'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1291:function(G,P,b){G=b(0);var k=b(17),f=b(42),x=b(6),u=b(109),w=b(143),r=b(724),m=b(202),l=b(574),z=b(2),F=b(366),L=b(23),E=b(41),A=b(231),M=b(1),Q=b(1375);class R{constructor(V,W){this.pdj=V;this.Yx=W}J(V){return this.pdj.ax(V,this.Yx)}}Object(G.a)(R,"PropertyMergeStrategies",null,[]);var K=b(1453),J=b(1398);class O extends J.a{constructor(){super();this.JNc=this.xOd=this.$l=null;this.vVd=0}get gca(){return"Property"}Wwb(){this.detail.Z("Type",
this.gca);this.detail.Z("ComplexMerger",null!=this.$l?this.$l:-1);this.detail.Z("Strategy",null!=this.xOd?this.xOd:-1);this.detail.Z("ClassId",null!=this.JNc?this.JNc:-1);this.detail.Z("PropId",this.vVd);return this.detail}}Object(G.a)(O,"PropertyMergeFailureDetail",J.a,[]);b.d(P,"a",function(){return N});class N{constructor(V=null){this.oBg=this.Na=null;this.ZOb=V||this.YDc()}get $l(){return 1}get eeb(){return this.ZOb}YDc(){return[Object(E.a)(this,this.rIn,"tryPreProcessFavoredRevision"),Object(E.a)(this,
this.X7j,"cloneObjectAndRemoveNeededProperties"),Object(E.a)(this,this.hIn,"tryMergeNodeInternal")]}set Ua(V){this.Na=V}get Yx(){return 5}get xVd(){return this.oBg||(this.oBg=new R(this.$i(),this.Yx))}zz(V,W){const ca=V.tf.value.Zd;w.a.instance.ua(4016352,1,3,"GenericNodeComplexMerge: Failing to merge object with [Id: {0}] [ClassId: {1}] because not all of its properties changes were ignorable.",ca.id,ca.Gb);V.vm.logger.Cf(Object.assign(new O,{$l:this.$l,JNc:ca.Gb,vVd:W}));return!1}CZf(V){const W=
V.tf.value;w.a.instance.ua(4016353,1,4,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",W.Zd.id,W.Zd.Gb);for(let ca=0;ca<this.eeb.length;ca++)if(!(0,this.eeb[ca])(V))return w.a.instance.ua(4016354,1,3,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",W.Zd.id,W.Zd.Gb,ca),V.vm.logger.iNd("GraphNodeComplexMerge.GetMergeFunctions()",ca),this.v3l(V),V.nj=null,!1;w.a.instance.ua(4016355,1,4,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",
W.Zd.id,W.Zd.Gb);return!0}v3l(V){V.m2f||(V.m2f=!0,K.a(V.tf.value.ns,"Base",1),K.a(V.tf.value.Zd,"Favored",1),K.a(V.jl.value.Zd,"Conflict",1))}rIn(V){const W=V.tf.value,ca=this.xVd;if(!W.GO)return!0;let H=!0;W.L9.forEach((Z,aa)=>{if(!aa.GO||V.Ze.contains(Z))return!0;aa=ca.J(Z);if(5===aa){const ja=W.ns.Gb;w.a.instance.ua(4018176,1,2,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",ja,Z,aa);V.vm.logger.Cf(Object.assign(new O,
{$l:this.$l,JNc:ja,vVd:Z,xOd:aa}));return H=!1}6===aa&&V.gGf.add(Z);return!0});return H}X7j(V){V.nj=V.tf.value.Zd.dF();const W=V.gGf,ca=V.nj;W&&W.forEach(H=>{ca.removeProperty(r.a.lO(H));return!0});return!0}hIn(V){const W=V.jl.value,ca=W.ns.Gb,H=this.xVd;let Z=!0;W.L9.forEach((aa,ja)=>{const Ba=H.J(aa);Z=this.iIn(V,ja,aa,Ba);Z||(V.nj=null,w.a.instance.ua(4018177,1,3,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",ca,aa,Ba),V.vm.logger.Cf(Object.assign(new O,{$l:this.$l,
JNc:ca,vVd:aa,xOd:Ba})));return Z});return Z}iIn(V,W,ca,H){const Z=V.nj;if(!W.GO&&8!==H||2===H||7===H||V.Ze.contains(ca))return!0;if(5===H)return!1;if(4===H||3===H){let aa;if(({value:aa}=V.tf.value.L9.Ab(ca)).returnValue&&aa.GO)return 4!==H;H=0}8===H&&(H=0);if(0===H){if(!W.isDeleted)return V=r.a.lO(ca),(N.wUn(W,ca,V)||N.pon())&&Z.b$(V,W.newValue),!0;H=6}return 6===H?(Z.removeProperty(r.a.lO(ca)),!0):1===H?this.zz(V,ca):!1}Zcm(V,W,ca,H,Z,aa){V=V||new m.a;W=W||new m.a;ca=ca||new m.a;var ja=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseList.Length: {0}] to not exceed [favoredList.Length: {1}] or [conflictList.Length: {2}]",
V.length,W.length,ca.length),Ba=V.length<=W.length&&V.length<=ca.length;this.QTh()&&Ba&&w.a.instance.ua(541181455,1,1,ja);if(!Ba&&this.cSh(aa.runtime.Ua))return null;if(this.QTh())for(ja=0;ja<V.length;ja++){Ba=V.Ye(ja);var la=W.Ye(ja);let ia=ca.Ye(ja);Ba=String.format("TryMergePurelyAdditiveObjectIds: Expected [baseVal: {0}] [favoredVal: {1}] and [conflictVal: {2}] [index: {3}] [baseList.Count {4}] to all be the same.",Ba,la,ia,ja,V.length);w.a.instance.ua(541181457,1,1,Ba)}if(this.cSh(aa.runtime.Ua))for(aa=
0;aa<V.length;aa++)if(ja=V.Ye(aa),Ba=W.Ye(aa),la=ca.Ye(aa),!H(ja,Ba)||!H(ja,la))return null;V=V.s1();H=new l.a;aa=V.length;for(ja=aa;ja<W.length;ja++)Ba=W.Ye(ja),V.add(Ba),H.add(Ba);for(;aa<ca.length;aa++)W=ca.Ye(aa),H.contains(W)?w.a.instance.ua(4018180,1,4,"MergePurelyAdditiveLists: Both favored and conflict lists contained a reference to {0}. Only adding one copy of it.",W):(V.add(W),Z(W));return V}QTh(){return!!z.AFrameworkApplication.K&&z.AFrameworkApplication.K.$("LogMPALErrors")}cSh(V){if(!V)return!1;
V.Vbf(1000008);return V.eyb(1000008)}wSl(V){if(!V)return!1;V.Vbf(1000009);return V.eyb(1000009)}i5h(V,W,ca,H){return Q.a(V,W,ca,H)}vAa(V,W,ca){V=V||new m.a;W=W||new m.a;ca=ca||new m.a;const H=V.yz(),Z=W.yz(),aa=ca.yz();V=N.filter(V,ja=>Z.contains(ja)&&aa.contains(ja));V.yz();V.ez(V.length,N.filter(W,ja=>!H.contains(ja)));V.ez(V.length,N.filter(ca,ja=>!H.contains(ja)&&!Z.contains(ja)));return V}Scm(V,W){const ca=r.a.lO(W),H=V.Bc;var Z=H.getPropertyObjectIds(V.tf.value.ns,ca),aa=H.getPropertyObjectIds(V.tf.value.Zd,
ca);const ja=H.getPropertyObjectIds(V.jl.value.Zd,ca);Z=this.vAa(Z,aa,ja);aa=V.nj;0<Z.length?H.setPropertyObjectIds(aa,ca,Z):aa.removeProperty(ca);V.Ze.add(W)}p9a(V,W,ca){V.hasProperty(ca)?W.b$(ca,V.PG(ca)):W.removeProperty(ca)}C_m(V,W){var ca=W.zi();for(const H of ca)W.removeProperty(H);ca=V.zi();for(const H of ca)W.b$(H,V.PG(H))}onf(V,W,ca,H,Z){W=V.getPropertyInt32(W,Z);ca=V.getPropertyInt32(ca,Z);ca=null!=W&&null!=ca?Math.max(W,ca):null!=ca?ca:null!=W?W:null;null!=ca?V.setPropertyInt32(H,Z,ca):
H.removeProperty(Z)}uPe(V,W,ca,H,Z,aa){W=V(W,Z);ca=V(ca,Z);V=V(H,Z);H=W.yz();let ja=!1;aa&&(ja=aa(W,ca,V));ja?(aa=!0,H=!1):(aa=H.X5g(ca),H=H.X5g(V));w.a.instance.ua(588011013,1,3,"CheckForMaterialDifferences: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",r.a.Ha(Z),W.xp(),ca.xp(),V.xp(),aa,H);return{oxc:V,yXa:aa,sXa:H}}W3j(V,W,ca,H,Z){let aa;W=V(W,Z);ca=V(ca,Z);V=V(H,Z);H=this.QWh(W,ca);aa=this.QWh(W,V);w.a.instance.ua(588011014,
1,3,"CheckForMaterialDifferencesInDictionaryProperty: Property:{0}, [BaseValue: {1}, FavoredValue: {2}, ConflictingValue: {3}][isFavoredEquivalentToBase:{4}, isConflictEquivalentToBase:{5}]",r.a.Ha(Z),W.xp(),ca.xp(),V.xp(),H,aa);return{oxc:V,yXa:H,sXa:aa}}QWh(V,W){if(!V&&!W)return!0;if(!V||!W)return!1;if(!V.count&&!W.count)return!0;let ca=!1;W.forEach((H,Z)=>ca=V.Ja(H)&&Z==V.J(H));return ca}$i(){let V;V=this.wSl(this.Na)?N.elj.value:N.dlj.value;const W=new F.a(0);for(let ca=0;ca<V.length;ca++)W.Z(V[ca],
7);return W}static Oba(){return new N}static get instance(){return N._instance.value}static pon(){return L.a.instance.ra("Box4.IFeatureHelper").isFeatureEnabled(126)}static wUn(V,W,ca){if(void 0!==V.newValue&&null!==V.newValue||M.a.AUh(ca.type))return!0;N.J4l(V,W,ca);return!1}static J4l(V,W,ca){ca=ca.type===M.a.string;W=String.format("TryMergeProperty: Failed to Merge Property [ID: {0}]",W);ca||(W+=String.format(" [NewValue: {0}] [OldValue: {1}]",V.newValue,V.oldValue));w.a.instance.ua(19145822,1,
2,W)}static Yrf(V,W,ca){const H=r.a.Ha(ca),Z=V.Bc;var aa=Z.getPropertyObjectIds(V.tf.value.ns,ca);const ja=Z.getPropertyObjectIds(V.tf.value.Zd,ca);var Ba=Z.getPropertyObjectIds(V.jl.value.Zd,ca);Ba=N.fll(Ba,V.vm.runtime.Pac);W=W.vAa(aa,ja,Ba);aa=V.nj;0<W.length?Z.setPropertyObjectIds(aa,ca,W):aa.removeProperty(ca);V.Ze.add(H);return!0}static fll(V,W){const ca=new m.a;V.forEach(H=>{W.contains(H,(Z,aa)=>Z.equals(aa))||ca.add(H);return!0});return ca}static filter(V,W){const ca=new m.a;V.forEach(H=>
{W(H)&&ca.add(H);return!0});return ca}static e3k(){return[r.a.Ha(k.a.A_e),r.a.Ha(k.a.lastModifiedTime),r.a.Ha(k.a.MI),r.a.Ha(k.a.pFb),r.a.Ha(k.a.VMf),r.a.Ha(f.a.INc),r.a.Ha(x.a.pqd),r.a.Ha(x.a.b$a),r.a.Ha(u.a.Gwi)]}static f3k(){return[r.a.Ha(k.a.A_e),r.a.Ha(k.a.lastModifiedTime),r.a.Ha(k.a.MI),r.a.Ha(k.a.pFb),r.a.Ha(k.a.VMf),r.a.Ha(f.a.INc),r.a.Ha(x.a.pqd),r.a.Ha(u.a.Gwi)]}}N._instance=new A.a(N.Oba);N.dlj=new A.a(N.e3k);N.elj=new A.a(N.f3k);Object(G.a)(N,"GraphNodeComplexMerge",null,[1925])},1292:function(G,
P,b){b.r(P);G=b(0);var k=b(246),f=b(1315),x=b(1298),u=b(1458),w=b(1459);class r{constructor(l,z){this.X4a=!1;this.mda=null;if(!l)throw Error.argumentNull("annotations");if(!l.S3b(z))throw Error.argument("structTypeID","Invalid struct type ID");this.Au=l;this.c5b=this.Au.$yh(z);this.rwj=z}get OTb(){return this.Au}get isReadOnly(){return this.X4a}get xNa(){return this.rwj}Bab(l){if(0>l||l>=this.c5b)throw Error.argument("iField","Invalid field index");return this.mda&&null!=this.mda[l]?this.mda[l]:this.Au.mDh(this.xNa,
l)}LPf(l,z){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>l||l>=this.c5b)throw Error.argument("iField","Invalid field index");if(!this.Au.M2b(this.Au.Nxb(this.xNa,l),z))throw Error.argument("value","Value is not of the correct type for the specified field");(this.mda||(this.mda=Array(this.c5b)))[l]=z}I$(){const {Annotations:l}=b(1292);let z="[";if(this.mda){let F=!0;for(let L=0;L<this.c5b;++L){if(null==this.mda[L])continue;const E=this.Au.Nxb(this.xNa,
L);if(l.sjb(E,this.mda[L],this.Au.mDh(this.xNa,L)))continue;F?F=!1:z+=", ";z+=this.Au.nDh(this.xNa,L);z+="=";const A=this.Au.I$(E,this.mda[L]);E===l.M5?(z+='"',z+=f.a.x0e(A),z+='"'):z+=A}}return z+"]"}isEqual(l){const {Annotations:z}=b(1292);if(this===l)return!0;if(!l||this.Au!==l.OTb||this.xNa!==l.xNa)return!1;for(let F=0;F<this.c5b;++F)if(!z.sjb(this.Au.Nxb(this.xNa,F),this.Bab(F),l.Bab(F)))return!1;return!0}clone(){const l=new r(this.Au,this.xNa);this.mda&&(l.mda=Array.clone(this.mda));return l}TQ(){return this.isReadOnly?
this.clone():this}tpf(){const {Annotations:l}=b(1292);if(!this.isReadOnly&&(this.X4a=!0,this.mda))for(let z=0;z<this.c5b;++z){const F=this.mda[z];null!=F&&l.zBb(F)}}toString(){return this.I$()}}Object(G.a)(r,"StructValue",null,[1156,1154]);b.d(P,"Annotations",function(){return m});class m{constructor(l,z){if(!l)throw Error.argumentNull("initData");if(!z)throw Error.argumentNull("objectFetcher");this.y9l=z.fyk;let F=0;var L=z.nab(l.J(F));++F;this.Wqf=new u.a(new w.a(L));this.mdj=l.J(F);++F;this.Q2h=
Array(this.pvd);this.wMc=Array(this.pvd);this.Udb=Array(this.pvd);for(L=0;L<this.pvd;++L){this.Q2h[L]=z.getString(l.J(F));++F;this.wMc[L]=l.J(F);++F;var E=l.J(F);++F;this.Udb[L]=Array(E);for(var A=0;A<E;++A)this.Udb[L][A]=z.getString(l.J(F)),++F}this.qwj=l.J(F);++F;this.u3h=Array(this.nXc);this.ONd=Array(this.nXc);this.PNd=Array(this.nXc);this.NNd=Array(this.nXc);for(L=0;L<this.nXc;++L)for(this.u3h[L]=z.getString(l.J(F)),++F,E=l.J(F),++F,this.ONd[L]=Array(E),this.PNd[L]=Array(E),this.NNd[L]=Array(E),
A=0;A<E;++A)this.ONd[L][A]=z.getString(l.J(F)),++F,this.PNd[L][A]=l.J(F),++F,this.NNd[L][A]=({Jca:F}=this.VHa(this.PNd[L][A],l,F,null,null,null)).returnValue,m.zBb(this.NNd[L][A]);this.i8i=l.J(F);++F;this.Cqf=Array(this.nUb);this.Dqf=Array(this.nUb);this.Bqf=Array(this.nUb);for(L=0;L<this.nUb;++L)this.Cqf[L]=z.getString(l.J(F)),++F,this.Dqf[L]=l.J(F),++F,this.Bqf[L]=({Jca:F}=this.VHa(this.Dqf[L],l,F,null,null,null)).returnValue,m.zBb(this.Bqf[L])}GCc(l){for(let z=0;z<this.nUb;++z)if(this.Cqf[z]===
l)return z;return-1}uqh(l){if(!this.P3b(l))throw Error.argument("attrID","Invalid attribute ID");return this.Cqf[l]}getAttributeType(l){if(!this.P3b(l))throw Error.argument("attrID","Invalid attribute ID");return this.Dqf[l]}Nxb(l,z){if(!this.S3b(l))throw Error.argument("structTypeID","Invalid struct type ID");l=this.PNd[m.oXc(l)];if(0>z||z>=l.length)throw Error.argument("iField","Invalid field index");return l[z]}I$(l,z){if(!this.Nmf(l))throw Error.argument("typeID","Invalid type ID");if(!this.M2b(l,
z))throw Error.argument("value","Value is not of the correct type");switch(l){case m.M5:return z;case m.uta:return z?"True":"False";case m.OCa:case m.Rla:return z.toString();case m.IS:return z.I$();default:if(!m.UF(l)&&m.kZc(l)){l=m.n0e(l);const E=this.Udb[l].length;switch(this.wMc[l]){case 0:return this.Udb[l][z];case 1:if(z){var F="";for(var L=1;L<E;++L)z&1<<L-1&&(0<F.length&&(F+=" & "),F+=this.Udb[l][L]);return F}return this.Udb[l][0];case 2:F="";for(L=0;L<E;++L)z&1<<L&&(0<F.length&&(F+=" & "),
F+=this.Udb[l][L]);return F;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.wMc[l]);}}else return z.I$()}}Nmf(l){switch(l){case m.M5:case m.uta:case m.OCa:case m.Rla:case m.IS:return!0;default:return m.UF(l)?this.Nmf(m.WVa(l)):m.kZc(l)?this.EUl(l):this.S3b(l)}}EUl(l){l=m.n0e(l);return 0<=l&&l<this.Q2h.length}S3b(l){l=m.oXc(l);return 0<=l&&l<this.u3h.length}P3b(l){return 0<=l&&l<this.nUb}M2b(l,z){if(null==z)return!1;switch(l){case m.M5:return"string"===typeof z;case m.uta:return"boolean"===
typeof z;case m.OCa:return"number"===typeof z;case m.Rla:return"number"===typeof z;case m.IS:return Object(k.a)(1153,z);default:if(m.UF(l))return Object(k.a)(1155,z)&&z.R0===m.WVa(l);if(m.kZc(l)){if("number"!==typeof z)return!1;l=m.n0e(l);const F=this.Udb[l].length;switch(this.wMc[l]){case 0:return 0<=z&&z<F;case 1:return!(z&-1<<F-1);case 2:return!!z&&!(z&-1<<F);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.wMc[l]);}}else return Object(k.a)(1156,z)&&z.xNa===l}}get nUb(){return this.i8i}get pvd(){return this.mdj}get nXc(){return this.qwj}nSk(l){if(!this.P3b(l))throw Error.argument("attrID",
"Invalid attribute ID");return this.Bqf[l]}$yh(l){if(!this.S3b(l))throw Error.argument("structTypeID","Invalid struct type ID");return this.ONd[m.oXc(l)].length}nDh(l,z){if(!this.S3b(l))throw Error.argument("structTypeID","Invalid struct type ID");return this.ONd[m.oXc(l)][z]}mDh(l,z){if(!this.S3b(l))throw Error.argument("structTypeID","Invalid struct type ID");l=this.NNd[m.oXc(l)];if(0>z||z>=l.length)throw Error.argument("iField","Invalid field index");return l[z]}VHa(l,z,F,L,E,A){if(!z)throw Error.argumentNull("initData");
if(m.UF(l)){var M=z.J(F);++F;l=m.WVa(l);var Q=new x.a(this,l);for(var R=0;R<M;++R)Array.add(Q.items,({Jca:F}=this.VHa(l,z,F,L,E,A)).returnValue);return{returnValue:Q,Jca:F}}switch(l){case m.M5:return{returnValue:(L||this.Wqf).getString(z.J(F++)),Jca:F};case m.uta:return{returnValue:1===z.J(F++),Jca:F};case m.OCa:return{returnValue:z.J(F++),Jca:F};case m.Rla:return{returnValue:(E||this.y9l)[z.J(F++)],Jca:F};case m.IS:l=z.J(F++);M=new f.a(this);for(Q=0;Q<l;++Q)R=z.J(F),++F,A&&(R=A[R]),M.Dw(R,({Jca:F}=
this.VHa(this.getAttributeType(R),z,F,L,E,A)).returnValue);return{returnValue:M,Jca:F};default:if(m.kZc(l))return{returnValue:z.J(F++),Jca:F};if(m.eSi(l)){M=z.J(F++);Q=new r(this,l);for(R=0;R<M;++R){const K=z.J(F);++F;Q.LPf(K,({Jca:F}=this.VHa(this.Nxb(l,K),z,F,L,E,A)).returnValue)}return{returnValue:Q,Jca:F}}throw Error.argument("typeID","Invalid type ID");}}static kZc(l){return 16<=(l&16383)&&16384!==(l&16384)&&32768!==(l&32768)}static eSi(l){return 16<=(l&16383)&&16384===(l&16384)&&32768!==(l&
32768)}static UF(l){return 32768===(l&32768)}static h6k(l){if(m.UF(l))throw Error.argument("nonListTypeID","Non-list type ID required");return l|32768}static WVa(l){if(!m.UF(l))throw Error.argument("listTypeID","List type ID required");return l&-32769}static sjb(l,z,F){switch(l){case m.M5:case m.uta:case m.OCa:case m.Rla:return z===F;case m.IS:return z.isEqual(F);default:return m.UF(l)?z.isEqual(F):m.kZc(l)?z===F:z.isEqual(F)}}static zBb(l){Object(k.a)(1154,l)&&l.tpf()}static TQ(l){return Object(k.a)(1154,
l)?l.TQ():l}static n0e(l){return l-16}static oXc(l){return(l&-16385)-16}}m.M5=1;m.uta=2;m.OCa=3;m.Rla=5;m.IS=9;Object(G.a)(m,"Annotations",null,[1157])},1296:function(G,P,b){G=b(0);var k=b(265);class f{constructor(){this.userId=this.email=this.displayName=null}}Object(G.a)(f,"InsertMentionParameters",null,[]);class x{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(G.a)(x,"InsightsParameters",null,[]);var u=b(1556),w=b(1557),r=b(1558),m=b(1559),l=b(2),z=b(1358),
F=b(1371),L=b(31),E=b(15),A=b(16),M=b(1287);b.d(P,"a",function(){return Q});class Q{static get Lgf(){return"Insights_16x16x32"}static get vIk(){return"Find_16x16x32"}static get rgi(){return"-Parameterized"}static get bUf(){return"Parameterized"}static get p6d(){return"bTryQuery"}static get KZf(){return"TellMeSuggestion_"}static get FRi(){return"bTryQueryAlternate"}static get rXf(){return"MenuTellMe"}static get jAm(){const R={},K=[];Array.add(K,{Term:{PeopleType:"Person"}});R.And=K;return R}static cVe(R){return R+
Q.rgi}static getParameter(R){let K="",J="";if(R)for(let O=0;O<R.Qkh;++O)"Type"===R.w7e(O)?K=R.getValue(O):"Value"===R.w7e(O)&&(J=R.getValue(O));return new k.a(K,J)}static mub(R){R=Object.assign(new x,{neighborhood:R,mentionStart:0,mentionLength:R.length});return L.c(R)}static v$g(R,K,J){R=Object.assign(new f,{displayName:R,email:K,userId:J});return L.c(R)}static hUa(R,K,J=null){R=Object.assign(new F.a,{neighborhood:R,mentionStart:0,mentionLength:R?R.length:0});K=Object.assign(new z.a,{selection:R,
userIntent:null,entryPoint:K,launchData:J});return L.c(K)}static J3m(R,K){return Q.hUa(R,Q.K3m(K))}static K3m(R){switch(R){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static DSh(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("IsGoLocalEnvironment")}static wAb(){const R=l.AFrameworkApplication.K?l.AFrameworkApplication.K.Ga("SovereignEnvironmentName"):null;return!!R&&0<R.length}static isEnterpriseUser(){const R=
l.AFrameworkApplication.K?l.AFrameworkApplication.K.Ga("HostAuthType"):null;return!!R&&"aad"===R.toLowerCase()||"external"===R&&Q.qif()}static bSf(R){return R.ZBn&&!Q.wAb()}static pWh(){const R=l.AFrameworkApplication.K?l.AFrameworkApplication.K.Ga("UiHostIntegrationType"):"";return!!l.AFrameworkApplication.K&&"UnifiedUiHostTeams"===R&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static aSf(R){return R.JNa&&R.FGk&&(R.bYc||
R.$Xc||R.ldb)&&!Q.pWh()&&Q.isEnterpriseUser()&&!Q.wAb()}static aAa(){return l.AFrameworkApplication.K?l.AFrameworkApplication.m0a||l.AFrameworkApplication.K.$("SmartLookupEnableNativePane"):l.AFrameworkApplication.m0a}static IX(R){return!R||Q.MWh(R.Ef)}static MWh(R){return!R||!R.trim().length}static kZf(R){if(!R)return 0;const K=Math.pow(10,5);return Math.round(R*K)/K}static $Dn(){var R=new Date;return R?new Date(R.getUTCFullYear(),R.getUTCMonth(),R.getUTCDate(),R.getUTCHours(),R.getUTCMinutes(),
R.getUTCSeconds(),R.getUTCMilliseconds()):null}static Vaf(R){R=new Date(R);return(Q.$Dn().getTime()-R.getTime())/1E3}static sXh(R){const {InsightsMenuItemFactory:K}=b(1555);switch(R){case u.a.rdf:case w.a.Amh:case K.UNh:case r.a.Y7h:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":return!0}return R.startsWith(Q.p6d)||
R.startsWith(Q.KZf)||R.startsWith(Q.FRi)||R.startsWith("PeopleSuggestion")||R.startsWith("FileSuggestion")||R.startsWith("FindInDocumentSuggestion")||R.startsWith("NotesSuggestion")||R.startsWith("OnenoteNotesSuggestion")||R.startsWith("SmartLookupFromTellMe")||R.startsWith("GetHelpFromTellMe")||R.startsWith("GetHelpWithDescriptionFromTellMe")||R.startsWith("AddinSuggestion")?!0:!1}static M7e(R,K){const J=[];Array.add(J,new m.a(400,R));Array.add(J,new m.a(200,K));R={};R.parts=J;return JSON.stringify(R)}static LCc(R){const K=
R.indexOf("<b0>"),J=R.lastIndexOf("</b0>"),O=[];Array.add(O,new m.a(400,R.substring(0,K)));Array.add(O,new m.a(600,R.substring(K+4,J)));Array.add(O,new m.a(400,R.substring(J+5,R.length)));R={};R.parts=O;return JSON.stringify(R)}static KEh(R){const K=Q.Vaf(R);return 60>K?CommonUIStrings.l_TimeSince_SecsAgo:3600>K?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(K/60).toString()):86400>K?String.format(CommonUIStrings.l_TimeSince_HoursAgo,Math.floor(K/3600).toString()):172800>K?CommonUIStrings.l_TimeSince_Yesterday:
String.format(CommonUIStrings.l_TimeSince_Date,(new Date(R)).localeFormat("MMMM dd, yyyy"))}static pVk(R){const K=Array(R.length);for(let J=0;J<R.length;J++)K[J]=R[J].commandId;return K}static qif(){if("Dev Box"===l.AFrameworkApplication.K.Ga("StatusBarEnvironmentNameToUse"))return!0;let R=l.AFrameworkApplication.K.Ga("UserPrincipalName");R=M.c(R)?"":A.a.kg(R);const K=l.AFrameworkApplication.K.hF("TellMeIntEnabledForFeatureCrew")?l.AFrameworkApplication.K.bB("TellMeIntEnabledForFeatureCrew"):[];return 0<=
Array.indexOf(K,R)&&"inner"===l.AFrameworkApplication.K.Ga("Microsoft365Ring")}static a3k(R){switch(R.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static dA(){return E.a.MX&&!E.a.In}}Q.B5d=9E5;Object(G.a)(Q,"TellMeUtils",null,[])},1297:function(G,P,b){b.r(P);G=b(0);var k=b(41),f=b(246),x=b(69),u=b(1469),w=b(902);class r{constructor(vb,xb,lc,Lc,uc,od){this.groupType=vb;this.resultType=xb;
this.KVf=lc;this.e4=Lc;this.vYe=uc;this.resultIndex=od}}Object(G.a)(r,"ClickLoggingInfo",null,[]);const m=vb=>{const xb=[];for(;vb;)Array.add(xb,"{ContextId:"+vb.contextId+", IsGraphNodeContext:"+vb.Kk+"}"),vb=vb.lm;xb.reverse();return"{"+xb.join(", ")+"}"};class l{constructor(){this.Nca=this.sessionId=null}}Object(G.a)(l,"CorrelationRecord",null,[1048]);var z=b(1325);class F{constructor(vb,xb){this.Id=null;this.TimeStamp=0;this.Id=vb;this.TimeStamp=xb}}Object(G.a)(F,"MRUControl",null,[]);var L=b(1455),
E=b(1456),A=b(1296),M=b(2),Q=b(1189);class R{constructor(vb,xb){this.rmj=10;this.P2=[];this.fva=[];this.Jpg=this.Ipg=!1;this.wnc=this.vnc="";this.XOb=xb;this.wb=vb;this.Cqg=vb.Jo}fDc(){!this.Ipg&&this.Cqg&&this.wb&&E.a.WTh()&&(this.vnc="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.wb.application,this.P2=this.irh(),this.Ipg=!0);return this.P2}ucl(){!this.Jpg&&this.Cqg&&this.wb&&E.a.WTh()&&(this.wnc="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.wb.application,this.fva=this.irh(!0),this.Jpg=!0);return this.fva}HTl(vb){return vb.startsWith("TellMeUpsell")||
"OpenInClientUpsell"===vb||"TryOfficeUpsell"===vb}Yhf(vb){return this.FGl(vb)||this.HTl(vb)||A.a.sXh(vb)?!1:!0}KGa(vb){vb=vb.ControlId;this.Yhf(vb)&&(vb=this.wKf(vb),this.LWm(vb),this.s$l(),Array.insert(this.P2,0,new F(vb,Date.now())),this.vnc.length&&(vb=JSON.stringify(this.P2),Q.a.instance.setItem(this.vnc,vb)))}ZH(vb){this.r$l();Array.insert(this.fva,0,new F(L.a[vb],Date.now()));this.wnc.length&&(vb=JSON.stringify(this.fva),Q.a.instance.setItem(this.wnc,vb))}irh(vb=!1){if(!this.P2.length){var xb=
vb?Q.a.instance.getItem(this.wnc):Q.a.instance.getItem(this.vnc);if(!xb||""===xb)return vb?this.fva:this.P2;let lc=null;try{lc=JSON.parse(xb)}catch(Lc){this.g6j(vb),lc=null}if(!lc||!lc.length||10<lc.length)return vb?this.fva:this.P2;xb=0;for(const Lc of lc)if(vb||this.wb.KKd(Lc.Id)&&this.Yhf(Lc.Id))if(vb?Array.insert(this.fva,xb++,Lc):Array.insert(this.P2,xb++,Lc),xb===this.XOb)break}return vb?this.fva:this.P2}XRe(vb){vb=this.wKf(vb);for(const xb of this.P2)if(xb.Id===vb)return!0;return!1}g6j(vb=
!1){Q.a.instance.setItem(vb?this.wnc:this.vnc,"")}KIl(vb){vb=this.wKf(vb.ControlId);return this.Yhf(vb)?this.XRe(vb):!1}LWm(vb){if(0<this.P2.length){let xb=0;for(const lc of this.P2){if(lc.Id===vb){Array.removeAt(this.P2,xb);break}xb++}}}wKf(vb){return"Excel"===this.wb.application&&vb.startsWith("m_excelWebRenderer_ewaCtl_")?vb.substr(26,vb.length):vb}s$l(){this.P2.length===this.XOb&&Array.removeAt(this.P2,this.P2.length-1)}r$l(){this.fva.length===this.rmj&&Array.removeAt(this.fva,this.fva.length-
1)}FGl(vb){vb=vb.split("|");let xb="";if(6<=vb.length)xb=vb[0];else if(3<=vb.length){if("3"===vb[0])return!0;xb=vb[1]}return xb.startsWith("WA")}static createInstance(vb){let xb=3;M.AFrameworkApplication.K&&(xb=M.AFrameworkApplication.K.vb("TellMeMaxRecommendedResultsToReturn",3));return new R(vb,xb)}}Object(G.a)(R,"MruControlsManager",null,[1047]);class K{constructor(vb){this.$ob=vb}P_(vb,xb){let lc;return vb.mA&&(lc=this.$ob[vb.value])?lc.P_(vb,xb):(lc=this.ksh(vb.value))?lc.P_(lc.Lem,xb):null}hal(vb,
xb){if(vb=this.$ob[vb])for(const lc of xb)if(xb=A.a.getParameter(lc),xb.key===vb.CCf)return xb.value;return null}jim(vb){(vb=this.ksh(vb))&&vb.gim()}ksh(vb){const xb=vb.indexOf(A.a.rgi);return 0<xb?this.$ob[vb.substring(0,xb)]:null}}Object(G.a)(K,"ParameterizedCommandManager",null,[1046]);var J=b(1337);class O{constructor(vb,xb){this.Ef=vb;this.Xfb=xb}}Object(G.a)(O,"TellMeQuery",null,[]);var N=b(1457);class V{constructor(vb,xb){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=vb;this.TimeElapsedSinceClick=
xb}}Object(G.a)(V,"CommandClickedEvent",null,[]);var W=b(1287);class ca{constructor(vb,xb){this.Eoj=vb;this.Sna=xb}resultsUpdated(vb){this.Eoj(W.c(vb.query)?"":vb.query.Ef,vb.Am,vb.attributes,this.Sna,vb.f3b)}}Object(G.a)(ca,"ResultsUpdatedCallback",null,[1044]);var H=b(76);class Z{constructor(vb,xb){this.menuModel=vb;this.Yui=xb}}Object(G.a)(Z,"GeneratedMenuModel",null,[]);class aa{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(G.a)(aa,
"MenuModel",null,[]);class ja{constructor(vb,xb,lc){this.wb=vb;this.$ob=xb;this.aba=lc}CPk(vb,xb,lc){const {TellMeActor:Lc}=b(1297);let uc=0;const od=new aa,Cb=[];let gc="";od.sections=[];let Dc=new H.a;const Ub=!!this.wb&&this.wb.$Xa;var Bb=!!this.wb&&this.wb.xhb||M.AFrameworkApplication.na.Ya.xhb;for(const yb of vb){vb=0;Ub||(Dc=new H.a);const Wb=new H.a;let Xb=yb.displayName;for(const Cc of yb.results){if(0<=Cc.value.indexOf(A.a.bUf)){if(Cc.mA){var fb=this.$ob[Cc.value];if(fb&&Cc.value.endsWith(A.a.bUf)){if("FindParameterized"!==
Cc.value&&!Bb){const Bc=[];Bc.push(appChrome.actions.setControlLabel(Cc.value,fb.qAd(Cc)));Bc.push(appChrome.actions.setButtonCommandValueId(Cc.value,fb.X5e(Cc)));appChrome.api.dispatch(Bc)}fb=Cc.value.replace(A.a.bUf,"");Dc.remove(fb)?vb--:Wb.add(fb);Dc.add(Cc.value);vb++}}}else switch(Cc.type){case 5:Wb.contains(Cc.value)||(Dc.add(Cc.value),vb++);break;case 7:Dc.add(Cc.mA);vb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 6:case 19:case 20:case 21:case 25:Dc.add(Cc.value),
vb++}13===yb.groupType&&(Xb=A.a.aAa()?0<xb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,xb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,xb));21===yb.groupType&&(Xb=CommonUIStrings.l_LearningUILiveText)}uc+=vb;""!==Xb&&0<vb&&(gc+=" , "+vb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+Xb+" , ");0<Dc.count&&!Ub&&(vb=appChrome.api.menuSection(Dc.toArray(),yb.displayName,null,J.a[yb.groupType]),Cb.push(vb))}Bb=
null;0<uc&&(Bb=0<xb.length?1!==uc?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,uc,xb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,xb):1!==uc?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,uc):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,Ub?(xb=appChrome.api.menuSection(Dc.toArray(),"",null,null),Cb.push(xb)):Bb+=gc);lc&&(this.wb.uWa?Lc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Bb)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Bb)));od.sections=Cb;return new Z(od,uc,[])}static get i_e(){return ja.Tgg||(ja.Tgg=new Z(Object.assign(new aa,{sections:[]}),0,[]))}}ja.Tgg=null;Object(G.a)(ja,"TellMeMenuDefintionGenerator",null,[]);var Ba;(function(vb){vb[vb.TellMeControlActivated=0]="TellMeControlActivated";vb[vb.TellMeQueryExecuted=1]="TellMeQueryExecuted";vb[vb.TellMeResultsRendered=2]="TellMeResultsRendered";vb[vb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(Ba||
(Ba={}));Object(G.b)("PerformanceMarker",Ba);var la;(function(vb){vb[vb.TellMeTimeToRender=0]="TellMeTimeToRender";vb[vb.TellMeSessionLength=1]="TellMeSessionLength";vb[vb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(la||(la={}));Object(G.b)("PerformanceMeasure",la);class ia{mark(vb){window.performance.mark(Ba[vb])}measure(vb,xb,lc){const {TellMeActor:Lc}=b(1297);try{window.performance.measure(la[vb],Ba[xb],Ba[lc])}catch(uc){Lc.instance.Pd.onError("TellMePerformance:Measure","error measuring "+
la[vb])}}Qpf(vb,xb,lc){const {TellMeActor:Lc}=b(1297);Lc.instance.Pd.aqf(xb,lc,vb,this.O6k(vb))}G6j(){var vb=[0,1,2,3];for(const xb of vb)window.performance.clearMarks(Ba[xb])}clearMeasures(vb){for(const xb of vb)window.performance.clearMeasures(la[xb])}O6k(vb){let xb=0;(vb=this.fRk(vb))&&0<vb.length&&(xb=vb[vb.length-1].duration);return xb}fRk(vb){return window.performance.getEntriesByName(la[vb],"measure")}}Object(G.a)(ia,"TellMePerformance",null,[]);var oa=b(1378),ha=b(1377),pa=b(31);class Ea{constructor(vb){this.qxj=
vb}fDb(vb,xb,lc){const {TellMeActor:Lc}=b(1297);Lc.instance.Pd.N4(xb,ha.a.k8b,vb.data.we.toString(),Math.round(window.performance.now()-lc),ha.a.k8b,!0,oa.a.DJa);vb=pa.b(vb.data.qd);xb=-1;vb.Index&&(xb=vb.Index);Lc.instance.Pd.V6l(xb,this.qxj)}RCb(vb,xb,lc){const {TellMeActor:Lc}=b(1297);Lc.instance.Pd.N4(xb,ha.a.k8b,vb.data.we.toString(),Math.round(window.performance.now()-lc),ha.a.k8b,!1,oa.a.DJa)}Acl(vb){if(vb&&""!==vb.trim()){const lc=window.performance.now(),Lc=M.AFrameworkApplication.HNi;var xb=
{};xb.Text=vb;xb.IsFileHash="false";xb=pa.c(xb);M.AFrameworkApplication.fe.ai(Lc,2,xb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,uc=>{this.fDb(uc,vb.length,lc)},uc=>{this.RCb(uc,vb.length,lc)},null,null,!1,4E3,6E3)}}}Object(G.a)(Ea,"TellMeQueryIndexCallback",null,[]);var Fa=b(1301);class Ga{constructor(vb,xb,lc){this.xml=vb;this.Yui=xb;this.dwk=lc}}Object(G.a)(Ga,"GeneratedMenuXml",null,[]);var $a=b(1556),fa=b(16);class sa{constructor(vb,xb){this.y3c=vb||{};this.$Qa=xb}get GMa(){return 5}P_(vb,
xb=null){return this.$Qa.P_(vb,xb)||this.eWj(vb.value)}eWj(vb){return sa.vNe(vb,this.y3c[vb]||null)}static vNe(vb,xb=null){vb=String.format('<ClonedControl Id="{0}" ',vb);for(let uc in xb){var lc=uc,Lc=xb[uc];Lc=Lc?fa.a.Wd(Lc.toString()):"";vb+=String.format('{0}="{1}" ',lc,Lc)}return vb+"/>"}}Object(G.a)(sa,"CommandMenuItemFactory",null,[1037]);var qa=b(232);class va{constructor(){this.cej=CommonUIStrings.l_FindInDocumentText}get GMa(){return 8}P_(vb){var xb=vb.mA;vb=fa.a.Wd(vb.value);const lc=fa.a.Wd(xb);
xb=fa.a.Wd(String.format(this.cej,xb));return this.SOk(vb,lc,xb)}SOk(vb,xb,lc){return qa.a(vb,"1540292897",lc,A.a.vIk,null,xb,lc,null,null)}}Object(G.a)(va,"FindInDocumentMenuItemFactory",null,[1037]);var Ca=b(1557),ta=b(1555),Wa=b(1558);class Za{get GMa(){return 7}P_(vb){const xb=Object(x.a)(N.a,vb);return this.LPk(fa.a.Wd(vb.value),xb.id)}LPk(vb,xb){return qa.a(xb,"1404166600",vb,null,null,vb,vb,null,null)}}Object(G.a)(Za,"TryQueryMenuItemFactory",null,[1037]);class Ya{constructor(vb){this.t2=[];
this.wb=vb}J_k(vb){for(const xb of this.t2)if(xb.GMa===vb)return xb;return null}ha(vb){this.t2.push(vb)}oRm(vb){this.ha(new sa(this.wb.qdk,vb));this.ha(new Wa.a(this.wb.dhm));this.ha(new $a.a(this.wb.F8m,this.wb.E8m,this.wb.kCn,this.wb.tul,this.wb.ynn));this.ha(new ta.InsightsMenuItemFactory);this.ha(new va);this.ha(new Ca.a);this.ha(new Za);this.wb.Eoi(this)}}Object(G.a)(Ya,"MenuItemFactoryRegistry",null,[]);var Ka=b(1302);class xa{constructor(vb,xb){this.wb=vb;this.Tug=new Ya(this.wb);this.Tug.oRm(xb)}DPk(vb,
xb){let lc=0;const Lc=[],uc=[];for(const Cb of vb){vb=A.a.rXf;var od=[];for(const gc of Cb.results){const Dc=this.Tug.J_k(gc.type).P_(gc,xb);vb=A.a.rXf;od.push(Dc);if(13===gc.type||14===gc.type)vb="Menu32";17===gc.type&&(vb="MenuTellMeExtended");gc.groupType=Cb.groupType;uc.push(Object(x.a)(Ka.a,gc))}lc=lc?lc:od.length;od=qa.e("TellMeDropdownControls",od);vb=qa.j("TellMeDropdownMenuSection",od,vb,Cb.displayName);Lc.push(vb)}xb=qa.k(Lc,"LookupDropdownMenu");return new Ga(xb,lc,uc)}static get Hud(){return xa.Ugg||
(xa.Ugg=new Ga(qa.k([],"LookupDropdownMenu"),0,[]))}}xa.Ugg=null;Object(G.a)(xa,"TellMeXmlGenerator",null,[]);class Sa{}Sa.Bfm="MRU";Sa.test="Test";Object(G.a)(Sa,"ActionType",null,[]);var pb=b(1362),Db;(function(vb){vb[vb.Service=0]="Service";vb[vb.Local=1]="Local";vb[vb.MRU=2]="MRU";vb[vb.TestResult=3]="TestResult";vb[vb.Unknown=4]="Unknown"})(Db||(Db={}));Object(G.b)("SubResultType",Db);var Ua=b(74);class Lb{constructor(vb,xb,lc,Lc,uc=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=
this.SubResultType=this.ResultType=null;this.CommandId=vb;this.IsEnabled=xb;this.ResultType=L.a[lc];this.SubResultType=Db[Lc];this.OptionalData=uc?Ua.a.toJSON(uc):null}}Object(G.a)(Lb,"ResultInfo",null,[]);var Va=b(95),Sb=b(126),nb=b(235);class La{constructor(vb,xb=null){this.M8c="TellMeWAC.";this.gqj=vb;this.nyj=xb}RBa(vb,xb,lc){xb=Va.a.aR(xb);vb=Va.a.XUe(vb,this.gqj,this.nyj,lc,xb);Sb.a.RBa(vb,this.M8c)}QBa(vb,xb,lc=0){xb=Va.a.aR(xb);Sb.a.QBa(Object.assign(new nb.a,{name:vb,dataFields:xb,durationMs:lc}),
this.M8c)}}Object(G.a)(La,"TellMeOtelLogger",null,[1067]);var Ha=b(133);class Aa{constructor(vb,xb,lc,Lc,uc,od,Cb){this.Q2=this.X6=this.ycg=null;this.kkb=vb;this.oLb=xb;this.NFa=lc;this.W4a=Lc;this.nQa=uc;this.okj=od;this.Q2=Cb?Cb:new La(this.W4a?w.CuiHelper.aUf:w.CuiHelper.O4d)}get Jo(){return this.W4a}get aea(){return this.NFa}J0d(vb){this.ycg=vb;switch(vb){case Fa.a.contextMenu:this.X6=Fa.a.contextMenu;break;default:this.X6=Fa.a.tellMe}}cTj(vb,xb){this.NFa.Nca||(this.NFa.Nca=Ha.a.create().toString(),
this.r0h(vb,!0,xb))}qhh(vb,xb=!0){this.NFa.Nca&&this.k3l(vb,xb);this.W4a&&appChrome.api.updateTellMeCorrelationId("");this.NFa.Nca=null}r0h(vb,xb,lc){const {TellMeActor:Lc}=b(1297),uc=this.N3(z.a.kXa);uc[pb.a.culture]=this.oLb;uc[pb.a.appName]=this.kkb;uc[pb.a.context]=vb;uc[pb.a.ZJd]=this.nQa;uc[pb.a.DTl]=this.okj;uc[pb.a.qSl]=lc;uc[pb.a.SMl]=xb;uc[pb.a.contentType]=Lc.instance.ssd;this.Q2.RBa(z.a.kXa,uc,this.ycg);this.W4a&&appChrome.api.updateTellMeCorrelationId(this.NFa.Nca)}k3l(vb,xb){const lc=
this.N3(z.a.szb);lc[pb.a.Lyk]=vb;lc[pb.a.RMl]=xb;this.Q2.QBa(z.a.szb,lc)}U6l(vb,xb,lc){let Lc=0;!lc&&0<vb.length&&(Lc=vb.trim().split(" ").length);const uc=this.N3(z.a.query);uc[pb.a.query]="!";uc[pb.a.hEb]=xb;uc[pb.a.rli]=vb.length;uc[pb.a.tYh]=lc;uc[pb.a.vZn]=Lc;this.Q2.RBa(z.a.query,uc,this.X6)}P4l(vb,xb,lc,Lc,uc,od,Cb,gc=null){const Dc=this.N3(z.a.latency);Dc[pb.a.culture]=this.oLb;Dc[pb.a.rli]=vb;Dc[pb.a.iSi]=xb;Dc[pb.a.statusCode]=lc;Dc[pb.a.bbn]=uc;Dc[pb.a.isSuccess]=od;Dc[pb.a.uXl]=Cb;gc&&
(Dc[pb.a.xEn]=gc);this.Q2.QBa(z.a.latency,Dc,Lc)}aqf(vb,xb,lc,Lc){const uc=this.N3(z.a.performance);uc[pb.a.culture]=this.oLb;uc[pb.a.gTj]=Ba[vb];uc[pb.a.SAk]=Ba[xb];uc[pb.a.AAm]=la[lc];this.Q2.QBa(z.a.performance,uc,Lc)}f7l(vb,xb){var {TellMeActor:lc}=b(1297);const {CommandResultsUtility:Lc}=b(1345);if(vb.results.length){var uc=this.N3(z.a.Isi);uc[pb.a.e4]=xb.toString();uc[pb.a.groupType]=J.a[vb.groupType];16===vb.groupType&&(uc[pb.a.SRl]=lc.instance.k_c);xb=[];lc=[];var od=[];for(const Cb of vb.results)uc[pb.a.resultType]||
(uc[pb.a.resultType]=L.a[Cb.type]),vb={},25===Cb.type&&(vb.AssetId=Cb.qG),lc.push(Lc.AIc(Cb.value)),xb.push(Cb.value),od.push(new Lb(Cb.value,Lc.AIc(Cb.value),Cb.type,Cb.VLi,vb));0<xb.length&&(uc[pb.a.M3m]="{"+xb.join(", ")+"}",uc[pb.a.wAk]="{"+lc.join(", ")+"}",uc[pb.a.H3m]=pa.c(od));this.Q2.RBa(z.a.Isi,uc,this.X6)}}lQk(vb,xb){if(4===vb)return Sa.Bfm;switch(xb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return L.a[xb]}N2l(vb,
xb,lc,Lc,uc){const od=this.N3(z.a.click);od[pb.a.iSi]=vb;od[pb.a.Gym]=xb;od[pb.a.commandId]=lc;od[pb.a.Cba]=Lc;od[pb.a.actionType]=this.lQk(uc.groupType,uc.resultType);od[pb.a.resultType]=L.a[uc.resultType];od[pb.a.KVf]=Db[uc.KVf];od[pb.a.groupType]=J.a[uc.groupType];od[pb.a.e4]=uc.e4.toString();od[pb.a.vYe]=uc.vYe.toString();od[pb.a.resultIndex]=uc.resultIndex.toString();this.Q2.RBa(z.a.click,od,this.X6)}S2l(vb,xb){this.NFa.Nca||(this.NFa.Nca=Ha.a.create().toString(),this.r0h("",!1,xb));xb=this.N3(z.a.I6g);
xb[pb.a.hEb]=vb;this.Q2.QBa(z.a.I6g,xb)}L0h(vb,xb,lc){if(vb){if(lc)for(let Lc in lc)vb[Lc]=lc[Lc];this.Q2.QBa(z.a.events,vb,xb)}}l9(vb,xb,lc=null){const Lc=this.N3(z.a.events);Lc[pb.a.event]=vb;this.L0h(Lc,Math.round(xb),lc)}xYa(vb,xb,lc=null){const Lc=this.N3(z.a.events);Lc[pb.a.event]=z.a.error;Lc[pb.a.module]=vb;Lc[pb.a.errorMessage]=xb;Lc[pb.a.message]=xb;this.L0h(Lc,Math.round(window.performance.now()),lc)}L2l(vb){const xb=this.N3(z.a.Q3g);xb[pb.a.value]=vb;xb[pb.a.jXd]=this.W4a;this.Q2.RBa(z.a.Q3g,
xb,this.X6)}h2l(vb){const xb=this.N3(z.a.tMg);xb[pb.a.value]=vb;xb[pb.a.jXd]=this.W4a;this.Q2.RBa(z.a.tMg,xb,this.X6)}I3l(vb){const xb=this.N3(z.a.llh);xb[pb.a.value]=vb;xb[pb.a.jXd]=this.W4a;this.Q2.RBa(z.a.llh,xb,this.X6)}S6l(vb){const xb=this.N3(z.a.Hki);xb[pb.a.value]=vb;xb[pb.a.jXd]=this.W4a;this.Q2.RBa(z.a.Hki,xb,this.X6)}r2l(vb){const xb=this.N3(z.a.Mzi);xb[pb.a.value]=vb;this.Q2.RBa(z.a.Mzi,xb,this.X6)}W6l(vb,xb){const lc=this.N3(z.a.mli);lc[pb.a.k8b]=vb;xb&&(lc[pb.a.Nca]=xb);this.Q2.QBa(z.a.mli,
lc)}N3(vb){return{["SessionID"]:this.NFa.sessionId,["CorrelationID"]:this.NFa.Nca,["Time"]:(new Date).getTime(),["Event"]:vb,["Scenario"]:this.X6}}}Object(G.a)(Aa,"UsageLogger",null,[1043]);var Ma=b(54),cb=b(1515),ib=b(1057),Rb=b(80),Oa=b(60),lb=b(213),gb=b(353),Nb=b(15),qc=b(551),Eb=b(64),ec=b(13);b.d(P,"TellMeActor",function(){return Jb});class Jb{constructor(){this.$Qa=this.UZ=this.fb=this.qa=this.VV=this.Fu=this.Ta=this.ga=this.Pd=this.PH=this.vse=this.RLg=this.Una=this.wb=null;this.sOb=!1;this.Tde=
[];this.tcg=[];this.Kvg=[];this.Lvg=[];this.Bqg=!1;this.YKb=this.aba=null;this.olc=this.nQa=!1;this.Wad=!0;this.PW=this.okc=this.Nkg=this.Kse=this.uvg=null;this.WV=[];this.o3a=this.GLb=this.qua=null;this.HNb=!1;this.Dse=0;this.BKb=null;this.Sna=-1;this.Vug=0;this.wlc=!1;this.T3a=null;this.xKg=!1;this.tu=null}get ssd(){return this.VV?this.VV.contentType:Jb.unknown}get actions(){return this.WV}set actions(vb){this.WV=vb}BCd(){return this.Pd?this.Pd.aea.Nca:null}oM(){return this.wb}get sem(){return this.Wad}get JVn(){return this.uvg}performance(){return this.PH}get k_c(){return this.xKg}set k_c(vb){this.xKg=
vb}xE(vb){const xb=window.performance.now();this.aba&&!W.c(vb)&&(this.aba(vb),this.Pd.jA(z.a.xE,window.performance.now()-xb))}initialize(vb,xb=null,lc=null,Lc=null,uc=null,od=null,Cb=null,gc=null,Dc=null,Ub=null,Bb=null){const {InteractionLogger:fb}=b(1734),{GroupsPlacementInfo:yb}=b(1730),{AggregatorResultsProvider:Wb}=b(1577);this.wb=vb;this.nQa=!!M.AFrameworkApplication.na&&M.AFrameworkApplication.na.Ya.u3b;this.Pd=Lc;if(!Lc){Lc=new l;Lc.sessionId=M.AFrameworkApplication.userSessionId;const Xb=
qc.a.af(M.AFrameworkApplication.lcid)||qc.a.eIc;this.Pd=new fb(new Aa(this.wb.application,Xb.name,Lc,this.wb.Jo,this.nQa,vb.JNa,null),this.wb.zdk,this.wb)}this.$Qa=new K(this.wb.parameterData);this.RLg=lc||new xa(this.wb,this.$Qa);this.aba=Cb;this.vse=this.vse||new ja(this.wb,this.wb.parameterData,Cb);this.fb=Ma.FocusManager.instance();this.UZ=R.createInstance(this.wb);this.Nkg=new yb(vb);this.ga=uc||M.AFrameworkApplication.pa;this.Ta=od||M.AFrameworkApplication.Cb;this.Fu=Dc;this.Una=xb;this.tu=
Bb;this.PH=new ia;Dc?Dc.execute(Xb=>{Xb.isFeatureEnabled(Jb.YBn,!0).then(Cc=>{const {AggregatorResultsProvider:Bc}=b(1577);this.wlc=Cc;this.Una=this.Una||Bc.createInstance(this.UZ,this.wb,this.$Qa,this.wlc);return null})}):(this.wlc=!0,this.Una=this.Una||Wb.createInstance(this.UZ,this.wb,this.$Qa,this.wlc));this.qa=gc;this.qua=xa.Hud;this.uvg=new Promise(Xb=>{this.Kse=Xb});Ub&&Ub.execute(Xb=>{this.VV=Xb});this.wb.Jo&&A.a.pWh()&&(vb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.wb.application),
appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(vb,vb)))}eb(){this.lGj()}DSm(vb){this.okc=vb}lGj(){this.ga.Aa(ec.a.tellMe,Eb.a.frame,Object(k.a)(this,this.tellMe,"tellMe"),96);this.ga.Aa(ec.a.qXf,Eb.a.frame,Object(k.a)(this,this.TYg,"cacheAsyncMenuRefreshFunction"),96);this.ga.Aa(ec.a.vXf,Eb.a.frame,Object(k.a)(this,this.e1h,"logItemExecuted"),96);this.ga.Aa(ec.a.yXf,Eb.a.frame,Object(k.a)(this,this.B0h,"logControlDeactivation"),96);this.ga.Aa(ec.a.xXf,Eb.a.frame,Object(k.a)(this,
this.$0h,"logInputFocus"),96);this.ga.Aa(ec.a.tXf,Eb.a.frame,Object(k.a)(this,this.kXa,"interactionBegin"),96);this.ga.Aa(ec.a.AXf,Eb.a.frame,Object(k.a)(this,this.kXa,"interactionBegin"),96);this.ga.Aa(ec.a.wXf,Eb.a.frame,Object(k.a)(this,this.Z0h,"logInputBlur"),96);this.ga.Aa(ec.a.zXf,Eb.a.frame,Object(k.a)(this,this.A0h,"logControlActivated"),96);this.ga.Aa(ec.a.aYc,Eb.a.frame,Object(k.a)(this,this.snh,"focusSearchBox"),96);this.ga.Aa(ec.a.pXf,Eb.a.frame,Object(k.a)(this,this.K5g,"constructLiveNotificationForMenu"),
96);this.ga.Aa(ec.a.BXf,Eb.a.frame,Object(k.a)(this,this.Igf,"insertTryQuery"),96);this.ga.Aa(ec.a.wof,Eb.a.frame,Object(k.a)(this,this.Igf,"insertTryQuery"),96);this.ga.Aa(ec.a.G1e,Eb.a.frame,Object(k.a)(this,this.FLa,"openOrInsertUrl"),96);this.ga.Aa(ec.a.H1e,Eb.a.frame,Object(k.a)(this,this.FLa,"openOrInsertUrl"),96);this.ga.Aa(ec.a.I1e,Eb.a.frame,Object(k.a)(this,this.FLa,"openOrInsertUrl"),96);this.ga.Aa(ec.a.J1e,Eb.a.frame,Object(k.a)(this,this.FLa,"openOrInsertUrl"),96);this.ga.Aa(ec.a.K1e,
Eb.a.frame,Object(k.a)(this,this.FLa,"openOrInsertUrl"),96);this.ga.Aa(ec.a.jBf,Eb.a.frame,Object(k.a)(this,this.FLa,"openOrInsertUrl"),96);this.ga.Aa(ec.a.kBf,Eb.a.frame,Object(k.a)(this,this.FLa,"openOrInsertUrl"),96);this.ga.Aa(ec.a.lBf,Eb.a.frame,Object(k.a)(this,this.FLa,"openOrInsertUrl"),96);this.ga.Aa(ec.a.jDf,Eb.a.frame,Object(k.a)(this,this.gXa,"insertMention"),96);this.ga.Aa(ec.a.kDf,Eb.a.frame,Object(k.a)(this,this.gXa,"insertMention"),96);this.ga.Aa(ec.a.lDf,Eb.a.frame,Object(k.a)(this,
this.gXa,"insertMention"),96);this.ga.Aa(ec.a.sXf,Eb.a.frame,Object(k.a)(this,this.oei,"openFeedback"),96);this.ga.Aa(ec.a.CXf,Eb.a.frame,Object(k.a)(this,this.FLa,"openOrInsertUrl"),96);this.ga.Aa(ec.a.WIe,Eb.a.frame,Object(k.a)(this,this.sLd,"launchAddin"),96);this.ga.Aa(ec.a.XIe,Eb.a.frame,Object(k.a)(this,this.sLd,"launchAddin"),96);this.ga.Aa(ec.a.YIe,Eb.a.frame,Object(k.a)(this,this.sLd,"launchAddin"),96);this.ga.Aa(ec.a.ZGb,Eb.a.frame,Object(k.a)(this,this.ZGb,"showTellMeCoachmark"),96)}HQm(vb){this.Wad=
!1;const xb=window.performance.now();vb.Odb.isCompleted?(this.Wad=!0,this.Kse(!0)):vb.MQ(()=>{this.Wad=!0;this.Kse(!0);this.Pd.jA(z.a.fsk,window.performance.now()-xb)});this.tRm(vb)}tRm(vb){gb.a.kSc(Object(k.a)(this,this.rYe,"dispatcher"));gb.a.KAc([new lb.a(ec.a.tellMe,Eb.a.frame,96),new lb.a(ec.a.qXf,Eb.a.frame,96),new lb.a(ec.a.vXf,Eb.a.frame,96),new lb.a(ec.a.yXf,Eb.a.frame,96),new lb.a(ec.a.xXf,Eb.a.frame,96),new lb.a(ec.a.tXf,Eb.a.frame,96),new lb.a(ec.a.AXf,Eb.a.frame,96),new lb.a(ec.a.wXf,
Eb.a.frame,96),new lb.a(ec.a.zXf,Eb.a.frame,96),new lb.a(ec.a.aYc,Eb.a.frame,96),new lb.a(ec.a.pXf,Eb.a.frame,96),new lb.a(ec.a.BXf,Eb.a.frame,96),new lb.a(ec.a.wof,Eb.a.frame,96),new lb.a(ec.a.G1e,Eb.a.frame,96),new lb.a(ec.a.H1e,Eb.a.frame,96),new lb.a(ec.a.I1e,Eb.a.frame,96),new lb.a(ec.a.J1e,Eb.a.frame,96),new lb.a(ec.a.K1e,Eb.a.frame,96),new lb.a(ec.a.jBf,Eb.a.frame,96),new lb.a(ec.a.kBf,Eb.a.frame,96),new lb.a(ec.a.lBf,Eb.a.frame,96),new lb.a(ec.a.jDf,Eb.a.frame,96),new lb.a(ec.a.kDf,Eb.a.frame,
96),new lb.a(ec.a.lDf,Eb.a.frame,96),new lb.a(ec.a.sXf,Eb.a.frame,96),new lb.a(ec.a.CXf,Eb.a.frame,96),new lb.a(ec.a.WIe,Eb.a.frame,96),new lb.a(ec.a.XIe,Eb.a.frame,96),new lb.a(ec.a.YIe,Eb.a.frame,96),new lb.a(ec.a.ZGb,Eb.a.frame,96)],vb)}rYe(vb,xb,lc,Lc,uc){if(xb.contextId===Eb.a.frame)switch(vb){case ec.a.tellMe:return this.tellMe(vb,xb,lc,Lc,uc);case ec.a.qXf:return this.TYg(vb,xb,lc,Lc,uc);case ec.a.vXf:return this.e1h(vb,xb,lc,Lc,uc);case ec.a.yXf:return this.B0h(vb,xb,lc,Lc,uc);case ec.a.xXf:return this.$0h(vb,
xb,lc,Lc,uc);case ec.a.tXf:return this.kXa(vb,xb,lc,Lc,uc);case ec.a.AXf:return this.s3m(lc);case ec.a.wXf:return this.Z0h(vb,xb,lc,Lc,uc);case ec.a.zXf:return this.A0h(vb,xb,lc,Lc,uc);case ec.a.aYc:return this.snh(vb,xb,lc,Lc,uc);case ec.a.pXf:return this.K5g(vb,xb,lc,Lc,uc);case ec.a.BXf:case ec.a.wof:return this.Igf(vb,xb,lc,Lc,uc);case ec.a.G1e:case ec.a.H1e:case ec.a.I1e:case ec.a.J1e:case ec.a.K1e:case ec.a.jBf:case ec.a.kBf:case ec.a.lBf:case ec.a.CXf:return this.FLa(vb,xb,lc,Lc,uc);case ec.a.jDf:case ec.a.kDf:case ec.a.lDf:return this.gXa(vb,
xb,lc,Lc,uc);case ec.a.sXf:return this.oei(vb,xb,lc,Lc,uc);case ec.a.WIe:case ec.a.XIe:case ec.a.YIe:return this.sLd(vb,xb,lc,Lc,uc);case ec.a.ZGb:return this.ZGb(vb,xb,lc,Lc,uc)}return 2}snh(vb,xb,lc){if(1===lc)return 32;this.vDi();vb=!1;(this.wb.JNa||this.nQa)&&(xb=document.getElementById("SearchButton"))&&xb.click();if(!this.wb.JNa&&this.nQa)for(xb=document.getElementsByClassName("ms-suiteux-search-box"),lc=0;lc<xb.length;lc++){const Lc=xb[lc].querySelector("input[type=search]");Lc&&(vb=Ma.FocusManager.ZM(Lc))}else vb=
Ma.FocusManager.ZM($get(this.wb.Jo?w.CuiHelper.aUf:w.CuiHelper.O4d));this.olc=!0;return vb?32:8}Igf(vb,xb,lc,Lc,uc){if(1===lc)return 32;if(W.c(uc))return this.Pd.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.vDi();vb=uc.CommandValueId;xb=this.wb.Jo?w.CuiHelper.aUf:w.CuiHelper.O4d;this.wb.Jo&&!W.c(uc[ib.a.b0a])&&(uc[ib.a.b0a]=!1);if(vb){if(this.wb.Jo)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(vb)),this.T3a=[19],32;if(uc=$get(xb))uc.value=vb}return Ma.FocusManager.ZM($get(xb))?
32:8}vDi(){this.fb.NI(this.wb.JNa||this.nQa?this.wb.ryb:this.wb.s_a,!1)}dQk(vb,xb){switch(vb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,xb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,xb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,xb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,xb)}return xb}K5g(vb,xb,lc,Lc,uc){if(1===lc)return 32;
if(W.c(uc))return this.Pd.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;vb=this.qua?this.qua.Yui:0;uc.Value=1!==vb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,vb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.qua)for(const od of this.qua.dwk)uc=Object(f.a)(N.a,od)?od.id:fa.a.replaceAll(od.value,'"',""),(uc=$get(uc+"-"+A.a.rXf))&&Oa.a.wo(uc,Oa.a.oba,fa.a.Wd(this.dQk(od.groupType,uc.innerText)));return 32}TYg(vb,
xb,lc,Lc,uc){if(1===lc)return 32;if(W.c(uc))return this.Pd.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.BKb=new Rb.a(2,1,0,()=>{uc[cb.a.Callback]()},97);this.qua&&this.Ta.ub(this.BKb);return 32}e1h(vb,xb,lc,Lc,uc){if(1===lc)return 32;if(W.c(uc))return this.Pd.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;uc.CloseAllMenus&&(vb=void 0===uc.ParentControlId||null===uc.ParentControlId?"<NA>":uc.ParentControlId,xb=this.YKb?this.YKb[uc.ControlId]:
null,!xb&&this.YKb&&"<NA>"!==vb&&(xb=this.YKb[vb]),xb||(xb=this.sOb&&this.UZ.KIl(uc),xb=this.rtk(xb,uc.ControlId),xb=new r(xb,26,4,-1,-1,-1),this.Pd.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+uc.ControlId+" determined group:"+J.a[xb.groupType])),this.Pd.Rlm(uc.ControlId,vb,uc.CommandId,uc.CloseAllMenus,xb),this.$Qa.jim(uc.ControlId),uc.Location!==Fa.a.contextMenu&&(this.UZ.KGa(uc),this.UZ.ZH(xb.resultType),this.wb.I1d&&this.Una.cEj(uc.CommandId)));return 32}B0h(vb,xb,lc,Lc,
uc){if(1===lc)return 32;E.a.FTl()&&(new Ea(this.BCd())).Acl(this.GLb);vb=this.GLb;xb=this.Sna;lc=this.Pd.b4c;if(W.c(uc))return this.Pd.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;uc=uc.UILocation;vb&&0<vb.length&&this.wlc&&A.a.bSf(this.wb)&&this.wb.vKd&&19!==uc&&xb>lc&&!this.wb.GY&&(this.Pd.cqf(vb),this.Pd.zPf(xb));this.Pd.h2m();this.wb.N7d&&19!==uc&&(this.PH.mark(3),this.PH.measure(1,0,3),this.PH.measure(2,2,3),this.PH.Qpf(0,1,2),this.PH.Qpf(2,2,3),this.PH.Qpf(1,0,3),
this.PH.G6j(),this.PH.clearMeasures([0,2,1]));this.Pd.wmm(window.performance.now()-this.Dse);this.wb.Jo&&(this.o3a=null,this.Pd.Xra());this.olc=this.HNb=!1;this.GLb="";return 32}$0h(vb,xb,lc){if(1===lc)return 32;this.Pd.Ueb(m(xb),this.olc);return 32}Z0h(vb,xb,lc){if(1===lc)return 32;this.Pd.Xra();this.HNb=!1;return 32}A0h(vb,xb,lc,Lc,uc){if(1===lc)return 32;this.PW=null;uc&&(this.PW=uc);this.wb.N7d&&(W.c(this.PW)||this.PW.Location!==Fa.a.contextMenu)&&this.PH.mark(0);this.Pd.J0d(W.c(this.PW)||W.c(this.PW.Location)?
Fa.a.unknown:this.PW.Location);this.Pd.vmm(this.Vug,this.olc);this.HNb||this.iZa();return 32}R8g(vb,xb){const lc=[],Lc=Date.now();for(let uc of vb)vb=(Lc-uc.timeStamp)/1E3,vb=A.a.kZf(vb),Array.add(lc,new V(xb?uc.commandId:uc.controlId,vb));return lc}x9g(vb=!1){var xb=vb?this.UZ.ucl():this.UZ.fDc();vb=[];const lc=Date.now();for(const Lc of xb)xb=(lc-Lc.TimeStamp)/1E3,xb=A.a.kZf(xb),Array.add(vb,new V(Lc.Id,xb));return vb}iZa(){if(!this.HNb){this.sOb=this.HNb=!0;""!==this.wb.aOf&&M.AFrameworkApplication.Bh(this.wb.aOf);
if(!this.Bqg){this.Bqg=!0;const vb={};vb.IsMLREnabled=this.wb.pOl;vb.IsReactRibbonEnabled=this.wb.Jo;vb.IsSharedHeaderEnabled=!!M.AFrameworkApplication.na&&M.AFrameworkApplication.na.Ya.WG;vb.IsSearchUxEnabled=this.nQa;vb.IsTellMeInHeaderEnabled=this.wb.JNa;vb.IsGoLocalEnv=A.a.DSh();vb.IsSovereignEnvironment=A.a.wAb();vb.IsTellMeServiceResultsEnabled=A.a.bSf(this.wb);vb.IsSubstrateProviderEnabled=A.a.aSf(this.wb);vb.ShouldFetchTokens=!!M.AFrameworkApplication.na&&M.AFrameworkApplication.na.Ya.AGb;
vb.IsSerpletEnabled=A.a.aAa();vb.FirstOnClickTimeInMS=Math.round(window.performance.now());vb.IsHeaderHidden=M.AFrameworkApplication.hideHeader||M.AFrameworkApplication.BR;vb.IsSearchInHeaderHidden=M.AFrameworkApplication.oGc;void 0!==window.performance.timing&&null!==window.performance.timing&&(vb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));vb.IsFindWithMatchesEnabled=this.wb.Gwd;vb.HelpShowsTopSearchResult=this.wb.eWc;vb.HelpShowsNumberOfMatches=this.wb.dWc;
M.AFrameworkApplication.K&&(vb.UiHost=M.AFrameworkApplication.K.Ga("UiHostIntegrationType"));this.Pd.A7l(JSON.stringify(vb))}this.Tde=this.R8g(u.a.instance.vZb(),!1);this.tcg=this.R8g(u.a.instance.twb(),!0);this.Kvg=this.x9g();this.Lvg=this.x9g(!0);this.Pd.iZa()}}kXa(vb,xb,lc,Lc,uc){if(1===lc)return 32;if(W.c(uc))return this.Pd.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Nb.a.Wza)return 32;this.Dse=window.performance.now();this.iZa();vb=new ca(Object(k.a)(this,this.$ra,"onRequestCompleted"),
0);this.Sna++;this.Pd.beginQuery("",this.Sna,this.sOb);this.qua=xa.Hud;this.o3a=ja.i_e;if(this.Una)Jb.instance.actions=[],this.Una.qK(new O("",this.Sna),vb,this.wb.Jo);else this.Pd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.BKb&&this.Ta.ub(this.BKb);return 32}s3m(vb){if(1===vb)return 32;this.fb.gP(this.wb.JNa||this.nQa?this.wb.ryb:this.wb.s_a,!1);return 32}tellMe(vb,xb,lc,Lc,uc){if(1===lc)return 32;if(W.c(uc))return this.Pd.onError("TellMeActor:TellMe","actiondata comes null"),
16;this.PW=uc;this.Pd.J0d(W.c(this.PW.Location)?Fa.a.unknown:this.PW.Location);vb=this.PW.Value;this.wb.Jo||vb&&""!==vb.trim()?(!this.o3a&&this.wb.Jo&&(this.Pd.Ueb(m(xb),this.olc),this.iZa()),this.fEk(vb,this.PW.Location),this.PW.PopulationXML=this.qua.xml):this.sOb?this.PW.PopulationXML=this.qua.xml:(this.PW.PopulationXML=xa.Hud.xml,this.o3a=ja.i_e,this.GLb="");return 32}fEk(vb,xb){this.Dse=window.performance.now();this.wb.N7d&&xb!==Fa.a.contextMenu&&this.PH.mark(1);this.wb.Jo&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(vb));
vb&&0<vb.trim().length&&(this.sOb=!1);this.wb.KCk();xb=W.c(xb)?Fa.a.tellMe:xb;if(vb!==this.GLb||this.wb.Jo){this.Sna++;this.Pd.beginQuery(vb,this.Sna,this.sOb);const lc=new O(vb,this.Sna),Lc=new ca(Object(k.a)(this,this.$ra,"onRequestCompleted"),this.Sna);this.qua=xa.Hud;this.o3a=ja.i_e;if(this.Una)Jb.instance.actions=[],this.Una.qK(lc,Lc,this.wb.Jo,xb,this.T3a),this.T3a=null;else this.Pd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.Vug=this.Sna;this.GLb=vb}}NOn(vb){if(this.wb.Jo){var xb=
appChrome.selectors.getActiveControlStates();if(xb=Object(x.a)(Object,xb[vb.value])){vb.label=xb.label;let lc=null;"description"in xb&&(lc=xb.description);lc&&Object.getType(lc)===String?vb.description=lc:"secondaryText"in xb?vb.description=xb.secondaryText:"fullDescriptionLabel"in xb&&(vb.description=xb.fullDescriptionLabel)}}}WBm(vb){this.YKb={};let xb=0,lc=0;for(const Lc of vb){vb=0;for(const uc of Lc.results)this.YKb[uc.value]=new r(uc.groupType,uc.type,uc.VLi,xb,vb,lc),vb++,lc++,uc.label||5!==
uc.type||this.NOn(uc);0<vb&&xb++}}Z6b(vb,xb,lc,Lc,uc){if(1===lc)return 32;if(W.c(uc))return this.Pd.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(vb=uc.CommandValueId)&&window.open(vb,"_blank");return 32}gXa(vb,xb,lc,Lc,uc){if(1===lc)return 32;if(W.c(uc))return this.Pd.onError("TellMeActor:InsertMention","actiondata comes null"),16;vb=uc.UILocation;let od;uc=uc.CommandValueId;try{od=pa.a(uc)}catch(Cb){return this.Pd.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),
16}return W.c(od)?(this.Pd.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):W.c(this.okc)?(this.Pd.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==vb?(this.Pd.onError("TellMeActor:InsertMention","location "+vb+" is unexpected"),16):this.okc.gXa(od.displayName,od.email,od.userId)?32:(this.Pd.onError("TellMeActor:InsertMention","mention is not inserted"),16)}FLa(vb,xb,lc,Lc,uc){return 1===lc?32:W.c(uc)?(this.Pd.onError("TellMeActor:OpenOrInsertUrl",
"actiondata comes null"),16):19===uc.UILocation?this.nEl(lc,uc):this.Z6b(vb,xb,lc,Lc,uc)}oei(vb,xb,lc,Lc,uc){if(1===lc)return 32;if(W.c(uc))return this.Pd.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.tu&&this.tu.execute(od=>{od.Dhb("TellMeSurvey",null)});return 32}nEl(vb,xb){if(1===vb)return 32;if(W.c(xb))return this.Pd.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(W.c(this.okc))return this.Pd.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),
16;vb=xb.CommandValueId;return W.c(vb)?(this.Pd.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.okc.insertHtmlText(vb)?32:(this.Pd.onError("TellMeActor:InsertUrl","url is not inserted"),16)}$ra(vb,xb,lc,Lc,uc){lc=window.performance.now();this.WBm(xb);this.Pd.Jfn(xb);this.wb.Jo?(this.o3a=this.vse.CPk(xb,vb,uc),this.wb.uWa?(this.WV.push(appChrome.actions.updateTellMeSearchResults(this.o3a.menuModel,vb,uc)),appChrome.api.dispatch(this.WV)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.o3a.menuModel,
vb,uc)),this.wb.N7d&&this.HNb&&(W.c(this.PW)||this.PW.Location!==Fa.a.contextMenu)&&(this.PH.mark(2),this.PH.measure(0,1,2))):this.qua=this.RLg.DPk(xb,this.Pd.aea);this.BKb&&this.Ta.ub(this.BKb);uc={};uc.GroupsCount=xb.length;uc.QueryID=Lc;uc.QueryLength=vb.length;this.Pd.jA(z.a.olk,window.performance.now()-lc,uc)}rtk(vb,xb){return xb.startsWith(this.wb.Jo?A.a.KZf:A.a.p6d)?5:vb?4:"bSearchHelp"===xb||xb.startsWith("GetHelpFromTellMe")?8:"bInsights"===xb||xb.startsWith("SmartLookupFromTellMe")?13:xb===
this.wb.Y1e?2:0}ZH(vb,xb){this.Una&&this.Una.ZH(vb,xb)}sLd(vb,xb,lc,Lc,uc){({AddinResultsProvider:vb}=b(1470));uc=uc.CommandValueId;if(W.b(uc))return this.Pd.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!vb.fsb[uc])return this.Pd.onError("TellMeActor:LaunchAddin","Add-in with assetId "+uc+" doesn't not exist in entitlements"),16;vb=b(1470).AddinResultsProvider.fsb[uc];xb={};xb.solutionId=vb.id;xb.assetId=vb.assetId;xb.appVersion=vb.appVersion;xb.storeId=vb.storeId;xb.assetStoreId=
vb.assetStoreId;xb.displayName=vb.displayName;xb.assetStoreId=vb.assetStoreId;xb.targetType=vb.targetType;xb.height=vb.height;xb.width=vb.width;xb.storeType=vb.storeType;vb=this.ga.hb(ec.a.tgf,2,xb);if(32!==vb)this.Pd.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+vb+". AssetId: "+uc);return vb}ZGb(){if(!W.c(this.tu))for(let vb of u.a.instance.twb()){if("ShowContextMenuWithFloatie"===vb.commandId)return this.tu.execute(xb=>{xb.logActivity("TellMe1TabSwitchCoachMarkActivity",
null)}),32;if(vb.commandId&&-1===vb.commandId.indexOf("Tab"))break}return 8}static get instance(){return Jb._instance||(Jb._instance=new Jb)}}Jb._instance=null;Jb.YBn="mso_tellMeService";Jb.unknown="Unknown";Object(G.a)(Jb,"TellMeActor",null,[])},1298:function(G,P,b){b.d(P,"a",function(){return f});G=b(0);var k=b(1315);class f{constructor(x,u){this.X4a=!1;const {Annotations:w}=b(1292);if(!x)throw Error.argumentNull("annotations");if(!x.Nmf(u))throw Error.argument("memberTypeID","Invalid type ID");
if(w.UF(u))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.Au=x;this.Bmj=u;this.Tn=[]}get OTb(){return this.Au}get isReadOnly(){return this.X4a}get R0(){return this.Bmj}get items(){return this.Tn}I$(){const {Annotations:x}=b(1292);let u="[";for(let w=0,r=this.items.length;w<r;++w){0<w&&(u+=", ");const m=this.Au.I$(this.R0,this.items[w]);this.R0===x.M5?(u+='"',u+=k.a.x0e(m),u+='"'):u+=m}return u+"]"}isEqual(x){const {Annotations:u}=b(1292);if(this===x)return!0;if(!x||x.OTb!==
this.Au||x.R0!==this.R0||x.items.length!==this.items.length)return!1;for(let w=0;w<this.items.length;++w)if(!u.sjb(this.R0,this.items[w],x.items[w]))return!1;return!0}clone(){const x=new f(this.Au,this.R0);Array.addRange(x.items,this.items);return x}TQ(){return this.isReadOnly?this.clone():this}tpf(){const {Annotations:x}=b(1292);if(!this.isReadOnly){this.X4a=!0;for(const u of this.items)x.zBb(u)}}toString(){return this.I$()}}Object(G.a)(f,"ListValue",null,[1155,1154])},1301:function(G,P,b){b.d(P,
"a",function(){return k});G=b(0);class k{}k.tellMe="TellMe";k.contextMenu="ContextMenu";k.unknown="Unknown";Object(G.a)(k,"TellMeScenario",null,[])},1302:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(f,x,u=null,w=null,r=4,m=-99999,l=0){this.qG="";this.Kld=-1;this.value=f;this.type=x;this.VLi=r;this.label=this.mA=u;this.groupType=25;this.description=w;this.score=m;this.count=l}}Object(G.a)(k,"ResultBinding",null,[])},1308:function(G,P,b){b.d(P,"a",function(){return k});
G=b(0);class k{constructor(f){this.attributes=null;this.query=f;this.Am=[]}kw(f){this.Am.push(f)}Wqi(f){const x=[];for(const u of this.Am)u.groupType!==f&&x.push(u);this.Am.length!==x.length&&(this.Am=x)}get f3b(){return!1}}Object(G.a)(k,"SimpleResultsUpdatedEventArgs",null,[1019])},1309:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(f=25,x=""){this.Bs=[];this.groupType=f;this.displayName=x}get results(){return this.Bs}Xw(f){f.groupType=this.groupType;Array.add(this.results,
f)}nKf(f=1){if(this.results.length>=f)for(let x=0;x<f;x++)Array.removeAt(this.results,this.results.length-1)}}Object(G.a)(k,"SimpleResultGroup",null,[1020])},1315:function(G,P,b){G=b(0);class k{constructor(x,u){this.j8a=x;this.value=u}}Object(G.a)(k,"AttrValuePair",null,[]);b.d(P,"a",function(){return f});class f{constructor(x){this.X4a=!1;if(!x)throw Error.argumentNull("annotations");this.Au=x;this.nV=[]}get OTb(){return this.Au}get isReadOnly(){return this.X4a}get Kcf(){return 0<this.nV.length}Ro(x){if(!this.Au.P3b(x))throw Error.argument("attributeID",
"Invalid attribute ID");for(const u of this.nV)if(x===u.j8a)return x=u.value,{returnValue:!0,value:x};return{returnValue:!1,value:null}}Dw(x,u){var {Annotations:w}=b(1292);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Au.P3b(x))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Au.M2b(this.Au.getAttributeType(x),u))throw Error.argument("value","Value is not of the correct type for the specified attribute");w.zBb(u);
for(w=0;w<this.nV.length;++w){const r=this.nV[w];if(x===r.j8a){r.value=u;return}}Array.add(this.nV,new k(x,u))}sMa(x){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Au.P3b(x))throw Error.argument("attributeID","Invalid attribute ID");for(let u=0;u<this.nV.length;++u)if(x===this.nV[u].j8a){Array.removeAt(this.nV,u);break}}yxd(x){if(!x)throw Error.argumentNull("action");for(const u of this.nV)x(u.j8a,u.value)}clone(){const x=new f(this.Au);
x.VTa(this);return x}VTa(x){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!x)throw Error.argumentNull("other");if(x.OTb!==this.Au)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.nV);x.yxd((u,w)=>{this.Dw(u,w)})}I$(){const {Annotations:x}=b(1292);let u="[",w=!0;for(const r of this.nV){w?w=!1:u+=", ";u+=this.Au.uqh(r.j8a);u+="=";const m=this.Au.getAttributeType(r.j8a),l=this.Au.I$(m,r.value);m===x.M5?(u+='"',
u+=f.x0e(l),u+='"'):u+=l}return u+"]"}isEqual(x){const {Annotations:u}=b(1292);if(!x)throw Error.argumentNull("other");if(this===x)return!0;if(!x||this.Au!==x.OTb||this.Kcf!==x.Kcf)return!1;let w=0,r=null,m=!1;x.yxd((l,z)=>{++w;if(!m){var F=-1;for(let L=0,E=this.nV.length;L<E;++L)if(this.nV[L].j8a===l){F=L;break}0>F?m=!0:(r||(r=Array(this.nV.length)),r[F]=z)}});if(this.nV.length!==w||m)return!1;for(let l=0,z=this.nV.length;l<z;++l)if(!u.sjb(this.Au.getAttributeType(this.nV[l].j8a),this.nV[l].value,
r[l]))return!1;return!0}TQ(){return this.isReadOnly?this.clone():this}tpf(){const {Annotations:x}=b(1292);if(!this.isReadOnly){this.X4a=!0;for(const u of this.nV)x.zBb(u.value)}}toString(){return this.I$()}static x0e(x){return x.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(G.a)(f,"FeatureBundle",null,[1153,1154])},1325:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{}k.click="Click";k.kXa="InteractionBegin";k.szb="InteractionEnd";k.I6g="ControlActivated";
k.query="Query";k.mli="QueryIndexRecorded";k.Q3g="Clicks";k.tMg="ActionEvents";k.llh="FilteredActionEvents";k.Mzi="SessionContext";k.latency="Latency";k.performance="Performance";k.Isi="RenderedResults";k.events="Events";k.olk="CreateResultsMenu";k.xE="UpdateRibbonControls";k.L3m="ResultsAggregation";k.qK="IssueQuery";k.W9j="CommandSuggestions";k.error="Error";k.fpf="LoadModelData";k.fsk="DepsResolveTime";k.tem="ModelDataWaitTime";k.timedOut="TimedOut";k.fKj="AddinQueryCommandReady";k.EQk="GetAddinEntitlements";
k.Hki="ProviderMRUEvents";Object(G.a)(k,"EventNames",null,[])},1331:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(){this.Tqf=null;this.n9=this.Vqf=0}V3e(f,x,u){if(!f)throw Error.argumentNull("referenceList");if(0>x||x>f.length)throw Error.argumentOutOfRange("startIndex");if(0>u||u>f.length)throw Error.argumentOutOfRange("length");if(x+u>f.length)throw Error.argument("Invalid start-length range");this.Tqf=f;this.Vqf=x;this.n9=u}aab(f,x,u){this.V3e(f.Tqf,f.Vqf+x,u)}J(f){if(0>
f||f>=this.n9)throw Error.argumentOutOfRange("index");return this.Tqf[this.Vqf+f]}get count(){return this.n9}static DUe(f){const x=new k;x.V3e(f,0,f.length);return x}}Object(G.a)(k,"ReadOnlyList",null,[1173])},1337:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);var k;(function(f){f[f.Classifier=0]="Classifier";f[f.AppsForOffice=1]="AppsForOffice";f[f.FindInDocument=2]="FindInDocument";f[f.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";f[f.RecentlyUsed=4]="RecentlyUsed";f[f.TryQuery=
5]="TryQuery";f[f.Empty=6]="Empty";f[f.TryCommand=7]="TryCommand";f[f.Assistance=8]="Assistance";f[f.Answer=9]="Answer";f[f.Definition=10]="Definition";f[f.Entity=11]="Entity";f[f.WolframAnswer=12]="WolframAnswer";f[f.Insights=13]="Insights";f[f.People=14]="People";f[f.Document=15]="Document";f[f.Recommended=16]="Recommended";f[f.ServiceClassifier=17]="ServiceClassifier";f[f.ServiceRecommended=18]="ServiceRecommended";f[f.Image=19]="Image";f[f.Notes=20]="Notes";f[f.Learning=21]="Learning";f[f.Feedback=
22]="Feedback";f[f.Template=23]="Template";f[f.Addin=24]="Addin";f[f.None=25]="None";f[f.MergedActions=26]="MergedActions";f[f.MergedScopedSearches=27]="MergedScopedSearches";f[f.MergedSuggestedSearches=28]="MergedSuggestedSearches"})(k||(k={}));Object(G.b)("ResultGroupType",k)},1343:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1398);class k extends b.a{constructor(){super();this.info=this.Ph=this.eventId=null}get gca(){return"Misc"}Wwb(){this.detail.Z("Type",this.gca);this.detail.Z("EventId",
this.eventId);this.detail.Z("Func",this.Ph);this.detail.Z("Info",this.info);return this.detail}}Object(G.a)(k,"BasicMergeFailureDetail",b.a,[])},1344:function(G,P,b){b.d(P,"a",function(){return u});G=b(0);var k=b(574),f=b(724),x=b(1361);class u{constructor(w,r=!0){this.ik=r&&w?w.dF():w;this.gSb=new k.a}Kz(w){this.gSb.add(f.a.Ha(w))}Pjn(w){this.gSb=w}m5h(w){this.ik&&(new x.a(this.ik,w)).L9.forEach((r,m)=>{m.GO&&!this.gSb.contains(r)&&(this.gSb.add(r),m.isDeleted?(m=this.ik,m.hasProperty(f.a.lO(r))&&
m.removeProperty(f.a.lO(r))):this.ik.b$(f.a.lO(r),m.newValue));return!0})}}Object(G.a)(u,"PartialMergeResult",null,[])},1345:function(G,P,b){b.r(P);b.d(P,"CommandResultsUtility",function(){return z});G=b(0);var k=b(1362),f=b(1325),x=b(1363),u=b(1302),w=b(1309),r=b(1297),m=b(1296),l=b(2);class z{static vZc(F,L){if(L&&L.Jo){const E={};for(const A of F)L.KKd(A)&&(E[A]=appChrome.selectors.getModelType(A));r.TellMeActor.instance.xE(E)}}static lCn(F){return F.startsWith("btnTellMeOfficeAddIn")}static AIc(F){const L=
r.TellMeActor.instance.oM();return!!L&&L.Jo&&!appChrome.selectors.isControlDisabled(F)}static cNd(F,L,E,A){if(r.TellMeActor.instance.Pd&&F){const M=[];for(const Q of F)M.push(String.format('{{"Id":"{0}","Score":{1}}}',Q.commandId,Q.score));F={};F[k.a.suggestions]="[{"+M.join(",")+"}]";F[k.a.tYh]=L;F[k.a.groupType]=E;F[k.a.provider]=A;r.TellMeActor.instance.Pd.jA(f.a.W9j,window.performance.now(),F)}}static ZWk(F,L){const E=[],A=[];for(const M of L){L=M.commandId;let Q=M;M.commandId in F&&(L=F[M.commandId],
Q=new x.a(L,M.score));Array.contains(A,L)||(E.push(Q),A.push(L))}return E}static NBd(F,L,E,A,M,Q,R){L.z6e&&(F=z.ZWk(L.z6e,F));var K=m.a.pVk(F);z.vZc(K,L);var J=[],O=[];K=[];const N=new w.a(Q);Q=16===Q||18===Q||7===Q||4===Q?l.AFrameworkApplication.K?l.AFrameworkApplication.K.vb("TellMeMaxRecommendedResultsToReturn",3):3:0===Q||17===Q?5:0;for(const V of F)if(!z.IIl(V.commandId)){F=z.lCn(V.commandId);if(L.KKd(V.commandId)&&!F){if(m.a.sXh(V.commandId))continue;F=null;A&&M&&(F=A.hal(V.commandId,M));z.AIc(V.commandId)?
Array.add(J,new u.a(V.commandId,5,F,null,R,V.score)):Array.add(O,new u.a(V.commandId,5,F,null,R,V.score))}else L.$Sa&&F&&E&&Array.add(K,V.commandId.substr(21));if(J.length+K.length>=Q)break}L=0;for(A=0;A<J.length&&L<Q;A++,L++)N.Xw(J[A]);for(J=0;J<O.length&&L<Q;J++,L++)N.Xw(O[J]);for(O=0;O<K.length&&L<Q;O++,L++)E.EQn(K[O],N);return N}static IIl(F){z.gWg||(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.hF("TellMeControlPredictionBlockList")&&(z.fWg=l.AFrameworkApplication.K.bB("TellMeControlPredictionBlockList")),
z.gWg=!0);return Array.contains(z.fWg,F.toLowerCase())}static Phf(F){return 2<F.length&&";"===F.charAt(0)&&";"===F.charAt(F.length-1)&&!!l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static msh(F){const L=new w.a(0);var E=F.split(";");F=r.TellMeActor.instance.oM();for(const A of E)if(0<A.length){E=A.split(":");const M=2===E.length?E[0]:A;if(!F.KKd(M))break;
if(1===E.length)E=new u.a(M,5,null,null,1),L.Xw(E);else if(2===E.length)E=new u.a(M,5,E[1],null,1),L.Xw(E);else break}return L}static IDj(F,L,E){if(!(L&&L.results&&F&&F.results&&F.results.length))return{returnValue:!1,sHe:F,eIe:L};const A=[];for(var M of L.results)Array.add(A,M.value);M=0;const Q=0<L.results.length?L.results[0].score:0;for(const R of F.results)if(R.score>E&&!Array.contains(A,R.value)&&z.AIc(R.value)&&(0<Q&&(R.score=Q),Array.insert(L.results,M,R),M++),2===M)break;return 0<M?(E=L.results.length-
5,0<E&&L.nKf(E),{returnValue:!0,sHe:F,eIe:L}):{returnValue:!1,sHe:F,eIe:L}}}z.gWg=!1;z.fWg=[];Object(G.a)(z,"CommandResultsUtility",null,[])},1360:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{static ODn(f){return f.toString().charCodeAt(0)}static fTl(f){return 55296<=f&&57343>=f}static charAt(f,x){return f.charAt(x)}static cUg(f,x){if(f===x)return!0;"\u00a0"===f&&(f=" ");"\u00a0"===x&&(x=" ");return f===x}static bUg(f,x){if(f===x)return!0;if(!f||!x||f.length!==x.length)return!1;
f=k.Ssi(f);x=k.Ssi(x);return f===x}static Ssi(f){return f.replace(k.KMc," ")}static Whb(f,x,u){return f.substring(x,x+u)}}k.KMc=RegExp("\u00a0","g");Object(G.a)(k,"CharUtils",null,[])},1361:function(G,P,b){b.d(P,"a",function(){return r});G=b(0);var k=b(366),f=b(724),x=b(231),u=b(41),w=b(1546);class r{constructor(m,l){this.Mnj=m;this.jnj=l;this.ine=new x.a(()=>this.LIc());this.trj=new x.a(Object(u.a)(this,this.vDk,"evaluatePropertyDiffs"))}get ns(){return this.Mnj}get Zd(){return this.jnj}get vcb(){return!!this.Zd&&
!this.ns}get isDeleted(){return!this.Zd&&!!this.ns}get GO(){return this.vcb||this.isDeleted||this.ine.value}get L9(){return this.trj.value}LIc(m=null){let l=!1;this.L9.forEach((z,F)=>{l=F.GO&&(!m||7!==m.J(z));return!l});return l}vDk(){const m=new k.a;var l=this.Zd,z=this.ns;if(this.vcb){z=l.zi();for(var F=0;F<z.length;F++){var L=z[F];m.Z(f.a.Ha(L),new w.a(L,null,l.PG(L)))}}else if(this.isDeleted)for(l=z.zi(),F=0;F<l.length;F++)L=l[F],m.Z(f.a.Ha(L),new w.a(L,z.PG(L),null));else{F=z.zi();for(L=0;L<
F.length;L++){var E=F[L],A=f.a.Ha(E),M=z.PG(E);const Q=l.hasProperty(E)?l.PG(E):null;m.Z(A,new w.a(E,M,Q))}F=l.zi();for(L=0;L<F.length;L++)E=F[L],z.hasProperty(E)||(A=f.a.Ha(E),M=l.PG(E),m.Z(A,new w.a(E,null,M)))}return m}}Object(G.a)(r,"MergeableObjectDiff",null,[])},1362:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{}k.appName="AppName";k.Cba="CloseAllMenus";k.commandId="CommandId";k.context="Context";k.culture="Culture";k.message="Message";k.errorMessage="ErrorMessage";k.event=
"Event";k.Nca="CorrelationID";k.Gym="ParentUiElement";k.query="Input";k.hEb="QueryID";k.rli="QueryLength";k.k8b="QueryIndex";k.M3m="ResultsList";k.suggestions="Suggestions";k.scenario="Scenario";k.sessionId="SessionID";k.source="Source";k.timeStamp="Time";k.iSi="UiElement";k.jXd="ReactUx";k.value="Val";k.statusCode="StatusCode";k.bbn="Service";k.isSuccess="IsSuccess";k.xEn="TokenAcquired";k.uXl="LatencyType";k.groupName="GroupName";k.e4="GroupIndex";k.groupType="GroupType";k.H3m="ResultInfoList";
k.resultType="ResultType";k.KVf="SubResultType";k.RMl="IsInputBlur";k.SMl="IsInputFocus";k.qSl="IsShortCutUsed";k.actionType="ActionType";k.count="Count";k.Lyk="DwellTime";k.tYh="IsZeroTerm";k.vZn="WordsCount";k.ZJd="IsSearchUxEnabled";k.DTl="IsTellMeInHeaderEnabled";k.module="Module";k.resultIndex="ResultIndex";k.vYe="DisplayIndex";k.wAk="EnableList";k.provider="Provider";k.contentType="ContentType";k.SRl="IsSelectionBased";k.gTj="BeginPerformanceMarker";k.SAk="EndPerformanceMarker";k.AAm="PerformanceMeasure";
Object(G.a)(k,"Columns",null,[])},1363:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(f,x){this.commandId=f;this.score=x}}Object(G.a)(k,"CommandSuggestion",null,[])},1375:function(G,P,b){b.d(P,"b",function(){return w});b.d(P,"a",function(){return m});var k=b(202),f=b(366),x=b(574),u=b(1547);const w=(z,F,L)=>{const E=r(z,F,L);let A=0,M=0,Q=0,R=new u.a;const K=new k.a;for(let J=0;J<E.length;J++){const O=E.Ye(J+1);R.bmd(z.Ye(A));R.emd(F.Ye(M));R.jmd(L.Ye(Q));A++;M++;for(Q++;A<
z.length&&(!O||!O.equals(z.Ye(A)));)R.bmd(z.Ye(A)),A++;for(;M<F.length&&(!O||!O.equals(F.Ye(M)));)R.emd(F.Ye(M)),M++;for(;Q<L.length&&(!O||!O.equals(L.Ye(Q)));)R.jmd(L.Ye(Q)),Q++;K.add(R);R=new u.a}for(;A<z.length;)R.bmd(z.Ye(A)),A++;for(;M<F.length;)R.emd(F.Ye(M)),M++;for(;Q<L.length;)R.jmd(L.Ye(Q)),Q++;R.isEmpty||K.add(R);return K},r=(z,F,L)=>{const E=new k.a,A=F.yz(),M=L.yz();z.forEach(Q=>{A.contains(Q)&&M.contains(Q)&&E.add(Q);return!0});return E},m=(z,F,L)=>{z=z||new k.a;F=F||new k.a;L=L||new k.a;
const E=new k.a,A=new f.a(0),M=new x.a;for(var Q=0;Q<z.length;Q++){var R=z.Ye(Q);A.Z(R,Q)}for(z=Q=0;Q<F.length&&z<L.length;){R=F.Ye(Q);let K=L.Ye(z),J=A.ax(R,-1),O=A.ax(K,-1);-1===J?(l(M,E,R),Q++):-1===O?(l(M,E,K),z++):J===O?(l(M,E,R),Q++,z++):J<O?Q++:z++}for(;Q<F.length;Q++)R=F.Ye(Q),-1===A.ax(R,-1)&&l(M,E,R);for(;z<L.length;z++)F=L.Ye(z),-1===A.ax(F,-1)&&l(M,E,F);return E},l=(z,F,L)=>{z.contains(L)||(F.add(L),z.add(L))}},1376:function(G,P,b){b.d(P,"a",function(){return f});G=b(0);var k=b(51);class f{constructor(){this.cp=
0;this.id=k.a.create()}}Object(G.a)(f,"LcsUpdateHint",null,[1202,277])},1377:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{}k.tellMe="TellMe";k.loki="Loki";k.substrate="Substrate";k.k8b="QueryIndex";k.INi="TellMeRanker";k.JNi="TellMeRankerLogging";Object(G.a)(k,"Services",null,[])},1378:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{}k.DJa="HttpRequest";k.provider="Provider";Object(G.a)(k,"LatencyTypes",null,[])},1381:function(G,P,b){G=b(0);var k=b(17),f=b(6),x=b(202),
u=b(143),w=b(191),r=b(51),m=b(574),l=b(41),z=b(237),F=b(1398);class L extends F.a{constructor(){super();this.nFb=null}get gca(){return"CreateMergeBlock"}Wwb(){this.detail.Z("Type",this.gca);this.detail.Z("Revision",this.nFb);return this.detail}}Object(G.a)(L,"CreateMergeBlockFailureDetail",F.a,[]);var E=b(1451),A=b(1453),M=b(1545),Q=b(1399),R=b(1344),K=b(1600);b.d(P,"a",function(){return J});class J{static Krd(O,N,V,W,ca,H,Z){let aa;aa="";const ja=new x.a;for(let la=0;la<V.length;la++){var Ba=void 0;
let ia;Ba=E.a.rXk(N,V.J(la),W,ca,H,Z,O);if(!Ba)return{returnValue:null,JYa:aa};({Xrf:ia,JYa:Ba}=Ba.kyh());if(!ia)return{returnValue:null,JYa:aa};aa+=Ba;ja.ez(ja.length,ia)}return{returnValue:ja,JYa:aa}}static A9g(O,N,V,W,ca,H,Z,aa){let ja,Ba,la,ia,oa,ha;ha=oa=ia=la=Ba=ja=null;({JYa:ia,returnValue:ja}=J.Krd(N,pa=>O.runtime.Ci.J(pa),V,1,H,Z,aa));if(!ja)return u.a.instance.ua(17044299,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for base revision"),
O.logger.Cf(Object.assign(new L,{nFb:"Base"})),{returnValue:!1,bI:ja,qBc:Ba,oZc:la,Xmd:ia,lwd:oa,J6d:ha};({JYa:oa,returnValue:Ba}=J.Krd(N,pa=>O.runtime.xr.J(pa)||O.runtime.Ci.J(pa),W,2,H,Z,aa));if(!Ba)return u.a.instance.ua(17044300,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for favoured revision"),O.logger.Cf(Object.assign(new L,{nFb:"Favored"})),{returnValue:!1,bI:ja,qBc:Ba,oZc:la,Xmd:ia,lwd:oa,J6d:ha};({JYa:ha,returnValue:la}=
J.Krd(N,pa=>O.runtime.So.J(pa)||O.runtime.Ci.J(pa),ca,4,H,Z,aa));return la?{returnValue:!0,bI:ja,qBc:Ba,oZc:la,Xmd:ia,lwd:oa,J6d:ha}:(u.a.instance.ua(17044301,1,1,"ParagraphMergeUtils:CreateMergeBlocksForMergeInputObjects returned failure as we were unable to create merge blocks for unfavoured revision"),O.logger.Cf(Object.assign(new L,{nFb:"Unfavored"})),{returnValue:!1,bI:ja,qBc:Ba,oZc:la,Xmd:ia,lwd:oa,J6d:ha})}static O3g(O,N=!1){const V=new x.a;let W=0;for(;W<O.length;){var ca=O.J(W);if(1===ca.type||
4===ca.type||2===ca.type)V.add(ca),W++;else if(3===ca.type){let Z="";Z+=ca.character;W++;let aa=ca.pKa,ja=!1;for(;W<O.length;W++){var H=O.J(W);3===H.type?ca.runId===H.runId&&ca.KG.equals(H.KG)&&(ca.C8===H.C8||ca.Wya===H.Wya)&&ca.HC.oy(H.HC)&&(!N||ca.ur&&ca.ur.equals(H.ur))?(Z+=H.character,H.pKa&&(aa=!0)):ja=!0:ja=!0;if(ja){ca=new K.a(null,ca.source,ca.oi,ca.qf,ca.runId,ca.KG,Z,ca.yeb,!0,aa,ca.C8,ca.Wya,ca.bMa,ca.HC,ca.ur);V.add(ca);break}}}}u.a.instance.ua(17044302,1,3,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
V.xp());return V}static N9j(O,N=!1){const V=new x.a;let W=0;for(;W<O.length;){var ca=O.J(W);if(1===ca.type||4===ca.type||2===ca.type)V.add(ca),W++;else if(3===ca.type){let Z=ca.character.toString();W++;let aa=ca.pKa;for(;W<O.length;W++){var H=O.J(W);if(3===H.type&&J.Cnn(ca,H,N))Z+=H.character,H.pKa&&(aa=!0);else break}ca=new K.a(null,ca.source,ca.oi,ca.qf,ca.runId,ca.KG,Z,ca.yeb,!0,aa,ca.C8,ca.Wya,ca.bMa,ca.HC,ca.ur);V.add(ca)}}u.a.instance.ua(50931345,1,3,"CombineGranularMergeBlocks: List of non granular merge blocks after merge {0}",
V.xp());return V}static Cnn(O,N,V){return O.runId===N.runId&&O.KG.equals(N.KG)&&(O.C8===N.C8||O.Wya===N.Wya)&&O.HC.oy(N.HC)&&(!V||!!O.ur&&O.ur.equals(N.ur))}static Jhn(O,N,V,W,ca,H,Z,aa,ja,Ba,la,ia,oa,ha,pa,Ea){O.setPropertyString(V.ik,k.a.Pl,ca);O.setPropertyUint32(V.ik,f.a.Ib,W);O.setPropertyUint32s(V.ik,f.a.yp,H);O.setPropertyUint32s(V.ik,f.a.Jr,Z);O.setPropertyObjectIds(V.ik,k.a.mm,ja);O.hasProperty(V.ik,f.a.Wh)&&O.setPropertyUint32(V.ik,f.a.Wh,J.iPk());N&&N(20)&&O.setPropertyObjectIds(V.ik,f.a.Ot,
Ea);W=!1;for(ca=0;ca<Ba.length;ca++)if(Ba.J(ca)){W=!0;break}W&&O.setPropertyBools(V.ik,f.a.Svf,Ba);J.$Zj(N,O,V,la,ia,oa,ha);J.a_j(O,V,pa);V.Kz(k.a.Pl);V.Kz(f.a.Ib);V.Kz(f.a.yp);V.Kz(f.a.Jr);V.Kz(k.a.mm);V.Kz(f.a.Svf);V.Kz(k.a.pl);V.Kz(k.a.Nhb);V.Kz(f.a.nJa);V.Kz(f.a.jBa);V.Kz(k.a.Ora);V.Kz(f.a.Ot);O.hasProperty(V.ik,f.a.Wh)&&V.Kz(f.a.Wh);0<aa.length?O.setPropertyUint32s(V.ik,k.a.pl,aa):V.ik.removeProperty(k.a.pl)}static $Zj(O,N,V,W,ca,H,Z){if(O(160)){O=W.contains(!0,(aa,ja)=>ja);J.KQf(N,V,k.a.Ora,
O?W:null);J.KQf(N,V,k.a.Nhb,J.xui(W,ca));J.KQf(N,V,f.a.nJa,J.xui(W,H));W=!1;for(ca=0;ca<Z.length;ca++)0!==Z.J(ca)&&(W=!0);W?N.setPropertyUint32s(V.ik,f.a.jBa,Z):V.ik.removeProperty(f.a.jBa)}}static a_j(O,N,V){const W=Z=>Z;var ca=Object(l.a)(O,O.setPropertyBools,"setPropertyBools");J.iHa(N,V.jcb,W,ca,f.a.yza);J.iHa(N,V.N9a,W,ca,f.a.Sba);J.iHa(N,V.JZa,W,ca,f.a.iBa);ca=Z=>0<Z.length;var H=Object(l.a)(O,O.setPropertyStrings,"setPropertyStrings");J.iHa(N,V.icb,ca,H,f.a.zza);J.iHa(N,V.M9a,ca,H,f.a.Ixa);
J.iHa(N,V.Mfb,ca,H,f.a.FCa);ca=Z=>!!Z;H=Object(l.a)(O,O.setPropertyListOfMilliseconds,"setPropertyListOfMilliseconds");J.iHa(N,V.kcb,ca,H,f.a.Aza);J.iHa(N,V.yUa,ca,H,f.a.Jxa);J.iHa(N,V.Ofb,ca,H,f.a.GCa);V.JZa.any(W)?J.iHa(N,V.Nfb,()=>!0,Object(l.a)(O,O.setPropertyObjectIds,"setPropertyObjectIds"),f.a.sta):N.ik.removeProperty(f.a.sta)}static xui(O,N){const V=new x.a;let W=!1;for(let ca=0;ca<O.length;ca++){const H=N.J(ca)&&!O.J(ca);V.add(H);W=H||W}return W?V:null}static KQf(O,N,V,W){W?O.setPropertyBools(N.ik,
V,W):N.ik.removeProperty(V)}static iPk(){return w.a.nE()}static ezh(O,N){return O.runtime.xr.ax(N,O.runtime.Ci.J(N)||O.runtime.So.get(N))}static ZDc(O,N,V,W,ca){let H;H=new x.a;const Z=!!V&&V(20);if(O.runtime.Ua.isFeatureEnabled(125)){var aa=J.N9j(W,Z);var ja=J.O3g(W,Z);aa.length!==ja.length&&O.runtime.Ua.ks(125)}else aa=J.O3g(W,Z);ja=0;let Ba="",la=new x.a,ia=new x.a,oa=new x.a,ha=new x.a,pa=new x.a,Ea=new x.a,Fa=new x.a,Ga=new x.a,$a=new x.a;const fa=new M.a;let sa=new x.a;var qa=aa.J(aa.length-
1);if(2!==qa.type&&4!==qa.type)return u.a.instance.ua(17044304,1,2,"GetMergeableObjectsFromMergeBlocks: Last merge block not an EOP or table but is [Type: {0}] instead",qa.type),O.logger.Cf(Object.assign(new Q.a,{Ph:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnq",info:String.format("Last merge block is not EOP or table but {0}",qa.type)})),{returnValue:!1,PTd:H};var va=0;for(qa=0;qa<aa.length;qa++){var Ca=aa.J(qa),ta=null;if(1===Ca.type||3===Ca.type)ta=Ca,Ba+=ta.text;else if(4===Ca.type){Ca=
J.ezh(O,Ca.oi);Ca=new R.a(Ca);H.add(Ca);continue}ta?(la.add(ta.runId),ia.add(ta.qf),va+=ta.text.length,oa.add(va),ha.add(ta.KG),pa.add(ta.yeb),Ea.add(ta.pKa),Fa.add(ta.C8),Ga.add(ta.Wya),$a.add(ta.bMa),fa.jcb.add(ta.HC.Qsl),fa.N9a.add(ta.HC.psl),fa.JZa.add(ta.HC.otl),fa.icb.add(ta.HC.insertion.author),fa.M9a.add(ta.HC.deletion.author),fa.Mfb.add(ta.HC.hBa.author),fa.kcb.add(ta.HC.insertion.dNc),fa.yUa.add(ta.HC.deletion.dNc),fa.Ofb.add(ta.HC.hBa.dNc),fa.Nfb.add(ta.HC.hBa.WEf),Z&&sa.add(ta.ur)):la.length||
(la.add(0),ia.add(0),oa.add(0),ha.add(r.a.nil),pa.add(!1),Ea.add(!1),Fa.add(!1),Ga.add(!1),$a.add(0),fa.jcb.add(!1),fa.N9a.add(!1),fa.JZa.add(!1),fa.icb.add(""),fa.M9a.add(""),fa.Mfb.add(""),fa.kcb.add(0),fa.yUa.add(0),fa.Ofb.add(0),fa.Nfb.add(r.a.nil));if(2===Ca.type){va=Ca;Ca=va.Ib;oa.HD(oa.length-1);ta=ca.J(ja);if(!ta)return u.a.instance.ua(17044307,1,2,"GetMergeableObjectsFromMergeBlocks: Failed to get a paragraphId. [ParagraphIdx: {0}] [ParagraphIds.Count: {1}] [MergeBlocks.Length: {2}] [CombinedMergeBlockIdx: {3}] [CombinedMergeBlocks.Length: {4}]",
ja,ca.length,W.length,qa,aa.length),O.logger.Cf(Object.assign(new Q.a,{Ph:"GetMergeableObjectsFromMergeBlocks",eventId:"bbbnt",info:"Failed to get ParaId"})),u.a.instance.Uea(17044308,1,3,"GetMergeableObjectsFromMergeBlocks Paragraphs",ca.xp()),u.a.instance.Uea(17044309,1,3,"GetMergeableObjectsFromMergeBlocks MergeBlocks",W.xp()),u.a.instance.Uea(17044310,1,3,"GetMergeableObjectsFromMergeBlocks CombinedMergeBlocks",aa.xp()),{returnValue:!1,PTd:H};if(ta=J.ezh(O,ta))ta=new R.a(ta.dF()),J.Jhn(N,V,ta,
va.Ib,Ba,la,ia,oa,ha,pa,Ea,Fa,Ga,$a,fa,sa),H.add(ta);u.a.instance.ua(17044312,1,3,"Merge result for: [GraphNode: {0}] [WordId: {1}] [RunIds: {2}] [ParaIds: {3}] [RunIndices: {4}] [ProofingRequired: {5}] [HasSpellingError: {6}] [HasGrammarError: {7}] [FormattingIds: {8}] {9} [ProofingErrorHint: {10}]",va.oi,Ca,la.xp(),ia.xp(),oa.xp(),Ea.xp(),Fa.xp(),Ga.xp(),ha.xp(),"",$a.xp());ja++;Ba="";la=new x.a;ia=new x.a;oa=new x.a;ha=new x.a;pa=new x.a;Ea=new x.a;Fa=new x.a;Ga=new x.a;$a=new x.a;fa.reset();va=
0;sa=new x.a}}return{returnValue:!0,PTd:H}}static A2m(O,N){const V=O.runtime.Xk.J(z.a.dJ),W=N.getPropertyObjectIds(V.ik,f.a.ZY);for(let ca=0;ca<W.length;ca++)O.runtime.Xk.remove(W.J(ca));N.setPropertyObjectIds(V.ik,f.a.ZY,new x.a);N.setPropertyString(V.ik,f.a.$Na,r.a.nil.toString());V.Kz(f.a.ZY);V.Kz(f.a.$Na)}static OBl(O,N){if(O.runtime.Xk.Ja(z.a.dJ))return null;const V=new R.a(O.runtime.Ci.J(z.a.dJ).dF());N.setPropertyString(V.ik,f.a.$Na,O.output.xK.last().id.toString());N.setPropertyObjectIds(V.ik,
f.a.ZY,new x.a);V.Kz(f.a.ZY);V.Kz(f.a.$Na);O.runtime.Xk.Z(z.a.dJ,V);return V}static a9e(O){const N=new x.a;O.forEach(V=>{N.add(V.id);return!0});return N}static U4b(O,N,V,W){let ca=0;V.forEach(H=>{A.a(H,N+ca++,1);393230===H.Gb&&O.getPropertyObjectIds(H,k.a.mm).forEach(Z=>{W.add(Z);return!0});return!0})}static u3l(O,N){const V=new m.a;let W=0;N.forEach(ca=>{if(V.contains(ca))return!0;V.add(ca);if(({index:W}=J.Kpf("BaseFormatting_",W,ca,H=>O.runtime.Ci.J(H))).returnValue||({index:W}=J.Kpf("FavoredFormatting_",
W,ca,H=>O.runtime.xr.J(H))).returnValue||({index:W}=J.Kpf("ConflictingFormatting_",W,ca,H=>O.runtime.So.J(H))).returnValue)return!0;W++;return!0})}static Kpf(O,N,V,W){if(V=W(V))if(A.a(V,O+N,1),1179649===V.Gb)return N++,{returnValue:!0,index:N};return{returnValue:!1,index:N}}static ZYe(O){return!!O.runtime.Ci.J(z.a.dJ)}static iHa(O,N,V,W,ca){N.any(V)?(W(O.ik,ca,N),O.Kz(ca)):O.ik.removeProperty(ca)}static XCi(O,N){const V=new x.a;V.add(0);const W=O?O.length:0;for(let ca=0;ca<W;ca++)V.insert(ca+1,O.Ye(ca));
V.insert(V.length,N);return V}}Object(G.a)(J,"ParagraphMergeUtils",null,[])},1396:function(G,P,b){b.d(P,"a",function(){return f});G=b(0);var k=b(202);class f{constructor(x,u,w){this.al=null;this.vk=x;this.source=u;this.oi=w}get type(){return this.vk}get A0a(){return!1}get LLl(){return 1===(this.source&1)}get MLl(){return 2===(this.source&2)}get NLl(){return 4===(this.source&4)}L0(){return!1}toString(){return String.format("[Source: {0}] [Type: {1}]",this.XSk(),this.jZb())}XSk(){let x="";this.LLl&&
(x+="Base");this.MLl&&(x+="FavoredUpdate");this.NLl&&(x+="UnfavoredUpdate");return x}jZb(){return""}oy(x){return this.type===x.type}bXc(){const x=new k.a;x.add(this);return x}get length(){return 0}}Object(G.a)(f,"AMergeBlock",null,[61,62])},1397:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1396);class k extends b.a{constructor(f,x,u){super(2,f,x);this.Ib=u}toString(){return String.format("{0} [WordId: {1}] [GraphNodeId: {2}]",super.toString(),this.Ib,this.oi)}jZb(){return"Eop"}clone(){return new k(this.source,
this.oi,this.Ib)}oy(f,x,u,w=!1,r=!0){return super.oy(f,x,u,w)?r?f.Ib===this.Ib:f.oi===this.oi&&f.Ib===this.Ib:!1}get length(){return 1}}Object(G.a)(k,"EopMergeBlock",b.a,[])},1398:function(G,P,b){b.d(P,"a",function(){return f});G=b(0);var k=b(366);class f{constructor(){this.detail=new k.a}}Object(G.a)(f,"AMergeFailureDetail",null,[1937])},1399:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1343);class k extends b.a{constructor(){super()}get gca(){return"ParagraphMerge"}}Object(G.a)(k,
"ParagraphMergeFailureDetail",b.a,[])},1400:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1343);class k extends b.a{constructor(){super()}get gca(){return"RdOpLcs"}}Object(G.a)(k,"ReducedOpsLcsFailureDetail",b.a,[])},1401:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1343);class k extends b.a{constructor(){super()}get gca(){return"TableMerge"}}Object(G.a)(k,"TableMergeFailureDetail",b.a,[])},1405:function(G,P,b){G=b(0);class k{constructor(){this.zYc=this.DHc=null;this.Erf=
this.score=this.MMc=0}JCf(E,A,M){this.score=E.J(A);++A;this.DHc=E.J(A)?M.Mia(E.J(A)):null;++A;this.zYc=E.J(A)?M.Mia(E.J(A)):null;++A;this.MMc=E.J(A);++A;this.Erf=E.J(A);++A;return A}}Object(G.a)(k,"TokenStringGeneratorInit",null,[]);class f{constructor(E,A,M,Q,R){this.S$a=E;this.count=A;this.bxd=M;this.jM=Q;this.depth=R}}Object(G.a)(f,"ErrorTolerantTrieMatch",null,[]);var x=b(1466),u=b(1565);class w{constructor(E=null,A=0,M=0,Q=0){this.myj=E||new u.a;this.aqa=A;this.jM=M;this.depth=Q}get I1(){return this.myj}getKey(){return this.I1.Hv.toString()+
":"+this.aqa.toString()}}Object(G.a)(w,"TrieBookmark",null,[]);class r{constructor(E,A){this.bLa=E;this.Oqf=A}h9l(E){if(null==E)throw Error.argumentNull("prefix");let A={};var M=A[""]=new w;this.CFd(M,A);for(M=0;M<E.length;++M){const Q=E.charCodeAt(M),R={};for(let K in A)this.VKj(Q,A[K],R);A=R}return this.kGn(A)}CFd(E,A){if(!(E.jM>=this.Oqf)&&(E=new w(x.a.pQe(E.I1),E.aqa,E.jM+1,E.depth),E.I1.RC&x.a.Y1a&&(E.aqa+=1),this.bLa.qIb(E.I1))){E.depth+=1;let M=!0;for(;M;)r.o7d(E,A),this.CFd(E,A),E.aqa+=this.bLa.AZb(E.I1,
!0)+(E.I1.RC&x.a.Y1a?1:0),M=this.bLa.TYc(E.I1)}}VKj(E,A,M){A.jM+1<=this.Oqf&&(A.jM+=1,r.o7d(A,M),--A.jM);A.I1.RC&x.a.Y1a&&(A.aqa+=1);if(this.bLa.qIb(A.I1)){A.depth+=1;let Q=!0;for(;Q;)A.I1.lJb===E?(r.o7d(A,M),this.CFd(A,M)):A.jM+1<=this.Oqf&&(A.jM+=1,r.o7d(A,M),this.CFd(A,M),--A.jM),A.aqa+=this.bLa.AZb(A.I1,!0)+(A.I1.RC&x.a.Y1a?1:0),Q=this.bLa.TYc(A.I1)}}kGn(E){const A=[];for(var M in E){const Q=E[M];if(!Q.I1.Hv)continue;const R=!!(Q.I1.RC&x.a.Y1a),K=this.bLa.AZb(Q.I1,!1)+(R?1:0);Array.add(A,new f(Q.aqa,
K,R,Q.jM,Q.depth))}A.sort((Q,R)=>{let K=Q.S$a-R.S$a;return K||(K=-(Q.count-R.count))?K:K=Q.depth-R.depth});if(2>A.length)return A;E=[];for(M=0;M<A.length;)M+=r.YPi(M,A,E);return E}static o7d(E,A){const M=E.getKey();M in A?(A=A[M],A.jM=Math.min(A.jM,E.jM)):A[M]=new w(x.a.pQe(E.I1),E.aqa,E.jM,E.depth)}static YPi(E,A,M){const Q=A[E];let R=Q.S$a;const K=R+Q.count;let J=1,O=Q.bxd;for(;E+J<A.length&&A[E+J].S$a<K;){const N=A[E+J];N.S$a>R&&(Array.add(M,new f(R,N.S$a-R,O,Q.jM,Q.depth)),O=!1);J+=r.YPi(E+J,
A,M);R=N.S$a+N.count}R<K&&Array.add(M,new f(R,K-R,O,Q.jM,Q.depth));return J}}Object(G.a)(r,"ErrorTolerantTrieLookupEngine",null,[1220]);class m extends k{constructor(E,A,M){super();this.RLh=this.kei=!1;this.Mih=null;if(E){var Q=0;try{Q=this.JCf(E,Q,A);this.kei=1===E.J(Q);++Q;this.RLh=1===E.J(Q);++Q;const R=E.J(Q);this.Mih=this.Zym(M,R)}catch(R){throw Error.argument("initData");}}}Zym(E,A){return new r(E,A)}}Object(G.a)(m,"FuzzyMatchTokenStringGeneratorInit",k,[]);class l extends k{constructor(E,A){super();
this.query=this.name=null;if(E){this.le=A.le;var M=0;try{M=this.JCf(E,M,A),this.name=A.getString(E.J(M)),++M,this.query=A.nI(E.J(M))}catch(Q){throw Error.argument("initData");}}}}Object(G.a)(l,"QueryTokenStringGeneratorInit",k,[]);class z extends k{constructor(E,A){super();if(E)try{this.JCf(E,0,A)}catch(M){throw Error.argument("initData");}}}Object(G.a)(z,"SurfaceStringTokenStringGeneratorInit",k,[]);var F=b(1331);b.d(P,"a",function(){return L});class L{constructor(E){this.Fqf=E}get DHc(){return this.Fqf.DHc}get zYc(){return this.Fqf.zYc}get MMc(){return this.Fqf.MMc}static create(E,
A,M){const {SurfaceStringTokenStringGenerator:Q}=b(1692),{QueryTokenStringGenerator:R}=b(1693),{FuzzyMatchTokenStringGenerator:K}=b(1694);let J=0;try{if(E.J(J)!==L.Osb)throw Error.argument("initData","Input does not represent a token string generator");++J;const O=E.J(J);++J;const N=new F.a;N.aab(E,J,E.count-J);switch(O){case Q.zvc:return new Q(new z(N,A));case R.zvc:return new R(new l(N,A));case K.zvc:return new K(new m(N,A,M));default:throw Error.argument("initData");}}catch(O){throw Error.argument("initData");
}}static $Og(E,A,M,Q,R,K){E=E.CEn.getId(A,null);if(0>E)return++K,K;L.aPg(E,M,Q,R);return K}static aPg(E,A,M,Q){Array.add(Q.CVf,E);Array.add(Q.FLi,A);++Q.kcc[M]}}L.Osb=1099767983;Object(G.a)(L,"TokenStringGenerator",null,[1191])},1450:function(G,P,b){b.d(P,"a",function(){return x});G=b(0);var k=b(202);P=b(1396);var f=b(1360);class x extends P.a{constructor(u,w,r){super(u,w,r)}ivn(u){let w;w=null;if(!this.text||!this.A0a||0>=u||u>=this.length)return{returnValue:!1,mKi:w};w=new k.a;const r=this.clone();
r.QVc(f.a.Whb(this.text,0,u));const m=this.clone();m.QVc(f.a.Whb(this.text,u,this.length-u));w.add(r);w.add(m);return{returnValue:!0,mKi:w}}L0(){return!0}get length(){return this.text.length}}Object(G.a)(x,"ATextMergeBlock",P.a,[])},1451:function(G,P,b){b.d(P,"a",function(){return f});G=b(0);var k=b(143);class f{bKe(x,u){return x+("[Block: "+u+"] ")}static rXk(x,u,w,r,m,l,z){const {ParagraphMergeBlockCreator:F}=b(1737),{TableMergeBlockCreator:L}=b(1741);if(393230===u.Gb)return new F(x,u,w,m,l,r(20),
z);if(393250===u.Gb)return new L(u,w);k.a.instance.ua(4051652,1,1,"Trying to Run GetMergeBlockList on unknown Runtime Class ID {0}.",u.Gb);return null}}Object(G.a)(f,"MergeBlockCreator",null,[])},1452:function(G,P,b){b.d(P,"a",function(){return u});G=b(0);var k=b(6),f=b(51);P=b(1450);var x=b(1361);class u extends P.a{constructor(w,r,m,l,z,F,L,E,A,M,Q,R,K,J){super(r,m,l);this.qf=z;this.runId=F;this.yeb=E;this.Pej=L;this.Kae=w;this.pKa=A;this.C8=M;this.Wya=Q;this.bMa=R;this.HC=K;this.ur=J}get kuc(){return this.Kae}get KG(){return this.Pej}get pwb(){return this.kuc(this.KG)}toString(){return String.format("{0} [ParaId: {1}] [RunId: {2}] [NewlyTypedRun: {3}] [GraphNodeId: {4}] [FormatId: {5}] [ChangeId: {6}]",
super.toString(),this.qf,this.runId,this.yeb,this.oi,this.KG.toString(),this.ur?this.ur.toString():"NULL")}oy(w,r,m,l=!1){if(!super.oy(w,r,m,l))return!1;if(l)return!0;if(!this.HC.oy(w.HC)||this.ur&&!this.ur.equals(w.ur))return!1;if(this.KG.equals(w.KG)||this.KG.equals(f.a.nil)||w.KG.equals(f.a.nil))return!0;w=new x.a(this.pwb,w.pwb);r=r.e9g(this.pwb,m);return w.LIc(r.xVd)?!1:!0}get QGl(){return this.L0()&&"\ufffc"===this.text&&this.pwb?this.pwb.hasProperty(k.a.Qp)||1179725!==this.pwb.Gb?!0:!1:!1}}
Object(G.a)(u,"AUserRunMergeBlock",P.a,[])},1453:function(G,P,b){b.d(P,"a",function(){return f});var k=b(143);const f=(x,u,w=4)=>{x?k.a.instance.Uea(4273285,w,3,u,x.Bib()):k.a.instance.ua(4293845,w,1,u,"{0}: Node was null.",u)}},1454:function(G,P,b){b.d(P,"e",function(){return r});b.d(P,"a",function(){return m});b.d(P,"d",function(){return l});b.d(P,"b",function(){return z});b.d(P,"c",function(){return F});var k=b(6),f=b(17),x=b(51),u=b(909),w=b(1375);const r=(A,M,Q)=>{const R=new u.a;let K=x.a.nil;
M=R.getPropertyObjectId(M,k.a.kib);M.equals(x.a.nil)||(A=A.runtime.Ci.J(M),Q&&(A=Q.ax(M,A)),A&&(K=R.getPropertyObjectId(A,k.a.kib)));return K},m=(A,M,Q,R,K)=>{const J=new u.a;let O=null;var N=J.getPropertyObjectId(Q,k.a.kib);N!==x.a.nil&&(O=A.runtime.Ci.J(N),M&&(O=M.ax(N,O)));if(O){N=J.getPropertyObjectIds(O,f.a.ge);for(K=0;K<N.length&&!N.J(K).equals(Q.id);K++);K===N.length&&(K=-1)}Q=r(A,Q,M);if(!Q.equals(x.a.nil)&&(A=A.runtime.Ci.J(Q),M&&(A=M.ax(Q,A)),A)){M=J.getPropertyObjectIds(A,f.a.ge);for(R=
0;R<M.length&&!M.J(R).equals(O.id);R++);R===M.length&&(R=-1)}return{rowIndex:R,DVb:K}},l=(A,M,Q,R,K)=>{var J=new u.a;let O=null;var N=A.runtime.Ci.J(Q);M&&(N=M.ax(Q,N));if(!N)return null;N=J.getPropertyObjectIds(N,f.a.ge);Q=null;R<N.length&&(R=N.J(R),Q=A.runtime.Ci.J(R),M&&(Q=M.ax(R,Q)));Q&&(J=J.getPropertyObjectIds(Q,f.a.ge),K<J.length&&(K=J.J(K),O=A.runtime.Ci.J(K),M&&(O=M.ax(K,O))));return O},z=(A,M,Q)=>{let R,K;K=R=-1;const J=(new u.a).getPropertyObjectId(Q,k.a.kib);var O=r(A,Q,M);if(O.equals(x.a.nil)||
J.equals(x.a.nil))return{rowIndex:R,DVb:K};M=A.runtime.KWf;var N=M.J(O);if(!N){N=L(A,O);if(!N)return{rowIndex:R,DVb:K};M.Z(O,N)}for(O=0;O<N.length;O++)if(N.J(O).equals(J)){R=O;break}N=M.J(J);if(!N){N=E(A,J);if(!N)return{rowIndex:R,DVb:K};M.Z(J,N)}for(A=0;A<N.length;A++)if(N.J(A).equals(Q.id)){K=A;break}return{rowIndex:R,DVb:K}},F=(A,M,Q,R)=>{if(0>Q||0>R)return x.a.nil;new u.a;const K=A.runtime.KWf;let J=K.J(M);if(!J){J=L(A,M);if(!J)return x.a.nil;K.Z(M,J)}if(Q<J.length)M=J.J(Q);else return x.a.nil;
Q=K.J(M);if(!Q){Q=E(A,M);if(!Q)return x.a.nil;K.Z(M,Q)}if(R<Q.length)A=Q.J(R);else return x.a.nil;return A},L=(A,M)=>{var Q=new u.a;const R=A.runtime.Ci.J(M);if(R){var K=A.runtime.xr.ax(M,R);A=A.runtime.So.ax(M,R);M=Q.getPropertyObjectIds(R,f.a.ge);K=Q.getPropertyObjectIds(K,f.a.ge);Q=Q.getPropertyObjectIds(A,f.a.ge);return M.Go(K,(J,O)=>J.equals(O))?Q:M.Go(Q,(J,O)=>J.equals(O))?K:w.a(M,K,Q,(J,O)=>J.equals(O))}return(K=A.runtime.xr.J(M))?Q.getPropertyObjectIds(K,f.a.ge):(K=A.runtime.So.J(M))?Q.getPropertyObjectIds(K,
f.a.ge):null},E=(A,M)=>{var Q=new u.a;const R=A.runtime.Ci.J(M);if(R){var K=A.runtime.xr.ax(M,R);A=A.runtime.So.ax(M,R);M=Q.getPropertyObjectIds(R,f.a.ge);K=Q.getPropertyObjectIds(K,f.a.ge);Q=Q.getPropertyObjectIds(A,f.a.ge);return M.Go(K,(J,O)=>J.equals(O))?Q:M.Go(Q,(J,O)=>J.equals(O))?K:null}return(K=A.runtime.xr.J(M))?Q.getPropertyObjectIds(K,f.a.ge):(K=A.runtime.So.J(M))?Q.getPropertyObjectIds(K,f.a.ge):null}},1455:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);var k;(function(f){f[f.Answer=
0]="Answer";f[f.Definition=1]="Definition";f[f.Entity=2]="Entity";f[f.WolframAnswer=3]="WolframAnswer";f[f.Assistance=4]="Assistance";f[f.Command=5]="Command";f[f.Document=6]="Document";f[f.TryQuery=7]="TryQuery";f[f.FindInDocument=8]="FindInDocument";f[f.HelpAction=9]="HelpAction";f[f.Insights=10]="Insights";f[f.People=11]="People";f[f.Image=12]="Image";f[f.FirstRunResult=13]="FirstRunResult";f[f.NoCommandsFoundResult=14]="NoCommandsFoundResult";f[f.TestResult=15]="TestResult";f[f.AppsForOffice_Installed=
16]="AppsForOffice_Installed";f[f.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";f[f.AppsForOffice_Query=18]="AppsForOffice_Query";f[f.Notes_Onenote=19]="Notes_Onenote";f[f.Notes_Samsung=20]="Notes_Samsung";f[f.Notes_Sticky=21]="Notes_Sticky";f[f.Learning=22]="Learning";f[f.Feedback=23]="Feedback";f[f.Template=24]="Template";f[f.Addin=25]="Addin";f[f.Unknown=26]="Unknown"})(k||(k={}));Object(G.b)("ResultType",k)},1456:function(G,P,b){b.d(P,"a",function(){return f});G=b(0);var k=b(1296);
b=b(2);class f{static FTl(){return!k.a.DSh()&&!k.a.wAb()&&f.isFeatureEnabled(0)}static JWh(){return f.isFeatureEnabled(1)}static WTh(){return f.isFeatureEnabled(2)}static isFeatureEnabled(x){return!!(f.Mdj&1<<x)}}f.Mdj=b.AFrameworkApplication.K?b.AFrameworkApplication.K.vb("TellMeFeatureConfigValue",0):0;Object(G.a)(f,"TellMeFeatureAvailability",null,[])},1457:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1302);class k extends b.a{constructor(f,x,u,w,r=null){super(f,x,r,null,u);this.id=
w}}Object(G.a)(k,"TryQueryResultBinding",b.a,[])},1458:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(f){this.Ka=f}get $Ya(){return this.Ka.$Ya}get ezn(){return 4!==this.Ka.style}get gzn(){return!0}get trie(){return this.Ka.trie}getId(f,x){if(!this.ezn)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ka.style){case 0:return this.c3k(f,x);default:throw Error.notImplemented();}}getString(f){if(!this.gzn)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>f||f>=this.$Ya)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ka.style){case 0:return this.Ogl(f);case 4:return this.Ngl(f);default:throw Error.notImplemented();}}c3k(f,x){f=this.Ka.trie.o2h(f,0,f.length,x);if(!f.succeeded)return-1;if(0>f.wcc||f.wcc>=this.Ka.$Ya)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ka.UYc?this.Ka.ORc.Cw(this.Ka.UYc+4*f.wcc,4):f.wcc}Ogl(f){if(this.Ka.UYc){let x=0;for(;x<this.Ka.$Ya&&this.Ka.ORc.Cw(this.Ka.UYc+
4*x,4)!==f;++x);if(x>=this.Ka.$Ya)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ka.trie.lDh(x)}return this.Ka.trie.lDh(f)}Ngl(f){const x=this.Ka.ORc.Cw(this.Ka.CLi+4*f,4);f=this.Ka.ORc.Cw(this.Ka.DLi+4*f,4);if(0>f||0>x)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const u=Array(x);for(let w=0;w<x;++w)u[w]=({Awl:f}=this.WMm(f)).returnValue;return String.fromCharCode.apply(null,u)}WMm(f){let x=0;for(let u=0;3>u;++u){const w=
this.Ka.ORc.J(this.Ka.L0g+f)^182;++f;x|=(w&127)<<7*u;if(!(w&128))break}return{returnValue:x,Awl:f}}}Object(G.a)(k,"StringTable",null,[1176])},1459:function(G,P,b){b.d(P,"a",function(){return f});G=b(0);var k=b(1466);class f{constructor(x){this.trie=null;this.L0g=this.CLi=this.DLi=this.UYc=0;if(x){this.ORc=x;var u=0;if(x.Cw(u,4)!==f.Osb)throw Error.argument("bytes","Input does not represent a string table");u+=4;this.$Ya=x.Cw(u,4);u+=4;this.style=x.Cw(u,4);u+=4;switch(this.style){case 0:const w=1===
x.Cw(u,4);u+=4;w||(this.UYc=u,u+=4*this.$Ya);x.Cw(u,4);this.trie=this.zzm(x,u+4);break;case 4:this.DLi=u;this.CLi=u+=4*this.$Ya;u+=4*this.$Ya;x.Cw(u,4);this.L0g=u+4;break;default:throw Error.argument("bytes");}}}zzm(x,u){return new k.a(x,u)}}f.Osb=1025118440;Object(G.a)(f,"StringTableInit",null,[])},1463:function(G,P,b){G=b(0);var k=b(6),f=b(574),x=b(143),u=b(202),w=b(51),r=b(366),m=b(69),l;(function(Ha){Ha[Ha.none=0]="none";Ha[Ha.mergeConflict=1]="mergeConflict";Ha[Ha.containerBaseIdValidationFailure=
2]="containerBaseIdValidationFailure";Ha[Ha.failedToApplyHints=3]="failedToApplyHints";Ha[Ha.validateUpdateHintsAreComplete=4]="validateUpdateHintsAreComplete";Ha[Ha.other=5]="other"})(l||(l={}));Object(G.b)("ParagraphMergeUsingHintsFailureReason",l);var z=b(909),F=b(237),L=b(804);const E=Ha=>{const Aa=new u.a;Ha.forEach(Ma=>{Aa.add(Ma);return!0});return Aa};var A=b(1397),M=b(1375),Q=b(1400);const R=(Ha,Aa)=>{if(Ha.length!==Aa.length)return!1;for(let Ma=0;Ma<Ha.length;Ma++)Ha.J(Ma).al=Aa.J(Ma),Aa.J(Ma).al=
Ha.J(Ma);return!0},K=(Ha,Aa,Ma)=>{let cb,ib,Rb;cb=0;ib=!1;Rb=0;var Oa;if(!({idx:Oa}=W(Ha,Aa)).returnValue)return x.a.instance.ua(18969440,1,4,"TryFindMergeBlockToSplit: Unable to find MergeBlock for [GraphNodeId: {0}] [MergeBlocks: {1}]",Aa,Ha.xp()),{returnValue:!1,wFc:cb,teb:ib,uNc:Rb};if(!Ma&&2===Ha.J(Oa).type)return{returnValue:!0,wFc:Oa,teb:ib,uNc:Rb};if(!Ha.J(Oa).L0())return x.a.instance.ua(17044256,1,2,"TryFindMergeBlockToSplit: MergeBlock that at [Index: {0}] [Cp: {1}] is of Unexpected type [MergeBlocks: {2}]",
Oa,Ma,Ha.xp()),{returnValue:!1,wFc:cb,teb:ib,uNc:Rb};let lb=!1,gb=0;for(;Oa<Ha.length&&Ha.J(Oa).oi.equals(Aa);Oa++){if(Ma===gb){lb=!0;break}if(Ma>gb&&Ma<gb+Ha.J(Oa).length){ib=lb=!0;Rb=Ma-gb;break}gb+=Ha.J(Oa).length}lb||Ma!==gb||(lb=!0);lb&&(cb=Oa);return{returnValue:lb,wFc:cb,teb:ib,uNc:Rb}},J=(Ha,Aa,Ma)=>{let cb,ib,Rb;Rb=ib=0;cb=!1;let Oa=0,lb=!1;for(;ib<Ha.length;ib++){if(Aa===Oa){lb=!0;break}if(Aa>Oa&&Aa<Oa+Ha.J(ib).length){cb=lb=!0;Rb=Aa-Oa;break}Oa+=Ha.J(ib).length}lb||Aa!==Oa||(lb=!0);lb||
(Ha=String.format("Unable to find block idx to split at cp [Blocks: {0}][Length: {1}][CP: {2}]",Ha.length,Oa,Aa),x.a.instance.ua(573178201,1,2,Ha),Ma.Cf(Object.assign(new Q.a,{eventId:"8k6fz",info:Ha})));return{returnValue:lb,teb:cb,eWg:ib,dWg:Rb}},O=(Ha,Aa,Ma)=>{let cb;if(Ha.J(Aa).L0()&&({mKi:cb}=Ha.J(Aa).ivn(Ma)).returnValue)return Ha.ez(Aa+1,cb),Ha.HD(Aa),!0;x.a.instance.ua(18969441,1,4,"TrySplitMergeBlockInListAtIndexAndCp: Unable to split at [Index: {0}] [Cp: {1}] [MergeBlocks: {2}]",Aa,Ma,Ha.xp());
return!1},N=(Ha,Aa,Ma)=>{let cb,ib;if(!({wFc:Ma,teb:ib,uNc:cb}=K(Ha,Aa,Ma)).returnValue)return{returnValue:!1,index:0};if(!ib)return{returnValue:!0,index:Ma};if(O(Ha,Ma,cb))return{returnValue:!0,index:Ma+1};x.a.instance.ua(18969442,1,4,"TrySplitMergeBlockListAtCp: Unable to split at [GraphNodeId: {0}] [Cp: {1}] [MergeBlocks: {2}]",Aa,cb,Ha.xp());return{returnValue:!1,index:0}},V=(Ha,Aa,Ma)=>{let cb;if(!({teb:cb,eWg:Aa,dWg:Ma}=J(Ha,Aa,Ma)).returnValue)return{returnValue:!1,index:0};if(!cb)return{returnValue:!0,
index:Aa};if(O(Ha,Aa,Ma))return{returnValue:!0,index:Aa+1};x.a.instance.ua(574433311,1,4,"TrySplitMergeBlockListAtCp: Unable to split at [Cp: {1}] [MergeBlocks: {2}]",Ma,Ha.xp());return{returnValue:!1,index:0}},W=(Ha,Aa)=>{let Ma;Ma=0;for(let cb=0;cb<Ha.length;cb++)if(Ha.J(cb).oi.equals(Aa))return Ma=cb,{returnValue:!0,idx:Ma};x.a.instance.ua(18969443,1,4,"TryGetFirstIdxForGraphNodeId: Unable to find first idx [GraphNodeId: {0}] [MergeBlocks: {1}]",Aa,Ha.xp());return{returnValue:!1,idx:Ma}},ca=(Ha,
Aa)=>{let Ma;Ma=-1;for(let cb=Aa;cb<Ha.length;cb++)if(2===Ha.J(cb).type)return Ma=cb,{returnValue:!0,eca:Ma};x.a.instance.ua(18969472,1,4,"TryGetIdxNextEop: Unable to find first idx [Index: {0}] [MergeBlocks: {1}]",Aa,Ha.xp());return{returnValue:!1,eca:Ma}},H=(Ha,Aa,Ma)=>{let cb;cb=-1;for(let ib=Ma;ib<Ha.length;ib++)if(2===Ha.J(ib).type&&Ha.J(ib).oi.equals(Aa))return cb=ib,{returnValue:!0,eca:cb};x.a.instance.ua(18969473,1,4,"TryGetIdxNextEopForGraphNodeId: Unable to find EOP [GraphNodeId: {0}] [Index: {1}] [MergeBlocks: {2}]",
Aa,Ma,Ha.xp());return{returnValue:!1,eca:cb}},Z=(Ha,Aa)=>{let Ma;Ma=0;var cb;if(!({idx:cb}=W(Ha,Aa)).returnValue)return x.a.instance.ua(17342616,1,2,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Aa,Ha),{returnValue:!1,length:Ma};for(;cb<Ha.length;cb++)if(6!==Ha.J(cb).type){if(2===Ha.J(cb).type)return{returnValue:!0,length:Ma};x.a.instance.shipAssertTag(17342617,1,Ha.J(cb).L0(),"We found something other than text with type "+Ha.J(cb).type);x.a.instance.shipAssertTag(17877021,1,Ha.J(cb).oi.equals(Aa),
"Unexpected GraphNodeId {0} for ParaId {1}",Ha.J(cb).oi,Aa);Ma+=Ha.J(cb).length}x.a.instance.ua(18969474,1,4,"Unable to find [GraphNodeId: {0}] [MergeBlocks: {1}]",Aa,Ha);return{returnValue:!1,length:Ma}},aa=Ha=>{const Aa=new u.a;for(let Ma=0;Ma<Ha.length;Ma++)Aa.add(Ha.J(Ma).clone());return Aa};var ja=b(1399),Ba=b(1360);class la{constructor(Ha,Aa,Ma=null,cb=null){this.oi=Ha;this.type=Aa;this.text=Ma;this.Ib=cb}isEqual(Ha){return Ha.oi.equals(this.oi)&&this.type===Ha.type&&this.Ib===Ha.Ib&&Ba.a.bUg(this.text,
Ha.text)}toString(){let Ha=String.format("[GraphNodeId: {0}] [WordId: {1}] [MergeBlockType: {2}]",this.oi,this.Ib,this.type);this.text&&(Ha+=String.format(" [TextLength: {0}]",this.text.length));return Ha}}Object(G.a)(la,"MergeBlockValidationState",null,[]);var ia=b(246),oa=b(841),ha=b(776),pa=b(510),Ea=b(458),Fa=b(840),Ga=b(775),$a=b(1343),fa=b(1554),sa;(function(Ha){Ha[Ha.base=1]="base";Ha[Ha.favoredUpdate=2]="favoredUpdate";Ha[Ha.unfavoredUpdate=4]="unfavoredUpdate";Ha[Ha.min=1]="min";Ha[Ha.max=
7]="max"})(sa||(sa={}));Object(G.b)("MergeBlockSource",sa);class qa{constructor(Ha,Aa,Ma,cb){this.qf=Ha;this.cp=Aa;this.Wmd=Ma;this.TZc=cb}}Object(G.a)(qa,"MergedListBlocksWithUpdatedFormattingIds",null,[]);var va=b(1396);class Ca extends va.a{constructor(Ha,Aa){super(6,Ha,Aa);this.Ib=0}toString(){return String.format("{0} [GraphNodeId: {1}]",super.toString(),this.oi)}jZb(){return"Selection"}clone(){return new Ca(this.source,this.oi)}oy(){return!1}get length(){return 0}}Object(G.a)(Ca,"SelectionMergeBlock",
va.a,[]);var ta;(function(Ha){Ha[Ha.success=0]="success";Ha[Ha.selfSplit=1]="selfSplit";Ha[Ha.noSecondaryBlockToSplit=2]="noSecondaryBlockToSplit";Ha[Ha.unexpected=3]="unexpected"})(ta||(ta={}));Object(G.b)("SplitTwinListResult",ta);var Wa=b(1450);class Za extends Wa.a{constructor(Ha,Aa,Ma,cb){super(5,Ha,Aa);this._text=null;this.QVc(Ma);this.Syj=cb}get text(){return this._text}QVc(Ha){this._text=Ha}get CZc(){return this.Syj}clone(){return new Za(this.source,this.oi,this.text,this.CZc)}get A0a(){return this.text&&
this.text.length?!0:!1}toString(){return String.format("{0}",super.toString())}}Object(G.a)(Za,"UpdateHintTextMergeBlock",Wa.a,[]);class Ya{constructor(Ha,Aa,Ma,cb){this.TZ=!1;this.v6a=new r.a;this.Rc=Ha;this.aKg=cb;this.ebg=Ma;this._base=Aa;this.age=aa(Aa);if(!R(this.base,this.Ed))throw x.a.instance.ua(574133957,1,2,"LcsTwinList ConnectList: Length not equal"),Ha.logger.Cf(Object.assign(new $a.a,{info:"TwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Ed(){return this.age}get mergeConflict(){return this.TZ}MKe(Ha,
Aa){switch(Ha.type){case 1:return this.GOj(Ha,Aa);case 2:return this.oKe(Ha,Aa);case 3:return this.rPj(Ha,Aa);case 4:return this.XOj(Ha);case 5:return this.WNj(Ha,Aa);case 6:return this.mKe(Ha);default:return!1}}LKe(Ha,Aa){switch(Ha.type){case 1:return this.sKe(Ha,Aa);case 2:return this.nKe(Ha,Aa);case 3:return this.qPj(Ha,Aa);case 4:return this.WOj(Ha);case 5:return this.VNj(Ha,Aa);case 6:return this.lKe(Ha);default:return{returnValue:!1,xs:null}}}GOj(Ha,Aa){let Ma;const cb=({Kca:Ma}=this.jCa(Ha.qf,
Aa,!1,Ha.cp,!1,"ApplyInsertTextHintToDerived")).returnValue;if(0!==cb&&1!==cb)return 3!==cb&&(x.a.instance.ua(590202197,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToDerived for mergeBlockSource {0}: {1}",sa[Aa],ta[cb]),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vv"}))),!1;this.TZ=!1;Aa=new Za(Aa,Ha.qf,Ha.text,Ha.id);this.hgf(Ha,Ma,Aa);return!0}oKe(Ha,Aa){let Ma,cb=({Kca:Ma}=this.jCa(Ha.qf,Aa,!1,Ha.cp,!1,"ApplyDeleteTextHintToDerived Start")).returnValue;
if(0!==cb&&1!==cb)return 3!==cb&&(x.a.instance.ua(590202198,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (start) for mergeBlockSource {0}: {1}",sa[Aa],ta[cb]),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vw"}))),!1;let ib;({Kca:ib,returnValue:cb}=this.jCa(Ha.qf,Aa,!1,Ha.cp+Ha.text.length,!1,"ApplyDeleteTextHintToDerived End"));if(0!==cb&&1!==cb)return 3!==cb&&(x.a.instance.ua(590202199,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToDerived (end) for mergeBlockSource {0}: {1}",
sa[Aa],ta[cb]),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vx"}))),!1;this.TZ=!1;this.TWe(Ha,Ma,ib);return!0}rPj(Ha,Aa){let Ma;const cb=({tef:Ma}=this.ywh(Ha,Aa,!1)).returnValue;if(0!==cb&&1!==cb)return 3!==cb&&(x.a.instance.ua(590202200,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToDerived for mergeBlockSource {0}: {1}",sa[Aa],ta[cb]),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vy"}))),
!1;this.TZ=!1;Aa=new A.a(Aa,Ha.Ur,Ha.xoa);this.hgf(Ha,Ma,Aa);return!0}XOj(Ha){let Aa;if(!({GFd:Aa}=this.zwh(Ha,this.Ed,"Derived")).returnValue)return!1;this.TWe(Ha,Aa,Aa+1);return!0}WNj(Ha,Aa){let Ma;if(!({Wrf:Aa,sef:Ma}=this.jyh(Ha,!1,Aa)).returnValue)return!1;this.hgf(Ha,Ma,Aa);return!0}mKe(Ha){let Aa;if(!({FFd:Aa}=this.pwh(Ha,this.Ed,"Derived")).returnValue)return!1;this.TWe(Ha,Aa,Aa+1);return!0}lTg(Ha,Aa,Ma){const cb=({Kca:Aa}=this.jCa(Ha,Ma,!1,Aa,!0,"ApplyInsertCpPlaceHolderHintToDerived")).returnValue;
if(0!==cb&&1!==cb)return 3!==cb&&(x.a.instance.ua(590202201,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToDerived for mergeBlockSource {0}: {1}",sa[Ma],ta[cb]),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2vz"}))),!1;this.TZ=!1;Ha=new Ca(Ma,Ha);this.Ed.insert(Aa,Ha);return!0}sKe(Ha,Aa){var Ma=null;if(Ya.SRh(Ha.text.length))return{returnValue:!1,xs:Ma};let cb,ib,Rb;var Oa=({Kca:cb,Iqa:ib,Mba:Rb}=this.jCa(Ha.qf,Aa,!0,Ha.cp,
!1,"ApplyInsertTextHintToBaseAndDerived")).returnValue;if(0!==Oa&&2!==Oa)return 3!==Oa&&(x.a.instance.ua(590202202,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertTextHintToBaseAndDerived for mergeBlockSource {0}: {1}",sa[Aa],ta[Oa]),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v0"}))),{returnValue:!1,xs:Ma};this.TZ=!1;({eca:Oa}=ca(this.Ed,ib));Oa=this.Ed.J(Oa).oi;Ma=new Za(Aa,Ha.qf,Ha.text,Ha.id);Aa=new Za(Aa,Oa,Ha.text,Ha.id);Ma.al=Aa;Aa.al=
Ma;this.base.insert(cb,Ma);this.Ed.insert(ib,Aa);Ma=new u.a;Ma.add(new Ea.a(Oa,Rb,Ha.text,Ha.id,Ha.Qs));return{returnValue:!0,xs:Ma}}nKe(Ha,Aa){let Ma;Ma=null;if(Ya.SRh(Ha.text.length))return{returnValue:!1,xs:Ma};let cb;var ib,Rb=({Kca:cb,Iqa:Oa,Mba:ib}=this.jCa(Ha.qf,Aa,!0,Ha.cp,!1,"ApplyDeleteTextHintToBaseAndDerived Start")).returnValue;if(0!==Rb){if(2!==Rb)return 3!==Rb&&(x.a.instance.ua(590202203,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (start) for mergeBlockSource {0}: {1}",
sa[Aa],ta[Rb]),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v1"}))),{returnValue:!1,xs:Ma};var Oa=0;for({idx:ib}=W(this.base,Ha.qf);ib<this.base.length&&Oa<Ha.cp;ib++)Oa+=this.base.J(ib).length;Oa-=this.base.J(ib-1).length;({Iqa:Oa,Mba:ib,returnValue:Rb}=this.jCa(Ha.qf,Aa,!0,Oa,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Rb)return 3!==Rb&&(x.a.instance.ua(590202204,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback start) for mergeBlockSource {0}: {1}",
sa[Aa],ta[Rb]),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v2"}))),{returnValue:!1,xs:Ma};this.TZ=!1}var lb,gb;({Kca:lb,Iqa:gb,Mba:Nb,returnValue:Rb}=this.jCa(Ha.qf,Aa,!0,Ha.cp+Ha.text.length,!1,"ApplyDeleteTextHintToBaseAndDerived End"));if(0!==Rb){if(2!==Rb)return 3!==Rb&&(x.a.instance.ua(590202205,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (end) for mergeBlockSource {0}: {1}",sa[Aa],ta[Rb]),this.Rc.logger.Cf(Object.assign(new fa.a,
{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v3"}))),{returnValue:!1,xs:Ma};var Nb=0;for({idx:gb}=W(this.base,Ha.qf);gb<this.base.length&&Nb<Ha.cp+Ha.text.length;gb++)Nb+=this.base.J(gb).length;({Iqa:gb,Mba:Nb,returnValue:Rb}=this.jCa(Ha.qf,Aa,!0,Nb,!1,"ApplyDeleteTextHintToBaseAndDerived Start"));if(0!==Rb)return 3!==Rb&&(x.a.instance.ua(590202206,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyDeleteTextHintToBaseAndDerived (fallback end) for mergeBlockSource {0}: {1}",sa[Aa],ta[Rb]),
this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v4"}))),{returnValue:!1,xs:Ma};this.TZ=!1}Aa="";Ma=new u.a;for(--gb;gb>=Oa;gb--)if(6!==this.Ed.J(gb).type)if(this.Ed.J(gb).al)Aa=this.Ed.J(gb).text+Aa,this.Ed.HD(gb);else{if(5===this.Ed.J(gb).type)Rb=Nb-Aa.length;else if(2===this.Ed.J(gb).type){if(Rb=0,!({length:Nb}=Z(this.Ed,this.Ed.J(gb).oi)).returnValue)return x.a.instance.ua(589603462,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetTextLengthForParaId failed"),
this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkg"})),{returnValue:!1,xs:Ma}}else return x.a.instance.ua(589898051,1,2,"ApplyDeleteTextHintToBaseAndDerived: Unexpected block type missing twin"),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9ksfd"})),{returnValue:!1,xs:Ma};if(!({eca:qc}=ca(this.Ed,gb+1)).returnValue)return x.a.instance.ua(589603463,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),
this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9jkkh"})),{returnValue:!1,xs:Ma};var qc=this.Ed.J(qc).oi;Ma.add(new pa.DeleteTextUpdateHint(qc,Rb,Aa));Aa=""}for(--lb;lb>=cb;lb--)this.base.HD(lb);if(!({eca:qc}=ca(this.Ed,Oa)).returnValue)return x.a.instance.ua(589603464,1,2,"ApplyDeleteTextHintToBaseAndDerived: TryGetIdxNextEop failed"),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9jkki"})),{returnValue:!1,xs:Ma};
qc=this.Ed.J(qc).oi;Aa&&Aa.length&&Ma.add(new pa.DeleteTextUpdateHint(qc,ib,Aa,Ha.id,Ha.Qs));return{returnValue:!0,xs:Ma}}qPj(Ha,Aa){var Ma=null;let cb,ib,Rb;var Oa=({tef:cb,mLh:ib,Mba:Rb}=this.ywh(Ha,Aa,!0)).returnValue;if(0!==Oa)return 3!==Oa&&(x.a.instance.ua(590202207,1,2,"Fatal GetIndicesAndCpForSplitPara failure in ApplySplitParaHintToBaseAndDerived for mergeBlockSource {0}: {1}",sa[Aa],ta[Oa]),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v5"}))),
{returnValue:!1,xs:Ma};var lb;if(!({eca:lb}=ca(this.Ed,ib)).returnValue)return x.a.instance.ua(17342618,1,2,"ApplySplitParaHintToBaseAndDerived: Could not find corrsponding block in derived list."),{returnValue:!1,xs:Ma};Oa=this.Ed.J(lb).oi;const gb=this.Ed.J(lb).Ib;let Nb,qc,Eb;({Ur:lb,q3:Nb,xoa:qc,C7:Eb}=this.f8k(Ha,lb));this.G0g(this.Ed,lb,Nb,Eb,ib);Ma=new A.a(Aa,Ha.Ur,Ha.xoa);Aa=new A.a(Aa,lb,qc);Ma.al=Aa;Aa.al=Ma;this.base.insert(cb,Ma);this.Ed.insert(ib,Aa);Ma=new u.a;Ma.add(new Ga.a(Oa,gb,
Rb,lb,qc,Nb,Eb,Ha.id,Ha.Qs));return{returnValue:!0,xs:Ma}}WOj(Ha){let Aa;Aa=null;let Ma,cb;var ib;if(!({GFd:Ma}=this.zwh(Ha,this.base,"Base")).returnValue)return{returnValue:!1,xs:Aa};if(!this.base.J(Ma).al||!({eca:cb}=H(this.Ed,this.base.J(Ma).al.oi,0)).returnValue)return x.a.instance.ua(17342619,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",
eventId:"bckc1"})),this.TZ=!0,{returnValue:!1,xs:Aa};if(!({eca:ib}=ca(this.Ed,cb+1)).returnValue)return x.a.instance.ua(17342620,1,2,"ApplyMergeParaHintToBaseAndDerived: We don't support operation as the below para on derived after merge is null"),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"bckc2"})),this.TZ=!0,{returnValue:!1,xs:Aa};let Rb,Oa,lb,gb,Nb,qc;({LYa:ib,MYa:lb,Lvf:Rb,Qgm:gb,vgm:Oa,wgm:Nb}=this.OXk(Ha,cb,ib));if(!({length:qc}=Z(this.Ed,ib)).returnValue)return{returnValue:!1,
xs:Aa};this.F0g(this.Ed,ib,lb,cb);this.Ed.HD(cb);this.base.HD(Ma);Aa=new u.a;Aa.add(new Fa.MergeParagraphUpdateHint(Rb,gb,qc,Oa,Nb,ib,lb,Ha.id,Ha.Qs));return{returnValue:!0,xs:Aa}}VNj(Ha,Aa){var Ma=null;let cb,ib,Rb;if(!({Wrf:Rb,sef:cb}=this.jyh(Ha,!0,Aa)).returnValue)return{returnValue:!1,xs:Ma};if(!({Obb:ib}=this.NDc(this.base,this.Ed,cb,!0)).returnValue)return x.a.instance.ua(17146332,1,2,"ApplyAddParaHintToBaseAndDerived: We could not find the corresponding index in the Derived list."),{returnValue:!1,
xs:Ma};if(0<ib&&2!==this.Ed.J(ib-1).type)return x.a.instance.ua(17342621,1,2,"ApplyAddParaHintToBaseAndDerived: We cannot insert a new para in a middle of an existing para"),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"bckc3"})),this.TZ=!0,{returnValue:!1,xs:Ma};let Oa;if(!({Ur:Oa}=this.Dph(ib)).returnValue)return{returnValue:!1,xs:Ma};Aa=new A.a(Aa,Ha.qf,Ha.Ib);Ma=Rb;Ma.al=Aa;Aa.al=Ma;this.base.insert(cb,Rb);this.Ed.insert(ib,Aa);Ma=new u.a;Ma.add(new oa.AddParagraphUpdateHint(Ha.qf,
Ha.Ib,Oa,Ha.id,Ha.Qs));return{returnValue:!0,xs:Ma}}lKe(Ha){let Aa;Aa=null;let Ma;var cb;if(!({FFd:cb}=this.pwh(Ha,this.base,"Base")).returnValue)return{returnValue:!1,xs:Aa};if(!this.base.J(cb).al||!this.base.J(cb).al.oi.equals(Ha.qf))return x.a.instance.ua(17135243,1,2,"ApplyDeleteParaHintToBaseAndDerived: We don't support operation where same para was deleted or split para was deleted by one"),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0l"})),this.TZ=
!0,{returnValue:!1,xs:Aa};if(!({Obb:Ma}=this.NDc(this.base,this.Ed,cb,!0)).returnValue)return x.a.instance.ua(17135244,1,2,"ApplyDeleteParaHintToBaseAndDerived: Possibly bad merge hints provided"),{returnValue:!1,xs:Aa};if(0<Ma&&2!==this.Ed.J(Ma).type)return x.a.instance.ua(17135245,1,2,"ApplyDeleteParaHintToBaseAndDerived: Detected new or leftover content in the list"),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"bbx0n"})),this.TZ=!0,{returnValue:!1,xs:Aa};
const ib=this.Ed.J(Ma).oi,Rb=this.Ed.J(Ma).Ib;this.Ed.HD(Ma);this.base.HD(cb);({Ur:cb}=this.Dph(Ma));0<Ma&&6===this.Ed.J(Ma-1).type&&this.HCm(Ma-1,cb);Aa=new u.a;Aa.add(new ha.a(ib,Rb,cb,Ha.id,Ha.Qs));return{returnValue:!0,xs:Aa}}kTg(Ha,Aa,Ma){let cb;var ib=({Kca:Aa,Iqa:cb}=this.jCa(Ha,Ma,!0,Aa,!0,"ApplyInsertCpPlaceHolderHintToBaseAndDerived")).returnValue;if(0!==ib)return 3!==ib&&(x.a.instance.ua(590202208,1,2,"Fatal SplitTwinListAtCpForHint failure in ApplyInsertCpPlaceHolderHintToBaseAndDerived for mergeBlockSource {0}: {1}",
sa[Ma],ta[ib]),this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"9l2v6"}))),!1;({eca:ib}=ca(this.Ed,cb));ib=this.Ed.J(ib).oi;Ha=new Ca(Ma,Ha);Ma=new Ca(Ma,ib);Ha.al=Ma;Ma.al=Ha;this.base.insert(Aa,Ha);this.Ed.insert(cb,Ma);return!0}OXk(Ha,Aa,Ma){let cb,ib,Rb;cb=Ha.LYa.equals(Ha.qf)?this.Ed.J(Aa).oi:this.Ed.J(Ma).oi;Ha=Ha.MYa===Ha.Ib?this.Ed.J(Aa).Ib:this.Ed.J(Ma).Ib;ib=this.Ed.J(Aa).oi;Aa=this.Ed.J(Aa).Ib;Rb=this.Ed.J(Ma).oi;Ma=this.Ed.J(Ma).Ib;return{LYa:cb,
MYa:Ha,Lvf:ib,Qgm:Aa,vgm:Rb,wgm:Ma}}f8k(Ha,Aa){let Ma;var cb=Ha.qf.equals(Ha.Ur)?Ha.q3:Ha.Ur;const ib=Ha.Ib===Ha.xoa?Ha.C7:Ha.xoa;Ha.qf.equals(Ha.Ur)?Ma=this.Ed.J(Aa).oi:(Ma=cb,cb=this.Ed.J(Aa).oi);Ha.Ib===Ha.xoa?(Ha=this.Ed.J(Aa).Ib,Aa=ib):(Ha=ib,Aa=this.Ed.J(Aa).Ib);return{Ur:Ma,q3:cb,xoa:Ha,C7:Aa}}H0g(Ha,Aa,Ma,cb){for(;cb<Ha.length;cb++){if(!Ha.J(cb).L0()&&6!==Ha.J(cb).type&&2!==Ha.J(cb).type){x.a.instance.shipAssertTag(17311188,1,!1,"Found merge block of type "+Ha.J(cb).type);break}Ha.J(cb).oi=
Aa;if(2===Ha.J(cb).type){Ha.J(cb).Ib=Ma;break}}}G0g(Ha,Aa,Ma,cb,ib){this.H0g(Ha,Ma,cb,ib);Ya.I0g(Ha,Aa,ib)}F0g(Ha,Aa,Ma,cb){this.H0g(Ha,Aa,Ma,cb+1);Ya.I0g(Ha,Aa,cb)}zwh(Ha,Aa,Ma){let cb,ib=-1;if(!({eca:cb}=H(Aa,Ha.qf,0)).returnValue)return x.a.instance.ua(17342622,1,2,"GetIndicesForMergePara: Failed to find index of EOP in "+Ma+"for GraphNodeId "+Ha.qf),{returnValue:!1,GFd:cb};if(!({eca:ib}=ca(Aa,cb+1)).returnValue||!Aa.J(ib).oi.equals(Ha.q3))return x.a.instance.ua(17342623,1,2,"GetIndicesForMergePara: Failed to find index "+
cb+1+" in "+Ma+" of length "+Aa.length),{returnValue:!1,GFd:cb};this.F0g(Aa,Ha.LYa,Ha.MYa,cb);return{returnValue:!0,GFd:cb}}ywh(Ha,Aa,Ma){let cb;const ib=Ma?this.base:this.Ed,Rb=Ma?"Base":"Derived",Oa=({Kca:Aa,Iqa:Ma,Mba:cb}=this.jCa(Ha.qf,Aa,Ma,Ha.cp,!1,"GetIndicesAndCpForSplitPara")).returnValue;if(3===Oa||2===Oa)return x.a.instance.ua(17311189,1,2,"GetIndicesAndCpForSplitPara: Failed to find indices and Cp for "+Rb),{returnValue:Oa,tef:Aa,mLh:Ma,Mba:cb};this.G0g(ib,Ha.Ur,Ha.q3,Ha.C7,Aa);return{returnValue:Oa,
tef:Aa,mLh:Ma,Mba:cb}}pwh(Ha,Aa,Ma){return({idx:Ha}=W(Aa,Ha.qf)).returnValue?2!==Aa.J(Ha).type?(x.a.instance.ua(17156034,1,2,"GetIndexForDeletePara: Found merge block that is not a zero length merge block "+Ma),{returnValue:!1,FFd:-1}):{returnValue:!0,FFd:Ha}:(x.a.instance.ua(17156033,1,2,"GetIndexForDeletePara: Failed to find the para in "+Ma),{returnValue:!1,FFd:-1})}HCm(Ha,Aa){var Ma=this.Ed.J(Ha);if(Aa){let cb;({eca:cb}=H(this.Ed,Aa,0));Ma=Ma.clone();Ma.oi=Aa;this.Ed.HD(Ha);this.Ed.insert(cb,
Ma)}else this.Ed.length>Ha&&(this.Ed.J(Ha+1).L0()||2===this.Ed.J(Ha+1).type)&&(Ma.oi=this.Ed.J(Ha+1).oi)}jyh(Ha,Aa,Ma){var cb=Aa?this.base:this.Ed;Aa=Aa?"Base":"Derived";Ma=new A.a(Ma,Ha.qf,Ha.Ib);if(Ha.Ur){if(!({eca:cb}=H(cb,Ha.Ur,0)).returnValue)return x.a.instance.ua(17146333,1,2,"GetMergeBlockAndIndexToInsertForAddPara: We could not find [AboveParaId: {0}] in {1}",Ha.Ur,Aa),{returnValue:!1,Wrf:Ma,sef:cb};cb+=1}else cb=0;return{returnValue:!0,Wrf:Ma,sef:cb}}Dph(Ha){let Aa;Aa=null;let Ma=Ha-1;if(-1===
Ma)return{returnValue:!0,Ur:Aa};6===this.Ed.J(Ma).type&&Ma--;if(2===this.Ed.J(Ma).type||4===this.Ed.J(Ma).type)return Aa=this.Ed.J(Ma).oi,{returnValue:!0,Ur:Aa};x.a.instance.ua(17342934,1,2,"GetAboveParaIdFromDerived: We found an unexpected block [Type: {0}] above",this.Ed.J(Ha-1).type);return{returnValue:!1,Ur:Aa}}NDc(Ha,Aa,Ma,cb){let ib,Rb=!0;ib=-1;if(Ma>Ha.length)return x.a.instance.ua(17146334,1,2,"GetIndexInSecondary: Index supplied for the primary is out of bounds"),{returnValue:!1,Obb:ib};
if(Ma<Ha.length){if(-1<Ma&&Ma<Ha.length&&!Ha.J(Ma).al){Rb=!1;for(var Oa=Ma+1;Oa<Ha.length;Oa++)if(Ha.J(Oa).al){Ma=Oa;Rb=!0;break}}if(!Rb)return{returnValue:!1,Obb:ib};Rb=!1;for(Oa=0;Ha.J(Ma)&&Oa<Aa.length;Oa++)if(Aa.J(Oa).al===Ha.J(Ma)){ib=Oa;Rb=!0;break}if(!Rb)return{returnValue:!1,Obb:ib}}else ib=Aa.length;if(0<ib&&cb&&!Aa.J(ib-1).al){for(Ha=ib-1;0<=Ha&&!Aa.J(Ha).al;Ha--);ib=Ha+1;6===Aa.J(ib).type&&5!==this.Rc.input.source&&ib++}return{returnValue:!0,Obb:ib}}jCa(Ha,Aa,Ma,cb,ib,Rb){let Oa;var lb;
let gb;var Nb=this.base;let qc=this.Ed,Eb=!1;Ma||(Nb=this.Ed,qc=this.base);gb=lb=Oa=0;let ec,Jb,vb=0;if(!({wFc:cb,teb:ec,uNc:Jb}=K(Nb,Ha,cb)).returnValue)return x.a.instance.ua(17044295,1,2,"SplitTwinListAtCpForHint: Unable to find the merge block to split at given Cp. It most likely means that our update hints are not complete"),{returnValue:3,Kca:Oa,Iqa:lb,Mba:gb};0<=cb&&cb<Nb.length&&!Nb.J(cb).al&&ec&&!ib&&(x.a.instance.ua(17044296,1,3,"SplitTwinListAtCpForHint: We are trying to split a merge block that is deleted in the other revision. Failing merge. Called from {0}",
Rb),this.TZ=!0,vb=Aa===Nb.J(cb).source?1:2,Eb=!0);ib&&!Nb.J(cb)&&cb--;ib&&ec&&!Nb.J(cb).al&&(ec=!1,Jb=0);if(!Ma&&!({idx:Ha}=W(qc,Ha)).returnValue&&!ec)return{returnValue:0,Kca:cb,Iqa:lb,Mba:gb};if(!({Obb:Ha}=this.NDc(Nb,qc,cb,Ma&&!ec)).returnValue&&!Eb&&(Aa=!1,1===this.aKg&&0<cb&&!Jb&&(cb--,{Obb:Ha,returnValue:Aa}=this.NDc(Nb,qc,cb,Ma&&!ec),Aa&&(cb++,Ha<qc.length-1?Ha++:Aa=!1)),!Aa))return x.a.instance.ua(17156037,1,2,"SplitTwinListAtCpForHint: We are trying to find index in derived when the para most likley doesn't exist."),
this.Rc.logger.Cf(Object.assign(new fa.a,{Ph:"ParagraphMergeUsingHintsTwinList",eventId:"bb25f"})),this.TZ=!0,{returnValue:3,Kca:Oa,Iqa:lb,Mba:gb};if(ec&&(!O(Nb,cb,Jb)||!Eb&&!O(qc,Ha,Jb)))return x.a.instance.shipAssertTag(17044297,1,!1,"SplitTwinListAtCpForHint: Unable find the twin in secondary or unable to split the lists when a split was needed"),{returnValue:3,Kca:Oa,Iqa:lb,Mba:gb};Oa=cb;lb=Ha;ec&&(Oa=cb+1,Eb||(lb=Nb.J(cb),Ma=qc.J(Ha),lb.al=Ma,Ma.al=lb,Nb=Nb.J(cb+1),lb=qc.J(Ha+1),Nb.al=lb,lb.al=
Nb,lb=Ha+1));if(lb>=qc.length)return x.a.instance.shipAssertTag(17311190,1,!1,"SplitTwinListAtCpForHint: We are in bad state. indexInSecondary was "+lb+" secondaryList length was "+qc.length),{returnValue:3,Kca:Oa,Iqa:lb,Mba:gb};for(Nb=0;Nb<lb;Nb++)qc.J(Nb).oi.equals(qc.J(lb).oi)&&(gb+=qc.J(Nb).length);return{returnValue:vb,Kca:Oa,Iqa:lb,Mba:gb}}TWe(Ha,Aa,Ma){this.ebg.contains(Ha.id)&&this.v6a.Z(Ha.id,new u.a);for(--Ma;Ma>=Aa;Ma--)this.ebg.contains(Ha.id)?this.v6a.J(Ha.id).insert(this.v6a.J(Ha.id).length,
this.Ed.J(Ma)):this.Ed.J(Ma).al&&(this.Ed.J(Ma).al.al=null),this.Ed.HD(Ma)}hgf(Ha,Aa,Ma){if(this.v6a.Ja(Ha.Qs)){const cb=this.v6a.J(Ha.Qs);for(let ib=0;ib<cb.length;ib++)cb.J(ib).oi=Ma.oi,Object(ia.a)(A.a,Ma)&&Object(ia.a)(A.a,cb.J(ib))&&(cb.J(ib).Ib=Ma.Ib);this.Ed.ez(Aa,this.v6a.J(Ha.Qs));this.v6a.remove(Ha.Qs)}else this.Ed.insert(Aa,Ma)}gkl(Ha){let Aa,Ma;Ma=Aa=-1;if(!Ha.al)return{returnValue:!1,jXb:Aa,lXe:Ma};var cb;let ib=0,Rb=!1;if(!({idx:cb}=W(this.Ed,Ha.al.oi)).returnValue)return{returnValue:!1,
jXb:Aa,lXe:Ma};for(;cb<this.Ed.length;cb++){if(Ha.al===this.Ed.J(cb)){Aa=cb;Ma=ib;Rb=!0;break}ib+=this.Ed.J(cb).length}return{returnValue:Rb,jXb:Aa,lXe:Ma}}b2e(Ha){let Aa;Aa=new u.a;let Ma=0,cb=0;for(;Ma<Ha.length;){if(cb>=this.base.length)return x.a.instance.shipAssertTag(17335388,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),{returnValue:!1,Tcc:Aa};if(Ha.J(Ma).length>this.base.J(cb).length){if(!O(Ha,Ma,this.base.J(cb).length))return x.a.instance.ua(17335389,1,
2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision MergeBlock [Idx: {0}] at [Cp: {1}]",Ma,this.base.J(cb).length),{returnValue:!1,Tcc:Aa}}else if(Ha.J(Ma).length<this.base.J(cb).length){var ib=!!this.base.J(cb).al,Rb=0;if(ib&&!({Obb:Rb}=this.NDc(this.base,this.Ed,cb,!1)).returnValue)return x.a.instance.shipAssertTag(17335390,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Base Merge Block at [Idx: {0}] has a Twin, but we are unable to find it",cb),
{returnValue:!1,Tcc:Aa};if(!O(this.base,cb,Ha.J(Ma).length)||ib&&!O(this.Ed,Rb,Ha.J(Ma).length))return x.a.instance.ua(17335391,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split Base and/or Derived Merge blocks"),{returnValue:!1,Tcc:Aa};if(ib){ib=this.base.J(cb);var Oa=this.Ed.J(Rb);ib.al=Oa;Oa.al=ib;ib=this.base.J(cb+1);Rb=this.Ed.J(Rb+1);ib.al=Rb;Rb.al=ib}}if(this.base.J(cb).al&&5!==this.base.J(cb).type&&this.base.J(cb).L0()&&(Rb=this.base.J(cb),ib=Ha.J(Ma),!Rb.KG.equals(ib.KG)||
!Rb.HC.oy(ib.HC))){let lb;if(!({jXb:Oa,lXe:lb}=this.gkl(this.base.J(cb))).returnValue)return{returnValue:!1,Tcc:Aa};Aa.add(new qa(this.Ed.J(Oa).oi,lb,Rb,ib))}Ma++;cb++}return{returnValue:!0,Tcc:Aa}}static I0g(Ha,Aa,Ma){for(--Ma;0<=Ma;Ma--){if(!Ha.J(Ma).L0()&&6!==Ha.J(Ma).type){x.a.instance.shipAssertTag(17311187,1,2===Ha.J(Ma).type||4===Ha.J(Ma).type,"Found merge block of type "+Ha.J(Ma).type);break}Ha.J(Ma).oi=Aa}}static SRh(Ha){return Ha?!1:(x.a.instance.ua(17156036,1,2,"IsEmptyRunUpdateHint: We are trying to insert an empty run. It is likely we have bad merge hints."),
!0)}}Object(G.a)(Ya,"ParagraphMergeUsingHintsTwinList",null,[1927]);var Ka=b(1552),xa=b(1553),Sa=b(1549),pb=b(1551),Db=b(1550);class Ua{constructor(Ha,Aa,Ma,cb){this.cp=Ha;this.length=Aa;this.Wmd=Ma;this.TZc=cb}}Object(G.a)(Ua,"UpdateFormattingIdsPosInfo",null,[]);class Lb{constructor(Ha,Aa,Ma){this.TZ=!1;this.v6a=new r.a;this.Rc=Ha;this.aKg=Ma;this._base=Aa;this.age=aa(Aa);if(!R(this.base,this.Ed))throw x.a.instance.ua(574133956,1,2,"LcsTwinList ConnectList: Length not equal"),Ha.logger.Cf(Object.assign(new Q.a,
{info:"LcsTwinList ConnectList: Length not equal"})),Error.create("ConnectList");}get base(){return this._base}get Ed(){return this.age}get mergeConflict(){return this.TZ}MKe(Ha,Aa){switch(Ha.type){case 11:return this.EOj(Ha,Aa);case 8:return this.oKe(Ha,Aa);case 10:return this.mKe(Ha);default:return!1}}LKe(Ha,Aa){switch(Ha.type){case 11:return this.DOj(Ha,Aa);case 8:return this.nKe(Ha,Aa);case 10:return this.lKe(Ha);default:return{returnValue:!1,xs:null}}}lTg(){x.a.instance.ua(574433295,1,2,"ApplyInsertCpPlaceHolderHintToDerived not implemented");
this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ApplyInsertCpPlaceHolderHintToDerived",eventId:"8ps6p"}));return!1}kTg(){x.a.instance.ua(574433296,1,2,"ApplyInsertCpPlaceHolderHintToBaseAndDerived not implemented");this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ApplyInsertCpPlaceHolderHintToBaseAndDerived",eventId:"8ps6q"}));return!1}b2e(Ha){let Aa;Aa=new u.a;let Ma=0,cb=0,ib=0;for(;Ma<Ha.length;){if(cb>=this.base.length)return x.a.instance.shipAssertTag(574433297,1,!1,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: idxBase out of range"),
this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6r"})),{returnValue:!1,SZc:Aa};if(Ha.J(Ma).length>this.base.J(cb).length){if(!O(Ha,Ma,this.base.J(cb).length))return x.a.instance.ua(574433298,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split UnfavoredRevision"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6s"})),{returnValue:!1,SZc:Aa}}else if(Ha.J(Ma).length<
this.base.J(cb).length&&!this.q0a(ib+Ha.J(Ma).length,!0).returnValue)return x.a.instance.ua(574433299,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Unable to split"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ps6t"})),{returnValue:!1,SZc:Aa};if(this.base.J(cb).al&&5!==this.base.J(cb).type&&this.base.J(cb).L0()){const Rb=this.base.J(cb),Oa=Ha.J(Ma);if(!Rb.KG.equals(Oa.KG)||!Rb.HC.oy(Oa.HC)){let lb,gb;if(({jXb:lb,Ich:gb}=this.hkl(this.base.J(cb))).returnValue)Aa.add(new Ua(gb,
this.Ed.J(lb).length,Rb,Oa));else return x.a.instance.ua(571757956,1,2,"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo: Enable to find unfavored formatting"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"FindMergeBlocksInUnfavoredWithUpdatedFormattingInfo",eventId:"8ffwe"})),{returnValue:!1,SZc:Aa}}}ib+=this.base.J(cb).length;Ma++;cb++}return{returnValue:!0,SZc:Aa}}EOj(Ha,Aa){let Ma;if(!({Kxa:Ma}=this.q0a(Ha.cp,!0)).returnValue)return x.a.instance.ua(574433300,1,2,"ApplyInsertTextHintToDerived"),
this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ApplyInsertTextHintToDerived",eventId:"8ps6u"})),!1;for(let ib=0;ib<Ha.xX.length;ib++)switch(Ha.xX.J(ib).type){case 7:var cb=Ha.xX.J(ib);this.Ed.insert(Ma,new Za(Aa,null,cb.text,cb.id));break;case 9:cb=Ha.xX.J(ib);this.Ed.insert(Ma,new A.a(Aa,cb.qf,cb.Ib));break;default:return x.a.instance.ua(574433301,1,2,"ApplyInsertHintToDerived invalid hint"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ApplyInsertHintToDerived",eventId:"8ps6v"})),!1}return!0}oKe(Ha,
Aa){let Ma,cb;if(!({Kxa:Ma}=this.q0a(Ha.cp,!0)).returnValue||!({Kxa:cb}=this.q0a(Ha.cp+Ha.text.length,!1)).returnValue)return x.a.instance.ua(575706433,1,2,"ApplyDeleteTextHintToDerived"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ApplyDeleteTextHintToDerived",eventId:"8ujvb"})),!1;for(Ha=cb;Ha>=Ma;Ha--)this.Ed.J(Ha).source!==Aa&&this.atd(this.Ed,Ha);return!0}mKe(Ha){let Aa;if(!({Kxa:Aa}=this.q0a(Ha.cp,!0)).returnValue)return x.a.instance.ua(574433302,1,2,"ApplyDeleteParaHintToDerived"),this.Rc.logger.Cf(Object.assign(new Q.a,
{Ph:"ApplyDeleteParaHintToDerived",eventId:"8ps6w"})),!1;this.XWe(this.Ed,Ha,Aa);return!0}DOj(Ha,Aa){let Ma;Ma=null;let cb,ib;if(!({zsb:cb,Kxa:ib}=this.q0a(Ha.cp,!0)).returnValue)return x.a.instance.ua(574433303,1,2,"ApplyInsertTextHintToBaseAndDerived unable to split"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ApplyInsertTextHintToBaseAndDerived",eventId:"8ps6x"})),{returnValue:!1,xs:Ma};var Rb=this.B6e(this.Ed,ib-1);Rb=new Db.a(Rb);for(let Oa=0;Oa<Ha.xX.length;Oa++)switch(Ha.xX.J(Oa).type){case 7:Rb.xX.add(this.sKe(Ha.xX.J(Oa),
Aa,cb,ib));break;case 9:Rb.xX.add(this.FOj(Ha.xX.J(Oa),Aa,cb,ib));break;default:return x.a.instance.ua(574433304,1,2,"ApplyInsertHintToDerived invalid hint"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ApplyInsertHintToDerived",eventId:"8ps6y"})),{returnValue:!1,xs:Ma}}Ma=new u.a;Ma.add(Rb);return{returnValue:!0,xs:Ma}}sKe(Ha,Aa,Ma,cb){const ib=new Za(Aa,Ha.qf,Ha.text,Ha.id);Aa=new Za(Aa,Ha.qf,Ha.text,Ha.id);ib.al=Aa;Aa.al=ib;this.base.insert(Ma,ib);this.Ed.insert(cb,Aa);Ma=new pb.a(Ha.qf,Ha.text);
Ma.id=Ha.id;return Ma}FOj(Ha,Aa,Ma,cb){const ib=new A.a(Aa,Ha.qf,Ha.Ib);Aa=new A.a(Aa,Ha.qf,Ha.Ib);ib.al=Aa;Aa.al=ib;this.base.insert(Ma,ib);this.Ed.insert(cb,Aa);return new Sa.a(Ha.qf,Ha.Ib)}nKe(Ha){let Aa;Aa=new u.a;let Ma;var cb;let ib;if(!({zsb:Ma,Kxa:cb}=this.q0a(Ha.cp,!0)).returnValue||!({zsb:ib,Kxa:Rb}=this.q0a(Ha.cp+Ha.text.length,!1)).returnValue)return x.a.instance.ua(588001990,1,2,"ApplyDeleteTextHintToBaseAndDerived"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ApplyDeleteTextHintToBaseAndDerived",
eventId:"9ddlg"})),{returnValue:!1,xs:Aa};for(Ha=Rb;Ha>=cb;Ha--)if(this.Ed.J(Ha).al){var Rb=Ha;Aa.add(({Ggm:Ha}=this.aIk(Ha,cb)).returnValue);this.atd(this.Ed,Ha,Rb)}for(cb=ib;cb>=Ma;cb--)this.atd(this.base,cb);return{returnValue:!0,xs:Aa}}lKe(Ha){let Aa;Aa=null;let Ma,cb;if(!({zsb:Ma,Kxa:cb}=this.q0a(Ha.cp,!0)).returnValue)return x.a.instance.ua(574433305,1,2,"ApplyDeleteParaHintToBaseAndDerived"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps6z"})),
{returnValue:!1,xs:Aa};if(!this.XWe(this.base,Ha,Ma))return x.a.instance.ua(574433306,1,2,"ApplyDeleteParaHintToBaseAndDerived EOP mismatch"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ApplyDeleteParaHintToBaseAndDerived",eventId:"8ps60"})),{returnValue:!1,xs:Aa};this.XWe(this.Ed,Ha,cb)&&(Aa=new u.a,Aa.add(new Ka.a(this.B6e(this.Ed,cb-1),Ha.qf,Ha.Ib)));return{returnValue:!0,xs:Aa}}q0a(Ha,Aa){var Ma;var cb=Ma=-1;let ib,Rb;if(!({teb:Rb,eWg:Ha,dWg:ib}=J(this.base,Ha,this.Rc.logger)).returnValue)return{returnValue:!1,
zsb:Ma,Kxa:cb};const Oa=Ha>=this.base.length;Oa&&Ha--;if(this.base.J(Ha).al){const lb=this.wJk(this.Ed,this.base.J(Ha));if(Rb){if(0>lb||!O(this.base,Ha,ib)||!O(this.Ed,lb,ib))return x.a.instance.ua(575706444,1,2,"SplitTwinListAndFindIdx"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"SplitTwinListAndFindIdx",eventId:"8ujvm"})),{returnValue:!1,zsb:Ma,Kxa:cb};Ma=this.base.J(Ha);cb=this.Ed.J(lb);Ma.al=cb;cb.al=Ma;Ma=this.base.J(Ha+1);cb=this.Ed.J(lb+1);Ma.al=cb;cb.al=Ma;Ma=Aa?Ha+1:Ha;cb=Aa?lb+1:lb}else Aa?
(Ma=Oa?Ha+1:Ha,cb=Oa?lb+1:lb):(Ma=Oa?Ha:Ha-1,cb=Oa?lb:lb-1)}else if(Rb){if(O(this.base,Ha,ib))Ma=Aa?Ha+1:Ha;else return x.a.instance.ua(575706445,1,2,"SplitTwinListAndFindIdx"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"SplitTwinListAndFindIdx",eventId:"8ujvn"})),{returnValue:!1,zsb:Ma,Kxa:cb};Aa?(cb=({Gyb:cb}=this.wYb(this.base,this.Ed,Ha,!1)).returnValue?cb+1:0,cb=cb>=this.Ed.length?this.Ed.length-1:cb):(cb=({Gyb:cb}=this.wYb(this.base,this.Ed,Ha,!0)).returnValue?cb-1:this.Ed.length-1,cb=0>cb?
0:cb)}else Aa?(({Gyb:cb}=this.wYb(this.base,this.Ed,Ha,!0)).returnValue||(({Gyb:cb}=this.wYb(this.base,this.Ed,Ha,!1)).returnValue?cb+=1:(cb=Oa?this.Ed.length-1:0,cb=0>cb?0:cb)),Ma=Oa?Ha+1:Ha):(({Gyb:cb}=this.wYb(this.base,this.Ed,Ha,!1)).returnValue||(({Gyb:cb}=this.wYb(this.base,this.Ed,Ha,!0)).returnValue?--cb:(cb=Ha?this.Ed.length-1:0,cb=0>cb?0:cb)),Ma=Oa?Ha:Ha-1);return{returnValue:!0,zsb:Ma,Kxa:cb}}wYb(Ha,Aa,Ma,cb){let ib=null;if(cb)for(;Ma<Ha.length;Ma++){if(Ha.J(Ma).al){ib=Ha.J(Ma).al;break}}else for(;0<=
Ma;Ma--)if(Ha.J(Ma).al){ib=Ha.J(Ma).al;break}if(ib)for(Ha=0;Ha<Aa.length;Ha++)if(Aa.J(Ha)===ib)return Aa=Ha,{returnValue:!0,Gyb:Aa};return{returnValue:!1,Gyb:-1}}wJk(Ha,Aa){for(let Ma=0;Ma<Ha.length;Ma++)if(Ha.J(Ma).al===Aa)return Ma;return-1}atd(Ha,Aa,Ma=-1){for(Ma=0>Ma?Aa:Ma;Ma>=Aa;Ma--)Ha.J(Ma).al&&(Ha.J(Ma).al.al=null),Ha.HD(Ma)}B6e(Ha,Aa){let Ma=0;for(;0<=Aa;Aa--)Ma+=Ha.J(Aa).length;return Ma}Gil(Ha){Ha=Object(m.a)(Wa.a,Ha);Ha||(x.a.instance.ua(575706448,1,2,"GetTextBlock"),this.Rc.logger.Cf(Object.assign(new Q.a,
{Ph:"GetTextBlock",eventId:"8ujvq"})));return Ha}aIk(Ha,Aa){let Ma="";for(;Ha>=Aa&&this.Ed.J(Ha).al&&2!==this.Ed.J(Ha).type;)Ma=this.Gil(this.Ed.J(Ha)).text+Ma,Ha--;Aa=0>Ha?0:this.B6e(this.Ed,Ha);Ha+=1;return{returnValue:new xa.a(Aa,Ma),Ggm:Ha}}hkl(Ha){let Aa,Ma,cb=!1;Ma=Aa=0;if(!Ha.al)return{returnValue:!1,jXb:Aa,Ich:Ma};for(Aa=0;Aa<this.Ed.length;Aa++){if(this.Ed.J(Aa).al===Ha){cb=!0;break}Ma+=this.Ed.J(Aa).length}return{returnValue:cb,jXb:Aa,Ich:Ma}}XWe(Ha,Aa,Ma){Ma=Ma===Ha.length?--Ma:Ma;Ma>Ha.length-
1&&(x.a.instance.ua(571757957,1,2,"DeleteEopInList: Idx out of range"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"DeleteEopInList",eventId:"8ffwf"})));if(2===Ha.J(Ma).type){const cb=Ha.J(Ma);if(cb.oi!==Aa.qf||cb.Ib!==Aa.Ib)return!1;this.atd(Ha,Ma);return!0}return!1}}Object(G.a)(Lb,"ParagraphMergeUsingHintsTwinListLcs",null,[1927]);var Va=b(1381),Sb=b(1344),nb=b(1548);b.d(P,"a",function(){return La});class La{constructor(Ha,Aa,Ma,cb,ib,Rb,Oa=null,lb=null,gb=null){this.tN=this.roa=this.qEa=this.sma=
null;this._initialized=!1;this.Rc=Ha;this.WC=Aa;this.Vva=cb;this.Dua=Ma;this.Wma=ib;this.Obe=new f.a;for(Ha=0;Ha<this.WC.length;Ha++)this.Obe.add(this.WC.J(Ha).id);this.Xhg=new f.a;for(Ha=0;Ha<this.Dua.length;Ha++)this.Xhg.add(this.Dua.J(Ha).id);this.OJg=new f.a;for(Ha=0;Ha<this.Vva.length;Ha++)this.OJg.add(this.Vva.J(Ha).id);this.Hf=Rb;this.aFe=Oa||L.a.instance;this.dG=lb;this.eU=gb;this.xnb=1===(this.dG&&this.eU&&1===this.dG.TCa&&1===this.eU.TCa?1:0);this.Vma=0}get HMf(){return 1!==this.Vma}NBl(){var Ha=
!0;if(this.dG&&this.eU)return Ha;if(this.dG||this.eU)return x.a.instance.ua(593826832,1,2,"ParagraphMergeUsingHints.InitializeUpdateHints : Unexpected input to constructor: need to supply both or neither of favored and unfavored update hints, just supplying one is unsupported"),!1;this.Rc.runtime.xr.Ja(F.a.dJ)&&(Ha=this.Rc.runtime.xr.J(F.a.dJ),Ha=this.O1f(Ha,this.Rc.runtime.Xwa.id,"favored")&&({updateHints:this.dG}=this.XMh(Ha,this.Obe,this.Xhg,this.Rc.runtime.xr,"favored")).returnValue);Ha&&this.Rc.runtime.So.Ja(F.a.dJ)&&
(Ha=this.Rc.runtime.So.J(F.a.dJ),Ha=this.O1f(Ha,this.Rc.runtime.Xwa.id,"unfavored")&&({updateHints:this.eU}=this.XMh(Ha,this.Obe,this.OJg,this.Rc.runtime.So,"unfavored")).returnValue);this.dG=this.dG?this.dG:new nb.a(new u.a,0);this.eU=this.eU?this.eU:new nb.a(new u.a,0);Ha&&this.Rc.input.Y0b&&(Ha=this.Rc.input.C1.last().XVa(F.a.dJ),Ha=this.O1f(Ha,this.Rc.input.C1.last().A_.id,"alreadyMerged"));return Ha}Yzl(){const Ha=new f.a;if(this.xnb)return Ha;const Aa=this.dG?this.dG.updateHints.s1():new u.a;
let Ma=0;for(;Ma<Aa.length-1;){const cb=Aa.J(Ma);let ib,Rb=!1;for(ib=Ma+1;ib<Aa.length;ib++){const Oa=Aa.J(ib);if(cb.lTh(Oa)){Ha.add(cb.id);Aa.HD(ib);Aa.HD(Ma);Rb=!0;break}}Rb||Ma++}return Ha}O1f(Ha,Aa,Ma){Ha=this.Hf.getPropertyString(Ha,k.a.$Na);Ha=w.a.Ee(Ha);return Aa.equals(Ha)?!0:(this.oVc(2),x.a.instance.ua(17162307,1,2,"ParagraphMergeUsingHints: ValidateUpdateHintsContainerBaseId returned failure [MergeBaseId: {0}] [UpdateHintsContainerBaseId: {1}] [RevisionType: {2}]",this.Rc.runtime.Xwa.id,
Ha,Ma),!1)}XMh(Ha,Aa,Ma,cb,ib){let Rb;Rb=new nb.a(new u.a,0);Ha=this.Hf.getPropertyObjectIds(Ha,k.a.ZY).s1();for(let lb=0;lb<Ha.length;lb++){if(!cb.Ja(Ha.J(lb)))return x.a.instance.ua(17044257,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to find [UpdateHintObject: {0}] in [RevisionType: {1}]",Ha.J(lb),ib),{returnValue:!1,updateHints:Rb};const gb=cb.J(Ha.J(lb));var Oa=w.a.Ee(this.Hf.getPropertyString(gb,k.a.afa));if(Aa.contains(Oa)||Ma.contains(Oa)){Oa=this.aFe.fFc(gb);
if(!Oa)return x.a.instance.ua(17044258,1,2,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs unable to create a updateHint for [UpdateHintObject: {0}]  in [RevisionType: {1}]",gb.id,ib),{returnValue:!1,updateHints:Rb};Rb.updateHints.add(Oa)}}0<Ha.length&&x.a.instance.ua(17162308,1,4,"ParagraphMergeUsingHints: InitializeUpdateHintsListForParagraphs for [RevisionType: {0}] [UpdateHintIds: {1}] [UpdateHints: {2}]",ib,Ha.xp(),Rb.updateHints.xp());return{returnValue:!0,updateHints:Rb}}YAl(){return({bI:this.sma,
qBc:this.qEa,oZc:this.roa}=Va.a.A9g(this.Rc,this.Hf,this.WC,this.Dua,this.Vva,this.Wma,!0,!0)).returnValue?!0:!1}KBl(Ha){const Aa=Va.a.Krd(this.Hf,Ma=>this.Rc.runtime.Ci.J(Ma),this.WC,1,this.Wma,!0,!0).returnValue;if(!Aa)return x.a.instance.ua(17044259,1,2,"InitializeTwinTextMergeBlocks:Unable to create merge blocks for the base or derived"),!1;this.tN=this.xnb?new Lb(this.Rc,Aa,1):new Ya(this.Rc,Aa,Ha,this.dG?this.dG.TCa:0);return!0}initialize(){if(this._initialized)return!1;this._initialized=!0;
if(!this.NBl()||!this.YAl())return!1;const Ha=this.Yzl();return this.KBl(Ha)?!0:!1}lyh(Ha){const Aa=new u.a;let Ma="";for(let cb=0;cb<Ha.length;cb++){const ib=Ha.J(cb);ib.L0()?Ma+=Ha.J(cb).text:2===ib.type?(Aa.add(new la(ib.oi,ib.type,Ma,ib.Ib)),Ma=""):4===ib.type&&(Aa.add(new la(ib.oi,ib.type)),Ma="")}return Aa}validateUpdateHintsAreComplete(Ha,Aa,Ma){Aa=this.lyh(Aa);Ha=this.lyh(Ha);let cb=Aa.length===Ha.length;if(cb)for(let ib=0;ib<Aa.length;ib++)if(!Aa.J(ib).isEqual(Ha.J(ib))){cb=!1;break}cb||
(this.oVc(4),x.a.instance.ua(17044288,1,2,"ValidateUpdateHintsAreComplete: Validation of update hints from [Revision: {0}] was unsuccessful [MergeValidationState: {1}] [RevisionValidationState: {2}]",Ma,Ha.xp(),Aa.xp()));return cb}RTg(Ha,Aa,Ma){(Aa=({n1a:Ha}=this.MPj(Ha,Aa,Ma)).returnValue)||this.oVc(this.tN.mergeConflict?1:3);return{returnValue:Aa,n1a:Ha}}MPj(Ha,Aa,Ma){let cb;cb=new u.a;let ib=!0;var Rb=0;let Oa=null,lb=this.dG?this.dG.updateHints.length:0;for(var gb=0;gb<lb&&ib;gb++)Oa=this.dG.updateHints.J(gb),
Rb<this.eU.updateHints.length&&Oa.id.equals(this.eU.updateHints.J(Rb).id)&&5!==this.Rc.input.source?({returnValue:ib}=this.tN.LKe(Oa,2),Rb++):ib=this.tN.MKe(Oa,2);if(!ib)return x.a.instance.ua(17044289,1,2,"ApplyUpdateHints: Failed to apply favored [UpdateHint: {0}]",Oa.toString()),{returnValue:!1,n1a:cb};if(!this.validateUpdateHintsAreComplete(this.tN.Ed,this.qEa,"Favored"))return{returnValue:!1,n1a:cb};if(Ha&&1===this.Rc.input.S0&&!this.tN.lTg(Aa,Ma,2))return x.a.instance.ua(17409920,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",
Aa,Ma),{returnValue:!1,n1a:cb};ib=!0;gb=new u.a;for(lb=this.eU?this.eU.updateHints.length:0;Rb<lb&&ib;Rb++){Oa=this.eU.updateHints.J(Rb);let Nb;({xs:Nb,returnValue:ib}=this.tN.LKe(Oa,4));ib&&Nb&&gb.ez(gb.length,Nb)}return ib?this.validateUpdateHintsAreComplete(this.tN.base,this.roa,"Unfavored")?Ha&&2===this.Rc.input.S0&&!this.tN.kTg(Aa,Ma,4)?(x.a.instance.ua(17409921,1,2,"ApplyUpdateHints: Unable to insert placeholder Cp in [ParaId: {0}] [Cp: {1}]",Aa,Ma),{returnValue:!1,n1a:cb}):{returnValue:!0,
n1a:gb}:{returnValue:!1,n1a:cb}:(x.a.instance.ua(17044291,1,2,"ApplyUpdateHints: Failed to apply unfavored [UpdateHint: {0}] [Type: {1}]",Oa.id,Oa.type),{returnValue:!1,n1a:cb})}R6k(){let Ha,Aa=0;let Ma=0,cb=w.a.nil;for(Ha=new r.a;Ma<this.tN.base.length;){const Oa=this.tN.base.J(Ma);cb.equals(Oa.oi)||(Aa=0,cb=Oa.oi);if(5===Oa.type){var ib=Aa+Oa.length;var Rb=void 0;let lb;const gb=aa(this.roa);if(!({index:Rb}=N(gb,Oa.oi,Aa)).returnValue||!({index:lb}=N(gb,Oa.oi,ib)).returnValue)return x.a.instance.ua(17335384,
1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks from unfavored to insert in favored for [UpdateHintId: {0}]",Oa.CZc),{returnValue:!1,a5h:Ha};for(ib=new u.a;Rb<lb;Rb++)ib.add(gb.J(Rb));Ha.Z(Oa.CZc,ib)}Aa+=Oa.length;Ma++}return{returnValue:!0,a5h:Ha}}S6k(){let Ha;Ha=new r.a;let Aa=0;for(let cb=0;cb<this.tN.base.length;cb++){const ib=this.tN.base.J(cb);if(5===ib.type){var Ma=void 0;let Rb;const Oa=aa(this.roa);if(!({index:Ma}=V(Oa,Aa,this.Rc.logger)).returnValue||!({index:Rb}=
V(Oa,Aa+ib.length,this.Rc.logger)).returnValue)return x.a.instance.ua(574433309,1,2,"GetMergeBlocksToInsertForUnfavoredUpdateHints: Unable to extract merge blocks"),{returnValue:!1,b5h:Ha};const lb=new u.a;for(;Ma<Rb;Ma++)lb.add(Oa.J(Ma));Ha.Z(ib.CZc,lb)}Aa+=ib.length}return{returnValue:!0,b5h:Ha}}YOj(Ha){let Aa;Aa=new u.a;let Ma;if(this.xnb){if(!({b5h:Ma}=this.S6k()).returnValue)return{returnValue:!1,cNc:Aa}}else if(!({a5h:Ma}=this.R6k()).returnValue)return{returnValue:!1,cNc:Aa};let cb;cb=this.xnb?
new Lb(this.Rc,aa(this.qEa),1):new Ya(this.Rc,aa(this.qEa),new f.a,this.dG?this.dG.TCa:0);for(var ib=0;ib<Ha.length;ib++)if(!cb.MKe(Ha.J(ib),4))return{returnValue:!1,cNc:Aa};for(Ha=cb.Ed.length-1;0<=Ha;Ha--)5===cb.Ed.J(Ha).type&&(ib=cb.Ed.J(Ha).CZc,cb.Ed.HD(Ha),cb.Ed.ez(Ha,Ma.J(ib)));this.xnb&&(this.gbh(cb.Ed),this.gbh(this.tN.Ed));if(!this.validateUpdateHintsAreComplete(this.tN.Ed,cb.Ed,"Merged"))return{returnValue:!1,cNc:Aa};Aa=cb.Ed;return{returnValue:!0,cNc:Aa}}gbh(Ha){const Aa=new r.a;for(let Ma=
Ha.length-1;0<=Ma;Ma--){const cb=Object(m.a)(A.a,Ha.J(Ma));cb&&(Aa.Ja(cb.Ib)?Aa.J(cb.Ib).source!==cb.source&&Ha.HD(Ma):Aa.add(cb.Ib,cb))}}LPj(Ha){let Aa;if(!({SZc:Aa}=this.tN.b2e(aa(this.roa))).returnValue)return!1;for(let cb=0;cb<Aa.length;cb++){const ib=Aa.J(cb);let Rb,Oa;if(!({index:Rb}=V(Ha,ib.cp,this.Rc.logger)).returnValue||!({index:Oa}=V(Ha,ib.cp+ib.length,this.Rc.logger)).returnValue)return x.a.instance.ua(572379488,1,2,"ApplyUnfavoredFormattingChangesLcs: Unable to split"),this.Rc.logger.Cf(Object.assign(new Q.a,
{Ph:"ApplyUnfavoredFormattingChangesLcs",eventId:"8h3f6"})),!1;var Ma=!1;for(let lb=Rb;lb<Oa&&!Ma;lb++)Ma=!ib.Wmd.KG.equals(Ha.J(lb).KG);if(!Ma){for(Ma=Rb;Ma<Oa;Ma++)Ha.HD(Rb);Ha.insert(Rb,ib.TZc)}}return!0}KPj(Ha){let Aa;if(!({Tcc:Aa}=this.tN.b2e(aa(this.roa))).returnValue)return!1;for(let ib=0;ib<Aa.length;ib++){var Ma=Aa.J(ib);let Rb,Oa;if(({index:Rb}=N(Ha,Ma.qf,Ma.cp)).returnValue&&({index:Oa}=N(Ha,Ma.qf,Ma.cp+Ma.TZc.length)).returnValue){var cb=!1;for(let lb=Rb;lb<Oa&&!cb;lb++)cb=!Ma.Wmd.KG.equals(Ha.J(lb).KG)||
!Ma.Wmd.HC.oy(Ha.J(lb).HC);if(cb){if(this.dG&&1===this.dG.TCa||this.eU&&1===this.eU.TCa)return!1}else{for(cb=Rb;cb<Oa;cb++)Ha.HD(Rb);Ha.insert(Rb,Ma.TZc)}}else if(Ma=Ma.TZc.QGl,x.a.instance.ua(51500353,1,2,"ApplyUnfavoredFormattingChanges: Unable to find corresponding merge blocks with update formatting in merged list. IsEmbeddedObject {0}",Ma),Ma||this.dG&&1===this.dG.TCa||this.eU&&1===this.eU.TCa)return!1}return!0}yal(Ha){let Aa,Ma;Ma=new u.a;Aa=this.Rc.runtime.Xk.J(F.a.dJ);let cb;({dsf:cb}=La.Zph(this.Rc,
this.Hf));const ib=new u.a;for(let Oa=0;Oa<Ha.length;Oa++){if(cb.contains(Ha.J(Oa).id,(gb,Nb)=>gb.equals(Nb)))continue;if(this.Rc.runtime.Xk.Ja(Ha.J(Oa).id))return x.a.instance.shipAssertTag(17044293,1,!1,"[UpdateHint: {0}] is already in the merged object. Failing merge.",Ha.J(Oa).id),{returnValue:!1,RTd:Aa,QTd:Ma};ib.add(Ha.J(Oa).id);var Rb=Ha.J(Oa).aWa();const lb=new Sb.a(Rb);Rb=Rb.zi();for(const gb of Rb)lb.Kz(gb);Ma.add(lb)}Ha=this.Hf.getPropertyObjectIds(Aa.ik,k.a.ZY);Ha.ez(Ha.length,ib);this.Hf.setPropertyObjectIds(Aa.ik,
k.a.ZY,Ha);return{returnValue:!0,RTd:Aa,QTd:Ma}}wzd(Ha){return String.format("Name: {0}, Message: {1}, Stack: {2}",Ha.name,Ha.message,Ha.stack)}oVc(Ha){0===this.Vma&&(this.Vma=Ha)}Ecc(){let Ha;Ha=null;let Aa,Ma;var cb;try{if({Xk:Ha,RTd:Aa,QTd:Ma,returnValue:cb}=this.gHn(),cb){if(Aa&&Ma){this.Rc.runtime.Xk.Z(Aa.ik.id,Aa);for(cb=0;cb<Ma.length;cb++){const lb=Ma.J(cb);this.Rc.runtime.Xk.Z(lb.ik.id,lb)}const ib=Aa.ik,Rb=this.Hf.getPropertyObjectIds(ib,k.a.ZY),Oa=this.Hf.getPropertyString(ib,k.a.$Na);
x.a.instance.ua(17162312,1,4,"ParagraphMergeUsingHints returned success [UpdateHintsContainerNodeIds: {0}] [UpdateHintsContainerBaseId: {1}]",Rb.xp(),Oa)}else x.a.instance.ua(593826831,1,4,"ParagraphMergeUsingHints returned success and did not update UpdateHint objects");return{returnValue:!0,Xk:Ha}}}catch(ib){x.a.instance.ua(17162313,1,2,"ParagraphMergeUsingHints Crashed! Retrying ParagraphMerge [{0}]",this.wzd(ib))}this.oVc(5);x.a.instance.ua(17409922,1,2,"TryDoMerge: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.Vma,this.HMf);this.yYa();this.dG&&1===this.dG.TCa&&this.Rc.logger.Cf(Object.assign(new ja.a,{eventId:"bc04c",Ph:"ParagraphMergeUsingHints.TryDoMerge",info:l[this.Vma]+"/LCS"}));return{returnValue:!1,Xk:Ha}}gHn(){let Ha,Aa,Ma;Ma=Aa=Ha=null;let cb;cb=this.initialize();this.Rc.logger.YR("PMUH Initialize");let ib=null;cb=cb&&({n1a:ib}=this.RTg(!1,w.a.nil,0)).returnValue;this.Rc.logger.YR("PMUH ApplyUpdateHints");let Rb=new u.a;cb=cb&&({cNc:Rb}=this.YOj(ib)).returnValue;this.Rc.logger.YR("PMUH ApplyMergedUnfavoredHintsToFavoredToMergeFavoredFormattingChanges");
cb=this.xnb?cb&&this.LPj(Rb):cb&&this.KPj(Rb);this.Rc.logger.YR("PMUH ApplyUnfavoredFormattingChanges");this.xnb&&!this.A4m(Rb)&&(x.a.instance.shipAssertTag(571552961,1,!1,"ReuseParaIdsIfPossible"),this.Rc.logger.Cf(Object.assign(new Q.a,{Ph:"ReuseParaIdsIfPossible",eventId:"8ettb"})),cb=!1);const Oa=this.dBd(Rb);cb=cb&&({PTd:Ha}=Va.a.ZDc(this.Rc,this.Hf,this.Wma,Rb,Oa)).returnValue;this.Rc.logger.YR("PMUH GetMergeableObjectsFromMergeBlocks");this.dG&&1===this.dG.TCa&&this.eU&&1===this.eU.TCa||(cb=
cb&&({RTd:Aa,QTd:Ma}=this.yal(E(ib))).returnValue,this.Rc.logger.YR("PMUH GetPartialMergeResultForUpdateHintNodes"));return{returnValue:cb,mergeConflict:!!this.tN&&this.tN.mergeConflict,Xk:Ha,RTd:Aa,QTd:Ma}}dBd(Ha){const Aa=new u.a;for(let Ma=0;Ma<Ha.length;Ma++)2===Ha.J(Ma).type&&Aa.add(Ha.J(Ma).oi);return Aa}o7e(Ha){const Aa=new u.a;for(let Ma=0;Ma<Ha.length;Ma++)2===Ha.J(Ma).type&&Aa.add(Ha.J(Ma));return Aa}A4m(Ha){var Aa=this.o7e(this.sma),Ma=this.o7e(this.qEa),cb=this.o7e(this.roa),ib=this.dBd(Aa),
Rb=this.dBd(Ma),Oa=this.dBd(cb);Rb=M.b(ib,Rb,Oa);ib=new u.a;for(Oa=0;Oa<Rb.length;Oa++)ib.ez(ib.length,Rb.J(Oa).yJk());Rb=this.DJk(Ha);Aa=this.zJk(Rb,ib,Aa,Ma,cb);Ma=0;cb=new f.a;for(ib=0;ib<Ha.length;ib++)if(Rb=Ha.J(ib),2===Rb.type)if(cb.contains(Rb.oi))if(Ma<Aa.length)Ha.HD(ib),Ha.insert(ib,Aa.J(Ma)),Ma++;else return!1;else cb.add(Rb.oi);0<Ha.length&&2!==Ha.J(Ha.length-1).type&&Ma<Aa.length&&Ha.insert(Ha.length,Aa.J(Ma));return!0}DJk(Ha){const Aa=new f.a;for(let Ma=0;Ma<Ha.length;Ma++)2===Ha.J(Ma).type&&
Aa.add(Ha.J(Ma).oi);return Aa}zJk(Ha,Aa,Ma,cb,ib){const Rb=new u.a;for(let Oa=0;Oa<Aa.length;Oa++){const lb=Aa.J(Oa);if(!Ha.contains(lb)){let gb;(({block:gb}=this.U1e(cb,lb)).returnValue||({block:gb}=this.U1e(ib,lb)).returnValue||({block:gb}=this.U1e(Ma,lb)).returnValue)&&gb&&Rb.add(gb)}}return Rb}U1e(Ha,Aa){for(let Ma=0;Ma<Ha.length;Ma++)if(2===Ha.J(Ma).type&&Ha.J(Ma).oi===Aa)return Ha=Ha.J(Ma),{returnValue:!0,block:Ha};return{returnValue:!1,block:null}}yYa(){const Ha=new u.a;Va.a.U4b(this.Hf,"BaseObjects_",
this.WC,Ha);Va.a.U4b(this.Hf,"FavoredObjects_",this.Dua,Ha);Va.a.U4b(this.Hf,"ConflictObjects_",this.Vva,Ha)}X_j(){let Ha,Aa;Ha=w.a.nil;Aa=-1;let Ma=0;for(let cb=0;cb<this.tN.Ed.length;cb++){const ib=this.tN.Ed.J(cb);if(ib.L0())Ma+=ib.length;else if(6!==ib.type)Ma=0;else return Ha=ib.oi,Aa=Ma,{returnValue:!0,objectId:Ha,cp:Aa}}x.a.instance.ua(17409923,1,2,"CalculatePositionOfPlaceHolderCp: Unable to find placeholder Cp");return{returnValue:!1,objectId:Ha,cp:Aa}}zZc(Ha,Aa){let Ma,cb;cb=Aa;Ma=Ha;try{let ib=
this.initialize();if(ib=(ib=ib&&this.RTg(!0,Ha,Aa).returnValue)&&({objectId:Ma,cp:cb}=this.X_j()).returnValue)return x.a.instance.ua(17409924,1,4,"UpdateCpAccordingToIncomingChange returned success [ResultObjectId: {0}] [ResultCp: {1}]",Ma,cb),{returnValue:!0,o_a:Ma,Vka:cb}}catch(ib){x.a.instance.ua(17409925,1,2,"UpdateCpAccordingToIncomingChange Crashed! Retrying using the old method [{0}]",this.wzd(ib))}this.oVc(5);x.a.instance.ua(17409926,1,2,"UpdateCpAccordingToIncomingChange: ParagraphMergeUsingHints returned failure [MergeFailureReason:{0}] [RetryMergeWithoutHints:{1}]",
this.Vma,this.HMf);this.yYa();return{returnValue:!1,o_a:Ma,Vka:cb}}static Zph(Ha,Aa){let Ma;Ma=new u.a;if(!Ha.input.Y0b)return{returnValue:!0,dsf:Ma};Ha=Ha.input.C1.last().XVa(F.a.dJ);Ma=Aa.getPropertyObjectIds(Ha,k.a.ZY);return{returnValue:!0,dsf:Ma}}static hDm(Ha){if(!Va.a.ZYe(Ha))return!0;const Aa=new z.a;Ha.runtime.Xk.Z(F.a.dJ,Va.a.OBl(Ha,Aa));return!0}static RCm(Ha){if(!Ha.runtime.Xk.Ja(F.a.dJ)||!Ha.runtime.So.Ja(F.a.dJ))return!0;const Aa=new z.a,Ma=Ha.runtime.Xk.J(F.a.dJ);var cb=Aa.getPropertyString(Ma.ik,
k.a.$Na);if(w.a.Ee(cb).equals(w.a.nil))return!0;cb=Aa.getPropertyObjectIds(Ma.ik,k.a.ZY);const ib=Aa.getPropertyObjectIds(Ha.runtime.So.J(F.a.dJ),k.a.ZY);let Rb;({dsf:Rb}=La.Zph(Ha,Aa));for(let Oa=0;Oa<ib.length;Oa++)cb.contains(ib.J(Oa),(lb,gb)=>lb.equals(gb))||Rb.contains(ib.J(Oa),(lb,gb)=>lb.equals(gb))||(cb.add(ib.J(Oa)),Ha.runtime.Xk.Z(ib.J(Oa),new Sb.a(Ha.runtime.So.J(ib.J(Oa)).dF())));Aa.setPropertyObjectIds(Ma.ik,k.a.ZY,cb);return!0}}Object(G.a)(La,"ParagraphMergeUsingHints",null,[1868])},
1466:function(G,P,b){G=b(0);class k{constructor(m){this.M7h=m;this.succeeded=!1;this.wcc=m?m.wcc:0;this.yTl=!1;this.length=this.lBn=0}}Object(G.a)(k,"TrieResult",null,[]);class f{constructor(m,l,z){this.Wdb=new k(null);this.G9l=m;this.yMc=l;this.P2h=l+z-1}get result(){return this.Wdb}Dyh(){let m;return this.yMc<=this.P2h?(m=this.G9l.charAt(this.yMc),++this.yMc,{returnValue:!0,ch:m}):{returnValue:!1,ch:"\x00"}}uJf(m,l,z){m&&(this.Wdb.yTl=!0,this.Wdb.lBn=l);this.Wdb.length=this.yMc;this.Wdb.succeeded=
!0;this.Wdb.wcc=z;this.yMc!==this.P2h+1&&(this.Wdb=new k(this.Wdb))}}Object(G.a)(f,"LookUpStringVisitor",null,[1192]);var x=b(1565);class u{constructor(){this.l0g=this.NYg=this.PYg=this.MYg=this.OYg=this.RNe=this.PNe=this.TNe=this.ONe=0}}Object(G.a)(u,"TRIESTATS",null,[]);class w{constructor(){this.symbol=this.TNc=0}}Object(G.a)(w,"TrieSymbol",null,[]);b.d(P,"a",function(){return r});class r{constructor(m,l){this.P0=null;this.INd=this.d3h=this.b3h=this.f3h=this.Y2h=this.e3h=this.c3h=this.g3h=this.Z2h=
0;this.aH=m;if(m.Cw(l,4)!==r.Osb)throw Error.argument("Input does not represent a trie");l+=4;this.R2h=1===m.Cw(l,4);l+=4;this.D9l=1===m.Cw(l,4);l+=4;this.z9l=m.Cw(l,4);l+=4;if(m.Cw(l,4)){m=l+4;this.P0=this.eNm(m);this.Z2h=l=m+r.uZj;this.g3h=l+=r.Rnd*(this.P0.ONe+(this.P0.ONe%2?1:0));this.c3h=l+=r.Rnd*(this.P0.TNe+(this.P0.TNe%2?1:0));this.e3h=l+=r.Rnd*(this.P0.PNe+(this.P0.PNe%2?1:0));this.Y2h=l+=r.Rnd*(this.P0.RNe+(this.P0.RNe%2?1:0));this.f3h=l+=r.VNe*this.P0.MYg;this.b3h=l+=r.WNe*this.P0.PYg;
this.d3h=l+=r.WNe*this.P0.NYg;l+=r.WNe*this.P0.OYg;if(l!==m+this.P0.l0g)throw Error.argument("Corrupted trie binary");this.INd=l}else this.P0=null}o2h(m,l,z,F){m=new f(m,l,z);this.vYi(m,F);return m.result}lDh(m){if(this.R2h)if(m)--m;else return"";if(!this.P0)throw Error.argument("Invalid trieID");const l=new x.a;l.RC=0;this.qIb(l);const z=[];for(;;){if(l.RC&r.Y1a)if(m)--m;else return Array.add(z,l.lJb),String.fromCharCode.apply(null,z);const F=!!(l.RC&r.g$d),L=this.AZb(l,!0);if(F||m<L){if(Array.add(z,
l.lJb),!this.qIb(l))throw Error.argument("Invalid trieID");}else if(m-=L,!this.TYc(l))throw Error.argument("Invalid trieID");}}vYi(m,l){let z=0;this.R2h&&(m.uJf(this.D9l,this.z9l,0),++z);if(this.P0){var F=new x.a;F.RC=0;if(this.qIb(F))for(;;){var L=void 0;if(!({ch:L}=m.Dyh()).returnValue)break;l&&(L=l(L));L=L.toString().charCodeAt(0);let E=!1;for(;!E;){const A=!!(F.RC&r.Y1a);if(F.lJb===L){if(E=!0,A&&m.uJf(!!(F.RC&r.w7f),F.G4d,z),!this.qIb(F))return}else if(z+=this.AZb(F,!0),!this.TYc(F))return;A&&
++z}}}}qIb(m){if(!m.RC)return this.fZf(m),!0;if(!(m.RC&r.f$d))return!1;m.FJa=0;m.Hv=m.Nbb;this.fZf(m);return!0}TYc(m){if(m.RC&r.g$d)return!1;this.fZf(m);return!0}AZb(m,l){return m.RC&r.v7f?m.Qnd:m.RC&r.f$d?!l&&m.RC&r.g$d?this.eXk(m):1:0}eXk(m){m=r.pQe(m);if(!this.qIb(m))return 0;let l=0;do m.RC&r.Y1a&&++l,l+=this.AZb(m,!1);while(this.TYc(m));return l}fZf(m){m.RC||(m.FJa=0,m.Hv=this.INd);var l=this.Jsd(this.Z2h,m.Hv),z=l.symbol;m.Hv+=l.TNc;l=this.aH.Cw(this.Y2h+r.VNe*z,r.VNe);m.lJb=l&65535;m.RC=l>>
16;m.RC&r.v7f&&(m.Qnd=this.hpk(m));m.RC&r.w7f&&(l=this.Jsd(this.g3h,m.Hv),z=l.symbol,m.Hv+=l.TNc,m.G4d=this.aH.Cw(this.f3h+4*z,4));m.RC&r.H4i?(m.Nbb=this.INd+((this.aH.J(m.Hv)<<8|this.aH.J(m.Hv+1))<<8|this.aH.J(m.Hv+2)),m.Hv+=3):m.RC&r.I4i?(m.Nbb=m.Hv,m.FJa=m.Nbb):m.RC&r.J4i?(l=this.Jsd(this.c3h,m.Hv),z=l.symbol,m.Hv+=l.TNc,m.Nbb=this.INd+this.aH.Cw(this.b3h+4*z,4)):m.RC&r.f$d&&(l=this.Jsd(this.e3h,m.Hv),z=l.symbol,m.Hv+=l.TNc,m.FJa||(m.FJa=m.Hv),m.FJa+=this.aH.Cw(this.d3h+4*z,4),m.Nbb=m.FJa)}Jsd(m,
l){const z=new w;let F=0;for(;;){F+=this.aH.J(l);++l;++z.TNc;const L=this.aH.Cw(m,2);if(F<L)break;z.symbol+=L;F-=L;m+=2;F<<=8}z.symbol+=F;return z}hpk(m){let l=this.aH.J(m.Hv);192<=l?(l=(l&63)<<15|(this.aH.J(m.Hv+1)&127)<<8,l|=this.aH.J(m.Hv+2),m.Hv+=3):128<=l?(l=(l&127)<<8|this.aH.J(m.Hv+1),m.Hv+=2):m.Hv+=1;return l}eNm(m){const l=new u;l.ONe=this.aH.Cw(m+12,2);l.TNe=this.aH.Cw(m+14,2);l.PNe=this.aH.Cw(m+16,2);l.RNe=this.aH.Cw(m+18,2);l.OYg=this.aH.Cw(m+24,4);l.MYg=this.aH.Cw(m+28,4);l.PYg=this.aH.Cw(m+
32,4);l.NYg=this.aH.Cw(m+36,4);l.l0g=this.aH.Cw(m+40,4);return l}static pQe(m){const l=new x.a;l.lJb=m.lJb;l.RC=m.RC;l.Qnd=m.Qnd;l.Hv=m.Hv;l.Nbb=m.Nbb;l.FJa=m.FJa;l.G4d=m.G4d;return l}}r.Osb=1654263084;r.uZj=48;r.Rnd=2;r.WNe=4;r.VNe=4;r.Y1a=1;r.g$d=2;r.v7f=4;r.w7f=8;r.f$d=16;r.I4i=64;r.J4i=128;r.H4i=256;Object(G.a)(r,"Trie",null,[1187])},1470:function(G,P,b){b.r(P);G=b(0);b(1301);var k=b(1325),f=b(1297),x=b(2),u=b(80),w=b(13);class r{constructor(){this.MBe=0}SQc(A){this.MBe=window.performance.now();
this.iOa(()=>{const M=window.performance.now(),Q={};!x.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled")&&x.AFrameworkApplication.K.$("AppsForOfficeAllowExternalMarketplace")&&x.AFrameworkApplication.qsb&&(Q.callback=R=>{A(R,OSF.StoreTypeEnum.MarketPlace,M)},x.AFrameworkApplication.pa.hb(w.a.Wfb,2,Q));x.AFrameworkApplication.K.$("AppsForOfficePrivateCatalogIsEnabled")&&(Q.callback=R=>{A(R,OSF.StoreTypeEnum.PrivateCatalog,M)},Q.storeType=OSF.StoreTypeEnum.PrivateCatalog,x.AFrameworkApplication.pa.hb(w.a.Wfb,
2,Q))},0,()=>{if(f.TellMeActor.instance.Pd)f.TellMeActor.instance.Pd.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.MBe)+" ms")})}iOa(A,M=0,Q=null){2!==x.AFrameworkApplication.pa.processAction(w.a.Wfb,1)?(f.TellMeActor.instance.Pd&&f.TellMeActor.instance.Pd.jA(k.a.fKj,window.performance.now()-this.MBe),A()):20>M?x.AFrameworkApplication.Cb.ub(new u.a(2,1,500,()=>{this.iOa(A,M+1,Q)})):Q&&Q()}static get instance(){r._instance||
(r._instance=new r);return r._instance}}r._instance=null;Object(G.a)(r,"AddinEntitlementsQuery",null,[]);class m{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.storeType=this.storeId=this.providerName=this.iconUrl=null}}Object(G.a)(m,"AddinInfo",null,[]);var l=b(1302),z=b(1309),F=b(1308),L=b(1296);b.d(P,"AddinResultsProvider",function(){return E});class E{constructor(A){this.wb=A;this.gom=
(M,Q,R)=>{if(M){const K=M.errorCode;if(f.TellMeActor.instance.Pd){const J={};J.StoreType=Q;J.ErrorCode=K;J.AddinCount=M.value?M.value.length:0;f.TellMeActor.instance.Pd.jA(k.a.EQk,window.performance.now()-R,J)}if(0===K&&M.value){E.fsb=E.fsb||{};M=M.value;for(const J of M)M=new m,M.displayName=J[0],M.id=J[1],M.description=J[2],M.targetType=J[3],M.appVersion=4<J.length?J[4]:"",M.assetId=5<J.length?J[5]:"",M.assetStoreId=6<J.length?J[6]:"",M.width=7<J.length?J[7]:0,M.height=8<J.length?J[8]:0,M.iconUrl=
9<J.length?J[9]:"",M.providerName=10<J.length?J[10]:"",M.storeId=11<J.length?J[11]:"",M.storeType=12<J.length?J[12]:"",E.fsb[M.id]=M,0<M.iconUrl.length&&appChrome.addInApi.registerAddinIcon("AddinIcon_"+M.id,M.iconUrl)}}};r.instance.SQc(this.gom)}sO(){return"Add-ins"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:2}qK(A,M,Q,R,K=null){Q=new F.a(A);K&&!Array.contains(K,24)||L.a.IX(A)||(K=new z.a(24),K.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,this.Won()?this.Kwh(A.Ef,K,2):this.Kwh(A.Ef,
K,3),0<K.results.length&&Q.kw(K));M.resultsUpdated(Q)}Kwh(A,M,Q){if((A=this.D8m(A))&&0<A.length){let R=0;A.forEach(K=>{if(!(++R>Q)){var J="AddinSuggestion"+R,O={};O["default"]=0<K.iconUrl.length?"AddinIcon_"+K.id:"AppForOfficeLogo_20";var N=[];N.push(appChrome.actions.setControlLabel(J,K.displayName));N.push(appChrome.actions.setControlIconSet(J,O));N.push(appChrome.actions.setCompoundButtonCommandValueId(J,K.id));N.push(appChrome.actions.updateCompoundButtonDescription(J,K.description));appChrome.api.dispatch(N);
J=new l.a(J,25,void 0,void 0,1);J.qG=Telemetry.PrivacyRules.GetAssetId(K.storeType,K.storeId,K.id,K.providerName);M.Xw(J)}})}}Won(){return this.wb.qGl?!0:!1}D8m(A){if(!E.fsb)return null;const M=[],Q=E.fsb;for(let K in Q){var R=Q[K];R&&(0<=R.displayName.toLowerCase().indexOf(A.toLowerCase())?Array.add(M,R):this.wb.HRl&&0<=R.description.toLowerCase().indexOf(A.toLowerCase())&&Array.add(M,R))}return M}}E.fsb=null;Object(G.a)(E,"AddinResultsProvider",null,[1042])},1545:function(G,P,b){b.d(P,"a",function(){return f});
G=b(0);var k=b(202);class f{constructor(){this.Nfb=this.Ofb=this.yUa=this.kcb=this.Mfb=this.M9a=this.icb=this.JZa=this.N9a=this.jcb=null;this.reset()}reset(){this.jcb=new k.a;this.N9a=new k.a;this.JZa=new k.a;this.icb=new k.a;this.M9a=new k.a;this.Mfb=new k.a;this.kcb=new k.a;this.yUa=new k.a;this.yUa=new k.a;this.Ofb=new k.a;this.Nfb=new k.a}xUn(x){return this.wJa(this.jcb,x)&&this.wJa(this.N9a,x)&&this.wJa(this.JZa,x)&&this.wJa(this.icb,x)&&this.wJa(this.M9a,x)&&this.wJa(this.Mfb,x)&&this.wJa(this.kcb,
x)&&this.wJa(this.yUa,x)&&this.wJa(this.Ofb,x)&&this.wJa(this.Nfb,x)}wJa(x,u){return!x||!x.length||x.length===u}}Object(G.a)(f,"MergeableTrackedChangesProperties",null,[])},1546:function(G,P,b){b.d(P,"a",function(){return u});G=b(0);var k=b(724),f=b(231),x=b(41);class u{constructor(w,r,m){this.rrj=w;this.Pnj=r;this.mnj=m;this.ine=new f.a(Object(x.a)(this,this.j4j,"checkIfDifferent"))}get Sfb(){return this.rrj}get oldValue(){return this.Pnj}get newValue(){return this.mnj}get vcb(){return!(void 0===
this.newValue||null===this.newValue)&&(void 0===this.oldValue||null===this.oldValue)}get isDeleted(){return(void 0===this.newValue||null===this.newValue)&&!(void 0===this.oldValue||null===this.oldValue)}get GO(){return this.vcb||this.isDeleted||this.ine.value}j4j(){return this.vcb||this.isDeleted?!0:!k.a.gUg(this.Sfb,this.oldValue,this.newValue)}}Object(G.a)(u,"PropertyDiff",null,[])},1547:function(G,P,b){b.d(P,"a",function(){return x});G=b(0);var k=b(202),f=b(574);class x{constructor(){this.uDa=
new k.a;this.pEa=new k.a;this.DGa=new k.a}get xsb(){return this.uDa}get v1e(){return this.pEa}get Vib(){return this.DGa}get isEmpty(){return!this.uDa.length&&!this.pEa.length&&!this.DGa.length}get Crf(){return Math.max(Math.max(this.uDa.length,this.pEa.length),this.DGa.length)}get gem(){return Math.min(Math.min(this.uDa.length,this.pEa.length),this.DGa.length)}bmd(u){this.uDa.add(u)}emd(u){this.pEa.add(u)}jmd(u){this.DGa.add(u)}yJk(){const u=new f.a,w=new k.a;let r=0;for(;r<this.uDa.length||r<this.pEa.length||
r<this.DGa.length;)r<this.uDa.length&&!u.contains(this.uDa.J(r))&&(w.add(this.uDa.J(r)),u.add(this.uDa.J(r))),r<this.pEa.length&&!u.contains(this.pEa.J(r))&&(w.add(this.pEa.J(r)),u.add(this.pEa.J(r))),r<this.DGa.length&&!u.contains(this.DGa.J(r))&&(w.add(this.DGa.J(r)),u.add(this.DGa.J(r))),r++;return w}}Object(G.a)(x,"ObjectCollection",null,[])},1548:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(f,x){this.TCa=x;this.updateHints=f}}Object(G.a)(k,"UpdateHintCollection",
null,[])},1549:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1376);class k extends b.a{constructor(f,x){super();this.qf=f;this.Ib=x}get type(){return 9}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.qf,this.Ib)}}Object(G.a)(k,"LcsInsertParaUpdateHint",b.a,[])},1550:function(G,P,b){b.d(P,"a",function(){return f});G=b(0);var k=b(202);b=b(1376);class f extends b.a{constructor(x){super();this.xX=new k.a;this.cp=x}get type(){return 11}toString(){let x=
"";for(let u=0;u<this.xX.length;u++)x+=String.format("({0}), ",this.xX.J(u).toString());return String.format("[Cp:{0}] {1}",this.cp,x)}}Object(G.a)(f,"LcsInsertUpdateHint",b.a,[])},1551:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1376);class k extends b.a{constructor(f,x){super();this.text=x;this.qf=f}get type(){return 7}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [Text:{3}]",this.cp,this.type,this.qf,this.text)}}Object(G.a)(k,"LcsInsertTextUpdateHint",b.a,[])},
1552:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1376);class k extends b.a{constructor(f,x,u){super();this.cp=f;this.qf=x;this.Ib=u}get type(){return 10}toString(){return String.format("[Cp:{0}] [Type:{1}] [ParaId:{2}] [WordId:{3}]",this.cp,this.type,this.qf,this.Ib)}}Object(G.a)(k,"LcsDeleteParaUpdateHint",b.a,[])},1553:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1376);class k extends b.a{constructor(f,x){super();this.cp=f;this.text=x}get type(){return 8}toString(){return String.format("[Cp:{0}] [Type:{1}] [Text:{2}]",
this.cp,this.type,this.text)}}Object(G.a)(k,"LcsDeleteTextUpdateHint",b.a,[])},1554:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);b=b(1343);class k extends b.a{constructor(){super()}get gca(){return"Conflict"}}Object(G.a)(k,"ConflictMergeFailureDetail",b.a,[])},1555:function(G,P,b){b.r(P);b.d(P,"InsightsMenuItemFactory",function(){return u});G=b(0);var k=b(1296),f=b(232),x=b(16);class u{constructor(w=null){this.hij=w||CommonUIStrings.l_InsightsButtonText}get GMa(){return 10}P_(w){var r=w.mA;
w=k.a.aAa()?k.a.hUa(r,1):k.a.mub(r);r=String.format(this.hij,r);return this.aPk(w,r)}aPk(w,r){return f.a(u.UNh,k.a.aAa()?"1914896509":"3317204163",x.a.Wd(r),k.a.Lgf,null,x.a.Wd(w),x.a.Wd(r),null,null)}}u.UNh="bInsights";Object(G.a)(u,"InsightsMenuItemFactory",null,[1037])},1556:function(G,P,b){b.d(P,"a",function(){return x});G=b(0);var k=b(232),f=b(16);class x{constructor(u,w,r,m,l){this.Eze=u;this.Dze=w;this.vxj=r;this.Pgj=m;this.Bmg=l}get GMa(){return 4}P_(u,w=null){w=w.sessionId+"|"+w.Nca+"|"+
u.mA;if(this.Bmg||this.Pgj){let r=this.Bmg||f.a.zy(CommonUIStrings.l_HelpTooltip)===f.a.zy(u.mA.trim());if(this.vxj&&2<u.mA.length){const m=u.mA;";"===m.charAt(0)&&";"===m.charAt(m.length-1)&&m.substring(1,m.length-1)===x.rdf&&(r=!0)}u=r?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,u.mA);return this.oph(w,f.a.Wd(u),r)}return this.oph(w,f.a.Wd(String.format(CommonUIStrings.l_TextWithQuotation,u.mA)),!1)}oph(u,w,r){return k.a(x.rdf,r?this.Dze:this.Eze,
w,"OfficeAssistant_16x16x32","A0",f.a.Wd(u),w,null,null)}}x.rdf="bSearchHelp";Object(G.a)(x,"AssistanceMenuItemFactory",null,[1037])},1557:function(G,P,b){b.d(P,"a",function(){return w});G=b(0);var k=b(2),f=b(232),x=b(96),u=b(16);class w{get GMa(){return 13}P_(){return w.AWj()}static AWj(){return f.b(w.Amh,"798637440",u.a.Wd(CommonUIStrings.l_LookupFirstRunExperienceTitle),k.AFrameworkApplication.qp,x.getImageClass("Info_32x32x32"),null,null,u.a.Wd(CommonUIStrings.l_LookupFirstRunExperienceTitle),
"Menu32",null,null,u.a.Wd(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}w.Amh="bTellMeFirstRun";Object(G.a)(w,"FirstRunMenuItemFactory",null,[1037])},1558:function(G,P,b){b.d(P,"a",function(){return u});G=b(0);var k=b(2),f=b(232),x=b(16);class u{constructor(w=null,r=null){this.lwg=w;this.unj=r||CommonUIStrings.l_LookupNoResultsDescription}get GMa(){return 14}P_(w){w=String.format(this.unj,w.mA);return this.xXj(w)}xXj(w){return f.b(u.Y7h,"798637440",x.a.Wd(CommonUIStrings.l_LookupNoResultsTitle),
this.lwg?k.AFrameworkApplication.qp:null,this.lwg,null,null,x.a.Wd(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,x.a.Wd(w),null,null)}}u.Y7h="lookupNoResults";Object(G.a)(u,"NoCommandsFoundMenuItemFactory",null,[1037])},1559:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(f,x){this.FontWeight=0;this.Text=null;this.FontWeight=f;this.Text=x}}Object(G.a)(k,"LabelFormatted",null,[])},1560:function(G,P,b){b.d(P,"a",function(){return W});G=b(0);var k=b(76),f=b(1301),
x=b(1447),u=b(1362),w=b(1325),r=b(1378),m=b(1561),l=b(1345),z=b(1363),F=b(1562),L=b(1302),E=b(1309),A=b(1308),M=b(1586),Q=b(1563),R=b(1377),K=b(1297),J=b(1296),O=b(2),N=b(31),V=b(133);class W{constructor(ca,H,Z){this.lrc=this.pgd=this.qgd=this.ogd=!1;this.uN=null;this.AZ=-1;this.qoa=this.Nrc=null;this.bsc="";this.Jnb=0;this.wb=ca;const aa=J.a.aAa();this.T3a=H||[];this.Qe=O.AFrameworkApplication.fe;this.VFg=ca.nBf;this.rgd=ca.mBf;this.LAe=aa&&this.EGb();this.MAe=aa&&this.FGb();this.avj=aa&&this.GGb();
this.OAe=this.IGb();this.XFg=this.oac();ca.VVf&&J.a.aSf(ca)&&(this.Nrc=new M.a(ca),this.ogd=ca.$Xc,this.qgd=ca.bYc,this.pgd=ca.ldb,this.lrc=this.ogd&&this.bE("File")||this.qgd&&this.bE("People")||this.pgd&&this.bE("Notes"));this.ngd=this.Eon();this.ugd=ca.$Oc;this.NAe=this.Zon();this.C2a=this.Cil();this.j$f=new m.a(ca);this.Dhj=new F.a(ca);this.txj=new Q.a(ca);this.dqc=Z;this.Hze=new x.a;this.ugd&&(this.j$f=new m.a(ca))}bE(ca){return Array.contains(this.T3a,ca)?!0:!1}sO(){return"TellMeService"}u0(){return 0===
this.wb.rw?0:1===this.wb.rw?1:3===this.wb.rw?3:this.bE("Command")||this.bE("Recommended")?2:3}zil(ca){let H="";if(!ca&&this.bE("Command")&&this.wb.skf){H+="CommandSearch_DLIS,";var Z=this.wb.MNi;0<Z.length&&(H+=Z+",")}ca&&this.bE("Recommended")&&this.rgd&&(Z=this.wb.NNi,0<Z.length&&(H+=Z+","));!ca&&this.bE("Help")&&(ca=this.wb.LNi,0<ca.length&&(H+=ca+","));0<H.length&&(H=H.substr(0,H.length-1));return H}qK(ca,H,Z,aa=f.a.tellMe,ja=null){const Ba=new A.a(ca);Z=J.a.IX(ca);if(this.lrc&&(!this.Jnb||window.performance.now()-
this.Jnb>=J.a.B5d)){var la=this.Hze.Dil();if(la)this.Jnb=window.performance.now(),la.then(pa=>{this.bsc=pa},pa=>{K.TellMeActor.instance.Pd.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+pa)});else if(K.TellMeActor.instance.Pd)K.TellMeActor.instance.Pd.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var ia=this.lrc&&!!this.bsc;la=ia||Z&&this.bE("Recommended")&&this.rgd;ia=ia||!Z&&(this.VFg&&this.bE("Command")||this.LAe&&this.bE("Answer")||this.MAe&&
this.bE("Definition")||this.XFg&&this.bE("Image")||this.ugd&&this.bE("Help")||this.OAe&&this.bE("WolframAnswer")||this.NAe&&this.bE("Template"));if(la||ia)if(this.qoa=aa,aa={"Content-Type":"application/json",Accept:"application/json"},aa["X-Office-Version"]=O.AFrameworkApplication.buildVersion,aa["X-Office-Application"]=O.AFrameworkApplication.K.Ga("Application"),aa["X-Office-Platform"]="WAC",aa["X-TellMe-SqmUserId"]=O.AFrameworkApplication.K.Ga("LoggableUserId")||"",aa["X-TellMe-SessionId"]=K.TellMeActor.instance.BCd(),
this.bsc&&(aa.Authorization="Bearer "+this.bsc),la=this.zil(Z),0<la.length&&(aa["X-TellMe-Flights"]=la),la=[],!Z&&this.bE("Answer")&&this.LAe&&(ja?Array.contains(ja,9):1)&&Array.add(la,"Answer"),!Z&&this.bE("Command")&&this.VFg&&!l.CommandResultsUtility.Phf(ca.Ef)&&(ja?Array.contains(ja,17):1)&&Array.add(la,"Command"),!Z&&this.bE("Definition")&&this.MAe&&(ja?Array.contains(ja,10):1)&&Array.add(la,"Definition"),!Z&&this.bE("Help")&&this.ugd&&(ja?Array.contains(ja,8):1)&&Array.add(la,"Help"),!Z&&this.bE("WolframAnswer")&&
this.OAe&&(ja?Array.contains(ja,12):1)&&Array.add(la,"WolframAnswer"),Z&&this.bE("Recommended")&&this.rgd&&!K.TellMeActor.instance.k_c&&(ja?Array.contains(ja,18):1)&&Array.add(la,"Recommended"),!Z&&this.bE("Image")&&this.XFg&&(ja?Array.contains(ja,19):1)&&Array.add(la,"Image"),this.bsc&&this.lrc&&(ja?Array.contains(ja,14)||Array.contains(ja,15)||Array.contains(ja,20):1)&&(this.Nrc.j9b(),this.ogd&&this.bE("File")&&Array.add(la,"File"),this.qgd&&this.bE("People")&&Array.add(la,"People"),this.pgd&&this.bE("Notes")&&
Array.add(la,"Notes")),!Z&&this.bE("Template")&&this.NAe&&(ja?Array.contains(ja,23):1)&&Array.add(la,"Template"),la.length){aa["X-TellMe-SuggestionTypes"]=la.join(",");aa["X-TellMe-Culture"]=O.AFrameworkApplication.uiCulture;aa["X-TellMe-ProcessSessionId"]=O.AFrameworkApplication.userSessionId;var oa=this.uN=V.a.create().toString();aa["Client-Request-Id"]=oa;var ha=window.performance.now();this.Rwa();this.AZ=window.setTimeout(()=>{if(oa===this.uN){this.uN="";this.AZ=-1;H.resultsUpdated(Ba);const pa=
{};pa[u.a.provider]=this.sO();pa[u.a.hEb]=ca.Xfb;K.TellMeActor.instance.Pd.jA(w.a.timedOut,this.dqc,pa)}},this.dqc);this.Qe.ai(this.C2a,2,this.Bil(ca.Ef),aa,!1,0,pa=>{this.eDb(pa,ca,H,oa,ha,ja)},pa=>{this.QCb(pa,ca,H,oa,ha)},null,null,!1,4E3,6E3)}else K.TellMeActor.instance.Pd.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),H.resultsUpdated(Ba);else H.resultsUpdated(Ba)}Rwa(){-1!==this.AZ&&(window.clearTimeout(this.AZ),this.AZ=-1)}eDb(ca,H,Z,aa,ja,Ba){const la=new A.a(H);
if(aa===this.uN){this.Rwa();K.TellMeActor.instance.Pd.N4(H.Ef.length,this.T3a.join(","),ca.data.we.toString(),Math.round(window.performance.now()-ja),R.a.tellMe,!0,r.a.DJa);aa=ca.data.qd;ca=null;try{ca=N.b(aa)}catch(Fa){K.TellMeActor.instance.Pd.onError("OnSuccessCallBack","Exception occured while deserializing response:"+Fa);return}aa=J.a.IX(H);if("Groups"in ca&&ca.Groups){var ia=ca.Groups;for(var oa of ia)if("GroupType"in oa&&"Suggestions"in oa&&oa.Suggestions)if("Commands"===oa.GroupType&&(Ba?
Array.contains(Ba,17):1)||"Recommended"===oa.GroupType&&(Ba?Array.contains(Ba,18):1)){var ha=(ia="Recommended"===oa.GroupType)?"DLIS":"NaiveBayes";"Source"in oa&&oa.Source&&(ha=oa.Source);var pa=oa.Suggestions;new k.a;var Ea=[];for(const Fa of pa)this.AUl(Fa)&&(pa=Fa.Type,("Command"===pa||ia&&"Recommended"===pa)&&Ea.push(new z.a(Fa.CommandId,Fa.Score)));l.CommandResultsUtility.cNd(Ea,!H.Ef.trim().length,oa.GroupType,ha);ha=K.TellMeActor.instance.UZ;pa=[];for(const Fa of Ea)ia&&ha&&ha.XRe(Fa.commandId)||
pa.push(Fa);Ea=l.CommandResultsUtility.NBd(pa,this.wb,null,null,null,ia?18:17,0);0<Ea.results.length&&(this.qoa!==f.a.contextMenu&&(Ea.displayName=ia?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),la.kw(Ea))}else if("Answer"===oa.GroupType){pa=oa.Suggestions;ia=null;Ea=2147483647;ha="";for(const Fa of pa)if(this.zUl(Fa))if(ha=Fa.Type,pa=this.BBd(ha),"Answer"===ha&&this.LAe){ia=this.k$g(ha,Fa,H.Ef);break}else pa&&pa<Ea&&(Ea=pa,ia=this.k$g(ha,Fa,H.Ef));Ea=J.a.J3m(H.Ef,
ha);ia&&(Ba?Array.contains(Ba,ia.type):1)&&(ha=[],this.ngd?this.wb.uWa?(K.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ia.value,ia.mA)),K.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ia.value,ia.description)),K.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ia.value,Ea))):(ha.push(appChrome.actions.setControlLabel(ia.value,ia.mA)),ha.push(appChrome.actions.updateCompoundButtonDescription(ia.value,ia.description)),
ha.push(appChrome.actions.setCompoundButtonCommandValueId(ia.value,Ea)),appChrome.api.dispatch(ha)):this.wb.uWa?(K.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ia.value,ia.mA+" - "+ia.description)),K.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(ia.value,Ea))):(ha.push(appChrome.actions.setControlLabel(ia.value,ia.mA+" - "+ia.description)),ha.push(appChrome.actions.setButtonCommandValueId(ia.value,Ea)),appChrome.api.dispatch(ha)),Ea=this.Ulk(ia.type),
Ea.Xw(ia),la.kw(Ea))}else"Help"===oa.GroupType&&oa.Suggestions.length&&(Ba?Array.contains(Ba,8):1)?this.ugd&&(ia=this.j$f.k0b(H,oa.Suggestions))&&0<ia.results.length&&la.kw(ia):"Template"===oa.GroupType&&(Ba?Array.contains(Ba,23):1)?(ia=oa.Suggestions)&&0<ia.length&&this.txj.k0b(H,la,ia):"Substrate"===oa.GroupType&&this.lrc&&"Type"in oa&&("File"===oa.Type&&this.ogd&&(Ba?Array.contains(Ba,15):1)?(ia=this.Nrc.Duh(oa.Suggestions,aa,this.qoa))&&0<ia.results.length&&la.kw(ia):"People"===oa.Type&&this.qgd&&
(Ba?Array.contains(Ba,14):1)?(ia=this.Nrc.lAh(oa.Suggestions,aa,this.qoa))&&0<ia.results.length&&la.kw(ia):"Notes"===oa.Type&&this.pgd&&(Ba?Array.contains(Ba,14):1)&&(ia=this.Nrc.Zyh(oa.Suggestions,aa,H))&&0<ia.results.length&&la.kw(ia));else K.TellMeActor.instance.Pd.onError("OnSuccessCallBack","GroupType"in oa?"Invalid group suggestions found for "+oa.GroupType:"Invalid group found")}if(ca.Intents){oa=ca.Intents;for(const Fa of oa)this.Imf(Fa)&&("Image"===Fa.GroupType&&Fa.ConfidenceScore>Fa.ConfidenceThreshold&&
(Ba?Array.contains(Ba,19):1)?this.Dhj.k0b(H,la,0,Fa):"Commands"===Fa.GroupType&&Fa.ConfidenceScore<Fa.ConfidenceThreshold&&(Ba?Array.contains(Ba,17):1)&&(oa=new E.a(17),la.kw(oa)))}Z.resultsUpdated(la);K.TellMeActor.instance.Pd.N4(H.Ef.length,this.T3a.join(","),"",Math.round(window.performance.now()-ja),"",!0,r.a.provider)}}QCb(ca,H,Z,aa,ja){const Ba=new A.a(H);aa===this.uN&&(this.Rwa(),K.TellMeActor.instance.Pd.N4(H.Ef.length,this.T3a.join(","),ca.data.we.toString(),Math.round(window.performance.now()-
ja),R.a.tellMe,!1,r.a.DJa));Z.resultsUpdated(Ba)}BBd(ca){switch(ca){case "Entity":return this.avj?3:0;case "Definition":return this.MAe?5:0;case "WolframAnswer":return this.OAe?2:0;default:return 0}}k$g(ca,H,Z){switch(ca){case "Answer":return new L.a(this.ngd?"AnswerForSearch":"AnswerForSearchSingleLine",0,""===H.Title?Z:H.Title,H.Description,0);case "Entity":return new L.a(this.ngd?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===H.Title?Z:H.Title,H.Description,0);case "Definition":return new L.a(this.ngd?
"AnswerForSearch":"AnswerForSearchSingleLine",1,""===H.Title?Z:H.Title,H.Description,0);case "WolframAnswer":return new L.a("WolframForSearch",3,""===H.Title?Z:H.Title,H.Description,0);default:return null}}Ulk(ca){switch(ca){case 0:return new E.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new E.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new E.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new E.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new E.a(19,
this.wb.iac?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}zUl(ca){return"Type"in ca&&!!ca.Type&&""!==ca.Type&&"Description"in ca&&!!ca.Description&&""!==ca.Description}AUl(ca){return"Type"in ca&&!!ca.Type&&""!==ca.Type&&"CommandId"in ca&&!!ca.CommandId&&""!==ca.CommandId&&"Score"in ca&&!!ca.Score}Imf(ca){if("GroupType"in ca&&ca.GroupType&&"ConfidenceScore"in ca&&"ConfidenceThreshold"in ca)return!0;K.TellMeActor.instance.Pd.onError("IsValidIntentGroup",
"Invalid intents found");return!1}Bil(ca){const H=J.a.MWh(ca),Z={};Z.Query=ca;H&&this.rgd&&(Z.CommandClickedEvents=K.TellMeActor.instance.Tde,Z.CommandActionEvents=K.TellMeActor.instance.tcg,Z.TellMeCommandClickMruEvents=K.TellMeActor.instance.Kvg,Z.ContentType=K.TellMeActor.instance.ssd);this.NAe&&(ca={},ca.Application=this.wb.application,Z.TemplateInfo=ca);return N.c(Z)}EGb(){return!!this.wb&&this.wb.EGb||!!O.AFrameworkApplication.na&&O.AFrameworkApplication.na.Ya.EGb}FGb(){return!!this.wb&&this.wb.FGb||
!!O.AFrameworkApplication.na&&O.AFrameworkApplication.na.Ya.FGb}GGb(){return!!this.wb&&this.wb.GGb||!!O.AFrameworkApplication.na&&O.AFrameworkApplication.na.Ya.GGb}IGb(){return!!this.wb&&this.wb.IGb||!!O.AFrameworkApplication.na&&O.AFrameworkApplication.na.Ya.IGb}oac(){return!!this.wb&&(this.wb.oac||this.wb.GY)}Eon(){return!!this.wb&&!this.wb.$Xa}Zon(){return!!this.wb&&this.wb.FKc}uXh(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",
!1)}vXh(){return!!O.AFrameworkApplication.K&&O.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}Cil(){if(!O.AFrameworkApplication.K)return"";if(this.vXh())return O.AFrameworkApplication.K.Ga("TellMeServiceProdEndpointForSearch");if(this.uXh())return O.AFrameworkApplication.K.Ga("TellMeServiceEdogEndpointForSearch");if(J.a.qif())return O.AFrameworkApplication.K.Ga("TellMeServiceIntEndpointForSearch");let ca=O.AFrameworkApplication.K.Ga("TellMeServiceSearchEndpoint");
ca&&""!==ca||(ca=O.AFrameworkApplication.KNi);return ca}static K$g(ca,H){if(H)return new W(ca,["Command","Recommended"],ca.M_k);H=J.a.aAa()?"Answer Definition Help WolframAnswer Image File People Notes Template".split(" "):"Help WolframAnswer File People Notes Template".split(" ");return new W(ca,H,ca.UCh)}}Object(G.a)(W,"TellMeServiceProvider",null,[1042])},1561:function(G,P,b){b.d(P,"a",function(){return r});G=b(0);b(1301);var k=b(1302),f=b(1309),x=b(1308),u=b(1296),w=b(16);class r{constructor(m){this.wb=
m}sO(){return"Assistance"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:this.wb.$Oc?3:2}qK(m,l,z=!1,F,L=null){F=new x.a(m);if((!L||Array.contains(L,8))&&!u.a.IX(m)){L=new f.a(8);if(z){z=w.a.zy(CommonUIStrings.l_HelpTooltip)===w.a.zy(m.Ef.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,m.Ef);const E=[];this.wb.$Xa&&(this.wb.Q1d||E.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),z=this.Uyh(m.Ef));const A=
"||"+m.Ef;E.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",z));E.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",A));appChrome.api.dispatch(E);m=new k.a("GetHelpFromTellMe",4,m.Ef,null,1)}else m=new k.a("bSearchHelp",4,m.Ef,null,1);L.Xw(m);L.displayName=CommonUIStrings.l_HelpButtonTitle;F.kw(L)}l.resultsUpdated(F)}k0b(m,l=null){const z=new f.a(8),F=w.a.zy(CommonUIStrings.l_HelpTooltip)===w.a.zy(m.Ef.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,
m.Ef);for(let E=0;E<l.length&&2>E;E++){var L=void 0;L=[];let A="GetHelpWithDescriptionFromTellMe"+(E+1).toString(),M=4;if(this.wb.dWc)L.push(appChrome.actions.setControlLabel(A,F)),L.push(appChrome.actions.setCompoundButtonCommandValueId(A,m.Ef)),L.push(appChrome.actions.updateCompoundButtonDescription(A,this.abf(l.length)));else if(this.wb.eWc){let Q=this.VEh(l[E]);A="GetHelpFromTellMe"+(E+1).toString();this.wb.$Xa&&(Q=this.Uyh(Q));M=9;L.push(appChrome.actions.setControlLabel(A,Q));L.push(appChrome.actions.setButtonCommandValueId(A,
this.Bjl(l[E])))}appChrome.api.dispatch(L);L=new k.a(A,M,null,null,0);L.label=this.VEh(l[E]);L.description=this.Ajl(l[E]);z.Xw(L);if(this.wb.eWc)break}z.displayName=CommonUIStrings.l_HelpButtonTitle;return z}abf(m){return 1===m?String.format(CommonUIStrings.l_SearchResultText,m):String.format(CommonUIStrings.l_SearchResultsText,m)}Uyh(m){return this.wb.dmf?u.a.M7e(m,CommonUIStrings.l_HelpScopedButtonText):m+CommonUIStrings.l_HelpScopedButtonText}VEh(m){return m.name?m.name:""}Ajl(m){return m.description?
m.description:""}Bjl(m){return m.id?"AssetID="+m.id:""}}Object(G.a)(r,"AssistanceResultsProvider",null,[1042])},1562:function(G,P,b){b.d(P,"a",function(){return m});G=b(0);b(1301);var k=b(1302),f=b(1309),x=b(1308),u=b(1297),w=b(1296),r=b(1374);class m{constructor(l){this.wb=l}sO(){return"Image"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:3===this.wb.rw?3:2}qK(l,z,F,L,E=null){F=new x.a(l);(!E||Array.contains(E,19))&&w.a.IX(l)&&this.wb.GY&&this.k0b(l,F,1);z.resultsUpdated(F)}k0b(l,z,F,L=null){var E=
[];let A;u.TellMeActor.instance.oM()&&u.TellMeActor.instance.oM().$Xa?(A=this.wb.dmf?w.a.M7e(l.Ef,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):l.Ef+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.wb.Q1d||E.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):A=this.wb.GY?w.a.IX(l)?this.wb.Euc?w.a.LCc(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.wb.Euc?w.a.LCc(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,
l.Ef)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,l.Ef):this.wb.iac?CommonUIStrings.l_TellMeImageSuggestionButtonText:l.Ef+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.wb.uWa?(u.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",A)),E=w.a.hUa(l.Ef,9,Object.assign(new r.a,{landingTab:"Image"})),u.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",E))):(E.push(appChrome.actions.setControlLabel("ImageForSearch",
A)),l=w.a.hUa(l.Ef,9,Object.assign(new r.a,{landingTab:"Image"})),E.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",l)),appChrome.api.dispatch(E));F=new k.a("ImageForSearch",12,null,null,F);L&&(F.score=L.ConfidenceScore);L=new f.a(19,this.wb.iac?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);L.Xw(F);z.kw(L)}}Object(G.a)(m,"ImageResultsProvider",null,[1042])},1563:function(G,P,b){b.d(P,"a",function(){return r});G=b(0);b(1301);var k=b(1302),f=b(1309),x=b(1308),
u=b(1296),w=b(2);class r{constructor(m){this.wb=m}sO(){return"Template"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:3}qK(m,l){m=new x.a(m);l.resultsUpdated(m)}k0b(m,l,z){var F=[];let L;L=this.wb.GY?this.wb.Euc?u.a.LCc(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,m.Ef)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,m.Ef):String.format(CommonUIStrings.l_TellMeTemplateButtonText,m.Ef);F.push(appChrome.actions.setControlLabel("TemplateForSearch",L));F.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(w.AFrameworkApplication.K.Ga("TellMeTemplateProviderURL"),w.AFrameworkApplication.uiCulture,m.Ef)));appChrome.api.dispatch(F);m=new f.a(23);m.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;F=new k.a("TemplateForSearch",24,null,null,0);F.label=z[0].Title?z[0].Title:"";F.description=z[0].Description?z[0].Description:"";m.Xw(F);l.kw(m)}}Object(G.a)(r,"TemplateResultsProvider",null,[1042])},1564:function(G,P,b){b.d(P,"a",function(){return z});G=b(0);b(1301);var k=b(1345),f=b(1302),
x=b(1309),u=b(1308),w=b(1457),r=b(1297),m=b(1296),l=b(16);class z{constructor(F,L,E,A){this.UZ=F;this.w7a=L;this.zJg=A;this.mej=E;this.wb=r.TellMeActor.instance.oM()}sO(){return"EmptyQuery"}u0(){return 1===this.wb.rw?1:0}qK(F,L,E=!1,A,M=null){A=new u.a(F);if((!M||Array.contains(M,5)||Array.contains(M,6)||Array.contains(M,4))&&m.a.IX(F)){this.UZ.fDc().length||!this.mej||this.zJg||(F=new x.a(6),M=new f.a(null,13,void 0,void 0,1),F.Xw(M),A.kw(F));F=new x.a(4);if(0<this.UZ.fDc().length){F.displayName=
CommonUIStrings.l_TellMeRecentlyUsedTitle;M=this.UZ.fDc();var Q=[];for(var R of M)Q.push(R.Id);k.CommandResultsUtility.vZc(Q,this.wb);for(var K of M)k.CommandResultsUtility.AIc(K.Id)&&F.Xw(new f.a(K.Id,5,null,null,2));A.kw(F)}if(this.zJg&&0<this.w7a.length&&this.UZ.fDc().length<z.D4h){R=new x.a(5);R.displayName=CommonUIStrings.l_TellMeTryQueryTitle;K=z.D4h-F.results.length;F=[];for(M=0;M<this.w7a.length&&M<K;++M){if(E){Q=m.a.KZf+(M+1);const J=this.w7a[M].key,O=l.a.replaceAll(J,'"',"");F.push(appChrome.actions.setControlLabel(Q,
J));F.push(appChrome.actions.setButtonCommandValueId(Q,O));Q=new w.a(J,7,0,O,Q)}else Q=new w.a(this.w7a[M].key,7,0,this.w7a[M].value);R.Xw(Q)}0<F.length&&appChrome.api.dispatch(F);A.kw(R)}}L.resultsUpdated(A)}}z.D4h=5;Object(G.a)(z,"EmptyQueryResultsProvider",null,[1042])},1565:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(){this.G4d=this.FJa=this.Nbb=this.Hv=this.Qnd=this.RC=this.lJb=0}}Object(G.a)(k,"TRIESCAN",null,[])},1577:function(G,P,b){b.r(P);var k=b(0),f=b(1301),
x=b(1362),u=b(1325),w=b(1470);class r{constructor(ya,Ab){this.Rta=ya;this.Aj=Ab}resultsUpdated(ya){this.Rta.bin(this.Aj,ya)}}Object(k.a)(r,"AggregatorResultsProviderCallback",null,[1044]);var m=b(1309),l=b(1308);class z{constructor(ya){this.jma=null;this.wb=ya;this.wb.$Sa&&(this.jma=this.wb.lyd())}sO(){return"AppsForOffice"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:2}qK(ya,Ab,Vb,oc,Wc=null){Vb=new l.a(ya);if(!Wc||Array.contains(Wc,1))Wc=new m.a(1),this.jma.CGj(Wc,ya.Ef),Vb.kw(Wc);Ab.resultsUpdated(Vb)}}
Object(k.a)(z,"AppsForOfficeRecommendationResultsProvider",null,[1042]);var F=b(1561),L=b(1292),E=b(1315),A=b(246);class M{constructor(ya,Ab){this.Ka=ya;this.C9l=Ab}isMatch(ya,Ab){if(!Object(A.a)(1153,ya))throw Error.argument("objToTest","Expected feature bundle");let Vb;return({value:Vb}=ya.Ro(this.Ka.Qoa)).returnValue?this.Ka.Q1f.isMatch(Vb,Ab):this.C9l}}Object(k.a)(M,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[1177]);class Q{constructor(ya,Ab){this.Ka=ya;this.Lqf=Ab}isMatch(ya){if(!Object(A.a)(1153,
ya))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Lqf^ya.Ro(this.Ka.Qoa).returnValue)}}Object(k.a)(Q,"AnnotatedWithAnnotationFilter",null,[1177]);class R{constructor(ya){this.Ka=ya}isMatch(ya,Ab){if(!Object(A.a)(1156,ya))throw Error.argument("objToTest","Expected struct value");return this.Ka.Q1f.isMatch(ya.Bab(this.Ka.vIa),Ab)}}Object(k.a)(R,"FieldValueMatchesStructFilter",null,[1177]);class K{constructor(ya,Ab){ya&&(this.vIa=ya.J(0),this.Q1f=Ab.Mia(ya.J(1)))}}Object(k.a)(K,
"FieldValueMatchesStructFilterInit",null,[]);class J{constructor(ya){this.Lqf=ya}isMatch(ya){if(!Object(A.a)(1153,ya))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Lqf^ya.Kcf)}}Object(k.a)(J,"HasAnnotationsAnnotationFilter",null,[1177]);class O{constructor(ya,Ab){this.Ka=ya;this.H4=Ab}isMatch(ya,Ab){if(!Object(A.a)(1155,ya))throw Error.argument("objToTest","Expected list value");switch(this.H4){case 0:for(const Vb of ya.items)if(this.Ka.filter.isMatch(Vb,Ab))return!0;return!1;
case 1:for(const Vb of ya.items)if(!this.Ka.filter.isMatch(Vb,Ab))return!1;return!0;default:throw Error.notImplemented();}}}Object(k.a)(O,"ItemTestListFilter",null,[1177]);class N{constructor(ya){this.Ka=ya}isMatch(ya,Ab){if(!Object(A.a)(1155,ya))throw Error.argument("objToTest","Expected list value");return this.Ka.filter.isMatch(ya.items.length,Ab)}}Object(k.a)(N,"LengthMatchesListFilter",null,[1177]);class V{constructor(ya,Ab){this.Ka=ya;this.H4=Ab}isMatch(ya,Ab,Vb=null){let oc=0===this.H4;for(const Wc of this.Ka.F1g)if((oc=
Wc.isMatch(ya,Ab,Vb))?1===this.H4:0===this.H4)return oc;2===this.H4&&(oc=!oc);return oc}}Object(k.a)(V,"NonterminalFilter",null,[1177]);class W{constructor(ya,Ab){if(ya){var Vb=ya.J(0);this.F1g=Array(Vb);for(let oc=0;oc<Vb;++oc)this.F1g[oc]=Ab.Mia(ya.J(1+oc))}}}Object(k.a)(W,"NonterminalFilterInit",null,[]);class ca{constructor(ya,Ab){this.Ka=ya;this.H4=Ab}isMatch(ya,Ab){if("number"!==typeof ya)throw Error.argument("objToTest","Expected number value");let Vb=this.Ka.number;if(this.Ka.query){Ab=this.Ka.query.Fr(null,
Ab);if("number"!==typeof Ab)throw Error.invalidOperation("Query did not return number");Vb+=Ab}switch(this.H4){case 0:return ya===Vb;case 1:return ya<Vb;case 2:return ya<=Vb;case 3:return ya>Vb;case 4:return ya>=Vb;default:throw Error.notImplemented();}}}Object(k.a)(ca,"NumberFilter",null,[1177]);class H{constructor(ya,Ab){ya&&(this.number=ya.J(0),this.query=ya.J(1)?Ab.nI(ya.J(1)):null)}}Object(k.a)(H,"NumberFilterInit",null,[]);class Z{constructor(ya,Ab,Vb){this.Azd=this.P_k;this.I9l=ya;this.V2h=
Ab;this.U2h=Vb}aPe(ya){this.V2h=ya}P_k(ya){if(!ya)throw Error.argument("name","Invalid named feature bundle reference");const Ab=ya.substr(1);return 1===ya.charCodeAt(0)&&Ab===this.I9l?this.V2h:this.U2h?this.U2h.Azd(ya):null}}Object(k.a)(Z,"SimpleNamedFeatureBundleResolver",null,[1198]);class aa{constructor(ya){this.Ka=ya}isMatch(ya,Ab){if(!Object(A.a)(1153,ya))throw Error.argument("objToTest","Expected feature bundle");ya=this.Ka.query.Fr(null,new Z(this.Ka.X7d,ya,Ab));if("boolean"!==typeof ya)throw Error.invalidOperation("Query did not return bool");
return ya}}Object(k.a)(aa,"PredicateAnnotationFilter",null,[1177]);class ja{constructor(ya,Ab){ya&&(this.X7d=Ab.getString(ya.J(0)),this.query=Ab.nI(ya.J(1)))}}Object(k.a)(ja,"PredicateAnnotationFilterInit",null,[]);class Ba{constructor(ya){this.Ka=ya}isMatch(ya,Ab){if("boolean"!==typeof ya)throw Error.argument("objToTest","Expected bool value");Ab=this.Ka.query.Fr(null,Ab);if("boolean"!==typeof Ab)throw Error.invalidOperation("Query did not return bool");return ya===Ab}}Object(k.a)(Ba,"QueryBooleanFilter",
null,[1177]);class la{constructor(ya,Ab){this.Ka=ya;this.H4=Ab}isMatch(ya,Ab){if("number"!==typeof ya)throw Error.argument("objToTest","Expected integer");Ab=this.Ka.query.Fr(null,Ab);if("number"!==typeof Ab)throw Error.invalidOperation("Query did not return an enum value");switch(this.H4){case 0:return ya===Ab;case 1:return 0!==(ya&Ab);case 2:return ya===(ya&Ab);case 3:return Ab===(ya&Ab);default:throw Error.notImplemented();}}}Object(k.a)(la,"QueryEnumFilter",null,[1177]);class ia{constructor(ya,
Ab){ya&&(this.rJd=1===ya.J(0),this.query=Ab.nI(ya.J(1)))}}Object(k.a)(ia,"QueryEnumFilterInit",null,[]);class oa{constructor(ya,Ab){this.Ka=ya;this.H4=Ab}isMatch(ya,Ab){if(!Object(A.a)(1155,ya))throw Error.argument("objToTest","Expected list value");Ab=this.Ka.query.Fr(null,Ab);if(!Object(A.a)(1155,Ab))throw Error.invalidOperation("Query did not return list value");if(ya.R0!==Ab.R0)return!1;switch(this.H4){case 0:return L.Annotations.sjb(L.Annotations.h6k(ya.R0),ya,Ab);case 1:for(const Vb of ya.items)for(const oc of Ab.items)if(L.Annotations.sjb(ya.R0,
Vb,oc))return!0;return!1;case 2:for(const Vb of ya.items)for(const oc of Ab.items)if(!L.Annotations.sjb(ya.R0,Vb,oc))return!1;return!0;case 3:for(const Vb of Ab.items)for(const oc of ya.items)if(!L.Annotations.sjb(ya.R0,Vb,oc))return!1;return!0;default:throw Error.notImplemented();}}}Object(k.a)(oa,"QueryListFilter",null,[1177]);class ha{constructor(ya,Ab){this.Ka=ya;this.H4=Ab}isMatch(ya,Ab){if("string"!==typeof ya)throw Error.argument("objToTest","Expected string");Ab=this.Ka.query.Fr(null,Ab);
if("string"!==typeof Ab)throw Error.invalidOperation("Query did not return string");this.Ka.Jhf&&(ya=ya.toUpperCase(),Ab=Ab.toUpperCase());switch(this.H4){case 0:return ya===Ab;case 1:return 0<=ya.indexOf(Ab);case 2:return ya.startsWith(Ab);case 3:return ya.endsWith(Ab);case 4:return 0<=Ab.indexOf(ya);case 5:return Ab.startsWith(ya);case 6:return Ab.endsWith(ya);default:throw Error.notImplemented();}}}Object(k.a)(ha,"QueryStringFilter",null,[1177]);class pa{constructor(ya,Ab){ya&&(this.query=Ab.nI(ya.J(0)),
this.Jhf=1===ya.J(1))}}Object(k.a)(pa,"QueryStringFilterInit",null,[]);class Ea{constructor(ya){this.Ka=ya}isMatch(ya,Ab){if(!Object(A.a)(1156,ya))throw Error.argument("objToTest","Expected struct value");Ab=this.Ka.query.Fr(null,Ab);if(!Object(A.a)(1156,Ab))throw Error.invalidOperation("Query did not return struct value");return ya.isEqual(ya)}}Object(k.a)(Ea,"QueryStructFilter",null,[1177]);class Fa{constructor(ya){this.Ka=ya}isMatch(ya,Ab){ya=this.Ka.query.Fr(null,Ab);if("boolean"!==typeof ya)throw Error.invalidOperation("Query did not return bool");
return ya}}Object(k.a)(Fa,"QueryWhereConstraintFilter",null,[1177]);class Ga{constructor(ya){this.Ka=ya}isMatch(ya){if("string"!==typeof ya)throw Error.argument("objToTest","Expected string");return this.Ka.RIf.test(ya)}}Object(k.a)(Ga,"RegexStringFilter",null,[1177]);class $a{constructor(ya,Ab){ya&&(this.RIf=Ab.C_b(ya.J(0)))}}Object(k.a)($a,"RegexStringFilterInit",null,[]);class fa{constructor(ya,Ab){ya&&(this.filter=Ab.Mia(ya.J(0)))}}Object(k.a)(fa,"SingleFilterFilterInit",null,[]);class sa{constructor(ya,
Ab){ya&&(this.query=Ab.nI(ya.J(0)))}}Object(k.a)(sa,"SingleQueryFilterInit",null,[]);class qa{constructor(ya){this.Ka=ya}isMatch(ya){if("boolean"!==typeof ya)throw Error.argument("objToTest","Expected bool value");return ya===this.Ka.value}}Object(k.a)(qa,"StoredValueBooleanFilter",null,[1177]);class va{constructor(ya){ya&&(this.value=1===ya.J(0))}}Object(k.a)(va,"StoredValueBooleanFilterInit",null,[]);class Ca{constructor(ya,Ab){this.Ka=ya;this.H4=Ab}isMatch(ya){if("number"!==typeof ya)throw Error.argument("objToTest",
"Expected integer");switch(this.H4){case 0:return this.Ka.rJd?this.Ka.value?!!(ya&this.Ka.value):!ya:ya===this.Ka.value;case 1:return this.Ka.rJd?(ya&this.Ka.value)===this.Ka.value:32>ya&&(1<<ya&this.Ka.value)===this.Ka.value;case 2:return this.Ka.rJd?!!(ya&this.Ka.value):32>ya&&!!(1<<ya&this.Ka.value);default:throw Error.notImplemented();}}}Object(k.a)(Ca,"StoredValueEnumFilter",null,[1177]);class ta{constructor(ya){ya&&(this.rJd=1===ya.J(0),this.value=ya.J(1))}}Object(k.a)(ta,"StoredValueEnumFilterInit",
null,[]);class Wa{constructor(){this.Fym=null;this.UNe=this.Fyb=0}}Object(k.a)(Wa,"WHEREConstraintData",null,[]);class Za{constructor(ya){this.Ka=ya}isMatch(ya,Ab){if(!Object(A.a)(Wa,ya))throw Error.argument("objToTest","Expected WHERE constraint data");let Vb=-1,oc=-1;const Wc=ya.Fym;switch(this.Ka.KOe){case 4:Vb=Wc.RBc;oc=Wc.nUf;break;case 5:Vb=ya.Fyb;oc=Wc.RBc-ya.Fyb;break;case 6:Vb=Wc.RBc+Wc.nUf;oc=ya.Fyb+ya.UNe-Vb;break;case 1:case 2:case 3:let cd=!1;for(let yd=Wc.M4n;yd;yd=yd.next)if(this.Ka.gTn===
yd.name){cd=!0;1===this.Ka.KOe?(Vb=yd.RBc,oc=yd.nUf):2===this.Ka.KOe?(Vb=ya.Fyb,oc=yd.RBc-ya.Fyb):(Vb=yd.RBc+yd.nUf,oc=ya.Fyb+ya.UNe-Vb);break}if(!cd)return!1;break;case 7:Vb=ya.Fyb;oc=ya.UNe;break;default:throw Error.notImplemented();}return null!==this.Ka.Kvn.K7n(Wc.ldo,Vb,oc,Vb,!0,2,Ab)}}Object(k.a)(Za,"SubSreWhereConstraintFilter",null,[1177]);class Ya{constructor(ya,Ab){if(ya){var Vb=Ab.getString(ya.J(0));this.KOe=Vb.charCodeAt(0);this.gTn=Vb.substr(1);this.Kvn=Ab.qel(ya.J(1))}}}Object(k.a)(Ya,
"SubSreWhereConstraintFilterInit",null,[]);class Ka{constructor(ya){this.Ka=ya}isMatch(ya,Ab,Vb=null){if(!Object(A.a)(1153,ya))throw Error.argument("objToTest","Expected feature bundle");if(null==Vb)throw Error.argumentNull("parentTextForSpan");if(this.Ka.NRg&&!this.Ka.NRg.isMatch(ya,Ab))return!1;if(this.Ka.MXf){let oc;if(({value:oc}=ya.Ro(this.Ka.Lun)).returnValue){if(!this.Ka.MXf.isMatch(oc,Ab))return!1}else{let Wc,cd;if(!({value:Wc}=ya.Ro(this.Ka.NJi)).returnValue||!({value:cd}=ya.Ro(this.Ka.MJi)).returnValue||
0>Wc||0>cd||Wc+cd>Vb.length||!this.Ka.MXf.isMatch(Vb.substr(Wc,cd),Ab))return!1}}if(this.Ka.IKi){let oc;if(!({value:oc}=ya.Ro(this.Ka.NJi)).returnValue||!this.Ka.IKi.isMatch(oc,Ab))return!1}if(this.Ka.e_h){let oc;if(!({value:oc}=ya.Ro(this.Ka.MJi)).returnValue||!this.Ka.e_h.isMatch(oc,Ab))return!1}return!0}}Object(k.a)(Ka,"TextSpanFilter",null,[1177]);class xa{constructor(ya,Ab){ya&&(this.le=Ab.le,this.NJi=ya.J(0),this.MJi=ya.J(1),this.Lun=ya.J(2),this.MXf=ya.J(3)?Ab.Mia(ya.J(3)):null,this.NRg=ya.J(4)?
Ab.Mia(ya.J(4)):null,this.IKi=ya.J(5)?Ab.Mia(ya.J(5)):null,this.e_h=ya.J(6)?Ab.Mia(ya.J(6)):null)}}Object(k.a)(xa,"TextSpanFilterInit",null,[]);class Sa{constructor(ya,Ab){ya&&(this.le=Ab.le,this.Qoa=ya.J(0),this.Q1f=ya.J(1)?Ab.Mia(ya.J(1)):null)}}Object(k.a)(Sa,"ValueFilterAnnotationFilterInit",null,[]);var pb=b(1331);class Db{Mia(ya,Ab){const Vb=ya.J(0),oc=new pb.a;oc.aab(ya,1,ya.count-1);switch(Vb){case 1:return new V(new W(oc,Ab),0);case 2:return new V(new W(oc,Ab),1);case 3:return new V(new W(oc,
Ab),2);case 101:return new Ga(new $a(oc,Ab));case 103:return new ha(new pa(oc,Ab),0);case 104:return new ha(new pa(oc,Ab),1);case 105:return new ha(new pa(oc,Ab),2);case 106:return new ha(new pa(oc,Ab),3);case 107:return new ha(new pa(oc,Ab),4);case 108:return new ha(new pa(oc,Ab),5);case 109:return new ha(new pa(oc,Ab),6);case 201:return new qa(new va(oc));case 202:return new Ba(new sa(oc,Ab));case 301:return new ca(new H(oc,Ab),0);case 302:return new ca(new H(oc,Ab),1);case 303:return new ca(new H(oc,
Ab),2);case 304:return new ca(new H(oc,Ab),3);case 305:return new ca(new H(oc,Ab),4);case 401:return new Ca(new ta(oc),0);case 402:return new Ca(new ta(oc),1);case 403:return new Ca(new ta(oc),2);case 404:return new la(new ia(oc,Ab),0);case 405:return new la(new ia(oc,Ab),1);case 406:return new la(new ia(oc,Ab),2);case 407:return new la(new ia(oc,Ab),3);case 501:return new R(new K(oc,Ab));case 502:return new Ea(new sa(oc,Ab));case 601:return new O(new fa(oc,Ab),0);case 602:return new O(new fa(oc,
Ab),1);case 603:return new N(new fa(oc,Ab));case 604:return new oa(new sa(oc,Ab),0);case 605:return new oa(new sa(oc,Ab),1);case 606:return new oa(new sa(oc,Ab),2);case 607:return new oa(new sa(oc,Ab),3);case 701:return new J(!1);case 702:return new J(!0);case 703:return new Q(new Sa(oc,Ab),!1);case 704:return new Q(new Sa(oc,Ab),!0);case 705:return new M(new Sa(oc,Ab),!1);case 706:return new M(new Sa(oc,Ab),!0);case 707:return new aa(new ja(oc,Ab));case 901:return new Ka(new xa(oc,Ab));case 1002:return new Fa(new sa(oc,
Ab));case 1001:return new Za(new Ya(oc,Ab));default:throw Error.argument("initData");}}}Object(k.a)(Db,"FilterFactory",null,[1152]);var Ua=b(1298);class Lb{constructor(ya){this.Ka=ya}get hB(){return this.Ka.hB}get n1(){return this.Ka.n1}get W3d(){return this.Ka.W3d}get $Hd(){return this.Ka.$Hd}load(ya,Ab){return this.Fr(ya,ya?new Z("root",ya,Ab):Ab)}store(ya,Ab,Vb){this.ebc(ya,Ab,ya?new Z("root",ya,Vb):Vb,null)}Fr(ya,Ab){if(!this.$Hd&&!this.Ka.le.M2b(this.hB,ya))throw Error.argument("input","Input value not of expected type");
let Vb=this.Ka.Gmh;for(;Vb;)ya=Vb.load(ya,Ab),Vb=Vb.next;return ya}ebc(ya,Ab,Vb,oc){if(!this.W3d)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.$Hd&&!this.Ka.le.M2b(this.hB,ya))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ka.le.M2b(this.n1,Ab))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ka.Gmh.store(ya,Ab,Vb,oc)}static D3g(ya,Ab,Vb,oc){if(Vb===oc)return Ab;if(L.Annotations.UF(Vb)&&L.Annotations.UF(oc)){Vb=
L.Annotations.WVa(Vb);oc=L.Annotations.WVa(oc);const Wc=new Ua.a(ya,oc);for(const cd of Ab.items)Array.add(Wc.items,Lb.D3g(ya,cd,Vb,oc));return Wc}if(Vb===L.Annotations.OCa){if(oc===L.Annotations.Rla)return Ab;if(oc===L.Annotations.M5)return Ab.toString()}else if(Vb===L.Annotations.Rla){if(oc===L.Annotations.OCa)return Math.floor(Ab);if(oc===L.Annotations.M5)return Ab.toString()}else if(Vb===L.Annotations.M5){if(oc===L.Annotations.OCa)return parseInt(Ab);if(oc===L.Annotations.Rla)return parseFloat(Ab)}throw Error.invalidOperation("Type conversion failure in query step");
}}Object(k.a)(Lb,"AnnotationQuery",null,[1180]);class Va{constructor(){this.n1=this.hB=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}$Va(ya){if(this.next)return{returnValue:this.next,mCa:ya};if(ya){const Ab=ya.H6g;ya=ya.lji;return{returnValue:Ab,mCa:ya}}return{returnValue:null,mCa:ya}}}Object(k.a)(Va,"AnnotationQueryStep",null,[1203]);class Sb extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){Ab=this.Ka.query.Fr(ya,Ab);if(L.Annotations.UF(this.hB)){var Vb=L.Annotations.WVa(this.hB);
let Wc=new Ua.a(this.Ka.le,Vb);if(L.Annotations.UF(this.Ka.query.n1)){if(ya.items.length!==Ab.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let cd=0,yd=ya.items.length;cd<yd;++cd)Array.add(Wc.items,this.Vnd(ya.items[cd],Ab.items[cd],Vb===L.Annotations.Rla))}else for(var oc of ya.items)Array.add(Wc.items,this.Vnd(oc,Ab,Vb===L.Annotations.Rla));return Wc}if(L.Annotations.UF(this.Ka.query.n1)){oc=new Ua.a(this.Ka.le,this.hB);for(Vb of Ab.items)Array.add(oc.items,
this.Vnd(ya,Vb,this.hB===L.Annotations.Rla));return oc}return this.Vnd(ya,Ab,this.hB===L.Annotations.Rla)}Vnd(ya,Ab,Vb){ya=this.XUb(ya,Ab);return Vb?ya:Math.floor(ya)}}Object(k.a)(Sb,"NumericAnnotationQueryStep",Va,[]);class nb extends Sb{constructor(ya){super(ya)}XUb(ya,Ab){return ya+Ab}}Object(k.a)(nb,"AddAnnotationQueryStep",Sb,[]);class La extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){if(this.hB===L.Annotations.uta&&this.Ka.query.n1===L.Annotations.uta){let Wc;if(({result:Wc}=this.v_g(ya)).returnValue)return Wc}if(L.Annotations.UF(this.hB)){var Vb=
new Ua.a(this.Ka.le,L.Annotations.uta);Ab=this.Ka.query.Fr(ya,Ab);if(L.Annotations.UF(this.Ka.query.n1)){if(ya.items.length!==Ab.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Wc=0,cd=ya.items.length;Wc<cd;++Wc)Array.add(Vb.items,this.jxc(Ab.items[Wc],ya.items[Wc]))}else for(var oc of ya.items)Array.add(Vb.items,this.jxc(Ab,oc));return Vb}oc=this.Ka.query.Fr(ya,Ab);if(L.Annotations.UF(this.Ka.query.n1)){Ab=new Ua.a(this.Ka.le,L.Annotations.uta);
for(Vb of oc.items)Array.add(Ab.items,this.jxc(Vb,ya));return Ab}return this.jxc(oc,ya)}}Object(k.a)(La,"BinaryBooleanAnnotationQueryStep",Va,[]);class Ha extends La{constructor(ya){super(ya)}v_g(ya){return{returnValue:!ya,result:!1}}jxc(ya,Ab){return ya&&Ab}}Object(k.a)(Ha,"AndAnnotationQueryStep",La,[]);class Aa{constructor(ya){ya&&(this.le=ya)}}Object(k.a)(Aa,"AnnotationsOnlyQueryStepInit",null,[]);class Ma extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){Ab=this.Ka.query.Fr(ya,Ab);ya=
ya.clone();L.Annotations.UF(this.Ka.query.n1)?Array.addRange(ya.items,Ab.items):Array.add(ya.items,Ab);return ya}}Object(k.a)(Ma,"AppendAnnotationQueryStep",Va,[]);class cb extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){if(this.hB===L.Annotations.IS)return this.gBc(ya,Ab);const Vb=new Ua.a(this.Ka.le,L.Annotations.IS);for(const oc of ya.items)Array.add(Vb.items,this.gBc(oc,Ab));return Vb}gBc(ya,Ab){const Vb=new E.a(this.Ka.le);Vb.VTa(ya);ya=new E.a(this.Ka.le);this.Ka.script.nIa(null,new Z("Input",
Vb,new Z("Output",ya,Ab)));return ya}}Object(k.a)(cb,"ApplyAnnotationQueryStep",Va,[]);class ib extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){if(this.hB===L.Annotations.IS)return Ab=this.gBc(ya,Ab),Ab.Ro(this.Ka.LRg).returnValue||new Ua.a(this.Ka.le,L.Annotations.IS),Ab;const Vb=new Ua.a(this.Ka.le,L.Annotations.IS);for(const oc of ya.items)if(ya=this.gBc(oc,Ab),({value:ya}=ya.Ro(this.Ka.LRg)).returnValue)for(const Wc of ya.items)Array.add(Vb.items,Wc);return Vb}gBc(ya,Ab){const Vb=new E.a(this.Ka.le);
Vb.VTa(ya);ya=new E.a(this.Ka.le);this.Ka.script.nIa(null,new Z("Input",Vb,new Z("Output",ya,Ab)));return ya}}Object(k.a)(ib,"ApplyExpandAnnotationQueryStep",Va,[]);class Rb{constructor(ya,Ab){ya&&(this.le=Ab.le,this.script=Ab.ywb(ya.J(0)),this.LRg=ya.J(1))}}Object(k.a)(Rb,"ApplyExpandQueryStepInit",null,[]);class Oa{constructor(ya,Ab){ya&&(this.le=Ab.le,this.script=Ab.ywb(ya.J(0)))}}Object(k.a)(Oa,"ApplyQueryStepInit",null,[]);class lb extends Va{constructor(ya){super();this.Ka=ya}load(ya){if(this.hB===
L.Annotations.IS)return this.TMd(ya);const Ab=new Ua.a(this.Ka.le,this.Ka.le.getAttributeType(this.Ka.Qoa));for(const Vb of ya.items)Array.add(Ab.items,this.TMd(Vb));return Ab}store(ya,Ab,Vb,oc){if(this.hB===L.Annotations.IS){var Wc=Ab,cd=({mCa:oc}=this.$Va(oc)).returnValue;cd&&(Wc=cd.store(L.Annotations.TQ(this.TMd(ya)),Ab,Vb,oc));ya.Dw(this.Ka.Qoa,Wc)}else{var yd=Ab;if(Wc=({mCa:oc}=this.$Va(oc)).returnValue){yd=new Ua.a(this.Ka.le,this.Ka.le.getAttributeType(this.Ka.Qoa));for(cd of ya.items)Array.add(yd.items,
this.TMd(cd));yd=Wc.store(yd,Ab,Vb,oc)}Ab=yd;if(Ab.items.length!==ya.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let sc=0,Xd=ya.items.length;sc<Xd;++sc)Vb=ya.items[sc],Vb.isReadOnly&&(Vb=Vb.clone(),ya.items[sc]=Vb),Vb.Dw(this.Ka.Qoa,Ab.items[sc])}return ya}TMd(ya){({value:ya}=ya.Ro(this.Ka.Qoa)).returnValue||(ya=this.Ka.le.nSk(this.Ka.Qoa));return ya}}Object(k.a)(lb,"AttrAnnotationQueryStep",Va,[]);class gb{constructor(ya,Ab){ya&&(this.le=
Ab,this.Qoa=ya.J(0))}}Object(k.a)(gb,"AttrQueryStepInit",null,[]);class Nb extends Va{constructor(ya){super();this.Ka=ya}load(ya){const Ab=new E.a(this.Ka.le);Ab.VTa(ya);return this.Ka.module.execute(Ab)}}Object(k.a)(Nb,"CallModuleAnnotationQueryStep",Va,[]);class qc{constructor(ya,Ab){ya&&(this.le=Ab.le,this.module=Ab.f9e(ya.J(0)))}}Object(k.a)(qc,"CallModuleQueryStepInit",null,[]);class Eb extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){if(L.Annotations.UF(this.hB)){var Vb=this.Ka.query.Fr(ya,
Ab);Ab=new Ua.a(this.Ka.le,L.Annotations.M5);let cd="string"===typeof Vb;for(var oc of ya.items)if(cd)Array.add(Ab.items,oc+Vb);else for(var Wc of Vb.items)Array.add(Ab.items,oc+Wc);return Ab}oc=this.Ka.query.Fr(ya,Ab);if("string"===typeof oc)return ya+oc;Wc=new Ua.a(this.Ka.le,L.Annotations.M5);for(Vb of oc.items)Array.add(Wc.items,ya+Vb);return Wc}}Object(k.a)(Eb,"ConcatAnnotationQueryStep",Va,[]);class ec extends Va{constructor(ya){super();this.Ka=ya}load(ya){return Lb.D3g(this.Ka.le,ya,this.hB,
this.n1)}}Object(k.a)(ec,"ConvertAnnotationQueryStep",Va,[]);class Jb extends Va{constructor(){super()}load(ya){return ya.items.length}}Object(k.a)(Jb,"CountAnnotationQueryStep",Va,[]);class vb extends Sb{constructor(ya){super(ya)}XUb(ya,Ab){return ya/Ab}}Object(k.a)(vb,"DivideAnnotationQueryStep",Sb,[]);class xb extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){Ab=new Z(this.Ka.X7d,null,Ab);for(const Vb of ya.items)if(Ab.aPe(Vb),this.Ka.query.Fr(Vb,Ab))return!0;return!1}}Object(k.a)(xb,"ExistsAnnotationQueryStep",
Va,[]);class lc extends Sb{constructor(ya){super(ya)}XUb(ya,Ab){return Math.pow(ya,Ab)}}Object(k.a)(lc,"ExpAnnotationQueryStep",Sb,[]);class Lc{constructor(ya,Ab){ya&&(this.tIa=Ab.getString(ya.J(0)))}}Object(k.a)(Lc,"FeatureBundleNameQueryStepInit",null,[]);class uc extends Va{constructor(ya){super();this.Ka=ya}load(ya){if(L.Annotations.UF(this.hB)){const Ab=new Ua.a(this.Ka.le,this.Ka.le.Nxb(L.Annotations.WVa(this.hB),this.Ka.vIa));for(const Vb of ya.items)Array.add(Ab.items,Vb.Bab(this.Ka.vIa));
return Ab}return ya.Bab(this.Ka.vIa)}store(ya,Ab,Vb,oc){if(L.Annotations.UF(this.hB)){var Wc=Ab,cd=({mCa:oc}=this.$Va(oc)).returnValue;if(cd){Wc=new Ua.a(this.Ka.le,this.Ka.le.Nxb(L.Annotations.WVa(this.hB),this.Ka.vIa));for(var yd of ya.items)Array.add(Wc.items,yd.Bab(this.Ka.vIa));Wc=cd.store(Wc,Ab,Vb,oc)}Ab=Wc;if(Ab.items.length!==ya.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let sc=0,Xd=ya.items.length;sc<Xd;++sc)Vb=ya.items[sc],Vb.isReadOnly&&
(Vb=Vb.clone(),ya.items[sc]=Vb),Vb.LPf(this.Ka.vIa,Ab.items[sc])}else cd=Ab,(yd=({mCa:oc}=this.$Va(oc)).returnValue)&&(cd=yd.store(L.Annotations.TQ(ya.Bab(this.Ka.vIa)),Ab,Vb,oc)),ya.LPf(this.Ka.vIa,cd);return ya}}Object(k.a)(uc,"FieldAnnotationQueryStep",Va,[]);class od{constructor(ya,Ab){ya&&(this.le=Ab,this.vIa=ya.J(0))}}Object(k.a)(od,"FieldQueryStepInit",null,[]);class Cb extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){for(const Vb of ya.items)if(this.Ka.filter.isMatch(Vb,Ab))return Vb;
throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(ya,Ab,Vb,oc){let Wc=Ab,cd=-1;for(let sc=0,Xd=ya.items.length;sc<Xd;sc++)if(this.Ka.filter.isMatch(ya.items[sc],Vb)){cd=sc;break}if(0>cd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const yd=({mCa:oc}=this.$Va(oc)).returnValue;yd&&(Wc=yd.store(L.Annotations.TQ(ya.items[cd]),Ab,Vb,oc));ya.items[cd]=Wc;return ya}}Object(k.a)(Cb,"FirstItemMatchingAnnotationQueryStep",
Va,[]);class gc extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){Ab=new Z(this.Ka.X7d,null,Ab);for(const Vb of ya.items)if(Ab.aPe(Vb),!this.Ka.query.Fr(Vb,Ab))return!1;return!0}}Object(k.a)(gc,"ForAllAnnotationQueryStep",Va,[]);class Dc extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){ya=Ab?Ab.Azd(this.Ka.tIa):null;if(!ya)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ka.tIa+'"');return ya}store(ya,Ab,Vb,oc){ya=Vb?Vb.Azd(this.Ka.tIa):null;if(!ya)throw Error.invalidOperation('Feature bundle resolution failure: "'+
this.Ka.tIa+'"');let Wc=Ab;const cd=({mCa:oc}=this.$Va(oc)).returnValue;cd&&(Wc=cd.store(ya,Ab,Vb,oc));ya!==Wc&&ya.VTa(Wc);return ya}}Object(k.a)(Dc,"GetAnnotationQueryStep",Va,[]);class Ub{constructor(ya,Ab){this.Qaj=ya;this.Yqj=Ab}get H6g(){return this.Qaj}get lji(){return this.Yqj}}Object(k.a)(Ub,"AnnotationQueryStoreContinuation",null,[1204]);class Bb extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){return this.Ka.U4d.Fr(ya,Ab)?this.Ka.IQi.Fr(ya,Ab):this.Ka.hwd?this.Ka.hwd.Fr(ya,Ab):
ya}store(ya,Ab,Vb,oc){var Wc=this.Ka.U4d.Fr(ya,Vb);this.next&&(oc=new Ub(this.next,oc));if(Wc)return this.Ka.IQi.ebc(ya,Ab,Vb,oc);if(this.Ka.hwd)return this.Ka.hwd.ebc(ya,Ab,Vb,oc);Wc=Ab;let cd=null;oc&&(cd=oc.H6g,oc=oc.lji);cd&&(Wc=cd.store(L.Annotations.TQ(ya),Ab,Vb,oc));return Wc}}Object(k.a)(Bb,"IfAnnotationQueryStep",Va,[]);class fb{constructor(ya,Ab){ya&&(this.U4d=Ab.nI(ya.J(0)),this.IQi=Ab.nI(ya.J(1)),this.hwd=ya.J(2)?Ab.nI(ya.J(2)):null)}}Object(k.a)(fb,"IfQueryStepInit",null,[]);class yb{constructor(ya,
Ab){ya&&(this.zyl=Ab.nI(ya.J(0)),this.wYh=Ab.nI(ya.J(1)))}}Object(k.a)(yb,"IndexAndItemQueryStepInit",null,[]);class Wb extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){const Vb=this.Ka.zyl.Fr(ya,Ab);Ab=this.Ka.wYh.Fr(ya,Ab);ya=ya.clone();if(0>Vb||Vb>ya.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(L.Annotations.UF(this.Ka.wYh.n1))for(let oc=0;oc<Ab.items.length;++oc)Array.insert(ya.items,Vb+oc,Ab.items[oc]);else Array.insert(ya.items,Vb,Ab);
return ya}}Object(k.a)(Wb,"InsertAtAnnotationQueryStep",Va,[]);class Xb extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){return!(!Ab||!Ab.Azd(this.Ka.tIa))}}Object(k.a)(Xb,"IsDefinedAnnotationQueryStep",Va,[]);class Cc extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){Ab=this.aK(ya,Ab);return ya.items[Ab]}store(ya,Ab,Vb,oc){const Wc=this.aK(ya,Vb);let cd=Ab;const yd=({mCa:oc}=this.$Va(oc)).returnValue;yd&&(cd=yd.store(L.Annotations.TQ(ya.items[Wc]),Ab,Vb,oc));ya.items[Wc]=cd;return ya}aK(ya,
Ab){Ab=this.Ka.query.Fr(ya,Ab);if(0>Ab||Ab>=ya.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Ab}}Object(k.a)(Cc,"ItemAnnotationQueryStep",Va,[]);class Bc extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){const Vb=new Ua.a(this.Ka.le,L.Annotations.WVa(this.hB));for(const oc of ya.items)this.Ka.filter.isMatch(oc,Ab)&&Array.add(Vb.items,oc);return Vb}}Object(k.a)(Bc,"ItemsMatchingAnnotationQueryStep",Va,[]);class pd extends Va{constructor(ya){super();
this.Ka=ya}load(ya,Ab){Ab=this.aK(ya,Ab);return ya.items[ya.items.length-Ab-1]}store(ya,Ab,Vb,oc){const Wc=this.aK(ya,Vb);let cd=Ab;const yd=({mCa:oc}=this.$Va(oc)).returnValue;yd&&(cd=yd.store(L.Annotations.TQ(ya.items[ya.items.length-Wc-1]),Ab,Vb,oc));ya.items[ya.items.length-Wc-1]=cd;return ya}aK(ya,Ab){Ab=this.Ka.query?this.Ka.query.Fr(ya,Ab):0;if(0>Ab||Ab>=ya.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Ab}}Object(k.a)(pd,"LastItemAnnotationQueryStep",
Va,[]);class zd extends Va{constructor(ya){super();this.Ka=ya}load(ya){if(L.Annotations.UF(this.hB)){const Ab=new Ua.a(this.Ka.le,L.Annotations.OCa);for(const Vb of ya.items)Array.add(Ab.items,Vb.length);return Ab}return ya.length}}Object(k.a)(zd,"LengthAnnotationQueryStep",Va,[]);class Jd extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){if(L.Annotations.UF(this.hB)){const Vb=new Ua.a(this.Ka.le,L.Annotations.uta);for(const oc of ya.items)Array.add(Vb.items,this.Ka.filter.isMatch(oc,Ab));
return Vb}return this.Ka.filter.isMatch(ya,Ab)}}Object(k.a)(Jd,"MatchesAnnotationQueryStep",Va,[]);class Ue extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){return this.Ka.filter.isMatch(ya,Ab)}}Object(k.a)(Ue,"MatchesAsListAnnotationQueryStep",Va,[]);class Sc extends Sb{constructor(ya){super(ya)}XUb(ya,Ab){return ya%Ab}}Object(k.a)(Sc,"ModuloAnnotationQueryStep",Sb,[]);class kc extends Sb{constructor(ya){super(ya)}XUb(ya,Ab){return ya*Ab}}Object(k.a)(kc,"MultiplyAnnotationQueryStep",Sb,
[]);class Pc extends Va{constructor(ya){super();this.Ka=ya}load(ya){if(L.Annotations.UF(this.hB)){const Ab=new Ua.a(this.Ka.le,L.Annotations.uta);for(const Vb of ya.items)Array.add(Ab.items,!Vb);return Ab}return!ya}}Object(k.a)(Pc,"NotAnnotationQueryStep",Va,[]);class Rd extends La{constructor(ya){super(ya)}v_g(ya){return{returnValue:ya,result:!0}}jxc(ya,Ab){return ya||Ab}}Object(k.a)(Rd,"OrAnnotationQueryStep",La,[]);class le extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){const Vb=this.Ka.gVf.Fr(ya,
Ab);ya=this.Ka.ayc.Fr(ya,Ab);Ab=new Ua.a(this.Ka.le,L.Annotations.OCa);for(let oc=0;oc<ya;++oc)Array.add(Ab.items,Vb+oc);return Ab}}Object(k.a)(le,"RangeAnnotationQueryStep",Va,[]);class Fc{constructor(ya,Ab){ya&&(this.le=Ab.le,this.filter=Ab.Mia(ya.J(0)))}}Object(k.a)(Fc,"SingleFilterQueryStepInit",null,[]);class He{constructor(ya,Ab){ya&&(this.le=Ab.le,this.query=ya.J(0)?Ab.nI(ya.J(0)):null)}}Object(k.a)(He,"SingleOptionalQueryQueryStepInit",null,[]);class $e{constructor(ya,Ab){ya&&(this.le=Ab.le,
this.query=Ab.nI(ya.J(0)))}}Object(k.a)($e,"SingleQueryQueryStepInit",null,[]);class Le{constructor(ya,Ab){ya&&(this.le=Ab.le,this.gVf=Ab.nI(ya.J(0)),this.ayc=ya.J(1)?Ab.nI(ya.J(1)):null)}}Object(k.a)(Le,"StartAndCountOrLengthQueryStepInit",null,[]);class df extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){let Vb;({startIndex:Ab,length:Vb}=this.iCd(ya,Ab));const oc=new Ua.a(this.Ka.le,ya.R0);for(let Wc=0;Wc<Vb;++Wc)Array.add(oc.items,ya.items[Ab+Wc]);return oc}store(ya,Ab,Vb,oc){let Wc,cd;
({startIndex:Wc,length:cd}=this.iCd(ya,Vb));var yd=Ab;const sc=({mCa:oc}=this.$Va(oc)).returnValue;if(sc){yd=new Ua.a(this.Ka.le,ya.R0);for(let Xd=0;Xd<cd;++Xd)Array.add(yd.items,ya.items[Wc+Xd]);yd=sc.store(yd,Ab,Vb,oc)}Ab=yd;for(Vb=0;Vb<cd;++Vb)Array.removeAt(ya.items,Wc);for(let Xd=0,Sd=Ab.items.length;Xd<Sd;++Xd)Array.insert(ya.items,Wc+Xd,Ab.items[Xd]);return ya}iCd(ya,Ab){let Vb;Vb=this.Ka.gVf.Fr(ya,Ab);if(0>Vb)throw Error.invalidOperation("Invalid start index in Sublist() query step");Ab=this.Ka.ayc?
this.Ka.ayc.Fr(ya,Ab):ya.items.length-Vb;if(0>Ab||Vb+Ab>ya.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:Vb,length:Ab}}}Object(k.a)(df,"SublistAnnotationQueryStep",Va,[]);class Af extends Va{constructor(ya){super();this.Ka=ya}load(ya,Ab){if(L.Annotations.UF(this.hB)){const Vb=new Ua.a(this.Ka.le,L.Annotations.M5);for(let oc=0,Wc=ya.items.length;oc<Wc;++oc)Array.add(Vb.items,this.zDh(ya.items[oc],Ab));return Vb}return this.zDh(ya,
Ab)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}zDh(ya,Ab){let Vb;({startIndex:Ab,length:Vb}=this.iCd(ya,Ab));return ya.substr(Ab,Vb)}iCd(ya,Ab){let Vb;Vb=this.Ka.gVf.Fr(ya,Ab);if(0>Vb)throw Error.invalidOperation("Invalid start index in Substring() query step");Ab=this.Ka.ayc?this.Ka.ayc.Fr(ya,Ab):ya.length-Vb;if(0>Ab||Vb+Ab>ya.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:Vb,length:Ab}}}
Object(k.a)(Af,"SubstringAnnotationQueryStep",Va,[]);class Ve extends Sb{constructor(ya){super(ya)}XUb(ya,Ab){return ya-Ab}}Object(k.a)(Ve,"SubtractAnnotationQueryStep",Sb,[]);class Kc extends Va{constructor(ya){super();this.Ka=ya}load(ya){const Ab=new Ua.a(this.Ka.le,L.Annotations.M5);for(let Vb=0;Vb<ya.length;++Vb)Array.add(Ab.items,ya.charAt(Vb).toString());return Ab}}Object(k.a)(Kc,"ToCharListAnnotationQueryStep",Va,[]);class hd extends Va{constructor(ya){super();this.Ka=ya}load(ya){const Ab=
new Ua.a(this.Ka.le,this.hB);Array.add(Ab.items,ya);return Ab}}Object(k.a)(hd,"ToListAnnotationQueryStep",Va,[]);class id extends Va{constructor(ya){super();this.Ka=ya}load(){return this.Ka.value}}Object(k.a)(id,"ValueAnnotationQueryStep",Va,[]);class oh{constructor(ya,Ab){if(ya){var Vb=ya.J(0),oc=1;this.value=({Jca:oc}=Ab.VHa(Vb,ya,oc,null,null,null)).returnValue;L.Annotations.zBb(this.value)}}}Object(k.a)(oh,"ValueQueryStepInit",null,[]);class vf{constructor(ya,Ab){ya&&(this.X7d=Ab.getString(ya.J(0)),
this.query=Ab.nI(ya.J(1)))}}Object(k.a)(vf,"VarNameAndQueryQueryStepInit",null,[]);class Yc{constructor(ya,Ab){this.Sig=null;if(ya){this.le=Ab.le;var Vb=0;this.hB=ya.J(Vb);++Vb;this.n1=ya.J(Vb);++Vb;this.W3d=1===ya.J(Vb);++Vb;this.$Hd=1===ya.J(Vb);++Vb;var oc=ya.J(Vb);++Vb;if(oc){var Wc=Vb,cd=Vb+oc,yd=Vb+2*oc;Vb+=3*oc;var sc=ya.count-Vb,Xd=null;for(let wf=0;wf<oc;++wf){var Sd=Vb+ya.J(yd+wf);const Xi=(wf===oc-1?sc:ya.J(yd+wf+1))-ya.J(yd+wf),Ak=new pb.a;Ak.aab(ya,Sd,Xi);Sd=Yc.h8k(ya.J(cd+wf),Ak,Ab);
Sd.hB=ya.J(Wc+wf);Sd.n1=wf===oc-1?this.n1:ya.J(Wc+wf+1);Xd?Xd.next=Sd:this.Sig=Sd;Xd=Sd}}}}get Gmh(){return this.Sig}static h8k(ya,Ab,Vb){switch(ya){case 1:return new Dc(new Lc(Ab,Vb));case 2:return new Xb(new Lc(Ab,Vb));case 3:return new lb(new gb(Ab,Vb.le));case 4:return new uc(new od(Ab,Vb.le));case 5:return new Bb(new fb(Ab,Vb));case 6:return new Jd(new Fc(Ab,Vb));case 43:return new Ue(new Fc(Ab,Vb));case 45:return new cb(new Oa(Ab,Vb));case 49:return new ib(new Rb(Ab,Vb));case 46:return new id(new oh(Ab,
Vb.le));case 51:return new Nb(new qc(Ab,Vb));case 52:return new le(new Le(Ab,Vb));case 53:return new ec(new Aa(Vb.le));case 13:return new Cc(new $e(Ab,Vb));case 14:return new pd(new He(Ab,Vb));case 15:return new Jb;case 18:return new Cb(new Fc(Ab,Vb));case 16:return new gc(new vf(Ab,Vb));case 17:return new xb(new vf(Ab,Vb));case 22:return new Wb(new yb(Ab,Vb));case 24:return new Ma(new $e(Ab,Vb));case 26:return new df(new Le(Ab,Vb));case 27:return new Bc(new Fc(Ab,Vb));case 30:return new hd(new Aa(Vb.le));
case 31:return new Af(new Le(Ab,Vb));case 32:return new Eb(new $e(Ab,Vb));case 47:return new zd(new Aa(Vb.le));case 48:return new Kc(new Aa(Vb.le));case 34:return new nb(new $e(Ab,Vb));case 35:return new Ve(new $e(Ab,Vb));case 36:return new kc(new $e(Ab,Vb));case 37:return new vb(new $e(Ab,Vb));case 38:return new Sc(new $e(Ab,Vb));case 39:return new lc(new $e(Ab,Vb));case 40:return new Ha(new $e(Ab,Vb));case 41:return new Rd(new $e(Ab,Vb));case 42:return new Pc(new Aa(Vb.le));default:throw Error.argument("currStepInitData");
}}}Object(k.a)(Yc,"AnnotationQueryInit",null,[]);class sb{constructor(ya){this.Ka=ya}execute(ya,Ab){this.nIa(ya,ya?new Z("root",ya,Ab):Ab)}nIa(ya,Ab){for(const Vb of this.Ka.commands)Ab=Vb.execute(ya,Ab)}}Object(k.a)(sb,"AnnotationScript",null,[1179]);class Qb{constructor(ya){this.Ka=ya}execute(ya,Ab){const Vb=this.Ka.pCl.Fr(ya,Ab),oc=this.Ka.zwm.Fr(ya,Ab);this.Ka.script.nIa(ya,new Z("Input",Vb,new Z("Output",oc,Ab)));return Ab}}Object(k.a)(Qb,"ApplyAnnotationScriptCommand",null,[1201]);class Oc{constructor(ya,
Ab){ya&&(this.pCl=Ab.nI(ya.J(0)),this.zwm=Ab.nI(ya.J(1)),this.script=Ab.ywb(ya.J(2)))}}Object(k.a)(Oc,"ApplyScriptCommandInit",null,[]);class wc{constructor(ya){this.Ka=ya}execute(ya,Ab){const Vb=this.Ka.wNf.Fr(ya,Ab);this.Ka.zNd.ebc(ya,Vb,Ab,null);return Ab}}Object(k.a)(wc,"AssignAnnotationScriptCommand",null,[1201]);class yc{constructor(ya){this.Ka=ya}execute(ya,Ab){const Vb=this.Ka.zNd.Fr(ya,Ab);ya=this.Ka.wNf.Fr(ya,Ab);Vb!==ya&&Vb.VTa(ya);return Ab}}Object(k.a)(yc,"CopyAnnotationScriptCommand",
null,[1201]);class ef{constructor(ya){this.Ka=ya}execute(ya,Ab){let Vb=this.Ka.Xof.Fr(ya,Ab);if(this.Ka.Xof.W3d){Vb=L.Annotations.TQ(Vb);var oc=new Z(this.Ka.tIa,null,Ab);for(let cd=0,yd=Vb.items.length;cd<yd;++cd){var Wc=this.njh(ya,Vb.items[cd],oc);if(0>this.Ka.eZd)Vb.items[cd]=Wc;else if(({value:Wc}=Wc.Ro(this.Ka.eZd)).returnValue)Vb.items[cd]=Wc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ka.Xof.ebc(ya,Vb,Ab,null)}else{oc=new Z(this.Ka.tIa,
null,Ab);for(let cd=0,yd=Vb.items.length;cd<yd;++cd)this.njh(ya,Vb.items[cd],oc)}return Ab}njh(ya,Ab,Vb){let oc;0>this.Ka.eZd?oc=L.Annotations.TQ(Ab):(oc=new E.a(this.Ka.le),oc.Dw(this.Ka.eZd,Ab));Vb.aPe(oc);this.Ka.cUj.nIa(ya,Vb);return oc}}Object(k.a)(ef,"EnumerateAnnotationScriptCommand",null,[1201]);class Je{constructor(ya,Ab){ya&&(this.le=Ab.le,this.tIa=Ab.getString(ya.J(0)),this.Xof=Ab.nI(ya.J(1)),this.cUj=Ab.ywb(ya.J(2)),this.eZd=ya.J(3))}}Object(k.a)(Je,"EnumerateScriptCommandInit",null,[]);
class fh{constructor(ya){this.Ka=ya}execute(ya,Ab){this.Ka.U4d.Fr(ya,Ab)?this.Ka.RGn.nIa(ya,Ab):this.Ka.rkh&&this.Ka.rkh.nIa(ya,Ab);return Ab}}Object(k.a)(fh,"IfAnnotationScriptCommand",null,[1201]);class re{constructor(ya,Ab){ya&&(this.U4d=Ab.nI(ya.J(0)),this.RGn=Ab.ywb(ya.J(1)),this.rkh=ya.J(2)?Ab.ywb(ya.J(2)):null)}}Object(k.a)(re,"IfScriptCommandInit",null,[]);class Se{constructor(ya,Ab){ya&&(this.le=Ab.le,this.zNd=Ab.nI(ya.J(0)),this.wNf=Ab.nI(ya.J(1)))}}Object(k.a)(Se,"LvalueAndRvalueQueryScriptCommandInit",
null,[]);class Ye{constructor(ya){this.Ka=ya}execute(ya,Ab){const Vb=this.Ka.wNf.Fr(this.Ka.zNd.Fr(ya,Ab),Ab);this.Ka.zNd.ebc(ya,Vb,Ab,null);return Ab}}Object(k.a)(Ye,"ModifyAnnotationScriptCommand",null,[1201]);class Ji{constructor(ya){this.Ka=ya}execute(ya,Ab){const Vb=new E.a(this.Ka.le);this.Ka.query&&Vb.VTa(this.Ka.query.Fr(ya,Ab));return Ab=new Z(this.Ka.tIa,Vb,Ab)}}Object(k.a)(Ji,"NewAnnotationScriptCommand",null,[1201]);class ah{constructor(ya,Ab){ya&&(this.le=Ab.le,this.tIa=Ab.getString(ya.J(0)),
this.query=ya.J(1)?Ab.nI(ya.J(1)):null)}}Object(k.a)(ah,"NewScriptCommandInit",null,[]);class ag{constructor(ya){this.Ka=ya}execute(ya,Ab){ya=this.Ka.query.Fr(ya,Ab);if(this.Ka.query.n1===L.Annotations.IS)ya.sMa(this.Ka.Qoa);else for(const Vb of ya.items)Vb.sMa(this.Ka.Qoa);return Ab}}Object(k.a)(ag,"RemoveAnnotationScriptCommand",null,[1201]);class rg{constructor(ya,Ab){ya&&(this.le=Ab.le,this.query=Ab.nI(ya.J(0)),this.Qoa=ya.J(1))}}Object(k.a)(rg,"RemoveScriptCommandInit",null,[]);class pi{constructor(ya,
Ab){if(ya){var Vb=0,oc=ya.J(Vb);++Vb;if(oc){var Wc=Vb,cd=Vb+oc;Vb+=2*oc;var yd=ya.count-Vb;this.commands=Array(oc);for(let sc=0;sc<oc;++sc){const Xd=Vb+ya.J(cd+sc),Sd=(sc===oc-1?yd:ya.J(cd+sc+1))-ya.J(cd+sc),wf=new pb.a;wf.aab(ya,Xd,Sd);this.commands[sc]=pi.Y7k(ya.J(Wc+sc),wf,Ab)}}}}static Y7k(ya,Ab,Vb){switch(ya){case 1:return new wc(new Se(Ab,Vb));case 2:return new Ye(new Se(Ab,Vb));case 3:return new ag(new rg(Ab,Vb));case 6:return new Ji(new ah(Ab,Vb));case 7:return new ef(new Je(Ab,Vb));case 8:return new fh(new re(Ab,
Vb));case 9:return new yc(new Se(Ab,Vb));case 10:return new Qb(new Oc(Ab,Vb));default:throw Error.argument("initData");}}}Object(k.a)(pi,"AnnotationScriptInit",null,[]);var Rj=b(1466);class Ki{constructor(ya){this.lZ=ya;this.Vv=0}Y4(){const ya=this.lZ.Cw(this.Vv,4);this.Vv+=4;return ya}get Kuc(){return this.lZ}get offset(){return this.Vv}set offset(ya){this.Vv=ya}}Object(k.a)(Ki,"ByteArrayReader",null,[]);class Fd{constructor(){this.aH=null;this.$2h=this.n9=0}J(ya){if(0>ya||ya>=this.n9)throw Error.argumentOutOfRange("index");
return this.aH.Cw(this.$2h+4*ya,4)}get count(){return this.n9}static cik(ya,Ab,Vb){const oc=new Fd;oc.aH=ya;oc.$2h=Ab;oc.n9=Vb;return oc}}Object(k.a)(Fd,"ReadOnlyListOverByteArray",null,[1173]);class Ld{constructor(ya,Ab){this.T2h=this.S2h=!1;this.Au=this.bLa=this.Aqf=this.W2h=null;try{this.Au=Ab.le;const Vb=Ab.nab(ya.J(0)),oc=new Ki(Vb);if(-914743053!==oc.Y4())throw Error.argument("Input does not represent a flat lexicon");this.S2h=1===oc.Y4();this.T2h=1===oc.Y4();const Wc=oc.Y4();oc.offset+=Wc;
const cd=oc.Y4();this.Aqf=Ld.Kym(oc,cd,this.Au);const yd=oc.Y4();this.W2h=Ld.azm(oc,yd);const sc=oc.Y4();this.bLa=new Rj.a(oc.Kuc,oc.offset);oc.offset+=sc}catch(Vb){throw Error.argument("initData");}}get trie(){return this.bLa}$Tk(ya){return"i"===ya&&this.T2h?"\u0130":ya.toUpperCase()}Jhf(){return this.S2h}FRk(ya){let Ab;Ab=new Ua.a(this.Au,L.Annotations.IS);if(1!==ya)if(0===ya)ya=new E.a(this.Au),Array.add(Ab.items,ya);else if(ya&1073741824){ya=this.W2h[ya&-1073741825];for(let oc=0;oc<ya.length;++oc){var Vb=
ya[oc];Vb=0===Vb?new E.a(this.Au):this.Aqf[Vb-2];Array.add(Ab.items,Vb)}}else Array.add(Ab.items,this.Aqf[ya-2]);return{returnValue:!0,MYl:Ab}}static Kym(ya,Ab,Vb){if(Ab%4)throw Error.argument("reader");const oc=Fd.cik(ya.Kuc,ya.offset,Ab/4);ya.offset+=Ab;ya=[];for(Ab=0;Ab<oc.count;){const Wc=({Jca:Ab}=Vb.VHa(L.Annotations.IS,oc,Ab,null,null,null)).returnValue;Array.add(ya,Wc)}return ya}static azm(ya,Ab){Ab=ya.offset+Ab;const Vb=[];for(;ya.offset<Ab;){const oc=ya.Y4(),Wc=Array(oc);for(let cd=0;cd<
oc;++cd){const yd=ya.Y4();Wc[cd]=yd}Array.add(Vb,Wc)}return Vb}}Object(k.a)(Ld,"RawFlatLexicon",null,[1178]);var we=b(1458),Te=b(1459);class Dj{constructor(ya){if(null==ya)throw Error.argumentNull("base64String");const Ab=ya.length;if(Ab%4)throw Error.argument("base64String's length must be a multiple of 4");this.n9=.75*Ab;this.KBb=Array(Math.ceil(this.n9/4));ya.endsWith("==")?this.n9-=2:ya.endsWith("=")&&--this.n9;let Vb=0;for(let oc=0;oc<Ab;oc+=4){const Wc=Dj.RZd[ya.charCodeAt(oc)-43]<<18|Dj.RZd[ya.charCodeAt(oc+
1)-43]<<12|Dj.RZd[ya.charCodeAt(oc+2)-43]<<6|Dj.RZd[ya.charCodeAt(oc+3)-43];let cd=Wc>>16&255;this.KBb[Math.floor(Vb/4)]|=cd<<Vb%4*8;++Vb;cd=Wc>>8&255;this.KBb[Math.floor(Vb/4)]|=cd<<Vb%4*8;++Vb;cd=Wc&255;this.KBb[Math.floor(Vb/4)]|=cd<<Vb%4*8;++Vb}}get length(){return this.n9}J(ya){if(0>ya||ya>=this.n9)throw Error.argumentOutOfRange("i");return this.crh(ya)}Cw(ya,Ab){if(0>ya||0>Ab||ya+Ab>this.n9)throw Error.argument("Bad range");let Vb=0;for(let oc=0;oc<Ab;++oc)Vb|=this.crh(ya+oc)<<8*oc;return Vb}hNm(ya,
Ab){let Vb=0,oc=0,Wc=Math.floor(ya/8);for(ya%=8;oc<Ab;){const cd=8-ya>Ab-oc?Ab-oc:8-ya,yd=this.J(Wc);Vb|=(yd>>ya&~(255<<cd))<<oc;oc+=cd;++Wc;ya=0}return Vb}crh(ya){return this.KBb[Math.floor(ya/4)]>>ya%4*8&255}}Dj.RZd=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(k.a)(Dj,"ByteArray",null,[]);class oi{constructor(ya,Ab,Vb){this.kB=
ya;this.E9l=Ab;this.H9l=Vb;this.h3h=Array(ya.b?ya.b.length:0);this.Wqf=new we.a(new Te.a(this.nab(this.kB.s)));this.F4=Array(ya.t.length);this.VC=new L.Annotations(this.lab(0),this)}get le(){return this.VC}get fyk(){return this.kB.d}w7k(){if(!(""in this.kB.m))throw Error.argument("name","Unrecognized module");return this.f9e(this.kB.m[""])}nab(ya){if(0>ya||!this.kB.b||ya>=this.kB.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.h3h[ya]||(this.h3h[ya]=new Dj(this.kB.b[ya]))}getString(ya){if(1>
ya||ya>=this.kB.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.kB.t[ya])throw Error.argument("blobID","Requested blob is not a string");if(null==this.F4[ya]){const Ab=this.lab(ya).J(0);this.F4[ya]=this.Wqf.getString(Ab)}return this.F4[ya]}C_b(ya){if(1>ya||ya>=this.kB.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.kB.t[ya])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.F4[ya]){var Ab=this.lab(ya);const Vb=this.getString(Ab.J(0));Ab=1===Ab.J(1);
this.F4[ya]=new RegExp(Vb,Ab?"i":"")}return this.F4[ya]}qel(ya){if(1>ya||ya>=this.kB.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.kB.t[ya])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}f9e(ya){if(1>ya||ya>=this.kB.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.kB.t[ya])throw Error.argument("blobID","Requested blob is not an NL module");return this.F4[ya]||(this.F4[ya]=this.H9l.P7k(this.lab(ya),this))}nI(ya){if(1>ya||ya>=
this.kB.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.kB.t[ya])throw Error.argument("blobID","Requested blob is not an annotation query");return this.F4[ya]||(this.F4[ya]=new Lb(new Yc(this.lab(ya),this)))}ywb(ya){if(1>ya||ya>=this.kB.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.kB.t[ya])throw Error.argument("blobID","Requested blob is not an annotation script");return this.F4[ya]||(this.F4[ya]=new sb(new pi(this.lab(ya),this)))}Mia(ya){if(1>ya||ya>=this.kB.t.length)throw Error.argumentOutOfRange("blobID");
if(7!==this.kB.t[ya])throw Error.argument("blobID","Requested blob is not a filter");return this.F4[ya]||(this.F4[ya]=this.E9l.Mia(this.lab(ya),this))}Gcl(ya){if(1>ya||ya>=this.kB.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.kB.t[ya])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.F4[ya]||(this.F4[ya]=new Ld(this.lab(ya),this))}lab(ya){const Ab=this.kB.n[ya];ya=(ya<this.kB.t.length-1?this.kB.n[ya+1]:this.kB.n.length)-Ab;if(0>Ab||0>ya||Ab+ya>
this.kB.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+Ab+","+ya+")");const Vb=new pb.a;Vb.V3e(this.kB.n,Ab,ya);return Vb}}Object(k.a)(oi,"ObjectFetcher",null,[1151]);class ik{constructor(ya,Ab,Vb){if(!ya)throw Error.argumentNull("prediction");if(!Ab)throw Error.argumentNull("fieldNames");if(!Vb)throw Error.argumentNull("values");if(Ab.length!==Vb.length)throw Error.argument("values","fieldNames and values do not have same length");this.Mqj=ya;this.LBb=Ab;this.CMc=
Vb}get prediction(){return this.Mqj}get Qkh(){return this.LBb.length}w7e(ya){return 0<=ya&&ya<this.LBb.length?this.LBb[ya]:null}getValue(ya){return 0<=ya&&ya<this.CMc.length?this.CMc[ya]:null}}Object(k.a)(ik,"PredictionData",null,[]);class Nf{constructor(ya,Ab){if(!ya)throw Error.argumentNull("predictions");if(!Ab)throw Error.argumentNull("tokenAttributes");this.K9l=ya;this.P9l=Ab}h$e(){return this.K9l}Xph(){return this.P9l}}Object(k.a)(Nf,"PredictionDataWithTokenAttributes",null,[]);class vj{constructor(ya,
Ab){this.prediction=null;this.score=0;this.prediction=ya;this.score=Ab}}Object(k.a)(vj,"PredictionWithScore",null,[]);class Qj{constructor(ya,Ab){if(!ya)throw Error.argumentNull("predictions");if(!Ab)throw Error.argumentNull("attributes");this.Nqj=ya;this.k8i=Ab}h$e(){return this.Nqj}Xph(){return this.k8i}}Object(k.a)(Qj,"PredictionsWithTokenAttributes",null,[]);class Jg{constructor(ya,Ab,Vb){if(!ya)throw Error.argumentNull("attributeName");if(!Ab)throw Error.argumentNull("fieldNames");if(!Vb)throw Error.argumentNull("values");
if(Ab.length!==Vb.length)throw Error.argument("values","fieldNames and values do not have same length");this.j8i=ya;this.LBb=Ab;this.CMc=Vb}get attributeName(){return this.j8i}get Qkh(){return this.LBb.length}w7e(ya){return 0<=ya&&ya<this.LBb.length?this.LBb[ya]:null}getValue(ya){return 0<=ya&&ya<this.CMc.length?this.CMc[ya]:null}}Object(k.a)(Jg,"TokenAttributes",null,[]);var Mi=b(41),rf=b(632);class ld{constructor(ya,Ab,Vb,oc,Wc){this.h0c=0;this.n3f=null;this.i0c=this.Udc=0;this.V8d=this.vJb=this.dma=
this.Vdc=null;this.o3f=0;this.nte=this.Dz=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.xP=ya;this.s_i=this.w_i=Ab;this.r_i=this.u_i=Vb;this.f0c=this.t_i=oc;this.g0c=this.v_i=Wc}x_i(){this.i0c=0;return this.l3f}l3f(){if(!(this.i0c<this.f0c))return this.m3f;this.Vdc=this.s_i.items[this.i0c+this.r_i];this.dma=new E.a(this.xP.Ka.le);1!==this.f0c&&this.xP.Ka.wIc||this.dma.VTa(this.Vdc);if(0<=this.xP.Ka.iPd){({value:this.vJb}=
this.dma.Ro(this.xP.Ka.iPd)).returnValue?this.vJb=this.vJb.TQ():this.vJb=new Ua.a(this.xP.Ka.le,L.Annotations.IS);this.V8d=this.g0c.items;this.o3f=this.V8d.length;for(this.h0c=0;this.h0c<this.o3f;++this.h0c)this.n3f=this.V8d[this.h0c],Array.add(this.vJb.items,this.n3f);this.dma.Dw(this.xP.Ka.iPd,this.vJb)}else 0<=this.xP.Ka.cUf?this.dma.Dw(this.xP.Ka.cUf,this.g0c.items[0]):0<=this.xP.Ka.FMe?this.dma.Dw(this.xP.Ka.FMe,!0):this.xP.Ka.SUh?this.g0c.items[0].yxd((ya,Ab)=>this.dma.Dw(ya,Ab)):(this.dma.VTa(this.g0c.items[0]),
1!==this.f0c&&this.xP.Ka.wIc||(({value:this.Udc}=this.Vdc.Ro(this.xP.Ka.y_)).returnValue&&this.dma.Dw(this.xP.Ka.y_,this.Udc),({value:this.Udc}=this.Vdc.Ro(this.xP.Ka.o3)).returnValue&&this.dma.Dw(this.xP.Ka.o3,this.Udc),this.Vdc.Ro(this.xP.Ka.k8a).returnValue&&this.dma.Dw(this.xP.Ka.k8a,this.Udc)));this.Dz=this.dma;this._state=2;return this.z_i}m3f(){this._state=3}y_i(){this.i0c++;return this.l3f}z_i(){return 1<this.f0c&&this.xP.Ka.wIc?this.m3f:this.y_i}dispose(){}getEnumerator(){return-1===this._state?
(this._state=0,this):(new ld(this.xP,this.w_i,this.u_i,this.t_i,this.v_i)).getEnumerator()}[Symbol.iterator](){return Object(rf.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.nte=this.x_i());for(;1===this._state;)this.nte=this.nte();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.Dz}}Object(k.a)(ld,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[14,74,114]);class lg{constructor(ya,Ab,Vb){this.zMc=this.a3h=0;this.d5b=null;this.Xqf=this.Gqf=this.b5b=this.GNd=this.Jqf=0;this.HNd=!1;this.Sqf=ya;this.Zqf=Ab;this.J9l=Vb}Dyh(){null===this.d5b&&({YNi:this.d5b,fLh:this.Jqf,length:this.GNd,AFk:ya}=this.Sqf.TEh(this.Zqf.items[this.zMc],this.J9l),this.HNd=ya||this.HNd);if(this.b5b<this.GNd){var ya=this.d5b.charAt(this.Jqf+this.b5b);++this.b5b;return{returnValue:!0,ch:ya}}if(this.zMc===this.Zqf.items.length-1)return{returnValue:!1,ch:"\x00"};++this.zMc;
this.b5b=0;this.d5b=null;return{returnValue:!0,ch:" "}}uJf(ya,Ab){this.b5b===this.GNd&&this.d5b&&(this.Xqf=Ab,this.Gqf=this.zMc-this.a3h+1)}u2m(ya){if(0>ya||ya>=this.Zqf.items.length)throw Error.argumentOutOfRange("iToken");this.zMc=this.a3h=ya;this.d5b=null;this.Gqf=this.b5b=this.GNd=this.Jqf=0;this.Xqf=-1;this.HNd=!1}w6k(){return{sZj:this.Gqf,xWl:this.Xqf,zFk:this.HNd}}}Object(k.a)(lg,"TriePrefixVisitor",null,[1192]);class Cj{constructor(ya){this.Ka=ya}execute(ya){if(!({value:Vb}=ya.Ro(this.Ka.eHa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Ab;({value:Ab}=ya.Ro(this.Ka.eTa)).returnValue||(Ab=null);var Vb=this.OQk(Vb,Ab);ya=L.Annotations.TQ(ya);ya.Dw(this.Ka.eHa,Vb);return ya}OQk(ya,Ab){let Vb=null;const oc=this.Ka.flatLexicon.trie,Wc=new lg(this,ya,Ab);let cd=null;this.Ka.flatLexicon.Jhf()&&(cd=Object(Mi.a)(this.Ka.flatLexicon,this.Ka.flatLexicon.$Tk,"getCaseInsensitiveForm"));let yd=0,sc;var Xd;let Sd;for(;yd<ya.items.length;){const wf=ya.items[yd];Wc.u2m(yd);oc.vYi(Wc,cd);({sZj:sc,xWl:Xd,zFk:Sd}=Wc.w6k());if(0<sc){({MYl:Xd}=this.Ka.flatLexicon.FRk(Xd));
for(let Xi of this.Ujk(ya,yd,sc,Xd)){1<sc&&this.Ka.wIc&&this.Jkk(ya,Ab,yd,wf,sc,Sd,Xi);if(!Vb)for(Vb=new Ua.a(this.Ka.le,L.Annotations.IS),Xd=0;Xd<yd;++Xd)Array.add(Vb.items,ya.items[Xd]);Array.add(Vb.items,Xi)}yd+=sc}else Vb&&Array.add(Vb.items,wf),++yd}return Vb||ya}Jkk(ya,Ab,Vb,oc,Wc,cd,yd){if(cd)cd=!0;else if(this.Ka.yUh){cd=!1;var sc=-1;for(var Xd=0;Xd<Wc;Xd++){var Sd=ya.items[Vb+Xd];let ph;var wf=void 0;if(!({value:ph}=Sd.Ro(this.Ka.y_)).returnValue||!({value:wf}=Sd.Ro(this.Ka.o3)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Xd){if(ph>sc+1){cd=!0;break}if(0>sc||null===Ab||sc>=Ab.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Ab.charAt(sc)){cd=!0;break}}sc=ph+wf}}else cd=!1;if(cd){wf=new Sys.StringBuilder;for(cd=0;cd<Wc;++cd)({YNi:sc,fLh:Xd,length:Sd}=this.TEh(ya.items[Vb+cd],Ab)),0<cd&&wf.append(" "),wf.append(sc.substr(Xd,Sd));yd.Dw(this.Ka.k8a,wf.toString())}ya=ya.items[Vb+Wc-1];let Xi,Ak;({value:oc}=oc.Ro(this.Ka.y_)).returnValue&&
({value:Xi}=ya.Ro(this.Ka.y_)).returnValue&&({value:Ak}=ya.Ro(this.Ka.o3)).returnValue?(yd.Dw(this.Ka.y_,oc),yd.Dw(this.Ka.o3,Xi+Ak-oc)):(yd.sMa(this.Ka.y_),yd.sMa(this.Ka.o3))}Ujk(ya,Ab,Vb,oc){return new ld(this,ya,Ab,Vb,oc)}TEh(ya,Ab){let Vb,oc;if(({value:Vb}=ya.Ro(this.Ka.k8a)).returnValue)oc=!0,Ab=0,ya=Vb.length;else{oc=!1;if(null===Ab)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");Vb=Ab;if(!({value:Ab}=ya.Ro(this.Ka.y_)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:ya}=ya.Ro(this.Ka.o3)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Ab||0>ya||Ab+ya>Vb.length)throw Error.argument("Token start/length values out of range","token");}return{YNi:Vb,fLh:Ab,length:ya,AFk:oc}}}Object(k.a)(Cj,"FlatLexiconNLModule",null,[1174]);class Bm{constructor(ya,Ab){this.FMe=this.iPd=this.cUf=this.k8a=this.o3=this.y_=this.eTa=this.eHa=0;this.SUh=this.yUh=this.wIc=!1;this.flatLexicon=null;this.le=Ab.le;let Vb=0;
try{this.eHa=ya.J(Vb),++Vb,this.eTa=ya.J(Vb),++Vb,this.y_=ya.J(Vb),++Vb,this.o3=ya.J(Vb),++Vb,this.k8a=ya.J(Vb),++Vb,this.cUf=ya.J(Vb),++Vb,this.iPd=ya.J(Vb),++Vb,this.FMe=ya.J(Vb),++Vb,this.wIc=1===ya.J(Vb),++Vb,this.yUh=1===ya.J(Vb),++Vb,this.SUh=1===ya.J(Vb),++Vb,this.flatLexicon=Ab.Gcl(ya.J(Vb))}catch(oc){throw Error.argument("initData");}}}Object(k.a)(Bm,"FlatLexiconNLModuleInit",null,[]);class bi{constructor(){this.HGc=0;this.Q1e=null;this.rUc=0}}Object(k.a)(bi,"FeatureGenStackRec",null,[]);
class ml{constructor(ya){this.AYf=Array(ya);this.kcc=Array(ya);this.CVf=[];this.FLi=[]}}Object(k.a)(ml,"TokenStringLattice",null,[]);const fg=(ya,Ab,Vb)=>{for(let oc=0;oc<ya.length;oc++)Vb=Ab(Vb,ya[oc]);return Vb},Ej=(ya,Ab)=>{const Vb=Array(ya.length);for(let oc=0;oc<ya.length;oc++)Vb[oc]=Ab(ya[oc]);return Vb},ui=(ya,Ab)=>{Ab=Array(Math.min(Ab,ya.length));for(let Vb=0;Vb<Ab.length;Vb++)Ab[Vb]=ya[Vb];return Ab},Xl=(ya,Ab)=>{const Vb=[];for(const oc of ya)Ab(oc)&&Array.add(Vb,oc);return Vb};class qf{constructor(ya,
Ab){this.key=ya;this.value=Ab}}Object(k.a)(qf,"KeyValuePair",null,[]);const yk=(ya,Ab)=>({returnValue:Ab in ya,value:ya[Ab]}),Qh=ya=>{const Ab=[];for(let Vb in ya){const oc=new qf(Vb,ya[Vb]);Array.add(Ab,oc)}return Ab};class rk{constructor(ya){this.SEh=this.pjl;this.Ka=ya;this.JNd=this.Pqf=this.Qqf=0;for(const Ab of this.Ka.nwd)this.Qqf=Math.max(this.Qqf,Ab.sEf),this.Pqf=Math.max(this.Pqf,Ab.nEf),this.JNd=Math.max(this.JNd,Ab.Jhb.length)}get BHk(){return this.Ka.C5d.trie}execute(ya){if(!ya)throw Error.argumentNull("input");
let Ab,Vb;({B$:Ab,xXl:Vb}=this.qjl(ya));let oc=null,Wc=null,cd={};if(this.Ka.ZIc){Ab=L.Annotations.TQ(Ab);for(var yd=0;yd<Ab.items.length;++yd)Ab.items[yd]=L.Annotations.TQ(Ab.items[yd])}else({Bkh:Wc,returnValue:oc}=this.tzh(ya,cd));yd=Array(this.JNd);const sc=Array(this.JNd);for(var Xd=0;Xd<sc.length;++Xd)sc[Xd]=new bi;for(Xd=-this.Qqf;Xd<Ab.items.length+this.Pqf;++Xd){let Sd=null;this.Ka.ZIc&&(Sd=Ab.items[Xd],cd={},{Bkh:Wc,returnValue:oc}=this.tzh(Sd,cd));for(const wf of this.Ka.nwd){if(0>Xd&&-Xd>
wf.sEf||Xd>=Ab.items.length&&Xd-Ab.items.length+1>wf.nEf)continue;let Xi=!0;for(let Ak=0;Ak<wf.Jhb.length;++Ak){const ph=Xd+wf.Jhb[Ak];yd[Ak]=ph;if(0>ph?0>this.Ka.tEf:ph>=Ab.items.length?0>this.Ka.oEf:!Vb.kcc[ph]){Xi=!1;break}}Xi&&({Wnk:oc,Xnk:Wc}=this.xEl(wf,Vb,oc,Wc,cd,sc,yd))}this.Ka.ZIc&&(Sd.Dw(this.Ka.CXa?this.Ka.mUb:this.Ka.kUb,oc),this.Ka.CXa&&Sd.Dw(this.Ka.lUb,Wc))}ya=L.Annotations.TQ(ya);this.Ka.ZIc?ya.Dw(this.Ka.eHa,Ab):(ya.Dw(this.Ka.CXa?this.Ka.mUb:this.Ka.kUb,oc),this.Ka.CXa&&ya.Dw(this.Ka.lUb,
Wc));return ya}qjl(ya){let Ab,Vb;if(!ya||!({value:Ab}=ya.Ro(this.Ka.eHa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let oc;({value:oc}=ya.Ro(this.Ka.eTa)).returnValue||(oc="");Vb=new ml(Ab.items.length);const Wc=Xl(this.Ka.CYf,cd=>!cd.DHc||cd.DHc.isMatch(ya,null));for(let cd=0;cd<Ab.items.length;++cd){const yd=Ab.items[cd];let sc=null;Vb.AYf[cd]=Vb.CVf.length;let Xd=Vb.kcc[cd]=0;for(const Sd of Wc)0<Sd.MMc&&Vb.kcc[cd]+Xd>=Sd.MMc||Sd.zYc&&!Sd.zYc.isMatch(yd,
null)||({AYc:sc,yvc:Xd}=Sd.apply(this,yd,cd,Vb,oc,sc,Xd))}return{B$:Ab,xXl:Vb}}xEl(ya,Ab,Vb,oc,Wc,cd,yd){let sc=0;cd[0].HGc=-1;for(cd[0].Q1e=ya.Vvi;;){var Xd=yd[sc],Sd=0>Xd||Xd>=Ab.kcc.length?1:Ab.kcc[Xd];let Ak=!1;for(;cd[sc].HGc<Sd-1;){++cd[sc].HGc;var wf=void 0,Xi=void 0;0>Xd?(wf=this.Ka.tEf,Xi=1):Xd>=Ab.AYf.length?(wf=this.Ka.oEf,Xi=1):(Xi=Ab.AYf[Xd]+cd[sc].HGc,wf=Ab.CVf[Xi],Xi=Ab.FLi[Xi]);cd[sc].rUc=Xi*(sc?cd[sc-1].rUc:ya.score);if(({value:wf}=yk(cd[sc].Q1e,wf.toString())).returnValue){sc===
ya.Jhb.length-1?(Xd=wf,cd[sc].rUc&&(({value:Sd}=yk(Wc,Xd.toString())).returnValue||(Sd=-1),0>Sd&&(Vb=L.Annotations.TQ(Vb),Array.add(Vb.items,Xd)),this.Ka.CXa&&(oc=L.Annotations.TQ(oc),0>Sd?Array.add(oc.items,cd[sc].rUc):oc.items[Sd]+=cd[sc].rUc),0>Sd&&(this.Ka.TXh||this.Ka.CXa)&&(Wc[Xd.toString()]=Vb.items.length-1))):(++sc,cd[sc].HGc=-1,cd[sc].Q1e=wf);Ak=!0;break}}if(!Ak&&(--sc,0>sc))break}return{Wnk:Vb,Xnk:oc}}tzh(ya,Ab){let Vb;if(({value:Vb}=ya.Ro(this.Ka.CXa?this.Ka.mUb:this.Ka.kUb)).returnValue)for(let oc=
0;oc<Vb.items.length;++oc)Ab[Vb.items[oc].toString()]=oc;else Vb=new Ua.a(this.Ka.le,L.Annotations.OCa);if(this.Ka.CXa){if(({value:Ab}=ya.Ro(this.Ka.lUb)).returnValue||(Ab=new Ua.a(this.Ka.le,L.Annotations.Rla)),Ab.items.length!==Vb.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ka.le.I$(L.Annotations.IS,ya));}else Ab=null;return{returnValue:Vb,Bkh:Ab}}get CEn(){return this.Ka.C5d}pjl(ya,Ab){var Vb;if(({value:Vb}=
Ab.Ro(this.Ka.k8a)).returnValue)ya=Vb;else{if(!({value:Vb}=Ab.Ro(this.Ka.y_)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Ab}=Ab.Ro(this.Ka.o3)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>Vb||0>Ab||Vb+Ab>ya.length)throw Error.argument("Token indices are out of range");ya=ya.substr(Vb,Ab)}return ya}}Object(k.a)(rk,"NGramNLModule",null,[1174,1175]);class yf{constructor(ya){this.Jhb=null;this.score=this.nEf=this.sEf=0;this.Vvi=null;if(ya){var Ab=
0;try{if(ya.J(Ab)!==yf.Osb)throw Error.argument("initData","Input does not represent a feature template");++Ab;const Vb=ya.J(Ab);++Ab;this.Jhb=Array(Vb);for(let oc=0;oc<Vb;++oc)this.Jhb[oc]=ya.J(Ab),++Ab;this.sEf=ya.J(Ab);++Ab;this.nEf=ya.J(Ab);++Ab;this.score=ya.J(Ab);++Ab;this.Vvi=({$Kh:Ab}=yf.Zmi(ya,Ab)).returnValue}catch(Vb){throw Error.argument("initData");}}}static Zmi(ya,Ab){const Vb=ya.J(Ab);++Ab;const oc={};for(let Wc=0;Wc<Vb;++Wc){const cd=ya.J(Ab);++Ab;ya.J(Ab)?oc[cd.toString()]=({$Kh:Ab}=
yf.Zmi(ya,Ab)).returnValue:(++Ab,oc[cd.toString()]=ya.J(Ab),++Ab)}return{returnValue:oc,$Kh:Ab}}}yf.Osb=240803228;Object(k.a)(yf,"FeatureTemplate",null,[1190]);var Cl=b(1405);class bn{constructor(ya,Ab){this.CXa=this.TXh=this.ZIc=!1;this.k8a=this.o3=this.y_=this.eHa=this.eTa=this.lUb=this.mUb=this.kUb=0;this.C5d=null;this.oEf=this.tEf=0;this.nwd=this.CYf=null;if(ya){this.le=Ab.le;var Vb=0;try{this.ZIc=1===ya.J(Vb);++Vb;this.TXh=1===ya.J(Vb);++Vb;this.CXa=1===ya.J(Vb);++Vb;this.kUb=ya.J(Vb);++Vb;this.mUb=
ya.J(Vb);++Vb;this.lUb=ya.J(Vb);++Vb;this.eTa=ya.J(Vb);++Vb;this.eHa=ya.J(Vb);++Vb;this.y_=ya.J(Vb);++Vb;this.o3=ya.J(Vb);++Vb;this.k8a=ya.J(Vb);++Vb;this.C5d=this.vzm(Ab.nab(ya.J(Vb)));++Vb;this.tEf=ya.J(Vb);++Vb;this.oEf=ya.J(Vb);++Vb;const oc=ya.J(Vb);++Vb;this.CYf=Array(oc);for(let cd=0;cd<oc;++cd){const yd=ya.J(Vb);++Vb;const sc=this.C5d.trie,Xd=new pb.a;Xd.aab(ya,Vb,yd);this.CYf[cd]=this.yzm(Xd,Ab,sc);Vb+=yd}const Wc=ya.J(Vb);++Vb;this.nwd=Array(Wc);for(Ab=0;Ab<Wc;++Ab){const cd=ya.J(Vb);++Vb;
const yd=new pb.a;yd.aab(ya,Vb,cd);this.nwd[Ab]=this.bzm(yd);Vb+=cd}}catch(oc){throw Error.argument("initData");}}}vzm(ya){return new we.a(new Te.a(ya))}yzm(ya,Ab,Vb){return Cl.a.create(ya,Ab,Vb)}bzm(ya){return new yf(ya)}}Object(k.a)(bn,"NGramNLModuleInit",null,[]);class Yl{constructor(ya){this.Ka=ya}execute(ya){if(!ya)throw Error.argumentNull("input");ya=ya.clone();this.Ka.script.execute(ya,null);return ya}}Object(k.a)(Yl,"ScriptNLModule",null,[1174]);class rj{constructor(ya,Ab){ya&&(this.script=
Ab.ywb(ya.J(0)))}}Object(k.a)(rj,"ScriptNLModuleInit",null,[]);const Ci=ya=>{ya=Ej(ya,Ab=>Ab*Ab);return Math.sqrt(fg(ya,(Ab,Vb)=>Ab+Vb,0))},wj=ya=>fg(ya,(Ab,Vb)=>Ab>Vb?Ab:Vb,ya[0]);class Fj{constructor(ya){this.Ka=ya}execute(ya){if(!ya)throw Error.argumentNull("input");var Ab=[],Vb=[];this.l9j(ya,Ab,Vb);this.sKj(Ab,Vb);const oc={};for(let cd=0;cd<Ab.length;++cd){var Wc=Ab[cd];const yd=this.Ka.vOh.J(Wc);Wc=this.Ka.wOh.J(Wc);for(let sc=0;sc<Wc;++sc){const Xd=this.Ka.z3.J(this.Ka.O1g.J(yd+sc)),Sd=this.Ka.P1g.J(yd+
sc);let wf;({value:wf}=yk(oc,Xd)).returnValue||(wf=0);oc[Xd]=wf+Vb[cd]*Sd}}Vb=Qh(oc);Vb.sort((cd,yd)=>{var sc=cd.value,Xd=yd.value;(sc=-(sc>Xd?1:sc<Xd?-1:0))||(sc=cd.key.localeCompare(yd.key));return sc});Ab=new Ua.a(this.Ka.le,L.Annotations.IS);for(const cd of ui(Vb,this.Ka.$am))Vb=new E.a(this.Ka.le),Vb.Dw(this.Ka.sRj,cd.key),Vb.Dw(this.Ka.uRj,cd.value),Array.add(Ab.items,Vb);ya.Dw(this.Ka.tRj,Ab);return ya}l9j(ya,Ab,Vb){if(({value:ya}=ya.Ro(this.Ka.rRj)).returnValue){let oc;if(({value:oc}=ya.Ro(this.Ka.mUb)).returnValue){let Wc;
if(!({value:Wc}=ya.Ro(this.Ka.lUb)).returnValue||oc.items.length!==Wc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.Xpd(oc,Wc,Ab,Vb)}if(({value:oc}=ya.Ro(this.Ka.wRj)).returnValue){let Wc;if(!({value:Wc}=ya.Ro(this.Ka.xRj)).returnValue||oc.items.length!==Wc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.Xpd(oc,Wc,Ab,Vb)}({value:oc}=ya.Ro(this.Ka.kUb)).returnValue&&
this.Xpd(oc,null,Ab,Vb);({value:oc}=ya.Ro(this.Ka.vRj)).returnValue&&this.Xpd(oc,null,Ab,Vb)}}Xpd(ya,Ab,Vb,oc){for(let cd=0;cd<ya.items.length;++cd){var Wc=void 0;ya.R0===L.Annotations.M5?({value:Wc}=yk(this.Ka.dgh,ya.items[cd])).returnValue||(Wc=-1):(Wc=ya.items[cd],Wc=Wc>=this.Ka.usf&&Wc<=this.Ka.Ebm?this.Ka.ewf?this.Ka.ewf.J(Wc-this.Ka.usf)-1:Wc-this.Ka.usf:-1);if(0<=Wc){let yd;yd=Ab?Ab.items[cd]:1;0<yd&&(Array.add(Vb,Wc),Array.add(oc,yd))}}}sKj(ya,Ab){if(ya.length){switch(this.Ka.MIm){case 0:break;
case 1:for(var Vb=0;Vb<Ab.length;++Vb)Ab[Vb]=1+Math.log(Ab[Vb]);break;case 2:Vb=wj(Ab);for(let oc=0;oc<Ab.length;++oc)Ab[oc]=.5+Ab[oc]/Vb*.5;break;case 3:for(Vb=0;Vb<Ab.length;++Vb)Ab[Vb]=1;break;default:throw Error.notImplemented();}if(this.Ka.cHd)for(Vb=0;Vb<Ab.length;++Vb)Ab[Vb]*=this.Ka.cHd.J(ya[Vb]);ya=Ci(Ab);for(Vb=0;Vb<Ab.length;++Vb)Ab[Vb]/=ya}}}Object(k.a)(Fj,"TfIdfRankerNLModule",null,[1174]);class sk{constructor(ya,Ab=0){if(!ya)throw Error.argumentNull("byteArray");this.KNd=Ab;if(604662927!==
ya.Cw(this.KNd+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Mh=ya.Cw(this.KNd+4,4);this.K2h=ya.Cw(this.KNd+8,4);this.x9l=ya}J(ya){if(0>ya||ya>=this.count)throw Error.argumentOutOfRange("index");return this.x9l.hNm(8*this.KNd+96+ya*this.K2h,this.K2h)}get count(){return this.Mh}}Object(k.a)(sk,"CompactIntArray",null,[1173]);const xn=(ya,Ab)=>{Ab=Array(Ab);for(let cd=0;cd<Ab.length;cd++){var Vb=cd,oc=ya.Y4(),Wc=1===(oc>>31&1)?-1:1;const yd=oc&8388607;oc=
oc>>23&255;256===oc+1?Wc=yd?Number.NaN:1===Wc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:oc?(oc-=127,Wc=Wc*yn(yd,1)*Math.pow(2,oc)):Wc=Wc*yn(yd,0)*Math.pow(2,-126);Ab[Vb]=Wc}return Ab},yn=(ya,Ab)=>{let Vb=0;for(let oc=0;23>oc;oc++)Vb+=(ya>>22-oc&1)/Math.pow(2,oc+1);return Ab+Vb};class yh{constructor(ya,Ab){this.ewf=null;this.N8h=0;this.wOh=this.vOh=this.cHd=null;this.M8h=0;this.P1g=this.O1g=null;this.le=Ab.le;let Vb=0;this.vRj=ya.J(Vb);++Vb;this.kUb=ya.J(Vb);++Vb;this.wRj=ya.J(Vb);++Vb;this.xRj=
ya.J(Vb);++Vb;this.mUb=ya.J(Vb);++Vb;this.lUb=ya.J(Vb);++Vb;this.rRj=ya.J(Vb);++Vb;this.tRj=ya.J(Vb);++Vb;this.sRj=ya.J(Vb);++Vb;this.uRj=ya.J(Vb);++Vb;var oc=ya.J(Vb);++Vb;var Wc=Array(oc);for(var cd=0;cd<oc;++cd)Wc[cd]=Ab.getString(ya.J(Vb)),++Vb;this.z3=pb.a.DUe(Wc);this.$am=ya.J(Vb);++Vb;this.MIm=ya.J(Vb);++Vb;oc=ya.J(Vb);++Vb;this.dgh={};for(Wc=0;Wc<oc;++Wc){cd=Ab.getString(ya.J(Vb));++Vb;const yd=ya.J(Vb);++Vb;this.dgh[cd]=yd}this.usf=ya.J(Vb);++Vb;this.Ebm=ya.J(Vb);++Vb;oc=ya.J(Vb);++Vb;0<
oc&&(oc=Ab.nab(ya.J(Vb)),++Vb,this.ewf=this.LTd(new Ki(oc)));++Vb;ya=Ab.nab(ya.J(Vb));this.izm(ya)}LTd(ya){return new sk(ya.Kuc,ya.offset)}izm(ya){try{const Ab=new Ki(ya);this.N8h=Ab.Y4();1===Ab.Y4()?this.cHd=pb.a.DUe(xn(Ab,this.N8h)):this.cHd=null;const Vb=Ab.Y4();this.vOh=this.LTd(Ab);Ab.offset+=Vb;const oc=Ab.Y4();this.wOh=this.LTd(Ab);Ab.offset+=oc;this.M8h=Ab.Y4();const Wc=Ab.Y4();this.O1g=this.LTd(Ab);Ab.offset+=Wc;this.P1g=pb.a.DUe(xn(Ab,this.M8h))}catch(Ab){throw Error.argument("byteReader");
}}}Object(k.a)(yh,"TfIdfRankerNLModuleInit",null,[]);class Sm{constructor(ya,Ab,Vb,oc){this.HCf=ya;this.tmh=Vb;this.B$=oc;this.Qha=Ab;this.m$b=-1;this.z_d=0}}Object(k.a)(Sm,"TokenizerData",null,[]);class vi{constructor(ya){this.Ka=ya}execute(ya){if(!ya)throw Error.argumentNull("input");if(!({value:oc}=ya.Ro(this.Ka.eTa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Ab;({value:Ab}=ya.Ro(this.Ka.y_)).returnValue||(Ab=0);let Vb;({value:Vb}=
ya.Ro(this.Ka.o3)).returnValue||(Vb=oc.length-Ab);if(0>Ab||Ab>oc.length)throw Error.argument("input","Start index out of range");if(0>Vb||Vb>oc.length)throw Error.argument("input","Length out of range");if(Ab+Vb>oc.length)throw Error.argument("input","Bad start-length range");var oc=new Sm(oc,Ab,Ab+Vb,new Ua.a(this.Ka.le,L.Annotations.IS));this.DEn(oc);ya=ya.isReadOnly?ya.clone():ya;ya.Dw(this.Ka.eHa,oc.B$);return ya}DEn(ya){for(;ya.Qha<ya.tmh;){if(this.Ka.acf){var Ab=this.Ka.acf.o2h(ya.HCf,ya.Qha,
ya.tmh-ya.Qha,null);!Ab.succeeded&&Ab.M7h&&(Ab=Ab.M7h);if(Ab.succeeded){this.Bbi(ya,Ab.length,this.Ka.$Gh);ya.Qha+=Ab.length;continue}}Ab=ya.HCf.substr(ya.Qha);let Vb=-1,oc=-1,Wc=-1;for(let cd=0;cd<this.Ka.EZd.length;++cd){const yd=this.Ka.EZd[cd].exec(Ab);yd&&0<yd[1].length&&(0>Vb||yd[0].length>oc)&&(Vb=cd,oc=yd[0].length,Wc=yd[1].length)}0<=Vb?(this.Bbi(ya,Wc,this.Ka.pNf[Vb]),ya.Qha+=Wc):ya.Qha+=1}}Bbi(ya,Ab,Vb){if(this.Ka.vWh)Vb!==vi.BZj&&(0>ya.m$b&&(ya.m$b=ya.Qha),ya.z_d=ya.Qha+Ab-ya.m$b,Vb===
vi.AZj&&(0<=ya.m$b&&0<ya.z_d&&(Ab=new E.a(this.Ka.le),Ab.Dw(this.Ka.y_,ya.m$b),Ab.Dw(this.Ka.o3,ya.z_d),Ab.Dw(this.Ka.wLe,vi.CZj),Ab.Dw(this.Ka.eTa,ya.HCf),Array.add(ya.B$.items,Ab)),ya.m$b=-1,ya.z_d=0));else{let oc=new E.a(this.Ka.le);oc.Dw(this.Ka.y_,ya.Qha);oc.Dw(this.Ka.o3,Ab);oc.Dw(this.Ka.wLe,Vb);Array.add(ya.B$.items,oc)}}}vi.BZj="GAP";vi.AZj="EOS_CHUNK";vi.CZj="SENTENCE";Object(k.a)(vi,"TokenizerNLModule",null,[1174]);class aj{constructor(ya,Ab){this.o3=this.y_=this.wLe=this.eHa=this.eTa=
0;this.vWh=!1;this.pNf=this.EZd=this.$Gh=this.acf=null;if(ya){this.le=Ab.le;var Vb=0;try{this.eTa=ya.J(Vb);++Vb;this.eHa=ya.J(Vb);++Vb;this.wLe=ya.J(Vb);++Vb;this.y_=ya.J(Vb);++Vb;this.o3=ya.J(Vb);++Vb;this.vWh=1===ya.J(Vb);++Vb;var oc=ya.J(Vb);++Vb;0<oc&&(this.acf=Ab.f9e(oc).BHk);this.$Gh=ya.J(Vb)?Ab.getString(ya.J(Vb)):"";++Vb;const Wc=ya.J(Vb);++Vb;this.EZd=Array(Wc);this.pNf=Array(Wc);for(oc=0;oc<Wc;++oc)this.EZd[oc]=new RegExp(Ab.getString(ya.J(Vb))),++Vb,this.pNf[oc]=Ab.getString(ya.J(Vb)),
++Vb}catch(Wc){throw Error.argument("initData");}}}}Object(k.a)(aj,"TokenizerNLModuleInit",null,[]);class bg{constructor(ya){this.Ka=ya}execute(ya){if(!ya)throw Error.argumentNull("input");let Ab;if(!({value:Ab}=ya.Ro(this.Ka.$Ug)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const Vb of this.Ka.QUf)Ab=Vb.apply(Ab);ya=L.Annotations.TQ(ya);ya.Dw(this.Ka.aVg,Ab);return ya}static KKe(ya,Ab){const Vb=new Sys.StringBuilder;for(let oc=0;oc<ya.length;++oc)Vb.append(Ab(ya.substr(oc,
1)));return Vb.toString()}}Object(k.a)(bg,"TransliteratorNLModule",null,[1174]);class zh{constructor(ya){ya&&(this.style=ya.J(0))}apply(ya){return bg.KKe(ya,Ab=>zh.P2j(Ab,this.style))}static P2j(ya,Ab){switch(Ab){case 0:return ya.toLowerCase();case 1:return"I"===ya?"\u0131":ya.toLowerCase();case 2:return ya.toUpperCase();case 3:return"i"===ya?"\u0130":ya.toUpperCase();default:throw Error.invalidOperation();}}}zh.Psb=0;Object(k.a)(zh,"ChangeCaseTransliterationStage",null,[1189]);class Gi{apply(ya){return bg.KKe(ya,
Gi.ZFn)}static ZFn(ya){const Ab=ya.charCodeAt(0);return 65281<=Ab&&65374>=Ab?String.fromCharCode(Ab-65248):ya}}Gi.Psb=4;Object(k.a)(Gi,"LatinFullWidthToHalfWidthTransliterationStage",null,[1189]);class gh{constructor(ya,Ab){ya&&(this.RIf=Ab.C_b(ya.J(0)),this.e0m=Ab.getString(ya.J(1)))}apply(ya){return ya.replace(this.RIf,this.e0m)}}gh.Psb=1;Object(k.a)(gh,"RegexReplaceTransliterationStage",null,[1189]);class Zi{constructor(ya,Ab){if(ya){var Vb=ya.J(0),oc=Ab.getString(ya.J(1)),Wc=new sk(Ab.nab(ya.J(2)));
ya=0>ya.J(3)?null:new sk(Ab.nab(ya.J(3)));this.TVf={};for(Ab=0;Ab<Vb;++Ab)this.TVf[oc.charAt(Ab).toString()]=oc.substr(Wc.J(Ab),ya?ya.J(Ab):1)}}apply(ya){return bg.KKe(ya,Ab=>Ab in this.TVf?this.TVf[Ab]:Ab)}}Zi.Psb=2;Object(k.a)(Zi,"SingleCharSubstitutionsTransliterationStage",null,[1189]);class sm{constructor(ya,Ab){this.aVg=this.$Ug=0;this.QUf=null;if(ya){this.le=Ab.le;var Vb=0;try{this.$Ug=ya.J(Vb);++Vb;this.aVg=ya.J(Vb);++Vb;const oc=ya.J(Vb);++Vb;this.QUf=Array(oc);for(let Wc=0;Wc<oc;++Wc){const cd=
ya.J(Vb);++Vb;const yd=ya.J(Vb);++Vb;const sc=new pb.a;sc.aab(ya,Vb,yd);Vb+=yd;this.QUf[Wc]=this.uzm(cd,sc,Ab)}}catch(oc){throw Error.argument("initData");}}}uzm(ya,Ab,Vb){switch(ya){case zh.Psb:return new zh(Ab);case gh.Psb:return new gh(Ab,Vb);case Zi.Psb:return new Zi(Ab,Vb);case Gi.Psb:return new Gi;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(k.a)(sm,"TransliteratorNLModuleInit",null,[]);class cf{P7k(ya,Ab){const Vb=ya.J(0),oc=new pb.a;
oc.aab(ya,1,ya.count-1);switch(Vb){case 0:return new Yl(new rj(oc,Ab));case 2:return new vi(new aj(oc,Ab));case 3:return new rk(new bn(oc,Ab));case 5:return new Cj(new Bm(oc,Ab));case 9:return new bg(new sm(oc,Ab));case 10:return new Fj(new yh(oc,Ab));default:throw Error.notImplemented();}}}Object(k.a)(cf,"NLModuleFactory",null,[1159]);class Pk{constructor(ya){this.yZj=";";if(!ya)throw Error.argumentNull("resource");this.nda=new oi(ya,new Db,new cf);this.Sqf=this.nda.w7k();this.J2h=this.nda.le.GCc("Text.Text");
this.H2h=this.nda.le.GCc("Classification.Predictions");this.Eqf=this.nda.le.GCc("Classification.PredictionString");this.I2h=this.nda.le.GCc("Classification.Probability");this.w9l=this.nda.le.GCc("NLMod.Tokens");if(0>this.J2h||0>this.H2h||0>this.Eqf||0>this.I2h)throw Error.argument("resourceObj","Resource does not represent a ranker");}JSk(){const ya=[];this.I0e(void 0,this.Gqh(ya),null);return ya}LSk(ya,Ab){const Vb=[],oc=[];this.I0e(ya,this.Gqh(Vb),(Wc,cd)=>{const yd=this.nda.le.uqh(Wc),sc=[],Xd=
[];Ab&&Ab.length&&-1===Array.indexOf(Ab,yd)||(Wc=this.nda.le.getAttributeType(Wc),this.nii(Wc,cd,sc,Xd),cd=new Jg(yd,sc,Xd),Array.add(oc,cd))});return new Qj(Vb,oc)}KSk(ya){const Ab=[];this.I0e(ya,Vb=>{let oc;if(({value:oc}=Vb.Ro(this.Eqf)).returnValue){let Wc;({value:Wc}=Vb.Ro(this.I2h)).returnValue&&Array.add(Ab,new vj(oc,Wc))}},null);return Ab}I0e(ya,Ab,Vb){var oc=new E.a(this.nda.le);oc.Dw(this.J2h,ya);ya=this.Sqf.execute(oc);if(({value:oc}=ya.Ro(this.H2h)).returnValue)for(const Wc of oc.items)Ab(Wc);
if(Vb&&({value:Ab}=ya.Ro(this.w9l)).returnValue)for(const Wc of Ab.items)Wc.yxd(Vb)}nii(ya,Ab,Vb,oc){if(L.Annotations.UF(ya))for(var Wc of Ab.items)this.nii(Ab.R0,Wc,Vb,oc);else if(L.Annotations.eSi(ya)){Wc=this.nda.le.$yh(ya);for(let cd=0;cd<Wc;cd++)Array.add(Vb,this.nda.le.nDh(ya,cd)),Array.add(oc,this.nda.le.I$(this.nda.le.Nxb(ya,cd),Ab.Bab(cd)))}else Array.add(Vb,"VALUE"),Array.add(oc,this.nda.le.I$(ya,Ab))}Gqh(ya){return Ab=>{let Vb;({value:Vb}=Ab.Ro(this.Eqf)).returnValue&&Array.add(ya,this.kbl(Vb))}}kbl(ya){const Ab=
ya.indexOf(this.yZj);return 0>Ab?ya:ya.substring(0,Ab)}}Object(k.a)(Pk,"Ranker",null,[]);var Id=b(1345),rd=b(1363),ge=b(1302),Me=b(1297),me=b(1296),nl=b(2);class zn{constructor(ya,Ab){this.qsg="";this.wxe=null;this.xxe=!1;this.jma=null;this.m8i=["TellMe.TellMeParamCollection"];this.wb=ya;this.$Qa=Ab;this.wb.$Sa&&(this.jma=this.wb.lyd())}get jWd(){if(!this.wxe&&!this.xxe){let ya=null;try{ya=window.TellMeModel}catch(Ab){if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("QueryRanker",
"TellMeModel not found. Exception: "+Ab)}if(ya){try{this.wxe=new Pk(ya)}catch(Ab){if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Ab)}this.xxe=!0}else if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("QueryRanker","Classifier model not found")}return this.wxe}sO(){return"Command"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:2}qK(ya,Ab,Vb=!1,oc=f.a.tellMe,Wc=null){const cd=new l.a(ya);if((!Wc||
Array.contains(Wc,0))&&!me.a.IX(ya)){if(!this.jWd&&this.xxe){if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.wb.$Sa&&this.jma&&this.jma.initialize();if(Id.CommandResultsUtility.Phf(ya.Ef)&&(Wc=Id.CommandResultsUtility.msh(ya.Ef),0<Wc.results.length)){Wc.displayName="Classifier Debug";cd.kw(Wc);Ab.resultsUpdated(cd);return}Wc=ya?this.qsg=ya.Ef:
this.qsg;if(nl.AFrameworkApplication.K.$("TellMeParameterizedQueriesEnabled")){Wc=this.mbl(Wc);var yd=this.Gyd(Wc.h$e());Wc=Wc.Xph()}else Wc=this.lbl(Wc),yd=this.sVk(Wc),Wc=[];Id.CommandResultsUtility.cNd(yd,!1,"Classifier","TFIDF");yd=Id.CommandResultsUtility.NBd(yd,this.wb,this.jma,this.$Qa,Wc,0,1);0<yd.results.length&&oc!==f.a.contextMenu&&(yd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Vb||yd.results.length||this.wb.EX||this.wb.m0a||(ya=new ge.a("lookupNoResults",14,ya.Ef,null,1),
yd.Xw(ya));0<yd.results.length&&cd.kw(yd);cd.attributes=Wc}Ab.resultsUpdated(cd)}h$e(){let ya=[];try{ya=this.jWd.JSk()}catch(Ab){if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("GetPredictions","Exception: "+Ab)}return ya}lbl(ya){let Ab=[];try{Ab=this.jWd.KSk(ya)}catch(Vb){if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("GetPredictionsWithScore","Exception: "+Vb)}return Ab}mbl(ya){try{return this.jWd.LSk(ya,this.m8i)}catch(Ab){if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("GetPredictionsWithTokenAttributes",
"Exception: "+Ab)}return new Qj([],[])}Gyd(ya){const Ab=[];if(ya)for(const Vb of ya)Ab.push(new rd.a(Vb,-99999));return Ab}sVk(ya){const Ab=[];if(ya)for(const Vb of ya)Ab.push(new rd.a(Vb.prediction,Vb.score));return Ab}}Object(k.a)(zn,"CommandResultsProvider",null,[1042]);var oe=b(1564);class th{constructor(ya){this.wb=ya}sO(){return"Feedback"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:2}qK(ya,Ab,Vb,oc,Wc=null){ya=new l.a(ya);if(!Wc||Array.contains(Wc,21))Wc=[],Wc.push(appChrome.actions.setControlLabel("TellMeFeedback",
CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(Wc),Wc=new m.a(22),Wc.displayName="",Wc.Xw(new ge.a("TellMeFeedback",23,null,null,1)),ya.kw(Wc);Ab.resultsUpdated(ya)}}Object(k.a)(th,"FeedbackResultsProvider",null,[1042]);class oj{constructor(ya,Ab,Vb,oc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=ya;this.CommandId=Ab;this.CommandValueId=Vb;this.InputText=oc}}Object(k.a)(oj,"FindInDocumentProp",null,[]);var nf=b(1374),Ni=b(16);class tg{constructor(ya){this.ise=
2;this.lob=[];this.B5a=[];this.wb=ya;tg.iya=ya.Y1e;tg.Llh="FindInDocumentSuggestion";tg.Bhi="FindInDocumentSuggestion3";this.Qqe=Object.assign(new nf.a,{landingTab:"Indoc",data:null});this.nuj=this.wb.xhb||!!nl.AFrameworkApplication.na&&nl.AFrameworkApplication.na.Ya.xhb}sO(){return"FindInDocument"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:3===this.wb.rw?this.wb.kJi?2:3:2}qK(ya,Ab,Vb=!1,oc,Wc=null){const cd=new l.a(ya);if(Wc&&!Array.contains(Wc,2))Ab.resultsUpdated(cd);else if(Array.clear(this.lob),
me.a.IX(ya)){if(Vb&&this.GGi()){Vb=new m.a(2);Vb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Wc=1;oc="";if(0<this.B5a.length&&!this.wb.iac)for(var yd of this.B5a)if(""!==yd.Label.toLowerCase()){if(Wc>=this.ise)break;this.LVi(Vb,yd.Label,yd.CommandValueId,tg.Llh+Wc,yd.InputText);Wc++}yd="";this.wb.GY?(cd.kw(Vb),Vb=new m.a(3),yd=this.wb.Euc?me.a.LCc(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):yd=CommonUIStrings.l_TellMeOpenFindPaneText;
oc=this.lsh("");this.LVi(Vb,yd,oc,tg.Bhi,"");cd.kw(Vb)}Ab.resultsUpdated(cd)}else yd="",Vb&&(Vb=this.lsh(ya.Ef),oc=[],this.wb.$Xa?(this.wb.Q1d&&oc.push(appChrome.actions.setControlIconSet(tg.iya,{"default":"FindInDocument_20"})),yd=this.wb.dmf?me.a.M7e(ya.Ef,CommonUIStrings.l_FindInDocumentScopedButtonText):ya.Ef+CommonUIStrings.l_FindInDocumentScopedButtonText):this.wb.GY?(yd=this.wb.Euc?me.a.LCc(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,ya.Ef)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,
ya.Ef),oc.push(appChrome.actions.setControlIconSet(tg.iya,{"default":"FindInDocument_20"}))):yd=this.wb.iac?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,ya.Ef),this.wb.uWa?(Me.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(tg.iya,yd)),Me.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(tg.iya,Vb))):(oc.push(appChrome.actions.setControlLabel(tg.iya,yd)),oc.push(appChrome.actions.setButtonCommandValueId(tg.iya,
Vb)),appChrome.api.dispatch(oc)),this.nCi(yd,tg.iya,Vb,ya.Ef)),this.wb.kJi?(yd=new ge.a(tg.iya,8,ya.Ef),Vb=new m.a(2),Vb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,Vb.Xw(yd),cd.kw(Vb),Ab.resultsUpdated(cd)):this.wb.Dzd(ya.Ef).then(sc=>{const Xd=new ge.a(tg.iya,8,ya.Ef,null,1);Xd.count=sc;sc=new m.a(2);sc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;sc.Xw(Xd);cd.kw(sc);Ab.resultsUpdated(cd)},sc=>{Me.TellMeActor.instance.Pd.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+sc);sc=new ge.a(tg.iya,8,ya.Ef,null,1);const Xd=new m.a(2);Xd.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Xd.Xw(sc);cd.kw(Xd);Ab.resultsUpdated(cd)})}GGi(){return!!this.wb&&this.wb.I1d}LVi(ya,Ab,Vb,oc,Wc=null){const cd=[];Ab&&cd.push(appChrome.actions.setControlLabel(oc,Ab));this.wb.GY&&cd.push(appChrome.actions.setControlIconSet(oc,{"default":"FindInDocument_20"}));cd.push(appChrome.actions.setButtonCommandValueId(oc,Vb));appChrome.api.dispatch(cd);
this.nCi(Ab,oc,Vb,"");ya.Xw(new ge.a(oc,8,Wc,null,1,-99999))}lsh(ya){return this.nuj?me.a.hUa(ya,15,this.Qqe):Ni.a.Wd(ya)}nCi(ya,Ab,Vb,oc){this.GGi()&&this.lob.length<this.ise&&(ya=new oj(ya,Ab,Vb,oc),Array.add(this.lob,ya))}mgn(ya){for(let Ab=0;Ab<this.lob.length;Ab++)if(this.lob[Ab].CommandId===ya){const Vb=this.lob[Ab].Label;let oc=!1;if(0<this.B5a.length){let Wc=0;for(const cd of this.B5a){if(cd.Label===Vb){Array.removeAt(this.B5a,Wc);oc=!0;break}Wc++}}!oc&&this.B5a.length>=this.ise-1&&Array.removeAt(this.B5a,
1);Array.insert(this.B5a,0,this.lob[Ab])}}}tg.iya=null;tg.Llh=null;tg.Bhi=null;Object(k.a)(tg,"FindInDocumentResultsProvider",null,[1042]);var Ih=b(1562);class Ri{constructor(ya){this.wb=ya}sO(){return"Insights"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:2}qK(ya,Ab,Vb=!1,oc,Wc=null){oc=new l.a(ya);if(!Wc||Array.contains(Wc,13))if(this.Qon()||!me.a.IX(ya)){Wc=new m.a(13);var cd=""===ya.Ef.trim(),yd=cd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",sc=new ge.a(yd,10,ya.Ef,null,1);Vb&&(Vb=
null,me.a.aAa()?cd?cd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(cd=this.wb.iac?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ya.Ef),Vb=me.a.hUa(ya.Ef,1)):(cd=String.format(CommonUIStrings.l_InsightsButtonText,ya.Ef),Vb=me.a.mub(ya.Ef)),this.wb.uWa?(Me.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(yd,cd)),Vb&&Me.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
Vb))):(ya=[],ya.push(appChrome.actions.setControlLabel(yd,cd)),Vb&&ya.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",Vb)),appChrome.api.dispatch(ya)),sc.label=cd);Wc.Xw(sc);oc.kw(Wc)}Ab.resultsUpdated(oc)}Qon(){return me.a.aAa()&&this.wb.XBn}}Object(k.a)(Ri,"InsightsResultsProvider",null,[1042]);var wi=b(1559);class Ne{constructor(ya){this.wb=ya}sO(){return"Learning"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:2}qK(ya,Ab,Vb,oc,Wc=null){Vb=new l.a(ya);Wc&&!Array.contains(Wc,
21)||!me.a.IX(ya)||(Wc=[],oc=this.wb.wYl,Wc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",oc)),oc=Ne.u1k(oc),Wc.push(appChrome.actions.setControlLabel("LearningForSearch",oc)),appChrome.api.dispatch(Wc),ya=new ge.a("LearningForSearch",22,ya.Ef,null,1),Wc=new m.a(21),Wc.Xw(ya),Vb.kw(Wc));Ab.resultsUpdated(Vb)}static u1k(ya){const Ab=[];Array.add(Ab,new wi.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Ab,new wi.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Ab,new wi.a(600,ya));Array.add(Ab,new wi.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));ya={};ya.parts=Ab;return JSON.stringify(ya)}}Object(k.a)(Ne,"LearningProvider",null,[1042]);var ke=b(440);class tm{constructor(ya,Ab){this.wOb=this.sSb=this.f6a=this.Vad=null;this.vv=!1;this.aPb=ya;this.nbj=Ab;ya&&this.akh(ya)}l6d(){this.aPb.l6d()&&this.akh(this.aPb)}qhl(ya){let Ab=[];var Vb=[];ya=tm.Ehm(ya);var oc="";Array.clear(Vb);for(let Wc=0;Wc<ya.length;Wc++){const cd=ya.charAt(Wc);-1!==
" ".indexOf(cd)?(oc.length&&Array.add(Vb,oc),oc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(cd)?(oc.length&&Array.add(Vb,oc),oc=cd,Array.add(Vb,oc),oc=""):oc+=cd}oc.length&&Array.add(Vb,oc);for(ya=0;ya<Vb.length;ya++)oc=this.rVk(Vb[ya]),oc=this.gek(oc),Ab=tm.Fcm(Ab,oc);return Ab=this.YEj(Ab)}qkf(){this.vv||this.l6d();return this.vv}Isd(ya){return this.Vad[ya.toString()]}YEj(ya){for(let Ab=0;Ab<ya.length;Ab++){const Vb=this.f6a[Ab];if(ya[Ab].commandId!==this.Isd(Vb[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let oc;(oc=ya[Ab]).score=oc.score+Vb[1]}return ya}gek(ya){const Ab=[];for(var Vb=0;Vb<this.f6a.length;Vb++)Ab.push(new rd.a(this.Isd(this.f6a[Vb][0]),-5));Vb=new ke.a;for(var oc=0;oc<ya.length;oc++)Vb.add(this.Isd(ya[oc][0]));for(oc=0;oc<Ab.length;oc++){const cd=Ab[oc];for(let yd=0;yd<ya.length;yd++){var Wc=ya[yd];const sc=this.Isd(Wc[0]);Wc=Wc[1];if(sc===cd.commandId){cd.score=Wc;Vb.remove(sc);break}}if(!Vb.count)break}return Ab}rVk(ya){const Ab=1>ya.length;for(let yd=0;2>=yd;yd++){const sc=this.wOb;
for(let Xd in sc){var Vb=sc[Xd],oc=ya,Wc=Xd;const Sd=Wc.length+1,wf=Array((oc.length+1)*Sd);for(var cd=0;cd<=oc.length;cd++)wf[cd*Sd]=cd;for(cd=0;cd<=Wc.length;cd++)wf[cd]=cd;for(cd=0;cd<Wc.length;cd++)for(let Xi=0;Xi<oc.length;Xi++)wf[(Xi+1)*Sd+(cd+1)]=oc.charAt(Xi)===Wc.charAt(cd)?wf[Xi*Sd+cd]:Math.min(Math.min(wf[Xi*Sd+(cd+1)]+1,wf[(Xi+1)*Sd+cd]+1),wf[Xi*Sd+cd]+1);oc=wf[oc.length*Sd+Wc.length];if((!oc||!Ab)&&oc<=yd)return Vb}}return this.sSb}akh(ya){this.Vad=ya.e9e();this.f6a=ya.Wbl();this.sSb=
ya.rkl();this.wOb=ya.J4k();if(this.vv=!!this.Vad&&!!this.f6a&&!!this.wOb&&!!this.sSb)this.vv=0<this.f6a.length&&tm.whf(this.f6a);this.vv&&(this.vv=0<this.sSb.length&&tm.whf(this.sSb));this.vv&&(this.wOb=tm.ell(this.wOb));this.vv||(this.wOb=this.sSb=this.f6a=this.Vad=null)}Cjl(ya){ya=this.qhl(ya);return this.pHk(ya,this.nbj)}pHk(ya,Ab){let Vb=[];for(let oc=0;oc<ya.length;oc++)ya[oc].score>=Ab&&Vb.push(ya[oc]);Vb.sort((oc,Wc)=>oc.score<Wc.score?1:oc.score>Wc.score?-1:0);0<Vb.length-10&&(Vb=Vb.slice(0,
10));return Vb}static Fcm(ya,Ab){if(!ya.length)return Ab;if(ya.length!==Ab.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let Vb=0;Vb<ya.length;Vb++){if(ya[Vb].commandId!==Ab[Vb].commandId)throw Error.create("Incorrect CommandId");let oc;(oc=ya[Vb]).score=oc.score+Ab[Vb].score}return ya}static Ehm(ya){return Ni.a.kg(ya)}static whf(ya){for(let Ab=0;Ab<ya.length;Ab++)if(2!==ya[Ab].length)return!1;return!0}static ell(ya){const Ab={};for(let Wc in ya){var Vb=
Wc,oc=ya[Wc];const cd=oc;cd.length&&tm.whf(cd)&&(Ab[Vb]=oc)}return Ab}}Object(k.a)(tm,"NaiveBayesClassifierModel",null,[]);class yg{constructor(ya,Ab){this.jma=null;this.wb=ya;this.qnc=new tm(Ab,ya.Q7k);this.wb.$Sa&&(this.jma=this.wb.lyd())}sO(){return"NBCommand"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:2}qK(ya,Ab,Vb=!1,oc=f.a.tellMe,Wc=null){const cd=new l.a(ya);if((!Wc||Array.contains(Wc,0))&&!me.a.IX(ya)){if(Id.CommandResultsUtility.Phf(ya.Ef)&&(Wc=Id.CommandResultsUtility.msh(ya.Ef),0<Wc.results.length)){Wc.displayName=
"Classifier Debug";cd.kw(Wc);Ab.resultsUpdated(cd);return}if(!this.qnc.qkf()){if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.wb.$Sa&&this.jma&&this.jma.initialize();Wc=this.qnc.Cjl(ya.Ef);Id.CommandResultsUtility.cNd(Wc,!1,"Classifier","NaiveBayesian");Wc=Id.CommandResultsUtility.NBd(Wc,this.wb,this.jma,null,null,0,1);0<Wc.results.length&&
oc!==f.a.contextMenu&&(Wc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);Vb||Wc.results.length||this.wb.EX||this.wb.m0a||(ya=new ge.a("lookupNoResults",14,ya.Ef,null,1),Wc.Xw(ya));0<Wc.results.length&&cd.kw(Wc)}Ab.resultsUpdated(cd)}}Object(k.a)(yg,"NaiveBayesCommandProvider",null,[1042]);class Pe{constructor(){this.iob=null;this.vv=!1;this.l6d()}l6d(){this.vv||(this.iob=window.NBCRM)&&4===this.iob.length&&(this.vv=!0);return this.vv}Wbl(){return this.vv?this.iob[1]:null}rkl(){return this.vv?
this.iob[2]:null}J4k(){return this.vv?this.iob[3][0]:null}e9e(){return this.vv?this.iob[0][0]:null}}Object(k.a)(Pe,"NaiveBayesModelAdapter",null,[1069]);var wd=b(76),Wk=b(265),zk=b(1378),Zl=b(1337),Vh=b(1377),wl=b(31),Dg=b(133),fc=b(1287);class xj{constructor(ya){this.uN=null;this.AZ=-1;this.Frf=14;this.Irf=12;this.attributes=this.OEe=this.query=null;this.f3b=!1;this.xQb=[];this.Qe=nl.AFrameworkApplication.fe;nl.AFrameworkApplication.K&&(this.Frf=nl.AFrameworkApplication.K.vb("TellMeMaxTermedResults",
this.Frf),this.Irf=nl.AFrameworkApplication.K.vb("TellMeMaxZeroTermResults",this.Irf));this.ZR=ya}get Am(){return this.xQb}get N6d(){return this.OEe}kw(ya){let Ab=!1;for(let Vb=0;Vb<this.Am.length;Vb++)if(25!==this.Am[Vb].groupType&&this.Am[Vb].groupType===ya.groupType){this.SHe(this.Am[Vb],ya);Ab=!0;break}Ab||this.Am.push(ya)}SHe(ya,Ab){for(let Vb=0;Vb<Ab.results.length;Vb++)ya.Xw(Ab.results[Vb])}Wqi(ya){const Ab=[];for(const Vb of this.Am)Vb.groupType!==ya&&Ab.push(Vb);this.Am.length!==Ab.length&&
(this.xQb=Ab)}CWm(ya){let Ab=null,Vb=null,oc=null;for(let Wc=0;Wc<ya.length;Wc++){const cd=ya[Wc];if(cd&&cd.Am&&cd.Am.length)for(const yd of cd.Am)if(17===yd.groupType||18===yd.groupType)Ab=yd;else if(0===yd.groupType||16===yd.groupType)Vb=yd,oc=cd}Ab&&Vb&&0<Vb.results.length&&(17===Ab.groupType&&({sHe:Vb,eIe:Ab}=Id.CommandResultsUtility.IDj(Vb,Ab,this.ZR.oM()?this.ZR.oM().UUk:-.6)),oc.Wqi(Vb.groupType))}oun(){new wd.a;this.UWc(this.ZR.n3h)}wKc(ya,Ab){return this.query.Ef.length>this.ZR.oM().Bcl&&
this.jQl(ya,Ab)||this.query.Ef.length>this.ZR.oM().Ccl&&this.SSl(ya,Ab)?!0:!1}SSl(ya,Ab){return ya&&ya.length&&Ab&&Ab.length?-1===Ab.toLowerCase().indexOf(ya.toLowerCase())?!1:!0:!1}jQl(ya,Ab){return ya&&ya.length&&Ab&&Ab.length?Ab.toLowerCase().startsWith(ya.toLowerCase()):!1}zHk(ya){const Ab=[];for(const Vb of this.ZR.oM().GY?this.N6d:this.Am)ya.contains(Vb.groupType)||Ab.push(Vb);this.ZR.oM().GY?this.OEe=Ab:this.xQb=Ab}FQn(ya,Ab){const Vb=[];for(const oc of this.Am){const Wc=oc;if(13!==Wc.groupType){const cd=
ya[Zl.a[Wc.groupType].toLowerCase()];let yd="False";cd<Ab&&(yd="True");Wc.displayName=Wc.displayName+" ("+yd+": "+cd+")"}Vb.push(Wc)}this.xQb=Vb}UWc(ya,Ab=!1,Vb=null){if(this.ZR.oM().GY){if(!Ab)for(this.OEe=Array(this.Am.length),Ab=0;Ab<this.Am.length;Ab++)this.N6d[Ab]=this.Am[Ab];this.ZR.s3h.UWc(this.Am,this.N6d,this.query,ya,Vb)}else{for(Vb=new wd.a;this.Am.length;){Ab=this.Am.pop();const oc=Zl.a[Ab.groupType].toLowerCase(),Wc=ya[oc];if(fc.c(Wc))throw Error.create("GroupId "+oc+" missed from group SortingOrder");
Vb.add(new Wk.a(Wc,Ab))}Vb.Sc((oc,Wc)=>oc.key<Wc.key?-1:1);for(ya=0;ya<Vb.count;ya++)Ab=Vb.J(ya).value,this.Am.push(Ab)}}pun(){var ya=!1;let Ab=!1,Vb=!1;for(let Wc=0;Wc<this.Am.length;Wc++){var oc=this.Am[Wc];const cd=oc.groupType;if(8===cd||15===cd||14===cd){oc=oc.results;for(let yd=0;yd<oc.length;yd++){if(8===cd&&this.wKc(this.query.Ef,oc[yd].label)){ya=!0;break}if(15===cd&&this.wKc(this.query.Ef,oc[yd].label)){Ab=!0;break}if(14===cd){if(this.wKc(this.query.Ef,oc[yd].label)||this.wKc(this.query.Ef,
oc[yd].description)){Vb=!0;break}const sc=oc[yd].label.split(" ");for(const Xd of sc)if(this.wKc(this.query.Ef,Xd)){Vb=!0;break}}}}}ya=this.ZR.kel(ya,Ab,Vb);this.UWc(ya)}eDb(ya,Ab,Vb,oc,Wc,cd){if(Wc===this.uN){var yd=ya.data.qd;Wc=null;try{Wc=wl.b(yd)}catch(Hg){Me.TellMeActor.instance.Pd.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Hg);return}if("RankerResults"in Wc&&Wc.RankerResults){this.Rwa();var sc=Wc.RankerResults,Xd=new wd.a,Sd=new wd.a;yd=0;
for(var wf of sc){sc=wf.ProviderId;var Xi=wf.Score;yd+=Xi;Xd.add(new Wk.a(sc,Xi))}Xd.Sc((qh,xi)=>qh.value>xi.value?-1:1);Xi=cd?cd.ECh:1E-6;wf={};sc={};let Hg=0;for(var Ak=0;Ak<Xd.count;Ak++){let qh=parseInt(Xd.J(Ak).key),xi=Xd.J(Ak).value/yd;1===qh&&(sc.answer=Hg++,sc.entity=Hg++,sc.definition=Hg++,sc.wolframanswer=Hg++,xi<Xi&&(Sd.add(9),Sd.add(11),Sd.add(10),Sd.add(12)),wf.answer=xi,wf.entity=xi,wf.definition=xi,wf.wolframanswer=xi);2===qh&&(sc.assistance=Hg++,xi<Xi&&Sd.add(8),wf.assistance=xi);
3===qh&&(sc.classifier=Hg++,sc.serviceclassifier=Hg++,xi<Xi&&(Sd.add(0),Sd.add(17)),wf.classifier=xi,wf.serviceclassifier=xi);4===qh&&(sc.people=Hg++,xi<Xi&&Sd.add(14),wf.people=xi);5===qh&&(sc.document=Hg++,xi<Xi&&Sd.add(15),wf.document=xi);6===qh&&(sc.findindocument=Hg++,xi<Xi&&Sd.add(2),wf.findindocument=xi);7===qh&&(sc.notes=Hg++,xi<Xi&&Sd.add(20),wf.notes=xi);8===qh&&(sc.image=Hg++,xi<Xi&&Sd.add(19),wf.image=xi)}Xd=new wd.a;Xd.add("classifier");Xd.add("serviceclassifier");Xd.add("appsforoffice");
Xd.add("addin");Xd.add("findindocument");Xd.add("assistance");Xd.add("document");Xd.add("people");Xd.add("answer");Xd.add("wolframanswer");Xd.add("definition");Xd.add("entity");Xd.add("image");Xd.add("template");for(Ak=0;Ak<Xd.count;Ak++)Xd.J(Ak)in sc||(sc[Xd.J(Ak)]=Hg++);sc.learning=Hg++;sc.insights=Hg++;sc.feedback=Hg++;cd&&cd.eUh&&this.FQn(wf,Xi);cd&&cd.fUh&&this.zHk(Sd);Sd={};for(var ph in wf)Sd[ph]=wf[ph]*yd;this.UWc(sc,!0,Sd)}if(cd.eKd&&"Intents"in Wc&&Wc.Intents){ph=Wc.Intents;for(var Ah of ph)if(this.Imf(Ah)&&
"Serplet"===Ah.GroupType&&Ah.ConfidenceScore>Ah.ConfidenceThreshold){ph=!1;Wc=0;if(cd.fKd){yd=new ge.a("",26);for(Sd=0;Sd<this.Am.length;Sd++)if((Xd=this.Am[Sd].results)&&0<Xd.length){Wc=Sd;yd=Xd[0];break}2===yd.groupType&&(ph=!0)}yd=new m.a(13);ph&&cd.fKd&&(yd=new m.a(13,CommonUIStrings.l_TellMeWebTitle));Sd=new ge.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Ef,null,0);Xd=[];wf=null;wf=me.a.aAa()?me.a.hUa(this.query.Ef,1):me.a.mub(this.query.Ef);Xd.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",
wf));wf=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Ef);Xd.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",wf));appChrome.api.dispatch(Xd);yd.Xw(Sd);Sd=[];if(ph&&cd.fKd)for(Sd.push(this.Am[Wc]),Sd.push(yd),ph=Wc+1;ph<this.Am.length;ph++)(Wc=this.Am[ph].results)&&0<Wc.length&&Sd.push(this.Am[ph]);else for(Sd.push(yd),ph=0;ph<this.Am.length;ph++)(Wc=this.Am[ph].results)&&0<Wc.length&&Sd.push(this.Am[ph]);this.xQb=Sd}}if(cd.FKc&&!cd.GY){Ah=ph=
-1;for(Wc=0;Wc<this.Am.length;Wc++)switch(this.Am[Wc].groupType){case 23:ph=Wc;break;case 0:case 17:case 2:-1===Ah&&(Ah=Wc)}if(-1!==ph){Ah=-1===Ah?0:ph>Ah?Ah+1:Ah;ph=this.Am[ph];Wc=Array(this.Am.length);yd=0;for(Sd=0;Sd<Wc.length;Sd++)Sd===Ah?Wc[Sd]=ph:(23===this.Am[yd].groupType&&yd++,Wc[Sd]=this.Am[yd],yd++);this.xQb=Wc}}oc.resultsUpdated(this);oc=Me.TellMeActor.instance.Pd;oc.N4(Ab.length,"RankerInference",ya.data.we.toString(),Math.round(window.performance.now()-Vb),Vh.a.INi,!0,zk.a.DJa);this.f3b&&
oc&&(ya=this.query.Xfb,Ab=oc.b4c,cd.vKd&&ya>Ab&&!cd.GY&&(oc.cqf(this.query.Ef),oc.zPf(ya)))}}Imf(ya){if("GroupType"in ya&&ya.GroupType&&"ConfidenceScore"in ya&&"ConfidenceThreshold"in ya)return!0;Me.TellMeActor.instance.Pd.onError("IsValidIntentGroup","Invalid intents found");return!1}QCb(ya,Ab,Vb,oc,Wc){oc===this.uN&&(this.Rwa(),Me.TellMeActor.instance.Pd.N4(Ab.length,"RankerInference",ya.data.we.toString(),Math.round(window.performance.now()-Vb),Vh.a.INi,!1,zk.a.DJa));Wc.resultsUpdated(this)}Rwa(){-1!==
this.AZ&&(window.clearTimeout(this.AZ),this.AZ=-1)}qun(ya){let Ab;Ab=this.ZR.oM().GY?Me.TellMeActor.instance.Pd.laf(this.N6d,this.query.Ef):Me.TellMeActor.instance.Pd.laf(this.Am,this.query.Ef);var Vb=this.ZR.oM().DCh;""!==Vb&&(Vb="_"+Vb);let oc="";this.ZR.oM().nJd&&(oc="RankerInference"+Vb+",");this.ZR.oM().eKd&&(oc+="SerpletClassifier");","===oc.charAt(oc.length-1)&&(oc=oc.substring(0,oc.length-1));Vb=Me.TellMeActor.instance.Pd.qEh(oc);const Wc=this.uN=Dg.a.create().toString();Vb["Client-Request-Id"]=
Wc;const cd=window.performance.now(),yd=this.ZR.oM()?this.ZR.oM().FCh:1E3;this.Rwa();this.AZ=window.setTimeout(()=>{if(Wc===this.uN){this.uN="";this.AZ=-1;ya.resultsUpdated(this);const sc={};sc[x.a.provider]="Ranker";sc[x.a.hEb]=this.query.Xfb;Me.TellMeActor.instance.Pd.jA(u.a.timedOut,yd,sc)}},yd);this.Qe.ai(Me.TellMeActor.instance.Pd.rEh(),2,Ab,Vb,!1,0,sc=>{this.eDb(sc,this.query.Ef,cd,ya,Wc,this.ZR.oM())},sc=>{this.QCb(sc,this.query.Ef,cd,Wc,ya)},null,null,!1,4E3,6E3)}GGn(){var ya=0,Ab=new wd.a,
Vb=this.ZR.l3h,oc=this.ZR.m3h;for(var Wc=0;Wc<this.Am.length;Wc++){var cd=this.Am[Wc],yd=Zl.a[cd.groupType].toLowerCase(),sc=Vb[yd];ya+=cd.results.length;cd.results.length>sc&&(yd=oc[yd],fc.c(yd)||Ab.add(new Wk.a(yd,cd)))}oc=!this.query||""===this.query.Ef.trim();Wc=ya-(oc?this.Irf:this.Frf);if(!(0>=Wc)){oc=window.performance.now();ya=ya.toString()+" total,"+Wc.toString()+" to remove.";if(0<Ab.count)for(Ab.Sc((Xd,Sd)=>Xd.key>Sd.key?-1:1),cd=0;cd<Ab.count&&0<Wc;cd++){yd=Ab.J(cd).value;sc=Zl.a[yd.groupType].toLowerCase();
let Xd=yd.results.length-Vb[sc];Xd>Wc&&(Xd=Wc);0<Xd&&(yd.nKf(Xd),ya+=sc+": "+Xd.toString()+" results removed.",Wc-=Xd)}if(0<Wc){ya+=Wc.toString()+" results left after trimming.";Ab=new wd.a;Vb=this.ZR.q3h;for(cd=0;cd<this.Am.length;cd++)yd=this.Am[cd],sc=Vb[Zl.a[yd.groupType].toLowerCase()],fc.c(sc)||Ab.add(new Wk.a(sc,yd));Ab.Sc((Xd,Sd)=>Xd.key<Sd.key?-1:1);for(Vb=0;0<Wc;)cd=Ab.J(Vb++).value,Wc>=cd.results.length?(Array.remove(this.Am,cd),ya+=Zl.a[cd.groupType]+": "+cd.results.length.toString()+
" results force removed.",Wc-=cd.results.length):(cd.nKf(Wc),ya+=Zl.a[cd.groupType]+": "+Wc.toString()+" results force removed.",Wc=0)}Me.TellMeActor.instance.Pd&&(Ab={},Ab[x.a.message]=ya,Me.TellMeActor.instance.Pd.jA("ShowOptimal",window.performance.now()-oc,Ab))}}}Object(k.a)(xj,"CombineResultsUpdatedEventArgs",null,[1019]);var ng=b(1456);class Cf{constructor(ya,Ab,Vb,oc=!1,Wc=""){this.Uve=this.Fye=!1;this.Ju=ya;this.Rpb=[];this.tBg=Ab.length;this.wb=Me.TellMeActor.instance.oM();this.g$c=oc;this.qoa=
Wc;this.KRb={};for(ya=0;ya<Ab.length;++ya)this.KRb[ya.toString()]=Vb?0:Ab[ya].u0()}bin(ya,Ab){Ab&&Ab.query&&Ab.query.Xfb<Me.TellMeActor.instance.Sna||(this.Rpb[ya]=Ab,this.Uve?this.Fye=!0:(!this.wb||3!==this.wb.rw||3!==this.KRb[ya.toString()]||this.Gdh())&&this.ucb())}$zm(){this.Uve=!0}jKn(){this.Uve=!1;this.Fye&&(this.Fye=!1,this.ucb())}Gdh(){if(this.Rpb.length<this.tBg)return!1;for(let ya=0;ya<this.tBg;++ya)if(!this.Rpb[ya])return!1;return!0}ucb(){var ya=this.Gdh();const Ab=window.performance.now(),
Vb=new xj(Me.TellMeActor.instance.Nkg);Vb.CWm(this.Rpb);for(var oc=0;oc<this.Rpb.length;++oc){var Wc=this.Rpb[oc];if(Wc&&Wc.Am&&Wc.Am.length&&(Vb.query=Wc.query,Wc.attributes&&0<Wc.attributes.length&&(Vb.attributes=Wc.attributes),Wc&&Wc.Am&&(ya||this.Y4j(oc,this.Rpb))))for(const cd of Wc.Am)Vb.kw(cd)}Vb.Am&&Vb.Am.length&&(Vb.f3b=ya,this.wb&&this.wb.X5d&&Vb.GGn(),ng.a.JWh()&&(this.wb&&this.wb.xRl&&Vb.query.Ef&&0<Vb.query.Ef.length?Vb.pun():Vb.oun()),ng.a.JWh()&&this.wb&&(this.wb.nJd||this.wb.eKd)&&
this.g$c&&Vb.query.Ef&&0<Vb.query.Ef.length&&Vb.f3b&&this.qoa!==f.a.contextMenu?(3===this.wb.rw&&ya||this.Ju.resultsUpdated(Vb),Vb.qun(this.Ju)):this.Ju.resultsUpdated(Vb),ya=Me.TellMeActor.instance.Pd,Vb.f3b&&ya&&(oc=Vb.query.Xfb,Wc=ya.b4c,Vb.query.Ef&&0<Vb.query.Ef.length&&this.g$c&&this.wb.vKd&&this.qoa!==f.a.contextMenu&&oc>Wc&&!this.wb.nJd&&!this.wb.GY&&(ya.cqf(Vb.query.Ef),ya.zPf(oc)),ya.jA(u.a.L3m,window.performance.now()-Ab)))}Y4j(ya,Ab){if(!(this.KRb&&ya.toString()in this.KRb)||Ab.length<=
ya||!Ab[ya])return!1;if(!Ab[ya].Am.length)return!0;const Vb=this.KRb[ya.toString()];if(0===Vb)return!0;const oc=this.KRb;for(let cd in oc){var Wc=oc[cd];const yd=Number.parseInvariant(cd);if(yd!==ya&&Wc===Vb&&!(Ab.length>yd&&Ab[yd]))return!1}return!0}}Object(k.a)(Cf,"ResultsAggregator",null,[]);var gg=b(1586);class pf{constructor(){this.ecc=this.fcc=this.dcc=this.logCount=this.logRank=this.invertedRank=0}sDj(ya,Ab){switch(ya){case 1:this.invertedRank=Ab;break;case 3:this.logRank=Ab;break;case 2:this.logCount=
Ab;break;case 5:this.dcc=Ab;break;case 4:this.fcc=Ab;break;case 6:this.ecc=Ab}}}Object(k.a)(pf,"CommandFeatures",null,[]);class $k{constructor(ya){this.eig=0;this.Omj=ya;this.L$i={}}get modelId(){return this.Omj}get featureIntercept(){return this.eig}get Pwc(){return this.L$i}tCj(ya,Ab,Vb){0===Ab?this.eig=Vb:(this.Pwc[ya]||(this.Pwc[ya]=new pf),this.Pwc[ya].sDj(Ab,Vb))}}Object(k.a)($k,"CoefficientsModel",null,[]);const ol=(ya,Ab)=>Math.pow(10,-Ab/(60*Math.LN10/Math.LN2*ya));class Tg{constructor(ya,
Ab){this.Mh=1;this.S5c=new pf;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=ya?1/ya:0;this.features.logRank=2/Math.pow(2,ya);this.features.dcc=ol(10,Ab);this.features.fcc=ol(2,Ab);this.features.ecc=ol(1,Ab)}get count(){return this.Mh}get features(){return this.S5c}WLh(){this.Mh=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}pQn(ya){const Ab=2/Math.pow(2,ya);this.features.invertedRank=Math.max(this.features.invertedRank,ya?1/ya:0);this.features.logRank=
Math.max(this.features.logRank,Ab)}TRn(ya){const Ab=ol(10,ya),Vb=ol(2,ya);ya=ol(1,ya);this.features.dcc=Math.max(this.features.dcc,Ab);this.features.fcc=Math.max(this.features.fcc,Vb);this.features.ecc=Math.max(this.features.ecc,ya)}}Object(k.a)(Tg,"CommandModel",null,[]);class xd{constructor(ya){this.qgc=null;if(!ya&&Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("PredictionEngine","IModelAdapter can't be null");this.aPb=ya;this.Uad=this.fpf()}fpf(){const ya=this.aPb.p7k(),Ab=this.aPb.e9e();
if(void 0===ya||null===ya||void 0===Ab||null===Ab)return!1;try{window.performance.now();this.qgc={};for(let Vb=0;Vb<ya.length;Vb++){const oc=ya[Vb],Wc=Ab[oc[0].toString()].trim(),cd=oc[1],yd=0!==cd?Ab[oc[2].toString()].trim():"",sc=oc[3];Wc in this.qgc||(this.qgc[Wc]=new $k(Wc));this.qgc[Wc].tCj(yd,cd,sc)}}catch(Vb){if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("LoadModelData","Error Loading Suggestions Model: "+Vb);return!1}return!0}$Ok(){const ya=this.aPb.d4k(),Ab={};if(!ya)return Ab;
let Vb=1;for(let oc=0;oc<ya.length;oc++){const Wc=ya[oc];Wc.Id in Ab?(Ab[Wc.Id].WLh(),Ab[Wc.Id].pQn(Vb),Ab[Wc.Id].TRn(Wc.TimeElapsedSinceClick)):Ab[Wc.Id]=new Tg(Vb,Wc.TimeElapsedSinceClick);Vb++}return Ab}qkf(){this.Uad||(this.Uad=this.fpf());return this.Uad}jbl(){let ya=[];if(!this.Uad){if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("GetPredictedCommands","IModelAdapter returned no data");return ya}const Ab=this.$Ok(),Vb=this.qgc;for(let Wc in Vb){const cd=Vb[Wc],yd=cd.modelId;
let sc=0;for(let Xd in Ab){var oc=Xd;const Sd=Ab[Xd].features;(oc=oc in cd.Pwc?cd.Pwc[oc]:null)&&(sc+=Sd.invertedRank*oc.invertedRank+Sd.logRank*oc.logRank+Sd.logCount*oc.logCount+Sd.dcc*oc.dcc+Sd.fcc*oc.fcc+Sd.ecc*oc.ecc)}sc+=cd.featureIntercept;ya.push(new rd.a(yd,sc))}ya.sort((Wc,cd)=>Wc.score<cd.score?1:Wc.score>cd.score?-1:0);0<ya.length-10&&(ya=ya.slice(0,10));return ya}}Object(k.a)(xd,"PredictionEngine",null,[]);class Si{constructor(){this.FEg={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}Gyd(ya,Ab){return Ab&&"word"===Ab.application.toLowerCase()&&
ya in this.FEg?this.FEg[ya]:[]}}Object(k.a)(Si,"SuggestionResultsUtility",null,[]);class Sj{constructor(ya,Ab,Vb){this.wb=Ab;this.qnc=new xd(ya);this.UZ=Vb;this.uHg=new Si}sO(){return"Suggestion"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:2}qK(ya,Ab,Vb,oc=f.a.tellMe,Wc=null){Vb=new l.a(ya);Me.TellMeActor.instance.k_c=!1;if((!Wc||Array.contains(Wc,16))&&me.a.IX(ya)){if(!this.qnc.qkf()){if(Me.TellMeActor.instance.Pd)Me.TellMeActor.instance.Pd.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}if(this.$Jd()&&0<this.uHg.Gyd(Me.TellMeActor.instance.ssd,this.wb).length){Wc=this.uHg.Gyd(Me.TellMeActor.instance.ssd,this.wb);ya=[];for(var cd of Wc)this.wb.I1d&&"Find"===cd||ya.push(new rd.a(cd,0));Me.TellMeActor.instance.k_c=!0}else ya=this.qnc.jbl();Id.CommandResultsUtility.cNd(ya,!0,"Recommended","LRE");cd=[];for(var yd of ya)this.UZ&&this.UZ.XRe(yd.commandId)||cd.push(yd);yd=Id.CommandResultsUtility.NBd(cd,this.wb,
null,null,null,16,1);0<yd.results.length&&oc!==f.a.contextMenu&&(yd.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<yd.results.length&&Vb.kw(yd)}Ab.resultsUpdated(Vb)}$Jd(){return!!this.wb&&(this.wb.$Jd||this.wb.AVl)}}Object(k.a)(Sj,"SuggestionResultsProvider",null,[1042]);class Re{d4k(){return Me.TellMeActor.instance.Tde}p7k(){return window.TellMeSuggestionModel}e9e(){return window.CoefficientModelIdMap}}Object(k.a)(Re,"SuggestionsModelAdapter",null,[1068]);var Ae=b(1560),Ml=b(1563);b.d(P,
"AggregatorResultsProvider",function(){return mh});class mh{constructor(ya=!1){this.kQb={};this.kQb[f.a.tellMe]=[];this.kQb[f.a.contextMenu]=[];this.g$c=ya}vYh(ya,Ab,Vb,oc,Wc=null){let cd;var yd=!1;switch(oc){case f.a.contextMenu:cd=this.kQb[f.a.contextMenu];yd=!0;break;default:cd=this.kQb[f.a.tellMe]}Ab=new Cf(Ab,cd,yd,this.g$c,oc);Ab.$zm();for(let sc=0;sc<cd.length;++sc){const Xd=window.performance.now(),Sd=new r(Ab,sc);(yd=Me.TellMeActor.instance.oM())&&yd.fVj?window.setTimeout(()=>{cd[sc].qK(ya,
Sd,Vb,oc,Wc);if(Me.TellMeActor.instance.Pd){const wf={};wf[x.a.provider]=cd[sc].sO();wf[x.a.hEb]=ya.Xfb;Me.TellMeActor.instance.Pd.jA(u.a.qK,window.performance.now()-Xd,wf)}},0):(cd[sc].qK(ya,Sd,Vb,oc,Wc),Me.TellMeActor.instance.Pd&&(yd={},yd[x.a.provider]=cd[sc].sO(),yd[x.a.hEb]=ya.Xfb,Me.TellMeActor.instance.Pd.jA(u.a.qK,window.performance.now()-Xd,yd)))}Ab.jKn()}sO(){return"Aggregator"}u0(){return 0}qK(ya,Ab,Vb=!1,oc=f.a.tellMe,Wc=null){if(Me.TellMeActor.instance.sem)this.vYh(ya,Ab,Vb,oc,Wc);else{const cd=
window.performance.now();Me.TellMeActor.instance.JVn.then(()=>{Me.TellMeActor.instance.Pd&&Me.TellMeActor.instance.Pd.jA(u.a.tem,window.performance.now()-cd);this.vYh(ya,Ab,Vb,oc,Wc);return!0})}}ZH(ya,Ab){this.kQb[Ab].push(ya)}cEj(ya){switch(ya){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Ab=this.kQb[f.a.tellMe];for(const Vb of Ab)if("FindInDocument"===Vb.sO()){Vb.mgn(ya);break}}}static createInstance(ya,Ab,Vb,oc){const Wc=oc&&me.a.bSf(Ab);var cd=
Wc&&Ab.mBf;const yd=Ab.vmf&&!me.a.wAb(),sc=new mh(Wc);if(Ab.Ron){var Xd=new Ne(Ab);sc.ZH(Xd,f.a.tellMe)}Xd=Ab.Jo?nl.AFrameworkApplication.K.$("TellMeIsSuggestionsForSimplifiedUxEnabled"):nl.AFrameworkApplication.K.$("TellMeSuggestionsIsEnabled");const Sd=!Xd&&nl.AFrameworkApplication.K.$("TellMeFirstRunExperienceIsEnabled");sc.ZH(new oe.a(ya,Ab.vIn,Sd,!1),f.a.tellMe);Xd&&sc.ZH(new Sj(new Re,Ab,ya),f.a.tellMe);ya=nl.AFrameworkApplication.na.Ya.tXh?new yg(Ab,new Pe):new zn(Ab,Vb);sc.ZH(ya,f.a.contextMenu);
(Wc&&Ab.nBf||cd)&&sc.ZH(Ae.a.K$g(Ab,!0),f.a.tellMe);sc.ZH(ya,f.a.tellMe);!Ab.Hlh||"Word"===Ab.application&&Ab.Gwd||sc.ZH(new tg(Ab),f.a.tellMe);Ab.$Sa&&(cd=new z(Ab),sc.ZH(cd,f.a.tellMe),sc.ZH(cd,f.a.contextMenu));!Ab.ssb||Ab.eWc||Ab.dWc||sc.ZH(new F.a(Ab),f.a.tellMe);oc&&(Ab.EX||me.a.aAa())&&(cd=new Ri(Ab),sc.ZH(cd,f.a.tellMe),sc.ZH(cd,f.a.contextMenu));Wc&&sc.ZH(Ae.a.K$g(Ab,!1),f.a.tellMe);oc&&!Ab.VVf&&me.a.aSf(Ab)&&(sc.ZH(new gg.a(Ab),f.a.tellMe),Ab.eMi&&sc.ZH(new gg.a(Ab),f.a.contextMenu));yd&&
sc.ZH(new th(Ab),f.a.tellMe);(Ab.oac||Ab.GY)&&sc.ZH(new Ih.a(Ab),f.a.tellMe);Ab.FKc&&sc.ZH(new Ml.a(Ab),f.a.tellMe);oc&&nl.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ForbiddenCatalogGetLoaderParamsFromCallback",!1)&&Ab.qhf&&sc.ZH(new w.AddinResultsProvider(Ab),f.a.tellMe);return sc}}Object(k.a)(mh,"AggregatorResultsProvider",null,[1042])},1579:function(G,P,b){G=b(0);var k=b(17),f=b(6),x=b(143),u=b(202),w=b(366),r=b(51),m=b(69),l=b(841),z=b(776),F=b(510);b(458);var L=
b(1552),E=b(1553),A=b(1549),M=b(1551),Q=b(1550),R=b(840),K=b(775);class J{constructor(oa,ha,pa){this.uOk=oa;this.HSj=ha;this.d3j=pa}}Object(G.a)(J,"BacktraceAndMakeUpdateHintsInput",null,[]);var O=b(1360),N;(function(oa){oa[oa.EOP=0]="EOP";oa[oa.character=1]="character";oa[oa.embeddedMarker=2]="embeddedMarker"})(N||(N={}));Object(G.b)("LCSBlockType",N);class V{toString(){return String.format("[Type: {0}]",N[this.type])}}Object(G.a)(V,"ALCSBlock",null,[]);class W extends V{constructor(oa,ha){super();
this.Yce=ha;this.Dve=oa}get type(){return 1}get character(){return this.Yce}get eu(){return this.Dve}oy(oa){return 1===oa.type&&O.a.cUg(oa.character,this.character)}toString(){return String.format("{0} [Char: {1}]",super.toString(),this.character)}}Object(G.a)(W,"CharacterLCSBlock",V,[]);class ca extends V{constructor(oa,ha,pa){super();this.Dve=oa;this.bGe=ha;this.mmc=pa}get type(){return 0}get Ib(){return this.bGe}get length(){return this.mmc}get eu(){return this.Dve}oy(oa){return 0!==oa.type?!1:
oa.eu===this.eu&&oa.Ib===this.Ib}toString(){return String.format("{0} [ParaId: {1}] [WordId: {2}] [Length: {3}]",super.toString(),this.eu.toString(),this.Ib,this.length)}}Object(G.a)(ca,"EOPLCSBlock",V,[]);class H extends W{constructor(oa,ha,pa){super(oa,"\ufffc");this.dmj=ha;this.I6c=pa}get type(){return 2}get Mk(){return this.dmj}get mi(){return this.I6c}oy(oa){return 2!==oa.type?!1:oa.Mk===this.Mk&&this.mi.equals(oa.mi)}toString(){return String.format("{0} [Marker: {1}] [FId: {2}]",super.toString(),
this.Mk,this.mi)}}Object(G.a)(H,"EmbeddedMarkerLCSBlock",W,[]);class Z{constructor(oa,ha){this.x=oa;this.y=ha}equals(oa){return oa.x===this.x&&oa.y===this.y}toString(){return"("+this.x+", "+this.y+")"}}Object(G.a)(Z,"IntPair",null,[881]);var aa=b(1399),ja=b(1381),Ba=b(1400),la=b(1548);b.d(P,"a",function(){return ia});class ia{constructor(oa,ha){this.Hf=oa;this.Rc=ha}V$g(oa,ha,pa,Ea,Fa,Ga,$a){return this.Wmk(oa,ha,pa,Ea,Fa,Ga,$a)}Wmk(oa,ha,pa,Ea,Fa,Ga,$a){let fa;fa=null;({returnValue:oa}=this.pAd(oa,
ha));if(!oa)return x.a.instance.ua(575706449,1,2,"Failed to get LCS blocks from objects for base"),this.Rc.logger.YR("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:fa};({returnValue:pa}=this.pAd(pa,Ea));if(!pa)return x.a.instance.ua(575706450,1,2,"Failed to get LCS blocks from objects for changed"),this.Rc.logger.YR("GetLCSBlocksFromObject"),{returnValue:!1,updateHints:fa};this.Rc.logger.YR("GetLCSBlocksFromObject");fa=this.Vmk(oa,pa,Fa,Ga,$a);return fa?{returnValue:!0,updateHints:fa}:(x.a.instance.ua(575706451,
1,2,"Failed to Create UpdateHints"),{returnValue:!1,updateHints:fa})}wlh(oa,ha,pa,Ea){({returnValue:oa}=this.pAd(oa,ha));if(!oa)return-1;({returnValue:pa}=this.pAd(pa,Ea));if(!pa)return-1;({aWe:pa}=this.Alh(oa,pa));return pa}pAd(oa,ha){let pa;const Ea=new u.a;pa=new u.a;if(!oa.length)return x.a.instance.ua(594124833,1,2,"Abandoning LCS due to empty list of paragraphs"),this.Rc.logger.Cf(Object.assign(new aa.a,{Ph:"GetLCSBlocksFromObject",eventId:"900a7"})),{returnValue:null,o0e:pa};for(let $a=0;$a<
oa.length;$a++)if(this.Rc.runtime.MC("GetLCSBlocksFromObject: paraObjs#"+$a),393230===oa.J($a).Gb){const fa=this.Hf.getPropertyString(oa.J($a),k.a.Pl),sa=this.Hf.getPropertyUint32(oa.J($a),f.a.Ib);if(null==sa)return x.a.instance.ua(594124835,1,2,"Abandoning LCS due to missing WordId"),this.Rc.logger.Cf(Object.assign(new aa.a,{Ph:"GetLCSBlocksFromObject",eventId:"900a9"})),{returnValue:null,o0e:pa};let qa=this.Hf.getPropertyUint32s(oa.J($a),k.a.pl);qa=ja.a.XCi(qa,fa.length);const va=this.Hf.getPropertyObjectIds(oa.J($a),
k.a.mm);let Ca;for(Ca=0;Ca<qa.length-1;Ca++){var Fa=ha(va.Ye(Ca)),Ga=void 0;Ga=Fa?(Ga=this.Hf.getPropertyBool(Fa,k.a.I5))?Ga:!1:!1;if(Ga)Ea.add(this.Chk(oa.J($a).id,Fa));else for(Fa=qa.Ye(Ca);Fa<qa.Ye(Ca+1);Fa++)Ea.add(new W(oa.J($a).id,O.a.charAt(fa,Fa)))}Ea.add(new ca(oa.J($a).id,sa,qa.J(Ca)));pa.add(Ea.length-1)}else return x.a.instance.ua(594124864,1,2,"Abandoning LCS due to presence of non-paragraph object of type {0}",oa.J($a).Gb),this.Rc.logger.Cf(Object.assign(new aa.a,{Ph:"GetLCSBlocksFromObject",
eventId:"900ba"})),{returnValue:null,o0e:pa};this.Rc.runtime.MC("LCS: GetLCSBlocks for base");return{returnValue:Ea,o0e:pa}}Chk(oa,ha){const pa=null==this.Hf.getPropertyInt32(ha,f.a.Qp)?0:this.Hf.getPropertyInt32(ha,f.a.Qp);return new H(oa,pa,ha.id)}Vmk(oa,ha,pa,Ea,Fa){Ea=({aWe:pa}=this.Alh(oa,ha,pa,Ea,Fa)).returnValue;this.Rc.logger.YR("FindFurthestPaths");oa=new J(Ea,oa,ha);oa=new la.a(this.xSj(oa,pa),1);this.Rc.logger.YR("BacktraceAndMakeUpdateHints");return oa}Alh(oa,ha,pa=-1,Ea=-1,Fa=-1){let Ga;
if(-1===pa||-1===Ea||-1===Fa)Fa=Ea=pa=-1;Ga=-1;const $a=new w.a;$a.Z(new Z(-1,1),new Z(0,-1));if(-1!==pa){$a.Z(new Z(0,0),new Z(pa,pa));var fa=1}else fa=0,Ea=oa.length,Fa=ha.length;for(pa=0;fa<=oa.length+ha.length;fa++){let sa=!1;for(let qa=-fa;qa<=fa;qa+=2){let va,Ca;qa===-fa?(va=$a.J(new Z(fa-1,qa+1)).x,Ca=$a.J(new Z(fa-1,qa+1)).y+1):qa===fa?(va=$a.J(new Z(fa-1,qa-1)).x+1,Ca=$a.J(new Z(fa-1,qa-1)).y):$a.J(new Z(fa-1,qa-1)).x>=$a.J(new Z(fa-1,qa+1)).x?(va=$a.J(new Z(fa-1,qa-1)).x+1,Ca=$a.J(new Z(fa-
1,qa-1)).y):(va=$a.J(new Z(fa-1,qa+1)).x,Ca=$a.J(new Z(fa-1,qa+1)).y+1);for(;va<Ea&&Ca<Fa&&oa.J(va).oy(ha.J(Ca));)va++,Ca++;$a.Z(new Z(fa,qa),new Z(va,Ca));if(va===Ea&&Ca===Fa){sa=!0;Ga=fa;pa=qa;break}}if(sa)break;this.Rc.runtime.MC("LCS FindFurthestPaths")}if(pa!==Ea-Fa)return{returnValue:null,aWe:Ga};$a.Z(new Z(Ga,pa),new Z(Ea+1,Fa+1));x.a.instance.ua(593826837,1,3,"FindFurthestPaths finished. Length of base: {0} Length of changed: {1} Size of diff: {2}",oa.length,ha.length,Ga);return{returnValue:$a,
aWe:Ga}}xSj(oa,ha){const pa=oa.uOk,Ea=oa.HSj;oa=oa.d3j;const Fa=new u.a;let Ga=Ea.length,$a=oa.length;for(;0<Ga||0<$a;){var fa=Ga-1,sa=$a-1;if(this.Zzm(pa,ha,Ga,$a)){fa=oa.J(sa);if(1===fa.type||2===fa.type)this.jEl(Fa,Ga,fa);else if(0===fa.type)this.LDl(Fa,Ga,fa);else return x.a.instance.ua(575706452,1,2,"Abandoning LCS due to unexpected block of type {0}",fa.type),this.Rc.logger.Cf(Object.assign(new Ba.a,{Ph:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;$a--;ha--}else if(this.Yzm(pa,
ha,Ga,$a)){sa=Ea.J(fa);if(1===sa.type||2===sa.type)this.Wrk(Fa,fa,sa);else if(0===sa.type)this.Ark(Fa,fa,sa);else return x.a.instance.ua(575706453,1,2,"Abandoning LCS due to unexpected block of type {0}",sa.type),this.Rc.logger.Cf(Object.assign(new Ba.a,{Ph:"BacktraceAndMakeUpdateHintsReducedOps",eventId:"0"})),null;Ga--;ha--}else if(Ga&&$a&&Ea.J(fa).oy(oa.J(sa)))Ga--,$a--;else return x.a.instance.ua(575706454,1,2,"Abandoning LCS due to being unable to find a path"),this.Rc.logger.Cf(Object.assign(new Ba.a,
{Ph:"BacktraceAndMakeUpdateHints",eventId:"0"})),null}this.Rc.runtime.MC("LCS: CreateUpdateHintsFromLCSBlocks");return Fa}Yzm(oa,ha,pa,Ea){ha=new Z(ha-1,pa-Ea-1);return oa.Ja(ha)&&oa.J(ha).x===pa-1&&oa.J(ha).y===Ea}Zzm(oa,ha,pa,Ea){ha=new Z(ha-1,pa-Ea+1);return oa.Ja(ha)&&oa.J(ha).x===pa&&oa.J(ha).y===Ea-1}addPara(oa,ha,pa,Ea,Fa,Ga){var $a=null;pa.block?$a=pa.block.eu:0<=Fa&&0===oa.J(Fa).type&&($a=oa.J(Fa).eu);pa=oa=Ga.eu;if(Ea.HTb.contains(oa))for(Fa=0,oa=r.a.Ee("{00000000-0000-0000-0000-000000000000}{"+
Fa+"}");Ea.HTb.contains(oa);)Fa++,oa=r.a.Ee("{00000000-0000-0000-0000-000000000000}{"+Fa+"}");$a=new l.AddParagraphUpdateHint(oa,Ga.Ib,$a);$a.Svm=pa;ha.updateHints.add($a);Ea.eu=oa;Ea.Ib=Ga.Ib;Ea.HTb.add(oa);Ea.MLa=0}LDl(oa,ha,pa){pa=new A.a(pa.eu,pa.Ib);let Ea=!1;if(0<oa.length&&11===oa.Ye(oa.length-1).type){const Fa=oa.Ye(oa.length-1);Fa.cp===ha&&(Ea=!0,Fa.xX.add(pa))}Ea||(ha=new Q.a(ha),ha.xX.add(pa),oa.add(ha))}splitPara(oa,ha,pa,Ea,Fa,Ga,$a,fa){oa=this.MIk(Ga.eu,oa,ha,Ea);if(!oa)return!1;ha=
new K.a(Ga.eu,Ga.Ib,Ga.MLa,oa.eu,oa.Ib,$a.eu,$a.Ib);pa.updateHints.add(ha);Ga.Ib=oa.Ib;oa!==fa?(Fa.block=oa,Fa.n5n=Ga.MLa,Fa=new l.AddParagraphUpdateHint(fa.eu,fa.Ib,oa.eu),pa.updateHints.add(Fa),Ga.eu=fa.eu,Ga.Ib=fa.Ib,Ga.HTb.add(fa.eu),Ga.MLa=0):Ga.HTb.add($a.eu);return!0}jEl(oa,ha,pa){var Ea=!1;if(0<oa.length&&11===oa.Ye(oa.length-1).type){const Fa=oa.Ye(oa.length-1);Fa.cp===ha&&((Ea=Object(m.a)(M.a,Fa.xX.J(Fa.xX.length-1)))?Ea.text=pa.character.toString()+Ea.text:Fa.xX.add(new M.a(pa.eu,pa.character.toString())),
Ea=!0)}Ea||(ha=new Q.a(ha),ha.xX.add(new M.a(pa.eu,pa.character.toString())),oa.add(ha))}deletePara(oa,ha,pa,Ea,Fa,Ga){let $a=-1;for(let fa=0;fa<Fa.length;fa++)if(Fa.J(fa)===Ga){0<fa&&($a=fa-1);break}Ga=null;0<=$a&&(Ga=Ea.J(Fa.J($a)));Ea=new z.a(pa.eu,pa.Ib,Ga?Ga.eu:null);oa.updateHints.add(Ea);Ga&&ha.eu.equals(pa.eu)&&(ha.MLa=Ga.length,ha.eu=Ga.eu,ha.Ib=Ga.Ib);ha.HTb.remove(pa.eu)}Ark(oa,ha,pa){ha=new L.a(ha,pa.eu,pa.Ib);oa.add(ha)}mergePara(oa,ha,pa){oa.updateHints.add(new R.MergeParagraphUpdateHint(pa.eu,
pa.Ib,pa.length,ha.eu,ha.Ib,pa.eu,ha.Ib));ha.MLa=pa.length;ha.HTb.remove(ha.eu);ha.eu=pa.eu}deleteText(oa,ha,pa){let Ea=!1;if(0<oa.updateHints.length&&2===oa.updateHints.Ye(oa.updateHints.length-1).type){const Fa=oa.updateHints.Ye(oa.updateHints.length-1);Fa.qf.equals(ha.eu)&&Fa.cp===ha.MLa&&(Fa.cp=ha.MLa-1,Fa.text=pa.character.toString()+Fa.text,Ea=!0)}Ea||oa.updateHints.add(new F.DeleteTextUpdateHint(ha.eu,ha.MLa-1,pa.character.toString()));--ha.MLa}Wrk(oa,ha,pa){let Ea=!1;if(0<oa.length&&8===oa.Ye(oa.length-
1).type){const Fa=oa.Ye(oa.length-1);Fa.cp===ha+1&&(Fa.text=pa.character.toString()+Fa.text,--Fa.cp,Ea=!0)}Ea||oa.add(new E.a(ha,pa.character.toString()))}MIk(oa,ha,pa,Ea){for(;0<=Ea;){var Fa=ha.J(pa.J(Ea));if(0!==Fa.type)break;if(Fa.eu.equals(oa))return Fa;Ea--}return null}}Object(G.a)(ia,"LCSUpdateHintGenerator",null,[])},1585:function(G,P,b){b.r(P);G=b(0);var k=b(17),f=b(6),x=b(143),u=b(366),w=b(574),r=b(202),m=b(51),l=b(41),z=b(1670),F=b(1343);class L extends F.a{constructor(){super()}get gca(){return"ChildNodeListMerge"}}
Object(G.a)(L,"ChildNodeListMergeFailureDetail",F.a,[]);class E{WNa(aa,ja,Ba){return ja.ax(aa,Ba.J(aa))}dRi(aa,ja,Ba,la){let ia;return({value:ia}=ja.Ab(aa)).returnValue||({value:ia}=Ba.Ab(aa)).returnValue?ia:la.J(aa)}}Object(G.a)(E,"ChildNodeListMergeUtils",null,[1939]);var A=b(1375),M=b(1602),Q=b(1453);class R{constructor(aa,ja){this.classId=aa;this.WIn=ja}}Object(G.a)(R,"NodeChildrenTransformation",null,[]);var K=b(724),J=b(1361);class O{constructor(aa,ja,Ba){this.bC=aa;this.Xea=Ba;this.c0=ja}wVd(aa){let ja,
Ba;return({Eki:ja}=this.iRi(this.Xea,aa)).returnValue&&ja.GO||({Eki:Ba}=this.iRi(this.c0,aa)).returnValue&&Ba.GO}iRi(aa,ja){let Ba;return{returnValue:({value:Ba}=(new J.a(this.bC,aa)).L9.Ab(K.a.Ha(ja))).returnValue,Eki:Ba}}}Object(G.a)(O,"NodeTriplet",null,[]);var N=b(1547);class V{constructor(aa,ja,Ba){this.Rc=aa;this.Hf=ja;this.iU=Ba;this.qHg=!0}get vm(){return this.Rc}get Bc(){return this.Hf}get gfa(){return this.iU}get success(){return this.qHg}xal(){x.a.instance.ua(4220310,1,4,"Evaluating ParentObjects");
const aa=new u.a;this.BNe(aa,ja=>this.vm.runtime.Ci.J(ja));this.BNe(aa,ja=>this.gfa.WNa(ja,this.vm.runtime.xr,this.vm.runtime.Ci));this.BNe(aa,ja=>this.gfa.WNa(ja,this.vm.runtime.So,this.vm.runtime.Ci));return aa}BNe(aa,ja){const Ba=ja(b(1585).ChildNodeListMerge.iTd);this.Bc.getPropertyObjectIds(Ba,k.a.ge).forEach(la=>{this.Bc.getPropertyObjectIds(ja(la),k.a.ge).forEach(ia=>{aa.Ja(ia)&&!la.equals(aa.J(ia))&&(this.qHg=!1,x.a.instance.ua(4220311,1,1,"OutlineGroup {0} should have parent {1} but instead has a different parent {2}.",
ia,la,aa.J(ia)));aa.Z(ia,la);return!0});return!0})}}Object(G.a)(V,"OutlineGroupParentFinder",null,[]);var W=b(1344),ca=b(1401),H=b(1454);b.d(P,"ChildNodeListMerge",function(){return Z});class Z{constructor(aa,ja=null,Ba=null,la=null,ia=null){this.Hf=aa;this.oym=ja||M.a.CRi;this.GPd=Ba||this.I8k();this.gfa=la||new E;this.e5h=ia||this.U6k()}get Bc(){return this.Hf}d9l(aa){null==Z.Tre&&(aa.runtime.Ua.ks(z.a.qqf),Z.Tre=aa.runtime.Ua.isFeatureEnabled(z.a.qqf));return Z.Tre}I8k(){return[new R(393227,Object(l.a)(this,
this.cxm,"pageContentNodeThreewayChildMerge")),new R(1073872968,Object(l.a)(this,this.nZn,"wordSectionNodeThreewayChildMerge")),new R(393241,Object(l.a)(this,this.aTd,"outlineElementContainerThreewayChildMerge")),new R(393252,Object(l.a)(this,this.kAn,"tableCellThreewayChildMergev2")),new R(1074135125,Object(l.a)(this,this.aTd,"outlineElementContainerThreewayChildMerge")),new R(1074135123,Object(l.a)(this,this.aTd,"outlineElementContainerThreewayChildMerge")),new R(1074135127,Object(l.a)(this,this.aTd,
"outlineElementContainerThreewayChildMerge"))]}U6k(){return[Object(l.a)(this,this.QDm,"prepareObjectGroupings"),Object(l.a)(this,this.Qpl,"handleInterOutlineGroupMerge"),Object(l.a)(this,this.zAm,"performThreewayChildMerge")]}Ecm(aa){let ja=0;for(;ja<this.e5h.length;ja++)if(!(0,this.e5h[ja])(aa))return x.a.instance.ua(4273296,1,3,"MergeChildNodeLists: Merged failed. [Function: {0}]",ja),aa.logger.iNd("ChildNodeListMerge.GetMergeChildNodeListsFunctions()",ja),!1;return!0}QDm(aa){const ja=new u.a,Ba=
new u.a,la=new w.a;aa.runtime.xr.forEach((ia,oa)=>Z.Jgi(oa,ja));aa.runtime.So.forEach((ia,oa)=>Z.Jgi(oa,Ba));for(let ia=0;ia<this.GPd.length;ia++){const oa=this.GPd[ia].classId;aa.runtime.zeb.Z(oa,new u.a);ja.Ja(oa)&&ja.J(oa).forEach(ha=>{var pa=aa.runtime.Ci.J(ha.id);pa&&(pa=new O(pa,ha,aa.runtime.So.ax(ha.id,pa)),aa.runtime.zeb.J(oa).add(ha.id,pa),la.add(ha.id));return!0});Ba.Ja(oa)&&Ba.J(oa).forEach(ha=>{if(la.contains(ha.id))return!0;const pa=aa.runtime.Ci.J(ha.id);pa&&aa.runtime.zeb.J(oa).add(ha.id,
new O(pa,pa,ha));return!0})}aa.runtime.MC("PrepareObjectGroupings");aa.logger.lda("PrepareObjectGroupings");return!0}zAm(aa){let ja=!0;for(let Ba=0;ja&&Ba<this.GPd.length;Ba++){const la=this.GPd[Ba];aa.runtime.MC("Before function#"+Ba);const ia=la.classId;aa.runtime.zeb.J(ia).forEach((oa,ha)=>{aa.runtime.oHa.contains(ha.bC.id)||(ja=la.WIn(aa,ha)&&ja);ja||(x.a.instance.ua(4273297,1,3,"PerformThreewayChildMerge: Failed. [ClassId: {0}] [BaseObject.Id: {1}]",ia,ha.bC.id),aa.logger.Cf(Object.assign(new L,
{Ph:"PerformThreewayChildMerge",eventId:"aqtsr"})));return ja});aa.runtime.MC("PerformThreewayChildMerge"+Ba)}aa.logger.lda("PerformThreewayChildMerge");return ja}cxm(aa,ja){if(ja.wVd(k.a.ge)){var Ba=this.Bc.getPropertyObjectIds(ja.bC,k.a.ge);const la=this.Bc.getPropertyObjectIds(ja.c0,k.a.ge);ja=this.Bc.getPropertyObjectIds(ja.Xea,k.a.ge);Ba=String.format("Child node count: Base={0}, Favored={1}, Unfavored={2}, GraphMergeSource={3}",Ba.length,la.length,ja.length,aa.input.source);x.a.instance.ua(4030551,
1,3,"Punting attempted merge as there appears to be an added or removed WordSection. {0}",Ba);aa.logger.Cf(Object.assign(new L,{Ph:"PageContentNodeThreewayChildMerge",eventId:"apybx",info:Ba}));return!1}return!0}nZn(aa,ja){if(ja.wVd(k.a.ge)){const Ea=new w.a,Fa=new w.a,Ga=new w.a,$a=new w.a;var Ba=this.Bc.getPropertyObjectIds(ja.bC,k.a.ge),la=Ba.yz(),ia,oa=({N7g:ia}=this.fYi(ja.c0,la,Ea,"Favored")).returnValue,ha=({N7g:pa}=this.fYi(ja.Xea,la,Fa,"Unfavored")).returnValue;if(!oa||!ha)return this.d9l(aa)&&
this.a9l(aa,ja.c0,ja.Xea),Ba=String.format("Unexpected OG node added. Base OG count: {0}. Favored OG count: {1}. Unfavored OG count: {2}. Favored OGs not found in base: {3}. Unfavored OGs not found in base: {4}.",la.count,Ea.count,Fa.count,ia,pa),aa.logger.Cf(Object.assign(new L,{Ph:"WordSectionNodeThreewayChildMerge",info:Ba})),!1;Ba.forEach(fa=>{Ea.contains(fa)||Ga.add(fa);Fa.contains(fa)||$a.add(fa);return!0});ja=ja.bC.dF();la=new r.a;for(ia=0;ia<Ba.length;ia++){var pa=Ba.Ye(ia);if(Ga.contains(pa)||
$a.contains(pa)){if(aa.runtime.oHa.add(pa),la.length&&(oa=la.Ye(la.length-1),oa=aa.runtime.zeb.J(393241).J(oa),ha=aa.runtime.zeb.J(393241).J(pa),oa&&ha))Ga.contains(pa)?$a.contains(pa)||(oa.bC=oa.bC.dF(),oa.Xea=oa.Xea.dF(),this.dmd(oa.bC,ha.bC),this.dmd(oa.Xea,ha.Xea)):(oa.bC=oa.bC.dF(),oa.c0=oa.c0.dF(),this.dmd(oa.bC,ha.bC),this.dmd(oa.c0,ha.c0))}else la.add(pa)}this.Bc.setPropertyObjectIds(ja,k.a.ge,la);Ba=new W.a(ja);Ba.Kz(k.a.ge);aa.runtime.Xk.Z(ja.id,Ba)}return!0}dmd(aa,ja){const Ba=this.Bc.getPropertyObjectIds(aa,
k.a.ge);ja=this.Bc.getPropertyObjectIds(ja,k.a.ge);const la=Ba.s1();ja.forEach(ia=>{la.add(ia);return!0});this.Bc.setPropertyObjectIds(aa,k.a.ge,la)}fYi(aa,ja,Ba,la){let ia=0,oa=!0;this.Bc.getPropertyObjectIds(aa,k.a.ge).forEach(ha=>{ja.contains(ha)?Ba.add(ha):(oa=!1,x.a.instance.ua(573912977,1,3,"VerifyWordSectionChildren {0}: Failed to find {1} in baseObjects.",la,ha),ia++);return!0});return{returnValue:oa,N7g:ia}}oca(){return(new Date).getTime()}a9l(aa,ja,Ba){var la=this.Bc.getPropertyObjectIds(ja,
k.a.ge),ia=this.Bc.getPropertyObjectIds(Ba,k.a.ge);const oa=la.yz(),ha=ia.yz(),pa=new r.a,Ea=new r.a;Ba=this.oca();ja=0;la.forEach(Ga=>{ha.contains(Ga)||pa.add(Ga);return!0});ia.forEach(Ga=>{oa.contains(Ga)||Ea.add(Ga);return!0});if(pa.length===Ea.length){for(la=0;la<pa.length;la++){ia=this.gfa.WNa(pa.J(la),aa.runtime.xr,aa.runtime.Ci);ia=this.Bc.getPropertyObjectIds(ia,k.a.ge);for(let Ga=0;Ga<Ea.length;Ga++){var Fa=void 0;let $a;Fa=this.gfa.WNa(Ea.J(Ga),aa.runtime.xr,aa.runtime.Ci);Fa=this.Bc.getPropertyObjectIds(Fa,
k.a.ge);if(({UIi:Fa,R8h:$a}=this.gak(ia,Fa)).returnValue){ja++;x.a.instance.ua(524871196,1,2,"These OG nodes are similar and have {0}% similiar child nodes for {1} total child nodes.",Math.round(100*Fa),$a);break}}aa.runtime.MC("LoggingDifferentId")}x.a.instance.ua(0,1,2,"{0}/{1} found another node with a different Id but similar children. This process took {2}",ja,pa.length+Ea.length,this.oca()-Ba)}}gak(aa,ja){const Ba=aa.length+ja.length;let la=0;const ia=aa.yz(),oa=ja.yz();aa.forEach(ha=>{oa.contains(ha)||
la++;return!0});ja.forEach(ha=>{ia.contains(ha)||la++;return!0});aa=1-la/Ba;return.5>aa?{returnValue:!1,UIi:aa,R8h:Ba}:{returnValue:!0,UIi:aa,R8h:Ba}}Qpl(aa){let ja=!0;aa.runtime.zeb.J(393241).forEach((Ba,la)=>{if(this.bNl(la)){x.a.instance.ua(4220302,1,3,"OutlineGroup {0} requires inter-OG merge.",la.bC.id);let ia;const oa=new V(aa,this.Bc,this.gfa);if(({bfi:Ba,PZi:ia}=this.sHn(aa,oa.xal(),la)).returnValue)return x.a.instance.ua(4220303,1,3,"Merging WordSection {0} as a unit.",ia),ja=oa.success&&
this.tdm(aa,ia,Ba)&&ja,ja||(x.a.instance.ua(4273299,1,2,"Inter-OG merge failed. [ObjectId: {0}] [OutlineGroupParentFinder.Success: {1}].",la.bC.id,oa.success),aa.logger.Cf(Object.assign(new L,{Ph:"HandleInterOutlineGroupMerge",eventId:"aqtst",info:String.format("Inter-OG Failure [OutlineGroupParentFinder.Success: {0}]",oa.success)}))),ja}return!0});return ja}bNl(aa){if(!aa.wVd(k.a.ge))return!1;const ja=this.Bc.getPropertyObjectIds(aa.bC,k.a.ge).J(0),Ba=this.Bc.getPropertyObjectIds(aa.c0,k.a.ge);aa=
this.Bc.getPropertyObjectIds(aa.Xea,k.a.ge);return!Ba.contains(ja,(la,ia)=>la.equals(ia))||!aa.contains(ja,(la,ia)=>la.equals(ia))}sHn(aa,ja,Ba){ja=ja.J(Ba.bC.id);x.a.instance.ua(4220304,1,3,"While inspecting OG {0}, it appears an inter-OG merge is taking place. All children of WordSection {1} will be merged as a unit.",Ba.bC.id,ja);if(aa.runtime.oHa.contains(ja))return x.a.instance.ua(4220305,1,4,"Trying to merge WordSection {0} for an inter-OG merge, but an another OG caused us to do that already. Skipping the attempt.",
ja),{returnValue:!1,bfi:null,PZi:ja};const la=new N.a;Ba=aa.runtime.Ci.J(ja);this.Bc.getPropertyObjectIds(Ba,k.a.ge).forEach(ia=>{la.bmd(ia);return!0});Ba=this.gfa.WNa(ja,aa.runtime.xr,aa.runtime.Ci);this.Bc.getPropertyObjectIds(Ba,k.a.ge).forEach(ia=>{la.emd(ia);return!0});aa=this.gfa.WNa(ja,aa.runtime.So,aa.runtime.Ci);this.Bc.getPropertyObjectIds(aa,k.a.ge).forEach(ia=>{la.jmd(ia);return!0});return{returnValue:!0,bfi:la,PZi:ja}}NEf(aa,ja,Ba,la,ia){let oa=!0;aa.forEach(ha=>{const pa=ja(ha);this.Bc.getPropertyObjectIds(pa,
k.a.ge).forEach(Ea=>{Ba.add(Ea);if(la.Ja(Ea))return(oa=la.J(Ea).equals(ha)&&oa)||x.a.instance.ua(4273300,1,2,"PreprocessRevisionOutlineGroups {0}: Failed. [OutlineElementId: {1}] [OutlineGroupId: {2}] [OutputMapping: {3}]",ia,Ea,ha,la.J(Ea)),oa;la.Z(Ea,ha);return!0});return!0});return oa}M9k(aa,ja){let Ba,la,ia,oa;Ba=new r.a;la=new r.a;ia=new r.a;oa=new u.a;const ha=aa.runtime.Ci;return this.NEf(ja.xsb,pa=>ha.J(pa),Ba,oa,"Base")&&this.NEf(ja.v1e,pa=>this.gfa.WNa(pa,aa.runtime.xr,ha),la,oa,"Favored")&&
this.NEf(ja.Vib,pa=>this.gfa.WNa(pa,aa.runtime.So,ha),ia,oa,"Unfavored")?{returnValue:!0,KVg:Ba,ukh:la,zSi:ia,c9h:oa}:{returnValue:!1,KVg:Ba,ukh:la,zSi:ia,c9h:oa}}HJk(aa,ja,Ba,la){let ia=!0;const oa=aa.runtime.Ci,ha=aa.runtime.xr,pa=aa.runtime.So,Ea=aa.runtime.Xk,Fa=new r.a,Ga=new u.a;Ba.forEach($a=>{const fa=la.J($a);if(!fa)return x.a.instance.ua(4220306,1,1,"OutlineElementId {0} does not have an OutlineGroup parent in oeToOgMapping.",$a),aa.logger.Cf(Object.assign(new L,{Ph:"FinishInterOutlineGroupMerge",
eventId:"aqgws"})),ia=!1;fa.equals(Fa.last())||(Fa.add(fa),Ga.add(fa,new r.a));Ga.J(fa).add($a);aa.runtime.oHa.add($a);return!0});if(!ia)return!1;Ga.forEach(($a,fa)=>{const sa=this.gfa.dRi($a,ha,pa,oa).dF();this.Bc.setPropertyObjectIds(sa,k.a.ge,fa);Ea.Z($a,new W.a(sa));Ea.J($a).Kz(k.a.ge);aa.runtime.oHa.add($a);return ia});Ba=this.gfa.dRi(ja,ha,pa,oa).dF();this.Bc.setPropertyObjectIds(Ba,k.a.ge,Fa);Ea.Z(ja,new W.a(Ba));Ea.J(ja).Kz(k.a.ge);aa.runtime.oHa.add(ja);return ia}tdm(aa,ja,Ba){let la,ia;
if(!({KVg:oa,ukh:la,zSi:ia,c9h:Ba}=this.M9k(aa,Ba)).returnValue)return!1;var oa=A.b(oa,la,ia);oa=this.EBf(aa,oa);return!!oa&&this.HJk(aa,ja,oa,Ba)}aTd(aa,ja){return this.Xei(aa,ja)}Xei(aa,ja){if(ja.wVd(k.a.ge)){var Ba=this.L9k(ja);Ba=this.EBf(aa,Ba);if(!Ba)return x.a.instance.ua(4220308,1,1,"OutlineElementContainerThreewayChildMerge: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ja.bC.id),aa.logger.Cf(Object.assign(new L,
{Ph:"OutlineElementContainerThreewayChildMerge",eventId:"aqgwu"})),Q.a(ja.bC,"OutlineElementContainerThreewayChildMerge_Base",1),Q.a(ja.c0,"OutlineElementContainerThreewayChildMerge_Favored",1),Q.a(ja.Xea,"OutlineElementContainerThreewayChildMerge_Unfavored",1),!1;var la=this.Bc.getPropertyObjectIds(ja.bC,k.a.ge);const ia=Ba.yz();la.forEach(oa=>{ia.contains(oa)||(oa=this.Bc.getPropertyObjectIds(ja.bC,k.a.LJ),0<oa.length&&aa.runtime.jCf.add(oa.J(0)));return!0});la=ja.c0.dF();this.Bc.setPropertyObjectIds(la,
k.a.ge,Ba);aa.runtime.Xk.Z(la.id,new W.a(la));aa.runtime.Xk.J(la.id).Kz(k.a.ge)}return!0}GAb(aa){if(!aa)return x.a.instance.ua(573957964,1,2,"Feature helper is null"),!1;aa.ks(177);return aa.isFeatureEnabled(177)}kAn(aa,ja){if(!this.GAb(aa.runtime.Ua))return this.IWf(aa,ja);var Ba=ja.bC.id,la=H.e(aa,ja.bC,null);if(la.equals(m.a.nil))return x.a.instance.ua(573957965,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",Ba),aa.logger.Cf(Object.assign(new ca.a,{info:"Table node ID could not be found for table cell"})),
!1;var ia=aa.runtime.Ctb.J(la);if(ia&&(ia=ia.J(Ba)))if(ia.lf)ja=ja.c0.dF(),ja.removeProperty(k.a.ge),this.Bc.setPropertyBool(ja,f.a.ghostCell,!0),null!=ia.colSpan?this.Bc.setPropertyUint32(ja,f.a.colSpan,ia.colSpan):ja.removeProperty(f.a.colSpan),aa.runtime.Xk.Z(ja.id,new W.a(ja)),aa.runtime.Xk.J(ja.id).Kz(k.a.ge),aa.runtime.Xk.J(ja.id).Kz(f.a.ghostCell),aa.runtime.Xk.J(ja.id).Kz(f.a.colSpan);else{let oa,ha;({Umd:la,jwd:oa,H6d:ha}=this.Y5k(aa,ja,ia,la));if(!oa.length&&!ha.length)return x.a.instance.ua(573957966,
1,2,"A non-ghost cell does not have OE nodes on either side. Table cell ID: {0}",Ba),aa.logger.Cf(Object.assign(new ca.a,{info:"A non-ghost cell does not have OE nodes on either side"})),!1;oa.length?ha.length?(Ba=A.b(la,oa,ha),Ba=this.EBf(aa,Ba)):Ba=oa:Ba=ha;if(!Ba)return x.a.instance.ua(573957920,1,1,"TableCellThreewayChildMergev2: While attempting to merge node {0}, OutlineElementCollectionsThreewayChildMerge returned null list -- rejecting the change.",ja.bC.id),aa.logger.Cf(Object.assign(new L,
{Ph:"TableCellThreewayChildMergev2",eventId:"8n426"})),Q.a(ja.bC,"TableCellThreewayChildMergev2_Base",1),Q.a(ja.c0,"TableCellThreewayChildMergev2_Favored",1),Q.a(ja.Xea,"TableCellThreewayChildMergev2_Unfavored",1),!1;ja=ja.c0.dF();this.Bc.setPropertyObjectIds(ja,k.a.ge,Ba);ja.removeProperty(f.a.ghostCell);Ba=ia.rowSpan;ia=ia.colSpan;null!=Ba&&null!=ia&&(1<Ba||1<ia)?(this.Bc.setPropertyUint32(ja,f.a.rowSpan,Ba),this.Bc.setPropertyUint32(ja,f.a.colSpan,ia)):(ja.removeProperty(f.a.rowSpan),ja.removeProperty(f.a.colSpan));
aa.runtime.Xk.Z(ja.id,new W.a(ja));aa.runtime.Xk.J(ja.id).Kz(k.a.ge);aa.runtime.Xk.J(ja.id).Kz(f.a.ghostCell);aa.runtime.Xk.J(ja.id).Kz(f.a.rowSpan);aa.runtime.Xk.J(ja.id).Kz(f.a.colSpan)}else return this.IWf(aa,ja);aa.logger.lda("TableCellThreewayChildMergev2");return!0}Y5k(aa,ja,Ba,la){let ia,oa;({Umd:ja,jwd:ia,H6d:oa}=this.auh(ja));ja||(ja=new r.a);ia||(ia=new r.a);oa||(oa=new r.a);var ha=ja.yz(),pa=ia.yz(),Ea=oa.yz(),Fa=Ba.eQd;if(Fa)for(var Ga=0;Ga<Fa.length;Ga++){var $a=Fa.J(Ga),fa=aa.runtime.Ci.J($a);
!ha.contains($a)&&fa&&(ha.add($a),ja.add($a));!pa.contains($a)&&aa.runtime.xr.ax($a,fa)&&(pa.add($a),ia.add($a));!Ea.contains($a)&&aa.runtime.So.ax($a,fa)&&(Ea.add($a),oa.add($a))}aa.logger.lda("OENodesAddedToChildrenList");if(Fa=Ba.Hbf)for(Ga=0;Ga<Fa.length;Ga++)if($a=Fa.J(Ga),fa=aa.runtime.Ci.J($a)){var sa=this.Bc.getPropertyObjectIds(fa,k.a.ge);if(sa)for(var qa=0;qa<sa.length;qa++){var va=sa.J(qa);ha.contains(va)||(ha.add(va),ja.add(va))}sa=aa.runtime.xr.ax($a,fa);if(sa=this.Bc.getPropertyObjectIds(sa,
k.a.ge))for(qa=0;qa<sa.length;qa++)va=sa.J(qa),pa.contains(va)||(pa.add(va),ia.add(va));$a=aa.runtime.So.ax($a,fa);if($a=this.Bc.getPropertyObjectIds($a,k.a.ge))for(fa=0;fa<$a.length;fa++)sa=$a.J(fa),Ea.contains(sa)||(Ea.add(sa),oa.add(sa))}aa.logger.lda("GhostCellOENodesAddedToChildrenList");if(Ba=Ba.fwf)for(ha=0;ha<Ba.length;ha++)if(pa=Ba.J(ha),pa=aa.runtime.Ctb.J(la).J(pa))if(pa=pa.eQd){pa=pa.yz();Ea=new r.a;for(Fa=0;Fa<ja.length;Fa++)pa.contains(ja.J(Fa))||Ea.add(ja.J(Fa));ja=Ea;Ea=new r.a;for(Fa=
0;Fa<ia.length;Fa++)pa.contains(ia.J(Fa))||Ea.add(ia.J(Fa));ia=Ea;Ea=new r.a;for(Fa=0;Fa<oa.length;Fa++)pa.contains(oa.J(Fa))||Ea.add(oa.J(Fa));oa=Ea}aa.logger.lda("NonGhostCellsOENodesRemovedFromChildrenList");return{Umd:ja,jwd:ia,H6d:oa}}IWf(aa,ja){let Ba=ja.c0.hasProperty(k.a.ge),la=ja.Xea.hasProperty(k.a.ge);Ba&&(Ba=!!this.Bc.getPropertyObjectIds(ja.c0,k.a.ge).length);la&&(la=!!this.Bc.getPropertyObjectIds(ja.Xea,k.a.ge).length);if(Ba!==la)if(this.nTl(aa.runtime.Ua))aa.logger.o0h(Object.assign(new ca.a,
{info:"TableCell OE missing children, ghost cell likely touched"}));else return aa.logger.Cf(Object.assign(new ca.a,{info:"TableCell OE missing children, ghost cell likely touched"})),!1;return this.Xei(aa,ja)}L9k(aa){let ja,Ba;({Umd:aa,jwd:ja,H6d:Ba}=this.auh(aa));return A.b(aa,ja,Ba)}EBf(aa,ja){x.a.instance.ua(4220309,1,4,"Considering {0} OutlineElement collections for merge.",ja.length);const Ba=new r.a;let la=!0;ja.forEach(ia=>{if(!ia)return x.a.instance.shipAssertTag(4740611,1,!1,"Mapping is null."),
aa.logger.Cf(Object.assign(new L,{Ph:"OutlineElementCollectionsThreewayChildMerge",eventId:"asfyd"})),la=!1;if(1===ia.gem&&1===ia.Crf){const sa=ia.xsb.J(0),qa=ia.v1e.J(0),va=ia.Vib.J(0);if(sa&&sa.equals(qa)&&sa.equals(va))return Ba.add(sa),!0;if(1!==ja.length)return x.a.instance.shipAssertTag(4030554,1,!1,"OutlineElementCollectionsThreewayChildMerge: A 1-1-1 mapping found which somehow contains differing objects. [Base: {0}] [Favored: {1}] [Unfavored: {2}] [Total Collections: {3}].",sa,qa,va,ja.length),
aa.logger.Cf(Object.assign(new L,{Ph:"OutlineElementCollectionsThreewayChildMerge",eventId:"apyb0"})),la=!1}const oa=new u.a,ha=new r.a,pa=new r.a,Ea=new r.a,Fa=new r.a,Ga=new r.a,$a=new r.a,fa=aa.runtime.Ci;ia.xsb.forEach(sa=>la=this.BFf(aa,sa,qa=>fa.J(qa),ha,Fa,oa,"Base"));if(!la)return x.a.instance.ua(4285026,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process base outlines."),aa.logger.Cf(Object.assign(new L,{Ph:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj8"})),
!1;ia.v1e.forEach(sa=>la=this.BFf(aa,sa,qa=>this.gfa.WNa(qa,aa.runtime.xr,fa),pa,Ga,oa,"Favored"));if(!la)return x.a.instance.ua(4285027,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process favored outlines."),aa.logger.Cf(Object.assign(new L,{Ph:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwj9"})),!1;ia.Vib.forEach(sa=>la=this.BFf(aa,sa,qa=>this.gfa.WNa(qa,aa.runtime.So,fa),Ea,$a,oa,"Unfavored"));if(!la)return x.a.instance.ua(4285056,1,3,"OutlineElementCollectionsThreewayChildMerge: Failed to process unfavored outlines."),
aa.logger.Cf(Object.assign(new L,{Ph:"OutlineElementCollectionsThreewayChildMerge",eventId:"aqwka"})),!1;aa.runtime.Ua&&aa.runtime.Ua.eyb(1000005)&&(Ga.length&&this.WFk(Ga,aa.runtime.xr)?(this.ZOg(Ga,aa,Ba,oa),this.lld(aa,oa,$a)):this.ZOg($a,aa,Ba,oa));if(ha.length){ia=null;if(!({Xk:ia}=this.oym(aa,ha,pa,Ea,ia)).returnValue||!ia)return la=!1;ia.forEach(sa=>{0<sa.gSb.count&&aa.runtime.Xk.Z(sa.ik.id,sa);Ba.add(oa.J(sa.ik.id));return!0})}return!0});return la?Ba:null}WFk(aa,ja){for(let Ba=0;Ba<aa.length;Ba++)if(ja.get(aa.Ye(Ba).id))return!0;
return!1}lld(aa,ja,Ba){Ba.length&&(Ba.forEach(la=>{aa.runtime.Pac.add(la.id);aa.runtime.Pac.add(ja.J(la.id));return!0}),M.a.lld(aa,this.Bc,Ba.J(0)))}ZOg(aa,ja,Ba,la){aa.forEach(ia=>{const oa=new W.a(ia.dF());ja.runtime.Xk.Z(ia.id,oa);Ba.add(la.J(ia.id));return!0})}BFf(aa,ja,Ba,la,ia,oa,ha){var pa=Ba(ja);if(!pa)return x.a.instance.ua(4285057,1,1,"ProcessOutlineElement {0}: Failed to find OutlineElement with [Id: {1}]",ha,ja),aa.logger.Cf(Object.assign(new L,{Ph:"ProcessOutlineElement",eventId:"aqwkb",
info:String.format("[Revision: {0}] Failed to find OutlineElement",ha)})),!1;const Ea=this.Bc.getPropertyObjectIds(pa,k.a.LJ);if(!Ea||!Ea.length)return x.a.instance.ua(4285058,1,1,"ProcessOutlineElement {0}: OutlineElement [Id: {1}] has no children.",ha,ja),aa.logger.Cf(Object.assign(new L,{Ph:"ProcessOutlineElement",eventId:"aqwkc",info:String.format("[Revision: {0}] OutlineElement has no children",ha)})),Q.a(pa,"ProcessOutlineElement_"+ha,1),!1;pa=Ea.Ye(0);Ba=Ba(pa);if(!Ba)return x.a.instance.ua(4285059,
1,1,"ProcessOutlineElement {0}: Failed to find ParagraphNode with [Id: {1}] as a child of OutlineElement with [Id: {2}]",ha,pa,ja),aa.logger.Cf(Object.assign(new L,{Ph:"ProcessOutlineElement",eventId:"aqwkd",info:String.format("[Revision: {0}] Failed to find correct ParagraphNode in OutlineElement",ha)})),!1;if((ha=this.Bc.getPropertyString(Ba,f.a.ZK))&&""!==ha&&aa.runtime.Ua&&(aa.runtime.Ua.Vbf(1000005),aa.runtime.Ua.eyb(1000005)))return ia.add(Ba),oa.add(pa,ja),aa.runtime.oHa.add(pa),!0;la.add(Ba);
oa.add(pa,ja);aa.runtime.oHa.add(pa);return!0}auh(aa){let ja,Ba;ja=this.Bc.getPropertyObjectIds(aa.bC,k.a.ge);Ba=this.Bc.getPropertyObjectIds(aa.c0,k.a.ge);aa=this.Bc.getPropertyObjectIds(aa.Xea,k.a.ge);return{Umd:ja,jwd:Ba,H6d:aa}}nTl(aa){if(!aa)return x.a.instance.ua(51422868,1,2,"Feature Helper is null"),!1;aa.ks(175);return aa.isFeatureEnabled(175)}static Jgi(aa,ja){ja.Ja(aa.Gb)||ja.Z(aa.Gb,new r.a);ja.J(aa.Gb).add(aa);return!0}}Z.iTd=m.a.Ee("{4215CA2B-DF37-4aaa-89ED-F1646178CD20}{1}");Z.Tre=
null;Object(G.a)(Z,"ChildNodeListMerge",null,[1867])},1586:function(G,P,b){G=b(0);var k=b(1301),f=b(1447),x=b(1362),u=b(1325),w=b(1378);class r{constructor(Z,aa){this.DimensionValue=this.DimensionName=null;this.DimensionName=Z;this.DimensionValue=aa}}Object(G.a)(r,"Dimension",null,[]);class m{constructor(Z,aa,ja,Ba,la){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=Z;this.Query=aa;this.From=ja;this.Size=Ba;la&&(this.Filter=la)}}Object(G.a)(m,"EntityRequest",
null,[]);class l{constructor(Z){this.QueryString=null;this.QueryString=Z}}Object(G.a)(l,"Query",null,[]);var z=b(1302);class F{constructor(Z,aa){this.Dimensions=this.Name=null;this.Name=Z;this.Dimensions=aa}}Object(G.a)(F,"Scenario",null,[]);var L=b(1309),E=b(1308);class A{constructor(Z,aa,ja,Ba){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=Z;this.TimeZone=aa;this.Cvid=ja;this.Scenario=Ba}}Object(G.a)(A,"SubstrateBody",null,[]);var M=b(1377),Q=b(1297),R=b(1296),
K=b(2),J=b(1531),O=b(1530),N=b(1374),V=b(31),W=b(16),ca=b(133);b.d(P,"a",function(){return H});class H{constructor(Z){this.ooc=this.H6a=this.sbd=this.bjc=this.cpc=0;this.swg=this.kAg=this.uN=null;this.Jnb=0;this.AZ=-1;this.Orc="";this.Qe=K.AFrameworkApplication.fe;this.wb=Z;this.kCe=this.phl();this.Hze=new f.a;this.Dug=this.wb.X5d?3:2;this.lIg=this.wb.X5d&&this.wb.eIi?5:3;this.SLg=this.wb.I1d?2:3;this.TLg=1;this.Cad=this.wb.czh;this.zGg=this.wb.zSl;this.dqc=Z.UCh;K.AFrameworkApplication.K&&(this.kAg=
K.AFrameworkApplication.K.Ga("AppCatalogUrl")+K.AFrameworkApplication.K.Ga("SearchPersonaPhotoBaseUrl"))}sO(){return"Substrate"}u0(){return 0===this.wb.rw?0:1===this.wb.rw?1:3}qK(Z,aa,ja,Ba=k.a.tellMe,la=null){const ia=new E.a(Z);if(!la||Array.contains(la,14)||Array.contains(la,15)||Array.contains(la,20))if(!this.Jnb||window.performance.now()-this.Jnb>=R.a.B5d)if(ja=this.Hze.xDh())this.Jnb=window.performance.now(),ja.then(oa=>{oa&&""!==oa?(this.Orc=oa,""!==this.uN&&this.wDh(Z,Ba,this.Orc,aa,la)):
(Q.TellMeActor.instance.Pd.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),aa.resultsUpdated(ia))},oa=>{Q.TellMeActor.instance.Pd.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+oa);aa.resultsUpdated(ia)});else{if(Q.TellMeActor.instance.Pd)Q.TellMeActor.instance.Pd.onError("SubstrateResultsProvider:IssueQuery","undefined token promise");aa.resultsUpdated(ia)}else this.Orc&&""!==this.Orc?this.wDh(Z,Ba,this.Orc,aa,la):(aa.resultsUpdated(ia),
Q.TellMeActor.instance.Pd.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else aa.resultsUpdated(ia)}j9b(){this.H6a=this.ooc=this.sbd=this.bjc=this.cpc=0}wDh(Z,aa,ja,Ba,la){this.j9b();const ia=new E.a(Z),oa=this.uN=ca.a.create().toString();this.Rwa();this.AZ=window.setTimeout(()=>{if(oa===this.uN){this.uN="";this.AZ=-1;Ba.resultsUpdated(ia);const Ea={};Ea[x.a.provider]=this.sO();Ea[x.a.hEb]=Z.Xfb;Q.TellMeActor.instance.Pd.jA(u.a.timedOut,this.dqc,Ea)}},this.dqc);const ha=
{"Content-Type":"application/json",Accept:"application/json"};ha.Authorization="Bearer "+ja;ha["X-Office-Version"]=K.AFrameworkApplication.buildVersion;ha["X-Office-Application"]=K.AFrameworkApplication.K.Ga("Application");ha["X-Office-Platform"]="WAC";ha["X-TellMe-SessionId"]=Q.TellMeActor.instance.BCd();ha["X-TellMe-Culture"]=K.AFrameworkApplication.uiCulture;ha["X-TellMe-ProcessSessionId"]=K.AFrameworkApplication.userSessionId;ha["Client-Request-Id"]=oa;const pa=window.performance.now();this.Qe.ai(this.ihl(),
2,this.jhl(Z.Ef,this.wb.application,Q.TellMeActor.instance.BCd(),R.a.IX(Z)),ha,!1,0,Ea=>{this.eDb(Ea,Z,Ba,oa,pa,aa,la)},Ea=>{this.QCb(Ea,Z,Ba,oa,pa)},null,null,!1,4E3,6E3)}Rwa(){-1!==this.AZ&&(window.clearTimeout(this.AZ),this.AZ=-1)}eDb(Z,aa,ja,Ba,la,ia,oa){Q.TellMeActor.instance.Pd.N4(aa.Ef.length,this.kCe.join(","),Z.data.we.toString(),Math.round(window.performance.now()-la),M.a.substrate,!0,w.a.DJa);const ha=R.a.IX(aa),pa=new E.a(aa);if(Ba===this.uN){this.Rwa();Z=V.b(Z.data.qd);if(Z.Groups){Z=
Z.Groups;for(const Ea of Z)"People"===Ea.Type&&this.wb.bYc&&(oa?Array.contains(oa,14):1)?(Z=this.lAh(Ea.Suggestions,ha,ia),0<Z.results.length&&pa.kw(Z)):"File"===Ea.Type&&this.wb.$Xc&&(oa?Array.contains(oa,15):1)?(Z=this.Duh(Ea.Suggestions,ha,ia),0<Z.results.length&&pa.kw(Z)):"Notes"===Ea.Type&&this.wb.ldb&&ia!==k.a.contextMenu&&(oa?Array.contains(oa,20):1)&&(Z=this.Zyh(Ea.Suggestions,ha,aa),0<Z.results.length&&pa.kw(Z))}ja.resultsUpdated(pa);Q.TellMeActor.instance.Pd.N4(aa.Ef.length,this.kCe.join(","),
"",Math.round(window.performance.now()-la),"",!0,w.a.provider)}else ja.resultsUpdated(pa)}Zyh(Z,aa,ja){const Ba=new L.a(20);Ba.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const la of Z)this.QUl(la)&&(Z=la.NotesType,Z=W.a.kg(Z),Z=this.U8k(Z,la.LastModifiedTime,la.BodyPreview,la.Subject,aa,ja,la))&&(Z.groupType=20,Ba.Xw(Z));return Ba}lAh(Z,aa,ja){const Ba=new L.a(14);Ba.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const ia of Z)if(this.RUl(ia)){var la=ia.Id.split("@")[0];
Z=ia.EmailAddresses[0];let oa=ia.Type;if(void 0===oa||null===oa)oa="User";if(la=this.Jal(oa,ia.DisplayName,ia.JobTitle,Z,la,ja,aa))la.description=Z,Z=ia.JobTitle,"Department"in ia&&"CompanyName"in ia&&(Z+="@"+ia.Department+"@"+ia.CompanyName),la.qG=Z,Ba.Xw(la)}return Ba}Duh(Z,aa,ja){const Ba=new L.a(15);Ba.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const oa of Z)if(this.GUl(oa)){var la=oa.FileName;Z=oa.FileExtension;const ha=la.length>Z.length?la.substr(0,la.length-Z.length-1):oa.Title;
var ia=void 0;Z=0;"DateCreated"in oa?(Z=R.a.Vaf(oa.DateCreated),ia=R.a.KEh(oa.DateCreated),ia=String.format(CommonUIStrings.l_CreatedTimeFormatString,oa.Author,ia)):ia=oa.Author;const pa=oa.AccessUrl+"?web=1",Ea=W.a.DGc(pa);la=String.format('<a href="{0}">{1}</a>',Ea,W.a.yX(la));if(ja!==k.a.contextMenu||W.a.OX(pa))if(la=this.b0k(ha,ja===k.a.contextMenu?la:pa,ia,oa.FileExtension,oa.Text,aa))la.description=oa.Author,la.Kld=Z,Ba.Xw(la)}return Ba}QCb(Z,aa,ja,Ba,la){Ba===this.uN&&(this.Rwa(),Q.TellMeActor.instance.Pd.N4(aa.Ef.length,
this.kCe.join(","),Z.data.we.toString(),Math.round(window.performance.now()-la),M.a.substrate,!1,w.a.DJa));Z=new E.a(aa);ja.resultsUpdated(Z)}Jal(Z,aa,ja,Ba,la,ia,oa){oa=oa?this.TLg:this.Dug;if(!window.LPC&&!R.a.qif()||this.cpc===oa)return null;this.cpc+=1;oa="PeopleSuggestion"+this.cpc.toString();var ha=this.kAg+"?size=1&accountName="+Ba;Z=Object.assign(new J.a,{PersonaType:Z,Smtp:Ba,ProfilePictureUrl:ha,AadObjectId:la});const pa=Object.assign(new O.a,{identifiers:Z,displayName:aa});Z=ia===k.a.contextMenu;
this.wb.uWa?(Q.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(oa,pa,aa,ja)),ia===k.a.contextMenu&&(ja=R.a.v$g(aa,Ba,la),Q.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(oa,ja))),Q.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(oa,Z))):(ha=[],ha.push(appChrome.actions.setPersonaButtonCoauthor(oa,pa,aa,ja)),ia===k.a.contextMenu&&(ja=R.a.v$g(aa,Ba,la),ha.push(appChrome.actions.setButtonCommandValueId(oa,
ja))),ha.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(oa,Z)),appChrome.api.dispatch(ha));return new z.a(oa,11,aa,Ba,0)}U8k(Z,aa,ja,Ba,la,ia,oa){if(la&&!this.wb.xXh||this.sbd===this.Cad||this.ooc===this.Cad||this.H6a===this.Cad)return null;var ha=null;this.sbd+=1;la="";const pa=[],Ea={};oa.type="Notes";this.swg=Object.assign(new N.a,{landingTab:"Notes",data:oa});ia=R.a.hUa(ia.Ef,33,this.swg);if("onenotepagepreviews"===Z){if(!("ClickthroughUrl"in oa&&oa.ClickthroughUrl)||""===oa.ClickthroughUrl)return null;
this.ooc+=1;la="OnenoteNotesSuggestion"+this.ooc.toString();Ea["default"]="SaveAsonetoc2_20";ha=oa.ClickthroughUrl;pa.push(appChrome.actions.setControlIconSet(la,Ea));pa.push(appChrome.actions.setCompoundButtonCommandValueId(la,ha));ha=new z.a(la,19,null,null,0)}else if("stickynote"===Z){if(!this.zGg)return null;this.H6a+=1;la="NotesSuggestion"+this.H6a.toString();Ea["default"]="ShowAllNotes_20";pa.push(appChrome.actions.setControlIconSet(la,Ea));pa.push(appChrome.actions.setCompoundButtonCommandValueId(la,
ia));ha=new z.a(la,21,null,null,0)}else if("samsung"===Z){if(!this.zGg)return null;this.H6a+=1;la="NotesSuggestion"+this.H6a.toString();Ea["default"]="CategoryCollapsed_20";pa.push(appChrome.actions.setControlIconSet(la,Ea));pa.push(appChrome.actions.setCompoundButtonCommandValueId(la,ia));ha=new z.a(la,20,null,null,0)}""!==la&&(Z=R.a.KEh(aa),Z=String.format(CommonUIStrings.l_LastModifiedString,Z),ha.label=Ba,ha.Kld=R.a.Vaf(aa),pa.push(appChrome.actions.setControlLabel(la,Ba)),pa.push(appChrome.actions.updateCompoundButtonDescription(la,
Z)),pa.push(appChrome.actions.setControlCustomTooltip(la,ja)),appChrome.api.dispatch(pa));return ha}b0k(Z,aa,ja,Ba,la,ia){if(this.bjc===(ia?this.SLg:this.lIg))return null;this.bjc+=1;ia="FileSuggestion"+this.bjc.toString();const oa=[],ha={};ha["default"]=R.a.a3k(Ba);this.wb.uWa?(Q.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ia,Z)),Q.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ia,ha)),Q.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ia,
ja)),Q.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ia,aa)),Q.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ia,la))):(oa.push(appChrome.actions.setControlLabel(ia,Z)),oa.push(appChrome.actions.setControlIconSet(ia,ha)),oa.push(appChrome.actions.updateCompoundButtonDescription(ia,ja)),oa.push(appChrome.actions.setCompoundButtonCommandValueId(ia,aa)),oa.push(appChrome.actions.setControlCustomTooltip(ia,la)),appChrome.api.dispatch(oa));
return new z.a(ia,6,Z,ja,0)}phl(){const Z=[];this.wb.bYc&&Array.add(Z,"People");this.wb.$Xc&&Array.add(Z,"File");this.wb.ldb&&Array.add(Z,"Notes");return Z}jhl(Z,aa,ja,Ba){var la=new l(Z);Z=new m("File",la,0,Ba?this.SLg:this.lIg,null);Ba=new m("People",la,0,Ba?this.TLg:this.Dug,R.a.jAm);la=new m("Notes",la,0,this.Cad,null);aa=new r("app",aa.toLowerCase());var ia=[];Array.add(ia,aa);aa=new F("tellmesearch",ia);ia=[];this.wb.$Xc&&Array.add(ia,Z);this.wb.bYc&&Array.add(ia,Ba);this.wb.ldb&&Array.add(ia,
la);ja=new A(ia,"UTC",ja,aa);return V.c(ja)}ihl(){let Z=this.wb.Dyn;this.wb.ldb&&(Z+="?&setflight=NotesFrom3S");""!==this.wb.yDh&&(Z=Z+"&"+this.wb.yDh);return Z}RUl(Z){return"DisplayName"in Z&&"Id"in Z&&"EmailAddresses"in Z&&!!Z.Id&&!!Z.EmailAddresses}GUl(Z){return"FileExtension"in Z&&!!Z.FileExtension&&"FileName"in Z&&!!Z.FileName&&""!==Z.FileName&&"AccessUrl"in Z&&!!Z.AccessUrl&&""!==Z.AccessUrl}QUl(Z){return"Id"in Z&&!!Z.Id&&"NotesType"in Z&&!!Z.NotesType&&"Subject"in Z&&!!Z.Subject&&""!==Z.Subject}}
Object(G.a)(H,"SubstrateResultsProvider",null,[1042])},1587:function(G,P,b){G=b(0);var k=b(155),f=b(6),x=b(17),u=b(143),w=b(79),r=b(145),m=b(202),l=b(574),z=b(51),F=b(366),L=b(2),E=b(1258),A=b(690);class M{constructor(ha,pa=0){this.TTe=null;this.TCf=0;this.xK=ha;this.$cm=pa}}Object(G.a)(M,"GraphMergerResponse",null,[]);var Q=b(41),R=b(1),K=b(295),J=b(648),O=b(1343),N=b(1398);class V extends N.a{constructor(){super();this.vKi=null;this.$Yi=!1}get gca(){return"Crash"}Wwb(){this.detail.Z("Type",this.gca);
this.detail.Z("Trace",this.SGn(this.vKi));this.detail.Z("Continue",this.$Yi);return this.detail}SGn(ha){ha=ha.split("\n");const pa=4<ha.length?4:ha.length,Ea=new Sys.StringBuilder;for(let Fa=0;Fa<pa;Fa++)Fa===pa-1?Ea.append(String.format("{0}...",ha[Fa])):Ea.append(String.format("{0}\n",ha[Fa]));return Ea.toString()}}Object(G.a)(V,"CrashMergeFailureDetail",N.a,[]);var W=b(1732),ca=b(1361),H=b(1463),Z=b(1344),aa=b(1546);class ja{constructor(){this.jUj=new F.a;this.x$j=new F.a;this.Kck=new F.a}}Object(G.a)(ja,
"RangeMarkers",null,[]);class Ba{constructor(){this.colSpan=this.rowSpan=null;this.lf=!1;this.gke=new m.a;this.ute=new m.a;this.Ote=new m.a}get Hbf(){return this.gke.s1()}set Hbf(ha){ha||(this.gke=new m.a);this.gke=ha.s1()}get fwf(){return this.ute.s1()}set fwf(ha){ha||(this.ute=new m.a);this.ute=ha.s1()}get eQd(){return this.Ote.s1()}set eQd(ha){ha||(this.Ote=new m.a);this.Ote=ha.s1()}}Object(G.a)(Ba,"TableCellStructureInfo",null,[]);var la=b(1401),ia=b(1454);b.d(P,"a",function(){return oa});class oa{constructor(){this.nDd=
0;this.Fkg=this.r4a=this.ZOb=this.Hf=this.lDg=this.zQb=null;this.Bug=0;this.nrg=50;this.Uga=this.dig=this.Kbg=null}get vvi(){return this.zQb}get M4m(){return this.lDg}get Bc(){return this.Hf}get eeb(){return this.ZOb}get UGh(){return this.r4a}get wnl(){return this.Fkg}get o5b(){return this.Bug}get G1g(){return this.Kbg}get rBc(){return this.dig}Fmf(ha){null==this.Uga&&(ha?(ha.ks(34),this.Uga=ha.isFeatureEnabled(34)):(this.Uga=!1,u.a.instance.ua(528761236,1,2,"Feature helper is null")));return this.Uga}u5b(ha,
pa,Ea,Fa,Ga,$a,fa){Ea=this.Bjk(ha,pa,Fa,Ga,$a,fa,this.rBc);Fa=0;const sa=Ea.runtime.M1d;let qa=null;try{this.o5l(sa,Ea,fa,ha,pa,Ga,$a);for(ha=1;Fa<this.eeb.length;Fa++)if(!(0,this.eeb[Fa])(Ea)){ha=2;Ea.logger.iNd("GraphMerger.GetMergeFunctions()",Fa);break}return qa=new M(Ea.output.xK,ha)}catch(va){const Ca=!Ea.output.timeout;Ea.output.crash=Ca;const ta=this.wzd(va),Wa=String.format("Merge {0}! [MergeId: {1}] Failing the merge. [Will continue: {2}] [{3}]",Ca?"Crashed":"Timed Out",Ea.input.YBb,!!Ea.output.xK,
ta);Ca?(u.a.instance.ua(4051608,1,1,"MergeChanges Crash. [Error: {0}]",Wa),Ea.logger.Cf(Object.assign(new V,{vKi:ta,$Yi:!!Ea.output.xK}))):u.a.instance.ua(4993346,1,2,"MergeChanges Timeout. [Error: {0}]",Wa);if(Ea.output.xK)return qa=new M(Ea.output.xK,2);throw va;}finally{Ea.output.succeeded?this.l5l(sa,Ea,Fa):Ea.output.timeout?this.n5l(Ea,Fa):Ea.output.crash?Ea.output.xK?this.m5l(Ea,Fa):this.k5l(Ea,Fa):this.j5l(Ea,Fa);Ea.logger.i5l();u.a.instance.Uea(42350232,1,Ea.output.succeeded?3:2,"MergeLogger",
Ea.logger.X6k());Ea.logger.JMc.HIh()&&u.a.instance.Uea(559015903,1,2,"MarkerInfo",Ea.logger.JMc.toString());if(Ea.runtime.Ua&&Ea.runtime.Ua.isFeatureEnabled(120))try{this.k2l(Ea)}catch(va){u.a.instance.ua(571619421,1,3,"Error logging references: {0}",va.toString())}this.T6l(Ea);qa.TCf|=(Ea.output.succeeded?2:1)<<2*(fa-1);if(qa)try{qa.TTe=this.yDm(Ea)}catch(va){u.a.instance.shipAssertTag(51663492,1,!1,"Failed to create merge report {0}",va)}}}T6l(ha){if(!ha.output.succeeded){ha=ha.output.timeout?"Timeout":
ha.logger.Nki?ha.logger.Nki.gca:"Unknown";const pa=new K.a;w.Health.instance.recordQosError(ha,["MergeFailure"],!0,!0,!1,!1,pa)}}k2l(ha){const pa=Ga=>{const $a=this.oca()-ha.input.tNa>this.o5b;if(0<this.o5b&&$a)throw u.a.instance.ua(571619422,1,2,"Timed out while calculating added and deleted nodes: {0}",Ga),r.a.invalidOperation(Ga);};let Ea=ha.runtime.xr.keys,Fa=Ga=>ha.runtime.xr.J(Ga);this.xpf(ha,pa,Ea,Fa,"Favored");Ea=ha.runtime.So.keys;Fa=Ga=>ha.runtime.So.J(Ga);this.xpf(ha,pa,Ea,Fa,"Unfavored");
Ea=ha.runtime.Xk.keys;Fa=Ga=>{const $a=ha.runtime.Xk.J(Ga);return $a?$a.ik:ha.runtime.xr.J(Ga)};this.xpf(ha,pa,Ea,Fa,"Merged")}xpf(ha,pa,Ea,Fa,Ga){var $a=new m.a;const fa=new m.a;for(let sa=0;sa<Ea.length;sa++){pa("LogAddedAndDeletedNodes");const qa=Fa(Ea.J(sa));if(4325465===qa.Gb)continue;const va=ha.runtime.Ci.J(qa.id);va&&this.l2l($a,fa,qa,va)}this.k1h(fa,sa=>ha.runtime.Ci.J(sa),pa);this.k1h($a,Fa,pa);pa=new Sys.StringBuilder;for(Ea=0;Ea<$a.length;Ea++)pa.append($a.J(Ea).toString()+",");$a=new Sys.StringBuilder;
for(Ea=0;Ea<fa.length;Ea++)$a.append(fa.J(Ea).toString()+",");u.a.instance.Uea(571619423,1,3,Ga+" revision: Added references",pa.toString());u.a.instance.Uea(571619424,1,3,Ga+" revision: Deleted references",$a.toString())}l2l(ha,pa,Ea,Fa){const Ga=Ea.zi();for(let fa=0;fa<Ga.length;fa++){const sa=Ga[fa];if(this.JPh(sa)){var $a=this.Bc.getPropertyObjectIds(Ea,sa);this.f4l(ha,pa,Fa,sa,$a)}else this.DUh(sa)&&($a=this.Bc.getPropertyObjectId(Ea,sa),this.e4l(ha,pa,Fa,sa,$a))}}k1h(ha,pa,Ea){Ea("LogNestedReferences");
Ea=new m.a;const Fa=new l.a;for(let Ga=0;Ga<ha.length;Ga++){const $a=ha.J(Ga);this.Ypf($a,Ea,Fa,pa)}for(pa=0;pa<Ea.length;pa++)ha.add(Ea.J(pa))}Ypf(ha,pa,Ea,Fa){const Ga=Fa(ha);if(Ga){const fa=Ga.zi();for(let sa=0;sa<fa.length;sa++){var $a=fa[sa];if(this.JPh($a)){$a=this.Bc.getPropertyObjectIds(Ga,$a);for(let qa=0;qa<$a.length;qa++)Ea.contains($a.J(qa))||(pa.add($a.J(qa)),Ea.add($a.J(qa)),this.Ypf($a.J(qa),pa,Ea,Fa))}else this.DUh($a)&&($a=this.Bc.getPropertyObjectId(Ga,$a),Ea.contains($a)||(pa.add($a),
Ea.add($a),this.Ypf(ha,pa,Ea,Fa)))}}}f4l(ha,pa,Ea,Fa,Ga){if(this.Bc.hasProperty(Ea,Fa)){Ea=this.Bc.getPropertyObjectIds(Ea,Fa);const $a=Ea.yz();Fa=Ga.yz();for(let fa=0;fa<Ga.length;fa++)$a.contains(Ga.J(fa))||ha.add(Ga.J(fa));for(ha=0;ha<Ea.length;ha++)Fa.contains(Ea.J(ha))||pa.add(Ea.J(ha))}else for(pa=0;pa<Ga.length;pa++)ha.add(Ga.J(pa))}e4l(ha,pa,Ea,Fa,Ga){Ga&&(this.Bc.hasProperty(Ea,Fa)?(Ea=this.Bc.getPropertyObjectId(Ea,Fa),Ga.equals(Ea)||(ha.add(Ga),pa.add(Ea))):ha.add(Ga))}h5l(ha){u.a.instance.ua(4535064,
1,3,"Sending merge backup. [MergeId: {0}] [Crash: {1}] [Timeout: {2}]",ha.input.YBb,ha.output.crash,ha.output.timeout)}o5l(ha,pa,Ea,Fa,Ga,$a,fa){if(ha){ha=Fa.length?Fa.Ye(Fa.length-1):null;var sa=Ga.length?Ga.Ye(Ga.length-1):null;Ea=String.format("MergeChanges: Begin. [MergeId: {0}] [TheirChanges - Length:{1} Last:{2} Base:{3}] [YourChanges - Length:{4} Last:{5} Base:{6}] [MergeHint: {7}] [IgnoreConflictsInLastServerRevision: {8}] [MaxMergeTimeInMs: {9}] [Source: {10}]",pa.input.YBb,Fa.length,ha?
ha.id:z.a.nil,ha?ha.A_?ha.A_.id:z.a.nil:z.a.nil,Ga.length,sa?sa.id:z.a.nil,sa?sa.A_?sa.A_.id:z.a.nil:z.a.nil,$a,fa,this.o5b,Ea);switch(pa.input.source){case 5:u.a.instance.ua(51663493,1,3,Ea);break;default:u.a.instance.ua(4051606,1,3,Ea)}}}l5l(ha,pa,Ea){if(ha)switch(ha=this.oDc(pa,Ea,"Succeeded"),pa.input.source){case 5:u.a.instance.ua(51663494,1,3,ha);break;default:u.a.instance.ua(4059162,1,3,ha)}}n5l(ha,pa){pa=this.oDc(ha,pa,"Timeout");switch(ha.input.source){case 5:u.a.instance.ua(51663495,1,3,
pa);break;default:u.a.instance.ua(4059163,1,2,pa)}}j5l(ha,pa){pa=this.oDc(ha,pa,"Rejection");switch(ha.input.source){case 5:u.a.instance.ua(51663496,1,3,pa);break;default:u.a.instance.ua(4059164,1,2,pa)}}m5l(ha,pa){pa=this.oDc(ha,pa,"Crash - Rejection");switch(ha.input.source){case 5:u.a.instance.ua(51663497,1,3,pa);break;default:u.a.instance.ua(4059165,1,2,pa)}}k5l(ha,pa){pa=this.oDc(ha,pa,"Crash - Failed");switch(ha.input.source){case 5:u.a.instance.ua(51663498,1,3,pa);break;default:u.a.instance.ua(4059166,
1,2,pa)}}oDc(ha,pa,Ea){const Fa=ha.output.xK,Ga=Fa&&Fa.length?Fa.Ye(Fa.length-1):null;return String.format("MergeChanges: End for [MergeId: {0}] with result {1}. [ElapsedTime: {2}ms] [Function: {3}] [MergedRevisions - Length:{4} Last:{5} Base:{6}] [Source: {7}]",ha.input.YBb,Ea,this.oca()-ha.input.tNa,pa,Fa?Fa.length:0,Ga?Ga.id:z.a.nil,Ga?Ga.A_?Ga.A_.id:z.a.nil:z.a.nil,ha.input.source)}Bjk(ha,pa,Ea,Fa,Ga,$a,fa){const sa=new W.a,qa=sa.input;qa.C1=ha;qa.Mta=pa;qa.Nk=Ea;qa.S0=Fa;qa.Y0b=Ga;qa.source=
$a;qa.rBc=fa;qa.tNa=this.oca();sa.logger.djn(qa.tNa);ha=sa.runtime;ha.kWc=u.a.instance.y5(1,4);ha.M1d=u.a.instance.y5(1,3);let va="";ha.MC=Ca=>{if(this.o5b){var ta=this.oca()-qa.tNa,Wa=ta>this.o5b;va+=String.format(" ({0}: {1})",Ca,ta);Wa&&(sa.output.timeout=!0,Ca=String.format("[MergeId: {0}] Exceeded [MaxMergeTimeInMs: {1}] when we reached [Details: {2}] [Elapsed Time: {3}] [Timeline: {4}]",qa.YBb,this.o5b,Ca,ta,va),u.a.instance.ua(528061012,1,2,Ca),this.eDn(Ca))}};return sa}YDc(){return[Object(Q.a)(this,
this.Xvm,"otherAuthorsHaveChangesToMerge"),Object(Q.a)(this,this.TMl,"isInputValid"),Object(Q.a)(this,this.dBl,"initializeOutputMergeState"),Object(Q.a)(this,this.pGd,"initializeRuntimeMergeState"),H.a.hDm,Object(Q.a)(this,this.gDm,"preProcessTableStructure"),Object(Q.a)(this.G1g,this.G1g.Ecm,"mergeChildNodeLists"),Object(Q.a)(this,this.nIn,"tryObjectMerge"),H.a.RCm,Object(Q.a)(this,this.FHk,"finalizeObjectMerge"),Object(Q.a)(this,this.validateMarkers,"validateMarkers"),Object(Q.a)(this,this.fEj,
"addMergeResultsToOutput")]}Xvm(ha){const pa=ha.input.C1;ha=ha.output;return pa?pa.length?!0:(u.a.instance.ua(4051610,1,4,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),ha.xK=pa,ha.succeeded=!0,!1):(u.a.instance.ua(4051609,1,4,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),ha.xK=pa,ha.succeeded=!0,!1)}TMl(ha){var pa=ha.input;const Ea=pa.C1,Fa=pa.Mta,Ga=pa.Nk,$a=pa.S0;pa=pa.Y0b;ha=ha.output;if(!Fa||!Fa.length)return u.a.instance.ua(42350233,
1,4,"IsInputValid: No local changes to merge."),ha.xK=Ea,ha.succeeded=!0,!1;let fa=!0;if(2!==$a&&1!==$a)return ha.xK=Ea,!1;Ga&&Ga!==z.a.nil||(fa=!1);Ea.length<(pa?2:1)&&(u.a.instance.ua(4051614,1,4,"IsInputValid: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",pa),fa=!1);fa||(ha.xK=2===$a?Ea:Fa);return fa}pGd(ha){var pa=ha.input,Ea=pa.C1,Fa=pa.Mta,Ga=pa.S0,$a;let fa;({LCn:$a,YZn:fa,Xwa:pa}=this.b5k(ha,Ea,Fa,
pa.Y0b));if(!pa)return u.a.instance.ua(4273301,1,2,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",$a.id,fa.id),ha.logger.Cf(Object.assign(new O.a,{Ph:"InitializeRuntimeMergeState",eventId:"aqtsv",info:"Couldn't find a common base change"})),this.I1h($a,Ea.length,"TheirChanges"),this.I1h(fa,Fa.length,"YourChanges"),ha.output.xK=2===Ga?Ea:Fa,!1;ha.runtime.Xwa=pa;({OJn:Ea,XFk:Fa}=this.Itk(Ga,$a,fa));({PJn:pa,YFk:Ga,LSj:$a}=this.s7k(ha,Ea,Fa,pa));
ha.runtime.Ci=$a;ha.runtime.So=pa;ha.runtime.xr=Ga;ha.runtime.Xk=new F.a;ha.runtime.kwd=Fa.id;ha.runtime.I6d=Ea.id;ha.runtime.zeb=new F.a;ha.runtime.oHa=new l.a;ha.runtime.PWe=new F.a;ha.runtime.Ctb=new F.a;ha.runtime.KWf=new F.a;ha.runtime.iXd=new ja;ha.runtime.zOd=new m.a;ha.runtime.jCf=new l.a;ha.runtime.Pac=new m.a;ha.runtime.Ua=ha.input.rBc(ha);ha.runtime.Ua.Xrb(1000001,"Microsoft.Office.WordOnline.WordTestCrossCompiledFeature","WoWor220;WoWor220cf",k.a.mCn);ha.runtime.Ua.Xrb(1000005,"Microsoft.Office.WordOnline.TOCMerge",
"Word-TOCMerge;Word-TOCMergecf",k.a.dEn);ha.runtime.Ua.Xrb(1000008,"Microsoft.Office.WordOnline.FailOnMPALAsserts","69bca399;0362i899",k.a.FFk);ha.runtime.Ua.Xrb(1000009,"Microsoft.Office.WordOnline.RemoveEditedImageUrlFromIgnoredProperties","mergeeditedimageurl;mergeeditedimageurlcf",k.a.XVm);ha.runtime.Ua.Xrb(1000010,"Microsoft.Office.WordOnline.ValidateMarkers","08367149;c570e399",k.a.oUn);ha.runtime.Ua.Xrb(1000012,"Microsoft.Office.WordOnline.AdditionalPropertyMerge","3eh12588;c3h9g955",k.a.mKj);
ha.runtime.Ua.Xrb(1000013,"Microsoft.Office.WordOnline.LoggingForMergableOGNodes","hej93675;6g8j9958",k.a.qqf);ha.runtime.$Mh=!0;L.AFrameworkApplication.K&&(this.nrg=L.AFrameworkApplication.K.vb("WordEditorGraphMergeMaxIterationsPerCycle",50));return!0}I1h(ha,pa,Ea){const Fa=new m.a;for(;ha;)Fa.add(ha),ha=ha.A_;const Ga=new Sys.StringBuilder;Ga.append(String.format("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",Ea,pa,Fa.length));let $a=Fa.length,fa=0;Fa.forEach(sa=>({eLh:$a,j2h:fa}=this.QFj(Ga,
sa,Fa,$a,fa)).returnValue);u.a.instance.ua(4273302,1,3,Ga.toString())}QFj(ha,pa,Ea,Fa,Ga){ha.append(String.format(" [{0} {1} {2}]",Fa,pa.qra?"S":"B",pa.id));Fa--;Ga++;return 50<Ga&&Ea.length!==Ga?(ha.append(" ...Truncated."),{returnValue:!1,eLh:Fa,j2h:Ga}):{returnValue:!0,eLh:Fa,j2h:Ga}}b5k(ha,pa,Ea,Fa){pa=pa.Ye(pa.length-1-(Fa?1:0));Ea=Ea.Ye(Ea.length-1);Fa=pa.sab(Ea);ha.runtime.MC("GetCommonBase");ha.logger.lda("GetCommonBase");return{LCn:pa,YZn:Ea,Xwa:Fa}}s7k(ha,pa,Ea,Fa){let Ga,$a;({result:Ga}=
pa.v5b(Fa));ha.runtime.MC("GetUnfavoredChanges");ha.logger.lda("GetUnfavoredChanges");({result:$a}=Ea.v5b(Fa));5===ha.input.source&&(ha.runtime.aGk=J.a.DBh(Ea),ha.runtime.g_f=J.a.DBh(pa));ha.runtime.MC("GetFavoredChanges");ha.logger.lda("GetFavoredChanges");pa=new E.a(Object(Q.a)(Fa,Fa.XVa,"getMergeableObject"));ha.runtime.MC("GetModifiedObjects");ha.logger.lda("GetModifiedObjects");return{PJn:Ga,YFk:$a,LSj:pa}}Itk(ha,pa,Ea){2===ha?(ha=pa,pa=Ea):ha=Ea;return{OJn:pa,XFk:ha}}dBl(ha){const pa=ha.input,
Ea=pa.C1,Fa=pa.Mta;ha.output.xK=(2===pa.S0?Ea:Fa).s1();ha.runtime.MC("InitializeOutputMergeState");ha.logger.lda("InitializeOutputMergeState");return!0}fEj(ha){var pa=ha.input.Nk;const Ea=ha.runtime.Xk,Fa=ha.output.xK;pa=this.Cjk(ha,Fa.Ye(Fa.length-1),pa,z.a.create());this.fHk(ha,pa,Ea);Fa.add(pa);return ha.output.succeeded=!0}Cjk(ha,pa,Ea,Fa){ha.runtime.M1d&&u.a.instance.ua(4051616,1,3,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",Ea,Fa);ha=this.M4m(Fa);
ha.iTj(pa,Ea);return ha}fHk(ha,pa,Ea){ha.runtime.M1d&&u.a.instance.ua(4059167,1,3,"FillRevision: Adding {0} objects to merged revision.",Ea.count);Ea.forEach((Fa,Ga)=>{pa.tFj(Ga.ik);return!0})}GAb(ha){if(!ha)return u.a.instance.ua(573957952,1,2,"Feature helper is null"),!1;ha.ks(177);return ha.isFeatureEnabled(177)}gDm(ha){if(!this.GAb(ha.runtime.Ua))return!0;const pa=ha.runtime.xr,Ea=ha.runtime.So,Fa=ha.runtime.Ci;let Ga=!0;pa.forEach(($a,fa)=>{393252===fa.Gb&&(Ga=this.Fii(ha,$a,fa,Fa,pa));return Ga});
if(!Ga)return!1;Ea.forEach(($a,fa)=>{393252===fa.Gb&&(Ga=this.Fii(ha,$a,fa,Fa,Ea));return Ga});ha.logger.lda("PreProcessTableStructure");return Ga}Fii(ha,pa,Ea,Fa,Ga){const $a=null==this.Bc.getPropertyBool(Ea,f.a.ghostCell)?!1:this.Bc.getPropertyBool(Ea,f.a.ghostCell),fa=null==this.Bc.getPropertyUint32(Ea,f.a.rowSpan)?1:this.Bc.getPropertyUint32(Ea,f.a.rowSpan),sa=null==this.Bc.getPropertyUint32(Ea,f.a.colSpan)?1:this.Bc.getPropertyUint32(Ea,f.a.colSpan);if($a)return!0;var qa=Fa.J(pa);if(qa){Fa=null==
this.Bc.getPropertyBool(qa,f.a.ghostCell)?!1:this.Bc.getPropertyBool(qa,f.a.ghostCell);var va=null==this.Bc.getPropertyUint32(qa,f.a.rowSpan)?1:this.Bc.getPropertyUint32(qa,f.a.rowSpan);var Ca=null==this.Bc.getPropertyUint32(qa,f.a.colSpan)?1:this.Bc.getPropertyUint32(qa,f.a.colSpan);Fa=Fa!==$a;va=va!==fa;Ca=Ca!==sa}else Ca=va=Fa=!0;const ta=ia.e(ha,Ea,Ga);if(ta.equals(z.a.nil))return u.a.instance.ua(573957953,1,2,"Table cell's containing table node id could not be found. Table Cell ID: {0}",pa),
ha.logger.Cf(Object.assign(new la.a,{info:"Table Cell's containing table node ID could not be found"})),!1;let Wa=ha.runtime.Ctb.J(ta);Wa||(ha.runtime.Ctb.Z(ta,new F.a),Wa=ha.runtime.Ctb.J(ta));let Za=Wa.J(pa),Ya=new m.a;const Ka=new m.a,xa=new m.a;Fa&&(Za||(Ya=this.Bc.getPropertyObjectIds(Ea,x.a.ge)));if(va||Ca)if(Za){if(Za.lf)return u.a.instance.ua(573957961,1,3,"Table cell has conflicting ghostcell properties we are not handling"),ha.logger.Cf(Object.assign(new la.a,{info:"A table cell is ghost in one revision while non-ghost in another."})),
!1;if(null!=Za.rowSpan&&fa!==Za.rowSpan||null!=Za.colSpan&&sa!==Za.colSpan)return u.a.instance.ua(573957962,1,3,"Same table cell has different rowSpan/colSpan in conflicting revisions"),ha.logger.Cf(Object.assign(new la.a,{info:"A table cell has different rowSpan/colSpan in the conflicting revisions"})),!1}else{var Sa;({rowIndex:Ea,DVb:Sa}=ia.b(ha,Ga,Ea));if(-1===Ea||-1===Sa)return u.a.instance.ua(573957954,1,2,"Table cell location could not be found. Table Cell ID: {0}",pa),ha.logger.Cf(Object.assign(new la.a,
{info:"Table cell location could not be found"})),!1;for(var pb=Ea;pb<Ea+fa;pb++)for(var Db=Sa;Db<Sa+sa;Db++){var Ua=ia.c(ha,ta,pb,Db);if(Ua.equals(z.a.nil))return u.a.instance.ua(573957955,1,3,"Other revision deleted the table cells this revision is trying to merge"),ha.logger.Cf(Object.assign(new la.a,{info:"Ghost cell not found in the table bounds"})),!1;var Lb=Ga.ax(Ua,ha.runtime.Ci.J(Ua));if(!Lb)return u.a.instance.ua(573957956,1,3,"Other revision has inserted cells in between the cells this revision is trying to merge"),
ha.logger.Cf(Object.assign(new la.a,{info:"Newly inserted cell in another revision cannot be merged with the cell in current revision"})),!1;if(!Ua.equals(pa)){if(null==this.Bc.getPropertyBool(Lb,f.a.ghostCell)||!this.Bc.getPropertyBool(Lb,f.a.ghostCell))return u.a.instance.ua(573957957,1,3,"Other revision deleted some of the cells this revision is trying to merge"),ha.logger.Cf(Object.assign(new la.a,{info:"Cannot merge a non-ghost cell with the controlling cell"})),!1;var Va=Wa.J(Ua);if(Va)return u.a.instance.ua(573957958,
1,3,"The ghost cell is already merged with some other cells in the other revision"),ha.logger.Cf(Object.assign(new la.a,{info:"Ghost cell is already merged with some other cell"})),!1;Ka.add(Ua);Va=new Ba;Va.lf=!0;Lb=this.Bc.getPropertyUint32(Lb,f.a.colSpan);null!=Lb&&(Va.colSpan=Lb);Wa.Z(Ua,Va)}}if(qa&&(null==this.Bc.getPropertyBool(qa,f.a.ghostCell)||!this.Bc.getPropertyBool(qa,f.a.ghostCell))&&(Ga=null==this.Bc.getPropertyUint32(qa,f.a.rowSpan)?1:this.Bc.getPropertyUint32(qa,f.a.rowSpan),Ea=null==
this.Bc.getPropertyUint32(qa,f.a.colSpan)?1:this.Bc.getPropertyUint32(qa,f.a.colSpan),Ga>fa||Ea>sa)){pb=Sa=-1;({rowIndex:Sa,DVb:pb}=ia.a(ha,null,qa,Sa,pb));if(-1===Sa||-1===pb)return u.a.instance.ua(573957959,1,2,"Table cell location could not be found in base revision. Table Cell ID: {0}",pa),ha.logger.Cf(Object.assign(new la.a,{info:"Table cell location could not be found in base revision, although the object is present itself"})),!1;qa=Ka.yz();for(Db=Sa;Db<Sa+Ga;Db++)for(Ua=pb;Ua<pb+Ea;Ua++){Va=
ia.d(ha,null,ta,Db,Ua);if(!Va)return u.a.instance.ua(573957960,1,2,"Table cell could not be found within table bounds"),ha.logger.Cf(Object.assign(new la.a,{info:"Ghost cell not found in the table bounds"})),!1;Va.id.equals(pa)||qa.contains(Va.id)||xa.add(Va.id)}}}!Za&&(Fa||va||Ca)&&(u.a.instance.ua(573957963,1,3,"Adding cell info structure to the ComplexTableStructure Dictionary for table cell id: {0}",pa),Za=new Ba,Za.rowSpan=fa,Za.colSpan=sa,Za.lf=$a,Za.eQd=Ya,Za.Hbf=Ka,Za.fwf=xa,Wa.add(pa,Za));
return!0}nIn(ha){return this.yRi(ha,!1)}FHk(ha){return this.yRi(ha,!0)}yRi(ha,pa){const Ea=ha.runtime,Fa=Ea.Ci,Ga=Ea.xr,$a=pa?Ea.PWe:Ea.So,fa=Ea.Xk;let sa=!0;const qa=ha.runtime.kWc;let va=0,Ca=0,ta=0;$a.forEach((Wa,Za)=>{qa&&u.a.instance.ua(4051617,1,4,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]",Wa,Za.Gb,pa);Ca++;this.nrg===Ca&&(va++,ha.runtime.MC(String.format("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}] [Finalize: {2}]",va,ta,pa)),Ca=0);if(ha.runtime.Ua&&ha.runtime.Ua.eyb(1000005)&&
ha.runtime.Pac.contains(Za.id,(xa,Sa)=>xa.equals(Sa))||this.Gtn(Za.Gb))return!0;if(!pa&&this.xqk(Za.Gb,ha.runtime.Ua))return Ea.PWe.Z(Wa,Za),!0;var Ya=Ga.get(Wa);if(!Ya)return fa.Ja(Wa)?fa.J(Wa).m5h(Za):fa.Z(Wa,new Z.a(Za,!1)),!0;if(!Fa.J(Wa)&&!this.sdm(Ya.Gb)){var Ka=!!ha.input.C1&&!!ha.input.C1.last()&&ha.input.C1.last().AM(Wa);const xa=!!ha.input.Mta&&!!ha.input.Mta.last()&&ha.input.Mta.last().AM(Wa),Sa=new ca.a(Ya,Za);if(!Sa.GO)return fa.Z(Wa,new Z.a(Ya,!1)),!0;u.a.instance.ua(4051618,1,2,"Merging Object: [Id: {0}] [ClassId: {1}] [Finalize: {2}]. Object wasn't in base revision, but was in conflict and favored. [ReferencedInFavored: {3}] [ReferencedInUnfavored: {4}] [Identical: {5}] [Source: {6}].",
Wa,Za.Gb,pa,Ka,xa,!Sa.GO,ha.input.source);ha.logger.Cf(Object.assign(new O.a,{Ph:"GraphMerger.TryObjectMerge",eventId:"ap3k8"}));return sa=!1}Ka=fa.ax(Wa,new Z.a(Fa.J(Wa)));({nj:Ya,returnValue:sa}=this.wnl.merge(ha,this.UGh,this.Bc,Ka,Ya,Za));ta++;sa&&(ha.runtime.MC(String.format("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}] [Finalize: {4}]",Wa,Za.Gb,ta,va,pa)),Ya&&(fa.Ja(Ya.ik.id)?fa.J(Ya.ik.id).m5h(Ya.ik):fa.Z(Ya.ik.id,Ya)));return sa});ha.logger.lda("ObjectMerge");!oa.jUl&&
sa&&5===ha.input.source&&ha.runtime.g_f.length&&Ga.forEach((Wa,Za)=>393230===Za.Gb&&ha.runtime.g_f.contains(Wa,(Ya,Ka)=>Ya.equals(Ka))&&(sa=Fa.J(Wa)?!(new aa.a(x.a.Pl,this.Bc.getPropertyString(Fa.J(Wa),x.a.Pl),this.Bc.getPropertyString(Za,x.a.Pl))).GO:!1,!sa)?(u.a.instance.ua(16869081,1,2,"Failed to Merge Object {0} which was changed in the favored and removed in the unfavored, finalize: {1}",Wa,pa),ha.logger.Cf(Object.assign(new O.a,{Ph:"GraphMerger.TryObjectMerge",eventId:"baw1z"})),!1):!0);qa&&
u.a.instance.ua(4059168,1,4,"TryObjectMerge: Merged {0} objects. {1} were complex merges, finalize: {2}.",$a.count,ta,pa);return sa}validateMarkers(ha){try{for(let pa=0;pa<ha.runtime.zOd.length;pa++){const Ea=ha.runtime.zOd.J(pa);if(ha.runtime.Xk.J(Ea)){if(!this.bOl(ha,Ea))return!1}else u.a.instance.ua(527034192,1,2,"ValidateMerge: Couldn't find merged node to verify");ha.runtime.MC("Validate markers taking too long")}}catch(pa){u.a.instance.ua(559535579,1,2,"ValidateMerge threw an exception: {0}",
pa)}return ha.logger.JMc.HIh()?!1:!0}gpn(ha){return 38===ha||39===ha||40===ha||41===ha||44===ha||45===ha||33===ha||34===ha?!1:!0}I6k(ha){switch(ha){case 38:case 39:case 40:case 41:return f.a.ud;case 44:case 45:return f.a.jnd;case 33:case 34:return f.a.Oj}return A.CommonProperties.nil}nUn(ha,pa){const Ea=this.Bc.getPropertyUint32(ha,f.a.Qp);if(!Ea||this.gpn(Ea))return!0;ha=this.Bc.getPropertyObjectId(ha,this.I6k(Ea));return oa.QZb(pa,ha)?!0:(pa.logger.JMc.eHd=Ea,!1)}bOl(ha,pa){if(ha.runtime.jCf.contains(pa))return!1;
if(pa=oa.QZb(ha,pa)){pa=this.Bc.getPropertyObjectIds(pa,x.a.mm);for(let Ea=0;Ea<pa.length;Ea++){const Fa=oa.QZb(ha,pa.Ye(Ea));if(Fa&&!this.nUn(Fa,ha))return!1}}return!0}Gtn(ha){switch(ha){case 1074135137:case 1074135138:case 1074135139:case 1074135140:case 131162:case 4325465:return!0}return!1}xqk(ha,pa){let Ea=!1;if(1074135145===ha)return!0;pa&&pa.ks(210);pa&&pa.isFeatureEnabled(210)&&1074135153===ha&&(Ea=!0);return Ea}sdm(ha){switch(ha){case 1074135162:return!0}return!1}Mlk(ha,pa){const Ea=new m.a,
Fa=new m.a,Ga=new m.a;var $a=ha.runtime.Xwa;const fa=$a?$a.id:z.a.nil;this.Yof($a).forEach(sa=>{Ea.add(pa(sa));return!0});$a=ha.input.C1.Ye(ha.input.C1.length-1);this.Yof($a,fa).forEach(sa=>{Fa.add(pa(sa));return!0});ha=ha.input.Mta.Ye(ha.input.Mta.length-1);this.Yof(ha,fa).forEach(sa=>{Ga.add(pa(sa));return!0});return{JSj:Ea,MCn:Fa,ZZn:Ga}}Yof(ha,pa=null){const Ea=new m.a;pa||(pa=z.a.nil);for(;ha&&!pa.equals(ha.id);)Ea.add(ha),ha=ha.A_;Ea.reverse();return Ea}fzn(ha){const pa=3===this.nDd;let Ea=
!1;!ha.output.succeeded&&(2===this.nDd||ha.output.crash&&1===this.nDd)&&(Ea=!0);let Fa=!1;ha.input.C1&&0<ha.input.C1.length&&(pa||Ea)&&ha.runtime.xr&&ha.runtime.Ci&&ha.runtime.Ua&&(Fa=ha.runtime.Ua.isFeatureEnabled(83));return Fa}JPh(ha){return 9===R.a.Lxb(R.a.Y3e(ha))}DUh(ha){return 8===R.a.Lxb(R.a.Y3e(ha))}static get jUl(){oa.h$c||(L.AFrameworkApplication.K?(L.AFrameworkApplication.Mg("undoMergecleanup_trtmnt;undoMergecleanup_ctrl"),oa.h$c=L.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UndoMergeCleanup",
!1)):oa.h$c=!1);return oa.h$c}static K1k(ha){return ha.output.crash?2:ha.output.succeeded?3:1}static QZb(ha,pa){if(!pa||pa===z.a.nil)return null;const Ea=ha.runtime.Xk.J(pa);return Ea?Ea.ik:ha.runtime.Ci.J(pa)}}oa.mDd=z.a.Ee("{0B310978-27EA-4A49-A620-7E588CFE64C6}{1}");oa.h$c=null;Object(G.a)(oa,"GraphMergerBase",null,[1275])},1600:function(G,P,b){G=b(0);var k=b(202),f=b(1452),x=b(145),u=b(1360);class w extends f.a{constructor(m,l,z,F,L,E,A,M,Q,R,K,J,O,N){super(m,3,l,z,F,L,E,M,Q,R,K,J,O,N);this.Yce=
A}get character(){return this.Yce}get text(){return this.character.toString()}QVc(){throw x.a.notImplemented();}toString(){return String.format("{0}",super.toString())}jZb(){return"CharRun"}clone(){return new w(this.kuc,this.source,this.oi,this.qf,this.runId,this.KG,this.character,this.yeb,this.pKa,this.C8,this.Wya,this.bMa,this.HC,this.ur)}oy(m,l,z,F=!1){return super.oy(m,l,z,F)?m.character===this.character?!0:u.a.cUg(m.character,this.character):!1}}Object(G.a)(w,"CharRunMergeBlock",f.a,[]);b.d(P,
"a",function(){return r});class r extends f.a{constructor(m,l,z,F,L,E,A,M,Q,R,K,J,O,N,V){super(m,1,l,z,F,L,E,M,R,K,J,O,N,V);this._text=A;this.vCe=Q}get text(){return this._text}QVc(m){this._text=m}get A0a(){return this.vCe&&this._text&&this._text.length?!0:!1}toString(){return String.format("{0} [SupportsSplit: {1}]",super.toString(),this.vCe)}jZb(){return"TextRun"}clone(){return new r(this.kuc,this.source,this.oi,this.qf,this.runId,this.KG,this._text,this.yeb,this.vCe,this.pKa,this.C8,this.Wya,this.bMa,
this.HC,this.ur)}oy(m,l,z,F=!1){return super.oy(m,l,z,F)?u.a.bUg(this._text,m._text):!1}bXc(){const m=new k.a;for(let z=0;z<this.text.length;z++){var l=u.a.charAt(this._text,z);if(u.a.fTl(u.a.ODn(l))){let F="";F+=l;l=u.a.charAt(this._text,++z);F+=l;l=new r(this.kuc,this.source,this.oi,this.qf,this.runId,this.KG,F,this.yeb,!1,this.pKa,this.C8,this.Wya,this.bMa,this.HC,this.ur);m.add(l)}else l=new w(this.kuc,this.source,this.oi,this.qf,this.runId,this.KG,l,this.yeb,this.pKa,this.C8,this.Wya,this.bMa,
this.HC,this.ur),m.add(l)}return m}}Object(G.a)(r,"TextRunMergeBlock",f.a,[])},1601:function(G,P,b){G=b(0);var k=b(893),f=b(17),x=b(366),u=b(202),w=b(51);b(724);var r=b(574),m=b(143),l=b(145),z=b(909),F;(function(Q){Q[Q.none=0]="none";Q[Q.browser=1]="browser";Q[Q.serverPutChanges=2]="serverPutChanges";Q[Q.syncDiff=3]="syncDiff";Q[Q.docxMerge=4]="docxMerge";Q[Q.undo=5]="undo"})(F||(F={}));Object(G.b)("GraphMergeSource",F);var L=b(1585),E=b(1375),A=b(1579);b.d(P,"a",function(){return M});class M{constructor(Q){this.Jy=
new z.a;this.rN=new x.a;this.VIg=new x.a(0);this.r1c=new u.a;this.Ulg=new u.a;this.Rvg=new u.a;this.Ysg=new u.a;this.Zug="";this.JPa=null;this.wq=this.sqe=0;this.Ecd=new x.a(0);this.xie=this.Czg=this.I$c=0;const {MarkerValidation:R}=b(1690);this._state=Q;this.emj=new R}get JMc(){return this.emj}get Nki(){return this.JPa}djn(Q){this.sqe=Q}iNd(Q,R){this.Zug=String.format("{0}-{1}",Q,R)}B0d(Q){this.q6j();this.xie=Q}qQf(){this.xie=0}q6j(){this.JPa&&this.r1c.add(this.JPa);this.JPa=null}Cf(Q){this.JPa||
(this.JPa=Q);switch(this.xie){case 1:this.Ulg.add(Q);break;case 2:this.Rvg.add(Q);break;case 3:this.Ysg.add(Q);break;default:this.JPa&&this.r1c.add(Q)}}o0h(Q){this.r1c.add(Q)}i5l(){this.wq=this.oca();this.lda("MergeEnd")}lda(Q){const R=this.oca();this.VIg.Z(Q,R-this.sqe);this.sqe=R}ihn(){this.I$c=this.oca();this.Czg++}YR(Q){const R=this.oca();let K;({value:K}=this.Ecd.Ab(Q)).returnValue?(K+=R-this.I$c,this.Ecd.Z(Q,K)):this.Ecd.Z(Q,R-this.I$c);this.I$c=R}X6k(){this.rN.Z("Id",this._state.input.YBb.toString());
this.rN.Z("Source",F[this._state.input.source]);this.rN.Z("Base",M.Lta(this.CSk()));this.rN.Z("Favored",M.Lta(this.RBh(!0)));this.rN.Z("Unfavored",M.Lta(this.RBh(!1)));this.rN.Z("NodesRolledBackIfFailed",M.Lta(this.N8k()));if(!this._state.output.succeeded){let Q,R,K,J,O;({MSj:Q,ZFk:R,QJn:K,RSj:J,RJn:O}=this.KHk(this._state.runtime));this.rN.Z("CharactersLost",this.CUk(Q,R,K));this.rN.Z("CharactersLostInComments",this.wVk());this.rN.Z("CharactersLostInTables",this.xRk(O,J))}this.rN.Z("FuncStep",this.Zug);
this.rN.Z("FailureDetail",M.Lta(this.Wwb()));this.rN.Z("FailDetailHints",this.yzd(this.Ulg));this.rN.Z("FailDetailNaiveMerge",this.yzd(this.Rvg));this.rN.Z("FailDetailLcs",this.yzd(this.Ysg));this.rN.Z("ExtraDetails",this.yzd(this.r1c));this.rN.Z("Timeline",M.Lta(this.VIg));this.rN.Z("ParagraphMergesCount",this.Czg);this.rN.Z("ParagraphMergeDurations",M.Lta(this.Ecd));this.rN.Z("MarkerInfo",M.Lta(this.JMc.Fth()));this.rN.Z("Result",M.Lta(this.Z6k()));return JSON.stringify(M.Lta(this.rN))}oca(){return(new Date).getTime()}CSk(){const Q=
new x.a,R=this._state.input.Mta,K=this._state.runtime.Xwa?this._state.runtime.Xwa.id:w.a.nil;let J=!1,O=0;for(;O<R.length;O++)if(R.J(O).id.equals(K)){J=!0;break}Q.Z("LastId",K.toString());Q.Z("Length",J?O+1:-1);return Q}RBh(Q){const R=new x.a;if(0===this._state.input.S0)return null;Q=Q?2===this._state.input.S0?this._state.input.C1:this._state.input.Mta:2===this._state.input.S0?this._state.input.Mta:this._state.input.C1;R.Z("FirstId",Q.J(0).id.toString());R.Z("LastId",Q.length?Q.J(Q.length-1).id.toString():
null);R.Z("Length",Q.length);return R}N8k(){if(!this._state.runtime.$Mh)return null;const Q=this._state.runtime.So,R=new x.a(0);Q.forEach((K,J)=>{({value:K}=R.Ab(J.Gb.toString()));R.Z(J.Gb.toString(),K+1);return!0});return R}CUk(Q,R,K){let J=null,O=null,N=null;const V=this._state.runtime.So;let W=0;try{N=new A.a(this.Jy,this._state);J=E.b(Q,R,K);O=new r.a;for(Q=0;Q<J.length;Q++)if(!J.J(Q).xsb.Go(J.J(Q).Vib,(ca,H)=>ca.equals(H))){const ca=this.Kdh(J.J(Q),N);W+=ca;O.add(J.J(Q))}J&&V.forEach((ca,H)=>
{if(393230===H.Gb){H=null;for(let Z=0;Z<J.length;Z++)if(!O.contains(J.J(Z))&&J.J(Z).Vib.contains(ca,(aa,ja)=>aa===ja)){H=J.J(Z);break}H&&(ca=this.Kdh(H,N),O.add(H),W+=ca)}return!0});return W}catch(ca){return m.a.instance.ua(579190992,1,2,"Exception in GetCharactersLost: "+ca.toString()),-1}}KHk(Q){let R,K,J,O,N;Q.MC=W=>{if(750<this.oca()-this._state.input.tNa)throw m.a.instance.ua(579190991,1,2,"Timed out while calculating characters lost: {0}",W),l.a.invalidOperation(W);};R=new u.a;K=new u.a;J=new u.a;
O=new u.a;const V=new u.a;N=new u.a;try{if(Q.Ci){const W=Q.Ci.J(L.ChildNodeListMerge.iTd);let ca,H;ca=Q.xr.J(L.ChildNodeListMerge.iTd)||W;H=Q.So.J(L.ChildNodeListMerge.iTd)||W;this.S1e(W,Z=>Q.Ci.J(Z),R,O);this.S1e(ca,Z=>Q.xr.J(Z)||Q.Ci.J(Z),K,V);this.S1e(H,Z=>Q.So.J(Z)||Q.Ci.J(Z),J,N)}}catch(W){m.a.instance.ua(573089732,1,2,"Exception in FindAllParagraphAndTableIds: "+W.toString())}return{MSj:R,ZFk:K,QJn:J,RSj:O,RJn:N}}xRk(Q,R){try{let J=0;const O=this._state.runtime;var K=W=>O.So.J(W)||O.Ci.J(W);
const N=new r.a,V=this.sJk(Q,O,K,N);for(Q=0;Q<V.count;Q++){let W=V.keys.J(Q);const ca=V.J(W);if(!N.contains(W)){let H=this.MDh(O,K,N,W,ca);if(-1!==H)J+=H;else return m.a.instance.ua(573089733,1,2,"Error calculating characters lost between base and unfavored tables"),-1}}for(K=0;K<R.length;K++){let W=R.J(0);if(!N.contains(W)){let ca=this.DCd(O.Ci.J(W));if(-1===ca)return m.a.instance.ua(573089734,1,2,"Error calculating characters lost in table deleted from base"),-1;J+=ca}}return J}catch(J){return m.a.instance.ua(573089735,
1,2,"Exception in GetAllTablesCharactersLost: "+J.toString()),-1}}MDh(Q,R,K,J,O){Q.MC("GetTableCharactersLost");let N=0;O=this.Jy.getPropertyObjectIds(O,f.a.ge);for(let Z=0;Z<O.length;Z++){var V=R(O.J(Z));V=this.Jy.getPropertyObjectIds(V,f.a.ge);for(let aa=0;aa<V.length;aa++){var W=R(V.J(aa));if(Q.Ci.J(O.J(Z))&&Q.Ci.J(V.J(aa))){var ca=Q.Ci.J(V.J(aa));if(!ca)return m.a.instance.ua(573089737,1,2,"Base cell unexpectedly null"),-1;W=this.Jy.getPropertyObjectIds(ca,f.a.ge);var H=Q.xr.J(V.J(aa))||Q.Ci.J(V.J(aa));
H=this.Jy.getPropertyObjectIds(H,f.a.ge);ca=this.Jy.getPropertyObjectIds(ca,f.a.ge);W=E.b(W,H,ca);for(ca=0;ca<W.length;ca++){H=W.J(ca);const ja=this.dil(Q,R,K,H);if(-1===ja)return m.a.instance.ua(573089738,1,2,"Error getting characters lost for parition {0}",H.toString()),-1;N+=ja}}else{ca=this.Kil(R,W,K);if(-1===ca)return m.a.instance.ua(573089736,1,2,"Error getting text length of cell {0}",W.id.toString()),-1;N+=ca}}}K.add(J);return N}dil(Q,R,K,J){let O=0;var N=new u.a,V=new u.a;const W=new x.a;
new x.a;for(var ca=0;ca<J.xsb.length;ca++){var H=Q.Ci.J(J.xsb.J(ca));H=this.Jy.getPropertyObjectIds(H,f.a.LJ);if(1!==H.length)return m.a.instance.ua(573089739,1,2,"Unexpected number of ContentNodes: {0}",H.length),-1;var Z=Q.Ci.J(H.J(0));393230===Z.Gb?N.add(Z):393250===Z.Gb&&W.add(H.J(0),Z)}for(ca=0;ca<J.Vib.length;ca++){H=R(J.Vib.J(ca));H=this.Jy.getPropertyObjectIds(H,f.a.LJ);if(1!==H.length)return m.a.instance.ua(573089740,1,2,"Unexpected number of ContentNodes: {0}",H.length),-1;Z=R(H.J(0));if(393230===
Z.Gb)V.add(Z);else if(393250===Z.Gb){Z=this.MDh(Q,R,K,H.J(0),Z);if(-1===Z)return m.a.instance.ua(573089741,1,2,"Error diffing table {0}",H.J(0).toString()),-1;O+=Z}}ca=new A.a(this.Jy,this._state);if(0<N.length&&0<V.length){N=ca.wlh(N,aa=>Q.Ci.J(aa),V,aa=>R(aa));if(-1===N)return m.a.instance.ua(573089742,1,2,"Problem diffing parition {0} with LCS",J.toString()),-1;O+=N}else if(0<N.length)for(J=0;J<N.length;J++)O+=this.Jy.getPropertyString(N.J(J),f.a.Pl).length+1;else if(0<V.length)for(J=0;J<V.length;J++)O+=
this.Jy.getPropertyString(V.J(J),f.a.Pl).length+1;for(J=0;J<W.count;J++)if(N=W.keys.J(J),!K.contains(N)){V=this.DCd(W.J(N));if(-1===V)return m.a.instance.ua(573089743,1,2,"Error getting length of table {0}",N.toString()),-1;O+=V}return O}Kil(Q,R,K){let J=0;R=this.Jy.getPropertyObjectIds(R,f.a.ge);for(let V=0;V<R.length;V++){var O=Q(R.J(V));O=this.Jy.getPropertyObjectIds(O,f.a.LJ);if(1!==O.length)return m.a.instance.ua(573089744,1,2,"Unexpected number of ContentNodes: {0}",O.length),-1;var N=Q(O.J(0));
if(393230===N.Gb)J+=this.Jy.getPropertyString(N,f.a.Pl).length+1;else if(393250===N.Gb){N=this.DCd(N);if(-1===N)return m.a.instance.ua(573089745,1,2,"Problem finding text length of table {0}",O.J(0).toString()),-1;J+=N;K.add(O.J(0))}}return J}DCd(Q){this._state.runtime.MC("GetTextLengthOfTable");let R=0;const K=W=>this._state.runtime.So.J(W)||this._state.runtime.Ci.J(W);Q=this.Jy.getPropertyObjectIds(Q,f.a.ge);for(let W=0;W<Q.length;W++){var J=K(Q.J(W));J=this.Jy.getPropertyObjectIds(J,f.a.ge);for(let ca=
0;ca<J.length;ca++){var O=K(J.J(ca));O=this.Jy.getPropertyObjectIds(O,f.a.ge);for(let H=0;H<O.length;H++){var N=K(O.J(H));N=this.Jy.getPropertyObjectIds(N,f.a.LJ);if(1!==N.length)return m.a.instance.ua(573089746,1,2,"Unexpected number of ContentNodes: {0}",N.length),-1;var V=K(N.J(0));if(393230===V.Gb)R+=this.Jy.getPropertyString(V,f.a.Pl).length+1;else if(393250===V.Gb){V=this.DCd(V);if(-1===V)return m.a.instance.ua(573089747,1,2,"Error finding the text length of table {0}",N.J(0)),-1;R+=V}}}}return R}sJk(Q,
R,K,J){const O=new x.a;for(let N=0;N<Q.length;N++){let V=!1;R.So.J(Q.J(N))&&(V=!0);const W=K(Q.J(N)),ca=this.Jy.getPropertyObjectIds(W,f.a.ge);if(!V)for(let H=0;H<ca.length;H++)if(R.So.J(ca.J(H))){V=!0;break}V?O.add(Q.J(N),W):J.add(Q.J(N))}return O}Kdh(Q,R){return this.Jdh(Q.xsb,Q.Vib,R)}Jdh(Q,R,K){const J=new u.a;for(var O=0;O<Q.length;O++)J.add(this._state.runtime.Ci.J(Q.J(O)));Q=new u.a;for(O=0;O<R.length;O++)Q.add(this._state.runtime.So.J(R.J(O))||this._state.runtime.Ci.J(R.J(O)));return K.wlh(J,
N=>this._state.runtime.Ci.J(N),Q,N=>this._state.runtime.So.J(N)||this._state.runtime.Ci.J(N))}S1e(Q,R,K,J){if(393227===Q.Gb){Q=this.Jy.getPropertyObjectIds(Q,f.a.ge);for(let O=0;O<Q.length;O++){const N=this.Jy.getPropertyObjectIds(R(Q.J(O)),f.a.ge);for(let V=0;V<N.length;V++){const W=this.Jy.getPropertyObjectIds(R(N.J(V)),f.a.ge);for(let ca=0;ca<W.length;ca++){const H=this.Jy.getPropertyObjectIds(R(W.J(ca)),f.a.LJ);if(1!==H.length)return;const Z=R(H.J(0));393230===Z.Gb?K.add(H.J(0)):393250===Z.Gb?
J.add(H.J(0)):m.a.instance.ua(573089748,1,2,"Unsupported class id in GetCharactersLost: "+k.a[Z.Gb])}}}}}T1e(Q,R){Q=this.Jy.getPropertyObjectIds(Q,f.a.ge);const K=new u.a;for(let J=0;J<Q.length;J++){const O=this.Jy.getPropertyObjectIds(R(Q.J(J)),f.a.LJ);if(1!==O.length)return null;K.add(O.J(0))}return K}wVk(){let Q=0;const R=this._state.runtime,K=R.So,J=N=>R.So.J(N)||R.Ci.J(N);let O=null;R.MC=N=>{if(750<this.oca()-this._state.input.tNa)throw m.a.instance.ua(573089749,1,2,"Timed out while calculating comment characters lost: {0}",
N),l.a.invalidOperation(N);};try{K.forEach((N,V)=>{if(1074135127===V.Gb){N=this.T1e(V,J);var W=R.Ci.J(V.id);if(W)W=this.T1e(W,H=>R.Ci.J(H)),O||(O=new A.a(this.Jy,this._state)),Q+=this.Jdh(W,N,O);else for(W=0;W<N.length;W++)Q+=this.Jy.getPropertyString(R.So.J(N.J(W)),f.a.Pl).length+1}if(1074135126===V.Gb&&(N=this.Jy.getPropertyObjectIds(V,f.a.ge).yz(),V=R.Ci.J(V.id)))for(V=this.Jy.getPropertyObjectIds(V,f.a.ge),W=0;W<V.length;W++)if(!N.contains(V.J(W))){var ca=R.Ci.J(V.J(W));ca=this.T1e(ca,H=>R.Ci.J(H));
for(let H=0;H<ca.length;H++)Q+=this.Jy.getPropertyString(R.Ci.J(ca.J(H)),f.a.Pl).length+1}return!0})}catch(N){return m.a.instance.ua(573089750,1,2,"Exception in GetCommentCharactersLost: "+N.toString()),-1}return Q}Wwb(){return this.JPa?this.JPa.Wwb():null}yzd(Q){const R=new u.a;Q.forEach(K=>{R.add(M.Lta(K.Wwb()));return!0});return R.toArray()}Z6k(){const Q=new x.a;Q.Z("Succeeded",this._state.output.succeeded);Q.Z("Timeout",this._state.output.timeout);Q.Z("Crash",this._state.output.crash);Q.Z("MergedRevisions",
this._state.output.xK?this._state.output.xK.length:-1);Q.Z("Duration",this.wq-this._state.input.tNa);return Q}static Lta(Q){if(!Q)return null;const R={};Q.forEach((K,J)=>{R[K.toString()]=J;return!0});return R}}Object(G.a)(M,"MergeLogger",null,[])},1602:function(G,P,b){G=b(0);var k=b(231),f=b(17),x=b(6),u=b(109),w=b(724),r=b(143),m=b(202),l=b(366),z=b(1291);class F{constructor(A,M,Q){this.position=A;this.leader=M;this.val=Q}equals(A){return this.position===A.position&&this.leader===A.leader&&this.val===
A.val}toString(){return this.position.toString()}}Object(G.a)(F,"TabStop",null,[]);var L=b(1691);b.d(P,"a",function(){return E});class E extends z.a{constructor(){super()}get $l(){return 20}get Yx(){return 0}$i(){const A=super.$i();A.Z(w.a.Ha(f.a.Pl),1);A.Z(w.a.Ha(f.a.mm),1);A.Z(w.a.Ha(f.a.pl),1);A.Z(w.a.Ha(x.a.Jr),1);A.Z(w.a.Ha(x.a.yp),1);A.Z(w.a.Ha(x.a.Ib),1);A.Z(w.a.Ha(f.a.Nhb),1);A.Z(w.a.Ha(x.a.nJa),1);A.Z(w.a.Ha(x.a.jBa),1);A.Z(w.a.Ha(f.a.Ora),1);A.Z(w.a.Ha(x.a.yza),1);A.Z(w.a.Ha(x.a.Sba),1);
A.Z(w.a.Ha(x.a.zza),1);A.Z(w.a.Ha(x.a.Ixa),1);A.Z(w.a.Ha(x.a.Aza),1);A.Z(w.a.Ha(x.a.Jxa),1);A.Z(w.a.Ha(x.a.iBa),1);A.Z(w.a.Ha(x.a.FCa),1);A.Z(w.a.Ha(x.a.GCa),1);A.Z(w.a.Ha(x.a.sta),1);A.Z(w.a.Ha(x.a.Ot),1);A.Z(w.a.Ha(x.a.vV),1);A.Z(w.a.Ha(x.a.wV),1);A.Z(w.a.Ha(x.a.CK),1);A.Z(w.a.Ha(u.a.JI),6);A.Z(w.a.Ha(u.a.jOa),6);A.Z(w.a.Ha(x.a.vVb),7);A.Z(w.a.Ha(u.a.JI),6);A.Z(w.a.Ha(x.a.pJi),2);A.Z(w.a.Ha(u.a.uck),2);A.Z(w.a.Ha(u.a.aym),2);A.Z(w.a.Ha(x.a.tcc),2);A.Z(w.a.Ha(x.a.OYc),2);A.Z(w.a.Ha(x.a.pIb),2);A.Z(w.a.Ha(x.a.Lib),
2);A.Z(w.a.Ha(x.a.PYc),2);A.Z(w.a.Ha(x.a.QYc),2);A.Z(w.a.Ha(x.a.lockNotFullySupportedParagraphInBlockContentControl),2);return A}zz(A,M){if(M===w.a.Ha(f.a.Pl)||M===w.a.Ha(f.a.mm)||M===w.a.Ha(f.a.pl)||M===w.a.Ha(x.a.Jr)||M===w.a.Ha(x.a.yp)||M===w.a.Ha(x.a.Ib)||M===w.a.Ha(f.a.Nhb)||M===w.a.Ha(x.a.nJa)||M===w.a.Ha(x.a.jBa)||M===w.a.Ha(f.a.Ora)||M===w.a.Ha(x.a.yza)||M===w.a.Ha(x.a.Sba)||M===w.a.Ha(x.a.zza)||M===w.a.Ha(x.a.Ixa)||M===w.a.Ha(x.a.Aza)||M===w.a.Ha(x.a.Jxa)||M===w.a.Ha(x.a.iBa)||M===w.a.Ha(x.a.FCa)||
M===w.a.Ha(x.a.GCa)||M===w.a.Ha(x.a.sta)||M===w.a.Ha(x.a.Ot)||M===w.a.Ha(x.a.ZK)){var Q=A.jl.value.ns,R=A.jl.value.Zd;M=A.tf.value.Zd;if(A.vm.runtime.oHa.contains(Q.id))return r.a.instance.ua(18989579,1,3,"ParagraphNodeComplexMerge: Skipping merge for [Paragraph: {0}] as it was already merged during ChildNodeListMerge.",Q.id),!0;if(A.vm.runtime.Ua.eyb(1000005)&&this.Mtn(A,M,R))return A.nj=M.dF(),E.YNg(A),E.lld(A.vm,A.Bc,R),!0;const K=new m.a;K.add(Q);Q=new m.a;Q.add(R);R=new m.a;R.add(M);if(!({Xk:M}=
E.CRi(A.vm,K,R,Q)).returnValue)return A.m2f=!0,A.nj=null,!1;E.YNg(A);A.nj=M.Ye(0).ik;return!0}return M===w.a.Ha(x.a.vV)||M===w.a.Ha(x.a.wV)||M===w.a.Ha(x.a.CK)?(this.cHn(A),A.Ze.add(w.a.Ha(x.a.vV)),A.Ze.add(w.a.Ha(x.a.wV)),A.Ze.add(w.a.Ha(x.a.CK)),!0):!1}Mtn(A,M,Q){M=A.Bc.getPropertyString(M,x.a.ZK);A=A.Bc.getPropertyString(Q,x.a.ZK);return M||A?!0:!1}cHn(A){const M=A.Bc,Q=A.nj;var R=A.jl.value.Zd,K=A.tf.value.Zd;A=this.O6e(A.jl.value.ns,M);K=this.O6e(K,M);R=this.O6e(R,M);({vdm:R,wdm:A,xdm:K}=this.a7k(A,
K,R));R.length?(M.setPropertyUint32s(Q,x.a.CK,R),M.setPropertyUint32s(Q,x.a.vV,A),M.setPropertyUint32s(Q,x.a.wV,K)):this.KVm(Q)}O6e(A,M){const Q=M.getPropertyUint32s(A,x.a.CK),R=M.getPropertyUint32s(A,x.a.vV);A=M.getPropertyUint32s(A,x.a.wV);M=new m.a;if(!Q)return M;for(let K=0;K<Q.length;++K)M.add(new F(Q.J(K),R.J(K),A.J(K)));return M}a7k(A,M,Q){({Rei:M,Sei:O,Tei:J}=this.rth(A,M));let R,K;({Rei:Q,Sei:R,Tei:K}=this.rth(A,Q));A=this.Uol(A,O,J,R,K);var J=this.Tol(A,M,Q);A=new m.a;M=new m.a;var O=new m.a;
for(Q=0;Q<J.length;++Q)A.add(J.J(Q).position),M.add(J.J(Q).leader),O.add(J.J(Q).val);return{vdm:A,wdm:M,xdm:O}}rth(A,M){let Q,R,K;Q=new m.a;R=new l.a;K=new l.a;let J,O;for(J=O=0;J<A.length&&O<M.length;)A.J(J).position===M.J(O).position?(A.J(J).equals(M.J(O))||K.Z(A.J(J).position,M.J(O)),++J,++O):A.J(J).position<M.J(O).position?(R.Z(A.J(J).position,A.J(J)),++J):(Q.add(M.J(O)),++O);for(;J<A.length;)R.Z(A.J(J).position,A.J(J)),++J;for(;O<M.length;)Q.add(M.J(O)),++O;return{Rei:Q,Sei:R,Tei:K}}Uol(A,M,
Q,R,K){const J=new m.a;for(let O=0;O<A.length;++O){const N=A.J(O).position;M.Ja(N)||(Q.Ja(N)?J.add(Q.J(N)):R.Ja(N)||(K.Ja(N)?J.add(K.J(N)):J.add(A.J(O))))}return J}Tol(A,M,Q){M=this.k5h(M,Q);return this.k5h(A,M)}k5h(A,M){const Q=new m.a;let R,K;for(R=K=0;R<A.length&&K<M.length;)A.J(R).position<=M.J(K).position?(Q.add(A.J(R)),A.J(R).position===M.J(K).position&&++K,++R):Q.add(M.J(K++));for(;R<A.length;)Q.add(A.J(R++));for(;K<M.length;)Q.add(M.J(K++));return Q}KVm(A){A.removeProperty(x.a.CK);A.removeProperty(x.a.vV);
A.removeProperty(x.a.wV)}static ig(){return new E}static get instance(){return E.Gf.value}static YNg(A){A.Ze.add(w.a.Ha(f.a.Pl));A.Ze.add(w.a.Ha(f.a.mm));A.Ze.add(w.a.Ha(f.a.pl));A.Ze.add(w.a.Ha(x.a.Jr));A.Ze.add(w.a.Ha(x.a.yp));A.Ze.add(w.a.Ha(x.a.Ib));A.Ze.add(w.a.Ha(f.a.Nhb));A.Ze.add(w.a.Ha(x.a.nJa));A.Ze.add(w.a.Ha(x.a.jBa));A.Ze.add(w.a.Ha(f.a.Ora));A.Ze.add(w.a.Ha(x.a.yza));A.Ze.add(w.a.Ha(x.a.Sba));A.Ze.add(w.a.Ha(x.a.zza));A.Ze.add(w.a.Ha(x.a.Ixa));A.Ze.add(w.a.Ha(x.a.Aza));A.Ze.add(w.a.Ha(x.a.Jxa));
A.Ze.add(w.a.Ha(x.a.iBa));A.Ze.add(w.a.Ha(x.a.FCa));A.Ze.add(w.a.Ha(x.a.GCa));A.Ze.add(w.a.Ha(x.a.sta));A.Ze.add(w.a.Ha(x.a.Ot));A.Ze.add(w.a.Ha(x.a.ZK))}static CRi(A,M,Q,R){return(new L.a(A,M,Q,R)).Ecc()}static lld(A,M,Q){Q=M.getPropertyObjectIds(Q,f.a.mm);for(let K=0;K<Q.length;K++){var R=A.runtime.So.J(Q.Ye(K));if(R&&(R=M.getPropertyObjectId(R,x.a.ud))){A.runtime.Pac.add(R);break}}}}E.Gf=new k.a(E.ig);Object(G.a)(E,"ParagraphNodeComplexMerge",z.a,[])},1690:function(G,P,b){b.r(P);b.d(P,"MarkerValidation",
function(){return x});G=b(0);var k=b(366),f=b(1601);class x{constructor(){this.eHd=this.GOh=this.FOh=this.EOh=0}Fth(){const u=new k.a(0);u.Z("InvalidBookmarks",this.EOh);u.Z("InvalidComments",this.FOh);u.Z("InvalidContentControls",this.GOh);0!==this.eHd&&u.Z("InvalidMarkerType",this.eHd);return u}HIh(){return 0<this.EOh||0<this.FOh||0<this.GOh||0!==this.eHd?!0:!1}toString(){return JSON.stringify(f.a.Lta(this.Fth()))}}Object(G.a)(x,"MarkerValidation",null,[])},1691:function(G,P,b){b.d(P,"a",function(){return r});
G=b(0);var k=b(143),f=b(909),x=b(237),u=b(1463),w=b(1381);class r{constructor(m,l,z,F,L=null,E=null,A=null,M=null){this.Rc=m;this.WC=l;this.Dua=z;this.Vva=F;this.Fmj=L;this.Ldj=E;this.Fyj=A;this.Wma=M||this.CTe()}CTe(){return m=>!!this.Rc.runtime.Ua&&this.Rc.runtime.Ua.isFeatureEnabled(m)}Phk(){return()=>this.Rc.runtime.Ua}ZYe(){return!!this.Rc.runtime.Ci.J(x.a.dJ)}FJi(){let m;if(1===this.Rc.input.source||2===this.Rc.input.source)m=129;else if(4===this.Rc.input.source||3===this.Rc.input.source)m=
59;else if(5===this.Rc.input.source)m=204;else return!1;return this.ZYe()&&this.Wma(m)}BLi(m,...l){return String.format.apply(null,[m].concat(l))}gBd(m){const {ParagraphMerge:l}=b(1733);let z=this.Rc,F=this.Dua,L=this.Vva;m||(z=this.Fmj||this.Rc,F=this.Ldj||F,L=this.Fyj||L);var E=w.a.a9e(this.WC);const A=w.a.a9e(F),M=w.a.a9e(L);E=this.BLi("[MergeSource: {0}] [BaseRevisionId: {1}] [FavoredRevisionId: {2}] [UnfavoredRevisionId: {3}] [BaseObjects: {4}] [FavoredObjects: {5}] [UnfavoredObjects: {6}]",
z.input.source,z.runtime.Xwa.id,z.runtime.kwd,z.runtime.I6d,E.xp(),A.xp(),M.xp());return m?{returnValue:new u.a(z,this.WC,F,L,this.CTe(),new f.a),xp:E}:{returnValue:new l(z,this.WC,F,L,this.CTe(),this.Phk(),new f.a),xp:E}}Ecc(){this.Rc.logger.ihn();var m=this.FJi();var l=({xp:F}=this.gBd(m)).returnValue;k.a.instance.ua(18994389,1,3,"ParagraphMergeSelector TryDoMerge: [UseHints: {0}] {1}",m,F);this.Rc.logger.YR("ParagraphMergeSelector initialization");m?this.Rc.logger.B0d(1):this.Rc.logger.B0d(2);
let z=({Xk:l}=l.Ecc()).returnValue;this.Rc.logger.qQf();var F=!z;m=!!this.Rc.runtime.Ci.J(x.a.dJ)&&(m&&!z||!m);F&&({xp:F,returnValue:l}=this.gBd(!1),{Xk:l,returnValue:z}=l.Ecc(),k.a.instance.ua(18994390,1,z?3:2,"ParagraphMergeSelector TryDoMerge Fallback: [Success: {0}] {1}",z,F));m&&(F=new f.a,w.a.A2m(this.Rc,F));this.Rc.logger.YR("ParagraphMergeSelector finalization");return{returnValue:z,Xk:l}}zZc(m,l){let z,F,L;const E=this.FJi()&&this.Wma(205);let A=({xp:L}=this.gBd(E)).returnValue,M=({o_a:z,
Vka:F}=A.zZc(m,l)).returnValue;k.a.instance.ua(18994391,1,3,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange: [UseHints: {0}] {1}",E,L);E&&!M&&A.HMf&&({xp:L,returnValue:A}=this.gBd(!1),{o_a:z,Vka:F,returnValue:M}=A.zZc(m,l),k.a.instance.ua(18994392,1,M?3:2,"ParagraphMergeSelector UpdateCpAccordingToIncomingChange Fallback: [Success: {0}] {1}",M,L));return{returnValue:M,o_a:z,Vka:F}}}Object(G.a)(r,"ParagraphMergeSelector",null,[1868])},1692:function(G,P,b){b.r(P);b.d(P,"SurfaceStringTokenStringGenerator",
function(){return f});G=b(0);var k=b(1405);class f extends k.a{constructor(x){super(x);this.Ka=x}apply(x,u,w,r,m,l,z){null==l&&(l=x.SEh(m,u));z=k.a.$Og(x,l,this.Ka.score,w,r,z);return{AYc:l,yvc:z}}}f.zvc=0;Object(G.a)(f,"SurfaceStringTokenStringGenerator",k.a,[])},1693:function(G,P,b){b.r(P);b.d(P,"QueryTokenStringGenerator",function(){return x});G=b(0);var k=b(1405),f=b(1292);class x extends k.a{constructor(u){super(u);this.Ka=u}apply(u,w,r,m,l,z,F){w=this.Ka.query.load(w,null);l=0;let L=null;this.Ka.query.n1===
f.Annotations.uta?w&&(L=this.Ka.name):((L=this.Ka.name)&&(L+="_"),L+=this.Ka.le.I$(this.Ka.query.n1,w));null!=L&&(l=k.a.$Og(u,L,this.Ka.score,r,m,l));return{AYc:z,yvc:F+l}}}x.zvc=1;Object(G.a)(x,"QueryTokenStringGenerator",k.a,[])},1694:function(G,P,b){b.r(P);b.d(P,"FuzzyMatchTokenStringGenerator",function(){return f});G=b(0);var k=b(1405);class f extends k.a{constructor(x){super(x);this.Ka=x}apply(x,u,w,r,m,l,z){null==l&&(l=x.SEh(m,u));x=this.Ka.Mih.h9l(l);if(this.Ka.kei)for(var F of x)if(!F.jM&&
F.bxd)return{AYc:l,yvc:z};F=0;for(const L of x)if(L.jM&&!({SNe:F}=this.TTg(L,!0,w,r,F)).returnValue)return{AYc:l,yvc:z};if(this.Ka.RLh)for(const L of x)if(!({SNe:F}=this.TTg(L,!1,w,r,F)).returnValue)break;return{AYc:l,yvc:z}}TTg(x,u,w,r,m){let l;u?(u=0,l=x.bxd?1:0):(u=x.bxd?1:0,l=x.count-u);for(let z=0;z<l;++z)if(k.a.aPg(x.S$a+u+z,this.Ka.score,w,r),++m,0<this.Ka.Erf&&m>=this.Ka.Erf)return{returnValue:!1,SNe:m};return{returnValue:!0,SNe:m}}}f.zvc=2;Object(G.a)(f,"FuzzyMatchTokenStringGenerator",k.a,
[])},1724:function(G,P,b){G=b(0);var k=b(6),f=b(42),x=b(231),u=b(1291);class w extends u.a{constructor(){super()}get $l(){return 2}get Yx(){return 7}static ig(){return new w}static get instance(){return w.Gf.value}}w.Gf=new x.a(w.ig);Object(G.a)(w,"AppBindingNodeComplexMerge",u.a,[]);var r=b(17),m=b(724),l=b(143),z=b(1344);class F extends u.a{constructor(){super()}get $l(){return 3}get Yx(){return 7}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(r.a.z4),1);return Cb}zz(Cb,gc){if(gc===m.a.Ha(r.a.z4)){const Ub=
Cb.nj;var Dc=Cb.Bc;l.a.instance.ua(6633221,1,3,"AppNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Ub.id,Ub.Gb,gc);gc=Dc.getPropertyMilliseconds(Cb.tf.value.Zd,r.a.z4);Dc=Dc.getPropertyMilliseconds(Cb.jl.value.Zd,r.a.z4);gc<Dc&&this.VVk(Cb);Cb.Ze.add(m.a.Ha(r.a.z4));return!0}l.a.instance.ua(6633222,1,1,"AppNodeComplexMerge: Failed to merge AppNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.Zd.id,gc);return!1}VVk(Cb){this.C_m(Cb.jl.value.Zd,
Cb.nj);this.f6e(Cb,k.a.WJe);this.f6e(Cb,k.a.cSg);this.f6e(Cb,k.a.URg)}f6e(Cb,gc){var Dc=Cb.Bc,Ub=Cb.nj;if(Dc.hasProperty(Ub,gc)&&(gc=Dc.getPropertyObjectIds(Ub,gc))&&gc.length)for(Dc=Cb.vm.runtime.So,Cb=Cb.vm.runtime.Xk,Ub=0;Ub<gc.length;Ub++){const Bb=gc.J(Ub);if(!Dc.Ja(Bb))continue;const fb=Dc.J(Bb).dF();Cb.add(Bb,new z.a(fb,!1))}}static ig(){return new F}static get instance(){return F.Gf.value}}F.Gf=new x.a(F.ig);Object(G.a)(F,"AppNodeComplexMerge",u.a,[]);class L extends u.a{constructor(){super()}get $l(){return 4}get Yx(){return 7}static ig(){return new L}static get instance(){return L.Gf.value}}
L.Gf=new x.a(L.ig);Object(G.a)(L,"AppPropNodeComplexMerge",u.a,[]);class E extends u.a{constructor(){super()}get $l(){return 5}get Yx(){return 7}static ig(){return new E}static get instance(){return E.Gf.value}}E.Gf=new x.a(E.ig);Object(G.a)(E,"AppRefNodeComplexMerge",u.a,[]);var A=b(366),M=b(574),Q=b(202),R=b(16);class K{constructor(Cb,gc){this.id=Cb;this.Xvn=gc}}Object(G.a)(K,"IdAndTime",null,[]);class J extends u.a{constructor(){super()}get $l(){return 6}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.XSa),
1);return Cb}zz(Cb,gc){if(gc===m.a.Ha(k.a.XSa)){const Dc=Cb.nj,Ub=Cb.Bc;l.a.instance.ua(6633224,1,3,"AppsNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Dc.id,Dc.Gb,gc);gc=Ub.getPropertyObjectIds(Cb.tf.value.ns,k.a.XSa);const Bb=Ub.getPropertyObjectIds(Cb.tf.value.Zd,k.a.XSa),fb=Ub.getPropertyObjectIds(Cb.jl.value.Zd,k.a.XSa);gc=this.tcm(Cb,gc,Bb,fb);0<gc.length?Ub.setPropertyObjectIds(Dc,k.a.XSa,gc):Dc.removeProperty(k.a.XSa);Cb.Ze.add(m.a.Ha(k.a.XSa));
return!0}l.a.instance.ua(6633225,1,1,"AppsNodeComplexMerge: Failed to merge AppsNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.Zd.id,gc);return!1}tcm(Cb,gc,Dc,Ub){const Bb=this.vAa(gc,Dc,Ub),fb=gc.yz(),yb=Dc.yz(),Wb=Ub.yz();gc=u.a.filter(Bb,Bc=>!fb.contains(Bc)&&yb.contains(Bc));Dc=u.a.filter(Bb,Bc=>!fb.contains(Bc)&&Wb.contains(Bc));if(!gc.length||!Dc.length)return Bb;const Xb=new A.a;gc.forEach(Bc=>{const pd=new K(Bc,this.qqh(Cb,Bc,!1));this.nqh(Cb,Bc,!1).forEach(zd=>
{Xb.add(zd,pd);return!0});return!0});const Cc=new M.a;Dc.forEach(Bc=>{const pd=this.qqh(Cb,Bc,!0);this.nqh(Cb,Bc,!0).forEach(zd=>Xb.Ja(zd)?(Cc.add(Xb.J(zd).Xvn>=pd?Bc:Xb.J(zd).id),!1):!0);return!0});return u.a.filter(Bb,Bc=>!Cc.contains(Bc))}qqh(Cb,gc,Dc){return(gc=this.Kya(Cb,gc,Dc))?Cb.Bc.getPropertyMilliseconds(gc,r.a.z4):0}Kya(Cb,gc,Dc){Cb=Dc?Cb.vm.runtime.So:Cb.vm.runtime.xr;return Cb.Ja(gc)?Cb.J(gc):null}nqh(Cb,gc,Dc){const Ub=new Q.a,Bb=new M.a,fb=Cb.Bc;gc=this.Kya(Cb,gc,Dc);var yb=this.uBh(fb,
gc);if(yb)for(Ub.add(yb),Bb.add(yb),gc=fb.getPropertyObjectIds(gc,k.a.WJe),yb=0;gc&&yb<gc.length;yb++){const Wb=this.uBh(fb,this.Kya(Cb,gc.J(yb),Dc));if(!Wb)break;Bb.contains(Wb)||(Ub.add(Wb),Bb.add(Wb))}return Ub}uBh(Cb,gc){if(!Cb.hasProperty(gc,k.a.RTb)||!Cb.hasProperty(gc,k.a.Xld)||!Cb.hasProperty(gc,k.a.Yld))return null;const Dc=Cb.getPropertyString(gc,k.a.RTb),Ub=Cb.getPropertyString(gc,k.a.Xld);Cb=Cb.getPropertyString(gc,k.a.Yld);return R.a.zy(Dc+";"+Ub+";"+Cb)}static ig(){return new J}static get instance(){return J.Gf.value}}
J.Gf=new x.a(J.ig);Object(G.a)(J,"AppsNodeComplexMerge",u.a,[]);class O extends u.a{constructor(){super()}get $l(){return 36}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.Z_f),1);Cb.Z(m.a.Ha(k.a.GQf),1);return Cb}zz(Cb,gc){l.a.instance.ua(51430790,1,3,"AutoSaveParametersNode PropertyId {0}: Using CustomMerge Strategy",gc);if(gc===m.a.Ha(k.a.Z_f)||gc===m.a.Ha(k.a.GQf)){const fb=m.a.lO(gc);var Dc=Cb.tf.value.Zd,Ub=Cb.jl.value.Zd;const yb=Cb.nj;var Bb=Cb.Bc.getPropertyStrings(Cb.tf.value.ns,fb);Dc=Cb.Bc.getPropertyStrings(Dc,
fb);Ub=Cb.Bc.getPropertyStrings(Ub,fb);Bb=this.vAa(Bb,Dc,Ub);Cb.Bc.setPropertyStrings(yb,fb,Bb);Cb.Ze.add(gc);return!0}return!1}static ig(){return new O}static get instance(){return O.Gf.value}}O.Gf=new x.a(O.ig);Object(G.a)(O,"AutoSaveParametersNodeComplexMerge",u.a,[]);class N extends u.a{constructor(){super()}get $l(){return 44}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(r.a.ge),1);return Cb}zz(Cb,gc){const Dc=Cb.vm.runtime.Ua;if(gc===m.a.Ha(r.a.ge))return l.a.instance.ua(589608865,1,3,"BookmarkContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Cb.nj.id,Cb.nj.Gb,gc),Dc.ks(210),Dc.isFeatureEnabled(210)?this.wcm(Cb,gc):this.Scm(Cb,gc),!0;l.a.instance.ua(589608912,1,1,"BookmarkContainerNodeComplexMerge: Failed to merge BookmarkContainer [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Cb.tf.value.Zd.id,gc);return!1}wcm(Cb,gc){const Dc=m.a.lO(gc),Ub=Cb.Bc;var Bb=Ub.getPropertyObjectIds(Cb.tf.value.ns,Dc),fb=Ub.getPropertyObjectIds(Cb.tf.value.Zd,Dc),yb=Ub.getPropertyObjectIds(Cb.jl.value.Zd,Dc);yb=N.pkl(Cb,fb,yb);Bb=this.vAa(Bb,fb,
yb);fb=Cb.nj;0<Bb.length?Ub.setPropertyObjectIds(fb,Dc,Bb):fb.removeProperty(Dc);Cb.Ze.add(gc)}static ig(){return new N}static get instance(){return N.Gf.value}static pkl(Cb,gc,Dc){const Ub=new Q.a,Bb=new A.a;gc.forEach(fb=>{const yb=Cb.vm.runtime.xr.J(fb);yb&&Bb.add(yb.PG(k.a.Vr).toString(),fb);return!0});Dc.forEach(fb=>{var yb=Cb.vm.runtime.So.J(fb);yb?(yb=yb.PG(k.a.Vr).toString(),Bb.Ja(yb)&&Bb.get(yb)!==fb?l.a.instance.ua(557061773,1,3,"BookmarkContainerNodeComplexMerge: Similar name bookmark found during merge, skipping conflict revision bookmark"):
Ub.add(fb)):Ub.add(fb);return!0});return Ub}}N.Gf=new x.a(N.ig);Object(G.a)(N,"BookmarkContainerNodeComplexMerge",u.a,[]);class V extends u.a{constructor(){super()}get $l(){return 41}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.Gsb),1);Cb.Z(m.a.Ha(k.a.Vr),1);Cb.Z(m.a.Ha(k.a.z5),1);Cb.Z(m.a.Ha(k.a.Zxa),1);return Cb}zz(Cb,gc){return gc===m.a.Ha(k.a.Gsb)?(Cb.Ze.add(m.a.Ha(k.a.Gsb)),!0):gc===m.a.Ha(k.a.Vr)?(Cb.Ze.add(m.a.Ha(k.a.Vr)),!0):!1}ve(Cb){return Cb&&Cb.length?!1:!0}static ig(){return new V}static get instance(){return V.Gf.value}}
V.Gf=new x.a(V.ig);Object(G.a)(V,"BookmarkNodeComplexMerge",u.a,[]);class W extends u.a{constructor(){super();this.QHd=!1}get $l(){return 7}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(r.a.ge),1);return Cb}zz(Cb,gc){if(gc===m.a.Ha(r.a.ge)){const Bb=Cb.nj,fb=Cb.Bc;var Dc=Cb.vm.runtime.Ua;Dc&&(this.QHd=Dc.isFeatureEnabled(121));l.a.instance.ua(4511579,1,3,"CommentContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Bb.id,Bb.Gb,gc);gc=fb.getPropertyObjectIds(Cb.tf.value.ns,
r.a.ge);Dc=fb.getPropertyObjectIds(Cb.tf.value.Zd,r.a.ge);var Ub=fb.getPropertyObjectIds(Cb.jl.value.Zd,r.a.ge);gc=this.Gcm(gc,Dc,Ub);if(this.QHd&&0<gc.length){Dc=new Sys.StringBuilder;for(Ub=0;Ub<gc.length;Ub++)Dc.append(gc.J(Ub).toString()+",");l.a.instance.ua(559710276,1,3,"Merge result for CommentContentNode {0}: {1}",Bb.id,Dc.toString())}0<gc.length?fb.setPropertyObjectIds(Bb,r.a.ge,gc):Bb.removeProperty(r.a.ge);Cb.Ze.add(m.a.Ha(r.a.ge));return!0}l.a.instance.ua(4511580,1,1,"CommentContentNodeComplexMerge: Failed to merge CommentContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Cb.tf.value.Zd.id,gc);return!1}Gcm(Cb,gc,Dc){const Ub=new Q.a,Bb=new A.a(0);this.dHk(Cb,Dc,Ub,Bb);return this.ytk(gc,Bb,Ub)}dHk(Cb,gc,Dc,Ub){Cb=Cb||new Q.a;gc=gc||new Q.a;Cb.forEach(Bb=>{Ub.Z(Bb,1);return!0});gc.forEach(Bb=>{Ub.Ab(Bb).returnValue?Ub.Z(Bb,2):(Ub.Z(Bb,0),Dc.add(Bb));return!0})}ytk(Cb,gc,Dc){Cb=Cb||new Q.a;const Ub=new Q.a,Bb=new Q.a,fb=new Q.a;Cb.forEach(yb=>{let Wb=!0,Xb;({value:Xb}=gc.Ab(yb)).returnValue&&(0===Xb?gc.Z(yb,2):1===Xb&&(Wb=!1));Wb?Ub.add(yb):this.QHd&&Bb.add(yb);return!0});
Dc.forEach(yb=>{let Wb=!1,Xb;({value:Xb}=gc.Ab(yb)).returnValue?0===Xb&&(Wb=!0,gc.Z(yb,2)):l.a.instance.ua(4511585,1,3,"DetermineMergedListOfCommentNodes: Expected to find Conflicting Comment with [ObjectID: {0}] in conflictChangesMap, but it was not there.",yb);Wb?Ub.add(yb):this.QHd&&fb.add(yb);return!0});this.F1h(Bb,"Favored");this.F1h(fb,"Unfavored");return Ub}F1h(Cb,gc){if(Cb.length){var Dc=new Sys.StringBuilder;for(let Ub=0;Ub<Cb.length;Ub++)Dc.append(Cb.J(Ub).toString()+",");l.a.instance.ua(561637572,
1,3,"DetermineMergedListOfCommentNodes: Removed {0} ObjectIds: {1}",gc,Dc.toString())}}static ig(){return new W}static get instance(){return W.Gf.value}}W.Gf=new x.a(W.ig);Object(G.a)(W,"CommentContentNodeComplexMerge",u.a,[]);class ca extends u.a{constructor(){super()}get $l(){return 8}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.J7),3);Cb.Z(m.a.Ha(k.a.JD),3);Cb.Z(m.a.Ha(k.a.Xwc),2);Cb.Z(m.a.Ha(k.a.commentId),2);Cb.Z(m.a.Ha(k.a.y4g),2);Cb.Z(m.a.Ha(k.a.Vwa),2);Cb.Z(m.a.Ha(k.a.BHa),1);Cb.Z(m.a.Ha(k.a.zbb),
1);Cb.Z(m.a.Ha(k.a.Bcb),1);Cb.Z(m.a.Ha(k.a.C3),1);Cb.Z(m.a.Ha(k.a.BF),1);Cb.Z(m.a.Ha(k.a.Wwc),2);Cb.Z(m.a.Ha(k.a.cqd),2);Cb.Z(m.a.Ha(k.a.JVb),2);Cb.Z(m.a.Ha(k.a.XQe),2);Cb.Z(m.a.Ha(k.a.YL),1);Cb.Z(m.a.Ha(r.a.ge),0);Cb.Z(m.a.Ha(k.a.fF),0);return Cb}zz(Cb,gc){if(gc===m.a.Ha(k.a.YL)){var Dc=Cb.Bc.getPropertyString(Cb.jl.value.Zd,k.a.YL);this.ve(Dc)?Cb.nj.removeProperty(k.a.YL):Cb.nj.b$(k.a.YL,Dc);return!0}if(gc!==m.a.Ha(k.a.BHa)&&gc!==m.a.Ha(k.a.zbb)&&gc!==m.a.Ha(k.a.Bcb)&&gc!==m.a.Ha(k.a.BF)&&gc!==
m.a.Ha(k.a.C3))return!1;var Ub=Cb.tf.value.Zd,Bb=Cb.jl.value.Zd;Dc=Cb.nj;if(gc===m.a.Ha(k.a.BHa)){Ub=Cb.Bc.getPropertyString(Ub,k.a.BHa);Bb=Cb.Bc.getPropertyString(Bb,k.a.BHa);Bb=this.ve(Ub)?Bb:this.ve(Bb)?Ub:null;if(this.ve(Bb))return!0;Cb.Bc.setPropertyString(Dc,k.a.BHa,Bb);Cb.Ze.add(m.a.Ha(k.a.BHa));return!0}if(gc===m.a.Ha(k.a.Bcb))return Ub=Cb.Bc.getPropertyBool(Ub,k.a.Bcb),Bb=Cb.Bc.getPropertyBool(Bb,k.a.Bcb),Ub=null!=Ub?Ub:!1,Ub=(null!=Bb?Bb:!1)||Ub,Cb.Bc.setPropertyBool(Dc,k.a.Bcb,Ub),Cb.Ze.add(m.a.Ha(k.a.Bcb)),
!0;if(gc===m.a.Ha(k.a.zbb)){Ub=Cb.Bc.getPropertyBool(Ub,k.a.zbb);Bb=Cb.Bc.getPropertyBool(Bb,k.a.zbb);if(Ub===Bb)return!0;Ub=null!=Ub?Ub:!1;Ub=(null!=Bb?Bb:!1)||Ub;Cb.Bc.setPropertyBool(Dc,k.a.zbb,Ub);return!0}if(gc===m.a.Ha(k.a.BF)){Ub=Cb.Bc.getPropertyBool(Ub,k.a.BF);Bb=Cb.Bc.getPropertyBool(Bb,k.a.BF);if(Ub===Bb)return!0;Ub=null!=Ub?Ub:!1;Ub=(null!=Bb?Bb:!1)||Ub;Cb.Bc.setPropertyBool(Dc,k.a.BF,Ub);Cb.Ze.add(m.a.Ha(k.a.BF));return!0}if(gc===m.a.Ha(k.a.C3)){gc=Cb.vm.runtime.Ua;gc.ks(27);if(!gc.isFeatureEnabled(27))return!1;
Ub=Cb.Bc.getPropertyString(Ub,k.a.C3);Bb=Cb.Bc.getPropertyString(Bb,k.a.C3);if(Ub===Bb)return!0;Cb.Bc.setPropertyString(Dc,k.a.C3,Bb||Ub);Cb.Ze.add(m.a.Ha(k.a.C3));return!0}return!1}ve(Cb){return Cb&&Cb.length?!1:!0}static ig(){return new ca}static get instance(){return ca.Gf.value}}ca.Gf=new x.a(ca.ig);Object(G.a)(ca,"CommentNodeComplexMerge",u.a,[]);class H extends u.a{constructor(){super()}get $l(){return 46}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.contentControlNode),1);Cb.Z(m.a.Ha(r.a.lastModifiedTime),
0);Cb.Z(m.a.Ha(k.a.zxc),2);return Cb}zz(Cb,gc){if(gc===m.a.Ha(k.a.contentControlNode))return l.a.instance.ua(556865370,1,3,"ContentControlContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cb.nj.id,Cb.nj.Gb,gc),u.a.Yrf(Cb,this,k.a.contentControlNode);l.a.instance.ua(556865371,1,1,"ContentControlContainerNodeComplexMerge: Failed to merge ContentControlContainerNode [Id: {0}].Custom merge is not handled on [PropertyId: {1}]",Cb.tf.value.Zd.id,gc);return!1}static ig(){return new H}static get instance(){return H.Gf.value}}
H.Gf=new x.a(H.ig);Object(G.a)(H,"ContentControlContainerNodeComplexMerge",u.a,[]);var Z=b(51),aa=b(1587);class ja extends u.a{constructor(){super();this.Uga=null}Fmf(Cb){null==this.Uga&&(Cb?(Cb.ks(34),this.Uga=Cb.isFeatureEnabled(34)):(this.Uga=!1,l.a.instance.ua(528761235,1,2,"Feature helper is null")));return this.Uga}get $l(){return 37}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.F3),1);Cb.Z(m.a.Ha(k.a.Ti),1);Cb.Z(m.a.Ha(k.a.yh),1);Cb.Z(m.a.Ha(k.a.jIb),1);Cb.Z(m.a.Ha(k.a.Hqd),2);Cb.Z(m.a.Ha(k.a.Axc),
2);Cb.Z(m.a.Ha(k.a.contentControlNode),1);Cb.Z(m.a.Ha(k.a.k4),1);Cb.Z(m.a.Ha(k.a.Iba),1);Cb.Z(m.a.Ha(k.a.cWb),1);Cb.Z(m.a.Ha(k.a.Dxc),1);Cb.Z(m.a.Ha(k.a.j9a),1);Cb.Z(m.a.Ha(k.a.i9a),1);Cb.Z(m.a.Ha(k.a.lSe),2);Cb.Z(m.a.Ha(k.a.Cxc),1);Cb.Z(m.a.Ha(k.a.Iqd),1);Cb.Z(m.a.Ha(k.a.Iha),1);return Cb}zz(Cb,gc){var Dc=Cb.tf.value.Zd,Ub=Cb.jl.value.Zd;const Bb=Cb.nj;if(gc===m.a.Ha(k.a.contentControlNode))return u.a.Yrf(Cb,this,k.a.contentControlNode);if(gc===m.a.Ha(k.a.k4)){gc=Cb.Bc.getPropertyBool(Dc,k.a.k4);
Ub=Cb.Bc.getPropertyBool(Ub,k.a.k4);if(null!=gc&&gc||null!=Ub&&Ub)Cb.Bc.setPropertyBool(Bb,k.a.k4,!0),Cb.Ze.add(m.a.Ha(k.a.k4));return!0}if(gc===m.a.Ha(k.a.Iba))return gc=Cb.Bc.getPropertyBool(Dc,k.a.Iba),Ub=Cb.Bc.getPropertyBool(Ub,k.a.Iba),Cb.Bc.setPropertyBool(Bb,k.a.Iba,null!=gc&&!!gc&&null!=Ub&&!!Ub),Cb.Ze.add(m.a.Ha(k.a.Iba)),!0;if(gc===m.a.Ha(k.a.cWb))return gc=Cb.Bc.getPropertyUint32(Ub,k.a.cWb),null!=gc&&(Cb.Bc.setPropertyUint32(Bb,k.a.cWb,gc),Cb.Ze.add(m.a.Ha(k.a.cWb))),!0;if(gc===m.a.Ha(k.a.Dxc)||
gc===m.a.Ha(k.a.j9a)||gc===m.a.Ha(k.a.i9a))return(Ub=Cb.Bc.getPropertyString(Ub,m.a.lO(gc)))&&0<Ub.length&&(Cb.Bc.setPropertyString(Bb,m.a.lO(gc),Ub),Cb.Ze.add(gc)),!0;if(gc===m.a.Ha(k.a.Cxc)||gc===m.a.Ha(k.a.Iqd)){var fb=Cb.Bc.getPropertyObjectId(Dc,m.a.lO(gc));if(aa.a.QZb(Cb.vm,fb))return!0;if((Ub=Cb.Bc.getPropertyObjectId(Ub,m.a.lO(gc)))&&Ub!==Z.a.nil)return Cb.Bc.setPropertyObjectId(Bb,m.a.lO(gc),Ub),Cb.Ze.add(gc),!0;Bb.removeProperty(m.a.lO(gc));Cb.Ze.add(gc);return!0}if(gc===m.a.Ha(k.a.Iha)){fb=
Cb.Bc.getPropertyObjectId(Dc,k.a.Iha);if((fb=aa.a.QZb(Cb.vm,fb))&&Cb.Bc.getPropertyObjectIds(fb,k.a.contentControlNode).yz().contains(Cb.nj.id))return!0;Ub=Cb.Bc.getPropertyObjectId(Ub,k.a.Iha);return(fb=aa.a.QZb(Cb.vm,Ub))&&Cb.Bc.getPropertyObjectIds(fb,k.a.contentControlNode).yz().contains(Cb.nj.id)?(Cb.Bc.setPropertyObjectId(Bb,k.a.Iha,Ub),Cb.Ze.add(gc),!0):!1}if(gc===m.a.Ha(k.a.F3))return gc=Cb.Bc.getPropertyBool(Ub,k.a.F3),null==gc||gc||(Cb.Bc.setPropertyBool(Bb,k.a.F3,!1),Cb.Ze.add(m.a.Ha(k.a.F3))),
!0;if(gc===m.a.Ha(k.a.jIb)){gc=Cb.Bc.getPropertyObjectId(Dc,k.a.jIb);Ub=Cb.Bc.getPropertyObjectId(Ub,k.a.jIb);if(gc&&!gc.equals(Ub))return!1;if(gc=gc||Ub)Cb.Bc.setPropertyObjectId(Bb,k.a.jIb,gc),Cb.Ze.add(m.a.Ha(k.a.jIb));return!0}if(this.Fmf(Cb.vm.runtime.Ua)&&(gc===m.a.Ha(k.a.Ti)||gc===m.a.Ha(k.a.yh)))return Bb.removeProperty(m.a.lO(gc)),Cb.Ze.add(gc),!0;if(!this.Fmf(Cb.vm.runtime.Ua)&&(gc===m.a.Ha(k.a.Ti)||gc===m.a.Ha(k.a.yh))){fb=m.a.lO(gc);Dc=Cb.Bc.getPropertyObjectId(Dc,fb);Ub=Cb.Bc.getPropertyObjectId(Ub,
fb);const yb=this.ZUh(Cb,Cb.nj.id,Dc),Wb=this.ZUh(Cb,Cb.nj.id,Ub);if(Dc&&Dc.equals(Ub))return!0;if(Dc&&!Cb.vm.runtime.Xk.get(Dc)||yb&&Wb)return!1;(Ub=yb?Dc:Wb?Ub:null)?Cb.Bc.setPropertyObjectId(Bb,fb,Ub):Bb.removeProperty(fb);Cb.Ze.add(gc);return!0}return!1}ZUh(Cb,gc,Dc){if(!Dc)return!1;const Ub=Cb.vm.runtime.Xk;Dc=Ub.get(Dc);if(!Dc||!Dc.ik)return!1;Dc=Cb.Bc.getPropertyObjectIds(Dc.ik,r.a.mm);if(!Dc)return!1;for(let fb=0;fb<Dc.length;fb++){var Bb=Dc.J(fb);if((Bb=Ub.get(Bb))&&Bb.ik&&(Bb=Cb.Bc.getPropertyObjectId(Bb.ik,
k.a.ud))&&Bb.equals(gc))return!0}return!1}static ig(){return new ja}static get instance(){return ja.Gf.value}}ja.Gf=new x.a(ja.ig);Object(G.a)(ja,"ContentControlNodeComplexMerge",u.a,[]);class Ba extends u.a{constructor(){super()}get $l(){return 10}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.customXmlPartNode),1);return Cb}zz(Cb,gc){if(gc===m.a.Ha(k.a.customXmlPartNode)){gc=Cb.nj;const Ub=Cb.Bc;var Dc=Ub.getPropertyObjectIds(Cb.tf.value.ns,k.a.customXmlPartNode);const Bb=Ub.getPropertyObjectIds(Cb.tf.value.Zd,
k.a.customXmlPartNode),fb=Ub.getPropertyObjectIds(Cb.jl.value.Zd,k.a.customXmlPartNode);Dc=this.Lcm(Dc,Bb,fb);0<Dc.length?Ub.setPropertyObjectIds(gc,k.a.customXmlPartNode,Dc):gc.removeProperty(k.a.customXmlPartNode);Cb.Ze.add(m.a.Ha(k.a.customXmlPartNode));return!0}return!1}Lcm(Cb,gc,Dc){return this.vAa(Cb,gc,Dc)}static ig(){return new Ba}static get instance(){return Ba.Gf.value}}Ba.Gf=new x.a(Ba.ig);Object(G.a)(Ba,"CustomXmlPartContainerNodeComplexMerge",u.a,[]);class la extends u.a{constructor(){super()}get $l(){return 9}get Yx(){return 0}static ig(){return new la}static get instance(){return la.Gf.value}}
la.Gf=new x.a(la.ig);Object(G.a)(la,"CustomXmlPartNodeComplexMerge",u.a,[]);class ia extends u.a{constructor(){super()}get $l(){return 29}get Yx(){return 3}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.embeddedFontNode),1);return Cb}zz(Cb,gc){if(gc===m.a.Ha(k.a.embeddedFontNode)){gc=Cb.Bc;var Dc=gc.getPropertyObjectIds(Cb.tf.value.ns,k.a.embeddedFontNode),Ub=gc.getPropertyObjectIds(Cb.tf.value.Zd,k.a.embeddedFontNode);const Bb=gc.getPropertyObjectIds(Cb.jl.value.Zd,k.a.embeddedFontNode);Dc=this.vAa(Dc,
Ub,Bb);Ub=Cb.nj;0<Dc.length?gc.setPropertyObjectIds(Ub,k.a.embeddedFontNode,Dc):Ub.removeProperty(k.a.embeddedFontNode);Cb.Ze.add(m.a.Ha(k.a.embeddedFontNode));return!0}return!1}static ig(){return new ia}static get instance(){return ia.Gf.value}}ia.Gf=new x.a(ia.ig);Object(G.a)(ia,"EmbeddedFontContainerNodeComplexMerge",u.a,[]);class oa extends u.a{constructor(){super()}get $l(){return 30}get Yx(){return 3}static ig(){return new oa}static get instance(){return oa.Gf.value}}oa.Gf=new x.a(oa.ig);Object(G.a)(oa,
"EmbeddedFontNodeComplexMerge",u.a,[]);class ha extends u.a{constructor(){super()}get $l(){return 11}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.S3),4);Cb.Z(m.a.Ha(k.a.nVa),1);return Cb}zz(Cb,gc){if(gc===m.a.Ha(k.a.nVa)){const Dc=Cb.nj,Ub=Cb.Bc;l.a.instance.ua(4063307,1,3,"FootnoteEndnoteContainerNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Dc.id,Dc.Gb,gc);gc=Ub.getPropertyObjectIds(Cb.tf.value.ns,k.a.nVa);const Bb=Ub.getPropertyObjectIds(Cb.tf.value.Zd,
k.a.nVa),fb=Ub.getPropertyObjectIds(Cb.jl.value.Zd,k.a.nVa);gc=this.i5h(gc,Bb,fb,(yb,Wb)=>yb.equals(Wb));0<gc.length?Ub.setPropertyObjectIds(Dc,k.a.nVa,gc):Dc.removeProperty(k.a.nVa);Cb.Ze.add(m.a.Ha(k.a.nVa));return!0}l.a.instance.ua(4063308,1,1,"FootnoteEndnoteContainerNodeComplexMerge: Failed to merge FootnoteEndnoteContainer [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.Zd.id,gc);return!1}static ig(){return new ha}static get instance(){return ha.Gf.value}}ha.Gf=new x.a(ha.ig);
Object(G.a)(ha,"FootnoteEndnoteContainerNodeComplexMerge",u.a,[]);class pa extends u.a{constructor(){super()}get $l(){return 12}get Yx(){return 3}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.via),1);return Cb}zz(Cb,gc){const Dc=Cb.nj,Ub=Cb.Bc;if(gc===m.a.Ha(k.a.via)){let Bb=-1;l.a.instance.ua(5002527,1,3,"FootnoteEndnoteNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Dc.id,Dc.Gb,gc);const fb=Ub.getPropertyInt32(Cb.tf.value.Zd,k.a.via),yb=Ub.getPropertyInt32(Cb.jl.value.Zd,
k.a.via);null!=fb&&-1!==fb?Bb=fb:null!=yb&&(Bb=yb);Ub.setPropertyInt32(Dc,k.a.via,Bb);Cb.Ze.add(gc);return!0}l.a.instance.ua(5002528,1,3,"FootnoteEndnoteNodeComplexMerge: Failed to merge FootnoteEndnoteNodeComplexMerge [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.ns.id,gc);return!1}static ig(){return new pa}static get instance(){l.a.instance.ua(5002526,1,3,"FootnoteEndnoteNodeComplexMerge: Got Instance");return pa.Gf.value}}pa.Gf=new x.a(pa.ig);Object(G.a)(pa,"FootnoteEndnoteNodeComplexMerge",
u.a,[]);class Ea extends u.a{constructor(){super()}get $l(){return 47}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.glossaryPageContentNode),1);return Cb}zz(Cb,gc){return gc===m.a.Ha(k.a.glossaryPageContentNode)?(l.a.instance.ua(525099865,1,3,"GlossaryPageManifestNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Cb.nj.id,Cb.nj.Gb,gc),u.a.Yrf(Cb,this,k.a.glossaryPageContentNode)):!1}static ig(){return new Ea}static get instance(){return Ea.Gf.value}}Ea.Gf=new x.a(Ea.ig);
Object(G.a)(Ea,"GlossaryPageManifestNodeComplexMerge",u.a,[]);class Fa extends u.a{constructor(){super()}get $l(){return 13}get Yx(){return 3}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.pea),4);return Cb}static ig(){return new Fa}static get instance(){return Fa.Gf.value}}Fa.Gf=new x.a(Fa.ig);Object(G.a)(Fa,"HeaderFooterContainerNodeComplexMerge",u.a,[]);class Ga extends u.a{constructor(){super()}get $l(){return 14}get Yx(){return 3}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.runId),3);Cb.Z(m.a.Ha(k.a.Ib),
3);Cb.Z(m.a.Ha(k.a.yPh),3);Cb.Z(m.a.Ha(k.a.DR),1);Cb.Z(m.a.Ha(f.a.CX),1);Cb.Z(m.a.Ha(r.a.imageAltText),1);Cb.Z(m.a.Ha(k.a.BX),1);Cb.Z(m.a.Ha(r.a.T4),1);Cb.Z(m.a.Ha(f.a.D1a),1);Cb.Z(m.a.Ha(k.a.U7a),1);return Cb}zz(Cb,gc){if(gc===m.a.Ha(r.a.imageAltText)||gc===m.a.Ha(k.a.BX)||gc===m.a.Ha(k.a.DR)||gc===m.a.Ha(k.a.WU)||gc===m.a.Ha(r.a.Mbb)||gc===m.a.Ha(r.a.T4)||gc===m.a.Ha(f.a.CX)||gc===m.a.Ha(f.a.D1a)||gc===m.a.Ha(k.a.U7a)){const Ub=Cb.nj;var Dc=Cb.Bc;l.a.instance.ua(4018185,1,3,"ImageNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Ub.id,Ub.Gb,gc);const Bb=Dc.getPropertyInt32(Cb.tf.value.Zd,f.a.CX);Dc=Dc.getPropertyInt32(Cb.jl.value.Zd,f.a.CX);if(null!=Bb&&(0===Bb||2===Bb))return!0;if(null!=Dc&&(0===Dc||2===Dc))return gc=Cb.jl.value.Zd,this.p9a(gc,Ub,r.a.imageAltText),this.p9a(gc,Ub,k.a.BX),this.p9a(gc,Ub,k.a.WU),gc.hasProperty(k.a.DR)&&this.p9a(gc,Ub,k.a.DR),this.p9a(gc,Ub,r.a.Mbb),this.p9a(gc,Ub,r.a.T4),this.p9a(gc,Ub,f.a.CX),this.p9a(gc,Ub,f.a.D1a),Cb.Ze.add(m.a.Ha(r.a.imageAltText)),Cb.Ze.add(m.a.Ha(k.a.BX)),Cb.Ze.add(m.a.Ha(k.a.WU)),
Cb.Ze.add(m.a.Ha(k.a.DR)),Cb.Ze.add(m.a.Ha(r.a.Mbb)),Cb.Ze.add(m.a.Ha(r.a.T4)),Cb.Ze.add(m.a.Ha(f.a.CX)),Cb.Ze.add(m.a.Ha(f.a.D1a)),Cb.Ze.add(m.a.Ha(k.a.U7a)),!0}l.a.instance.ua(4018186,1,3,"ImageNodeComplexMerge: Failed to merge ImageNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.ns.id,gc);return!1}static ig(){return new Ga}static get instance(){return Ga.Gf.value}}Ga.Gf=new x.a(Ga.ig);Object(G.a)(Ga,"ImageNodeComplexMerge",u.a,[]);class $a extends u.a{constructor(){super()}get $l(){return 40}get Yx(){return 0}static ig(){return new $a}static get instance(){return $a.Gf.value}}
$a.Gf=new x.a($a.ig);Object(G.a)($a,"IntelligenceAnnotationNodeComplexMerge",u.a,[]);class fa extends u.a{constructor(){super()}get $l(){return 32}get Yx(){return 0}static ig(){return new fa}static get instance(){return fa.Gf.value}}fa.Gf=new x.a(fa.ig);Object(G.a)(fa,"IntelligenceContentLocatorNodeComplexMerge",u.a,[]);class sa extends u.a{constructor(){super()}get $l(){return 34}get Yx(){return 0}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.mcb),1);return Cb}zz(Cb,gc){const Dc=Cb.nj,Ub=Cb.Bc;if(gc===
m.a.Ha(k.a.mcb)){gc=Ub.getPropertyObjectIds(Cb.tf.value.ns,k.a.mcb);const Bb=Ub.getPropertyObjectIds(Cb.tf.value.Zd,k.a.mcb),fb=Ub.getPropertyObjectIds(Cb.jl.value.Zd,k.a.mcb);gc=this.vAa(gc,Bb,fb);Ub.setPropertyObjectIds(Dc,k.a.mcb,gc);Cb.Ze.add(m.a.Ha(k.a.mcb));return!0}return!1}static ig(){return new sa}static get instance(){return sa.Gf.value}}sa.Gf=new x.a(sa.ig);Object(G.a)(sa,"IntelligenceRegionNodeComplexMerge",u.a,[]);class qa extends u.a{constructor(){super()}get $l(){return 35}get Yx(){return 0}static ig(){return new qa}static get instance(){return qa.Gf.value}}
qa.Gf=new x.a(qa.ig);Object(G.a)(qa,"IntelligenceRejectionNodeComplexMerge",u.a,[]);class va extends u.a{constructor(){super()}get $l(){return 39}get Yx(){return 0}static ig(){return new va}static get instance(){return va.Gf.value}}va.Gf=new x.a(va.ig);Object(G.a)(va,"IntelligenceReviewedNodeComplexMerge",u.a,[]);class Ca extends u.a{constructor(){super()}get $l(){return 33}get Yx(){return 0}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.XHc),1);Cb.Z(m.a.Ha(k.a.XGd),1);Cb.Z(m.a.Ha(k.a.Ogf),1);Cb.Z(m.a.Ha(k.a.Rgf),
1);return Cb}zz(Cb,gc){const Dc=Cb.nj,Ub=Cb.Bc;if(gc===m.a.Ha(k.a.XHc)||gc===m.a.Ha(k.a.XGd)||gc===m.a.Ha(k.a.Ogf)||gc===m.a.Ha(k.a.Rgf)){gc=gc===m.a.Ha(k.a.XHc)?k.a.XHc:k.a.XGd;var Bb=Ub.getPropertyObjectIds(Cb.tf.value.ns,gc);const fb=Ub.getPropertyObjectIds(Cb.tf.value.Zd,gc),yb=Ub.getPropertyObjectIds(Cb.jl.value.Zd,gc);Bb=this.vAa(Bb,fb,yb);Ub.setPropertyObjectIds(Dc,gc,Bb);Cb.Ze.add(m.a.Ha(gc));return!0}return!1}static ig(){return new Ca}static get instance(){return Ca.Gf.value}}Ca.Gf=new x.a(Ca.ig);
Object(G.a)(Ca,"IntelligenceRootNodeComplexMerge",u.a,[]);class ta extends u.a{constructor(){super()}get $l(){return 42}get Yx(){return 0}static ig(){return new ta}static get instance(){return ta.Gf.value}}ta.Gf=new x.a(ta.ig);Object(G.a)(ta,"IntelligenceSettingNodeComplexMerge",u.a,[]);class Wa extends u.a{constructor(){super()}get $l(){return 45}get Yx(){return 0}static ig(){return new Wa}static get instance(){return Wa.Gf.value}}Wa.Gf=new x.a(Wa.ig);Object(G.a)(Wa,"IntelligenceWorkflowNodeComplexMerge",
u.a,[]);class Za extends u.a{constructor(){super()}get $l(){return 15}get Yx(){return 3}static ig(){return new Za}static get instance(){return Za.Gf.value}}Za.Gf=new x.a(Za.ig);Object(G.a)(Za,"NumberListNodeComplexMerge",u.a,[]);var Ya=b(109);class Ka extends u.a{constructor(){super()}get $l(){return 16}get Yx(){return 0}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.osb),1);Cb.Z(m.a.Ha(Ya.a.dRe),7);Cb.Z(m.a.Ha(Ya.a.bRe),7);return Cb}zz(Cb,gc){const Dc=Cb.nj,Ub=Cb.Bc;if(gc===m.a.Ha(k.a.osb))return this.onf(Ub,
Cb.tf.value.Zd,Cb.jl.value.Zd,Dc,k.a.osb),Cb.Ze.add(gc),!0;l.a.instance.ua(4207940,1,3,"OutlineElementNodeComplexMerge: Failed to merge OutlineElementNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.ns.id,gc);return!1}static ig(){return new Ka}static get instance(){return Ka.Gf.value}}Ka.Gf=new x.a(Ka.ig);Object(G.a)(Ka,"OutlineElementNodeComplexMerge",u.a,[]);class xa extends u.a{constructor(){super()}get $l(){return 17}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.osb),1);
Cb.Z(m.a.Ha(k.a.aia),1);Cb.Z(m.a.Ha(Ya.a.JG),1);Cb.Z(m.a.Ha(Ya.a.r4b),1);Cb.Z(m.a.Ha(Ya.a.Mda),8);return Cb}zz(Cb,gc){const Dc=Cb.nj,Ub=Cb.Bc;if(gc===m.a.Ha(k.a.osb))return this.onf(Ub,Cb.tf.value.Zd,Cb.jl.value.Zd,Dc,k.a.osb),Cb.Ze.add(gc),!0;if(gc===m.a.Ha(k.a.aia)){var Bb=Ub.getPropertyBool(Cb.tf.value.Zd,k.a.aia),fb=Ub.getPropertyBool(Cb.jl.value.Zd,k.a.aia);Ub.setPropertyBool(Dc,k.a.aia,null==Bb?!1:Bb&&null==fb?!1:fb);Cb.Ze.add(gc);return!0}if(gc===m.a.Ha(Ya.a.r4b))return this.onf(Ub,Cb.tf.value.Zd,
Cb.jl.value.Zd,Dc,Ya.a.r4b),Cb.Ze.add(gc),!0;if(gc===m.a.Ha(Ya.a.JG))return Bb=Ub.getPropertyBool(Cb.tf.value.Zd,Ya.a.JG),fb=Ub.getPropertyBool(Cb.jl.value.Zd,Ya.a.JG),Ub.setPropertyBool(Dc,Ya.a.JG,null==Bb?!0:Bb||null==fb?!0:fb),Cb.Ze.add(gc),!0;l.a.instance.ua(4057305,1,3,"OutlineGroupNodeComplexMerge: Failed to merge OutlineGroupNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.ns.id,gc);return!1}static ig(){return new xa}static get instance(){return xa.Gf.value}}xa.Gf=
new x.a(xa.ig);Object(G.a)(xa,"OutlineGroupNodeComplexMerge",u.a,[]);var Sa=b(155),pb=b(41);class Db extends u.a{constructor(){super()}get $l(){return 18}get Yx(){return 2}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.MEd),3);Cb.Z(m.a.Ha(r.a.D9),this.Yx);Cb.Z(m.a.Ha(k.a.Er),1);Cb.Z(m.a.Ha(k.a.p7),1);Cb.Z(m.a.Ha(k.a.e1),1);Cb.Z(m.a.Ha(k.a.NO),1);Cb.Z(m.a.Ha(k.a.ao),1);Cb.Z(m.a.Ha(Sa.a.PO),1);Cb.Z(m.a.Ha(Sa.a.Z5b),1);return Cb}zz(Cb,gc){const Dc=Cb.Bc;if(Cb.vm.runtime.Ua.isFeatureEnabled(116)){var Ub=Cb.vm.runtime.Ua.isFeatureEnabled(209),
Bb=this.Axh(Ub),fb=this.Exh(Ub);if(gc===m.a.Ha(k.a.Er)||gc===m.a.Ha(k.a.e1)||gc===m.a.Ha(Bb)||gc===m.a.Ha(k.a.ao)||gc===m.a.Ha(fb))return this.PIn(Dc,Cb,Ub)}else if(gc===m.a.Ha(k.a.Er)||gc===m.a.Ha(k.a.ao)){({oxc:gc,yXa:Ub,sXa:Bb}=this.uPe(Object(pb.a)(Dc,Dc.getPropertyUint32s,"getPropertyUint32s"),Cb.tf.value.ns,Cb.tf.value.Zd,Cb.jl.value.Zd,k.a.Er,null));if(!Bb&&!Ub)return l.a.instance.ua(4318873,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Cb.tf.value.Zd.id,m.a.Ha(k.a.Er)),!0;let yb,Wb;({oxc:fb,yXa:yb,sXa:Wb}=this.uPe(Object(pb.a)(Dc,Dc.getPropertyObjectIds,"getPropertyObjectIds"),Cb.tf.value.ns,Cb.tf.value.Zd,Cb.jl.value.Zd,k.a.ao,null));if(!yb&&!Wb)return l.a.instance.ua(4318874,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",Cb.tf.value.Zd.id,m.a.Ha(k.a.ao)),!0;const Xb=yb&&!Wb;if((Ub&&!Bb)!==Xb)return l.a.instance.ua(4318875,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Cb.tf.value.Zd.id,m.a.Ha(k.a.Er),m.a.Ha(k.a.ao)),!1;Xb&&(Dc.setPropertyObjectIds(Cb.nj,k.a.ao,fb),Dc.setPropertyUint32s(Cb.nj,k.a.Er,gc));l.a.instance.ua(4318877,1,3,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [PropertyId: {1}] [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}]. [PropertyId: {3}] [favoredEquivalentToBase: {4}] [conflictEquivalentToBase: {5}]",Cb.tf.value.Zd.id,m.a.Ha(k.a.Er),Ub,Bb,m.a.Ha(k.a.ao),yb,Wb);Cb.Ze.add(m.a.Ha(k.a.ao));Cb.Ze.add(m.a.Ha(k.a.Er));
return!0}l.a.instance.ua(4318878,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.Zd.id,gc);return!1}iJh(Cb,gc,Dc,Ub){let Bb;({oxc:gc,yXa:Ub,sXa:Bb}=this.uPe(gc,Dc.tf.value.ns,Dc.tf.value.Zd,Dc.jl.value.Zd,Cb,Ub));return Bb||Ub?{returnValue:!0,IRe:gc,yXa:Ub,sXa:Bb}:(l.a.instance.ua(592545113,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",
Dc.tf.value.Zd.id.toString(),m.a.Ha(Cb)),{returnValue:!1,IRe:gc,yXa:Ub,sXa:Bb})}mIh(Cb,gc,Dc,Ub,Bb){let fb;let yb,Wb,Xb,Cc;({IRe:fb,yXa:Bc,sXa:yb,returnValue:Xb}=this.iJh(Cb,Object(pb.a)(Dc,Dc.getPropertyUint32s,"getPropertyUint32s"),Ub,null));({IRe:Dc,yXa:Bb,sXa:Wb,returnValue:Cc}=this.iJh(gc,Object(pb.a)(Dc,Dc.getPropertyObjectIds,"getPropertyObjectIds"),Ub,Bb));var Bc=Bc&&!yb;return Xb&&Cc?Bc!==(Bb&&!Wb)?(l.a.instance.ua(592545114,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}] and [PropertyId: {2}] differently.",
Ub.tf.value.Zd.id.toString(),m.a.Ha(Cb),m.a.Ha(gc)),{returnValue:2,sqd:fb,rqd:Dc,I4d:Bc}):{returnValue:0,sqd:fb,rqd:Dc,I4d:Bc}:{returnValue:1,sqd:fb,rqd:Dc,I4d:Bc}}Gif(Cb){let gc=!0;Cb.forEach(Dc=>Dc!==Z.a.nil?gc=!1:!0);return gc}E_k(Cb,gc,Dc){return this.Gif(Cb)&&this.Gif(gc)&&this.Gif(Dc)?!0:!1}PIn(Cb,gc,Dc){const Ub=this.Axh(Dc);Dc=this.Exh(Dc);let Bb,fb,yb,Wb,Xb,Cc;var Bc=({sqd:Wb,rqd:Xb,I4d:fb}=this.mIh(Ub,k.a.ao,Cb,gc,null)).returnValue;if(2===Bc||1===Bc)return!0;({sqd:yb,rqd:Cc,I4d:Bb,returnValue:Bc}=
this.mIh(k.a.Er,k.a.e1,Cb,gc,Object(pb.a)(this,this.E_k,"getExtendedGuidEquivalence")));if(2===Bc||1===Bc)return!0;let pd;({oxc:Bc,yXa:zd,sXa:pd}=this.W3j(Object(pb.a)(Cb,Cb.getPropertyDictionary,"getPropertyDictionary"),gc.tf.value.ns,gc.tf.value.Zd,gc.jl.value.Zd,Dc));if(!pd&&!zd)return l.a.instance.ua(592545115,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to  material difference in [PropertyId: {1}]",gc.tf.value.Zd.id.toString(),m.a.Ha(Dc)),!0;var zd=zd&&!pd;
if(Bb!==fb||Bb!==zd)return l.a.instance.ua(592545116,1,2,"PageContentNodeComplexMerge: Failed to merge PageContentNode [Id: {0}] due to wanting to merge [PropertyId: {1}], [PropertyId: {2}] and [PropertyId: {3}] differently. [takeConflictingAbsListId: {4}] [takeConflictingListId: {5}] [takeConflictingMap: {6}]",gc.tf.value.Zd.id.toString(),m.a.Ha(k.a.Er),m.a.Ha(Ub),m.a.Ha(Dc),fb,Bb,zd),!0;Bb&&(Cb.setPropertyObjectIds(gc.nj,k.a.ao,Xb),Cb.setPropertyUint32s(gc.nj,Ub,Wb),Cb.setPropertyObjectIds(gc.nj,
k.a.e1,Cc),Cb.setPropertyUint32s(gc.nj,k.a.Er,yb),Cb.setPropertyDictionary(gc.nj,Dc,Bc));l.a.instance.ua(592545118,1,3,"PageContentNodeComplexMerge: Merging PageContentNode [Id: {0}]. [takeConflictingAbsListId: {1}] [takeConflictingListId: {2}] [takeConflictingMap: {3}]",gc.tf.value.Zd.id.toString(),fb,Bb,zd);gc.Ze.add(m.a.Ha(Ub));gc.Ze.add(m.a.Ha(k.a.ao));gc.Ze.add(m.a.Ha(k.a.Er));gc.Ze.add(m.a.Ha(k.a.e1));gc.Ze.add(m.a.Ha(Dc));return!0}Axh(Cb){return Cb?Sa.a.Z5b:k.a.p7}Exh(Cb){return Cb?Sa.a.PO:
k.a.NO}static ig(){return new Db}static get instance(){return Db.Gf.value}}Db.Gf=new x.a(Db.ig);Object(G.a)(Db,"PageContentNodeComplexMerge",u.a,[]);class Ua extends u.a{constructor(){super()}get $l(){return 19}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.aCa),1);Cb.Z(m.a.Ha(k.a.appsNode),2);Cb.Z(m.a.Ha(k.a.customXmlPartContainerNode),2);Cb.Z(m.a.Ha(k.a.intelligenceRootNode),1);return Cb}zz(Cb,gc){const Dc=Cb.Bc;if(gc===m.a.Ha(k.a.aCa)){var Ub=Dc.getPropertyObjectIds(Cb.tf.value.ns,k.a.aCa),Bb=Dc.getPropertyObjectIds(Cb.tf.value.Zd,
k.a.aCa),fb=Dc.getPropertyObjectIds(Cb.jl.value.Zd,k.a.aCa);if((Ub=this.Zcm(Ub,Bb,fb,(yb,Wb)=>yb.equals(Wb),yb=>{let Wb;({value:Wb}=Cb.vm.runtime.So.Ab(yb)).returnValue?Cb.vm.runtime.Xk.Z(yb,new z.a(Wb,!1)):l.a.instance.shipAssertTag(4034653,1,!1,"PageManifestNodeComplexMerge failed to shared formatting object with [id: {0}] in conflicting revision.")},Cb.vm))&&0<Ub.length)return Dc.setPropertyObjectIds(Cb.nj,k.a.aCa,Ub),Cb.Ze.add(m.a.Ha(k.a.aCa)),!0}if(gc===m.a.Ha(k.a.intelligenceRootNode))return Ub=
Dc.getPropertyObjectIds(Cb.tf.value.ns,k.a.intelligenceRootNode),Bb=Dc.getPropertyObjectIds(Cb.tf.value.Zd,k.a.intelligenceRootNode),fb=Dc.getPropertyObjectIds(Cb.jl.value.Zd,k.a.intelligenceRootNode),Ub=this.vAa(Ub,Bb,fb),Dc.setPropertyObjectIds(Cb.nj,k.a.intelligenceRootNode,Ub),Cb.Ze.add(gc),!0;l.a.instance.ua(4018187,1,3,"PageManifestNodeComplexMerge: Failed to merge PageManifestNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.Zd.id,gc);return!1}static ig(){return new Ua}static get instance(){return Ua.Gf.value}}
Ua.Gf=new x.a(Ua.ig);Object(G.a)(Ua,"PageManifestNodeComplexMerge",u.a,[]);class Lb extends u.a{constructor(){super()}get $l(){return 43}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.eha),0);Cb.Z(m.a.Ha(k.a.CDb),0);Cb.Z(m.a.Ha(k.a.xAb),0);Cb.Z(m.a.Ha(k.a.$ia),1);Cb.Z(m.a.Ha(k.a.sessionId),3);Cb.Z(m.a.Ha(k.a.buildVersion),3);Cb.Z(m.a.Ha(k.a.hV),1);Cb.Z(m.a.Ha(k.a.ySh),1);Cb.Z(m.a.Ha(k.a.zt),1);return Cb}zz(Cb,gc){if(gc===m.a.Ha(k.a.hV)||gc===m.a.Ha(k.a.ySh)||gc===m.a.Ha(k.a.zt)){var Dc=Cb.jl.value.Zd,Ub=
Cb.tf.value.Zd,Bb=m.a.lO(gc);Ub=Cb.Bc.getPropertyBool(Ub,Bb);Dc=Cb.Bc.getPropertyBool(Dc,Bb);Cb.Bc.setPropertyBool(Cb.nj,Bb,null==Ub?!1:Ub&&null==Dc?!1:Dc);Cb.Ze.add(gc);return!0}if(gc===m.a.Ha(k.a.$ia)){gc=Cb.Bc;Dc=Cb.tf.value.ns;Ub=Cb.jl.value.Zd;Bb=Cb.tf.value.Zd;Dc=Dc?gc.getPropertyObjectId(Dc,k.a.$ia):null;Ub=Ub?gc.getPropertyObjectId(Ub,k.a.$ia):null;Bb=Bb?gc.getPropertyObjectId(Bb,k.a.$ia):null;l.a.instance.ua(589657691,1,3,"GraphFeatureChild Merge Attempt: [Base: {0}] [Conflict: {1}] [Favored: {2}]",
Dc?Dc.toString():"NULL",Ub?Ub.toString():"NULL",Bb?Bb.toString():"NULL");if(Ub){if(Bb&&Ub.equals(Bb))return Cb.Ze.add(m.a.Ha(k.a.$ia)),gc.setPropertyObjectId(Cb.nj,k.a.$ia,Ub),!0;if(aa.a.mDd.equals(Ub))return Cb.Ze.add(m.a.Ha(k.a.$ia)),gc.setPropertyObjectId(Cb.nj,k.a.$ia,aa.a.mDd),!0}if(Bb&&aa.a.mDd.equals(Bb))return Cb.Ze.add(m.a.Ha(k.a.$ia)),gc.setPropertyObjectId(Cb.nj,k.a.$ia,aa.a.mDd),!0;l.a.instance.ua(589657692,1,2,"GraphFeatureChild Merge Failure: [Base: {0}] [Conflict: {1}] [Favored: {2}]",
Dc?Dc.toString():"NULL",Ub?Ub.toString():"NULL",Bb?Bb.toString():"NULL")}return!1}static ig(){return new Lb}static get instance(){return Lb.Gf.value}}Lb.Gf=new x.a(Lb.ig);Object(G.a)(Lb,"PageMetadataNodeComplexMerge",u.a,[]);var Va=b(1602),Sb=b(128);class nb extends u.a{constructor(){super()}get $l(){return 31}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(Sb.a.$t),1);Cb.Z(m.a.Ha(k.a.listID),1);Cb.Z(m.a.Ha(k.a.qe),1);Cb.Z(m.a.Ha(k.a.D1),3);Cb.Z(m.a.Ha(k.a.yUb),3);Cb.Z(m.a.Ha(k.a.runId),3);Cb.Z(m.a.Ha(k.a.svd),
3);Cb.Z(m.a.Ha(r.a.fontColor),3);Cb.Z(m.a.Ha(k.a.w5g),3);Cb.Z(m.a.Ha(k.a.Ib),1);Cb.Z(m.a.Ha(Sb.a.MHd),3);Cb.Z(m.a.Ha(Sb.a.vJc),3);Cb.Z(m.a.Ha(k.a.BMk),3);Cb.Z(m.a.Ha(Ya.a.aTi),3);for(let gc=0;gc<nb.qYa.length;gc++)Cb.Z(nb.qYa[gc],1);return Cb}zz(Cb,gc){var Dc=Cb.Bc;const Ub=Cb.nj,Bb=Cb.vm.runtime.Ua.isFeatureEnabled(112);m.a.lO(gc);if(gc===m.a.Ha(k.a.Ib)){Dc=Cb.Bc.getPropertyInt32(Cb.jl.value.Zd,k.a.Ib);if(null==Dc||!Dc)return!0;Cb.Bc.setPropertyInt32(Ub,k.a.Ib,Dc);Cb.Ze.add(gc);return!0}if(gc===
m.a.Ha(Sb.a.$t)){const fb=Dc.getPropertyUint32(Cb.tf.value.Zd,Sb.a.$t),yb=Dc.getPropertyUint32(Cb.jl.value.Zd,Sb.a.$t);if(null!=fb&&null!=yb&&fb===yb)return Dc.setPropertyUint32(Ub,Sb.a.$t,fb),Cb.Ze.add(gc),!0;if(null==fb&&null==yb)return Bb?Ub.removeProperty(Sb.a.$t):Dc.setPropertyUint32(Ub,Sb.a.$t,fb),Cb.Ze.add(m.a.Ha(Sb.a.$t)),!0;if(null!=fb&&null==yb)return Dc.setPropertyUint32(Ub,Sb.a.$t,fb),Cb.Ze.add(gc),!0;if(null==fb&&null!=yb)return Dc.setPropertyUint32(Ub,Sb.a.$t,yb),Cb.Ze.add(gc),!0}else if(gc===
m.a.Ha(k.a.qe)){if(Bb)return this.gIn(Dc,Cb)}else if(gc===m.a.Ha(k.a.listID)){if(Bb)return this.jIn(Cb,k.a.listID)}else if(Array.contains(nb.qYa,gc)&&Bb)return this.fIn(Cb);return!1}jIn(Cb,gc){const Dc=Cb.nj;var Ub=Cb.jl.value,Bb=Cb.tf.value;let fb;const yb=Ub.L9.Ab(m.a.Ha(gc)).returnValue,Wb=({value:fb}=Bb.L9.Ab(m.a.Ha(gc))).returnValue;Bb=Bb.Zd;Ub=Ub.Zd;let Xb=!1;Wb?fb.isDeleted?(Dc.removeProperty(gc),Xb=!0):fb.GO?(Dc.b$(gc,Bb.PG(k.a.listID)),Xb=!0):yb&&(Ub.hasProperty(k.a.listID)?Dc.b$(gc,Ub.PG(k.a.listID)):
Dc.removeProperty(gc),Xb=!0):yb&&(Ub.hasProperty(k.a.listID)?(Dc.b$(gc,Ub.PG(k.a.listID)),Xb=!0):l.a.instance.ua(578851419,1,1,"PersistablePropertySetComplexMerge: Merging ListId property. Not present in [base]: {0} [favored] : {1} conflict {2}.]",Cb.tf.value.ns.Bib(),Cb.tf.value.Zd.Bib(),Cb.jl.value.Zd.Bib()));return Xb?(Cb.Ze.add(m.a.Ha(gc)),!0):!1}fIn(Cb){let gc=!0,Dc=!0,Ub,Bb;({KKl:gc,hIl:Dc,$Fk:Ub,sbk:Bb}=this.X3j(Cb));l.a.instance.ua(578932993,1,3,"PersistablePropertySetComplexMerge: Merging ListDef properties [Id: {0}]. [favoredEquivalentToBase: {1}] [conflictEquivalentToBase: {2}].",
Cb.tf.value.Zd.id.toString(),gc,Dc);return gc&&!Dc?(this.W5h(Bb,Cb),!0):gc?!1:(this.W5h(Ub,Cb),!0)}X3j(Cb){let gc,Dc,Ub,Bb;const fb=Cb.jl.value;let yb;const Wb=Cb.tf.value;let Xb;Dc=gc=!0;Ub=new A.a;Bb=new A.a;for(let Cc=0;Cc<nb.qYa.length;Cc++){const Bc=nb.qYa[Cc],pd=({value:yb}=fb.L9.Ab(Bc)).returnValue;({value:Xb}=Wb.L9.Ab(Bc)).returnValue&&(gc=this.hRi(Cb.tf,Ub,Xb,Bc)&&gc);pd&&(Dc=this.hRi(Cb.jl,Bb,yb,Bc)&&Dc)}return{KKl:gc,hIl:Dc,$Fk:Ub,sbk:Bb}}hRi(Cb,gc,Dc,Ub){const Bb=m.a.lO(Ub);Cb=Cb.value.Zd;
gc.Z(Ub,Cb.hasProperty(Bb)?Cb.PG(Bb):null);return!Dc.GO}W5h(Cb,gc){const Dc=gc.nj;for(let Bb=0;Bb<nb.qYa.length;Bb++){var Ub=nb.qYa[Bb];const fb=m.a.lO(Ub);(Ub=Cb.J(Ub))?Dc.b$(fb,Ub):Dc.removeProperty(fb)}for(Cb=0;Cb<nb.qYa.length;Cb++)gc.Ze.add(nb.qYa[Cb]);l.a.instance.ua(578932994,1,3,"PersistablePropertySetComplexMerge: Completed Merging ListDef properties [Id: {0}].",gc.tf.value.Zd.id.toString())}gIn(Cb,gc){const Dc=gc.nj,Ub=Cb.getPropertyInt32(gc.tf.value.Zd,k.a.qe),Bb=Cb.getPropertyInt32(gc.jl.value.Zd,
k.a.qe);return null!=Ub&&null!=Bb&&Ub===Bb?(Cb.setPropertyInt32(Dc,k.a.qe,Ub),gc.Ze.add(m.a.Ha(k.a.qe)),!0):null==Ub&&null==Bb?(Dc.removeProperty(k.a.qe),gc.Ze.add(m.a.Ha(k.a.qe)),!0):null!=Ub&&null==Bb?(Cb.setPropertyInt32(Dc,k.a.qe,Ub),gc.Ze.add(m.a.Ha(k.a.qe)),!0):null==Ub&&null!=Bb?(Cb.setPropertyInt32(Dc,k.a.qe,Bb),gc.Ze.add(m.a.Ha(k.a.qe)),!0):!1}static ig(){return new nb}static get instance(){return nb.Gf.value}}nb.Gf=new x.a(nb.ig);nb.qYa=[m.a.Ha(k.a.sk),m.a.Ha(k.a.qx),m.a.Ha(r.a.V0),m.a.Ha(k.a.k9),
m.a.Ha(k.a.Fq),m.a.Ha(k.a.pq),m.a.Ha(r.a.kV),m.a.Ha(k.a.ULe),m.a.Ha(r.a.font),m.a.Ha(Ya.a.Ndb)];Object(G.a)(nb,"PersistablePropertySetComplexMerge",u.a,[]);class La extends u.a{constructor(){super()}get $l(){return 21}get Yx(){return 0}static ig(){return new La}static get instance(){return La.Gf.value}}La.Gf=new x.a(La.ig);Object(G.a)(La,"RevisionMetadataNodeComplexMerge",u.a,[]);class Ha extends u.a{constructor(){super()}get $l(){return 48}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.rji),3);return Cb}static ig(){return new Ha}static get instance(){return Ha.Gf.value}}
Ha.Gf=new x.a(Ha.ig);Object(G.a)(Ha,"ShadowNumberListNodeComplexMerge",u.a,[]);class Aa extends u.a{constructor(){super()}get $l(){return 22}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.languageHint),7);Cb.Z(m.a.Ha(k.a.VJc),2);return Cb}static ig(){return new Aa}static get instance(){return Aa.Gf.value}}Aa.Gf=new x.a(Aa.ig);Object(G.a)(Aa,"SharedPersistablePropertySetComplexMerge",u.a,[]);class Ma extends u.a{constructor(){super()}get $l(){return 38}get Yx(){return 3}static ig(){return new Ma}static get instance(){return Ma.Gf.value}}
Ma.Gf=new x.a(Ma.ig);Object(G.a)(Ma,"StylePropertySetComplexMerge",u.a,[]);var cb=b(1401),ib=b(1454);class Rb extends u.a{constructor(){super()}get $l(){return 23}get Yx(){return 0}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(r.a.ge),4);Cb.Z(m.a.Ha(k.a.rowSpan),1);Cb.Z(m.a.Ha(k.a.colSpan),1);Cb.Z(m.a.Ha(k.a.ghostCell),1);Cb.Z(m.a.Ha(Sa.a.vMerge),1);Cb.Z(m.a.Ha(Sa.a.gridSpan),1);Cb.Z(m.a.Ha(k.a.Y0a),2);Cb.Z(m.a.Ha(k.a.Mib),2);Cb.Z(m.a.Ha(k.a.tCa),2);Cb.Z(m.a.Ha(k.a.kib),5);return Cb}GAb(Cb){if(!Cb)return l.a.instance.ua(573957923,
1,2,"Feature helper is null"),!1;Cb.ks(177);return Cb.isFeatureEnabled(177)}GI(Cb){if(!Cb)return l.a.instance.ua(540120285,1,2,"Feature helper is null"),!1;Cb.ks(179);return Cb.isFeatureEnabled(179)}zz(Cb,gc){Cb.vm.runtime.MC("TableCellNodeComplexMerge.TryMergeCustomProperty, propertyId:"+gc);var Dc=gc===m.a.Ha(k.a.rowSpan)||gc===m.a.Ha(k.a.colSpan)||gc===m.a.Ha(k.a.ghostCell);this.GI(Cb.vm.runtime.Ua)&&(Dc=Dc||gc===m.a.Ha(Sa.a.vMerge)||gc===m.a.Ha(Sa.a.gridSpan));if(!this.GAb(Cb.vm.runtime.Ua))return!Dc;
var Ub=Cb.jl.value.ns,Bb=ib.e(Cb.vm,Ub,null);if(Bb.equals(Z.a.nil))return l.a.instance.ua(573845783,1,2,"Table node ID could not be found for table cell. Table cell ID: {0}",Ub.id),Cb.vm.logger.Cf(Object.assign(new cb.a,{info:"Table node ID could not be found for table cell"})),!1;var fb=Cb.vm.runtime.Ctb.J(Bb).J(Ub.id);if(!fb)return!Dc;Ub=Cb.nj;Bb=Cb.Bc;if(gc===m.a.Ha(k.a.ghostCell))return Bb.setPropertyBool(Ub,k.a.ghostCell,fb.lf),Cb.Ze.add(m.a.Ha(k.a.ghostCell)),!0;if(gc===m.a.Ha(k.a.rowSpan))return gc=
fb.rowSpan,fb=fb.colSpan,null!=gc&&null!=fb&&(1<gc||1<fb)?Bb.setPropertyUint32(Ub,k.a.rowSpan,gc):Ub.removeProperty(k.a.rowSpan),Cb.Ze.add(m.a.Ha(k.a.rowSpan)),!0;if(gc===m.a.Ha(k.a.colSpan))return gc=fb.rowSpan,Dc=fb.colSpan,fb=fb.lf,null!=gc&&null!=Dc&&(1<gc||1<Dc)?Bb.setPropertyUint32(Ub,k.a.colSpan,Dc):fb&&null!=Dc?Bb.setPropertyUint32(Ub,k.a.colSpan,Dc):Ub.removeProperty(k.a.colSpan),Cb.Ze.add(m.a.Ha(k.a.colSpan)),!0;l.a.instance.ua(573690910,1,2,"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property whose merge strategy is not custom merge. PropertyID:{0}",
gc);Cb.vm.logger.Cf(Object.assign(new cb.a,{info:"TableCellNodeComplexMerge.TryMergeCustomProperty called for a property which should not be custom merged"}));return!Dc}static ig(){return new Rb}static get instance(){return Rb.Gf.value}}Rb.Gf=new x.a(Rb.ig);Object(G.a)(Rb,"TableCellNodeComplexMerge",u.a,[]);class Oa extends u.a{constructor(){super()}get $l(){return 24}GAb(Cb){if(!Cb)return l.a.instance.ua(573845782,1,2,"Feature helper is null"),!1;Cb.ks(177);return Cb.isFeatureEnabled(177)}get Yx(){return 0}$i(){const Cb=
super.$i();Cb.Z(m.a.Ha(r.a.ge),1);Cb.Z(m.a.Ha(r.a.OV),1);Cb.Z(m.a.Ha(r.a.hta),1);Cb.Z(m.a.Ha(k.a.Bbc),1);Cb.Z(m.a.Ha(k.a.H5),1);Cb.Z(m.a.Ha(k.a.Y0a),2);Cb.Z(m.a.Ha(k.a.Mib),2);Cb.Z(m.a.Ha(k.a.tCa),2);return Cb}zz(Cb,gc){Cb.vm.runtime.MC("TableNodeComplexMerge.TryMergeCustomProperty, PropertyId:"+gc);if(gc===m.a.Ha(r.a.ge)||gc===m.a.Ha(r.a.OV)||gc===m.a.Ha(k.a.Bbc)||gc===m.a.Ha(k.a.H5)||gc===m.a.Ha(r.a.hta)){const Bb=Cb.nj;var Dc=Cb.Bc;l.a.instance.ua(4273303,1,3,"TableNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Bb.id,Bb.Gb,gc);if(this.Dwk(Cb))return!1;var Ub=Dc.getPropertyObjectIds(Cb.tf.value.ns,r.a.ge);const fb=Dc.getPropertyObjectIds(Cb.tf.value.Zd,r.a.ge),yb=Dc.getPropertyObjectIds(Cb.jl.value.Zd,r.a.ge);Ub=this.i5h(Ub,fb,yb,(Wb,Xb)=>Wb.equals(Xb));if(0<Ub.length)return Dc.setPropertyObjectIds(Bb,r.a.ge,Ub),Dc.setPropertyInt32(Bb,r.a.hta,Ub.length),this.GAb(Cb.vm.runtime.Ua)&&({value:gc}=Cb.jl.value.L9.Ab(m.a.Ha(r.a.OV)),{value:Dc}=Cb.tf.value.L9.Ab(m.a.Ha(r.a.OV)),gc.GO?Bb.b$(r.a.OV,gc.newValue):Bb.b$(r.a.OV,
Dc.newValue)),Cb.Ze.add(m.a.Ha(r.a.ge)),Cb.Ze.add(m.a.Ha(r.a.OV)),Cb.Ze.add(m.a.Ha(r.a.hta)),Cb.Ze.add(m.a.Ha(k.a.Bbc)),Cb.Ze.add(m.a.Ha(k.a.H5)),!0}l.a.instance.ua(4018189,1,3,"TableNodeComplexMerge: Failed to merge TableNode [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.Zd.id,gc);return!1}Dwk(Cb){const gc=Cb.jl.value,Dc=Cb.tf.value;let Ub,Bb;({value:Ub}=gc.L9.Ab(m.a.Ha(r.a.OV)));({value:Bb}=Dc.L9.Ab(m.a.Ha(r.a.OV)));return Ub.GO||Bb.GO?Ub.GO&&Bb.GO?(l.a.instance.ua(4273304,
1,3,"TableNodeComplexMerge: Failed to merge TableNode due to columns being changed in both. [Base: {0}] [Favored: {1}] [Conflicting: {2}]",Ub.oldValue,Bb.newValue,Ub.newValue),Cb.vm.logger.Cf(Object.assign(new cb.a,{Ph:"DoColumnsConflict",eventId:"aqtsy",info:"Columns changed"})),!0):Oa.Beh(Cb.vm,Ub,Dc,"BaseConflict")||Oa.Beh(Cb.vm,Bb,gc,"BaseFavored")?!0:!1:!1}static ig(){return new Oa}static get instance(){return Oa.Gf.value}static Beh(Cb,gc,Dc,Ub){return gc.GO&&({value:gc}=Dc.L9.Ab(m.a.Ha(r.a.ge)),
gc.GO)?(l.a.instance.ua(4273305,1,3,"TableNodeComplexMerge {0}: Failed to merge TableNode due to columns and rows being changed on different sides of the conflict.",Ub),Cb.logger.Cf(Object.assign(new cb.a,{Ph:"DoColumnsConflictWithRows",eventId:"aqtsz"})),!0):!1}}Oa.Gf=new x.a(Oa.ig);Object(G.a)(Oa,"TableNodeComplexMerge",u.a,[]);class lb extends u.a{constructor(){super()}get $l(){return 25}get Yx(){return 0}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.Ib),3);Cb.Z(m.a.Ha(r.a.ge),4);Cb.Z(m.a.Ha(k.a.Y0a),
2);Cb.Z(m.a.Ha(k.a.Mib),2);Cb.Z(m.a.Ha(k.a.tCa),2);Cb.Z(m.a.Ha(Sa.a.QWf),2);Cb.Z(m.a.Ha(Sa.a.PWf),2);Cb.Z(m.a.Ha(k.a.kib),5);return Cb}static ig(){return new lb}static get instance(){return lb.Gf.value}}lb.Gf=new x.a(lb.ig);Object(G.a)(lb,"TableRowNodeComplexMerge",u.a,[]);class gb extends u.a{constructor(){super()}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.EBn),2);Cb.Z(m.a.Ha(r.a.ge),1);return Cb}zz(Cb,gc){if(gc===m.a.Ha(r.a.ge)){const Ub=Cb.nj,Bb=Cb.Bc;l.a.instance.ua(42754251,1,3,"TaskContentNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",
Ub.id,Ub.Gb,gc);var Dc=Bb.getPropertyObjectIds(Cb.tf.value.ns,r.a.ge);const fb=Bb.getPropertyObjectIds(Cb.tf.value.Zd,r.a.ge),yb=Bb.getPropertyObjectIds(Cb.jl.value.Zd,r.a.ge);if(Dc=this.jdm(Dc,fb,yb))return 0<Dc.length?Bb.setPropertyObjectIds(Ub,r.a.ge,Dc):Ub.removeProperty(r.a.ge),Cb.Ze.add(m.a.Ha(r.a.ge)),!0}l.a.instance.ua(42754252,1,1,"TaskContentNodeComplexMerge: Failed to merge TaskContent [Id: {0}] due to a conflicting change on [PropertyId: {1}]",Cb.tf.value.Zd.id,gc);return!1}jdm(Cb,gc,
Dc){const Ub=new A.a(0);Cb.forEach(fb=>{Ub.Z(fb,0);return!0});gc.forEach(fb=>{Ub.Ja(fb)?Ub.Z(fb,1):Ub.Z(fb,3);return!0});Dc.forEach(fb=>{let yb;({value:yb}=Ub.Ab(fb)).returnValue?1===yb?Ub.Z(fb,5):3===yb?(l.a.instance.ua(42754253,1,2,"TaskNode was found added by both sides of merge"),Ub.Z(fb,3)):Ub.Z(fb,2):Ub.Z(fb,4);return!0});const Bb=new Q.a;Ub.forEach((fb,yb)=>{0!==yb&&2!==yb&&1!==yb&&Bb.add(fb);return!0});return Bb}static ig(){return new gb}static get instance(){return gb.Gf.value}}gb.Gf=new x.a(gb.ig);
Object(G.a)(gb,"TaskContentNodeComplexMerge",u.a,[]);class Nb{equals(Cb,gc){return Cb&&gc?Cb.UserId===gc.UserId&&Cb.Provider===gc.Provider&&Cb.DisplayName===gc.DisplayName&&Cb.Email===gc.Email:!Cb&&!gc}tI(){return 0}}Object(G.a)(Nb,"CommentTaskPersonComparer",null,[164]);class qc{equals(Cb,gc){return Cb&&gc?Cb.startDate?Cb.endDate?Cb.startDate.getTime()===gc.startDate.getTime()&&Cb.endDate.getTime()===gc.endDate.getTime():!gc.endDate:!gc.startDate:!Cb&&!gc}tI(){return 0}}Object(G.a)(qc,"CommentTaskScheduleEqualityComparer",
null,[164]);class Eb{equals(Cb,gc){if(!Cb||!gc)return!Cb&&!gc;if(!Cb.extensions&&!gc.extensions)return!0;if(!Cb.extensions||!gc.extensions||Cb.extensions.count!==gc.extensions.count)return!1;let Dc=!0;Cb.extensions.forEach((Ub,Bb)=>{let fb;return({value:fb}=gc.extensions.Ab(Ub)).returnValue&&Bb===fb?!0:Dc=!1});return Dc}tI(){return 0}}Object(G.a)(Eb,"ExtensionListEqualityComparer",null,[164]);class ec{ZCk(Cb,gc){return Cb&&gc?Cb.recordId===gc.recordId&&ec.Jcg.equals(Cb.user,gc.user)&&ec.Jcg.equals(Cb.assignee,
gc.assignee)&&Cb.type===gc.type&&Cb.title===gc.title&&Cb.priority===gc.priority&&Cb.isLossy===gc.isLossy&&Cb.completion===gc.completion&&Cb.commentId===gc.commentId&&Cb.time===gc.time&&ec.X$i.equals(Cb.schedule,gc.schedule):!Cb&&!gc}equals(Cb,gc){return this.ZCk(Cb,gc)}tI(){return 0}}ec.Jcg=new Nb;ec.X$i=new qc;new Eb;Object(G.a)(ec,"HistoryRecordEqualityComparer",null,[164]);var Jb=b(1816),vb=b(1361);class xb extends u.a{constructor(Cb){super();this.wGa=Cb}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.RHb),
5);Cb.Z(m.a.Ha(k.a.taskId),2);Cb.Z(m.a.Ha(k.a.qBn),2);Cb.Z(m.a.Ha(k.a.uBn),2);Cb.Z(m.a.Ha(k.a.lta),1);return Cb}CZf(Cb){if(!Cb.jl.value.ns&&!Cb.tf.value.ns){const gc=Cb.tf.value.Zd.dF();gc.removeProperty(k.a.lta);const Dc=Cb.tf.value.Zd,Ub=Cb.jl.value.Zd;Cb.tf=new x.a(()=>new vb.a(gc,Dc));Cb.jl=new x.a(()=>new vb.a(gc,Ub))}return super.CZf(Cb)}zz(Cb,gc){if(gc!==m.a.Ha(k.a.lta))return l.a.instance.ua(42754254,1,1,"TaskSingleNodeComplexMerge: Failed to merge TaskSingle [Id: {0}] due to a conflicting change on [PropertyId: {1}]",
Cb.tf.value.Zd.id,gc),!1;const Dc=Cb.nj,Ub=Cb.Bc;l.a.instance.ua(42754255,1,3,"TaskSingleNodeComplexMerge: Running custom merge for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}]",Dc.id,Dc.Gb,gc);gc=Ub.getPropertyString(Cb.tf.value.ns,k.a.lta);const Bb=Ub.getPropertyString(Cb.tf.value.Zd,k.a.lta),fb=Ub.getPropertyString(Cb.jl.value.Zd,k.a.lta);gc=this.idm(gc,Bb,fb);if(!gc)return!1;0<gc.length?Ub.setPropertyString(Dc,k.a.lta,gc):Dc.removeProperty(k.a.lta);Cb.Ze.add(m.a.Ha(k.a.lta));return!0}idm(Cb,
gc,Dc){Cb=this.wGa.kXb(Cb);gc=this.wGa.kXb(gc);Dc=this.wGa.kXb(Dc);if(!xb.qVh(Cb,gc))return l.a.instance.ua(42754256,1,1,"MergeTaskHistory: base must be a prefix of the favored entries"),null;if(!xb.qVh(Cb,Dc))return l.a.instance.ua(42754257,1,1,"MergeTaskHistory: base must be a prefix of the conflict entries"),null;Dc=xb.O9j(Cb.length,gc,Dc);return this.wGa.ROf(Dc)}static ig(){const Cb=new Jb.a;return new xb(Cb)}static get instance(){return xb.Gf.value}static O9j(Cb,gc,Dc){const Ub=new Q.a;for(let Bb=
0;Bb<gc.length;Bb++)Ub.add(gc.J(Bb));for(;Cb<Dc.length;Cb++)Ub.add(Dc.J(Cb));return Ub}static qVh(Cb,gc){const Dc=Cb.length;if(Dc>gc.length)return!1;for(let Ub=0;Ub<Dc;Ub++)if(!xb.Vgj.equals(gc.J(Ub),Cb.J(Ub)))return gc.J(Ub).recordId===Cb.J(Ub).recordId&&l.a.instance.ua(50357519,1,1,"MergeTaskHistory: History records with same RecordId must have all other fields equal"),!1;return!0}}xb.Gf=new x.a(xb.ig);xb.Vgj=new ec;Object(G.a)(xb,"TaskSingleNodeComplexMerge",u.a,[]);class lc extends u.a{constructor(){super()}get $l(){return 26}$i(){const Cb=
super.$i();Cb.Z(m.a.Ha(r.a.ge),1);return Cb}zz(Cb,gc){const Dc=r.a.ge;if(gc===m.a.Ha(Dc)){gc=Cb.nj;const Bb=Cb.Bc;var Ub=Bb.getPropertyObjectIds(Cb.tf.value.ns,Dc);const fb=Bb.getPropertyObjectIds(Cb.tf.value.Zd,Dc),yb=Bb.getPropertyObjectIds(Cb.jl.value.Zd,Dc);Ub=this.pdm(Ub,fb,yb);Bb.setPropertyObjectIds(gc,Dc,Ub);Cb.Ze.add(m.a.Ha(Dc));return!0}return!1}pdm(Cb,gc,Dc){return this.vAa(Cb,gc,Dc)}static ig(){return new lc}static get instance(){return lc.Gf.value}}lc.Gf=new x.a(lc.ig);Object(G.a)(lc,
"VectorClockContainerNodeComplexMerge",u.a,[]);class Lc extends u.a{constructor(){super()}get $l(){return 27}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.TV),1);return Cb}zz(Cb,gc){const Dc=k.a.TV;if(gc===m.a.Ha(Dc)){gc=Cb.nj;const Ub=Cb.Bc,Bb=Ub.getPropertyUint32(Cb.tf.value.Zd,Dc)||0,fb=Ub.getPropertyUint32(Cb.jl.value.Zd,Dc)||0;Ub.setPropertyUint32(gc,Dc,this.N6k(Bb,fb));Cb.Ze.add(m.a.Ha(Dc));return!0}return!1}N6k(Cb,gc){return Cb>gc?Cb:gc}static ig(){return new Lc}static get instance(){return Lc.Gf.value}}
Lc.Gf=new x.a(Lc.ig);Object(G.a)(Lc,"VectorClockNodeComplexMerge",u.a,[]);class uc extends u.a{constructor(){super()}get $l(){return 28}get Yx(){return 0}$i(){const Cb=super.$i();Cb.Z(m.a.Ha(k.a.Weh),3);Cb.Z(m.a.Ha(k.a.Ib),3);Cb.Z(m.a.Ha(k.a.qxk),5);Cb.Z(m.a.Ha(k.a.r5h),5);Cb.Z(m.a.Ha(k.a.pea),5);return Cb}static ig(){return new uc}static get instance(){return uc.Gf.value}}uc.Gf=new x.a(uc.ig);Object(G.a)(uc,"WordSectionNodeComplexMerge",u.a,[]);b.d(P,"a",function(){return od});class od{e9g(Cb,gc){switch(Cb.Gb){case 131073:return Cb.hasProperty(k.a.imageType)||
Cb.hasProperty(f.a.CX)?this.Cn(Ga.instance,gc):this.Cn(nb.instance,gc);case 1074135140:return this.Cn(w.instance,gc);case 1074135137:return this.Cn(F.instance,gc);case 1074135139:return this.Cn(L.instance,gc);case 1074135138:return this.Cn(E.instance,gc);case 1074135136:return this.Cn(J.instance,gc);case 1074135157:return this.Cn(O.instance,gc);case 1074135152:return this.Cn(N.instance,gc);case 1074135153:return this.Cn(V.instance,gc);case 1074135126:return this.Cn(W.instance,gc);case 1074135127:return this.Cn(ca.instance,
gc);case 1074135145:return this.Cn(ja.instance,gc);case 1074135144:return this.Cn(H.instance,gc);case 1074135142:return this.Cn(Ba.instance,gc);case 1074135143:return this.Cn(la.instance,gc);case 1074135163:return this.Cn(ia.instance,gc);case 1074135164:return this.Cn(oa.instance,gc);case 1074135124:return this.Cn(ha.instance,gc);case 1074135125:return this.Cn(pa.instance,gc);case 1074135122:return this.Cn(Fa.instance,gc);case 393233:return this.Cn(Ga.instance,gc);case 1073872970:return this.Cn(Ga.instance,
gc);case 1074135170:return this.Cn($a.instance,gc);case 1074135168:return this.Cn(fa.instance,gc);case 1074135166:return this.Cn(sa.instance,gc);case 1074135167:return this.Cn(qa.instance,gc);case 1074135169:return this.Cn(va.instance,gc);case 1074135165:return this.Cn(Ca.instance,gc);case 393234:return this.Cn(Za.instance,gc);case 393229:return this.Cn(Ka.instance,gc);case 393241:return this.Cn(xa.instance,gc);case 393227:return this.Cn(Db.instance,gc);case 131120:return this.Cn(Lb.instance,gc);
case 393271:return this.Cn(Ua.instance,gc);case 393230:return this.Cn(Va.a.instance,gc);case 131140:return this.Cn(La.instance,gc);case 1179649:return this.Cn(Aa.instance,gc);case 1073872969:return this.Cn(Ma.instance,gc);case 393252:return this.Cn(Rb.instance,gc);case 393250:return this.Cn(Oa.instance,gc);case 393251:return this.Cn(lb.instance,gc);case 1074135154:return this.Cn(lc.instance,gc);case 1074135161:return this.Cn(gb.instance,gc);case 1074135162:return this.Cn(xb.instance,gc);case 1074135155:return this.Cn(Lc.instance,
gc);case 1073872968:return this.Cn(uc.instance,gc);case 1074135172:return this.Cn(Wa.instance,gc);case 1074135171:return this.Cn(ta.instance,gc);case 1074135149:return this.Cn(Ea.instance,gc);case 1074135151:return this.Cn(Ha.instance,gc)}return this.Cn(u.a.instance,gc)}Cn(Cb,gc){Cb.Ua=gc?gc():null;return Cb}}Object(G.a)(od,"GraphNodeComplexMergeFactory",null,[1870])},1730:function(G,P,b){b.r(P);G=b(0);var k=b(1337),f=b(76),x=b(265),u=b(69),w=b(1309);class r{constructor(Q,R,K,J=0){this.hHh=Q;this.groupType=
R;this.dcf=J;this.OTc=K}}Object(G.a)(r,"SortingGroup",null,[]);class m{constructor(Q,R,K,J){this.order=Q;this.e4=R;this.Snl=K;this.groupType=J}}Object(G.a)(m,"SortingProp",null,[]);var l=b(1297),z=b(1301),F=b(1296),L=b(1287);class E{constructor(Q,R){this.p3h={};this.o3h={};this.k3h=this.v3h=1;this.iYg(Q,R)}tun(Q,R,K){var J=F.a.IX(K)?this.p3h:this.o3h;K=new f.a;for(var O of R)R=Object(u.a)(m,J[k.a[O.groupType].toLowerCase()]),L.c(R)||K.add(new x.a(R,O));K.Sc((V,W)=>V.key.order<W.key.order?-1:1);Array.clear(Q);
O=l.TellMeActor.instance.PW;for(R=0;R<K.count;){J=K.J(R).key.e4;var N=K.J(R).value;const V=new w.a(K.J(R).key.groupType);L.c(O)||O.Location===z.a.contextMenu||(V.displayName=K.J(R).key.Snl);for(const W of N.results)V.Xw(W);for(N=++R;N<K.count&&K.J(N).key.e4===J;)this.SHe(V,K.J(N).value),N=++R;Q.push(V)}}eRn(Q,R){this.k3h=this.v3h=1;this.iYg(Q,R)}iYg(Q,R){this.DJi(Q);for(var K=0;K<Q.length;K++){let J=Q[K];for(const O of J.OTc)this.GDj(O,K,J.hHh,J.groupType)}this.DJi(R);for(Q=0;Q<R.length;Q++){K=R[Q];
for(const J of K.OTc)this.FDj(J,Q,K.hHh,K.groupType)}}DJi(Q){Q.sort((R,K)=>Object(u.a)(r,R).dcf>Object(u.a)(r,K).dcf?-1:1)}GDj(Q,R,K,J){this.p3h[k.a[Q].toLowerCase()]=new m(this.v3h++,R,K,J)}FDj(Q,R,K,J){this.o3h[k.a[Q].toLowerCase()]=new m(this.k3h++,R,K,J)}SHe(Q,R){for(let K=0;K<R.results.length;K++)Q.Xw(R.results[K])}}Object(G.a)(E,"BaseGroupingSorter",null,[]);class A{constructor(){this.QNd=[new r(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,4,[4,2]),new r(CommonUIStrings.l_TellMeCommandProviderTitle,
7,[18,16,7]),new r(CommonUIStrings.l_TellMeSuggestionsProviderTitle,28,[15,14,19,3]),new r("",13,[13]),new r("",22,[22])];this.LNd=[new r(CommonUIStrings.l_TellMeCommandProviderTitle,26,[17,0,1,8]),new r(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,27,[2,19,23]),new r(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,28,[15,14,20,9,12,10,11,24]),new r("",13,[13]),new r("",22,[22])];this.X2h=new E(this.QNd,this.LNd)}UWc(Q,R,K,J=null,O=null){let N=!1;if(J){for(const V of F.a.IX(K)?this.QNd:
this.LNd)this.jMm(V,J);N=!0}if(O){for(const V of F.a.IX(K)?this.QNd:this.LNd)this.fRn(R,V,O);N=!0}N&&this.X2h.eRn(this.QNd,this.LNd);this.X2h.tun(Q,R,K)}jMm(Q,R){const K=new f.a;for(var J of Q.OTc){const O=R[k.a[J].toLowerCase()];K.add(new x.a(L.c(O)?Number.MAX_VALUE:O,J))}if(K.count){K.Sc((O,N)=>O.key<N.key?-1:1);R=Array(K.count);for(J=0;J<K.count;J++)R[J]=K.J(J).value;Q.OTc=R}}fRn(Q,R,K){let J=0;for(const O of R.OTc)if(k.a[O].toLowerCase()in K&&K[k.a[O].toLowerCase()])for(const N of Q)if(N.groupType===
O){J+=K[k.a[O].toLowerCase()];break}R.dcf=J}}Object(G.a)(A,"SimplifiedGroupingSorter",null,[]);b.d(P,"GroupsPlacementInfo",function(){return M});class M{constructor(Q){this.n3h={};this.l3h={};this.m3h={};this.q3h={};this.Uqf={};this.r3h=this.R9l=this.L9l=this.N9l=1;this.s3h=null;this.$G=Q;this.wYj();this.nCm();this.$Xj();this.OWj();Q.GY&&(this.s3h=new A)}VH(Q){this.n3h[k.a[Q].toLowerCase()]=this.N9l++}QL(Q,R){this.l3h[k.a[Q].toLowerCase()]=R}LGa(Q){this.m3h[k.a[Q].toLowerCase()]=this.L9l++}o_(Q){this.q3h[k.a[Q].toLowerCase()]=
this.R9l++}mD(Q){this.Uqf[k.a[Q].toLowerCase()]=this.r3h++}wYj(){const Q=!!this.$G&&this.$G.$Xa,R=!!this.$G&&this.$G.$Oc,K=!!this.$G&&this.$G.ldb,J=!!this.$G&&this.$G.vmf&&!F.a.wAb(),O=!!this.$G&&this.$G.FKc,N=!!this.$G&&this.$G.qhf;this.VH(4);this.VH(18);this.VH(16);this.VH(7);this.VH(17);this.VH(0);this.VH(1);O&&this.VH(23);Q||this.VH(2);Q&&!R||this.VH(8);this.VH(15);K&&this.VH(20);this.VH(14);this.VH(9);this.VH(12);this.VH(10);this.VH(11);Q&&this.VH(2);Q&&!R&&this.VH(8);this.VH(19);N&&this.VH(24);
this.VH(21);this.VH(13);J&&this.VH(22)}nCm(){this.QL(21,1);this.QL(4,3);this.QL(18,3);this.QL(16,3);this.QL(7,3);this.QL(17,5);this.QL(0,5);this.QL(1,1);this.QL(2,1);this.QL(8,2);this.QL(15,3);this.QL(14,2);this.QL(24,3);this.QL(9,1);this.QL(12,1);this.QL(10,1);this.QL(11,1);this.QL(19,1);this.QL(23,1);this.QL(13,1);this.QL(20,2);this.QL(22,1)}$Xj(){this.LGa(4);this.LGa(0);this.LGa(17);this.LGa(7);this.LGa(16);this.LGa(18);this.LGa(15);this.LGa(20);this.LGa(8);this.LGa(14)}OWj(){this.o_(14);this.o_(10);
this.o_(12);this.o_(9);this.o_(11);this.o_(20);this.o_(15);this.o_(8);this.o_(2);this.o_(1);this.o_(24);this.o_(7);this.o_(18);this.o_(16);this.o_(17);this.o_(0);this.o_(4)}r2m(){this.Uqf={};this.r3h=1}kel(Q,R,K){this.r2m();const J=!!this.$G&&this.$G.$Xa,O=!!this.$G&&this.$G.$Oc,N=!!this.$G&&this.$G.ldb,V=!!this.$G&&this.$G.vmf&&!F.a.wAb(),W=!!this.$G&&this.$G.FKc,ca=!!this.$G&&this.$G.qhf;Q=Q&&O;this.mD(4);this.mD(18);this.mD(16);this.mD(7);this.mD(17);this.mD(0);this.mD(1);W&&this.mD(23);J&&!O||
!Q||this.mD(8);R&&this.mD(15);J||this.mD(2);ca&&this.mD(24);K&&this.mD(14);J&&!O||Q||this.mD(8);R||this.mD(15);N&&this.mD(20);K||this.mD(14);this.mD(9);this.mD(12);this.mD(10);this.mD(11);J&&this.mD(2);J&&!O&&this.mD(8);this.mD(19);this.mD(21);this.mD(13);V&&this.mD(22);return this.Uqf}oM(){return this.$G}}Object(G.a)(M,"GroupsPlacementInfo",null,[])},1732:function(G,P,b){G=b(0);var k=b(1601),f=b(51);class x{constructor(){this.source=0;this.Nk=this.Mta=this.C1=null;this.S0=0;this.Y0b=!1;this.mode=
this.tNa=0;this.rBc=null;this.YBb=f.a.create()}}Object(G.a)(x,"InputState",null,[]);class u{constructor(){this.timeout=this.succeeded=this.crash=!1;this.xK=null}}Object(G.a)(u,"OutputState",null,[]);class w{constructor(){this.$Mh=this.M1d=this.kWc=!1;this.Ua=this.zOd=this.jCf=this.iXd=this.KWf=this.Ctb=this.oHa=this.MC=this.zeb=this.Pac=this.g_f=this.aGk=this.Xk=this.PWe=this.So=this.xr=this.Ci=this.I6d=this.kwd=this.Xwa=null}}Object(G.a)(w,"RuntimeState",null,[]);b.d(P,"a",function(){return r});
class r{constructor(){this.input=new x;this.runtime=new w;this.output=new u;this.logger=new k.a(this)}}Object(G.a)(r,"MergeState",null,[])},1733:function(G,P,b){b.r(P);G=b(0);var k=b(574),f=b(202),x=b(143),u=b(246),w=b(1452),r=b(1554),m=b(1579),l=b(6),z=b(1724);class F{constructor(K,J){this.start=K;this.end=J}}Object(G.a)(F,"MergeDiffIdx",null,[]);class L{constructor(K,J,O,N=!1,V=null,W=null,ca=!0){this.F4c=this.E4c=this.Cfg=this.knc=0;this.uSb=this.Nbe=null;this.r4a=V||new z.a;this.Hf=O;this.sma=
K.s1();this.Zyj=J.s1();this.eN=new F(0,0);this.GQ=new F(0,0);this.Lle=N;this.ukc=ca;this.Xma=W;this.n_j();this.rgn()}get bI(){return this.sma}get qH(){return this.Zyj}get mx(){return this.knc}get $x(){return this.Cfg}get Hpa(){return this.E4c}get Wha(){return this.F4c}get ruk(){const K=new f.a;for(let J=this.Nbe.start;J<this.Nbe.end;J++)K.add(this.bI.Ye(J));return K}get WXe(){const K=new f.a;for(let J=this.uSb.start;J<this.uSb.end;J++)K.add(this.qH.Ye(J));return K}YYe(K){if(this.$x<K.$x){if(this.$x+
this.Hpa>K.$x)return!0}else if(this.$x>K.$x){if(K.$x+K.Hpa>this.$x)return!0}else if(2===this.mx&&3===K.mx||3===this.mx&&2===K.mx||2===this.mx&&2===K.mx||3===this.mx&&3===K.mx)return!0;return!1}Qsi(K,J,O,N){K.HD(J);K.ez(J,O);return N+=O.length-1}aKi(K,J,O,N,V){let W=this.bI.Ye(K),ca=this.qH.Ye(J);if(!W||!ca||!W.A0a&&!ca.A0a)return{returnValue:!1,Dwa:N,SCa:V};let H=new f.a,Z=new f.a;W.A0a&&(H=W.bXc(),W=H.Ye(O?0:H.length-1));ca.A0a&&(Z=ca.bXc(),ca=Z.Ye(O?0:Z.length-1));if(!W.oy(ca,this.r4a,this.Xma,
this.Lle,this.ukc))return{returnValue:!1,Dwa:N,SCa:V};H.length&&(N=this.Qsi(this.bI,K,H,N));Z.length&&(V=this.Qsi(this.qH,J,Z,V));return{returnValue:!0,Dwa:N,SCa:V}}nIk(K,J,O,N,V,W){for(;V<=O&&W<=N;){const ca=K.Ye(V),H=J.Ye(W);if(!ca.oy(H,this.r4a,this.Xma,this.Lle,this.ukc))break;this.eN.start+=ca.length;this.GQ.start+=H.length;V++;W++}return{TLe:V,P_f:W}}lIk(K,J,O,N,V,W){for(;V>=O&&W>=N;){const ca=K.Ye(V),H=J.Ye(W);if(!ca.oy(H,this.r4a,this.Xma,this.Lle,this.ukc))return{returnValue:!0,Dwa:V,SCa:W};
V--;W--}return{returnValue:!1,Dwa:V,SCa:W}}mIk(K,J,O,N){let V=!1;do({TLe:K,P_f:J}=this.nIk(this.bI,this.qH,O,N,K,J)),{Dwa:O,SCa:N,returnValue:V}=this.aKi(K,J,!0,O,N);while(V);return{TLe:K,P_f:J,Dwa:O,SCa:N}}kIk(K,J,O,N){let V=!1;do{if(!({Dwa:O,SCa:N}=this.lIk(this.bI,this.qH,K,J,O,N)).returnValue)break;({Dwa:O,SCa:N,returnValue:V}=this.aKi(O,N,!1,O,N))}while(V);return{Dwa:O,SCa:N}}n_j(){var K=0,J=0,O=this.bI.length-1,N=this.qH.length-1;0<=O&&this.bI.Ye(O);0<=N&&this.qH.Ye(N);({TLe:K,P_f:J,Dwa:O,SCa:N}=
this.mIk(K,J,O,N));if(K<O||J<N)({Dwa:O,SCa:N}=this.kIk(K,J,O,N));O++;N++;this.Nbe=new F(K,O);this.uSb=new F(J,N);this.eN.end=this.eN.start;this.GQ.end=this.GQ.start;for(var V=K;V<O;V++){var W=this.bI.Ye(V);this.eN.end+=W.length}for(V=J;V<N;V++)W=this.qH.Ye(V),this.GQ.end+=W.length;x.a.instance.ua(3993809,1,3,"CalculateDiffIndexes: NonGranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",K,O,J,N);x.a.instance.ua(3993810,1,3,"CalculateDiffIndexes: GranularList idxs [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}]",
this.eN.start,this.eN.end,this.GQ.start,this.GQ.end);this.eN.start<=this.eN.end&&this.GQ.start<=this.GQ.end&&(K=this.bI.Ye(K),J=this.qH.Ye(J),V=this.bI.Ye(O),W=this.qH.Ye(N),O=this.bI.Ye(O-1),N=this.qH.Ye(N-1),x.a.instance.ua(3993811,1,3,"CalculateDiffIndexes: Merge Blocks [Base.Start: {0}] [Base.End: {1}] [Update.Start: {2}] [Update.End: {3}] [Base.UnequalEnd: {4}] [Update.UnequalEnd: {5}]",K,V,J,W,O,N))}rgn(){this.Cfg=this.eN.start;this.E4c=this.F4c=0;this.eN.start===this.eN.end&&this.GQ.start===
this.GQ.end?this.knc=0:this.eN.start===this.eN.end&&this.GQ.start<this.GQ.end?(this.knc=1,this.F4c=this.GQ.end-this.GQ.start):this.GQ.start===this.GQ.end&&this.eN.start<this.eN.end?(this.knc=2,this.E4c=this.eN.end-this.eN.start):(this.knc=3,this.E4c=this.eN.end-this.eN.start,this.F4c=this.GQ.end-this.GQ.start);x.a.instance.ua(3993814,1,3,"SetMergeDiffType: [MergeDiffType: {0}] [DiffIndex: {1}] [DiffLengthBase: {2}] [DiffLengthUpdate: {3}]",this.mx,this.$x,this.Hpa,this.Wha)}fOl(K,J){return K.L0()&&
J.L0()?K.runId===J.runId&&K.qf===J.qf:!1}YSl(K){if(!K.L0()||"\ufffc"!==K.text)return!1;K=K.pwb;return K?K.hasProperty(l.a.Oj)||K.hasProperty(l.a.jnd)||K.hasProperty(l.a.BZe)||K.hasProperty(l.a.S3)||K.hasProperty(l.a.imageType)||K.hasProperty(l.a.yKa)||K.hasProperty(l.a.BAb)||K.hasProperty(l.a.Qp)&&(K=this.Hf.getPropertyInt32(K,l.a.Qp))&&(36===K||35===K||24===K||23===K||33===K||34===K||44===K||45===K||42===K||43===K)?!0:!1:!1}DJc(K){return K.L0()&&!this.YSl(K)}S0j(){if(2===this.mx)return!1;var K=this.uSb.start;
if(!K)return!1;let J=null;for(var O=this.uSb.start;O<this.uSb.end;O++){const N=this.qH.Ye(O);if(this.DJc(N)){J=N;break}}if(!J)return!1;--K;for(O=this.qH.Ye(K);O&&!this.DJc(O);)K--,O=this.qH.Ye(K);return O&&this.fOl(O,J)?!0:!1}vvh(K){const J=new f.a;for(let O=0;O<K.length;O++)K.J(O).A0a?J.ez(J.length,K.J(O).bXc()):J.insert(J.length,K.J(O));return J}hOl(){if(3!==this.mx||this.Hpa!==this.Wha)return!1;const K=this.vvh(this.ruk),J=this.vvh(this.WXe);if(K.length!==J.length)return!1;for(let O=0;O<K.length;O++)if(!K.J(O).oy(J.J(O),
this.r4a,this.Xma,!0,this.ukc))return!1;return!0}gOl(){if(0!==this.mx&&3!==this.mx||this.bI.length!==this.qH.length)return!1;let K=!1;for(let J=0;J<this.bI.length;J++){if(!this.bI.J(J).oy(this.qH.J(J),this.r4a,this.Xma,!0,this.ukc))return!1;if(3===this.bI.J(J).type||1===this.bI.J(J).type){const O=this.bI.J(J),N=this.qH.J(J);K=O.runId!==N.runId||O.qf!==N.qf||K}}return K}}Object(G.a)(L,"MergeBlockDiff",null,[]);var E=b(1399);class A{constructor(K,J){this.id=K;this.index=J}}Object(G.a)(A,"ParagraphStartIndex",
null,[]);var M=b(1463),Q=b(1381);b.d(P,"ParagraphMerge",function(){return R});class R{constructor(K,J,O,N,V,W,ca){this.yQb=this.Wob=this.kn=this.qv=null;this.rg=!1;this.PJg=this.Yhg=this.K$f=this.roa=this.qEa=this.sma=null;this.Rc=K;this.WC=J;this.Vva=N;this.Dua=O;this.Wma=V;this.Xma=W;this.Hf=ca}CBh(K){const J=new k.a;K.bI.forEach(O=>{2===O.type&&J.add(O.oi);return!0});K.qH.forEach(O=>{2===O.type&&J.remove(O.oi);return!0});return J}myh(K){const J=new f.a;K.qH.forEach(O=>{2===O.type&&J.add(O.oi);
return!0});return J}f5g(K){const J=new f.a;let O=0,N=0;K.qH.forEach(V=>{2===V.type&&(J.add(new A(V.oi,O<K.$x?O:O<K.$x+K.Wha?K.$x:O-K.Wha+K.Hpa)),O=N);N+=V.length;return!0});return J}Vak(K,J){var O=this.f5g(K);const N=this.f5g(J);K=this.CBh(K);const V=this.CBh(J);J=new f.a;const W=new k.a;let ca=0;for(let H=0;H<O.length;H++){const Z=O.J(H);if(ca<N.length){let aa=N.J(ca);for(;ca<N.length&&aa.index<=Z.index;){if(aa.id.equals(Z.id)){ca++;break}K.contains(aa.id)||W.contains(aa.id)||(J.add(aa.id),W.add(aa.id));
ca++;aa=N.J(ca)}}V.contains(Z.id)||(J.add(Z.id),W.add(Z.id))}for(;ca<N.length;)O=N.J(ca),K.contains(O.id)||W.contains(O.id)||(J.add(O.id),W.add(O.id)),ca++;return J}initialize(){if(this.rg){const K=!!this.qv&&!!this.kn;this.Rc.logger.Cf(Object.assign(new E.a,{Ph:"ParagraphMerge.Initialize",info:"MergeDiff objects not initialized"}));return K}this.rg=!0;if(!({bI:this.sma,qBc:this.qEa,oZc:this.roa,Xmd:this.K$f,lwd:this.Yhg,J6d:this.PJg}=Q.a.A9g(this.Rc,this.Hf,this.WC,this.Dua,this.Vva,this.Wma,!1,
!1)).returnValue)return!1;this.qv=new L(this.sma,this.qEa,this.Hf,void 0,void 0,this.Xma);this.kn=new L(this.sma,this.roa,this.Hf,void 0,void 0,this.Xma);x.a.instance.ua(593272919,1,3,String.format("FavoredBaseDiffLen: {0} FavoredUpdateDiffLen: {1} UnfavoredBaseDiffLen: {2} UnfavoredUpdateDiffLen {3}",this.qv.Hpa,this.qv.Wha,this.kn.Hpa,this.kn.Wha));return!0}JCa(){x.a.instance.ua(593826836,1,3,"Attempting to merge with LCS");let K=!1;const J=new m.a(this.Hf,this.Rc);let O=null,N=null;var V=null;
const W=H=>this.Rc.runtime.Ci.J(H),ca=H=>this.Rc.runtime.So.J(H)||this.Rc.runtime.Ci.J(H);this.qv=new L(this.sma,this.qEa,this.Hf,void 0,void 0,this.Xma,!1);this.kn=new L(this.sma,this.roa,this.Hf,void 0,void 0,this.Xma,!1);({updateHints:O}=J.V$g(this.WC,W,this.Dua,H=>this.Rc.runtime.xr.J(H)||this.Rc.runtime.Ci.J(H),this.qv.$x,this.qv.$x+this.qv.Hpa,this.qv.$x+this.qv.Wha)).returnValue&&({updateHints:N}=J.V$g(this.WC,W,this.Vva,ca,this.kn.$x,this.kn.$x+this.kn.Hpa,this.kn.$x+this.kn.Wha)).returnValue&&
(K=!0);K||(x.a.instance.ua(593826835,1,2,"Failed to create update hints with LCS"),K=!1);K&&(V=new M.a(this.Rc,this.WC,this.Dua,this.Vva,H=>this.Rc.runtime.Ua?this.Rc.runtime.Ua.isFeatureEnabled(H):!1,this.Hf,null,O,N),({Xk:V}=V.Ecc()).returnValue||(x.a.instance.ua(593826834,1,2,"Failed to merge using LCS generated UpdateHints"),this.Rc.logger.Cf(Object.assign(new E.a,{Ph:"TryLCSMerge",eventId:"9zrqs"})),K=!1));x.a.instance.ua(593826833,1,K?3:2,"TryLCSMerge: [Success: {0}]",K);return{returnValue:K,
Xk:V}}Ecc(){let K;K=null;if(!this.initialize())return this.Rc.logger.YR("ParagraphMerge Initialize"),this.yYa(),{returnValue:!1,Xk:K};this.Rc.logger.YR("ParagraphMerge Initialize");let J;this.Rc.logger.B0d(2);let O=({JCa:J}=this.Swk()).returnValue;O=O&&({Xk:K,JCa:J}=this.ZDc(this.Rc,this.Hf,this.Wma,this.yQb,this.Wob)).returnValue;this.Rc.logger.qQf();if(!O){this.Rc.logger.YR("ParagraphMerge DoMergeInteral");if(J){this.Rc.logger.B0d(3);({Xk:K,returnValue:O}=this.JCa());this.Rc.logger.qQf();if(O)return{returnValue:!0,
Xk:K};this.yYa();return{returnValue:!1,Xk:K}}this.yYa();return{returnValue:!1,Xk:K}}if(!({Xk:K,JCa:J}=this.ZDc(this.Rc,this.Hf,this.Wma,this.yQb,this.Wob)).returnValue)return this.Rc.logger.YR("ParagraphMerge DoMergeInteral"),this.yYa(),{returnValue:!1,Xk:K};this.Rc.logger.YR("ParagraphMerge DoMergeInteral");return{returnValue:!0,Xk:K}}ZDc(){let K;if(!({PTd:K}=Q.a.ZDc(this.Rc,this.Hf,this.Wma,this.yQb,this.Wob)).returnValue)return this.Rc.logger.YR("ParagraphMerge GetMergeableObjectsFromMergeBlocks"),
this.yYa(),{returnValue:!1,Xk:K,JCa:!0};this.Rc.logger.YR("ParagraphMerge GetMergeableObjectsFromMergeBlocks");return{returnValue:!0,Xk:K,JCa:!1}}yYa(K=!1){x.a.instance.Uea(4478665,1,1,"ParagraphMergeFailed: [IsCpMerge: "+K+"] BaseRevisionMergeBlocksList: {0}",this.K$f);x.a.instance.Uea(4478666,1,1,"FavoredRevisionMergeBlocksList: {0}",this.Yhg);x.a.instance.Uea(4478667,1,1,"UnfavoredRevisionMergeBlocksList: {0}",this.PJg);K=new f.a;Q.a.U4b(this.Hf,"BaseObjects_",this.WC,K);Q.a.U4b(this.Hf,"FavoredObjects_",
this.Dua,K);Q.a.U4b(this.Hf,"ConflictObjects_",this.Vva,K);Q.a.u3l(this.Rc,K)}CZg(K){let J,O;O=J=0;if(0===this.qv.mx)J=this.kn.$x;else if(1===this.qv.mx)J=this.kn.$x<this.qv.$x?this.kn.$x:this.kn.$x===this.qv.$x?K||1!==this.kn.mx?this.kn.$x+this.qv.Wha:this.kn.$x:this.kn.$x+this.qv.Wha;else if(2===this.qv.mx||3===this.qv.mx)J=this.kn.$x<=this.qv.$x?this.kn.$x:this.kn.$x+(this.qv.Wha-this.qv.Hpa);if(2===this.kn.mx||3===this.kn.mx)O=J+this.kn.Hpa;return{RGh:J,nnl:O}}Olh(K,J){let O;O=0;if(!J)return{returnValue:!0,
NNc:O};let N=0,V=0;for(;N<K.length;){let W;for(let ca=N;ca<K.length;ca++){N=ca;W=K.J(ca);const H=W.length;V+=H;if(!(V<J)){if(V>J)if(W.A0a)K.HD(N),K.ez(N,W.bXc()),V-=H;else return x.a.instance.ua(3993819,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}] as the block could not be split",J),this.Rc.logger.Cf(Object.assign(new E.a,{Ph:"FindNonGranularListIndex",eventId:"appd1"})),{returnValue:!1,NNc:O};break}}if(V===
J)return N++,O=N,{returnValue:!0,NNc:O}}x.a.instance.ua(3993820,1,1,"ParagraphMerge:FindNonGranularListIndex: ParagraphMerge returned failure as we were unable to find index for [GranularListIndex: {0}]",J);this.Rc.logger.Cf(Object.assign(new E.a,{Ph:"FindNonGranularListIndex",eventId:"appd2"}));return{returnValue:!1,NNc:O}}zPj(K,J,O){let N=0;var V=0,W=!1;const ca=this.kn.WXe.s1();if(this.kn.S0j())for(--J;0<=J;J--){let H=K.J(J);if(this.kn.DJc(H)){V=K.J(J);N=V.runId;V=V.qf;W=!0;break}}W||((V=K.J(O))&&
this.kn.DJc(V)?(N=V.runId,V=V.qf):V=N=0);for(K=0;K<ca.length;K++)O=ca.J(K),O.L0()&&(W=O,this.kn.DJc(O)?(W.runId=N,W.qf=V):(W.runId=0,W.qf=0));return ca}IUh(K){if(2===K.length){const J=1===K.J(0).type?K.J(0):null;K=2===K.J(1).type;if(J&&K&&""===J.text)return!0}return!1}Swk(){const K=this.qv.gOl();if(!K&&0===this.qv.mx)return this.yQb=this.kn.qH.s1(),this.Wob=this.myh(this.kn),{returnValue:!0,JCa:!1};if(0===this.kn.mx)return this.yQb=this.qv.qH.s1(),this.Wob=this.myh(this.qv),{returnValue:!0,JCa:!1};
(this.IUh(this.qv.qH)||this.IUh(this.kn.qH))&&this.Rc.logger.o0h(Object.assign(new E.a,{info:"DoMergeInternal - OneParaEmpty"}));if(!K){var J=this.qv.YYe(this.kn);J&&this.Wma(91)&&(x.a.instance.ua(17326359,1,2,"DoMergeInternal: Diff overlaps when we take formatting ids into account. Running another diff without formatting ids"),this.qv=new L(this.sma,this.qEa,this.Hf,!0,void 0,this.Xma),this.kn=new L(this.sma,this.roa,this.Hf,!0,void 0,this.Xma),J=this.qv.YYe(this.kn));if(J)return x.a.instance.ua(3993821,
1,2,"DoMergeInternal: We were unable to merge as there was an overlap in the changes in the 2 revisions"),this.Rc.logger.Cf(Object.assign(new r.a,{Ph:"ParagraphMerge",eventId:"appd3"})),{returnValue:!1,JCa:!0}}var O;J=0;this.Wob=this.Vak(this.qv,this.kn);({RGh:O,nnl:V}=this.CZg(!1));const N=this.qv.qH.s1();if(!({NNc:O}=this.Olh(N,O)).returnValue||(2===this.kn.mx||3===this.kn.mx)&&!({NNc:J}=this.Olh(N,V)).returnValue)return{returnValue:!1,JCa:!1};if(2===this.kn.mx||3===this.kn.mx){this.t$b(N,J);this.t$b(N,
O-1);var V=null;for(var W=J-1;W>=O;W--)2===N.J(W).type&&(V=N.J(W)),N.HD(W);0<N.length&&(W=N.J(N.length-1),2!==W.type&&4!==W.type&&V&&(this.Rc.runtime.Ua.ks(125),this.Rc.runtime.Ua.isFeatureEnabled(125)&&(N.add(V),this.Wob.add(V.oi))));x.a.instance.ua(4019726,1,3,"DoMergeInternal deleted [Length: {0}] merge blocks at [Index: {1}]",J-O-1,O)}if(1===this.kn.mx||3===this.kn.mx)V=this.kn.WXe,K&&(V=this.zPj(N,O,J)),this.t$b(N,O-1),this.t$b(N,O),this.t$b(V,0),this.t$b(V,V.length-1),N.ez(O,V),x.a.instance.ua(4019727,
1,3,"DoMergeInternal: Inserted merge blocks at [Index: {0}] [Syncdiff merge: {1}] [Merge Blocks: {2}]",O,K,V.xp());this.yQb=N;return{returnValue:!0,JCa:!1}}t$b(K,J){0>J||J>=K.length||(K=K.J(J),Object(u.a)(w.a,K)&&(K.pKa=!0))}zZc(K,J){let O;O=J;if(!this.initialize())return{returnValue:!1,o_a:K,Vka:O};if(this.kn.YYe(this.qv))return this.yYa(!0),this.Rc.logger.Cf(Object.assign(new r.a,{Ph:"ParagraphMerge",info:"Is a CpMerge"})),{returnValue:!1,o_a:K,Vka:O};if(0===this.kn.mx||3===this.kn.mx&&this.kn.hOl())return{returnValue:!0,
o_a:K,Vka:J};let N;({RGh:N}=this.CZg(!0));J<N||J===N&&(1!==this.kn.mx||1===this.kn.mx&&1===this.qv.mx&&J===this.qv.$x+this.qv.Wha)?O=J:(O=J+this.kn.Wha-this.kn.Hpa,O<N&&(O=N));return{returnValue:!0,o_a:K,Vka:O}}}Object(G.a)(R,"ParagraphMerge",null,[1868])},1734:function(G,P,b){b.r(P);G=b(0);var k=b(1469),f=b(1378),x=b(1337),u=b(1560),w=b(1377);class r{constructor(M="",Q="",R="",K=-99999,J=-1,O=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=M?M:"";this.Description=
Q?Q:"";this.Type=R?R:"";this.Score=K;this.Age=J;this.Count=O}}Object(G.a)(r,"Suggestion",null,[]);class m{constructor(M,Q){this.GroupType=this.Suggestions=null;this.Suggestions=M;this.GroupType=Q}}Object(G.a)(m,"SuggestionGroup",null,[]);class l{}l.help="help";l.answer="answer";l.commands="commands";l.cbn="servicecommands";l.template="template";Object(G.a)(l,"SuggestionGroupType",null,[]);var z=b(1297),F=b(1296),L=b(2),E=b(31);b.d(P,"InteractionLogger",function(){return A});class A{constructor(M,
Q,R){this.ohe=0;this.aDe=this.emc=null;this.Qc=M;this.gBe=this.Gee=this.jme=!1;this.Vaj=Q;this.Qe=L.AFrameworkApplication.fe;this.wb=R;this.b4c=this.Jve=0}get aea(){return this.Qc.aea}J0d(M){this.Qc.J0d(M)}G1h(){if(this.emc){var M=0;for(const Q of this.emc)this.Qc.f7l(Q,M++);this.emc=null}}beginQuery(M,Q,R){this.Qc.U6l(M,Q,R)}Ueb(M,Q){this.Qc.cTj(M,Q);this.jme=!0;this.gBe=!1}Xra(){this.jme=!1;this.Gee||(this.G1h(),this.Qc.qhh(this.ohe))}V6l(M,Q){this.Qc.W6l(M,Q)}Rlm(M,Q,R,K,J){for(const O of this.Vaj)if(M.startsWith(O)){this.gBe=
!0;break}this.Qc.N2l(M,Q,R,K,J)}wmm(M){this.Gee=!1;this.ohe=M;this.jme||this.gBe||(this.G1h(),this.Qc.qhh(this.ohe,!1))}vmm(M,Q){this.Qc.S2l(M,Q);this.Gee=!0}n4e(M,Q){if(!M.count)return"";let R="";const K=Date.now();for(let J of M)M=(K-J.timeStamp)/1E3,M=F.a.kZf(M),0<R.length&&(R+=";"),R+=Q?J.commandId:J.controlId,R+=":",R+=M.toString();return R}iZa(){var M=this.n4e(k.a.instance.vZb(),!1);0<M.length&&this.Qc.L2l(M);M=this.n4e(k.a.instance.twb(),!0);0<M.length&&this.Qc.h2l(M);M=this.n4e(k.a.instance.a6c,
!0);0<M.length&&this.Qc.I3l(M);M=z.TellMeActor.instance.Lvg;0<M.length&&this.Qc.S6l(E.c(M))}A7l(M){this.Qc.r2l(M)}N4(M,Q,R,K,J,O,N,V=null){this.Qc.P4l(M,Q,R,K,J,O,N,V)}aqf(M,Q,R,K){this.Qc.aqf(M,Q,R,K)}jA(M,Q,R=null){this.Qc.l9(M,Q,R)}onError(M,Q,R=null){this.Qc.xYa(M,Q,R)}Jfn(M){this.emc=M}mhl(M){const Q=[];if(!M)return Q;for(let R=0;R<M.length;R++){const K=x.a[M[R].groupType].toLowerCase(),J=[],O=M[R].results;if(O){for(let N=0;N<O.length;N++)"findindocument"===K?Array.add(J,new r("","",K,O[N].score,
O[N].Kld,O[N].count)):Array.add(J,new r(O[N].label,O[N].description,K,O[N].score,O[N].Kld,O[N].count));"answer"===K||"definition"===K||"wolframanswer"===K||"entity"===K?Array.add(Q,new m(J,l.answer)):"classifier"===K||"appsforoffice"===K?Array.add(Q,new m(J,l.commands)):"serviceclassifier"===K?Array.add(Q,new m(J,l.cbn)):"assistance"===K?Array.add(Q,new m(J,l.help)):("document"===K||"people"===K||"findindocument"===K||"notes"===K||"image"===K||"template"===K)&&Array.add(Q,new m(J,K))}}return Q}laf(M,
Q){const R={};R.Query=Q;R.SuggestionGroups=E.c(this.mhl(M));return E.c(R)}qEh(M){const Q={"Content-Type":"application/json",Accept:"application/json"};Q["X-Office-Version"]=L.AFrameworkApplication.buildVersion;Q["X-Office-Application"]=L.AFrameworkApplication.K.Ga("Application");Q["X-Office-Platform"]="WAC";Q["X-TellMe-SqmUserId"]=L.AFrameworkApplication.K.Ga("LoggableUserId")||"";Q["X-TellMe-SessionId"]=this.Qc.aea.Nca;Q["X-TellMe-SuggestionTypes"]="Ranker";Q["X-TellMe-Culture"]=L.AFrameworkApplication.uiCulture;
Q["X-TellMe-ProcessSessionId"]=L.AFrameworkApplication.userSessionId;Q["X-TellMe-Flights"]=M;Q["X-TellMe-PartialQueryIndex"]=this.Jve;return Q}eDb(M,Q,R){this.N4(Q.length,"RankerLogging",M.data.we.toString(),Math.round(window.performance.now()-R),w.a.JNi,!0,f.a.DJa)}QCb(M,Q,R){this.N4(Q.length,"RankerLogging",M.data.we.toString(),Math.round(window.performance.now()-R),w.a.JNi,!1,f.a.DJa)}rEh(){this.aDe||(this.aDe=new u.a(this.wb,null,6E3));return this.aDe.C2a}cqf(M){const Q=this.laf(this.emc,M),R=
this.qEh("RankerLogging"),K=window.performance.now();this.Qe.ai(this.rEh(),2,Q,R,!1,0,J=>{this.eDb(J,M,K)},J=>{this.QCb(J,M,K)},null,null,!1,4E3,6E3);this.Jve++}h2m(){this.Jve=0}zPf(M){this.b4c=M}}Object(G.a)(A,"InteractionLogger",null,[])},1737:function(G,P,b){b.r(P);G=b(0);var k=b(17),f=b(6),x=b(143),u=b(202),w=b(51),r=b(1545),m=b(1451),l=b(1397),z=b(1381);class F{constructor(M,Q,R=null){this.author=M;this.dNc=Q;this.WEf=R||w.a.nil}oy(M){return M?this.author===M.author&&this.dNc===M.dNc&&this.WEf===
M.WEf:!1}}Object(G.a)(F,"RunMergeBlockTrackedChangeAttribute",null,[]);class L{constructor(M,Q,R){this.insertion=M||L.f_e;this.deletion=Q||L.f_e;this.hBa=R||L.f_e}get Qsl(){return 0<this.insertion.author.length}get psl(){return 0<this.deletion.author.length}get otl(){return 0<this.hBa.author.length}oy(M){return M?this.insertion.oy(M.insertion)&&this.deletion.oy(M.deletion)&&this.hBa.oy(M.hBa):!1}}L.f_e=new F("",0);Object(G.a)(L,"RunMergeBlockTrackedChangeInfo",null,[]);var E=b(1600);b.d(P,"ParagraphMergeBlockCreator",
function(){return A});class A extends m.a{constructor(M,Q,R,K,J,O,N){super();this.maxValue=Number.MAX_VALUE;this.Ky=new r.a;this.IKb=null;this.EL=0;this.Rog=!1;this.jnc="";this.Kae=M;this.Wq=Q;this.Ds=R;this.Evj=K;this.D6c=J;this.$ng=O;this.Hf=N;if(this.Hf.hasProperty(this.Wq,k.a.Pl))if(this.Hf.hasProperty(this.Wq,f.a.Ib))if(this.Hf.hasProperty(this.Wq,f.a.yp))if(this.Hf.hasProperty(this.Wq,f.a.Jr))if(this.Hf.hasProperty(this.Wq,k.a.mm))if(this.VZ=this.Hf.getPropertyString(this.Wq,k.a.Pl),this.bGe=
this.Hf.getPropertyUint32(this.Wq,f.a.Ib),this.yq=this.Hf.getPropertyUint32s(this.Wq,f.a.yp),this.Acd=this.Hf.getPropertyUint32s(this.Wq,f.a.Jr),this.yje=this.Hf.getPropertyObjectIds(this.Wq,k.a.mm),this.VZ||""===this.VZ)if(this.VZ.length||1!==this.yje.length||(this.yq.length||(this.yq.add(0),x.a.instance.ua(4322134,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no runIDs, fixing it")),this.Acd.length||(this.Acd.add(0),x.a.instance.ua(4322135,1,2,"MergeBlockIterator: Paragraph contains one formattingID, but no paraIDs, fixing it"))),
this.nnj=this.oyd(this.Wq,f.a.Svf,this.yq.length),this.Zoc=this.oyd(this.Wq,k.a.Ora,this.yq.length),this.Fga=this.oyd(this.Wq,k.a.Nhb,this.yq.length),this.Wfa=this.oyd(this.Wq,f.a.nJa,this.yq.length),this.tga=this.lkl(this.Wq,f.a.jBa,this.yq.length),this.Azl(),M=this.Hf.hasProperty(this.Wq,k.a.pl)?this.Hf.getPropertyUint32s(this.Wq,k.a.pl):new u.a,this.ofd=z.a.XCi(M,this.VZ.length),this.yq.length!==this.Acd.length)x.a.instance.ua(3993799,1,1,"MergeBlockIterator: Length of RunIds and ParaIds does not match on [Object: {0}]",
Q.id);else if(this.yq.length!==this.yje.length)x.a.instance.ua(3993800,1,1,"MergeBlockIterator: Length of FormattingIds and ParaIds does not match on [Object: {0}]",Q.id);else{this.$ng&&(this.Hf.hasProperty(this.Wq,f.a.Ot)?this.IKb=this.Hf.getPropertyObjectIds(this.Wq,f.a.Ot):(x.a.instance.ua(40939931,1,2,"MergeBlockIterator: ChangeIds are null on [Object: {0}]",Q.id),this.IKb=this.eX(this.yq.length,w.a.nil)),this.yq.length!==this.IKb.length&&(x.a.instance.ua(40939932,1,2,"MergeBlockIterator: Length of RunIds and ChangeIds don't match on [Object: {0}]. RunIds Length: {1} ChangeIds Length: {2}",
Q.id,this.yq.length,this.IKb.length),this.IKb=this.eX(this.yq.length,w.a.nil)));if(this.yq.length!==this.Zoc.length||this.yq.length!==this.Fga.length||this.yq.length!==this.Wfa.length||this.yq.length!==this.tga.length)this.yq.length===this.Zoc.length||this.D6c||x.a.instance.ua(8266445,1,1,"MergeBlockIterator: Length of NotProofedRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [NotProofedRuns Length: {2}]",Q.id,this.yq.length,this.Zoc.length),this.yq.length===this.Fga.length||
this.D6c||x.a.instance.ua(8266446,1,1,"MergeBlockIterator: Length of SpellErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [SpellErrorRuns Length: {2}]",Q.id,this.yq.length,this.Fga.length),this.yq.length===this.Wfa.length||this.D6c||x.a.instance.ua(20742792,1,1,"MergeBlockIterator: Length of GrammarErrorRuns and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [GrammarErrorRuns Length: {2}]",Q.id,this.yq.length,this.Wfa.length),this.yq.length===this.tga.length||
this.D6c||x.a.instance.ua(25274202,1,1,"MergeBlockIterator: Length of ProofingErrorHints and ParaIds does not match on [Object: {0}] [RunIds Length: {1}] [ProofingErrorHints Length: {2}]",Q.id,this.yq.length,this.tga.length),M=this.Hf.getPropertyBool(this.Wq,k.a.cSe),x.a.instance.ua(17877020,1,3,"MergeBlockIterator: Reproofing Para {0}. [ForceProofing: {1}] [ContainsIgnoredSpellingErrors: {2}]",Q.id,J,null==M?!1:M),this.Zoc=this.eX(this.yq.length,!0),this.Fga=this.eX(this.yq.length,!1),this.Wfa=this.eX(this.yq.length,
!1),this.tga=this.eX(this.yq.length,0),this.Hf.setPropertyBool(this.Wq,k.a.cSe,!1);this.Ky.xUn(this.yq.length)?(this.ofd.length!==this.yq.length+1&&x.a.instance.ua(3993801,1,1,"MergeBlockIterator: Length of RunIdexes is different than expected for [Object: {0}] [RunIds Length: {1}] [RunIndices Length: {2}]",Q.id,this.yq.length,this.ofd.length),this.ykj=!0):x.a.instance.ua(23205786,1,1,"MergeBlockIterator: Length of RunIds and tracked changes properties does not match on [Object: {0}]",Q.id)}else x.a.instance.ua(4322133,
1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",Q.id);else x.a.instance.ua(3993798,1,1,"MergeBlockIterator: FormattingIds is null on [Object: {0}]",Q.id);else x.a.instance.ua(3993797,1,1,"MergeBlockIterator: ParaIds is null on [Object: {0}]",Q.id);else x.a.instance.ua(3993796,1,1,"MergeBlockIterator: RunIds is null on [Object: {0}]",Q.id);else x.a.instance.ua(3993795,1,1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",Q.id);else x.a.instance.ua(3993794,1,
1,"MergeBlockIterator: RichEditTextUnicode is null on [Object: {0}]",Q.id)}Azl(){this.Hf.hasProperty(this.Wq,f.a.yza)?this.Ky.jcb=this.Hf.getPropertyBools(this.Wq,f.a.yza):this.Ky.jcb=this.eX(this.yq.length,!1);this.Hf.hasProperty(this.Wq,f.a.Sba)?this.Ky.N9a=this.Hf.getPropertyBools(this.Wq,f.a.Sba):this.Ky.N9a=this.eX(this.yq.length,!1);this.Hf.hasProperty(this.Wq,f.a.zza)?this.Ky.icb=this.Hf.getPropertyStrings(this.Wq,f.a.zza):this.Ky.icb=this.eX(this.yq.length,"");this.Hf.hasProperty(this.Wq,
f.a.Ixa)?this.Ky.M9a=this.Hf.getPropertyStrings(this.Wq,f.a.Ixa):this.Ky.M9a=this.eX(this.yq.length,"");this.Hf.hasProperty(this.Wq,f.a.Aza)?this.Ky.kcb=this.Hf.getPropertyListOfMilliseconds(this.Wq,f.a.Aza):this.Ky.kcb=this.eX(this.yq.length,0);this.Hf.hasProperty(this.Wq,f.a.Jxa)?this.Ky.yUa=this.Hf.getPropertyListOfMilliseconds(this.Wq,f.a.Jxa):this.Ky.yUa=this.eX(this.yq.length,0);this.Hf.hasProperty(this.Wq,f.a.iBa)?this.Ky.JZa=this.Hf.getPropertyBools(this.Wq,f.a.iBa):this.Ky.JZa=this.eX(this.yq.length,
!1);this.Hf.hasProperty(this.Wq,f.a.FCa)?this.Ky.Mfb=this.Hf.getPropertyStrings(this.Wq,f.a.FCa):this.Ky.Mfb=this.eX(this.yq.length,"");this.Hf.hasProperty(this.Wq,f.a.GCa)?this.Ky.Ofb=this.Hf.getPropertyListOfMilliseconds(this.Wq,f.a.GCa):this.Ky.Ofb=this.eX(this.yq.length,0);this.Hf.hasProperty(this.Wq,f.a.sta)?this.Ky.Nfb=this.Hf.getPropertyObjectIds(this.Wq,f.a.sta):this.Ky.Nfb=this.eX(this.yq.length,w.a.nil)}oyd(M,Q,R){return this.Hf.hasProperty(M,Q)?this.Hf.getPropertyBools(M,Q):this.eX(R,!1)}lkl(M,
Q,R){return this.Hf.hasProperty(M,Q)?this.Hf.getPropertyUint32s(M,Q):this.eX(R,0)}eX(M,Q){const R=new u.a;for(let K=0;K<M;K++)R.add(Q);return R}Jil(M){const Q=this.ofd.Ye(M);M=this.ofd.Ye(M+1);return this.VZ.substring(Q,M)}Byh(){if(this.Rog)return null;var M=this.EL<this.yq.length?this.yq.Ye(this.EL):this.maxValue;if(M===this.maxValue||this.Evj&&!this.VZ.length)return this.Rog=!0,M=new l.a(this.Ds,this.Wq.id,this.bGe),this.jnc=this.bKe(this.jnc,M.toString()),M;const Q=this.Acd.Ye(this.EL),R=this.yje.Ye(this.EL),
K=this.nnj.Ye(this.EL),J=this.Zoc.Ye(this.EL),O=this.Fga.Ye(this.EL),N=this.Wfa.Ye(this.EL),V=this.tga.Ye(this.EL),W=this.$ng?this.IKb.Ye(this.EL):null;var ca=null;this.Ky.jcb.Ye(this.EL)&&(ca=new F(this.Ky.icb.Ye(this.EL)||"",this.Ky.kcb.Ye(this.EL)));var H=null;this.Ky.N9a.Ye(this.EL)&&(H=new F(this.Ky.M9a.Ye(this.EL)||"",this.Ky.yUa.Ye(this.EL)));var Z=null;this.Ky.JZa.Ye(this.EL)&&(Z=new F(this.Ky.Mfb.Ye(this.EL)||"",this.Ky.Ofb.Ye(this.EL),this.Ky.Nfb.Ye(this.EL)));ca=new L(ca,H,Z);H=this.Jil(this.EL);
this.EL++;Z=H.startsWith("\ufddfHYPERLINK ");M=new E.a(this.Kae,this.Ds,this.Wq.id,Q,M,R,H,K,!Z,J,O,N,V,ca,W);this.jnc=this.bKe(this.jnc,M.toString());return M}kyh(){let M;M=null;var Q="";if(!this.ykj)return{Xrf:M,JYa:Q};if(Q=this.Byh())M=new u.a,M.add(Q);for(;Q=this.Byh();)M.add(Q);Q=this.jnc;return{Xrf:M,JYa:Q}}}Object(G.a)(A,"ParagraphMergeBlockCreator",m.a,[])},1741:function(G,P,b){b.r(P);G=b(0);var k=b(202),f=b(1451),x=b(1396);class u extends x.a{constructor(r,m){super(4,r,m)}toString(){return String.format("{0} [GraphNodeId: {1}]",
super.toString(),this.oi)}jZb(){return"Table"}clone(){return new u(this.source,this.oi)}oy(r,m,l,z=!1){return super.oy(r,m,l,z)?this.oi.equals(r.oi):!1}get length(){return 1}}Object(G.a)(u,"TableMergeBlock",x.a,[]);b.d(P,"TableMergeBlockCreator",function(){return w});class w extends f.a{constructor(r,m){super();this.T$f=new u(m,r.id)}kyh(){let r;r=new k.a;r.add(this.T$f);return{Xrf:r,JYa:this.bKe("",this.T$f.toString())}}}Object(G.a)(w,"TableMergeBlockCreator",f.a,[])},1808:function(G,P,b){b.r(P);
var k=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]},f=b(0),x=b(41),u=b(63);class w extends Sys.EventArgs{constructor(I,ra){super();this.g5d=I;this.actualValue=ra}}Object(f.a)(w,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,
[]);var r=b(27);class m{constructor(){this.iLb=[];this.Fdg=this.Yee=0;this.Me=null;this.ma=new u.a}init(I,ra,ab){this.Me=I;this.Yee=ra;this.Fdg=ab;this.Me.qld(Object(x.a)(this,this.LCb,"onCpuMeterFrameAvailable"));this.$Hj(Object(x.a)(this,this.tfk,"cpuPercentThresholdExceeded"))}LCb(I,ra){ra.zNc&&(Array.enqueue(this.iLb,ra.zNc.CP),this.iLb.length>this.Fdg&&(Array.dequeue(this.iLb),this.D3j()))}D3j(){var I=this.iLb.length;let ra=0;for(let ab=0;ab<I;ab++){const Fb=Array.dequeue(this.iLb);ra+=Fb;Array.enqueue(this.iLb,
Fb)}I=ra/I;I>this.Yee&&this.ma.raiseEvent("CPTTE",new w(this.Yee,I))}tfk(I,ra){r.b(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.zrd(ra.g5d,ra.actualValue))}$Hj(I){this.ma.addHandler("CPTTE",I)}zrd(I,ra){const ab={};ab.ThresholdValue=I;ab.ActualValue=ra;return ab}}Object(f.a)(m,"CpuMeterMonitor",null,[1941]);var l=b(405);class z{constructor(){this.S=this.T=this.M=this.C=0}}Object(f.a)(z,"ProfileInformation",null,[]);var F=b(7),L=b(25),E=b(191),A=b(74);class M{constructor(I=
0,ra=0){this.Rmb=!1;this.mmb={};this.sad=I;this.Jad=ra;this.KEe=0;L.a.addHandler(window.self,F.a.jRg,()=>{this.Rmb=!0});L.a.addHandler(window.self,F.a.kRg,()=>{this.Rmb=!1})}mRg(I,ra,ab){const Fb=M.generateKey(ra,ab);Fb in this.mmb?ra=this.mmb[Fb]:(ra=new z,ra.S=ab?1:0,this.mmb[Fb]=ra,this.KEe++);ra.C++;ra.M=I>ra.M?I:ra.M;ra.T+=I}swa(I,ra){this.mRg(I,ra,!1);this.Rmb&&this.mRg(I,ra,!0)}getData(){if(0<this.Jad&&this.KEe>this.Jad)return this.BXk();const I=0<this.sad,ra={},ab=this.mmb;for(let ac in ab){var Fb=
ac;const Xc=ab[ac];this.bwi(Xc);I&&Xc.T>=this.sad&&(ra[Fb]=Xc)}return I?A.a.ve(ra)?null:ra:this.mmb}BXk(){var I=0<this.sad,ra=[];const ab=this.mmb;for(let Fb in ab){const ac={key:Fb,value:ab[Fb]};let Xc=ac.value;(!I||Xc.T>=this.sad)&&Array.add(ra,ac)}if(ra.length>this.Jad)ra.sort((Fb,ac)=>ac.value.T-Fb.value.T),ra=ra.slice(0,this.Jad);else if(!ra.length)return null;I={};for(const Fb of ra)ra=Fb.value,this.bwi(ra),I[Fb.key]=ra;return I}bwi(I){I.M=E.a.lP(I.M,0);I.T=E.a.lP(I.T,0)}reset(){this.mmb={};
this.KEe=0}static generateKey(I,ra){return ra?I+" [it]":I}}Object(f.a)(M,"FunctionCallAggregator",null,[842]);var Q=b(2),R=b(1069);class K{}Object(f.a)(K,"CpuMeterFrame",null,[]);class J extends Sys.EventArgs{constructor(I){super();this.zNc=I}}Object(f.a)(J,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);class O{}Object(f.a)(O,"MiniTaskItemInfo",null,[]);class N{}Object(f.a)(N,"TaskItemInfo",null,[]);var V=b(914),W=b(1217),ca=b(183);class H{constructor(I,ra,ab,Fb,ac){this.yqb=0;this.WZ=null;this.qfd=
this.UGg=0;this.WDg=!1;this.EMb=0;this.klc=!1;this.Fna=null;this.L8c=0;this.eue=new u.a;this.Hhd=[];this.Mw=I;this.Xre=ra;this.Cje=ab;this.kug=Fb;Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("WrapSetTimeoutForTelemetryIsEnabled")&&this.g4b();this.xdj=ac;this.Dje=new M(100);this.$lj=V.a.MD(1,5,new W.a)}qld(I){this.eue.addHandler("OnCpuMeterFrameAvailable",I)}GKf(I){this.eue.removeHandler("OnCpuMeterFrameAvailable",I)}Qfb(I,ra,ab,Fb=null){ab=Fb?Fb.priority:7;const ac=this.Mw();this.start(ra,
ab);try{I()}finally{this.stop(ra,Fb),I=this.Mw()-ac,this.kug.track(I,ra)}}$c(I,ra){const ab=this.Mw();try{I()}finally{I=this.Mw()-ab,this.Cje.swa(I,ra),0<this.yqb&&this.Dje.swa(I,ra),this.kug.track(I,ra)}}IAf(I){const ra=new N;ra.TN=I.rqf;ra.TP=I.priority;this.xmi(1,ra)}i5b(I){this.L8c|=I}start(I,ra){if(!this.yqb){this.Dje.reset();const ab=this.$Xh(I);ab&&this.$Nd(1);this.WZ=new N;this.WZ.TN=I;this.WZ.TP=ra;this.WZ.ST=(new Date).toISOString();this.WZ.STS=E.a.lP(this.Mw(),2);ab?this.WZ.UI=1:this.mOl(I)?
this.WZ.UI=2:this.WZ.UI=0}this.yqb++}$Nd(I){this.EMb|=I}opd(I=!0,ra=0){this.EMb=I?0:this.EMb&~ra}stop(I,ra=null){let ab;this.yqb--;0>=this.yqb&&this.WZ&&(ab=this.Mw()-this.WZ.STS,this.qfd+=ab,this.Xre.swa(ab,I),this.$Xh(I)&&this.opd(!1,1),this.WZ.TRT=E.a.lP(ab,2),ra&&(this.WZ.TQT=E.a.lP(ra.wKm,2),this.WZ.TDT=E.a.lP(ra.dZh,2)),this.xdj&&(this.xmi(0,this.WZ),this.F0m()),this.yqb=0);0<=I.indexOf(R.a.cJn)&&this.i5b(2);0<=I.indexOf(R.a.Wsi)&&this.i5b(4);1===(this.EMb&1)&&this.i5b(1);2===(this.EMb&2)&&
this.i5b(8)}F0m(){var I=this.WZ.TRT;if(750<I){let ab=this.Dje.getData();if(ab){const Fb={};for(let ac in ab){var ra=ab[ac];const Xc=ac;Xc.startsWith("SiOp_")||(Fb[Xc]=E.a.lP(100*ra.T/I,2))}ab=Fb}I=Object.assign(new O,{T:I,S:ab});this.$lj.track(I,this.WZ.TN)}}hun(){var I=this.Mw()-this.UGg,ra=E.a.lP(this.qfd/I*100,2);I=new K;I.CP=ra;I.II=this.L8c;ra=this.Xre.getData();A.a.count(ra)&&(I.LRT=ra);ra=this.Cje.getData();A.a.count(ra)&&(I.FP=ra);this.eue.raiseEvent("OnCpuMeterFrameAvailable",new J(I));this.GKi()}GKi(){this.Xre.reset();
this.Cje.reset();this.qfd=this.yqb=0;this.UGg=this.Mw();this.L8c=0;this.WZ=null}run(){this.WDg?this.hun():(this.GKi(),this.WDg=!0);this.Fna?this.Fna(Object(x.a)(this,this.run,"run"),1E3):window.setTimeout(Object(x.a)(this,this.run,"run"),1E3)}Jkd(I,ra,ab){const Fb=Array(2);Fb[0]=ra;Fb[1]=ab;this.Hhd[I]||(this.Hhd[I]=[]);this.Hhd[I].push(Fb)}xmi(I,ra){I=this.Hhd[I];if(!ca.a.ve(I))for(let Fb=0;Fb<I.length;Fb++){var ab=I[Fb];const ac=ab[0];ab=ab[1];ac&&!ac(ra)||ab(ra)}}g4b(){if(!this.klc){const I=window.setTimeout;
this.Fna=(ra,ab)=>I(ra,ab);this.klc=!0}}$Xh(I){return I.startsWith("key")||I.startsWith("input")}mOl(I){return I.startsWith("click")||I.startsWith("mouse")||I.startsWith("pointer")}}Object(f.a)(H,"CpuMeter",null,[138]);class Z{constructor(I){this.Vgc=null;this.Zp=new l.a;this.Mw=I}initialize(I,ra,ab,Fb=!1){this.Vgc||(this.Vgc=new H(this.Mw,I,ra,ab,Fb),this.Zp.Jf(this.Vgc));return this.Vgc}}Object(f.a)(Z,"CpuMeterProvider",null,[1940]);var aa=b(168),ja=b(149);class Ba{constructor(I=1){this.WB=[];this.x4c=
[];this.Mh=I}xIk(){let I=0;for(let ra=0;ra<this.WB.length;ra++)this.WB[ra]<this.WB[I]&&(I=ra);return I}swa(I,ra){I=E.a.lP(I,2);if(this.WB.length<this.Mh)Array.add(this.WB,I),Array.add(this.x4c,ra);else{var ab=this.xIk();I>this.WB[ab]&&(this.WB[ab]=I,this.x4c[ab]=ra)}}getData(){return this.WB.length?{["Vals"]:this.WB,["Desc"]:this.x4c}:null}reset(){this.WB=[];this.x4c=[]}}Object(f.a)(Ba,"MaxDataAggregator",null,[842]);var la=b(36),ia=b(23);class oa{get name(){return"Common.App.CpuMeter"}yb(I){I.register(Z,
"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").singleInstance().Pc(()=>new Z(la.a.ie));I.register(m,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").singleInstance().Pc(()=>new m)}init(){const I=Q.AFrameworkApplication.K;if(I.$("CpuMeterIsEnabled")){const ra=ia.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");ja.a.instance.suc.continueWith(()=>{oa.iAl(I,ra)})}}dispose(){}static iAl(I,ra){const ab=V.a.MD(10,5,new M(I.vb("TaskManagerLoggingThreshold",
0),I.vb("CpuMeterMaximumEntriesToLog",0)));ra=ra.initialize(new Ba(5),new M,ab,I.$("CPUMeterExposeTaskDetailsIsEnabled"));ra.run();I.$("CpuMeterMonitorIsEnabled")&&ia.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(ra,I.pO("CpuMeterAverageCpuPercentThreshold",80),I.vb("CpuMeterRollingAverageFramesCount",15));r.b(16827671,306,50,"Initializing CpuMeter")}static main(){aa.a.instance.Lb(new oa)}}Object(f.a)(oa,"CpuMeterPackage",null,[1,2]);var ha=b(8),pa=b(79),Ea=b(934),Fa=b(919),Ga=b(15),
$a=b(1218);class fa{constructor(){this.Lna=this.Sec=null;this.JSb=!0;this.vlc=!1}yb(I){Q.AFrameworkApplication.K.$("EventTimingMeterIsEnabled")&&I.register(1865,"Common.IEventTimingMeter").singleInstance().Pc(()=>new EventTiming.EventTimingMeter)}get name(){return"Common.App.EventTimingMeter"}init(){var I=new Fa.a(Q.AFrameworkApplication.K.vb("EventTimingMeterEventSamplingPercent",0)/100);I=new Ea.a(Object(x.a)(I,I.a0a,"shouldBeInSample"));const ra=V.a.MD(16,1,I);this.Lna=new $a.a("TypingDuration-SlowPercentileAtValue",
"Percentile",Q.AFrameworkApplication.K.pO("AshaVetoForTypingThresholdInMS",150),Q.AFrameworkApplication.K.pO("AshaVetoForTypingThresholdPercentile",95),this.JSb);(this.vlc=!Ga.a.UXa)&&Q.AFrameworkApplication.UK(()=>{this.APe()});this.Sec=ab=>{ab=ab.rawEvent.detail;for(const Fb of ab)ra.track(Fb,"EventTimingData"),"false"===Fb.metadata.altPressed.toString()&&"false"===Fb.metadata.ctrlPressed.toString()&&"false"===Fb.metadata.repeat.toString()&&this.vlc&&this.Lna.wsa(Fb.timeToRequestAnimationFrameMs)};
L.a.addHandler(window.self,F.a.iRg,this.Sec)}dispose(){this.Sec&&(L.a.removeHandler(window.self,F.a.iRg,this.Sec),this.Sec=null)}APe(){this.Lna.jMa();this.Lna.gfi&&(ha.ULS.sendTraceTag(588649307,209,15,"Report SlowTypingSession Veto with SlowTypingSession error"),pa.Health.instance.recordQosError("SlowTypingSession",["SlowTypingSession"],!1,!0,!0,!1,null))}static main(){aa.a.instance.Lb(new fa)}}Object(f.a)(fa,"EventTimingMeterPackage",null,[1,2]);var sa=b(76),qa=b(69),va=b(31);class Ca{constructor(I,
ra,ab,Fb=null,ac=null){this.wJ=I;this.Hjc=ra;this.Cjc=ab;this.zAg=Fb;this.lpc=ac}O0e(I){const ra=new Sys.StringBuilder(this.wJ.aUc);ra.append("RoamingServiceHandler.ashx?action=");ra.append("getFirstRunExperienceSettings");ra.append("&");ra.append(this.o$e(I));ra.append("&");ra.append(Q.AFrameworkApplication.kl);Q.AFrameworkApplication.fe.ai(ra.toString(),1,null,null,!0,2,Object(x.a)(this,this.Fxb,"getRequestSuccessCallback"),Object(x.a)(this,this.hWa,"getRequestFailureCallback"),null)}Q0e(I){var ra=
new Sys.StringBuilder(this.wJ.aUc);ra.append("RoamingServiceHandler.ashx?action=");ra.append("saveFirstRunExperienceSettings");ra.append("&");ra.append(Q.AFrameworkApplication.kl);ra=ra.toString();I=va.c(I);Q.AFrameworkApplication.fe.ai(ra,2,I,null,!0,4,Object(x.a)(this,this.TCm,"postRequestSuccessCallback"),Object(x.a)(this,this.NDb,"postRequestFailureCallback"),null)}Fxb(I){let ra=!1,ab=null;try{if(0<I.data.qd.length){const Fb=Object(qa.a)(Object,va.a(I.data.qd)),ac=Fb?Fb[this.wJ.TJe]:null;ac&&
(ab=Object(qa.a)(Object,va.a(ac.toString())))}ra=!0}catch(Fb){this.hWa(null)}ra&&this.Hjc&&this.Hjc(I.data,ab)}hWa(I){this.Cjc&&this.Cjc(I?I.data:null)}TCm(I){this.zAg&&this.zAg(I?I.data:null)}NDb(I){this.lpc&&this.lpc(I?I.data:null)}o$e(I){const ra=new Sys.StringBuilder("requestedsettings=");for(let ab=0;ab<I.count;ab++)ra.append(I.J(ab)),ab<I.count-1&&ra.append(";");return ra.toString()}}Object(f.a)(Ca,"FirstRunExperienceRequestHandler",null,[]);class ta{constructor(){this.jjc=this.m6c=this.wJ=
null}brn(I){I?(this.wJ=I,this.jOl()&&(ha.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),I=new sa.a,I.add(this.wJ.TJe),this.m6c=new Ca(this.wJ,Object(x.a)(this,this.Fxb,"getRequestSuccessCallback"),Object(x.a)(this,this.hWa,"getRequestFailureCallback"),null,Object(x.a)(this,this.NDb,"postRequestFailureCallback")),this.m6c.O0e(I)),(this.wJ.yXh||Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",
!1))&&this.iTf()):ha.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}jOl(){try{if(this.wJ.yXh)return!0;if(!Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||Q.AFrameworkApplication.K.$("IsAnonymousUser"))return!1;if(this.wJ.hJl||this.wJ.M3b||Q.AFrameworkApplication.K.$("IsO365ConsumerHost"))return!0;const I=Q.AFrameworkApplication.K.Ga("FlightId");return-1!==(I?I.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(I){ha.ULS.sendTraceTag(576582624,
306,10,"Error checking setting {0}",I?I.toString():null)}return!1}Wwi(I){const ra={},ab={};ab.FREDisplayedDate=(new Date).toUTCString();ab.VersionDisplayed=I;ab.RemindMeLater=!1;ra[this.wJ.TJe]=va.c(ab);ha.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");this.m6c&&this.m6c.Q0e(ra)}Fxb(I,ra){I=I?+I.VQ-+I.yF:-1;I>this.wJ.Qvi?ha.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",
I,this.wJ.Qvi):ra?this.$pn(ra)?(ha.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.wJ.G5h),this.iTf()):ha.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(ha.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.iTf())}hWa(I){ha.ULS.sendTraceTag(51675541,
306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",I?I.we:-1)}NDb(I){ha.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",I?I.we:-1)}iTf(){var I=ia.a.instance.ra("Common.ISystemInitiatedFeedback");I?this.CHi(I):(ha.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",
!0)&&((I=ia.a.instance.za("Common.ISystemInitiatedFeedback"))?I.execute(ra=>{this.CHi(ra)}):ha.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}CHi(I){if(I){var ra=this.wJ.nLk;ra&&(Q.AFrameworkApplication.Bh(ra),Q.AFrameworkApplication.kda(ra));ha.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",ra);I.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.jjc=Object(x.a)(this,this.Knm,"onFirstRunExperienceCampaignEvent"),
window.addEventListener("FGWebSurfaceEvent",this.jjc,!0),window.addEventListener("FRELaunchedEvent",this.jjc,!0)):(ha.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.Wwi(this.wJ.currentVersion))}else ha.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}Knm(I){if(I){var ra=I.detail;I=I.type;var ab=this.wJ&&this.wJ.b_g?this.wJ.b_g.split("-")[0]:null;if("FRELaunchedEvent"===I||ab&&ra&&ra.id&&-1!==ra.id.indexOf(ab))ra.success&&(ha.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.Wwi(this.wJ.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.jjc,!0),window.removeEventListener("FRELaunchedEvent",this.jjc,!0))}}$pn(I){if("RemindMeLater"in I&&"FREDisplayedDate"in I){if("true"===I.RemindMeLater.toString()&&(+new Date-+new Date(I.FREDisplayedDate.toString()))/36E5>this.wJ.G5h)return!0}else if(Q.AFrameworkApplication.K.$("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in
I&&I.VersionDisplayed<this.wJ.currentVersion)return ha.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}}Object(f.a)(ta,"FirstRunExperienceLauncher",null,[1863]);class Wa{constructor(){this.W=null}get name(){return"Common.App.FirstRunExperienceLauncher"}yb(I){this.W=I;this.W.register(1863,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").singleInstance().Pc(()=>new ta)}init(){}dispose(){}static main(){aa.a.instance.Lb(new Wa)}}
Object(f.a)(Wa,"FirstRunExperienceLauncherPackage",null,[1,2]);class Za{constructor(){this.y=this.x=0}}Object(f.a)(Za,"HammerPoint",null,[]);var Ya=b(13);class Ka{constructor(I,ra,ab,Fb,ac){this.rsg=this.eQa=this.x8c=1;this.Zid=this.Hsc=this.tSa=0;this.pte=this.NDa=null;this.akb=this.Hie=this.Odd=!1;this.hg=I;this.eGa=ra;this.Zpb=ab;this.ga=Fb;ac&&(this.Odd=ac.$("PromoteLayerPinchToZoomIsEnabled"),this.Hie=ac.$("FinalizeWithInitialPinchScaleIsEnabled"),this.akb=ac.$("AdjustPinchStartXWithPageMarginIsEnabled"))}get XI(){return this.eGa}TLl(){return!!this.hg.instance}fom(I){this.ga&&
this.ga.processAction(Ya.a.RKi,2);const ra=this.hg.instance;this.Odd&&ra.mmi();this.eQa=ra.ei;this.x8c=I.sCc.scale;this.rsg=1;this.pte=this.GZg();this.NDa=this.eGa.getBounds();if(!this.NDa)return ha.ULS.sendTraceTag(42821145,353,15,"Unexpected null bounds"),!1;I=this.wAh(I);this.akb?this.xCi(this.eGa.scrollWidth,this.NDa.width,I,this.eQa,ra):this.tSa=this.eGa.scrollWidth>this.NDa.width?this.Dvc(this.Zpb.scrollLeft,I.x,this.eQa):null;this.Zid=this.eGa.scrollHeight>this.NDa.height?this.Dvc(this.Zpb.scrollTop,
I.y,this.eQa):null;return!0}XLf(){this.tSa=null;this.Hsc=0}xCi(I,ra,ab,Fb,ac){I>ra?this.tSa?(I=ac.Aof,I!==this.Hsc&&(this.tSa-=this.Hsc-I,this.Hsc=I)):(this.tSa=this.Dvc(this.Zpb.scrollLeft,ab.x,Fb),this.Hsc=ac.Aof):this.XLf()}eom(I){const ra=this.wAh(I);if(!ra)return ha.ULS.sendTraceTag(42821147,353,15,"Unexpected null pinch center"),!1;I=this.Vdn(I.sCc.scale/this.x8c)*this.eQa;this.UQn(ra,I);this.VQn(ra,I);return!0}UQn(I,ra){const ab=this.eGa.scrollWidth,Fb=this.NDa.width;this.akb?this.xCi(ab,Fb,
I,ra,this.hg.instance):!this.tSa&&ab>Fb&&(this.tSa=this.Dvc(this.Zpb.scrollLeft,I.x,ra));if(I=this.OZg(I.x,this.tSa,ab,Fb,ra))this.Zpb.scrollLeft=I}VQn(I,ra){const ab=this.eGa.scrollHeight,Fb=this.NDa.height;!this.Zid&&ab>Fb&&(this.Zid=this.Dvc(this.Zpb.scrollTop,I.y,ra));if(I=this.OZg(I.y,this.Zid,ab,Fb,ra))this.Zpb.scrollTop=I}OZg(I,ra,ab,Fb,ac){return ab<=Fb||!ra||!Fb?null:Math.max(0,Math.min(ra*ac-I,ab-Fb))}Dvc(I,ra,ab){return(I+ra)/ab}dom(I){I=I.sCc.scale;this.Hie&&(I/=this.x8c);this.mlh(I);
this.Odd&&this.hg.instance.JHf();this.ga&&this.ga.processAction(Ya.a.x_e,2);this.akb&&this.XLf()}com(I){I=I.sCc.scale;this.Hie&&(I/=this.x8c);this.mlh(I,!0);this.Odd&&this.hg.instance.JHf();this.ga&&this.ga.processAction(Ya.a.x_e,2);this.akb&&this.XLf()}Vdn(I){const ra=this.hg.instance,ab=new Date>=this.pte;ab&&(this.pte=this.GZg());Math.abs(I-this.rsg)>=.01*I&&ra.xkn(I*this.eQa,ab);return ra.ei/this.eQa}mlh(I,ra=!1){I*=this.eQa;this.hg.instance.tRf(I,!1);const ab={};ab.initialScale=this.eQa;ab.finalScale=
I;ab.cancelled=ra;ha.ULS.sendTraceTag(42821150,353,50,"Pinch zoom ended: {0}",ab)}wAh(I){return(I=I.sCc.center)&&this.NDa?Object.assign(new Za,{x:I.x-this.NDa.x,y:I.y-this.NDa.y}):null}GZg(){const I=(new Date).getTime();return new Date(I+1E3)}}Object(f.a)(Ka,"PinchZoomAdapter",null,[1924]);class xa{constructor(I){this._element=I}get scrollWidth(){return this._element.scrollWidth}get scrollHeight(){return this._element.scrollHeight}getBounds(){return Sys.UI.DomElement.getBounds(this._element)}}Object(f.a)(xa,
"ScrollContainerElement",null,[1923]);var Sa=b(118);class pb{constructor(I,ra,ab,Fb,ac,Xc){this.YBe=this.o4a=null;this.W=I;this.Zc=ra;this.L9c=ab;this.eqg=Fb;this.Pjj=ac;this.jNb=Xc;this.i3c=new sa.a}register(I,ra){this.L9c&&(4===Q.AFrameworkApplication.na.Ya.Rm&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.OneNoteOnline.OneNoteDelayLoadHammerJs",!1)?Sa.a.get_instance().Vk(8,()=>{this.Hui(I,ra)}):this.Hui(I,ra))}Hui(I,ra){this.W.za("Common.IGestureInputManager").execute(ab=>{this.Jwn();
this.o4a=ab;this.i3c.add(I);if(this.eqg){if(this.Pjj&&0!==ab.G1k()){this.rLi();return}var Fb=this.W.za("Common.IZoomManager");this.W.resolve("Common.IAppSettingsManager");const ac=new xa(I);Fb=new Ka(Fb,ac,ra,Q.AFrameworkApplication.pa,Q.AFrameworkApplication.K);ab.jSm(I,Fb)}this.rLi()})}unregister(){if(this.o4a&&this.i3c){if(this.eqg){for(let I of this.i3c)this.o4a.yKn(I);this.i3c.clear()}this.o4a=null}}Jwn(){this.jNb&&(this.Zc?this.YBe=this.Zc.Pe("Task","Register"):ha.ULS.sendTraceTag(590387076,
310,10,"_stopwatchBuilder is null"))}rLi(){this.jNb&&(this.YBe?this.YBe.stop():ha.ULS.sendTraceTag(590387077,310,10,"_stopwatchForRegister is null"))}}Object(f.a)(pb,"GestureInputRegistrar",null,[1864]);class Db{constructor(){this.W=null;this.rg=!1}get name(){return"Common.App.GestureInput"}init(){this.rg||(this.W.resolve("Common.IGestureInputRegistrar"),this.rg=!0)}dispose(){}yb(I){this.W=I;I.register(1864,"Common.IGestureInputRegistrar").singleInstance().Pc(()=>new pb(I,Q.AFrameworkApplication.na.Qo,
Q.AFrameworkApplication.FJc(),Q.AFrameworkApplication.oVh(),!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("PinchZoomOnlyPointerEventsIsEnabled"),!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled")))}static main(){aa.a.instance.Lb(new Db)}}Object(f.a)(Db,"GestureInputPackage",null,[1,2]);var Ua=b(305),Lb=b(78);class Va{constructor(){this.agb=this.Bph=null}}Object(f.a)(Va,"GestureAdapterInfo",null,[]);var Sb=b(353),nb=b(221);class La{constructor(){this.mlb=
null}apf(){if(!this.mlb){var I="hammer.min.js";Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseIsServerFlavorAppSetting",!1)&&(I=Q.AFrameworkApplication.K.$("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");I=Q.AFrameworkApplication.vx(String.format("{0}",I),5);I=nb.a.create(I,null,null);Sb.a.iR(I);this.mlb=I.Odb}return this.mlb}static get instance(){La._instance||(La._instance=new La);return La._instance}}La._instance=null;Object(f.a)(La,"HammerJsDependencyLoader",
null,[1972]);const Ha=(I,ra,ab=null)=>{if(void 0===ra||null===ra)throw ha.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let Fb=null;switch(I){case F.a.pinch:Fb=new Hammer.Pinch(ab);break;case F.a.pan:Fb=new Hammer.Pan(ab)}Fb&&(Fb.manager=ra);return Fb};var Aa;(function(I){I[I.none=-1]="none";I[I.pinch=0]="pinch";I[I.pan=1]="pan";I[I.swipe=2]="swipe"})(Aa||(Aa={}));Object(f.b)("GestureEvent",Aa);var Ma=b(50);class cb extends Ma.a{constructor(I,
ra,ab,Fb,ac,Xc,Md,bf){super(I,ab,Fb,Xc);this.igc=ra;this.WRa=Md;this.Cma=bf;this.$ej=ac}get shiftKey(){return this.WRa}get ctrlKey(){return this.Cma}get clientPoint(){return this.igc}get sCc(){return this.$ej}static create(I,ra,ab,Fb,ac,Xc){if(ab.rawEvent)if(Xc){var Md=ab.rawEvent;Md=new Sys.UI.Point(Md.clientX,Md.clientY)}else Md=Ma.a.wyd(ab);else Md=new Sys.UI.Point(ab.clientX,ab.clientY);return new cb(I,Md,ra,ab,Fb,ac,ab.shiftKey,ab.ctrlKey,Xc)}}Object(f.a)(cb,"GestureEventArgs",Ma.a,[]);class ib{constructor(){this.srcEvent=
this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}}Object(f.a)(ib,"GestureManagerData",null,[]);class Rb{}Rb.$3i=2;Rb.a4i=4;Rb.b4i=8;Rb.c4i=8;Object(f.a)(Rb,"HammerConstants",null,[]);
var Oa=b(68),lb=b(101),gb=b(16),Nb=b(86);class qc extends L.a{constructor(I,ra){super();this.TEa=Ua.a.UPk;this.nwe=!!window.PointerEvent;this.hJg=window.hasOwnProperty("ontouchstart");this.pmb=this.doc=null;this.IEa=!1;this.sga=new Lb.a;this.jpc=new Lb.a;this.Yjg=new sa.a;this.q3a=null;this.CKb=this.jNb=this.ybg=this.bde=this.Gre=this.PCg=this.Pbg=this.Qsc=!1;this.Zmc=-1;this.curRecognizer=this.element=this.handlers=this.session=this.ZBe=null;this.ef=Oa.EventHandlerManager.instance;this.nwe?(ha.ULS.sendTraceTag(593893141,
310,50,"Using pointer events"),this.doc=Object(x.a)(this,this.KRd,"onPointerEvent"),this.pmb=F.a.WPk):this.hJg?(ha.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.doc=Object(x.a)(this,this.ffb,"onTouchEvent"),this.pmb=F.a.touchEvents):(ha.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.doc=Object(x.a)(this,this.zRd,"onMouseEvent"),this.pmb=F.a.VPk);this.Zc=ra;this.EH=I;Q.AFrameworkApplication.K&&(this.Qsc=Q.AFrameworkApplication.K.$("UsePointerCaptureIsEnabled"),this.Pbg=
Q.AFrameworkApplication.K.$("ClearCacheOnPrimaryPointerIsEnabled"),this.PCg=Q.AFrameworkApplication.K.$("ResetHandledBeforeInputHandlerIsEnabled"),this.Gre=Q.AFrameworkApplication.K.$("LogCoalescedEventsIsEnabled"),this.bde=Q.AFrameworkApplication.K.$("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.ybg=Q.AFrameworkApplication.K.$("CheckIfHammerExistsAfterDownloadIsEnabled"),this.jNb=Q.AFrameworkApplication.K.$("HammerJsPerformanceTimersIsEnabled"),this.CKb=this.Qsc&&Q.AFrameworkApplication.K.$("CancelDragFromGestureInputManagerIsEnabled")&&
Q.AFrameworkApplication.K.$("UseGestureInputManagerPointerCacheIsEnabled"))}G1k(){return this.nwe?0:this.hJg?1:2}yt(I){super.yt(I);this.ef.qza(this.pmb,I,0,this.doc)}tt(I){super.tt(I);this.ef.xUa(I,this.pmb)}jSm(I,ra){Q.AFrameworkApplication.FJc()?La.instance.apf().continueWith(ab=>{this.Iwn();if(ab.Gh||ab.Hn)ha.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",ab.status);else{ha.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",ab.status);if(this.ybg){ab=window.Hammer;
if("undefined"===typeof ab){ha.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.y3d();return}if("undefined"===typeof ab.inputHandler){ha.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.y3d();return}}if(!I)throw this.y3d(),Error.argumentNull("source element can not be null");ab=lb.a.Ra(I,this.TEa);if(void 0===ab||null===ab)ab=new Lb.a,lb.a.Gl(I,this.TEa,ab),this.kSm(I);if(!ab.Ja(Aa[0])){var Fb=Object.assign(new Va,{agb:Ha(Aa[0],this,null),Bph:ra});ab.add(Aa[0],
Fb)}}this.y3d()}):ha.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}Iwn(){this.jNb&&(this.Zc?this.ZBe=this.Zc.Pe("Task","RegisterGestureAdapterAfterLoad"):ha.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))}y3d(){this.jNb&&(this.ZBe?this.ZBe.stop():ha.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}yKn(I){ha.ULS.sendTraceTag(42256223,310,I?100:10,"source element {0} ",I.id);const ra=
lb.a.Ra(I,this.TEa);void 0!==ra&&null!==ra&&(ra.remove(Aa[0]),ra.count||(lb.a.vY(I,this.TEa),this.curRecognizer=null,this.zKn(I)))}kSm(I){this.Yjg.add(I);this.ef.qza(this.pmb,I,0,this.doc)}zKn(I){this.Yjg.remove(I);this.ef.xUa(I,this.pmb)}recognize(I){var ra=Array(I.pointers.length);for(var ab=0;ab<I.pointers.length;ab++)ra[ab]=I.pointers[ab].target;ab=null;for(this.q3a=this.x6k(ra);void 0!==this.q3a&&null!==this.q3a&&(ab=lb.a.Ra(this.q3a,this.TEa),void 0===ab||null===ab);this.q3a=this.q3a.parentNode);
if(void 0!==ab&&null!==ab){this.curRecognizer&&this.curRecognizer.state===Rb.c4i&&(this.curRecognizer=null);ra=ab.keys;for(let Fb of ra){ra=ab.J(Fb);void 0!==ra&&null!==ra&&void 0!==ra.agb&&null!==ra.agb&&(void 0===this.curRecognizer||null===this.curRecognizer||ra.agb===this.curRecognizer||ra.agb.canRecognizeWith(this.curRecognizer))&&ra.agb.recognize(I);const ac=ra.agb.state;this.curRecognizer||Rb.$3i!==ac&&Rb.a4i!==ac&&Rb.b4i!==ac||(this.curRecognizer=ra.agb)}}}emit(I,ra){if("hammer.input"!==I){this.IEa=
!1;ra=cb.create(I,this.q3a,ra.srcEvent,ra,3,this.nwe);var ab=lb.a.Ra(this.q3a,this.TEa);if(this.VPl(I))var Fb=0;else if(this.vPl(I))Fb=1;else if(this.hTl(I))Fb=2;else{ha.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:ab}=ab.Ab(Aa[Fb]));void 0!==ab&&null!==ab&&((ab=ab.Bph,ab.TLl())?I.endsWith("start")?this.IEa=ab.fom(ra):I.endsWith("end")?(ab.dom(ra),this.IEa=!0):I.endsWith("cancel")?(ab.com(ra),this.IEa=!0):I.endsWith("move")&&(this.IEa=ab.eom(ra)):
ha.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",I))}}get(I){return Object(qa.a)(Hammer.Recognizer,I)}x6k(I){if(1>I.length)return null;if(1===I.length)return I[0];var ra=I[0],ab=!0;for(let Fb=1;Fb<I.length;Fb++){if(!I[Fb])return null;if(ra!==I[Fb]){ab=!1;break}}if(ab)return ra;ra=this.$ph(I[0]);ab=0;for(const Fb of I){I=this.$ph(Fb);if(ra.J(ra.count-1)!==I.J(I.count-1))return null;for(let ac=ra.count-2,Xc=I.count-2;ac>=ab&&0<=Xc;ac--,Xc--)if(ra.J(ac)!==I.J(Xc)){ab=ac+
1;break}}return ra.J(ab)}$ph(I){const ra=new sa.a;for(;void 0!==I&&null!==I;I=I.parentNode)ra.add(I);return ra}Gwh(I){switch(I){case F.a.YM:case F.a.Ksb:return 1;case F.a.XM:case F.a.qNe:return 2;case F.a.oH:case F.a.Lsb:return 4;case F.a.G5d:case F.a.pNe:return 8}return 0}ffb(I,ra,ab){I=this.Gwh(I);ra=this.c4k(ab);Hammer.inputHandler(this,I,ra);this.IEa&&ab.preventDefault();return this.IEa}iIh(){return 1<this.sga.count}nod(){ha.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.Qsc)for(let I of this.sga)this.Sqi(I.key);
else this.sga=new Lb.a;this.session=null}yEj(I,ra,ab){ha.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",I);if(!this.jpc.Ja(I)){try{ra.setPointerCapture(I)}catch(Fb){ha.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",Fb)}this.jpc.add(I,ra)}this.sga.Z(I,ab);this.CKb&&1<this.sga.count&&this.EH&&!this.EH.Qvc&&(this.EH.Qvc=!0)}Sqi(I){ha.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",I);if(this.jpc.Ja(I)){try{this.jpc.J(I).releasePointerCapture(I)}catch(ra){ha.ULS.sendTraceTag(594055956,
310,10,"Exception: {0}",ra)}this.jpc.remove(I)}else ha.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",I);this.sga.remove(I);this.CKb&&1>=this.sga.count&&this.EH&&this.EH.Qvc&&(this.EH.Qvc=!1)}KRd(I,ra,ab){var Fb=ab.rawEvent.pointerType.toString();const ac=ab.rawEvent.pointerId.toString();if("touch"!==Fb)return!1;I=this.Gwh(I);if(1!==I&&!this.sga.Ja(ac))return!1;this.Pbg&&1===I&&ab.rawEvent.isPrimary&&this.sga.count&&(ha.ULS.sendTraceTag(593839564,310,
10,"Pointer cache should be empty"),this.nod());this.Qsc?this.yEj(ac,ra,ab):this.sga.Z(ac,ab);this.Gre&&2===I&&(!this.bde||this.bde&&"function"===typeof ab.rawEvent.getCoalescedEvents)&&(ra=ab.rawEvent.getCoalescedEvents())&&this.iIh()&&(this.Zmc=Math.max(this.Zmc,ra.length));this.PCg&&(this.IEa=!1);Fb=this.b4k(this.sga,ab,Fb);Hammer.inputHandler(this,I,Fb);if(4===I||8===I)this.Qsc?this.Sqi(ac):this.sga.remove(ac),this.sga.count||(this.session=null,this.Gre&&-1!==this.Zmc&&(ha.ULS.sendTraceTag(593597138,
310,50,"Max number of coalesced events: {0}",this.Zmc),this.Zmc=-1));this.IEa&&ab.preventDefault();return this.IEa}zRd(){return!1}c4k(I){const ra=new ib;var ab=I.rawEvent;const Fb=ab.touches;ab=ab.changedTouches;ra.pointers=Array.clone(Fb);ra.pointers=Array.clone(0<Fb.length?Fb:ab);ra.changedPointers=Array.clone(ab);ra.srcEvent=I;ra.pointerType="touch";return ra}b4k(I,ra,ab){const Fb=new ib;Fb.pointers=Nb.toArray(I.values);Fb.changedPointers=[ra];Fb.pointerType=ab;Fb.srcEvent=ra;return Fb}VPl(I){return gb.a.startsWith(I,
F.a.pinch)}vPl(I){return gb.a.startsWith(I,F.a.pan)}hTl(I){return gb.a.startsWith(I,F.a.swipe)}}Object(f.a)(qc,"GestureInputManager",L.a,[1943,1944]);var Eb=b(225);class ec{constructor(){this.W=null;this.rg=!1}get name(){return"Common.App.GestureInputManager"}yb(I){I.register(qc,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").singleInstance().Pc(()=>new qc(Eb.a.instance,Q.AFrameworkApplication.na.Qo));this.W=I}init(){this.rg||(this.W.resolve("Common.App.GestureManager.GestureInputManager"),
this.rg=!0)}dispose(){}static main(){aa.a.instance.Lb(new ec)}}Object(f.a)(ec,"GestureInputManagerPackage",null,[1,2]);var Jb=b(231),vb=b(47),xb=b(1370);class lc{constructor(I,ra,ab){this.vAe=this.uAe=null;this.fRb=new l.a;this.Qe=I;this.Unc=ab;this.d3=ra.appSettings[lc.ZVn]||""}get Tln(){return this.fRb.task}get Aha(){return this.Qe.value}i1m(){const I={};I[lc.Prl]=Q.AFrameworkApplication.kl;I["Content-Type"]="application/json; charset=utf-8";ha.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");
const ra=vb.a.oo(this.d3+lc.Uln,lc.vjm,Q.AFrameworkApplication.na.Ya.Rm.toString());this.Aha.ai(ra,1,"",I,!0,2,Object(x.a)(this,this.fDb,"onSuccessCallback"),Object(x.a)(this,this.RCb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}z5l(I){try{const ra={};ra.FlightName=I.FlightName;ra.SessionID=I.SessionID;ha.ULS.sendTraceTag(594883776,215,50,va.c(ra))}catch(ra){ha.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}fDb(I){if((I=I.data.qd)&&I.length)try{const ra=va.a(I);this.uAe=
ra.NavBarDataJson;ha.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.uAe?({dv:this.vAe}=va.d(ra.NavBarDataJson)).returnValue?(this.z5l(this.vAe),this.fRb.Jf(this.vAe)):(ha.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:xb.a.YYc(this.uAe)}),this.fRb.X9()):(ha.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.fRb.X9())}catch(ra){ha.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),
this.fRb.X9()}else ha.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}RCb(){this.fRb.X9();ha.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return lc._instance||(lc._instance=lc.wwb())}static wwb(){return new lc(new Jb.a(()=>Q.AFrameworkApplication.fe),Q.AFrameworkApplication.K,Q.AFrameworkApplication.na.Ya.Rm)}}lc.Prl="X-qs";lc.vjm="at";lc.Uln="O365ShellServiceProxy.ashx";lc._instance=null;lc.ZVn="ShellWebServiceBase";
Object(f.a)(lc,"O365ShellActor",null,[1942]);class Lc{constructor(){this.W=null}get name(){return"Common.App.O365Shell"}yb(I){this.W=I;this.W.register(lc,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").singleInstance().Pc(()=>new lc(new Jb.a(()=>Q.AFrameworkApplication.fe),Q.AFrameworkApplication.K,Q.AFrameworkApplication.na.Ya.Rm))}init(){Q.AFrameworkApplication.K.Io(Object(x.a)(this,this.Mv,"onFullAppSettingsReady"))}Mv(){Q.AFrameworkApplication.h1f&&Q.AFrameworkApplication.na.Ya.WG&&
this.W.resolve("Common.App.O365Shell.O365ShellActor").i1m()}dispose(){}static main(){aa.a.instance.Lb(new Lc)}}Object(f.a)(Lc,"PackageManager",null,[1,2]);class uc{vYa(){}init(){}dispose(){}}Object(f.a)(uc,"NoOpOfflineLogger",null,[1936,14]);var od=b(562);class Cb{}Cb.Vld=0;Object(f.a)(Cb,"OfflineLoggerConstants",null,[]);var gc=b(80),Dc=b(216),Ub=b(303);class Bb{constructor(I,ra,ab,Fb,ac){this.mQa=!1;this.L2=null;this.hhc=this.AOb=this.alb=0;this.MH=this.q5a=this.wQ=null;this.uk=!1;this.jva=ab;this.Tva=
Fb;this.Gva=ac;this.Qe=ra;this.Ta=I}init(){this.ERf();this.x_l();this.mQa=!1;this.Qe.kTb(this);this.wQ=new gc.a(3,2,2500,Object(x.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),104);this.Ta.ub(this.wQ)}rvc(I){return"OfflineLog|"+I}x_l(){const I=this.jva.getItem("OfflineLoggerManifest");void 0!==I&&null!==I&&0<I.length&&(this.L2=Bb.Ncc(I));this.L2||(this.L2={});if(void 0===this.L2.end||null===this.L2.end)this.L2.end=0;if(void 0===this.L2.offset||null===this.L2.offset)this.L2.offset=0;this.alb=this.L2.offset;
isFinite(this.alb)||(this.alb=0);this.AOb=this.L2.end;isFinite(this.AOb)||(this.AOb=0);this.hhc=this.AOb}ERf(){this.q5a=new Ub.a;this.MH=new Dc.a;this.Tva.LPg(Object(x.a)(this,this.VAf,"onUlsReadyToBeSent"));this.Tva.qQg(Object(x.a)(this,this.XAf,"onUlsSentSuccessfully"));this.Tva.pQg(Object(x.a)(this,this.WAf,"onUlsSentFailed"));this.Tva.CPg(Object(x.a)(this,this.lxf,"onAfterUlsHostDisposed"))}VAf(I,ra){if(void 0!==ra&&null!==ra&&void 0!==ra.args&&null!==ra.args){I=!1;if(!this.q5a.Ja(ra.args.tag)){if(!this.q5a.Ja(Cb.Vld))return;
I=!0}this.q5a.remove(I?Cb.Vld:ra.args.tag);this.MH.Ja(ra.aL)||this.MH.Z(ra.aL,new sa.a);this.MH.J(ra.aL).add(ra.args)}}XAf(I,ra){this.MH.remove(ra.aL)}WAf(I,ra){if(void 0!==ra&&null!==ra&&this.MH.Ja(ra.aL)){I=this.MH.J(ra.aL);for(let ab=0,Fb=I.count;ab<Fb;++ab)ra=Bb.serialize(I.J(ab),this.Gva),this.dZc(this.rvc(this.hhc++),ra)}}lxf(){this.dispose()}dZc(I,ra){try{return this.jva.setItem(I,ra),!0}catch(ab){return ha.ULS.sendTraceTag(18614232,222,15,"OfflineLogger SetItem failed with exception: {0}",
ab.message),!1}}sendOfflineLogs(){if(!this.mQa){for(var I=this.alb,ra=new sa.a,ab=null;I<this.AOb&&5>=ra.count;++I){var Fb=this.rvc(I);const ac=this.jva.getItem(Fb);this.jva.removeItem(Fb);if(void 0===ac||null===ac)continue;const Xc=({sessionId:Fb}=Bb.deserialize(ac)).returnValue;if(Xc){if(!ab)ab=Fb;else if(Fb!==ab)break;ra.add(Xc)}else ha.ULS.sendTraceTag(18614233,222,15,"Unable to deserialze the offline log: {0}",ac)}0<ra.count&&this.Tva.dui(this,Nb.toArray(ra),ab);this.alb=I;I>=this.AOb&&(this.Ta.me(this.wQ),
this.wQ=null)}}vYa(I,ra,ab){!this.uk&&ha.ULS.y5(ra,ab)&&this.q5a.Z(I,!0)}dispose(){if(!this.uk){this.wQ&&this.Ta.me(this.wQ);var I=Nb.toArray(this.MH.keys);I.sort();for(const ra of I){I=this.MH.J(ra);for(let ab=0,Fb=I.count;ab<Fb;++ab){const ac=Bb.serialize(I.J(ab),this.Gva);this.dZc(this.rvc(this.hhc++),ac)}}this.alb<this.hhc?(this.L2.end=this.hhc,this.L2.offset=this.alb,this.dZc("OfflineLoggerManifest",JSON.stringify(this.L2))):this.jva.removeItem("OfflineLoggerManifest")}this.uk=!0}mLa(){this.mQa=
!0}ueb(){this.mQa=!1}static serialize(I,ra){const ab={};ab.t=I.tag;ab.c=I.category;ab.l=I.level;ab.m=I.message;ab.lt=I.logType;ab.s=ra;ab.ts=I.timestamp;ab.o=I.isMinified;ab.a=I.args;return JSON.stringify(ab)}static deserialize(I){return(I=Bb.Ncc(I))?{returnValue:new od.a(I.ts,I.c,I.t,I.l,I.m,I.lt,I.o,I.a),sessionId:I.s}:{returnValue:null,sessionId:null}}static Ncc(I){try{return JSON.parse(I)}catch(ra){ha.ULS.sendTraceTag(18614234,222,10,"OfflineLogger TryParseString failed with exception: {0}",ra.message)}return null}}
Object(f.a)(Bb,"OfflineLoggerImpl",null,[1936,14,207]);class fb{constructor(I,ra,ab,Fb){this.sessionId=I;this.version=ra;this.Pmd=ab;this.ABf=Fb;this.Zja=new sa.a}}Object(f.a)(fb,"CachedLogUpload",null,[]);class yb{constructor(I){I.name&&(this.n=I.name);I.stack&&(this.s=I.stack);I.message&&(this.m=I.message);I.file&&(this.f=I.file);null!=I.line&&(this.l=I.line);null!=I.column&&(this.c=I.column)}}Object(f.a)(yb,"LoggingExceptionArgsLocalStorage",null,[]);class Wb{constructor(I){this.t=I.tag;this.c=
I.category;this.l=I.level;this.m=I.message;this.lt=I.logType;this.ts=I.timestamp;this.o=I.isMinified;this.a=I.args;I.exceptionArgs&&(this.e=new yb(I.exceptionArgs))}}Object(f.a)(Wb,"LoggingArgsLocalStorage",null,[]);var Xb=b(337);class Cc{constructor(I,ra,ab,Fb,ac,Xc){this.t=I;this.m=ra;this.s=ab;this.v=Fb;this.i=ac;this.a=Xc;this.op="Log"}}Object(f.a)(Cc,"LoggingKeyLocalStorage",null,[]);var Bc=b(133);const pd=(I,ra,ab)=>!(void 0===I||null===I)&&!(void 0===I.i||null===I.i)&&!(void 0===I.t||null===
I.t)&&!(void 0===I.s||null===I.s)&&"Log"===I.op&&I.t===ra&&isFinite(I.t)&&Bc.a.Nc(I.s)&&(void 0===I.m||null===I.m||I.m===ab);class zd{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg,gi){this.mQa=this.Xtg=this.Mtg=this.Ntg=!1;this.MH=this.q5a=this.L2=this.wQ=null;this.uk=!1;this.Anb=[];this.vOb=[];this.jva=ab;this.Tva=Fb;this.Gva=ac;this.Qe=ra;this.Ta=I;this.Unc=Xc;this.Pte=Md;this.$Cg=bf;this.CQa=Hf;this.Hlj=Zg;this.Zoe=gi}get manifest(){return this.L2}get aMc(){return this.q5a}get VKa(){return this.MH}init(){this.ERf();
this.mQa=!1;this.Qe.kTb(this);this.wQ=new gc.a(3,1,2500,Object(x.a)(this,this.determineLogsToSendAtBoot,"determineLogsToSendAtBoot"),103);this.Ta.ub(this.wQ)}determineLogsToSendAtBoot(){this.fdh(!0)}determineLogsToSendOnReconnect(){this.fdh(!1)}fdh(I){this.lvd();this.Anb=[];I&&(this.vOb=[]);for(var ra=0;ra<this.jva.length;ra++){const ab=this.jva.key(ra),Fb=zd.Ncc(ab,!1);pd(Fb,this.Unc,this.Pte)&&(Fb.s===this.Gva?Array.add(this.Anb,ab):I&&Array.add(this.vOb,ab))}if(this.Anb.length||I&&this.vOb.length)if(ra=
this.Zoe?Object(x.a)(this,this.jun,"sortDescendKeysToUpload"):Object(x.a)(this,this.mun,"sortKeysToUpload"),this.Anb.sort(ra),I&&this.vOb.sort(ra),0<this.Anb.length||0<this.vOb.length)this.wQ=new gc.a(3,2,2500,Object(x.a)(this,this.sendOfflineLogs,"sendOfflineLogs"),105),this.Ta.ub(this.wQ)}mun(I){return I.s!==I.s?I.s.localeCompare(I.s):I.i-I.i}jun(I){return I.s!==I.s?I.s.localeCompare(I.s):I.i-I.i}rvc(I,ra,ab,Fb){return JSON.stringify(new Cc(this.Unc,this.Pte,ra,ab,I,Fb))}ERf(){this.q5a=new Ub.a;
this.MH=new Dc.a;this.Tva.LPg(Object(x.a)(this,this.VAf,"onUlsReadyToBeSent"));this.Tva.qQg(Object(x.a)(this,this.XAf,"onUlsSentSuccessfully"));this.Tva.pQg(Object(x.a)(this,this.WAf,"onUlsSentFailed"));this.Tva.CPg(Object(x.a)(this,this.lxf,"onAfterUlsHostDisposed"))}VAf(I,ra){if(void 0!==ra&&null!==ra&&void 0!==ra.args&&null!==ra.args){if(this.aMc.Ja(ra.args.tag))this.aMc.remove(ra.args.tag);else if(this.aMc.Ja(Cb.Vld))this.aMc.remove(Cb.Vld);else if(!(this.Hlj&&50>ra.args.level))return;({value:I}=
this.VKa.Ab(ra.aL)).returnValue||(I=new fb(ra.sessionId,ra.version,ra.Pmd,ra.ABf),this.VKa.Z(ra.aL,I));this.VKa.J(ra.aL).Zja.add(ra.args)}}XAf(I,ra){this.VKa.remove(ra.aL)}WAf(I,ra){void 0!==ra&&null!==ra&&this.VKa.Ja(ra.aL)&&this.d6h(ra.aL)&&!this.Xtg&&(this.Xtg=!0,ha.ULS.sendTraceTag(37290073,222,50,"Added logs to local storage."))}d6h(I){let ra=!1;if(({value:Fb}=this.VKa.Ab(I)).returnValue&&Fb&&0<Fb.Zja.count){if(Fb.Pmd>=this.CQa)return!1;var ab=Fb.Zja;const ac=Array(ab.count);for(let Xc=0,Md=
ab.count;Xc<Md;++Xc)ac[Xc]=new Wb(ab.J(Xc));ab=zd.serialize(ac);var Fb=this.rvc(Fb.ABf,Fb.sessionId,Fb.version,Fb.Pmd);this.dZc(Fb,ab)&&(this.VKa.remove(I),ra=!0)}return ra}lxf(){this.dispose()}dZc(I,ra){try{return this.jva.setItem(I,ra),!0}catch(ab){return ha.ULS.sendTraceTag(37290074,222,15,"OfflineLogger SetItem failed with exception: {0}",ab.message),!1}}sendOfflineLogs(){if(!this.mQa){var I=0<this.Anb.length?this.Anb:this.vOb,ra=I.length;if(ra)for(;0<ra;){Q.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordSendOfflineLogsV2ImprovementSettings");
ra--;var ab=this.Zoe?I.pop():I[0];this.Zoe||Array.removeAt(I,0);const Xc=zd.Ncc(ab,!0);if(pd(Xc,this.Unc,this.Pte)){var Fb=this.jva.getItem(ab);this.jva.removeItem(ab);if(void 0!==Fb&&null!==Fb)if(Xc.a>this.CQa)ha.ULS.sendTraceTag(37290075,222,50,"Log has more attempt {0} than the max allowed {1}.",Xc.a,this.CQa);else if(ab=zd.Ncc(Fb,!0),void 0!==ab&&null!==ab&&isFinite(ab.length))if(ab.length){Fb=ab[ab.length-1];var ac=(new Date).getTime()-Fb.ts;if(ac<-zd.tOi)ha.ULS.sendTraceTag(37290078,222,50,
"Log came from more than a day in the future.  Let's throw it away and not trust it. {0}",Fb.ts);else if(ac>this.$Cg*zd.tOi)ha.ULS.sendTraceTag(37290079,222,50,"Log is older than our retention period of {0} days.  Throwing it away. {1}",this.$Cg,Fb.ts);else{Xc.s===this.Gva?this.Ntg||(this.Ntg=!0,ha.ULS.sendTraceTag(37290080,222,50,"Attempted to re-send logs from this session.")):this.Mtg||(this.Mtg=!0,ha.ULS.sendTraceTag(37290081,222,50,"Attempted to re-send logs from another session {0}.",Xc.s));
ra=Array(ab.length);for(Fb=0;Fb<ab.length;Fb++){I=Fb;a:{ac=ab[Fb];if(void 0===ac||null===ac){ac=null;break a}let Md=null;ac.e&&(Md=new Xb.a(null),Md.name=ac.e.n,Md.stack=ac.e.s,Md.message=ac.e.m,Md.file=ac.e.f,Md.line=ac.e.l,Md.column=ac.e.c);ac=new od.a(ac.ts,ac.c,ac.t,ac.l,ac.m,ac.lt,ac.o,ac.a,Md)}ra[I]=ac}this.Tva.dui(this,ra,Xc.s,Xc.v,Xc.a+1,Xc.i);break}}else ha.ULS.sendTraceTag(37290077,222,15,"Deserialize an empty array from local storage: {0}",Fb);else ha.ULS.sendTraceTag(37290076,222,15,"Unable to deserialize the offline log: {0}",
Fb)}}else this.lvd()}}vYa(I,ra,ab){!this.uk&&ha.ULS.y5(ra,ab)&&this.aMc.Z(I,!0)}dispose(){if(!this.uk){this.wQ&&this.Ta.me(this.wQ);var I=Nb.toArray(this.VKa.keys);for(const ra of I)this.d6h(ra)}this.uk=!0}mLa(){this.mQa=!0;this.lvd()}ueb(){this.mQa=!1;this.lvd();this.wQ&&this.Ta.me(this.wQ);this.wQ=new gc.a(3,1,2500,Object(x.a)(this,this.determineLogsToSendOnReconnect,"determineLogsToSendOnReconnect"),102);this.Ta.ub(this.wQ)}lvd(){this.wQ&&(this.Ta.me(this.wQ),this.wQ=null)}static serialize(I){return JSON.stringify(I)}static Ncc(I,
ra){try{return JSON.parse(I)}catch(ab){ra&&ha.ULS.sendTraceTag(37290082,222,10,"OfflineLogger TryParseString failed with exception: {0}",ab.message)}return null}}zd.tOi=864E5;Object(f.a)(zd,"OfflineLoggerImplV2",null,[1936,14,207]);class Jd{constructor(){localStorage.getItem("{CBEDE940-2407-4B58-BA27-B8CBF0B0DDE6}{5}")}get length(){try{return localStorage.length}catch(I){return this.handleError("Length",I),-1}}key(I){try{return localStorage.key(I)}catch(ra){return this.handleError("Key",ra),null}}getItem(I){try{return localStorage.getItem(I)}catch(ra){return this.handleError("GetItem",
ra),null}}setItem(I,ra){try{return localStorage.setItem(I,ra)}catch(ab){return this.handleError("SetItem",ab),null}}removeItem(I){try{localStorage.removeItem(I)}catch(ra){this.handleError("RemoveItem",ra)}}clear(){try{localStorage.clear()}catch(I){this.handleError("Clear",I)}}handleError(I,ra){ha.ULS.sendTraceTag(19170128,222,10,"Invoking localStorage function[{0}] failed, message: {1}",I,ra.message)}}Object(f.a)(Jd,"OfflineStorage",null,[1935]);class Ue{create(I){let ra=null;try{void 0!==localStorage&&
null!==localStorage&&(ra=new Jd)}catch(ab){ha.ULS.sendTraceTag(18641093,222,50,"window.localStorage is not accessable: {0}",ab.message)}Object.getType(ha.ULS.host).implementsInterface(1E3)&&ra||(ha.ULS.sendTraceTag(18614230,222,50,"OfflineLogger is not supported: offline storage is {0}, ULS host hook is {1}",ra?"supported":"not supported",Object.getType(ha.ULS.host).implementsInterface(1E3)?"supported":"not supported"),I=0);I=1===I?new Bb(Q.AFrameworkApplication.Cb,Q.AFrameworkApplication.fe,ra,ha.ULS.host,
Q.AFrameworkApplication.userSessionId):2===I?new zd(Q.AFrameworkApplication.Cb,Q.AFrameworkApplication.fe,ra,ha.ULS.host,Q.AFrameworkApplication.userSessionId,Q.AFrameworkApplication.na.Ya.Rm,Q.AFrameworkApplication.na.Ya.yda,Q.AFrameworkApplication.K.vb("OfflineLoggerRetentionInDays",30),Q.AFrameworkApplication.K.vb("OfflineLoggerMaxAttempts",5),Q.AFrameworkApplication.K.$("OfflineLoggerListenForAllMonitorableLogsIsEnabled"),Q.AFrameworkApplication.K.$("SendOfflineLogsV2ImprovementIsEnabled")):new uc;
I.init();return I}}Object(f.a)(Ue,"OfflineLoggerFactory",null,[]);class Sc{yb(){}get name(){return"Common.App.OfflineLogger"}init(){const I=Q.AFrameworkApplication.K;let ra=0;I.$("OneNoteOfflineLoggerIsEnabled")?ra=1:I.$("OfflineLoggerV2IsEnabled")&&(ra=2);0!==ra&&(Q.AFrameworkApplication.YXf=(new Ue).create(ra))}dispose(){}}Object(f.a)(Sc,"OfflineLoggerPackage",null,[1,2]);var kc=b(1189);class Pc{constructor(I){this.j3h=null;ha.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.BMc=
Q.AFrameworkApplication.K.Ga("PhoneLinkServiceEndpoint");(this.G4=I)||ha.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.BMc&&this.BMc.length||ha.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}yGk(I){I&&(this.BMc="https://dcg-df.microsoft.com/",ha.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.xGk()}xGk(){ha.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");
if(864E5>=+new Date-+this.j3h)ha.ULS.sendTraceTag(527574722,306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.j3h=new Date;var I=new Date;this.G4.Pla("BayBridge",this.BMc).then(ra=>{const ab=+new Date-+I;ra.IsSuccess?(ha.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",ab),this.pGk(ra.Token,this.WRk())):ha.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
ab,ra.ErrorCode,ra.ErrorMessage)}).catch(ra=>{ha.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",ra,+new Date-+I)})}}pGk(I,ra){const ab={};ab.Authorization="Bearer "+I;ab["Authorization-Type"]="AAD";ab.Accept="application/json";Q.AFrameworkApplication.fe.ai(ra,1,null,ab,!1,2,Object(x.a)(this,this.Kgl,"getStatusSucceeded"),Object(x.a)(this,this.Igl,"getStatusFailed"),null,void 0,void 0,void 0,void 0,"39")}TTk(){const I=kc.a.instance.getItem("AccountLinkedStatusCache");
return I&&I.length?"true"===I.toLowerCase()?!0:!1:!1}WRk(){return this.BMc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}Igl(){ha.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}Kgl(I){ha.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");I=va.a(I.data.qd).state+"";kc.a.instance.setItem("AccountLinkedStatusCache",I)}}Object(f.a)(Pc,"PhoneLinkManager",null,[1862]);class Rd{constructor(){this.W=
null}get name(){return"Common.App.PhoneLink"}yb(I){this.W=I;this.W.register(1862,"Common.App.PhoneLink.IPhoneLinkManager").singleInstance().Pc(()=>new Pc(this.W.resolve("Common.App.OAuth.IOAuthManager")))}init(){Q.AFrameworkApplication.K.Io(()=>{this.XWa()})}XWa(){this.W.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){aa.a.instance.Lb(new Rd)}}Object(f.a)(Rd,"PhoneLinkPackage",null,[1,2]);const le=I=>{try{return va.a(I)}catch(ra){}return null};class Fc{constructor(I,ra,
ab,Fb,ac,Xc){this.vW=!1;this.Gp=null;this.awe=!1;this.ga=I;this.Qe=ra;this.Mi=ab;this.Ssg=Fb;this.qa=ac;this.mlj=Xc}init(I,ra){ra&&I.za("Common.Interface.IRtcBasicProvider").execute(Object(x.a)(this,this.LLe,"awaitRtc"))}LLe(I){const ra=I.QDc();ra.continueWith(()=>{this.Gp=ra.result;this.awe&&(this.Gp.MM(2,null,!0),this.awe=!1);this.Gp.j3((ab,Fb)=>{2===Fb.type&&this.Eb.processAction(Ya.a.fileNameUpdate,2)});this.Gp.qwa((ab,Fb)=>{2===Fb.newState&&this.Eb.processAction(Ya.a.fileNameUpdate,2)});2===
this.Gp.connectionState&&this.Eb.processAction(Ya.a.fileNameUpdate,2)})}oIa(I){this.yjh(I,!0)}yjh(I,ra){const ab=this.PXj(I.iJi),Fb={};Fb[Fc.y6g]=Fc.z6g;this.Tti.ai(ab,2,"",Fb,!1,2,Object(x.a)(this,this.J6b,"onRefreshFilenameSuccess"),ra?Object(x.a)(this,this.yrm,"onRefreshFilenameFailureRetry"):Object(x.a)(this,this.rci,"onRefreshFilenameFailureNoRetry"),I)}J6b(I){this.vW=!1;const ra=le(I.data.qd);I.data.state.onSuccess(ra,this.Ssg.value)}yrm(I){5!==I.data.status||this.vW?this.rci(I):(this.vW=!0,
this.yjh(I.data.state,!1))}rci(I){I.data.state.onFailure(-1)}Ovb(I){this.zjh(I,!0)}zjh(I,ra){const ab=this.QXj(),Fb={};Fb[Fc.y6g]=Fc.z6g;Fb[Fc.Nrl]=gb.a.ui(I.$ti);Fb[Fc.Lrl]=this.mlj.value.L8j;this.Tti.ai(ab,2,"",Fb,!1,2,Object(x.a)(this,this.QOc,"onRenameFileSuccess"),ra?Object(x.a)(this,this.Drm,"onRenameFileFailureRetry"):Object(x.a)(this,this.tci,"onRenameFileFailureNoRetry"),I)}QXj(){return this.hYg()}PXj(I){let ra=this.hYg();return ra=vb.a.oo(ra,Fc.Rrl,I?"2":"1")}hYg(){let I=(this.qa.value.appSettings.RenameWebServiceBase||
"")+Fc.Mrl;I=vb.a.oo(I,Fc.Orl,gb.a.ui(Q.AFrameworkApplication.kl));this.qo&&this.qo.Uif&&(I=vb.a.oo(I,Fc.Qrl,"1"));return I}QOc(I){this.vW=!1;const ra=le(I.data.qd);I.data.state.onSuccess(ra,this.Ssg.value);this.y8h()}y8h(){this.Gp?this.Gp.MM(2,null,!0):this.awe=!0}Drm(I){5!==I.data.status||this.vW?this.tci(I):(this.vW=!0,this.zjh(I.data.state,!1))}tci(I){I.data.state.onFailure(-1)}get Eb(){return this.ga.value}get Tti(){return this.Qe.value}get qo(){return this.Mi.value}static get instance(){return Fc._instance||
(Fc._instance=Fc.wwb())}static wwb(){return new Fc(new Jb.a(()=>Q.AFrameworkApplication.pa),new Jb.a(()=>Q.AFrameworkApplication.fe),new Jb.a(()=>Q.AFrameworkApplication.qo),new Jb.a(()=>ia.a.instance.resolve("Postmessage.IHostPostmessenger")),new Jb.a(()=>Q.AFrameworkApplication.K),new Jb.a(()=>ia.a.instance.resolve("Common.IRenameProps")))}}Fc.y6g="Content-Type";Fc.z6g="application/json; charset=utf-8";Fc.Mrl="renamehandler.ashx";Fc.Orl="qs";Fc.Nrl="n";Fc.Qrl="sl";Fc.Lrl="X-CoauthLockId";Fc.Rrl=
"u";Fc._instance=null;Object(f.a)(Fc,"ExecuteRenameFileHandler",null,[]);class He{constructor(){this.onFailure=this.onSuccess=null;this.iJi=!1}}Object(f.a)(He,"ExecuteRefreshFilenameData",null,[]);class $e{constructor(){this.onFailure=this.onSuccess=this.$ti=null}}Object(f.a)($e,"ExecuteRenameFileData",null,[]);class Le{constructor(){this.W=null;this.kie=Fc.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}yb(I){this.W=I}init(){Q.AFrameworkApplication.K.Io(Object(x.a)(this,this.Mv,
"onFullAppSettingsReady"))}Mv(){Q.AFrameworkApplication.fKc()&&(Fc.instance.init(this.W,Q.AFrameworkApplication.cTc),Q.AFrameworkApplication.Ovb=Object(x.a)(this,this.Ovb,"executeRenameFile"),Q.AFrameworkApplication.oIa=Object(x.a)(this,this.oIa,"executeRefreshFilename"),Q.AFrameworkApplication.JUc=Object(x.a)(this,this.JUc,"sendFileNameAndLocationUpdateNotification"))}Ovb(I,ra,ab){const Fb=new $e;Fb.$ti=I;Fb.onSuccess=ra;Fb.onFailure=ab;this.kie.Ovb(Fb)}oIa(I,ra,ab){const Fb=new He;Fb.onSuccess=
I;Fb.onFailure=ra;Fb.iJi=ab;this.kie.oIa(Fb)}JUc(){this.kie.y8h()}dispose(){}}Object(f.a)(Le,"PackageManager",null,[1,2]);var df=b(132);class Af{constructor(I,ra,ab){this.vTf=this.wTf=this.xTf=!1;this.JTf=!I&&!ra;this.KTf=!I&&!ab;this.JTf||this.KTf||(this.xTf=!I,this.wTf=!ra,this.vTf=!ab)}}Object(f.a)(Af,"RenameDisabledDialogInfo",null,[]);class Ve extends df.StandardDialog{constructor(I,ra,ab,Fb,ac){super();this.JXf=[];this.uaa=new Af(I,ra,ab);this.D7a=Fb;this.Y4a=ac;this.jf="RenameDisabledDialog";
this.yc=0;this.Nd(1,CommonUIStrings.l_DialogClose);this.Fjn();this.SZm()}Fjn(){this.uaa.JTf?this.yWc(this.D7a?this.Y4a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.uaa.KTf?this.yWc(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.bEj();this.zkd(this.JXf)}yWc(I){Array.add(this.JXf,I)}bEj(){const I=[];this.uaa.xTf||Array.add(I,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.uaa.wTf||Array.add(I,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.uaa.vTf||Array.add(I,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<I.length&&Array.add(this.JXf,I)}}Object(f.a)(Ve,"ReactRenameDisabledDialogBase",df.StandardDialog,[]);class Kc extends Ve{constructor(I,ra,ab,Fb,ac){super(I,ra,ab,Fb,ac)}SZm(){this.feb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(f.a)(Kc,"ReactRenameDisabledDialog",Ve,[]);var hd=b(151);class id{static get vf(){return hd.a.fy(id.ll,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}id.ll="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(f.a)(id,"RenameDisabledDialogHtml",null,[]);class oh extends hd.a{constructor(I,ra,ab,Fb,ac){super();this.uaa=new Af(I,ra,ab);this.D7a=Fb;this.Y4a=ac;this.jf="RenameDisabledDialog";this.yc=0;this.Nd(1,CommonUIStrings.l_DialogClose);this.vf=id.vf;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.n5("RenameRow")}cS(){if(this.uaa.JTf){let I;I=this.D7a?this.Y4a?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;oh.yWc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),I)}else this.uaa.KTf?oh.yWc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Uul()}Uul(){this.uaa.xTf&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.uaa.wTf&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.uaa.vTf&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static yWc(I,ra,ab){I.style.display="none";ra.innerText=ab}}Object(f.a)(oh,"RenameDisabledDialog",hd.a,[]);var vf=b(64);class Yc{constructor(I,ra){this.eob=0;this.ga=I;this.cEa=ra}initialize(I){if(!this.ga||!this.cEa)return!1;this.eob=I;this.eb();return!0}eb(){this.ga.ka(Ya.a.eRe,vf.a.frame,Object(x.a)(this,this.eRe,"commitNewDocumentTitle"))}eRe(I,ra,ab,Fb,ac){if(1===ab)return this.ga.processAction(Ya.a.renameFile,
1);I=gb.a.rI(this.cEa.Ry);ac=(0,ac.getNewDocumentTitle)();ac.length>this.eob&&(ac=ac.substr(0,this.eob));if(32!==this.ga.hb(Ya.a.renameFile,2,ac))return this.fdc(I),8;this.fdc(ac);return 32}fdc(I){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(I))}static wk(){return new Yc(Q.AFrameworkApplication.pa,Q.AFrameworkApplication.Yr)}}Object(f.a)(Yc,"ReactRenameUIHandler",null,[1934]);var sb=b(902),Qb=b(1429),Oc=b(505),wc=b(92),yc=b(188),ef=b(60);class Je{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,
Hf,Zg,gi,Ei){this._initialized=!1;this._element=null;this.eob=0;this.Sze=this.Nle=!1;this.ga=I;this.vfa=ra;this.jd=ab;this.xq=Fb;this.cEa=ac;this.aEg=Xc;this.Ffd=Md;this.yde=bf;this.x4a=Hf;this.Vpg=Zg;this.Sg=gi;this.une=Ei}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(I,ra,ab){if(!(this.ga&&this.cEa&&this.aEg&&this.Ffd&&this.yde&&ra)||0>=I)return!1;this._element=ra;this._element.title=ab;this._element.setAttribute(ef.a.tg,ef.a.v_);this._element.setAttribute("Unselectable",
"on");this.eob=I;this.IF();return this._initialized=!0}IF(){this.vfa&&(this.vfa.Ea(F.a.blur,this._element,Object(x.a)(this,this.onBlur,"onBlur")),this.vfa.Ea(F.a.paste,this._element,Object(x.a)(this,this.NOc,"onPaste")));this.jd.Ea(F.a.ah,this._element,Object(x.a)(this,this.onKeyDown,"onKeyDown"));this.xq.Ea(F.a.pointerDown,this._element,Object(x.a)(this,this.uC,"onPointerDown"));this.xq.Ea(F.a.GK,this._element,Object(x.a)(this,this.Yra,"onPointerUp"))}onBlur(){this.isActive&&!this.Nle&&(this.Vpg||
this.yde(this._element),this.I4g(),this.mWe(!1));return this.Nle=!1}NOc(){ha.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(I){return this.isActive?this.jpm(I):this.kpm(I)}jpm(I){let ra=!1;switch(I.Sa.keyCode){case Sys.UI.Key.enter:this.I4g();this.mWe(this.Sg||this.une);ra=!0;break;case Sys.UI.Key.tab:this.Vpg&&this.yde(this._element);break;case Sys.UI.Key.esc:this.oMf(),this.mWe(this.Sg||this.une),ra=!0}return ra}kpm(I){let ra=!1;switch(I.Sa.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.JQi(this.une),
this.isActive&&this.Ffd(this._element),ra=!0}return ra}uC(){this.isActive||(this.JQi(!1),this.isActive&&(this._element.focus(),this.Ffd(this._element),this.Sze=!0));return!1}Yra(){return this.Sze?(this.Ffd(this._element),this.Sze=!1,!0):!1}k3b(){return 32===this.ga.processAction(Ya.a.renameFile,1)}I4g(){const I=gb.a.rI(this.cEa.Ry);let ra=this._element.innerText.trim();ra.length>this.eob&&(ra=ra.substr(0,this.eob));ra!==I&&""!==ra?32!==this.ga.hb(Ya.a.renameFile,2,ra)?this.oMf():this.fdc(ra):this.oMf()}oMf(){this.fdc(gb.a.rI(this.cEa.Ry))}fdc(I){this._initialized&&
(this._element.innerText=I,this.aEg())}JQi(I){this.k3b()?this.isActive||(I&&(this.Nle=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(ef.a.tg,ef.a.BUg),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,sb.CuiHelper.kgh),this.x4a&&this.x4a.execute(ra=>{ra.pmi(!0)}),I&&this._element.focus(),ha.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.ga.processAction(Ya.a.Gac,
2)}mWe(I){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(ef.a.tg,ef.a.v_);Sys.UI.DomElement.removeCssClass(this._element,sb.CuiHelper.kgh);this.x4a&&this.x4a.execute(ra=>{ra.pmi(!1)});I&&(this._element.blur(),this._element.focus())}static $ka(){Qb.a.$ka(Q.AFrameworkApplication.isRtl)}static wk(){return new Je(Q.AFrameworkApplication.pa,Oc.a.instance,wc.KeyInputManager.instance,yc.a.instance,Q.AFrameworkApplication.Yr,Je.$ka,
la.a.a9m,la.a.F2g,ia.a.instance.za("Common.App.Header.HeaderEventSource"),Ga.a.eA,Ga.a.sh,Ga.a.Qh)}}Object(f.a)(Je,"RenameUIHandler",null,[1934]);class fh{static get instance(){return Q.AFrameworkApplication.na.Ya.WG?fh._instance||(fh._instance=Yc.wk()):fh._instance||(fh._instance=Je.wk())}}fh._instance=null;Object(f.a)(fh,"RenameUIHandlerFactory",null,[]);var re=b(105);class Se{constructor(){this.Dvf=this.zgm=this.Znk=null}}Object(f.a)(Se,"RenameMruEntryProperties",null,[]);var Ye=b(166),Ji=b(90),
ah=b(1369),ag;(function(I){I[I.unknown=-1]="unknown";I[I.success=0]="success";I[I.renameInvalidFileName=1]="renameInvalidFileName";I[I.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";I[I.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";I[I.permissionDenied=4]="permissionDenied";I[I.serverCommunicationFailure=5]="serverCommunicationFailure";I[I.fileNameTooLong=6]="fileNameTooLong"})(ag||(ag={}));Object(f.b)("CommonOperationResult",ag);class rg{constructor(I,ra,ab,Fb,ac,Xc,
Md,bf,Hf,Zg,gi,Ei){this.qqg=I;this.ga=ra;this.Mi=ab;this.nJ=Fb;this.Lnb=ac;this.lzj=Xc;this.D7a=Md;this.gKg=bf;this.gsj=Hf;this.Y4a=Zg;this.qa=gi;this.fsj=Ei}eb(){Q.AFrameworkApplication.na&&Q.AFrameworkApplication.na.Ya.WG||this.Eb.ka(Ya.a.s1b,vf.a.frame,Object(x.a)(this,this.s1b,"initializeRenameUIHandler"));this.Eb.ka(Ya.a.Gac,vf.a.frame,Object(x.a)(this,this.Gac,"showRenameDisabledDialog"));this.Eb.ka(Ya.a.renameFile,vf.a.frame,Object(x.a)(this,this.renameFile,"renameFile"));this.Eb.Aa(Ya.a.fileNameUpdate,
vf.a.frame,Object(x.a)(this,this.uQm,"refreshFilename"),64);this.Eb.Aa(Ya.a.aPd,vf.a.frame,Object(x.a)(this,this.aPd,"moveToFolderCompleteByHost"),64);this.Eb.ka(Ya.a.eCb,vf.a.frame,Object(x.a)(this,this.eCb,"moveToFolder"));Q.AFrameworkApplication.na&&(Q.AFrameworkApplication.K.$("PostMessageEmbedded")||Q.AFrameworkApplication.K.$("IsJsApi"))&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&Q.AFrameworkApplication.uO().execute(I=>{I.uu(Ji.a.x6h);
I.pA(Ji.a.x6h,rg.xNm);I.uu(Ji.a.E1e);I.pA(Ji.a.E1e,rg.vNm)})}k3b(){return 0===this.fsj.EBh()?32:8}eTn(){return this.qo?this.D7a?this.qo.tfh:this.qo.iab:!0}s1b(){return fh.instance.initialize(Q.AFrameworkApplication.wwd,Q.AFrameworkApplication.lfh,Q.AFrameworkApplication.gsi||CommonUIStrings.l_RenameFileTooltip)?32:8}Gac(){const I=this.eTn(),ra=this.lzj();ha.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.Lnb,ra,I,this.D7a);Q.AFrameworkApplication.na&&Q.AFrameworkApplication.na.Ya.fA&&Q.AFrameworkApplication.K.$("ReactRenameDisabledDialogIsEnabled")?new Kc(this.Lnb,!ra,!I,this.D7a,this.Y4a()):new oh(this.Lnb,!ra,!I,this.D7a,this.Y4a());return 32}renameFile(I,ra,ab,Fb,ac){if(1===ab)return this.k3b();if(!Q.AFrameworkApplication.Ovb)return 8;if(8===this.k3b())return this.Eb.processAction(Ya.a.Gac,2),8;ha.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");Q.AFrameworkApplication.Ovb(ac,Object(x.a)(this,
this.QOc,"onRenameFileSuccess"),Object(x.a)(this,this.Crm,"onRenameFileFailure"));return 32}QOc(I,ra){I?0!==I.OperationResult?this.zHh(I.OperationResult):(this.M$m(ra,I.NewName),this.RLn(I,Object(x.a)(Q.AFrameworkApplication.na.Ya,Q.AFrameworkApplication.na.Ya.gVi,"updateOpenInClientDocumentUrl")),Q.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&Q.AFrameworkApplication.na.updateCommandUI(),this.gsj.fTi()):this.zHh(5)}M$m(I,ra){const ab={};ab[Ye.a.VGk]=ra;I.Qg(Ji.a.E1e,ab)}RLn(I,
ra){this.aMn(I);Q.AFrameworkApplication.Etd=I.DirectInvokeDavUrl;ra=ra(I.EditDocInClientUrl);const ab=new Se;ab.Dvf=this.nJ.Ry;ab.Znk=ra;ab.zgm=I.EditDocInClientUrl;this.Eb.hb(Ya.a.hsi,2,ab)}zHh(I){switch(I){case 1:I=new df.StandardDialog,I.yc=0,I.vS(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.Uui()}}aMn(I){this.nJ.Ry=rg.qNj(this.nJ.Ry,I.NewName);I.BreadcrumbFolderName&&(this.nJ.breadcrumbFolderName=I.BreadcrumbFolderName);I.BreadcrumbFolderUrl&&
(this.nJ.breadcrumbFolderUrl=I.BreadcrumbFolderUrl);this.gKg(I.NewName)}Crm(I){const ra=new df.StandardDialog;ra.yc=0;switch(I){case 1:ha.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");ra.Dea(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ha.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");ra.Dea(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;
default:ha.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:I}),ra.Dea(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}Q.AFrameworkApplication.uO().execute(ab=>{ab.Qg(Ji.a.UGk,{["FailureMessage"]:ag[I]})});this.Uui()}uQm(I,ra,ab){if(1===ab)return this.k3b();if(!Q.AFrameworkApplication.oIa)return 8;Q.AFrameworkApplication.oIa(Object(x.a)(this,this.J6b,"onRefreshFilenameSuccess"),Object(x.a)(this,this.NRd,"onRefreshFilenameFailure"),
!1);return 32}eCb(I,ra,ab,Fb,ac){if(1===ab)return Q.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?32:8;if(2===ab){const Xc={};I=Q.AFrameworkApplication.JAb;ra=Q.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");I=(!I||I&&ra)&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Xc[Ye.a.Oyn]=I;ac&&ac.MoveButtonClickedTime&&(Xc[Ye.a.Sem]=ac.MoveButtonClickedTime.getTime());Q.AFrameworkApplication.uO().execute(Md=>{Md.Qg(Ji.a.eCb,Xc)});
if(ac&&ac.MoveButtonClickedTime){if(I=re.a.AD())ac=(new Date).getTime()-ac.MoveButtonClickedTime.getTime(),I.set("MovePostDuration",ac.toString());pa.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",I)}return 32}return 8}aPd(I,ra,ab,Fb,ac){if(1===ab)return Q.AFrameworkApplication.K.$("UiHostSupportsMoveToFolder")?this.k3b():8;if(2===ab){if(!Q.AFrameworkApplication.JUc)return pa.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;
if(!ac)return pa.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(ac[Ye.a.TIl])if(ac[Ye.a.IWi])if(I=ac[Ye.a.IWi].toLowerCase(),ra=Q.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"),ab=Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),ra&&Q.AFrameworkApplication.JAb&&ab){const Xc={};Xc[Ye.a.G8b]="1";Xc[Ye.a.documentUrl]=I;Xc[Ye.a.reason]=ah.a.CNf;pa.Health.instance.recordKpiSuccess("MoveToFolder",null);Q.AFrameworkApplication.uO().execute(Md=>
{Md.Qg(Ji.a.jvb,Xc)})}else if(!Q.AFrameworkApplication.JAb&&ab)pa.Health.instance.recordKpiSuccess("MoveToFolder",null),la.a.Ql(I,la.a.bma(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return pa.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else pa.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else Q.AFrameworkApplication.oIa(Object(x.a)(this,this.J6b,"onRefreshFilenameSuccess"),Object(x.a)(this,this.NRd,"onRefreshFilenameFailure"),
!1),Q.AFrameworkApplication.JUc(),pa.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}Cpn(I,ra){return I&&ra?I!==this.nJ.breadcrumbFolderName||ra!==this.nJ.breadcrumbFolderUrl:!1}J6b(I,ra){I&&(I.NewName!==gb.a.rI(this.nJ.Ry)||this.Cpn(I.BreadcrumbFolderName,I.BreadcrumbFolderUrl))&&this.QOc(I,ra)}NRd(){}Uui(){this.gKg(gb.a.rI(this.nJ.Ry))}get Eb(){return this.ga.value}get qo(){return this.Mi.value}static get instance(){return rg._instance||(rg._instance=rg.wwb())}static wwb(){return new rg(Q.AFrameworkApplication.fKc,
new Jb.a(()=>Q.AFrameworkApplication.pa),new Jb.a(()=>Q.AFrameworkApplication.qo),Q.AFrameworkApplication.Yr,Q.AFrameworkApplication.yra,()=>Q.AFrameworkApplication.s1f,Q.AFrameworkApplication.cTc,Object(x.a)(fh.instance,fh.instance.fdc,"updateTitle"),ia.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>Q.AFrameworkApplication.zt,Q.AFrameworkApplication.K,ia.a.instance.resolve("Common.IRenameProps"))}static qNj(I,ra){I=gb.a.WIa(I);return ra+I}static xNm(I){const ra=I.Values[Ye.a.oOl];
ha.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",ra);ra?Q.AFrameworkApplication.pa.hb(Ya.a.aPd,2,I.Values):pa.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static vNm(I){Q.AFrameworkApplication.pa.hb(Ya.a.renameFile,2,I.Values.NewName)}}rg._instance=null;Object(f.a)(rg,"RenameActor",null,[]);var pi=b(146),Rj=b(1196),Ki=b(533),Fd=b(354);class Ld{constructor(I,ra){this.ga=I;this.C3a=ra}eb(){this.ga.ka(Ya.a.qIi,vf.a.frame,
Object(x.a)(this,this.msn,"showRenameDialogAction"))}msn(I,ra,ab){I=32;if(1===ab)return Fd.SessionStatusManager.instance.gi||Q.AFrameworkApplication.Aja?8:32;2===ab&&(32!==this.ga.processAction(Ya.a.renameFile,1)?(this.ga.processAction(Ya.a.Gac,2),pi.a.instance.ib(Rj.a.ria,{["Reason"]:Ki.a.$Ym}),I=8):32===this.ga.processAction(Ya.a.s2d,1)?this.ga.processAction(Ya.a.s2d,2):this.C3a.value.create().mNa());return I}}Object(f.a)(Ld,"RenameDialogActor",null,[1930]);class we{constructor(I,ra,ab){this.dialog=
null;this.ga=I;this.nJ=ra;this.f4a=ab}bdl(){const I={};I.nameInputProps={["type"]:"AppInputProps",["id"]:we.CXb,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:gb.a.rI(this.nJ.Ry),["maxLength"]:this.f4a};return I}mNa(){const I={["id"]:"RenameDialog",["bodyControls"]:this.bdl()};this.dialog=new hd.a(!1,!1,!0);this.dialog.yc=1;this.dialog.jf="RenameDialog";this.dialog.Tg(CommonUIStrings.l_RenameDialogTitle,Object(x.a)(this,this.LKf,"renameDialogHandler"),I)}LKf(I,ra){if(ra&&1===I){if(ra[we.CXb]&&
(I=gb.a.rI(this.nJ.Ry),ra=(ra[we.CXb]||"").trim(),ra!==I&&""!==ra)){this.ga.hb(Ya.a.renameFile,2,ra);return}pi.a.instance.ib(Rj.a.zXb,{["Reason"]:Ki.a.$kh})}}}we.CXb="txtDocumentName";Object(f.a)(we,"ReactRenameDialog",null,[1938]);class Te{static get vf(){return hd.a.fy(Te.ll,CommonUIStrings.l_RenameDialogLabel)}}Te.ll="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(Te,"RenameDialogHtml",null,[]);class Dj extends hd.a{constructor(I,ra,ab){super();this.ga=I;this.nJ=ra;this.f4a=ab;this.jf="RenameDialog";this.vf=Te.vf}mNa(){var I={["txtDocumentName"]:gb.a.rI(this.nJ.Ry)};this.Tg(CommonUIStrings.l_RenameDialogTitle,Object(x.a)(this,this.LKf,"renameDialogHandler"),I);I=document.getElementById(Dj.CXb);0<this.f4a&&(I.maxLength=this.f4a);I.focus()}LKf(I,ra){if(1===I&&(I=gb.a.rI(this.nJ.Ry),ra=(ra[Dj.CXb]||"").trim(),ra!==I&&""!==ra)){this.ga.hb(Ya.a.renameFile,
2,ra);return}pi.a.instance.ib(Rj.a.zXb,{["Reason"]:Ki.a.$kh})}}Dj.CXb="txtDocumentName";Object(f.a)(Dj,"RenameDialog",hd.a,[1938]);class oi{constructor(I){this.cEa=null;this.f4a=0;this.ga=I;this._initialized=!1}initialize(I,ra){this.cEa=I;this.f4a=ra;this._initialized=!0}create(){return this._initialized?Q.AFrameworkApplication.na&&Q.AFrameworkApplication.na.Ya.fA&&Q.AFrameworkApplication.K.$("ReactRenameDialogIsEnabled")?new we(this.ga,this.cEa,this.f4a):new Dj(this.ga,this.cEa,this.f4a):null}}Object(f.a)(oi,
"RenameDialogFactory",null,[1929]);var ik=b(171);class Nf{constructor(I){this.ga=I}eb(){this.ga.ka(Ya.a.s2d,vf.a.frame,Object(x.a)(this,this.nsn,"showRenameFlyoutAction"))}q1j(){return ik.d("setDocumentTitleFlyoutOpened")&&Q.AFrameworkApplication.na.Ya.WG}nsn(I,ra,ab){if(1===ab)return this.q1j()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}}Object(f.a)(Nf,"RenameFlyoutActor",null,[1928]);class vj{constructor(I,ra,ab,Fb,ac){this.L8j=null;this.Mi=ac;this.rqg=
ab;this.qqg=Fb;this.nzj=I;this.Y4a=ra}get qo(){return this.Mi.value}EBh(){if(!this.qqg())return 5;if(this.Y4a())return 1;if(this.qo){if(this.rqg&&!this.qo.tfh)return 3;if(!this.rqg&&!this.qo.iab)return 4}return this.nzj()?0:2}}Object(f.a)(vj,"RenameProps",null,[1922]);class Qj{constructor(I,ra,ab,Fb,ac,Xc){this.Sj=!1;this.Cqe=new Lb.a;this.fMb=ra;this.Mw=ab;this.WKb=Fb;this.qa=ac;this.Jga=Xc}enable(){this.Sj||(this.fTi(),this.hVf(),this.Sj=!0)}generateKey(I,ra,ab){return String.format("{0}/{1}/{2}",
ab,I,ra)}G4k(){const I=gb.a.rI(this.fMb().Ry);return this.generateKey(this.fMb().breadcrumbFolderName,this.fMb().breadcrumbFolderUrl,I)}H4k(I,ra,ab){return I&&ra?this.generateKey(I,ra,ab):ab}quk(I,ra,ab){return I&&I!==this.fMb().breadcrumbFolderName||ra&&ra!==this.fMb().breadcrumbFolderUrl?!0:ab!==gb.a.rI(this.fMb().Ry)}fTi(){const I=this.G4k();this.Cqe.Z(I,new Date)}vDf(I){this.Qnn(I)&&this.pMg(I)}Qnn(I){const ra=this.WKb();return ra?this.Jga&&this.Jga.Kn||!ra.Uif||!Q.AFrameworkApplication.oIa?(this.tLi(I),
this.Sj=!1):!0:!1}ndi(I,ra,ab,Fb){const ac=this.quk(I,ra,ab);I=this.H4k(I,ra,ab);ra=this.Cqe.Ab(I).returnValue;ac&&!ra&&(this.BHh(Fb),ha.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Wpf));ac||this.Cqe.Z(I,this.Mw())}}Object(f.a)(Qj,"ARenamedFileChecker",null,[1903]);class Jg extends Qj{constructor(I,ra,ab,Fb,ac,Xc,Md,bf){super(I,ra,ab,Fb,ac,Xc);this.QH=ac;this.esj=Md;this.ple=bf}get Wpf(){return"RenamedFileCheckerUsingSettingsRefresh"}hVf(){this.QH.Ytc(Object(x.a)(this,this.UHh,
"handleSettingsRefresh"))}UHh(I,ra){ra&&ra.oCb&&ra.u9h&&(ra.wKa("BreadcrumbDocName")||ra.wKa("BreadcrumbFolderName")||ra.wKa("BreadcrumbFolderUrl")||ra.wKa("DirectInvokeDAVUrl")||ra.wKa("EditDocInClientUrl"))&&(ha.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Wpf),this.vDf(ra))}tLi(){this.QH.Zri(Object(x.a)(this,this.UHh,"handleSettingsRefresh"))}pMg(I){if(I&&I.oCb){const ra=I.oCb;this.ndi(ra.Ga("BreadcrumbFolderName"),ra.Ga("BreadcrumbFolderUrl"),ra.Ga("BreadcrumbDocName"),
I)}}BHh(I){const ra={OperationResult:0,classId:1};I=I.oCb;ra.BreadcrumbFolderName=I.Ga("BreadcrumbFolderName");ra.BreadcrumbFolderUrl=I.Ga("BreadcrumbFolderUrl");ra.DirectInvokeDavUrl=I.Ga("DirectInvokeDAVUrl");ra.EditDocInClientUrl=I.Ga("EditDocInClientUrl");I=I.Ga("BreadcrumbDocName");ra.NewName=Q.AFrameworkApplication.$zc?I:gb.a.rI(I);this.ple.execute(ab=>{this.RFl(ra,ab)})}RFl(I,ra){this.esj().QOc(I,ra)}}Object(f.a)(Jg,"RenamedFileCheckerUsingSettingsRefresh",Qj,[]);class Mi extends Qj{constructor(I,
ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg){super(I,ab,Fb,ac,Xc,Hf);this.Qpc=this.Ip=null;this.xqj=ra;this.ga=Md;this.Ta=bf;Zg&&Zg.execute(gi=>{this.xUm(gi)})}get Wpf(){return"RenamedFileCheckerUsingTask"}xUm(I){this.Ip=I;this.Ip.zTb(Object(x.a)(this,this.cja,"handleVisibilityChange"))}cja(I,ra){!this.Sj||0!==ra.newState&&1!==ra.newState||this.Qpc||(this.hVf(),this.vDf(this.Qpc))}hVf(){this.Qpc=new gc.a(3,2,this.xqj(),Object(x.a)(this,this.vDf,"performRenameFileCheckTick"),89);this.Ta.ub(this.Qpc)}tLi(I){this.Ta.me(I)}pMg(I){this.Ip&&
2===this.Ip.pD?this.hWm(I):Q.AFrameworkApplication.oIa(Object(x.a)(this,this.J6b,"onRefreshFilenameSuccess"),Object(x.a)(this,this.NRd,"onRefreshFilenameFailure"),!0)}hWm(I){this.Ta.me(I);this.Qpc=null}J6b(I){I&&this.ndi(I.BreadcrumbFolderName,I.BreadcrumbFolderUrl,I.NewName,null)}BHh(){this.ga.processAction(Ya.a.fileNameUpdate,2)}NRd(){}}Object(f.a)(Mi,"RenamedFileCheckerUsingTask",Qj,[]);class rf{constructor(){this.qa=this.W=null}get name(){return"Common.App.RenameFile"}yb(I){this.W=I;this.qa=Q.AFrameworkApplication.K;
this.W.register(Ld,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Pc(()=>new Ld(Q.AFrameworkApplication.pa,this.W.te("Common.App.Rename.IRenameDialogFactory"))).singleInstance();this.W.register(oi,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Pc(()=>new oi(Q.AFrameworkApplication.pa)).singleInstance();this.W.register(1903,"Common.App.Rename.IRenamedFileChecker").Pc(()=>this.elk()).singleInstance();this.W.register(Nf,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Pc(()=>
new Nf(Q.AFrameworkApplication.pa)).singleInstance()}elk(){if(this.qa.$("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const I=this.W.ra("Common.IRefreshableAppSettings");if(I&&I.TVh)return new Jg(()=>I.vb("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>Q.AFrameworkApplication.Yr,()=>new Date,()=>Q.AFrameworkApplication.qo,I,this.W.ra("Common.ISessionStatus"),()=>rg.instance,this.W.za("Postmessage.IHostPostmessenger"))}return new Mi(()=>this.qa.vb("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>
this.qa.vb("RenamedFileCheckerPingIntervalInMs",12E4),()=>Q.AFrameworkApplication.Yr,()=>new Date,()=>Q.AFrameworkApplication.qo,Q.AFrameworkApplication.K,Q.AFrameworkApplication.pa,Q.AFrameworkApplication.Cb,this.W.ra("Common.ISessionStatus"),this.W.za("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.qa.Io(Object(x.a)(this,this.Mv,"onFullAppSettingsReady"))}Mv(){const I=Q.AFrameworkApplication.na.Ya.WG;Q.AFrameworkApplication.fKc()&&fh.instance.initialize(Q.AFrameworkApplication.wwd,
I?null:Q.AFrameworkApplication.lfh,I?null:Q.AFrameworkApplication.gsi||CommonUIStrings.l_RenameFileTooltip)&&(this.W.register(vj,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Pc(()=>new vj(()=>Q.AFrameworkApplication.s1f,()=>Q.AFrameworkApplication.zt,Q.AFrameworkApplication.cTc,Q.AFrameworkApplication.fKc,new Jb.a(()=>Q.AFrameworkApplication.qo))).singleInstance(),rg.instance.eb(),this.qa.$("RenameDialogIsEnabled")&&(this.W.resolve("Common.App.Rename.RenameDialogFactory").initialize(Q.AFrameworkApplication.Yr,
Q.AFrameworkApplication.wwd),this.W.resolve("Common.App.Rename.IRenameDialogActor").eb()),this.W.resolve("Common.App.Rename.IRenameFlyoutActor").eb(),Q.AFrameworkApplication.cTc&&this.W.resolve("Common.App.Rename.IRenamedFileChecker").enable())}dispose(){}}Object(f.a)(rf,"PackageManager",null,[1,2]);class ld{static get vf(){return hd.a.fy(ld.ll,CommonUIStrings.l_SaveACopyFileName)}}ld.ll="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(f.a)(ld,"FileNameDialogHtml",null,[]);class lg extends hd.a{constructor(I,ra,ab,Fb){super();this.v6c=this.xEa=null;this.ga=I;this.kma=ra;this.Nsc=ab;this.Nd(1,CommonUIStrings.l_SaveButtonLabel);this.vf=ld.vf;this.jf="FileNameDialog-SaveACopy";this.wl=Fb}Pxa(I,ra,ab){this.v6c=I;this.xEa=ab;I={["txtFileName"]:gb.a.rI(Q.AFrameworkApplication.Yr.Ry),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,ra)};this.Tg(CommonUIStrings.l_SaveToOneDrive,Object(x.a)(this,this.vwd,"fileNameDialogHandler"),
I);ha.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}vwd(I,ra){1!==I?ha.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(I=ra.txtFileName.trim(),ha.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),ra=gb.a.WIa(Q.AFrameworkApplication.fileName),I&&""!==I&&""!==ra&&(I+=ra),this.Nsc.lCa(this.v6c,this.xEa,I,this.wl))}}Object(f.a)(lg,"FileNameDialog",
hd.a,[1973]);class Cj{constructor(I,ra,ab){this.ga=I;this.kma=ra;this.Nsc=ab}create(I){return new lg(this.ga,this.kma,this.Nsc,I)}}Object(f.a)(Cj,"FileNameDialogFactory",null,[1946]);class Bm extends df.StandardDialog{constructor(I){super();this.yc=1;this.Nd(1,CommonUIStrings.l_RetryButtonLabel);this.Nd(0,CommonUIStrings.l_DialogClose);this.ga=I}cR(I){ha.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",I);this.Fw(I,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
Object(x.a)(this,this.DMf,"retryDialogHandler"))}DMf(I){1===I?(ha.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.ga.processAction(Ya.a.P9b,2)):ha.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(f.a)(Bm,"RetryDialog",df.StandardDialog,[1947]);var bi=b(213);class ml{constructor(I,ra,ab,Fb){this.Red=null;this.wtj=I;this.qa=ab;this.iyg=ra;this.rtg=new l.a;this.Zc=Fb}M3b(){return this.qa.$("SaveToCloudStorageUIIsEnabled")}fab(){return Ya.a.KNf}Xnd(){Sb.a.kSc(Object(x.a)(this,
this.hxi,"saveToCloudActionDispatcher"));Sb.a.KAc([new bi.a(Ya.a.KNf,vf.a.frame,0)],this.iyg.j_b())}eb(){const I=this.iyg.j_b();I?(I.MQ(()=>{this.rtg.Jf(!0)}),this.Xnd()):ha.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}Dni(){ha.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}hxi(I,ra,ab,Fb,ac){return ra.contextId!==vf.a.frame||I!==this.fab()?2:this.M3b()?1===ab?Fd.SessionStatusManager.instance.gi||Q.AFrameworkApplication.Aja?
8:32:2===ab?(this.Dni(),ac&&ac.FileDownloadUrl&&ha.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Zc&&(this.Red=this.Zc.Pe("DialogShown","SaveToOneDriveReponseTime")),this.rtg.task.continueWith(()=>{this.Red&&(this.Red.stop(),this.Red=null);this.wtj.start(ac)}),32):8:8}}Object(f.a)(ml,"SaveToCloudStorageActor",null,[1951]);class fg extends ml{constructor(I,ra,ab,Fb){super(I,ra,ab,Fb);this.cpj=ra}M3b(){return this.qa.$("SaveACopyBrsIsEnabled")}fab(){return Ya.a.P9b}Xnd(){Sb.a.kSc(Object(x.a)(this,
this.hxi,"saveToCloudActionDispatcher"));Sb.a.KAc([new bi.a(Ya.a.P9b,vf.a.frame,0)],this.cpj.j_b())}Dni(){ha.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(f.a)(fg,"SaveACopyActor",ml,[]);class Ej{}Ej.default=0;Object(f.a)(Ej,"SaveToCloudErrorCodes",null,[]);class ui{constructor(I,ra,ab,Fb,ac,Xc){this.wl=null;this.pvj=I;this.boa=ra;this.Nsc=ab;this.qa=Fb;this.E1c=ac;this.KE=Xc}start(I){this.wl=I;if("SharePointOnlineConsumer"===this.qa.Ga("FileSource")){const ra=
ia.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(ra){ra.start(null,I);return}}this.boa.nIc?(ha.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.q0j()):(ha.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.wsn())}wsn(){this.pvj.create().Pxa()}fo(){this.KE().cR(Ej.default)}q0j(){try{ha.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let I={["client_id"]:this.qa.appSettings.UploadToSkyDriveClientId,
["env"]:"INT"};if(1===this.E1c||2===this.E1c)I={["client_id"]:this.qa.appSettings.UploadToSkyDriveClientId};WL.init(I);ha.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(x.a)(this,this.onSuccess,"onSuccess"),Object(x.a)(this,this.onFailure,"onFailure"))}catch(I){ha.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",I,I.stack),this.fo()}}onSuccess(I){ha.ULS.sendTraceTag(6590592,
216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");I&&I.data&&I.data.folders&&this.Nsc.lCa(I.data.folders[0].id,I.data.folders[0].urls.viewInBrowser,null,this.wl)}onFailure(I){if(I&&I.error){if("user_canceled"===I.error.code){ha.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ha.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",I.error.code,I.error.message)}else ha.ULS.sendTraceTag(6590595,
216,50,"File Dialog returned with no response");this.fo()}}Object(f.a)(ui,"SaveToCloudManager",null,[1952]);class Xl extends ui{constructor(I,ra,ab,Fb,ac,Xc,Md){super(ra,ab,Fb,ac,Xc,Md);this.Udj=I}onSuccess(I){I&&I.data&&I.data.folders?(ha.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Udj.create(this.wl).Pxa(I.data.folders[0].id,I.data.folders[0].name,I.data.folders[0].urls.viewInBrowser)):(ha.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),
this.fo())}onFailure(I){I&&I.error&&"user_canceled"===I.error.code&&ha.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.onFailure(I)}fo(){ha.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.fo()}}Object(f.a)(Xl,"SaveACopyManager",ui,[]);var qf=b(176);class yk{constructor(I,ra,ab,Fb,ac){this.xEa=this.Ij=this.Tfc=null;this.vW=!1;this.wl=this.wSa=null;this.hFe=I;this.mRa=ra;this.KE=ab;this.gh=Fb;this.Zc=ac}i0a(){this.gh&&1===
this.gh.state||(this.Ij=this.mRa(),this.Ij.message=CommonUIStrings.l_CommentProgressTooltip,this.Ij.yc=5,this.Ij.Zr=!1,this.Ij.PK(CommonUIStrings.l_DefaultDialogTitle,null,null))}Yha(){this.Ij&&(this.Ij.close(),this.Ij=null)}t1(){1!==Q.AFrameworkApplication.na.state&&this.KE().cR(Ej.default)}GEb(){ha.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");la.a.Ql(this.xEa,la.a.bma(3),void 0,"UploadToCloudManager.RedirectToFolder")}FEb(I){let ra=!1,ab=!1;Q.AFrameworkApplication.K&&(ra=Q.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),
ab=Q.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ha.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",I,ra);if(ra&&ab){ha.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Fb={};Fb[Ye.a.G8b]="1";Fb[Ye.a.documentUrl]=I;Q.AFrameworkApplication.uO().execute(ac=>{ac.Qg(Ji.a.jvb,Fb)})}else la.a.Ql(I,la.a.bma(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}lCa(I,ra,ab=null,Fb=
null){ha.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Zc&&(this.wSa=this.Zc.Pe("DialogShown","SaveToOneDriveUploadTime"));this.i0a();this.xEa=ra;this.Tfc=this.hFe.create(I,ab,Fb);this.wl=Fb;this.fca()}fca(){ha.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.Tfc.execute(Object(x.a)(this,this.psm,"onSaveToCloudUploadFinished"),Object(x.a)(this,this.osm,"onSaveToCloudUploadFailed"))}psm(I){this.Yha();this.vW=!1;if(I&&I.data&&I.data.qd){var ra;if(({dv:ra}=va.d(I.data.qd)).returnValue)if(I=
ra,I.StatusCode!==qf.a.wA&&I.StatusCode!==qf.a.Gyc)ha.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.t1();else{ha.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{I.NewDocumentUrl&&""!==I.NewDocumentUrl?this.FEb(I.NewDocumentUrl):this.GEb()}catch(ab){ha.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",ab.toString())}this.NPc()}else ha.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",
{["ResponseData"]:xb.a.YYc(I.data.qd)}),this.t1()}else ha.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.t1()}osm(I){5!==I.data.status&&12!==I.data.status||this.vW?(ha.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",I.data.status),this.Yha(),this.t1(),this.NPc()):(ha.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.vW=!0,this.fca())}NPc(){this.wSa&&(this.wSa.stop(),this.wSa=null)}}
Object(f.a)(yk,"UploadToCloudManager",null,[1950]);class Qh extends yk{constructor(I,ra,ab,Fb,ac,Xc){super(ra,ab,Fb,ac,Xc);this.ga=I}Glf(){return!!this.wl&&!!this.wl.SaveEntryPoint&&"VersionHistory"===this.wl.SaveEntryPoint.toString()}t1(){ha.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.Glf()&&this.ga.hb(Ya.a.NYd,2,{["FailureReason"]:"Unknown"});super.t1()}GEb(){ha.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Glf()&&this.ga.processAction(Ya.a.xTc,
2);super.GEb()}FEb(I){ha.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",I);this.Glf()&&this.ga.processAction(Ya.a.xTc,2);super.FEb(I)}fca(){this.wl&&"true"===this.wl.SkipSaveToHost?super.fca():32!==this.ga.processAction(Ya.a.zFb,1)?(ha.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.fca()):this.ga.hb(Ya.a.zFb,2,[()=>{ha.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");
yk.prototype.fca.call(this)},()=>{ha.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.t1()}])}}Object(f.a)(Qh,"SaveACopyUploadToCloudManager",yk,[]);var rk=b(680),yf=b(1054);class Cl{constructor(){this.W=null}get name(){return"Common.App.SaveACopy"}init(){Q.AFrameworkApplication.K.Io(Object(x.a)(this,this.Mv,"onFullAppSettingsReady"))}Mv(){Q.AFrameworkApplication.K.$("SaveACopyBrsIsEnabled")&&this.W.resolve("Common.App.SaveACopy.SaveACopyActor").eb()}dispose(){}yb(I){this.W=
I;this.W.register(Qh,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Pc(()=>new Qh(Q.AFrameworkApplication.pa,I.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new yf.a).create(),()=>new Bm(Q.AFrameworkApplication.pa),Q.AFrameworkApplication.na,Q.AFrameworkApplication.na.Qo)).singleInstance();this.W.register(Cj,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Pc(()=>new Cj(Q.AFrameworkApplication.pa,Q.AFrameworkApplication.na.Ya,
I.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).singleInstance();this.W.register(fg,"Common.App.SaveACopy.SaveACopyActor").Pc(()=>new fg(I.resolve("Common.App.SaveACopy.SaveACopyManager"),I.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),Q.AFrameworkApplication.K,Q.AFrameworkApplication.na.Qo)).singleInstance();this.W.register(Xl,"Common.App.SaveACopy.SaveACopyManager").Pc(()=>new Xl(I.resolve("Common.App.SaveACopy.FileNameDialogFactory"),I.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),
rk.a.instance,I.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),Q.AFrameworkApplication.K,Q.AFrameworkApplication.kia,()=>new Bm(Q.AFrameworkApplication.pa))).singleInstance()}static main(){aa.a.instance.Lb(new Cl)}}Object(f.a)(Cl,"PackageManager",null,[1,2]);var bn=b(35);class Yl extends df.StandardDialog{constructor(I,ra){super();this.zPb=!1;this.qL=null;this.ga=I;this.Sic=ra;this.dCa=!1}cR(I,ra,ab){this.qL=ra;this.zPb=ab;ha.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
I,ab);I=this.rPe(I);0===I?(this.yc=6,this.Nd(0,CommonUIStrings.l_DialogClose)):(this.yc=0,this.Nd(1,CommonUIStrings.l_DialogClose));0===I&&ha.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Fw(bn.a.Q6m,this.XYk(I),this.WYk(I,ra),Object(x.a)(this,this.DMf,"retryDialogHandler"),!0)}DMf(I){1===I?(ha.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.qL?this.ga.hb(Ya.a.nUc,2,[this.qL,this.zPb]):this.ga.processAction(Ya.a.nUc,2)):ha.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")}rPe(I){return 0>I||6<I?(ha.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",I),0):I}WYk(I,ra){I=this.rPe(I);return this.Sic?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ra),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][I]:[CommonUIStrings.l_FailToSaveFile,
CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ra),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][I]}XYk(I){I=this.rPe(I);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][I]}}
Object(f.a)(Yl,"ErrorRetryDialog",df.StandardDialog,[1976]);class rj{constructor(I,ra){this.qa=I;this.ga=ra;this.Sic=this.qa.$("SaveToHostWithExtraCharsInFileName")}create(){return new Yl(this.ga,this.Sic)}}Object(f.a)(rj,"ErrorRetryDialogFactory",null,[1953]);class Ci extends hd.a{constructor(I,ra,ab,Fb,ac,Xc,Md=null){super();this.u2=null;this.ga=ra;this.kma=Fb;this.xSa=Xc;this.qa=I;this.KE=ac;this.gh=ab;this.Sic=this.qa.$("SaveToHostWithExtraCharsInFileName");this.wl=Md;this.Nd(1,CommonUIStrings.l_SaveButtonLabel)}get na(){return this.gh}Ydh(I,
ra){this.tea(1,!!I&&I!==ra);this.u2=document.getElementById(Ci.Zkh);L.a.addHandler(this.u2,"change",Object(x.a)(this,this.UQd,"onFileNameChange"));L.a.addHandler(this.u2,"input",Object(x.a)(this,this.UQd,"onFileNameChange"));this.u2.focus()}Ykh(I){return this.Sic?(new RegExp("["+this.Nih('\\/:*?"<>|')+"]")).test(I):(new RegExp("["+this.Nih('\\/:*?"<>|#{}%~&')+"]")).test(I)}Nih(I){return I.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}scf(){const I=gb.a.rI(Q.AFrameworkApplication.Yr.Ry);this.tea(1,
!!this.u2&&""!==this.u2.value&&this.u2.value!==I)}UQd(){this.u2&&window.setTimeout(()=>{this.scf()},0)}vwd(I,ra){if(1!==I)ha.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{I=ra[Ci.Zkh];ra=Ci.lfi in ra?ra[Ci.lfi]:!1;ha.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",gb.a.eoi(I),ra);const ab=gb.a.WIa(Q.AFrameworkApplication.fileName);(I=I?I.trim():null)&&""!==I&&""!==ab||1===this.na.state?
this.Ykh(I)?this.KE.create().cR(1,I,ra):this.xSa.lCa(I+ab,ra,this.wl):this.KE.create().cR(2,I,ra)}}dispose(){this.u2&&(L.a.removeHandler(this.u2,"change",Object(x.a)(this,this.UQd,"onFileNameChange")),L.a.removeHandler(this.u2,"input",Object(x.a)(this,this.UQd,"onFileNameChange")),this.u2=null);super.dispose()}}Ci.Zkh="txtFileName";Ci.lfi="chkOverwrite";Object(f.a)(Ci,"FileNameDialogBase",hd.a,[]);class wj{static get vf(){return hd.a.fy(wj.ll,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
wj.ll="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(f.a)(wj,"FileNameDialogHtml",null,[]);class Fj extends Ci{constructor(I,ra,ab,Fb,ac,Xc){super(I,ra,ab,Fb,ac,Xc);this.vf=wj.vf;this.jf="FileNameDialog-SaveAsToHost"}Pxa(I,ra){const ab=gb.a.rI(Q.AFrameworkApplication.Yr.Ry);ra={["txtFileName"]:I||ab,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:ra};this.Tg(CommonUIStrings.L_SaveAs,Object(x.a)(this,this.vwd,"fileNameDialogHandler"),ra);this.Ydh(I,ab)}}Object(f.a)(Fj,"FileNameDialog",Ci,[1977]);class sk{constructor(I,ra,
ab,Fb,ac,Xc){this.ga=ra;this.qa=I;this.kma=Fb;this.xSa=Xc;this.KE=ac;this.gh=ab}create(){return new Fj(this.qa,this.ga,this.gh,this.kma,this.KE,this.xSa)}}Object(f.a)(sk,"FileNameDialogFactory",null,[1954]);class xn{constructor(I,ra,ab){this.xSa=ab;this.Fie=ra;this.qa=I}eb(){2===Q.AFrameworkApplication.na.Ya.Rm?Q.AFrameworkApplication.pa.Aa(Ya.a.nUc,vf.a.frame,Object(x.a)(this,this.Qwi,"saveAsToHostActionDispatcher"),4):Q.AFrameworkApplication.pa.ka(Ya.a.nUc,vf.a.frame,Object(x.a)(this,this.Qwi,"saveAsToHostActionDispatcher"))}Qwi(I,
ra,ab,Fb,ac){return ra.contextId!==vf.a.frame||I!==Ya.a.nUc?2:this.qa.$("SaveAsToHostBrsIsEnabled")?1===ab?Fd.SessionStatusManager.instance.gi||Q.AFrameworkApplication.Aja?8:32:2===ab?(ha.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),I=this.Fie.create(),ac&&Object.getType(ac)===Array&&2===ac.length?I.Pxa(ac[0],!!ac[1]):I.Pxa(null,!1),32):8:8}}Object(f.a)(xn,"SaveAsToHostActor",null,[]);class yn{constructor(I,ra,ab,Fb,ac,Xc,Md,bf){this.Ij=null;this.zPb=
this.vW=!1;this.wSa=this.wl=this.qL=null;this.qa=ra;this.d3=this.qa.appSettings.SaveAsToHostWebServiceBase;this.Tng=Fb;this.mRa=ac;this.Qe=ab;this.KE=Xc;this.Zc=bf;this.gh=Md;this.ga=I;this.VPa=ra.Ga("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}i0a(){1!==this.gh.state&&(this.Ij=this.mRa(),this.Ij.message=CommonUIStrings.l_CommentProgressTooltip,this.Ij.yc=5,this.Ij.Zr=!1,this.Ij.PK(CommonUIStrings.l_DefaultDialogTitle,null,null))}t1(I=0){1!==this.gh.state&&this.KE.create().cR(I,gb.a.rI(this.qL),
this.zPb)}GEb(){const I=this.qa.appSettings.BreadcrumbFolderUrl;ha.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");la.a.Ql(I,la.a.bma(3),void 0,"UploadToHostManager.RedirectToFolder")}FEb(I){let ra=!1,ab=!1;this.qa&&(ra=this.qa.$("SaveACopyIsEnabledForUiHost"),ab=this.qa.$("UiHostSupportsDocRebootFeatures"));ha.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",I,ra,ab);if(ra&&ab){ha.ULS.sendTraceTag(51245197,
216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Fb={};Fb[Ye.a.G8b]="1";Fb[Ye.a.documentUrl]=I;Fb[Ye.a.reason]=ah.a.CNf;Q.AFrameworkApplication.uO().execute(ac=>{ac.Qg(Ji.a.jvb,Fb)})}else ra&&!ab&&Q.AFrameworkApplication.kKa?la.a.Ql(I,la.a.bma(4),void 0,"UploadToHostManager.RedirectToEditUrl"):la.a.Ql(I,la.a.bma(3),void 0,"UploadToHostManager.RedirectToEditUrl")}lCa(I,ra,ab=null){ha.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.Tng&&!this.Tng()&&
this.Qe&&(this.Zc&&(this.wSa=this.Zc.Pe("DialogShown","SaveAsToHostUploadTime")),this.i0a(),this.zPb=ra,this.qL=I,(this.wl=ab)&&"true"===this.wl.SkipSaveToHost?this.Gvd():this.fca())}fca(){32!==this.ga.processAction(Ya.a.zFb,1)?(ha.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.Gvd()):this.ga.hb(Ya.a.zFb,2,[()=>{ha.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.Gvd()},(I,ra)=>{ha.ULS.sendTraceTag(18989380,
219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.t1(ra)}])}qum(I){this.Yha();this.vW=!1;if(I&&I.data&&I.data.qd)if(({dv:ra}=va.d(I.data.qd)).returnValue)if(I=ra,I.StatusCode!==qf.a.wA&&I.StatusCode!==qf.a.Gyc){ha.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var ra={};ra.FailureReason=I.StatusCode.toString();ra.ExtraInfo=I.ExtraInfo;this.zMa(ra);this.t1(parseInt(I.ExtraInfo))}else{ha.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.CLf();try{I.NewDocumentUrl&&""!==I.NewDocumentUrl?this.FEb(I.NewDocumentUrl):this.GEb()}catch(ab){ha.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",ab.toString())}this.NPc()}else ha.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:xb.a.YYc(I.data.qd)}),this.zMa({["FailureReason"]:"Failed to deserialize response"}),this.t1();else ha.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.zMa({["FailureReason"]:"null response"}),this.t1()}pum(I){5!==I.data.status&&12!==I.data.status||this.vW?(ha.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:I.data.status,["HttpStatus"]:I.data.we}),this.zMa({["FailureReason"]:I.data.we.toString()}),this.Yha(),this.t1(),this.NPc()):(ha.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.vW=!0,this.wl&&"true"===this.wl.SkipSaveToHost?this.Gvd():this.fca())}Yha(){this.Ij&&
(this.Ij.close(),this.Ij=null)}NPc(){this.wSa&&(this.wSa.stop(),this.wSa=null)}CLf(){this.wl&&"VersionHistory"===this.wl.SaveEntryPoint&&this.ga.processAction(Ya.a.xTc,2)}zMa(I){this.wl&&"VersionHistory"===this.wl.SaveEntryPoint&&this.ga.hb(Ya.a.NYd,2,I)}Gvd(){let I=this.d3+this.VPa;I=vb.a.oo(I,"qs",gb.a.ui(Q.AFrameworkApplication.kl));I=vb.a.oo(I,"n",gb.a.ui((new Date).getTime().toString()));I=vb.a.oo(I,"ov",gb.a.ui(this.zPb.toString()));I=vb.a.oo(I,"fn",gb.a.ui(this.qL));this.wl&&this.wl.FileDownloadUrl&&
(I=vb.a.oo(I,"furl",gb.a.ui(this.wl.FileDownloadUrl)));this.Qe.ai(I,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(x.a)(this,this.qum,"onUploadFinished"),Object(x.a)(this,this.pum,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(f.a)(yn,"UploadToHostManager",null,[1901]);class yh{constructor(){this.W=null}get name(){return"Common.App.SaveAsToHost"}init(){Q.AFrameworkApplication.K.Io(Object(x.a)(this,this.Mv,"onFullAppSettingsReady"))}Mv(){Q.AFrameworkApplication.K.$("SaveAsToHostBrsIsEnabled")&&
this.W.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").eb()}yb(I){this.W=I;this.W.register(rj,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Pc(()=>new rj(Q.AFrameworkApplication.K,Q.AFrameworkApplication.pa)).singleInstance();this.W.register(yn,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Pc(()=>new yn(Q.AFrameworkApplication.pa,Q.AFrameworkApplication.K,Q.AFrameworkApplication.fe,
()=>Q.AFrameworkApplication.Qj,()=>(new yf.a).create(),I.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Q.AFrameworkApplication.na,Q.AFrameworkApplication.na.Qo)).singleInstance();this.W.register(sk,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Pc(()=>new sk(Q.AFrameworkApplication.K,Q.AFrameworkApplication.pa,Q.AFrameworkApplication.na,Q.AFrameworkApplication.na.Ya,I.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),I.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance();
this.W.register(xn,"Common.App.SaveAsToHost.SaveAsToHostActor").Pc(()=>new xn(Q.AFrameworkApplication.K,I.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),I.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).singleInstance()}dispose(){}static main(){aa.a.instance.Lb(new yh)}}Object(f.a)(yh,"SaveAsToHostPackage",null,[1,2]);class Sm extends df.StandardDialog{constructor(){super();this.yc=0;this.Nd(1,CommonUIStrings.l_DialogClose)}cR(I){this.Fw(I,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(f.a)(Sm,"ErrorDialog",df.StandardDialog,[1947]);var vi=b(190);class aj extends df.StandardDialog{constructor(I,ra,ab){super();this.ga=I;this.boa=ra;this.kma=ab;this.q6=!1;this.yc=1;this.yY(1);this.Nd(1,CommonUIStrings.l_SignIn);this.Nd(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}Pxa(){this.boa.oPg(Object(x.a)(this,this.kdi,"onSignIn"));this.mv(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(x.a)(this,this.lCl,"inputHandler"))}lCl(I){0===
I?(ha.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.hUd()}v3j(){let I="2";if(this.kma)switch(this.kma.Rm){case 3:I="0";break;case 2:I="3";break;case 1:I="1"}return I}hide(){this.boa.PXm(Object(x.a)(this,this.kdi,"onSignIn"));super.hide()}hUd(){const I=new vi.QueryStringBuilder("Signin.aspx");I.Hd("prompt","1");I.Hd("cbcxt",this.v3j());Q.AFrameworkApplication.Aoa(I);la.a.Ql(I.toString(),"LoginWindow",void 0,"SignInDialog")}kdi(){this.bAa&&this.hide();ha.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.ga.processAction(Ya.a.KNf,2)}}Object(f.a)(aj,"SignInDialog",df.StandardDialog,[1975]);class bg{constructor(I,ra,ab){this.ga=I;this.boa=ra;this.kma=ab}create(){return new aj(this.ga,this.boa,this.kma)}}Object(f.a)(bg,"SignInDialogFactory",null,[1949]);class zh{constructor(I,ra,ab,Fb,ac,Xc,Md){this.d3=I;this.qL=ra;this.IMb=ab;this.v6c=Fb;this.pxe=ac;this.VPa=Xc;this.wl=Md}execute(I,ra){if(!Q.AFrameworkApplication.Qj&&
Q.AFrameworkApplication.fe){var ab=this.d3+this.VPa;ab=vb.a.oo(ab,"fo",gb.a.ui(this.v6c));ab=vb.a.oo(ab,"fn",gb.a.ui(this.qL));ab=vb.a.oo(ab,"qs",gb.a.ui(this.pxe));ab=vb.a.oo(ab,"n",gb.a.ui((new Date).getTime().toString()));this.wl&&this.wl.FileDownloadUrl&&(ab=vb.a.oo(ab,"furl",gb.a.ui(this.wl.FileDownloadUrl)));this.IMb&&(ab=vb.a.oo(ab,"fnn",gb.a.ui(this.IMb)));Q.AFrameworkApplication.fe.ai(ab,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,I,ra,null)}}}Object(f.a)(zh,"SkyDriveUploadCaller",
null,[1974]);class Gi{constructor(I){this.qa=I;this.trb=I.appSettings.SkyDriveUploadWebServiceBase;this.qL=I.appSettings.FileName;this.VPa=I.Ga("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(I,ra,ab){return new zh(this.trb,this.qL,ra,I,Q.AFrameworkApplication.kl,this.VPa,ab)}}Object(f.a)(Gi,"SkydriveUploadCallerFactory",null,[1948]);class gh{constructor(){this.W=null}get name(){return"Common.App.SaveToCloudStorage"}init(){Q.AFrameworkApplication.K.$("SaveToCloudStorageUIIsEnabled")&&
this.W.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").eb()}dispose(){}yb(I){this.W=I;this.W.register(bg,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Pc(()=>new bg(Q.AFrameworkApplication.pa,rk.a.instance,Q.AFrameworkApplication.na.Ya)).singleInstance();this.W.register(Gi,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Pc(()=>new Gi(Q.AFrameworkApplication.K)).singleInstance();
this.W.register(ml,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Pc(()=>new ml(I.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),I.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),Q.AFrameworkApplication.K,Q.AFrameworkApplication.na.Qo)).singleInstance();this.W.register(yk,"Common.App.SaveToCloudStorage.UploadToCloudManager").Pc(()=>new yk(I.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new yf.a).create(),()=>new Sm,Q.AFrameworkApplication.na,
Q.AFrameworkApplication.na.Qo)).singleInstance();this.W.register(ui,"Common.App.SaveToCloudStorage.SaveToCloudManager").Pc(()=>new ui(I.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),rk.a.instance,I.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),Q.AFrameworkApplication.K,Q.AFrameworkApplication.kia,()=>new Sm)).singleInstance()}static main(){aa.a.instance.Lb(new gh)}}Object(f.a)(gh,"PackageManager",null,[1,2]);class Zi extends df.StandardDialog{constructor(){super();this.yc=
0;this.Nd(1,CommonUIStrings.l_DialogClose)}cR(I,ra){this.peh(I,ra,bn.a.S6m)}peh(I,ra,ab){ha.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",ab);this.Fw(ab,I,ra,null)}zYe(I,ra){ha.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Fw(bn.a.U6m,I,ra,null,!0)}}Object(f.a)(Zi,"ErrorDialog",df.StandardDialog,[932]);class sm{static get vf(){return hd.a.fy(sm.ll,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,
"")}}sm.ll="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(f.a)(sm,"FileNameDialogHtml",null,[]);var cf=b(67);class Pk extends Ci{constructor(I,ra,ab,Fb,ac,Xc,Md,bf){super(I,ra,ab,Fb,ac,Xc,bf);this.I4a=this.xze=this.wN=null;this.oZj=CommonUIStrings.l_SaveToAnotherFolder;this.vf=sm.vf;this.jf="FileNameDialog-SaveToSharePoint";this.Dqc=Md;this.opj=bf}Pxa(I){const ra=gb.a.rI(Q.AFrameworkApplication.Yr.Ry),ab=Q.AFrameworkApplication.breadcrumbFolderName,Fb=Q.AFrameworkApplication.breadcrumbBrandName,ac={["txtFileName"]:I||ra};let Xc=CommonUIStrings.L_SaveAs;
2===Q.AFrameworkApplication.na.Ya.Rm&&(Xc=CommonUIStrings.L_SaveACopy);this.Tg(Xc,Object(x.a)(this,this.vwd,"fileNameDialogHandler"),ac);this.Ydh(I,ra);this.wXe.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");Q.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost")||(this.wN=document.getElementById("anotherFolder"),I=document.getElementById("folderLocation"),this.xze=ef.a.fmd(I,this.wN,"anotherFolderDescribedBy",""),
this.wN.className="WACButton WACDialogButtonNormal",I=!1,ab&&ab.length?(this.hNg(this.wN,this.xze,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Fb,ab)),I=this.bCj(Fb,ab)):this.hNg(this.wN,this.xze,CommonUIStrings.l_CurrentOnlineFolder),this.NDj(this.wN),this.dCj(this.wN),I?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.wN,"SaveToAnotherLocationTwo"),ha.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):
Sys.UI.DomElement.addCssClass(this.wN,"SaveToAnotherLocationOne"),L.a.addHandler(this.wN,F.a.click,Object(x.a)(this,this.tAf,"onSaveToAnotherLocationClick")),L.a.addHandler(this.wN,F.a.ah,Object(x.a)(this,this.Rci,"onSaveToAnotherLocationKeyDown")))}bCj(I,ra){let ab;ab=!1;const Fb=document.getElementById("currentLocation");Fb.innerText="";const ac=this.wyh(Fb,I),Xc=this.wyh(Fb,ra);let Md=255,bf=255;255<ac+Xc&&(Md=Math.max(238,408-ac),bf=Math.max(170,408-Xc),ab=!0);this.SFj(Fb,I,bf,ra,Md);return ab}wyh(I,
ra){const ab=document.createElement("div");ab.innerText=ra;ab.style.visibility="hidden";I.appendChild(ab);ra=ab.clientWidth;I.removeChild(ab);return ra}SFj(I,ra,ab,Fb,ac){ra&&(this.gNg(I,ra,ab),this.KFj(I));Fb&&this.gNg(I,Fb,ac)}gNg(I,ra,ab){const Fb=document.createElement("div");Fb.innerText=ra;Fb.title=ra;Fb.className="SaveToAnotherFolderBreadcrumb";Fb.style.maxWidth=ab.toString()+"px";I.appendChild(Fb)}KFj(I){const ra=document.createElement("span");ra.id="FolderSeparator";const ab=document.createElementNS("http://www.w3.org/2000/svg",
"svg");ab.setAttribute("class","SeparatorCaret");const Fb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Fb.setAttribute("points","1 4 1 11 5 7.5");ab.appendChild(Fb);ra.appendChild(ab);I.appendChild(ra)}hNg(I,ra,ab){ab=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,ab);ra&&(ra.innerText=ab);I.tabIndex=0;I.setAttribute(ef.a.tg,ef.a.v_)}dCj(I){const ra=document.createElement("span");ra.id="anotherFolderText";ra.innerText=this.oZj;ra.className="AnotherFolderTextSpan";
I.appendChild(ra)}NDj(I){const ra=document.createElement("span");ra.className="cui-img-cont-float cui-img-16by16 ";this.I4a=document.createElementNS("http://www.w3.org/2000/svg","svg");this.I4a.setAttribute("class","FolderIconSVG");const ab=document.createElementNS("http://www.w3.org/2000/svg","path");ab.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.I4a.appendChild(ab);ra.appendChild(this.I4a);I.appendChild(ra)}Rci(I){!I||
I.keyCode!==cf.a.Nq&&I.keyCode!==cf.a.s_c||this.tAf(I)}tAf(){if(this.u2){const I=gb.a.WIa(Q.AFrameworkApplication.fileName);let ra=this.u2.value;this.hide();ra&&""!==ra&&""!==I||1===this.na.state?(""!==I&&(ra+=I),this.Ykh(ra)?this.KE.create().cR(1,ra,!1):this.Dqc.start(ra,this.opj)):this.KE.create().cR(2,ra,!1)}}b3j(I){this.wN&&this.I4a&&(I?(this.wN.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.wN,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.I4a,"DisabledFolderIconSVG")):(this.wN.tabIndex=
-1,Sys.UI.DomElement.containsCssClass(this.wN,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.I4a,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.wN,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.I4a,"DisabledFolderIconSVG"))))}scf(){super.scf();this.b3j(!!this.u2&&""!==this.u2.value)}dispose(){this.wN&&(L.a.removeHandler(this.wN,F.a.click,Object(x.a)(this,this.tAf,"onSaveToAnotherLocationClick")),L.a.removeHandler(this.wN,F.a.ah,Object(x.a)(this,this.Rci,
"onSaveToAnotherLocationKeyDown")),this.wN=null);super.dispose()}}Object(f.a)(Pk,"FileNameDialog",Ci,[1034]);var Id=b(502),rd=b(350),ge=b(1364),Me=b(1514);class me{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(f.a)(me,"SaveAsDialogInput",null,[]);class nl{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(f.a)(nl,"SaveLocation",null,[]);var zn=b(295);class oe{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,Hf){this.Vqe=
null;this.qL="";this.Dqc=I;this.KE=ra;this.wl=Hf;this.xSa=ab;this.gh=ac;this.nJ=Fb;this.hrb=Md;this.dRb=bf;Xc&&(this.Vqe=new Jb.a(()=>new ge.a(Xc.value,null)))}NXk(){const I=new Id.a(rd.a.yi());I.Z("type","currentHost");return Object.assign(new nl,{folderName:this.nJ.breadcrumbFolderName,friendlyPath:this.nJ.breadcrumbBrandName,properties:I})}pSl(I){return!!I&&"ClassicMru"===I.type&&!!I.service_info&&!!I.service_info.service_id&&-1!==I.service_info.service_id.indexOf("SHAREPOINT")}Qfl(){if(!this.Vqe||
!this.hrb)return null;var I=this.Vqe.value.jj("SaveAsToSharePointDialog",!1);if(!I||3!==I.state||!I.G6h)return null;I=I.G6h;const ra=new sa.a;let ab=0,Fb=0;for(var ac=0;ac<I.length;ac++){var Xc=I[ac];if(!this.pSl(Xc))continue;ab++;if(!Xc.sharepoint_info)continue;const Md=Xc.url,bf=Xc.sharepoint_info.site_url,Hf=Xc.title;Xc=Me.b(Xc,Q.AFrameworkApplication.isRtl);if(!(Md&&bf&&Hf&&Xc))continue;Fb++;const Zg=new Id.a(rd.a.yi());Zg.Z("type","SharePoint");Zg.Z("siteUrl",bf);Zg.Z("folderUrl",Md);Fb++;ra.add(Object.assign(new nl,
{folderName:Hf,friendlyPath:Xc,properties:Zg}))}ac=new Map;ac.set("NumPlaces",I.length.toString());ac.set("NumSharepointPlaces",ab.toString());ac.set("placesWithMetadata",Fb.toString());pa.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",ac);0<ab&&(Fb?.5>1*Fb/ab&&pa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):pa.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return ra}VYk(){const I=
new sa.a;I.add(this.NXk());const ra=this.Qfl();ra&&I.addRange(ra);return Object.assign(new me,{enableMoreLocations:!Q.AFrameworkApplication.K.$("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.qL,extension:gb.a.WIa(this.nJ.Ry),saveLocations:I.toArray(),scenario:"SaveToSharePoint"})}UYk(){const I=Object(x.a)(this,this.VYk,"getDialogInput"),ra={};ra.inputPropsCallback=I;return ra}Pxa(I){this.qL=I;this.qL||(this.qL=String.format(CommonUIStrings.l_SaveACopy_Filename,gb.a.rI(this.nJ.Ry)));I={["id"]:"SaveAsDialog",
["bodyControls"]:this.UYk()};let ra=CommonUIStrings.L_SaveAs;2===this.gh.Ya.Rm&&(ra=CommonUIStrings.L_SaveACopy);const ab=new hd.a(!1,!1,!0);ab.yc=1;ab.jf="SaveAsDialog";ab.Nd(1,CommonUIStrings.l_SaveButtonLabel);ab.Tg(ra,Object(x.a)(this,this.O6m,"saveAsDialogHandler"),I)}Lrn(I,ra){I&&""!==I&&""!==ra||1===this.gh.state?this.oSl()?this.K_l(I,ra):(""!==ra&&(I+=ra),this.Dqc.start(I,this.wl)):(ha.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.KE.create().cR(2,
I,!1))}K_l(I,ra){pa.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const ab=this.dRb.STe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.dRb.z7e(ab).then(Fb=>{if(Fb&&0<Fb.length){const ac=Fb[0][Ye.a.RAm];Fb=Fb[0][Ye.a.SAm];if(""!==ac&&""!==Fb)this.hrb.lCa(Fb,I+ra,ac,this.wl),pa.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.KE.create().cR(0,I,!1);const Xc=re.a.AD();Xc&&(Xc.set("SiteUrlAvailable",
""===ac?"false":"true"),Xc.set("FolderUrlAvailable",""===Fb?"false":"true"));pa.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new zn.a,{extendedProperties:Xc}))}}else this.KE.create().cR(0,I,!1),pa.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Fb=>{"Canceled"===Fb?((Fb=re.a.AD())&&Fb.set("IsCanceled","true"),pa.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new zn.a,{extendedProperties:Fb}))):
pa.Health.instance.recordKpiFailure("SaveACopySFP",Fb,!1,!1,null)})}oSl(){return this.dRb?this.dRb.Slf():(ha.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}O6m(I,ra){if(ra&&1===I){I=ra.fileName;var ab=gb.a.WIa(this.nJ.Ry);ra.moreLocationsSelected&&this.Lrn(I,ab);if(ra.locationCallback){var Fb=ra.locationCallback();Fb?Fb.properties&&"currentHost"===Fb.properties.J("type")?this.xSa.lCa(I+ab,!1,this.wl):Fb.properties&&"SharePoint"===Fb.properties.J("type")?(ra=Fb.properties.J("siteUrl"),
Fb=Fb.properties.J("folderUrl"),this.hrb.lCa(Fb,I+ab,ra,this.wl)):ha.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ha.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ha.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(f.a)(oe,"ReactSaveAsDialog",null,[1034]);class th{constructor(I,ra,ab,Fb,ac,Xc,Md,bf=null,Hf=null,Zg=null){this.ga=ra;this.qa=I;this.kma=Fb;this.xSa=Xc;this.KE=ac;this.gh=ab;this.ZDg=Md;this.flj=bf;this.hrb=Hf;this.dRb=
Zg}create(I){return this.gh&&this.gh.Ya.fA?new oe(this.ZDg,this.KE,this.xSa,Q.AFrameworkApplication.Yr,this.gh,this.flj,this.hrb,this.dRb,I):new Pk(this.qa,this.ga,this.gh,this.kma,this.KE,this.xSa,this.ZDg,I)}}Object(f.a)(th,"FileNameDialogFactory",null,[1012]);class oj{constructor(I,ra,ab,Fb){this.Iu=this.moc=null;this.$lb=I;this.gh=ab;this.wqj=Fb;this.TPa=new Jb.a(()=>new ge.a(ra.value,Object(x.a)(this,this.oxb,"getMoreInfoEventReceived")))}get gei(){this.moc||(this.TPa.value.jj("Save As",!0),
this.Iu&&this.Iu.K9&&this.Iu.K9.length&&(this.moc=this.o9k(this.Iu.K9)));return this.moc}start(I){if(!this.gei)if(Q.AFrameworkApplication.breadcrumbFolderUrl&&Q.AFrameworkApplication.breadcrumbFolderUrl.length)this.moc=Q.AFrameworkApplication.breadcrumbFolderUrl;else return ha.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Iu),!1;const ra=this.wqj();ra.Yrn();const ab=ra.Pal();
if(!ab)return ha.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.$lb.start((Fb,ac)=>{ra.hide();I(Fb,ac)},()=>{this.GCb(ra)},ab,this.moc);return!0}GCb(I){I.hide();ha.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}o9k(I){I=I.toLowerCase();I.endsWith("/")||(I+="/");const ra=I.indexOf("/documents/");return-1!==ra?I.substring(0,ra+1)+"_layouts/15/onedrive.aspx":""}oxb(I){this.Iu||3!==I.state||(this.Iu=I)}}Object(f.a)(oj,"OneDriveFilePickerHelper",
null,[1011]);class nf extends hd.a{constructor(){super()}Yrn(){this.HLb="FilePickerDialog";this.vf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.jf="PickerDialog-MsoSp";this.showDialog("",null)}Pal(){return document.getElementById("FilePickerDiv")}wS(){}Mka(){}}Object(f.a)(nf,"PickerDialog",hd.a,[1010]);class Ni{constructor(I,ra,ab,Fb,ac,Xc,Md){this.qa=I;this.Fie=ab;this.ga=ra;this.Dqc=Fb;this.$lb=ac;this.loc=Xc;this.W9i=Md}eb(){const I=this.$lb.j_b();I?Ga.a.dA||this.qa.$("SaveToSharePointOnDemandDownloadJsIsEnabled")?
this.ga.Aa(Ya.a.R9b,vf.a.frame,Object(x.a)(this,this.kxi,"saveToSharePointActionDispatcher"),64):(I.Odb.continueWith(ra=>{ra.Gh&&this.$lb.kzf(ra)}),this.Xnd()):ha.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}Xnd(){Sb.a.kSc(Object(x.a)(this,this.kxi,"saveToSharePointActionDispatcher"));Sb.a.KAc([new bi.a(Ya.a.R9b,vf.a.frame,0)],this.$lb.j_b())}get M3b(){return this.qa.$("SaveToAnotherFolderBrsIsEnabled")}get z_g(){return this.qa.$("UserCanWriteRelative")}kxi(I,
ra,ab,Fb,ac){return ra.contextId!==vf.a.frame||I!==Ya.a.R9b?2:this.M3b&&(this.loc.gei||this.z_g)?1===ab?Fd.SessionStatusManager.instance.gi||Q.AFrameworkApplication.Aja?8:this.W9i()?32:8:2===ab?(ha.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(ac&&ac.SaveEntryPoint&&"VersionHistory"===ac.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.z_g?(ha.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.Fie.create(ac).Pxa(null)):(ha.ULS.sendTraceTag(24524225,
216,50,"No permission save to current folder, show Picker to save to another folder."),this.Dqc.start(null,ac)),32):8:8}}Object(f.a)(Ni,"SaveToSharePointActor",null,[]);class tg{constructor(I,ra,ab,Fb){this.wl=this.awg=null;this.hrb=I;this.KE=ra;this.loc=ab;this.gh=Fb}start(I,ra){ha.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.awg=I;this.wl=ra;this.loc.start((ab,Fb)=>{this.IFf(ab,Fb)})||this.BTf()}IFf(I,ra){if(I)this.onSuccess(ra);else this.onFailure(ra)}BTf(){1!==this.gh.state&&this.KE().zYe(CommonUIStrings.l_DefaultDialogTitle,
CommonUIStrings.l_OneDriveContactError)}onSuccess(I){ha.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(I&&I.data&&I.data.value&&I.data.value.length&&I.data.value[0].sharePoint){const ra=I.data.value[0].sharePoint.url;I=I.data.value[0].sharePoint.listUrl;let ab=null;if(ra&&(ab=I?this.igl(I):this.hgl(ra))){this.hrb.lCa(ra,this.awg,ab,this.wl);return}ha.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",
!ra,!ab)}ha.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.BTf()}hgl(I){I.endsWith("/")||(I+="/");let ra=0;for(let ab=0;ab<I.length;ab++)if("/"===I.charAt(ab)&&5===++ra)return I.substr(0,ab);return null}igl(I){I.endsWith("/")&&(I=I.substring(0,I.length-1));const ra=I.lastIndexOf("/");return-1!==ra?I.substring(0,ra):null}onFailure(I){ha.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");I&&I.error?ha.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",
I.error.errorCode,I.error.message):ha.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.BTf()}}Object(f.a)(tg,"SaveToSharePointManager",null,[1956]);class Ih{constructor(I,ra,ab,Fb,ac,Xc,Md,bf){this.d3=I;this.qL=ra;this.IMb=Fb;this.pxe=Xc;this.xEa=ab;this.Cvj=ac;this.VPa=Md;this.wl=bf}execute(I,ra){if(!Q.AFrameworkApplication.Qj&&Q.AFrameworkApplication.fe){var ab=this.d3+this.VPa;ab=vb.a.oo(ab,"fu",gb.a.ui(this.xEa));ab=vb.a.oo(ab,"su",gb.a.ui(this.Cvj));ab=vb.a.oo(ab,"fn",
gb.a.ui(this.qL));ab=vb.a.oo(ab,"n",gb.a.ui((new Date).getTime().toString()));this.wl&&this.wl.FileDownloadUrl&&(ab=vb.a.oo(ab,"furl",gb.a.ui(this.wl.FileDownloadUrl)));ab=ab+"&"+this.pxe;this.IMb&&this.IMb.length?ab=vb.a.oo(ab,"fnn",gb.a.ui(this.IMb)):ha.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ha.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");Q.AFrameworkApplication.fe.ai(ab,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,
2,I,ra,null,void 0,void 0,void 0,void 0,"9")}}}Object(f.a)(Ih,"SharePointSaveAsCaller",null,[1980]);class Ri{constructor(I){this.trb=I.appSettings.SaveAsToHostWebServiceBase;this.qL=I.appSettings.FileName;this.VPa=I.Ga("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(I,ra,ab,Fb){return new Ih(this.trb,this.qL,I,ra,ab,Q.AFrameworkApplication.kl,this.VPa,Fb)}}Object(f.a)(Ri,"SharePointUploadCallerFactory",null,[1957]);var wi=b(1391);class Ne{constructor(I,ra,ab,Fb,ac){this.Ij=this.Tfc=
null;this.Pae=!1;this.rze=this.xEa=null;this.hFe=ra;this.mRa=ab;this.KE=Fb;this.gh=ac;this.ga=I}lCa(I,ra,ab,Fb){this.Pae=!1;ha.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.i0a();this.xEa=I;Fb&&Fb.SaveEntryPoint&&(this.rze=Fb.SaveEntryPoint);this.Tfc=this.hFe.create(I,ra,ab,Fb);Fb&&"true"===Fb.SkipSaveToHost?this.fca():this.dNk()}dNk(){const I=()=>{ha.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.fca()};32!==this.ga.hb(Ya.a.zFb,2,[()=>{ha.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.fca()},I])&&I()}fca(){ha.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.Tfc.execute(Object(x.a)(this,this.rsm,"onSaveToSharePointUploadFinished"),Object(x.a)(this,this.qsm,"onSaveToSharePointUploadFailed"))}rsm(I){if(I&&I.data&&I.data.qd){var ra;if(({dv:ra}=va.d(I.data.qd)).returnValue)if(ra.StatusCode!==qf.a.wA&&ra.StatusCode!==
qf.a.Gyc)ha.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",I.data.status,ra.StatusCode),ra.StatusCode!==qf.a.HLf&&this.Veh(I.data.status)||(this.zMa(ra.StatusCode.toString()),this.Vqn(ra.StatusCode));else{ha.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.CLf();try{ra.NewDocumentUrl?this.FEb(ra.NewDocumentUrl):this.GEb()}catch(ab){ha.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
ab.toString())}}else ha.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:xb.a.YYc(I.data.qd)}),this.Wtd()||(this.zMa("Failed to deserialize response"),this.EWc())}else ha.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.Wtd()||(this.zMa("Unknown"),this.EWc())}qsm(I){I&&I.data?this.Veh(I.data.status)||(ha.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.zMa(wi.a[I.data.status]),this.EWc()):(ha.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.Wtd()||(this.zMa("Unknown"),this.EWc()))}Wtd(){if(!this.Pae)return ha.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.Pae=!0,this.fca(),!0;ha.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}Veh(I){ha.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",I);return this.Wtd()}GEb(){ha.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");la.a.Ql(this.xEa,la.a.bma(3),void 0,"UploadToSharePointManager.RedirectToFolder")}FEb(I){let ra=
!1,ab=!1;Q.AFrameworkApplication.K&&(ra=Q.AFrameworkApplication.K.$("SaveACopyIsEnabledForUiHost"),ab=Q.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures"));ha.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",I,ra);if(ra&&ab){ha.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Fb={};Fb[Ye.a.G8b]="1";Fb[Ye.a.documentUrl]=I;Fb[Ye.a.reason]=ah.a.CNf;Q.AFrameworkApplication.uO().execute(ac=>
{ac.Qg(Ji.a.jvb,Fb)})}else la.a.Ql(I,la.a.bma(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}i0a(){this.gh&&1===this.gh.state||(this.Ij=this.mRa(),this.Ij.message=CommonUIStrings.l_CommentProgressTooltip,this.Ij.yc=5,this.Ij.Zr=!1,this.Ij.PK(CommonUIStrings.l_DefaultDialogTitle,null,null))}Yha(){this.Ij&&(this.Ij.close(),this.Ij=null)}EWc(){this.fo(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}Mrn(){this.fo(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}$qn(){const I=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.fo(CommonUIStrings.l_SaveAsFileTooLargeTitle,I,bn.a.P6m)}fo(I,ra,ab=bn.a.T6m){ha.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",I,ra);this.Yha();1!==this.gh.state&&this.KE().peh(I,ra,ab)}Vqn(I){ha.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",I);switch(I){case qf.a.C6d:this.Mrn();break;case qf.a.HLf:this.$qn();break;default:this.EWc()}}CLf(){"VersionHistory"===this.rze&&this.ga.processAction(Ya.a.xTc,
2)}zMa(I){"VersionHistory"===this.rze&&this.ga.hb(Ya.a.NYd,2,{["FailureReason"]:I})}}Object(f.a)(Ne,"UploadToSharePointManager",null,[1955]);var ke=b(677),tm=b(114);class yg{constructor(){this.cgd=this.Wse=this.Nse=this.W=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}yb(I){this.W=I;this.Nse=ke.a.Vp(I.za("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.Wse=ke.a.Vp(I.za("Common.IEventEmitter<Common.IMruResult>"));this.cgd=ke.a.Vp(I.za("Common.App.SharedFilePicker.ISharedFilePicker"));
tm.Task.WAA.call(null,this.Nse,this.Wse,this.cgd).continueWith(()=>{this.LQm()})}LQm(){this.W.register(Ri,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Pc(()=>new Ri(Q.AFrameworkApplication.K)).singleInstance();this.W.register(Ne,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Pc(()=>new Ne(Q.AFrameworkApplication.pa,this.W.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),
()=>(new yf.a).create(),()=>new Zi,Q.AFrameworkApplication.na)).singleInstance();this.W.register(tg,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Pc(()=>new tg(this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Zi,this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),Q.AFrameworkApplication.na)).singleInstance();this.W.register(oj,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Pc(()=>
new oj(this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Jb.a(()=>this.Nse.result),Q.AFrameworkApplication.na,()=>new nf)).singleInstance();this.W.register(th,"Common.App.SaveToSharePoint.FileNameDialogFactory").Pc(()=>new th(Q.AFrameworkApplication.K,Q.AFrameworkApplication.pa,Q.AFrameworkApplication.na,Q.AFrameworkApplication.na.Ya,this.W.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.W.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),
this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new Jb.a(()=>this.Wse.result),this.W.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.cgd?this.cgd.result:null)).singleInstance();this.W.register(Ni,"Common.App.SaveToSharePoint.SaveToSharePointActor").Pc(()=>new Ni(Q.AFrameworkApplication.K,Q.AFrameworkApplication.pa,this.W.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.W.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.W.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.W.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>Q.AFrameworkApplication.na.y1j)).singleInstance();Q.AFrameworkApplication.K.$("SaveToAnotherFolderBrsIsEnabled")&&this.W.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").eb()}static main(){aa.a.instance.Lb(new yg)}}Object(f.a)(yg,"PackageManager",null,[1,2]);class Pe{}Object(f.a)(Pe,"StringDifference",null,[1900]);class wd{constructor(I,ra){this.charCode=I;this.description=ra}}Object(f.a)(wd,"UBTableEntry",null,
[]);class Wk{}new wd(8,"C0 Controls 1");new wd(9,"Horizontal tab (HT)");new wd(10,"Line feed (LF)");new wd(12,"C0 Controls 2");new wd(13,"Carriage return (CR)");new wd(31,"C0 Controls 3");new wd(32,"Space");new wd(47,"ASCII Punctuation and Symbols 1");new wd(57,"ASCII Digits");new wd(64,"ASCII Punctuation and Symbols 2");new wd(90,"Uppercase Latin Alphabet");new wd(96,"ASCII Punctuation and Symbols 3");new wd(122,"Lowercase Latin Alphabet");new wd(127,"U+0000..U+007F Basic Latin");new wd(159,"C1 Controls");
new wd(160,"NB Space");new wd(191,"Latin-1 Punctuation and Symbols");new wd(255,"U+0080..U+00FF Latin-1 Supplement");new wd(383,"U+0100..U+017F Latin Extended-A");new wd(591,"U+0180..U+024F Latin Extended-B");new wd(687,"U+0250..U+02AF IPA Extensions");new wd(767,"U+02B0..U+02FF Spacing Modifier Letters");new wd(879,"U+0300..U+036F Combining Diacritical Marks");new wd(1023,"U+0370..U+03FF Greek and Coptic");new wd(1279,"U+0400..U+04FF Cyrillic");new wd(1327,"U+0500..U+052F Cyrillic Supplement");new wd(1423,
"U+0530..U+058F Armenian");new wd(1535,"U+0590..U+05FF Hebrew");new wd(1791,"U+0600..U+06FF Arabic");new wd(1871,"U+0700..U+074F Syriac");new wd(1919,"U+0750..U+077F Arabic Supplement");new wd(1983,"U+0780..U+07BF Thaana");new wd(2047,"U+07C0..U+07FF NKo");new wd(2111,"U+0800..U+083F Samaritan");new wd(2143,"U+0840..U+085F Mandaic");new wd(2303,"U+08A0..U+08FF Arabic Extended-A");new wd(2431,"U+0900..U+097F Devanagari");new wd(2559,"U+0980..U+09FF Bengali");new wd(2687,"U+0A00..U+0A7F Gurmukhi");
new wd(2815,"U+0A80..U+0AFF Gujarati");new wd(2943,"U+0B00..U+0B7F Oriya");new wd(3071,"U+0B80..U+0BFF Tamil");new wd(3199,"U+0C00..U+0C7F Telugu");new wd(3327,"U+0C80..U+0CFF Kannada");new wd(3455,"U+0D00..U+0D7F Malayalam");new wd(3583,"U+0D80..U+0DFF Sinhala");new wd(3711,"U+0E00..U+0E7F Thai");new wd(3839,"U+0E80..U+0EFF Lao");new wd(4095,"U+0F00..U+0FFF Tibetan");new wd(4255,"U+1000..U+109F Myanmar");new wd(4351,"U+10A0..U+10FF Georgian");new wd(4607,"U+1100..U+11FF Hangul Jamo");new wd(4991,
"U+1200..U+137F Ethiopic");new wd(5023,"U+1380..U+139F Ethiopic Supplement");new wd(5119,"U+13A0..U+13FF Cherokee");new wd(5759,"U+1400..U+167F Unified Canadian Aboriginal Syllabics");new wd(5791,"U+1680..U+169F Ogham");new wd(5887,"U+16A0..U+16FF Runic");new wd(5919,"U+1700..U+171F Tagalog");new wd(5951,"U+1720..U+173F Hanunoo");new wd(5983,"U+1740..U+175F Buhid");new wd(6015,"U+1760..U+177F Tagbanwa");new wd(6143,"U+1780..U+17FF Khmer");new wd(6319,"U+1800..U+18AF Mongolian");new wd(6399,"U+18B0..U+18FF Unified Canadian Aboriginal Syllabics Extended");
new wd(6479,"U+1900..U+194F Limbu");new wd(6527,"U+1950..U+197F Tai Le");new wd(6623,"U+1980..U+19DF New Tai Lue");new wd(6655,"U+19E0..U+19FF Khmer Symbols");new wd(6687,"U+1A00..U+1A1F Buginese");new wd(6831,"U+1A20..U+1AAF Tai Tham");new wd(7039,"U+1B00..U+1B7F Balinese");new wd(7103,"U+1B80..U+1BBF Sundanese");new wd(7167,"U+1BC0..U+1BFF Batak");new wd(7247,"U+1C00..U+1C4F Lepcha");new wd(7295,"U+1C50..U+1C7F Ol Chiki");new wd(7375,"U+1CC0..U+1CCF Sundanese Supplement");new wd(7423,"U+1CD0..U+1CFF Vedic Extensions");
new wd(7551,"U+1D00..U+1D7F Phonetic Extensions");new wd(7615,"U+1D80..U+1DBF Phonetic Extensions Supplement");new wd(7679,"U+1DC0..U+1DFF Combining Diacritical Marks Supplement");new wd(7935,"U+1E00..U+1EFF Latin Extended Additional");new wd(8191,"U+1F00..U+1FFF Greek Extended");new wd(8303,"U+2000..U+206F General Punctuation");new wd(8351,"U+2070..U+209F Superscripts and Subscripts");new wd(8399,"U+20A0..U+20CF Currency Symbols");new wd(8447,"U+20D0..U+20FF Combining Diacritical Marks for Symbols");
new wd(8527,"U+2100..U+214F Letterlike Symbols");new wd(8591,"U+2150..U+218F Number Forms");new wd(8703,"U+2190..U+21FF Arrows");new wd(8959,"U+2200..U+22FF Mathematical Operators");new wd(9215,"U+2300..U+23FF Miscellaneous Technical");new wd(9279,"U+2400..U+243F Control Pictures");new wd(9311,"U+2440..U+245F Optical Character Recognition");new wd(9471,"U+2460..U+24FF Enclosed Alphanumerics");new wd(9599,"U+2500..U+257F Box Drawing");new wd(9631,"U+2580..U+259F Block Elements");new wd(9727,"U+25A0..U+25FF Geometric Shapes");
new wd(9983,"U+2600..U+26FF Miscellaneous Symbols");new wd(10175,"U+2700..U+27BF Dingbats");new wd(10223,"U+27C0..U+27EF Miscellaneous Mathematical Symbols-A");new wd(10239,"U+27F0..U+27FF Supplemental Arrows-A");new wd(10495,"U+2800..U+28FF Braille Patterns");new wd(10623,"U+2900..U+297F Supplemental Arrows-B");new wd(10751,"U+2980..U+29FF Miscellaneous Mathematical Symbols-B");new wd(11007,"U+2A00..U+2AFF Supplemental Mathematical Operators");new wd(11263,"U+2B00..U+2BFF Miscellaneous Symbols and Arrows");
new wd(11359,"U+2C00..U+2C5F Glagolitic");new wd(11391,"U+2C60..U+2C7F Latin Extended-C");new wd(11519,"U+2C80..U+2CFF Coptic");new wd(11567,"U+2D00..U+2D2F Georgian Supplement");new wd(11647,"U+2D30..U+2D7F Tifinagh");new wd(11743,"U+2D80..U+2DDF Ethiopic Extended");new wd(11775,"U+2DE0..U+2DFF Cyrillic Extended-A");new wd(11903,"U+2E00..U+2E7F Supplemental Punctuation");new wd(12031,"U+2E80..U+2EFF CJK Radicals Supplement");new wd(12255,"U+2F00..U+2FDF Kangxi Radicals");new wd(12287,"U+2FF0..U+2FFF Ideographic Description Characters");
new wd(12351,"U+3000..U+303F CJK Symbols and Punctuation");new wd(12447,"U+3040..U+309F Hiragana");new wd(12543,"U+30A0..U+30FF Katakana");new wd(12591,"U+3100..U+312F Bopomofo");new wd(12687,"U+3130..U+318F Hangul Compatibility Jamo");new wd(12703,"U+3190..U+319F Kanbun");new wd(12735,"U+31A0..U+31BF Bopomofo Extended");new wd(12783,"U+31C0..U+31EF CJK Strokes");new wd(12799,"U+31F0..U+31FF Katakana Phonetic Extensions");new wd(13055,"U+3200..U+32FF Enclosed CJK Letters and Months");new wd(13311,
"U+3300..U+33FF CJK Compatibility");new wd(19903,"U+3400..U+4DBF CJK Unified Ideographs Extension A");new wd(19967,"U+4DC0..U+4DFF Yijing Hexagram Symbols");new wd(40959,"U+4E00..U+9FFF CJK Unified Ideographs");new wd(42127,"U+A000..U+A48F Yi Syllables");new wd(42191,"U+A490..U+A4CF Yi Radicals");new wd(42239,"U+A4D0..U+A4FF Lisu");new wd(42559,"U+A500..U+A63F Vai");new wd(42655,"U+A640..U+A69F Cyrillic Extended-B");new wd(42751,"U+A6A0..U+A6FF Bamum");new wd(42783,"U+A700..U+A71F Modifier Tone Letters");
new wd(43007,"U+A720..U+A7FF Latin Extended-D");new wd(43055,"U+A800..U+A82F Syloti Nagri");new wd(43071,"U+A830..U+A83F Common Indic Number Forms");new wd(43135,"U+A840..U+A87F Phags-pa");new wd(43231,"U+A880..U+A8DF Saurashtra");new wd(43263,"U+A8E0..U+A8FF Devanagari Extended");new wd(43311,"U+A900..U+A92F Kayah Li");new wd(43359,"U+A930..U+A95F Rejang");new wd(43391,"U+A960..U+A97F Hangul Jamo Extended-A");new wd(43487,"U+A980..U+A9DF Javanese");new wd(43615,"U+AA00..U+AA5F Cham");new wd(43647,
"U+AA60..U+AA7F Myanmar Extended-A");new wd(43743,"U+AA80..U+AADF Tai Viet");new wd(43775,"U+AAE0..U+AAFF Meetei Mayek Extensions");new wd(43823,"U+AB00..U+AB2F Ethiopic Extended-A");new wd(44031,"U+ABC0..U+ABFF Meetei Mayek");new wd(55215,"U+AC00..U+D7AF Hangul Syllables");new wd(55295,"U+D7B0..U+D7FF Hangul Jamo Extended-B");new wd(56191,"U+D800..U+DB7F High Surrogates");new wd(56319,"U+DB80..U+DBFF High Private Use Surrogates");new wd(57343,"U+DC00..U+DFFF Low Surrogates");new wd(63743,"U+E000..U+F8FF Private Use Area");
new wd(64255,"U+F900..U+FAFF CJK Compatibility Ideographs");new wd(64335,"U+FB00..U+FB4F Alphabetic Presentation Forms");new wd(65023,"U+FB50..U+FDFF Arabic Presentation Forms-A");new wd(65039,"U+FE00..U+FE0F Variation Selectors");new wd(65055,"U+FE10..U+FE1F Vertical Forms");new wd(65071,"U+FE20..U+FE2F Combining Half Marks");new wd(65103,"U+FE30..U+FE4F CJK Compatibility Forms");new wd(65135,"U+FE50..U+FE6F Small Form Variants");new wd(65279,"U+FE70..U+FEFF Arabic Presentation Forms-B");new wd(65519,
"U+FF00..U+FFEF Halfwidth and fullwidth forms");new wd(65535,"U+FFF0..U+FFFF Specials");new wd(65663,"U+10000..U+1007F Linear B Syllabary");new wd(65791,"U+10080..U+100FF Linear B Ideograms");new wd(65855,"U+10100..U+1013F Aegean Numbers");new wd(65935,"U+10140..U+1018F Ancient Greek Numbers");new wd(65999,"U+10190..U+101CF Ancient Symbols");new wd(66047,"U+101D0..U+101FF Phaistos Disc");new wd(66207,"U+10280..U+1029F Lycian");new wd(66271,"U+102A0..U+102DF Carian");new wd(66351,"U+10300..U+1032F Old Italic");
new wd(66383,"U+10330..U+1034F Gothic");new wd(66463,"U+10380..U+1039F Ugaritic");new wd(66527,"U+103A0..U+103DF Old Persian");new wd(66639,"U+10400..U+1044F Deseret");new wd(66687,"U+10450..U+1047F Shavian");new wd(66735,"U+10480..U+104AF Osmanya");new wd(67647,"U+10800..U+1083F Cypriot Syllabary");new wd(67679,"U+10840..U+1085F Imperial Aramaic");new wd(67871,"U+10900..U+1091F Phoenician");new wd(67903,"U+10920..U+1093F Lydian");new wd(67999,"U+10980..U+1099F Meroitic Hieroglyphs");new wd(68095,
"U+109A0..U+109FF Meoritic Cursive");new wd(68191,"U+10A00..U+10A5F Kharoshthi");new wd(68223,"U+10A60..U+10A7F Old South Arabian");new wd(68415,"U+10B00..U+10B3F Avestan");new wd(68447,"U+10B40..U+10B5F Inscriptional Parthian");new wd(68479,"U+10B60..U+10B7F Inscriptional Pahlavi");new wd(68687,"U+10C00..U+10C4F Old Turkic");new wd(69247,"U+10E60..U+10E7F Rumi Numeral Symbols");new wd(69759,"U+11000..U+1107F Brahmi");new wd(69839,"U+11080..U+110CF Kaithi");new wd(69887,"U+110D0..U+110FF Sora Sompeng");
new wd(69967,"U+11100..U+1114F Chakma");new wd(70111,"U+11180..U+111DF Sharada");new wd(71375,"U+11680..U+116CF Takri");new wd(74751,"U+12000..U+123FF Cuneiform");new wd(74879,"U+12400..U+1247F Cuneiform Numbers and Punctuation");new wd(78895,"U+13000..U+1342F Egyptian Hieroglyphs");new wd(92735,"U+16800..U+16A3F Bamum Supplement");new wd(94111,"U+16F00..U+16F9F Miao");new wd(110847,"U+1B000..U+1B0FF Kana Supplement");new wd(119039,"U+1D000..U+1D0FF Byzantine Musical Symbols");new wd(119295,"U+1D100..U+1D1FF Musical Symbols");
new wd(119375,"U+1D200..U+1D24F Ancient Greek Musical Notation");new wd(119647,"U+1D300..U+1D35F Tai Xuan Jing Symbols");new wd(119679,"U+1D360..U+1D37F Counting Rod Numerals");new wd(120831,"U+1D400..U+1D7FF Mathematical Alphanumeric Symbols");new wd(126719,"U+1EE00..U+1EEFF Arabic Mathematical Alphabetic Symbols");new wd(127023,"U+1F000..U+1F02F Mahjong Tiles");new wd(127135,"U+1F030..U+1F09F Domino Tiles");new wd(127231,"U+1F0A0..U+1F0FF Playing Cards");new wd(127487,"U+1F100..U+1F1FF Enclosed Alphanumeric Supplement");
new wd(127743,"U+1F200..U+1F2FF Enclosed Ideographic Supplement");new wd(128511,"U+1F300..U+1F5FF Miscellaneous Symbols and Pictographs");new wd(128591,"U+1F600..U+1F64F Emoticons");new wd(128767,"U+1F680..U+1F6FF Transport and Map Symbols");new wd(128895,"U+1F700..U+1F77F Alchemical Symbols");new wd(173791,"U+20000..U+2A6DF CJK Unified Ideographs Extension B");new wd(177983,"U+2A700..U+2B73F CJK Unified Ideographs Extension C");new wd(178207,"U+2B740..U+2B81F CJK Unified Ideographs Extension D");
new wd(195103,"U+2F800..U+2FA1F CJK Compatibility Ideographs Supplement");new wd(917631,"U+E0000..U+E007F Tags");new wd(917999,"U+E0100..U+E01EF Variation Selectors Supplement");new wd(1048575,"U+F0000..U+FFFFF Supplementary Private Use Area-A");new wd(1114111,"U+100000..U+10FFFF Supplementary Private Use Area-B");Object(f.a)(Wk,"UnicodeBlocks",null,[1898]);class zk{constructor(){this.W=null}yb(I){this.W=I;this.W.register(Pe,"Common.App.SensitiveLogging.StringDifference").as("Common.App.SensitiveLogging.IStringDifference").singleInstance();
this.W.register(Wk,"Common.App.SensitiveLogging.UnicodeBlocks").as("Common.App.SensitiveLogging.IUnicodeBlocks").singleInstance()}get name(){return"Common.App.SensitiveLogging"}init(){this.W.resolve("Common.App.SensitiveLogging.IStringDifference");this.W.resolve("Common.App.SensitiveLogging.IUnicodeBlocks")}dispose(){}static main(){aa.a.instance.Lb(new zk)}}Object(f.a)(zk,"SensitiveLoggingPackage",null,[1,2]);var Zl;(function(I){I[I.myFiles=0]="myFiles";I[I.recent=1]="recent";I[I.currentFolder=2]=
"currentFolder";I[I.yourPhone=3]="yourPhone"})(Zl||(Zl={}));Object(f.b)("SharedFilePickerLandingLocation",Zl);class Vh{constructor(I){this.Cyb=this.c8b=null;this._initialized=!1;this.aef=I}X_e(I){this._initialized||(I.uu(Ji.a.fni),I.pA(Ji.a.fni,Object(x.a)(this,this.vrm,"onReceivedPickerResponse")),this._initialized=!0)}z7e(I){return this.Cyb=new Promise((ra,ab)=>{const Fb={};Fb[Ye.a.QAm]=I;this.c8b=(ac,Xc)=>{""===Xc?(ha.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),ra(ac)):
("Canceled"===Xc?ha.ULS.sendTraceTag(572548164,306,50,Xc):ha.ULS.sendTraceTag(556901065,306,10,Xc),ab(Xc))};this.aef.execute(ac=>{this.X_e(ac);ac.Qg(Ji.a.Evm,Fb)})})}vrm(I){this.c8b(I.Values[Ye.a.D9m],void 0===I.Values[Ye.a.zDf]||null===I.Values[Ye.a.zDf]?"":I.Values[Ye.a.zDf])}Slf(){return Q.AFrameworkApplication.K.$("UiHostCommonFilePicker")}STe(I,ra,ab,Fb,ac,Xc,Md,bf,Hf=null){const Zg={};Zg[Ye.a.b9m]=I;Zg[Ye.a.titleText]=ra;Zg[Ye.a.ELj]=ab;Zg[Ye.a.FLj]=Fb;Zg[Ye.a.HLj]=ac;Zg[Ye.a.Vvk]=!0;Zg[Ye.a.$Gk]=
Xc;Zg[Ye.a.UAm]=Md;Zg[Ye.a.TAm]=Zl[bf];ik.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Zg[Ye.a.VAm]="Dark");Hf&&(null!=Hf.ITb&&(Zg[Ye.a.ITb]=Hf.ITb),null!=Hf.j1b&&(Zg[Ye.a.j1b]=Hf.j1b));return Zg}}Object(f.a)(Vh,"SharedFilePickerManager",null,[1897]);class wl{constructor(){this.W=null}get name(){return"Common.App.SharedFilePicker"}yb(I){this.W=I;I.register(Vh,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").singleInstance().Pc(()=>
new Vh(I.za("Postmessage.IHostPostmessenger")))}init(){Q.AFrameworkApplication.K.Io(()=>{this.XWa()})}XWa(){this.W.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){aa.a.instance.Lb(new wl)}}Object(f.a)(wl,"SharedFilePickerPackage",null,[1,2]);class Dg extends Sys.EventArgs{constructor(I){super();this.Pgm=I}}Object(f.a)(Dg,"TypingSpeedMeterChangedEventArgs",Sys.EventArgs,[]);class fc{}Object(f.a)(fc,"TypingSpeedMeterWindow",null,[]);class xj{constructor(I,ra,ab,Fb,
ac){this.Csf=null;this.ceg=this.iid=this.ADe=this.e6b=0;this.DEe=new u.a;this.Mw=I;this.Me=ra;this.Me.qld(Object(x.a)(this,this.LCb,"onCpuMeterFrameAvailable"));this.wyj=ab;this.umj=ac;this.Qxj=Fb}$Ij(I){this.DEe.addHandler("TypingSpeedWindowAvailable",I)}EYm(I){this.DEe.removeHandler("TypingSpeedWindowAvailable",I)}LCb(I,ra){this.Csf=ra.zNc}OYh(){var I=this.Mw();I-this.iid>this.Qxj&&this.Cui();this.e6b||(this.ADe=I);this.iid=I;this.e6b++;this.e6b>=this.umj&&(this.DEe.raiseEvent("TypingSpeedWindowAvailable",
new Dg(this.QZg())),I=new fc,I.TS=this.QZg(),this.Csf&&(I.CP=this.Csf.CP),I.EC=this.ceg,this.wyj.track(I),this.Cui())}Cui(){this.iid=this.ADe=this.e6b=0}QZg(){return 2>this.e6b?0:Math.round(6E4*(this.e6b-1)/(this.iid-this.ADe))}WPn(I){this.ceg=I}dispose(){this.Me.GKf(Object(x.a)(this,this.LCb,"onCpuMeterFrameAvailable"))}}Object(f.a)(xj,"TypingSpeedMeter",null,[1978]);class ng{constructor(I){this.brb=null;this.Zp=new l.a;this.Mw=I}initialize(I,ra,ab,Fb){this.brb||(this.brb=new xj(this.Mw,I,ra,ab,
Fb),this.Zp.Jf(this.brb));return this.brb}}Object(f.a)(ng,"TypingSpeedMeterProvider",null,[1958]);class Cf{constructor(){this.CEe=null}get name(){return"Common.App.TypingSpeedMeter"}init(){if(Q.AFrameworkApplication.K.$("TypingSpeedMeterIsEnabled")){const I=ia.a.instance.resolve("Common.App.TypingSpeedMeter.TypingSpeedMeterProvider"),ra=ke.a.Vp(ia.a.instance.za("Common.ICpuMeterProvider"));ra.continueWith(()=>{const ab=ra.result.Zp.task;var Fb=new Fa.a(Q.AFrameworkApplication.K.vb("TypingSpeedMeterWindowSamplingPercent",
0)/100);Fb=new Ea.a(Object(x.a)(Fb,Fb.a0a,"shouldBeInSample"));const ac=V.a.MD(12,1,Fb),Xc=Q.AFrameworkApplication.K.vb("TypingSpeedMeterWindowTimeoutMs",5E3),Md=Q.AFrameworkApplication.K.vb("TypingSpeedMeterMaxKeystrokesPerWindow",5);ab.CWR(()=>this.CEe=I.initialize(ab.result,ac,Xc,Md))})}}dispose(){this.CEe&&this.CEe.dispose()}yb(I){I.register(ng,"Common.App.TypingSpeedMeter.TypingSpeedMeterProvider").as("Common.ITypingSpeedMeterProvider").singleInstance().Pc(()=>new ng(la.a.ie))}static main(){aa.a.instance.Lb(new Cf)}}
Object(f.a)(Cf,"TypingSpeedMeterPackage",null,[1,2]);class gg{create(I){return new Fa.a(I)}}Object(f.a)(gg,"RandomSamplerFactory",null,[853]);var pf=b(12),$k=b(1225);class ol{constructor(I,ra,ab,Fb,ac){I.wIj(()=>{Fb.pTc()});I.RIj((Xc,Md)=>{Fb.nTc(Md.revisionId,Md.bZa)});I.HIe((Xc,Md)=>{Fb.Xxl(Md.O4m,Md.bZa,Md.wOi)});I.vIj(()=>{Fb.tLf()});ra.UIj((Xc,Md)=>{Fb.tDn(Md.bti,Md.g5d,Md.actualValue)});ra.MHj((Xc,Md)=>{Fb.sDn(Md.bti,Md.g5d,Md.actualValue)});ac.pld(()=>{Fb.mZc()});ab.j3((Xc,Md)=>{6===Md.type&&
Fb.J9b(Md.Q5)})}}Object(f.a)(ol,"EventForwarder",null,[]);class Tg{constructor(I,ra,ab){this.Gnj=I;this.jL=ab;this.YRb=ra}create(I,ra){return new ol(this.Gnj,this.YRb,I,ra,this.jL)}}Object(f.a)(Tg,"EventForwarderFactory",null,[]);var xd=b(370);class Si{}Si.eJn="TypingToOutboundReplicationStart";Si.fwm="OutboundReplicationStartToOutboundReplicationEnd";Si.lwi="RtcNotificationToInboundReplicationEnd";Si.hSi="TypingToInboundReplicationEnd";Object(f.a)(Si,"PerfTrackerPhases",null,[]);class Sj{constructor(I,
ra,ab,Fb,ac,Xc,Md,bf,Hf=null){this.Lre=this.Ltg=!1;this.Jte=5;this.kvg=50;this.lse=20;this.Fqe=this.Wre=this.Rta=null;this.dhc=this.Ugc=0;this.LBe=this.WCe=!1;this.Ghd=Array(7);this.wec=null;this.elg=!1;this.ede=null;this.Uda={};this.r8c=I;this.jPa=ra;this.imj=ab;this.Vmg=Fb.create(Si.lwi,ac,Xc,20,!1);this.Qid=Fb.create(Si.hSi,Md,bf,20,!0);if(this.qa=Q.AFrameworkApplication.K)this.Ltg=this.qa.$("LogSteppedInboundFrameIsEnabled"),this.Lre=this.qa.$("LogTasksDetailsFromCPUMeterIsEnabled"),this.lse=
this.qa.vb("InboundFrameMaxNumberOfLongRunningTasks",20),this.kvg=this.qa.vb("InboundFrameMinLengthForLongRunningTasksInMs",50),this.Jte=this.qa.vb("InboundFrameNumberOfLastShortTasks",5);this.Lkb=Hf}get y4j(){null==this.ede&&(this.ede=!!this.qa&&this.qa.$("InboundRequestTakesTooLongToSendAfterRTCTelemetryIsEnabled"));return this.ede}initialize(I){this.Rta=I}k0m(I,ra,ab=null){this.X1g();ha.ULS.shipAssertTag(8229761,324,0<I.length);let Fb=!1;for(const Xc of I){const Md=Xc.toString();if(Md in this.Uda){var ac=
this.Uda[Md];if(!ac.p$b){ac.Kzi(I,ra,ab);if(this.Lre&&!Fb){const bf=this.wFk(),Hf=this.NPk(this.wec);Fb=!0;this.O1h(Xc.toString(),ac,bf,this.Fqe,this.Ghd,Hf)}else this.O1h(Xc.toString(),ac,null,null,this.Ghd,null);delete this.Uda[Md]}}else ac=this.r8c.create(this.Vmg,this.Qid),ac.Kzi(I,ra),this.Uda[Md]=ac}this.LBe=!1}J9b(I){ha.ULS.shipAssertTag(8257930,304,I.gYh,"Expected data not sent on the wire");if(I.gYh){if(I.nZd in this.Uda){var ra=this.Uda[I.nZd];ra.CZd||(ra.J9b(I.revisionId,I.Uei,I.BGi,I.bZa),
delete this.Uda[I.nZd])}else ra=this.r8c.create(this.Vmg,this.Qid),ra.J9b(I.revisionId,I.Uei,I.BGi,I.bZa),this.Uda[I.nZd]=ra;this.X1g()}}wzl(){this.WCe||(this.Wre=Array(this.lse),this.Fqe=Array(this.Jte),this.dhc=this.Ugc=0,this.Ghd=[0,0,0,0,0,0,0,0],this.wec=Array(3),this.wec[1]=[0,0],this.wec[2]=[0,0],this.WCe=!0)}uon(I){return!I.TP&&I.TN===R.a.Wsi&&(I=xd.a(this.Uda))&&I[0]?!0:!1}Bmm(I){this.WCe=!1;const ra=xd.a(this.Uda);ra&&ra[0]&&(I.TRT>=this.kvg&&this.Ugc<this.lse?this.Wre[this.Ugc++]=I:(this.Fqe[this.dhc]=
I,this.dhc=this.dhc<this.Jte-1?this.dhc+1:0),this.P7l(I),this.g8l(I))}Amm(){this.Lre&&(this.wzl(),this.LBe=!0)}P7l(I){this.Ghd[I.TP]++}g8l(I){if(I&&I.UI){const ra=this.wec[I.UI];ra[0]+=1;ra[1]+=I.TRT}}NPk(I){const ra={};I&&(I[1]&&(ra.Typing=I[1]),I[2]&&(ra.Clicking=I[2]));return ra}wFk(){return this.Ugc?this.Wre.slice(0,this.Ugc-1):null}X1g(){var I=xd.a(this.Uda);if(I&&(this.elg||this.R8l(I),I.length>this.imj))for(const ra of I){I=this.Uda[ra];const ab=I.createdTime,Fb=this.jPa();6E4<Fb-ab&&(r.b(8438528,
304,50,"{0}",{["Not Received"]:I.p$b?"RtcNotification":"ServerRevision",["Duration"]:Fb-ab}),I.p$b||r.b(42075798,304,15,"{0}",{["RevisionId"]:ra,["Duration"]:Fb-ab}),delete this.Uda[ra])}}R8l(I){if(this.y4j&&this.Lkb)for(const ra of I)if(I=this.Uda[ra],I.CZd&&!I.p$b&&(I=I.createdTime,2E3<this.jPa()-I)){let ab=null;pf.App.oa&&pf.App.oa.Da&&pf.App.oa.Da.Zb&&(ab=pf.App.oa.Da.Zb.contentReplicator);this.Lkb.execute(Fb=>{Fb.flush(ab,1)});this.elg=!0}}O1h(I,ra,ab,Fb,ac,Xc){this.Ltg&&(ra=ra.wPk())&&(ra.RevisionId=
I,ra.LRTWR=ab,ra.LSTWR=Fb,ra.TSD=ac,ra.UIWR=Xc,this.Rta&&this.Rta.track(ra))}}Object(f.a)(Sj,"InboundMonitor",null,[1984]);class Re{constructor(I,ra,ab,Fb){this.Hy=ra;this.r8c=ab;this.Nxj=Fb}create(I,ra,ab,Fb,ac=null){return new Sj(this.r8c,this.Hy,50,this.Nxj,I,ra,ab,Fb,ac)}}Object(f.a)(Re,"InboundMonitorFactory",null,[1963]);var Ae=b(282);class Ml{}Ml.R7d="UserCount";Ml.L4m="RevisionChainLength";Object(f.a)(Ml,"PerfTrackerPivotNames",null,[]);class mh{}Object(f.a)(mh,"PerfTrackingContext",null,
[]);const ya=I=>5>=I?"5AndFewer":10>=I?"6To10":15>=I?"11To15":20>=I?"15To20":25>=I?"21To25":30>=I?"26To30":"31AndAbove";class Ab{}Object(f.a)(Ab,"SteppedInboundFrame",null,[]);class Vb{constructor(I,ra,ab,Fb,ac){this.W5a=this.t8c=null;this.Qmg=500;this.s8c=this.qna=this.Smb=this.ANb=this.U0c=-1;this.y8f=null;this.VEg=this.LDg=!1;this.oDg=null;this.Myg=this.uFa=0;this.TPb=I;this.createdTime=ra();this.kgd=!1;this.Yue=0;this.wob=ab;this.Nhj=Fb;this.Qid=ac;Q.AFrameworkApplication.K&&(this.Qmg=Q.AFrameworkApplication.K.vb("InboundFrameSamplingMinimalTotalTimeMs",
500))}get CZd(){return this.LDg}get p$b(){return this.VEg}get xvi(){return this.oDg}get bZa(){return this.uFa}get ewm(){return this.Myg}get xvb(){return this.wob()}J9b(I,ra,ab,Fb){this.CZd||(this.kgd=ab,this.Yue=ra,this.U0c=E.a.lP(la.a.ie(),2),this.y8f=(new Date).toISOString(),this.W5a=I,this.Myg=Fb,this.LDg=!0,this.p$b?this.Dhh():(this.YKi(),ja.a.instance.Ww(I.toString()+"Start"),Ae.a.instance.$Nd(2)))}Kzi(I,ra,ab=null){this.p$b||(this.uFa=ra,this.VEg=!0,this.oDg=I,this.s8c=E.a.lP(la.a.ie(),2),this.CZd&&
(ja.a.instance.Ww(this.W5a.toString()+"End"),ab&&(this.ANb=ab.t1m,this.Smb=ab.h_a,this.qna=ab.l0m),Ae.a.instance.opd(),this.Dhh()))}wPk(){if(!(0<this.U0c&&0<this.ANb&&0<this.Smb&&0<this.qna&&0<this.s8c))return null;const I=new Ab;I.TT=E.a.lP(this.s8c-this.U0c,2);if(I.TT<this.Qmg)return null;I.ST=this.y8f;I.UC=this.xvb;I.RS=E.a.lP(this.ANb-this.U0c,2);I.SR=E.a.lP(this.Smb-this.ANb,2);I.RRS=E.a.lP(this.qna-this.Smb,2);I.RP=E.a.lP(this.s8c-this.qna,2);I.ResponseLanded=E.a.lP(this.Smb,2);0<I.RS?(ja.a.instance.pV("RTCToRequestSent",
this.W5a.toString()+"Start","RequestInvoked"+this.ANb),ja.a.instance.pV("RequestSentToResponseReceived","RequestInvoked"+this.ANb,"RequestCompleted"+this.Smb),ja.a.instance.pV("ResponseReceivedToReplicationStart","RequestCompleted"+this.Smb,"ReplicationStart"+this.qna)):ja.a.instance.pV("RTCToReplicationStart",this.W5a.toString()+"Start","ReplicationStart"+this.qna);ja.a.instance.pV("Replication","ReplicationStart"+this.qna,this.W5a.toString()+"End");return I}YKi(){this.t8c=this.TPb.create();this.t8c.start(Si.lwi,
Si.hSi)}Dhh(){this.t8c||this.YKi();const I=this.t8c.end(this.kgd,this.Gkk());this.Nhj.MYd(I);this.Qid.MYd(I+this.Yue)}Gkk(){const I={};I[Ml.R7d]=ya(this.xvb);var ra=this.xvi.length;I[Ml.L4m]=9>=ra?ra.toString():"10AndAbove";return Object.assign(new mh,{P:I,FC:this.bZa,CFC:this.ewm+this.bZa,ID:this.W5a.toString(),CD:this.Yue,UC:this.xvb,RCL:this.xvi.length})}}Object(f.a)(Vb,"InboundOperation",null,[1981]);class oc{constructor(I,ra,ab){this.oEa=I;this.jPa=ra;this.wob=ab}create(I,ra){return new Vb(this.oEa,
this.jPa,this.wob,I,ra)}}Object(f.a)(oc,"InboundOperationFactory",null,[1962]);class Wc{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,Hf){this.lgd=!0;this.cAg=this.Xcd=null;this.Xue=I;this.gdj=ra;this.vqj=ab;this.$h=Fb;this.EEe=ac.create("TypingToOutboundReplicationStart",Xc,Md,20,!1);this.gye=ac.create("OutboundReplicationStartToOutboundReplicationEnd",bf,Hf,20,!1)}get gDf(){return this.Xcd}get aUd(){return this.cAg}mZc(){!this.gDf&&this.lgd&&(this.lgd=this.gdj())&&(this.Xcd=this.Xue.create(Object(x.a)(this,
this.MM,"sendUpdateNotification"),this.vqj(),this.EEe,this.gye),this.gDf.mZc())}pTc(){this.lgd=!0;this.cAg=this.gDf;this.aUd&&(this.Xcd=null,this.aUd.pTc())}tLf(){this.Xcd=null}nTc(I,ra){this.aUd&&this.aUd.nTc(I,ra)}MM(I){this.$h.MM(6,I)}}Object(f.a)(Wc,"OutboundMonitor",null,[]);class cd{constructor(I,ra){this.Xue=I;this.spj=ra}create(I,ra,ab,Fb,ac,Xc,Md){return new Wc(this.Xue,I,ra,ab,this.spj,Fb,ac,Xc,Md)}}Object(f.a)(cd,"OutboundMonitorFactory",null,[]);var yd=b(51);class sc{constructor(I){this.o6a=
I}get mMm(){return this.o6a}Ja(I){return!!this.o6a&&I in this.o6a}get gYh(){return this.Ja(sc.qud)&&this.Ja(sc.oFb)&&this.Ja(sc.zSf)}get revisionId(){if(this.Ja(sc.oFb))return yd.a.Ee(this.o6a[sc.oFb]);throw Error.create("Unable to parse RevisionIdKey key from dictionary into string");}get nZd(){if(this.Ja(sc.oFb))return this.o6a[sc.oFb];throw Error.create("Unable to cast RevisionIdKey key from dictionary into string");}get Uei(){if(this.Ja(sc.qud))return Number.parseInvariant(this.o6a[sc.qud]);throw Error.create("Unable to parse DurationKey key from dictionary into int");
}get BGi(){if(this.Ja(sc.oFb))return Boolean.parse(this.o6a[sc.zSf]);throw Error.create("Unable to parse ShouldSample key from dictionary into bool");}get bZa(){if(this.Ja(sc.Cwf))return Number.parseInvariant(this.o6a[sc.Cwf]);throw Error.create("Unable to parse NumSequentailFailuresKey key from dictionary into int");}static eik(I){return new sc(I)}static jik(I,ra,ab,Fb){const ac={};ac[sc.qud]=I.toString();ac[sc.oFb]=ra.toString();ac[sc.zSf]=ab.toString();ac[sc.Cwf]=Fb.toString();return new sc(ac)}}
sc.oFb="RevisionID";sc.qud="Duration";sc.zSf="ShouldSample";sc.Cwf="NumSequentialFailures";Object(f.a)(sc,"ReplicationNotificationMessage",null,[1982]);class Xd{constructor(I,ra,ab,Fb,ac,Xc,Md){this.wq=this.lh=0;this.Kob=this.Esc=null;this.rae=[];this.$Ag=null;this.J5c={};this.uFa=0;this.TPb=I;this.Ptj=ra;this.jPa=ab;this.wob=Fb;this.SFg=ac;this.W5a=null;this.J5c.TypingStartStage=null;this.J5c.ReplicationStartStage="TypingStartStage";this.J5c.ReplicationEndStage="ReplicationStartStage";this.vKg=1<
this.xvb;this.EEe=Xc;this.gye=Md}get xvb(){return this.wob()}mZc(){this.pPe("TypingStartStage")&&(this.DIf("TypingStartStage"),ha.ULS.shipAssertTag(8257931,324,!this.Kob&&!this.wq,"ReplicationStart or ReplicationEnd were calledbefore TypingStart"),this.lh=this.jPa(),this.Esc=this.TPb.create(),this.QKi(this.Esc,Si.eJn))}pTc(){if(this.pPe("ReplicationStartStage")){this.DIf("ReplicationStartStage");ha.ULS.shipAssertTag(8257932,324,!!this.Esc,"TypingStart not called");if(this.Esc){const I=this.yhh(this.Esc,
this.W5a);this.EEe.MYd(I)}this.Kob=this.TPb.create();this.QKi(this.Kob,Si.fwm)}}nTc(I,ra){this.pPe("ReplicationEndStage")&&(this.DIf("ReplicationEndStage"),this.wq=this.jPa(),this.uFa=ra,ha.ULS.shipAssertTag(8257933,324,!!this.Kob,"ReplicationStart not called"),this.Kob&&(ha.ULS.shipAssertTag(8193425,324,!!this.Kob,"ReplicationStart not called"),ra=this.yhh(this.Kob,I),this.gye.MYd(ra)),ha.ULS.shipAssertTag(8257934,324,!!this.lh,"StartTime not set. No message sent to other editors."),this.lh&&(I=
sc.jik(this.wq-this.lh,I,this.SFg,this.uFa),this.Ptj(I.mMm)))}pPe(I){if(this.J5c[I]===this.$Ag)return!0;ha.ULS.shipAssertTag(8422940,324,!1,"{0}",{["Previous stage mismatch"]:this.zBj()});return!1}zBj(){const I=new Sys.StringBuilder;I.append("Actual Phase:");for(let ra=0;ra<this.rae.length;ra++)I.append(" "+this.rae[ra]);return I.toString()}DIf(I){this.rae.push(I);this.$Ag=I}QKi(I,ra){this.vKg&&I.start(ra)}yhh(I,ra){if(!this.vKg)return-1;const ab={};ab[Ml.R7d]=ya(this.xvb);ra=Object.assign(new mh,
{P:ab,FC:this.uFa,CFC:0,ID:ra?ra.toString():"",CD:0,UC:this.xvb,RCL:0});return I.end(this.SFg,ra)}}Object(f.a)(Xd,"OutboundOperation",null,[1979]);class Sd{constructor(I,ra,ab){this.TPb=I;this.jPa=ra;this.wob=ab}create(I,ra,ab,Fb){return new Xd(this.TPb,I,this.jPa,this.wob,ra,ab,Fb)}}Object(f.a)(Sd,"OutboundOperationFactory",null,[1960]);class wf{constructor(I,ra){this.Rcg=this._name=this.e_=null;this.Zc=I;this.Rta=ra}start(I,ra=null){this.e_=this.Zc.Pe("UserAction",I);this._name=I;this.Rcg=ra}end(I,
ra){let ab=-1;I&&(ab=this.e_.Yg,ra.D=ab,ra.CN=this.Rcg,ra.CD+=ab,this.Rta.track(ra,this._name));return ab}}Object(f.a)(wf,"PerfTracker",null,[1983]);class Xi{constructor(I,ra){this.Zc=I;this.Rta=ra}create(){return new wf(this.Zc,this.Rta)}}Object(f.a)(Xi,"PerfTrackerFactory",null,[1961]);class Ak{constructor(I,ra,ab){this.xoc=null;this.rpj=I;this.Umg=ra;this.lQb=ab}init(I,ra,ab,Fb,ac,Xc,Md){ra=this.lQb.create(ra/100);ab=this.lQb.create(ab/100);this.xoc=this.rpj.create(Object(x.a)(ra,ra.a0a,"shouldBeInSample"),
Object(x.a)(ab,ab.a0a,"shouldBeInSample"),I,Fb,ac,Xc,Md)}mZc(){this.xoc.mZc()}pTc(){this.xoc.pTc()}tLf(){this.xoc.tLf()}nTc(I,ra){this.xoc.nTc(I,ra)}Xxl(I,ra,ab=null){this.Umg.k0m(I,ra,ab)}J9b(I){I=sc.eik(I);this.Umg.J9b(I);ja.a.instance.Ww(I.revisionId+"Start")}tDn(I,ra,ab){r.b(9041820,304,50,"ReplicationTelemetry KPI Threshold Exceeded: [{0}]",this.zrd(I,ra,ab))}sDn(I,ra,ab){r.b(9041821,304,50,"ReplicationTelemetry KPI Average Threshold Exceeded: [{0}]",this.zrd(I,ra,ab))}zrd(I,ra,ab){const Fb=
{};Fb.PhaseName=I;Fb.ThresholdValue=ra;Fb.ActualValue=ab;return Fb}}Object(f.a)(Ak,"ReplicationTelemetryManager",null,[]);var ph=b(842);class Ah extends ph.a{constructor(I,ra){super(I,ra);this.Mh=this.fhd=0}wsa(I){this.fhd+=I;this.Mh++}getValue(){return this.Mh?this.fhd/this.Mh:0}CMa(){this.Mh=this.fhd=0}}Object(f.a)(Ah,"AverageMetric",ph.a,[]);class Hg extends ph.a{constructor(I,ra){super(I,ra);this.bva=0}wsa(I){I>this.bva&&(this.bva=I)}getValue(){return this.bva}CMa(){this.bva=0}}Object(f.a)(Hg,
"MaxMetric",ph.a,[]);var qh=b(1695);class xi extends ph.a{constructor(I,ra,ab=100){super(I,ra);this.Ead=this.jPb=this.GRb=0;this.dfd=ab;this.Wye=new qh.a(this.dfd)}wsa(I){if(this.jPb===this.dfd){const ra=this.Wye.dequeue();this.GRb-=ra;this.jPb--}this.Wye.enqueue(I);this.GRb+=I;this.jPb++;I=this.GRb/this.jPb;I>this.Ead&&this.jPb===this.dfd&&(this.Ead=I)}getValue(){return this.Ead}CMa(){this.Ead=0;this.Wye=new qh.a(this.dfd);this.jPb=this.GRb=0}}Object(f.a)(xi,"MaxRollingAverageMetric",ph.a,[]);class wa extends ph.a{constructor(I,
ra){super(I,ra);this.Mh=0}wsa(){this.Mh++}getValue(){return this.Mh}CMa(){this.Mh=0}}Object(f.a)(wa,"CounterMetric",ph.a,[]);class kb{constructor(I,ra){this.JSb=ra;this.Ebe=new Ah(I+"-AverageValue","Milliseconds");this.jse=new Hg(I+"-MaxValue","Milliseconds");this.qse=new xi(I+"-MaxRollingAverageValue","Milliseconds");this.Vee=new wa(I+"-NumberOfEvents","Count");this.Lna=new $a.a(I+"-SlowPercentileAtValue","Percentile",Q.AFrameworkApplication.K.pO("CoAuthLatencySlowTargetValue",3E3),Q.AFrameworkApplication.K.pO("CoAuthLatencySlowThresholdPercentile",
95),this.JSb);this.fwe=new $a.a(I+"-BrokenSlowPercentileAtValue","Percentile",Q.AFrameworkApplication.K.pO("CoAuthLatencyBrokenSlowTargetValue",5E3),Q.AFrameworkApplication.K.pO("CoAuthLatencyBrokenSlowThresholdPercentile",95),this.JSb)}sY(I){this.Ebe.wsa(I);this.jse.wsa(I);this.qse.wsa(I);this.Vee.wsa(I);this.Lna.wsa(I);this.fwe.wsa(I)}oXd(){this.Ebe.jMa();this.jse.jMa();this.qse.jMa();this.Vee.jMa();this.Lna.jMa();this.fwe.jMa();this.Ebe.CMa();this.jse.CMa();this.qse.CMa();this.Vee.CMa();this.Lna.CMa();
this.fwe.CMa()}}Object(f.a)(kb,"ReplicationLatencyMetrics",null,[]);class Pb{constructor(){this.Pqe=new Lb.a}Uni(I,ra,ab){if(!(0>ra)){if(!({value:Fb}=this.Pqe.Ab(I,Fb)).returnValue){var Fb=new kb(I,ab);this.Pqe.Z(I,Fb)}Fb.sY(ra)}}oXd(){for(const I of this.Pqe.values)I.oXd()}}Object(f.a)(Pb,"ReplicationTelemetryMetricsManager",null,[1959]);class Hb{Uni(){}oXd(){}}Object(f.a)(Hb,"ReplicationTelemetryMetricsManagerStub",null,[1959]);class bd{constructor(I,ra,ab,Fb,ac,Xc,Md){this.mSa=this.Aid=0;this.Jmj=
I;this.iwe=ab;this.CIg=Fb;this.G$f=ac;this.YRb=ra;this.Kmj=Xc;this.JSb=Md}MYd(I){this.Jmj.Uni(this.iwe,I,this.JSb);I>this.CIg&&this.YRb.cDn(this.iwe,this.CIg,I);this.Aid+=I;this.mSa++;this.Aid/this.mSa>this.G$f&&this.mSa>this.Kmj&&this.YRb.nSj(this.iwe,this.G$f,this.Aid/this.mSa)}}Object(f.a)(bd,"TimeSpanVerifier",null,[1920]);class nc{constructor(I,ra){this.wsj=I;this.YRb=ra}create(I,ra,ab,Fb,ac){return new bd(this.wsj,this.YRb,I,ra,ab,Fb,ac)}}Object(f.a)(nc,"TimeSpanVerifierFactory",null,[1896]);
class Qe extends Sys.EventArgs{constructor(I,ra,ab){super();this.bti=I;this.g5d=ra;this.actualValue=ab}}Object(f.a)(Qe,"TimeSpanVerifierEventArgs",Sys.EventArgs,[]);class ye{constructor(){this.ma=new u.a}cDn(I,ra,ab){this.ma.raiseEvent("TSVTE",new Qe(I,ra,ab))}nSj(I,ra,ab){this.ma.raiseEvent("TSVATE",new Qe(I,ra,ab))}UIj(I){this.ma.addHandler("TSVTE",I)}MHj(I){this.ma.addHandler("TSVATE",I)}}Object(f.a)(ye,"TimeSpanVerifierNotifier",null,[1895]);class lf{constructor(){this.W=this.qa=null}get name(){return"Box4.ReplicationTelemetry"}yb(I){this.qa=
I.resolve("Common.IAppSettingsManager");this.W=I;if(this.qa.$("Box4ReplicationTelemetryIsEnabled")){I.ha("ReplicationTelemetry.IPerfTrackerFactory",()=>new Xi(pf.App.oa.Qo,V.a.MD(20,1,new W.a))).singleInstance();I.ha("ReplicationTelemetry.ITimeSpanVerifierNotifier",()=>new ye).singleInstance();this.qa.$("Box4ReplicationTelemetryMetricsIsEnabled")?I.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",()=>new Pb).singleInstance():I.ha("ReplicationTelemetry.IReplicationTelemetryMetricsManager",
()=>new Hb).singleInstance();I.ha("ReplicationTelemetry.ITimeSpanVerifierFactory",()=>new nc(I.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager"),I.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"))).singleInstance();I.ha("ReplicationTelemetry.OutboundOperationFactory",()=>new Sd(I.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),lf.Yth)).singleInstance();I.ha("ReplicationTelemetry.OutboundMonitorFactory",()=>new cd(I.resolve("ReplicationTelemetry.OutboundOperationFactory"),
I.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory"))).singleInstance();I.ha("ReplicationTelemetry.InboundOperationFactory",()=>new oc(I.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),lf.Yth)).singleInstance();var ra=new Re(I.resolve("ReplicationTelemetry.IPerfTrackerFactory"),()=>(new Date).getTime(),I.resolve("ReplicationTelemetry.InboundOperationFactory"),I.resolve("ReplicationTelemetry.ITimeSpanVerifierFactory")),ab=this.qa.$("ComponentStateLoggingPackageIsEnabled")?
this.W.za("Common.IComponentStateLogManager"):null;I.ha("ReplicationTelemetry.IInboundMonitor",()=>ra.create(this.qa.vb("Box4ReplicationTelemetryInboundOperationThreshold",0),this.qa.vb("Box4ReplicationTelemetryInboundOperationAverageThreshold",0),this.qa.vb("Box4ReplicationTelemetryTypingToInboundEndThreshold",0),this.qa.vb("Box4ReplicationTelemetryTypingToInboundEndAverageThreshold",0),ab)).singleInstance();I.ha("Common.IRandomSamplerFactory",()=>new gg).singleInstance();I.ha("ReplicationTelemetry.ReplicationTelemetryManager",
()=>new Ak(I.resolve("ReplicationTelemetry.OutboundMonitorFactory"),I.resolve("ReplicationTelemetry.IInboundMonitor"),I.resolve("Common.IRandomSamplerFactory"))).singleInstance();I.ha("ReplicationTelemetry.EventForwarderFactory",()=>new Tg($k.a.instance,I.resolve("ReplicationTelemetry.ITimeSpanVerifierNotifier"),I.resolve("Box4.ContentEditableViewEventSource")))}}init(){if(this.qa.$("Box4ReplicationTelemetryIsEnabled")){var I=this.qa.vb("Box4ReplicationTelemetrySamplePercent",0),ra=this.qa.vb("Box4ReplicationTelemetryPhaseSamplePercent",
0),ab=this.qa.vb("Box4ReplicationTelemetryTypingToReplicationStartThreshold",0),Fb=this.qa.vb("Box4ReplicationTelemetryTypingToReplicationStartAverageThreshold",0),ac=this.qa.vb("Box4ReplicationTelemetryReplicationStartToReplicationEndThreshold",0),Xc=this.qa.vb("Box4ReplicationTelemetryReplicationStartToReplicationEndAverageThreshold",0),Md=this;this.W.za("Box4.Presence.IRtcProxyProvider").execute(Hf=>{Hf.NG().continueWith(()=>{const Zg=Hf.NG().result,gi=Md.W.resolve("ReplicationTelemetry.ReplicationTelemetryManager");
gi.init(Zg,I,ra,ab,Fb,ac,Xc);Md.W.resolve("ReplicationTelemetry.EventForwarderFactory").create(Zg,gi);if(Md.qa.$("LogSteppedInboundFrameIsEnabled")){const Ei=ke.a.Vp(Md.W.za("Common.ICpuMeterProvider"));Ei.continueWith(()=>{const Il=Md.W.resolve("ReplicationTelemetry.IInboundMonitor");var Kk=new Ea.a(()=>!0);Kk=V.a.MD(19,1,Kk);Il.initialize(Kk);const nm=Ei.result.Zp.task;nm.continueWith(()=>{nm.result.Jkd(0,()=>Il.LBe,Rf=>{Il.Bmm(Rf)});nm.result.Jkd(1,Rf=>Il.uon(Rf),()=>{Il.Amm()})})})}ha.ULS.sendTraceTag(8257935,
305,50,"ReplicationTelemetry init")})});var bf=this;Q.AFrameworkApplication.UK(()=>{bf.W.resolve("ReplicationTelemetry.IReplicationTelemetryMetricsManager").oXd()})}}dispose(){}static Yth(){const I=pf.App.lc;return I?I.sgh:0}}Object(f.a)(lf,"ReplicationTelemetryPackage",null,[1,2]);var rh=b(1194),Eg=b(54),Qf=b(14),jg=b(138),Ng=b(3),ci=b(91),bj=b(70),Xk=b(219),Bk=b(19),he=b(24),mj=b(10),Jk=b(1802);class um{static get vf(){return hd.a.fy(um.ll,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,"")}}um.ll=
"<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";Object(f.a)(um,"InsertSymbolsDialogHtml",null,[]);class wg extends Jk.a{constructor(I,ra,ab){super();this.yOb=this.uGa=this.f7a=null;this.Cme=0;this.ga=I;this.fb=ra;this.g7a=ab;
this.Nd(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Nd(0,CommonUIStrings.l_DialogClose);this.q6=!1;this.vf=um.vf;this.jf="InsertSymbolsDialog"}dispose(){0<wg.aEe&&ha.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.Cme,wg.aEe);wg.ifg++;ha.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",wg.ifg);this.ga=this.g7a=null;super.dispose()}mNa(){this.Tg(Box4Intl.Box4Strings.L_SymbolSingle,Object(x.a)(this,
this.YDl,"insertSymbolsDialogHandler"),null);this.Cme=0;wg.ofg++;ha.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",wg.ofg);const I=this.qaf("symbol_d_"+wg.Zlc);I&&I.focus()}hide(){var I=document.getElementById("symbolsContainer");if(I&&(I=I.getElementsByTagName("a")))for(let ra=0;ra<I.length;ra++)L.a.removeHandler(I[ra],F.a.focus,Object(x.a)(this,this.HMi,"symbolFocusHandler"));super.hide()}YDl(I){1===I?(this.$yf("symbol_d_"+wg.Zlc),this.fb.NI(this.lI,!0),this.fb.gk().Sh.ov(this.ZC),
this.ZC.focus()):this.hide()}get Adb(){return wg.dmc}set Adb(I){wg.dmc=I}get wdb(){return wg.Tlc}set wdb(I){wg.Tlc=I}cS(){super.cS();var I=document.getElementById("symbolsContainer");if(I&&(I.innerHTML=this.g7a.KWj(),I=I.getElementsByTagName("a")))for(let ra=0;ra<I.length;ra++)L.a.addHandler(I[ra],F.a.focus,Object(x.a)(this,this.HMi,"symbolFocusHandler"))}kha(){const I=document.getElementById("symbolsContainer");I&&(this.f7a||(this.f7a=Object(x.a)(this,this.Hzn,"symbolClickHandler"),this.Uo.Ea(F.a.click,
I,this.f7a),this.Uo.Ea(F.a.YA,I,this.f7a)),this.uGa||(this.uGa=Object(x.a)(this,this.Jzn,"symbolKeyHandler"),this.jd.Ea(F.a.ah,I,this.uGa),this.jd.Ea(F.a.hs,I,this.uGa),this.jd.Ea(F.a.Hg,I,this.uGa)));super.kha()}S9a(){const I=document.getElementById("symbolsContainer");I&&(this.f7a&&(this.Uo.xb(F.a.click,I,this.f7a),this.Uo.xb(F.a.YA,I,this.f7a),this.f7a=null),this.uGa&&(this.jd.xb(F.a.ah,I,this.uGa),this.jd.xb(F.a.hs,I,this.uGa),this.jd.xb(F.a.Hg,I,this.uGa),this.uGa=null));super.S9a()}Esm(I){this.wDi("symbol_d_"+
wg.Zlc,!1);wg.Zlc=parseInt(I.substr(I.lastIndexOf("_")+1));this.wDi(I,!0);if(I=document.getElementById("SymbolNameValueLabel")){const ra=this.pCd(wg.Zlc);I.innerText=ra.altText}}pCd(I){const ra=this.g7a.f4d.wWf.value,ab=xd.a(ra);return ra[ab[I]]}HMi(I){if(I.target!==this.yOb){const ra=this.fb.gk();ra&&ra.Sh&&(ra.Sh.ov(I.target),this.yOb=I.target)}this.Esm(I.target.id)}Hzn(I){const ra=I.Ud;if("a"!==ra.tagName.toLowerCase())return!1;I.eventName===F.a.YA&&this.$yf(ra.id);this.fb.NI(this.lI,!0);this.fb.gk().Sh.ov(ra);
ra.focus();return!0}Jzn(I){var ra=I.Ud;if("a"!==ra.tagName.toLowerCase())return!1;const ab=parseInt(ra.id.substr(ra.id.lastIndexOf("_")+1));if(I.Sa.ctrlKey||I.Sa.altKey||I.Sa.keyCode>=cf.a.pec&&I.Sa.keyCode<=cf.a.LJb)return!1;if(I.eventName===F.a.ah){I=I.Sa.keyCode;let Fb=-1;I===Sys.UI.Key.enter?(this.$yf(ra.id),this.fb.NI(this.lI,!0),this.fb.gk().Sh.ov(ra),ra.focus()):I===Sys.UI.Key.up?Fb=ab-15:I===Sys.UI.Key.down?Fb=ab+15:I===Sys.UI.Key.left?Fb=Q.AFrameworkApplication.isRtl?ab+1:ab-1:I===Sys.UI.Key.right&&
(Fb=Q.AFrameworkApplication.isRtl?ab-1:ab+1);0<=Fb&&(ra=this.qaf("symbol_d_"+Fb))&&ra.focus()}return!0}$yf(I){this.Cme++;wg.aEe++;I=parseInt(I.substr(I.lastIndexOf("_")+1));const ra=this.pCd(I),ab={};ab.SourceControlId="symbol_"+I+"_"+ra.d4d;this.ga.hb(Ng.a.hcb,2,ab);ha.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",I)}qaf(I){const ra=document.getElementById("symbolsContainer");return ra?ra.querySelector("#"+I):null}wDi(I,ra){(I=this.qaf(I))&&(ra?I.setAttribute("selected",
"true"):I.removeAttribute("selected"))}}wg.Zlc=0;wg.dmc=null;wg.Tlc=null;wg.ofg=0;wg.ifg=0;wg.aEe=0;Object(f.a)(wg,"InsertSymbolsDialog",Jk.a,[]);class Jh{constructor(I,ra,ab,Fb,ac,Xc,Md){this.ga=I;this.Vb=ra;this.Fwj=new Jb.a(Object(x.a)(this,this.zhl,"getSymbolsDropDownMenuProps"));this.Fb=ab;this.g7a=Fb;this.Gm=ac;this.ya=Xc;this.vl=Md}zhl(){return this.g7a.OXj()}eb(){this.ga.Aa(Ng.a.NGf,Qf.a.application,Object(x.a)(this,this.NGf,"queryInsertSymbols"),96);this.ga.ka(Ng.a.KDb,Qf.a.view,Object(x.a)(this,
this.KDb,"populateSymbolsDropDown"));this.ga.ka(Ng.a.e4d,Qf.a.view,Object(x.a)(this,this.IMi,"symbolsDropDownOpenHandler"));this.ga.ka(Ng.a.vWd,Qf.a.view,Object(x.a)(this,this.xli,"querySymbolPositionHandler"));this.ga.ka(Ng.a.hcb,Qf.a.view,Object(x.a)(this,this.OJa,"insertSymbolViewHandler"));this.ga.ka(Ng.a.KDb,Qf.a.Ub,Object(x.a)(this,this.KDb,"populateSymbolsDropDown"));this.ga.ka(Ng.a.e4d,Qf.a.Ub,Object(x.a)(this,this.IMi,"symbolsDropDownOpenHandler"));this.ga.ka(Ng.a.vWd,Qf.a.Ub,Object(x.a)(this,
this.xli,"querySymbolPositionHandler"));this.ga.ka(Ng.a.hcb,Qf.a.Ub,Object(x.a)(this,this.XDl,"insertSymbolHandler"));this.ga.Qb(Ng.a.KDb,1124);this.ga.Qb(Ng.a.e4d,1036);this.ga.Qb(Ng.a.vWd,1124);this.ga.Qb(Ng.a.hcb,1036);Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&(this.ga.ka(Ng.a.MHc,Qf.a.view,Object(x.a)(this,this.THi,"showInsertMoreSymbolsDialogHandler")),this.ga.ka(Ng.a.MHc,Qf.a.Ub,Object(x.a)(this,this.THi,"showInsertMoreSymbolsDialogHandler")),this.ga.Qb(Ng.a.MHc,
1124))}xli(I,ra,ab,Fb,ac){if(1===ab)return 32;I=this.g7a.Fgi(ac);I=String.format(this.g7a.Izn,I.character);ac[rh.a.InnerHTML]=I;ac[rh.a.On]=!1;return 32}OJa(I,ra,ab,Fb,ac){let Xc;if(({kd:Xc,selected:Md,OJa:bf}=this.azc(ra,ab,Xc,Md,bf)).returnValue)return bf;var Md=Bk.SelectionEditor.ke(Md);var bf=!0;I=8;ab=this.Fb.Ob(15);ab.Oa(Xc.sc);Md||(I=this.ga.Le(ra,Ng.a.Uha,2,!0,Fb,null),ra=32===I,ha.ULS.shipAssertTag(6407387,348,ra,"DeleteForReplace did not succeed. Response is {0}",I),bf=ra);bf&&(ra=Xc.Ma.If,
Md=Bk.SelectionEditor.ke(ra),ha.ULS.shipAssertTag(6407388,348,Md,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",ra.contextId),I=8,Md&&(I=this.ga.Le(ra,Ng.a.hcb,2,!1,Fb,ac),ha.ULS.shipAssertTag(6407389,348,32===I,"Insertion at IP context did not succeed. Response is {0}",I),32===I&&Eg.FocusManager.instance().Kf(Xc.IG)));ab.dispose();return I}azc(I,ra,ab,Fb,ac){ab=null;I.view.Cd&&(ab=I.view);Fb=null;if(!ab||!ab.Ma)return r.b(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",
I.toString()),{returnValue:!0,kd:ab,selected:Fb,OJa:8};Fb=ab.Ma.If;if(!Fb)return{returnValue:!0,kd:ab,selected:Fb,OJa:2};if(this.Gm.Kba(Fb))return{returnValue:!0,kd:ab,selected:Fb,OJa:8};if(ab.Ma.Ca.VG||this.vl&&this.vl.instance&&this.vl.instance.JR(Fb)||Bk.SelectionEditor.qXa(I.lm))return{returnValue:!0,kd:ab,selected:Fb,OJa:2};if(Jh.uf.J$(mj.ParagraphReader.EO,Fb))return ac=8,Jh.Kb.ib(ci.a.re,{["Reason"]:bj.a.$L}),{returnValue:!0,kd:ab,selected:Fb,OJa:ac};ac=32;return 1===ra?{returnValue:!0,kd:ab,
selected:Fb,OJa:ac}:{returnValue:!1,kd:ab,selected:Fb,OJa:ac}}XDl(I,ra,ab,Fb,ac){if(1===ab)return 32;if(Bk.SelectionEditor.qXa(ra))return 2;I=this.g7a.Fgi(ac);Fb.dr=I.index;Fb=this.Vb.ff(ra.node);ab=Fb.La(11);ha.ULS.shipAssertTag(6379466,324,ab,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",jg.a[ra.node.type]);ab=this.Fb.Ob(15);ab.Lr(Fb);Jh.characterPropertiesEditor.replaceTextRange(ra,I.character,!0,!1);ra=he.SelectionFactory.vd(Fb.currentNode,ra.cpBegin+1);this.ya.setSelection(ra);
ab.dispose();return 32}KDb(I,ra,ab,Fb,ac){if(1===ab)return 32;ac.MenuItems=this.Fwj.value;return 32}IMi(I,ra,ab){let Fb,ac,Xc;({kd:Fb,selected:ac,OJa:Xc}=this.azc(ra,ab,Fb,ac,Xc));return Xc}THi(I,ra,ab){2===ab&&(new wg(this.ga,Eg.FocusManager.instance(),ia.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).mNa();return 32}NGf(){return 32}static get characterPropertiesEditor(){return Jh.Tb||(Jh.Tb=ia.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(I){Jh.Tb=
I}static get uf(){return Xk.ContextSetEditor.instance}static get Kb(){return pi.a.instance}}Jh.Tb=null;Object(f.a)(Jh,"SymbolsActor",null,[1861]);class Sf{constructor(I,ra){this.d4d=I;this.altText=ra}}Object(f.a)(Sf,"Symbol",null,[]);class Kh{constructor(){this.BCe=null;this.HHg=new Jb.a(Kh.PUe)}get wWf(){return this.HHg}bxh(I){this.BCe||(this.BCe=xd.a(this.HHg.value));return Array.indexOf(this.BCe,I)}static PUe(){const I={};I["\u2022"]=new Sf("\u2022",Box4Intl.Box4Strings.L_Bullet);I["\u20ac"]=new Sf("\u20ac",
Box4Intl.Box4Strings.L_EuroSign);I["\u00a3"]=new Sf("\u00a3",Box4Intl.Box4Strings.L_PoundSign);I["\u00a5"]=new Sf("\u00a5",Box4Intl.Box4Strings.L_YenSign);I["\u00a9"]=new Sf("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);I["\u00ae"]=new Sf("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);I["\u2122"]=new Sf("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);I["\u00b1"]=new Sf("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);I["\u2260"]=new Sf("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);I["\u2264"]=new Sf("\u2264",
Box4Intl.Box4Strings.L_LessThanOrEqualTo);I["\u2265"]=new Sf("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);I["\u00f7"]=new Sf("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);I["\u00d7"]=new Sf("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);I["\u221e"]=new Sf("\u221e",Box4Intl.Box4Strings.L_Infinity);I["\u00b5"]=new Sf("\u00b5",Box4Intl.Box4Strings.L_MicroSign);I["\u03b1"]=new Sf("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);I["\u03b2"]=new Sf("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);
I["\u03c0"]=new Sf("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);I["\u03a9"]=new Sf("\u03a9",Box4Intl.Box4Strings.L_OhmSign);I["\u03a3"]=new Sf("\u03a3",Box4Intl.Box4Strings.L_NArySummation);I["\u00b0"]=new Sf("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);I["\u0394"]=new Sf("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);I["\u263a"]=new Sf("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);I["\u2665"]=new Sf("\u2665",Box4Intl.Box4Strings.L_BlackHeartSuit);I["\u20b9"]=new Sf("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);
I["\u00bf"]=new Sf("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);I["\u00a1"]=new Sf("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);I["\u2014"]=new Sf("\u2014",Box4Intl.Box4Strings.L_EmDash);I["\u2026"]=new Sf("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);I["\u00c0"]=new Sf("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);I["\u00c1"]=new Sf("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);I["\u00c2"]=new Sf("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);
I["\u00c3"]=new Sf("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);I["\u00c4"]=new Sf("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);I["\u00c5"]=new Sf("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);I["\u00c6"]=new Sf("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);I["\u00c7"]=new Sf("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);I["\u00c8"]=new Sf("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);I["\u00c9"]=new Sf("\u00c9",
Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);I["\u00ca"]=new Sf("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);I["\u00cb"]=new Sf("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);I["\u00cc"]=new Sf("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);I["\u00cd"]=new Sf("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);I["\u00ce"]=new Sf("\u00ce",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);I["\u00cf"]=new Sf("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);
I["\u00d1"]=new Sf("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);I["\u00d2"]=new Sf("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);I["\u00d3"]=new Sf("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);I["\u00d4"]=new Sf("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);I["\u00d5"]=new Sf("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);I["\u00d6"]=new Sf("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);I["\u00d9"]=
new Sf("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);I["\u00da"]=new Sf("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);I["\u00db"]=new Sf("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);I["\u00dc"]=new Sf("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);I["\u00df"]=new Sf("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);I["\u00e0"]=new Sf("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);I["\u00e1"]=new Sf("\u00e1",
Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);I["\u00e2"]=new Sf("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);I["\u00e3"]=new Sf("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);I["\u00e4"]=new Sf("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);I["\u00e5"]=new Sf("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);I["\u00e6"]=new Sf("\u00e6",Box4Intl.Box4Strings.L_LatinSmallLetterAe);I["\u00e7"]=new Sf("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);
I["\u00e8"]=new Sf("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);I["\u00e9"]=new Sf("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);I["\u00ea"]=new Sf("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);I["\u00eb"]=new Sf("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);I["\u00ec"]=new Sf("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);I["\u00ed"]=new Sf("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);I["\u00ee"]=new Sf("\u00ee",
Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);I["\u00ef"]=new Sf("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);I["\u00f1"]=new Sf("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);I["\u00f2"]=new Sf("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);I["\u00f3"]=new Sf("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);I["\u00f4"]=new Sf("\u00f4",Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);I["\u00f5"]=new Sf("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);
I["\u00f6"]=new Sf("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);I["\u00f9"]=new Sf("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);I["\u00fa"]=new Sf("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);I["\u00fb"]=new Sf("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);I["\u00fc"]=new Sf("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);I["\u00ff"]=new Sf("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);I["\u011e"]=
new Sf("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);I["\u011f"]=new Sf("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);I["\u0130"]=new Sf("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);I["\u0131"]=new Sf("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);I["\u0152"]=new Sf("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);I["\u0153"]=new Sf("\u0153",Box4Intl.Box4Strings.L_LatinSmallLigatureOe);I["\u015e"]=new Sf("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);
I["\u015f"]=new Sf("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);I["\u0178"]=new Sf("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return I}}Object(f.a)(Kh,"SymbolsLoader",null,[1860]);var Kd=b(410),dd=b(335),Gc=b(198),sd=b(605),tb=b(1274),vc=b(232),$c=b(96);class Td{constructor(I){this.f4d=I}get Izn(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}Fgi(I){I=I.SourceControlId.split("_");const ra={};2===I.length?(ra.character=
I[1],ra.index=this.f4d.bxh(ra.character)):(ra.character=I[2],ra.index=parseInt(I[1]));return ra}OXj(){return this.FDh()}build(){return this.Ahl()}KWj(){const I=new Sys.StringBuilder;I.append('<table class="moreSymbolsTable">');const ra=this.f4d.wWf.value,ab=xd.a(ra);let Fb=0;for(;Fb<ab.length;){Fb%15||I.append('<tr role="presentation">');const ac=ra[ab[Fb]];I.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+Fb,gb.a.yX(ac.d4d),gb.a.yX(ac.altText)));Fb++;Fb%15&&Fb!==ab.length||I.append("</tr>")}I.append("</table>");return I.toString()}Ahl(){const I=this.FDh();return vc.t(I)}FDh(){const I=Object.assign(new Kd.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});I.MenuSectionList.push(this.cGj());Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("InsertMoreSymbolsIsEnabled")&&I.MenuSectionList.push(this.kEj());return I}kEj(){const I=Object.assign(new dd.a,{Id:"msMoreSymbols",Title:"",DisplayMode:"Menu16",
ControlsId:"ctrlMoreSymbols",ControlList:[]}),ra=Object.assign(new Gc.a,{Id:"btnMoreSymbols",Command:Ng.a.MHc.toString(),LabelText:gb.a.Wd(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:gb.a.Wd(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:Q.AFrameworkApplication.qp,Image16by16Class:$c.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});I.ControlList.push(ra);return I}cGj(){const I=Object.assign(new dd.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),
ra=Object.assign(new sd.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),ab=this.f4d.wWf.value,Fb=xd.a(ab),ac=Math.min(25,Fb.length);for(let Md=0;Md<ac;Md++){var Xc=ab[Fb[Md]];Xc=Object.assign(new tb.a,{Id:String.format("{0}{1}_{2}","symbol_",Md,Xc.d4d),Character:Xc.d4d,Command:Ng.a.hcb.toString(),QueryCommand:Ng.a.vWd.toString(),Alt:gb.a.Wd(Xc.altText)});ra.GalleryItems.push(Xc)}I.ControlList.push(ra);
return I}}Object(f.a)(Td,"SymbolsUiBuilder",null,[1859]);var Ee=b(49),xf=b(233),cg=b(644),sh=b(371);class bh{constructor(){this.W=null}get name(){return"Box4.Symbols"}init(){Q.AFrameworkApplication.K.$("InsertSymbolIsEnabled")&&this.W.resolve("Box4.Symbols.ISymbolsActor").eb()}dispose(){}yb(I){this.W=I;this.W.register(Kh,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").singleInstance();this.W.ha("Box4.Symbols.SymbolsUiBuilder",()=>new Td(this.W.resolve("Box4.Symbols.ISymbolsLoader"))).as("Box4.Symbols.ISymbolsUIBuilder").singleInstance();
this.W.ha("Box4.Symbols.SymbolsActor",()=>new Jh(Q.AFrameworkApplication.pa,new cg.a,new sh.a,this.W.resolve("Box4.Symbols.ISymbolsUIBuilder"),xf.a.instance,Ee.a.instance,this.W.za("Box4.IExternalSelectionManager"))).as("Box4.Symbols.ISymbolsActor").singleInstance()}static main(){aa.a.instance.Lb(new bh)}}Object(f.a)(bh,"Box4SymbolsPackage",null,[1,2]);var qi=window.AccCheckerPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AccCheckerTaskPane",
Width:"300",Overflow:"auto"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AccCheckResultsPlaceHolder",IsStretched:"true",MinHeight:"400"}}]}]}]},gf=b(1450),ne=b(1396),ch=b(1381),Oe=b(1724),zb=b(240),Fh=b(407);class Lh{constructor(){this.container=this.oDa=null}yb(I){this.container=I}init(){this.oDa=this.container.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager")}dispose(){this.oDa&&this.oDa.dispose()}}Object(f.a)(Lh,"ALiveBooksAccessibilityCheckPackageManager",
null,[1,2]);class li{get Uck(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get Vck(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get Wck(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get bwm(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get yfb(){return CommonUIStrings.l_AccCheckerPaneTitle}get Dzm(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}Object(f.a)(li,"AccessibilityCheckStringsProvider",null,
[54]);class Dh{constructor(){this.rwi=this.contentId=null}}Object(f.a)(Dh,"ResultIds",null,[]);class di{constructor(I,ra){this._element=null;this.Se=ra;this.jd=I}get element(){this._element||(this._element=this.xhk(),this.nz());return this._element}vRf(I){this._element=I}dispose(){this.element&&(this.O5(),this.vRf(null))}nz(){this.Se&&this.jd?(this.Se.Ea(F.a.click,this.element,Object(x.a)(this,this.onClick,"onClick")),this.jd.Ea(F.a.ah,this.element,Object(x.a)(this,this.fE,"onKeyPress"))):ha.ULS.shipAssertTag(19789026,
334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}O5(){this.Se&&this.jd&&(this.Se.xb(F.a.click,this.element,Object(x.a)(this,this.onClick,"onClick")),this.jd.xb(F.a.ah,this.element,Object(x.a)(this,this.fE,"onKeyPress")))}onClick(){this.lRd();return!0}fE(I){return this.sNl(I.Sa.keyCode)?(this.lRd(),!0):!1}sNl(I){return I===cf.a.s_c||I===cf.a.Nq}}Object(f.a)(di,"AInteractivePaneElement",null,[98,14]);var nj=b(435),
sj=b(52);class yi extends di{constructor(I,ra,ab){super(I,ra);this.gue=ab}hide(){this.element.removeAttribute(ef.a.tg);ef.a.wo(this.element,ef.a.Rx,ef.a.$m);this.element.style.display="none"}show(){ef.a.wo(this.element,ef.a.Rx,ef.a.$H);ef.a.wo(this.element,ef.a.tg,ef.a.ZKe);this.element.style.display="block"}xhk(){const I=nj.b("div",this.t8h,"AccCheckerNotification");ef.a.wo(I,ef.a.jUg,ef.a.$m);ef.a.wo(I,ef.a.pba,this.jwf);I.tabIndex=0;const ra=nj.b("span",this.s8h,"AccCheckerNotificationIcon");var ab=
$c.createClusteredImage(16,16,"Info_16x16x32","",!0,"");ra.appendChild(ab);ab=nj.b("span",this.jwf,"AccCheckerNotificationText");sj.a.Ew(ab,this.u8h);I.appendChild(ra);I.appendChild(ab);return I}lRd(){this.gue()}}Object(f.a)(yi,"APopupNotification",di,[297,98,14]);class Cg extends yi{constructor(I,ra,ab,Fb){super(I,ra,ab);this.foa=Fb}get t8h(){return"AccCheckerOutOfSyncNotificationId"}get s8h(){return"AccCheckerOutOfSyncNotificationIconId"}get jwf(){return"AccCheckerOutOfSyncNotificationTextId"}get u8h(){return this.foa.bwm}}
Object(f.a)(Cg,"OutOfSyncNotification",yi,[]);class mi extends yi{constructor(I,ra,ab,Fb){super(I,ra,ab);this.foa=Fb}get t8h(){return"AccCheckerPartialResultNotificationId"}get s8h(){return"AccCheckerPartialResultNotificationIconId"}get jwf(){return"AccCheckerPartialResultNotificationTextId"}get u8h(){return this.foa.Dzm}}Object(f.a)(mi,"PartialResultNotification",yi,[]);var ei=b(153),If=b(126),pl=b(34),ic=b(169);class Nl{constructor(I,ra,ab,Fb=null,ac=null,Xc=null,Md=null){this.XCg=this.AJ=this.jd=
this.oDa=null;this.IKa=Fb;this.Se=I;this.fb=ra;this.Dn=ab;this.foa=Md||new li;this.Vue=ac||new Cg(this.IKa,this.Se,Object(x.a)(this,this.Buk,"dimissOutOfSyncNotification"),this.foa);this.Lve=Xc||new mi(this.IKa,this.Se,Object(x.a)(this,this.Cuk,"dimissPartialResultNotification"),this.foa)}show(){}hide(){}get IKa(){return this.jd||(this.jd=Q.AFrameworkApplication.na.zB)}set IKa(I){this.jd=I}C8g(){}fja(){}dispose(){}h1a(){}LFl(I){var ra=this.XCg[I];I=ra.contentId;if((ra=ra.rwi+"")&&ra.length){const ab=
[];Array.add(ab,Object.assign(new pl.a,{name:"RuleID",string:ra}));If.a.sendTelemetryEvent(Object.assign(new ic.a,{name:String.format("{0}.{1}",Nl.oXf,"ViolationSelected"),dataFields:ab}))}this.cgm(I)}cgm(I){I&&this.oDa.aen(I)||(this.fb.NI(ei.AFrame.YLg,!1),this.xqn())}Buk(){this.tWc(!1)}Cuk(){this.KHi(!1)}xqn(){const I=Object.assign(new df.StandardDialog(!0),{Zr:Q.AFrameworkApplication.L8,yc:1,dCa:!1});I.yY(1);I.Nd(1,this.foa.Uck);I.Nd(0,CommonUIStrings.l_DialogCancel);I.vS(this.foa.Wck,this.foa.Vck,
ra=>{1===ra&&this.khf()})}UXj(I){let ra=null;if(I.Results&&0<I.Results.length){ra={};let ab=0;for(const Fb of I.Results)Fb.ResultId=Nl.DAj+ ++ab,I=new Dh,I.contentId=Fb.ContentId,I.rwi=Fb.RuleId,ra[Fb.ResultId]=I}return ra}H7l(){If.a.addNamespaceMapping(Nl.oXf,Nl.VBn);If.a.sendTelemetryEvent(Object.assign(new ic.a,{name:String.format("{0}.{1}",Nl.oXf,"ShowTaskpane")}))}}Nl.DAj="AccCheckResult";Nl.oXf="Office.UX.AccChecker";Nl.VBn="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";
Object(f.a)(Nl,"BaseAccessibilityCheckPane",null,[56,14]);class Jo{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(f.a)(Jo,"AccCheckerTaskPaneProps",null,[]);var Nd=b(1207),be=b(1665),Di=b(1384),uh=b(189);class Uc extends Nl{constructor(I,ra,ab,Fb,ac=null,Xc=null,Md,bf=null,
Hf=null){super(ra,ab,Fb,Xc,void 0,void 0,bf);this.M8f=null;this.EBg=this.Kve=this.kcd=this.tfd=this.Ted=!1;this.bFe=null;this.ZCe=!!Q.AFrameworkApplication.na&&!!Q.AFrameworkApplication.na.Ya&&Q.AFrameworkApplication.na.Ya.umf;this.Tie=this.U1=null;this.$ke=0;this.Glg=null;this.GP=ac;Hf&&(this.U1=Hf.M3n,this.Tie=Hf.f7n,this.$ke=Hf.h8n);this.Ny=new be.a}get isVisible(){return this.EBg}eNa(I){this.EBg=I}xYe(I){I&&(this.M8f=I,I.IsSuccess&&(this.XCg=this.UXj(I),I.IsPartialResult&&this.KHi(!0)),this.Ted=
!0,this.tfd=!1,this.it())}tWc(I){this.isVisible&&I!==this.kcd&&(this.kcd=I,this.it())}KHi(I){this.Kve=I;this.it()}NM(){this.tfd||uh.UISurfaces.Ms().then(I=>{ja.a.instance.Ww(Uc.Tjb+":PaneOpen:Start");I.showTaskPane(Uc.Tjb,this.Tz());this.khf();return null});this.isVisible?uh.UISurfaces.Ms().then(I=>{I.setSelectedTaskPane(Uc.Tjb);return null}):this.H7l()}it(){uh.UISurfaces.Ms().then(I=>{I.updateTaskPane(Uc.Tjb,this.Tz());return null})}Tz(){var I=new Jo;this.Ny.cGb(I);I=Object.assign(new Di.a,{title:this.foa.yfb,
hideHeader:!1,width:320,location:2,contentProps:I,onOpen:()=>{this.o5();this.eNa(!0);Q.AFrameworkApplication.na.updateCommandUI()},onClose:()=>{this.Z9();this.eNa(!1);this.tfd=this.Ted=!1;this.it();Q.AFrameworkApplication.na.updateCommandUI()},isModernPane:!0});this.ZCe&&(I.enableResize=!0,I.minResizeWidth=268,I.maxResizeWidth=920);return I}initialize(I){const ra=this.fb.fd(Uc.Tjb);ra.parent=ei.AFrame.uo;ra.rK=!0;this.oDa=I;this.CBj()}dispose(){this.h1a();this.Vue&&(this.Vue.dispose(),this.Vue=null);
this.Lve&&(this.Lve.dispose(),this.Lve=null);super.dispose()}CBj(){this.Ny.QI(this.onRecheckExecute());this.Ny.QI(this.bQk());this.Ny.QI(this.tdl());this.Ny.QI(this.onInvokeNavigateExecute());this.Ny.QI(this.D2k());this.Ny.QI(this.J9k());this.Ny.QI(this.zal());this.Ny.QI(this.updateLastScanTime());this.Ny.QI(this.showHelpPane())}onRecheckExecute(){return I=>{I.onRecheckExecute=()=>{this.khf()}}}bQk(){return I=>{I.accessibilityCheckResultCollection=this.M8f}}tdl(){return I=>{I.resultsReady=this.Ted}}onInvokeNavigateExecute(){return I=>
{I.onInvokeNavigateExecute=ra=>{this.LFl(ra)}}}D2k(){return I=>{I.helpLink=this.aFk}}J9k(){return I=>{I.outOfSync=this.kcd}}zal(){return I=>{I.partialResult=this.Kve}}updateLastScanTime(){return I=>{I.updateLastScanTime=ra=>{this.bFe=ra}}}showHelpPane(){return I=>{I.showHelpPane=()=>{if(this.GP&&this.GP.value){const ab=this.GP.value;if(ab){var ra={};ra.query=Uc.Crj+Uc.Ogj;ra=Object.assign(new Nd.a,{rV:ra});ab.i$(Uc.Xke,ra)}}else this.Glg?this.Glg():this.U1.value&&this.Tie&&this.$ke&&this.U1.value.hb(this.$ke,
2,this.Tie)}}}khf(){this.Kve=this.kcd=this.Ted=!1;this.bFe&&this.bFe();this.it();this.tfd=!0;this.oDa.zlm()}o5(){this.fb.Kf(Uc.Tjb)}Z9(){this.YXa()&&this.fb.Kf(this.fb.$Q)}YXa(){return!!this.fb.nf&&this.fb.nf.name===Uc.Tjb}}Uc.Tjb="AccessibilityCheckerPane";Uc.Ogj="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";Uc.Xke="FA000000012";Uc.Crj="AssetID=";Object(f.a)(Uc,"ReactAccessibilityCheckPane",Nl,[]);class Qc extends Uc{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,Hf=null){super(I,ra,ab,Fb,ac,Xc,void 0,Hf);this.Adj=
bf;this.EN=Md}get aFk(){return this.Adj}NM(){this.EN.OHa();super.NM()}}Object(f.a)(Qc,"ReactLiveBooksAccessibilityCheckPane",Uc,[]);var og=b(1578),xl=b(120),sq=b(172),Tm=b(75),ri=b(161),al=b(488),Of;(function(I){I[I.error=0]="error";I[I.warning=1]="warning";I[I.tip=2]="tip";I[I.intelligentService=3]="intelligentService"})(Of||(Of={}));Object(f.b)("AccessibilityRuleCategory",Of);class zg{constructor(I,ra,ab=null){this.Q$d=null;this.xpg=this.iog=!1;this.JGa=I;this.$0c=ra;this.ga=ab;this.Eb.ka(Ya.a.k8j,
vf.a.frame,Object(x.a)(this,this.wQe,"closePane"))}get Eb(){return this.ga||(this.ga=Q.AFrameworkApplication.pa)}set Eb(I){this.ga=I}tBk(){this.iog||(this.JGa.initialize(this),this.$0c.initialize(this),this.iog=!0)}zlm(){r.b(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.$0c.$5m()}NM(I,ra,ab){if(1===ab)return Fd.SessionStatusManager.instance.gi?8:32;this.JGa.isVisible||this.tBk();this.Wrn();return 32}wQe(I,ra,ab){1!==ab&&this.JGa.fja();return 32}lAf(){this.JGa.tWc(!0)}xYe(I){if(I){if(I.AccessibilityRules&&
Object.keys(I.AccessibilityRules).length){const ab=I.AccessibilityRules;for(let Fb in ab){var ra=Fb;const ac=ab[Fb].RuleId+"";ra!==ac&&r.b(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",ra,ac)}this.Q$d=ab}else!this.Q$d&&I.Results&&0<I.Results.length?(r.b(18993251,200,15,"No accessibility rule definitions available"),I.IsSuccess=!1):I.AccessibilityRules=this.Q$d;I.IsSuccess||r.b(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.wWm(I);this.q7l(I);this.JGa.xYe(I)}}wWm(I){const ra=
I.AccessibilityRules;if(I=I.Results)for(let ab=I.length-1;0<=ab;ab--){const Fb=I[ab];let ac="";const Xc=Fb.RuleId;Fb.ContentName||(ac+="Result does not have content name. ");Xc in ra||(ac+=String.format("No accessibility check rule exists for ID {0}.",Xc));0<ac.length&&(r.b(36214999,200,15,"Omitting invalid accessibility check result: "+ac),Array.removeAt(I,ab))}}Bel(){return Q.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):ia.a.instance.resolve("Common.IDynamicScriptLoaderProvider").$C.loadScript("accessibility-checker-pane-strings")}Wrn(){this.xpg?
this.JGa.NM():this.Bel().then(()=>{this.xpg=!0;this.JGa.NM()}).catch(I=>ha.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",I))}q7l(I){var ra={};const ab={};var Fb=I.Results,ac=[];Array.add(ac,Object.assign(new pl.a,{name:"FinalViolationCount",int64:0}));Array.add(ac,Object.assign(new pl.a,{name:"FinalErrorCount",string:"0"}));Array.add(ac,Object.assign(new pl.a,{name:"FinalWarningCount",string:"0"}));Array.add(ac,Object.assign(new pl.a,{name:"FinalTipCount",
string:"0"}));Array.add(ac,Object.assign(new pl.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(Fb){for(const bf of Fb)if(I.AccessibilityRules){var Xc=I.AccessibilityRules[bf.RuleId];if(Xc){if(ra[Of[Xc.Category]]){let Hf=ra[Of[Xc.Category]];ra[Of[Xc.Category]]=++Hf}else ra[Of[Xc.Category]]=1;ab[bf.RuleId]?(Xc=ab[bf.RuleId],ab[bf.RuleId]=++Xc):ab[bf.RuleId]=1}}ac[0].int64=Fb.length;for(var Md in ra)switch(I=ra[Md],Fb=Md,Fb="Final"+Fb.charAt(0).toUpperCase()+Fb.substring(1,Fb.length)+"Count",
Fb){case "FinalErrorCount":ac[1].string=I.toString();break;case "FinalWarningCount":ac[2].string=I.toString();break;case "FinalTipCount":ac[3].string=I.toString();break;case "FinalIntelligentServiceCount":ac[4].string=I.toString()}}If.a.sendTelemetryEvent(Object.assign(new ic.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:ac}));for(let bf in ab)ra=bf,ac=ab[bf],Md=[],Array.add(Md,Object.assign(new pl.a,{name:"RuleID",string:ra})),Array.add(Md,Object.assign(new pl.a,
{name:"FinalViolationCount",string:ac.toString()})),If.a.sendTelemetryEvent(Object.assign(new ic.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Md}))}dispose(){this.JGa&&this.JGa.dispose();this.$0c&&this.$0c.dispose()}}Object(f.a)(zg,"AAccessibilityCheckManager",null,[53,14]);var Dl=b(434);class Cm extends zg{constructor(I,ra,ab){super(ra,ab,I);this.graph=null}zli(I,ra,ab,Fb,ac){if(1===ab)return 32;ac[Dl.a.On]=this.JGa.isVisible;return 32}iTm(){for(const I of this.e8h){const ra=
this.graph.Yd(I);ra.Yl(Object(x.a)(this,this.Df,"onPropertyChanged"));ra.Yo(Object(x.a)(this,this.tC,"onConnected"));ra.Mt(Object(x.a)(this,this.uOc,"onDisconnected"))}}HKn(){for(const I of this.e8h){const ra=this.graph.Yd(I);ra.WI(Object(x.a)(this,this.Df,"onPropertyChanged"));ra.oE(Object(x.a)(this,this.tC,"onConnected"));ra.R9(Object(x.a)(this,this.uOc,"onDisconnected"))}}dispose(){super.dispose();this.HKn()}Df(){this.lAf()}tC(){this.lAf()}uOc(){this.lAf()}}Object(f.a)(Cm,"ALiveBooksAccessibilityCheckManager",
zg,[]);class bo extends Cm{constructor(I,ra,ab,Fb,ac,Xc){super(I,ra,ab);this.Eb.ka(Ya.a.TSf,vf.a.frame,Object(x.a)(this,this.NM,"showPane"));this.Eb.Aa(Ya.a.dKm,vf.a.frame,Object(x.a)(this,this.zli,"queryToggleAccCheckerPane"),96);this.graph=ac;this.Ymj=Fb;this.Gjj=Xc;this.iTm()}get e8h(){return[12,14,22,19,30,43,44]}aen(I){if(this.Gjj)return ha.ULS.sendTraceTag(20713608,334,15,"ODT file. Disable content navigation."),!0;ha.ULS.shipAssertTag(20272215,334,!!I);return this.Ymj.Yfm(I)}}Object(f.a)(bo,
"WordAccessibilityCheckManager",Cm,[]);var Ol=b(89),El=b(30),jp=b(130),ii=b(21),Yb=b(175),dh=b(6),of=b(20),Dm=b(461);class kg{constructor(I,ra,ab,Fb,ac,Xc,Md){this.un=null;this.wub=0;this.Vb=ra;this.dw=ab;this.ya=Fb;this.ga=ac;this.Rb=Xc;this.Fs=I;this.oc=Md}get sP(){if(!this.un){const I=this.Vb.ff(this.Fs.Zb);this.dw.EZf(I);if(I.La(7)||I.mc(7))this.un=Ol.a.eq(I,I.origin)}return this.un}Yfm(I){if(!I||!I.qf||0>=I.qf.length)return ha.ULS.shipAssertTag(20272217,334,!1,"ContentId is null or invalid."),
!1;var ra=Array(I.qf.length);let ab=7,Fb=null;for(let Xc=0;Xc<I.qf.length;Xc++)if(Fb=this.JIk(I.qf[Xc])){if(7===ab)ab=this.wub;else if(ab!==this.wub)return ha.ULS.shipAssertTag(20272218,334,!1,"Two paragraphs in a range selections don't belong to the same view."),!1;var ac=this.oc.PLa(Fb.characterData,Fb.la);const Md=I.cpBegin?this.oc.Wtb(ac,I.cpBegin):-1;ac=I.cpEnd?this.oc.Wtb(ac,I.cpEnd):-1;if(-1>Md||-1>ac)return ha.ULS.shipAssertTag(20272219,334,!1,"Fail to convert WordTextOffset to WAC cp. Reset Cps to -1."),
!1;ra[Xc]=El.a.dM(Md,ac,!1,Fb);switch(I.contentType){case 5:if(!jp.HyperlinkReader.GIh(ra[Xc],!1))return!1;break;case 6:if(!ii.ImageReader.S8(ra[Xc]))return!1;break;case 7:ra[Xc]=El.a.dM(-1,-1,!1,Fb)}}else return!1;ra=new Yb.Selection(ra,!1);return this.Rin(Fb,ra,I.contentType)}JIk(I){if(this.sP)for(this.sP.reset(),this.wub=7;this.sP.moveNext();){var ra=this.sP.currentNode.type;if(38===ra||36===ra||23===ra)this.wub=ra;else if(12===ra){ra=this.sP.currentNode;const ab=ra.ia(dh.a.Ib,0);if(I===ab)return ra}}return null}tWf(I){this.ga.processAction(of.a.jX,
2);this.ga.processAction(of.a.Vba,2);let ra=2;switch(this.wub){case 23:ra=32;break;case 38:ra=this.ga.hb(of.a.hfb,2,new Dm.a(I));break;case 36:ra=this.ga.hb(of.a.hBb,2,new Dm.a(I));break;default:ha.ULS.shipAssertTag(20272220,334,!1,"Unexpected search scope encountered: {0}",this.wub)}if(32===ra)return!0;ha.ULS.shipAssertTag(20272221,334,!1,"Fail to switch to target view: {0}",this.wub);return!1}Rin(I,ra,ab){if(this.tWf(I)){I=this.Fs.Su;const Fb=this.ya.Ca.Fa;Fb&&Fb.equals(ra)&&this.Rb.$Ba(I,null);
this.Rb.$Ba(I,ra);switch(ab){case 0:case 1:this.ga.processAction(Ng.a.FFb,2);break;case 2:this.ga.processAction(Ng.a.yUc,2);break;case 3:this.ga.processAction(Ng.a.cla,2)}return!0}return!1}}Object(f.a)(kg,"WordAccessibilityCheckNavigateManager",null,[1964]);class Um{constructor(I){this.oDa=null;this.dkg=I}get fileId(){return this.dkg?this.dkg():null}initialize(I){this.oDa=I}n$h(I){this.oDa.xYe(I)}}Object(f.a)(Um,"AAccessibilityCheckService",null,[55,14]);class Vm{constructor(){this.AccessibilityRules=
null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(I){I=Sys.Serialization.JavaScriptSerializer.deserialize(I);const ra=I.AccessibilityRules,ab={};if(ra)for(let Fb=0;Fb<ra.length;++Fb){const ac=ra[Fb];ab[ac.Key]=ac.Value}I.AccessibilityRules=ab;return I}}Object(f.a)(Vm,"AccessibilityCheckResultCollection",null,[]);class An extends Um{constructor(I){super(I)}onFailure(I,ra){ha.ULS.shipAssertTag(20730842,334,!1,"Acc Checker force save failed! StatusCode:{0}",ra);I=Object.assign(new Vm,
{IsSuccess:!1});this.n$h(I)}onSuccess(I){I=An.rdl(I);let ra=null;if(I)try{ra=this.nsk(I)}catch(ab){ha.ULS.shipAssertTag(20730843,334,!1,"AccChecker response data is invalid. [{0}]",ab.message),ra=Object.assign(new Vm,{IsSuccess:!1})}else ha.ULS.shipAssertTag(20730844,334,!1,"AccChecker response is NULL."),ra=Object.assign(new Vm,{IsSuccess:!1});this.n$h(ra)}dispose(){}static rdl(I){let ra=null;I&&I.Vi&&(ra=I.Vi[0]);return ra?ra.Body:null}}Object(f.a)(An,"ALiveBooksAccessibilityCheckService",Um,[]);
var xg=b(955),tk=b(229);class yl extends tk.a{constructor(){super();this.FileId=null;this.IsCoauthorable=!1}ol(){return 56}static construct(I,ra){const ab=new yl;ab.FileId=I;ab.IsCoauthorable=ra;return ab}}Object(f.a)(yl,"WordAccessibilityCheckRequest",tk.a,[]);class Wm{}Object(f.a)(Wm,"AccessibilityCheckRule",null,[]);var Be=b(145);class Ed{static parse(I){switch(gb.a.kg(I)){case "warnings":return 1;case "tips":return 2;case "errors":return 0;case "intelligentservices":return 3;default:throw I=String.format("Invalid Accessibility result category: {0}",
I),Be.a.argument(I);}}}Object(f.a)(Ed,"AccessibilityRuleCategoryParser",null,[]);class zi{constructor(){this.Category=this.Text=this.Id=null}static LDn(I){const ra=new Wm;ra.RuleId=I.Id;ra.RuleName=I.Text;ra.Category=Ed.parse(I.Category);return ra}}Object(f.a)(zi,"WordAccessibilityCheckRule",null,[]);class fi{}Object(f.a)(fi,"AccessibilityCheckResult",null,[]);class zl{constructor(){this.cpEnd=this.cpBegin=this.qf=null;this.contentType=0}}Object(f.a)(zl,"WordAccessibilityCheckContentId",null,[]);
const Qk=I=>{switch(gb.a.kg(I)){case "tableheading":return 0;case "tablerow":return 1;case "tablecolumn":return 2;case "table":return 3;case "textcontrast":return 4;case "hyperlink":return 5;case "inlinepicture":return 6;case "anchoredepicture":return 7;default:return 8}};var kk=b(1410);class $l{constructor(){this.OE=this.OS=this.ContentType=this.Label=this.RuleId=this.ParaId=null}static JDn(I){const ra=new fi;ra.RuleId=I.RuleId;ra.ContentName=I.Label;const ab=new zl;ab.qf=I.ParaId;ab.cpBegin=kk.b(I.OS);
ab.cpEnd=kk.b(I.OE);ab.contentType=Qk(I.ContentType);ra.ContentId=ab;return ra}}Object(f.a)($l,"WordAccessibilityViolation",null,[]);class tp{constructor(){this.Violations=this.Rules=null}static KDn(I){const ra=new Vm;try{var ab={};if(I.Rules){for(let Fb=0;Fb<I.Rules.length;++Fb){const ac=zi.LDn(I.Rules[Fb]);ab[ac.RuleId]=ac}ra.AccessibilityRules=ab}if(I.Violations){const Fb=Array(I.Violations.length);for(ab=0;ab<I.Violations.length;++ab)Fb[ab]=$l.JDn(I.Violations[ab]);ra.Results=Fb}ra.IsPartialResult=
!1;ra.IsSuccess=!0}catch(Fb){ha.ULS.shipAssertTag(20272214,334,!1,"Failed to convert WordAccessibilityCheckResult to AccessibilityCheckResultCollection. [{0}]",Fb.message),ra.IsSuccess=!1}return ra}}Object(f.a)(tp,"WordAccessibilityCheckResult",null,[]);class Fl extends An{constructor(I,ra,ab){super(I);this.UMb=ra;this.gnb=ab}$5m(){const I=Object.assign(new xg.a,{Kq:yl.construct(this.fileId,this.gnb),status:1,GF:"AccessibilityCheck"});this.UMb(12,!1,Object(x.a)(this,this.onSuccess,"onSuccess"),Object(x.a)(this,
this.onFailure,"onFailure"),I,null,I)}nsk(I){I=va.b(I);return tp.KDn(I)}}Object(f.a)(Fl,"WordAccessibilityCheckService",An,[]);class Dp extends Lh{constructor(){super()}get name(){return"WordEditor.AccessibilityChecker"}yb(I){super.yb(I);I.ha("Common.App.AccessibilityChecker.IAccessibilityCheckPane",()=>new Qc(Q.AFrameworkApplication.pa,zb.a.instance,Eg.FocusManager.instance(),Fh.a.instance,I.te("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),wc.KeyInputManager.instance,og.a.instance,Q.AFrameworkApplication.K.Ga("AccessibilityCheckerHelpUrl"))).singleInstance();
I.ha("Common.App.AccessibilityChecker.IAccessibilityCheckService",()=>new Fl(()=>Q.AFrameworkApplication.rootQuerySignature,al.a.jO,xl.PageReader.instance.lAd(pf.App.oa.Da.Zb))).singleInstance();I.ha("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager",()=>new kg(pf.App.oa.Da,I.resolve("Box4.Graph.IGraphIteratorFactory"),sq.PageNavigator.instance,I.resolve("Box4.ISelectionManager"),Q.AFrameworkApplication.pa,Tm.InteractiveViewManager.instance,I.resolve("WordEditor.WordTextOffsetTranslator.IWordTextOffsetTranslator"))).singleInstance();
I.ha("Common.App.AccessibilityChecker.IAccessibilityCheckManager",()=>new bo(Q.AFrameworkApplication.pa,I.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),I.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),I.resolve("WordEditor.AccessibilityChecker.WordAccessibilityCheckNavigateManager"),pf.App.aj.Pk,ri.App.KJc)).singleInstance()}init(){ri.App.r8d&&this.container.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{Lh.prototype.init.call(this)})}}Object(f.a)(Dp,
"WordAccCheckerPackageManager",Lh,[]);class cn{constructor(I,ra){this.CHg=!1;this.Mi=I;this.a_=ra}Seb(I){I.XU.KJj(Object(x.a)(this,this.CGn,"triggerWebToWebActiveCoauthSurveysEventHandler"))}CGn(){this.BGn()}BGn(){!this.CHg&&this.Mi&&(this.Mi.gAa?this.a_?this.a_.execute(I=>{I.logActivity("WordWebToWebActiveCoauth","WebToWebActiveCoauthFloodgateSurveyIsEnabled")}):ha.ULS.sendTraceTag(51389134,304,10,"Future ISystemInitiatedFeedback not available"):this.CHg=!0)}}Object(f.a)(cn,"CoauthSurveyManager",
null,[1858]);class Ck{constructor(){this.Fs=this.W=null}get name(){return"WordEditor.CoauthSurveys"}init(){pf.App.oa&&(this.Fs=pf.App.oa.Da)&&(this.Fs.Qqa?this.Eea():this.Fs.lba(()=>{this.Eea()}))}Eea(){var I=this.Fs.Zb;I&&(I=I.contentReplicator)&&this.W.resolve("WordEditor.CoauthSurveys.CoauthSurveyManager").Seb(I)}dispose(){}yb(I){this.W=I;I.ha("WordEditor.CoauthSurveys.CoauthSurveyManager",()=>new cn(I.resolve("WordEditor.IWordEditorCoauthManager"),I.za("Common.ISystemInitiatedFeedback"))).as("WordEditor.CoauthSurveys.ICoauthSurveyManager").singleInstance()}static main(){Q.AFrameworkApplication.K.$("CoauthSurveysPackageIsEnabled")&&
aa.a.instance.Lb(new Ck)}}Object(f.a)(Ck,"WordEditorCoauthSurveyManagerPackage",null,[1,2]);var dn;(function(I){I[I.graphSpaceReplicatorNotSendingContent=0]="graphSpaceReplicatorNotSendingContent";I[I.inboundRequestTakesTooLongToSendAfterRTC=1]="inboundRequestTakesTooLongToSendAfterRTC";I[I.docxSaveMonitorKickoutElapsed=2]="docxSaveMonitorKickoutElapsed"})(dn||(dn={}));Object(f.b)("ComponentLoggingScenario",dn);var Km=b(1259);class am{flush(I,ra){const ab=this.TYk(I);ab.LoggingScenario=dn[ra];xd.a(ab).length?
ha.ULS.sendTraceTag(594571986,3013,15,"{0}",ab):ha.ULS.sendTraceTag(594571987,3013,15,"No log returned when component state log manager trying to log with {0}",Km.a[I.LTa])}TYk(I){const ra={};if(!I)return ra;const ab=new qh.a;for(ab.enqueue(I);!ab.isEmpty;){I=ab.dequeue();const Fb=Km.a[I.LTa];try{ra[Fb]=I.qI()}catch(ac){ha.ULS.sendTraceTag(594571985,3013,15,"Exception when component state log manager trying to log with {0}, details: {1}",Fb.toString(),{["Kind"]:"Exception",["Stack"]:ac.stack,["Message"]:ac.message,
["FileName"]:ac.fileName,["LineNumber"]:ac.lineNumber})}if((I=I.nqd)&&I.length)for(let ac of I)!ac||Km.a[ac.LTa]in ra||ab.enqueue(ac)}return ra}}Object(f.a)(am,"ComponentStateLogManager",null,[1855]);class kp{flush(){}}Object(f.a)(kp,"NoOpComponentStateLogManager",null,[1855]);class uk{constructor(){this.W=null}get name(){return"WordEditor.ComponentStateLogging"}init(){this.W.resolve("Common.IComponentStateLogManager")}dispose(){}yb(I){this.W=I;Q.AFrameworkApplication.K.$("ComponentStateLoggingPackageIsEnabled")?
I.ha("WordEditor.ComponentStateLogging.ComponentStateLogManager",()=>new am).as("Common.IComponentStateLogManager").singleInstance():I.ha("WordEditor.ComponentStateLogging.NoOpComponentStateLogManager",()=>new kp).as("Common.IComponentStateLogManager").singleInstance()}static main(){aa.a.instance.Lb(new uk)}}Object(f.a)(uk,"WordEditorComponentStateLoggingPackage",null,[1,2]);var Gj=b(1803);class Ko{constructor(I,ra,ab){this.Qe=I;this.Agd=ra;this.CBg=ab}ai(I,ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg=null,gi=!1,Ei=
null,Il=null,Kk=null,nm=null,Rf=!1){return this.CBg?this.Agd.ai(I,ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg,gi,Il,Kk):this.Qe.ai(I,ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg,gi,Ei,Il,Kk,nm,Rf)}E_b(I){return this.CBg?this.Agd.E_b():this.Qe.E_b(I)}}Object(f.a)(Ko,"ClientRequestAdapter",null,[902]);var vo=b(173),Ij=b(253),Sn=b(250),Pp=b(1227),Bn=b(1804),Lo=b(1216),bk=b(269),bm=b(48),Pl=b(663),hm=b(558),Ti=b(119),Al=b(626),ck=b(440),Rh;(function(I){I[I.none=0]="none";I[I.getCells=1]="getCells";I[I.hotStoreStatus=2]="hotStoreStatus";
I[I.saveMonitor=3]="saveMonitor";I[I.saveMonitor_LineageTombstone=4]="saveMonitor_LineageTombstone";I[I.kickoutExecutor=5]="kickoutExecutor"})(Rh||(Rh={}));Object(f.b)("MostRecentRevisionIdOrigin",Rh);class Fm extends Sys.EventArgs{constructor(I,ra,ab,Fb){super();this.t4b=I;this.Vum=ra;this.httpStatusCode=ab;this.oB=Fb}}Object(f.a)(Fm,"UpdatedLastRevisionSaveIdEventArgs",Sys.EventArgs,[]);class Jj{constructor(){this.V2=0}get isEmpty(){return!this.V2}Utc(I){this.V2|=I}gKc(I){return!!(this.V2&I)}clear(){this.V2=
0}Pvc(){return!1}}Object(f.a)(Jj,"DocxSaveMonitorRetryAttemptOnce",null,[]);class Uf{constructor(I,ra=3){this.V2=0;this.Wed=new Map;this.pmj=I;this.Ssj=ra}get isEmpty(){return!this.V2}Utc(I){this.V2|=I;let ra=this.Wed.get(I)||0;this.Wed.set(I,++ra)}gKc(I){return!!(this.V2&I)}clear(){this.V2=0;this.Wed.clear()}Pvc(I){return this.Ssj&I?(this.Wed.get(I)||0)<this.pmj:!1}}Object(f.a)(Uf,"DocxSaveMonitorRetryAttemptMany",null,[]);class Fg{static create(I=!1,ra=3,ab=0){return I?new Uf(ra,ab):new Jj}}Object(f.a)(Fg,
"DocxSaveMonitorRetryAttemptFactory",null,[]);var on=b(1544),De;(function(I){I[I.q$n=-1]="noResultYet";I[I.teo=0]="upToDate";I[I.dco=1]="sessionLost";I[I.zeo=2]="userSignedOut";I[I.Qao=3]="previousRequestPending";I[I.PYd=4]="requestFailed";I[I.xco=5]="shuttingDown";I[I.v$n=6]="nullResponseData";I[I.K8n=7]="invalidResponseData";I[I.$6n=8]="failedRevisionLookup";I[I.Hbo=9]="savedWithinThreshold";I[I.s$n=10]="notSavedWarning";I[I.a9n=11]="kickoutThreshold";I[I.eeo=12]="unknownRevision";I[I.i5n=13]="contentNotYetLoaded";
I[I.sessionExpired=14]="sessionExpired";I[I.canaryError=15]="canaryError";I[I.timeout=16]="timeout";I[I.b9n=17]="kickoutThreshold_Offline";I[I.j6n=18]="dssSessionDeleted";I[I.k6n=19]="dssSessionExpired";I[I.Ieo=20]="waitingForSessionTokenRefresh";I[I.l6n=21]="dssSessionNotFound"})(De||(De={}));Object(f.b)("SaveMonitorResult",De);var bl=b(59);class Zd{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg,gi,Ei,Il,Kk,nm,Rf,Jp,Gu,Pi,Zt,Et,xs,fm,iv,za,Qa=null,Da,ua){this.rnc=0;this.gOb=!1;this.cqc=null;this.Rlc=this.BL=
-1;this.Jwe=null;this.wdd=0;this.xdd=!1;this.zob=null;this.aoc=0;this.yze=this.OIg=null;this.PP=this.xsg=this.Wge=0;this.Nqe=null;this.zpg=!1;this.Ip=null;this.Bgd=0;this.FRb=I;this.b4a=ra;this.Q4a=I;this.iLg=ab;this.Muj=Fb;this.Xpe=ac;this.Frj=Xc;this.cAe=Md;this.pPb=bf;this.Zfg=Hf;this.Dde=Zg;this.fG=gi;this.D6=Ei;this.Ijc=Il;this.wkj=Kk;this.kOb=nm;this.$oe=Rf;this.pN=Jp;this.Mw=Gu;this.Bsj=Pi;this.zpg=za;this.aPa=Fg.create(ua.isEnabled,ua.NMc,xs.V2);this.Iye=new ck.a;this.Lje=fm;this.Hx=new Pp.a(-1);
this.Ve=Qa;this.hD=Da;this.Hx.NIe(Object(x.a)(this,this.I3m,"resultStateChanged"));this.Hed=Zt;this.Inb=Gu();this.bng=Et;this.l7i=ua.isEnabled?null:xs;this.Lkb=iv;this.RIg=this.iLg;this.Pse=yd.a.nil;this.ma=new u.a;ia.a.instance.za("Common.App.VisibilityManagement.IVisibilityManager").execute(Ta=>{this.Ip=Ta;this.Ip.zTb((wb,Kb)=>{this.cja(wb,Kb)});this.Uwe=Ta.pD});(this.Luj=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IgnoreOldErrorsAfterReconnectIsEnabled",
!1):!1)&&this.Ve&&this.Ve.zIe((Ta,wb)=>{this.DCb(Ta,wb)});this.MFg=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LastSavedToHostDetailsIsEnabled",!1):!1;this.Tsj=ua}DCb(I,ra){ha.ULS.sendTraceTag(528577692,Zd.Qm,15,"DocxSaveMonitor: AppNetworkChanged event raised. OldState: [{0}], NewState: [{1}]",Bn.a[ra.Zwf],Bn.a[ra.BNc]);1!==ra.BNc&&3!==ra.BNc&&(ha.ULS.sendTraceTag(528566343,Zd.Qm,50,"Resetting list of current failed request retries. State before resetting is - Canary: [{0}], Timeout: [{1}]",
this.aPa.gKc(1),this.aPa.gKc(2)),this.aPa.clear())}get eud(){return this.Wge}get lNc(){return this.Pse}get aYa(){return!this.Pwb()||this.lNc.equals(this.Pwb().id)}get wTh(){return this.Mw().getTime()-this.Inb.getTime()>this.Xpe}get pxc(){return this.PP}get LTa(){return 3}get nqd(){let I=null;pf.App.oa&&pf.App.oa.Da&&pf.App.oa.Da.Zb&&(I=pf.App.oa.Da.Zb.contentReplicator);return[I,ri.App.PY]}cja(){var I,ra,ab;const Fb={["VisibilityState"]:Lo.a[this.Ip.pD],["IsVisible"]:this.Ip.isVisible,["DocxSaveMonitor"]:{["RequestPending"]:this.gOb,
["KickoutIntervalElapsed"]:this.wTh,["LastSuccessfulIterationTime"]:null!==(I=this.Inb)&&void 0!==I?I:"null",["RequestStartTime"]:null!==(ra=this.cqc)&&void 0!==ra?ra:"null",["SkippedKickouts"]:this.Bgd,["LastSkippedKickoutAt"]:null!==(ab=this.Csg)&&void 0!==ab?ab:"null"},["IsViable"]:this.Ve.wra,["IsNetworkConnected"]:this.Ve.pK,["IsExpired"]:this.Ve.Wqa,["HasEmergencyViewModeBeenDeployed"]:this.Ve.gi,["Navigator.Online"]:window.navigator.onLine};ha.ULS.sendTraceTag(539874775,Zd.Qm,50,va.c(Fb));
this.Uwe!=this.Ip.pD&&(0===this.Ip.pD?bl.c(of.a.rVj,void 0,void 0,void 0,void 0,void 0,Fb):0===this.Uwe&&bl.c(of.a.sVj,void 0,void 0,void 0,void 0,void 0,Fb),this.Uwe=this.Ip.pD)}start(){this.Wge=this.Zfg.w9a(Object(x.a)(this,this.OJk,"fireRequestIfNecessary"),this.Q4a)}bOa(I){if(!this.eud||this.Q4a===I)return!1;const ra=this.Q4a;this.Q4a=I;this.stop("changing save monitor interval from "+ra+"ms to "+I+"ms");this.start();return!0}K$b(I,ra){if(ra>=this.rnc&&I&&!yd.a.nil.equals(I)){var ab=!this.Pse.equals(I);
this.rnc=ra;this.Pse=I;const Fb=this.Mw();this.yze=Fb;const ac=this.aYa;ab&&(ra={["Id"]:I.toString(),["IsUpToDate"]:ac,["Origin"]:Rh[ra]},this.Nqe&&(ra.LastUpToDateTime=this.Nqe.toISOString()),(ab=this.w6e())&&ab.store&&(I=ab.store.getRevision(I))&&(ra.LastSavedCreationTime=I.creationTime.toISOString()),ha.ULS.sendTraceTag(557320151,Zd.Qm,50,"Updating Last Saved Revision: {0}",ra));ac&&(this.Nqe=Fb)}else ra<this.rnc?ha.ULS.sendTraceTag(572051800,Zd.Qm,50,'Deny lower rank origin: {{"CurrentOrigin":"{0}", "Attempt":"{1}"}}',
this.rnc,ra):ha.ULS.sendTraceTag(572051801,Zd.Qm,15,'Deny null or Nil ID: {{"Attempt":"{0}"}}',ra)}stop(I){this.me(I)}me(I){this.eud&&(ha.ULS.sendTraceTag(5830084,Zd.Qm,50,"Stopping DocxSaveMonitor because {0}!",I),this.Zfg.me(this.eud),this.Wge=0)}OJk(){var I;ha.ULS.sendTraceTag(524871194,Zd.Qm,50,"DocxSaveMonitor tick: {0}",{["IsUpToDate"]:this.aYa,["AppVisibilityState"]:Lo.a[null===(I=this.Ip)||void 0===I?void 0:I.pD]});I=this.Inb;this.Inb=this.Mw();if(this.pN())this.Hx.event(5),this.stop("session has shut down");
else{this.Q4a===Zd.mvi&&this.bOa(this.b4a);var ra=this.Ijc();if(ra)if(this.$oe()&&Q.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordDocxSaveMonitorWaitForTokenRefreshSettings"),this.aYa)this.Hx.event(0);else if(this.kOb())this.Hx.event(1),this.stop("session is lost"),Q.AFrameworkApplication.Mg("WordKickoutSafetyCheck;WordKickoutSafetyCheckcf"),this.zpg&&!this.tNl()&&(ha.ULS.sendTraceTag(554726995,Zd.Qm,10,"DocxSaveMonitor: Session lost but not kicked out"),this.Aw(bm.a.qfh));
else if(this.$oe())20!==this.Hx.currentState?(this.Hx.event(20),this.OIg=this.Mw(),ha.ULS.sendTraceTag(593510691,Zd.Qm,15,"Detected that session is expired. DocxSaveMonitor will wait for {0}ms to see if we can refresh the access token.",this.RIg)):this.Mw().getTime()-this.OIg.getTime()>this.RIg&&(this.Hx.event(14),this.stop("Waited too long for session token to be refreshed"),this.Aw(bm.a.dud));else if(this.wkj())if(this.Inb=I,this.gOb)this.Hx.event(3),this.Mw().getTime()-this.cqc.getTime()>this.Xpe&&
(I=this.Dde.E_b(this.BL),ha.ULS.sendTraceTag(19161610,205,50,"DocxSaveMonitorKickout: Status for presumably pending request {0} is {1}",this.BL,wi.a[I]),this.Hed&&this.Hed.log(),this.stop("stuck on previousRequestPending"),this.Aw());else if(I=hm.b(on.a.construct(ra)),this.gOb=!0,this.cqc=this.Bsj(),this.BL=this.Dde.ai(Zd.serviceUrl,2,I,{"Content-Type":"application/json; charset=utf-8"},!1,0,Object(x.a)(this,this.O4j,"checkSaveRequestSucceeded"),Object(x.a)(this,this.N4j,"checkSaveRequestFailed"),
null,void 0,void 0,this.Frj,this.cAe,void 0,void 0,!0),0>=this.BL)this.gOb=!1,ha.ULS.sendTraceTag(19161611,205,50,"DocxSaveMonitorKickout: Request {0} was not added to the queue.",this.BL.toString());else{I=this.Dde.E_b(this.BL);ra=100;if(I&&1!==I||this.bng)ra=50;ha.ULS.sendTraceTag(19161612,Zd.Qm,ra,"DocxSaveMonitor: Sending Request {0}",{["Id"]:this.BL,["Status"]:wi.a[I]});this.Hed&&this.Hed.start(this.BL)}else this.Hx.event(2);else this.Hx.event(13)}}qpl(){if(0>=this.pPb)return!1;var I=this.h9k();
if(!I)return this.Jwe=null,this.wdd=0,this.xdd=!1;this.zob=I.Zwd;this.zob===this.Jwe?this.wdd++:(this.Jwe=this.zob,this.wdd=1,this.xdd=!1);if(this.wdd<Zd.bem)return!1;this.aoc=+this.Mw()-+this.zob;if(this.aoc<=this.pPb)return!1;if(!this.xdd)return this.xdd=!0,this.qmi(),!1;if(this.Lkb)this.Lkb.execute(ra=>{ra.flush(this,0)});else{I="";try{this.Lje&&(I=this.Lje())}catch(ra){I=va.c({["Kind"]:"Exception",["Stack"]:ra.stack,["Message"]:ra.message,["FileName"]:ra.fileName,["LineNumber"]:ra.lineNumber}),
ha.ULS.sendTraceTag(50426817,Zd.Qm,15,"Exception when getting log extra details for exceeding max allowed local revision age. {0}",I)}ha.ULS.sendTraceTag(50426818,Zd.Qm,15,"Oldest local revision was created at {0} which is {1}ms ago and exceeds max allowed age of {2}ms.  Extra Details: {3}",this.zob.toISOString(),this.aoc,this.pPb,I)}this.pPb=-1;this.stop("Exceeded oldest allowed local revision");this.Aw(bm.a.Qxk);return!0}h9k(){let I=null,ra=this.Pwb();for(;ra&&!ra.qra;)I=ra,ra=ra.Zl;return I}iSl(){return this.kOb()?
(this.Hx.event(1),this.stop("session is lost"),!0):this.$oe()?(this.Hx.event(14),ha.ULS.sendTraceTag(20029718,Zd.Qm,15,"ExpiredSessionNotLostYet"),this.stop("session is expired"),this.Aw(bm.a.dud),!0):!1}w6e(){const I=this.Ijc();return I?I.Mb:null}Pwb(){const I=this.w6e();return I?I.sm:null}Pvc(I){return this.Tsj.isEnabled?this.aPa.Pvc(I):this.l7i.gKc(I)&&!this.aPa.gKc(I)}N4j(I){this.PP=this.pxc+1;let ra=this.gOb=!1,ab=!1;I=I.data;Ga.a.qk&&Q.AFrameworkApplication.kda("MultipleRetriesForDocxSaveMonitor_t;MultipleRetriesForDocxSaveMonitor_c");
I?(ha.ULS.sendTraceTag(22552773,Zd.Qm,15,"Request failed {0}",{["Status"]:I.status,["HttpStatus"]:I.we,["Correlation"]:I.oj?I.oj[bk.a.L3]:"",["Id"]:I.id,["ConsecutiveErrors"]:this.pxc,["Request.InvokedTime"]:I.yF,["Request.EnqueueTime"]:I.hIa,["Request.CompletedTime"]:I.VQ}),ab=7===I.status||13===I.status,this.Pvc(2)&&ab?(this.aPa.Utc(2),ra=!0,this.Rlc=I.we,this.Hx.event(16)):this.Pvc(1)&&5===I.status?(this.aPa.Utc(1),ra=!0,this.Rlc=I.we,this.Hx.event(15)):(this.Hx.event(4),this.Rlc=I.we)):(this.Hx.event(4),
ha.ULS.sendTraceTag(23425240,Zd.Qm,15,"RequestFailed and event data is null"));if(!ra&&(this.aPa.clear(),ab?this.znf(17,bm.a.Pxk,"while offline"):this.znf(11,bm.a.XYe,"while online")))return;this.bOa(ra?this.wSk(ab):this.b4a)}wSk(I){return I?Zd.EDn:Zd.mvi}znf(I,ra,ab){if(this.wTh)if(this.Ip&&!this.Ip.isVisible)ha.ULS.sendTraceTag(540669727,Zd.Qm,15,"Kickout interval has elapsed, but browser tab is not visible. We will not kick out immediately"),this.Bgd+=1,this.Csg=this.Mw();else return this.Hx.event(I,
{}),this.stop("request failed after kickout interval "+ab),this.Lkb&&this.Lkb.execute(Fb=>{Fb.flush(this,2)}),this.Aw(ra),!0;return!1}O4j(I){this.PP=this.pxc+1;this.gOb=!1;var ra={};this.aPa.clear();if(I=I.data){var ab=I.oj?I.oj[bk.a.L3]:"";ra.HttpStatus=I.we;ra.Correlation=ab;ra.Id=I.id;ha.ULS.sendTraceTag(23425242,Zd.Qm,this.bng?50:100,"Request succeeded at the HTTP level {0}",ra);this.Rlc=I.we}else ha.ULS.sendTraceTag(23425241,Zd.Qm,15,"Request succeeded with null response data");if(this.pN()||
!this.eud)this.Hx.event(5),this.stop("session has shut down");else if(!this.iSl())if(I&&I.qd)if(I=this.Gpa(I.qd))if(this.D6.hjb(I),I.StatusCode)this.Anf(I,ra)||this.Hx.event(8,ra);else{this.PP=0;this.Inb=this.Mw();this.Iye.clear();ra={["LastSavedRevisionId"]:I.LastSavedRevisionId,["LastSavedRevisionSequenceNumber"]:I.RevisionSequenceNumber};ab=Ti.b(I.LastSavedRevisionId);this.MFg||this.hD.gYd(ab.toString(),I.RevisionSequenceNumber);this.K$b(ab,3);var Fb=this.w6e().store.getRevision(ab);if(Fb){I=null;
ab=this.Pwb();Fb=(Fb=Fb.sab(ab))?Fb.id:yd.a.nil;let ac=ab;for(;ac&&!ac.id.equals(Fb);)I=ac,ac=ac.Zl;this.Cql(I,ra,ab)||this.Hx.event(9)}else this.qpl()||this.Hx.event(12,ra);this.bOa(this.FRb)&&ha.ULS.sendTraceTag(22552774,Zd.Qm,50,"Received response from server -- going back to normal interval")}else this.Hx.event(7),this.Bnf("invalid response",ra);else this.Hx.event(6),this.Bnf("null response",ra)}Anf(I,ra){const ab=I.StatusCode;return 88===ab||89===ab||236===ab?(ra.KickoutDiagnostics=this.Lje(),
88===ab?(ra.Result="deleted DSS session",this.Hx.event(18,ra),this.stop("deleted DSS session"),this.Aw(bm.a.localCobaltDeletedSessionFault)):89===ab?(ra.Result="expired DSS session",this.Hx.event(19,ra),this.stop("expired DSS session"),this.Aw(bm.a.localCobaltExpiredSessionFault)):(Q.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled"),Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateLastSavedRevisionIdOnDssSessionNotFoundIsEnabled",
!1)&&(I=Ti.b(I.LastSavedRevisionId),this.K$b(I,4)),ra.Result="DSS session not found",this.Hx.event(21,ra),this.stop("DSS session not found"),this.Aw(bm.a.localCobaltSessionNotFound)),!0):14===ab?(this.stop("DSS returned an unspecified failure"),this.Aw(bm.a.T1l),!0):104===ab?(this.stop("this operation is disabled on the server"),!0):this.Bnf("unrecognized OperationResult: "+ab,ra)}Bnf(I,ra){if(!this.Iye.contains(I))this.Iye.add(I);else if(this.znf(11,bm.a.XYe,I))return ra.ConsecutiveErrors=this.pxc,
ra.Reason=I,ha.ULS.sendTraceTag(41997899,Zd.Qm,15,"DocxSaveMonitor kickout. {0}",ra),!0;this.bOa(this.b4a);return!1}Cql(I,ra,ab){let Fb=!1;if(I){const ac=this.Mw().getTime()-I.creationTime.getTime();ac>=this.iLg&&(Fb=!0,Zd.g5h(ra,this.Ddl(I,ac,ab)),ac>=this.Xpe&&10===this.Hx.currentState?(this.Hx.event(11,ra),this.stop("didn't save in time"),this.Aw()):(this.Hx.event(10,ra),this.qmi(),this.w3e()))}return Fb}CIj(I){this.ma.addHandler(Zd.Dii,I)}XPg(I){this.ma.addHandler(Zd.F3e,I)}Qri(I){this.ma.removeHandler(Zd.F3e,
I)}qmi(){this.ma.raiseEvent(Zd.Dii)}Gpa(I){let ra;return({group:ra}=Al.a.D$(I,ra)).returnValue?ra.Responses[0]:null}Ddl(I,ra,ab){const Fb={};Fb.FirstUnsavedRevisionId=I.id.toString();Fb.FirstUnsavedRevisionLengthToRoot=I.EM;Fb.UnsavedTimeInMs=ra;Fb.CurrentRevisionId=ab.id.toString();Fb.CurrentRevisionLengthToRoot=ab.EM;return Fb}w3e(){al.a.eoh(8)}Aw(I=bm.a.XYe){this.Muj?(this.stop(Zd.NWl),I===bm.a.dud?this.fG.value.Aw(I,Object.assign(new Pl.a,{Woa:4,s3:Box4Intl.Box4Strings.L_SessionExpiredMessageDescription,
xba:Box4Intl.Box4Strings.L_SessionExpiredMessageTitle,showDescription:!0})):this.fG.value.Aw(I,new Pl.a)):ha.ULS.sendTraceTag(19247383,Zd.Qm,50,"Kickout disabled")}I3m(I,ra){I={};I.DocxSaveMonitorState=De[ra.newState];I.PreviousState=De[ra.XEf];I.PreviousStateHits=ra.YEf;I.PreviousStateTransitionTime=ra.ZEf.toISOString();I.LastHttpStatus=this.Rlc;I.LastSuccessTime=this.Inb.toISOString();this.cqc&&(I.LastRequestStartTime=this.cqc.toISOString());I.LastSavedRevisionID=this.lNc.toString();I.LastSavedRevisionIdOrigin=
this.rnc;I.LastSavedRevisionIdSetTime=this.yze?this.yze.toISOString():null;I.IsViable=this.Ve.wra;I.IsNetworkConnected=this.Ve.pK;I.IsExpired=this.Ve.Wqa;I.HasEmergencyViewModeBeenDeployed=this.Ve.gi;I["Navigator.Online"]=window.navigator.onLine;const ab=ra.axn;ab&&Zd.g5h(I,ab);ra=ra.newState;switch(ra){case 13:ha.ULS.sendTraceTag(5830086,Zd.Qm,50,"{0}",I);break;case 1:ha.ULS.sendTraceTag(5884125,Zd.Qm,50,"{0}",I);break;case 0:ha.ULS.sendTraceTag(5830087,Zd.Qm,50,"{0}",I);break;case 2:ha.ULS.sendTraceTag(5830088,
Zd.Qm,50,"{0}",I);break;case 3:ha.ULS.sendTraceTag(5830089,Zd.Qm,50,"{0}",I);break;case 4:ha.ULS.sendTraceTag(5884126,Zd.Qm,50,"{0}",I);break;case 5:ha.ULS.sendTraceTag(5884127,Zd.Qm,50,"{0}",I);break;case 6:ha.ULS.shipAssertTag(5830090,Zd.Qm,!1,"{0}",I);break;case 7:ha.ULS.shipAssertTag(5830091,Zd.Qm,!1,"{0}",I);break;case 8:ha.ULS.sendTraceTag(5830092,Zd.Qm,15,"{0}",I);break;case 10:ha.ULS.sendTraceTag(5830094,Zd.Qm,15,"{0}",I);break;case 9:ha.ULS.sendTraceTag(5884128,Zd.Qm,50,"{0}",I);break;case 11:ha.ULS.sendTraceTag(5830096,
Zd.Qm,15,"{0}",I);break;case 17:ha.ULS.sendTraceTag(37835678,Zd.Qm,15,"{0}",I);break;case 12:ha.ULS.sendTraceTag(5830095,Zd.Qm,15,"{0}",I);break;case 18:ha.ULS.sendTraceTag(38122832,Zd.Qm,15,"{0}",I);break;case 19:ha.ULS.sendTraceTag(38122833,Zd.Qm,15,"{0}",I);break;case 21:ha.ULS.sendTraceTag(0,Zd.Qm,15,"{0}",I);break;case 14:ha.ULS.sendTraceTag(6575508,Zd.Qm,15,"{0}",I);break;case 15:ha.ULS.sendTraceTag(36739287,Zd.Qm,50,"{0}",I);break;case 16:ha.ULS.sendTraceTag(36767649,Zd.Qm,15,"{0}",I);break;
case 20:ha.ULS.sendTraceTag(593510690,Zd.Qm,15,"{0}",I);break;default:ha.ULS.shipAssertTag(5884129,Zd.Qm,!1,"Bad state:{0} logInfo:{1}",ra,I)}}qI(){const I={};this.zob&&(I.ORT=this.zob.toISOString());0<this.aoc&&(I.AA=this.aoc);0<this.pPb&&(I.MAA=this.pPb);0<this.Bgd&&(I.LSKO=this.Csg.toISOString());this.Hx&&0<=this.Hx.currentState&&(I.SMS=De[this.Hx.currentState]);const ra={};Q.AFrameworkApplication.Ija&&(ra.S=1);pf.App.lostSession&&(ra.LS=1);this.Ve&&(this.Ve.Kn&&(ra.KO=1),this.Ve.Wqa&&(ra.TE=1));
this.Ip&&(ra.VS=Lo.a[this.Ip.pD]);window.navigator&&(ra.NW=!window.navigator.onLine);I.AMD=ra;return I}o2k(){const I={"Content-Type":"application/json; charset=utf-8","X-Requested-With":"Fetch"};Q.AFrameworkApplication.buildVersion&&(I["X-OfficeVersion"]=gb.a.yO(Q.AFrameworkApplication.buildVersion));Q.AFrameworkApplication.accessToken&&(I["X-AccessToken"]=gb.a.yO(Q.AFrameworkApplication.accessToken),I["X-AccessTokenTtl"]=Q.AFrameworkApplication.IGa.toString());Q.AFrameworkApplication.canary&&(I["X-Key"]=
gb.a.yO(Q.AFrameworkApplication.canary));Q.AFrameworkApplication.userType&&(I["X-UserType"]=gb.a.yO(Q.AFrameworkApplication.userType));const ra=Q.AFrameworkApplication.fe.R1;ra&&(I["X-WacCluster"]=gb.a.yO(ra));Q.AFrameworkApplication.userSessionId&&(I["X-UserSessionId"]=gb.a.yO(Q.AFrameworkApplication.userSessionId));return I}B3e(){var I=this.Ve?this.Ve.networkState:null;if(1===I||3===I)ha.ULS.sendTraceTag(558158790,Zd.Qm,15,"Not sending request because we dont have network.");else if(I=this.Ijc()){var ra=
new Sys.Net.WebRequest;ra.set_httpVerb("POST");ra.set_url(Zd.serviceUrl);var ab={};ab.body=hm.b(on.a.construct(I));ab.headers=this.o2k();ab.method=ra.get_httpVerb();try{"function"===typeof window.fetch?window.fetch(ra.getResolvedUrl(),ab).then(Fb=>{ha.ULS.sendTraceTag(561551382,Zd.Qm,50,"Request succeeded at the HTTP level {0}",Fb.statusText);this.xsg=Fb.status;return Fb.json()},Fb=>{ha.ULS.sendTraceTag(561551383,Zd.Qm,15,"Request failed at the HTTP level {0}",Fb);return null}).then(Fb=>{Fb=JSON.stringify(Fb);
this.F4j(Fb,this.xsg);return Fb},()=>{ha.ULS.sendTraceTag(561551385,Zd.Qm,15,"Request succeeded with null response data");return""}):ha.ULS.sendTraceTag(561002076,Zd.Qm,15,"Browser does not support Fetch.")}catch(Fb){ha.ULS.sendTraceTag(561551386,Zd.Qm,15,String.format("Exception when attempting to get last revision save id : {0}",Fb))}}else ha.ULS.sendTraceTag(540079457,Zd.Qm,15,"Target node is null, not sending last saved revision request.")}F4j(I,ra){let ab=yd.a.nil,Fb=!1,ac=-1;if(ra===qf.a.wA)if(I=
this.Gpa(I)){ab=Ti.b(I.LastSavedRevisionId);const Xc=I.RevisionSequenceNumber;this.MFg||this.hD.gYd(ab.toString(),Xc);I.StatusCode||(Fb=!0,ac=I.StatusCode)}else ha.ULS.sendTraceTag(561002077,Zd.Qm,50,"Response is null when attempting to get last revision save id");this.ma.raiseEvent(Zd.F3e,new Fm(ab,Fb,ra,ac))}static g5h(I,ra){for(let ab in ra)I[ab]=ra[ab]}tNl(){return Fd.SessionStatusManager.instance.Kn}}Zd.mvi=0;Zd.serviceUrl=pf.App.webServiceBase+"OneNote.ashx?perfTag=LastSavedRevisionRequest";
Zd.NWl="kickout";Zd.Dii="PS";Zd.F3e="FLSR";Zd.Qm=343;Zd.bem=5;Zd.EDn=5E4;Object(f.a)(Zd,"DocxSaveMonitor",null,[1857,142]);class Eh{constructor(I,ra){this.bGa=I;this.Ggj=ra}eb(I){I.ka(of.a.bDf,Qf.a.view,Object(x.a)(this,this.bDf,"pendingAutosavesCheck"));I.ka(of.a.c7d,Qf.a.view,Object(x.a)(this,this.c7d,"updateDocxSaveMonitorInterval"));I.Qb(of.a.c7d,101)}bDf(){const I=this.Ggj();return 32!==I?I:!this.bGa||this.bGa.aYa?32:2<=this.bGa.pxc?8:4}c7d(I,ra,ab,Fb,ac){this.bGa&&this.bGa.bOa(parseInt(ac.toString()));
return 32}}Object(f.a)(Eh,"DocxSaveMonitorActor",null,[]);class im{w9a(I,ra){return window.setInterval(I,ra)}me(I){window.clearInterval(I)}}im.instance=new im;Object(f.a)(im,"DocxSaveMonitorTaskManager",null,[1856]);class Hj{constructor(I){this.BL=0;this.eoa=I}start(I){this.eoa&&(this.BL=I,this.eoa.reset())}log(){if(this.eoa){var I={};I.RequstId=this.BL;I.InvokeCount=this.eoa.fIc;I.InvokeFailedCount=this.eoa.gIc;I.NoOpenConnectionCount=this.eoa.HNc;I.SynchronousNotificationCount=this.eoa.IXc;I.ResponseNotAvailable=
this.eoa.JTc;ha.ULS.sendTraceTag(19161613,205,50,"ClientRequestManagerTelemetryStorage: {0}",I)}}}Object(f.a)(Hj,"RequestLifeCycleTelemetryManager",null,[1854]);class Rk{constructor(){this.W=this.bGa=null}get name(){return"WordEditor.DocxSaveMonitor"}init(){if(pf.App.Wr||pf.App.Bn)this.bGa=this.W.resolve("WordEditor.DocxSaveMonitor.DocxSaveMonitor"),(new Eh(this.bGa,()=>Sn.WoncaApp.LC.RIh())).eb(Q.AFrameworkApplication.pa)}Elk(){var I=Q.AFrameworkApplication.K;if(!I.$("DocxSaveMonitorEnabled"))return null;
var ra=I.$("DocxSaveMonitorKickoutEnabled");const ab=I.vb("DocxSaveMonitorIntervalMs",6E4),Fb=I.vb("DocxSaveMonitorFailureIntervalMs",5E3),ac=I.vb("DocxSaveMonitorWarningTimeMs",12E4),Xc=I.vb("DocxSaveMonitorKickoutTimeMs",3E5),Md=I.vb("DocxSaveMonitorQueueTimeoutMs",6E4),bf=I.vb("DocxSaveMonitorSentTimeoutMs",12E4),Hf=I.vb("DocxSaveMonitorOldestAllowedLocalRevisionMs",3E5);var Zg=I.$("DocxSaveMonitorTelemetryInfoEnabled");const gi=I.$("DocxSaveMonitorInfoRequestLoggingEnabled");var Ei=Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorBypassCRMIsEnabled",
!1),Il=I.$("DocxSaveMonitorRawWebRequestsEnabled")||Ei;Ei=I.$("ComponentStateLoggingPackageIsEnabled");I=I.getBooleanFeatureGate("Microsoft.Office.WordOnline.DocxSaveMonitorKickoutIfSessionisLostButNotKickedOutIsEnabled",!1);var Kk=Q.AFrameworkApplication.fe,nm=Il?new Gj.a(Q.AFrameworkApplication.userSessionId,Kk.R1,Kk.Mbh):null;nm=new Ko(Kk,nm,Il);Zg=Zg&&Kk&&!Il?new Hj(Kk.Pea):null;Il=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorIsEnabled",
!1):!1;Kk=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.MultipleRetriesForDocxSaveMonitorMaxRetries",3):3;const Rf=Fg.create(Il,Kk);Rf.Utc(1);Rf.Utc(2);Ei=Ei?this.W.za("Common.IComponentStateLogManager"):null;ra=new Zd(ab,Fb,ac,ra,Xc,Md,bf,Hf,im.instance,nm,ia.a.instance.te("Box4.IKickoutExecutor"),Ij.a.instance,Object(x.a)(this,this.V_b,"getTargetNode"),()=>!Q.AFrameworkApplication.qPd||rk.a.instance.nIc,()=>pf.App.lostSession,Object(x.a)(vo.a.instance,
vo.a.instance.Pwa,"checkAndTriggerSessionHasExpired"),()=>Q.AFrameworkApplication.Qj,()=>new Date,()=>new Date,Zg,gi,Rf,Object(x.a)(this,this.IQk,"getAdditionalDiagnosticLog"),Ei,I,ia.a.instance.ra("Common.ISessionStatus")||Fd.SessionStatusManager.instance,ia.a.instance.resolve("Box4.Revision.IRevisionSequenceNumberManager"),{isEnabled:Il,NMc:Kk});ra.start();ha.ULS.sendTraceTag(5884131,Zd.Qm,50,"SaveMonitor initialized");return ra}V_b(){const I=pf.App.oa.Da.Jb;return I?I.sc:null}IQk(){const I={};
Q.AFrameworkApplication.Cb&&(I.TM=Q.AFrameworkApplication.Cb.qI());Sn.WoncaApp.LC&&(I.RS=Sn.WoncaApp.LC.qI());ri.App.PY&&(I.CRS=ri.App.PY.qI());pf.App.oa&&pf.App.oa.Da&&pf.App.oa.Da.Zb&&pf.App.oa.Da.Zb.contentReplicator&&(I.GSR=pf.App.oa.Da.Zb.contentReplicator.qI());Q.AFrameworkApplication.Ija&&(I.S=1);pf.App.lostSession&&(I.LS=1);pf.App.lc&&pf.App.lc.xz.Kn&&(I.KO=1);return Sys.Serialization.JavaScriptSerializer.serialize(I)}dispose(){this.bGa&&this.bGa.stop("WordEditorDocxSaveMonitorPackage is being disposed")}yb(I){this.W=
I;(pf.App.Wr||pf.App.Bn)&&I.ha("WordEditor.DocxSaveMonitor.DocxSaveMonitor",Object(x.a)(this,this.Elk,"createSaveMonitor")).as("Wonca.IDocxSaveMonitor").singleInstance()}static main(){aa.a.instance.Lb(new Rk)}}Object(f.a)(Rk,"WordEditorDocxSaveMonitorPackage",null,[1,2]);var Ql;(function(I){I[I.version0=0]="version0";I[I.version1=1]="version1"})(Ql||(Ql={}));Object(f.b)("FirstRunExperienceVersion",Ql);class bp{get TJe(){return"Word"}get b_g(){return"74eb3f02-206c-47c2-ad65-c4d21db60910"}get version(){return Ql.version0}get currentVersion(){return Ql.version1}get hJl(){return bp.isEnabled()&&
Q.AFrameworkApplication.K.$("WordEditorFirstRunExperienceDataStoreIsEnabled")}get M3b(){return bp.isEnabled()&&Q.AFrameworkApplication.K.$("WordEditorFirstRunExperienceUIV2IsEnabled")}get yXh(){return Q.AFrameworkApplication.K.$("WordEditorFirstRunExperienceTestIsEnabled")}get nLk(){return"Microsoft.Office.Web.SessionSettings.IWordEditorFirstRunExperienceUIV2Settings"}get G5h(){return 24}get Qvi(){return 4E3}get aUc(){return""}static isEnabled(){const I=Q.AFrameworkApplication.sessionStartInfoSettings?
Q.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup:"";return"Unknown"!==I&&"Automation"!==I}}Object(f.a)(bp,"FirstRunExperienceLauncherSettings",null,[1890]);class Gl{constructor(I){this.Qig=I}arn(I){this.Qig&&this.Qig.brn(I)}}Object(f.a)(Gl,"FirstRunExperienceManager",null,[1889]);class Mo{constructor(){this.W=null}get name(){return"WordEditor.FirstRunExperience"}yb(I){this.W=I;this.W.ha("WordEditor.FirstRunExperience.IFirstRunExperienceManager",()=>new Gl(this.W.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"))).singleInstance()}init(){const I=
this.W.resolve("WordEditor.FirstRunExperience.IFirstRunExperienceManager");I&&I.arn(new bp)}dispose(){}}Object(f.a)(Mo,"WordEditorFirstRunExperiencePackageManager",null,[1,2]);class tq{constructor(I,ra,ab){this.ga=I;this.MEa=ra;this.Tqg=ab}dispose(){this.MEa&&this.MEa.dispose()}eb(){this.ga.ka(of.a.s5d,Qf.a.view,Object(x.a)(this,this.s5d,"toggleFormatPicturePane"));this.ga.Aa(of.a.tla,Qf.a.view,Object(x.a)(this,this.tla,"showFormatPicturePane"),4);this.ga.ka(of.a.fFd,Qf.a.view,Object(x.a)(this,this.fFd,
"hideFormatPicturePane"));this.ga.Aa(of.a.a2d,Qf.a.view,Object(x.a)(this,this.tla,"showFormatPicturePane"),4);this.ga.ka(of.a.b2d,Qf.a.view,Object(x.a)(this,this.tla,"showFormatPicturePane"));this.ga.ka(of.a.c2d,Qf.a.view,Object(x.a)(this,this.tla,"showFormatPicturePane"));this.Tqg&&(this.ga.Aa(of.a.gli,Qf.a.view,Object(x.a)(this,this.fli,"queryFormatPicturePane"),96),this.ga.ka(of.a.jTf,Qf.a.view,Object(x.a)(this,this.tla,"showFormatPicturePane")),this.ga.Aa(of.a.hli,Qf.a.view,Object(x.a)(this,this.fli,
"queryFormatPicturePane"),96),this.ga.ka(of.a.kTf,Qf.a.view,Object(x.a)(this,this.tla,"showFormatPicturePane")))}fli(I,ra,ab,Fb,ac){if(1===ab)return 32;switch(I){case of.a.gli:ac[Dl.a.On]=1===this.MEa.F9a;break;case of.a.hli:ac[Dl.a.On]=2===this.MEa.F9a}return 32}tla(I,ra,ab,Fb,ac){if(1===ab)return 32;if(2===ab){ra=this.MEa.Zf.isVisible;this.MEa.uz(!0,1===ac);ab=0;switch(I){case of.a.jTf:ac=1;break;case of.a.kTf:ac=2;break;case of.a.a2d:ac=2;ab=1;break;case of.a.b2d:ac=1;ab=2;break;case of.a.c2d:ac=
1;ab=3;break;case of.a.s5d:ac=this.MEa.F9a;this.Tqg&&!ac&&(ac=1);break;default:ab=ac=0}ra&&I===of.a.tla||this.MEa.yen(ac,ab);return 32}return 8}fFd(I,ra,ab,Fb,ac){this.toggleButton(ac,!1);return this.v8j(ab)}v8j(I){if(1===I)return 32;this.MEa.uz(!1);return 32}s5d(I,ra,ab,Fb,ac){return this.MEa.Zf.isVisible?this.fFd(I,ra,ab,Fb,ac):this.tla(I,ra,ab,Fb,ac)}toggleButton(I,ra){I&&(I[Dl.a.On]=ra)}}Object(f.a)(tq,"FormatPictureActor",null,[14]);class No{constructor(I){this.Nqb=!1;this.Zf=I}get F9a(){return this.Zf.aok}yen(I,
ra){switch(I){case 0:case 1:this.Zf.Zrn(ra);break;case 2:this.Zf.jsn(ra)}}uz(I,ra=!1){this.Nqb||this.Tff();I?this.Zf.NM(ra):this.Zf.fja()}dispose(){this.Zf.dispose()}Tff(){this.Nqb||(this.Zf.initialize(),this.Nqb=!0)}}Object(f.a)(No,"FormatPictureManager",null,[1853,14]);var na=b(348),bb=b(128),ub=b(332);class dc{}dc.WM=ub.a.Kxd;dc.m7b=1;dc.yfb=WordEditorIntl.WordEditorStrings.L_FormatPicture;dc.Cpa="FormatPictureTaskPaneData";Object(f.a)(dc,"FormatPicturePaneConstants",null,[]);class xc{constructor(){this.type=
"FormatPictureTaskPaneProps";this.section=0;this.description=this.title=this.numberFormatInfo=null;this.rotationAngle=this.rightCrop=this.leftCrop=this.bottomCrop=this.topCrop=0;this.onRotationSpinButtonChange=this.onCropSpinButtonChange=this.onDescriptionChange=this.onTitleChange=null;this.disabled=!1}}Object(f.a)(xc,"FormatPictureTaskPaneProps",null,[]);class Nc{constructor(I,ra,ab,Fb){this.Ize=0;this.Khc=this.Qga=null;this.ifd=this.$ed=this.Z$c=this.f2c=this.xid=0;this.nt=this.$Lb=!1;this.kfe=
0;this.EN=I;this.alj=ra;this.Tqe=ab;this.Se=Fb}initialize(){this.YW();this.Bea()}get isVisible(){return this.nt}NM(I){this.xWc(I)}fja(){this.Z9();this.Oul()}Zrn(I){this.xDi(I,1)}jsn(I){this.xDi(I,2)}xDi(I,ra){this.kfe=ra;this.Ize=I}get aok(){return this.kfe}dispose(){}YW(){this.EN.OHa();this.Ize=this.kfe=0}get wf(){return this.alj.value}get Eb(){return this.Tqe.value}YXa(){return!!this.wf.nf&&this.wf.nf.name===dc.WM}Nsm(){this.iBi()}iBi(){this.wf.Kf(dc.WM)}Bea(){const I=this.wf.fd(dc.WM);I.parent=
ei.AFrame.uo;I.iba(Object(x.a)(this,this.Nsm,"onSetFocus"))}Z9(){this.YXa()&&this.wf.Kf(this.wf.$Q)}xWc(I){uh.UISurfaces.Ms().then(ra=>{ra.showTaskPane(dc.WM,this.Tz(I));this.isVisible&&I&&this.wf.Kf(dc.WM);return null})}it(){uh.UISurfaces.Ms().then(I=>{I.updateTaskPane(dc.WM,this.Tz(!1));return null})}Oul(){uh.UISurfaces.Ms().then(I=>{I.hideTaskPane(dc.WM,2);return null})}Tz(){const I=new xc;this.lln(I);return Object.assign(new Di.a,{title:dc.yfb,hideHeader:!1,width:320,location:2,contentProps:I,
onOpen:ra=>{this.nt=!0;pf.App.oa.RSa(Object(x.a)(this,this.yk,"pollForStateAndUpdate"));pf.App.oa.updateCommandUI();this.iBi();this.Se.Lrb(dc.WM,ra)},onClose:()=>{this.Z9();this.nt=!1;pf.App.oa.W8b(Object(x.a)(this,this.yk,"pollForStateAndUpdate"));pf.App.oa.updateCommandUI()},isModernPane:!0,enableResize:!0,minResizeWidth:150,maxResizeWidth:920})}lln(I){const ra=ik.e().numberFormatInfo;I.section=this.Ize;I.numberFormatInfo="object"===typeof ra?ra:null;I.title=this.Qga;I.description=this.Khc;I.topCrop=
this.xid;I.bottomCrop=this.f2c;I.leftCrop=this.Z$c;I.rightCrop=this.$ed;I.rotationAngle=this.ifd;I.onTitleChange=this.onTitleChange();I.onDescriptionChange=this.onDescriptionChange();I.onCropSpinButtonChange=this.onCropSpinButtonChange();I.onRotationSpinButtonChange=this.onRotationSpinButtonChange();I.disabled=this.$Lb}onTitleChange(){return I=>{if(I!==this.Qga){this.Qga=I;var ra=new na.DictionaryPropertySet;ra.setValue(bb.a.Pbb,I);this.Eb.hb(Ng.a.jVc,2,ra);this.it()}}}onDescriptionChange(){return I=>
{if(I!==this.Khc){var ra=new na.DictionaryPropertySet;ra.setValue(bb.a.BX,I);this.Khc=I;this.Eb.hb(Ng.a.WFb,2,ra);this.it()}}}onCropSpinButtonChange(){return(I,ra)=>{const ab=new na.DictionaryPropertySet;switch(ra){case 0:this.xid=I;ab.setValue(bb.a.Ubb,I);this.Eb.hb(of.a.UGc,2,ab);break;case 1:this.f2c=I;ab.setValue(bb.a.Rbb,I);this.Eb.hb(of.a.NGc,2,ab);break;case 2:this.Z$c=I;ab.setValue(bb.a.Sbb,I);this.Eb.hb(of.a.OGc,2,ab);break;case 3:this.$ed=I,ab.setValue(bb.a.Tbb,I),this.Eb.hb(of.a.PGc,2,
ab)}this.it()}}onRotationSpinButtonChange(){return I=>{this.ifd=I;const ra=new na.DictionaryPropertySet;ra.setValue(bb.a.e1b,0);ra.setValue(bb.a.kK,I);this.Eb.hb(Ng.a.imageRotate,2,ra);this.it()}}yk(){let I=!1;I=this.cJm()||I;I=this.SZa()||I;I=this.RZa()||I;I=this.i8b()||I;(I=this.$Im()||I)&&this.it()}cJm(){const I=2===this.Eb.hb(Ng.a.jVc,1,null),ra=I!==this.$Lb;this.$Lb=I;return ra}SZa(){var I=new na.DictionaryPropertySet;this.Eb.hb(Ng.a.SZa,2,I);I=I.ia(bb.a.Pbb,"");const ra=I!==this.Qga;this.Qga=
I;return ra}RZa(){var I=new na.DictionaryPropertySet;this.Eb.hb(Ng.a.RZa,2,I);I=I.ia(bb.a.BX,"");const ra=I!==this.Khc;this.Khc=I;return ra}i8b(){var I=new na.DictionaryPropertySet;this.Eb.hb(of.a.XQc,2,I);const ra=I.ia(bb.a.Ubb,0),ab=I.ia(bb.a.Rbb,0),Fb=I.ia(bb.a.Sbb,0);I=I.ia(bb.a.Tbb,0);const ac=ra!==this.xid||ab!==this.f2c||Fb!==this.Z$c||I!==this.$ed;this.xid=ra;this.f2c=ab;this.Z$c=Fb;this.$ed=I;return ac}$Im(){var I=new na.DictionaryPropertySet;this.Eb.hb(Ng.a.kEb,2,I);I=I.ia(bb.a.kK,0);const ra=
I!==this.ifd;this.ifd=I;return ra}}Object(f.a)(Nc,"ReactFormatPicturePane",null,[1852,14]);class qd{constructor(){this.F6c=this.W=null}get name(){return"WordEditor.FormatPicture"}yb(I){this.W=I;this.W.ha("WordEditor.FormatPicture.IFormatPictureManager",()=>new No(this.W.resolve("WordEditor.FormatPicture.IFormatPicturePane"),ri.App.BZi)).singleInstance();this.W.ha("WordEditor.FormatPicture.IFormatPicturePane",()=>new Nc(og.a.instance,new Jb.a(()=>Eg.FocusManager.instance()),new Jb.a(()=>Q.AFrameworkApplication.pa),
zb.a.instance)).singleInstance();this.W.ha("WordEditor.FormatPicture.FormatPictureActor",()=>new tq(Q.AFrameworkApplication.pa,this.W.resolve("WordEditor.FormatPicture.IFormatPictureManager"),ri.App.BZi)).singleInstance()}init(){if(ri.App.x8d||ri.App.G2f)this.F6c=this.W.resolve("WordEditor.FormatPicture.FormatPictureActor"),this.F6c.eb(),pf.App.oa.updateCommandUI()}dispose(){this.F6c&&this.F6c.dispose()}static main(){aa.a.instance.Lb(new qd)}}Object(f.a)(qd,"WordEditorFormatPicturePackage",null,[1,
2]);class ae{constructor(){this.ZMb=this.bqc=null;this.Ced=0}get name(){return"WordEditor.FrameTiming"}yb(){this.ZMb=new EventTiming.FrameTimingMeter;this.Ced=Q.AFrameworkApplication.K.vb("FrameTimingMeterReportingIntervalInSeconds",60);0>=this.Ced&&(this.Ced=60);this.bqc=I=>{(I=I.rawEvent)&&ha.ULS.sendTraceTag(24962208,306,50,va.c(I.detail))};L.a.addHandler(window.self,F.a.kti,this.bqc)}init(){this.ZMb&&this.ZMb.start(this.Ced)}dispose(){this.ZMb&&(this.ZMb.stop(),this.ZMb=null);this.bqc&&(L.a.removeHandler(window.self,
F.a.kti,this.bqc),this.bqc=null)}static main(){aa.a.instance.Lb(new ae)}}Object(f.a)(ae,"FrameTimingPackageManager",null,[1,2]);var Pd=b(1282),ce=b(524);class tf extends tk.a{constructor(){super();this.Prompt=0;this.FileId=null}ol(){return 100}static construct(I,ra){const ab=new tf;ab.FileId=I;ab.Prompt=ra;return ab}}Object(f.a)(tf,"GraphMergeConsentChangedRequest",tk.a,[]);class zf{constructor(I,ra,ab,Fb,ac,Xc=null,Md=null){this.uk=!1;this.wL=null;this.OEg=this.Cpe=!1;this.eQ=I;this.Vjd=ab;this.Xta=
Fb;this.KDa=ac;this.Vjd&&this.Vjd.kIj(Object(x.a)(this,this.NHh,"handleOnGraphMergeComplete"));this.D6=Xc||Ij.a.instance;if(!Md){const bf=new ce.a;Md=Hf=>bf.zia(0,Hf)}this.N8i=Md}get jVl(){return this.Cpe}get Ian(){return this.OEg}NRe(){if(this.Xta.REd)this.Cpe=!0;else if(this.Cpe=!1,!this.Ian){this.OEg=!0;var I=this.KDa.qsa;ha.ULS.sendTraceTag(39084353,300,50,"GraphMerge consent given: {0}",400===I);if(100===I||400===I)I=tf.construct(this.eQ(),I),this.Pv(I)}}NHh(I,ra){ra&&ra.asf&&ra.asf.TTe&&!this.Xta.BXh&&
(this.Xta.eTi(),this.Xta.REd=!0,this.Pv(ra.asf.TTe))}Pv(I){const ra=new xg.a;ra.Kq=I;ra.status=1;ra.GF="GraphMerge";const ab=this.N8i(()=>{this.ITc(ra,33===I.ol())});ab.WH(ra);ab.DU()}ITc(I,ra){this.uk||(ra&&(this.Xta.REd=!1),2===I.statusCode&&!ca.a.cAb(I.Vi)&&1===I.Vi.length&&I.Vi[0]?(I=I.Vi[0],I.StatusCode?this.Xta.FQf():ra&&this.KDa.Pti(Object(x.a)(this,this.NRe,"consentChoiceMade")),this.D6.hjb(I),this.jVl&&this.NRe()):this.Xta.FQf())}Seb(I){this.wL=I;this.wL.tTb(Object(x.a)(this,this.KHh,"handleOnAfterReplication"));
this.wL.uTb(Object(x.a)(this,this.LHh,"handleOnAfterResponseReceived"))}KHh(I,ra){ra&&ra.L_c&&this.Xta.eTi()}LHh(I,ra){ra&&(ra.ShowMergePrompt&&this.KDa.Pti(Object(x.a)(this,this.NRe,"consentChoiceMade")),Q.AFrameworkApplication.ug&&(Q.AFrameworkApplication.ug.SessionMergeInfo|=ra.PartMergeInfo))}dispose(){this.uk||(this.Vjd&&this.Vjd.nYm(Object(x.a)(this,this.NHh,"handleOnGraphMergeComplete")),this.wL&&(this.wL.TEb(Object(x.a)(this,this.KHh,"handleOnAfterReplication")),this.wL.XSc(Object(x.a)(this,
this.LHh,"handleOnAfterResponseReceived"))),this.uk=!0)}}Object(f.a)(zf,"GraphMergeBackupManager",null,[1888,14]);class hb{constructor(I,ra=null,ab=null,Fb=null){this.Jbe=0;this.qoe=!1;this.Krg=new Date(0);this.REd=!1;this.KDa=I;this.Mw=ra||(()=>new Date);ab||(ab=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.vb("WordEditorGraphMergeBackupDelayInMs",12E4):12E4);this.Lmj=ab;Fb||(Fb=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.vb("WordEditorGraphMergeMaxBackups",1):1);this.vug=Fb}get TTl(){return+this.Mw()-
+this.Krg<this.Lmj}get BXh(){return 500===this.KDa.qsa?!1:100===this.KDa.qsa?!0:this.qoe||this.REd||this.TTl}eTi(){this.Krg=this.Mw();this.Jbe++;this.Jbe>=this.vug&&this.FQf()}FQf(){this.qoe||(this.qoe=!0,ha.ULS.sendTraceTag(39084356,300,50,"Permanently throttling merge reports after creating {0} out of a maximum of {1} reports.",this.Jbe,this.vug))}}Object(f.a)(hb,"GraphMergeBackupThrottler",null,[1887]);class cc{constructor(I,ra,ab=null){this.Ykg=!1;this.gL=I;this.P5c=ra;null==ab&&(ab=!!Q.AFrameworkApplication.K&&
Q.AFrameworkApplication.K.$("WordEditorGraphMergeBypassConsentPrompt"));this.bxe=ab?500:300}get qsa(){return this.bxe}Pti(I){if(!this.Ykg&&300===this.qsa){var ra=this.P5c.value;ra&&ra.isFeatureEnabled(83)&&(this.Ykg=!0,this.gL.execute(ab=>{ab.lrn(()=>{this.Gbk(I)},()=>{this.consentDenied(I)})}))}}consentDenied(I){300===this.qsa&&(ha.ULS.sendTraceTag(42333270,300,50,"Consent denied for investigating merge failures."),this.bxe=100,I());this.pqi()}Gbk(I){300===this.qsa&&(ha.ULS.sendTraceTag(42333271,
300,50,"Consent received for investigating merge failures."),this.bxe=400,I());this.pqi()}pqi(){this.gL.execute(I=>{I.Hul()})}}Object(f.a)(cc,"GraphMergeCollectionConsentManager",null,[1886]);class Ac extends Sys.EventArgs{constructor(I){super();this.asf=I}}Object(f.a)(Ac,"GraphMergeCompleteEventArgs",Sys.EventArgs,[]);var Rc=b(648),Bd=b(909),qe=b(587),Jf=b(764),dg=b(1587),Qg=b(1585),Df=b(202),Pf=b(143);class hg{constructor(I,ra,ab,Fb,ac,Xc){this.gGf=this.Ze=null;this.yKc=this.m2f=!1;this.nj=null;
this.kWc=I.runtime.kWc;this.vm=I;this.Bc=ra;this.tf=ab;this.jl=Fb;this.qbk=ac;this.graphNodeComplexMerge=Xc}}Object(f.a)(hg,"GraphNodeComplexMergeState",null,[]);var Ui=b(1361),Zh=b(1344);class Nn{constructor(I,ra=null){this.Hf=I;this.ZOb=ra||this.YDc()}get eeb(){return this.ZOb}get Bc(){return this.Hf}YDc(){return[Object(x.a)(this,this.vtn,"simpleMerge"),Object(x.a)(this,this.Gak,"complexMerge")]}pln(I,ra,ab,Fb,ac,Xc){ra=new hg(I,ab,new Jb.a(()=>new Ui.a(Fb?Fb.ik:null,ac)),new Jb.a(()=>new Ui.a(Fb?
Fb.ik:null,Xc)),new Jb.a(()=>new Ui.a(Xc,ac)),ra.e9g(ac,()=>I.runtime.Ua));ra.Ze=Fb.gSb;ra.gGf=new Df.a;return ra}merge(I,ra,ab,Fb,ac,Xc){ra=this.pln(I,ra,ab,Fb,ac,Xc);ab=!0;for(Fb=0;Fb<this.eeb.length&&ab;Fb++)(ab=(0,this.eeb[Fb])(ra))||I.logger.iNd("GraphNodeMerge.GetMergeFunctions()",Fb);if(I=ra.yKc&&ra.nj?new Zh.a(ra.nj,!1):null)switch(I.Pjn(ra.Ze),(I?I.ik:ac).Gb){case 1074135145:ra.vm.runtime.iXd.Kck.Z(I.ik.id,I.ik);break;case 1074135153:ra.vm.runtime.iXd.jUj.Z(I.ik.id,I.ik);break;case 1074135127:ra.vm.runtime.iXd.x$j.Z(I.ik.id,
I.ik);break;case 393230:ra.vm.runtime.zOd.add(I.ik.id)}return{returnValue:ra.yKc,nj:I}}vtn(I){if(I.vm.runtime.Ua&&I.vm.runtime.Ua.eyb(1000005)&&0<I.Ze.count)return!0;var ra=I.graphNodeComplexMerge.xVd;return I.jl.value.LIc(ra)&&I.qbk.value.LIc(ra)?I.tf.value.LIc(ra)?!0:(ra=I.jl.value.Zd,I.yKc=!0,I.nj=ra.dF(),!1):(I.yKc=!0,!1)}Gak(I){const ra=I.jl.value.Zd;I.kWc&&Pf.a.instance.ua(4018183,1,3,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",ra.id,ra.Gb);const ab=I.graphNodeComplexMerge.CZf(I);I.yKc=ab;
Pf.a.instance.ua(4018184,1,ab?4:3,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",ab?"Succeeded":"Failed",ra.id,ra.Gb,!!I.nj);return ab}}Object(f.a)(Nn,"GraphNodeMerge",null,[1869]);class jm extends tk.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=this.FileId=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Prompt=this.Reason=this.Source=0}ol(){return 33}static construct(I,
ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg,gi){const Ei=new jm;Ei.FileId=I;Ei.BaseRevisions=ra;Ei.TheirRevisions=ab;Ei.YourRevisions=Fb;Ei.IgnoreConflictsInLastServerRevision=ac;Ei.MergeHint=Xc;Ei.ObjectSpaceId=Md?Ti.a(Md):null;Ei.RequestId=bf?Ti.a(bf):null;Ei.Source=Hf;Ei.Reason=Zg;Ei.Prompt=gi;return Ei}}Object(f.a)(jm,"CreateGraphMergeReplayRequest",tk.a,[]);var Jq=b(731),Qp=b(237),Fp=b(17),Lm=b(1732),Kj=b(1691);class Qd{constructor(I,ra=null,ab=null){this.WE=I;this.WC=I.Ci;this.A5a=I.NCn;this.job=I.$Zn;this.Klj=
I.S1l;this.Hf=ra||new Bd.a;this.dqj=ab||Object(x.a)(this,this.axk,"doParagraphMergeForModifiedObject")}Vzc(I){const ra=new Df.a;for(let ab=0;ab<I.length;ab++){const Fb=this.Twk(I.J(ab));ra.add(Fb)}return ra}Uzc(I,ra,ab){const Fb=I.yh===I.Ti&&I.startCp===I.endCp;ra&&({HBa:I.yh,Vka:I.startCp}=this.dOa(I.yh,I.startCp,I.yh,I.startCp),Fb&&(I.Ti=I.yh,I.endCp=I.startCp));ab&&!Fb&&({HBa:I.Ti,Vka:I.endCp}=this.dOa(I.Ti,I.endCp,I.Ti,I.endCp));return I}Twk(I){if(I.yh===I.Ti){var ra=new Df.a;ra.add(I.startCp);
ra.add(I.endCp);({HBa:ab,gFb:Fb}=this.H0f(I.yh,ra,ab,Fb));return new Jq.a(ab,Fb.J(0),ab,Fb.J(1))}var ab=new Df.a;var Fb=new Df.a;let ac,Xc,Md;ab.add(I.startCp);({HBa:ra,gFb:Xc}=this.H0f(I.yh,ab,ra,Xc));Fb.add(I.endCp);({HBa:ac,gFb:Md}=this.H0f(I.Ti,Fb,ac,Md));return new Jq.a(ra,Xc.J(0),ac,Md.J(0))}H0f(I,ra,ab,Fb){ab=I;Fb=ra;if(!this.WC.J(I))return ha.ULS.sendTraceTag(4339675,318,50,"UpdateSelectionRecordsForParagraph: Not updating the selection record for [Paragraph: {0}] as it is new in this revision",
I),{HBa:ab,gFb:Fb};if(this.A5a.get(I))({HBa:ab,gFb:Fb}=this.dqj(I,ra,ab,Fb));else if(this.WE.gff&&!this.WE.gff.J(this.WE.gff.length-1).AM(I)){Fb=new Df.a;for(let ac=0;ac<ra.length;ac++){let Xc;({HBa:ab,Vka:Xc}=this.dOa(I,ra.J(ac),ab,Xc));Fb.add(Xc)}}return{HBa:ab,gFb:Fb}}Yxh(I){let ra="";I.forEach(ab=>{ra+=ab.Bib();ra+=" ";return!0});return ra}nyh(I){const ra=ia.a.instance.ra("Box4.IFeatureHelper"),ab=new Lm.a;ab.input.source=this.WE.Wbf;ab.input.S0=this.WE.S0;ab.input.rBc=()=>ra;ab.runtime.Ci=this.WC;
ab.runtime.Xwa=this.WE.cak;1===I?(ab.runtime.xr=this.job,ab.runtime.So=this.A5a,ab.runtime.kwd=this.WE.hZh,ab.runtime.I6d=this.WE.vZh):2===I&&(ab.runtime.xr=this.A5a,ab.runtime.So=this.job,ab.runtime.kwd=this.WE.vZh,ab.runtime.I6d=this.WE.hZh);ab.runtime.Ua=ra;return ab}axk(I,ra,ab,Fb){ab=I;Fb=ra;var ac=this.A5a.get(I);if(!ac)return{HBa:ab,gFb:Fb};Fb=new Df.a;Fb.add(ac);var Xc=this.job.get(I)||this.WC.J(I);ac=new Df.a;ac.add(Xc);Xc=new Df.a;Xc.add(this.WC.J(I));ha.ULS.sendTraceTag(17409890,318,50,
"Performing CpMerge: [Source: {0}] [MergeHint: {1}] [LocalRevisionObjects: {2}] [ServerRevisionObjects: {3}]",this.WE.Wbf,this.WE.S0,this.Yxh(ac),this.Yxh(Fb));var Md=this.nyh(this.WE.S0);this.KKk(Md,I,Fb);ac=new Kj.a(Md,Xc,1===Md.input.S0?ac:Fb,1===Md.input.S0?Fb:ac,this.nyh(1),ac,Fb);Fb=new Df.a;for(Xc=0;Xc<ra.length;Xc++){this.WE.MC("GraphMergeSelectionRecordUpdater.DoParagraphMergeForModifiedObject");const bf=({o_a:ab,Vka:Md}=ac.zZc(I,ra.J(Xc))).returnValue;Fb.add(Md);bf?ha.ULS.sendTraceTag(17409891,
318,50,"UpdateSelectionRecordsForParagraph: Updating the selection record for [Paragraph: {0}] [Cp: {1}] to [Result Paragraph: {2}] [Result Cp: {3}] ",I,ra.J(Xc),ab,Md):ha.ULS.sendTraceTag(4339677,318,15,"UpdateSelectionRecordsForParagraph: UpdateCpAccordingToIncomingChange was unable to update the cp for [Paragraph: {0}]",I)}return{HBa:ab,gFb:Fb}}KKk(I,ra,ab){if(I.runtime.xr.Ja(Qp.a.dJ)){var Fb=I.runtime.xr.J(Qp.a.dJ);Fb=this.Hf.getPropertyObjectIds(Fb,dh.a.ZY);if(1===Fb.length&&(Fb=Fb.J(0),I.runtime.xr.Ja(Fb)&&
(Fb=I.runtime.xr.J(Fb),3===this.Hf.getPropertyInt32(Fb,dh.a.djb)))){const ac=this.Hf.getPropertyString(Fb,dh.a.afa),Xc=this.Hf.getPropertyString(Fb,dh.a.IIb);ra.toString()===ac&&ac===Xc&&(ra=this.Hf.getPropertyObjectId(Fb,dh.a.BZc),I.runtime.xr.Ja(ra)&&ab.add(I.runtime.xr.J(ra)))}}}P$k(I,ra){let ab=0;for(let Fb=0;Fb<I.length;Fb++)if(ra.equals(I.J(Fb)))return ab=Fb,{returnValue:!0,idx:ab};return{returnValue:!1,idx:ab}}dOa(I,ra){const ab=this.Klj&&!!this.job.J(I)&&!this.WC.J(I);let Fb=I,ac=ra,Xc=!1,
Md=!1;(ab?this.job:this.A5a).forEach((bf,Hf)=>{this.WE.MC("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");if(this.Ikf(Hf.Gb)&&this.WC.J(bf)){Hf=null;if(ab){Hf=this.rEc(gi=>this.job.J(gi)||this.WC.J(gi),bf);var Zg=this.tJd(Hf,I)}else Zg=this.rEc(gi=>this.WC.J(gi),bf),Zg=this.tJd(Zg,I);if(Zg&&(Md=!0,Hf||(Hf=this.rEc(gi=>this.job.J(gi)||this.WC.J(gi),bf)),bf=this.rEc(gi=>this.A5a.J(gi)||this.WC.J(gi),bf),Zg=0,({idx:Zg}=this.P$k(Hf,I)).returnValue)){for(let gi=Zg+1;gi<Hf.length;gi++)if(this.tJd(bf,
Hf.J(gi)))return ac=0,Fb=Hf.J(gi),Xc=!0,!1;for(--Zg;0<=Zg;Zg--)if(this.tJd(bf,Hf.J(Zg)))return ac=Number.MAX_VALUE,Fb=Hf.J(Zg),Xc=!0,!1}}return!0});if(!Xc&&(ha.ULS.sendTraceTag(4339678,318,15,"UpdateSelectionRecordForDeletedParagraph: Was unable to reposition the selection record [ObjectID : {0}] [Cp: {1}] [IsNewParaInRejectedLocalChange: {2}] [FoundDeletedNode: {3}]",I,ra,ab,Md),5===this.WE.Wbf)){ha.ULS.sendTraceTag(17340240,318,50,"UpdateSelectionRecordForDeletedParagraph: Unable to position IP, Trying to update to first para in server revision for Undo",
Fb);let bf;({xmh:bf}=this.F0k(bf)).returnValue?(Fb=bf,ac=0,ha.ULS.sendTraceTag(17340241,318,15,"UpdateSelectionRecordForDeletedParagraph: Did not find any paragraphs that were common on client and server. Repositioning to the start of the first [Paragraph:{0}] in the incoming revision",Fb)):ha.ULS.sendTraceTag(17340242,318,15,"UpdateSelectionRecordForDeletedParagraph: Unable to get the first para in an incoming change",Fb)}return{HBa:Fb,Vka:ac}}F0k(I){I=yd.a.nil;let ra=new Df.a;this.A5a.forEach((ab,
Fb)=>{this.WE.MC("GraphMergeSelectionRecordUpdater.UpdateSelectionRecordForDeletedParagraph");return this.Ikf(Fb.Gb)?(ra=this.rEc(ac=>this.A5a.J(ac)||this.WC.J(ac),ab),!1):!0});return 0<ra.length?(I=ra.J(0),{returnValue:!0,xmh:I}):{returnValue:!1,xmh:I}}Ikf(I){return 393241===I||393250===I||393251===I||393252===I}rEc(I,ra){var ab=I(ra);ra=new Df.a;if(!this.Ikf(ab.Gb))return ra;ab=this.Hf.getPropertyObjectIds(ab,Fp.a.ge);for(let Fb=0;Fb<ab.length;Fb++){const ac=new Df.a;this.U9e(I,ab.J(Fb),ac);ra.ez(ra.length,
ac)}return ra}U9e(I,ra,ab){var Fb=I(ra);if(Fb)if(393230===Fb.Gb)ab.add(ra);else if(393229===Fb.Gb)ra=this.Hf.getPropertyObjectIds(Fb,Fp.a.LJ).Ye(0),this.U9e(I,ra,ab);else if(393250===Fb.Gb||393251===Fb.Gb||393252===Fb.Gb)for(ra=this.Hf.getPropertyObjectIds(Fb,Fp.a.ge),Fb=0;Fb<ra.length;Fb++)this.U9e(I,ra.J(Fb),ab)}tJd(I,ra){for(let ab=0;ab<I.length;ab++)if(ra.equals(I.J(ab)))return!0;return!1}}Object(f.a)(Qd,"GraphMergeSelectionRecordUpdater",null,[]);class Kq extends dg.a{constructor(I=null,ra=null,
ab=null,Fb=null,ac=null,Xc=null,Md=null,bf=null,Hf=-1,Zg=null,gi=null,Ei=null){super();this.eQ=I||(()=>Q.AFrameworkApplication.rootQuerySignature);ra||(ra=Il=>new Rc.a(Il));this.lDg=ra;this.Hf=ab||new Bd.a;this.Kbg=Md||new Qg.ChildNodeListMerge(this.Bc);this.zQb=bf;this.vvi||(this.zQb=(Il,Kk,nm)=>new qe.a(Il,Kk,nm));this.ZOb=Fb||this.YDc();this.r4a=ac||new Oe.a;this.Fkg=Xc||new Nn(this.Bc);this.Bug=void 0===Hf||null===Hf||-1===Hf?ri.App.CZi:Hf;this.Xta=Zg;this.KDa=gi;this.nDd=this.qtk(Ei);this.dig=
()=>ia.a.instance.ra("Box4.IFeatureHelper")}qtk(I){I||(I=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.vb("WordEditorGraphMergeBackupCasesBrowser",0):0);return I}oca(){return(new Date).getTime()}BLi(I,...ra){return String.format.apply(null,[I].concat(ra))}eDn(I){throw Be.a.invalidOperation(I);}wzd(I){return String.format("Name: {0}, Message: {1}, Stack: {2}",I.name,I.message,I.stack)}yDm(I){if(this.Xta&&this.Xta.BXh||!this.fzn(I))return null;this.h5l(I);let ra;({JSj:Fb,MCn:ac,ZZn:ra}=this.Mlk(I,
Object(x.a)(this,this.w$g,"createSerializedRevisionFrom")));const ab=dg.a.K1k(I);var Fb=jm.construct(this.eQ(),Fb.Kla(),ac.Kla(),ra.Kla(),I.input.Y0b,I.input.S0,I.input.Nk,I.input.YBb,I.input.source,ab,this.KDa.qsa);var ac=I.output.xK;3===ab&&0<ac.length&&(Fb.MergedRevision=this.w$g(I.output.xK.last()));return Fb}w$g(I){const ra=I.A_,ab=pf.App.oa.Da.Zb;return new Jf.a(I,ra,ab.Lc,ab.fileId,ab.LEb,ab.contextId,ra?ra.id:yd.a.nil,this.vvi,!1,!0)}Vzc(I,ra){return(new Qd(I)).Vzc(ra)}Uzc(I,ra,ab,Fb){return(new Qd(I)).Uzc(ra,
ab,Fb)}}Object(f.a)(Kq,"GraphMerger",dg.a,[]);class vm extends Kq{constructor(I,ra=null,ab=null){super(I,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ra,ab);this.ma=new u.a}get qsa(){return this.KDa?this.KDa.qsa:0}get delayedMergeOperation(){return null}set delayedMergeOperation(I){}kIj(I){this.ma.addHandler(vm.Ubf,I)}nYm(I){this.ma.removeHandler(vm.Ubf,I)}oSf(){return!1}u5b(I,ra,ab,Fb,ac,Xc,Md){(I=super.u5b(I,ra,ab,Fb,ac,Xc,Md))&&this.ma.raiseEvent(vm.Ubf,new Ac(I));return I}}vm.Ubf="GMC";
Object(f.a)(vm,"WordEditorGraphMerger",Kq,[1885,1274,1275]);class Rp{constructor(){this.W=null}get name(){return"WordEditor.GraphMerge"}yb(I){this.W=I;this.W.ha("WordEditor.GraphMerge.GraphMergeCollectionConsentManager",()=>new cc(this.W.za("WordEditor.IBusinessBarController"),new Jb.a(()=>I.ra("Box4.IFeatureHelper")))).as("Box4.IGraphMergeCollectionConsentManager").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupThrottler",()=>new hb(this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IGraphMergeBackupThrottler").singleInstance();
this.W.ha("WordEditor.GraphMerge.WordEditorGraphMerger",()=>new vm(()=>Q.AFrameworkApplication.rootQuerySignature,this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("WordEditor.GraphMerge.IWordEditorGraphMerger").singleInstance();this.W.ha("WordEditor.GraphMerge.GraphMergeBackupManager",()=>new zf(()=>Q.AFrameworkApplication.rootQuerySignature,Q.AFrameworkApplication.pa,this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger"),
this.W.resolve("WordEditor.GraphMerge.IGraphMergeBackupThrottler"),this.W.resolve("Box4.IGraphMergeCollectionConsentManager"))).as("Box4.IGraphMergeBackupManager").singleInstance()}init(){pf.App.rP||(pf.App.rP=Pd.a.Oba());const I=this.W.resolve("WordEditor.GraphMerge.IWordEditorGraphMerger");pf.App.rP.BTj(I);this.W.resolve("Box4.IGraphMergeBackupManager")}dispose(){let I=this.W.ra("Box4.IGraphMergeBackupManager");I&&I.dispose()}}Object(f.a)(Rp,"GraphMergePackage",null,[1,2]);var pg=b(123);class yj{constructor(I){this.kPb=
0;this.Zf=I}ebh(I){this.kPb=Math.max(0,--this.kPb);this.qsi(I);0<this.kPb&&window.setTimeout(()=>{this.ebh(I)},1E3)}qsi(I){I.style.backgroundColor="rgba(255,0,0,"+Math.min(1,this.kPb/20)+")"}LZm(I){this.Zf&&this.Zf.tym&&(this.kPb++,this.qsi(I),this.Zf.P8h=sj.a.S4e(I,!1),1===this.kPb&&window.setTimeout(()=>{this.ebh(I)},1E3))}}Object(f.a)(yj,"ParagraphRenderVisualizationManager",null,[1884]);class Tj{constructor(I,ra,ab,Fb,ac){this.Upc=this.J3c=this.Dsc=this.Zf=null;this.Xee=new sa.a;this.Xpc=null;
this.Hwg=0;this.ga=I;this.EN=ra;this.Se=ab;this.poa=Fb;this.Edg=ac}get tym(){return this.Upc?this.Upc.checked:!1}get P8h(){return this.Hwg}set P8h(I){this.Xpc&&(this.Xpc.innerText=String.format("Total number of child elements in last rendered paragraph: {0}",I));this.Hwg=I}eb(){this.ga.ka(of.a.j8g,Qf.a.application,Object(x.a)(this,this.showTaskPane,"showTaskPane"))}dispose(){null!==this.Zf&&(this.EN.evb(Tj.Iw,this.Zf),this.Zf=null);this.poa.execute(I=>{this.jjh(I,ra=>{ra.EYm(Object(x.a)(this,this.Vdi,
"onTypingSpeedMeterWindowAvailable"))})});this.Edg.execute(I=>{this.ijh(I,ra=>{ra.GKf(Object(x.a)(this,this.LCb,"onCpuMeterFrameAvailable"))})})}Vdi(I,ra){this.Dsc&&(this.Dsc.innerText=ra.Pgm+" CPM")}LCb(I,ra){this.J3c&&(this.J3c.innerText=ra.zNc.CP+"%",this.Xee.add(ra.zNc.CP))}$rd(){const I=new sb.CuiHelper(pg.a.z8a,Box4Intl.Box4Strings);this.Zf=this.EN.UUe(Tj.Iw,0,Tj.width,"InteractivePerfTaskPaneData",I);this.Nfk();this.Kfk();this.Mfk()}showTaskPane(){if(!pf.App.oa.sib)return 16;this.Zf||this.$rd();
this.EN.showTaskPane(this.Zf);this.Zf.element.style.overflow="scroll";return 32}V7e(I){I=document.getElementById(I);return sj.a.OIa(sj.a.OIa(I,"cui-groupContainer"),"cui-groupBody")}ijh(I,ra){const ab=I.Zp.task;ab.continueWith(()=>{ra(ab.result)})}jjh(I,ra){const ab=I.Zp.task;ab.continueWith(()=>{ra(ab.result)})}Nfk(){const I=this.V7e("TypingSpeedMeterGroup");I.style.margin="10px";I.style.fontSize="15px";const ra=document.createElement("div");ra.innerText="Typing Speed";this.Dsc=document.createElement("div");
this.Dsc.innerText="0 CPM";this.poa.execute(ab=>{this.jjh(ab,Fb=>{Fb.$Ij(Object(x.a)(this,this.Vdi,"onTypingSpeedMeterWindowAvailable"))})});I.appendChild(ra);I.appendChild(this.Dsc)}Kfk(){const I=this.V7e("CpuMeterGroup");I.style.margin="10px";I.style.fontSize="15px";const ra=document.createElement("div");ra.innerText="CPU Meter";this.J3c=document.createElement("div");this.Edg.execute(ac=>{this.ijh(ac,Xc=>{Xc.qld(Object(x.a)(this,this.LCb,"onCpuMeterFrameAvailable"))})});const ab=document.createElement("div"),
Fb=document.createElement("button");Fb.innerText="View Cpu Percent";this.Se.Ea(F.a.click,Fb,Object(x.a)(this,this.Uvk,"displayCpuPercentLogs"));ab.appendChild(Fb);I.appendChild(ra);I.appendChild(this.J3c);I.appendChild(ab)}Mfk(){const I=this.V7e("RenderGroup"),ra=document.createElement("label");ra.innerText="Enable render visualizations";this.Upc=document.createElement("input");this.Upc.setAttribute("type","checkbox");I.appendChild(this.Upc);I.appendChild(ra);this.Xpc=document.createElement("div");
this.Xpc.style.margin="10px";I.appendChild(this.Xpc);ia.a.instance.ha("Box4.IParagraphRenderVisualizationManager",()=>new yj(this))}Uvk(){const I=la.a.Ql("","LogFile","","InteractivePerf.DisplayCpuPercentLogs").document;I.writeln("<HEAD>");I.writeln('<STYLE type="text/css">');I.writeln("* { padding: 0px; margin: 0px; font-family: monospace; }");I.writeln("</STYLE>");I.writeln("</HEAD>");I.writeln("<BODY style='BACKGROUND-COLOR: #f3f8fd;'>");const ra=document.createElement("div");var ab=document.createElement("div");
ab.innerText=String.format("{0}, {1}","Frame","CpuPercent");ra.appendChild(ab);for(ab=0;ab<this.Xee.count;ab++){const Fb=this.mWj(ab,this.Xee.J(ab));Fb&&ra.appendChild(Fb)}I.writeln(ra.innerHTML);I.writeln("</BODY>");I.close();return!0}mWj(I,ra){I=I.toString();ra=ra.toString();const ab=document.createElement("div");ab.innerText=String.format("{0}, {1}",I,ra);return ab}}Tj.Iw="InteractivePerfTaskPane";Tj.width=400;Object(f.a)(Tj,"InteractivePerfTaskPane",null,[]);class lp{constructor(){this.Zf=null}get name(){return"WordEditor.InteractivePerfTaskPane"}yb(I){I.ha("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane",
()=>new Tj(Q.AFrameworkApplication.pa,og.a.instance,Q.AFrameworkApplication.na.yx,I.za("Common.ITypingSpeedMeterProvider"),I.za("Common.ICpuMeterProvider"))).singleInstance()}init(){if(this.Zf=ia.a.instance.ra("WordEditor.InteractivePerfTaskPane.InteractivePerfTaskPane"))this.Zf.eb(),"1"===vb.a.tX(document.URL,"wdShowIPerfTaskPane")&&Q.AFrameworkApplication.pa.processAction(of.a.j8g,2)}dispose(){this.Zf&&(this.Zf.dispose(),this.Zf=null)}static main(){aa.a.instance.Lb(new lp)}}Object(f.a)(lp,"InteractivePerfTaskPanePackageManager",
null,[1,2]);var en=b(286);class fn{constructor(I){this.Ude="FontPicker";this.Qne=null;this.s2a=I;this.Q5c=this.s2a.vBa(en.a.nBb,Object(x.a)(this,this.Wvb,"featureStateChangeCallback"));this.s2a.isFeatureEnabled(en.a.nBb,!1).then(ra=>{this.Qne=ra})}get isLicensed(){return this.Qne}Wvb(I){this.Qne=I.isEnabled;I=appChrome.actions.updateFontPickerLicenseState(this.Ude,I.isEnabled);appChrome.api.dispatch(I)}dispose(){this.s2a.R8b(en.a.nBb,this.Q5c)}}Object(f.a)(fn,"ModernFontPickerFeatureHelper",null,
[1009,14]);var Fr=b(468),Lq=b(600),wo=b(1486);class Vg{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(f.a)(Vg,"FontInfoTaskPaneProps",null,[]);class Xm{constructor(I,ra,ab,Fb=null){this.vEe=this.pT=this.Q5c=null;this._state=this.zOb=0;this.Tqe=I;this.s2a=ra;this.L8i=ab;this.fb=Fb}get Eb(){return this.Tqe.value}initialize(){this.Eb.ka(Ya.a.ILf,vf.a.frame,Object(x.a)(this,this.ILf,
"requestFontInfo"));this.Q5c=this.s2a.vBa(en.a.nBb,Object(x.a)(this,this.Wvb,"featureStateChangeCallback"));this.Bea()}NM(I=!1){const ra=uh.UISurfaces.Ms(),ab=this.s2a.isFeatureEnabled(en.a.nBb,!1),Fb=[];Fb.push(ra);Fb.push(ab);Promise.all(Fb).then(ac=>{ac[0].showTaskPane(wo.a.mwb,this.Tz(ac[1]));I&&this.ZM()})}UPn(I){uh.UISurfaces.Ms().then(ra=>{ra.updateTaskPane(wo.a.mwb,this.Tz(I));return null})}Wvb(I){this.UPn(I.isEnabled)}ILf(I,ra,ab,Fb,ac){this.pT=ac.CommandValueId;this.vEe=ac.Trigger;this.zOb=
ac.InputMethod;this.NM(2===this._state&&1===this.zOb);return 32}Tz(I){const ra=new Vg;ra.onUpsellButtonClicked=Object(x.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");ra.fontName=this.pT;ra.isLicensed=I;ra.trigger=this.vEe;ra.helpArticleUrl=this.Sbk();ra.paneId=wo.a.mwb;I=this.xzl();I.contentProps=ra;return I}xzl(){return Object.assign(new Di.a,{title:wo.a.yfb,hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(x.a)(this,
this.onOpen,"onOpen"),onClose:Object(x.a)(this,this.onClose,"onClose"),onShow:Object(x.a)(this,this.onShow,"onShow"),onHide:Object(x.a)(this,this.onHide,"onHide")})}Bea(){if(this.fb){var I=this.fb.fd(wo.a.mwb);I.parent=ei.AFrame.uo;I.rK=!0}}onOpen(){this._state=2;this.ZM()}onShow(I){0!==this._state&&(this._state=2,1===I&&(this.zOb=I),this.ZM())}onClose(){this.zOb=this._state=0;this.blur()}onHide(){this._state=1;this.zOb=0}ZM(){this.fb&&1===this.zOb&&this.fb.Kf(wo.a.mwb)}blur(){this.fb&&this.fb.nf&&
this.fb.nf.name===wo.a.mwb&&this.fb.Kf(this.fb.$Q)}onUpsellButtonClicked(){this.s2a.launchUpsellExperience(wo.a.experienceId)}dispose(){this.s2a.R8b(en.a.nBb,this.Q5c)}Sbk(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.L8i,this.C2k(),"WDWAENDUSER",Q.AFrameworkApplication.lcid)}C2k(){switch(this.vEe){case "missing":return"hlpFontInfoMissingFont";case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";
case "theme":return"hlpFontInfoThemeFont"}return Xm.QVj(this.pT)}static QVj(I){let ra="hlpFontInfo";for(let ab=0;ab<I.length;++ab){const Fb=gb.a.charAt(I,ab);if(255<I.charCodeAt(ab)||gb.a.tPh(Fb))ra+=Fb}return ra}}Object(f.a)(Xm,"FontInfoPane",null,[931,14]);class Bl extends Xm{constructor(I,ra,ab,Fb,ac){super(I,ra,Fb.Ga("FontInfoHelpBaseUrl"),ac);this.EN=ab}NM(I){this.YW();super.NM(I)}Wvb(I){super.Wvb(I);pf.App.oa.updateCommandUI()}YW(){this.EN.OHa()}}Object(f.a)(Bl,"WordEditorFontInfoPane",Xm,[]);
class Tn{constructor(){this.RMb=this.Pad=this.ojc=this.W=null}get name(){return"WordEditor.ModernFontPicker"}yb(I){this.W=I;I.ha("Common.ModernFontPicker.IModernFontPickerFeatureHelper",()=>new fn(this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))).singleInstance();I.ha("Common.ModernFontPicker.IFontInfoPane",()=>new Bl(new Jb.a(()=>Q.AFrameworkApplication.pa),this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),og.a.instance,Q.AFrameworkApplication.K,
Eg.FocusManager.instance())).singleInstance()}init(){this.Pad=this.W.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper");this.ojc=this.W.resolve("Common.ModernFontPicker.IFontInfoPane");this.ojc.initialize();Q.AFrameworkApplication.K.$("IsAnonymousUser")||((this.RMb=this.W.ra(Lq.a))?this.RMb.initialize():ha.ULS.sendTraceTag(557061451,3021,15,"IFontPinningStore service is not available."));pf.App.oa.updateCommandUI()}dispose(){this.ojc&&(this.ojc.dispose(),this.ojc=null);this.Pad&&(this.Pad.dispose(),
this.Pad=null);this.RMb&&(this.RMb.wwc(),this.RMb=null)}static main(){Object(Fr.a)()&&aa.a.instance.Lb(new Tn)}}Object(f.a)(Tn,"ModernFontPickerPackage",null,[1,2]);var In=b(121),Rl=b(5),Gr=b(39),Dn=b(18),cs=b(970);class cm{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg,gi,Ei=null){this.Bz=ab;this.Vb=I;this.Fb=ra;this.Vd=ac;this.vDa=Xc;this.bW=Md;this.nbg=bf;this.mbg=Hf;this.Ao=Zg;this.Zaj=Ei||cm.av}get ag(){return this.Ao?this.Ao.ag:!1}mNh(I){return this.uza(I,0)}tCl(I){return this.uza(I,1)}uza(I,ra){let ab=
null;if(this.ag&&this.bW&&(this.mbg.instance&&this.mbg.instance.LCa(I),ra?1===ra&&(ab=this.bW.byh(I.node)):ab=this.bW.s6e(I.node,I.cpBegin,I.Qa),ab&&!ab.ia(dh.a.k4,!1)))return ha.ULS.shipAssertTag(24749379,368,!1,"Try to insert page break to inconvertible inline content control"),2;const Fb=Rl.GraphIterator.qR(this.Vb.Dj());Fb.set(I.node);Fb.La(10);const ac=this.Fb.Ob(15);ac.Lr(Fb);ra?Gr.OutlineElementNavigator.Wc(Fb):(this.splitParagraph(Fb,I),this.Bz.Occ(I.node,cf.a.Nq));I=mj.ParagraphReader.Bl(Fb.currentNode);
this.DDl(Fb);this.ag&&ab&&this.nbg&&(ra=new sa.a,ra.add(Fb.currentNode),this.nbg.cNg(ra,ab.id));this.xfn(I);ac.dispose();return 32}xfn(I){I=he.SelectionFactory.vd(I,0);Ee.a.instance.setSelection(I)}DDl(I){this.Vd.bA(I,!0,!0,null,!1,!1);I=Gr.OutlineElementNavigator.Fd(I);this.uCl(I)}splitParagraph(I,ra){const ab=Gr.OutlineElementNavigator.Wc(I);if(ra.cpBegin||this.ag&&(!this.ag||-1!==ra.Qa)){Dn.a.instance.J(4)&&pf.App.lc.$n&&ra.cpBegin!==mj.ParagraphReader.textLength(ra.node)&&pf.App.lc.zp.aF(ra.node);
this.Vd.bA(I,!1,!0,null,!1,!0);var Fb=Rl.GraphIterator.qR(this.Vb.Dj());Fb.set(ab);this.Vd.o$(Fb,I,ra,!0,!0,!0)}}uCl(I){I=this.Zaj(I);this.vDa.GNh(I)}static gC(){return new cm(new cg.a,new sh.a,ia.a.instance.resolve("Box4.IAutoCorrectScheduler"),cs.a.instance,ia.a.instance.resolve("Box4.IOutlineElementEditor"),ia.a.instance.resolve("Box4.IBlobEditor"),ia.a.instance.ra("Box4.IContentControlReader"),ia.a.instance.ra("Box4.IContentControlEditor"),ia.a.instance.za("Box4.IContentControlConverter"),ia.a.instance.ra("Box4.ContentControlConfigSettings"),
ia.a.instance.resolve("Box4.List.IListReader"))}static get instance(){return cm._instance||(cm._instance=cm.gC())}static av(I){return El.a.av(I)}}cm._instance=null;Object(f.a)(cm,"PageBreakInserter",null,[1910]);class lk{constructor(I,ra,ab,Fb,ac,Xc,Md,bf){this.ga=I;this.Dme=ra;this.Fb=ab;this.vl=Fb;this.Xoe=ac;this.Gm=Xc;this.yjj=Md;this.Bb=bf}eb(){this.ga.ka(of.a.uza,Qf.a.view,Object(x.a)(this,this.GDl,"insertPageBreakViewHandler"));this.ga.ka(of.a.uza,Qf.a.Ub,Object(x.a)(this,this.FDl,"insertPageBreakIpHandler"));
this.ga.ka(of.a.uza,Qf.a.table,Object(x.a)(this,this.EDl,"insertPageBreakBeforeTableHandler"));this.ga.Qb(of.a.uza,4)}k1(){const I=Eg.FocusManager.instance().fd(In.AppFrame.iC);ei.AFrame.mh(I,wc.KeyInputManager.mb(cf.a.Nq,wc.KeyInputManager.Bg),of.a.uza)}GDl(I,ra,ab,Fb){var ac=ra.view,Xc=ac.Ma.If;if(!Xc)return 2;if(!this.nPe(ra))return 8;if(1===ab)return 32;let Md=!0;ab=8;const bf=this.Xoe(Xc);Xc=this.Fb.Ob(15);Xc.Oa(ac.sc);Xc.ql=I;bf||(ab=this.ga.Le(ra,Ng.a.Uha,2,!0,Fb,null),I=32===ab,ha.ULS.shipAssertTag(4208012,
314,I),Md=I);Md&&(ac=ac.Ma.If,I=this.Xoe(ac),ha.ULS.shipAssertTag(4208013,314,I,"{0}",{["ContextId"]:ra.contextId}),ab=8,I&&(ab=this.Dme.mNh(ac),ha.ULS.shipAssertTag(4208014,314,32===ab)));Xc.dispose();32===ab&&this.Bb.Xq(10);return ab}mNl(I){return this.Jv(I.iterator)}LQl(I){I=I.J(0);const ra=Bk.SelectionEditor.Ri(I,!0,!1);if(this.Jv(ra.sa.iterator))return!0;I=Bk.SelectionEditor.Ri(I,!1,!1);return this.Jv(I.sa.iterator)}Jv(I){return I.La(14)}FDl(I,ra,ab){if(!ra||ra.contextId!==Qf.a.Ub)return 8;if(1===
ab)return ra.contextId===Qf.a.Ub?32:8;if(2===ab){if(!this.nPe(ra))return 8;I=this.Dme.mNh(ra);32===I&&this.Bb.Xq(10);return I}return 32}EDl(I,ra,ab){if(!ra||ra.contextId!==Qf.a.table)return 8;if(1===ab)return 32;if(2===ab){if(!this.nPe(ra))return 8;I=this.Dme.tCl(ra);32===I&&this.Bb.Xq(10);return I}return 32}nPe(I){let ra=null,ab=I;if(ab.contextId===Qf.a.view){ra=ab.view;if(!ra.features.iWf)return!1;ab=ra.Ma.If;if(!ab)return!1}else{const Fb=Rl.GraphIterator.va(ab.node);if(Fb.La(36)||Fb.La(38)||Fb.La(40)||
Fb.La(14))return!1}return pf.App.mtb(I)?!1:ab.contextId===Qf.a.table?this.Gm.ZMl(ab.node):!this.Gm.XMl(ab)||this.vl&&this.vl.instance&&this.vl.instance.JR(ab)?!1:((I=this.Xoe(ab))?this.mNl(ab):this.LQl(ra.Ma.Ca))||I&&this.yjj(ab,!0)?!1:!0}static gC(){return new lk(Q.AFrameworkApplication.pa,cm.instance,new sh.a,ia.a.instance.za("Box4.IExternalSelectionManager"),Bk.SelectionEditor.ke,xf.a.instance,jp.HyperlinkReader.yja,ia.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get instance(){return lk._instance||
(lk._instance=lk.gC())}}lk._instance=null;Object(f.a)(lk,"PageBreakActor",null,[1879]);class km{constructor(){this.hve=this.W=null}get name(){return"WordEditor.PageBreak"}yb(I){this.W=I}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{this.El()})}El(){this.hve=lk.instance;this.hve.eb();this.hve.k1();pf.App.oa.updateCommandUI()}dispose(){}}Object(f.a)(km,"PackageManager",null,[1,2]);var Oq=b(1284),jo=b(81),et=b(1285),vp=b(243),jf=b(165),Sp=b(248),En=b(277),bq=b(355);class xo{constructor(I,
ra,ab,Fb,ac,Xc,Md){this.fpb=null;this.ma=new u.a;this.pfe=1;this.H$c=-1;this.VQa=null;this.ya=ra;this.Ta=ab;this.Q4c=Fb;this.hG=ac;this.iu=Xc;this.YE=Md;this.enable()}get Nyc(){return this.pfe}jEi(I){this.pfe!==I&&(this.pfe=I,this.ma.raiseEvent("X"),this.Nkf&&this.s0f())}get Nkf(){const I=ia.a.instance.ra("WordEditor.Pagination.IPageEndMarkers");return I?I.Nkf:!0}get ee(){return this.hG.value}get hj(){return Ae.a.instance}pHj(I){this.ma.addHandler("X",I)}s0f(){this.hj.$c(()=>{this.YE.JM(bq.a.ufi)},
"CPC:UPN")}enable(){this.ya.aC(Object(x.a)(this,this.oka,"onProcessSetSelectionFinished"));this.cOe()}oka(){this.cOe()}cOe(){if(!this.VQa||1>=this.VQa.count)this.jEi(1);else{var I=this.ya.Ca.Fa;if(I){var ra=I.Ie?I.Pb:I.sa;!ra||0>ra.cpBegin||(I=ra.node)&&mj.ParagraphReader.tb(I)&&this.IMl(I)&&(this.fpb&&(this.Ta.me(this.fpb),this.fpb=null),this.fpb=new gc.a(2,1,400,ab=>{this.findCurrentPageFromIp(ab,ra)},62),this.Ta.ub(this.fpb))}}}IMl(I){I=Rl.GraphIterator.va(I);return I.La(35)||I.La(37)||I.La(39)?
!1:!0}pVi(I){this.VQa=I;this.WTi()}WTi(){if(-1!==this.H$c){var I=this.WHk(this.H$c);-1!==I&&this.jEi(I)}}findCurrentPageFromIp(I,ra){this.fpb===I&&(this.fpb=null,this.H$c=this.XPk(ra),-1!==this.H$c&&this.WTi())}WHk(I){if(!this.VQa)return-1;for(let ra=0;ra<this.VQa.count;ra++){const ab=this.VQa.J(ra);if(I>ab.XLg&&I<ab.XLg+ab.height)return ab.ii}return-1}XPk(I){var ra=this.dal(I);if(!ra||!ra.htmlElement)return-1;const ab=ra.getBounds();I=this.fXk(I,ra);if(!I)return-1;ra=la.a.gWa(this.Q4c.ufb,ra.htmlElement).y;
return I.y+Math.floor(I.height/2)-ab.y+ra}dal(I){return I.node.Sd(this.ee.gb)}fXk(I,ra){I=this.iu?this.iu.Lba(I,!0):I.cpBegin;return En.a.Zo(ra,I)}disable(){this.ya.fea(Object(x.a)(this,this.oka,"onProcessSetSelectionFinished"))}}Object(f.a)(xo,"CurrentPageCalculator",null,[1971,1966]);class ug{constructor(I){ug.mW=I}get FVe(){return ug.mW}get Nyc(){return this.FVe.Nyc}tAk(){this.FVe.enable()}Iuk(){this.FVe.disable()}}ug.mW=null;Object(f.a)(ug,"CurrentPageManager",null,[1970]);var yo=b(109);class Tp extends Sys.EventArgs{constructor(I,
ra){super();this.u7h=ra}}Object(f.a)(Tp,"DocumentBottomChangeEventArgs",Sys.EventArgs,[]);class Sk extends Sys.EventArgs{constructor(I,ra,ab){super();this.delta=I;this.u7h=ab}}Object(f.a)(Sk,"PageContentSizeChangeEventArgs",Sys.EventArgs,[]);class fj{constructor(I,ra,ab){this.UAg=this.Gdd=-1;this.Boc=null;this.ma=new u.a;this.jte=!1;this.hG=I;this.KPa=ra;this.SQa=new sa.a;this.ee.FPg(Object(x.a)(this,this.yxm,"pageViewOnAfterValidate"));this.Qdf();this.lka=this.lka.bind(this);ab.xTb(this.lka)}get ee(){return this.hG.value}lka(){this.Boc=
null}get ufb(){this.Boc||(this.Boc=this.ee.sc.Sd(this.ee.gb).ufb,ha.ULS.shipAssertTag(34136386,336,!!this.Boc));return this.Boc}xIj(I){this.ma.addHandler("OnPageContentSizeChangeKey",I)}yxm(I,ra){this.jte=this.Y3j();ra.ofb||this.KPa.value.measure(Object(x.a)(this,this.T3j,"checkForDocumentSizeChanges"))}T3j(){const I=this.ufb.clientHeight;this.S3j(I);this.a4j(I)}S3j(I){I!==this.UAg&&(this.ma.raiseEvent("OnDocumentBottomChangeKey",new Tp(I,this.jte)),this.UAg=I)}a4j(I){I!==this.Gdd&&(-1!==this.Gdd&&
this.ma.raiseEvent("OnPageContentSizeChangeKey",new Sk(I-this.Gdd,I,this.jte)),this.Gdd=this.ufb.clientHeight)}Y3j(){let I=!1;for(let ra=this.SQa.count-1;0<=ra;ra--)this.SQa.J(ra).hasChildNodes()&&(this.SQa.removeAt(ra),I=!0);return I}Qdf(){pf.App.aj.Pk.Yd(23).Yl(Object(x.a)(this,this.GBf,"outlineGroupOnPropertyChanged"))}GBf(I,ra){ra.property===yo.a.JG&&(I=ra.node)&&I.ia(yo.a.JG,!1)&&(I=I.Sd(this.ee.gb))&&(I=I.htmlElement)&&this.SQa.add(I)}}Object(f.a)(fj,"DocumentSizeManager",null,[]);var Sl=b(58),
Wf=b(262);class uq{constructor(I){this.hG=I}get ee(){const I=this.hG.value;ha.ULS.shipAssertTag(37820298,336,I.Rh,"OutlineManager.PageView is not a PageView.");return I}F0d(I,ra){const ab=Sl.a.Vh(uq.vh.$z(I),1);ra+=ab;I.Sd(this.ee.gb).htmlElement.firstChild.style.minHeight=ra+"px"}Wuh(){const I=Rl.GraphIterator.va(this.ee.sc);I.fn();I.Xc();ha.ULS.shipAssertTag(37820299,336,10===I.rm.type);return I.rm}rxh(){const I=Rl.GraphIterator.va(this.ee.sc);I.fn();I.A8();ha.ULS.shipAssertTag(37820300,336,10===
I.rm.type);return I.rm}Sbl(I){const ra=Rl.GraphIterator.va(this.ee.sc);ra.fn();ra.Xc();let ab=ra.rm,Fb=null;for(;I!==ab&&ra.ni();)Fb=ab,ab=ra.rm;ha.ULS.shipAssertTag(37820301,336,10===ra.rm.type);return Fb}static get vh(){return Wf.a.instance}}Object(f.a)(uq,"OutlineManager",null,[1969]);class cl{constructor(I){this.cva=0;this.mZ=null;this.Ta=I}BSd(){this.mZ||(this.mZ=this.syc())}Hpd(){this.mZ&&0<cl.ICc(this.mZ).length&&this.Ta.ub(this.mZ);this.mZ=null}syc(){return Object.assign(new gc.a(3,1,250,
Object(x.a)(this,this.VSf,"showAdornmentTextBatched"),166),{customData:[]})}pQf(I){this.cva=I}pWc(I){if(I){I.style.width=this.cva+"px";if(this.mZ)var ra=this.mZ;else ra=this.syc(),this.Ta.ub(ra);cl.ICc(ra).push(I)}}mGc(I){I&&(I.style.width="0px",this.udf(I))}tZc(I,ra){ra?this.pWc(I):this.mGc(I)}VSf(I){for(let ra of I.customData)this.showAdornmentText(ra)}showAdornmentText(I){I.style.width===this.cva+"px"&&(this.UCc(I).style.visibility="visible")}udf(I){I&&(this.UCc(I).style.visibility="hidden")}UCc(I){I=
I.childNodes;ha.ULS.shipAssertTag(24958351,336,1===I.length,"Expected 1 child div in the page adornment, found "+I.length);return I[0]}static ICc(I){return I.customData}}Object(f.a)(cl,"PageAdornmentAnimationManager",null,[1968]);class Mm{constructor(I){this.Bk=I;this.I6=new Dc.a;this.J6=new Dc.a}Zwa(I){I=Rl.GraphIterator.va(I);if(I.fn()&&I.ro()){I.Xc();do 10===I.Md&&this.YDf(I.currentNode),I.Ns();while(8!==I.Md)}}zGb(I){const ra=I.ii;var ab=this.Jxb(I.kIb);if(!this.I6.Ja(ab))return ha.ULS.sendTraceTag(24958352,
336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+ab),!1;I=this.I6.J(ab);ha.ULS.shipAssertTag(24958353,336,this.J6.Ja(ab),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");ab=this.J6.J(ab);return this.pdf(I,ra,ab)}yGb(I){const ra=I.ii;var ab=this.Jxb(I.kIb);if(!this.I6.Ja(ab))return ha.ULS.sendTraceTag(24958354,336,10,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+
ab),!1;I=this.I6.J(ab);ha.ULS.shipAssertTag(24958355,336,this.J6.Ja(ab),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");ab=this.J6.J(ab);return this.f3e(I,ra,ab)}Eaf(I){if(!I)return ha.ULS.sendTraceTag(24979136,336,10,"Null container input into GetTemplateSelectionFromContainer."),0;var ra=I.qnd;if(!ra)return ha.ULS.sendTraceTag(24979137,336,10,String.format("Container of page number {0} has a null EndSectionNode.",I.ii)),0;
ra=this.Bk.$wb(ra);if(!ra)return ha.ULS.sendTraceTag(24979138,336,10,"Header footer container node expected not to be null."),0;ra=this.Bk.Wia(ra);const ab=1===I.ii;I=!(I.ii%2);return 1===ra?1:2===ra?ab?2:1:3===ra?I?3:4:ab?2:I?3:4}YDf(I){if(10===I.type){var ra=new Dc.a,ab=this.Bk.$wb(I);ha.ULS.shipAssertTag(24958356,336,!!ab,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var Fb=this.Bk.Wia(ab);I=this.Jxb(I);this.E0f(I,
Fb);this.D0f(I,ra);ab=Rl.GraphIterator.va(ab);if(ab.ro()){ab.Xc();do I=ab.currentNode,Fb=this.Bk.Tzd(I),I=this.Bk.vJh(I),ra.add(Fb,I),ab.Ns();while(36===ab.Md)}}}E0f(I,ra){this.J6.Ja(I)?this.J6.Z(I,ra):this.J6.add(I,ra)}D0f(I,ra){this.I6.Ja(I)?this.I6.Z(I,ra):this.I6.add(I,ra)}Jxb(I){ha.ULS.shipAssertTag(24958358,336,10===I.type,"Expected node of type Outline but received node of type "+I.type);return I.ia(dh.a.pea,0)}pdf(I,ra,ab){const Fb=1===ra;ra=!(ra%2);switch(ab){case 2:if(Fb){if(I.Ja(2))return I.J(2)}else if(I.Ja(0))return I.J(0);
break;case 3:if(ra){if(I.Ja(1))return I.J(1)}else if(I.Ja(0))return I.J(0);break;case 4:if(Fb){if(I.Ja(2))return I.J(2)}else if(ra){if(I.Ja(1))return I.J(1)}else if(I.Ja(0))return I.J(0);break;case 1:if(I.Ja(0))return I.J(0)}return!1}f3e(I,ra,ab){const Fb=1===ra;ra=!(ra%2);switch(ab){case 2:if(Fb){if(I.Ja(5))return I.J(5)}else if(I.Ja(3))return I.J(3);break;case 3:if(ra){if(I.Ja(4))return I.J(4)}else if(I.Ja(3))return I.J(3);break;case 4:if(Fb){if(I.Ja(5))return I.J(5)}else if(ra){if(I.Ja(4))return I.J(4)}else if(I.Ja(3))return I.J(3);
break;case 1:if(I.Ja(3))return I.J(3)}return!1}}Object(f.a)(Mm,"PageAdornmentContentManager",null,[1967]);var ko=b(1009);class Hr{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,Hf){this.K1f(I,ra,ab,Xc,Md,bf,Hf);this.ii=I;this.Wo=ra;this.Vq=ab;this.kIb=Fb;this.qnd=ac;this.g9a=Xc;this.C0b=Md;this.OYb=bf;this.Kfi=Hf}get top(){return this.Wo}get height(){return this.Vq}JVc(I){this.Wo!==I&&(this.g9a.style.top=I+"px",this.Wo=I)}VPf(I){this.height!==I&&(this.g9a.style.height=I+"px",this.Vq=I)}K1f(I,ra,ab,Fb,ac,Xc,Md){ha.ULS.shipAssertTag(37244961,
336,0<I,"PageAdornmentContainer: pageNumber parameter value {0} is unexpected value.",I);ha.ULS.shipAssertTag(37244962,336,0<=ra,"PageAdornmentContainer: top parameter value {0} is unexpected value.",ra);ha.ULS.shipAssertTag(37244963,336,0<=ab,"PageAdornmentContainer: height parameter value {0} is unexpected value.",ab,ra);ha.ULS.shipAssertTag(37244992,336,!!Fb,"PageAdornmentContainer: containerDomElement parameter is null.");ha.ULS.shipAssertTag(37244993,336,!!ac,"PageAdornmentContainer: headerLabelDomElement parameter is null.");
ha.ULS.shipAssertTag(37244994,336,!!Xc,"PageAdornmentContainer: footerLabelDomElement parameter is null.");ha.ULS.shipAssertTag(37244995,336,!!Md,"PageAdornmentContainer: pageNumberLabelDomElement parameter is null.")}}Object(f.a)(Hr,"PageAdornmentContainer",null,[1985]);class pn{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg,gi,Ei,Il){this.Blg="headerFooterTab";this.Mhd=null;this.nt=!0;this.Rke=0;this.lqe=null;this.HWa=!1;this.hG=I;this.Se=ra;this.kJ=ab;this.vfa=Fb;this.ga=ac;this.Bi=Xc;this.US=Md;this.mua=
bf;this.JEa=Hf;this.Ta=Zg;this.qa=gi;this.Txe=[];this.kZ=new Map;this.AW=Ei;this.uv=Il;this.JEa.rld(Object(x.a)(this,this.syb,"headerFooterDismissedEvent"));this.Pw=!!Q.AFrameworkApplication.na&&Q.AFrameworkApplication.na.Ya.a9;if(this.j9c=(this.Pme=!!this.qa&&this.qa.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&!!this.qa&&this.qa.$("DisableHeaderFooterTabForSmallScreenModeIsEnabled"))"Small"===pf.App.oa.Vw.getLayoutBreakpoint()&&(this.nt=!1),pf.App.oa.Vw.registerLayoutBreakpointChanged(this.Blg,
Kk=>{switch(Kk){case "Small":this.RJh();break;default:this.hIi()}})}get ee(){return this.hG.value}hIi(){try{this.Rrn()}catch(I){ha.ULS.shipAssertTag(37244997,336,!1,"Exception was caught in ShowPageAdornments. Message: {0} Stack: {1}",I.message,I.stack)}}RJh(){try{this.Kul()}catch(I){ha.ULS.shipAssertTag(37244998,336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",I.message,I.stack)}}RWm(){for(const I of this.kZ.keys())this.PXd(I)}Zwa(){try{this.Sak()}catch(I){ha.ULS.shipAssertTag(37244999,
336,!1,"Exception was caught in HidePageAdornments. Message: {0} Stack: {1}",I.message,I.stack)}}pVi(I){try{this.OPn(I)}catch(ra){ha.ULS.shipAssertTag(37245E3,336,!1,"Exception was caught in UpdatePageElements. Message: {0}",ra.message)}}dispose(){try{this.mKn(),this.QKn(),this.JEa&&this.JEa.Mri(Object(x.a)(this,this.syb,"headerFooterDismissedEvent"))}catch(I){ha.ULS.shipAssertTag(37245001,336,!1,"Exception was caught in PageAdornmentManager.Dispose. Message: {0} Stack: {1}",I.message,I.stack)}}UCb(I){this.Xjm(I.$p);
return!0}Xjm(I){const ra=this.cJc(I),ab=this.ysh(I);ab?(I=this.mua.Eaf(ab),this.ga.hb(ra?of.a.c8d:of.a.C_c,2,I),this.HWa=!0):(ha.ULS.sendTraceTag(37245002,336,10,"GetContainerFromElement returned a null container for element with id "+I.id),this.ga.processAction(of.a.FGd,2))}gE(){return!0}syb(){this.XSe()&&(this.HWa=!1,this.JLn(),this.lqe=new Date)}WCb(I){this.HWa||this.US.pWc(I.$p);return!0}VCb(I){this.HWa||(I=I.$p,this.DSf(I)||this.US.mGc(I));return!0}mKn(){this.kZ.forEach(I=>{this.Wib(I)})}QKn(){this.Pw&&
(this.j9c&&(pf.App.oa.Vw.unregisterLayoutBreakpointChanged(this.Blg),this.j9c=!1),this.Pw=!1)}Wib(I){if(I){var ra=I.C0b;I=I.OYb;sj.a.fAa(ra)&&sj.a.fAa(I)?(this.Bi.xb(F.a.yK,ra,Object(x.a)(this,this.WCb,"onMouseHoverOver")),this.Bi.xb(F.a.yK,I,Object(x.a)(this,this.WCb,"onMouseHoverOver")),this.Bi.xb(F.a.bH,ra,Object(x.a)(this,this.VCb,"onMouseHoverLeave")),this.Bi.xb(F.a.bH,I,Object(x.a)(this,this.VCb,"onMouseHoverLeave")),this.Se.xb(F.a.click,ra,Object(x.a)(this,this.UCb,"onHeaderFooterClickEvent")),
this.Se.xb(F.a.click,I,Object(x.a)(this,this.UCb,"onHeaderFooterClickEvent")),this.kJ.xb(ra,pn.KCb),this.kJ.xb(I,pn.KCb),this.vfa.xb(F.a.Lv,ra,Object(x.a)(this,this.gE,"onMouseDown")),this.vfa.xb(F.a.Lv,I,Object(x.a)(this,this.gE,"onMouseDown"))):ha.ULS.sendTraceTag(37245003,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}nKm(I){Array.enqueue(this.Txe,I);this.Mhd||(this.Mhd=new gc.a(2,1,50,Object(x.a)(this,this.ERm,"registerEventHandlersTask")),this.Ta.ub(this.Mhd))}ERm(){let I=
Array.dequeue(this.Txe);for(;I;)this.tY(I),I=Array.dequeue(this.Txe);this.Mhd=null}tY(I){if(I){var ra=I.C0b;I=I.OYb;sj.a.fAa(ra)&&sj.a.fAa(I)?(this.Bi.Ea(F.a.yK,ra,Object(x.a)(this,this.WCb,"onMouseHoverOver")),this.Bi.Ea(F.a.yK,I,Object(x.a)(this,this.WCb,"onMouseHoverOver")),this.Bi.Ea(F.a.bH,ra,Object(x.a)(this,this.VCb,"onMouseHoverLeave")),this.Bi.Ea(F.a.bH,I,Object(x.a)(this,this.VCb,"onMouseHoverLeave")),this.Se.Ea(F.a.click,ra,Object(x.a)(this,this.UCb,"onHeaderFooterClickEvent")),this.Se.Ea(F.a.click,
I,Object(x.a)(this,this.UCb,"onHeaderFooterClickEvent")),this.kJ.Ea(ra,pn.KCb),this.kJ.Ea(I,pn.KCb),this.vfa.Ea(F.a.Lv,ra,Object(x.a)(this,this.gE,"onMouseDown")),this.vfa.Ea(F.a.Lv,I,Object(x.a)(this,this.gE,"onMouseDown"))):ha.ULS.sendTraceTag(37245004,336,15,"Invalid DOM element for the given adornment container in PageAdornmentManager.")}}Rrn(){if(!this.nt){for(let I of this.kZ.values())I.g9a.style.display="block";this.nt=!0}}Kul(){this.nt&&(this.kZ.forEach(I=>{I.g9a.style.display="none"}),this.nt=
!1)}Sak(){this.mua.Zwa(this.ee.sc)}OPn(I){this.US.BSd();var ra=0;const ab=new sa.a;this.Zwa();const Fb=this.T4k();for(var ac of I)I=ac.ii,this.Ywm(ac)||this.PXd(ac.ii),this.kZ.has(I)?this.RMn(ac):this.Qgk(ac),ra=I,ab.add(I);for(ac=1;ac<=ra;ac++)ab.contains(ac)||this.PXd(ac);for(ra+=1;ra<=Fb;ra++)this.PXd(ra);this.US.Hpd()}Ywm(I){return this.kZ.has(I.ii)?this.kZ.get(I.ii).kIb.id===I.kIb.id:!1}T4k(){let I=0;this.kZ.forEach((ra,ab)=>{ab>I&&(I=ab)});return I}Qgk(I){const ra=I.kIb.Sd(this.ee.gb);if(ra){var ab=
I.ii;I=this.gyc(ab,I.top,I.height,ra.Zha,I.kIb,I.qnd);this.nKm(I);this.D_f(I);this.S0f(I);this.j9c&&!this.nt&&(I.g9a.style.display="none");this.kZ.set(ab,I)}}gyc(I,ra,ab,Fb,ac,Xc){const Md=nj.b("div","","PageAdornmentContainer");Md.style.top=ra+"px";Md.style.height=ab+"px";Fb.appendChild(Md);this.dOe(Md,WordEditorIntl.WordEditorStrings.l_Header,WordEditorIntl.WordEditorStrings.l_Footer);Fb=this.AUe(I);Md.appendChild(Fb);const bf=this.XTe(I);Md.appendChild(bf);const Hf=this.NTe(I);Md.appendChild(Hf);
Q.AFrameworkApplication.isRtl&&(Md.classList.add("Rtl"),bf.classList.add("Rtl"),Hf.classList.add("Rtl"));return new Hr(I,ra,ab,ac,Xc,Md,bf,Hf,Fb)}XTe(I){I=nj.b("div","h"+I,this.uv?"PageAdornmentHeaderLabelThemed":"PageAdornmentHeaderLabel");this.AW&&(this.uv?I.classList.add("PageAdornmentHeaderFooterBorderThemed"):I.style.borderColor=ko.a.p8d);const ra=nj.b("span","","");ra.innerText=WordEditorIntl.WordEditorStrings.l_Header;ra.style.whiteSpace="nowrap";I.appendChild(ra);return I}NTe(I){I=nj.b("div",
"f"+I,this.uv?"PageAdornmentFooterLabelThemed":"PageAdornmentFooterLabel");this.AW&&(this.uv?I.classList.add("PageAdornmentHeaderFooterBorderThemed"):I.style.borderColor=ko.a.p8d);const ra=nj.b("span","","");ra.innerText=WordEditorIntl.WordEditorStrings.l_Footer;ra.style.whiteSpace="nowrap";I.appendChild(ra);return I}AUe(I){const ra=nj.b("div","","PageAdornmentNumberLabel");ra.innerText=I.toString();return ra}dOe(I,ra,ab){if(!this.Rke){const Fb=nj.b("p","","");Fb.innerText=ra;Fb.style.whiteSpace=
"nowrap";Fb.style.visibility="hidden";I.appendChild(Fb);ra=nj.b("p","","");ra.innerText=ab;ra.style.whiteSpace="nowrap";ra.style.visibility="hidden";I.appendChild(ra);this.Rke=I.clientWidth;this.US.pQf(this.Rke);I.removeChild(Fb);I.removeChild(ra)}}PXd(I){if(this.kZ.has(I)){var ra=this.kZ.get(I);this.Wib(ra);sj.a.Zs(ra.g9a);this.kZ.delete(I)}}RMn(I){if(this.kZ.has(I.ii)){var ra=this.kZ.get(I.ii);ra.JVc(I.top);ra.VPf(I.height);this.D_f(ra);this.S0f(ra)}else ha.ULS.sendTraceTag(37245005,324,15,"We called UpdateContainerForPage, but a container doesn't exist for the given page.")}JLn(){this.US.BSd();
this.Zwa();this.kZ.forEach(I=>{this.D_f(I);this.S0f(I)});this.US.Hpd()}D_f(I){const ra=I.C0b,ab=I.OYb,Fb=this.mua.zGb(I),ac=this.mua.yGb(I);this.aSn(I,Fb,ac);this.US.tZc(ra,Fb);this.US.tZc(ab,ac)}aSn(I,ra=!0,ab=!0){const Fb=I.C0b;I=I.OYb;3!==Q.AFrameworkApplication.pa.mode?(Fb.title=WordEditorIntl.WordEditorStrings.l_OpenHeader,I.title=WordEditorIntl.WordEditorStrings.l_OpenFooter):(Fb.title=ra?WordEditorIntl.WordEditorStrings.l_EditHeader:WordEditorIntl.WordEditorStrings.l_AddHeader,I.title=ab?WordEditorIntl.WordEditorStrings.l_EditFooter:
WordEditorIntl.WordEditorStrings.l_AddFooter)}DSf(I){const ra=this.ysh(I);return ra?this.cJc(I)?this.mua.zGb(ra):this.mua.yGb(ra):(ha.ULS.sendTraceTag(37245006,336,10,"GetContainerFromElement returned null."),!1)}ysh(I){I=I.id;I=I.substring(1,I.length);I=Number.parseInvariant(I);return this.kZ.has(I)?this.kZ.get(I):(ha.ULS.sendTraceTag(37245007,336,10,"Adornment container map does not contain the page number "+I),null)}cJc(I){return I.id.length?"h"===I.id.substring(0,1):(ha.ULS.sendTraceTag(37245008,
336,10,"Empty ID found for adornment"),!0)}S0f(I){const ra=I.height;ra<pn.jem?(I.C0b.classList.add(pn.Fbb),I.OYb.classList.add(pn.Fbb)):(I.C0b.classList.remove(pn.Fbb),I.OYb.classList.remove(pn.Fbb));ra<pn.kem?(I.Kfi.classList.add(pn.Fbb),I.g9a.classList.add(pn.Fbb)):(I.Kfi.classList.remove(pn.Fbb),I.g9a.classList.remove(pn.Fbb))}XSe(){return!this.lqe||E.a.kdf(this.lqe,500)}static KCb(){return!0}}pn.Fbb="Hidden";pn.jem=120;pn.kem=50;Object(f.a)(pn,"PageAdornmentManager",null,[1965,14,1966]);class ql{constructor(I,
ra){this.jTd=new sa.a;this.jTd.add(I);this.jTd.add(ra)}}Object(f.a)(ql,"PageElementManagerList",null,[]);var Gp=b(55);class rl{constructor(I,ra,ab){this.Lj=I;this.CPb=[];this.QE=ra;this.AW=ab}Hpi(){for(let I=0,ra=this.CPb.length;I<ra;I++)sj.a.Zs(this.CPb[I]);Array.clear(this.CPb)}Tth(I,ra,ab,Fb,ac,Xc){let Md=Math.min(Fb.x-Xc.x,ac.x-Xc.x);Fb=Math.min(Xc.x+Xc.width-(Fb.x+Fb.width),Xc.x+Xc.width-(ac.x+ac.width));ra+=ac.y-Xc.y;({Oda:ra,leftMargin:Md,rightMargin:Fb}=this.JKj(ra,Md,Fb));I=this.i$k(I,Md,
Fb,Md,Fb,ab);I.style.top=ra+"px";I.style.zIndex="0";this.CPb.push(I);Gp.c(I,!0);return I}$Ad(I){return I?I.querySelector(".PageBreakBorderSpan"):null}i$k(I,ra,ab,Fb,ac,Xc){return I?this.cil(ra,ab,Fb,ac,Xc):this.A$k(Fb,ac,Xc)}JKj(I,ra,ab){ra/=this.Lj.instance.ei;ab/=this.Lj.instance.ei;I/=this.Lj.instance.ei;return{Oda:I,leftMargin:ra,rightMargin:ab}}bMl(I){return this.dYh(I)&&this.Bfi(I)?(I=this.xxb(I))&&I.offsetParent?!1:!0:!1}aMl(I){return!this.dYh(I)||this.Bfi(I)?!1:!0}TO(){}xxb(I){if(!I.FCf)return null;
let ra=null;I.Lcb&&!I.c9?(I=this.$Ad(I.FCf))&&(ra=I):ra=I.FCf;return ra}dYh(I){return I.Lcb&&!I.c9&&I.paragraphNode?!0:!1}Bfi(I){I=I.paragraphNode;return!!I&&!!I.anchor}MZg(I,ra){I=la.a.IIa(I);ra=la.a.IIa(ra);return(I-ra)/this.Lj.instance.ei}gOe(I,ra){I=la.a.IIa(I);ra=la.a.IIa(ra);return(I-ra)/this.Lj.instance.ei}UNd(){this.rVi(!1)}TNd(){this.rVi(!0)}rVi(I){for(let ra=0,ab=this.CPb.length;ra<ab;ra++){const Fb=this.CPb[ra];"PageEndMarker.Para"===Fb.id?rl.uVi(Fb,I):"PageEndMarker.Table"===Fb.id&&rl.kWi(Fb,
I)}}A$k(I,ra,ab){if(!rl.zSb){rl.zSb=nj.b("div","PageEndMarker.Para","PageEndMarker");var Fb=nj.b("div","","Current FullWidth");this.AW&&(Fb.style.borderTopColor=this.QE.qqa());rl.zSb.appendChild(Fb);Fb=nj.b("div","","Stale LeftWing");const ac=nj.b("div","","Stale RightWing");this.AW&&(Fb.style.borderTopColor=this.QE.qqa(),ac.style.borderTopColor=this.QE.qqa());rl.zSb.appendChild(Fb);rl.zSb.appendChild(ac)}Fb=rl.zSb.cloneNode(!0);Fb.childNodes[1].style.width=I-10+"px";Fb.childNodes[2].style.width=
ra-10+"px";rl.uVi(Fb,ab);return Fb}cil(I,ra,ab,Fb,ac){if(!rl.grb){rl.grb=nj.b("div","PageEndMarker.Table","PageEndMarker");var Xc=nj.b("div","","Current LeftWing"),Md=nj.b("div","","Current RightWing");this.AW&&(Xc.style.borderTopColor=this.QE.qqa(),Md.style.borderTopColor=this.QE.qqa());rl.grb.appendChild(Xc);rl.grb.appendChild(Md);Xc=nj.b("div","","Stale LeftWing");Md=nj.b("div","","Stale RightWing");this.AW&&(Xc.style.borderTopColor=this.QE.qqa(),Md.style.borderTopColor=this.QE.qqa());rl.grb.appendChild(Xc);
rl.grb.appendChild(Md)}Xc=rl.grb.cloneNode(!0);Xc.childNodes[0].style.width=I+"px";Xc.childNodes[1].style.width=ra+"px";Xc.childNodes[2].style.width=ab-10+"px";Xc.childNodes[3].style.width=Fb-10+"px";rl.kWi(Xc,ac);return Xc}static uVi(I,ra){ra?rl.p$l(I):rl.q$l(I)}static q$l(I){I.childNodes[0].style.display="none";I.childNodes[1].style.display="block";I.childNodes[2].style.display="block"}static p$l(I){I.childNodes[0].style.display="block";I.childNodes[1].style.display="none";I.childNodes[2].style.display=
"none"}static kWi(I,ra){ra?rl.u$l(I):rl.v$l(I)}static v$l(I){I.childNodes[0].style.display="none";I.childNodes[1].style.display="none";I.childNodes[2].style.display="block";I.childNodes[3].style.display="block"}static u$l(I){I.childNodes[0].style.display="block";I.childNodes[1].style.display="block";I.childNodes[2].style.display="none";I.childNodes[3].style.display="none"}}rl.zSb=null;rl.grb=null;Object(f.a)(rl,"PageEndDOMHelper",null,[]);class br{constructor(I,ra){this.npb=this.ZAg=null;this.Lj=
I;this.Me=ra}zVf(I,ra){try{this.Xxn(I,ra)}catch(ab){ha.ULS.sendTraceTag(35005339,336,10,"Exception was caught in PageEndMarkerPositionComparer.StorePositions. Message: {0}",ab.message)}}nak(I,ra,ab,Fb,ac,Xc,Md){this.Me.$c(()=>{try{this.oak(I,ra,ab,Fb,ac,Xc,Md)}catch(bf){ha.ULS.sendTraceTag(35005341,336,10,"Exception was caught in PageEndMarkerPositionComparer.ComparePositions. Message: {0}",bf.message)}},"PEMPC:CP")}Xxn(I,ra){this.ZAg=I;this.npb=ra}oak(I,ra,ab,Fb,ac,Xc,Md){var bf=this.ZAg;if(bf&&
I){var Hf=bf.count,Zg=I.count;if(Hf&&Zg){var gi=this.wIk(bf,I);if(gi.count){var Ei=this.Lj.ei,Il=this.TVb(gi)/Ei,Kk=this.g5g(gi)/Ei;I=this.Twd(bf,I);if(I.count){bf=this.TVb(I)/Ei;Ei=this.g5g(I)/Ei;var nm=!0;for(var Rf=0;Rf<gi.count;Rf++)if(gi.J(Rf)){nm=!1;break}var Jp=Rf=0;this.npb&&ra&&(Rf=this.c_j(this.npb,ra),Jp=ra.count-this.npb.count);ha.ULS.sendTraceTag(35005343,336,50,"{0}",{["FlightEnabled"]:ab,["HardPageBreakExists"]:ac,["EstimatedPageCount"]:Hf,["CalculatedPageCount"]:Zg,["InOrderAverageDelta"]:Il,
["InOrderStandardDeviation"]:Kk,["ShortestAverageDelta"]:bf,["ShortestStandardDeviation"]:Ei,["PositionsShouldBeUpdated"]:Fb,["DocumentHeightChanged"]:Xc,["DeltasAllZero"]:nm,["HeaderFooterOpenSinceLastResponse"]:Md,["DeltaInViewport"]:Rf,["ChangeInViewportMarkerCount"]:Jp});Xc||Md||nm||(ha.ULS.sendTraceTag(36557839,336,15,"Assumed redundant pagination request but there were changes in the page end marker positions."),ra=gi.toArray().toString(),ab=I.toArray().toString(),ha.ULS.sendTraceTag(35726603,
336,50,"{0} {1}",ra,ab))}}}}else ha.ULS.sendTraceTag(35005342,336,10,"estimatedPositions or calculatedPositions are null in PageEndMarkerPositionComparer.ComparePositionsInternal.")}c_j(I,ra){const ab=new sa.a;for(let Fb of I)ab.add(Fb.top);if(!ab.count)return-1;I=new sa.a;for(let Fb of ra)I.add(Fb.top);if(!I.count)return-1;ra=this.Twd(ab,I);return this.TVb(ra)/this.Lj.ei}TVb(I){if(!I.count)return 0;let ra=0;for(let ab=0;ab<I.count;ab++)ra+=I.J(ab);return ra/I.count}g5g(I){if(!I.count)return 0;const ra=
this.TVb(I);let ab=0;for(let Fb=0;Fb<I.count;Fb++){const ac=I.J(Fb)-ra;ab+=ac*ac}return Math.sqrt(ab/I.count)}wIk(I,ra){const ab=new sa.a;if(!I.count||!ra.count)return ab;I.Sc((ac,Xc)=>ac-Xc);ra.Sc((ac,Xc)=>ac-Xc);const Fb=Math.min(I.count,ra.count);for(let ac=0;ac<Fb;ac++){const Xc=Math.abs(I.J(ac)-ra.J(ac));ab.add(Xc)}return ab}Twd(I,ra){const ab=new sa.a;if(!I.count||!ra.count)return ab;var Fb=I.count<=ra.count;const ac=Fb?I:ra;I=Fb?ra:I;for(ra=0;ra<ac.count;ra++){Fb=ac.J(ra);let Md=Math.abs(Fb-
I.J(0)),bf=0;for(let Hf=1;Hf<I.count;Hf++){var Xc=I.J(Hf);Xc=Math.abs(Fb-Xc);Xc<Md&&(Md=Xc,bf=Hf)}ab.add(Md);I.removeAt(bf)}return ab}}Object(f.a)(br,"PageEndMarkerPositionComparer",null,[1894]);var dl=b(401),gj=b(484);class co{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg){this.Wo=I;this._pageNumber=ra;this.Lcb=ab;this.c9=Fb;this.FCf=ac;this.outlineNode=Xc;this.outlineGroupNode=Md;this.Pyg=bf;this.paragraphNode=Hf;this.fS=Zg}get top(){return this.Wo}get ii(){return this._pageNumber}get rwm(){return this.Pyg}JVc(I){this.Wo=
I}G0d(I){this._pageNumber=I}zCi(I){this.Pyg=I}}Object(f.a)(co,"PageEndMarker",null,[]);class lm{constructor(){this.Qd=null;this.B7h=0}}Object(f.a)(lm,"PageEndMarkerToRestore",null,[]);class dm{constructor(I,ra,ab,Fb,ac,Xc,Md){this.hG=I;this.Lj=ra;this.BFa=ab;this.$v=Fb;this.kve=ac;this.HW=Xc;this.Wm=Md;this.Pr=new sa.a;this.DPb=new sa.a;this.frb=new Dc.a;this.Hjd=new gj.a(new dl.a);this.SQa=new sa.a;this.GPb=!!ac;this.Qdf()}get ee(){const I=this.hG.value;ha.ULS.shipAssertTag(37052750,336,I.Rh,"PageEndMarkerPositionUpdater.PageView is not a PageView.");
return I}HZc(I){try{this.rPn(I)}catch(ra){this.$v.TO(ra.message+" "+ra.stack),ha.ULS.sendTraceTag(38405270,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateMarkers. Exception: {0}",ra.message)}}iFj(I){try{this.jFj(I)}catch(ra){this.$v.TO(ra.message+" "+ra.stack),ha.ULS.sendTraceTag(38405271,336,10,"Exception caught in PageEndMarkerPositionUpdater.AddRenderedMarker. Exception: {0}",ra.message)}}Y_j(I){try{return this.Z_j(I)}catch(ra){this.$v.TO(ra.message+" "+ra.stack),ha.ULS.sendTraceTag(37052752,
336,10,"Exception caught in PageEndMarkerPositionUpdater.CalculatePositions. Exception: {0}",ra.message)}return!1}B3m(){try{this.C3m()}catch(I){this.$v.TO(I.message+" "+I.stack),ha.ULS.sendTraceTag(37052753,336,10,"Exception caught in PageEndMarkerPositionUpdater.RestorePositions. Exception: {0}",I.message)}}HEc(){try{return this.edl()}catch(I){return this.$v.TO(I.message+" "+I.stack),ha.ULS.sendTraceTag(38405273,336,10,"Exception caught in PageEndMarkerPositionUpdater.GetRenderedPageEndMarkers. Exception: {0}",
I.message),null}}C0f(){try{this.WQn()}catch(I){this.$v.TO(I.message+" "+I.stack),ha.ULS.sendTraceTag(37820302,336,10,"Exception caught in PageEndMarkerPositionUpdater.UpdateSectionLastPageHeight. Exception: {0}",I.message)}}DPe(){try{return this.r5j()}catch(I){return this.$v.TO(I.message+" "+I.stack),ha.ULS.sendTraceTag(38405274,336,10,"Exception caught in PageEndMarkerPositionUpdater.CheckVirtualizedHardBreaks. Exception: {0}",I.message),!1}}vDl(I){try{this.wDl(I)}catch(ra){this.$v.TO(ra.message+
" "+ra.stack),ha.ULS.sendTraceTag(38916953,336,10,"Exception caught in PageEndMarkerPositionUpdater.InsertOrDeleteRenderedMarkers. Exception: {0}",ra.message)}}rPn(I){if(I){this.W6j();for(let ra=0;ra<I.length;ra++){const ab=ra+1,Fb=this.dck(I[ra],ab);this.Pr.add(Fb);this.frb.add(ab,Fb)}}}wDl(I){let ra=!1;for(let ab of I)if(ab)if(0<ab.kA)for(let Fb of ab.Jgf)ra=this.ald(Fb,ab.outlineGroupNode)||ra;else if(0>ab.kA){ra=!0;for(let Fb of ab.ktd)this.zrk(Fb.ii)}ra&&this.dLf()}jFj(I){const ra=this.Ash(I.paragraphNode);
this.ald(I,ra)&&this.dLf()}zrk(I){const ra=I-1;0>ra||this.Pr.count<=ra||(this.Pr.removeAt(ra),this.frb.Ja(I)&&this.frb.remove(I))}edl(){const I=new sa.a;for(let ra of this.Pr)this.$2b(ra)&&I.add(ra);return I}ald(I,ra){if(!I)return ha.ULS.sendTraceTag(38385033,336,15,"pageEndDetails is null in PageEndMarkerPositionUpdater.AddRenderedMarkerInternal."),!1;ra=this.$bk(I,ra);I=I.NHl?-1:I.ii;let ab=!1,Fb;this.frb.Ja(I)?(Fb=this.frb.J(I).ii,ra.G0d(Fb),this.Pr.Z(Fb-1,ra),this.frb.remove(I)):(Fb=ra.ii,this.Pr.insert(Fb-
1,ra),ab=!0);return ab}dck(I,ra){return new co(0,ra,I.HardBreak,!1,null,null,null,0,null,null)}$bk(I,ra){const ab=I.vfb,Fb=I.ii,ac=I.fS,Xc=!!ac&&ac.HardBreak,Md=I.c9,bf=I.paragraphNode,Hf=this.Azh(ra),Zg=I.outlineNode;var gi=this.L9e(Zg);if(!gi)return ha.ULS.sendTraceTag(37782370,336,15,"Given an outline node with a null DOM element in ConstructPageEndMarker."),null;let Ei=null;Xc&&(Ei=this.$v.$Ad(I.vfb));I=this.$v.MZg(Ei||ab,Hf);gi=this.$v.gOe(Ei||ab,gi);return new co(gi,Fb,Xc,Md,ab,Zg,ra,I,bf,ac)}Z_j(I){this.DPb=
new sa.a;this.GPb&&this.kve.reset();this.RVm();this.nun();this.KKj();this.O_j(I);return 0<this.DPb.count}RVm(){for(let I=0;I<this.Pr.count;I++){const ra=this.Pr.J(I);this.$v.bMl(ra)?this.G8l(ra):(this.$v.aMl(ra)||this.$2b(ra)&&!this.L9e(ra.outlineNode))&&this.Nqi(ra)}}KKj(){let I=0,ra=null;var ab=0;let Fb=0;for(let ac=0;ac<this.Pr.count;ac++){const Xc=this.Pr.J(ac);this.$2b(Xc)&&(Xc.Lcb&&(Fb+=this.IZg(Xc,ab,Fb)),ra&&ra.id===Xc.outlineNode.id||(ra=Xc.outlineNode,Fb=I=0),Xc.Lcb&&!Xc.c9&&(I=this.M_j(Xc)),
ab=Xc.top+I+Fb,Xc.JVc(ab))}this.IZg(null,ab,Fb);this.JVm()}IZg(I,ra,ab){let Fb=null;this.GPb&&(Fb=this.kve.P_j(I,ra,ab));return Fb?Fb.delta:0}C3m(){if(this.DPb){for(let I=0;I<this.DPb.count;I++){const ra=this.DPb.J(I);sj.a.zdn(ra.Qd,ra.B7h)}this.GPb&&this.kve.y3m()}}WQn(){if(!this.GPb){var I=this.BFa.rxh();if(this.Pr.count){var ra=this.BFa.Wuh();for(let ac=0;ac<this.Pr.count;ac++){var ab=this.Pr.J(ac);if(this.$2b(ab)&&ab.c9){ab=this.BFa.Sbl(ab.outlineNode);var Fb=0<ac?this.Pr.J(ac-1).outlineNode:
ra;Fb=ac&&ab.id===Fb.id?this.Pr.J(ac-1).top:0;this.BFa.F0d(ab,Fb)}}ra=this.Pr.J(this.Pr.count-1);ra.c9?this.BFa.F0d(I,0):this.BFa.F0d(I,ra.top)}else this.BFa.F0d(I,0)}}nun(){this.Pr.Sc((I,ra)=>I.ii-ra.ii)}dLf(){for(let I=0;I<this.Pr.count;I++)this.Pr.J(I).G0d(I+1)}M_j(I){return I?this.LZg(I)-I.top:(ha.ULS.sendTraceTag(37306776,336,15,"CalculatePageEndMarkerDelta called with a null PageEndMarker."),0)}W_j(I){if(!I)return 0;const ra=this.Azh(I.outlineGroupNode);return ra?this.$v.MZg(this.$v.xxb(I),
ra):0}LZg(I){if(!I)return 0;const ra=this.$v.xxb(I);I=this.L9e(I.outlineNode);return I?this.$v.gOe(ra,I):(ha.ULS.sendTraceTag(37782371,336,50,"The given pageEndMarker contains an outline node with a null DOM element in CalculatePageEndMarkerPosition."),0)}JVm(){let I=0,ra=!1,ab=null,Fb=!1;for(let ac=this.Pr.count-1;0<=ac;ac--){const Xc=this.Pr.J(ac);this.$2b(Xc)&&(ab&&ab.id===Xc.outlineNode.id||(ra=!ab,ab=Xc.outlineNode,I=this.Q9k(ab)),Xc.Lcb?(ra=!1,I=Xc.top):this.GPb&&ra||!(Xc.top>I)||(this.Nqi(Xc),
sj.a.Zs(this.$v.xxb(Xc)),Fb=!0))}Fb&&this.dLf()}Nqi(I){this.Pr.contains(I)&&(this.GPb&&this.HW.SWm(I),this.Pr.remove(I))}$2b(I){return I?(I=this.$v.xxb(I))&&I.offsetParent?!0:!1:(ha.ULS.sendTraceTag(38385035,324,50,"PageEndMarker is null in IsPageEndMarkerRendered."),!1)}r5j(){let I=!1;for(let ra=this.SQa.count-1;0<=ra;ra--)this.SQa.J(ra).hasChildNodes()&&(this.SQa.removeAt(ra),I=!0);return I}G8l(I){(I=this.Ash(I.paragraphNode))&&(this.Hjd.contains(I.id)||this.Hjd.add(I.id))}Qdf(){this.Wm&&this.Wm.Yd(23).Yl(Object(x.a)(this,
this.GBf,"outlineGroupOnPropertyChanged"))}GBf(I,ra){ra.property===yo.a.JG&&(I=ra.node)&&I.ia(yo.a.JG,!1)&&this.Hjd.contains(I.id)&&(ra=I.Sd(this.ee.gb))&&(ra=ra.htmlElement)&&(this.Hjd.remove(I.id),this.SQa.add(ra))}O_j(I){for(let ra=this.Pr.count-1;0<=ra;ra--){const ab=this.Pr.J(ra);this.$2b(ab)&&this.N_j(ab,I)}}N_j(I,ra){const ab=this.LZg(I),Fb=this.W_j(I);I.Lcb?(I.JVc(ab),I.zCi(Fb)):(ra=ra?ab-I.top:Fb-I.rwm,I.JVc(ab-ra),I.zCi(Fb-ra),1<Math.abs(ra)&&this.ain(this.$v.xxb(I),ra))}L9e(I){if(!I)return null;
I=I.Sd(this.ee.gb);return I?I.htmlElement:(ha.ULS.sendTraceTag(37782401,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeTop."),null)}Azh(I){return I?(I=I.Sd(this.ee.gb))?I.htmlElement:null:null}Ash(I){I=Rl.GraphIterator.va(I);return I.La(23)?I.mc(23):null}P9k(I){if(!I)return null;I=I.Sd(this.ee.gb);return I?la.a.getElementBounds(I.htmlElement):(ha.ULS.sendTraceTag(37888197,336,50,"outlineNodeHtmlViewElement is null in GetOutlineNodeBounds."),null)}Q9k(I){return(I=this.P9k(I))?I.height/
this.Lj.ei:0}ain(I,ra){ra=(sj.a.WZk(I)-ra)*this.Lj.ei;this.DPb.add(Object.assign(new lm,{Qd:I,B7h:ra}))}W6j(){this.Pr=new sa.a;this.frb=new Dc.a}}Object(f.a)(dm,"PageEndMarkerPositionUpdater",null,[1893]);var em=b(366),Xj=b(38),Ym=b(33),mk=b(800),Oo=b(346),Nm=b(22);class Ek{constructor(I,ra,ab,Fb,ac,Xc,Md=!1,bf=!1,Hf=!1,Zg=!1,gi=!1){this.K1f(ra,ab,Fb,ac,Xc,Hf,gi);this.position=I;this.ii=ra;this.paragraphNode=ab;this.fS=Fb;this.vfb=ac;this.outlineNode=Xc;this.MXa=Md;this.FXh=bf;this.NHl=Hf;this.c9=
Zg;this.Wkf=gi}G0d(I){this.ii=I}K1f(I,ra,ab,Fb,ac,Xc,Md){Md||(ha.ULS.shipAssertTag(38326881,336,!!ac,"PageEndDetails: outlineNode parameter value is null."),ha.ULS.shipAssertTag(24126528,336,0<=I,"PageEndDetails: pageNumber parameter value {0} is unexpected value.",I),ha.ULS.shipAssertTag(24126529,336,!!ra||Xc,"PageEndDetails: paragraphNode parameter is null for a page that is not client-only."),ha.ULS.shipAssertTag(24126530,336,!!ab||Xc,"PageEndDetails: pageEnd parameter is null for a page that is not client-only."),
ha.ULS.shipAssertTag(24126531,336,!!Fb||Xc,"PageEndDetails: pageEndDomElement parameter is null for a page that is not client-only."))}static Qik(I,ra){return Ek.uTe(0,I,null,ra,!0,!1)}static Rik(I){return Ek.uTe(0,0,null,I,!1,!0)}static uTe(I,ra,ab,Fb,ac,Xc){return new Ek(I,ra,null,null,ab,Fb,ac,Xc,!0)}static zWb(I,ra){return new Ek(0,I,null,ra,null,null,void 0,void 0,void 0,void 0,!0)}}Object(f.a)(Ek,"PageEndDetails",null,[]);class Hi{constructor(I,ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg,gi,Ei,Il,Kk,nm,Rf,Jp,
Gu,Pi,Zt,Et){this.Hna=!0;this.Ree=0;this.ycd=this.Ske=this.Tke=this.Sge=this.ive=this.Dke=!1;this.ued=this.Lpb=null;this.loe=!0;this.hG=I;this.zh=ra;this.K6=ab;this.AL=Fb;this.bzg=ac;this.P5a=Xc;Hi.$v=bf;this.okg=Hf;this.kG=Zg;this.Ta=gi;this.yfj=Ei;this.Zc=Kk;this.HW=Rf;this.mve=Jp;this.JPb=Gu;this.mW=Pi;this.gPb=new em.a;this.EPb=new sa.a;this.Pda=new sa.a;this.TQa=new em.a;this.jL=Il;this.BW=Et;this.oTd=this.oTd.bind(this);this.qTd=this.qTd.bind(this);this.xXd=this.xXd.bind(this);this.lka=this.lka.bind(this);
this.jL.pld(Object(x.a)(this,this.JCb,"onContentDirtied"));this.jve=!1;this.czg=Zt;nm&&(nm.lQg(Object(x.a)(this,this.Oyf,"onHeaderFooterShow")),nm.rld(Object(x.a)(this,this.Nyf,"onHeaderFooterDismiss")));Md&&Md.xIj(Object(x.a)(this,this.wqm,"onPageContentSizeChange"));this.BW.xTb(this.lka)}get Nkf(){return this.loe}get ee(){return this.hG.value}get jh(){return this.zh.value}JCb(){this.UNd()}Nyf(){this.Tke=!1}Oyf(){this.Ske=this.Tke=!0}HZc(I,ra){const ab=this.Zc.Pe("Task","UpdateMarkers");this.Vxn();
this.Hna=ra;Hi.$v.Hpi();this.gPb=new em.a;this.EPb.clear();this.Pda.clear();this.TQa=new em.a;this.loe=this.Dke=!1;this.AL&&this.AL.HZc(I);this.iCk();this.Ree=I.length;this.HW&&this.HW.reset(I);this.K6&&this.K6.Zwa();for(let Fb of I)this.Pda.add(Fb),this.SKf(Fb);ra&&this.AL&&this.mve&&this.mve.isEnabled&&(I=this.AL.HEc(),this.mve.uTa(I));this.mak();this.Sge=this.ive=!1;this.Ske=this.Tke;Sn.WoncaApp.instance.Kyb&&Hi.Ief&&this.AL.C0f();this.P5a.NPn(this.AL.HEc(),this.Pda.count);this.loe=!0;this.mW.s0f();
ab.stop();ha.ULS.sendTraceTag(25048922,336,50,"UpdateMarkers stopwatch stopped: {0}",{["DurationInMs"]:ab.Yg,["RenderedLineCount"]:this.Ree,["AvgDurationPerPageInMs"]:ab.Yg/this.Hzh()})}Kzh(){const I=this.AL.HEc();if(!I)return null;const ra=sj.a.z8(),ab=new sa.a;for(let Fb of I)this.sPl(Fb,ra)&&ab.add(Fb);return ab}sPl(I,ra){if(!I)return!1;I=Hi.$v.xxb(I);if(!I)return!1;I=la.a.IIa(I);return 0<=I&&I<=ra}Eph(){const I=new sa.a;if(!this.TQa)return ha.ULS.sendTraceTag(35005382,336,10,"_outlineGroupsWithPageEndDetails is null in PageEndMarkers.GetAbsolutePageEndMarkerPositions."),
I;const ra=this.TQa.keys;for(let ac=0;ac<ra.length;ac++){var ab=ra.J(ac);if(ab=this.TQa.J(ab))for(let Xc=0;Xc<ab.count;Xc++){var Fb=ab.J(Xc);Fb.fS.HardBreak||Object(Xj.a)(Fb.vfb,"Hidden")||(Fb=la.a.IIa(Fb.vfb),I.add(Fb))}}return I}Vxn(){const I=this.Eph(),ra=this.Kzh();this.bzg.zVf(I,ra);this.JPb&&this.JPb.isEnabled&&this.JPb.zVf(ra)}mak(){if(!(25<this.Hzh())){var I=this.Eph(),ra=this.Kzh();this.bzg.nak(I,ra,this.czg,this.ive,this.Dke,this.Sge,this.Ske);this.JPb&&this.JPb.isEnabled&&this.JPb.uTa(ra)}}lka(){this.K6.RWm();
this.adh()}adh(){this.ycd&&(this.ee.$Xm(this.oTd),this.ee.HYm(this.qTd),this.ee.oYm(this.xXd),this.ycd=!1)}iCk(){this.ycd||(this.ee.FPg(this.oTd),this.ee.cJj(this.qTd),this.ee.dQg(this.xXd),this.ycd=!0)}SKf(I){if(this.jve)return!0;I=this.NZm(I);if(!I)return!1;this.HW&&this.HW.mql(I);this.AL&&(this.AL.iFj(I),this.P5a.mVi(this.AL.HEc()),Sn.WoncaApp.instance.Kyb&&Hi.Ief&&this.AL.C0f());return!0}NZm(I){let ra=this.t0(I.ParaId);if(!ra)return null;if(!ra.anchor||!ra.Oh)return this.YOg(I,ra),null;let ab,
Fb;if(I.HardBreak){var ac=mj.ParagraphReader.jg(ra,!0,!0,!0);this.bym(ac)&&(ra=ac);if(!({Oda:ac,outlineGroupNode:ab,tfb:Fb}=this.FHn(I,ra)).returnValue)return null;this.Dke=!0}else if(!({kTd:ac,outlineGroupNode:ab,tfb:Fb}=this.OZm(I,ra,ac,ab,Fb)).returnValue)return null;return this.ald(ra,I,ac,ab,Fb)}bym(I){return I?(I=I.Sd(this.ee.gb))?!!Hi.$v.$Ad(I.htmlElement):!1:!1}OZm(I,ra,ab,Fb,ac){var Xc=I.PageEndType;let Md;ab=0;ac=Fb=null;if(!Xc){if(!({Oda:I,oCf:Md}=this.Lzh(I,ra)).returnValue)return{returnValue:!1,
kTd:ab,outlineGroupNode:Fb,tfb:ac}}else if(!({Oda:I,A4d:Md}=this.j$k(I,ra)).returnValue)return{returnValue:!1,kTd:ab,outlineGroupNode:Fb,tfb:ac};var bf=Rl.GraphIterator.va(ra);bf.nc();Fb=bf.mc(23);ra=Fb.Sd(this.ee.gb).getBounds();bf=bf.IMa().Sd(this.ee.gb);if(!bf)return ha.ULS.sendTraceTag(50997218,314,50,"outlineGroupViewElement is null for ViewId: {0}.",this.ee.gb),{returnValue:!1,kTd:ab,outlineGroupNode:Fb,tfb:ac};ac=bf.getBounds();ab=I-ra.y;Xc=Hi.$v.Tth(Xc,ab,this.Hna,Md,ra,ac);bf.Zha.appendChild(Xc);
return{returnValue:!0,kTd:ab,outlineGroupNode:Fb,tfb:Xc}}FHn(I,ra){let ab=null;const Fb=ra.Sd(this.ee.gb);var ac=0;let Xc=null;if(this.QKd(I,Fb,ra))return{returnValue:!1,Oda:ac,outlineGroupNode:ab,tfb:Xc};ab=Hi.$6h(ra);const Md=ab.Sd(this.ee.gb);if(!Md)return ha.ULS.sendTraceTag(50446550,314,15,"outlineGroupViewElement is null for ViewId: {0}.",this.ee.gb),{returnValue:!1,Oda:ac,outlineGroupNode:ab,tfb:Xc};ac=Md.getBounds();ac=En.a.Zo(Fb,I.CP).y-ac.y;Xc=this.f2k(ra);return{returnValue:!0,Oda:ac,outlineGroupNode:ab,
tfb:Xc}}f2k(I){return I.Sd(this.ee.gb).htmlElement}t0(I){const ra=this.kG.Uab(I);if(ra!==yd.a.nil){const ab=this.jh.Ra(ra);if(ab)return ab}ha.ULS.sendTraceTag(6398172,336,10,"PageEndMarkers: Cannot find graph node for para Id {0} objectId {1}",I,ra);return null}Lzh(I,ra){const ab=I.CP;let Fb=0,ac=null;const Xc=ra.Sd(this.ee.gb);if(this.QKd(I,Xc,ra))return{returnValue:!1,Oda:Fb,oCf:ac};ac=Xc.getBounds();Fb=ab?this.okg(Object(qa.a)(102,Xc),ab):ac.y-this.yfj(Xc);return{returnValue:!0,Oda:Fb,oCf:ac}}j$k(I,
ra){let ab=null,Fb=0;var ac=I.PageEndType;let Xc=Rl.GraphIterator.va(ra);Xc.nc();if(!Ym.TableReader.Jv(Xc))return ha.ULS.sendTraceTag(6398173,336,50,"PageEndMarkers: Para {0} has moved out from inside the table, treating as normal paragraph.",I.ParaId),{returnValue:({Oda:Fb,oCf:ab}=this.Lzh(I,ra)).returnValue,Oda:Fb,A4d:ab};if(1===ac){Nm.returnToContainingRow(Xc);ac=Xc.currentNode.Sd(this.ee.gb);if(this.QKd(I,ac,ra))return{returnValue:!1,Oda:Fb,A4d:ab};Fb=ac.getBounds().y}else{ac=ra.Sd(this.ee.gb);
if(this.QKd(I,ac,ra))return{returnValue:!1,Oda:Fb,A4d:ab};Fb=this.okg(Object(qa.a)(102,ac),I.CP)}--Fb;ra=null;do I=ra,ra=Xc.mc(14);while(ra);Xc=Rl.GraphIterator.va(I);Xc.nc();Nm.moveToFirstRow(Xc);ab=Xc.currentNode.Sd(this.ee.gb).getBounds();return{returnValue:!0,Oda:Fb,A4d:ab}}QKd(I,ra,ab){if(!ra||ra.lLa(16))return this.YOg(I,ab),!0;ra=ra.getBounds();return ra.width||ra.height?!1:(this.qOg(I),!0)}qOg(I){this.EPb.contains(I)||this.EPb.add(I)}YOg(I,ra){ra=ra.id;let ab;({value:ab}=this.gPb.Ab(ra)).returnValue||
(ab=new sa.a,this.gPb.Z(ra,ab));ab.add(I)}oTd(){const I=new sa.a;for(let ra=this.EPb.count-1;0<=ra;ra--){const ab=this.EPb.J(ra);this.SKf(ab)||I.add(ab)}this.EPb=I;this.DPe()}DPe(){this.AL&&this.AL.DPe()&&this.qVi(!1)}wqm(I,ra){1>=Math.abs(ra.delta)||(this.Sge=!0,this.qVi(!ra.u7h))}qVi(I){this.AL&&(this.AL.Y_j(I)&&(this.ive=!0),this.czg&&this.AL.B3m(),this.P5a.mVi(this.AL.HEc()),Sn.WoncaApp.instance.Kyb&&Hi.Ief&&this.AL.C0f())}qTd(I,ra){try{const ab=ra.id;if(this.gPb.Ja(ab)){const Fb=this.gPb.J(ab);
for(I=0;I<Fb.count;I++)this.qOg(Fb.J(I));this.gPb.remove(ab)}}catch(ab){}}UNd(){this.Hna&&(this.Hna=!1,Hi.$v.UNd())}TNd(){this.Hna||(this.Hna=!0,Hi.$v.TNd())}Srn(){this.jve=!1;this.Pda&&this.HZc(this.Pda.toArray(),this.Hna);this.K6&&this.K6.hIi()}Lul(){this.jve=!0;Hi.$v.Hpi();this.K6&&this.K6.RJh();this.HW&&this.HW.Mul()}ald(I,ra,ab,Fb,ac){const Xc=this.Pda.indexOf(ra)+1;if(0>Xc)return null;const Md=Sp.WordSectionNavigator.instance.WO(I),bf=this.c9(ra,I);I=new Ek(ab,Xc,I,ra,ac,Md,!I||!ra||!ac,!1,
!1,bf);this.TQa.Ja(Fb.id)||this.TQa.Z(Fb.id,new sa.a);this.TQa.J(Fb.id).add(I);return I}c9(I,ra){if(!I||!I.HardBreak)return!1;I=Rl.GraphIterator.va(ra);I.La(7);if(I.RD())return!1;I.mc(23);return I.RD()?!1:!0}joi(I){this.Hna&&(I.anchor&&I.Oh?!(I=Hi.$6h(I))||this.Lpb&&this.Lpb.customData&&this.Lpb.customData.id===I.id||(this.Lpb=Object.assign(new gc.a(3,1,500,Object(x.a)(this,this.dQm,"redrawPageEndsForOutlineGroup")),{customData:I}),this.Ta.ub(this.Lpb)):ha.ULS.sendTraceTag(6607198,336,10,"PageEndMarkers: Invalid node while redrawing page ends for outline group"))}dQm(I){I===
this.Lpb&&(this.Lpb=null);if(this.Hna){var ra=I.customData;if(I=this.TQa.get(ra.id))for(this.TQa.Z(ra.id,new sa.a),ha.ULS.sendTraceTag(6558539,336,50,"PageEndMarkers: Redraw page ends for Outline Group [Count: {0}] [Outline group: {1}]",I.count,ra.id),this.K6&&this.K6.Zwa(),ra=0;ra<I.count;ra++){const ab=I.J(ra),Fb=ab.fS;Fb.HardBreak||(sj.a.Zs(ab.vfb),this.SKf(Fb))}}}xXd(){this.Hna&&!this.ued&&this.Pda&&0<this.Pda.count&&(this.ued=new gc.a(3,1,500,Object(x.a)(this,this.cQm,"redrawAllPageEndsInDocument")),
this.Ta.ub(this.ued))}cQm(){this.ued=null;this.Hna&&this.Pda&&0<this.Pda.count&&(ha.ULS.sendTraceTag(6579856,336,50,"PageEndMarkers: Redraw all page ends in the document"),this.HZc(this.Pda.toArray(),this.Hna))}dispose(){this.ee&&this.adh();this.BW.EKf(this.lka);this.jL.FKf(Object(x.a)(this,this.JCb,"onContentDirtied"))}static get Ief(){null==Hi.Wle&&(Hi.Wle=Q.AFrameworkApplication.K.$("ImageOverflowUpdateHeightIsEnabled"));return Hi.Wle}static b2k(I){let ra=0;try{const ab=I.htmlElement,Fb=sj.a.FK(ab.firstChild.style.marginTop);
I=0;const ac=Hi.m$e(ab.parentNode);if(ac){const Xc=ac.firstChild;Xc&&Object(Xj.a)(Xc,"ParaWrappingDiv")&&(I=sj.a.FK(Xc.firstChild.style.marginBottom))}ra=Math.max(Fb,I)/2}catch(ab){}return ra}static m$e(I){let ra=I.previousSibling;if(!ra){var ab=I.parentNode;sj.a.ekf(ab)&&(ab=ab.parentNode)&&(ra=ab.previousSibling)}if(!ra&&(I=I.parentNode,Object(Xj.a)(I,mk.a.afi)||ha.ULS.sendTraceTag(19711369,314,15,"Expected OutlineGroup but encountered a {0} element with classname {1}.",I.tagName,I.className),(I=
I.previousSibling)&&I.hasChildNodes())){ra=I.lastChild;do{if(Object(Xj.a)(ra,"OutlineElement")||sj.a.ekf(ra)&&Object(Xj.a)(ra,Oo.a.J4b))break;ra=ra.previousSibling}while(ra)}if(ra){if(Object(Xj.a)(ra,Oo.a.J4b))return ra.lastChild.lastChild;if(sj.a.ekf(ra))return ra.lastChild}return ra}static $6h(I){I=Rl.GraphIterator.va(I);return I.La(23)?I.mc(23):null}Hzh(){return this.Ree+1}}Hi.$v=null;Hi.Wle=null;Object(f.a)(Hi,"PageEndMarkers",null,[1891,1892,14]);var Lj=b(134);class eo{constructor(I,ra,ab){this.pwm=
".Outline";this.hG=I;this.Lj=ra;this.$v=ab}get ee(){const I=this.hG.value;ha.ULS.shipAssertTag(38416594,336,I.Rh,"Invalid PageView.");return I}yZb(I){return(I=I.outlineNode)?this.yzh(I):(ha.ULS.shipAssertTag(38336522,336,!0,"Error getting last Outline DOM."),null)}yzh(I){let ra,ab;return(ra=I.Sd(this.ee.gb))&&(ab=ra.htmlElement)?ab.querySelector(this.pwm):(ha.ULS.shipAssertTag(39662425,336,!0,"Error getting last Outline DOM."),null)}zsh(I){I=Gr.OutlineElementNavigator.Al(I.paragraphNode);let ra;return I&&
(ra=I.Sd(this.ee.gb))?ra.htmlElement:(ha.ULS.shipAssertTag(38336525,336,!0,"Error calculating containing OE DOM."),null)}zZg(I,ra){const ab=this.Rll(I);return this.T_j(I,ra)-ab}Nth(I){return this.Dzh(I.outlineNode,I.ii)}Dzh(I,ra){if(!I)return-1;var ab=I.ia(dh.a.lA,-1);ab=Sl.a.Vh(ab,1);var Fb=I.ia(dh.a.marginTop,-1);Fb=Sl.a.Vh(Fb,1);I=I.ia(dh.a.marginBottom,-1);I=Sl.a.Vh(I,1);return 1===ra?ab-I:ab-(Fb+I)}xrk(I){I&&sj.a.Zs(I.vfb)}g$e(I){if(I.FXh||I.c9)return 0;if(I.MXa)return I=this.yZb(I),la.a.getElementBounds(I).height/
this.Lj.ei;const ra=this.yZb(I);return this.$v.gOe(this.Jzh(I),ra)}Agk(I,ra,ab){ab=ab.Sd(this.ee.gb).getBounds();I=I.Sd(this.ee.gb);const Fb=I.getBounds();ab.y=Fb.y;ra=this.$v.Tth(0,ra*this.Lj.ei,!1,ab,ab,Fb);I.Zha.appendChild(ra);return ra}TNh(I,ra){if(I&&!I.Wkf)if(I.MXa){if(I=this.yZb(I))I.style.paddingBottom=ra+"px"}else if(I.fS&&I.fS.HardBreak)if(I.c9){if(I=this.RAh(I))I.style.paddingBottom=ra+"px"}else{if(I=this.zsh(I))I.style.paddingTop=ra+"px"}else ha.ULS.shipAssertTag(39077394,336,!1,"Applying blank space on a page which is not hard break or last page.")}YQg(I,
ra){ra=this.yZb(ra);I=this.yZb(I);return la.a.IIa(ra)-la.a.IIa(I)}SAh(I){I=Rl.GraphIterator.va(I.outlineNode);I.La(7);return I.RD()}TUh(I){if(!I||I.Wkf)return!1;if(I.MXa||I.FXh)return!0;I=this.Jzh(I);return!!I&&sj.a.eia(I)}TO(I){this.$v.TO(I)}RAh(I){return(I=this.SAh(I))?(I=I.kj(this.ee.gb).htmlElement,I?I:(ha.ULS.shipAssertTag(39126080,336,!0,"Section dom is null."),null)):null}Jzh(I){return I.fS&&I.fS.HardBreak&&!I.c9?this.$v.$Ad(I.vfb):I.vfb}Rll(I){if(I.MXa){I=this.yZb(I);if(!I)return ha.ULS.shipAssertTag(38336528,
336,!0,"Last outline dom is null."),-1;I=Lj.a.Zz(I);return sj.a.Aca(I.paddingBottom)}if(I.fS&&I.fS.HardBreak){if(I.c9)return(I=this.RAh(I))?sj.a.Aca(I.style.paddingBottom):-1;I=this.zsh(I);return I?sj.a.Aca(I.style.paddingTop):(ha.ULS.shipAssertTag(38336529,336,!0,"Containing outline element Dom is null."),-1)}return 0}T_j(I,ra){return this.g$e(I)-ra}}Object(f.a)(eo,"PageFullHeightDOMHelper",null,[]);class wp{constructor(){this.delta=this.WYi=this.kA=0;this.Nda=null;this.qIa=this.fji=0;this.outlineGroupNode=
null;this.cxa=0;this.Jgf=new sa.a;this.ktd=new sa.a;this.Mgm=new sa.a}}Object(f.a)(wp,"PageFullHeightInfo",null,[]);class qr{constructor(I,ra){this.pva=I;this.aw=ra}JZg(I,ra){try{return this.Q_j(I,ra)}catch(ab){return this.aw.TO(ab.message+" "+ab.stack),ha.ULS.sendTraceTag(38416595,336,10,"Exception caught in CalculatePageFullHeightInfo. Exception: {0}",ab.message),null}}Q_j(I,ra){ha.ULS.shipAssertTag(38416596,336,I.MXa||I.fS.HardBreak);const ab=this.aw.g$e(I),Fb=this.aw.zZg(I,ra),ac=this.pva.wZg(I,
Fb);I=Object.assign(new wp,{cxa:Fb,qIa:ac,Nda:I});this.FOn(I);I.WYi=I.qIa-I.cxa;I.delta=ra+ac+I.delta-ab;return I}FOn(I){I.cxa>I.qIa?this.GOn(I):0>I.cxa&&this.i0f(I)}i0f(I){let ra=I.Nda.ii;for(;0>I.cxa;)I.kA--,I.delta-=this.pva.qDc(ra),I.cxa+=this.pva.qDc(ra-1),ra--;I.qIa=this.pva.qDc(ra)}GOn(I){const ra=this.aw.Nth(I.Nda);I.kA=Math.floor((I.cxa-I.qIa)/ra)+1;I.delta=I.kA*ra;I.cxa-=I.qIa+(I.kA-1)*ra;I.qIa=ra}}Object(f.a)(qr,"PageFullHeightInfoCalculator",null,[]);class Up{constructor(I,ra,ab,Fb){this.nSa=
0;this.FGa=null;this.pva=I;this.Qob=ra;this.RW=ab;this.aw=Fb;this.sCg=new sa.a}get FV(){return this.sCg}mql(I){try{this.ycf(I)}catch(ra){this.aw.TO(ra.message+" "+ra.stack),ha.ULS.sendTraceTag(38148114,336,10,"Exception caught in HandlePageFullHeight. Exception: {0}",ra.message)}}reset(I){try{this.W1m(I)}catch(ra){this.aw.TO(ra.message+" "+ra.stack),ha.ULS.sendTraceTag(38637723,336,10,"Exception caught in PageFullHeightManager.Reset. Exception: {0}",ra.message)}}Mul(){try{this.Nul()}catch(I){this.aw.TO(I.message+
" "+I.stack),ha.ULS.sendTraceTag(39153856,336,10,"Exception caught in PageFullHeightManager.HidePageFullHeights. Exception: {0}",I.message)}}xDl(I){try{this.yDl(I)}catch(ra){this.aw.TO(ra.message+" "+ra.stack),ha.ULS.sendTraceTag(38916954,336,10,"Exception caught in PageFullHeightManager.InsertOrDeleteRenderedPages. Exception: {0}",ra.message)}}SWm(I){try{this.TWm(I)}catch(ra){this.aw.TO("Pagination: "+ra.message+" "+ra.stack),ha.ULS.sendTraceTag(39387716,336,10,"Exception caught in PageFullHeightManager.RemovePageEndDetails. Exception: {0}",
ra.message)}}xAl(){var I=this.RW.C7e(),ra=this.RW.hxh();I=Ek.Rik(I);ra=Ek.Qik(this.nSa,ra);this.FV.Z(0,I);this.ycf(ra)}Z1m(){var I=Sp.WordSectionNavigator.instance.hxh();(I=this.aw.yzh(I).parentNode)&&""!==I.style.minHeight&&(I.style.minHeight="")}sBl(I){this.sCg=new sa.a;this.FV.add(null);for(let ra=0;ra<I.length;ra++){const ab=Ek.zWb(ra+1,I[ra]);this.FV.add(ab)}this.FV.add(Ek.zWb(I.length+1,null))}eBl(I){this.pva.f2m(I)}C2m(){if(this.FV)for(let I of this.FV)I&&this.KSh(I)&&this.aw.TNh(I,0)}ycf(I){const ra=
this.Mbl(I);if(this.aw.TUh(ra)){let ab=this.aw.g$e(ra);I.outlineNode!==ra.outlineNode&&(ab+=this.aw.YQg(I,ra));this.b_j(I,ab);this.KSh(I)&&this.TKf(I,ab)}else this.FGa.add(I),20<this.FGa.count&&ha.ULS.sendTraceTag(39982428,336,15,"Count of _waitingForPreviousPage is "+this.FGa.count);this.FV.Z(I.ii,I);this.fql(I)}Nul(){this.C2m()}W1m(I){this.nSa=I.length+1;this.FGa=new sa.a;this.sBl(I);this.eBl(this.nSa);this.xAl();this.Z1m()}yDl(I){this.pva.QPn(I);for(let ra of I){if(!ra){ha.ULS.sendTraceTag(38916955,
336,10,"info is null.");return}if(0<ra.kA){I=ra.Nda.ii;for(let ab of ra.Jgf)this.FV.insert(I,ab),I++}else if(0>ra.kA)for(let ab of ra.ktd)this.FV.remove(ab),this.FGa.contains(ab)&&this.FGa.remove(ab)}this.Psi()}TWm(I){I=I.ii;this.pva.UWm(I);this.FV.removeAt(I);for(let ra of this.FGa)ra.ii===I&&this.FGa.remove(ra);this.Psi()}b_j(I,ra){ra=this.aw.zZg(I,ra);this.pva.wZg(I,ra)}TKf(I,ra){I.fS&&I.fS.HardBreak||this.Qob.TKf(I,ra)}fql(I){I=I.ii+1;for(let ra of this.FGa)if(ra&&ra.ii===I){this.ycf(ra);this.FGa.remove(ra);
break}}Psi(){for(let I=0;I<this.FV.count;I++){const ra=this.FV.J(I);ra&&ra.G0d(I)}}KSh(I){I=this.b$k(I);return 2===I||1===I}Mbl(I){return this.FV.J(I.ii-1)}b$k(I){return I.MXa?2:I.fS&&I.fS.HardBreak?1:0}}Object(f.a)(Up,"PageFullHeightManager",null,[1912]);class zo{constructor(I,ra,ab,Fb){this.Qob=I;this.pva=ra;this.RW=ab;this.aw=Fb}create(){return new Up(this.pva,this.Qob,this.RW,this.aw)}}Object(f.a)(zo,"PageFullHeightManagerFactory",null,[]);var Po=b(965),Ao=b(554);class cq{constructor(I,ra,ab,
Fb,ac){this.FPb=null;this.HW=I;this.AL=ra;this.Doc=ab;this.Qob=Fb;this.aw=ac}reset(){this.FPb=new sa.a}P_j(I,ra,ab){try{return this.R_j(I,ra,ab)}catch(Fb){return ha.ULS.sendTraceTag(38897350,336,10,"Exception caught in PageFullHeightPositionUpdater.CalculatePageFullHeight. Exception: {0}",Fb.message),null}}y3m(){try{this.z3m()}catch(I){ha.ULS.sendTraceTag(38897351,336,10,"Exception caught in PageFullHeightPositionUpdater.RestorePageFullHeights. Exception: {0}",I.message)}}R_j(I,ra,ab){if(!this.HW.FV.count)return null;
const Fb=this.h$k(I,!I);if(!Fb||Fb.Wkf)return ha.ULS.sendTraceTag(38897352,336,10,"PageEndDetail is null for the given PageEndMarker"),null;if(Fb.fS&&Fb.fS.HardBreak)return null;var ac=this.HW.FV.J(Fb.ii-1);return this.aw.TUh(ac)&&(ra-=ab,Fb.outlineNode!==ac.outlineNode&&(ra+=this.aw.YQg(Fb,ac)),(ac=this.Doc.JZg(Fb,ra))&&1<Math.abs(ac.delta))?(ac.fji=ra,ac.outlineGroupNode=this.N9k(I,Fb),this.FPb.add(ac),this.i0f(ac),ac):null}N9k(I,ra){return ra&&ra.MXa?(I=Object(qa.a)(Ao.a,mj.ParagraphReader.uI(ra.outlineNode)),
I=Rl.GraphIterator.va(I),I.fn(),Object(qa.a)(Po.a,I.mc(23))):I&&I.Lcb?I.outlineGroupNode:null}z3m(){this.FPb.Sc((I,ra)=>ra.Nda.ii-I.Nda.ii);for(let I of this.FPb)this.Qob.vsi(I);this.TPn()}TPn(){this.AL.value.vDl(this.FPb);this.HW.xDl(this.FPb)}h$k(I,ra){return ra?this.HW.FV.J(this.HW.FV.count-1):this.HW.FV.J(I.ii)}i0f(I){let ra=I.Nda.ii;const ab=-I.kA;for(let Fb=0;Fb<ab;Fb++)ra--,I.ktd.add(this.HW.FV.J(ra))}}Object(f.a)(cq,"PageFullHeightPositionUpdater",null,[1911]);class Qo{constructor(I,ra,ab,
Fb,ac){this.HW=I;this.AL=ra;this.Doc=ab;this.Qob=Fb;this.aw=ac}create(){return new cq(this.HW,this.AL,this.Doc,this.Qob,this.aw)}}Object(f.a)(Qo,"PageFullHeightPositionUpdaterFactory",null,[]);class Ro{constructor(I,ra){this.aw=I;this.Doc=ra}TKf(I,ra){try{this.RZm(I,ra)}catch(ab){this.aw.TO(ab.message+" "+ab.stack),ha.ULS.sendTraceTag(38285912,336,10,"Exception caught in RenderPageFullHeight. Exception: {0}",ab.message)}}vsi(I){try{this.QZm(I)}catch(ra){this.aw.TO(ra.message+" "+ra.stack),ha.ULS.sendTraceTag(38855577,
336,10,"Exception caught in RenderPageFullHeightInfo. Exception: {0}",ra.message)}}RZm(I,ra){ha.ULS.shipAssertTag(38285913,336,I.MXa||I.fS.HardBreak);I=this.Doc.JZg(I,ra);this.vsi(I)}QZm(I){this.PZm(I);this.GZm(I)}GZm(I){0<I.kA?this.HDl(I):0>I.kA&&this.yrk(I)}PZm(I){this.aw.TNh(I.Nda,I.WYi)}HDl(I){let ra=I.fji+I.qIa;for(let Fb=0;Fb<I.kA;Fb++){var ab=I.Nda.ii+Fb;const ac=I.Nda.c9?this.aw.SAh(I.Nda):I.Nda.outlineNode;ab=this.zgk(ac,I.outlineGroupNode,ra,ab);I.Jgf.add(ab);I.Mgm.add(ra);ra+=I.qIa}}yrk(I){for(let ra of I.ktd)this.aw.xrk(ra)}zgk(I,
ra,ab,Fb){ra=this.aw.Agk(I,ab,ra);return Ek.uTe(ab,Fb,ra,I,!1,!1)}}Object(f.a)(Ro,"PageFullHeightRenderer",null,[]);class ds{constructor(I){this.OHf=I}}Object(f.a)(ds,"PageHeightDeltaResult",null,[1909]);class qn{constructor(I,ra,ab){this.Eo=null;this.aw=I;this.Me=ra;ab.execute(Fb=>{Fb.register(this)})}get gsf(){return"PageHeightDelta"}get result(){return this.Eo}get gwf(){return 1}get UNf(){return 500}get isEnabled(){return!0}mwf(){this.Eo=null}uTa(I){this.Me.$c(()=>{try{this.Evc(I)}catch(ra){ha.ULS.sendTraceTag(39188045,
324,10,"Exception caught in PageHeightDeltaMetric.Calculate. Exception: {0}",ra.message)}},"PHDM:C")}Evc(I){this.Eo=null;I=this.Hvc(I);-1!==I&&(this.Eo=new ds(I))}Hvc(I){if(!I.count)return-1;let ra=0,ab=0;for(let Fb of I)I=this.S_j(Fb),-1!==I&&(ra+=I,ab++);return ab?ra/ab:-1}S_j(I){if(!I.EKl)return-1;const ra=this.aw.Dzh(I.qnd,I.ii);return-1===ra?-1:Math.abs(I.height-ra)}}Object(f.a)(qn,"PageHeightDeltaMetric",null,[1880]);class Ir{constructor(I){this.IPa=null;this.aw=I}qDc(I){return this.IPa.J(I-
1)}f2m(I){this.IPa=new sa.a;for(let ra=0;ra<I;ra++)this.IPa.add(-1)}wZg(I,ra){if(this.tPl(I))return this.IPa.J(I.ii-1);ra=this.r_j(I,ra);this.Wxn(I,ra);return ra}QPn(I){for(let ra of I)this.PPn(ra)}Wxn(I,ra){this.IPa.Z(I.ii-1,ra)}UWm(I){this.IPa.removeAt(I-1)}PPn(I){if(I)if(0<I.kA){var ra=I.Nda.ii;for(var ab=0;ab<I.kA;ab++)this.IPa.insert(ra,I.qIa)}else if(0>I.kA)for(ra=-I.kA,I=I.Nda.ii-ra,ab=0;ab<ra;ab++)this.IPa.removeAt(I)}tPl(I){return-1!==this.IPa.J(I.ii-1)}r_j(I,ra){if(I.MXa||I.fS.HardBreak)I=
this.aw.Nth(I),ra=ra<I?I:ra;return ra}}Object(f.a)(Ir,"PageHeightStorage",null,[]);var wm=b(246);class Om{constructor(I){this.OHf=I}}Object(f.a)(Om,"PageLevelDeltaResult",null,[1909]);class cr{constructor(I,ra,ab,Fb){this.Eo=null;this.hG=I;this.FN=ra;this.Me=ab;Fb.execute(ac=>{ac.register(this)})}get ee(){const I=this.hG.value;ha.ULS.shipAssertTag(39081438,336,I.Rh,"PageLevelDeltaMetric.PageView is not a PageView.");return I}get gsf(){return"PageLevelDelta"}get result(){return this.Eo}get gwf(){return 0}get UNf(){return 60}get isEnabled(){return!0}mwf(){this.Eo=
null}uTa(I){this.Me.$c(()=>{try{this.Evc(I)}catch(ra){ha.ULS.sendTraceTag(39081440,324,10,"Exception caught in PageLevelDeltaMetric.Calculate. Exception: {0}",ra.message)}},"PLDM:C")}Evc(I){this.Eo=null;I=this.Hvc(I);-1!==I&&(this.Eo=new Om(I))}Hvc(I){if(!I.count)return-1;let ra=0,ab=0;for(let Fb of I)I=this.U_j(Fb),-1!==I&&(ra+=I,ab++);return ab?ra/ab:-1}U_j(I){if(I.Lcb)return-1;var ra=I.fS.CP;I=I.paragraphNode;ha.ULS.shipAssertTag(39081441,336,!!I);I=I.Sd(this.ee.gb);ha.ULS.shipAssertTag(39081442,
324,Object(wm.a)(102,I));let ab;({R7g:ra,$Zh:I,Lvi:ab}=this.G_j(I,sj.a.hy(I.htmlElement).length,ra));return I&&ab?Math.min(ra.x-I.x,ab.x-ra.x):(ha.ULS.sendTraceTag(39081443,336,50,"There was a problem calculating the line boundaries in PageLevelDeltaMetric.CalculatePageLevelDelta."),-1)}G_j(I,ra,ab){let Fb,ac,Xc,Md=ac=ab,bf=Xc=Fb=null;if(ab>ra)return ha.ULS.sendTraceTag(39081472,336,50,"cp > paragraph text length in FidelityTelemetryManager.CalculatePageLevelDelta."),{R7g:bf,xYl:Md,$Zh:Xc,k5m:ac,
Lvi:Fb};bf=this.FN.Zo(I,ab);for(var Hf=0,Zg=ab;Hf<=Zg;){let gi=Math.floor((Hf+Zg)/2),Ei=this.FN.Zo(I,gi);if(Hf===Zg){Md=gi;Xc=Ei;break}Ei.y+Ei.height<=bf.y?Hf=gi+1:Zg=gi}for(;ab<=ra;){Hf=Math.ceil((ab+ra)/2);Zg=this.FN.Zo(I,Hf);if(ab===ra){ac=Hf;Fb=Zg;break}Zg.y>=bf.y+bf.height?ra=Hf-1:ab=Hf}return{R7g:bf,xYl:Md,$Zh:Xc,k5m:ac,Lvi:Fb}}}Object(f.a)(cr,"PageLevelDeltaMetric",null,[1880]);class Fk{constructor(I,ra,ab,Fb,ac,Xc,Md){this.ii=I;this.top=ra;this.XLg=ab;this.height=Fb;this.kIb=ac;this.qnd=Xc;
this.EKl=Md}}Object(f.a)(Fk,"Page",null,[]);class Jn{constructor(I,ra,ab,Fb,ac){this.xPb=null;this.GHg=0;this.hG=I;this.Q4c=ra;this.azg=ab;this.BFa=Fb;this.dzg=ac;this.VQa=new sa.a}get ee(){const I=this.hG.value;ha.ULS.shipAssertTag(37007393,336,I.Rh,"PageManager.PageView is not a PageView.");return I}get pages(){return this.VQa}mVi(I){I=this.jni(I);this.oVi(I)}NPn(I,ra){this.GHg=ra;I=this.jni(I);this.oVi(I);this.dzg.isEnabled&&this.dzg.uTa(I)}jni(I){this.VQa=new sa.a;this.xPb=new em.a(0);const ra=
new sa.a;if(!I)return this.pages;var ab=0,Fb=null;for(let ac=0;ac<I.count;ac++){const Xc=I.J(ac);ab=Xc.ii;Fb=this.Prd(ab,Fb,Xc);this.pages.add(Fb);!Jn.ite&&0>Fb.height&&ra.add(Fb);Fb=Xc}I=this.Prd(ab+1,Fb,null);this.pages.add(I);!Jn.ite&&0>I.height&&ra.add(I);for(let ac of ra)Jn.ite=!0,ha.ULS.shipAssertTag(50968670,336,!1,"Page: height parameter value is negative for page "+ac.ii);return this.pages}Prd(I,ra,ab){const Fb=ra?ra.outlineNode:this.BFa.Wuh(),ac=ab?ab.outlineNode:this.BFa.rxh();var Xc=this.Ezh(Fb);
const Md=this.Ezh(ac),bf=ra?this.HZg(ra):0;Xc=bf+Xc;const Hf=ab?this.HZg(ab):this.Q4c.ufb.clientHeight-Md;return new Fk(I,bf,Xc,Fb.id===ac.id?Hf-bf:Hf+Md-Xc,Fb,ac,(ab?ab.ii:this.GHg+1)===(ra?ra.ii:0)+1)}HZg(I){return I.c9?0:I.top}oVi(I){if(this.azg.jTd)for(let ra of this.azg.jTd)ra&&ra.pVi(I)}Ezh(I){this.xPb||(this.xPb=new em.a(0));if(this.xPb.Ja(I.id))return this.xPb.J(I.id);var ra=I.Sd(this.ee.gb);if(!ra)return ha.ULS.sendTraceTag(37052758,336,15,"OutlineViewElement is null in PageManager.GetOutlineTop."),
0;ra=la.a.gWa(this.Q4c.ufb,ra.htmlElement).y;this.xPb.Z(I.id,ra);return ra}}Jn.ite=!1;Object(f.a)(Jn,"PageManager",null,[1882]);var rn=b(1193);class Bo{constructor(I,ra,ab,Fb,ac,Xc,Md){this.v1f=this.vZa=!1;this.ga=I;this.YE=ra;this.ePa=ab;this.Pr=Fb;this.gh=ac;this.fzg=Xc;this.fD=Md;this.vZa=0===this.fD.XA?!0:!1;this.oxf=this.oxf.bind(this);this.fD.HPg(this.oxf)}eb(){this.ga.Aa(of.a.yRc,Qf.a.application,this.yRc.bind(this),96);this.ga.Aa(of.a.CWd,Qf.a.application,this.CWd.bind(this),96);this.ga.Aa(of.a.x5d,
Qf.a.application,this.x5d.bind(this),96);this.ga.Aa(of.a.u5d,Qf.a.application,this.u5d.bind(this),8)}x5d(I,ra,ab){return 1===ab?32:this.ga.processAction(of.a.QNa,2)}u5d(I,ra,ab,Fb){if(1===ab)return 0===this.fD.XA?32:8;this.vZa?(this.Vdh(),this.v1f=!0):(this.hhh(),this.v1f=!1);this.gh.updateCommandUI();Fb.dr=this.vZa?1:0;return 32}yRc(I,ra,ab,Fb,ac){if(1===ab)return 32;I=this.fzg.cFc();-1===I?I="":this.vZa||1===this.fD.XA?(ra=this.fzg.jth(),ra>I&&(I=ra),I=String.format(WordEditorIntl.WordEditorStrings.l_CurrentPageAndCount,
ra,I)):I=1===I?String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCountSingular,I):String.format(WordEditorIntl.WordEditorStrings.l_TotalPageCount,I);ac[rn.a.Visible]=!0;ac[rn.a.LabelText]=I;return 32}CWd(I,ra,ab,Fb,ac){if(1===ab)return 32;ac[Dl.a.On]=this.vZa;return 32}oxf(I,ra){0!==ra.Q5b||this.v1f?this.Vdh():this.hhh()}hhh(){this.vZa||(this.ePa.tAk(),this.Pr.Srn(),this.vZa=!0)}Vdh(){this.vZa&&(this.ePa.Iuk(),this.Pr.Lul(),this.vZa=!1)}}Object(f.a)(Bo,"PaginationActor",null,[]);class On{constructor(I){this.OHf=
I}}Object(f.a)(On,"PaginationDeltaResult",null,[1909]);class sn{constructor(I,ra){this.npb=this.U5c=null;this.Me=I;ra.execute(ab=>{ab.register(this)})}get gsf(){return"PaginationDelta"}get result(){return this.U5c}get gwf(){return 1}get UNf(){return 200}get isEnabled(){return!0}mwf(){this.U5c=null}uTa(I){this.Me.$c(()=>{try{this.Evc(I)}catch(ra){ha.ULS.sendTraceTag(39686615,324,10,"Exception caught in PaginationDeltaMetric.Calculate. Exception: {0}",ra.message)}},"PDM:C")}zVf(I){this.npb=I}Evc(I){this.U5c=
null;I=this.Hvc(this.npb,I);-1!==I&&(this.U5c=new On(I))}Hvc(I,ra){if(!(I&&ra&&I.count&&ra.count))return-1;const ab=new sa.a;for(let Fb of I)ab.add(Fb.top);I=new sa.a;for(let Fb of ra)I.add(Fb.top);ra=this.Twd(ab,I);return this.TVb(ra)}TVb(I){if(!I.count)return 0;let ra=0;for(let ab=0;ab<I.count;ab++)ra+=I.J(ab);return ra/I.count}Twd(I,ra){const ab=new sa.a;if(!I.count||!ra.count)return ab;var Fb=I.count<=ra.count;const ac=Fb?I:ra;I=Fb?ra:I;for(ra=0;ra<ac.count;ra++){Fb=ac.J(ra);let Md=Math.abs(Fb-
I.J(0)),bf=0;for(let Hf=1;Hf<I.count;Hf++){var Xc=I.J(Hf);Xc=Math.abs(Fb-Xc);Xc<Md&&(Md=Xc,bf=Hf)}ab.add(Md);I.removeAt(bf)}return ab}}Object(f.a)(sn,"PaginationDeltaMetric",null,[1880]);var pj=b(385),lo=b(1215),Mj=b(1796);class Pm extends pj.a{constructor(I,ra,ab,Fb,ac,Xc,Md,bf=null){super();this.wL=null;this.Qee=0;this.nSa=-1;this.xmb=!1;this.BW=I;this.lka=this.lka.bind(this);this.BW.xTb(this.lka);this.ga=ra;this.Pr=ab;this.mW=Fb;this.yga=ac;this.are=bf||Ij.a.instance;this.EOb=this.eFa=yd.a.nil;
this.Zkj=Md;Xc.CWR(()=>Xc.result.xz.bsb(Object(x.a)(this,this.IAa,"onKickedOut")));this.oXb();this.Hi=new lo.a(1E3);this.Hi.vUa();this.yga.register(this)}get fka(){return"Pagination"}get BXb(){return this.Zkj.value}get wXl(){return this.eFa}get mPi(){return this.nSa}Mkn(I){this.nSa!==I&&(this.nSa=I,this.mW.s0f())}lka(){this.eFa=this.EOb=yd.a.nil;this.oXb()}IAa(){ha.ULS.sendTraceTag(7422755,336,50,"PaginationReplicator: disabling replication as user kicked out");this.Xdh()}Seb(I){this.wL=I;this.wL.tTb(Object(x.a)(this,
this.Kyf,"onGraphSpaceReplication"));this.hTb(this.wL.node)}Kyf(){if(0==this.BW.XA){var I=this.wL.Ss;yd.a.Go(I,this.EOb)||(this.EOb=I,this.ppm(this.eFa,this.EOb))}}ppm(I,ra){yd.a.Go(I,ra)?(this.Pr.TNd(),this.oXb()):(this.Pr.UNd(),this.Lwn())}CAk(){this.enabled=2}oXb(){this.enabled=0}Lwn(){this.Qee=0;this.CAk();this.mC(null,null,null)}dja(){return pf.App.lostSession||pf.App.lc.xz.Kn?!1:!!(this.enabled&2)&&this.Hi.SU()}mC(){this.Hi.Y$a();this.yga.nS()}forceOutbound(){}x0(){return 0===this.enabled?!1:
this.Tc&&2===this.Tc.status?!0:this.dja()}yMa(){if(1===this._state)this.Tc.Kq=Mj.a.L7(Q.AFrameworkApplication.rootQuerySignature,this.eFa),this.Tc.GF="Pagination",this.Tc.status=1,this._state=3;else if(3===this._state&&this.Tc&&2===this.Tc.status)if(Q.AFrameworkApplication.Qj)this._state=4;else if(this.Hi.bZ(),this.Hi.g4(),this._state=1,this.Qee++,2!==this.Tc.statusCode)this.pXb();else if(1!==(this.Tc.Vi?this.Tc.Vi.length:0))this.pXb();else{var I=this.Tc.Vi[0];this.are.hjb(I);104===I.StatusCode?this.Xdh():
101===I.StatusCode?this.pXb():3===I.StatusCode?this.pXb():I.StatusCode?this.pXb():I.PageEnds?(this.Mkn(I.PageEnds.length+1),this.eFa=Ti.b(I.LastKnownPaginationRevision),ha.ULS.sendTraceTag(7479449,336,50,"PaginationReplicator: Start rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",this.nSa,this.eFa),this.Pr.HZc(I.PageEnds,yd.a.Go(this.eFa,this.EOb)),this.BXb.Pda=I.PageEnds,this.mW.cOe(),ha.ULS.sendTraceTag(5870302,336,50,"PaginationReplicator: Finished rendering page ends on client after successful replication. [PageCount: {0}] for [Revision: {1}].",
this.nSa,this.eFa),this.Quk()):this.pXb()}}Xdh(){this.wL&&this.wL.TEb(Object(x.a)(this,this.Kyf,"onGraphSpaceReplication"));this.oXb()}pXb(){60<this.Qee&&this.oXb()}Quk(){yd.a.Go(this.eFa,this.EOb)&&this.oXb()}dispose(){this.wL&&(this.wL.TEb(Object(x.a)(this,this.Kyf,"onGraphSpaceReplication")),this.wL.node&&this.FSc(this.wL.node),this.wL=null);this.BW.EKf(this.lka)}hTb(I){I&&(I.addListener(this),this.xmb=!0)}FSc(I){this.xmb&&I&&(I.removeListener(this),this.xmb=!1)}TCb(I){this.FSc(I)}onBeforeLoadContent(){}onAfterLoadContent(I){(I=
I.Lc.sm)&&this.smm(this.eFa,I.id)}onAfterFirstSaveContent(){}smm(I,ra){yd.a.Go(I,ra)&&this.Pr.TNd()}}Object(f.a)(Pm,"PaginationReplicator",pj.a,[1881,14,111]);class sl{constructor(){this.K6=this.Pr=this.mW=this.ePa=this.su=this.Na=this.W=null;this.xna=!1}get name(){return"WordEditor.Pagination"}get $Wn(){return Q.AFrameworkApplication.K.$("WordEditorPageEndMarkerPositionUpdaterIsEnabled")}yb(I){this.W=I;this.Na=this.W.resolve("Box4.IFeatureHelper");this.W.ha("WordEditor.Pagination.PageElementManagerList",
()=>new ql(this.W.resolve("WordEditor.Pagination.PageAdornmentManager"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.OutlineManager",()=>new uq(new Jb.a(()=>pf.App.oa.Da.Jb))).as("WordEditor.Pagination.IOutlineManager").singleInstance();this.W.ha("WordEditor.Pagination.PageManager",()=>new Jn(new Jb.a(()=>pf.App.oa.Da.Jb),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageElementManagerList"),
this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageHeightDeltaMetric"))).as("WordEditor.Pagination.IPageManager").singleInstance();this.W.ha("WordEditor.IPaginationReplicator",()=>new Pm(this.W.resolve("WordEditor.IMainViewModeManager"),Q.AFrameworkApplication.pa,this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"),ri.App.PY,pf.App.Zia(),new Jb.a(()=>this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings")))).singleInstance();
this.W.ha("WordEditor.ICurrentPageManager",()=>new ug(this.W.resolve("WordEditor.Pagination.CurrentPageCalculator"))).singleInstance();this.W.ha("WordEditor.Pagination.PageLevelDeltaMetric",()=>new cr(new Jb.a(()=>pf.App.oa.Da.Jb),this.W.resolve("Box4.ITextMetricsAdapter"),Ae.a.instance,this.W.za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightDeltaMetric",()=>new qn(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),
Ae.a.instance,this.W.za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PaginationDeltaMetric",()=>new sn(Ae.a.instance,this.W.za("WordEditor.FidelityMetrics.IFidelityMetricManager"))).singleInstance();this.W.ha("WordEditor.Pagination.PageHeightStorage",()=>new Ir(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightDOMHelper",()=>new eo(new Jb.a(()=>pf.App.oa.Da.Jb),
this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightInfoCalculator",()=>new qr(this.W.resolve("WordEditor.Pagination.PageHeightStorage"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightRenderer",()=>new Ro(this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"))).singleInstance();
this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory",()=>new Qo(this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),this.W.te("WordEditor.Pagination.PageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightInfoCalculator"),this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightPositionUpdater",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdaterFactory").create()).singleInstance();
this.W.ha("WordEditor.Pagination.PageEndMarkerPositionUpdater",()=>new dm(new Jb.a(()=>pf.App.oa.Da.Jb),this.W.resolve("Common.IZoomManager"),this.W.resolve("WordEditor.Pagination.OutlineManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),this.W.resolve("WordEditor.Pagination.PageFullHeightPositionUpdater"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),pf.App.aj.Pk)).as("WordEditor.Pagination.IPageEndMarkerPositionUpdater").singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManagerFactory",
()=>new zo(this.W.resolve("WordEditor.Pagination.PageFullHeightRenderer"),this.W.resolve("WordEditor.Pagination.PageHeightStorage"),Sp.WordSectionNavigator.instance,this.W.resolve("WordEditor.Pagination.PageFullHeightDOMHelper"))).singleInstance();this.W.ha("WordEditor.Pagination.PageFullHeightManager",()=>this.W.resolve("WordEditor.Pagination.PageFullHeightManagerFactory").create()).singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkerPositionComparer",()=>new br(this.W.resolve("Common.IZoomManager"),
Ae.a.instance)).as("WordEditor.Pagination.IPageEndMarkerPositionComparer").singleInstance();this.W.ha("WordEditor.Pagination.PaginationActor",()=>new Bo(Q.AFrameworkApplication.pa,this.W.resolve("WordEditor.IStatusBarUser"),this.W.resolve("WordEditor.ICurrentPageManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkers"),Q.AFrameworkApplication.na,this.W.resolve("WordEditor.IPageNumberFinder"),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.DocumentSizeManager",
()=>new fj(new Jb.a(()=>pf.App.oa.Da.Jb),Oq.a.get_instance(),this.W.resolve("WordEditor.IMainViewModeManager"))).singleInstance();this.W.ha("WordEditor.Pagination.CurrentPageCalculator",()=>new xo(Q.AFrameworkApplication.pa,Ee.a.instance,jo.a.instance,this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),new Jb.a(()=>pf.App.oa.Da.Jb),this.W.ra("Box4.CpConversionManagerImpl"),this.W.resolve("WordEditor.IStatusBarUser"))).as("Common.ICurrentPageCalculator").singleInstance();this.W.ha("WordEditor.Pagination.PageEndMarkers",
()=>this.Pr=new Hi(new Jb.a(()=>pf.App.oa.Da.Jb),new Jb.a(()=>pf.App.oa.Da.Zb.Lc),this.W.resolve("WordEditor.Pagination.IPageAdornmentManager"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionUpdater"),this.W.resolve("WordEditor.Pagination.IPageEndMarkerPositionComparer"),this.W.resolve("WordEditor.Pagination.IPageManager"),this.W.resolve("WordEditor.Pagination.DocumentSizeManager"),this.W.resolve("WordEditor.Pagination.PageEndDOMHelper"),En.a.oEc,this.W.resolve("WordEditor.ParagraphWordIdMapping"),
jo.a.instance,Hi.b2k,this.W.resolve("Box4.ContentEditableViewEventSource"),new et.a,this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),this.W.resolve("WordEditor.Pagination.PageFullHeightManager"),null,this.W.resolve("WordEditor.Pagination.PaginationDeltaMetric"),this.W.resolve("Common.ICurrentPageCalculator"),this.$Wn,this.W.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.Pagination.IPageEndMarkers").as("Box4.IPaginationRefreshHelper").singleInstance();this.W.ha("WordEditor.Pagination.PageEndDOMHelper",
()=>new rl(this.W.za("Common.IZoomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!pf.App.instance&&pf.App.instance.BM)).singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentAnimationManager",()=>new cl(Q.AFrameworkApplication.Cb)).as("WordEditor.Pagination.IPageAdornmentAnimationManager").singleInstance();this.W.ha("WordEditor.Pagination.PageAdornmentContentManager",()=>new Mm(this.W.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).as("WordEditor.Pagination.IPageAdornmentContentManager").singleInstance();
this.W.ha("WordEditor.Pagination.PageAdornmentManager",()=>this.K6=new pn(new Jb.a(()=>pf.App.oa.Da.Jb),zb.a.instance,vp.a.instance,Oc.a.instance,Q.AFrameworkApplication.pa,jf.a.instance,this.W.resolve("WordEditor.Pagination.IPageAdornmentAnimationManager"),this.W.resolve("WordEditor.Pagination.IPageAdornmentContentManager"),this.W.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),jo.a.instance,Q.AFrameworkApplication.K,!!pf.App.instance&&pf.App.instance.BM,!!pf.App.instance&&pf.App.instance.Cja)).as("WordEditor.Pagination.IPageAdornmentManager").singleInstance()}init(){this.Na.pk.continueWith(()=>
{this.El()})}El(){const I=pf.App.oa.Da;I.Qqa?this.ZRg():I.lba(Object(x.a)(this,this.RMj,"appIsInteractiveEventHandling"))}RMj(){this.ZRg()}ZRg(){this.xna||(this.xna=!0,this.ePa=ia.a.instance.resolve("WordEditor.ICurrentPageManager"),this.mW=ia.a.instance.resolve("Common.ICurrentPageCalculator"),this.su=ia.a.instance.resolve("WordEditor.IPaginationReplicator"),ia.a.instance.resolve("WordEditor.Pagination.PaginationActor").eb())}dispose(){this.K6&&(this.K6.dispose(),this.K6=null);this.Pr&&(this.Pr.dispose(),
this.Pr=null);this.su&&(this.su.dispose(),this.su=null);this.mW&&(this.mW.disable(),this.mW=null);this.ePa&&(this.ePa=null)}}Object(f.a)(sl,"PackageManager",null,[1,2]);class vq{constructor(){this.W=null}yb(I){this.W=I||ia.a.instance}dispose(){}}Object(f.a)(vq,"TellMePackage",null,[1,2]);var Hp=b(1297),S=b(1301),ba=b(265),eb=b(1296),Mb=b(1203);class hc{constructor(I=null,ra=null,ab=null,Fb,ac=null){this.yae=null;this.j9f=!1;this.Aig=this.lKb=null;this.fvj=this.HFg=this.$9f=this.Cig=!1;this.y3c=null;
this.d8i=null==ra?Q.AFrameworkApplication.ssb:ra;this.iij=null==ab?Q.AFrameworkApplication.EX:ab;this.Mvj=null==ac?Q.AFrameworkApplication.m0a:ac;this.Qgj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("TellMeHelpOnHelpIsEnabled");this.wxj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("TellMeCommandHookIsEnabled");this.Kkn(!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("TellMeIgnoreQueryForHelp"));this.mxj=!!Q.AFrameworkApplication.na&&Q.AFrameworkApplication.na.Ya.EKc;
this.nxj=!eb.a.dA()&&!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("TellMePeopleSuggestionIsEnabled");this.lxj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("TellMeFileSuggestionIsEnabled");this.Qdj=!!Q.AFrameworkApplication.na&&Q.AFrameworkApplication.na.Ya.AGb;this.oxj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.Iuj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("HelpShowsTopSearchResult");this.gpj=this.eWc||
this.dWc;this.epj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("OnlineCommandSuggestionsIsEnabled");this.fpj=this.skf;this.gkj=!!Q.AFrameworkApplication.K&&this.JNa&&Q.AFrameworkApplication.K.$("StyledHeaderInLabelIsEnabled");this.pfj=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.Wfj=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",
1400):1400;this.dfj=Q.AFrameworkApplication.K?parseFloat(Q.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.ekj=!!Q.AFrameworkApplication.K&&(Q.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.twj=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl",
"https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.$fj=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.Juj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.yvj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",
!1);this.bvj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("ShowFindInDocumentInZeroTermSearchBox")||this.GY;this.qkj=!!Q.AFrameworkApplication.K&&(Q.AFrameworkApplication.K.$("TellMeTemplateProviderIsEnabled")||Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.Yjj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("TellMeIsRuleBasedSortingEnabled")&&"en-US"===Q.AFrameworkApplication.uiCulture;this.nkj=!!Q.AFrameworkApplication.K&&
(Q.AFrameworkApplication.K.$("TellMeFeedbackProviderIsEnabled")||Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.Bkj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("TellMeZeroTermContextualCommandSuggestionsEnabled");this.R7i=this.JNa&&!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.xgj=!!Q.AFrameworkApplication.K&&
Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.Dvj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1);this.q9i=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.gzj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",
!1);this.Bij=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.Cij=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.Zjj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",!1);this.Vfj=Q.AFrameworkApplication.K?Q.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",
0):0;this.pkj=!!Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("TellMeNotesSuggestionIsEnabled")||this.ETl;this.pxj=this.wXh&&(this.mBf||this.nBf||this.$Oc||this.JNa&&eb.a.aAa()&&!!Q.AFrameworkApplication.K&&(this.oac||this.EGb||this.FGb||this.GGb||this.IGb||Q.AFrameworkApplication.K.$("ShowAnswerSearchResults")||Q.AFrameworkApplication.K.$("ShowDefinitionSearchResults")||Q.AFrameworkApplication.K.$("ShowEntitySearchResults")||Q.AFrameworkApplication.K.$("ShowWolframSearchResults")));this.hAl(I||
{});this.Eze="2918242107";this.Dze="1454393937";this.$ob={};this.w7a=[];this.zdk=[eb.a.p6d]}get application(){return this.lKb}get ssb(){return this.d8i}get F8m(){return this.Eze}get E8m(){return this.Dze}get Y1e(){return this.Aig}get Hlh(){return this.Cig}get EX(){return this.iij}get m0a(){return this.Mvj}get $Sa(){return this.$9f}get tul(){return this.Qgj}get kCn(){return this.wxj}get wXh(){return!0}get ZBn(){return this.pxj}get ynn(){return this.HFg}Kkn(I){this.HFg=I}get JNa(){return this.mxj}get bYc(){return this.nxj}get $Xc(){return this.lxj}get FGk(){return this.Qdj}get XBn(){return this.oxj}get X5d(){return!1}get $Oc(){return this.gpj}get mBf(){return this.epj}get nBf(){return this.fpj}get $Xa(){return!1}get vKd(){return!1}get dmf(){return this.gkj}get Q1d(){return this.fvj}get oac(){return!1}get Ron(){return!1}get wYl(){return""}get skf(){return!1}get $8e(){return 2}get Bcl(){return 4}get Ccl(){return 5}get DCh(){return""}get M_k(){return this.pfj}get UCh(){return this.Wfj}get FCh(){return 1E3}get ECh(){return 1E-6}get Dyn(){return this.twj}get VVf(){return!1}get eMi(){return!1}get xRl(){return this.Yjj}get nJd(){return!1}get eKd(){return!1}get fKd(){return!1}get fUh(){return!1}get eUh(){return!1}get ETl(){return!1}get xXh(){return!1}get Gwd(){return!1}get xhb(){return!1}get EGb(){return!1}get FGb(){return!1}get GGb(){return!1}get IGb(){return!1}get eWc(){return this.Iuj}get iac(){return this.Juj}get dWc(){return!1}get z6e(){return null}get $Jd(){return!1}get I1d(){return this.bvj}get czh(){return 0}get UUk(){return this.dfj}get yDh(){return this.$fj}get zSl(){return this.ekj}get Q7k(){return-3.9}get GY(){return this.yvj}get FKc(){return this.qkj}get vmf(){return this.nkj}get Euc(){return this.R7i}get AVl(){return this.Bkj}get uWa(){return this.xgj}get kJi(){return this.Dvj}get fVj(){return this.q9i}get N7d(){return this.gzj}get qhf(){return this.Bij}get qGl(){return this.Cij}get HRl(){return this.Zjj}get rw(){return this.Vfj}get ldb(){return this.pkj}get uAb(){return!!Q.AFrameworkApplication.na&&
Q.AFrameworkApplication.na.Ya.Jo}get Jo(){return!!Q.AFrameworkApplication.na&&Q.AFrameworkApplication.na.Ya.Jo}get pOl(){return!!Q.AFrameworkApplication.na&&Q.AFrameworkApplication.na.Ya.lac}get dhm(){return $c.getImageClass("OfficeAssistant_32x32x32")}Dzd(){return Promise.reject("GetFindMatchCount method is not overridden")}KKd(I){return Array.contains(appChrome.selectors.getVisibleControlIds(),I)}bId(){return!1}Eoi(){}lyd(){return null}get ryb(){return"NoOpHeaderUi"}get qdk(){return this.y3c}get parameterData(){return this.$ob}get vIn(){return this.w7a}KCk(){if(this.yae&&
!this.j9f&&(this.j9f=!0,this.ohb(this.yae),this.Jo)){var I=ia.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");I=(new Mb.a(I)).byd(this.yae.vE);appChrome.api.dispatch(I)}}get aOf(){return""}ohb(){}Gtk(I){const ra=[];for(let ab=0;ab<I.length;++ab)I[ab].Mpn?ra.push(new ba.a(I[ab].alternate,eb.a.FRi+ab.toString())):ra.push(new ba.a(I[ab].standard,eb.a.p6d+ab.toString()));return ra}hAl(I){const ra={};for(let ab in I){const Fb=ab,ac=I[ab];for(let Xc in ac){const Md=Xc,bf=ac[Xc];(ra[Md]||
(ra[Md]={}))[Fb]=bf}}this.y3c=ra}get NNi(){return""}get MNi(){return""}get LNi(){return""}get eIi(){return!1}}Object(f.a)(hc,"TellMeApplicationData",null,[1018]);class Hc{constructor(I,ra=null,ab=!1){this.standard=I;this.alternate=ra;this.Mpn=ab}}Object(f.a)(Hc,"TryQuerySet",null,[]);var Zc=b(1455);class Dd{get GMa(){return Zc.a.AppsForOffice_Query}P_(I){return vc.a(String.format("{0}|{1}|",3,gb.a.Wd(I.value)),Ya.a.rLc.toString(),Dd.Ejm)}}Dd.Ejm="Explore Office Store";Object(f.a)(Dd,"AppsForOfficeQueryMenuItemFactory",
null,[1037]);var xe=b(1287);class af{constructor(){this.icon=this.description=this.assetId=this.name=null;this.installed=!1;this.storeId=this.currentStoreType=this.assetStoreId=this.appVersion=null;this.targetType=0}}Object(f.a)(af,"OfficeAppItem",null,[]);class eg{constructor(){this.F1c=null}get WSa(){this.F1c||(this.F1c={},this.oIm());return this.F1c}CYj(I){if(I)for(let ra of I)I=ra[1],I in this.WSa&&(I=this.WSa[I],I.installed=!0,I.name=ra[0],I.description=ra[2],I.targetType=ra[3],I.appVersion=
ra[4],I.currentStoreType=ra[6],I.icon=ra[9],I.storeId=ra[11],I.assetStoreId=ra[12])}UCk(I,ra,ab,Fb,ac){!xe.b(I)&&I in this.WSa&&(I=this.WSa[I],I.installed=!0,I.appVersion=ra,I.storeId=ab,I.assetStoreId=Fb,I.targetType=ac)}UW(I,ra,ab,Fb){const ac=new af;ac.assetId=ra;ac.name=I;ac.icon=ab;ac.description=Fb;ac.installed=!1;this.F1c[ra]=ac}oIm(){this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_Translator,"WA104124372",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_Translator,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_Translator);
this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_TextMaster,"WA104079622",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_TextMaster,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_TextMaster);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_ConsistencyChecker,"WA104041485",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_ConsistencyChecker,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_ConsistencyChecker);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_EFax,
"WA102919521",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_EFax,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_EFax);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_ProWordCloud,"WA104038830",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_ProWordCloud,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_ProWordCloud);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_FontFinder,"WA104211266",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_FontFinder,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_FontFinder);
this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_PicHit,"WA104178141",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_PicHit,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_PicHit);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_IMGEffector,"WA104070070",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_IMGEffector,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_IMGEffector);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_LucidChart,"WA103633427",
WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_LucidChart,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_LucidChart);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_DocuSign,"WA104218065",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_DocuSign,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_DocuSign);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_GeoGebraTube,"WA104199813",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_GeoGebraTube,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_GeoGebraTube);
this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_WordCalc,"WA103699714",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_WordCalc,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_WordCalc);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_QR4Office,"WA104051163",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_QR4Office,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_QR4Office);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_SymbolsCharacters,"WA104379279",
WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_SymbolsCharacters,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_SymbolsCharacters);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_WordToHTML,"WA104320163",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_WordToHTML,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_WordToHTML);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_MapIt,"WA104374368",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_MapIt,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_MapIt);
this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_AbbreviationList,"WA104043061",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_AbbreviationList,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_AbbreviationList);this.UW(WordEditorIntl.WordEditorStrings.L_TellMeAppTitle_HandyCalculator,"WA104379673",WordEditorIntl.WordEditorStrings.L_TellMeAppIconUrl_HandyCalculator,WordEditorIntl.WordEditorStrings.L_TellMeAppDescription_HandyCalculator)}static get instance(){return eg._instance}}
eg._instance=new eg;Object(f.a)(eg,"AppData",null,[]);const Xg=(I,ra,ab,Fb=null)=>{const ac=gb.a.Wd(I.name);var Xc="TellMe_OfficeAddin_Control";ab.uJd()?Xc="TellMe_OfficeAddin_SingleFlyoutLayout":ab.FUh()&&(Xc="TellMe_OfficeAddin_StandaloneFlyoutLayout");ab=I.installed?String.format("{0}|{1}|{2}|{3}|{4}|{5}|{6}",I.assetId,I.appVersion,I.storeId,I.assetStoreId,I.targetType,gb.a.Wd(I.name),Xc):String.format("{0}|{1}||{2}",2,I.assetId,Xc);Xc=gb.a.Wd(I.description);return vc.b(ab,I.installed?Ya.a.wGd.toString():
Ya.a.rLc.toString(),ac,I.icon,ra?"cui-img-16by16":"cui-img-32by32",null,Fb?Fb.sessionId+"|"+Fb.Nca+"|"+I.name:"",ac,ra?"Menu16":"Menu32",null,Ya.a.GNi.toString(),Xc,null,null)},hh=(I,ra,ab,Fb,ac)=>vc.h(I,null,null,null,!1,!0,null,null,"Image16by16",ra,ab,Fb,null,Fb,null,!1,!1,!0,ac);class qg{constructor(I){this.wb=I}get GMa(){return Zc.a.AppsForOffice_Recommandation}P_(I,ra=null){if(this.wb.uJd()){var ab=[];I=I.value.split("|");for(let Fb of I)if(!xe.b(Fb)){let ac=Xg(eg.instance.WSa[Fb],!1,this.wb,
ra);ab.push(ac)}ra=CommonUIStrings.l_TellMeAppsForOfficeMenuSectionTitle;ab=vc.e("TellMeDropdownControlsForApps_SingleFlyoutLayout",ab);ra=vc.j("TellMeDropdownMenuSectionForApps_SingleFlyoutLayout",ab,"Menu32",ra);I=String.format(CommonUIStrings.l_TellMeAppsForOfficeFlyoutAnchorTitle,I.length-1);return hh("TellMeFlyoutAnchorForApps_SingleFlyoutLayout",Q.AFrameworkApplication.qp,$c.getImageClass("AppForOfficeLogo_16x16x32"),I,[ra])}I=eg.instance.WSa[I.value];return this.wb.FUh()?(ra=[Xg(I,!1,this.wb,
ra)],ra=vc.e("TellMeControlsForApps_StandardFlyoutLayout",ra),ra=vc.j("TellMeMenuSectionForApps_StandardFlyoutLayout",ra,"Menu32"),ab=String.format(CommonUIStrings.l_TellMeAppsForOfficeInsertAppHint,gb.a.Wd(I.name)),hh("TellMeFlyoutAnchorForApps_StandardFlyoutLayout"+I.assetId,I.icon,"cui-img-16by16",ab,[ra])):Xg(I,!0,this.wb,ra)}}Object(f.a)(qg,"AppsForOfficeRecommendationMenuItemFactory",null,[1037]);var vk=b(1302);class nk{constructor(){this.Hgc=0;this.I9f=!1}SQc(){this.I9f||(this.K8b(),this.I9f=
!0);if(!this.Hgc||4===this.Hgc){const I=new gc.a(2,1,0,Object(x.a)(this,this.U3m,"retrieveData"));Q.AFrameworkApplication.Cb.ub(I);this.Hgc=1}}K8b(){const I={};I.callback=Object(x.a)(this,this.Dkm,"onAppForOfficeActivated");Q.AFrameworkApplication.pa.hb(Ya.a.K8b,2,I)}U3m(){const I={};I.callback=Object(x.a)(this,this.Fmm,"onDataReady");Q.AFrameworkApplication.pa.hb(Ya.a.Wfb,2,I)}Dkm(I,ra){eg.instance.UCk(ra[0],ra[1],ra[2],ra[3],ra[4])}Fmm(I){I?(I.errorCode||eg.instance.CYj(I.value),this.Hgc=I.errorCode&&
-1!==I.errorCode?-2147208619===I.errorCode?4:3:2):this.Hgc=3}static get instance(){return nk._instance}}nk._instance=new nk;Object(f.a)(nk,"AppEntitlementQuery",null,[]);class vh{constructor(I){this.rsc=this.QBg=null;this.wb=I}initialize(){nk.instance.SQc();this.wb.uJd()&&(this.QBg=[]);this.rsc=null}EQn(I,ra){I in eg.instance.WSa&&(eg.instance.WSa[I].installed?ra.Xw(new vk.a(I,Zc.a.AppsForOffice_Installed)):(this.rsc||(this.rsc=I),this.wb.uJd()&&this.QBg.push(I)))}CGj(I,ra){this.rsc&&!xe.b(ra)&&(I.Xw(new vk.a(this.rsc,
Zc.a.AppsForOffice_Recommandation)),I.Xw(new vk.a(ra,Zc.a.AppsForOffice_Query)))}}Object(f.a)(vh,"AppsForOfficeResultsProvider",null,[1913]);class wh{constructor(){this.yvg=this.zvg=null}get Lem(){return this.yvg}P_(I){this.zvg=I;return this.rUe(I)}gim(){this.yvg=this.zvg}qAd(I){return 8===I.type?String.format(CommonUIStrings.l_FindInDocumentText,I.mA):I.mA}X5e(I){return I.mA}}Object(f.a)(wh,"ParameterizedCommand",null,[]);class xm extends wh{constructor(I){super();this.uKc=I}get commandId(){return this.uKc?
"DefinitionsParameterized":"DefinitionButton"}get CCf(){return"Definition"}rUe(I){const ra=gb.a.Wd(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,I.mA));return vc.a(eb.a.cVe(I.value),Ya.a.IWe.toString(),ra,eb.a.Lgf,null,gb.a.Wd(eb.a.mub(I.mA)),ra,null,null)}qAd(I){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,I.mA)}X5e(I){return eb.a.mub(I.mA)}}Object(f.a)(xm,"DefinitionsParameterizedCommand",wh,[]);class tl extends wh{constructor(I){super();
this.uKc=I}get commandId(){return this.uKc?Q.AFrameworkApplication.na.Ya.XKl?"FindWithMatchesParameterized":"FindParameterized":"EditingFind"}get CCf(){return"Find"}rUe(I){const ra=gb.a.Wd(String.format(WordEditorIntl.WordEditorStrings.L_ParamFindInDocTitle,I.mA));return vc.a(eb.a.cVe(I.value),Ya.a.findInDocument.toString(),ra,"Find_16x16x32",null,gb.a.Wd(I.mA),ra,null,null)}qAd(I){return String.format(CommonUIStrings.l_TextWithQuotation,I.mA)}}Object(f.a)(tl,"FindParameterizedCommand",wh,[]);class So{constructor(I){this.wb=
I}get GMa(){return Zc.a.AppsForOffice_Installed}P_(I,ra=null){return Xg(eg.instance.WSa[I.value],!0,this.wb,ra)}}Object(f.a)(So,"InstalledAppsForOfficeMenuItemFactory",null,[1037]);class tn extends wh{constructor(I){super();this.uKc=I}get commandId(){return this.uKc?"SynonymsParameterized":"SynonymButton"}get CCf(){return"Synonym"}rUe(I){const ra=gb.a.Wd(String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_SynonymsParam,I.mA));return vc.a(eb.a.cVe(I.value),Ya.a.IWe.toString(),ra,eb.a.Lgf,
null,gb.a.Wd(eb.a.mub(I.mA)),ra,null,null)}qAd(I){return String.format(WordEditorIntl.WordEditorStrings.L_TellMeButtonLabel_DefinitionsParam,I.mA)}X5e(I){return eb.a.mub(I.mA)}}Object(f.a)(tn,"SynonymsParameterizedCommand",wh,[]);var Qm=b(1805),Vp=b(1727),dr=b(1817),er=b(1800),Pq=b(1801),es=b(1395);class dq extends Qm.a{constructor(){super(...arguments);this.xQ=null;this.iSa=Vp.FindManager.createInstance(this,dr.a.instance,es.a.instance,!0,!0)}static get instance(){return dq._instance}vYb(){this.xQ(this.iSa.ri.Tea);
this.iSa.wTa(!0)}Dzd(I){const ra=new Promise((ab,Fb)=>{this.xQ=ab;setTimeout(()=>{Fb("Find manager execution timed out");this.iSa.wTa(!0)},500)});I=er.a.createQuery(I,Pq.a.none);this.iSa.find(I);return ra}}dq._instance=new dq;Object(f.a)(dq,"TellMeFindStatusSpy",Qm.a,[]);class cp extends hc{constructor(I){super({});this.fbe=null;this.lKb="Word";this.Cfj=I;Q.AFrameworkApplication.K.$("TellMeFindInDocumentIsEnabled")&&(this.Cig=!0,this.Aig=this.Gwd?"FindWithMatchesParameterized":"FindParameterized");
this.$9f=Q.AFrameworkApplication.K.$("SearchOfficeAddinIsEnabled")&&!Q.AFrameworkApplication.K.$("AppsForOfficeThirdPartyIsDisabled");I=new xm(this.uAb);const ra=new tn(this.uAb);this.parameterData[I.commandId]=I;this.parameterData[ra.commandId]=ra;Q.AFrameworkApplication.K.$("WordEditorTellMeParameterizedFindIsEnabled")&&(I=new tl(this.uAb),this.parameterData[I.commandId]=I);Q.AFrameworkApplication.K.$("TellMeTryQueriesIsEnabled")&&(I=[new Hc(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery01,"",
!1),new Hc(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery02,"",!1),new Hc(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery03,"",!1),new Hc(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery04,"",!1),new Hc(WordEditorIntl.WordEditorStrings.L_TellMeTryQuery05,"",!1)],this.w7a=this.Gtk(I))}Dzd(I){return dq.instance.Dzd(I)}get s_a(){return In.AppFrame.Wka}get ryb(){return In.AppFrame.zJa}lyd(){this.$Sa&&!this.fbe&&(this.fbe=new vh(this));return this.fbe}Eoi(I){this.$Sa&&(I.ha(new So(this)),I.ha(new qg(this)),
I.ha(new Dd))}get aOf(){return"Microsoft.Office.Web.SessionSettings.IWacWordSharedHeaderSearchBoxSettings"}ohb(I){var ra=Q.AFrameworkApplication.K;I=I.vE;I.WordCountFlyout=!this.Cfj();I.SelectAllButton=!ra.$("TellMeSelectAllResultIsEnabled");const ab=ra.$("TellMeDesktopUpSellIsEnabled");let Fb=Q.AFrameworkApplication.GTl;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TryOfficeUpsell",!Fb));Fb=!1;I.TextBoxUpSellButton=!ab||Fb;I.TableOfContentsUpSellButton=!ab||Fb;I.SmartArtUpSellButton=
!ab||Fb;I.WordArtUpSellButton=!ab||Fb;I.MultiColumnLayoutUpSellButton=!ab||Fb;I.InsertEquationUpSellButton=!ab||Fb;I.TrackChangesUpSellButton=!ab||Fb;I.ShapesUpSellButton=!ab||Fb;I.LabelsUpSellButton=!ab||Fb;I.InsertCitationUpSellButton=!ab||Fb;I.TextBoxUpSellButtonEnterprise=!ab||!Fb;I.TableOfContentsUpSellButtonEnterprise=!ab||!Fb;I.SmartArtUpSellButtonEnterprise=!ab||!Fb;I.WordArtUpSellButtonEnterprise=!ab||!Fb;I.MultiColumnLayoutUpSellButtonEnterprise=!ab||!Fb;I.InsertEquationUpSellButtonEnterprise=
!ab||!Fb;I.TrackChangesUpSellButtonEnterprise=!ab||!Fb;I.ShapesUpSellButtonEnterprise=!ab||!Fb;I.LabelsUpSellButtonEnterprise=!ab||!Fb;I.InsertCitationUpSellButtonEnterprise=!ab||!Fb;ra=!ra.$("WordEditorTellMeDefinitionsAndSynonymsIsEnabled")||!Q.AFrameworkApplication.EX;I.SynonymButton=ra;I.DefinitionButton=ra}uJd(){return Q.AFrameworkApplication.K.vb("OfficeAddInSearchResultLayoutVariant",cp.f9h)===cp.tjm}FUh(){return Q.AFrameworkApplication.K.vb("OfficeAddInSearchResultLayoutVariant",cp.f9h)===
cp.ujm}get NNi(){return Q.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermModelName","")}get MNi(){return Q.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeMultiLanguageModelName","")}get VVf(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeServiceAADAuthIsEnabled",!1)}get LNi(){return Q.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMeHelpClassifierModelName",
"")}get oac(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowImageSearchResults",!1)}get skf(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeMLCModelIsEnabled",!1)}get $8e(){return Q.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMeMenuUpdatePolicy",0)}get eIi(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowMoreFileResults",!1)}get vKd(){return Q.AFrameworkApplication.K.$("TellMeRankerLoggingIsEnabled")&&
Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableTellMeRankerLogging",!1)}get nJd(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerEnabled",!1)}get eKd(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierEnabled",!1)}get fKd(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.IsSerpletClassifierSwapLogicEnabled",!1)}get FCh(){return Q.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerTimeOut",
1E3)}get ECh(){return 1E-6*Q.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerSuppressionScore",1)}get fUh(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionEnabled",!1)}get eUh(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsModelRankerSuppressionDebugEnabled",!1)}get DCh(){return Q.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.TellMe.GetServiceRankerModelName",
"")}get xXh(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeZeroTermNotesSuggestionIsEnabled",!1)}get czh(){return Q.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.NumberOfNotesSuggestionsToShow",2)}get wXh(){return Q.AFrameworkApplication.K.$("TellMeServiceForSearchIsEnabled")}get X5d(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeTrimAndShowOptimalResults",!1)}get $Xa(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeNoHeadingUIV2",
!1)}get Q1d(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMeUseFeatureIcons",!1)}get eMi(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SubstrateResultsForContextMenuIsEnabled",!1)}get $Jd(){return Q.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TellMe.SelectionBasedZeroTermSuggestionsEnabled",!1)}get EGb(){return Q.AFrameworkApplication.K.$("ShowAnswerSearchResults")}get FGb(){return Q.AFrameworkApplication.K.$("ShowDefinitionSearchResults")}get GGb(){return Q.AFrameworkApplication.K.$("ShowEntitySearchResults")}get IGb(){return Q.AFrameworkApplication.K.$("ShowWolframSearchResults")}get z6e(){return Q.AFrameworkApplication.K.$("ModernFontPickerIsEnabled")?
{["FontName"]:"FontPicker"}:{["FontPicker"]:"FontName"}}}cp.f9h=1;cp.ujm=2;cp.tjm=3;Object(f.a)(cp,"WordEditorTellMeApplicationData",hc,[]);var Co=b(1374),ie;(function(I){I[I.none=0]="none";I[I.waitAll=1]="waitAll";I[I.synchronizeFast=2]="synchronizeFast";I[I.synchronizeSlow=3]="synchronizeSlow"})(ie||(ie={}));Object(f.b)("ProviderSynchronizationType",ie);var mo;(function(I){I[I.immediate=0]="immediate";I[I.waitAll=1]="waitAll";I[I.synchronizeAndWaitAll=2]="synchronizeAndWaitAll";I[I.synchronizeAndWaitForRanker=
3]="synchronizeAndWaitForRanker"})(mo||(mo={}));Object(f.b)("MenuUpdatePolicy",mo);var fr=b(1308),eq=b(1309),wq=b(1337),Tl=b(95),xq=b(235);class Ul extends Qm.a{constructor(I){super();this.dAj=I}vYb(){this.dAj.update()}}Object(f.a)(Ul,"TellMeFindStatusManager",Qm.a,[]);class no{constructor(I){this.o7a=this.Oag=null;this.lh=0;this.M8c="TellMeWAC.";const ra=I.Y1e;this.wb=I;this.c6c=ra;this.Qqe=Object.assign(new Co.a,{landingTab:"Indoc",data:null});I=new Ul(this);this.iSa=Vp.FindManager.createInstance(I,
dr.a.instance,es.a.instance,!0,!0)}sO(){return"WordFindInDocument"}u0(){return this.wb.$8e?this.wb.$8e===mo.waitAll?ie.waitAll:ie.synchronizeSlow:ie.none}qK(I,ra){this.SUl(I)?(this.o7a=I,this.Oag=ra,I=er.a.createQuery(I.Ef,Pq.a.none),this.lh=window.performance.now(),this.iSa.find(I)):ra.resultsUpdated(new fr.a(I))}update(){this.oan(Math.round(window.performance.now()-this.lh));var I=String.format(CommonUIStrings.l_TextWithQuotation,this.o7a.Ef);var ra=Q.AFrameworkApplication.na&&Q.AFrameworkApplication.na.Ya.xhb?
eb.a.hUa(this.o7a.Ef,15,this.Qqe):gb.a.Wd(this.o7a.Ef);const ab=[];ab.push(appChrome.actions.setControlLabel(this.c6c,I));ab.push(appChrome.actions.setCompoundButtonCommandValueId(this.c6c,ra));ab.push(appChrome.actions.updateCompoundButtonDescription(this.c6c,this.abf()));appChrome.api.dispatch(ab);I=new vk.a(this.c6c,Zc.a.FindInDocument,this.o7a.Ef,this.iSa.ri.Tea.toString());ra=new eq.a(wq.a.FindInDocument);ra.displayName=WordEditorIntl.WordEditorStrings.L_FindInDocument;ra.Xw(I);const Fb=new fr.a(this.o7a);
Fb.kw(ra);window.requestAnimationFrame(()=>{this.Oag.resultsUpdated(Fb)});this.iSa.wTa(!0);this.qan(Math.round(window.performance.now()-this.lh))}abf(){const I=this.iSa.ri.Tea.toString();return"1"===I?String.format(CommonUIStrings.l_SearchResultText,I):String.format(CommonUIStrings.l_SearchResultsText,I)}SUl(I){return!!I&&!!I.Ef&&""!==I.Ef.trim()}oan(I){const ra={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"ApiCall",["Service"]:"FindApi",["UiElement"]:"FindWithMatchesParameterized",
["QueryLength"]:this.o7a.Ef.length};this.sendActivityEvent(ra,I)}qan(I){const ra={["Time"]:(new Date).getTime(),["Event"]:"Latency",["LatencyType"]:"Provider",["UiElement"]:"FindWithMatchesParameterized",["QueryLength"]:this.o7a.Ef.length};this.sendActivityEvent(ra,I)}sendActivityEvent(I,ra){I=Tl.a.aR(I);If.a.QBa(Object.assign(new xq.a,{name:"Latency",dataFields:I,durationMs:ra}),this.M8c)}}Object(f.a)(no,"WordFindInDocumentWithMatchesProvider",null,[1042]);class Do{constructor(I,ra){this.Eb=I;this.$Gd=
ra}gXa(I,ra,ab){return this.$Gd.gXa(0,I,ra,ab)}insertHtmlText(I){return I?32===this.jgf(I):!1}jgf(I){return this.executeCommand(Ng.a.cHa,I)}executeCommand(I,ra){const ab=new na.DictionaryPropertySet;ab.setValue(bb.a.jS,ra);ab.setValue(bb.a.NBa,!1);ra=this.Eb.processAction(I,1);32===ra&&(ra=this.Eb.hb(I,2,ab));return ra}}Object(f.a)(Do,"WordInsertContentHandler",null,[1883]);class dp extends vq{constructor(){super()}get name(){return"WordEditor.TellMe"}init(){Q.AFrameworkApplication.K.Io(Object(x.a)(this,
this.Mv,"onFullAppSettingsReady"))}Mv(){if(Q.AFrameworkApplication.uXf){var I=pf.App.oa.Ya.Y$e(Ya.a.tellMe);I.OIc?this.aii():I.MQ(Object(x.a)(this,this.p8m,"scriptResource_LoadFinished"));var ra=new cp(()=>!1);Hp.TellMeActor.instance.initialize(ra,null,null,null,null,null,Object(x.a)(pf.App.oa,pf.App.oa.C3e,"forceUpdateRibbonControls"),Q.AFrameworkApplication.K,this.W.za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.W.za("Common.IActionContextProvider"),this.W.za("Common.ISystemInitiatedFeedback"));
Hp.TellMeActor.instance.HQm(I);Hp.TellMeActor.instance.DSm(new Do(Q.AFrameworkApplication.pa,this.W.ra("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor")));ra.Hlh&&ra.Gwd&&Hp.TellMeActor.instance.ZH(new no(ra),S.a.tellMe)}}aii(){pf.App.oa.updateCommandUI()}p8m(){this.aii()}}Object(f.a)(dp,"WordEditorTellMePackage",vq,[]);class Qq{constructor(){this.W=null}get name(){return"WordEditor.TestFeature"}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{this.El()})}dispose(){}El(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(219)){Q.AFrameworkApplication.pa.Aa(of.a.wordTestFeature,
Qf.a.view,Object(x.a)(this,this.iCn,"testFeature"),96);var I=Eg.FocusManager.instance().fd(In.AppFrame.iC);ei.AFrame.mh(I,wc.KeyInputManager.mb(cf.a.Z1a,5|wc.KeyInputManager.Bg),of.a.wordTestFeature)}}iCn(I,ra,ab){2===ab&&(I=new df.StandardDialog,I.yc=0,I.Dea(WordEditorIntl.WordEditorStrings.L_WordTestFeature,WordEditorIntl.WordEditorStrings.L_WordTestFeatureDialogText,null));return 32}yb(I){this.W=I}static main(){aa.a.instance.Lb(new Qq)}}Object(f.a)(Qq,"WordEditorTestFeaturePackage",null,[1,2]);
var fo=b(113);class Eo{constructor(I,ra){this.mwi=I;this.Eb=ra;this.jSc()}jSc(){this.Eb.ka(of.a.x_d,vf.a.frame,Object(x.a)(this,this.x_d,"sendTrackChangeSettingUpdateNotification"));this.mwi.j3(Object(x.a)(this,this.A9,"onUpdateNotificationReceived"))}x_d(I,ra,ab,Fb,ac){if(1===ab)return 32;this.mwi.MM(9,ac,!1);return 32}A9(I,ra){if(9===ra.type){var ab;(I=ra.Q5)?("string"===typeof I?ab=I:"data"===I.type&&(ab=fo.a.x$g(I.wEm,I.newState,I.Nkn)),ab&&Eo.Rtc(ab)):ha.ULS.sendTraceTag(556103040,376,15,"TrackChangeSettingUpdateNotificationEventArgs is null")}}dispose(){}static Rtc(I){I=
pf.App.oa.notificationBar.jxa(I,!1);I.image=5;I.jja="CoAuth_AuthorStatus_16x16x32";pf.App.oa.notificationBar.Jz(I)}}Object(f.a)(Eo,"TrackChangeNotificationActor",null,[]);class Un{constructor(){this.$h=this.nEe=this.W=null}get name(){return"WordEditor.TrackChangeNotificationActor"}yb(I){this.W=I}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{this.El()})}El(){pf.App.ZCd().continueWith(Object(x.a)(this,this.SOc,"onRtcProxyReady"))}SOc(){if(this.$h=pf.App.ZCd().result)this.W.ha("WordEditor.TrackChange.TrackChangeNotificationActor",
()=>new Eo(this.$h,Q.AFrameworkApplication.pa)).singleInstance(),this.nEe=this.W.resolve("WordEditor.TrackChange.TrackChangeNotificationActor")}dispose(){this.nEe&&this.nEe.dispose()}}Object(f.a)(Un,"WordEditorTrackChangeNotificationActorPackageManager",null,[1,2]);var mp=b(72),Os=b(1279),ft=b(1792);class Hl{}Hl.t_f="UnsavedChanges";Hl.u_f="UnsavedChangesThemed";Hl.C7m="SavedChanges";Hl.PSi="UnsavedChangesOpenPipe";Hl.hLn="UnsavedChangesOpenPipeCssClassNameThemed";Hl.OSi="UnsavedChangesClosePipe";
Hl.eLn="UnsavedChangesClosePipeThemed";Hl.fLn="UnsavedChanges";Hl.gLn="UnsavedChangesThemed";Hl.v_f="UnsavedChangesIndicatorPositionRef";Object(f.a)(Hl,"UnsavedChangesHighlightUtils",null,[]);class To extends Os.a{constructor(I,ra){super();this.paa=I;this.uv=ra;this.r6=[this.uv?new ft.a(Hl.u_f,Hl.gLn):new ft.a(Hl.t_f,Hl.fLn)]}get gja(){return!0}get Ayb(){return 4}get Jbb(){return this.r6}CLa(I,ra){if(this.paa){var ab=this.paa.ysf;if(ab&&ab.count&&ab.contains(I.id))for(I=ra.UZa("span"),ra=0;ra<I.length;ra++)ab=
I[ra],ra||ab.classList.add(this.uv?Hl.hLn:Hl.PSi),ra===I.length-1&&ab.classList.add(this.uv?Hl.eLn:Hl.OSi),ab.classList.add(this.uv?Hl.u_f:Hl.t_f)}}Xab(){}}Object(f.a)(To,"UnsavedChangesHighlightActor",Os.a,[]);var np=b(912);class Tk{constructor(I){this.rfe=null;this.paa=I;this.Mne=!1}get key(){return"UnsavedChangesHighlight"}get $u(){return"UnsavedChanges"}reset(I){if(this.paa){I=I.node;if(mj.ParagraphReader.tb(I)){const ra=this.paa.ysf;if(ra&&ra.contains(I.id)){this.Mne=!0;this.rfe=I.id;return}}this.Mne=
!1;this.rfe=yd.a.nil}}ICa(){let I=null;return this.Mne?(I=Object.assign(new np.a,{mE:this.key,contentObject:this.rfe,description:null}),{returnValue:!0,bF:I}):{returnValue:!1,bF:I}}}Object(f.a)(Tk,"UnsavedChangesHighlightCpContentDetailsProvider",null,[430,431]);var ep=b(247),ul=b(1280);class xp{constructor(I,ra,ab,Fb,ac,Xc){this.wvg=null;this.c2=I;this.Ve=ra;this.YT=ab;this.nN=Fb;this.cJg=ac;this.uv=Xc;this.Ve.bsb(this.IAa.bind(this))}get ysf(){return this.wvg}gvl(){if(this.c2){if(1===this.c2.LQe){if(0===
this.c2.Rnf&&this.c2.jei()){this.wvg=this.c2.LOd;const I=this.c2.sZc;this.c2.D7m.forEach(this.xuk.bind(this));I.forEach(this.hvl.bind(this));0<I.length&&this.bwk(this.YT);return 0}return this.gNm(this.c2.Rnf)}return 2}return 1}gNm(I){switch(I){case 0:return this.c2.dJh()?5:6;case 3:case 5:case 11:return 4;default:return 6}}WJh(I,ra,ab){if(ra)if(ab){ab=ra.querySelectorAll("span");for(let Fb=0;Fb<ab.length;Fb++){const ac=ab[Fb];Fb||ac.classList.add(Hl.PSi);Fb===ab.length-1&&ac.classList.add(Hl.OSi);
ac.classList.add(this.uv?Hl.u_f:Hl.t_f)}ra.classList.add(Hl.v_f);I&&this.nN.EZc(I)}else ra.classList.add(Hl.C7m)}M0b(I,ra){const ab=this.ujl(I);if(I&&(I=I.Sd(ri.App.oa.Da.Jb.gb)))if(I.Nf&&I.Nf.rh&&0!==I.Nf.rh.count)for(let Fb of I.Nf.rh)this.WJh(ab,Fb,ra);else this.WJh(ab,I.htmlElement,ra)}ujl(I){return this.cJg&&(I=this.cJg.ICd(I))&&I&&(I=I.Sd(ri.App.oa.Da.Jb.gb))?I:null}hvl(I){this.M0b(I,!0);return!0}xuk(I){this.M0b(I,!1);return!0}bwk(I){I&&I.continueWith(()=>{I.result.logActivity("UnsavedChangesHighlightEnableSurvey",
"WordUnsavedChangesHighlightingSurveyGateIsEnabled",0)})}IAa(I,ra){ra===Sys.EventArgs.Empty?ha.ULS.sendTraceTag(572364513,306,50,"HighlightUnsavedChanges Not Run: Empty Event Args"):ra&&ra.errorCode?ul.a.xM.xM()&&(I=this.gvl(),ha.ULS.sendTraceTag(576528923,306,15,"HighlightUnsavedChanges Run Result: {0}",I),pa.Health.instance.recordKpiUsage("UnsavedChangesHighlight",0,"wwrelfc",null),0!==I&&4!==I&&this.HFn(I)):ha.ULS.sendTraceTag(572364514,306,50,"HighlightUnsavedChanges Not Run: No {0}",ra?"Error Code":
"Kickout Event Args")}HFn(I){let ra;const ab=new ep.a;ab.extendedProperties=new Map;ab.extendedProperties.set("HighlightUnsavedChangesResult",I.toString());ab.extendedProperties.set("UnsavedChangesCollectionResult","-1");switch(I){case 1:case 2:case 6:ra="HighlightInternalError";break;case 5:ra="ChangeOutsideCanvas"}6!==I&&5!==I||ab.extendedProperties.set("UnsavedChangesCollectionResult",this.c2.Rnf.toString());ra&&(pa.Health.instance.recordQosError(ra,["UnsavedContentNotHighlighted"],!0,!0,!1,!1,
ab),pa.Health.instance.recordKpiFailure("UnsavedChangesHighlight",ra,!0,!0,ab))}dispose(){this.Ve.$Sc(this.IAa.bind(this))}}Object(f.a)(xp,"UnsavedChangesHighlighter",null,[14]);var mm=b(638),Ia=b(487),Xa=b(1277);class qb extends Xa.a{constructor(I,ra){super();this.paa=I;this.uv=ra}vGb(I){if(!this.paa)return!1;const ra=this.paa.ysf;return ra?ra.contains(I.Ia.id)||I.htmlElement.querySelector(".UnsavedChanges")?!0:!1:!1}F_j(I,ra){ra=I.oza?I.oza[ra]?I.oza[ra].style?I.oza[ra].style.marginLeft:null:null:
null;var ab=I.leftMargin;I=1440<=ab?-(ab/1440*96):I.Tsb(0,96,this.zoom);ab=0;ra&&(ra=ra.match(/^(\d+)px/))&&ra[1]&&(ab=Number(ra[1]));return I-ab}i0j(I,ra,ab){return Sys.UI.DomElement.getBounds(I).y-ab.H8[ra].y}v_j(I){return Sys.UI.DomElement.getBounds(I).height}U9g(I,ra,ab,Fb){let ac;ac=this.F_j(ab,ra);ra=this.i0j(I,ra,ab);I=this.v_j(I);Fb=mm.a.createElement(Fb,Ia.a.div);Fb.className=this.uv?"UnsavedChangesIndicatorThemed":"UnsavedChangesIndicator";Fb.style.left=ac+"px";Fb.style.top=ra+"px";Fb.style.height=
I+"px";return Fb}l9g(I,ra,ab,Fb){const ac=[];let Xc=I.querySelectorAll("."+Hl.v_f);if(0===Xc.length&&Object(Xj.a)(I,Hl.v_f))ab=this.U9g(I,ra,ab,Fb),ab.OTa=ra,Array.add(ac,ab);else for(I=0;I<Xc.length;I++){let Md=this.U9g(Xc[I],ra,ab,Fb);Md.OTa=ra;Array.add(ac,Md)}return ac}aub(I){let ra=[];var ab=I.P4;const Fb=ab.Fe.ownerDocument;if(ab.Fi){let ac=0;for(let Xc of ab.Nf.rh)(ab=this.l9g(Xc,ac,I,Fb))&&(ra=ra.concat(ab)),ac+=1}else ra=this.l9g(ab.htmlElement,0,I,Fb);return ra}}Object(f.a)(qb,"UnsavedChangesIndicatorActor",
Xa.a,[]);class $b{constructor(){this.E2=this.tv=this.BEa=this.nN=this.w8c=this.paa=null}get name(){return"WordEditor.UnsavedChangesHighlight"}yb(){}init(){this.nN=ia.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance;this.paa=new xp(ia.a.instance.resolve("Wonca.UnsavedChangesCollection.IUnsavedChangesCollector"),Fd.SessionStatusManager.instance,ke.a.Vp(ia.a.instance.za("Common.ISystemInitiatedFeedbackWithTimeLapse")),this.nN,ia.a.instance.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),
!!pf.App.instance&&pf.App.instance.Cja);this.BEa=ia.a.instance.za("Box4.Accessibility.IAccessibilityContextManager");this.E2=ia.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance;this.w8c=new qb(this.paa,!!pf.App.instance&&pf.App.instance.Cja);this.nN.hgb(this.w8c);this.BEa&&this.BEa.execute(I=>{I.j1(new Tk(this.paa))});this.tv=new To(this.paa,!!pf.App.instance&&pf.App.instance.Cja);this.E2.ggb(this.tv)}dispose(){this.nN&&this.w8c&&this.nN.P6d(this.w8c);this.E2&&this.tv&&this.E2.o_f(this.tv);
mp.a.pz(this.paa)}static main(){aa.a.instance.Lb(new $b)}}Object(f.a)($b,"WordEditorUnsavedChangesHighlightPackage",null,[1,2,14]);var tc=b(325);class Vc{constructor(I,ra,ab,Fb){I=new wordVersionHistory.AppBootSettings;I.logger=new tc.a;I.forcePdfDevEnv=ab.dA;I.userSessionId=Q.AFrameworkApplication.userSessionId;I.wacCluster=Fb;I.publicScriptPath=Q.AFrameworkApplication.LV;I.userType=Q.AFrameworkApplication.userType;this.a8d=new wordVersionHistory.AppVersionControllerImpl(I,ra)}onVersionSelected(I,
ra,ab,Fb){this.a8d.onVersionSelected(I,ra,ab,Fb)}onDownloadTokenReady(I,ra){this.a8d.onDownloadTokenReady(I,ra)}getRenderFailureEvent(){return this.a8d.getRenderFailureEvent()}getLoadFinishEvent(){return this.a8d.getLoadFinishEvent()}}Object(f.a)(Vc,"AppVersionControllerImplWrapper",null,[1669]);class gd{create(I,ra,ab,Fb){return new Vc(I,ra,ab,Fb)}}Object(f.a)(gd,"AppVersionControllerImplWrapperFactory",null,[1648]);class Ad{getVersionHistoryControllerInstance(I){return versionHistory?versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(I):
null}}Object(f.a)(Ad,"VersionHistoryControllerFactory",null,[1647]);class je{static addAppPLTEventToLog(I){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(I)}catch(ra){}}static setIsPageLoadForFirstTime(I){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(I)}catch(ra){}}}Object(f.a)(je,"VersionHistoryLogConnector",null,[]);var mf=b(555),Wg=b(1265),si=b(1437);class mg{constructor(){this.revisionId=null;this.pMf=0}}Object(f.a)(mg,"ForceSaveData",
null,[]);class Ai extends tk.a{constructor(){super();this.ExclusiveLockId=this.VersionToken=this.FileId=null}ol(){return 106}static construct(I,ra,ab){const Fb=new Ai;Fb.FileId=I;Fb.VersionToken=ra;Fb.ExclusiveLockId=Ti.a(ab);return Fb}}Object(f.a)(Ai,"RestoreVersionRequest",tk.a,[]);class ti{static Nya(){return(new Date).getTime()}static Vbk(I){const ra=new ep.a;ra.durationMs=I;ra.extendedProperties=new Map;return ra}}Object(f.a)(ti,"VersionHistoryUtils",null,[]);var Mh=b(298);class ve{constructor(I,
ra,ab,Fb,ac,Xc,Md,bf,Hf,Zg,gi,Ei,Il,Kk,nm,Rf){this.Eb=I;this.wf=ra;this.lR=ab;this.clickInputManager=Fb;this.fNk=ac;this.Yq=Xc;this.k0h=Md;this.X_c=bf;this.Dnd=Hf;this.RUn=Zg;this.K=gi;this.kNj=Ei;this.VLe=Il;this.Hjb=Kk;this.Rd=nm;this.T1f=Rf;this.Adc=this.MBc=this.rWc=this.o2d=this.ATf=this.XZf=this.perfTelemetryInfos=this.baseVersion=this.currentVersion=this.controller=null;this.UZd=0;this.YGa=this.$7d=null;this.V1f=Wg.b.None;this.l3b=!1;this.X1f="";this.dFk={0:"GeneralSaveError",1:"InvalidFileName",
2:"EmptyFileName",3:"InvalidPermission",4:"OverwriteTarget",5:"TargetFileLocked",6:"InvalidFileNameDisallowPercentOctothorpe"};this.UHb={};this.fu={};this.C2d=!1;this.a9=!!Q.AFrameworkApplication.na&&Q.AFrameworkApplication.na.Ya.a9}Tod(){null===this.MBc&&(this.MBc=ti.Nya())}e9a(I){const ra=new ep.a;null===I?ha.ULS.sendTraceTag(541693581,3005,10,"constructKpiAdditionalValuesWithDurationFromStartTime called with null startTime"):(ra.durationMs=ti.Nya()-I,ra.extendedProperties=new Map);return ra}WMh(){null===
this.Adc&&(this.Adc=ti.Nya());this.Rd.Pm("WordVersionHistorySelectVersion",0,{gjf:!0})}tIf(){const I=[],ra=Object.assign(new ep.a,{extendedProperties:new Map});if(null!=this.o2d&&null!=this.ATf){var ab=this.o2d-this.ATf;Array.add(I,Object.assign(new pl.a,{name:"showPaneDuration",string:ab.toString()}));ra.extendedProperties.set("showPaneDuration",ab.toString())}null!=this.MBc&&null!=this.rWc&&(ab=this.MBc-this.rWc,Array.add(I,Object.assign(new pl.a,{name:"firstActionDuration",string:ab.toString()})),
ra.extendedProperties.set("firstActionDuration",ab.toString()));(ab=this.V1f===Wg.b.None)?this.Rd.DBb("WordVersionHistory",{Uu:ra}):this.Rd.pi("WordVersionHistory",Wg.b[this.V1f],{isIntentional:!1,Uu:ra},{name:ve.Cdc,Lm:"VersionHistoryLaunchFailed",isIntentional:!1});this.Rd.jB(of.a.A8j,{succeeded:ab,customData:I})}eb(){this.Eb.ka(Ya.a.PTf,vf.a.frame,Object(x.a)(this,this.FIi,"showVersionHistoryDialogAction"));this.Eb.ka(Ya.a.xTc,vf.a.frame,Object(x.a)(this,this.N0m,"reportVersionHistorySaveACopySuccessAction"));
this.Eb.ka(Ya.a.NYd,vf.a.frame,Object(x.a)(this,this.M0m,"reportVersionHistorySaveACopyFailureAction"))}FIi(I,ra,ab){if(1===ab)return Fd.SessionStatusManager.instance.gi?8:32;if(2===ab){this.$7d=Bc.a.create().toString();ha.ULS.sendTraceTag(592196993,3005,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.$7d);Q.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IDocsWordVersionHistorySaveACopyOverFlowMenuSettings");Q.AFrameworkApplication.kda("WoVer882;WoVer882cf");
Object(si.a)();this.Rd.Pm("WordVersionHistory",0,{gjf:!0});this.Rd.jB(of.a.Ivm,{succeeded:!0});this.UHb.ShowVersionHistoryDialog=(new Date).getTime().toString();this.fu.VersionHistoryLaunchSessionId=this.$7d;this.perfTelemetryInfos=[];this.controller||(this.X1f=this.K.Ga("WacCluster"),this.controller=this.RUn.getVersionHistoryControllerInstance({ulsLogger:new tc.a,serviceBase:this.K.appSettings.VersionHistoryWebServiceBase,docId:Q.AFrameworkApplication.kl,appSettings:{appName:Wg.a.Word,wdEnableDownloadTokens:this.X_c.YZi,
wdEnableSaveACopy:!0,wdEnableRestore:this.X_c.WZi,userSessionId:Q.AFrameworkApplication.userSessionId,wacCluster:this.X1f,uiLocale:Q.AFrameworkApplication.uiCulture?Q.AFrameworkApplication.uiCulture:"en-us",wdEnableHiddenButtonsUntilVersionLoadComplete:!0,wdEnableShowVersionChanges:!0,disabledChangeGates:Q.AFrameworkApplication.K.Ga("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.X_c.XZi,isRtl:Q.AFrameworkApplication.isRtl,wdEnableAppColorUpdate:this.K.$("AppColorUpdateIsEnabled"),useXhr:Ga.a.dA,
retryCount:0,wdEnableDeleteVersions:!1,wdEnableIterator:!1,viewerRootPositionRelative:!1,disableSaveACopy:!1},perfTelemetryInfos:this.perfTelemetryInfos}));if(!this.controller)return this.Rd.pi("WordVersionHistory","scriptDependencyUnavailable",{isIntentional:!1},{name:ve.Cdc,Lm:"VersionHistoryLaunchFailed",isIntentional:!1}),8;this.controller.setDisableSaveACopy(this.Lmn()||this.Jmn());this.Ysn()}return 32}N0m(I,ra,ab){if(1===ab)return Fd.SessionStatusManager.instance.pK?32:8;2===ab&&(I=this.e9a(this.UZd),
this.Rd.DBb("WordVersionHistorySaveACopy",{Uu:I}),this.tIf());return 32}M0m(I,ra,ab,Fb,ac){var Xc,Md,bf;if(1===ab)return Fd.SessionStatusManager.instance.pK?32:8;2===ab&&(I="Unknown",ra="",ac&&(I=null!==(Xc=ac.FailureReason)&&void 0!==Xc?Xc:I,ac=null!==(Md=ac.ExtraInfo)&&void 0!==Md?Md:"",ra=null!==(bf=this.dFk[ac])&&void 0!==bf?bf:ac),Md=this.e9a(this.UZd),""!==ra&&Md.extendedProperties.set("ExtraInfo",ra),bf=this.Hjb.kbb(I,3,ra),this.Rd.pi("WordVersionHistorySaveACopy",I,{isIntentional:bf.isIntentional,
Uu:Md},bf),ha.ULS.sendTraceTag(592197004,3005,10,"Save failed with {0} {1}",I,ra));return 32}Ysn(){this.ATf=ti.Nya();this.MBc=this.rWc=this.o2d=null;if(document.getElementById("VersionHistoryOverlay"))this.YB();else{this.bSm();this.aSm();this.MRm();this.RRm();this.ZRm();this.QRm();this.X_c.ZZi&&this.PRm();this.YRm();this.$Rm();const I=document.createElement("div");let ra=I.id="VersionHistoryOverlay",ab=null;this.SRm(I);if(this.a9&&(ab=Object(Mh.a)("Header"))){const Fb=document.getElementById("AppHeaderPanel");
ra=Fb&&"none"===Fb.style.display?String.format("{0} {1} {2}",ra,"RegionComposer","NoAppHeader"):String.format("{0} {1}",ra,"RegionComposer")}ab||(ab=document.getElementById("WACInnerFrame"));I.className=ra;ab.appendChild(I);this.XZf=this.controller.createVersionHistoryDialog(I);this.Bea()}document.getElementById("VersionHistoryOverlay").style.display="block";this.controller.getVersions("")}Lmn(){if(Q.AFrameworkApplication.X4)return ha.ULS.sendTraceTag(570770272,3005,15,"Version History is disabling Save a Copy because this is a protected file."),
!0;const I=32==this.Eb.processAction(Ya.a.P9b,1);let ra=32==this.Eb.processAction(Ya.a.R9b,1);return I||ra?!1:(ha.ULS.sendTraceTag(545403476,3005,15,"Version History is disabling Save a Copy because the save commands are disabled."),!0)}Jmn(){return Q.AFrameworkApplication.X4?(ha.ULS.sendTraceTag(545387291,3005,15,"Version History is disabling download version because this is a protected file."),!0):32!=this.Eb.processAction(Ya.a.downloadACopy,1)?(ha.ULS.sendTraceTag(545403477,3005,15,"Version History is disabling download version because the download command is disabled."),
!0):!1}RRm(){this.controller.getFullAppErrorEvent().addListener(I=>{let ra=I?Wg.b[I]:"";this.fu[ve.SBn]=ra;this.V1f=I;ha.ULS.sendTraceTag(592196994,3005,10,"Full App Error Event: {0}, VersionHistoryLaunchSessionId: {1}",ra,this.$7d)})}bSm(){this.controller.getVersionsReadyEvent().addListener(I=>{this.o2d=ti.Nya();this.E1m(I.containerDiv);this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryShowChangesFixEnabled",!1)&&this.T1f.initialize(this.YGa);this.YB()})}G7l(){this.Rd.Pm("WordVersionHistoryShowChanges",
0);let I;if(this.baseVersion)if(this.baseVersion.DownloadUrl)if(0==this.baseVersion.DownloadUrl.length)I="download token is empty string";else return;else I="download token is null";else I="base is null";ha.ULS.sendTraceTag(538027592,3005,10,"{0}, RevisionID: {1}",I,this.currentVersion.RevisionID);this.Rd.pi("WordVersionHistoryShowChanges",I,{isIntentional:!1},{name:ve.Cdc,Lm:"ShowChangesFailed",isIntentional:!1})}aSm(){this.controller.getVersionSelectedEvent().addListener(I=>{if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryShowChangesFixEnabled",
!1))this.T1f.display(I);else if(this.currentVersion=I.currentVersion,this.baseVersion=I.baseVersion,this.YGa){I.noBaseToCompareTo||this.C2d||this.G7l();try{this.f_i();if(this.baseVersion||I.noBaseToCompareTo)this.WMh(),this.YGa.onVersionSelected(I.currentVersion,I.baseVersion,this.UHb,!this.C2d);this.perfTelemetryInfos=[];this.UHb={}}catch(ra){ha.ULS.sendTraceTag(592196997,3005,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",ra)}}})}PRm(){this.controller.getDownloadTokenReadyEvent().addListener(I=>
{try{ha.ULS.sendTraceTag(592196998,3005,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.Cpl(I)}catch(ra){ha.ULS.sendTraceTag(592197002,3005,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",ra)}})}Cpl(I){I&&I.versionSelected?(this.currentVersion=I.versionSelected.currentVersion,this.baseVersion=I.versionSelected.baseVersion,this.WMh(),this.YGa.onVersionSelected(this.currentVersion,this.baseVersion,this.UHb,!this.C2d)):ha.ULS.sendTraceTag(591697922,
3005,10,"handleGetDownloadTokenReadyEvent: downloadTokenReadyObject.versionSelected was null")}MRm(){this.controller.getCloseSelectedEvent().addListener(()=>{this.B8j();this.dYl()})}aBl(I){const ra={};ra.FileDownloadUrl=I;ra.SaveEntryPoint="VersionHistory";return ra}vel(I){let ra="Dialog Failure - ActionResponse "+I.toString();2===I?ra="DialogNotHandled":8===I&&(ra="DialogFailed");return ra}ZRm(){this.controller.getSaveACopySelectedEvent().addListener(I=>{this.UZd=ti.Nya();this.Rd.Pm("WordVersionHistorySaveACopy",
0);this.Tod();ha.ULS.sendTraceTag(592197003,3005,50,"VersionHistoryPaneActor: RegisterForSaveACopySelectedEvent");this.F8h();var ra=this.aBl(I);I=32==this.Eb.processAction(Ya.a.P9b,1);ra=this.Eb.hb(I?Ya.a.P9b:Ya.a.R9b,2,ra);const ab=this.e9a(this.UZd),Fb=32===ra;if(!Fb){const ac=this.vel(ra),Xc=this.Hjb.kbb(ac,2);this.Rd.pi("WordVersionHistorySaveACopy",ac,{isIntentional:Xc.isIntentional,Uu:ab},Xc);ha.ULS.sendTraceTag(578033103,3005,10,I?"SaveACopy":"SaveToSharePoint failed with ActionResponse: "+
ra.toString())}this.Rd.jB(of.a.y7j,{succeeded:Fb})})}QRm(){this.controller.getDownloadVersionSelectedEvent().addListener(I=>{var ra=ti.Nya();this.Rd.Pm("WordVersionHistoryDownloadVersion",0);this.Tod();I=new vi.QueryStringBuilder(I);I.Hd("fn",Q.AFrameworkApplication.fileName);I=this.Eb.hb(Ya.a.downloadACopy,2,{["FileDownloadUrl"]:I.toString()});ra=this.e9a(ra);const ab=32===I;ab?this.Rd.DBb("WordVersionHistoryDownloadVersion",{Uu:ra}):(this.Rd.pi("WordVersionHistoryDownloadVersion",I.toString(),{isIntentional:!1,
Uu:ra},{name:ve.Cdc,Lm:"DownloadVersionFailed"}),ha.ULS.sendTraceTag(592197005,3005,10,"Download version failed with result: "+I.toString()));this.Rd.jB(of.a.x7j,{succeeded:ab})})}wLd(){this.F8h();this.tIf();this.Yq&&this.Yq.refreshDocument(null)}Kql(I,ra){this.l3b=!1;if(2===I.statusCode&&I.Vi&&0<I.Vi.length&&I.Vi[0])if(I=I.Vi[0],ra=this.e9a(ra),this.k0h&&I.ShouldAvoidLockRelease&&this.k0h.Vgb(!1,"VersionHistory"),191===I.StatusCode)I=this.Hjb.kbb("MultipleClientsInCoauthSession",5),this.Rd.pi("WordVersionHistoryRestore",
"multipleClientsInCoauthSession",{isIntentional:!0,Uu:ra},I),this.Rd.jB(of.a.Fwc,{succeeded:!1}),ha.ULS.sendTraceTag(592197006,3005,10,"RestoreVersionRequest failed with MultipleClientsInCoauthSession"),this.controller.setCoauthRestoreError(),ve.eYl();else if(I.StatusCode){ra.extendedProperties.set("status",mf.a[I.StatusCode]);const ab=this.Hjb.kbb("ServerOperationFailed",5);this.Rd.pi("WordVersionHistoryRestore","restoreVersionResponseFailed",{isIntentional:!1,Uu:ra},ab);this.Rd.jB(of.a.Fwc,{succeeded:!1});
ha.ULS.sendTraceTag(592197007,3005,10,"RestoreVersionRequest failed with "+mf.a[I.StatusCode]);this.controller.setRestoreFailedAtServer(Object(x.a)(this,this.wLd,"launchSurveyRefreshDocument"))}else this.Rd.DBb("WordVersionHistoryRestore",{Uu:ra}),this.Rd.jB(of.a.Fwc,{succeeded:!0}),ha.ULS.sendTraceTag(592197008,3005,50,"Restore Version Successful."),this.wLd();else ra=this.Hjb.kbb("ServerOperationFailed",5),this.Rd.pi("WordVersionHistoryRestore","serverOperationFailed",{isIntentional:ra.isIntentional},
ra),ha.ULS.sendTraceTag(592197009,3005,10,"serverOperation failed with "+wi.a[I.statusCode]),this.controller.setRestoreFailedAtServer(Object(x.a)(this,this.wLd,"launchSurveyRefreshDocument"))}hNk(I){ha.ULS.sendTraceTag(592197010,3005,50,"DocumentSavedSuccessfully");var ra=I.revisionId;const ab=yd.a.create();ra=Ai.construct(Q.AFrameworkApplication.rootQuerySignature,ra,ab);const Fb=Object.assign(new xg.a,{Kq:ra,status:1,GF:"RestoreVersion"});ra=this.VLe.zia(0,()=>{this.Kql(Fb,I.pMf)});ra.WH(Fb);ra.DU()}foh(I,
ra){this.l3b=!1;const ab=this.e9a(I.pMf);ab.extendedProperties.set("status",mf.a[ra]);const Fb=this.Hjb.kbb("ForceSaveFailed",5);this.Rd.pi("WordVersionHistoryRestore","forceSaveFailed",{isIntentional:Fb.isIntentional,Uu:ab},Fb);this.Rd.jB(of.a.Fwc,{succeeded:!1});ha.ULS.sendTraceTag(592197011,3005,10,"ForceSaveFailed with status"+mf.a[ra]+" for version "+I);this.controller.setRestoreFailedAtServer(Object(x.a)(this,this.wLd,"launchSurveyRefreshDocument"))}YRm(){this.controller.getRestoreVersionSelectedEvent().addListener(I=>
{if(this.l3b)ha.ULS.sendTraceTag(536998742,3005,50,"restore already in progress");else{this.l3b=!0;this.Tod();var ra=ti.Nya();this.Rd.Pm("WordVersionHistoryRestore",0);var ab=null;I&&(ab=I.split("-")[0]);ab&&""!==ab?(I=Object.assign(new mg,{revisionId:ab,pMf:ra}),ha.ULS.sendTraceTag(592197013,3005,50,"VersionHistoryPaneActor: RegisterForRestoreVersionSelectedEvent: {0}",ab),this.controller.setRestoreInProgress(),this.fNk(19,!1,Object(x.a)(this,this.hNk,"forceSaveSucceeded"),Object(x.a)(this,this.foh,
"forceSaveFailed"),I,null,null)):(ab=this.Hjb.kbb("InvalidRevisionId",5),this.Rd.pi("WordVersionHistoryRestore","invalidRevisionId",{isIntentional:ab.isIntentional},ab),this.Rd.jB(of.a.Fwc,{succeeded:!1}),ha.ULS.shipAssertTag(592197012,3005,!1),this.l3b=!1)}})}cSm(){this.YGa.getRenderFailureEvent().addListener(I=>{const ra=this.Hjb.kbb(I,1),ab=this.e9a(this.Adc);this.Adc=null;this.Rd.pi("WordVersionHistorySelectVersion",I,{isIntentional:ra.isIntentional,Uu:ab},ra);try{this.fu.ViewerErrorCode="ViewerErrorCode"in
this.fu?this.fu.ViewerErrorCode+("; "+I):I,this.controller.setViewerError(!0),ha.ULS.sendTraceTag(592197014,3005,10,"Versions viewer error code: {0}",I)}catch(Fb){ha.ULS.sendTraceTag(592197015,3005,10,"Failed to set viewer error: {0}",Fb)}})}TRm(){this.YGa.getLoadFinishEvent().addListener(()=>{null==this.rWc&&(this.rWc=ti.Nya());const I=this.e9a(this.Adc);this.Adc=null;this.Rd.DBb("WordVersionHistorySelectVersion",{Uu:I});this.controller.setVersionLoadComplete()})}$Rm(){this.controller.getShowVersionChangesToggledEvent().addListener(I=>
{if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryShowChangesFixEnabled",!1))this.T1f.sEn();else{this.C2d=!I;this.YB();try{this.currentVersion&&this.currentVersion.DownloadUrl&&this.YGa&&(this.f_i(),this.YGa.onVersionSelected(this.currentVersion,this.baseVersion,this.UHb,I),this.perfTelemetryInfos=[],this.UHb={})}catch(ra){ha.ULS.sendTraceTag(592197016,3005,10,"VersionHistoryPaneActor: Exception in ShowVersionChangesToggledEvent callback: {0}",ra)}}})}allowKeytips(I){ik.a("allowKeytips")&&
appChrome.api.allowKeytips(I)}YB(){this.lR.Bv(In.AppFrame.Wka);this.allowKeytips(!1);this.lR.Bv(ei.AFrame.Mp);this.lR.Bv(In.AppFrame.zla);this.wf.NI("VersionHistoryViewer",!1);this.lR.YB("VersionHistoryViewer");this.wf.NI("VersionHistoryHeader",!0);this.lR.YB("VersionHistoryHeader");this.wf.NI("VersionHistoryOverlay",!0);this.lR.YB("VersionHistoryOverlay")}Bv(){this.lR.YB(In.AppFrame.Wka);this.allowKeytips(!0);this.lR.YB(ei.AFrame.Mp);this.lR.YB(In.AppFrame.zla);this.lR.Bv("VersionHistoryOverlay");
this.wf.gP("VersionHistoryOverlay");this.lR.Bv("VersionHistoryHeader");this.wf.gP("VersionHistoryHeader");this.lR.Bv("VersionHistoryViewer");this.wf.gP("VersionHistoryViewer")}B8j(){this.l3b&&ha.ULS.sendTraceTag(536998743,3005,10,"restore did not complete!");this.tIf();document.getElementById("VersionHistoryOverlay").style.display="none";this.fu.browser=Ga.a.wD;Ga.a.o4&&(this.fu.electronBrowserVersion=Ga.a.Dzk);this.Bv();ha.ULS.sendTraceTag(592197017,3005,50,va.c(this.fu))}f_i(){for(let I of this.perfTelemetryInfos)I.TelemetryEventKey&&
I.TelemetryEventData&&(this.UHb[I.TelemetryEventKey]=I.TelemetryEventData)}E1m(I){try{if(this.YGa)je.setIsPageLoadForFirstTime(!1);else{je.setIsPageLoadForFirstTime(!0);const ra=this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsVersionHistoryBadGatewayFixEnabled",!1)?this.X1f:"";this.YGa=this.kNj.create(this.X_c,I,this.Dnd,ra);this.cSm();this.TRm()}}catch(ra){ha.ULS.sendTraceTag(592197018,3005,10,"WordVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",
ra)}}MTe(I){const ra=this.wf.fd(I);ra.parent=ei.AFrame.uo;this.lR.mwa(I);ra.rK=!0;return ra}Bea(){this.MTe("VersionHistoryOverlay").hba((I,ra)=>{try{this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsSaveACopyA11yFixEnabled",!1)&&null!=I&&"dialog/modal"==I.name?this.controller.setSaveACopyCanceled():"VersionHistoryOverlay"===ra.name&&this.XZf.then(ab=>{ab.enterFocusTrapZone();return null})}catch(ab){ha.ULS.sendTraceTag(592197019,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",
ab)}});this.clickInputManager.Lrb("VersionHistoryOverlay",document.getElementById("VersionHistoryOverlay"));this.MTe("VersionHistoryHeader").hba((I,ra)=>{try{"VersionHistoryHeader"===ra.name&&this.XZf.then(ab=>{ab.enterHeaderFocusTrapZone();return null})}catch(ab){ha.ULS.sendTraceTag(592197020,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",ab)}});this.clickInputManager.Lrb("VersionHistoryHeader",document.getElementById("vhHeader"));this.MTe("VersionHistoryViewer").hba((I,
ra)=>{try{"VersionHistoryViewer"===ra.name&&Eg.FocusManager.ZM(document.getElementById("vhViewer"))}catch(ab){ha.ULS.sendTraceTag(592197021,3005,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",ab)}});this.clickInputManager.Lrb("VersionHistoryViewer",document.getElementById("vhViewer"))}dYl(){const I=ia.a.instance.ra("Common.ISystemInitiatedFeedback");I?(I.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"),I.logActivity("VersionHistoryCheckExited","WordVersionHistoryFGIsEnabled")):
ha.ULS.sendTraceTag(592197022,3005,10,"ISystemInitiatedFeedback was null")}F8h(){const I=ia.a.instance.ra("Common.ISystemInitiatedFeedback");I?I.logActivity("VersionHistoryExited","WordVersionHistoryFGIsEnabled"):ha.ULS.sendTraceTag(592197023,3005,10,"ISystemInitiatedFeedback was null")}static eYl(){const I=ia.a.instance.ra("Common.ISystemInitiatedFeedback");I?I.logActivity("VersionHistoryRestoreCoauthFailed","VersionHistoryRestoreSurveyEnabled"):ha.ULS.sendTraceTag(578359496,3005,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}SRm(I){I&&
I.addEventListener("keydown",ra=>{ra.ctrlKey&&"KeyC"===ra.code&&(this.Tod(),this.Rd.Pm("WordVersionHistoryCopyText",0));ra.ctrlKey&&"KeyF"===ra.code&&this.Rd.Pm("WordVersionHistorySearchText",0)})}}ve.SBn="ErrorCode";ve.Cdc="VersionHistoryExperienceDegraded";Object(f.a)(ve,"VersionHistoryPaneActor",null,[1646]);class te{constructor(){this.XZi=this.WZi=this.ZZi=this.YZi=!1}}Object(f.a)(te,"WordVersionHistorySettings",null,[]);class Ke{kbb(I,ra,ab){let Fb={name:"VersionHistoryExperienceDegraded",isIntentional:!1};
0==ra?Fb.Lm="VersionHistoryLaunchFailed":1==ra?I.includes("Failed to fetch")?Fb.Lm="SelectVersionFailedBecauseFetchFailed":I.includes("Unexpected server response (500) while retrieving PDF")?Fb.Lm="SelectVersionFailedServerResponseInternalError":I.includes("Unexpected server response (502) while retrieving PDF")?Fb.Lm="SelectVersionFailedServerResponseBadGateway":I.includes("Unexpected server response (415) while retrieving PDF")?(Fb.Lm="SelectVersionFailedServerResponseUnsupportedMediaType",Fb.isIntentional=
!0):I.includes("Unexpected server response (408) while retrieving PDF")?Fb.Lm="SelectVersionFailedServerResponseRequestTimeout":I.includes("Unexpected server response (400) while retrieving PDF")?Fb.Lm="SelectVersionFailedServerResponseBadRequest":I.includes("Unexpected server response (413) while retrieving PDF")?(Fb.Lm="SelectVersionFailedServerResponseRequestEntityTooLarge",Fb.isIntentional=!0):Fb.Lm="SelectVersionFailed":5==ra?(Fb.Lm="RestoreVersionFailed"+I,Fb.isIntentional="MultipleClientsInCoauthSession"===
I):4==ra?Fb.Lm="DownloadVersionFailed"+I:2==ra?Fb.Lm=Ke.FNf+I:3==ra&&(ab?(Fb.Lm=Ke.FNf+ab,Fb.isIntentional="OverwriteTarget"===ab||"TargetFileLocked"===ab):(I=this.W2k(I),Fb.Lm=I?"SaveVersionFailedServerResponse"+I:Ke.FNf));return Fb}W2k(I){switch(I){case "400":return"BadRequest";case "401":return"Unauthorized";case "403":return"Forbidden";case "404":return"NotFound";case "408":return"Timeout";case "500":return"InternalError";default:return""}}}Ke.FNf="SaveVersionFailed";Object(f.a)(Ke,"WordVersionHistoryVetoHelper",
null,[1645]);var Vf=b(915),Bf=b(907);class Vi{constructor(I,ra){this.m8d=I;this.Rd=ra;this.aKe=null;this.qKc=!0}initialize(I){this.aKe=I}sEn(){this.qKc=!this.qKc;this.display(this.AYe)}display(I){this.AYe=I;this.mqf(I);if(this.aKe){var ra=this.m8d.Lll(I,this.qKc);if(2==ra)this.m8d.yum(I.currentVersion.RevisionID);else{1==ra&&this.Rd.pi("WordVersionHistoryShowChanges","BaseNotAvailable",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});this.m8d.dnm(I.currentVersion.RevisionID);try{this.aKe.onVersionSelected(this.AYe.currentVersion,
this.AYe.baseVersion,null,this.qKc)}catch(ab){ha.ULS.sendTraceTag(524957267,3005,10,"Exception thrown by onVersionSelected: {0}",ab)}}}else this.p8l()}mqf(I){this.m8d.WGl(I.currentVersion.RevisionID)||(this.Rd.Pm("WordVersionHistorySelectVersion",0,{gjf:!0}),this.qKc&&!I.noBaseToCompareTo&&this.Rd.Pm("WordVersionHistoryShowChanges",0))}p8l(){this.Rd.pi("WordVersionHistorySelectVersion","VersionDisplayActorUninitialized",{isIntentional:!1},{name:"VersionHistoryExperienceDegraded"});ha.ULS.sendTraceTag(524957266,
3005,10,"AppVersionController was not initialized!")}}Object(f.a)(Vi,"VersionDisplayActor",null,[1644]);var Sh;(function(I){I[I.notStarted=0]="notStarted";I[I.inProgress=1]="inProgress";I[I.complete=2]="complete"})(Sh||(Sh={}));Object(f.b)("WaitForBaseState",Sh);class qj{constructor(I,ra){this.revisionId=I;this.Rd=ra;this.state=Sh.notStarted}get nok(){return this.revisionId}begin(){this.state==Sh.notStarted&&(this.startTime=ti.Nya(),this.state=Sh.inProgress,this.Rd.Pm("WordVersionHistoryWaitForBase",
1),ha.ULS.sendTraceTag(524957265,3005,50,"WaitForBaseOperation.begin"))}end(I){if(this.state==Sh.inProgress){this.state=Sh.complete;this.endTime=ti.Nya();const ra=ti.Vbk(this.endTime-this.startTime);this.revisionId==I?this.Rd.DBb("WordVersionHistoryWaitForBase",{Uu:ra}):this.Rd.pi("WordVersionHistoryWaitForBase","WaitForBaseTimedOut",{Uu:ra},{name:"VersionHistoryExperienceDegraded"})}}}Object(f.a)(qj,"WaitForBaseOperation",null,[]);class $h{constructor(I){this.Rd=I}Lll(I,ra){return I.noBaseToCompareTo||
!ra?0:I.baseVersion?I.baseVersion.DownloadUrl&&0<I.baseVersion.DownloadUrl.length?0:void 0===I.baseVersion.DownloadUrl||null===I.baseVersion.DownloadUrl?1:0==I.baseVersion.DownloadUrl.length?2:1:1}WGl(I){return this.iJb?this.iJb.nok==I:!1}dnm(I){this.iJb&&this.xLi(I)}yum(I){this.iJb&&this.xLi(I);this.iJb=new qj(I,this.Rd);this.iJb.begin()}xLi(I){this.iJb.end(I);this.iJb=null}}Object(f.a)($h,"WaitForBaseController",null,[1643]);class hj{constructor(){this.K=this.container=null;this.CSn={jUa:"webasynccollabeng",
featureName:"VersionHistory",occ:"VersionHistoryFeatureUsage",cJb:7}}get name(){return"WordEditor.VersionHistory"}init(){Q.AFrameworkApplication.Omf()?(ha.ULS.sendTraceTag(39966528,3005,50,"WordVersionHistoryPackage:init - Initializing the React VersionHistory package"),Sa.a.get_instance().Vk(7,()=>{const I=this.container.resolve("Common.IDynamicScriptLoaderProvider").$C;(Q.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("wordVersionHistory"):I.loadScript("wordVersionHistory")).catch(ra=>
ha.ULS.sendTraceTag(39966529,3005,10,"Failed to load the resources for the versionHistory feature: {0}",ra)).then(()=>this.tum()).catch(ra=>ha.ULS.sendTraceTag(39966530,3005,10,"Failed to initialize the versionHistory feature: {0}",ra))})):ha.ULS.sendTraceTag(39966498,3005,50,"WordVersionHistoryPackage:init - Not initializing the React VersionHistory package because the feature is disabled")}tum(){ha.ULS.sendTraceTag(541942913,3005,50,"Finished loading resources for the versionHistory feature");this.container.resolve("IVersionHistoryPaneActor").eb();
return null}dispose(){}yb(I){this.container=I;this.K=this.container.resolve("Common.IAppSettingsManager");if(this.K.$("AppSupportsVersionHistory")){var ra=this.container.resolve("Common.IBrowserUtils"),ab=new te;ab.YZi=this.K.$("WordWdDownloadTokenIsEnabled");ab.ZZi=this.K.$("WordWdDownloadTokenRegisterIsEnabled");ab.WZi=this.K.$("WordVersionHistoryEnableRestore");ab.XZi=this.K.$("WordVersionHistorySaveACopyOverFlowMenuIsEnabled");this.container.ha("IFeatureUsageAndHealthLogger",()=>new Vf.a(pa.Health.instance,
new Bf.a,this.CSn)).singleInstance();this.container.ha("IWaitForBaseController",()=>new $h(this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionDisplayActor",()=>new Vi(this.container.resolve("IWaitForBaseController"),this.container.resolve("IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("IVersionHistoryPaneActor",()=>new ve(Q.AFrameworkApplication.pa,Eg.FocusManager.instance(),Fh.a.instance,zb.a.instance,al.a.jO,pf.App.oa,pf.App.QY,
ab,ra,new Ad,Q.AFrameworkApplication.K,new gd,new ce.a,new Ke,this.container.resolve("IFeatureUsageAndHealthLogger"),this.container.resolve("IVersionDisplayActor"))).singleInstance()}}static main(){let I=!1;Q.AFrameworkApplication.K&&Q.AFrameworkApplication.K.$("IsOnDemandVersionHistoryEnabled")&&Q.AFrameworkApplication.Omf()&&(I=!0);aa.a.instance.Lb(new hj,0,I)}}Object(f.a)(hj,"WordVersionHistoryPackage",null,[1,2]);var Uo=b(99);class us{constructor(I,ra,ab){this.ga=I;this.Lj=ra;this.qa=ab}eb(){this.qa.$("ZoomPopupDialogIsEnabled")&&
(this.ga.ka(Ya.a.Kac,vf.a.frame,Object(x.a)(this.Lj,this.Lj.Kac,"showZoomDialog")),this.ga.Aa(Ya.a.jKm,vf.a.frame,Object(x.a)(this.Lj,this.Lj.oci,"onQueryZoomText"),96),this.ga.ka(Ya.a.c0c,vf.a.frame,Object(x.a)(this.Lj,this.Lj.m_i,"zoomDialogTabFocusHandler")),this.ga.ka(Ya.a.b0c,vf.a.frame,Object(x.a)(this.Lj,this.Lj.m_i,"zoomDialogTabFocusHandler")));this.qa.$("ZoomSliderIsEnabled")&&(this.ga.Aa(Ya.a.Hli,vf.a.frame,Object(x.a)(this.Lj,this.Lj.nrm,"onQueryZoomPercentage"),96),this.ga.Aa(Ya.a.p_i,
vf.a.frame,Object(x.a)(this.Lj,this.Lj.Jum,"onZoomToPercentage"),96),this.ga.ka(Ya.a.n_n,vf.a.frame,Uo.ActionManager.De))}}Object(f.a)(us,"CommonZoomActor",null,[927]);class Kn extends us{constructor(I,ra,ab){super(I,ra,ab);this.eba=ra}eb(){super.eb();this.qa.$("ZoomPopupDialogIsEnabled")&&(this.ga.ka(of.a.k3f,vf.a.frame,Uo.ActionManager.De),this.ga.ka(of.a.U8d,vf.a.frame,Object(x.a)(this.eba,this.eba.m_n,"zoomTo100")));this.ga.ka(of.a.zoomToPageWidth,vf.a.frame,Object(x.a)(this.eba,this.eba.zoomToPageWidth,
"zoomToPageWidth"));this.ga.ka(Ya.a.Wbb,vf.a.frame,Object(x.a)(this.eba,this.eba.Wbb,"increaseZoom"));this.ga.ka(Ya.a.K9a,vf.a.frame,Object(x.a)(this.eba,this.eba.K9a,"decreaseZoom"));this.ga.ka(of.a.mOf,vf.a.frame,Object(x.a)(this.eba,this.eba.ykn,"setZoomLevelFromRibbon"));this.ga.Aa(of.a.Vfb,vf.a.frame,Object(x.a)(this.eba,this.eba.oci,"onQueryZoomText"),96);this.ga.Aa(of.a.JWd,Qf.a.application,Object(x.a)(this.eba,this.eba.mrm,"onQueryZoomLevelLabelText"),96);this.ga.ka(Ng.a.nah,vf.a.frame,Uo.ActionManager.De);
this.ga.ka(Ng.a.mah,vf.a.frame,Uo.ActionManager.De);this.ga.ka(Ng.a.rah,vf.a.frame,Uo.ActionManager.De);this.ga.ka(Ng.a.oah,vf.a.frame,Uo.ActionManager.De);this.ga.ka(of.a.dfa,vf.a.frame,Uo.ActionManager.De)}}Object(f.a)(Kn,"WordEditorZoomActor",us,[]);class gt{constructor(I,ra){this.zoom=I;this.KLj=ra}}Object(f.a)(gt,"SetCustomZoomArgs",null,[]);var Ip=b(1004);class oo{constructor(I,ra){this.xpk=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"];this.ypk=[oo.zXe,
oo.Atd,"200","150","100","75","50"];this.Sha=3;this.nL=0;this.delta=.1;this.Aof=0;this.Bd=new u.a;this.rd=null;this.K=I;this.Eb=ra;this.lEi(1)}get ei(){return this.nL}lEi(I){this.nL=I}get Qyc(){return Math.round(100*this.ei)}get Ugm(){return Math.floor(this.Qyc/10)/10+this.delta}get Tgm(){return Math.ceil(this.Qyc/10)/10-this.delta}get ga(){return Q.AFrameworkApplication.pa}VJj(I){this.Bd.addHandler("ZoomChanged",I)}VYm(I){this.Bd.removeHandler("ZoomChanged",I)}Z4(I){this.VJj(I)}ngb(I){this.VYm(I)}gpi(){}Rqi(){}fpi(){}Qqi(){}d0c(I){this.n_i(I,
this.ei)}n_i(I,ra){null!==I&&Lj.a.vin(I,ra)}tRf(I,ra=!0){let ab=I*=100;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(ab=new gt(I,ra));this.RAi(ab)}xkn(I,ra=!1){this.dfa(I,3|(ra?0:4))}Hum(I,ra,ab){if(1===I)return 32;I=ab/100;I<this.fNc?I=this.fNc:I>this.RMc&&(I=this.RMc);this.dfa(I,1);ra&&(ra.dr=Math.floor(100*I));return 32}oci(I,ra,ab,Fb,ac){if(1===ab)return 32;I=gb.a.pya(this.Qyc,6,Q.AFrameworkApplication.numberFormat);ac.Value=I;ac.LabelText=I;return 32}Jum(I,ra,ab,Fb,ac){return 1===
ab?32:this.Hum(ab,Fb,ac.value)}nrm(I,ra,ab,Fb,ac){ac.MinValue=100*this.fNc;ac.MaxValue=100*this.RMc;ac.value=this.Qyc;return 32}VFh(){return this.xpk}WFh(){return this.ypk}WXk(){let I=Math.floor(100*this.ei).toString();1===this.Sha?I=oo.zXe:2===this.Sha&&(I=oo.Atd);return I}Wbb(I,ra,ab){if(1===ab)return 32;this.rMc(this.Eb?this.Eb.eF:0,"IncreaseZoom");this.Sha=0;this.dfa(this.Ugm);return 32}K9a(I,ra,ab){if(1===ab)return 32;this.rMc(this.Eb?this.Eb.eF:0,"DecreaseZoom");this.Sha=0;this.dfa(this.Tgm);
return 32}ykn(I,ra,ab,Fb,ac){if(1===ab)return 32;this.rMc(this.Eb?this.Eb.eF:0,"SetZoomLevelFromRibbon");I=ac.Value;if(I.toLowerCase().startsWith("fit"))return I=new gc.a(0,1,0,()=>{this.zoomToPageWidth(0,null,2,null,null)},138,void 0,!0),jo.a.instance.ub(I),32;I=parseInt(I)/100;if(isNaN(I))return 2;this.Sha=0;this.dfa(I);return 32}rMc(I,ra){ha.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; IsSLR: {2}",I,ra,Q.AFrameworkApplication.na.Ya.Jo)}Kac(I,ra,ab){if(1===
ab)return 32;ha.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog");this.showDialog();return 32}showDialog(){const I=this.WXk();this.rd=new Ip.a(this.VFh(),this.WFh(),Object(x.a)(this,this.Jrl,"handleZoomDialogResult"),Eg.FocusManager.instance(),!0);this.rd.Kac(CommonUIStrings.l_ZoomDialogTitle,I)}EJl(I){return I.toLowerCase()===oo.zXe.toLowerCase()}FJl(I){return I.toLowerCase()===oo.Atd.toLowerCase()}Jrl(I){if(I){if(this.EJl(I)){this.Sha=1;var ra=32}else if(this.FJl(I))this.Sha=
2,ra=this.zoomToPageWidth(0,null,2,null,null);else if(ra=Number.parseInvariant(I)){this.Sha=0;let ab=ra;this.K&&this.K.$("DoNotAutoScrollAfterPinchIsEnabled")&&(ab=new gt(ra,!0));ra=this.RAi(ab)}else ra=8;32===ra?ha.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{["DialogResult"]:I}):ha.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{["DialogResult"]:I})}else ha.ULS.sendTraceTag(529290753,353,10,"Failed to Zoom: {0}",{["DialogResult"]:I})}fMm(){this.Bd.raiseEvent("ZoomChanged",null)}mmi(){}JHf(){}m_i(I){if(!this.rd)return 2;
var ra=this.rd.wf.gk().Sh.dO;if(ra===this.rd.Hu&&I===Ya.a.c0c||ra===this.rd.ZC&&I===Ya.a.b0c)this.rd.Yga||this.rd.k9m(),this.rd.wf.gk().Sh.ov(this.rd.Yga);else if(ra.id.startsWith(this.rd.FRc)||ra.className.startsWith(this.rd.Tli))ra=null,I===Ya.a.c0c?ra=this.rd.ZC:I===Ya.a.b0c&&(ra=this.rd.Hu),this.rd.wf.gk().Sh.ov(ra),Sys.UI.DomElement.removeCssClass(this.rd.Yga.parentNode,this.rd.AHf);else if(I===Ya.a.c0c)this.rd.wf.gk().RYa();else if(I===Ya.a.b0c)this.rd.wf.gk().QYa();else return 2;return 32}}
oo.zXe="FullPage";oo.Atd="PageWidth";Object(f.a)(oo,"ZoomManager",null,[810]);b(1198);var Yg;(function(I){I[I.normal=0]="normal";I[I.quiet=1]="quiet";I[I.disableScrollUpdate=2]="disableScrollUpdate";I[I.disableUiControlUpdate=4]="disableUiControlUpdate"})(Yg||(Yg={}));Object(f.b)("ZoomUpdateFlags",Yg);var yp;(function(I){I[I.manual=0]="manual";I[I.fitToFullPage=1]="fitToFullPage";I[I.fitWidth=2]="fitWidth";I[I.onBoot=3]="onBoot"})(yp||(yp={}));Object(f.b)("ZoomStatus",yp);var fq=b(276),go=b(329),
ok=b(1055);class fs extends oo{constructor(I,ra,ab,Fb,ac,Xc,Md){super(I,ra);this.VWn=[CommonUIStrings.l_PageWidth,"200%","150%","125%","100%","75%","50%"];this.WWn=[oo.Atd,"200","150","125","100","75","50"];this.gFe=this.Eui=!1;this.A$f="AutoFitForAdaptiveLayout";this.rej="FitPageWidthFailure";this.Yyj="UpdateZoomFailure";this.rAj="wwf";this.YE=this.wGe=null;this.RW=ab;this.Bi=Fb;this.fb=ac;this.Se=Xc;this.Djc=Md;this.rrg=I.$("KeepViewAfterZoomIsEnabled");this.sAj=I.$("ZoomShortCutIsEnabled");this.pAj=
I.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableZoomScroll",!1);this.kzj=I.$("DoNotAutoScrollAfterPinchIsEnabled");this.Jij=(this.Pme=I.$("AdaptiveLayoutForSmallScreenModeIsEnabled"))&&I.$("AutoFitForSmallScreenModeIsEnabled");this.scj=I.$("DoNotProcessUpdateZoomActionIsEnabled");this.tAj=I.$("ZoomSliderIsEnabled");this.Xyj=!!I&&I.getBooleanFeatureGate("Microsoft.Office.WordOnline.UpdateUiAfterChromeReadyIsEnabled",!1);this.nz()}get appName(){return"WordEditor"}get RMc(){return 4}get fNc(){return.1}get Tnk(){return wacBoot.CtrlWheelMetrics}jJj(I){this.Bd.addHandler("PinchStart",
I)}KYm(I){this.Bd.removeHandler("PinchStart",I)}iJj(I){this.Bd.addHandler("PinchEnd",I)}JYm(I){this.Bd.removeHandler("PinchEnd",I)}get xB(){return this.YE||(this.YE=ia.a.instance.ra("WordEditor.IStatusBarUser"))}xWi(I){I=!(I&Yg.disableUiControlUpdate);const ra=!this.Xyj||Sa.a.get_instance().isCompleted(7);return I&&ra?(I={SelectZoomOption:"ComboBoxModel"},pf.App.oa&&pf.App.oa.xE(I),this.rSn(),!0):!1}dfa(I,ra=Yg.normal){let ab=!0;this.scj||Q.AFrameworkApplication.pa.processAction(of.a.dfa,2);if(this.ei===
I)return this.gFe||(this.gFe=this.xWi(ra)),ab;I>this.RMc?I=this.RMc:I<this.fNc&&(I=this.fNc);var Fb=!!(ra&Yg.quiet);1===I||Fb||Q.AFrameworkApplication.pa.processAction(of.a.k3f,2);try{Fb=null;pf.App.oa&&Object(wm.a)(ok.PageView,pf.App.oa.Da.Jb)&&(Fb=pf.App.oa.Da.Jb);let ac=-1,Xc=-1,Md=-1;const bf=!(ra&Yg.disableScrollUpdate);this.rrg&&bf&&(ac=Bk.SelectionEditor.qll(Ee.a.instance.Ca.Fa,Fb),Xc=Fb.XI.scrollLeft,Md=Fb.XI.scrollTop);const Hf=this.ei;this.lEi(I);this.fMm();this.gFe=this.xWi(ra);bf&&this.TQn(Fb,
ac,Xc,Md,Hf)}catch(ac){ab=!1,ha.ULS.sendTraceTag(7185431,353,10,"UpdateZoom error:{0}",ac)}return ab}TQn(I,ra,ab,Fb,ac){I&&I.isActive?this.rrg?0<=ra&&100>=ra?I.OA.oea(100-ra,!0,!0):I.OA.nWl(ab,Fb,ac,this.ei):I.OA.oea():ha.ULS.sendTraceTag(7185430,353,10,"UpdateZoom: Failed to get PageView to scroll content")}m_n(I,ra,ab){2===ab&&(this.rMc(this.Eb?this.Eb.eF:0,"ZoomTo100"),this.Sha=yp.manual,this.dfa(1));return 32}RAi(I){this.Sha=yp.manual;let ra,ab=!0;if(this.kzj){if(!Object(wm.a)(gt,I))return ha.ULS.sendTraceTag(51644238,
353,10,"actiondata is not a SetCustomZoomArgs"),8;ra=I.zoom/100;ab=I.KLj}else ra=Number.parseInvariant(String.format("{0}",I))/100;ha.ULS.sendTraceTag(7410915,353,50,"Word Editor - Zoom to custom value: {0}",ra);I=Yg.normal;ab||(I=Yg.disableScrollUpdate);this.dfa(ra,I);return 32}zoomToPageWidth(I,ra,ab){if(1===ab)return 32;ha.ULS.sendTraceTag(7410944,353,50,"Word Editor - Zoom to fit page width");this.Sha=yp.fitWidth;this.pCk();return this.C2e()}mrm(I,ra,ab,Fb,ac){if(1===ab)return 32;I=gb.a.pya(this.Qyc,
6,Q.AFrameworkApplication.numberFormat);ac[fq.a.labelText]=I;return 32}VFh(){return this.VWn}WFh(){return this.WWn}pCk(){this.Eui||(pf.App.oa?(pf.App.oa.r_(Object(x.a)(this,this.OIf,"refitToPageWidth")),this.Eui=!0):ha.ULS.sendTraceTag(7185432,353,10,"EnsureResizeEventRegistered: Failed to get PageManager to register event"))}C2e(){var I=pf.App.oa?pf.App.oa.Da.Jb:null;if(I&&pf.App.oa.vA){var ra=null;(I=this.TXk(I))&&(ra=this.RW.WO(I));ra||(ra=this.RW.C7e());if(null!==ra)return ra=Wf.a.instance.fv(ra),
ra=Sl.a.Vh(ra,0),I=this.Djc(),ra+=I&&I.x1d()?wacBoot.ShiftUtils.getFloatingObjectsContainerWidth():0,ra+=2*go.a.N2f,this.dfa(pf.App.oa.vA.offsetWidth/ra),32;ha.ULS.sendTraceTag(7185433,353,10,"Zoom to page width: cannot find word section node.")}else ha.ULS.sendTraceTag(7185434,353,10,"Zoom to page width: cannot find editing view node.");return 8}TXk(I){return I&&I.Ma&&I.Ma.Ca.Fa&&I.Ma.Ca.Fa.sa&&I.Ma.Ca.Fa.sa.node?I.Ma.Ca.Fa.sa.node:null}OIf(){this.Sha===yp.fitWidth&&this.C2e()}rSn(){this.xB&&(this.tAj?
(this.xB.JM(bq.a.i_n),this.xB.JM(bq.a.j_n)):this.xB.JM(bq.a.k_n))}zxn(I){I||(I=window.self.CtrlWheelMetrics);if(I){var ra=I.ctrlWheelOccurred;if("boolean"!==typeof ra)ha.ULS.sendTraceTag(594346948,353,15,"ctrlWheelMetrics module not found");else{ha.ULS.sendTraceTag(594346947,353,50,"ctrlWheelOccurred: {0}",ra);try{I.stop()}catch(ab){ha.ULS.sendTraceTag(594346946,326,15,"Exception: {0}",ab)}}}else ha.ULS.sendTraceTag(594346949,353,15,"ctrlWheelMetrics module not found")}nz(){this.zxn(this.Tnk);if(this.Bi){var I=
document.getElementById(In.AppFrame.bud);I&&this.Bi.Ea(F.a.keb,I,Object(x.a)(this,this.Snk,"ctrlScrollZoomHandler"))}this.fb&&(I=this.fb.fd(In.AppFrame.iC),this.sAj&&(I.bindAction(wc.KeyInputManager.mb(cf.a.sdc,wc.KeyInputManager.Bg),Ya.a.Wbb),I.bindAction(wc.KeyInputManager.mb(cf.a.p_c,wc.KeyInputManager.Bg),Ya.a.Wbb),I.bindAction(wc.KeyInputManager.mb(cf.a.tdc,wc.KeyInputManager.Bg),Ya.a.K9a),I.bindAction(wc.KeyInputManager.mb(cf.a.udc,wc.KeyInputManager.Bg),Ya.a.K9a),I.bindAction(wc.KeyInputManager.mb(cf.a.M0c,
wc.KeyInputManager.Bg),of.a.U8d)));this.Se&&(this.wGe=document.getElementById("LabelShowZoomValue-MediumCompact"))&&this.Se.Ea(F.a.click,this.wGe,Object(x.a)(this,this.Ium,"onZoomLabelClickEvent"));this.Jij&&(pf.App.oa.Vw.registerLayoutBreakpointChanged("canvas",ra=>{this.ILe(ra)}),pf.App.oa.Vw.registerBoundingWindowRectsChanged("canvas",()=>{this.ILe(pf.App.oa.Vw.getLayoutBreakpoint())}))}ILe(I){let ra=!0,ab="";if(this.Sha!==yp.onBoot)return ra;pa.Health.instance.recordKpiUsage(this.A$f,0,this.rAj,
null);switch(I){case "Small":8===this.C2e()&&(ab=this.rej,ra=!1);break;default:1===this.ei||this.dfa(1)||(ab=this.Yyj,ra=!1)}ra||pa.Health.instance.recordKpiFailure(this.A$f,ab,!0,!0,null);return ra}Snk(I){if(I.ctrlKey&&(Q.AFrameworkApplication.pa.processAction(Ng.a.oah,2),this.pAj)){I=I.eWn;if(!I)return!1;this.dfa(this.ei-(0<I?.1:-.1));this.rMc(6,"CtrlScroll");return!0}return!1}Ium(){ha.ULS.sendTraceTag(42341578,353,50,"Click event detected on Zoom Label. IsSLR: {0}",!0);return!0}gpi(I){this.jJj(I)}Rqi(I){this.KYm(I)}fpi(I){this.iJj(I)}Qqi(I){this.JYm(I)}mmi(){this.Bd.raiseEvent("PinchStart",
null)}JHf(){this.Bd.raiseEvent("PinchEnd",null)}}Object(f.a)(fs,"WordEditorZoomManager",oo,[1615,810]);class vs{constructor(){this.W=null}get name(){return"WordEditor.Zoom"}init(){if(Q.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")){const I=this.W.resolve("WordEditor.Zoom.WordEditorZoomActor"),ra=this.W.resolve("WordEditor.Zoom.WordEditorZoomManager");I.eb();Sys.UI.DomElement.overrideGetBounds=!0;Q.AFrameworkApplication.K.$("AdaptiveLayoutForSmallScreenModeIsEnabled")&&Q.AFrameworkApplication.K.$("AutoFitForSmallScreenModeIsEnabled")&&
ra&&Sa.a.get_instance().Vk(4,()=>{ra.ILe(pf.App.oa.Vw.getLayoutBreakpoint())||ha.ULS.sendTraceTag(578326819,353,15,"Auto fit for adaptive layout failed during boot.")})}}dispose(){}yb(I){this.W=I;Q.AFrameworkApplication.K.$("ZoomPopupDialogIsEnabled")&&(this.W.ha("WordEditor.Zoom.WordEditorZoomManager",()=>new fs(Q.AFrameworkApplication.K,Q.AFrameworkApplication.pa,Sp.WordSectionNavigator.instance,jf.a.instance,Eg.FocusManager.instance(),zb.a.instance,()=>I.ra("Box4.IFloatingObjectUpdater"))).singleInstance().as("Common.IZoomManager").as("WordEditor.IWordEditorZoomManager"),
this.W.ha("WordEditor.Zoom.WordEditorZoomActor",()=>new Kn(Q.AFrameworkApplication.pa,this.W.resolve("WordEditor.Zoom.WordEditorZoomManager"),Q.AFrameworkApplication.K)).singleInstance())}static main(){aa.a.instance.Lb(new vs)}}Object(f.a)(vs,"ZoomPackage",null,[1,2]);var ht=window.FormatPictureTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FormatPictureTaskPane",Title:"STR@L_FormatPicture",Width:"300",ImageCollapsedArrow:"IMGMAP@we@ArrowCollapsedRest_16x16x32",
ImageExpandedArrow:"IMGMAP@we@ArrowExpandedRest_16x16x32",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageCheckMark:"IMGMAP@we@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@we@CheckboxUnchecked_16x16x32"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupFormatPictureControls",IsStretched:"false"},children:[{name:"Section",
attrs:{Id:"GroupFormatPictureControlsSection"},children:[{name:"Row",attrs:{Id:"NavControls",DisplayMode:"Large30",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnProperties",Command:"0x62A2D4C0",Image30by30:"IMGMAP@we@FormatObjectProperties_30x30x32",LabelText:"STR@L_Properties"}},{name:"Button",attrs:{Id:"btnPicture",Command:"0x7136810D",Image30by30:"IMGMAP@we@FormatObjectPictureOptions_30x30x32",LabelText:"STR@L_Picture"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupAllInOne",
IsStretched:"true",TextAlign:"Right"},children:[{name:"CollapsibleSection",attrs:{Id:"AltTextCollapsibleSection",Title:"STR@l_AlternativeTextDialogTitle"},children:[{name:"Section",attrs:{Id:"altTextSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextTitle",Alt:"STR@l_AlternativeTextTitleCaption",LabelText:"STR@l_AlternativeTextTitleCaption",Command:"0x3507A2B1",QueryCommand:"0x36DB7495",DisplayMode:"Medium",
MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"30px",IsStretchedHorizontally:"true"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"TextBox",attrs:{Id:"txtBoxAltTextDescription",Alt:"STR@l_AlternativeTextDescriptionCaption",LabelText:"STR@l_AlternativeTextDescriptionCaption",Command:"0x61FE1E53",QueryCommand:"0x416A13E3",DisplayMode:"Medium",MaxLength:"65536",AdditionalLabelBy:"AltTextCollapsibleSection-Title",Height:"180px",
IsStretchedHorizontally:"true",IsMultiline:"true"}}]}]}]}]},{name:"CollapsibleSection",attrs:{Id:"CropCollapsibleSection",Title:"STR@L_Crop"},children:[{name:"Section",attrs:{Id:"leftCropSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropTop",LabelText:"STR@L_Top",For:"spnCropTop"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"lblCropBottom",LabelText:"STR@L_Bottom",For:"spnCropBottom"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropLeft",LabelText:"STR@L_Left",For:"spnCropLeft"}}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblCropRight",LabelText:"STR@L_Right",For:"spnCropRight"}}]}]}]},{name:"Section",attrs:{Id:"rightCropSection",HorizontalAlignment:"Right"},
children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropTop",Alt:"STR@L_CropTopTooltip",Command:"0xDF8DEBBA",QueryCommand:"0xB9089B94",LabelledBy:"CropCollapsibleSection-Title lblCropTop-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",
attrs:{Id:"spnCropBottom",Alt:"STR@L_CropBottomTooltip",Command:"0x091D0734",QueryCommand:"0xA3D9079E",LabelledBy:"CropCollapsibleSection-Title lblCropBottom-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropLeft",Alt:"STR@L_CropLeftTooltip",Command:"0x2F92B28A",QueryCommand:"0x037C5130",LabelledBy:"CropCollapsibleSection-Title lblCropLeft-Medium"},
children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]},{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Spinner",attrs:{Id:"spnCropRight",Alt:"STR@L_CropRightTooltip",Command:"0x52A3310D",QueryCommand:"0x2AA307AB",LabelledBy:"CropCollapsibleSection-Title lblCropRight-Medium"},children:[{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]}]}]}]}]},{name:"CollapsibleSection",
attrs:{Id:"RotateCollapsibleSection",Title:"STR@L_Rotation"},children:[{name:"Section",attrs:{Id:"leftRotateSection"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblRotationAngle",LabelText:"STR@L_RotationAngle",For:"spnRotateAngle"}}]}]}]},{name:"Section",attrs:{Id:"rightRotateSection",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{DisplayMode:"Medium",Height:"29px"},children:[{name:"Controls",
attrs:{},children:[{name:"Spinner",attrs:{Id:"spnRotateAngle",Alt:"STR@L_RotationSpinnerTooltip",Command:"0x97B9E874",QueryCommand:"0xD63D3722",LabelledBy:"RotateCollapsibleSection-Title lblRotationAngle-Medium"},children:[{name:"Unit",attrs:{UnitType:"degree",MinimumValue:"0",MaximumValue:"360",Step:"1"}}]}]}]}]}]}]}]}]}]},it=window.InteractivePerfTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InteractivePerfTaskPane",
Title:"Interactive Perf TaskPane",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"TypingSpeedMeterGroup"}},{name:"Group",attrs:{Id:"CpuMeterGroup"}},{name:"Group",attrs:{Id:"RenderGroup"}}]}]}]};class Jr extends hd.a{constructor(I){super(!1,!1,!0);this.a1c=I}start(){const I={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.a1c.gef}};this.Tg("",Object(x.a)(this,this.G3m,"resultHandler"),I)}G3m(I,ra){1===I&&(this.a1c.gef=ra.tooltipPersistenceEnabled)}}
Object(f.a)(Jr,"AccessibilitySettingsDialog",hd.a,[]);class Kr{constructor(I,ra){this.ga=I;this.a1c=ra}eb(){this.ga.ka(Ya.a.dqn,vf.a.frame,Object(x.a)(this,this.eqn,"showAccessibilitySettingsDialogHandler"))}eqn(){(new Jr(this.a1c)).start();return 32}}Object(f.a)(Kr,"AccessibilitySettingsDialogActor",null,[1649]);const hn=I=>{const ra=new l.a;Q.AFrameworkApplication.fe.ai(gs(I),1,null,null,!0,2,ab=>{200===ab.data.we?ra.Jf("true"===ab.data.qd.toLowerCase()):ra.Jf(!1)},()=>{ra.Jf(!1)},null,void 0,void 0,
void 0,void 0,"7");return ra.task},gs=I=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",Q.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||"",I,Q.AFrameworkApplication.kl);class ws{constructor(){this.sNb=null}get gef(){return!!this.sNb}set gef(I){I!==this.sNb&&(this.sNb=I,ik.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(I),this.cWh()&&Q.AFrameworkApplication.fe.ai(gs("saveHoverableRibbonTooltipIsEnabled"),2,I.toString().toLowerCase(),
null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}r_l(){const I=new l.a;if(this.sNb)I.Jf(this.sNb);else if(this.cWh()){const ra=hn("getHoverableRibbonTooltipIsEnabled");ra.continueWith(()=>{this.sNb=ra.result;ik.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ra.result);I.Jf(ra.result)},8)}else I.Jf(!1)}cWh(){const I=Q.AFrameworkApplication.K.$("IsRoamingServiceEnabled"),ra=Q.AFrameworkApplication.K.$("IsAnonymousUser");return I&&!ra}}Object(f.a)(ws,"AccessibilitySettingsInfo",
null,[1642]);class jt{constructor(){this.W=null}get name(){return"Common.App.AccessibilitySettings"}yb(I){this.W=I;this.W.register(ws,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Pc(()=>new ws).singleInstance();this.W.register(Kr,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Pc(()=>new Kr(Q.AFrameworkApplication.pa,this.W.ra("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).singleInstance()}init(){const I=
this.W.ra("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ra=this.W.ra("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");I&&ra?(ra.eb(),I.r_l()):r.b(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){aa.a.instance.Lb(new jt)}}Object(f.a)(jt,"AccessibilitySettingsPackage",null,[1,2]);class gq{constructor(){this.events=[];this.ELf=!1}static vnf(I){return I.ctrlKey&&
"Control"!==I.key||I.altKey&&"Alt"!==I.key||!!gq.tWl[I.key]}static oXj(I,ra){let ab;ab=gq.vnf(I)?I.key:" "===I.key?"Space":"CharacterKey";return null!=ra?(ra.altPressed=(!!I.altKey).toString(),ra.ctrlPressed=(!!I.ctrlKey).toString(),ra.key=ab,ra.repeat=(!!I.repeat).toString(),ra.shiftPressed=(!!I.shiftKey).toString(),ra):{["altPressed"]:(!!I.altKey).toString(),["ctrlPressed"]:(!!I.ctrlKey).toString(),["key"]:ab,["repeat"]:(!!I.repeat).toString(),["shiftPressed"]:(!!I.shiftKey).toString()}}static kVh(I){return window.performance&&
window.performance.now&&I.timeStamp<performance.now()}static bjh(I){return!!I&&gq.kVh(I)&&gq.vnf(I)}static cjh(I){return!!I&&gq.kVh(I)&&!gq.vnf(I)}keyPressedEventHandlerStart(I,ra){gq.cjh(I)&&this.WKi(I,ra)}keyPressedEventHandlerEnd(I){gq.cjh(I)&&this.wLi(I)}keyDownEventHandlerStart(I,ra){gq.bjh(I)&&this.WKi(I,ra)}keyDownEventHandlerEnd(I){gq.bjh(I)&&this.wLi(I)}WKi(I,ra){I={["metadata"]:gq.oXj(I,ra),["timeStamp"]:this.Dcc(I.timeStamp),["timeToHandlerFinishMs"]:0,["timeToHandlerStartMs"]:this.Dcc(performance.now()-
I.timeStamp),["eventDurationMs"]:0,["timeToRequestAnimationFrameMs"]:0};this.events.push(I);this.JTm()}wLi(I){if(0!==this.events.length){var ra=this.Dcc(I.timeStamp);for(let ab=this.events.length-1;0<=ab;--ab){const Fb=this.events[ab];if(Fb.timeStamp===ra){Fb.timeToHandlerFinishMs=this.Dcc(performance.now()-I.timeStamp);Fb.eventDurationMs=this.Dcc(Fb.timeToHandlerFinishMs-Fb.timeToHandlerStartMs);break}}}}Dcc(I){return Number(I.toFixed(2))}JTm(){if(!this.ELf){const I=document.createEvent("CustomEvent");
I.initCustomEvent("aggregateeventtimingstart",!1,!1,null);dispatchEvent(I);requestAnimationFrame(()=>{this.ELf=!1;const ra=performance.now();this.events.forEach(Fb=>{Fb.timeToRequestAnimationFrameMs=this.Dcc(ra-Fb.timeStamp)});var ab=document.createEvent("CustomEvent");ab.initCustomEvent("aggregateeventtiming",!1,!1,this.events.slice(0));dispatchEvent(ab);this.events=[];ab=document.createEvent("CustomEvent");ab.initCustomEvent("aggregateeventtimingstop",!1,!1,null);dispatchEvent(ab)});this.ELf=!0}}}
gq.tWl={w3f:!0,R_i:!0,S_i:!0,x3f:!0,Backspace:!0,Delete:!0,End:!0,d4f:!0,q1i:!0,D0n:!0,r1n:!0,s1n:!0,Tab:!0};class Uk{constructor(){this.OYd=this.IYa=this.NKa=this.n5b=null;this.D3b=!1;this.b9b=null;this.jCc=[];this.IZc=()=>{Uk.uPl()&&null==this.IYa?(this.NKa=null,this.IYa=requestAnimationFrame(this.TMc)):null!=this.IYa&&(cancelAnimationFrame(this.IYa),this.IYa=null)};this.TMc=I=>{if(null!=this.NKa){const ra=I-this.NKa;if(null==this.n5b||this.n5b<ra)this.n5b=ra;for(let ab=0;ab<Uk.NRc.length;++ab)if(ra<
Uk.NRc[ab]){++this.jCc[ab];break}}this.NKa=I;this.IYa=requestAnimationFrame(this.TMc)};this.pti=()=>{if(null!=this.n5b){var I={};for(var ra=0;ra<Uk.NRc.length;++ra)I[Uk.NRc[ra]]=this.jCc[ra],this.jCc[ra]=0;ra=performance.now();I={["intervalStart"]:this.b9b,["intervalEnd"]:ra,["maxFrameLengthMs"]:this.n5b,["frameData"]:I};var ab=document.createEvent("CustomEvent");ab.initCustomEvent("reportframetiming",!1,!1,I);dispatchEvent(ab);this.n5b=null;this.b9b=ra}}}static Ukf(){return!!window.performance&&
!!window.performance.now}start(I){!this.D3b&&Uk.Ukf()&&(this.Skn(),this.OYd=setInterval(this.pti,1E3*I),this.b9b=performance.now(),this.IZc(),document.addEventListener("visibilitychange",this.IZc),this.D3b=!0)}stop(){this.D3b&&(document.removeEventListener("visibilitychange",this.IZc),null!=this.OYd&&(clearInterval(this.OYd),this.OYd=null),null!=this.IYa&&(cancelAnimationFrame(this.IYa),this.IYa=null),this.pti(),this.D3b=!1)}get o3b(){return this.D3b}Skn(){this.jCc=[];for(let I=0;I<Uk.NRc.length;++I)this.jCc.push(0)}}
Uk.uPl=()=>"visible"===document.visibilityState;Uk.NRc=[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Type.registerNamespace("B4RT");Type.registerNamespace("Box4.AccessibilityChecker");Type.registerNamespace("Box4.Symbols");Type.registerNamespace("WEDSM");Type.registerNamespace("WEFP");Type.registerNamespace("WETF");Type.registerNamespace("WEUCH");Type.registerNamespace("WordEditor.AccessibilityChecker");Type.registerNamespace("WordEditor.CoauthSurveys");Type.registerNamespace("WordEditor.ComponentStateLogging");
Type.registerNamespace("WordEditor.FirstRunExperience");Type.registerNamespace("WordEditor.FrameTiming");Type.registerNamespace("WordEditor.GraphMerge");Type.registerNamespace("WordEditor.InteractivePerfTaskPane");Type.registerNamespace("WordEditor.ModernFontPicker");Type.registerNamespace("WordEditor.PageBreak");Type.registerNamespace("WordEditor.Pagination");Type.registerNamespace("WordEditor.TellMe");Type.registerNamespace("WordEditor.TrackChange");Type.registerNamespace("WordEditor.Zoom");Type.registerNamespace("Common.App.VersionHistory");
Type.registerNamespace("WordEditor.VersionHistory");aa.a.instance.Lb(new hj);bh.main();Type.registerNamespace("Common.App.AccessibilityChecker");Type.registerNamespace("Common.App.Assistance");k;Type.registerNamespace("CACPU");oa.main();Type.registerNamespace("CAEventTimingMeter");fa.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Wa.main();Type.registerNamespace("Common.App.GestureInput");Db.main();Type.registerNamespace("Common.App.GestureManager");ec.main();Type.registerNamespace("Common.ModernFontPicker");
Type.registerNamespace("Common.App.OfflineLogger");aa.a.instance.Lb(new Sc);Type.registerNamespace("Common.App.O365Shell");Lc.main();Type.registerNamespace("Common.App.PhoneLink");Rd.main();Type.registerNamespace("Common.App.SensitiveLogging");zk.main();Type.registerNamespace("Common.App.Rename");aa.a.instance.Lb(new rf,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");aa.a.instance.Lb(new Le);Type.registerNamespace("Common.App.SaveAsToHost");yh.main();Type.registerNamespace("Common.App.SaveToCloudStorage");
gh.main();Type.registerNamespace("Common.App.SaveACopy");Cl.main();Type.registerNamespace("Common.App.SaveToSharePoint");yg.main();Type.registerNamespace("Common.App.SharedFilePicker");wl.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");Type.registerNamespace("CATypingSpeedMeter");Cf.main();qi;ae.main();aa.a.instance.Lb(new sl);Rk.main();ht;qd.main();aa.a.instance.Lb(new Mo);
Tn.main();gf.a.prototype.toString=ne.a.prototype.toString;ch.a.UGh=new Oe.a;aa.a.instance.Lb(new Rp);vs.main();aa.a.instance.Lb(new Dp);aa.a.instance.Lb(new km);aa.a.instance.Lb(new dp);Qq.main();Ck.main();uk.main();$b.main();Type.registerNamespace("NLRT");aa.a.instance.Lb(new lf);Type.registerNamespace("Common.App.AccessibilitySettings");jt.main();it;lp.main();aa.a.instance.Lb(new Un);window.EventTiming={EventTimingMeter:gq,FrameTimingMeter:Uk}}}]);

//# sourceMappingURL=https://wordwebclientbuilds.blob.core.windows.net/ooui/a048ce1529a2befd784608ddea483865d3dd781d/WordEditorDSVersionHistoryNotRemoved.box4.dll2.js.map