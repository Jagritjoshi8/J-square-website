!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).augLoop=e()}}((function(){return function e(t,o,n){function r(s,a){if(!o[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=o[s]={exports:{}};t[s][0].call(l.exports,(function(e){return r(t[s][1][e]||e)}),l,l.exports,e,t,o,n)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(2),o)},{2:2}],2:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.isStopWorkflowMessage=o.setStopAndFilterWorkflowMessage=o.setMessageException=o.getMessageExceptionType=o.getMessageExceptionDescription=o.filterWorkflowSchema=o.exceptionSchema=void 0;var n=e(90);o.exceptionSchema={category:n.TypeCategory.Schema,schema:{name:"Exception",path:"message-schema.proto"}},o.filterWorkflowSchema={category:n.TypeCategory.Schema,schema:{name:"Filter",path:"message-schema.proto"}};o.getMessageExceptionDescription=function(e,t){if(void 0===t&&(t=!1),null==e)return"Invalid message passed";if(null==e.payload)return"".concat(n.ExceptionType[n.ExceptionType.NoOutput],": Payload is null");if(null==e.payload.exceptionType)return"Payload is not an exception";var o=n.ExceptionType[e.payload.exceptionType];return o+=e.payload.message?": ".concat(e.payload.message):": No description",o+=t&&e.payload.data?"\n".concat(e.payload.data.toString()):""};o.getMessageExceptionType=function(e){return null==e||null==e.payload||null==e.payload.exceptionType?n.ExceptionType.Unknown:e.payload.exceptionType};o.setMessageException=function(e,t){if(null==e)throw new Error("Cannot set exception on null message");e.payload=t,e.payloadSchema=o.exceptionSchema,e.messageType=n.MessageType.Exception};o.setStopAndFilterWorkflowMessage=function(e,t){if(null==e)throw new Error("Cannot set filter on null message");var r={condition:t};e.payload=r,e.payloadSchema=o.filterWorkflowSchema,e.messageType=n.MessageType.StopAndFilterWorkflow};o.isStopWorkflowMessage=function(e){return(e||{}).messageType==n.MessageType.StopAndFilterWorkflow}},{90:90}],3:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(8),o),r(e(9),o)},{8:8,9:9}],4:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ReduceTimerCache=void 0;var n=function(){function e(){this.cache=new Map}return e.prototype.setReduceTimer=function(e,t,o,n,r,i){var s=this;void 0===n&&(n=500),void 0===r&&(r=function(){return!1}),void 0===i&&(i=5e3),this.cache.has(e)||this.cache.set(e,new Map);var a=this.cache.get(e);a.has(t)&&clearTimeout(a.get(t).timer);var c=function(){var c=a.get(t),u=Date.now()-c.start;r()&&u<i?c.timer=setTimeout(c.timerCallback,Math.min(n,i-u)):(a.size>1?a.delete(t):s.cache.delete(e),o())};a.set(t,{start:Date.now(),timerCallback:c,timer:setTimeout(c,n)})},e.prototype.clear=function(e,t){this.cache.forEach((function(o,n){e&&e!==n||o.forEach((function(e,o){t&&t!==o||clearTimeout(e.timer)}))})),this.cache.clear()},e}();o.ReduceTimerCache=n},{}],5:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.executeRemoteLambda=o.clearTokenCache=void 0;var n,r=e(31),i=e(64),s=e(90);o.clearTokenCache=function(){n=new i.TokenCache},(0,o.clearTokenCache)();var a=function(e,t,o,c,u,l,p,f,d,h){var g={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":u},body:JSON.stringify({payload:t.payload,payloadSchema:o,requestedSchema:c,clientMetadata:l,tokens:n.getAuthTokenEntries(p,d.docId)})};(0,i.internalFetch)(e,g,(function(i,g){i?h(new Error("Fetch error in remote lambda request to ".concat(e,": ").concat(i))):401===g.status?f>0?(r.Log.info(572838109,r.LogCategory.CoreDefault,"Auth token required for remote lambda request"),g.json().then((function(e){return n.updateAuthToken(p,{Tickets:[e],DocId:d.docId})})).then((function(){a(e,t,o,c,u,l,p,f-1,d,h)})).catch((function(e){h({exceptionType:s.ExceptionType.Authentication,message:e.message})}))):h({exceptionType:s.ExceptionType.Authentication,message:"Remote lambda request retry with authentication token failed"}):g.ok?g.json().then((function(e){if(Array.isArray(e))if(e.length>0)for(var o=0,n=0,r=e;n<r.length;n++){var i=r[n];t.moreResults=++o<e.length,h(null,i)}else h(new Error("No output"));else h(new Error("Did not receive a valid response for remote lambda request"))})).catch((function(e){h({exceptionType:s.ExceptionType.LambdaThrow,message:e.message})})):h(new Error("Remote lambda request failed with status ".concat(g.status)))}))};o.executeRemoteLambda=function(e,t,o,r,i,c,u,l,p){Array.isArray(l.authTickets)?n.updateAuthToken(u,{Tickets:l.authTickets,DocId:l.docId}).then((function(){a(e,t,o,r,i.id,c,u,1,l,p)})).catch((function(e){p({exceptionType:s.ExceptionType.Authentication,message:e.message})})):a(e,t,o,r,i.id,c,u,1,l,p)}},{31:31,64:64,90:90}],6:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.testWebSocketConnection=o.executeRemoteLambda=o.clearTokenCache=void 0;var n,r=e(31),i=e(64),s=e(90),a=e(11);o.clearTokenCache=function(){n=new i.TokenCache},(0,o.clearTokenCache)();var c=new a.WebSocketRequestManager(3e4,(function(){return new i.WebSocketWorker}),50),u=function(e,t,o,i,a,l,p,f,d,h){var g={payload:t.payload,payloadSchema:o,requestedSchema:i,clientMetadata:l,tokens:n.getAuthTokenEntries(p,d.docId)},y="";i&&i.schema&&(y=i.schema.name);var m=!1;c.addRequest(e,g,a,y,(function(c,g,y){if(!m)if(m=!0,null!=g)if(g.exceptionType===s.ExceptionType.Authentication)try{var v=JSON.parse(g.data);f>0?(r.Log.info(572838108,r.LogCategory.CoreDefault,"Auth token required for remote lambda WebSocket request"),n.updateAuthToken(p,{Tickets:[v],DocId:d.docId}).then((function(){u(e,t,o,i,a,l,p,f-1,d,h)})).catch((function(e){h({exceptionType:s.ExceptionType.Authentication,message:e.message})}))):h({exceptionType:s.ExceptionType.Authentication,message:"Remote lambda request retry with authentication token failed"})}catch(e){h({exceptionType:s.ExceptionType.Authentication,message:e.message})}else h(new Error("Error in remote lambda WebSocket request to ".concat(e,": ").concat(g)));else t.moreResults=!1,h(null,c)}))};o.executeRemoteLambda=function(e,t,o,r,i,a,c,l,p){Array.isArray(l.authTickets)?n.updateAuthToken(c,{Tickets:l.authTickets,DocId:l.docId}).then((function(){u(e,t,o,r,i.id,a,c,1,l,p)})).catch((function(e){p({exceptionType:s.ExceptionType.Authentication,message:e.message})})):u(e,t,o,r,i.id,a,c,1,l,p)};o.testWebSocketConnection=function(e,t){return c.testConnection(e,t)}},{11:11,31:31,64:64,90:90}],7:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ResultCache=void 0;var n=function(){function e(){this.cache=new Map,this.bucketSizes=new Map}return e.prototype.setBucketSize=function(e,t){this.bucketSizes.set(e,t)},e.prototype.setResult=function(e,t,o){if(t.primary){var n=this.cache.get(e);n||(n=new Map,this.cache.set(e,n));var r=n.get(t.primary);if(r||(r=t.secondary?new Map:[],n.set(t.primary,r)),t.secondary){r.set(t.secondary,o)}else{var i=r;i.length==this.getBucketSize(e)&&i.shift(),i.push(o)}}},e.prototype.getResults=function(e,t){var o=this.cache.get(e);if(o){var n=o.get(t.primary);if(n){if(!t.secondary)return n;var r=Array.from(n.values());if(r.length>0)return r}}return[]},e.prototype.clear=function(e,t){t?this.cache.forEach((function(o,n){if(!e||e===n)if(t.secondary){var r=o.get(t.primary);r&&r.delete(t.secondary)}else o.delete(t.primary)})):e?this.cache.delete(e):this.cache.clear()},e.prototype.getBucketSize=function(e){return this.bucketSizes.get(e)||10},e}();o.ResultCache=n},{}],8:[function(e,t,o){"use strict";var n=e("assignHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.runtimeALv1=o.ClientRuntimeALv1=o.getTypeFromSchema=o.Workflow=void 0;var r,i=e(1),s=e(31),a=e(64),c=e(90),u=e(4),l=e(5),p=e(6),f=e(7),d=e(9),h=e(10);!function(e){e[e.Restricted=0]="Restricted",e[e.Unrestricted=1]="Unrestricted",e[e.Suppressed=2]="Suppressed"}(r||(r={}));var g=function(){function e(){this.canaryTextTileEventSubmittedByDocSessionId=new Set,this.stateByDocSessionId=new Map,this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map}return e.prototype.getOutputSchema=function(){return this.lambdas[this.lambdas.length-1].outputSchema},e.prototype.scheduleExecution=function(e,t){var o=this.docSessionIdExtractor?this.docSessionIdExtractor(e):void 0,n=this.getStateForDocSessionId(o);if(n===r.Restricted){var i=this.getExecutionQueueForDocSessionId(o);i.push(t),1===i.length&&t()}else n===r.Unrestricted?t():r.Suppressed},e.prototype.onStart=function(e){this.incrementExecutionCountForDocSessionId(e)},e.prototype.onFinish=function(e,t){if(this.decrementExecutionCountForDocSessionId(e),t===c.ExceptionType.Authentication)this.stateByDocSessionId.set(e,r.Suppressed),this.executionQueueByDocSessionId.delete(e);else if(this.stateByDocSessionId.get(e)===r.Restricted){var o=this.getExecutionQueueForDocSessionId(e);if(o.shift(),void 0===t){this.stateByDocSessionId.set(e,r.Unrestricted),this.executionQueueByDocSessionId.delete(e);for(var n=0,i=o;n<i.length;n++){(0,i[n])()}}else if(o.length>0){(0,o[0])()}}},e.prototype.onRefresh=function(e){this.stateByDocSessionId=new Map,this.triggerOnRefresh&&(e?(this.executionQueueByDocSessionId.delete(e),this.executionCountByDocSessionId.delete(e)):(this.executionQueueByDocSessionId=new Map,this.executionCountByDocSessionId=new Map)),this.canaryTextTileEventSubmittedByDocSessionId.delete(e)},e.prototype.getStateForDocSessionId=function(t){var o=this.stateByDocSessionId.get(t);return void 0===o&&(o=e.executionQueuesEnabled?r.Restricted:r.Unrestricted,this.stateByDocSessionId.set(t,o)),o},e.prototype.getExecutionQueueForDocSessionId=function(e){var t=this.executionQueueByDocSessionId.get(e);return void 0===t&&(t=[],this.executionQueueByDocSessionId.set(e,t)),t},e.prototype.incrementExecutionCountForDocSessionId=function(e){var t=this.executionCountByDocSessionId.get(e)||0;this.executionCountByDocSessionId.set(e,t+1)},e.prototype.decrementExecutionCountForDocSessionId=function(e){var t=this.executionCountByDocSessionId.get(e)||0;t<=1?this.executionCountByDocSessionId.delete(e):this.executionCountByDocSessionId.set(e,t-1)},e.executionQueuesEnabled=!0,e}();o.Workflow=g;o.getTypeFromSchema=function(e){return{category:c.TypeCategory.Schema,schema:{name:e}}};var y="Tiling.TextTileEvent",m=function(e,t){return e===y&&t&&t.type==c.Tiling.TextTileEventType.Refresh},v=function(e,t){return"ClpSlideTile"===e&&t&&t.eventType==c.Ppt.SlideTileEventType.Refresh},T=function(e,t){return m(e,t)||v(e,t)},S=function(e,t){var o,n;return e===y?null===(n=null===(o=t.tile)||void 0===o?void 0:o.metadata)||void 0===n?void 0:n.docSessionId:"ClpSlideTile"===e?t.docId:void 0},w=function(){function e(){this.inputSchemasToWorkflows=new Map,this.inputSchemasToReduceWorkflows=new Map,this.reduceWorkflowsGroupingKeyExtractors=new Map,this.defaultWorkflowOptions={canProduceNullResult:!1,shouldSendResultsToHost:!0,enabledByDefault:!1,throttleSettings:{shouldBeThrottled:!1},triggerOnRefresh:!1},this.resultCache=new f.ResultCache,this.reduceTimerCache=new u.ReduceTimerCache,this.lookupTableCache=new Map,this.throttling=new h.ExecutionWithThrottling,this.lastTileRefreshSeq=-1,this.lastTileRefreshSeqByDocSessionId=new Map,this.tileRefreshByDocSessionIdEnabled=!0}return e.prototype.init=function(e,t,o){var n=this,r=new s.Operation({operationName:"InitRuntimeALv1",resourceId:e});r.start(),this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=(0,a.getVersion)()),this.hostCallbacks=o;var i=[];return i.push(this.isFeatureEnabled("DisableWebSocket").then((function(o){if(!!o)return!1;return!(["Outlook Mac","Outlook Win32","PowerPoint Mac","PowerPoint Web","PowerPoint Win32","Word Mac","Word Win32"].indexOf("".concat(t.appName," ").concat(t.appPlatform))>=0)||p.testWebSocketConnection(a.Utils.convertServiceUrlToWebSocket(e),n.clientMetadata)})).then((function(t){e&&(n.serviceUrl=t?a.Utils.convertServiceUrlToWebSocket(e):e,n.executeRemoteLambda=t?p.executeRemoteLambda:l.executeRemoteLambda,n.clearRemoteLambdaTokenCache=t?p.clearTokenCache:l.clearTokenCache,n.serviceProtocol=n.serviceUrl.split(":")[0].toLowerCase())}))),i.push(this.isFeatureEnabled("WorkflowQueuesDisabled").then((function(e){g.executionQueuesEnabled=!e}))),i.push(this.isFeatureEnabled("TileRefreshByDocSessionIdDisabled").then((function(e){n.tileRefreshByDocSessionIdEnabled=!e}))),Promise.all(i).then((function(){n.logOperation(r,!0)})).catch((function(e){n.logOperation(r,!1,"Error",e?e.message:"(no error)")}))},e.prototype.getServiceProtocol=function(){return this.serviceProtocol},e.prototype.registerSchemas=function(e,t){return Promise.resolve()},e.prototype.registerSimpleLocalWorkflow=function(e,t,o){return void 0===o&&(o=this.defaultWorkflowOptions),t.source=t.source||d.LambdaSource.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToWorkflows,o)},e.prototype.registerSimpleRemoteWorkflow=function(e,t,o,n,r){void 0===r&&(r=this.defaultWorkflowOptions);var i=[];return t&&(t.source=d.LambdaSource.Custom,i.push(t)),o.source=o.func?d.LambdaSource.Custom:d.LambdaSource.Remote,i.push(o),n&&(n.source=d.LambdaSource.Custom,i.push(n)),this.registerHardcodedWorkflow(e,i,this.inputSchemasToWorkflows,r)},e.prototype.registerMultipleLambdasWorkflow=function(e,t,o){return void 0===o&&(o=this.defaultWorkflowOptions),this.registerHardcodedWorkflow(e,t,this.inputSchemasToWorkflows,o)},e.prototype.registerReduceWorkflow=function(e,t,o,n,r){return void 0===n&&(n=10),void 0===r&&(r=this.defaultWorkflowOptions),this.reduceWorkflowsGroupingKeyExtractors.set(t.inputSchema,o),this.resultCache.setBucketSize(t.inputSchema,n),t.source=t.source||d.LambdaSource.Custom,this.registerHardcodedWorkflow(e,[t],this.inputSchemasToReduceWorkflows,r)},e.prototype.registerMultipleLambdasReduceWorkflow=function(e,t,o,n,r){return void 0===n&&(n=10),void 0===r&&(r=this.defaultWorkflowOptions),this.reduceWorkflowsGroupingKeyExtractors.set(t[0].inputSchema,o),this.resultCache.setBucketSize(t[0].inputSchema,n),this.registerHardcodedWorkflow(e,t,this.inputSchemasToReduceWorkflows,r)},e.prototype.submit=function(e,t,o){this.submitToWorkflows(e,t,o,this.inputSchemasToWorkflows)},e.prototype.getGroupingKey=function(e,t,o){var n=this.reduceWorkflowsGroupingKeyExtractors.get(o);if(null==n)throw new Error("Reduce workflow does not have a grouping extractor");return n(t,e)},e.prototype.submitToWorkflows=function(e,t,o,n){if(void 0===n&&(n=this.inputSchemasToWorkflows),this.hostCallbacks){var r;r=o?s.CorrelationVector.fromString(o):new s.CorrelationVector,this.handleTileRefresh(e,t,r);for(var i,a=0,c=n.get(e)||[];a<c.length;a++){var u=c[a];T(e,t)&&!u.triggerOnRefresh||(u.useCanaryTextTile&&e===y&&!u.canaryTextTileEventSubmittedByDocSessionId.has(S(e,t))&&(this.submitToWorkflow(y,{type:(i=t).type,tile:{metadata:{docSessionId:i.tile.metadata.docSessionId,docId:i.tile.metadata.docId,seqnoCLPRefresh:i.tile.metadata.seqnoCLPRefresh,tileId:"A56B3127DBDFD0D6"},elements:[{text:"B91153AE828B4E48"}]}},r,u,n),u.canaryTextTileEventSubmittedByDocSessionId.add(S(e,t))),this.submitToWorkflow(e,t,r,u,n))}}},e.prototype.submitToWorkflow=function(e,t,n,r,i){var a=this,u={messageType:c.MessageType.Input,correlationVector:n.newChild(),payload:t,payloadSchema:(0,o.getTypeFromSchema)(r.lambdas[0].inputSchema),clientMetadata:this.clientMetadata},l=new s.Operation({cv:u.correlationVector.toString(),operationName:"ExecuteWorkflow",resourceId:r.name});l.start(),r.scheduleExecution(t,(function(){try{if(u.payload&&u.payload.tile&&u.payload.tile.metadata&&u.payload.tile.metadata.tileId){var o=u.payload.tile.metadata.tileId;a.throttling.execute(o,r,(function(){return a.executeWorkflow(l,u,t,r,e,i)}))}else a.executeWorkflow(l,u,t,r,e,i)}catch(e){l.success=!1,l.resultSignature="ExecuteException",l.resultDescription=e?e.message:"(no error)",s.Log.error(559290447,s.LogCategory.CoreDefault,l.stop())}}))},e.prototype.handleTileRefresh=function(e,t,o){var n=this;if(T(e,t)){var r=this.tileRefreshByDocSessionIdEnabled?S(e,t):void 0,i=function(e,t){var o,n;return m(e,t)?null===(n=null===(o=t.tile)||void 0===o?void 0:o.metadata)||void 0===n?void 0:n.seqnoCLPRefresh:(v(e,t),-1)}(e,t);if(this.tileRefreshByDocSessionIdEnabled){var a=this.lastTileRefreshSeqByDocSessionId.get(r);if(a>=0&&i<=a)return}else if(i<=this.lastTileRefreshSeq)return;var c=new s.Operation({cv:o.toString(),operationName:"TileRefresh",resultDescription:"",success:!0});if(c.start(),this.tileRefreshByDocSessionIdEnabled&&!r)return c.success=!1,c.resultDescription="NoDocSessionId",void s.Log.info(559290448,s.LogCategory.CoreDefault,c.stop());this.inputSchemasToReduceWorkflows.forEach((function(e,t){e.some((function(e){return e.triggerOnRefresh}))&&(n.tileRefreshByDocSessionIdEnabled?(n.resultCache.clear(t,{primary:r}),n.resultCache.clear(n.getForcedDocLevelSchema(t),{primary:r}),n.reduceTimerCache.clear(t,r)):(n.resultCache.clear(t),n.resultCache.clear(n.getForcedDocLevelSchema(t)),n.reduceTimerCache.clear(t)),e.some((function(e){return!e.triggerOnRefresh}))&&(c.resultDescription+="X_"),c.resultDescription+=t+" ")})),this.clearRemoteLambdaTokenCache();var u=[];this.inputSchemasToWorkflows.forEach((function(e){return u.push.apply(u,e)})),this.inputSchemasToReduceWorkflows.forEach((function(e){return u.push.apply(u,e)}));for(var l=0,p=u;l<p.length;l++){var f=p[l];this.tileRefreshByDocSessionIdEnabled?f.onRefresh(r):f.onRefresh()}this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.set(r,i):this.lastTileRefreshSeq=i,s.Log.info(559290449,s.LogCategory.CoreDefault,c.stop())}},e.prototype.executeWorkflow=function(e,t,o,n,r,a){var u=this,l=n.docIdExtractor?n.docIdExtractor(t.payload):void 0,p=n.docSessionIdExtractor(o),f=this.tileRefreshByDocSessionIdEnabled?this.lastTileRefreshSeqByDocSessionId.get(p):this.lastTileRefreshSeq;n.onStart(p);var d=function(t){var l=u.tileRefreshByDocSessionIdEnabled?u.lastTileRefreshSeqByDocSessionId.get(p):u.lastTileRefreshSeq;if(n.triggerOnRefresh&&l!==f)return e.success=!0,e.resultSignature="TileRefreshIgnore",void s.Log.info(559290450,s.LogCategory.CoreDefault,e.stop());var d=t.messageType==c.MessageType.Exception&&t.payload.exceptionType==c.ExceptionType.NoOutput,h=d&&n.canProduceNullResult,g=h?n.lambdas[n.lambdas.length-1].outputSchema:t.payloadSchema.schema.name,y=h?null:t.payload;t.messageType===c.MessageType.Input||h?(n.shouldSendResultsToHost&&(a===u.inputSchemasToReduceWorkflows?u.hostCallbacks.onResult("Reduce.Input",o,g,y):u.hostCallbacks.onResult(r,o,g,y)),e.success=!0,e.resultSignature=d?"NoOutput":"ValidOutput"):d?(e.success=!0,e.resultSignature="NoOutput"):(e.success=!1,e.resultSignature="Exception",e.resultDescription=(0,i.getMessageExceptionDescription)(t)),a!==u.inputSchemasToReduceWorkflows&&u.updateResultCacheForReduceWorkflows(r,o,g,y,t.correlationVector.toString()),t.moreResults||(e.stop(),s.Log.info(559290451,s.LogCategory.CoreDefault,e),n.onFinish(p,t.payload&&t.payload.exceptionType?(0,i.getMessageExceptionType)(t):void 0))};n.preExecutionPromise.then((function(){for(var e={lookupTable:u.lookupTableCache.get(n.name),docId:l,docSessionId:p},o=d,r=n.lambdas.length-1;r>=0;r--)o=u.createLambdaExecutionStep(n.name,n.lambdas[r],e,o,d);o(t)}))},e.prototype.getForcedDocLevelSchema=function(e){return"~".concat(e)},e.prototype.updateResultCacheForReduceWorkflows=function(e,t,o,n,r){var i=this,a=this.inputSchemasToReduceWorkflows.get(o);if(a){var u;"docSessionId"===e?(u=this.getGroupingKey(e,t,o),this.resultCache.setResult(this.getForcedDocLevelSchema(o),u,n),u.secondary="*"):(u=this.getGroupingKey(e,t,o),!function(e,t){return e===y&&t&&t.type==c.Tiling.TextTileEventType.Delete||"ClpSlideTile"===e&&t&&t.eventType==c.Ppt.SlideTileEventType.Delete}(e,t)||null==u.primary||null==u.secondary?this.resultCache.setResult(o,u,n):this.resultCache.clear(void 0,u));var l=a.some((function(e){return e.deferReduceUntilIdle})),p=[];this.inputSchemasToWorkflows.forEach((function(e){return p.push.apply(p,e.filter((function(e){return e.getOutputSchema()===o})))}));var f=a.map((function(e){return e.deferReduceUntilIdleMaxDelayMs||0})).reduce((function(e,t){return Math.max(e,t)}));this.reduceTimerCache.setReduceTimer(o,u.primary,(function(){var e=i.resultCache.getResults(o,u);if(e.push.apply(e,i.resultCache.getResults(i.getForcedDocLevelSchema(o),{primary:u.primary})),Array.isArray(e)){var t={id:u.primary,values:e,isReduceInput:!0};i.submitToWorkflows(o,t,r,i.inputSchemasToReduceWorkflows)}else s.Log.error(559290452,s.LogCategory.CoreDefault,'Cached results have unexpected type "'.concat(typeof e,'"'))}),500,(function(){return l&&p.some((function(e){return e.executionCountByDocSessionId.get(u.primary)>0}))}),f)}},e.prototype.isFeatureEnabled=function(e,t,o){return void 0===t&&(t=!1),void 0===o&&(o="None"),this.hostCallbacks&&this.hostCallbacks.isFeatureEnabled?this.hostCallbacks.isFeatureEnabled("Microsoft.Office.AugLoop."+e,o).catch((function(){return Promise.resolve(t)})):Promise.resolve(t)},e.prototype.areLicenseFeaturesEnabled=function(e){return this.hostCallbacks&&this.hostCallbacks.areLicenseFeaturesEnabled?this.hostCallbacks.areLicenseFeaturesEnabled(e).catch((function(){return Promise.resolve(!1)})):Promise.resolve(!1)},e.prototype.isWorkflowEnabled=function(e,t,o,n,r){var i=this;if(t.some((function(e){return e.source===d.LambdaSource.Remote||e.source===d.LambdaSource.BatchedRemote}))){if(!this.serviceUrl)return r.resultDescription="Disabled because no service URL available for remote workflow",Promise.resolve(!1);if(this.clientMetadata&&this.clientMetadata.privateMode&&t.some((function(e){return(e.source===d.LambdaSource.Remote||e.source===d.LambdaSource.BatchedRemote)&&!e.canRunInPrivateMode})))return r.resultDescription="Disabled because we are running in private mode",Promise.resolve(!1)}return(!this.clientMetadata||"Mac"!==this.clientMetadata.appPlatform&&"Win32"!==this.clientMetadata.appPlatform)&&(n=!0,r.resultDescription="Enabled by default due to platform name"),(n?Promise.resolve(!0):this.isFeatureEnabled("WorkflowEnabled."+e)).then((function(t){return t?i.isFeatureEnabled("WorkflowDisabled."+e).then((function(e){return e?(r.resultDescription="Disabled because explicitly disabled",!1):!o||i.areLicenseFeaturesEnabled(o).then((function(e){return e||(r.resultDescription="Disabled because license check failed"),e}))})):(r.resultDescription="Disabled because not explicitly enabled",!1)}))},e.prototype.registerHardcodedWorkflow=function(e,t,n,r){var i=this;if(void 0===n&&(n=this.inputSchemasToWorkflows),!e||e.length>40)throw new Error("Workflow name has invalid length");if(!1===new RegExp(/^[A-Z][a-zA-Z0-9_]+$/).test(e))throw new Error("Workflow name has invalid format");n.forEach((function(t){if(t.some((function(t){return t.name===e})))throw new Error("Workflow name already registered.")}));var a=new s.Operation({operationName:"WorkflowRegistration",resourceId:e,success:!0});return a.setClientMetadata(this.clientMetadata),a.start(),this.isWorkflowEnabled(e,t,r.licenseFeatures,r.enabledByDefault,a).then((function(u){if(a.resultSignature=u?"Enabled":"Disabled",a.stop(),s.Log.info(559290453,s.LogCategory.CoreDefault,a),u){var l=t[0].inputSchema,p=n.get(l);p||(p=[],n.set(l,p));var f=Promise.resolve();r.lookupTableLambda&&(f=new Promise((function(t,n){var a=new s.CorrelationVector,u={messageType:c.MessageType.Input,correlationVector:a,payloadSchema:(0,o.getTypeFromSchema)(r.lookupTableLambda.inputSchema),clientMetadata:i.clientMetadata,payload:{}},l=function(o){o.messageType===c.MessageType.Input&&o.payload&&i.lookupTableCache.set(e,o.payload),t()};i.createLambdaExecutionStep("",r.lookupTableLambda,{},l,l)(u)})));var d=new g;d.name=e,d.lambdas=t,d.canProduceNullResult=r.canProduceNullResult,d.shouldSendResultsToHost=r.shouldSendResultsToHost,d.triggerOnRefresh=r.triggerOnRefresh,d.throttleSettings=r.throttleSettings||i.defaultWorkflowOptions.throttleSettings,d.docIdExtractor=r.docIdExtractor,d.docSessionIdExtractor=function(e){return e.isReduceInput?e.id:S(l,e)},d.deferReduceUntilIdle=r.deferReduceUntilIdle,d.deferReduceUntilIdleMaxDelayMs=r.deferReduceUntilIdleMaxDelayMs,d.useCanaryTextTile=r.useCanaryTextTile,d.preExecutionPromise=f,p.push(d)}}))},e.prototype.logOperation=function(e,t,o,n){e.stop(),e.success=t,e.resultSignature=o,e.resultDescription=n,s.Log.info(559290454,s.LogCategory.CoreDefault,e)},e.prototype.handleLambdaError=function(e,t,o,n,r){null!=e.exceptionType?(0,i.setMessageException)(t,e):e instanceof Error?(0,i.setMessageException)(t,{exceptionType:n,message:e.message}):(0,i.setMessageException)(t,{exceptionType:c.ExceptionType.Unknown,message:e?e.toString():void 0}),this.logOperation(o,!1,"Exception",(0,i.getMessageExceptionDescription)(t)),r(t)},e.prototype.handleLambdaOutput=function(e,t,n,r,s,a){e&&e.exceptionType!==c.ExceptionType.NoOutput?null!=e.exceptionType?this.handleLambdaError(e,t,n,e.exceptionType,a):e instanceof Error?this.handleLambdaError(e,t,n,c.ExceptionType.LambdaErrorCallback,a):(t.payload=e,t.payloadSchema=(0,o.getTypeFromSchema)(r),this.logOperation(n,!0),s(t)):((0,i.setMessageException)(t,{exceptionType:c.ExceptionType.NoOutput}),this.logOperation(n,!0,"NoOutput"),a(t))},e.prototype.executeCustomLambdaStep=function(e,t,o,n,r,s){var a=this;if(null==o.func)(0,i.setMessageException)(e,{exceptionType:c.ExceptionType.LambdaThrow,message:"No lambda function set"}),this.logOperation(t,!1,"Error",(0,i.getMessageExceptionDescription)(e)),s(e);else{try{o.func(e.payload,o.config,n,(function(n){a.handleLambdaOutput(n,e,t,o.outputSchema,r,s)}),(function(o,n){a.handleLambdaOutput(o,e,t,n,s,s)}))}catch(o){this.handleLambdaError(o,e,t,c.ExceptionType.LambdaThrow,s)}}},e.prototype.executeLocalLambdaStep=function(e,t,o,n,r){var s=this;null==this.hostCallbacks.executeLocalLambda?((0,i.setMessageException)(e,{exceptionType:c.ExceptionType.LambdaThrow,message:"No local lambda host callback set"}),this.logOperation(t,!1,"Error",(0,i.getMessageExceptionDescription)(e)),r(e)):this.hostCallbacks.executeLocalLambda(o.inputSchema,e.payload,o.outputSchema).then((function(i){s.handleLambdaOutput(i,e,t,o.outputSchema,n,r)})).catch((function(o){s.handleLambdaError(o,e,t,c.ExceptionType.LambdaThrow,r)}))},e.prototype.executeRemoteLambdaStep=function(e,t,n,r,s,u){var l=this;if(this.serviceUrl){t.resourceId+=".".concat(this.serviceProtocol);var p=function(o,r){o?l.handleLambdaError(o,e,t,o.exceptionType||c.ExceptionType.LambdaErrorCallback,u):l.handleLambdaOutput(r,e,t,n.outputSchema,s,u)};if(r.authTickets=n.authTickets,n.source===d.LambdaSource.Remote)this.executeRemoteLambda(this.serviceUrl,e,(0,o.getTypeFromSchema)(n.inputSchema),(0,o.getTypeFromSchema)(n.outputSchema),e.correlationVector,this.clientMetadata,this.hostCallbacks,r,p);else{this.batchedRemoteLambdaManager||(this.batchedRemoteLambdaManager=new a.BatchManager((function(e,t,n){var r=t.context,i=r.remoteLambda,s=r.lambdaContext;l.executeRemoteLambda(l.serviceUrl,{messageType:c.MessageType.Input,correlationVector:{id:t.cv},payload:e,payloadSchema:(0,o.getTypeFromSchema)(i.inputSchema),clientMetadata:l.clientMetadata},(0,o.getTypeFromSchema)(i.remoteInputSchema),(0,o.getTypeFromSchema)(i.remoteOutputSchema),{id:t.cv},l.clientMetadata,l.hostCallbacks,s,n)}),(function(e,t,o){var n,r=o.lambdaContext;l.updateResultCacheForReduceWorkflows("docSessionId",null!==(n=r.docSessionId)&&void 0!==n?n:r.docId,e,t)})));var f=n.batchOptions,h=this.normalizeBatchOptions(f),g=h.groupingKeyExtractor;h.groupingKeyExtractor=function(e){return"".concat(n.name,"-").concat(g(e))};var y={name:n.name,remoteLambda:n,lambdaContext:r};this.batchedRemoteLambdaManager.addBatchItem(e.payload,h,y,e.correlationVector.id.length>127?e.correlationVector.id.substring(0,127)+"!":e.correlationVector.id,void 0,p)}}else(0,i.setMessageException)(e,{exceptionType:c.ExceptionType.LambdaThrow,message:"No URL for remote lambda"}),this.logOperation(t,!1,"Error",(0,i.getMessageExceptionDescription)(e)),u(e)},e.prototype.createLambdaExecutionStep=function(e,t,o,n,r){var a=this;return function(u){var l=new s.Operation({cv:u.correlationVector.toString(),operationName:"ExecuteLambda",resourceId:t.name,dimension0:e});l.start(),t.source===d.LambdaSource.Custom?a.executeCustomLambdaStep(u,l,t,o,n,r):t.source===d.LambdaSource.Local?a.executeLocalLambdaStep(u,l,t,n,r):t.source===d.LambdaSource.Remote||t.source===d.LambdaSource.BatchedRemote?a.executeRemoteLambdaStep(u,l,t,o,n,r):((0,i.setMessageException)(u,{exceptionType:c.ExceptionType.LambdaThrow,message:"Unknown/No lambda location set"}),a.logOperation(l,!1,"Error",(0,i.getMessageExceptionDescription)(u)),r(u))}},e.prototype.normalizeBatchOptions=function(e){if(!e)throw new Error("Expected batchConfig");var t=n({},e);return e.estimateSize||(t.estimateSize=a.estimateSize),t},e}();o.ClientRuntimeALv1=w,o.runtimeALv1=new w},{1:1,10:10,31:31,4:4,5:5,6:6,64:64,7:7,9:9,90:90}],9:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.LambdaSource=void 0,function(e){e[e.Unknown=0]="Unknown",e[e.Local=1]="Local",e[e.Custom=2]="Custom",e[e.Remote=3]="Remote",e[e.BatchedRemote=4]="BatchedRemote"}(o.LambdaSource||(o.LambdaSource={}))},{}],10:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ExecutionWithThrottling=void 0;var n=e(64),r=function(){function e(){this.throttleInfoMap=new Map}return e.prototype.execute=function(e,t,o){var r=this;if(t.throttleSettings.shouldBeThrottled&&t.throttleSettings.throttlingInterval>0){var i=this.getWorkflowThrottleInfo(t.name);if(null==i.currentTileId)i.currentTileId=e,i.timeOfPreviousStartedEvent=n.Utils.getCurrentTimeMs(),o();else if(i.currentTileId===e){var s=n.Utils.getCurrentTimeMs(),a=this.delayTime(i,s,t.throttleSettings.throttlingInterval);a>0?(i.latestCallback=o,null==i.lastTimeout&&(i.lastTimeout=setTimeout((function(){var e=r.getWorkflowThrottleInfo(t.name);e.lastTimeout=void 0,e.timeOfPreviousStartedEvent=n.Utils.getCurrentTimeMs(),e.latestCallback()}),a))):(i.timeOfPreviousStartedEvent=s,o())}else null!=i.lastTimeout&&(clearTimeout(i.lastTimeout),i.latestCallback(),i.lastTimeout=void 0),i.currentTileId=e,i.timeOfPreviousStartedEvent=n.Utils.getCurrentTimeMs(),o()}else o()},e.prototype.delayTime=function(e,t,o){var n=t-e.timeOfPreviousStartedEvent;return Math.max(o-n,0)},e.prototype.getWorkflowThrottleInfo=function(e){var t=this.throttleInfoMap.get(e);return t||(t={currentTileId:void 0,timeOfPreviousStartedEvent:-1,latestCallback:function(){},lastTimeout:void 0},this.throttleInfoMap.set(e,t)),t},e}();o.ExecutionWithThrottling=r},{64:64}],11:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.WebSocketRequestManager=void 0;var n=e(31),r=e(64),i=function(){function e(e,t,o,n,r,i){this.requestId=e,this.correlationId=t,this.schemaName=o,this.data=n,this.callback=r,this.requestTimeoutInMs=i,this.ended=!1,this.startTime=0}return e.prototype.startRequest=function(){this.startTime=r.Utils.getCurrentTimeMs()},e.prototype.getMsUntilTimeout=function(){var e=r.Utils.getCurrentTimeMs()-this.startTime;return this.requestTimeoutInMs-e},e.prototype.endRequest=function(e){this.ended||(this.invokeCallback(null,e,!0),this.ended=!0)},e.prototype.addResponseData=function(e){this.invokeCallback(e,null,!1)},e.prototype.invokeCallback=function(e,t,o){var n=this;new Promise((function(){return n.callback(e,t,o)})).catch((function(e){}))},e}(),s=function(){function e(e,t,o){this.requestCounter=0,this.activeRequests=[],this.pendingRequests=[],this.requestTimeoutInMs=e,this.workerFactory=t,this.maxActiveRequests=o}return e.prototype.testConnection=function(e,t){var o=this,i=!1,s=new n.Operation({cv:(new n.CorrelationVector).toString(),operationName:"WebSocketTest",resourceId:e,success:!0}).start();return new Promise((function(a){var c=r.Utils.createHealthCheckRequest(t);e?o.addRequest(e,c,s.cv,"HealthCheckRequest",(function(e,t,o){t&&(s.success=!1,s.resultSignature="Error",s.resultDescription=t.message||t),e&&"OK"===e.status&&(i=!0),o&&(s.success&&!i&&(s.success=!1,s.resultSignature="NoResponseData"),n.Log.info(556617949,n.LogCategory.CoreDefault,s.stop()),a(s.success))})):(s.success=!1,s.resultSignature="EmptyUrl",n.Log.info(557641870,n.LogCategory.CoreDefault,s.stop()),a(s.success))}))},e.prototype.addRequest=function(e,t,o,n,r){var s=(this.requestCounter++).toString(),a=new i(s,o,n,t,r,this.requestTimeoutInMs);this.getWorker(e),this.pendingRequests.push(a),this.egressPendingRequests()},e.prototype.egressPendingRequests=function(){for(;this.pendingRequests.length>0&&this.activeRequests.length<this.maxActiveRequests;){var e=this.pendingRequests.shift();if(this.activeRequests.push(e),1===this.activeRequests.length){var t=e.getMsUntilTimeout();setTimeout(this.onTimeout.bind(this),t)}e.startRequest(),this.worker&&this.worker.egress(this.createRequestMessage(e.data,e.requestId,e.correlationId))}},e.prototype.createRequestMessage=function(e,t,o){return JSON.stringify({correlationId:o,requestId:t,body:e})},e.prototype.onTimeout=function(){for(;this.activeRequests.length>0;){var e=this.activeRequests[0],t=e.getMsUntilTimeout();if(!(t<=0))return void setTimeout(this.onTimeout.bind(this),t);var o=new Error("Request timed out");e.endRequest(o),this.activeRequests.shift(),this.egressPendingRequests()}},e.prototype.onMessage=function(e){try{for(var t=JSON.parse(e),o=0;o<this.activeRequests.length;o++){var r=this.activeRequests[o];if(r.requestId===t.requestId){t.end?(this.activeRequests.splice(o,1),r.endRequest(t.error),this.egressPendingRequests()):t.body&&r.addResponseData(t.body);break}}}catch(e){n.Log.error(557641871,n.LogCategory.CoreDefault,e)}},e.prototype.onClose=function(e){for(var t=new Error("Connection closed: ".concat(e)),o=0,n=this.activeRequests;o<n.length;o++){n[o].endRequest(t)}this.activeRequests=[];for(var r=0,i=this.pendingRequests;r<i.length;r++){i[r].endRequest(t)}this.pendingRequests=[],this.worker=void 0},e.prototype.getWorker=function(e){return this.worker||(this.worker=this.workerFactory(),this.worker.init(e,this.onMessage.bind(this),(function(){}),this.onClose.bind(this))),this.worker},e}();o.WebSocketRequestManager=s},{31:31,64:64}],12:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.BufferingSequencer=void 0;var n=e(31),r=function(){function e(e,t){void 0===e&&(e=500),void 0===t&&(t=!1),this.prevSeq=-1,this.bufferingTimeMs=e,this.rejectOutdatedSequenceNumbers=t}return e.prototype.sequence=function(t){var o=this;return new Promise((function(r,i){if(t<o.prevSeq){if(o.rejectOutdatedSequenceNumbers){var s=new Error("BufferingSequencer: Item out of order. Expecting seqId > ".concat(o.prevSeq,". Actual seqId ").concat(t));return s.name=e.Rejected,void i(s)}o.prevSeq=-1}t!=o.prevSeq+1&&n.Log.warn(542712385,n.LogCategory.CoreDefault,"BufferingSequencer: got out of order sequence number. Got ".concat(t,", expected ").concat(o.prevSeq+1));var a={seq:t,resolve:r};o.insertItem(a),o.runInOrder(a,!0,!1)}))},e.prototype.insertItem=function(e){if(!this.firstQueueItem)return this.firstQueueItem=e,void(this.lastQueueItem=e);var t=this.lastQueueItem,o=null;do{if(e.seq>t.seq)return e.prev=t,t.next=e,void(o?o.prev=e:this.lastQueueItem=e);o=t,t=t.prev}while(t);o&&(o.prev=e),e.next=o,this.firstQueueItem=e},e.prototype.runInOrder=function(e,t,o){for(var n=this,r=this.prevSeq,i=!1,s=[];this.firstQueueItem;){var a=this.firstQueueItem;if(r+1!=a.seq&&(!o||a.seq>e.seq))break;r=a.seq,a.timeout&&clearTimeout(a.timeout),s.push(a),e==a&&(i=!0),this.firstQueueItem=this.firstQueueItem.next,this.firstQueueItem&&(this.firstQueueItem.prev=null)}s.length>0&&setTimeout((function(){for(var e=0,t=s;e<t.length;e++){var o=t[e];o.resolve(o.seq)}}),0),this.prevSeq=r,!i&&t&&(e.timeout=setTimeout((function(){n.runInOrder(e,!1,!0)}),this.bufferingTimeMs))},e.Rejected="SequenceItemRejected",e}();o.BufferingSequencer=r},{31:31}],13:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(12),o)},{12:12}],14:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(15),o)},{15:15}],15:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ObserverStatusAnnotation=o.ExcelSessionCloseReason=o.ExcelKeepAlive=o.ExcelAccessTokenRefreshed=o.ExcelWorkbookUpdated=o.ExcelServerSessionExtensionConfig=o.ExcelServerSessionInitMessage=void 0;var n=e(114),r=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelServerSessionInitMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ExcelServerSessionInitMessage=r;var i=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelServerSessionExtensionConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ExcelServerSessionExtensionConfig=i;var s=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelWorkbookUpdated"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ExcelWorkbookUpdated=s;var a=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelAccessTokenRefreshed"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ExcelAccessTokenRefreshed=a;var c=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelKeepAlive"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ExcelKeepAlive=c;var u=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelSessionCloseReason"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ExcelSessionCloseReason=u;var l=function(){function e(t){n.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ObserverStatusAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ObserverStatusAnnotation=l},{114:114}],16:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.OAuth2AppScope=o.OAuth2GrantFlow=o.UserType=o.AuthTokenType=void 0,function(e){e[e.EditorLowPrivilege=0]="EditorLowPrivilege",e[e.AugLoopLowPrivilege=1]="AugLoopLowPrivilege",e[e.Anonymous=2]="Anonymous",e[e.ClientAssertion=3]="ClientAssertion",e[e.ClientAssertionV2=4]="ClientAssertionV2",e[e.AutoClpLowPrivilege=5]="AutoClpLowPrivilege",e[e.AutoClpAppOnlyLowPrivilege=6]="AutoClpAppOnlyLowPrivilege",e[e.Substrate=7]="Substrate",e[e.WacUserInfo=8]="WacUserInfo",e[e.OwaExchange=9]="OwaExchange",e[e.SmartCompose=10]="SmartCompose",e[e.WritingAnalyticsLowPrivilege=11]="WritingAnalyticsLowPrivilege",e[e.DWEngineLowPrivilege=12]="DWEngineLowPrivilege",e[e.SubstrateApp=13]="SubstrateApp",e[e.CortanaAppPop=14]="CortanaAppPop",e[e.OfficeAppsAppOnly=15]="OfficeAppsAppOnly",e[e.PPTFrontdoorAppPop=16]="PPTFrontdoorAppPop",e[e.EditorAppOnlyLowPrivilege=17]="EditorAppOnlyLowPrivilege",e[e.AugLoopApp=18]="AugLoopApp",e[e.MeetingIntelligenceApp=19]="MeetingIntelligenceApp",e[e.GraphApp=20]="GraphApp",e[e.IceServicesApp=21]="IceServicesApp",e[e.AzureMapsApp=22]="AzureMapsApp",e[e.SpoApp=23]="SpoApp",e[e.OneDrive=24]="OneDrive",e[e.GoogleDrive=25]="GoogleDrive",e[e.GettyApp=26]="GettyApp"}(o.AuthTokenType||(o.AuthTokenType={})),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(o.UserType||(o.UserType={})),function(e){e.AuthorizationCode="authorization_code",e.ClientCredentials="client_credentials"}(o.OAuth2GrantFlow||(o.OAuth2GrantFlow={})),function(e){e[e.DesignerApp=0]="DesignerApp"}(o.OAuth2AppScope||(o.OAuth2AppScope={}))},{}],17:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(16),o),r(e(18),o),r(e(19),o),r(e(20),o),r(e(21),o),r(e(22),o),r(e(23),o),r(e(24),o),r(e(25),o),r(e(26),o)},{16:16,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26}],18:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],19:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.stringifyReplacer=o.LoggingLevel=void 0,function(e){e[e.error=0]="error",e[e.warn=1]="warn",e[e.info=3]="info",e[e.metric=4]="metric",e[e.verbose=5]="verbose",e[e.debug=6]="debug"}(o.LoggingLevel||(o.LoggingLevel={}));o.stringifyReplacer=function(e,t){return"object"==typeof t&&0==Object.keys(t).length?void 0:t}},{}],20:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.isExceptionMessage=void 0;var n=e(90);o.isExceptionMessage=function(e){return null==e||null==e.messageType||e.messageType==n.MessageType.Exception}},{90:90}],21:[function(e,t,o){"use strict";var n=e("extendsHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.ExpectedError=void 0;var r=function(e){function t(o){void 0===o&&(o="ExpectedError");var n=e.call(this,o)||this;return n.__proto__=t.prototype,n}return n(t,e),t}(Error);o.ExpectedError=r},{}],22:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.gatewayType=void 0,o.gatewayType="Gateway"},{}],23:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],24:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.WorkflowKind=void 0,function(e){e[e.SingleItem=0]="SingleItem",e[e.Reduce=1]="Reduce",e[e.Grid=2]="Grid",e[e.DynamicText=3]="DynamicText",e[e.Join=4]="Join",e[e.Generic=5]="Generic"}(o.WorkflowKind||(o.WorkflowKind={}))},{}],25:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],26:[function(e,t,o){"use strict";var n=e("extendsHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.CoherencyError=o.GridRangeFilterCondition=void 0,function(e){e[e.None=0]="None",e[e.NotPartOfTables=1]="NotPartOfTables"}(o.GridRangeFilterCondition||(o.GridRangeFilterCondition={}));var r=function(e){function t(o){void 0===o&&(o="CoherencyError");var n=e.call(this,o)||this;return n.__proto__=t.prototype,n}return n(t,e),t}(Error);o.CoherencyError=r},{}],27:[function(e,t,o){"use strict";var n;Object.defineProperty(o,"__esModule",{value:!0}),o.AugLoopTextDecoder=o.AugLoopTextEncoder=void 0;o.AugLoopTextEncoder=(n=function(){if("undefined"==typeof TextEncoder){e(147);var t={AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder};return TextEncoder=void 0,TextDecoder=void 0,t}return{AugLoopTextEncoder:TextEncoder,AugLoopTextDecoder:TextDecoder}}()).AugLoopTextEncoder,o.AugLoopTextDecoder=n.AugLoopTextDecoder},{147:147}],28:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(29),o)},{29:29}],29:[function(e,t,o){"use strict";var n=e("valuesHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.JSOND=void 0;var r=e(27),i=function(){function e(){}return e.deserialize=function(t,o){if(void 0===o&&(o=function(e){return e}),t[0]!==e.IDENTIFIERBYTE)throw"Invalid Binary: Incorrect Identifier";for(var n=1,r=[],i=new DataView(t.buffer,t.byteOffset,t.byteLength);n<t.byteLength;){if(n+4>t.byteLength)throw"Invalid Binary: Error reading fragment length";var s=i.getUint32(n);if(n+s+4>t.byteLength)throw"Invalid Binary: Fragment out of range";"undefined"!=typeof Buffer&&Buffer.from?r.push(Buffer.from(t.buffer,t.byteOffset+n+4,s)):r.push(new Uint8Array(t.buffer,t.byteOffset+n+4,s)),n+=4+s}if(r.length<1)throw"Invalid Binary: No fragments found";var a=e.textDecoder.decode(r[0]);return JSON.parse(a,(function(t,n){if("string"==typeof n){if(n.substring(0,e.BINARYKEYWORD.length)===e.BINARYKEYWORD){var i=parseInt(n.substring(e.BINARYKEYWORD.length),10);if("number"!=typeof i||i>=r.length-1)throw"Invalid Binary: Binary index out of range";return o(r[i+1])}if(n.substring(0,e.ESCAPEKEYWORD.length)===e.ESCAPEKEYWORD)return n.substring(e.ESCAPEKEYWORD.length)}return n}))},e.serialize=function(t){var o,r,i=[void 0],s=JSON.stringify(t,(function(t,o){return ArrayBuffer.isView(o)?(i.push(o),"".concat(e.BINARYKEYWORD).concat(i.length-2)):o&&"Buffer"===o.type&&Array.isArray(o.data)?(i.push(new Uint8Array(o.data)),"".concat(e.BINARYKEYWORD).concat(i.length-2)):"string"==typeof o&&o.substring(0,e.ESCAPEKEYWORD.length)===e.ESCAPEKEYWORD?e.ESCAPEKEYWORD+o:o}));i[0]=e.textEncoder.encode(s);var a=i.reduce((function(e,t){return e+4+t.byteLength}),0),c=new Uint8Array(a+1);c[0]=e.IDENTIFIERBYTE;var u=1,l=new DataView(c.buffer,c.byteOffset,c.byteLength);try{for(var p=n(i),f=p.next();!f.done;f=p.next()){var d=f.value;l.setUint32(u,d.byteLength),c.set(d,u+4),u+=4+d.byteLength}}catch(e){o={error:e}}finally{try{f&&!f.done&&(r=p.return)&&r.call(p)}finally{if(o)throw o.error}}return c},e.IDENTIFIERBYTE=3,e.BINARYKEYWORD=":b",e.ESCAPEKEYWORD=":",e.textDecoder=new r.AugLoopTextDecoder,e.textEncoder=new r.AugLoopTextEncoder,e}();o.JSOND=i},{27:27}],30:[function(e,t,o){"use strict";var n=e("extendsHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationMetaDataChange=void 0;var r=function(e){function t(t){var o=e.call(this,t)||this;return o.eventName="AnnotationMetaDataChange",o}return n(t,e),t}(e(109).AnnotationMetaDataChangeEvent);o.AnnotationMetaDataChange=r},{109:109}],31:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),o.SessionHealthSource=o.SessionHealthReason=o.SessionHealthImpact=o.SessionHealthEvent=void 0,r(e(30),o),r(e(32),o),r(e(34),o),r(e(33),o),r(e(36),o);var i=e(37);Object.defineProperty(o,"SessionHealthEvent",{enumerable:!0,get:function(){return i.SessionHealth}}),Object.defineProperty(o,"SessionHealthImpact",{enumerable:!0,get:function(){return i.SessionHealthImpact}}),Object.defineProperty(o,"SessionHealthReason",{enumerable:!0,get:function(){return i.SessionHealthReason}}),Object.defineProperty(o,"SessionHealthSource",{enumerable:!0,get:function(){return i.SessionHealthSource}})},{30:30,32:32,33:33,34:34,36:36,37:37}],32:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.CorrelationVector=void 0;var n=function(){function e(e){this.childCount=0,this.id=e||function(){for(var e=0;e<22;e++)i[e]=r[Math.floor(Math.random()*r.length)];return i.join("")}()}return e.fromString=function(t,o){if(!t)throw new Error("Received invalid correlation vector string");var n;return n=t.endsWith(".0")?new e(t.substring(0,t.length-2)):new e(t),o&&(n.childCount=o),n},e.prototype.newChild=function(){return++this.childCount,new e(this.id+"."+this.childCount.toString())},e.prototype.toString=function(){return this.id.length>127?this.id.substring(0,127)+"!":this.id},e}();o.CorrelationVector=n;var r=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],i=new Array(22)},{}],33:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.LoggingAggregator=void 0;var n=/\|\~/g,r=function(){this.count=0,this.measureSums=new Map},i=function(e,t,o,i,s){var a=this;this.buckets=new Map,this.init=function(e){a.log=e},this.add=function(e){if(a.condition&&a.condition(e)){for(var t=[],o=0,i=a.dimensions;o<i.length;o++){var s=i[o];if(void 0===e[s])t.push(null);else{var c="";"boolean"==typeof e[s]?c="b~":"number"==typeof e[s]&&(c="n~"),t.push("".concat(c).concat(e[s].toString().replace(n,"_")))}}var u=t.join("|"),l=a.buckets.get(u);if(!l){(l=new r).traceLevel=e.traceLevel;for(var p=0,f=a.avgMeasures;p<f.length;p++){var d=f[p];l.measureSums.set(d,0)}a.buckets.set(u,l)}l.count++;for(var h=0,g=a.avgMeasures;h<g.length;h++)e[d=g[h]]&&l.measureSums.set(d,l.measureSums.get(d)+e[d])}else a.log(e,!1)},this.flush=function(e){void 0===e&&(e=!1),a.buckets.forEach((function(e,t){for(var o={traceLevel:e.traceLevel,eventName:a.eventName,count:e.count},n=t.split("|"),r=0;r<a.dimensions.length;r++){var i=a.dimensions[r],s=n[r];0===s.indexOf("b~")?o[i]="b~true"===s:0===s.indexOf("n~")?o[i]=parseInt(s.slice("n~".length),10):o[i]=s}for(var c=0,u=a.avgMeasures;c<u.length;c++){var l=u[c];o[l]=Math.round(e.measureSums.get(l)/e.count)}a.log(o,!0)})),a.buckets.clear(),e&&(a.condition=null,clearInterval(a.interval))},this.eventName=e,this.condition=t,this.dimensions=o,this.avgMeasures=i,s>0&&(this.interval=setInterval(this.flush,1e3*s))};o.LoggingAggregator=i},{}],34:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.LogCategory=o.tagIdToString=o.argsToString=o.Log=void 0;var n,r,i=e(17),s="undefined"!=typeof process&&process.env?process.env.SERVICE_NAME:"client",a="abcdefghijklmnopqrstuvwxyz0123456789",c={97:0,98:1,99:2,100:3,101:4,102:5,103:6,104:7,105:8,106:9,107:10,108:11,109:12,110:13,111:14,112:15,113:16,114:17,115:18,116:19,117:20,118:21,119:22,120:23,121:24,122:25,48:26,49:27,50:28,51:29,52:30,53:31,54:32,55:33,56:34,57:35},u=[],l=[],p=new Map,f=new Map,d=new Map,h=new Map;!function(e){e.defineCoreLogCategory=function(e){return{root:"Core",name:e}},e.defineWorkflowLogCategory=function(e){return{root:"Workflow",name:e}},e.clearLoggers=function(){u=[],l=[],f.clear(),d.clear()},e.addLogger=function(e){-1===u.indexOf(e)&&(u.push(e),g(f,e))},e.addDecidingLogger=function(e){-1===l.indexOf(e)&&(l.push(e),g(d,e))},e.setCorrelationContextCallback=function(e){n=e},e.addAggregator=function(e){e.init((function(e,t){T(e,t)})),p.set(e.eventName,e)},e.flushAggregators=function(e){p.forEach((function(t){t.flush(e)}))},e.setTagLevelOverride=function(e,t){var o=S(e);h.set(o,t)},e.resetTagLevelOverrides=function(){h.clear()},e.error=function(e,t,o,n,r,s,a,c,u,l){v(e,t,i.LoggingLevel.error,o,n,r,s,a,c,u,l)},e.warn=function(e,t,o,n,r,s,a,c,u,l){v(e,t,i.LoggingLevel.warn,o,n,r,s,a,c,u,l)},e.info=function(e,t,o,n,r,s,a,c,u,l){v(e,t,i.LoggingLevel.info,o,n,r,s,a,c,u,l)},e.verbose=function(e,t,o,n,r,s,a,c,u,l){v(e,t,i.LoggingLevel.verbose,o,n,r,s,a,c,u,l)},e.debug=function(e,t,o,n,r,s,a,c,u,l){v(e,t,i.LoggingLevel.debug,o,n,r,s,a,c,u,l)},e.metric=function(e,t,o,n,r,s,a,c,u,l){v(e,t,i.LoggingLevel.metric,o,n,r,s,a,c,u,l)},e.dynamic=function(e){T(e)}}(r=o.Log||(o.Log={}));var g=function(e,t){var o=t.level;Object.keys(i.LoggingLevel).map((function(e){return i.LoggingLevel[e]})).filter((function(e){return"string"!=typeof e})).filter((function(e){return e<=o})).forEach((function(o){e.has(o)?e.get(o).push(t):e.set(o,[t])}))};o.argsToString=function(e){return"string"==typeof e?e:e.map((function(e){return e instanceof Error?JSON.stringify({message:e.message,name:e.name,stack:e.stack}):"object"==typeof e?JSON.stringify(e):e})).join(" ")};var y=function(e){return void 0!==e?f.get(e)||[]:u},m=function(e,t){return(void 0!==e?d.get(e)||[]:l).filter((function(e){return e.shouldLog(t)}))},v=function(e,t,r,i,s,a,c,u,l,f,d){r=h.get(e)||r;var g=y(r),v=m(r,i);if(0!=g.length||0!=v.length){var S=(0,o.tagIdToString)(e),w=function(e,t,o,n,r,i,s,a){if(void 0===t&&("string"==typeof e||"object"==typeof e))return e;if(void 0===t&&"function"==typeof e)return e();for(var c=[],u=0,l=[e,t,o,n,r,i,s,a];u<l.length;u++){var p=l[u];void 0!==p&&c.push("function"==typeof p?p():p)}return c}(i,s,a,c,u,l,f,d);if(Array.isArray(w)||"object"!=typeof w){T({eventName:"Log",tagId:S,category:"".concat(t.root,".").concat(t.name),traceLevel:r,message:(0,o.argsToString)(w),getMetrics:function(){var e;return"Core"===t.root?{TraceEventV2:{dimensionNames:function(){return["Level","Tag"]},dimensionValues:[String(r),S],value:1}}:{WorkflowTraceEvent:{dimensionNames:function(){return["Level","Tag","Workflow"]},dimensionValues:[String(r),S,n?null===(e=n())||void 0===e?void 0:e.workflow:""],value:1}}}},!1,g,v)}else{var b=w;b.tagId=S,b.category="".concat(t.root,".").concat(t.name),"Operation"===b.eventName&&"Workflow"===t.root&&(b.eventName="WorkflowOperation",n&&(b.joinContextId=n().joinContextId)),b.traceLevel=r;var _=p.get(b.eventName);_?_.add(b):T(b,!1,g,v)}}},T=function(e,t,o,r){var i,a,c;if(void 0===t&&(t=!1),null==o&&(o=y(e.traceLevel)),r=r||[],o.length>0||r.length>0){if(e.serviceName=s,!t&&n){var u=n();if(u){e.cv=e.cv?e.cv:u.cv.toString(),e.sessionKey=e.sessionKey?e.sessionKey:u.sessionKey,e.workflow=e.workflow?e.workflow:u.workflow;var l=null===(i=u.clientMetadata)||void 0===i?void 0:i.appName;e.clientAppName=e.clientAppName?e.clientAppName:l;var p=null===(a=u.clientMetadata)||void 0===a?void 0:a.appPlatform;e.clientAppPlatform=e.clientAppPlatform?e.clientAppPlatform:p;var f=null===(c=u.clientMetadata)||void 0===c?void 0:c.releaseAudienceGroup;e.clientReleaseAudienceGroup=e.clientReleaseAudienceGroup?e.clientReleaseAudienceGroup:f}}for(var d=0,h=o;d<h.length;d++){h[d].log(e)}for(var g=0,m=r;g<m.length;g++){m[g].log(e)}}};o.tagIdToString=function(e){return a[e>>24&63]+a[e>>18&63]+a[e>>12&63]+a[e>>6&63]+a[e>>0&63]};var S=function(e){return e&&5===e.length?c[e.charCodeAt(0)]<<24|c[e.charCodeAt(1)]<<18|c[e.charCodeAt(2)]<<12|c[e.charCodeAt(3)]<<6|c[e.charCodeAt(4)]:-1},w=function(){function e(){}return e.CoreDefault=r.defineCoreLogCategory("Default"),e.CoreSystem=r.defineCoreLogCategory("System"),e.WorkflowDefault=r.defineWorkflowLogCategory("Default"),e.WorkflowUnsampled=r.defineWorkflowLogCategory("Unsampled"),e}();o.LogCategory=w},{17:17}],35:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.now=void 0;o.now="undefined"!=typeof process&&process.hrtime?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return Date.now()}},{}],36:[function(e,t,o){"use strict";var n=e("extendsHelper"),r=e("assignHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.Operation=void 0;var i=e(109),s=e(35),a=function(e){function t(t,o){var n=e.call(this,t)||this;return n.eventName="Operation",n.options=o,n.durationMs=null==t?void 0:t.durationMs,t&&null!=t.count||(n.count=1),n}return n(t,e),t.prototype.setClientMetadata=function(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientDeviceId=e.deviceId,this.clientUserAgent=e.userAgent),this},t.prototype.setUserContext=function(e){return e&&(this.userId=e.puid||e.oid,this.userType=e.userType&&e.userType.toString()),this},t.prototype.setDataField=function(e,t){var o=this.dataFields?JSON.parse(this.dataFields):{};o[e]=t,this.dataFields=JSON.stringify(o)},t.prototype.setDataFields=function(e){this.dataFields?this.dataFields=JSON.stringify(r(r({},JSON.parse(this.dataFields)),e)):this.dataFields=JSON.stringify(e)},t.prototype.start=function(){return this.startTime=(0,s.now)(),this},t.prototype.stop=function(){var e=(0,s.now)();return this.durationMs=Math.round(e-this.startTime),this},t.prototype.getMetrics=function(){var e,t,o,n,r={};if(this.operationName)switch(this.operationName){case"SessionHealthOrphanedEventsWithoutProperSessionKey":case"SessionHealthOrphanedSessions":case"WorkflowActivationState":r[this.operationName+".CountV2"]={dimensionNames:this.getOrphanedSessionHealthDimensionNames.bind(this),dimensionValues:this.getOrphanedSessionHealthDimensionValues(),value:this.count};break;case"MarkUnhealthySession":case"MarkHealthWarningSession":r[this.operationName+".Reason"]={dimensionNames:this.getSessionHealthDimensionNames.bind(this),dimensionValues:this.getSessionHealthDimensionValues(),value:1};break;default:"matchmaker_timer"===this.operationName&&(r["Workflow.DurationMs"]={dimensionNames:this.getWorkflowDimensionNames.bind(this),dimensionValues:this.getWorkflowDimensionValues(),value:this.durationMs||0},r["Workflow.Count"]={dimensionNames:this.getWorkflowDimensionNames.bind(this),dimensionValues:this.getWorkflowDimensionValues(),value:1}),void 0!==(null===(e=this.options)||void 0===e?void 0:e.metricDuration)&&!(null===(t=this.options)||void 0===t?void 0:t.metricDuration)||void 0===this.durationMs||(r["".concat(this.operationName,".DurationMsV2")]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.durationMs}),(void 0===(null===(o=this.options)||void 0===o?void 0:o.metricCount)||(null===(n=this.options)||void 0===n?void 0:n.metricCount))&&(r["".concat(this.operationName,".CountV2")]={dimensionNames:this.getDimensionNames.bind(this),dimensionValues:this.getDimensionValues(),value:this.count})}return r},t.prototype.getDimensionNames=function(){return["Success","ClientAppName","ClientAppPlatform","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},t.prototype.getDimensionValues=function(){return[this.success,this.clientAppName,this.clientAppPlatform,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]},t.prototype.getOrphanedSessionHealthDimensionNames=function(){return["Success","ClientAppName","ClientAppPlatform","ClientReleaseAudienceGroup","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"]},t.prototype.getOrphanedSessionHealthDimensionValues=function(){return[this.success,this.clientAppName,this.clientAppPlatform,this.clientReleaseAudienceGroup,this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]},t.prototype.getSessionHealthDimensionNames=function(){return["Reason","ClientAppName","ClientAppPlatform","ClientAppVersion","Dimension0","Dimension1","Dimension2","Dimension3"]},t.prototype.getSessionHealthDimensionValues=function(){return[this.resultSignature,this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.dimension0,this.dimension1,this.dimension2,this.dimension3]},t.prototype.getWorkflowDimensionNames=function(){return["ResultSignature","WorkflowId","ResourceId","Success"]},t.prototype.getWorkflowDimensionValues=function(){return[this.resultSignature,this.resourceId,this.resourceId,this.success]},t}(i.OperationEvent);o.Operation=a},{109:109,35:35}],37:[function(e,t,o){"use strict";var n=e("extendsHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.SessionHealth=o.SessionHealthImpact=o.SessionHealthReason=o.SessionHealthSource=void 0;var r,i,s,a=e(109),c=e(35);!function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.ClientRuntime=5]="ClientRuntime"}(r=o.SessionHealthSource||(o.SessionHealthSource={})),function(e){e[e.Unknown=0]="Unknown",e[e.Core=1]="Core",e[e.Workflow=2]="Workflow",e[e.SessionExtension=3]="SessionExtension",e[e.Client=4]="Client",e[e.Network=5]="Network",e[e.AugLoopDependency=6]="AugLoopDependency",e[e.WorkflowDependency=7]="WorkflowDependency",e[e.ClientRuntime=8]="ClientRuntime"}(i=o.SessionHealthReason||(o.SessionHealthReason={})),function(e){e[e.Unknown=0]="Unknown",e[e.None=1]="None",e[e.MissingInput=2]="MissingInput",e[e.MissingOutput=3]="MissingOutput"}(s=o.SessionHealthImpact||(o.SessionHealthImpact={}));var u=function(e){function t(t,o){var n,a,c=this;return(c=e.call(this,{source:r[t.source],reason:i[t.reason],reasonDependency:t.reasonDependency,subReason:t.subReason,sessionHealthEventName:t.sessionHealthEventName,impact:s[t.impact],success:t.success,durationMs:null!==(n=t.durationMs)&&void 0!==n?n:0,count:"number"==typeof t.count?t.count:1,message:t.message,affectedWorkflows:(null!==(a=t.affectedWorkflows)&&void 0!==a?a:[]).join(","),resourceId:t.resourceId,dimension0:t.dimension0,dimension1:t.dimension1,dimension2:t.dimension2,dimension3:t.dimension3,cv:t.cv,resultSignature:t.resultSignature,resultDescription:t.resultDescription})||this).eventName="SessionHealth",c.dimensionNames=["ClientAppName","ClientAppPlatform","ClientAppVersion","Success","Reason","Impact","FirstAffectedWorkflow","ResourceId","Dimension0","Dimension1","Dimension2","Dimension3"],o&&c.setClientMetadata(o),c}return n(t,e),t.prototype.getMetrics=function(){var e,t=this;return(e={})["".concat(this.sessionHealthEventName,".CountV2")]={dimensionNames:function(){return t.dimensionNames},dimensionValues:this.getDimensionValues(),value:this.count},e["".concat(this.sessionHealthEventName,".DurationMsV2")]={dimensionNames:function(){return t.dimensionNames},dimensionValues:this.getDimensionValues(),value:this.durationMs},e},t.prototype.setClientMetadata=function(e){return e&&(this.clientAppName=e.appName,this.clientAppPlatform=e.appPlatform,this.clientAppVersion=e.appVersion,this.clientFlights=e.flights,this.clientReleaseAudienceGroup=e.releaseAudienceGroup,this.clientReleaseChannel=e.releaseChannel,this.clientReleaseFork=e.releaseFork,this.clientRuntimeVersion=e.runtimeVersion,this.clientSessionId=e.sessionId,this.clientUserAgent=e.userAgent,this.clientDeviceId=e.deviceId),this},t.prototype.setReason=function(e){return this.reason=i[e],this},t.prototype.setSource=function(e){return this.source=r[e],this},t.prototype.setImpact=function(e){return this.impact=s[e],this},t.prototype.setAffectedWorkflows=function(e){return this.affectedWorkflows=(null!=e?e:[]).join(","),this},t.prototype.getAffectedWorkflows=function(){return this.affectedWorkflows.split(",")},t.prototype.start=function(){return this.startTime=(0,c.now)(),this},t.prototype.stop=function(){var e=(0,c.now)();return this.durationMs=Math.round(e-this.startTime),this},t.prototype.getDimensionValues=function(){var e;return[this.clientAppName,this.clientAppPlatform,this.clientAppVersion,this.success?"1":"0","".concat(this.reason,"_").concat(this.reasonDependency),this.impact,null!==(e=this.getAffectedWorkflows()[0])&&void 0!==e?e:"",this.resourceId,this.dimension0,this.dimension1,this.dimension2,this.dimension3]},t}(a.SessionHealthEvent);o.SessionHealth=u},{109:109,35:35}],38:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(39),o),r(e(40),o),r(e(41),o),r(e(42),o),r(e(43),o),r(e(44),o),r(e(45),o)},{39:39,40:40,41:41,42:42,43:43,44:44,45:45}],39:[function(e,t,o){"use strict";var n=e("assignHelper"),r=e("valuesHelper"),i=e("readHelper"),s=e("spreadArrayHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.ContextIdTracker=o.ContextIdManager=void 0;var a=e(114),c=e(31),u=new Set([a.AddOperation.getTypeName(),a.UpdateOperation.getTypeName(),a.SignalOperation.getTypeName(),a.DeltaUpdateOperation.getTypeName()]),l=function(){function e(e,t){void 0===t&&(t=!1),this.collectionScopeTypesOnJoinWorkflows=new Set,this.updatesByScopeItemPath=new Map,this.runtimeKind=e,this.pendingId="".concat(e,"0"),this.contextIdTracker=new p(e),this.changeGate=t}return e.prototype.getRuntimeKind=function(){return this.runtimeKind},e.prototype.setActiveScopeType=function(e){this.collectionScopeTypesOnJoinWorkflows.add(e)},e.prototype.applyContextIdOnOperations=function(e){var t,o,i,s,u,l,p,f,d,h;if(this.changeGate)try{for(var g=r(e),y=g.next();!y.done;y=g.next()){var m=y.value,v=a.SchemaObject.getTypeNameFor(m);if(this.isSupportedOperation(v))try{for(var T=(i=void 0,r(m.items)),S=T.next();!S.done;S=T.next()){var w=S.value,b=void 0;if(100*Math.random()<=.5&&(b=new c.Operation({operationName:"ApplyContextIdOnOperations",success:!0}).start()),w.contextId){var _=w.contextId.split("."),C=_.splice(_.length-1)[0];if(C===this.pendingId){var k=this.contextIdTracker.addChild(_.join("."));w.contextId=k,this.tryLogMessage(b,"Item from workflow, adding new id to contextId: ".concat(this.runtimeKind," ").concat(w.id," ").concat(w.contextId))}else C[0]!==this.runtimeKind?this.tryLogMessage(b,"Item from another runtime (".concat(C[0],"), keeping the same: ").concat(w.id," ").concat(w.contextId)):this.tryLogMessage(b,"Item from the same runtime (".concat(C[0],") with complete contextId: ").concat(w.id," ").concat(w.contextId),!1)}else{var O=this.contextIdTracker.addRoot();w.contextId=O,this.tryLogMessage(b,"New root idem, giving a new root contextId: ".concat(w.id," ").concat(w.contextId))}}}catch(e){i={error:e}}finally{try{S&&!S.done&&(s=T.return)&&s.call(T)}finally{if(i)throw i.error}}}}catch(e){t={error:e}}finally{try{y&&!y.done&&(o=g.return)&&o.call(g)}finally{if(t)throw t.error}}else try{for(var x=r(e),M=x.next();!M.done;M=x.next()){m=M.value,v=a.SchemaObject.getTypeNameFor(m);if(this.isSupportedOperation(v))try{for(var I=(p=void 0,r(m.items)),A=I.next();!A.done;A=I.next()){w=A.value,b=void 0;if(100*Math.random()<=.5&&(b=new c.Operation({operationName:"ApplyContextIdOnOperations",success:!0}).start()),w.contextId)this.tryLogMessage(b,"Item of id: ".concat(w.id," already has a contextId ").concat(w.contextId));else{var L=n({parentPath:m.parentPath},w);if(v===a.DeltaUpdateOperation.getTypeName()){var P=n(n({},w),{parentPath:m.parentPath.slice(0,-1)});this.updatesByScopeItemPath.has(this.makeItemPathStr(P))?(w.contextId=this.getNewContextId(P),this.tryLogMessage(b,"DeltaUpdateOperation ".concat(w.id," already has a related TextTile, its new contextId is ").concat(w.contextId))):this.tryLogMessage(b,"DeltaUpdateOperation ".concat(w.id," don't have a related TextTile with contextId"));continue}if(this.isScopeTypeOfAnyJoinWorkflow(w.body))w.contextId=this.getNewContextId(L),this.tryLogMessage(b,"Item of id: ".concat(w.id," is scope item of a join and its contextId is ").concat(w.contextId));else{var D=this.makeItemPathStr(L);try{for(var E=(d=void 0,r(this.updatesByScopeItemPath.keys())),N=E.next();!N.done;N=E.next()){var R=N.value;D.indexOf(R)>=0&&(w.contextId=this.getContextId(R),this.tryLogMessage(b,"Item of id: ".concat(w.id," is not scope item of a join and its contextId is ").concat(w.contextId)))}}catch(e){d={error:e}}finally{try{N&&!N.done&&(h=E.return)&&h.call(E)}finally{if(d)throw d.error}}w.contextId||this.tryLogMessage(b,"Item of id: ".concat(w.id," does not belong to any join workflow execution"))}}}}catch(e){p={error:e}}finally{try{A&&!A.done&&(f=I.return)&&f.call(I)}finally{if(p)throw p.error}}}}catch(e){u={error:e}}finally{try{M&&!M.done&&(l=x.return)&&l.call(x)}finally{if(u)throw u.error}}},e.prototype.getNewContextId=function(e){var t=this.makeItemPathStr(e),o=this.updatesByScopeItemPath.get(t)||0;return this.updatesByScopeItemPath.set(t,o+1),this.getContextId(t)},e.prototype.isSupportedOperation=function(e){return u.has(e)},e.prototype.isScopeTypeOfAnyJoinWorkflow=function(e){var t=s([],i(this.collectionScopeTypesOnJoinWorkflows),!1);return 0!==t.length&&a.SchemaObject.matchesTypesFor(e,t)},e.prototype.makeItemPathStr=function(e){return s(s([],i(e.parentPath),!1),[e.id],!1).join("/")},e.prototype.getContextId=function(e){return e+"@"+this.updatesByScopeItemPath.get(e)},e.prototype.tryLogMessage=function(e,t,o){void 0===o&&(o=!0),e&&(e.success=o,e.resultDescription=t,c.Log.verbose(527308633,c.LogCategory.CoreDefault,e.stop()))},e}();o.ContextIdManager=l;var p=function(){function e(e){this.rootCount=0,this.children=new Map,this.runtimeKind=e}return e.prototype.addRoot=function(){this.rootCount++;var e=this.buildNodeKey(this.rootCount);return this.increaseChildCount(e),e},e.prototype.addChild=function(e){this.children.has(e)||this.increaseChildCount(e);var t=this.children.get(e),o=this.appendNodeKey(e,this.buildNodeKey(t+1));return this.increaseChildCount(e),this.increaseChildCount(o),o},e.prototype.increaseChildCount=function(e){try{this.children.set(e,this.children.has(e)?this.children.get(e)+1:0)}catch(o){var t=new c.Operation({operationName:"ContextIdTracker",resultDescription:"key: ".concat(e,", rootCount: ").concat(this.rootCount,", children map size: ").concat(this.children.size,". Error: ").concat(o),success:!0}).start();c.Log.error(524318817,c.LogCategory.CoreDefault,t.stop())}},e.prototype.buildNodeKey=function(e,t){return void 0===t&&(t=this.runtimeKind),t+e.toString()},e.prototype.appendNodeKey=function(e,t){return e+"."+t},e}();o.ContextIdTracker=p},{114:114,31:31}],40:[function(e,t,o){"use strict";var n=e("assignHelper"),r=e("readHelper"),i=e("spreadArrayHelper"),s=e("valuesHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.findRangeForDeltaType=o.applyFormattedTextTileDelta=o.applyTextTileDelta=void 0;var a=e(114),c=e(31),u=e(125);function l(e,t,o){var n=new c.Operation({operationName:"FindRangeForDelta",success:!0});if(n.start(),!e)return n.resultDescription="No formatted ranges found within the tile, skipping.",void c.Log.info(538798212,c.LogCategory.CoreDefault,n.stop());if(t===u.TextTileDeltaType.Add){var r=e.find((function(e){return e.start===o&&0===e.length}));if(r)return n.resultDescription="Found a zero-length formatted range for add operation with start ".concat(r.start,"."),c.Log.info(538798213,c.LogCategory.CoreDefault,n.stop()),r;o=Math.max(o-1,0)}var i=e.find((function(e){return 0===e.length?e.start===o:e.start<=o&&o<e.start+e.length}));return i?(n.resultDescription="Updating formatted range for operation with start: ".concat(i.start," and length: ").concat(i.length),c.Log.info(538798214,c.LogCategory.CoreDefault,n.stop())):(n.resultDescription="Unable to find formatted range for operation at position ".concat(o,", skipping."),c.Log.info(538798215,c.LogCategory.CoreDefault,n.stop())),i}o.applyTextTileDelta=function(e,t){var o=new c.Operation({operationName:"ApplyTextTileDeltaForLocalWorkflows",success:!0});o.start();try{if(!t)return o.success=!1,o.resultDescription="Unable to apply text tile delta, parent tile is undefined",void c.Log.info(538798173,c.LogCategory.CoreDefault,o.stop());if(a.SchemaObject.getTypeNameFor(t)!==u.TextTile.getTypeName())return o.success=!1,o.resultDescription="Unable to apply text tile delta, parent tile is not proper type: expected ".concat(u.TextTileDelta.getTypeName(),", received ").concat(a.SchemaObject.getTypeNameFor(t)),void c.Log.info(538798174,c.LogCategory.CoreDefault,o.stop());var n=e,r=t.content,i="";if(void 0===n.position||n.position<0)return o.success=!1,o.resultDescription="Unable to apply text tile delta, invalid text tile position",void c.Log.info(538798175,c.LogCategory.CoreDefault,o.stop());switch(n.deltaType){case u.TextTileDeltaType.Add:i=n.position<r.length?"".concat(r.slice(0,n.position)).concat(n.content).concat(r.slice(n.position,r.length)):r+n.content;break;case u.TextTileDeltaType.Update:i="".concat(r.slice(0,n.position)).concat(n.content).concat(r.slice(n.position+(n.length||0),r.length));break;case u.TextTileDeltaType.Delete:i="".concat(r.slice(0,n.position)).concat(r.slice(n.position+(n.length||0),r.length))}return c.Log.info(538837071,c.LogCategory.CoreDefault,o.stop()),new u.TextTile({content:i})}catch(e){return o.success=!1,o.resultDescription="Error applying text tile delta: ".concat(e),void c.Log.info(538798176,c.LogCategory.CoreDefault,o.stop())}},o.applyFormattedTextTileDelta=function(e,t){var o,p,f,d,h,g,y=new c.Operation({operationName:"ApplyFormattedTextTileDeltaForLocalWorkflows",success:!0});y.start();try{if(!t)return y.success=!1,y.resultDescription="Unable to apply formatted text tile delta, parent tile is undefined",void c.Log.info(538798177,c.LogCategory.CoreDefault,y.stop());if(a.SchemaObject.getTypeNameFor(t)!==u.FormattedTextTile.getTypeName())return y.success=!1,y.resultDescription="Unable to apply formatted text tile delta, parent tile is not proper type: expected ".concat(u.FormattedTextTile.getTypeName(),", received ").concat(a.SchemaObject.getTypeNameFor(t)),void c.Log.info(538798178,c.LogCategory.CoreDefault,y.stop());var m=t,v=e,T=m.content,S="";if(void 0===v.position||v.position<0)return y.success=!1,y.resultDescription="Unable to apply formatted text tile delta, invalid text tile position",void c.Log.info(538798179,c.LogCategory.CoreDefault,y.stop());if(void 0===v.content&&v.deltaType!==u.TextTileDeltaType.Delete)return y.success=!1,y.resultDescription="Unable to apply formatted text tile delta, non-delete operation without content defined",void c.Log.info(538798208,c.LogCategory.CoreDefault,y.stop());v.deltaType===u.TextTileDeltaType.Add&&0!==v.length?c.Log.info(538798209,c.LogCategory.CoreDefault,new c.Operation({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta add operation with delta length, expected length 0",success:!0})):v.deltaType===u.TextTileDeltaType.Delete&&void 0!==v.content&&c.Log.info(538798210,c.LogCategory.CoreDefault,new c.Operation({operationName:"ApplyDeltaChecks",resultDescription:"Received formatted text tile delta delete operation with content defined, expected undefined",success:!0}));var w=l(m.formattedRanges,v.deltaType,v.position),b=m.formattedRanges?i([],r(m.formattedRanges),!1):[],_=w?b.indexOf(w):-1;switch(-1!==_&&(v.position+(v.length||0)>w.start+w.length?w.length=v.position+(null!==(f=v.content)&&void 0!==f?f:"").length-w.start:w.length+=(null!==(d=v.content)&&void 0!==d?d:"").length-(v.length||0),b[_]=w),v.deltaType){case u.TextTileDeltaType.Add:S=v.position<T.length?"".concat(T.slice(0,v.position)).concat(v.content).concat(T.slice(v.position,T.length)):T+v.content;break;case u.TextTileDeltaType.Update:S="".concat(T.slice(0,v.position)).concat(v.content).concat(T.slice(v.position+(v.length||0),T.length));break;case u.TextTileDeltaType.Delete:S="".concat(T.slice(0,v.position)).concat(T.slice(v.position+(v.length||0),T.length))}try{for(var C=s(b.slice(_+1)),k=C.next();!k.done;k=C.next()){var O=k.value;O.start<v.position||(v.position+(v.length||0)>O.start?(O.length=O.start+O.length-(v.position+(v.length||0)),O.start=v.position+(null!==(h=v.content)&&void 0!==h?h:"").length):O.start+=(null!==(g=v.content)&&void 0!==g?g:"").length-(v.length||0))}}catch(e){o={error:e}}finally{try{k&&!k.done&&(p=C.return)&&p.call(C)}finally{if(o)throw o.error}}b=b.filter((function(e){return e.length>0}));var x=new u.FormattedTextTile(n(n({},m),{content:S,formattedRanges:b,queryRange:v.queryRange}));return c.Log.info(538837073,c.LogCategory.CoreDefault,y.stop()),x}catch(e){return y.success=!1,y.resultDescription="Error applying formatted text tile delta: ".concat(e),void c.Log.info(538798211,c.LogCategory.CoreDefault,y.stop())}},o.findRangeForDeltaType=l},{114:114,125:125,31:31}],41:[function(e,t,o){"use strict";var n=e("assignHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.DynamicWorkflowDefinitionManager=void 0;var r=e(43),i=function(){function e(){this.workflowDefByWorkflowAndContextId=new Map,this.workflowDefByWorkflow=new Map}return e.mergeDefinitions=function(e,t,o){return n(n(n({},e),t),o)},e.prototype.mergeWorkflowDefinition=function(t,o,n){if(n){var i=(0,r.getOrSetDefaultValue)(this.workflowDefByWorkflowAndContextId,t.id,(function(){return new Map}));i.set(n,e.mergeDefinitions(t,i.get(n),o))}else this.workflowDefByWorkflow.set(t.id,e.mergeDefinitions(t,this.workflowDefByWorkflow.get(t.id),o))},e.prototype.getWorkflowDefinition=function(e,t){var o,n;return t&&(n=null===(o=this.workflowDefByWorkflowAndContextId.get(e.id))||void 0===o?void 0:o.get(t)),n||(n=this.workflowDefByWorkflow.get(e.id)),n||(n=e),n},e.prototype.deleteWorkflowDefinition=function(e,t){var o=this.workflowDefByWorkflowAndContextId.get(e.id);o&&(o.delete(t),0===o.size&&this.workflowDefByWorkflowAndContextId.delete(e.id))},e}();o.DynamicWorkflowDefinitionManager=i},{43:43}],42:[function(e,t,o){"use strict";var n=e("assignHelper"),r=e("valuesHelper"),i=e("readHelper"),s=e("spreadArrayHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.JoinAnnotationsManager=void 0;var a=e(114),c=e(31),u=new Set([a.AddOperation.getTypeName(),a.UpdateOperation.getTypeName(),a.SignalOperation.getTypeName(),a.DeltaUpdateOperation.getTypeName()]),l=function(){function e(e){this.collectionScopeTypesOnJoinWorkflows=new Set,this.updatesByScopeItemPath=new Map,this.scopeItemsByContextId=new Map,this.annotationsByWorkflowAndScopeItem=new Map,this.workflowDefinitionManager=e}return e.prototype.setActiveCollectionScopeType=function(e){this.collectionScopeTypesOnJoinWorkflows.add(e)},e.prototype.applyContextIdOnOperations=function(e){var t,o,i,s,u,l;try{for(var p=r(e),f=p.next();!f.done;f=p.next()){var d=f.value,h=a.SchemaObject.getTypeNameFor(d);if(this.isSupportedOperation(h))try{for(var g=(i=void 0,r(d.items)),y=g.next();!y.done;y=g.next()){var m=y.value,v=new c.Operation({operationName:"ApplyContextIdOnOperations",success:!1}).start();if(m.contextId)c.Log.verbose(539854490,c.LogCategory.CoreDefault,this.successLogMessage(v,"JAM :: Item of id: ".concat(m.id," already has a contextId ").concat(m.contextId)).stop());else{var T=n({parentPath:d.parentPath},m);if(h===a.DeltaUpdateOperation.getTypeName()){var S=n(n({},m),{parentPath:d.parentPath.slice(0,-1)});this.updatesByScopeItemPath.has(this.makeItemPathStr(S))?(m.contextId=this.getNewContextId(S),c.Log.verbose(539776014,c.LogCategory.CoreDefault,this.successLogMessage(v,"JAM :: DeltaUpdateOperation ".concat(m.id," already has a related TextTile, its new contextId is ").concat(m.contextId)).stop())):c.Log.verbose(539776015,c.LogCategory.CoreDefault,this.successLogMessage(v,"JAM :: DeltaUpdateOperation ".concat(m.id," don't have a related TextTile with contextId")).stop());continue}if(this.isScopeTypeOfAnyJoinWorkflow(m.body))m.contextId=this.getNewContextId(T),c.Log.verbose(539854488,c.LogCategory.CoreDefault,this.successLogMessage(v,"JAM :: Item of id: ".concat(m.id," is scope item of a join and its contextId is ").concat(m.contextId)).stop());else{var w=this.makeItemPathStr(T);try{for(var b=(u=void 0,r(this.updatesByScopeItemPath.keys())),_=b.next();!_.done;_=b.next()){var C=_.value;w.indexOf(C)>=0&&(m.contextId=this.getContextId(C),c.Log.verbose(539854489,c.LogCategory.CoreDefault,this.successLogMessage(v,"JAM :: Item of id: ".concat(m.id," is not scope item of a join and its contextId is ").concat(m.contextId)).stop()))}}catch(e){u={error:e}}finally{try{_&&!_.done&&(l=b.return)&&l.call(b)}finally{if(u)throw u.error}}m.contextId||c.Log.verbose(539109088,c.LogCategory.CoreDefault,this.successLogMessage(v,"JAM :: Item of id: ".concat(m.id," does not belong to any join workflow execution")).stop())}}}}catch(e){i={error:e}}finally{try{y&&!y.done&&(s=g.return)&&s.call(g)}finally{if(i)throw i.error}}}}catch(e){t={error:e}}finally{try{f&&!f.done&&(o=p.return)&&o.call(p)}finally{if(t)throw t.error}}},e.prototype.getNewContextId=function(e){var t=this.makeItemPathStr(e),o=this.updatesByScopeItemPath.get(t)||0;return this.updatesByScopeItemPath.set(t,o+1),this.getContextId(t)},e.prototype.setScopeItem=function(e,t){var o=e.contextId;if(this.scopeItemsByContextId.has(o)){var n=new c.Operation({resultDescription:"JAM.setScopeItem :: Trying to set new scope item: ".concat(e.id," with already existing contextId ").concat(o),operationName:"JoinSetScopeItem",success:!0}).start();c.Log.verbose(539854491,c.LogCategory.CoreDefault,n.stop())}else this.scopeItemsByContextId.set(o,e);this.annotationsByWorkflowAndScopeItem.has(t.id)||this.annotationsByWorkflowAndScopeItem.set(t.id,new Map),this.annotationsByWorkflowAndScopeItem.get(t.id).set(o,[])},e.prototype.getScopeItem=function(e,t){var o;if(null===(o=this.annotationsByWorkflowAndScopeItem.get(t.id))||void 0===o?void 0:o.has(e))return this.scopeItemsByContextId.get(e)},e.prototype.addItemOnContextIdList=function(e,t){var o,n,r=e.contextId,i=this.annotationsByWorkflowAndScopeItem.get(t.id);if(i){null===(o=i.get(r))||void 0===o||o.push(e);var s=new c.Operation({resultDescription:"JAM.addItemOnContextIdList :: Items for contextId ".concat(r,": [").concat(null===(n=i.get(r))||void 0===n?void 0:n.map((function(e){return e.id})).join(","),"]"),operationName:"JoinAddInputItem",success:!0}).start();c.Log.verbose(539854492,c.LogCategory.CoreDefault,s.stop())}},e.prototype.isJoinReady=function(e,t){var o=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=o},e.prototype.getItemsToExecute=function(e,t){var o=this.getGeneratedItems(e,t);return this.annotationsByWorkflowAndScopeItem.get(t.id).delete(e),o},e.prototype.registerWorkflowExecution=function(e,t){var o=e.contextId,n=this.annotationsByWorkflowAndScopeItem.get(t.id);n&&(n.delete(o),0===n.size&&this.annotationsByWorkflowAndScopeItem.delete(t.id)),this.hasWorkflowsAwaitingExecution(o)||this.scopeItemsByContextId.delete(o)},e.prototype.getGeneratedItems=function(e,t){var o;if(!(null===(o=this.annotationsByWorkflowAndScopeItem.get(t.id))||void 0===o?void 0:o.get(e)))return[];var n=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.annotationsByWorkflowAndScopeItem.get(t.id).get(e).slice(0,n)},e.prototype.isSupportedOperation=function(e){return u.has(e)},e.prototype.isScopeTypeOfAnyJoinWorkflow=function(e){var t=s([],i(this.collectionScopeTypesOnJoinWorkflows),!1);return 0!==t.length&&a.SchemaObject.matchesTypesFor(e,t)},e.prototype.hasWorkflowsAwaitingExecution=function(e){var t,o,n,i;try{for(var s=r(this.annotationsByWorkflowAndScopeItem.values()),a=s.next();!a.done;a=s.next()){var c=a.value;try{for(var u=(n=void 0,r(c.keys())),l=u.next();!l.done;l=u.next()){if(l.value===e)return!0}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(t)throw t.error}}return!1},e.prototype.makeItemPathStr=function(e){return s(s([],i(e.parentPath),!1),[e.id],!1).join("/")},e.prototype.getContextId=function(e){return e+"@"+this.updatesByScopeItemPath.get(e)},e.prototype.successLogMessage=function(e,t){return e.success=!0,e.resultDescription=t,e},e}();o.JoinAnnotationsManager=l},{114:114,31:31}],43:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.isHybridWorkflow=o.getWorkflowDefinitionBase=o.getOrSetDefaultValue=void 0;o.getOrSetDefaultValue=function(e,t,o){var n=e.get(t);return n||(n=o(),e.set(t,n)),n};o.getWorkflowDefinitionBase=function(e){return{id:e.id,kind:e.kind,visibility:e.visibility,collectionScopeType:e.collectionScopeType,inputTypes:e.inputTypes,outputTypes:e.outputTypes,correlatedSignals:e.correlatedSignals}};o.isHybridWorkflow=function(e){return Array.isArray(e.correlatedSignals)&&e.correlatedSignals.length>0}},{}],44:[function(e,t,o){"use strict";var n=e("assignHelper"),r=e("valuesHelper"),i=e("readHelper"),s=e("spreadArrayHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.WorkflowGraph=void 0;var a=e(17),c=e(31),u=function(){function e(){this.graphNodeByWorkflowId=new Map}return e.prototype.addWorkflow=function(e){if(this.graphNodeByWorkflowId.has(e.id)){var t=new c.Operation({resultDescription:"Adding a new with workflow with a duplicated workflowId: ".concat(e.id)});c.Log.error(524300630,c.LogCategory.CoreDefault,t.stop())}else{var o=new l(e);this.addWorkflowAsDependency(o),this.graphNodeByWorkflowId.set(e.id,o)}},e.prototype.getUpstreamRuntimeVisibleWorkflows=function(){var e,t,o,n=[];try{for(var a=r(this.graphNodeByWorkflowId.values()),c=a.next();!c.done;c=a.next()){var u=c.value,l=this.createWorkflowDefinition(u.workflow);1===u.workflow.visibility?this.compressDownstreamWorkflows(l,u):(o=l.outputTypes).push.apply(o,s([],i(u.workflow.outputTypes),!1)),0!==l.inputTypes.length&&n.push(l)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return n},e.prototype.getWorkflowsDefinitions=function(){return Array.from(this.graphNodeByWorkflowId.values()).map((function(e){return e.workflow}))},e.prototype.createWorkflowDefinition=function(e){return{id:"".concat(e.id,"-Virtual"),kind:e.kind,visibility:0,inputTypes:e.inputTypes,outputTypes:[],collectionScopeType:e.collectionScopeType,correlatedSignals:e.correlatedSignals}},e.prototype.compressDownstreamWorkflows=function(e,t){var o,n,i,s;try{for(var c=r(t.downstreamWorkflows),u=c.next();!u.done;u=c.next()){var l=u.value;if(1!==l.workflow.visibility){if(l.workflow.kind!==a.WorkflowKind.Join||-1!==e.inputTypes.indexOf(l.workflow.collectionScopeType))try{for(var p=(i=void 0,r(l.workflow.outputTypes)),f=p.next();!f.done;f=p.next()){var d=f.value;-1===e.outputTypes.indexOf(d)&&e.outputTypes.push(d)}}catch(e){i={error:e}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(i)throw i.error}}}else this.compressDownstreamWorkflows(e,l)}}catch(e){o={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(o)throw o.error}}},e.prototype.addWorkflowAsDependency=function(e){var t,o,n,i,s,a;try{for(var c=r(this.graphNodeByWorkflowId.values()),u=c.next();!u.done;u=c.next()){var l=u.value;try{for(var p=(n=void 0,r(l.workflow.inputTypes)),f=p.next();!f.done;f=p.next()){var d=f.value;-1!==e.workflow.outputTypes.indexOf(d)&&this.addWorkflowChain(e,l)}}catch(e){n={error:e}}finally{try{f&&!f.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}try{for(var h=(s=void 0,r(l.workflow.outputTypes)),g=h.next();!g.done;g=h.next()){var y=g.value;-1!==e.workflow.inputTypes.indexOf(y)&&this.addWorkflowChain(l,e)}}catch(e){s={error:e}}finally{try{g&&!g.done&&(a=h.return)&&a.call(h)}finally{if(s)throw s.error}}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(t)throw t.error}}},e.prototype.addWorkflowChain=function(e,t){e.downstreamWorkflows.add(t),t.upstreamWorkflows.add(e)},e}();o.WorkflowGraph=u;var l=function(e){this.upstreamWorkflows=new Set,this.downstreamWorkflows=new Set,this.workflow=n(n({},e),{inputTypes:Array.isArray(e.inputTypes)?e.inputTypes:[],outputTypes:Array.isArray(e.outputTypes)?e.outputTypes:[]})}},{17:17,31:31}],45:[function(e,t,o){"use strict";var n=e("valuesHelper"),r=e("readHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.WorkflowItemStorage=void 0;var i=e(31),s=function(){function e(e,t){this.scopeItemsByContextId=new Map,this.scopeItemsByContextIdAndType=new Map,this.itemsByWorkflowAndContextId=new Map,this.workflowDefinitionManager=e,this.changeGateContextIdV2=null!=t&&t}return e.prototype.setScopeItem=function(e,t){var o,n=e.contextId;if(n)if(this.itemsByWorkflowAndContextId.has(t.id)||this.itemsByWorkflowAndContextId.set(t.id,new Map),this.itemsByWorkflowAndContextId.get(t.id).set(n,[]),this.changeGateContextIdV2)if(this.scopeItemsByContextId.has(n)){if(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.has(n)){var r=new i.Operation({resultDescription:"Trying to set new scope item: ".concat(e.id," with already existing contextId ").concat(n," for workflow ").concat(t.id),operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();i.Log.verbose(527291288,i.LogCategory.CoreDefault,r.stop())}}else this.scopeItemsByContextId.set(n,e);else{this.scopeItemsByContextIdAndType.has(n)||this.scopeItemsByContextIdAndType.set(n,new Map);var s=this.scopeItemsByContextIdAndType.get(n);if(s.has(t.collectionScopeType)){r=new i.Operation({resultDescription:"Trying to set new scope item: ".concat(e.id," with already existing contextId ").concat(n," for workflow ").concat(t.id),operationName:"WIS.setScopeItem",resourceId:t.id,success:!0}).start();i.Log.verbose(526403807,i.LogCategory.CoreDefault,r.stop())}else s.set(t.collectionScopeType,e)}},e.prototype.getScopeItem=function(e,t){var o,r,i,s;if(this.changeGateContextIdV2)try{for(var a=n((null===(i=this.itemsByWorkflowAndContextId.get(t.id))||void 0===i?void 0:i.keys())||[]),c=a.next();!c.done;c=a.next()){var u=c.value;if(e.startsWith(u))return this.scopeItemsByContextId.get(u)}}catch(e){o={error:e}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}else if(null===(s=this.itemsByWorkflowAndContextId.get(t.id))||void 0===s?void 0:s.has(e))return this.scopeItemsByContextIdAndType.get(e).get(t.collectionScopeType)},e.prototype.addItemToWorkflowList=function(e,t){var o,s,a,c;if(this.changeGateContextIdV2){var u=e.contextId;if(!u)return;if(y=this.itemsByWorkflowAndContextId.get(t.id))try{for(var l=n(y),p=l.next();!p.done;p=l.next()){var f=r(p.value,2),d=f[0],h=f[1];if(u.startsWith(d)){h.push(e);var g=new i.Operation({resultDescription:"Items for contextId ".concat(d,": [").concat(h.map((function(e){return e.id})).join(","),"]"),operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();i.Log.info(526403808,i.LogCategory.CoreDefault,g.stop())}}}catch(e){o={error:e}}finally{try{p&&!p.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}}else{var y,m=e.contextId;if(y=this.itemsByWorkflowAndContextId.get(t.id)){null===(a=y.get(m))||void 0===a||a.push(e);g=new i.Operation({resultDescription:"Items for contextId ".concat(m,": [").concat(null===(c=y.get(m))||void 0===c?void 0:c.map((function(e){return e.id})).join(","),"]"),operationName:"WIS.addItemOnContextIdList",resourceId:t.id,success:!0}).start();i.Log.info(527291289,i.LogCategory.CoreDefault,g.stop())}}},e.prototype.isWorkflowReady=function(e,t){var o=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.getGeneratedItems(e,t).length>=o},e.prototype.getItemsToExecute=function(e,t){var o=this.getGeneratedItems(e,t);return this.itemsByWorkflowAndContextId.get(t.id).delete(e),o},e.prototype.onWorkflowExecuted=function(e,t){var o=e.contextId,n=this.itemsByWorkflowAndContextId.get(t.id);n&&(n.delete(o),0===n.size&&this.itemsByWorkflowAndContextId.delete(t.id)),this.hasWorkflowsAwaitingExecution(o)||(this.changeGateContextIdV2?this.scopeItemsByContextId.delete(o):this.scopeItemsByContextIdAndType.delete(o))},e.prototype.getGeneratedItems=function(e,t){var o;if(!(null===(o=this.itemsByWorkflowAndContextId.get(t.id))||void 0===o?void 0:o.get(e)))return[];var n=this.workflowDefinitionManager.getWorkflowDefinition(t,e).maxAnnotations;return this.itemsByWorkflowAndContextId.get(t.id).get(e).slice(0,n)},e.prototype.hasWorkflowsAwaitingExecution=function(e){var t,o,r,i;try{for(var s=n(this.itemsByWorkflowAndContextId.values()),a=s.next();!a.done;a=s.next()){var c=a.value;try{for(var u=(r=void 0,n(c.keys())),l=u.next();!l.done;l=u.next()){if(l.value===e)return!0}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(t)throw t.error}}return!1},e}();o.WorkflowItemStorage=s},{31:31}],46:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(47),o)},{47:47}],47:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ModelDownloader=void 0;var n,r=e(31),i=e(148),s=e(144),a="undefined"!=typeof fetch?fetch:s;!function(e){e.URL="URL",e.ArrayBuffer="ArrayBuffer"}(n||(n={}));var c=function(){function e(e,t,o){var n=this;this.dbName="ALModels_db",this.osName="ALModels_os",this.dbVersion=1,this.baseURL="https://".concat(t,"/web/").concat(e),this.checkIdbByFeatures=null==o?void 0:o.checkIdbByFeatures;var i=new r.Operation({operationName:"CreateModelDownloader",success:!0,resultDescription:""});i.start(),this.isBrowserIdbCompatible().then((function(e){if(e){var t,o=0,s=0,a=0,c=new Promise((function(e,o){t=setTimeout((function(){o(new Error("Took longer than ".concat(1e4," ms")))}),1e4)})),u=n.accessDB().then((function(e){var t=e.transaction(n.osName,"readwrite");return t.objectStore(n.osName).openCursor().then((function e(n){if(a++,n){var r=n.value;r.timesSinceUsage||(r.timesSinceUsage=0),r.timesSinceUsage++;var i=void 0;return r.timesSinceUsage>5?(s++,i=n.delete()):(o++,i=n.update(r)),i.then((function(){return n.continue()})).then(e)}return t.done}))}));n.initPromise=Promise.race([c,u]).catch((function(e){i.success=!1,i.resultDescription+="".concat(e.message," ")})).then((function(){i.dimension0="".concat(a),i.dimension1="".concat(o),i.dimension2="".concat(s),clearTimeout(t),n.closeDBAndEndLog(i,"initializing idb storage")}))}else i.resultDescription="Incompatible browser for IDB",r.Log.info(538706242,r.LogCategory.CoreDefault,i.stop())})).catch((function(){i.resultDescription="Issue determining idb compatibility",r.Log.info(536966936,r.LogCategory.CoreDefault,i.stop())}))}return e.prototype.getResourceAsArrayBuffer=function(e,t){var o=new r.Operation({operationName:"GetResource",success:!0,resultDescription:"",dimension0:n.ArrayBuffer,dimension1:e,dimension2:t});o.start();var i={};return this.getResource(e,t,n.ArrayBuffer,o,(function(e){return Promise.all(Array.from(e.keys()).map((function(t){var o=e.get(t);return o.arrayBuffer?o.arrayBuffer().then((function(e){i[t]=e})):new Promise((function(e,n){var r=new FileReader;r.readAsArrayBuffer(o),r.onload=function(o){var r=o.target.result;r instanceof ArrayBuffer?(i[t]=r,e()):n(new Error("Unable to obtain ArrayBuffer"))}}))})))})).then((function(){return i}))},e.prototype.getResourceAsURL=function(e,t){var o=new r.Operation({operationName:"GetResource",success:!0,resultDescription:"",dimension0:n.URL,dimension1:e,dimension2:t});o.start();var i={};return this.getResource(e,t,n.URL,o,(function(e){return Promise.all(Array.from(e.keys()).map((function(t){i[t]=URL.createObjectURL(e.get(t))})))})).then((function(){return i}))},e.prototype.getResource=function(e,t,o,n,r){var i=this;return this.getIndexedDBFiles(e,t,n).then((function(e){return r(e)})).then((function(){i.closeDBAndEndLog(n,"retrieving ".concat(e))})).catch((function(t){throw n.resultDescription!=="".concat(t.message," ")&&(n.success=!1,n.resultDescription+="".concat(t.message," ")),n.resultSignature="Issue retrieving from CDN or translating to ".concat(o),i.closeDBAndEndLog(n,"retrieving ".concat(e)),t}))},e.prototype.checkFirefoxCompatibility=function(e){var t=window.navigator.userAgent.substring(e+8,e+11);return t.replace(".",""),parseInt(t,10)<=70?new Promise((function(e,t){var o=window.indexedDB.open(this.dbName,this.dbVersion);o.onsuccess=function(){e(!0)},o.onerror=function(e){return t(e),!0}})):Promise.resolve(!0)},e.prototype.isBrowserIdbCompatible=function(){var e,t;return"undefined"==typeof Array||void 0===Array.from||"undefined"==typeof Proxy||"undefined"==typeof URL||void 0===URL.createObjectURL?Promise.resolve(!1):"undefined"!=typeof window&&(null===(e=window.navigator)||void 0===e?void 0:e.userAgent)?window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1?window.indexedDB?this.checkFirefoxCompatibility(window.navigator.userAgent.toLowerCase().indexOf("firefox")):Promise.resolve(!1):window.navigator.userAgent.toLowerCase().indexOf("safari")>-1&&window.navigator.userAgent.toLowerCase().indexOf("chrome")<=-1?this.checkIdbByFeatures&&(null===(t=window.document)||void 0===t?void 0:t.hasStorageAccess)?window.document.hasStorageAccess().then((function(){return!0})).catch((function(){return!1})):Promise.resolve(!1):Promise.resolve(!0):Promise.resolve(!1)},e.prototype.accessDB=function(){var e=this;return this.accessDBPromise?this.accessDBPromise.then((function(e){return e.transaction("ALModels_os").done})).then((function(){return e.accessDBPromise})).catch((function(){return e.callOpenDB()})):this.callOpenDB()},e.prototype.callOpenDB=function(){var e=this;return this.accessDBPromise=(0,i.openDB)(this.dbName,this.dbVersion,{upgrade:function(t){t&&!t.objectStoreNames.contains(e.osName)&&t.createObjectStore(e.osName,{keyPath:"modelId"})}})},e.prototype.endLog=function(e,t){e.success?(e.resultDescription="Success ".concat(t),r.Log.info(573329487,r.LogCategory.CoreDefault,e.stop())):(e.resultDescription+="error ".concat(t),r.Log.error(573329488,r.LogCategory.CoreDefault,e.stop()))},e.prototype.closeDBAndEndLog=function(e,t){var o=this;this.accessDBPromise?this.accessDBPromise.then((function(e){e.close()})).catch((function(t){e.resultDescription!=="".concat(t.message," ")&&(e.success=!1,e.resultDescription+="".concat(t.message?t.message:"Error closing db"," "),e.resultSignature="Issue closing db")})).then((function(){o.accessDBPromise=void 0,o.endLog(e,t)})):this.endLog(e,t)},e.prototype.getIndexedDBFiles=function(e,t,o){var n=this;return this.isBrowserIdbCompatible().catch((function(e){return o.success=!1,o.resultDescription+="".concat(e.message," "),o.resultSignature="Issue determining idb compatibility",!1})).then((function(r){return r?n.initPromise.catch((function(e){o.success=!1,o.resultDescription+="".concat(e.message," "),o.resultSignature="Issue initializing"})).then((function(){return n.getModel(e)})).then((function(e){return e&&e.model&&e.version==t?Promise.resolve(e.model):Promise.reject()})).catch((function(r){return r&&(o.resultDescription!=="".concat(r.message," ")&&(o.success=!1,o.resultDescription+="".concat(r.message," ")),o.resultSignature="Issue retrieving from DB"),n.downloadFiles(e,t)})).then((function(r){return n.putModel(e,r,t).then((function(){return r})).catch((function(e){return o.resultDescription!=="".concat(e.message," ")&&(o.success=!1,o.resultDescription+="".concat(e.message," ")),o.resultSignature="Issue adding to DB",r}))})):n.downloadFiles(e,t)}))},e.prototype.downloadFiles=function(e,t){var o=this;return a("".concat(this.baseURL,"/catalog_").concat(e,"_").concat(t,".json")).then((function(e){if(e.ok)return e.text();throw new Error("CDN download response status: ".concat(e.status))})).then((function(n){var r=JSON.parse(n),i="".concat(r.MajorVersion,".").concat(r.MinorVersion,"/ModelResources"),s="".concat(e,"/").concat(t,"/");return Promise.all(r.Resources.map((function(e){return e.Name.length>s.length&&e.Name.substring(0,s.length)===s&&(e.Name=e.Name.substring(s.length)),a("".concat(o.baseURL,"/").concat(i,"/").concat(s).concat(e.Name,".").concat(e.Type)).then((function(e){if(e.ok)return e.blob();throw new Error("CDN download response status: ".concat(e.status))})).then((function(t){return["".concat(e.Name,".").concat(e.Type),t]}))})))})).then((function(e){return new Map(e)}))},e.prototype.getModel=function(e){var t=this;return this.accessDB().then((function(o){return o.get(t.osName,e)}))},e.prototype.putModel=function(e,t,o){var n=this;return this.accessDB().then((function(r){return r.put(n.osName,{modelId:e,model:t,version:o,timesSinceUsage:0})}))},e}();o.ModelDownloader=c},{144:144,148:148,31:31}],48:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ALFactoryGlobal=o.AugLoopFactory=void 0;var n=e(49),r=e(64),i=function(){function e(){this._augLoopRuntimeManager=new n.AugLoopRuntimeManager}return e.prototype.getAugLoopRuntimeManager=function(){return this._augLoopRuntimeManager},e.prototype.createSingleItemWorkflow=function(e){return r.SingleItemWorkflow.create(e)},e}();o.AugLoopFactory=i,o.ALFactoryGlobal=new i},{49:49,64:64}],49:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.AugLoopRuntimeManager=o.IdentityProvider=void 0;var n=e(64),r=e(3),i=e(90);Object.defineProperty(o,"IdentityProvider",{enumerable:!0,get:function(){return i.IdentityProvider}});var s=e(46),a=e(51),c=e(136),u=e(137),l=e(138),p=e(14),f=e(55),d=function(e,t){for(var o,n=[],r=0,i=Object.keys(e);r<i.length;r++){var s=i[r];if(void 0!==e[s]&&null!==e[s]){var a={name:t?"".concat(t,".").concat(s):s,dataType:(o=e[s],"string"==typeof o?0:"boolean"==typeof o?1:"number"==typeof o?2:void l.ULS.sendTraceTag(572838285,c.LogCategory.msoulscat_Wac_BrowserGeneral,u.TraceLevel.Warning,"Unsupported data field type")),value:e[s],classification:4};n.push(a)}}return n},h=function(e){return Promise.resolve(!1)},g=function(){var e=this;this._telemetryAggregationIntervalSec=30,this._eventHandlerDictionary={},this.initialize=function(t){if(e._runtimeInitPromise)l.ULS.sendTraceTag(572838286,c.LogCategory.msoulscat_Wac_BrowserGeneral,u.TraceLevel.Info,"Runtime already initialized");else{l.ULS.sendTraceTag(572838287,c.LogCategory.msoulscat_Wac_BrowserGeneral,u.TraceLevel.Info,"Start and initialize augloop runtime ..."),e.checkParametersAndThrow("initialize",t);var o=e.isFeatureEnabled("ModelDownloaderEbrake","None").then((function(o){o?l.ULS.sendTraceTag(556376070,c.LogCategory.msoulscat_Wac_BrowserGeneral,u.TraceLevel.Info,"Resource downloader not created due to feature gate"):e.modelDownloaderFromCDN=t.appName&&t.downloadBaseUrl?new s.ModelDownloader(t.appName,t.downloadBaseUrl):void 0}));e.inferenceServiceFactory=t.appName&&t.inferenceServiceVersion?a.OnnxInferenceService.createFactory(t.appName,t.inferenceServiceVersion):void 0,e.excelServerParameters=t.excelServer,e.powerpointParameters=t.powerpoint;var i={appName:t.appName,appPlatform:"Web",appVersion:t.appVersion,uiLanguage:t.uiLanguage,releaseAudienceGroup:t.releaseAudienceGroup,releaseChannel:t.releaseChannel,releaseFork:t.releaseFork,sessionId:t.sessionId,flights:t.flights,privateMode:t.privateMode,disabledServiceGroups:t.disabledServiceGroups},p={onResult:e.onResult.bind(e),onAnnotationResult:e.onAnnotationResult.bind(e),sendTelemetryEvent:e.sendTelemetryEvent.bind(e),requestAuthToken:e.requestAuthToken.bind(e),isFeatureEnabled:e.isFeatureEnabled.bind(e),setSessionData:e.setSessionData.bind(e),areLicenseFeaturesEnabled:h,onInitSession:e.onInitSession.bind(e),overrideSessionInitMessage:e.overrideSessionInitMessage.bind(e)},f=o.then((function(){return n.runtime.init(t.serviceUrl,i,p,{telemetryAggregationIntervalSec:e._telemetryAggregationIntervalSec,modelDownloader:e.modelDownloaderFromCDN,inferenceServiceFactory:e.inferenceServiceFactory})})).then((function(){return r.runtimeALv1.init(t.serviceUrl,i,p)}));e.createSession=function(){e._runtimeInitPromise=f.then((function(){return n.runtime.createSession(t.sessionCreationOptions)}))},e.createSession()}},this.getSession=function(){return e._runtimeInitPromise},this.setULSLogger=function(t){e.checkParametersAndThrow("setULSLogger",t&&t.ulsLogger),l.ULS.setLogger(t.ulsLogger)},this.setSendOTelEventCallback=function(t){e.checkParametersAndPropertyAndThrow("setSendOTelEventCallback",t&&t.sendOTelEvent,e._sendOTelEventCallback),e._sendOTelEventCallback=t.sendOTelEvent},this.setRequestAuthTokenCallback=function(t){e.checkParametersAndPropertyAndThrow("setRequestAuthTokenCallback",t&&t.requestAuthTokenCallback,e._requestAuthTokenCallback),e._requestAuthTokenCallback=t.requestAuthTokenCallback},this.setIsFeatureEnabledCallback=function(t){e.checkParametersAndPropertyAndThrow("setIsFeatureEnabledCallback",t&&t.featureEnabledCallback,e._featureEnabledCallback),e._featureEnabledCallback=t.featureEnabledCallback},this.registerLocalWorkflow=function(t){e.checkParametersAndThrow("registerLocalWorkflow",t&&t.workflow),e.checkRuntimeInitAndThrow("registerLocalWorkflow"),e._runtimeInitPromise.then((function(e){e.registerLocalWorkflow(t.workflow)}))},this.activateAnnotation=function(t){var o=e.checkParameters("activateAnnotation",t&&t.annotationType)||e.checkRuntimeInit("activateAnnotation");return o?Promise.reject(o):e._runtimeInitPromise.then((function(e){var o;return(t.handler||t.stateUpdateHandler)&&(o={callback:t.handler,stateUpdateCallback:t.stateUpdateHandler}),e.activateAnnotation(t.annotationType,o)}))},this.updateAnnotationConfig=function(t){var o=e.checkParameters("updateAnnotationConfig",t&&t.token&&t.config)||e.checkRuntimeInit("updateAnnotationConfig");return o?Promise.reject(o):e._runtimeInitPromise.then((function(e){e.updateAnnotationConfig(t.token,t.config)}))},this.releaseAnnotation=function(t){var o=e.checkParameters("releaseAnnotation",t&&t.token)||e.checkRuntimeInit("releaseAnnotation");return o?Promise.reject(o):e._runtimeInitPromise.then((function(e){return e.releaseAnnotation(t.token)}))},this.submitOperation=function(t){e.checkParametersAndThrow("submitOperation",t&&t.operation),e.checkRuntimeInit("submitOperation"),e._runtimeInitPromise.then((function(e){e.submitOperation(t.operation)}))},this.setSessionDataCallback=function(t){e.checkParametersAndPropertyAndThrow("setSessionDataCallback",t&&(t.sessionDataCallback||t.handler),e._setSessionDataCallback),t.sessionDataCallback?e._setSessionDataCallback=t.sessionDataCallback:t.handler&&(e._setSessionDataCallback=function(e,o,n){return t.handler(e,o)})},this.setAnnotationResultCallback=function(t){if(e.checkParametersAndThrow("setAnnotationResultCallback",t&&t.handler),e._annotationResultCallback){var o="".concat("setAnnotationResultCallback"," already called");l.ULS.sendTraceTag(537401028,c.LogCategory.msoulscat_Wac_BrowserGeneral,u.TraceLevel.Error,o)}e._annotationResultCallback=t.handler},this.setAnnotationState=function(t){e.checkParametersAndThrow("setAnnotationState",t&&t.parentPath&&t.id&&t.value),e.checkRuntimeInitAndThrow("setAnnotationState"),e._runtimeInitPromise.then((function(e){e.setAnnotationState(t.parentPath,t.id,t.value)}))},this.setAnnotationMetadata=function(t){e.checkParametersAndThrow("setAnnotationMetadata",t&&t.parentPath&&t.id&&t.value),e.checkRuntimeInitAndThrow("setAnnotationMetadata"),e._runtimeInitPromise.then((function(e){e.setAnnotationMetadata(t.parentPath,t.id,t.value)}))},this.setInitSessionCallback=function(t){e.checkParametersAndPropertyAndThrow("setInitSessionCallback",t&&t.initSessionCallback,e._initSessionCallback),e._initSessionCallback=t.initSessionCallback},this.setSessionInitOverrideCallback=function(t){e.checkParametersAndPropertyAndThrow("setSessionInitOverrideCallback",t&&t.handler,e._sessionInitOverrideCallback),e._sessionInitOverrideCallback=t.handler},this.forceReconnectSession=function(t){var o=e.checkParameters("forceReconnectSession",t)||e.checkRuntimeInit("forceReconnectSession");return o?Promise.reject(o):e._runtimeInitPromise.then((function(o){return t.excelServerParameters&&(e.excelServerParameters=t.excelServerParameters),o.forceReconnect()}))},this.setSessionCloseCallback=function(t){var o=e.checkParameters("setSessionCloseCallback",t&&t.callback)||e.checkRuntimeInit("setSessionCloseCallback");return o?Promise.reject(o):e._runtimeInitPromise.then((function(e){e.setSessionCloseCallback(t.callback)}))},this.submitCustomMessage=function(t){var o=e.checkParameters("submitCustomMessage",t&&t.message)||e.checkRuntimeInit("submitCustomMessage");return o?Promise.reject(o):e._runtimeInitPromise.then((function(e){return e.submitCustomMessage(t.message)}))},this.closeSession=function(){var t=e.checkRuntimeInit("closeSession");return t?Promise.reject(t):e._runtimeInitPromise.then((function(e){e.close()}))},this.startNewSession=function(){if(!e.createSession){var t="startNewSession called before runtime init";throw l.ULS.sendTraceTag(537408074,c.LogCategory.msoulscat_Wac_BrowserGeneral,u.TraceLevel.Error,t),new Error(t)}e.createSession()},this.submit=function(t){e.checkParametersAndThrow("submit",t&&t.inputSchema&&t.input),e.checkRuntimeInitAndThrow("submit"),e._runtimeInitPromise.then((function(){r.runtimeALv1.submit(t.inputSchema,t.input,t.correlationVector)}))},this.addEventHandler=function(t){e.checkParametersAndThrow("addEventHandler",t&&t.schemaName&&t.handler);var o=e._eventHandlerDictionary[t.schemaName]||[];o.push(t.handler),e._eventHandlerDictionary[t.schemaName]=o},this.removeEventHandler=function(t){e.checkParametersAndThrow("removeEventHandler",t&&t.schemaName&&t.handler);var o=e._eventHandlerDictionary[t.schemaName];if(Array.isArray(o)){var n=o.indexOf(t.handler);n>=0&&o.splice(n,1)}},this.registerSimpleRemoteWorkflow=function(t){var o=e.checkParameters("registerSimpleRemoteWorkflow",t&&t.name&&t.lambdaRemote)||e.checkRuntimeInit("registerSimpleRemoteWorkflow");return o?Promise.reject(o):e._runtimeInitPromise.then((function(){return r.runtimeALv1.registerSimpleRemoteWorkflow(t.name,t.lambdaBefore,t.lambdaRemote,t.lambdaAfter)}))},this.registerSimpleLocalWorkflow=function(t){var o=e.checkParameters("registerSimpleLocalWorkflow",t&&t.name&&t.lambda)||e.checkRuntimeInit("registerSimpleLocalWorkflow");return o?Promise.reject(o):e._runtimeInitPromise.then((function(){return r.runtimeALv1.registerSimpleLocalWorkflow(t.name,t.lambda)}))},this.registerReduceWorkflow=function(e){return Promise.resolve()},this.registerSchemas=function(e){return Promise.resolve()},this.onResult=function(t,o,n,r){var i=e._eventHandlerDictionary[n];if(i)for(var s=0,a=i;s<a.length;s++){var c=a[s];c&&c({inputSchema:t,input:o,outputSchema:n,output:r})}},this.onAnnotationResult=function(t){e._annotationResultCallback&&e._annotationResultCallback(t)},this.requestAuthToken=function(t){return e._requestAuthTokenCallback?(e._requestAuthTokenCallback(t)||Promise.resolve("")).then((function(e){var t=e||"";return Promise.resolve({Token:t})})):Promise.resolve({Token:""})},this.sendTelemetryEvent=function(t,o,n,r,i,s,a,c){e._sendOTelEventCallback&&e._sendOTelEventCallback(function(e,t,o,n,r,i,s){var a={telemetryProperties:{ariaTenantToken:e,nexusTenantToken:-1},eventName:t.split("_").join("."),dataFields:d(o),eventFlags:{dataCategories:i,diagnosticLevel:s,samplingPolicy:1}};return n&&(a.eventContract={name:n,dataFields:d(r,n.split(".").slice(-1)[0])}),a}(t,o,n,r,i,a,c))},this.isFeatureEnabled=function(t,o){if(!t)return Promise.resolve(!1);var n="Microsoft.Office.AugLoop.";if(0===t.indexOf(n)&&e._featureEnabledCallback){var r=t.slice(n.length);return Promise.resolve(e._featureEnabledCallback(r))}return Promise.resolve(!1)},this.setSessionData=function(t,o,n){e._setSessionDataCallback&&e._setSessionDataCallback(t,o,n)},this.overrideSessionInitMessage=function(t){return e._sessionInitOverrideCallback?e._sessionInitOverrideCallback(t):0===t.clientMetadata.appName.indexOf("Excel")&&e.excelServerParameters?e.overrideExcelSessionInitMessage(t):0===t.clientMetadata.appName.indexOf("PowerPoint")&&e.powerpointParameters?e.overridePowerPointSessionInitMessage(t):t},this.overrideExcelSessionInitMessage=function(t){for(var o={cluster:e.excelServerParameters.wacCluster,restUrl:e.excelServerParameters.ecsRestUrl,ecsId:e.excelServerParameters.ecsSessionId,ecsOperationUrl:e.excelServerParameters.ecsOperationUrl,workbookMetadataVersion:e.excelServerParameters.metadataVersion,serverEventVersion:e.excelServerParameters.serverEventVersion,permissionFlags:e.excelServerParameters.permissionFlags,configurations:e.excelServerParameters.configurations,collabUserListVersion:e.excelServerParameters.userListVersion,collabStateId:e.excelServerParameters.collabStateId,accessToken:e.excelServerParameters.accessToken,accessTokenTTL:e.excelServerParameters.accessTokenTTL,supportCustomMessages:e.excelServerParameters.supportCustomMessages},n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];o[i]=t[i]}return new p.ExcelServerSessionInitMessage(o)},this.overridePowerPointSessionInitMessage=function(t){for(var o={downloadUrl:e.powerpointParameters.downloadUrl,getItemsEndPoint:e.powerpointParameters.getItemsEndPoint,documentOpenType:e.powerpointParameters.documentOpenType},n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];o[i]=t[i]}return new f.PowerPointSessionInitMessage(o)},this.onInitSession=function(){return e._initSessionCallback?e._initSessionCallback():Promise.resolve()},this.checkParameters=function(e,t){if(!t){var o="".concat(e," called with invalid parameters");return l.ULS.sendTraceTag(537408075,c.LogCategory.msoulscat_Wac_BrowserGeneral,u.TraceLevel.Error,o),new Error(o)}},this.checkParametersAndThrow=function(t,o){var n=e.checkParameters(t,o);if(n)throw n},this.checkParametersAndPropertyAndThrow=function(t,o,n){if(e.checkParametersAndThrow(t,o),n){var r="".concat(t," already called");throw l.ULS.sendTraceTag(537408076,c.LogCategory.msoulscat_Wac_BrowserGeneral,u.TraceLevel.Error,r),new Error(r)}},this.checkRuntimeInit=function(t){if(!e._runtimeInitPromise){var o="".concat(t," called before runtime init");return l.ULS.sendTraceTag(537408077,c.LogCategory.msoulscat_Wac_BrowserGeneral,u.TraceLevel.Error,o),new Error(o)}},this.checkRuntimeInitAndThrow=function(t){var o=e.checkRuntimeInit(t);if(o)throw o}};o.AugLoopRuntimeManager=g},{136:136,137:137,138:138,14:14,3:3,46:46,51:51,55:55,64:64,90:90}],50:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ALFactoryGlobal=void 0;var n=e(48);Object.defineProperty(o,"ALFactoryGlobal",{enumerable:!0,get:function(){return n.ALFactoryGlobal}})},{48:48}],51:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(53),o)},{53:53}],52:[function(e,t,o){"use strict";var n=e("awaiterHelper"),r=e("generatorHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.Inputs=o.Model=o.lackingPromiseOrWasmSupport=void 0;var i=e(31);o.lackingPromiseOrWasmSupport=function(e){var t="";if("undefined"!=typeof window&&window.navigator&&window.navigator.userAgent){var o=window.navigator.userAgent;!o.indexOf||o.indexOf("MSIE ")>0||o.indexOf("Trident/")>0?t="Error: IE lacks necessary support":"undefined"==typeof Promise?t="Error: Promise is not supported":"undefined"==typeof WebAssembly&&(t="Error: WASM is not supported")}else t="Error: No window userAgent";return""!=t&&(e.resultDescription=t,i.Log.info(540406806,i.LogCategory.CoreDefault,e.stop()),!0)};var s=function(){function e(e,t,o){this.session=e,this.onnxObject=o,this.modelName=t}return e.create=function(t,o,s){return n(this,void 0,void 0,(function(){var n;return r(this,(function(r){return(n=new i.Operation({operationName:"CreateModelForInferencing",success:!0,resourceId:o})).start(),[2,this.getInferenceSession(s).create(t).then((function(t){return i.Log.info(540406807,i.LogCategory.CoreDefault,n.stop()),new e(t,o,s)})).catch((function(e){throw n.resultDescription="Error: ".concat(e),i.Log.info(540406808,i.LogCategory.CoreDefault,n.stop()),e}))]}))}))},e.getInferenceSession=function(e){if(null==e?void 0:e.InferenceSession)return e.InferenceSession;throw new Error("InferenceSession is not defined")},e.prototype.run=function(e){var t;return n(this,void 0,void 0,(function(){var o,n,s,a=this;return r(this,(function(r){if((o=new i.Operation({operationName:"RunModelForInferencing",success:!0,resourceId:this.modelName})).start(),null===(t=this.onnxObject)||void 0===t?void 0:t.Tensor)return n=e.getInputs(),s={},Object.keys(n).forEach((function(e){var t=n[e];if(Array.isArray(t.values)&&t.values.length>0&&"boolean"==typeof t.values[0]){var o=new Uint8Array(t.values);s[e]=new a.onnxObject.Tensor(o,t.dimensions)}else s[e]=new a.onnxObject.Tensor(t.values,t.dimensions)})),[2,this.session.run(s).then((function(e){return i.Log.info(540406809,i.LogCategory.CoreDefault,o.stop()),new c(e)})).catch((function(e){o.resultDescription="Problem running model. ".concat(e.message),i.Log.info(540406810,i.LogCategory.CoreDefault,o.stop())}))];throw o.resultDescription="Unable to run model. Tensor not defined",i.Log.info(540406811,i.LogCategory.CoreDefault,o.stop()),new Error("Tensor is not defined")}))}))},e}();o.Model=s;var a=function(){function e(){this.map={}}return e.create=function(){return new e},e.prototype.getInputs=function(){return this.map},e.prototype.add=function(e,t,o){return this.map[e]={dimensions:t,values:o},this},e}();o.Inputs=a;var c=function(e){for(var t=0,o=Object.keys(e);t<o.length;t++){var n=o[t];this[n]=new u(n,e[n])}},u=function(){function e(e,t){this.resultName=e,this.result=t}return e.prototype.name=function(){return this.resultName},e.prototype.outputType=function(){switch(this.result.type){case"string":return 7;case"int8":return 4;case"int16":return 5;case"int32":return 6;case"bool":return 1;case"uint8":return 8;case"uint16":return 9;case"uint32":return 10;case"float32":return 2;case"float64":return 3;default:throw new Error("The output type ".concat(this.result.type," is not supported."))}},e.prototype.dimensions=function(){return this.result.dims},e.prototype.asBooleans=function(){if(1===this.outputType())return this.result.data.map((function(e){return!!e}));throw new Error("asBooleans() was called; however, outputType() is ".concat(this.outputType(),", not Type.Booleans."))},e.prototype.asFloat32s=function(){if(2===this.outputType())return this.result.data;throw new Error("asFloat32s() was called; however, outputType() is ".concat(this.outputType(),", not Type.Float32s."))},e.prototype.asFloat64s=function(){if(3===this.outputType())return this.result.data;throw new Error("asFloat64s() was called; however, outputType() is ".concat(this.outputType(),", not Type.Float64s."))},e.prototype.asInt8s=function(){if(4===this.outputType())return this.result.data;throw new Error("asInt8s() was called; however, outputType() is ".concat(this.outputType(),", not Type.Int8s."))},e.prototype.asInt16s=function(){if(5===this.outputType())return this.result.data;throw new Error("asInt16s() was called; however, outputType() is ".concat(this.outputType(),", not Type.Int16s."))},e.prototype.asInt32s=function(){if(6===this.outputType())return this.result.data;throw new Error("asInt32s() was called; however, outputType() is ".concat(this.outputType(),", not Type.Int32s."))},e.prototype.asStrings=function(){if(7===this.outputType())return this.result.data;throw new Error("asStrings() was called; however, outputType() is ".concat(this.outputType(),", not Type.Strings."))},e.prototype.asUnsignedInt8s=function(){if(8===this.outputType())return this.result.data;throw new Error("asUnsignedInt8s() was called; however, outputType() is ".concat(this.outputType(),", not Type.UnsignedInt8s."))},e.prototype.asUnsignedInt16s=function(){if(9===this.outputType())return this.result.data;throw new Error("asUnsignedInt16s() was called; however, outputType() is ".concat(this.outputType(),", not Type.UnsignedInt16s."))},e.prototype.asUnsignedInt32s=function(){if(10===this.outputType())return this.result.data;throw new Error("asUnsignedInt32s() was called; however, outputType() is ".concat(this.outputType(),", not Type.UnsignedInt32s."))},e}()},{31:31}],53:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.OnnxInferenceService=void 0;var n=e(54),r=function(){function e(){}return e.createFactory=function(t,o){var r=this;return function(){if(e.onnxRetrievalPromise)return e.onnxRetrievalPromise;return(0,n.createFactory)((function(){return t&&o?new Promise((function(n,i){var s=document.createElement("script");s.src=r.createCdnUrl(t,o),s.onload=function(){var t;(null===(t=null===window||void 0===window?void 0:window.top)||void 0===t?void 0:t.ort)&&window.top.ort.InferenceSession&&window.top.ort.Tensor?(e.onnxRetrievalPromise=Promise.resolve(new e),n("Success creating inference service")):(s.remove(),i(new Error("ort.Tensor and/or ort.InferenceSession are undefined")))},s.onerror=i,document.body.appendChild(s)})):Promise.reject(new Error("Error: appName and/or version not provided"))})).catch((function(t){e.onnxRetrievalPromise=Promise.reject(t)})).then((function(){return e.onnxRetrievalPromise}))}},e.createCdnUrl=function(e,t){return"https://".concat(e).concat(t)},e.prototype.createModel=function(e,t){var o;return(0,n.createModel)(e,t||"",null===(o=null===window||void 0===window?void 0:window.top)||void 0===o?void 0:o.ort)},e.prototype.createInputs=function(){return(0,n.createInputs)()},e}();o.OnnxInferenceService=r},{54:54}],54:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.createInputs=o.createModel=o.createFactory=void 0;var n=e(31),r=e(52);o.createFactory=function(e){var t=new n.Operation({operationName:"CreateOnnxInferenceService",success:!0,resultDescription:""});if(t.start(),(0,r.lackingPromiseOrWasmSupport)(t)){var o="Browser lacks necessary support for inference service";return t.success=!1,t.resultDescription=o,n.Log.info(540406803,n.LogCategory.CoreDefault,t.stop()),Promise.reject(new Error(o))}return e().then((function(e){t.resultDescription=e,n.Log.info(540406804,n.LogCategory.CoreDefault,t.stop())})).catch((function(e){throw t.success=!1,t.resultDescription=e.message,n.Log.info(540406805,n.LogCategory.CoreDefault,t.stop()),e}))},o.createModel=function(e,t,o){return r.Model.create(e,t,o)},o.createInputs=function(){return r.Inputs.create()}},{31:31,52:52}],55:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(56),o)},{56:56}],56:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.PowerPointSessionExtensionConfig=o.PowerPointSessionInitMessage=void 0;var n=e(114),r=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.PowerPointSessionInitMessage=r;var i=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionExtensionConfig"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.PowerPointSessionExtensionConfig=i},{114:114}],57:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationActivationTracker=void 0;var n=e(102),r=function(){function e(t,o,n){var r=this;this.sessionManager=t,this.annotationType=o,this.options=n,this.token="".concat(o,"-").concat(e.nextActivationResultBatchId++),this.promise=new Promise((function(e,t){r.resolve=e,r.reject=t}))}return e.prototype.asPromise=function(){return this.promise},e.prototype.activate=function(e){var t=this;this.sessionManager().sendMessage(new n.AnnotationActivationMessage({annotationType:this.annotationType,token:this.token,config:this.options?this.options.config:void 0,ignoreExistingAnnotations:e,sendStateUpdates:this.options?!!this.options.stateUpdateCallback:void 0}),(function(e,o){t.complete(e?new Error(e.error):void 0)}))},e.prototype.release=function(){var e=this;return new Promise((function(t,o){e.sessionManager().sendMessage(new n.AnnotationReleaseMessage({token:e.token}),(function(e,n){e?o(new Error(e.error)):t(n.lastRelease)}))}))},e.prototype.complete=function(e){this.isComplete||(this.isComplete=!0,e?this.reject(e):this.resolve({token:this.token}))},e.nextActivationResultBatchId=1,e}();o.AnnotationActivationTracker=r},{102:102}],58:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.OrderedAnnotationResultsProcessor=void 0;var n=e(59),r=function(){function e(e){this.annotationSequencer=null!=e?e:new n.AnnotationSequencer}return e.prototype.process=function(e,t,o,n){for(var r=[],i=function(e){var n=[];if(null==e?void 0:e.items)for(var i=function(o){var r=s.annotationSequencer.sequence(o.body).then((function(){t(e,o)}));n.push(r)},a=0,c=e.items;a<c.length;a++){i(c[a])}r.push(Promise.all(n).then((function(){o(e)})))},s=this,a=0,c=e.ops;a<c.length;a++){i(c[a])}Promise.all(r).then((function(){return n(e)}))},e}();o.OrderedAnnotationResultsProcessor=r},{59:59}],59:[function(e,t,o){"use strict";var n=e("awaiterHelper"),r=e("generatorHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationSequencer=void 0;var i=e(60),s=function(){function e(e,t){void 0===e&&(e=500),this.sequencerFactory=null!=t?t:new i.BufferingSequencerFactory(e)}return e.prototype.sequence=function(e){var t;return n(this,void 0,void 0,(function(){var o;return r(this,(function(n){switch(n.label){case 0:return(null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.seq)&&(o=this.sequencerFactory.create(e))?[4,o.sequence(e.metadata.seq)]:[2];case 1:return n.sent(),[2]}}))}))},e}();o.AnnotationSequencer=s},{60:60}],60:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.BufferingSequencerFactory=void 0;var n=e(13),r=function(){function e(e){void 0===e&&(e=500),this.bufferingTimeMs=500,this.workflowIdToSequencersMap=new Map,this.bufferingTimeMs=e}return e.prototype.create=function(e){if(!e.ownerId)return null;var t=this.workflowIdToSequencersMap.get(e.ownerId);return t||(t=new n.BufferingSequencer(this.bufferingTimeMs),this.workflowIdToSequencersMap.set(e.ownerId,t)),t},e}();o.BufferingSequencerFactory=r},{13:13}],61:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.RoutingAnnotationResultsProcessor=void 0;var n=e(58),r=e(62),i=function(){function e(e,t,o){this.isOrderingEnabled=e,this.orderedAnnotationResultsProcessor=null!=t?t:new n.OrderedAnnotationResultsProcessor,this.unorderedAnnotationResultsProcessor=null!=o?o:new r.UnorderedAnnotationResultsProcessor}return e.prototype.process=function(e,t,o,n){this.isOrderingEnabled()?this.orderedAnnotationResultsProcessor.process(e,t,o,n):this.unorderedAnnotationResultsProcessor.process(e,t,o,n)},e}();o.RoutingAnnotationResultsProcessor=i},{58:58,62:62}],62:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.UnorderedAnnotationResultsProcessor=void 0;var n=function(){function e(){}return e.prototype.process=function(e,t,o,n){for(var r=0,i=e.ops;r<i.length;r++){var s=i[r];if(null==s?void 0:s.items)for(var a=0,c=s.items;a<c.length;a++){t(s,c[a])}o(s)}n(e)},e}();o.UnorderedAnnotationResultsProcessor=n},{}],63:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.BatchManager=void 0;var n=e(31),r=e(90),i=function(){function e(e,t){this.batchesByGroupingKey=new Map,this.submit=e,this.onSummary=t}return e.prototype.addBatchItem=function(e,t,o,r,i,s){var a=this,c=t.delayMs,u=t.maxInputSize,l=t.estimateSize,p=t.groupingKeyExtractor,f=l(e),d=p(e);if(t.split&&f>u){var h;try{h=t.split(e)}catch(e){var g=new Error("Split error: "+e.message);return void(s?s(g):n.Log.error(573366352,n.LogCategory.CoreDefault,g))}if(h&&Array.isArray(h.inputs)&&h.inputs.length>1){for(var y,m=[],v=s?function(e,t){if(y=y||e,m.push(t),m.length===h.inputs.length){var o;try{o=h.join(m)}catch(e){return void s(new Error("Join error: "+e.message))}s(y,o)}}:void 0,T=0;T<h.inputs.length;T++){var S=h.inputs[T];this.addBatchItem(S,t,o,r,i&&T===h.inputs.length-1,v)}return}}var w=this.batchesByGroupingKey.get(d);w&&w.size+f>u&&(clearTimeout(w.timeout),this.executeBatch(d,w,t),w=void 0),w||(w={items:[],size:0,hasItemsWithCallbacks:!1,context:o},this.batchesByGroupingKey.set(d,w)),w.items.push({input:e,size:f,callback:s}),w.size+=f,w.hasItemsWithCallbacks=w.hasItemsWithCallbacks||!!s,w.cv=r,w.groupComplete=i,clearTimeout(w.timeout),w.groupComplete?this.executeBatch(d,w,t):w.timeout=setTimeout((function(){a.executeBatch(d,w,t)}),c)},e.prototype.removeAllBatchedItems=function(){this.batchesByGroupingKey.forEach((function(e){e.timeout&&clearTimeout(e.timeout)})),this.batchesByGroupingKey.clear()},e.prototype.executeBatch=function(e,t,o){var i=this;this.batchesByGroupingKey.delete(e);var s,a=t.items,c=function(e){return e<0?"Negative":0===e?"0":1===e?"1":"Magnitude ".concat(e.toString().length)},u=new n.Operation({operationName:"ExecuteBatch",cv:t.cv,resourceId:t.context.name,dimension0:"Count ".concat(c(a.length)),dimension1:"Size ".concat(c(t.size))}).start(),l=function(e,o,i){var s;if(o&&o.exceptionType===r.ExceptionType.NoOutput)u.success=!0,n.Log.info(573366353,n.LogCategory.CoreDefault,u.stop());else{var c="".concat(e," error: ").concat(o?o.message||o:"Unknown error");s=o||new Error(c),u.success=!1,u.resultDescription="Batch of ".concat(a.length," items of size ").concat(t.size," with ").concat(c),u.resultSignature="".concat(e," Error"),n.Log.error(573366354,n.LogCategory.CoreDefault,u.stop())}if(t.hasItemsWithCallbacks)for(var l=0,p=a;l<p.length;l++){var f=p[l];f.callback&&f.callback(s,i)}};try{s=o.multiplex(a.map((function(e){return e.input})))}catch(e){return void l("Multiplex",e)}this.submit(s.input,t,(function(e,r){var c;if(e||r&&("exceptionType"in r||r instanceof Error))l("Submit",e||r,r);else if(t.hasItemsWithCallbacks||o.summaryExtractor){var p=void 0;if(t.hasItemsWithCallbacks)try{if((p=s.demultiplex(r)).length!==a.length)throw new Error("Mismatched output length")}catch(e){return void l("Demultiplex",e)}var f=void 0,d=void 0;if(o.summaryExtractor)try{d=(c=o.summaryExtractor(r))[0],f=c[1]}catch(e){return void l("SummaryExtractor",e)}if(u.success=!0,n.Log.info(573366342,n.LogCategory.CoreDefault,u.stop()),t.hasItemsWithCallbacks)for(var h=0;h<a.length;h++)a[h].callback&&a[h].callback(void 0,p[h]);f&&i.onSummary(d,f,t.context)}else u.success=!0,n.Log.info(573366343,n.LogCategory.CoreDefault,u.stop())}))},e}();o.BatchManager=i},{31:31,90:90}],64:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(63),o),r(e(65),o),r(e(66),o),r(e(67),o),r(e(68),o),r(e(70),o),r(e(71),o),r(e(75),o),r(e(76),o),r(e(86),o),r(e(87),o)},{63:63,65:65,66:66,67:67,68:68,70:70,71:71,75:75,76:76,86:86,87:87}],65:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.isLargerThan=o.estimateSize=void 0;o.estimateSize=function(e){return n(e,Number.POSITIVE_INFINITY)};o.isLargerThan=function(e,t){return n(e,t)>t};var n=function(e,t){for(var o=0,n=[],r=[e];r.length>0;){var i=r.pop(),s=typeof i;if("boolean"===s)o+=4;else if("string"===s)o+=2*i.length;else if("number"===s)o+=8;else if("object"===s&&i&&-1===n.indexOf(i))if(i instanceof Uint8Array)o+=i.length;else for(var a in n.push(i),i)r.push(i[a]);if(o>t)return o}return o}},{}],66:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.internalFetch=void 0;var n=e(72),r=e(144);o.internalFetch=function(e,t,o){var n=new r.Request(e,t);return i.add(n,o)};var i=new n.SequentialFetchQueue(r,2e4,12e4)},{144:144,72:72}],67:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],68:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],69:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.LocalWorkflowContext=void 0;var n=e(130),r=function(){function e(e){this.model=e.model,this.clientMetadata=e.clientMetadata,this.site=e.site,this.getToken=e.getTokenCallback}return Object.defineProperty(e.prototype,"flights",{get:function(){var e;return null!==(e=this._flights)&&void 0!==e||(this._flights=(0,n.parseFlights)(this.clientMetadata.flights)),this._flights},enumerable:!1,configurable:!0}),e.prototype.getToken=function(e,t){return this.getToken(e,t)},e}();o.LocalWorkflowContext=r},{130:130}],70:[function(e,t,o){"use strict";var n=e("assignHelper"),r=e("spreadArrayHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.LocalWorkflowExecutionManager=void 0;var i=e(114),s=e(17),a=e(31),c=e(102),u=e(99),l=e(88),p=e(76),f=e(38),d=e(69),h=e(132),g=e(125),y=e(97),m=function(){function e(e,t,o){var n=this;this.workflowsWithSessionAffinity=new Map,this.workflowDefinitionsWithSessionAffinity=[],this.workflowsWithoutSessionAffinity=[],this.pendingScopeExecutionNotificationsByWorkflow=new Map,this.sweepIntervalMs=200,this.sweepTimers=new Map,this.getResourceAsArrayBuffer=function(e,t){return n.modelDownloader?n.modelDownloader.getResourceAsArrayBuffer(e,t):Promise.reject(new Error("Resource Downloader never created"))},this.getResourceAsURL=function(e,t){return n.modelDownloader?n.modelDownloader.getResourceAsURL(e,t):Promise.reject(new Error("Resource Downloader never created"))},this.createModel=function(e){return!n.inferenceService&&n.inferenceServiceFactory&&(n.inferenceService=n.inferenceServiceFactory()),n.inferenceService?n.inferenceService.then((function(t){return t.createModel(e)})):Promise.reject(new Error("Inference Service never created"))},this.createModelInputs=function(){if(!n.inferenceService&&n.inferenceServiceFactory&&(n.inferenceService=n.inferenceServiceFactory()),n.inferenceService)return n.inferenceService.then((function(e){return e.createInputs()}));throw new Error("Inference Service never created")},this.nextAnnotationId=1,this.nextSignalId=1,this.modelDownloader=e,this.inferenceServiceFactory=t,o.enableDeltas&&(this.deltaHandlers=(new Map).set(i.SchemaObject.getTypeNameFor(g.TextTileDelta),f.applyTextTileDelta).set(i.SchemaObject.getTypeNameFor(g.FormattedTextTileDelta),f.applyFormattedTextTileDelta),this.deltaItems=new Map),this.site={getResourceAsArrayBuffer:this.getResourceAsArrayBuffer,getResourceAsURL:this.getResourceAsURL,createModel:this.createModel,createModelInputs:this.createModelInputs}}return e.prototype.getNextClientAnnotationId=function(){return"#AC"+this.nextAnnotationId++},e.prototype.getNextClientSignalId=function(){return"#SC"+this.nextSignalId++},e.prototype.registerLocalWorkflow=function(e,t){var o=this,n=new a.Operation({operationName:"WorkflowRegistration",resourceId:e.id}).start();if(0===e.inputTypes.length)throw new Error("Invalid workflow params");t?(this.workflowsWithSessionAffinity.get(t).push(this.createWorkflowImplementation(e,t)),t.registerContextTypes((0,h.getContextTypes)(e.requestedContextTypesRules).map((function(e){var t=e[0];e[1];return t}))),t.addToWorkflowGraph(e)):(e.isStateful?(this.workflowDefinitionsWithSessionAffinity.push(e),this.workflowsWithSessionAffinity.forEach((function(t,n){t.push(o.createWorkflowImplementation(e,n)),n.addToWorkflowGraph(e)}))):this.workflowsWithoutSessionAffinity.push(this.createWorkflowImplementation(e)),this.workflowsWithSessionAffinity.forEach((function(t,o){return o.registerContextTypes((0,h.getContextTypes)(e.requestedContextTypesRules).map((function(e){var t=e[0];e[1];return t})))}))),n.success=!0,a.Log.info(572838110,a.LogCategory.CoreDefault,n.stop())},e.prototype.getAllRegisteredWorkflowsFromSession=function(e){var t=[];return t.push.apply(t,this.workflowsWithoutSessionAffinity||[]),t.push.apply(t,this.workflowsWithSessionAffinity.get(e)||[]),t.map((function(e){return e.workflow}))},e.prototype.getWorkflowDefinitionsByName=function(e){var t,o=new Map;return null===(t=this.workflowsWithSessionAffinity.get(e))||void 0===t||t.forEach((function(e){return o.set(e.workflow.id,e.workflow)})),o},e.prototype.getWorkflowDefinitionsWithSessionAffinity=function(){return this.workflowDefinitionsWithSessionAffinity},e.prototype.addSession=function(e){for(var t=[],o=0,n=this.workflowDefinitionsWithSessionAffinity;o<n.length;o++){var r=n[o];t.push(this.createWorkflowImplementation(r)),r.kind===s.WorkflowKind.Join&&e.getContextIdManager().setActiveScopeType(r.collectionScopeType),e.addToWorkflowGraph(r)}this.workflowsWithSessionAffinity.set(e,t);for(var i=0,a=this.workflowsWithoutSessionAffinity;i<a.length;i++){var c=a[i];e.addToWorkflowGraph(c.workflow)}},e.prototype.closeSession=function(e){this.cancelSweepTimer(e);for(var t=0,o=this.workflowsWithSessionAffinity.get(e)||[];t<o.length;t++){o[t].workflowLambda.dispose()}this.workflowsWithSessionAffinity.delete(e)},e.prototype.setTokenCallback=function(e){this.getAuthTokenCallback=e},e.prototype.runLocalWorkflows=function(e,t,o){var n,c,u,l=this;void 0===o&&(o=!1);var p=function(e,o,n){var c,u=t.getWorkflowItemStorage(),p=e.workflow,f=p.inputTypes.concat(p.kind===s.WorkflowKind.Join?p.collectionScopeType:[]),d=new a.Operation({operationName:"RunLocalWorkflows",success:!0,resourceId:p.id}).start();if(i.SchemaObject.matchesTypesFor(o.body,f)){var h=(0,y.shallowCloneItemWithPath)(n.parentPath,o);if(p.kind===s.WorkflowKind.Join)if(i.SchemaObject.matchesTypesFor(h.body,[p.collectionScopeType]))u.setScopeItem(h,p),d.resultDescription="Scope item: ".concat(o.id," (").concat(i.SchemaObject.getTypeNameFor(o.body),"), workflow: ").concat(p.id,", contextId: ").concat(o.contextId),a.Log.info(524126153,a.LogCategory.CoreDefault,d.stop()),l.setScopeExecutionNotification(t,e,h,0);else{if(!u.getScopeItem(h.contextId,p))return d.resultDescription="Filtered out join invalidation: out of scope type (".concat(p.collectionScopeType,"), itemd id: ").concat(h.id,", contextId: ").concat(h.contextId),void a.Log.info(541173894,a.LogCategory.CoreDefault,d.stop());u.addItemToWorkflowList(h,p),d.resultDescription="Input item: ".concat(o.id," (").concat(i.SchemaObject.getTypeNameFor(o.body),"), workflow: ").concat(p.id,", contextId: ").concat(o.contextId),a.Log.info(524126154,a.LogCategory.CoreDefault,d.stop())}if(i.SchemaObject.getBaseTypesFor(h.body).indexOf(i.ContextHolder.getTypeName())>=0){for(var g=r(r([],h.parentPath,!0),[h.id],!1),m=!0,v=0,T=null!==(c=p.outputTypes)&&void 0!==c?c:[];v<T.length;v++){var S=T[v];if(!t.getContextAnnotations(S,0,g,p.id)){m=!1;break}}if(m)return}var w=function(){var n,r=t.resolveRequestedContexts(p),i=r[0],c=r[1];if(!i)return d.resultDescription="Required contexts are not ready for ".concat(p.id,". Retrying execution in ").concat(500," milliseconds..."),a.Log.info(545837259,a.LogCategory.CoreDefault,d.stop()),void setTimeout(w,500);if(p.kind===s.WorkflowKind.SingleItem)l.executeLocalWorkflow(e,h,[h],t,c,0).catch((function(e){d.resultDescription=e,a.Log.error(572838111,a.LogCategory.CoreDefault,d.stop())}));else if(p.kind===s.WorkflowKind.Join){var f=o.contextId,g=u.getScopeItem(f,e.workflow);if(!g)return d.resultDescription="No scope item for ".concat(p.id," workflow from contextId ").concat(f),void a.Log.info(526758475,a.LogCategory.CoreDefault,d.stop());if(u.isWorkflowReady(g.contextId,p)){var y=u.getItemsToExecute(g.contextId,p);l.executeLocalWorkflow(e,g,y,t,c,0).catch((function(e){d.resultDescription=e,a.Log.error(541173895,a.LogCategory.CoreDefault,d.stop())})).finally((function(){return u.onWorkflowExecuted(g,p)})),(null===(n=l.pendingScopeExecutionNotificationsByWorkflow.get(p.id))||void 0===n?void 0:n.get(g.contextId))?(l.pendingScopeExecutionNotificationsByWorkflow.get(p.id).delete(g.contextId),0===l.pendingScopeExecutionNotificationsByWorkflow.get(p.id).size&&l.pendingScopeExecutionNotificationsByWorkflow.delete(p.id)):(d.resultDescription="Workflow ".concat(p.id,", contextId ").concat(g.contextId,", already queued, skipping new scope execution"),a.Log.info(528048977,a.LogCategory.CoreDefault,d.stop()))}}};w()}},f=e;o&&(f=[new i.AddOperation({parentPath:["session"],items:[{id:"#userContext#",body:new i.UserContextHolder}]}),new i.AddOperation({parentPath:["session"],items:[{id:"#tenantContext#",body:new i.TenantContextHolder}]})],t.getContextIdManager().applyContextIdOnOperations(f),f=f.concat(e));for(var d=0,h=f;d<h.length;d++)for(var g=h[d],m=i.SchemaObject.getTypeNameFor(g),v=0,T=g.items;v<T.length;v++){var S=T[v];if(t.applyOperationForContext(g,S,2),m!==i.DeleteOperation.getTypeName()){if(S.body)if(m===i.DeltaUpdateOperation.getTypeName()&&this.deltaHandlers&&this.deltaItems){var w=new a.Operation({operationName:"LocalDeltaUpdate",dimension0:i.SchemaObject.getTypeNameFor(S.body),success:!0});w.start();try{var b=this.deltaHandlers.get(i.SchemaObject.getTypeNameFor(S.body)),_=this.deltaItems.get(g.parentPath[g.parentPath.length-1]);if(b&&_){var C=b(S.body,_);if(C){var k={id:S.id,revId:S.revId,body:C,parentPath:g.parentPath,delta:S.body,contextId:S.contextId},O=new i.Operation({parentPath:k.parentPath,items:[k]});a.Log.info(539637591,a.LogCategory.CoreDefault,w.stop()),this.runLocalWorkflows([O],t)}else w.success=!1,w.resultDescription="Failed because the handler did not produce valid updated item",a.Log.info(539637592,a.LogCategory.CoreDefault,w.stop())}else w.success=!1,w.resultDescription="Failed due to lack of handler or parent item",a.Log.info(539637593,a.LogCategory.CoreDefault,w.stop())}catch(e){w.success=!1,w.resultDescription="Failed to apply delta, error: ".concat(e),a.Log.info(539637594,a.LogCategory.CoreDefault,w.stop())}}else{null===(c=this.deltaItems)||void 0===c||c.set(S.id,S.body);for(var x=0,M=this.workflowsWithoutSessionAffinity;x<M.length;x++){p(M[x],S,g)}for(var I=0,A=null!==(u=this.workflowsWithSessionAffinity.get(t))&&void 0!==u?u:[];I<A.length;I++){p(A[I],S,g)}}}else null===(n=this.deltaItems)||void 0===n||n.delete(S.id)}},e.prototype.createWorkflowImplementation=function(e,t){var o=e.factory();return{workflow:e,workflowLambda:o,initPromise:this.initWorkflow(e.kind,o,t)}},e.prototype.initWorkflow=function(e,t,o){var n,r=new d.LocalWorkflowContext({model:void 0,clientMetadata:o?o.getClientMetadata():void 0,site:this.site,getTokenCallback:null===(n=this.getAuthTokenCallback)||void 0===n?void 0:n.bind(this)});return e===s.WorkflowKind.SingleItem||e===s.WorkflowKind.Join?t.init(this.site,r):Promise.resolve()},e.prototype.executeLocalWorkflow=function(e,t,o,r,p,f){var h=this;return new Promise((function(g,y){var m,v={annotations:[]},T=e.workflow,S=new a.Operation({operationName:"ExecuteWorkflow",resourceId:T.id,dimension3:null!==(m=null==t?void 0:t.contextId)&&void 0!==m?m:""});S.start();var w=(null==t?void 0:t.contextId)?"".concat(null==t?void 0:t.contextId,".").concat("C","0"):null==t?void 0:t.contextId,b=function(){var e=new Map;if(t&&(t.parentPath||a.Log.error(525382231,a.LogCategory.CoreDefault,"Missing scope item parent. Workflow: ".concat(T.id,". Type: ").concat(i.SchemaObject.getTypeNameFor(t.body))),e.set(t.body,t)),Array.isArray(o))for(var n=0,r=o;n<r.length;n++){var s=r[n];s&&s.body&&(s.parentPath||a.Log.error(525382232,a.LogCategory.CoreDefault,"Missing parent. Workflow: ".concat(T.id,". Type: ").concat(i.SchemaObject.getTypeNameFor(s.body))),e.set(s.body,s))}return e}(),_=function(e){return e?(S.resultDescription=e,S.resultSignature="Exception",a.Log.error(572838112,a.LogCategory.CoreDefault,S.stop())):(S.success=!0,a.Log.info(572838113,a.LogCategory.CoreDefault,S.stop())),e},C=new d.LocalWorkflowContext({model:new l.WorkflowModel(o[0],p),clientMetadata:r.getClientMetadata(),site:h.site,getTokenCallback:h.getAuthTokenCallback.bind(h)}),k=function(e){_(e?e.message:null),e?y(e):g(v)},O={setAnnotations:function(t,u,l,p){for(var d,g=function(t){a.Log.info(555866112,a.LogCategory.CoreDefault,new a.AnnotationMetaDataChange({annotationType:u,annotationState:t,workflowId:e.workflow.id}))},m=0,S=l;m<S.length;m++){(A=S[m]).metadata=n(n({},A.metadata),{state:i.AnnotationState.Created}),g(i.AnnotationState.Created)}if(T.kind!==s.WorkflowKind.SingleItem||o[0].body===t){var C,k,O=b.get(t),x=i.SchemaObject.getTypeNameFor(O.body);if(Array.isArray(l))if(!T.outputTypes||T.outputTypes.indexOf(u)<0)C="Workflow said it would output one of [".concat(T.outputTypes,"] but instead output ").concat(u);else if(O)for(var M=0,I=l;M<I.length;M++){var A=I[M];i.SchemaObject.matchesTypesFor(A,[i.Annotation.getTypeName()])?i.SchemaObject.getTypeNameFor(A)!==u&&(C="Workflow produced inconsistent annotation types in setAnnotations call (".concat(i.SchemaObject.getTypeNameFor(A)," did not match expected ").concat(u,")")):C="Workflow produced an output that is not an annotation ".concat(i.SchemaObject.getTypeNameFor(A))}else C="No item provided";else C="Workflow produced an invalid annotation array";if(C)y(_(C));else if(k=p&&p.isSessionAnnotation?["session"]:p&&p.ancestorType?O.parentPath:O.parentPath.concat(O.id),v.annotations.push({path:k,annotationType:u,annotations:l}),1!==f){for(var L=[],P=[],D=function(e){e.metadata=n(n({},e.metadata),{state:i.AnnotationState.Sent}),g(i.AnnotationState.Sent);var t=e.id,o=t?null===(d=r.getContextAnnotations(u,0,k,T.id))||void 0===d?void 0:d.filter((function(e){var o;return(null===(o=e.body)||void 0===o?void 0:o.id)==t})):void 0;1==(null==o?void 0:o.length)?1==o.length?P.push({id:o[0].id,source:T.id,body:e,contextId:w}):a.Log.error(545837260,a.LogCategory.CoreDefault,"Assert: Multiple existing context annotations with body id ".concat(t," found for ").concat(u," and local workflow ").concat(T.id,").")):L.push({id:h.getNextClientAnnotationId(),source:T.id,body:e,contextId:w})},E=0,N=l;E<N.length;E++){D(A=N[E])}var R=[];L.length>0&&R.push(new i.AddOperation({parentPath:k,items:L})),P.length>0&&R.push(new i.UpdateOperation({parentPath:k,items:P})),setTimeout((function(){r.onAnnotationResults(new c.AnnotationResultsMessage({annotationType:u,ops:R}),0,(function(){}))}),0),(x==i.UserContextHolder.getTypeName()||x==i.TenantContextHolder.getTypeName()||i.SchemaObject.matchesTypesFor(O.body,[i.Document.getTypeName(),i.SubDocument.getTypeName()]))&&r.submitOperationsToSession(R)}}else y(_("Expected obj to be ".concat(o[0].body," but instead it was ").concat(t)))},submitSignals:function(e){if(1!==f){var t=e.map((function(e){return{id:h.getNextClientSignalId(),source:T.id,body:e,contextId:w}})),o=new i.SignalOperation({parentPath:["session"],items:t});r.submitOperations([o])}else y(_("NYI"))},done:k,overrideWorkflowDefinition:function(e,o,n){var i;switch(n){case 0:if(!t.contextId){var s="ContextId is not defined for this scope item.";throw a.Log.error(527472289,a.LogCategory.CoreDefault,s),new Error(s)}i=t.contextId;break;case 1:i=void 0;break;default:s="Defined scope is not supported. "+n;throw a.Log.error(527472290,a.LogCategory.CoreDefault,s),new Error(s)}var c=new u.WorkflowDefinitionOverrideMessage({definition:o,contextId:i,sourceWorkflowId:T.id,targetWorkflowId:e});r.onWorkflowDefinitionOverrideMessage(c)}},x=e.workflowLambda;if(T.kind===s.WorkflowKind.SingleItem){1!==o.length&&k(new Error("Single item workflows expect a single input")),C.delta=o[0].delta;try{var M=x;e.initPromise||(e.initPromise=M.init(h.site,C)),e.initPromise.then((function(){M.execute(o[0].body,C,O)})).catch((function(e){_(e)}))}catch(e){_(e)}}else if(T.kind===s.WorkflowKind.Join){0===o.length&&k(new Error("Join workflows expect an inputs array")),C.delta=t.delta;try{var I=x;e.initPromise||(e.initPromise=I.init(h.site,C)),e.initPromise.then((function(){I.execute(t.body,o.map((function(e){return e.body})),C,O)})).catch((function(e){_(e)}))}catch(e){_(e)}}else _("Workflow kind ".concat(T.kind," not supported"))}))},e.prototype.ensureSweepTimer=function(e){if(!this.sweepTimers.get(e)){var t=setInterval(this.onSweep.bind(this),this.sweepIntervalMs);this.sweepTimers.set(e,t)}},e.prototype.cancelSweepTimer=function(e){var t=this.sweepTimers.get(e);this.sweepTimers.get(e)&&(clearInterval(t),this.sweepTimers.delete(e))},e.prototype.onSweep=function(){this.sweepScopeExecutionNotifications()},e.prototype.setScopeExecutionNotification=function(e,t,o,n){var r=Date.now(),i={session:e,workflowImplementation:t,scopeItem:o,startTime:r,minTime:r+(0,p.getSafeNumber)(t.workflow.minDelayMs,1e3),maxTime:r+(0,p.getSafeNumber)(t.workflow.maxDelayMs,5e3),orchestrationMode:n},c=t.workflow.kind===s.WorkflowKind.Join?o.contextId:i.scopeItem.parentPath.concat(o.id).join("\\");if(this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id)||this.pendingScopeExecutionNotificationsByWorkflow.set(t.workflow.id,new Map),!this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).get(c)){var u=new a.Operation({resultDescription:"New pending scope execution for ".concat(t.workflow.id," at ").concat(c),operationName:"LocalScopeExecutionNotification",resourceId:t.workflow.id,success:!0}).start();a.Log.info(539883075,a.LogCategory.CoreDefault,u.stop()),this.pendingScopeExecutionNotificationsByWorkflow.get(t.workflow.id).set(c,i)}this.ensureSweepTimer(e)},e.prototype.sweepScopeExecutionNotifications=function(){for(var e=this,t=new Set(Array.from(this.sweepTimers.keys())),o=0,n=Array.from(this.pendingScopeExecutionNotificationsByWorkflow.entries());o<n.length;o++)for(var r=n[o],i=r[0],c=r[1],u=function(o,n){var r=n.session,c=n.workflowImplementation.workflow,u=n.orchestrationMode,p=r.getWorkflowItemStorage(),f=new a.Operation({operationName:"LocalScopeExecutionNotification",resourceId:c.id}).start();!function(){if(!function(){if(c.kind===s.WorkflowKind.Join){var e=Date.now(),t=n.workflowImplementation.workflow,o=n.scopeItem.contextId,i=r.getWorkflowDefinition(t,o).maxDelayMs;return p.isWorkflowReady(o,t)?(f.resultDescription="Join Workflow: ".concat(t.id," queuing by maxAnnotation, contextId: ").concat(o),a.Log.info(528048978,a.LogCategory.CoreDefault,f.stop()),!0):n.startTime+i<e&&(f.resultDescription="Join Workflow: ".concat(t.id," queuing by maxTimeout, contextId: ").concat(o),a.Log.info(528048979,a.LogCategory.CoreDefault,f.stop()),!0)}return!0}())return!1;var t=r.resolveRequestedContexts(c),o=t[0],i=t[1];if(!o)return!1;try{if(c.kind===s.WorkflowKind.Join){var l=n.scopeItem.contextId,d=p.getScopeItem(l,c);if(d){var h=p.getItemsToExecute(d.contextId,c);if(0===h.length)return f.resultDescription="Failed to retrieve items for workflow: ".concat(c.id,", contextId: ").concat(l,", skipping execution"),a.Log.info(527472291,a.LogCategory.CoreDefault,f.stop()),p.onWorkflowExecuted(d,c),!0;e.executeLocalWorkflow(n.workflowImplementation,d,h,r,i,u).finally((function(){return p.onWorkflowExecuted(d,c)}))}else f.resultDescription="ContextId no longer exists, skipping workflow execution",a.Log.info(539883076,a.LogCategory.CoreDefault,f.stop())}else f.resultDescription="Workflow in type ".concat(c.kind," is not supported"),a.Log.error(539883077,a.LogCategory.CoreDefault,f.stop())}catch(e){f.resultDescription="Trying to execute ".concat(c.id," caused an exception: ").concat(e),a.Log.warn(539883078,a.LogCategory.CoreDefault,f.stop())}return!0}()?t.delete(r):(l.pendingScopeExecutionNotificationsByWorkflow.get(i).delete(o),0===l.pendingScopeExecutionNotificationsByWorkflow.get(i).size&&l.pendingScopeExecutionNotificationsByWorkflow.delete(i))},l=this,p=0,f=Array.from(c.entries());p<f.length;p++){var d=f[p];u(d[0],d[1])}if(0!==t.size)for(var h=0,g=Array.from(t);h<g.length;h++){var y=g[h],m=new a.Operation({resultDescription:"No pending scope notifications left, cancelling sweep timer",operationName:"LocalScopeExecutionNotification",success:!0}).start();a.Log.debug(539883079,a.LogCategory.CoreDefault,m.stop()),this.cancelSweepTimer(y)}},e}();o.LocalWorkflowExecutionManager=m},{102:102,114:114,125:125,132:132,17:17,31:31,38:38,69:69,76:76,88:88,97:97,99:99}],71:[function(e,t,o){"use strict";var n=e("assignHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.createRuntime=o.runtime=o.ClientRuntime=o.getVersion=void 0;var r=e(31),i=e(74),s=e(86),a=e(84),c=e(73),u=e(76),l=e(79),p=e(81),f=e(83),d=e(70),h=e(61);o.getVersion=function(){return e(77).version};var g=function(){function e(e,t,o){var n=this;this.sessionsByDocSessionId=new Map,this.settings={dropOnlySequencedSyncsOnReseedEnabled:!0,closeWSBlockedSessionEnabled:!0,sessionOfflineModeEnabled:!0,annotationsOrderingEnabled:!1,deltaOperationsEnabled:!1,checkIdbByFeatures:!1},this.isDownloaderCompatible=function(){if(n.settings.checkIdbByFeatures)return"undefined"!=typeof Array&&void 0!==Array.from&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL;if("undefined"!=typeof window&&window.navigator&&window.navigator.userAgent){var e=window.navigator.userAgent;return!(!e.indexOf||e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0)}return!1},this.workerFactory=e||function(){return new s.WebSocketWorker};var r=this.createDefaultSessionManagerFactory();this.sessionManagerFactory=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return(null==t?void 0:t.apply(void 0,e))||r.apply(void 0,e)},this.sessionFactory=o||function(e){return new c.SessionProxy(e)}}return e.prototype.init=function(e,t,n,s){var a=this,c=new r.Operation({operationName:"InitRuntime",resourceId:e});c.start(),this.annotationResultsProcessor=new h.RoutingAnnotationResultsProcessor((function(){return a.settings.annotationsOrderingEnabled})),this.inferenceServiceFactory=s.inferenceServiceFactory,this.clientMetadata=t,this.clientMetadata&&(this.clientMetadata.runtimeVersion=(0,o.getVersion)()),this.hostCallbacks=n,r.Log.addLogger(new i.TelemetryLogger(this.hostCallbacks));var l=s.telemetryAggregationIntervalSec;if(void 0===l&&(l=30),l>0){var p=function(e,t,o){return new r.LoggingAggregator(e,(function(e){return e.success&&o.indexOf(e[t])>=0}),[t,"resourceId","success","resultSignature","dimension0","dimension1","dimension2","dimension3"],["durationMs"],l)};r.Log.addAggregator(p("Operation","operationName",["ExecuteLambda","ExecuteWorkflow","ExecuteBatch","ProcessResponse","LocalDeltaUpdate","ApplyFormattedTextTileDeltaForLocalWorkflows","ApplyTextTileDeltaForLocalWorkflows","FindRangeForDelta","RunModelForInferencing","GetResource"])),r.Log.addAggregator(p("SessionHealth","sessionHealthEventName",["ProcessMessage","SendMessage"]))}this.batchOptions=s.batchOptions,e&&(this.defaultServiceUrl=u.Utils.convertServiceUrlToWebSocket(e),this.serviceProtocol=this.defaultServiceUrl.split(":")[0].toLowerCase());var f=[];return f.push(this.isFeatureEnabled("CheckIdbByFeatures",!1).then((function(e){a.settings.checkIdbByFeatures=e}))),f.push(this.isFeatureEnabled("DropOnlySequencedSyncsOnReseedDisabled").then((function(e){a.settings.dropOnlySequencedSyncsOnReseedEnabled=!e}))),f.push(this.isFeatureEnabled("CloseWSBlockedSessionDisabled").then((function(e){a.settings.closeWSBlockedSessionEnabled=!e}))),f.push(this.isFeatureEnabled("SessionOfflineModeDisabled").then((function(e){a.settings.sessionOfflineModeEnabled=!e}))),f.push(this.isFeatureEnabled("AnnotationsOrderingEnabled",!1).then((function(e){a.settings.annotationsOrderingEnabled=e}))),f.push(this.isFeatureEnabled("DeltaOperationsEnabled").then((function(e){a.localWorkflowManager=new d.LocalWorkflowExecutionManager(s.modelDownloader&&a.isDownloaderCompatible()?s.modelDownloader:void 0,a.inferenceServiceFactory,{enableDeltas:e})})).catch((function(){a.localWorkflowManager=new d.LocalWorkflowExecutionManager(s.modelDownloader&&a.isDownloaderCompatible()?s.modelDownloader:void 0,a.inferenceServiceFactory,{enableDeltas:!1})}))),Promise.all(f).then((function(){a.logOperation(c,!0)})).catch((function(e){a.logOperation(c,!1,"Error",e?e.message:"(no error)")}))},e.prototype.getServiceProtocol=function(){return this.serviceProtocol},e.prototype.registerLocalWorkflow=function(e){this.localWorkflowManager.registerLocalWorkflow(e)},e.prototype.flushTelemetry=function(e){r.Log.flushAggregators(e)},e.prototype.createSession=function(e){var t,o=e?e.docSessionId:void 0,r=this.sessionsByDocSessionId.get(o);if(r&&!1===r.isClosed)throw new Error("docSessionId already exists");var i=e&&null!==(t=e.serviceUrl)&&void 0!==t?t:this.defaultServiceUrl;if(!(i=u.Utils.convertServiceUrlToWebSocket(i)))return Promise.reject(new Error("EmptyUrl"));var s=n({},this.clientMetadata);s.docSessionId=o,e&&e.flights&&(s.flights=s.flights?s.flights+";"+e.flights:e.flights);var a=this.sessionFactory({hostCallbacks:this.hostCallbacks,sessionManager:this.sessionManagerFactory(s,i,null==e?void 0:e.enableComplexLocalWorkflows),batchOptions:this.batchOptions,extensionConfigs:(null==e?void 0:e.extensionConfigs)||[],clientMetadata:s,localWorkflowManager:this.localWorkflowManager,annotationResultsProcessor:this.annotationResultsProcessor});return this.sessionsByDocSessionId.set(o,a),e&&e.onSessionConnect&&a.setConnectCallback(e.onSessionConnect),e&&e.onSessionDisconnect&&a.setDisconnectCallback(e.onSessionDisconnect),e&&e.onSessionReconnect&&a.setReconnectCallback(e.onSessionReconnect),e&&e.onSessionClose&&a.setSessionCloseCallback(e.onSessionClose),a.initialize?a.initialize():Promise.resolve(a)},e.prototype.getSessionManagerFactory=function(){return this.sessionManagerFactory},e.prototype.createDefaultSessionManagerFactory=function(){var e=this;return function(t,o,n){if(n)throw new Error("NYI");var i=new f.TokenRefreshManager,s=new l.SessionStats,c=function(){r.Log.error(573321615,r.LogCategory.CoreDefault,"Unexpectedly not set sendMessage")},d=new p.SessionInitializer((function(){return s}),t,i,(function(e,t){c(e,t)}),{getAuthToken:e.getAuthToken.bind(e,t.docSessionId),overrideSessionInitMessage:e.hostCallbacks.overrideSessionInitMessage}),h=new a.WebSocketSessionManager(u.Utils.convertServiceUrlToWebSocket(o),s,e.workerFactory,d,t,i,e.settings);return c=h.sendMessage.bind(h),h.on("disconnect",(function(){return i.clearRefreshTimeouts()})),h.on("connect",(function(t,o,n,r){t&&e.hostCallbacks.setSessionData&&e.hostCallbacks.setSessionData(o,n,r)})),h}},e.prototype.getAuthToken=function(e){var t={Tickets:[]};return e&&(t.DocSessionId=e),this.hostCallbacks.requestAuthToken(t).then((function(e){if(e)return e.Token})).catch((function(){}))},e.prototype.isFeatureEnabled=function(e,t,o){return void 0===t&&(t=!1),void 0===o&&(o="None"),u.Utils.isFeatureEnabled(this.hostCallbacks,e,t,o)},e.prototype.logOperation=function(e,t,o,n){e.stop(),e.success=t,e.resultSignature=o,e.resultDescription=n,r.Log.info(573321622,r.LogCategory.CoreDefault,e)},e}();o.ClientRuntime=g,o.runtime=new g;o.createRuntime=function(){return new g}},{31:31,61:61,70:70,73:73,74:74,76:76,77:77,79:79,81:81,83:83,84:84,86:86}],72:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.SequentialFetchQueue=void 0;var n=function(){function e(e,t,o){if(this.requestInProgress=!1,this.queuedRequests=[],null==e)throw new Error("No request.");this.fetch=e,this.fetchTimeout=t,this.queueTimeout=o}return e.prototype.tryProcessNextRequest=function(){if(this.requestInProgress=!1,this.queuedRequests.length>0){var e=this.queuedRequests.shift(),t=e[0],o=e[1],n=e[2];clearTimeout(n),this.add(t,o)}},e.prototype.add=function(e,t){var o=this;if(this.requestInProgress){var n=setTimeout((function(){t(new Error("Timed out waiting in queue"),null),o.queuedRequests.shift()}),this.queueTimeout);this.queuedRequests.push([e,t,n])}else{this.requestInProgress=!0,new Promise((function(t,n){var r=!1,i=setTimeout((function(){r=!0,n(new Error("Fetch timed out"))}),o.fetchTimeout);o.fetch(e).then((function(e){r||(clearTimeout(i),t(e))})).catch((function(e){r||(clearTimeout(i),n(e))}))})).then((function(e){t(null,e),o.tryProcessNextRequest()})).catch((function(e){t(e,null),o.tryProcessNextRequest()}))}},e}();o.SequentialFetchQueue=n},{}],73:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.SessionProxy=void 0;var n=e(102),r=e(99),i=e(114),s=e(90),a=e(57),c=e(63),u=e(65),l=e(78),p=e(17),f=e(76),d=e(31),h=e(132),g=e(97),y=e(38),m=function(){function e(e){this.annotationActivationTrackers=new Map,this.annotationCallbacks=new Map,this.annotationResultStates=new Map,this.tokensByAnnotationType=new Map,this.registeredContextTypes=new Set,this.availableContexts=new Map,this.nextSyncSequenceId=1,this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.hasSessionConnected=!1,this.isSessionClosed=!1,this.isSessionConnected=!1,this.workflowDefinitionManager=new y.DynamicWorkflowDefinitionManager,this.contextIdManager=new y.ContextIdManager("C",!0),this.workflowItemStorage=new y.WorkflowItemStorage(this.workflowDefinitionManager,!0),this.workflowGraph=new y.WorkflowGraph,this.hostCallbacks=e.hostCallbacks,this.sessionManager=e.sessionManager,this.operationBatchConfig=e.batchOptions?this.getOperationBatchConfig(e.batchOptions):void 0,this.extensionConfigs=e.extensionConfigs,this.clientMetadata=e.clientMetadata,this.localWorkflowManager=e.localWorkflowManager,this.annotationResultsProcessor=e.annotationResultsProcessor,e.workflowRuntimeFactory&&(this.workflowRuntime=e.workflowRuntimeFactory(this.sessionManager)),this.sessionManager.on("sessionClose",this.onSessionClose.bind(this)),this.sessionManager.on("reconnect",this.onReconnect.bind(this)),this.sessionManager.on("connect",this.onConnect.bind(this)),this.sessionManager.on("disconnect",this.onDisconnect.bind(this)),this.sessionManager.on("resetNextSyncSequenceId",this.resetNextSyncSequenceId.bind(this)),this.sessionManager.onMessage(n.AnnotationResultsMessage.getTypeName(),this.onAnnotationResultsFromServer.bind(this)),this.sessionManager.onMessage(n.AnnotationResultStateMessage.getTypeName(),this.onAnnotationResultStateMessage.bind(this))}return e.prototype.initialize=function(){var e=this;return this.sessionManager.init(this.extensionConfigs,this.hostCallbacks.onInitSession?this.hostCallbacks.onInitSession:void 0).then((function(){return e.workflowRuntime||(e.localWorkflowManager.addSession(e),e.localWorkflowManager.setTokenCallback(e.getAuthToken.bind(e))),e}))},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this.isSessionConnected},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasConnected",{get:function(){return this.hasSessionConnected},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isClosed",{get:function(){return this.isSessionClosed},enumerable:!1,configurable:!0}),e.prototype.getContextIdManager=function(){return this.contextIdManager},e.prototype.getWorkflowItemStorage=function(){return this.workflowItemStorage},e.prototype.getWorkflowDefinition=function(e,t){return this.workflowDefinitionManager.getWorkflowDefinition(e,t)},e.prototype.registerLocalWorkflow=function(e){if(this.workflowRuntime)return this.workflowRuntime.registerWorkflow(e),void this.sessionManager.sendMessage(new r.WorkflowRegistrationMessage({workflowDefinition:e}));if(e.kind===p.WorkflowKind.Join){this.contextIdManager.setActiveScopeType(e.collectionScopeType);for(var t=0,o=this.localWorkflowManager.getWorkflowDefinitionsWithSessionAffinity();t<o.length;t++){var n=o[t];this.contextIdManager.setActiveScopeType(n.collectionScopeType)}}this.localWorkflowManager.registerLocalWorkflow(e,this)},e.prototype.activateAnnotation=function(e,t){var o,n=new a.AnnotationActivationTracker(this.getSessionManager.bind(this),e,t);if(t&&t.callback){var r=this.annotationCallbacks.get(e);r||(r=new Map,this.annotationCallbacks.set(e,r)),r.set(n.token,t.callback)}var i=null!==(o=this.tokensByAnnotationType.get(e))&&void 0!==o?o:[];return-1===i.indexOf(n.token)&&i.push(n.token),this.tokensByAnnotationType.set(e,i),this.annotationActivationTrackers.set(n.token,n),n.activate(!1),n.asPromise().catch((function(t){var o=new d.Operation({resultDescription:"error on activate annotation type ".concat(e,": ").concat(t)}).start();d.Log.error(524812895,d.LogCategory.CoreDefault,o.stop())}))},e.prototype.updateAnnotationConfig=function(e,t){var o=new n.AnnotationConfigUpdateMessage({token:e,config:t});this.getSessionManager().sendMessage(o);var r=this.annotationActivationTrackers.get(e);r&&r.options&&(r.options.config=t)},e.prototype.releaseAnnotation=function(e){var t=this.annotationActivationTrackers.get(e);if(t){this.annotationActivationTrackers.delete(e);var o=this.annotationCallbacks.get(t.annotationType);return o&&(o.delete(e),0==o.size&&this.annotationCallbacks.delete(t.annotationType)),t.release()}return Promise.resolve(!1)},e.prototype.setAnnotationState=function(e,t,o){var n={state:o};this.submitOperation(new i.UpdateAnnotationMetaDataOperation({parentPath:e,items:[{id:t}],M_:n}))},e.prototype.setAnnotationMetadata=function(e,t,o){this.submitOperation(new i.UpdateAnnotationMetaDataOperation({parentPath:e,items:[{id:t}],M_:o}))},e.prototype.submitOperation=function(e,t){this.submitOperations([e],t)},e.prototype.submitOperations=function(e,t){var o=this;if(this.contextIdManager.applyContextIdOnOperations(e),this.workflowRuntime)this.submitOperationsToSession(e,t);else{var n=e.filter((function(e){return(0,f.isServerOp)(e,o.serverInputTypes)}));this.submitOperationsToSession(n,t),this.localWorkflowManager.runLocalWorkflows(e,this,!0)}},e.prototype.submitSeedOperations=function(e,t){if(!this.allowSeed)throw new Error("Cannot submit seed operations more than once per session");this.allowSeed=!1,this.allowGroupSeed=!1,this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(e,!0,t):this.getSessionManager().sendMessage(new n.SyncMessage({cv:t,seq:0,ops:e}))},e.prototype.submitSeedGroupOperations=function(e,t,o){if(!this.allowGroupSeed)throw new Error("Seed operations are not allowed for this session");t&&(this.allowGroupSeed=!1),this.allowSeed=!1,this.operationBatchConfig?this.sendSeedMessagesViaBatchManager(e,!!t,o):(this.seedGroupSize++,this.getSessionManager().sendMessage(new n.SyncMessage({cv:o,seq:0,ops:e,groupId:"Seed",groupSize:t?this.seedGroupSize:void 0,groupComplete:t||void 0})))},e.prototype.submitCustomMessage=function(e){var t=this;return new Promise((function(o,n){t.getSessionManager().sendMessage(e,(function(e,t){e?n(new Error(e.error)):o(t)}))}))},e.prototype.requestCacheDump=function(e){var t=this;if(e)throw new Error("NYI");return new Promise((function(e,o){t.getSessionManager().sendMessage(new n.CacheDumpRequestMessage,(function(t,n){t?o(t):e(n)}))}))},e.prototype.forceReconnect=function(e){return this.extensionConfigs=e,this.getSessionManager().forceReconnect(e)},e.prototype.close=function(){this.isSessionClosed=!0,this.getSessionManager().closeSession(),this.workflowRuntime&&this.workflowRuntime.close(),this.localWorkflowManager.closeSession(this)},e.prototype.getClientMetadata=function(){return this.clientMetadata},e.prototype.setSessionCloseCallback=function(e){this.sessionCloseCallback=e},e.prototype.setConnectCallback=function(e){this.connectCallback=e},e.prototype.setDisconnectCallback=function(e){this.disconnectCallback=e},e.prototype.setReconnectCallback=function(e){this.reconnectCallback=e},e.prototype.onAnnotationResults=function(e,t,o){var r=this;o(void 0,new n.Response),this.contextIdManager.applyContextIdOnOperations(e.ops),this.annotationResultsProcessor.process(e,(function(e,o){r.applyOperationForContext(e,o,t)}),(function(t){if(r.callAnnotationCallbacks(t,e.annotationType),r.hostCallbacks.onAnnotationResult)try{r.hostCallbacks.onAnnotationResult(t)}catch(e){d.Log.error(540301151,d.LogCategory.CoreDefault,"onAnnotationResult error: ".concat(e))}}),(function(e){if(1!==t){var o=e.ops.filter((function(e){return(0,f.isServerOp)(e,r.serverInputTypes)}));r.submitOperationsToSession(o,e.cv)}r.workflowRuntime?r.submitOperationsToSession(e.ops,e.cv):r.localWorkflowManager.runLocalWorkflows(e.ops,r)}))},e.prototype.onAnnotationResultStateMessage=function(e,t){var o;t(void 0,new n.Response);for(var r=0,i=e.updates;r<i.length;r++){var s=i[r],a=s.annotationType,c=s.state;if(this.tokensByAnnotationType.has(a)){var u=void 0;u=this.annotationResultStates.has(a)?this.annotationResultStates.get(a):0===c?1:0;for(var l=0,p=this.tokensByAnnotationType.get(a);l<p.length;l++){var f=p[l],d=this.annotationActivationTrackers.get(f);(null===(o=d.options)||void 0===o?void 0:o.stateUpdateCallback)&&d.options.stateUpdateCallback(u,c)}}}},e.prototype.submitOperationsToSession=function(e,t){var o=this,r=function(e){return i.SchemaObject.getTypeNameFor(e)===i.SignalOperation.getTypeName()},s=e.filter((function(e){return r(e)})),a=e.filter((function(e){return!r(e)}));if(s.length>0&&this.getSessionManager().sendMessage(new n.SyncMessage({cv:t,ops:s})),a.length>0)if(this.operationBatchConfig){if(!this.batchedOperationsManager){this.batchedOperationsManager=new c.BatchManager((function(e,t,r){o.getSessionManager().sendMessage(new n.SyncMessage({cv:t.cv,seq:o.nextSyncSequenceId++,ops:e}),(function(e){r(e?new Error(e.error):void 0)}))}))}this.batchedOperationsManager.addBatchItem(a,this.operationBatchConfig,{name:"SubmitOperations"},t)}else this.getSessionManager().sendMessage(new n.SyncMessage({cv:t,seq:this.nextSyncSequenceId++,ops:a}))},e.prototype.registerContextTypes=function(e){for(var t=0,o=e;t<o.length;t++){var n=o[t];this.activateAnnotation(n),this.registeredContextTypes.add(n)}},e.prototype.applyOperationForContext=function(e,t,o){var n=this,r=i.SchemaObject.getTypeNameFor(e);if(r==i.AddOperation.getTypeName()||r==i.Operation.getTypeName()||r==i.UpdateOperation.getTypeName()||r==i.DeleteOperation.getTypeName()){r==i.Operation.getTypeName()&&(r=i.AddOperation.getTypeName());var s=(0,g.shallowCloneItemWithPath)(this.resolvePlaceholdersInOperationParentPath(e.parentPath),t),a=(0,g.makeItemPathKey)(s.parentPath);if(r==i.AddOperation.getTypeName()||r==i.UpdateOperation.getTypeName()){if(!s.body)return;var c=i.SchemaObject.getTypeNameFor(s.body);if(!this.registeredContextTypes.has(c))return;var u=this.availableContexts.get(c);u||(u=new Map,this.availableContexts.set(c,u));var l=u.get(o);if(l||(l=[],u.set(o,l)),s.id||(s.id=this.localWorkflowManager.getNextClientAnnotationId()),r==i.AddOperation.getTypeName())0==l.filter((function(e){return(0,g.makeItemPathKey)(e.parentPath)==a&&e.id==s.id})).length?l.push(s):d.Log.info(540848911,d.LogCategory.CoreDefault,"AddOperation for (".concat(o,", ").concat(s.id,", ").concat(s.source,") can't be applied as the context item with matching path and ID already exists. Use UpdateOperation instead."));else for(var p=0;p<l.length;p++)if(l[p].id==s.id&&(0,g.makeItemPathKey)(l[p].parentPath)==a){if(l[p].source==s.source){l[p]=s;break}d.Log.warn(540848912,d.LogCategory.CoreDefault,"UpdateOperation for (".concat(o,", ").concat(s.id,", ").concat(s.source,") can't be applied as the context item with provided path and ID has different source: ").concat(l[p].source))}else d.Log.warn(540848913,d.LogCategory.CoreDefault,"UpdateOperation for (".concat(o,", ").concat(s.id,", ").concat(s.source,") can't be applied as the context item with matching path and ID was not found. AddOperation should be used instead"))}else if(r==i.DeleteOperation.getTypeName()){if(!s.id)return;this.availableContexts.forEach((function(e,t){var r=e.get(o);r&&(0==(r=r.filter((function(e){return!((0,g.makeItemPathKey)(e.parentPath)==a&&e.id==s.id)}))).length?e.delete(o):e.set(o,r),0==e.size?n.availableContexts.delete(t):n.availableContexts.set(t,e))}))}}},e.prototype.resolveRequestedContexts=function(e){for(var t=[],o=0,n=(0,h.getContextTypes)(e.requestedContextTypesRules);o<n.length;o++){var r=n[o],i=r[0],s=r[1];if(this.availableContexts.has(i)){var a=Array.from(this.availableContexts.get(i).values()).reduce((function(e,t){return e.concat(t)}),[]);if(0==a.length)throw new Error("Assert: availableContexts have the entry for ".concat(i," which does not contain any context annotation."));t.push.apply(t,a)}else if(-3==s)return[!1,[]]}return[!0,t]},e.prototype.getContextAnnotations=function(e,t,o,n){var r,i,s=o?(0,g.makeItemPathKey)(o):void 0;return null===(i=null===(r=this.availableContexts.get(e))||void 0===r?void 0:r.get(t))||void 0===i?void 0:i.filter((function(e){return!(s&&(0,g.makeItemPathKey)(e.parentPath)!=s||n&&e.source!=n)}))},e.prototype.onWorkflowDefinitionOverrideMessage=function(e){var t=new d.Operation({operationName:"WorkflowDefinitionOverride",success:!0}),o=function(e){throw t.resultDescription=e,t.success=!1,d.Log.error(527472287,d.LogCategory.CoreDefault,t.stop()),Error("WorkflowDefinitionOverride: ".concat(e))},n=this.localWorkflowManager.getWorkflowDefinitionsByName(this),r=n.get(e.sourceWorkflowId);if(r){var i=n.get(e.targetWorkflowId);i?i.allowDefinitionOverride?r.definitionOverrideTargetWorkflows&&-1!==r.definitionOverrideTargetWorkflows.indexOf(i.id)?(this.workflowDefinitionManager.mergeWorkflowDefinition(i,e.definition,e.contextId),t.success=!0,t.resourceId=r.id,t.resultDescription="Updated config for workflow: ".concat(e.targetWorkflowId,", context id: ").concat(e.contextId),d.Log.info(527472288,d.LogCategory.CoreDefault,t.stop())):o("Workflow '".concat(r.id,"' does not allow workflow definition for workflow '").concat(i.id,"'.")):o("Workflow '".concat(i.id,"' does not allow workflow definition override.")):o("Workflow registration for target workflow '".concat(e.targetWorkflowId,"' was not found."))}else o("Workflow registration for source workflow '".concat(e.targetWorkflowId,"' was not found."))},e.prototype.applyContextIdOnOperations=function(e){this.contextIdManager.applyContextIdOnOperations(e)},e.prototype.addToWorkflowGraph=function(e){this.workflowGraph.addWorkflow((0,y.getWorkflowDefinitionBase)(e))},e.prototype.getAuthToken=function(e,t){var o={Tickets:[]};this.clientMetadata.docSessionId&&(o.DocSessionId=this.clientMetadata.docSessionId);var n=function(e){if(e===p.AuthTokenType.Substrate)return s.AuthTokenType.Substrate}(e);n&&(o.TokenType=n),this.hostCallbacks.requestAuthToken(o).then((function(e){e?t(void 0,e.Token):t(new Error("Missing AuthTokenResponse from requestAutToken"))})).catch((function(e){return t(e)}))},e.prototype.resetNextSyncSequenceId=function(){this.nextSyncSequenceId=1},e.prototype.onReconnect=function(){this.isSessionConnected=!0,this.annotationActivationTrackers.forEach((function(e){e.activate(!0)})),this.reconnectCallback&&this.reconnectCallback()},e.prototype.onSessionClose=function(e){this.isSessionClosed=!0,this.isSessionConnected=!1,this.sessionCloseCallback&&this.sessionCloseCallback(e)},e.prototype.onConnect=function(e,t,o,n,r){this.hasSessionConnected?e&&(this.allowSeed=!0,this.allowGroupSeed=!0,this.seedGroupSize=0,this.seedBatchedOperationsManager&&(this.seedBatchedOperationsManager.removeAllBatchedItems(),this.seedBatchedOperationsManager=void 0),this.batchedOperationsManager&&(this.batchedOperationsManager.removeAllBatchedItems(),this.batchedOperationsManager=void 0)):this.sendWorkflowGraphInitMessage(),this.isSessionConnected=!0,this.hasSessionConnected=!0,this.connectCallback&&this.connectCallback(e,t,o,n),this.serverInputTypes=r},e.prototype.onDisconnect=function(e){this.isSessionConnected=!1,this.disconnectCallback&&this.disconnectCallback(e)},e.prototype.getSessionManager=function(){return this.sessionManager||(this.sessionManager=new l.EmptySessionManager),this.sessionManager},e.prototype.callAnnotationCallbacks=function(e,t){if(0!==this.annotationCallbacks.size){var o=this.annotationCallbacks.get(t);o&&o.forEach((function(t){t(e)}))}},e.prototype.getOperationBatchConfig=function(e){return{delayMs:e.delayMs,maxInputSize:e.maxInputSize,estimateSize:u.estimateSize,groupingKeyExtractor:function(){return"operations"},multiplex:function(e){return{input:e.filter((function(e){return e.length})).reduce((function(e,t){return e.concat(t)}),[]),demultiplex:function(){return[[]]}}},split:function(e){if(!(e.length<=1))return{inputs:e.reduce((function(e,t){return e.push([t]),e}),[]),join:function(){return[]}}}}},e.prototype.sendSeedMessagesViaBatchManager=function(e,t,o){var r=this;if(!this.seedBatchedOperationsManager){this.seedBatchedOperationsManager=new c.BatchManager((function(e,t,o){r.seedGroupSize++,r.getSessionManager().sendMessage(new n.SyncMessage({cv:t.cv,seq:0,ops:e,groupId:"Seed",groupSize:t.groupComplete?r.seedGroupSize:void 0,groupComplete:t.groupComplete?t.groupComplete:void 0}),(function(e){o(e?new Error(e.error):void 0)}))}))}this.seedBatchedOperationsManager.addBatchItem(e,this.operationBatchConfig,{name:"SubmitSeedOperations"},o,t)},e.prototype.onAnnotationResultsFromServer=function(e,t){this.onAnnotationResults(e,1,t)},e.prototype.sendWorkflowGraphInitMessage=function(){var e=this,t=this.localWorkflowManager.getAllRegisteredWorkflowsFromSession(this).map((function(e){return(0,y.getWorkflowDefinitionBase)(e)})),o=new d.Operation({operationName:"WorkflowGraphInit",resultDescription:"sending WorkflowGraphInit message ".concat(t.map((function(e){return e.id})))}).start(),r=new n.WorkflowGraphInitMessage({upstreamRuntimeWorkflows:t});this.getSessionManager().sendMessage(r,(function(t,n){if(t)return o.resultDescription="".concat(o.resultDescription,". error: ").concat(t,"}"),void d.Log.error(524300628,d.LogCategory.CoreDefault,o.stop());d.Log.info(524300629,d.LogCategory.CoreDefault,o.stop()),e.onWorkflowGraphInitResponse(n)}))},e.prototype.onWorkflowGraphInitResponse=function(e){for(var t=0,o=e.downstreamRuntimeWorkflows||[];t<o.length;t++){var n=o[t];this.workflowGraph.addWorkflow(n)}},e.prototype.resolvePlaceholdersInOperationParentPath=function(e){var t=e;return 3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("user_")&&(d.Log.info(540848914,d.LogCategory.CoreDefault,"Replacing user context placeholder for: ".concat((0,g.makeItemPathKey)(e),".")),t=["session","#userContext#"]),3==t.length&&"session"==t[0]&&"user"==t[1]&&t[2].startsWith("tenant_")&&(d.Log.info(540848915,d.LogCategory.CoreDefault,"Replacing tenant context placeholder for: ".concat((0,g.makeItemPathKey)(e),".")),t=["session","#tenantContext#"]),t},e}();o.SessionProxy=m},{102:102,114:114,132:132,17:17,31:31,38:38,57:57,63:63,65:65,76:76,78:78,90:90,97:97,99:99}],74:[function(e,t,o){"use strict";var n=e("assignHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.TelemetryLogger=void 0;var r=e(17),i=function(){function e(e){this.level=r.LoggingLevel.info,this.hostCallbacks=e}return e.prototype.log=function(t){var o=this;if(null!=this.hostCallbacks&&null!=this.hostCallbacks.sendTelemetryEvent){var r=function(t,r,i,s,a){var c=r.charAt(0).toUpperCase()+r.slice(1),u={ResourceId:t.resourceId,ResultDescription:t.resultDescription,ResultSignature:t.resultSignature,Dimension0:t.dimension0,Dimension1:t.dimension1,Dimension2:t.dimension2,Dimension3:t.dimension3};i&&(u=n(n({},u),JSON.parse(i))),o.hostCallbacks.sendTelemetryEvent(s||e.augLoopAriaTenantToken,"".concat(a||e.augLoopAriaNamespace,"_").concat(c),u,"Office.System.Activity",{CV:t.cv,Duration:1e3*(t.durationMs||0),Count:t.count,AggMode:2,Success:t.success},!1,6,110)};if("Operation"===t.eventName){var i=t;r(i,i.operationName,i.dataFields)}else if("SessionHealth"===t.eventName){r(t,t.sessionHealthEventName)}else if("WorkflowOperation"===t.eventName){var s=t;r(s,s.operationName,s.dataFields,s.ariaTenant,s.ariaNamespace)}}},e.augLoopAriaTenantToken="3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770",e.augLoopAriaNamespace="Office_AugLoop_Client",e}();o.TelemetryLogger=i},{17:17}],75:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.TokenCache=void 0;var n=e(76),r=function(){function e(e){void 0===e&&(e=33e5),this.tokenCache=new Map,this.requestMap=new Map,this.requestRecordMap=new Map,this.tokenExpirationMs=e}return e.prototype.updateAuthToken=function(e,t){var o=this,r=JSON.stringify(t),i=this.requestRecordMap.get(r);return(void 0===i||this.isTokenExpired(i))&&(i={requestPromise:e.requestAuthToken(t).then((function(e){if(!e||!e.Token)throw new Error("No token available for request ".concat(r));o.tokenCache.set(r,e.Token)})),requestTime:n.Utils.getCurrentTimeMs()},this.requestRecordMap.set(r,i)),i.requestPromise},e.prototype.getAuthTokenEntries=function(e,t){var o=this;return Array.from(this.tokenCache.keys()).map((function(e){var t=o.requestMap.get(e);return void 0===t&&(t=JSON.parse(e),o.requestMap.set(e,t)),{requestKey:e,request:t}})).filter((function(e){var o=e.request;return!t||o.DocId===t})).map((function(t){var n=t.requestKey,r=t.request;return o.isTokenExpired(o.requestRecordMap.get(n))&&o.updateAuthToken(e,r),{ticket:r.Tickets[0],token:o.tokenCache.get(n)}}))},e.prototype.isTokenExpired=function(e){return n.Utils.getCurrentTimeMs()>e.requestTime+this.tokenExpirationMs},e}();o.TokenCache=r},{76:76}],76:[function(e,t,o){"use strict";var n=e("spreadArrayHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.isServerOp=o.getSafeNumber=o.buildArrayOfTypes=o.LogCountLimiter=o.Utils=void 0;var r=e(31),i=e(90),s=e(114),a=function(){function e(){}return e.createHealthCheckRequest=function(e){return{payload:{},payloadSchema:{category:i.TypeCategory.Schema,schema:{name:"HealthCheckRequest"}},requestedSchema:{category:i.TypeCategory.Schema,schema:{name:"HealthCheckResponse"}},clientMetadata:e}},e.isFeatureEnabled=function(e,t,o,n){return void 0===o&&(o=!1),void 0===n&&(n="None"),e&&e.isFeatureEnabled?e.isFeatureEnabled("Microsoft.Office.AugLoop."+t,n).catch((function(){return Promise.resolve(o)})):Promise.resolve(o)},e.convertWebSocketUrlToHttp=function(e){return this.convertUrl(e,!1)},e.convertServiceUrlToWebSocket=function(e){return this.convertUrl(e,!0)},e.convertUrl=function(e,t){if(!e)return e;var o=e.split(":"),n=o[0].toLowerCase();return 0==n.indexOf(t?"http":"ws")?(n=t?n.replace("http","ws"):n.replace("ws","http"),o[0]=n,o.join(":")):e},e.getCurrentTimeMs=function(){return Date.now?Date.now():(new Date).getTime()},e}();o.Utils=a;var c=function(){function e(e){this.maxNumberOfLogs=40,this.numberOfLogs=0,this.id=e}return e.prototype.log=function(e){if(this.numberOfLogs<this.maxNumberOfLogs&&(this.numberOfLogs++,e(),this.numberOfLogs===this.maxNumberOfLogs)){var t=new r.Operation({operationName:"OnLastLog",success:!0,resourceId:this.id,resultDescription:"Limit for number of logs for id: ".concat(this.id," reached - all next logs will be dropped")});r.Log.warn(572838107,r.LogCategory.CoreDefault,t)}},e}();o.LogCountLimiter=c;var u=[s.SchemaObject.getTypeName(),s.Annotation.getTypeName(),s.Signal.getTypeName()];o.buildArrayOfTypes=function(e){for(var t=new Set,o=0,r=e;o<r.length;o++){var i=r[o];if("string"==typeof i)-1===u.indexOf(i)&&t.add(i);else for(var s=0,a=n([i.getTypeName()],i.getBaseTypes(),!0);s<a.length;s++){var c=a[s];-1===u.indexOf(c)&&t.add(c)}}return Array.from(t)};o.getSafeNumber=function(e,t){return void 0===t&&(t=0),Number.isFinite(e)?e:t};o.isServerOp=function(e,t){if(!Array.isArray(t)||0===t.length)return!0;if(s.DeltaUpdateOperation.typeGuard(e)||s.UpdateAnnotationMetaDataOperation.typeGuard(e))return!0;for(var o=0,n=e.items;o<n.length;o++){var r=n[o];if(!r.body||s.SchemaObject.matchesTypesFor(r.body,t))return!0}return!1}},{114:114,31:31,90:90}],77:[function(e,t,o){t.exports={version:"2.27.152"}},{}],78:[function(e,t,o){"use strict";var n=e("extendsHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.EmptySessionManager=void 0;var r=e(31),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n(t,e),t.prototype.init=function(){return Promise.resolve()},t.prototype.sendMessage=function(e,t){},t.prototype.onMessage=function(e,t){},t.prototype.forceReconnect=function(){return Promise.resolve()},t.prototype.closeSession=function(){},t.prototype.sendBytes=function(e){},t.prototype.getCorrelationVector=function(){return new r.CorrelationVector},t.prototype.setState=function(e){},t}(e(146).EventEmitter);o.EmptySessionManager=i},{146:146,31:31}],79:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.SessionStats=void 0;var n=function(){};o.SessionStats=n},{}],80:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.MessageQueue=o.ClientSendMessageErrorReason=void 0;var n,r=e(102),i=e(114),s=e(145),a=e(76),c=e(31);!function(e){e.ArrivedBeforeReseeding="Message is dropped from queue since it arrived before reseeding is started",e.DroppedAsOldestInQueue="Message is dropped as oldest in full queue"}(n=o.ClientSendMessageErrorReason||(o.ClientSendMessageErrorReason={}));var u=function(){function e(e){this.logOp=new c.Operation({operationName:"MessageQueue",success:!0}),this.messageQueueLogCountLimiter=new a.LogCountLimiter("MessageQueue"),this.queue=new s(1e3),this.callbacks=e}return e.prototype.push=function(e,t,o){var i=this,s=this.queue;if(1e3===s.length){this.messageQueueLogCountLimiter.log((function(){i.logOp.resourceId="QueueFull",i.logOp.durationMs=0,c.Log.warn(573187741,c.LogCategory.CoreDefault,i.logOp)}));var u=s.shift();u.onResponse&&u.onResponse(new r.ErrorResponse({error:n.DroppedAsOldestInQueue}))}s.push({message:e,onResponse:t,timeQueued:a.Utils.getCurrentTimeMs(),attemptNumber:o})},e.prototype.sendOnSessionInitialized=function(e){var t=this,o=this.queue.length,s=0;if(o>0){for(var u=a.Utils.getCurrentTimeMs()-this.queue.get(0).timeQueued;this.queue.length>0&&this.callbacks.canSendMessage();){var l=this.queue.shift();e&&l.message instanceof r.SyncMessage&&i.SchemaObject.matchesTypesFor(l.message,[r.SyncMessage.getTypeName()])&&(!this.callbacks.dropOnlySequencedSyncsOnReseed||l.message.seq>=0)?(s++,l.onResponse&&l.onResponse(new r.ErrorResponse({error:n.ArrivedBeforeReseeding}))):l.message instanceof Uint8Array?this.callbacks.sendBytes(l.message):this.callbacks.sendMessage(l.message,l.onResponse,l.attemptNumber)}this.messageQueueLogCountLimiter.log((function(){t.logOp.resourceId="SendOnSessionInitialized",t.logOp.resultDescription="Queue size before: ".concat(o,", after: ").concat(t.queue.length,". droppedSyncMessages: ").concat(s),t.logOp.durationMs=u,c.Log.warn(573187742,c.LogCategory.CoreDefault,t.logOp)}))}},e}();o.MessageQueue=u},{102:102,114:114,145:145,31:31,76:76}],81:[function(e,t,o){"use strict";var n=e("extendsHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.SessionInitializer=void 0;var r=e(31),i=e(102),s=e(76),a=function(e){function t(t,o,n,r,i){var s=e.call(this)||this;return s.getSessionStats=t,s.clientMetadata=o,s.tokenRefreshManager=n,s.sendMessage=r,s.options=i||{},s.options.overrideSessionInitMessage=s.options.overrideSessionInitMessage||function(e){return e},s}return n(t,e),t.prototype.initSession=function(e){var t=this;e.onResponse=e.onResponse||function(){};var o=s.Utils.getCurrentTimeMs(),n=this.getSessionStats().lastConnectionClose&&o-this.getSessionStats().lastConnectionClose,a=this.getSessionStats().lastSyncMessage&&o-this.getSessionStats().lastSyncMessage,c=new r.Operation({operationName:"SessionInit"}).start(),u={sessionKey:this.sessionKey,sessionId:this.clientMetadata.sessionId,timeSinceLastConnectionClose:n,timeSinceLastSyncMessage:a,isTokenRefresh:e.isTokenRefresh,error:void 0},l=this.options.overrideSessionInitMessage(new i.SessionInitMessage({protocolVersion:i.currentProtocolVersion,clientMetadata:this.clientMetadata,sessionKey:this.sessionKey,origin:this.origin,authToken:this.anonymousToken,extensionConfigs:e.extensionConfigs,returnWorkflowInputTypes:!0}));this.sendMessage(l,(function(o,n){c.success=!o,c.resultSignature=t.getSessionStats().lastConnectionClose?"Reconnect":"FirstConnect",c.resourceId=null==n?void 0:n.sliceUrl,(null==n?void 0:n.sessionKey)&&u.sessionKey!==n.sessionKey&&(u.sessionKey=n.sessionKey),o&&(u.error=o.error),c.resultDescription=JSON.stringify(u),r.Log.info(572838103,r.LogCategory.CoreDefault,c.stop()),e.onResponse(o,n),o||e.isReconnectOnSameSlice&&n.forceReconnect||(n.anonymousToken&&n.tokenExpirationSeconds?(t.anonymousToken=n.anonymousToken,t.onSuccessfulSessionInitOnServerSide(n)):r.Log.error(572838104,r.LogCategory.CoreDefault,"AL Anonymous token was not generated for the session"))}))},t.prototype.onSuccessfulSessionInitOnServerSide=function(e){var t=this;this.tokenRefreshManager.scheduleRefresh(0,e.tokenExpirationSeconds,this.initSession.bind(this,{isTokenRefresh:!0}),(function(){t.anonymousToken=void 0})),this.initHostAuthToken();var o=!!this.sessionKey,n=this.sessionKey!==e.sessionKey;this.sessionKey=e.sessionKey,this.origin=e.origin,this.emit("connect",n,o,"".concat(e.sessionUrlBase,"/").concat(e.sessionKey),e.origin,this.anonymousToken,e.workflowInputTypes),o&&this.emit("reconnect")},t.prototype.initHostAuthToken=function(){var e=this;this.options.getAuthToken&&this.options.getAuthToken().then((function(t){t?e.sendTokenProvisionMessage(t):r.Log.info(572838105,r.LogCategory.CoreDefault,"Host auth token provision failed")})).catch((function(e){r.Log.error(572838106,r.LogCategory.CoreDefault,"Error happened while attempting to fetch host token: ".concat(e))}))},t.prototype.sendTokenProvisionMessage=function(e){var t=new i.TokenProvisionMessage({authToken:e});this.sendMessage(t,this.onTokenProvisionResponse.bind(this))},t.prototype.onTokenProvisionResponse=function(e,t){!e&&t&&t.tokenExpirationSeconds&&this.tokenRefreshManager.scheduleRefresh(1,t.tokenExpirationSeconds,this.initHostAuthToken.bind(this))},t}(e(146).EventEmitter);o.SessionInitializer=a},{102:102,146:146,31:31,76:76}],82:[function(e,t,o){"use strict";var n=e("extendsHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.ClosedState=o.DisconnectedState=o.RunningState=o.InitingState=o.BaseState=o.queueBytes=o.queueMessage=o.sendMessageNow=o.SessionState=void 0;var r,i=e(102),s=e(114);!function(e){e[e.Initing=0]="Initing",e[e.Running=1]="Running",e[e.Disconnected=2]="Disconnected",e[e.Closed=3]="Closed"}(r=o.SessionState||(o.SessionState={}));o.sendMessageNow=function(e,t,o,n){t&&(t.cv||(t.cv=e.cvParent.newChild().toString()),e.messageEndpoint.sendMessage(t,(function(t,n){t||s.SchemaObject.getTypeNameFor(n)!==i.SyncResponse.getTypeName()||(e.stats.lastSyncMessage=Date.now()),o&&o(t,n)}),void 0,n))};o.queueMessage=function(e,t,o,n){t&&(e.messageQueue.push(t,o,n),e.webSocketWorkerManager.init(void 0,e.customInitPromise))};o.queueBytes=function(e,t){t&&(e.messageQueue.push(t),e.webSocketWorkerManager.init(void 0,e.customInitPromise))};var a=function(){function e(e){this.context=e}return e.prototype.onEnter=function(e){},e.prototype.sendMessage=function(e,t,o){},e.prototype.sendBytes=function(e){},e.prototype.canSendMessage=function(){return!1},e.prototype.onConnectionClose=function(){},e}();o.BaseState=a;var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stateName=r.Initing,t.possibleNextStates=[r.Running,r.Disconnected,r.Closed],t}return n(t,e),t.prototype.sendMessage=function(e,t,n){s.SchemaObject.matchesTypesFor(e,[i.SessionInitMessage.getTypeName()])?(0,o.sendMessageNow)(this.context,e,t,n):(0,o.queueMessage)(this.context,e,t)},t.prototype.sendBytes=function(e){(0,o.queueBytes)(this.context,e)},t.prototype.onConnectionClose=function(){this.context.setState(r.Disconnected)},t}(a);o.InitingState=c;var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stateName=r.Running,t.possibleNextStates=[r.Disconnected,r.Closed],t}return n(t,e),t.prototype.onEnter=function(e){e&&e.isSessionReseedingStarted&&this.context.resetNextSyncSequenceId(),this.context.messageQueue.sendOnSessionInitialized(e&&e.isSessionReseedingStarted)},t.prototype.sendMessage=function(e,t,n){(0,o.sendMessageNow)(this.context,e,t,n)},t.prototype.sendBytes=function(e){e&&this.context.webSocketWorkerManager.egressBytes(e)},t.prototype.canSendMessage=function(){return!0},t.prototype.onConnectionClose=function(){this.context.setState(r.Disconnected)},t}(a);o.RunningState=u;var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.stateName=r.Disconnected,t.possibleNextStates=[r.Initing,r.Closed],t}return n(t,e),t.prototype.onEnter=function(e){this.context.messageEndpoint.cancelPendingResponseCallbacks()},t.prototype.sendMessage=function(e,t,n){s.SchemaObject.matchesTypesFor(e,[i.SessionInitMessage.getTypeName()])?(this.context.setState(r.Initing),(0,o.sendMessageNow)(this.context,e,t,n)):s.SchemaObject.matchesTypesFor(e,[i.SessionCloseMessage.getTypeName()])?this.context.setState(r.Closed):(0,o.queueMessage)(this.context,e,t,n)},t.prototype.sendBytes=function(e){(0,o.queueBytes)(this.context,e)},t}(a);o.DisconnectedState=l;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state=r.Closed,t.possibleNextStates=[],t}return n(t,e),t}(a);o.ClosedState=p},{102:102,114:114}],83:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.TokenRefreshManager=void 0;var n=function(){function e(){this.timers=new Map}return e.prototype.scheduleRefresh=function(t,o,n,r){var i=this.timers.get(t);i||(i={numberOfAttempts:0},this.timers.set(t,i)),i.refreshTimeoutId&&(clearTimeout(i.refreshTimeoutId),i.refreshTimeoutId=void 0),i.expiredTimeoutId&&(clearTimeout(i.expiredTimeoutId),i.expiredTimeoutId=void 0);var s=1e3*o-e.tokenRefreshBufferMs,a=1e3*o-e.tokenExpirationBufferMs;s>0?i.numberOfAttempts=0:(++i.numberOfAttempts,s=e.tokenRefreshBackoffIntervalMs,a=e.tokenExpirationBufferMs),i.numberOfAttempts<=e.tokenRefreshMaximumAttempts&&(i.refreshTimeoutId=setTimeout((function(){n()}),s)),r&&(i.expiredTimeoutId=setTimeout((function(){r()}),a))},e.prototype.clearRefreshTimeouts=function(){this.clearTimeouts(!1)},e.prototype.clearAllTimeouts=function(){this.clearTimeouts(!0)},e.prototype.clearTimeouts=function(e){var t=this;this.timers.forEach((function(o,n){o.refreshTimeoutId&&(clearTimeout(o.refreshTimeoutId),o.refreshTimeoutId=void 0),e&&o.expiredTimeoutId&&(clearTimeout(o.expiredTimeoutId),o.expiredTimeoutId=void 0),o.expiredTimeoutId||t.timers.delete(n)}))},e.tokenRefreshBufferMs=24e4,e.tokenExpirationBufferMs=12e4,e.tokenRefreshBackoffIntervalMs=3e4,e.tokenRefreshMaximumAttempts=3,e}();o.TokenRefreshManager=n},{}],84:[function(e,t,o){"use strict";var n=e("extendsHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.WebSocketSessionManager=void 0;var r=e(31),i=e(102),s=e(114),a=e(146),c=e(76),u=e(80),l=e(82),p=e(85),f=function(e){function t(t,o,n,s,a,f,d){var h,g=e.call(this)||this;return g.cvParent=new r.CorrelationVector,g.logOp=new r.Operation({operationName:"SessionState",success:!0}).start(),g.sessionStateChangeLogCountLimiter=new c.LogCountLimiter("SessionState"),g.stats=o,g.allStates=((h={})[l.SessionState.Initing]=new l.InitingState(g),h[l.SessionState.Running]=new l.RunningState(g),h[l.SessionState.Disconnected]=new l.DisconnectedState(g),h[l.SessionState.Closed]=new l.ClosedState(g),h),g.setState(l.SessionState.Initing),g.messageEndpoint=new i.MessageEndpoint("c"),g.messageEndpoint.setClientMetadata(a),g.messageEndpoint.setEgress(g.egress.bind(g)),g.messageEndpoint.onMessage(i.SessionCloseMessage.getTypeName(),(function(e,t){g.onSessionCloseMessage(e,t)})),g.webSocketWorkerManager=new p.WebSocketWorkerManager(t,a,n,s,g.ingress.bind(g),g.onConnectionClose.bind(g),(function(){g.onSessionClose(void 0,"WSNotSupported")}),d),g.messageQueue=new u.MessageQueue({sendMessage:function(e,t,o){return g.state.sendMessage(e,t,o)},sendBytes:g.sendBytes.bind(g),canSendMessage:function(){return g.state.canSendMessage()},dropOnlySequencedSyncsOnReseed:d.dropOnlySequencedSyncsOnReseedEnabled}),s.on("connect",(function(e,t,o,n,r,i){g.setState(l.SessionState.Running,"",{isSessionReseedingStarted:e&&t}),g.emit("connect",e,o,n,r,i)})),s.on("reconnect",(function(){return g.emit("reconnect")})),g.resetNextSyncSequenceId=function(){return g.emit("resetNextSyncSequenceId")},g.tokenRefreshManager=f,g}return n(t,e),t.prototype.setState=function(e,t,o){var n=this;if(!this.state||e!==this.state.stateName){var i=this.state&&this.state.stateName?l.SessionState[this.state.stateName]:"undefined",s="undefined"===i&&e===l.SessionState.Initing||this.state.possibleNextStates.indexOf(e)>=0;this.sessionStateChangeLogCountLimiter.log((function(){n.logOp.stop(),n.logOp.resourceId="New state: ".concat(s?l.SessionState[e]:i),n.logOp.resultDescription="Previous state: ".concat(i),n.logOp.dimension0="Attempted state: ".concat(l.SessionState[e]||"undefined"),n.logOp.resultSignature=t+(n.state&&!s?"Unexpected state change":""),n.logOp.success=s,r.Log.info(573167323,r.LogCategory.CoreDefault,n.logOp)})),s&&(this.state=this.allStates[e],this.logOp.start(),this.state.onEnter(o))}},t.prototype.init=function(e,t){return this.extensionConfigs=e,this.customInitPromise=t,this.webSocketWorkerManager.init(this.extensionConfigs,this.customInitPromise,!0)},t.prototype.sendMessage=function(e,o){this.retrySendMessage(e,o,t.maxRetries)},t.prototype.sendBytes=function(e){this.state.sendBytes(e)},t.prototype.onMessage=function(e,t){this.messageEndpoint.onMessage(e,t)},t.prototype.getCorrelationVector=function(){return this.cvParent},t.prototype.forceReconnect=function(e){var t=this;return this.extensionConfigs=e||this.extensionConfigs,this.webSocketWorkerManager.close(!1),new Promise((function(e){return setTimeout((function(){e(t.webSocketWorkerManager.init(t.extensionConfigs))}),100)}))},t.prototype.closeSession=function(){this.sendMessage(new i.SessionCloseMessage),this.webSocketWorkerManager.close(!0),this.onSessionClose(void 0,"ClientRequested")},t.prototype.ingress=function(e){var t,o=this;try{t=JSON.parse(e)}catch(e){r.Log.error(573167324,r.LogCategory.CoreDefault,new r.SessionHealthEvent({sessionHealthEventName:"ProcessMessage",resourceId:"Unknown",success:!1,resultSignature:"ParseError",resultDescription:e.message,durationMs:0,source:r.SessionHealthSource.ClientRuntime,reason:r.SessionHealthReason.Client,impact:r.SessionHealthImpact.MissingOutput,affectedWorkflows:["All"],message:""}))}t&&this.messageEndpoint.ingress(t,(function(e,t){return o.egress(e||t,(function(){}))}))},t.prototype.egress=function(e,t){e&&this.webSocketWorkerManager.egress(e).then((function(){return t()})).catch((function(e){return t(e)}))},t.prototype.onSessionCloseMessage=function(e,t){e.reconnectAllowed?this.webSocketWorkerManager.close():this.onSessionClose(e,"CloseMessageReceived"),t()},t.prototype.onSessionClose=function(e,t){this.setState(l.SessionState.Closed,t),this.tokenRefreshManager.clearAllTimeouts(),this.onConnectionClose(void 0),e&&this.emit("sessionClose",e)},t.prototype.onConnectionClose=function(e){this.state.onConnectionClose(),this.stats.lastConnectionClose=c.Utils.getCurrentTimeMs(),this.emit("disconnect",e)},t.prototype.retrySendMessage=function(e,o,n){var r=this,i=t.maxRetries-n;this.state.sendMessage(e,(function(t,i){t&&n>0&&r.canBeRetried(e)&&r.isTransientError(t)?r.retrySendMessage(e,o,n-1):o&&o(t,i)}),i)},t.prototype.canBeRetried=function(e){return!s.SchemaObject.matchesTypesFor(e,[i.SessionInitMessage.getTypeName(),i.MicroSyncMessage.getTypeName()])},t.prototype.isTransientError=function(e){var t=e.error;return t!==i.SendMessageErrorReason.SyncMessageUnsupportedBatch&&t!==i.SendMessageErrorReason.UnexpectedSeedMessage&&t!==i.SendMessageErrorReason.UnsupportedSyncMessage&&t!==i.SendMessageErrorReason.AnnotationTokenNotFound&&t!==u.ClientSendMessageErrorReason.ArrivedBeforeReseeding&&t!==u.ClientSendMessageErrorReason.DroppedAsOldestInQueue},t.maxRetries=2,t}(a.EventEmitter);o.WebSocketSessionManager=f},{102:102,114:114,146:146,31:31,76:76,80:80,82:82,85:85}],85:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.WebSocketWorkerManager=o.calculateTimeToWaitForNextTry=void 0;var n=e(114),r=e(102),i=e(31),s=e(76),a=e(28),c=e(66);o.calculateTimeToWaitForNextTry=function(e,t){var o=0,n=s.Utils.getCurrentTimeMs()?s.Utils.getCurrentTimeMs()-t:0,r=[1e3,2e3,5e3,1e4,6e4];return o=r[Math.max(0,Math.min(r.length-1,e-1))],o=Math.max(o-n,1e3)};var u=function(){function e(t,o,n,r,a,u,l,p){var f=this;this.logCountLimiter=new s.LogCountLimiter(e.className),this.isWorkerReady=!1,this.permanentlyClosed=!1,this.currentReconnectAttempt=0,this.lastInitializationAttemptTimeMs=0,this.offlineInterval=void 0,this.alreadyLoggedReconnectAttempt=!1,this.httpTestsLeft=5,this.httpTestsSuccessCount=0,this.wsOpenCount=0,this.testHttpConnection=function(e){var t=s.Utils.convertWebSocketUrlToHttp(f.globalUrl),o=!e,n=null!=e?e:new i.Operation({operationName:"HttpsTest",resourceId:t,success:!1,resultDescription:"",resultSignature:"HttpResponse:"}).start(),r={method:"POST",headers:{"content-type":"application/json","X-CorrelationId":n.cv},body:JSON.stringify(s.Utils.createHealthCheckRequest(f.clientMetadata))};(0,c.internalFetch)(t,r,(function(e,t){e?(n.dimension1="HttpErr",n.resultDescription+="HttpErr: ".concat(e.message)):t&&t.ok?(n.dimension1="HttpOK",f.leaveOfflineMode(),f.httpTestsSuccessCount++,o&&(n.success=!0)):(n.dimension1="HttpNoResp",n.resultDescription+="HttpStatus: ".concat(null==t?void 0:t.status)),o&&n.stop(),f.logCountLimiter.log((function(){i.Log.info(558445283,i.LogCategory.CoreDefault,n)}))}))},this.globalUrl=t,this.clientMetadata=o,this.workerFactory=n,this.sessionInitializer=r,this.ingress=a,this.onConnectionClose=u,this.onDetectedWSBlock=l,this.closeWSBlockedSession=p.closeWSBlockedSessionEnabled,this.sessionOfflineModeEnabled=p.sessionOfflineModeEnabled}return e.prototype.init=function(t,o,n){var r=this;if(void 0===n&&(n=!1),this.permanentlyClosed)return Promise.reject("permanentlyClosed");if(this.isWorkerReady||this.pendingInitPromise)return this.pendingInitPromise?this.pendingInitPromise:Promise.resolve();this.extensionConfigs=t||this.extensionConfigs;var s=function(){if(n||!r.alreadyLoggedReconnectAttempt){var t=n?e.initialAttemptTimeout:e.reconnectAttemptTimeout;r.connTimeout=setTimeout((function(){var e=new i.Operation({operationName:"ConnectionFailingOrSlow",dimension0:n?"Initial":"Reconnect",dimension1:t.toString(),dimension2:r.currentReconnectAttempt.toString()});i.Log.info(572838096,i.LogCategory.CoreDefault,e),r.alreadyLoggedReconnectAttempt=!n,r.connTimeout=void 0}),t)}};return o?this.pendingInitPromise=o().catch((function(e){i.Log.error(572838097,i.LogCategory.CoreDefault,"Error occurred during calling the custom init promise: ".concat(e))})).then((function(){s(),r.initInternal()})):(this.pendingInitPromise=Promise.resolve(),s(),this.initInternal()),this.pendingInitPromise},e.prototype.egress=function(e){var t=this;return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((function(){t.egressInternal(e)})):(this.egressInternal(e),Promise.resolve())},e.prototype.egressBytes=function(e){var t=this;return!this.isWorkerReady&&this.pendingInitPromise?this.pendingInitPromise.then((function(){t.egressBytesInternal(e)})):(this.egressBytesInternal(e),Promise.resolve())},e.prototype.close=function(e){this.worker&&this.worker.close(),this.isWorkerReady=!1,this.worker=null,this.permanentlyClosed=e||this.permanentlyClosed,this.permanentlyClosed&&(this.leaveOfflineMode(),clearTimeout(this.connTimeout))},e.prototype.initInternal=function(){var e=this;this.isWorkerReady=!1,this.permanentlyClosed||this.isOffline()||(this.currentReconnectAttempt>0?setTimeout((function(){e.tryToConnectAndInitializeSession()}),(0,o.calculateTimeToWaitForNextTry)(this.currentReconnectAttempt,this.lastInitializationAttemptTimeMs)):this.tryToConnectAndInitializeSession())},e.prototype.egressInternal=function(e){var t;this.isWorkerReady||n.SchemaObject.matchesTypesFor(e,[r.SessionInitMessage.getTypeName()])?(n.SchemaObject.matchesTypesFor(e,[r.MicroSyncMessage.getTypeName()])?(this.castBinaryData(e),t=a.JSOND.serialize(e)):t=JSON.stringify(e),this.worker.egress(t)):n.SchemaObject.matchesTypesFor(e,[r.Response.getTypeName()])||i.Log.error(572838098,i.LogCategory.CoreDefault,new i.Operation({operationName:"UnexpectedEgressCall",resultDescription:"isWorkerReady: ".concat(this.isWorkerReady)}))},e.prototype.egressBytesInternal=function(e){this.isWorkerReady?this.worker.egress(e):i.Log.error(572838099,i.LogCategory.CoreDefault,new i.Operation({operationName:"UnexpectedEgressBytesCall",resultDescription:"isWorkerReady: ".concat(this.isWorkerReady)}))},e.prototype.tryToConnectAndInitializeSession=function(){var e=this;this.currentReconnectAttempt++,this.lastInitializationAttemptTimeMs=s.Utils.getCurrentTimeMs();var t=function(o){e.permanentlyClosed||e.isOffline()||(e.connect(e.sliceUrl?e.sliceUrl:e.globalUrl),e.sessionInitializer.initSession({isTokenRefresh:!1,isReconnectOnSameSlice:!!e.sliceUrl,extensionConfigs:e.extensionConfigs,onResponse:function(n,r){if(o.success=!n,o.resultDescription=n?"WS Error: ".concat(n.error):"",o.resourceId=r?r.sliceUrl:"",o.dimension0=o.success?"WSOK":"WSFail",n||!e.worker)return e.sliceUrl=void 0,e.close(),e.httpTestsLeft>0?(e.httpTestsLeft--,e.testHttpConnection(o.stop())):(e.closeWSBlockedSession&&0===e.wsOpenCount&&e.httpTestsSuccessCount>=5?(e.permanentlyClosed=!0,o.dimension1="WSBlocked",e.onDetectedWSBlock()):e.sessionOfflineModeEnabled&&0===e.httpTestsSuccessCount&&(e.startOfflineMode(),o.dimension1="WSOffline"),e.logCountLimiter.log((function(){i.Log.info(572838100,i.LogCategory.CoreDefault,o.stop())}))),void e.initInternal();if(e.logCountLimiter.log((function(){i.Log.info(555823373,i.LogCategory.CoreDefault,o.stop())})),r.forceReconnect){e.close();var s=new i.Operation({operationName:"ForcedReconnect"}).start();s.resultSignature="globalUrl: ".concat(e.globalUrl,". sliceUrl: ").concat(e.sliceUrl),e.sliceUrl=void 0,setTimeout((function(){t(s)}),1e3)}else clearTimeout(e.connTimeout),e.sliceUrl=r.sliceUrl,e.ready();e.resetHttpTestsCounter()}}))},o=new i.Operation({operationName:"TryToConnectAndInitializeSession",resultSignature:"Reconnection attempt #".concat(this.currentReconnectAttempt)}).start();t(o)},e.prototype.connect=function(e){var t=this;this.worker=this.workerFactory(),this.worker.init(e,this.ingress,(function(){t.wsOpenCount++,t.leaveOfflineMode()}),(function(e){t.onConnectionClose(e),t.close()}))},e.prototype.ready=function(){this.isWorkerReady=!0,this.pendingInitPromise=void 0,this.currentReconnectAttempt=0},e.prototype.castBinaryData=function(e){if(e){if(Array.isArray(e.__binaryMembers__))for(var t=0,o=e.__binaryMembers__;t<o.length;t++){var n=o[t];ArrayBuffer.isView(e[n])||(e[n]=new Uint8Array(e[n]))}for(var r=0,i=Object.keys(e);r<i.length;r++){var s=i[r];"object"==typeof e[s]&&null!==e[s]&&this.castBinaryData(e[s])}}},e.prototype.isOffline=function(){return!!this.offlineInterval},e.prototype.startOfflineMode=function(){var e=this;this.offlineInterval=setInterval((function(){e.testHttpConnection()}),6e4)},e.prototype.leaveOfflineMode=function(){this.isOffline()&&(clearInterval(this.offlineInterval),this.offlineInterval=void 0,this.resetHttpTestsCounter(),this.tryToConnectAndInitializeSession())},e.prototype.resetHttpTestsCounter=function(){this.httpTestsLeft=5,this.httpTestsSuccessCount=0},e.initialAttemptTimeout=1e5,e.reconnectAttemptTimeout=2e4,e.className="WebSocketWorkerManager",e}();o.WebSocketWorkerManager=u},{102:102,114:114,28:28,31:31,66:66,76:76}],86:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.WebSocketWorker=void 0;var n=e(150),r=e(31),i=e(76),s=function(){function e(){this.hasBeenOpened=!1,this.hadEgressError=!1,this.lastEgressTime=0,this.lastPongTime=0,this.remainingPingFailures=3,this.pendingEgress=[]}return e.prototype.init=function(t,o,i,s){var a=this;this.ws=new n(t),this.logOp=new r.Operation({operationName:e.className,success:!0}).start();var c=function(e){a.logPingLatencyOp&&(a.logPingLatencyOp.success=e,r.Log.info(572838091,r.LogCategory.CoreDefault,a.logPingLatencyOp.stop()),a.logPingLatencyOp=void 0)};this.ws.addEventListener("open",(function(t){i(),e.logCountLimiter.log((function(){a.logOp.resourceId="OnOpen",a.logOp.resultDescription="",a.logOp.success=!0,r.Log.info(572838092,r.LogCategory.CoreDefault,a.logOp.stop())})),a.hasBeenOpened=!0,a.pendingEgress.forEach((function(e){a.egress(e)})),a.pendingEgress=[],a.pingInterval=setInterval((function(){a.logPingLatencyOp&&(--a.remainingPingFailures,c(!1)),a.remainingPingFailures>0&&a.hasBeenOpened&&a.lastPongTime<a.lastEgressTime&&(a.logPingLatencyOp=new r.Operation({operationName:"Ping",success:!0,dimension0:a.ws.bufferedAmount>=0?a.ws.bufferedAmount.toString().length.toString():void 0}).start(),a.ws.send(e.pingPongMessage,(function(e){e&&(--a.remainingPingFailures,c(!1))})))}),3e4)})),this.ws.addEventListener("message",(function(t){a.logPingLatencyOp&&"string"==typeof t.data&&1===t.data.length&&t.data[0]===e.pingPongMessage?(c(!0),a.lastPongTime=Date.now()):o(t.data)})),this.ws.addEventListener("error",(function(t){a.errorMessage=t.message,e.logCountLimiter.log((function(){a.logOp.resourceId="OnError",a.logOp.resultDescription=a.errorMessage,a.logOp.success=!1,r.Log.info(572838093,r.LogCategory.CoreDefault,a.logOp.stop())})),a.ws.close()})),this.ws.addEventListener("close",(function(t){e.logCountLimiter.log((function(){a.logOp.resourceId="OnClose",a.logOp.resultDescription=t?"code: ".concat(t.code,". reason: ").concat(t.reason):"",a.logOp.success=!0,r.Log.info(572838094,r.LogCategory.CoreDefault,a.logOp.stop())})),a.pingInterval&&(clearInterval(a.pingInterval),a.pingInterval=void 0),s(a.errorMessage)}))},e.prototype.egress=function(t){var o=this;this.lastEgressTime=Date.now(),this.hasBeenOpened?this.ws.send(t,(function(t){t&&!o.hadEgressError&&(o.hadEgressError=!0,e.logCountLimiter.log((function(){o.logOp.resourceId="OnFirstEgressError",o.logOp.resultDescription=t.message,o.logOp.success=!1,r.Log.info(572838095,r.LogCategory.CoreDefault,o.logOp.stop())})))})):this.pendingEgress.push(t)},e.prototype.close=function(){this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=void 0),this.ws.close()},e.className="WebSocketWorker",e.logCountLimiter=new i.LogCountLimiter(e.className),e.pingPongMessage="~",e}();o.WebSocketWorker=s},{150:150,31:31,76:76}],87:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.SingleItemWorkflow=void 0;var n=e(17),r=e(76),i=function(){function e(e,t){var o,r,i,s,a;this.kind=n.WorkflowKind.SingleItem,this.isStateful=!1,this.id=e,t&&(this.inputTypes=null!==(o=t.inputTypes)&&void 0!==o?o:this.inputTypes,this.outputTypes=null!==(r=t.outputTypes)&&void 0!==r?r:this.outputTypes,this.requestedContextTypesRules=null!==(i=t.requestedContextTypesRules)&&void 0!==i?i:this.requestedContextTypesRules,this.definitionOverrideTargetWorkflows=null!==(s=t.definitionOverrideTargetWorkflows)&&void 0!==s?s:this.definitionOverrideTargetWorkflows,this.correlatedSignals=0!==(null===(a=t.correlatedSignals)||void 0===a?void 0:a.length)?t.correlatedSignals:this.correlatedSignals)}return e.create=function(t){return new e(t)},e.prototype.setInputTypes=function(e){return this.inputTypes=(0,r.buildArrayOfTypes)(e),this},e.prototype.setOutputTypes=function(e){return this.outputTypes=(0,r.buildArrayOfTypes)(e),this},e.prototype.setRequiredContextTypes=function(e){var t;return(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).push({contextTypes:e,cardinality:-3}),this},e.prototype.setOptionalContextTypes=function(e){var t;return(null!==(t=this.requestedContextTypesRules)&&void 0!==t?t:this.requestedContextTypesRules=[]).push({contextTypes:e,cardinality:-1}),this},e.prototype.setLambdaType=function(e){return this.factory=e,this},e.prototype.setDefinitionOverrideTargetWorkflows=function(e){return this.definitionOverrideTargetWorkflows=e,this},e.prototype.setCorrelatedSignals=function(e){return 0!==e.length&&(this.correlatedSignals=e),this},e.prototype.setLambda=function(e,t){return this.factory=function(){return{init:t||function(e){return Promise.resolve()},execute:e,dispose:function(){}}},this},e.prototype.validateOptions=function(){return{isValid:!0}},e}();o.SingleItemWorkflow=i},{17:17,76:76}],88:[function(e,t,o){"use strict";var n=e("spreadArrayHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.WorkflowModel=void 0;var r=e(114),i=function(){function e(e,t){void 0===t&&(t=[]),this.scopeItem=void 0,this.rootItem=void 0,this.normalizeFilter=function(e){if(!e)return function(e){return void 0!==e};if("function"==typeof e)throw new Error("Not implemented yet");if((e.id?1:0)+(e.ids?1:0)+(e.itemType?1:0)+(e.itemTypes?1:0)!=1)throw new Error("Exactly one condition expected on IItemFilter");if(e.itemType)return function(t){return t&&r.SchemaObject.matchesTypesFor(t.body,[e.itemType])};if(e.itemTypes)return function(t){return t&&r.SchemaObject.matchesTypesFor(t.body,e.itemTypes)};throw new Error("Not implemented yet")},this.items=n(n([],t,!0),[e],!1)}return e.prototype.getItem=function(e){throw new Error("Method not implemented.")},e.prototype.getItems=function(e){throw new Error("Method not implemented.")},e.prototype.getItemBody=function(e){return this.getItemBodies(e)[0]},e.prototype.getItemBodies=function(e){var t=this.normalizeFilter(e);return this.items.filter(t).map((function(e){return e.body}))},e.prototype.getItemByReference=function(e){throw new Error("Method not implemented.")},e.prototype.getItemBodyByReference=function(e){throw new Error("Method not implemented.")},e}();o.WorkflowModel=i},{114:114}],89:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.AuthTokenType=o.IdentityProvider=void 0,function(e){e[e.Unknown=0]="Unknown",e[e.LiveId=1]="LiveId",e[e.OrgId=2]="OrgId",e[e.ActiveDirectory=3]="ActiveDirectory",e[e.ADAL=4]="ADAL",e[e.SSPI=5]="SSPI",e[e.OAuth2=6]="OAuth2",e[e.Badger=7]="Badger"}(o.IdentityProvider||(o.IdentityProvider={})),function(e){e[e.Augloop=0]="Augloop",e[e.Substrate=1]="Substrate"}(o.AuthTokenType||(o.AuthTokenType={}))},{}],90:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(89),o),r(e(91),o),r(e(92),o),r(e(93),o),r(e(94),o),r(e(95),o),r(e(96),o)},{89:89,91:91,92:92,93:93,94:94,95:95,96:96}],91:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],92:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ExceptionType=o.MessageType=void 0,function(e){e[e.Input=0]="Input",e[e.Exception=1]="Exception",e[e.WaitOn=2]="WaitOn",e[e.StopAndFilterWorkflow=3]="StopAndFilterWorkflow"}(o.MessageType||(o.MessageType={})),function(e){e[e.Unknown=0]="Unknown",e[e.NoOutput=1]="NoOutput",e[e.Authentication=2]="Authentication",e[e.JoinTimedOut=3]="JoinTimedOut",e[e.LambdaThrow=4]="LambdaThrow",e[e.LambdaErrorCallback=5]="LambdaErrorCallback"}(o.ExceptionType||(o.ExceptionType={}))},{}],93:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Ppt=void 0,function(e){!function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(e.SlideTileEventType||(e.SlideTileEventType={}))}(o.Ppt||(o.Ppt={}))},{}],94:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],95:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Tiling=void 0,function(e){!function(e){e[e.Unknown=0]="Unknown",e[e.Text=1]="Text",e[e.Slide=2]="Slide"}(e.TileType||(e.TileType={})),function(e){e[e.Generic=0]="Generic",e[e.Title=1]="Title",e[e.SmartArt=2]="SmartArt",e[e.TableCell=3]="TableCell",e[e.TextBox=4]="TextBox",e[e.Notes=5]="Notes"}(e.TextTileType||(e.TextTileType={})),function(e){e[e.Undefined=0]="Undefined",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(e.TextTileElementUnit||(e.TextTileElementUnit={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered"}(e.ListType||(e.ListType={})),function(e){e[e.Undefined=0]="Undefined",e[e.AlphaLcParenBoth=1]="AlphaLcParenBoth",e[e.AlphaUcParenBoth=2]="AlphaUcParenBoth",e[e.AlphaLcParenR=3]="AlphaLcParenR",e[e.AlphaUcParenR=4]="AlphaUcParenR",e[e.AlphaLcPeriod=5]="AlphaLcPeriod",e[e.AlphaUcPeriod=6]="AlphaUcPeriod",e[e.ArabicParenBoth=7]="ArabicParenBoth",e[e.ArabicParenR=8]="ArabicParenR",e[e.ArabicPeriod=9]="ArabicPeriod",e[e.ArabicPlain=10]="ArabicPlain",e[e.RomanLcParenBoth=11]="RomanLcParenBoth",e[e.RomanUcParenBoth=12]="RomanUcParenBoth",e[e.RomanLcParenR=13]="RomanLcParenR",e[e.RomanUcParenR=14]="RomanUcParenR",e[e.RomanLcPeriod=15]="RomanLcPeriod",e[e.RomanUcPeriod=16]="RomanUcPeriod",e[e.CircleNumDbPlain=17]="CircleNumDbPlain",e[e.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain",e[e.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain",e[e.ArabicDbPeriod=20]="ArabicDbPeriod",e[e.ArabicDbPlain=21]="ArabicDbPlain",e[e.Ea1ChsPeriod=22]="Ea1ChsPeriod",e[e.Ea1ChsPlain=23]="Ea1ChsPlain",e[e.Ea1ChtPeriod=24]="Ea1ChtPeriod",e[e.Ea1ChtPlain=25]="Ea1ChtPlain",e[e.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod",e[e.Ea1JpnKorPlain=27]="Ea1JpnKorPlain",e[e.Ea1JpnKorPeriod=28]="Ea1JpnKorPeriod",e[e.Arabic1Minus=29]="Arabic1Minus",e[e.Arabic2Minus=30]="Arabic2Minus",e[e.Hebrew2Minus=31]="Hebrew2Minus",e[e.ThaiAlphaPeriod=32]="ThaiAlphaPeriod",e[e.ThaiAlphaParenR=33]="ThaiAlphaParenR",e[e.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth",e[e.ThaiNumPeriod=35]="ThaiNumPeriod",e[e.ThaiNumParenR=36]="ThaiNumParenR",e[e.ThaiNumParenBoth=37]="ThaiNumParenBoth",e[e.HindiAlphaPeriod=38]="HindiAlphaPeriod",e[e.HindiNumPeriod=39]="HindiNumPeriod",e[e.HindiNumParenR=40]="HindiNumParenR",e[e.HindiAlpha1Period=41]="HindiAlpha1Period"}(e.ListNumeration||(e.ListNumeration={})),function(e){e[e.Undefined=0]="Undefined",e[e.Delete=1]="Delete",e[e.Add=2]="Add",e[e.Change=3]="Change",e[e.Refresh=4]="Refresh"}(e.TextTileEventType||(e.TextTileEventType={}))}(o.Tiling||(o.Tiling={}))},{}],96:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.TypeCategory=void 0,function(e){e[e.Undefined=0]="Undefined",e[e.Schema=1]="Schema",e[e.Boolean=2]="Boolean",e[e.Number=3]="Number",e[e.String=4]="String",e[e.Buffer=5]="Buffer",e[e.Function=6]="Function"}(o.TypeCategory||(o.TypeCategory={}))},{}],97:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(98),o)},{98:98}],98:[function(e,t,o){"use strict";var n=e("assignHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.isAncestorOrEqualTo=o.getSafeNumber=o.isValidItemId=o.splitItemPathKey=o.makeItemPathKey=o.shallowCloneItemWithPath=void 0;o.shallowCloneItemWithPath=function(e,t){return n(n({},t),{parentPath:e})};o.makeItemPathKey=function(e){return Array.isArray(e)?5===e.length?"".concat(e[0]).concat("\\").concat(e[1]).concat("\\").concat(e[2]).concat("\\").concat(e[3]).concat("\\").concat(e[4]):4===e.length?"".concat(e[0]).concat("\\").concat(e[1]).concat("\\").concat(e[2]).concat("\\").concat(e[3]):3===e.length?"".concat(e[0]).concat("\\").concat(e[1]).concat("\\").concat(e[2]):2===e.length?"".concat(e[0]).concat("\\").concat(e[1]):1===e.length?e[0]:e.join("\\"):"(malformed path)"};o.splitItemPathKey=function(e){return e.split("\\")};o.isValidItemId=function(e){return e&&e.length>0&&e.length<100&&e.indexOf("\\")<0};o.getSafeNumber=function(e,t){return void 0===t&&(t=0),Number.isFinite(e)?e:t};o.isAncestorOrEqualTo=function(e,t){if(e.length>t.length)return!1;for(var o=0;o<e.length;o++)if(e[o]!==t[o])return!1;return!0}},{}],99:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(100),o),r(e(101),o)},{100:100,101:101}],100:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.WorkflowDefinitionOverrideMessage=o.SessionCloseResponse=o.TelemetryFlushMessage=o.TelemetryMessage=o.DiagnosticTraceMessage=o.RuntimeInitMessage=o.WorkflowExecutionResponse=o.WorkflowExecutionRequest=o.WorkflowRegistrationMessage=void 0;var n=e(114),r=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_WorkflowRegistrationMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.WorkflowRegistrationMessage=r;var i=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_WorkflowExecutionRequest"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.WorkflowExecutionRequest=i;var s=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_WorkflowExecutionResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.WorkflowExecutionResponse=s;var a=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_RuntimeInitMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.RuntimeInitMessage=a;var c=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_DiagnosticTraceMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.DiagnosticTraceMessage=c;var u=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_TelemetryMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.TelemetryMessage=u;var l=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_TelemetryFlushMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.TelemetryFlushMessage=l;var p=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_SessionCloseResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.SessionCloseResponse=p;var f=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_Internal_WorkflowDefinitionOverrideMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.WorkflowDefinitionOverrideMessage=f},{114:114}],101:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],102:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(103),o),r(e(104),o),r(e(105),o)},{103:103,104:104,105:105}],103:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.OAuth2CallbackMessage=o.OAuth2InitResponse=o.OAuth2InitMessage=o.WorkflowGraphInitResponse=o.WorkflowGraphInitMessage=o.KeepAlive=o.TokenProvisionResponse=o.TokenProvisionMessage=o.AnnotationResultsMessage=o.SessionDeleteMessage=o.SyncResponse=o.MicroSyncMessage=o.SyncMessage=o.AnnotationConfigUpdateResponse=o.AnnotationConfigUpdateMessage=o.AnnotationReleaseResponse=o.AnnotationReleaseMessage=o.AnnotationResultStateMessage=o.AnnotationActivationResponse=o.AnnotationActivationMessage=o.CacheDumpRequestResponse=o.CacheDumpRequestMessage=o.SessionCloseMessage=o.SessionInitResponse=o.SessionInitMessage=o.TimeoutErrorResponse=o.ErrorResponse=o.Response=o.Message=void 0;var n=e(114),r=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_Message"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.Message=r;var i=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_Response"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.Response=i;var s=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_ErrorResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ErrorResponse=s;var a=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_TimeoutErrorResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_ErrorResponse","AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.TimeoutErrorResponse=a;var c=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_SessionInitMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.SessionInitMessage=c;var u=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_SessionInitResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.SessionInitResponse=u;var l=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_SessionCloseMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.SessionCloseMessage=l;var p=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_CacheDumpRequestMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.CacheDumpRequestMessage=p;var f=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_CacheDumpRequestResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.CacheDumpRequestResponse=f;var d=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationActivationMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.AnnotationActivationMessage=d;var h=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationActivationResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.AnnotationActivationResponse=h;var g=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationResultStateMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.AnnotationResultStateMessage=g;var y=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationReleaseMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.AnnotationReleaseMessage=y;var m=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationReleaseResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.AnnotationReleaseResponse=m;var v=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.AnnotationConfigUpdateMessage=v;var T=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationConfigUpdateResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.AnnotationConfigUpdateResponse=T;var S=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_SyncMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.SyncMessage=S;var w=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_MicroSyncMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.MicroSyncMessage=w;var b=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_SyncResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.SyncResponse=b;var _=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_SessionDeleteMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.SessionDeleteMessage=_;var C=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_AnnotationResultsMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_SyncMessage","AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.AnnotationResultsMessage=C;var k=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_TokenProvisionMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.TokenProvisionMessage=k;var O=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_TokenProvisionResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.TokenProvisionResponse=O;var x=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_KeepAlive"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.KeepAlive=x;var M=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_WorkflowGraphInitMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.WorkflowGraphInitMessage=M;var I=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_WorkflowGraphInitResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.WorkflowGraphInitResponse=I;var A=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_OAuth2InitMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.OAuth2InitMessage=A;var L=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_OAuth2InitResponse"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Response"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.OAuth2InitResponse=L;var P=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Session_Protocol_OAuth2CallbackMessage"},e.getBaseTypes=function(){return["AugLoop_Session_Protocol_Message"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.OAuth2CallbackMessage=P},{114:114}],104:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.MessageEndpoint=o.extractMessageNameFromTypeName=o.ProcessMessageErrorReason=o.SendMessageErrorReason=void 0;var n,r,i=e(31),s=e(114),a=e(103),c=e(107);function u(e){for(var t,o=0,n=["AugLoop_Excel_Session_Protocol_","AugLoop_Powerpoint_Session_Protocol_","AugLoop_Session_Protocol_"];o<n.length;o++){var r=n[o];if(0===e.indexOf(r)){t=r;break}}if(!t)return"MalformedMessageName";var i=e.indexOf("Message",e.length-"Message".length)===e.length-"Message".length;return e.slice(t.length,i?-"Message".length:void 0)}!function(e){e.ClientDisconnected="Client disconnected.",e.UnsupportedSyncMessage="SyncMessages with seq = -1 are not supported anymore.",e.UnexpectedSeedMessage="Unexpected seed message",e.SyncMessageUnsupportedBatch="SyncMessage with unsupported batching.",e.AnnotationTokenNotFound="Token not found"}(n=o.SendMessageErrorReason||(o.SendMessageErrorReason={})),function(e){e.ProvisionTokenValidationError="Token provision message didn't pass token validation.",e.ProvisionTokenDecryptAndTransformError="Token provision message didn't pass token decrypt and transform."}(r=o.ProcessMessageErrorReason||(o.ProcessMessageErrorReason={})),o.extractMessageNameFromTypeName=u;var l=function(){function e(e){this.nextMessageId=1,this.pendingResponseCallbacks=new c.Cache({sweepInterval:5e3}),this.pendingMessageCallbacks=new c.Cache({sweepInterval:5e3}),this.messageCallbacks=new Map,this.messageIdPrefix=e,this.source="c"===e?i.SessionHealthSource.ClientRuntime:i.SessionHealthSource.Core,this.stats={sendMessageCount:0,sendMessageClientDisconnectedErrors:0,sendMessageErrors:0,sendMessageDurationMsMax:0,processMessageCount:0,processMessageProvisionTokenErrors:0,processMessageErrors:0,processMessageDurationMsMax:0}}return e.prototype.setClientMetadata=function(e){this.clientMetadata=e},e.prototype.setEgress=function(e){this.egress=e},e.prototype.ingress=function(e,t){var o=s.SchemaObject.getBaseTypesFor(e),n=s.SchemaObject.getTypeNameFor(e);n===a.Response.getTypeName()||o&&o.indexOf(a.Response.getTypeName())>=0?(this.processResponse(e),t()):this.processMessage(e,t),n!==a.SessionCloseMessage.getTypeName()||e.reconnectAllowed||this.clearAllPendingResponses()},e.prototype.sendMessage=function(e,t,o,n){var r=this;void 0===n&&(n=0);var c=new i.SessionHealthEvent({sessionHealthEventName:"SendMessage",source:this.source,reason:i.SessionHealthReason.Client,impact:this.source===i.SessionHealthSource.ClientRuntime?i.SessionHealthImpact.MissingInput:i.SessionHealthImpact.MissingOutput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv,resourceId:u(s.SchemaObject.getTypeNameFor(e)),dimension0:n.toString()}).start(),l=function(){if(c.setClientMetadata(r.clientMetadata),c.success)i.Log.info(572836e3,i.LogCategory.CoreDefault,c.stop());else{var e="ErrorWithoutPendingResponse"===c.resultSignature||"ResponseCallbackException"===c.resultSignature||"We called into done callback"!==c.message;c.message=JSON.stringify({errorNotPropagatedToDoneCallback:e}),i.Log.error(572836001,i.LogCategory.CoreDefault,c.stop())}};e.messageId="".concat(this.messageIdPrefix).concat(this.nextMessageId++);var p=s.SchemaObject.getTypeNameFor(e)===a.SessionCloseMessage.getTypeName();if(!o&&!p){var f=function(o,n){var i;if(o?(c.success=!1,c.resultSignature=o.error,c.resultDescription="Error for ".concat(s.SchemaObject.getTypeNameFor(e)," message ").concat(e.messageId,": ").concat(o.error)):c.resultSignature="Success",t)try{c.message="We called into done callback",t(o,n)}catch(e){c.success=!1,c.resultSignature="ResponseCallbackException",c.resultDescription="Web"===(null===(i=r.clientMetadata)||void 0===i?void 0:i.appPlatform)?JSON.stringify({message:e.message,stack:e.stack}):JSON.stringify({message:e.message})}r.pendingMessageCallbacks.del(e.messageId),l(),r.updateSendMessageStats(c.success,c.durationMs,o?new Error(o.error):void 0)};this.pendingResponseCallbacks.put(e.messageId,f,1e4,(function(){f(new a.TimeoutErrorResponse({error:"Timeout waiting for response"}),void 0)}))}this.egress(e,(function(t){var o,n;if(t){var i=r.pendingResponseCallbacks.get(e.messageId);i?(r.pendingResponseCallbacks.del(e.messageId),i(new a.ErrorResponse({error:t.message}))):p?(c.success=null!==(n=null===(o=t.message)||void 0===o?void 0:o.endsWith("Client disconnected."))&&void 0!==n&&n,c.resultSignature="ErrorSendingSessionCloseMessage",c.resultDescription="Error for ".concat(s.SchemaObject.getTypeNameFor(e)," message ").concat(e.messageId,": ").concat(t.message),l()):(c.success=!1,c.resultSignature="ErrorWithoutPendingResponse",c.resultDescription="Error for ".concat(s.SchemaObject.getTypeNameFor(e)," message ").concat(e.messageId,": ").concat(t.message),l())}}))},e.prototype.onMessage=function(e,t){this.messageCallbacks.set(e,t)},e.prototype.getStats=function(){return this.stats},e.prototype.hasMessageCallback=function(e){return this.messageCallbacks.has(e)},e.prototype.cancelPendingResponseCallbacks=function(){var e=this;this.pendingResponseCallbacks.forEach((function(t,o){t&&(e.pendingResponseCallbacks.del(o),t(new a.ErrorResponse({error:"Cancelled"})))}))},e.prototype.clearAllPendingResponses=function(){if(0!=this.pendingResponseCallbacks.size()){var e=new i.Operation({operationName:"PurgePendingResponses",resultDescription:this.pendingResponseCallbacks.size().toString(),success:!0});i.Log.info(572836002,i.LogCategory.CoreDefault,e),this.pendingResponseCallbacks.clear()}},e.prototype.processMessage=function(e,t){var o,n=this,r=new i.SessionHealthEvent({sessionHealthEventName:"ProcessMessage",source:this.source,reason:i.SessionHealthReason.Client,impact:this.source===i.SessionHealthSource.ClientRuntime?i.SessionHealthImpact.MissingOutput:i.SessionHealthImpact.MissingInput,success:!0,message:"",affectedWorkflows:["All"],cv:e.cv}).start(),c=function(){if(r.setClientMetadata(n.clientMetadata),r.success)i.Log.info(572836003,i.LogCategory.CoreDefault,r.stop());else{var e="UnsupportedMessage"===r.resourceId||"Timeout"===r.resultSignature||"OnResponseInvokedMoreThanOnce"===r.resultSignature||"MessageCallbackException"===r.resultSignature||"We called into messageCallback"!==r.message;r.message=JSON.stringify({errorHappenedOutsideRegisteredMessageCallback:e}),i.Log.error(572836032,i.LogCategory.CoreDefault,r.stop())}},l=this.messageCallbacks.get(s.SchemaObject.getTypeNameFor(e));l?r.resourceId=u(s.SchemaObject.getTypeNameFor(e)):l=function(t,o){r.resourceId=u(s.SchemaObject.getTypeNameFor(e)),"MalformedMessageName"!==r.resourceId&&(r.resourceId="UnsupportedMessage"),o(new a.ErrorResponse({error:"Message type ".concat(s.SchemaObject.getTypeNameFor(e)," is not supported")}))};this.pendingMessageCallbacks.put(e.messageId,void 0,1e4,(function(){r.success=!1,r.resultSignature="Timeout",r.resultDescription="Timeout processing message callback",c(),i.Log.error(572836033,i.LogCategory.CoreDefault,"Timeout processing ".concat(r.resourceId)),n.updateProcessMessageStats(!1,r.durationMs,new Error("timeout"))}));var p=!1;try{r.message="We called into messageCallback",l(e,(function(o,i){n.pendingMessageCallbacks.del(e.messageId),p?(r.success=!1,r.resultSignature="OnResponseInvokedMoreThanOnce",r.resultDescription="Invoked onResponse for ".concat(s.SchemaObject.getTypeNameFor(e)," message ").concat(e.messageId," more than once")):o?(r.success=!1,r.resultSignature=o.error,r.resultDescription="Error for ".concat(s.SchemaObject.getTypeNameFor(e)," message ").concat(e.messageId,": ").concat(o.error)):r.resultSignature="Success",p=!0,c(),o&&!s.SchemaObject.matchesTypesFor(o,[a.ErrorResponse.getTypeName()])&&(o=new a.ErrorResponse({error:"Internal Server Error"})),n.updateProcessMessageStats(r.success,r.durationMs,o?new Error(o.error):void 0),o?(o.messageId=e.messageId,t(o)):i?(i.messageId=e.messageId,t(void 0,i)):t()}))}catch(n){this.pendingMessageCallbacks.del(e.messageId),r.success=!1,r.resultSignature="MessageCallbackException",r.resultDescription="Web"===(null===(o=this.clientMetadata)||void 0===o?void 0:o.appPlatform)?JSON.stringify({message:n.message,stack:n.stack}):JSON.stringify({message:n.message}),c(),this.updateProcessMessageStats(!1,r.durationMs,n),t()}},e.prototype.processResponse=function(e){var t,o=new i.Operation({operationName:"ProcessResponse"});o.success=!0,o.setClientMetadata(this.clientMetadata),o.start();var n=this.pendingResponseCallbacks.get(e.messageId);n?(this.pendingResponseCallbacks.del(e.messageId),s.SchemaObject.matchesTypesFor(e,[a.ErrorResponse.getTypeName()])?n(e):n(void 0,e)):(o.resultSignature="NoPendingMessage",o.resultDescription="".concat(e.messageId),o.success=!1),"Production"!==(null===(t=this.clientMetadata)||void 0===t?void 0:t.releaseAudienceGroup)&&(o.resourceId=u(s.SchemaObject.getTypeNameFor(e)),i.Log.info(572836034,i.LogCategory.CoreDefault,o.stop()))},e.prototype.updateSendMessageStats=function(e,t,o){this.stats.sendMessageCount++,this.stats.sendMessageDurationMsMax=Math.max(t,this.stats.sendMessageDurationMsMax),e||o?e&&o&&i.Log.warn(572836036,i.LogCategory.CoreDefault,"Succeeded send message provided error object."):i.Log.warn(572836035,i.LogCategory.CoreDefault,"Failed send message did not provide error object."),e||(o&&o.message===n.ClientDisconnected?this.stats.sendMessageClientDisconnectedErrors++:this.stats.sendMessageErrors++)},e.prototype.updateProcessMessageStats=function(e,t,o){this.stats.processMessageCount++,this.stats.processMessageDurationMsMax=Math.max(t,this.stats.processMessageDurationMsMax),e||o?e&&o&&i.Log.warn(572836038,i.LogCategory.CoreDefault,"Succeeded process message provided error object."):i.Log.warn(572836037,i.LogCategory.CoreDefault,"Failed process message did not provide error object."),e||(o&&o.message===r.ProvisionTokenValidationError?this.stats.processMessageProvisionTokenErrors++:this.stats.processMessageErrors++)},e}();o.MessageEndpoint=l},{103:103,107:107,114:114,31:31}],105:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.currentProtocolVersion=void 0,o.currentProtocolVersion=2},{}],106:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Cache=void 0;var n=function(){function e(e){if(this.cache=new Map,this.options=e||{sweepInterval:100},null!=this.options.idleDurationMs&&this.options.idleDurationMs<=0)throw new Error("Idle duration must be positive");if(this.interval=this.options.sweepInterval||100,this.interval<=0)throw new Error("Sweep interval must be a positive number")}return e.prototype.put=function(e,t,o,n,r,i,s){if(null==o||o<=0)throw new Error("Cache timeout must be a positive number");(null==r||r<=0)&&(r=this.options.idleDurationMs);var a={value:t,lastUsed:r?Date.now():void 0,expire:o+Date.now(),idleDurationMs:r,expireCallback:n,expiringTriggerTime:i+Date.now(),expiringCallback:s};return this.cache.set(e,a),this.timeout||(this.timeout=setInterval(this.onInterval.bind(this),this.interval),this.timeout.unref&&this.timeout.unref()),t},e.prototype.del=function(e){if(this.options.delCallback){var t=this.cache.get(e);t&&this.options.delCallback(e,t.value)}var o=this.cache.delete(e);return 0===this.size()&&this.clear(),o},e.prototype.clear=function(){this.timeout&&(clearInterval(this.timeout),this.timeout=void 0),this.cache.clear()},e.prototype.get=function(e){var t=this.cache.get(e);if(t)return this.options.idleDurationMs&&(t.lastUsed=Date.now()),t.value},e.prototype.keys=function(){return this.cache.keys()},e.prototype.forEach=function(e){this.cache.forEach((function(t,o){e(t.value,o)}))},e.prototype.size=function(){return this.cache.size},e.prototype.updateExpireTime=function(e,t){return!!(this.cache.has(e)&&t>=0)&&(this.cache.get(e).expire=t+Date.now(),!0)},e.prototype.onInterval=function(){var e=this,t=Date.now();this.cache.forEach((function(o,n){if(o.idleDurationMs&&o.lastUsed<t-o.idleDurationMs)return e.del(n),void(e.options.idleCallback&&e.options.idleCallback(n,o.value));o.expire<t&&(e.del(n),o.expireCallback&&o.expireCallback(n,o.value)),o.expiringTriggerTime<t&&o.expiringCallback&&(o.expiringCallback(n,o.value),o.expiringCallback=void 0)}))},e}();o.Cache=n},{}],107:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(106),o)},{106:106}],108:[function(e,t,o){var n={util:{},roots:{default:{}}},r=(n.util,n.roots.default||(n.roots.default={}));r.AnnotationMetaDataChangeEvent=function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.sessionKey="",e.prototype.annotationType="",e.prototype.annotationState=0,e.prototype.workflowId="",e}(),t.exports=r},{}],109:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(108),o),r(e(110),o),r(e(111),o),r(e(112),o)},{108:108,110:110,111:111,112:112}],110:[function(e,t,o){var n={util:{},roots:{default:{}}},r=(n.util,n.roots.default||(n.roots.default={}));r.OperationEvent=function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e}(),t.exports=r},{}],111:[function(e,t,o){var n={util:{},roots:{default:{}}},r=(n.util,n.roots.default||(n.roots.default={}));r.SessionHealthEvent=function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.sessionHealthEventName="",e.prototype.source="",e.prototype.reason="",e.prototype.reasonDependency="",e.prototype.subReason="",e.prototype.impact="",e.prototype.success=!1,e.prototype.durationMs=0,e.prototype.count=0,e.prototype.message="",e.prototype.affectedWorkflows="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.resultDescription="",e.prototype.resultSignature="",e}(),t.exports=r},{}],112:[function(e,t,o){var n={util:{},roots:{default:{}}},r=(n.util,n.roots.default||(n.roots.default={}));r.WorkflowOperationEvent=function(){function e(e){if(e)for(var t in e)null!=e[t]&&(this[t]=e[t])}return e.prototype.count=0,e.prototype.cv="",e.prototype.serviceName="",e.prototype.sessionKey="",e.prototype.durationMs=0,e.prototype.success=!1,e.prototype.resultDescription="",e.prototype.resultSignature="",e.prototype.operationName="",e.prototype.resourceId="",e.prototype.dimension0="",e.prototype.dimension1="",e.prototype.dimension2="",e.prototype.dimension3="",e.prototype.clientAppName="",e.prototype.clientAppPlatform="",e.prototype.clientRuntimeVersion="",e.prototype.clientAppVersion="",e.prototype.clientReleaseAudienceGroup="",e.prototype.clientReleaseChannel="",e.prototype.clientReleaseFork="",e.prototype.clientSessionId="",e.prototype.clientFlights="",e.prototype.clientIPRange="",e.prototype.clientDocSessionId="",e.prototype.clientDeviceId="",e.prototype.clientUserAgent="",e.prototype.userType="",e.prototype.userId="",e.prototype.joinContextId="",e.prototype.ariaTenant="",e.prototype.ariaNamespace="",e.prototype.dataFields="",e}(),t.exports=r},{}],113:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.AnnotationState=void 0,function(e){e[e.Undefined=0]="Undefined",e[e.Created=10]="Created",e[e.Sent=20]="Sent",e[e.Duplicated=30]="Duplicated",e[e.Seen=40]="Seen",e[e.Tried=50]="Tried",e[e.Kept=60]="Kept",e[e.Rejected=70]="Rejected"}(o.AnnotationState||(o.AnnotationState={}))},{}],114:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(113),o),r(e(115),o),r(e(116),o),r(e(117),o),r(e(118),o),r(e(119),o),r(e(120),o),r(e(122),o),r(e(121),o),r(e(123),o),r(e(124),o)},{113:113,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124}],115:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.BinaryClassificationAnnotation=o.Annotation=void 0;var n=e(117),r=function(){function e(t){n.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Core_Annotation"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.Annotation=r;var i=function(){function e(t){n.SchemaObject.assign(e,this,t)}return Object.defineProperty(e.prototype,"metadata",{get:function(){return this.M_},set:function(e){this.M_=e},enumerable:!1,configurable:!0}),e.getTypeName=function(){return"AugLoop_Core_BinaryClassificationAnnotation"},e.getBaseTypes=function(){return["AugLoop_Core_Annotation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.BinaryClassificationAnnotation=i},{117:117}],116:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.SignalOperation=o.MicroSyncOperation=o.DeltaUpdateOperation=o.VisibilityOperation=o.FocusOperation=o.PurgeOperation=o.DeleteOperation=o.UpdateOperation=o.UpdateAnnotationMetaDataOperation=o.MoveOperation=o.AddOperation=o.OperationWithSiblingContext=o.Operation=o.ItemChangesDelta=o.ItemDelta=void 0;var n=e(117),r=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_ItemDelta"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ItemDelta=r;var i=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_ItemChangesDelta"},e.getBaseTypes=function(){return["AugLoop_Core_ItemDelta"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ItemChangesDelta=i;var s=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Operation"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.Operation=s;var a=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_OperationWithSiblingContext"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.OperationWithSiblingContext=a;var c=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_AddOperation"},e.getBaseTypes=function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.AddOperation=c;var u=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_MoveOperation"},e.getBaseTypes=function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.MoveOperation=u;var l=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.UpdateAnnotationMetaDataOperation=l;var p=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_UpdateOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.UpdateOperation=p;var f=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_DeleteOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.DeleteOperation=f;var d=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_PurgeOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.PurgeOperation=d;var h=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_FocusOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.FocusOperation=h;var g=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_VisibilityOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.VisibilityOperation=g;var y=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_DeltaUpdateOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.DeltaUpdateOperation=y;var m=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_MicroSyncOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.MicroSyncOperation=m;var v=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Signals_SignalOperation"},e.getBaseTypes=function(){return["AugLoop_Core_Operation"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.SignalOperation=v},{117:117}],117:[function(e,t,o){"use strict";var n=e("spreadArrayHelper");Object.defineProperty(o,"__esModule",{value:!0}),o.SchemaObject=void 0;var r=function(){function e(t){e.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_SchemaObject"},e.getBaseTypes=function(){return[]},e.getTypeNameFor=function(e){return e&&e.H_?e.H_.T_:void 0},e.getBaseTypesFor=function(e){return e&&e.H_&&e.H_.B_?e.H_.B_:[]},e.getAllTypesFor=function(t){var o=e.getTypeNameFor(t);return o?n([o],e.getBaseTypesFor(t),!0):[]},e.matchesTypesFor=function(t,o){if(!Array.isArray(o)||0===o.length)return!0;for(var n=e.getTypeNameFor(t),r=e.getBaseTypesFor(t),i=0,s=o;i<s.length;i++){var a=s[i];if(a===n)return!0;if(r.indexOf(a)>=0)return!0}return!1},e.assign=function(e,t,o){if(o)for(var n=0,r=Object.keys(o);n<r.length;n++){var i=r[n];t[i]=o[i]}return t.H_=e.H_,t},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.SchemaObject=r},{}],118:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Signal=void 0;var n=e(117),r=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Signals_Signal"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.Signal=r},{117:117}],119:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.UserCommandsHolder=o.EventsHolder=o.TenantContextHolder=o.UserContextHolder=o.ContextHolder=o.DynamicContext=o.GridNeighborhoodContext=o.GridCell=o.SubDocument=o.Document=o.Session=o.TileGroup=o.Binary=o.Blob=void 0;var n=e(117),r=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Blob"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.Blob=r;var i=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Binary"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.Binary=i;var s=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_TileGroup"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.TileGroup=s;var a=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Session"},e.getBaseTypes=function(){return["AugLoop_Core_TileGroup"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.Session=a;var c=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_Document"},e.getBaseTypes=function(){return["AugLoop_Core_TileGroup"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.Document=c;var u=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_SubDocument"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.SubDocument=u;var l=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_GridCell"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.GridCell=l;var p=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_GridNeighborhoodContext"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.GridNeighborhoodContext=p;var f=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_DynamicContext"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.DynamicContext=f;var d=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_ContextHolder"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.ContextHolder=d;var h=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_UserContextHolder"},e.getBaseTypes=function(){return["AugLoop_Core_ContextHolder"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.UserContextHolder=h;var g=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_TenantContextHolder"},e.getBaseTypes=function(){return["AugLoop_Core_ContextHolder"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.TenantContextHolder=g;var y=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_EventsHolder"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.EventsHolder=y;var m=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Core_UserCommandsHolder"},e.getBaseTypes=function(){return["AugLoop_Core_EventsHolder"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.UserCommandsHolder=m},{117:117}],120:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],121:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],122:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],123:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0})},{}],124:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.GridConstants=void 0;var n=function(){function e(){}return e.lowerIndexBound=1,e.maxNumberOfRows=1048576,e.maxNumberOfColumns=16384,e.firstColumnName="A",e.lastColumnName="XFD",e}();o.GridConstants=n},{}],125:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(126),o),r(e(127),o),r(e(128),o),r(e(129),o)},{126:126,127:127,128:128,129:129}],126:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.TextTileDeltaUnit=o.TextTileDeltaType=void 0,function(e){e[e.Add=0]="Add",e[e.Delete=1]="Delete",e[e.Update=2]="Update",e[e.CursorUpdate=3]="CursorUpdate",e[e.FormattingUpdate=4]="FormattingUpdate",e[e.OtherNonContentUpdate=5]="OtherNonContentUpdate"}(o.TextTileDeltaType||(o.TextTileDeltaType={})),function(e){e[e.Chars=0]="Chars",e[e.Word=1]="Word",e[e.PartialSentence=2]="PartialSentence",e[e.Sentence=3]="Sentence",e[e.Paragraph=4]="Paragraph"}(o.TextTileDeltaUnit||(o.TextTileDeltaUnit={}))},{}],127:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.FormattedTextTileDelta=o.TextTileDelta=void 0;var n=e(114),r=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Text_TextTileDelta"},e.getBaseTypes=function(){return["AugLoop_Core_ItemDelta"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.TextTileDelta=r;var i=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Text_FormattedTextTileDelta"},e.getBaseTypes=function(){return["AugLoop_Text_TextTileDelta","AugLoop_Core_ItemDelta"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.FormattedTextTileDelta=i},{114:114}],128:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.DateTile=o.PersonTile=o.TaskTile=o.DynamicTextContext=o.FormattedTextTile=o.TextTile=void 0;var n=e(114),r=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Text_TextTile"},e.getBaseTypes=function(){return[]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.TextTile=r;var i=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Text_FormattedTextTile"},e.getBaseTypes=function(){return["AugLoop_Text_TextTile"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.FormattedTextTile=i;var s=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Text_DynamicTextContext"},e.getBaseTypes=function(){return["AugLoop_Core_DynamicContext"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.DynamicTextContext=s;var a=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Text_TaskTile"},e.getBaseTypes=function(){return["AugLoop_Text_FormattedTextTile","AugLoop_Text_TextTile"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.TaskTile=a;var c=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Text_PersonTile"},e.getBaseTypes=function(){return["AugLoop_Text_TextTile"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.PersonTile=c;var u=function(){function e(t){n.SchemaObject.assign(e,this,t)}return e.getTypeName=function(){return"AugLoop_Text_DateTile"},e.getBaseTypes=function(){return["AugLoop_Text_TextTile"]},e.typeGuard=function(t){return n.SchemaObject.matchesTypesFor(t,[e.getTypeName()])},e.H_={T_:e.getTypeName(),B_:e.getBaseTypes()},e}();o.DateTile=u},{114:114}],129:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.SpecialIndentType=o.ObjectType=o.Alignment=o.UnderlineType=o.CapsType=o.FontWeight=o.ListType=o.AnchorMode=void 0,function(e){e[e.Unspecified=0]="Unspecified",e[e.Inline=1]="Inline",e[e.Floating=2]="Floating"}(o.AnchorMode||(o.AnchorMode={})),function(e){e[e.Undefined=0]="Undefined",e[e.Bullet=1]="Bullet",e[e.Numbered=2]="Numbered",e[e.Lim=3]="Lim",e[e.Nil=4]="Nil",e[e.Any=5]="Any",e[e.NoList=6]="NoList",e[e.Invalid=7]="Invalid"}(o.ListType||(o.ListType={})),function(e){e[e.DontCare=1]="DontCare",e[e.Thin=2]="Thin",e[e.ExtraLight=3]="ExtraLight",e[e.Light=4]="Light",e[e.Normal=5]="Normal",e[e.Medium=6]="Medium",e[e.SemiBold=7]="SemiBold",e[e.Bold=8]="Bold",e[e.ExtraBold=9]="ExtraBold",e[e.Heavy=10]="Heavy"}(o.FontWeight||(o.FontWeight={})),function(e){e[e.NoCaps=0]="NoCaps",e[e.SmallCaps=1]="SmallCaps",e[e.AllCaps=2]="AllCaps",e[e.AllPetiteCaps=3]="AllPetiteCaps",e[e.PetiteCaps=4]="PetiteCaps",e[e.Unicase=5]="Unicase",e[e.Titling=6]="Titling",e[e.Other=7]="Other"}(o.CapsType||(o.CapsType={})),function(e){e[e.None=0]="None",e[e.Words=1]="Words",e[e.SingleLine=2]="SingleLine",e[e.DoubleLine=3]="DoubleLine",e[e.HeavyLine=4]="HeavyLine",e[e.DottedLine=5]="DottedLine",e[e.DottedHeavyLine=6]="DottedHeavyLine",e[e.DashLine=7]="DashLine",e[e.DashHeavyLine=8]="DashHeavyLine",e[e.DashLongLine=9]="DashLongLine",e[e.DashLongHeavyLine=10]="DashLongHeavyLine",e[e.DotDashLine=11]="DotDashLine",e[e.DotDashHeavyLine=12]="DotDashHeavyLine",e[e.DotDotDashLine=13]="DotDotDashLine",e[e.DotDotDashHeavyLine=14]="DotDotDashHeavyLine",e[e.WavyLine=15]="WavyLine",e[e.WavyHeavyLine=16]="WavyHeavyLine",e[e.WavyDoubleLine=17]="WavyDoubleLine"}(o.UnderlineType||(o.UnderlineType={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justified=3]="Justified",e[e.Other=4]="Other",e[e.None=5]="None",e[e.JustifyLow=6]="JustifyLow",e[e.Distributed=7]="Distributed",e[e.ThaiDistributed=8]="ThaiDistributed"}(o.Alignment||(o.Alignment={})),function(e){e[e.Image=0]="Image",e[e.TextBox=1]="TextBox",e[e.Chart=2]="Chart",e[e.SmartArt=3]="SmartArt",e[e.Drawing=4]="Drawing",e[e.EquationObject=5]="EquationObject",e[e.Ink=6]="Ink",e[e.InkSpace=7]="InkSpace",e[e.InkEndOfLine=8]="InkEndOfLine",e[e.LineBreak=9]="LineBreak",e[e.PageBreak=10]="PageBreak",e[e.PageNumbers=11]="PageNumbers",e[e.FootnoteEndnote=12]="FootnoteEndnote",e[e.FootnoteEndnoteReferenceMark=13]="FootnoteEndnoteReferenceMark",e[e.Tab=14]="Tab",e[e.UnsupportedObject=15]="UnsupportedObject",e[e.Other=16]="Other"}(o.ObjectType||(o.ObjectType={})),function(e){e[e.Initial=0]="Initial",e[e.FirstLine=1]="FirstLine",e[e.Hanging=2]="Hanging"}(o.SpecialIndentType||(o.SpecialIndentType={}))},{}],130:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(131),o)},{131:131}],131:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.WorkflowFlights=o.parseFlights=void 0;o.parseFlights=function(e){if(!e)return new n([],new Set,new Map);for(var t=e.split(";"),o=new Set,r=new Map,i=0,s=t;i<s.length;i++){var a=s[i].trim();if(""!==a){o.add(n.normalizeName(a));var c=a.split(":"),u=c[0],l=c[1],p=n.normalizeName(u);p&&r.set(p,l)}}return new n(t,o,r)};var n=function(){function e(e,t,o){this.originalFlights=e,this.normalizedFlights=t,this.keyValueFlightsMap=o}return e.normalizeName=function(e){return null==e?void 0:e.toLowerCase()},e.prototype.hasFlight=function(t){var o=e.normalizeName(t),n=this.normalizedFlights.has(o),r=this.keyValueFlightsMap.has(o);return n||r},e.prototype.getBooleanValue=function(e,t){var o;switch(null===(o=this.getStringValue(e))||void 0===o?void 0:o.toLowerCase()){case"true":return!0;case"false":return!1;default:return t}},e.prototype.getIntValue=function(e,t){var o=this.getStringValue(e),n=Number.parseInt(o,10);return Number.isNaN(n)?t:n},e.prototype.getStringValue=function(t,o){var n;return null!==(n=this.keyValueFlightsMap.get(e.normalizeName(t)))&&void 0!==n?n:o},e.prototype.getAll=function(){return this.originalFlights},e}();o.WorkflowFlights=n},{}],132:[function(e,t,o){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o);var r=Object.getOwnPropertyDescriptor(t,o);r&&!("get"in r?!t.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return t[o]}}),Object.defineProperty(e,n,r)}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(o,"__esModule",{value:!0}),r(e(133),o)},{133:133}],133:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.getContextTypes=void 0;o.getContextTypes=function(e,t){for(var o=[],n=0,r=null!=e?e:[];n<r.length;n++){var i=r[n];if(void 0===t||t===i.cardinality)for(var s=0,a=i.contextTypes;s<a.length;s++){var c=a[s];o.push([c,i.cardinality])}}return o}},{}],134:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ConsoleLogger=void 0;var n=e(137),r=e(136),i=function(){function e(){}return e.tagIntToString=function(t){return t<=e.maxNumericTag?t.toString():t>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t):e.map.charAt(t>>24&63)+e.map.charAt(t>>18&63)+e.map.charAt(t>>12&63)+e.map.charAt(t>>6&63)+e.map.charAt(63&t)},e.getLogMessage=function(t,o,n){return"tag_"+e.tagIntToString(t)+" ["+r.LogCategory[o]+"] "+n},e.prototype.sendTraceTag=function(t,o,r,i){var s=this.logMessage;switch(r){case n.TraceLevel.Error:s=this.logError;break;case n.TraceLevel.Warning:s=this.logWarning;break;case n.TraceLevel.Info:s=this.logInfo;break;case n.TraceLevel.Verbose:s=this.logVerbose;break;case n.TraceLevel.Spam:default:s=this.logMessage}try{s(e.getLogMessage(t,o,i))}catch(e){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw e}},e.prototype.shipAssertTag=function(t,o,n,r){console.assert(n,e.getLogMessage(t,o,r))},e.prototype.debugAssertTag=function(e,t,o,n){this.shipAssertTag(e,t,o,n)},e.prototype.logMessage=function(e){"log"in console&&console.log(e)},e.prototype.logError=function(e){"error"in console&&console.error(e)},e.prototype.logWarning=function(e){"warn"in console&&console.warn(e)},e.prototype.logInfo=function(e){"info"in console&&console.info(e)},e.prototype.logVerbose=function(e){"debug"in console&&console.debug(e)},e.maxNumericTag=65535,e.minOldSchemeHighByteValue=36,e.map="abcdefghijklmnopqrstuvwxyz0123456789",e}();o.ConsoleLogger=i},{136:136,137:137}],135:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.NoopLogger=void 0;var n=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}();o.NoopLogger=n},{}],136:[function(e,t,o){"use strict";var n;Object.defineProperty(o,"__esModule",{value:!0}),o.LogCategory=void 0,o.LogCategory=n,function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools"}(n||(o.LogCategory=n={}))},{}],137:[function(e,t,o){"use strict";var n;Object.defineProperty(o,"__esModule",{value:!0}),o.TraceLevel=void 0,o.TraceLevel=n,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(n||(o.TraceLevel=n={}))},{}],138:[function(e,t,o){(function(t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.initializeLogger=function(e){if(!e)throw new Error("The 'logger' argument is missing");s.setLogger(e)},o.ULS=o.UlsLoggerWrapper=void 0;var n=e(135),r=e(134),i=function(){function e(){this.externalLogger="production"!==t.env.NODE_ENV?new r.ConsoleLogger:new n.NoopLogger}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,o,n){this.externalLogger.sendTraceTag(e,t,o,n)},e.prototype.debugAssertTag=function(e,t,o,n){this.externalLogger.debugAssertTag(e,t,o,n)},e.prototype.shipAssertTag=function(e,t,o,n){this.externalLogger.shipAssertTag(e,t,o,n)},e}();o.UlsLoggerWrapper=i;var s=new i;o.ULS=s}).call(this,{env:{NODE_ENV:"production"}})},{134:134,135:135}],139:[function(e,t,o){function n(e,t,o,n,r,i,s){try{var a=e[i](s),c=a.value}catch(e){return void o(e)}a.done?t(c):Promise.resolve(c).then(n,r)}t.exports=function(e){return function(){var t=this,o=arguments;return new Promise((function(r,i){var s=e.apply(t,o);function a(e){n(s,r,i,a,c,"next",e)}function c(e){n(s,r,i,a,c,"throw",e)}a(void 0)}))}}},{}],140:[function(e,t,o){t.exports=function(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}},{}],141:[function(e,t,o){t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],142:[function(e,t,o){var n=e(140);t.exports=function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},r=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(o).filter((function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable})))),r.forEach((function(t){n(e,t,o[t])}))}return e}},{140:140}],143:[function(e,t,o){t.exports=e(151)},{151:151}],144:[function(e,t,o){var n="undefined"!=typeof self?self:this,r=function(){function e(){this.fetch=!1,this.DOMException=n.DOMException}return e.prototype=n,new e}();!function(e){!function(t){var o="URLSearchParams"in e,n="Symbol"in e&&"iterator"in Symbol,r="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),i="FormData"in e,s="ArrayBuffer"in e;if(s)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function u(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!=typeof e&&(e=String(e)),e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function d(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise((function(t,o){e.onload=function(){t(e.result)},e.onerror=function(){o(e.error)}}))}function g(e){var t=new FileReader,o=h(t);return t.readAsArrayBuffer(e),o}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:r&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:i&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:o&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&r&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e,t,o,n=d(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,o=h(t),t.readAsText(e),o;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),o=new Array(t.length),n=0;n<t.length;n++)o[n]=String.fromCharCode(t[n]);return o.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},i&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=u(e),t=l(t);var o=this.map[e];this.map[e]=o?o+", "+t:t},f.prototype.delete=function(e){delete this.map[u(e)]},f.prototype.get=function(e){return e=u(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(u(e))},f.prototype.set=function(e,t){this.map[u(e)]=l(t)},f.prototype.forEach=function(e,t){for(var o in this.map)this.map.hasOwnProperty(o)&&e.call(t,this.map[o],o,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,o){e.push(o)})),p(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,o){e.push([o,t])})),p(e)},n&&(f.prototype[Symbol.iterator]=f.prototype.entries);var v=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function T(e,t){var o,n,r=(t=t||{}).body;if(e instanceof T){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(o=t.method||this.method||"GET",n=o.toUpperCase(),v.indexOf(n)>-1?n:o),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function S(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var o=e.split("="),n=o.shift().replace(/\+/g," "),r=o.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(r))}})),t}function w(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}T.prototype.clone=function(){return new T(this,{body:this._bodyInit})},m.call(T.prototype),m.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var b=[301,302,303,307,308];w.redirect=function(e,t){if(-1===b.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(e){t.DOMException=function(e,t){this.message=e,this.name=t;var o=Error(e);this.stack=o.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function _(e,o){return new Promise((function(n,i){var s=new T(e,o);if(s.signal&&s.signal.aborted)return i(new t.DOMException("Aborted","AbortError"));var a=new XMLHttpRequest;function c(){a.abort()}a.onload=function(){var e,t,o={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new f,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var o=e.split(":"),n=o.shift().trim();if(n){var r=o.join(":").trim();t.append(n,r)}})),t)};o.url="responseURL"in a?a.responseURL:o.headers.get("X-Request-URL");var r="response"in a?a.response:a.responseText;n(new w(r,o))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new t.DOMException("Aborted","AbortError"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&r&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),s.signal&&(s.signal.addEventListener("abort",c),a.onreadystatechange=function(){4===a.readyState&&s.signal.removeEventListener("abort",c)}),a.send(void 0===s._bodyInit?null:s._bodyInit)}))}_.polyfill=!0,e.fetch||(e.fetch=_,e.Headers=f,e.Request=T,e.Response=w),t.Headers=f,t.Request=T,t.Response=w,t.fetch=_,Object.defineProperty(t,"__esModule",{value:!0})}({})}(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;(o=i.fetch).default=i.fetch,o.fetch=i.fetch,o.Headers=i.Headers,o.Request=i.Request,o.Response=i.Response,t.exports=o},{}],145:[function(e,t,o){"use strict";function n(e){if(this._capacity=i(e),this._length=0,this._front=0,r(e)){for(var t=e.length,o=0;o<t;++o)this[o]=e[o];this._length=t}}n.prototype.toArray=function(){for(var e=this._length,t=new Array(e),o=this._front,n=this._capacity,r=0;r<e;++r)t[r]=this[o+r&n-1];return t},n.prototype.push=function(e){var t=arguments.length,o=this._length;if(t>1){var n=this._capacity;if(o+t>n){for(var r=0;r<t;++r){this._checkCapacity(o+1),this[i=this._front+o&this._capacity-1]=arguments[r],o++,this._length=o}return o}for(var i=this._front,r=0;r<t;++r)this[i+o&n-1]=arguments[r],i++;return this._length=o+t,o+t}return 0===t?o:(this._checkCapacity(o+1),this[r=this._front+o&this._capacity-1]=e,this._length=o+1,o+1)},n.prototype.pop=function(){var e=this._length;if(0!==e){var t=this._front+e-1&this._capacity-1,o=this[t];return this[t]=void 0,this._length=e-1,o}},n.prototype.shift=function(){var e=this._length;if(0!==e){var t=this._front,o=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length=e-1,o}},n.prototype.unshift=function(e){var t=this._length,o=arguments.length;if(o>1){if(t+o>(r=this._capacity)){for(var n=o-1;n>=0;n--){this._checkCapacity(t+1);var r=this._capacity;this[s=(this._front-1&r-1^r)-r]=arguments[n],t++,this._length=t,this._front=s}return t}var i=this._front;for(n=o-1;n>=0;n--){var s;this[s=(i-1&r-1^r)-r]=arguments[n],i=s}return this._front=i,this._length=t+o,t+o}if(0===o)return t;this._checkCapacity(t+1);r=this._capacity;return this[n=(this._front-1&r-1^r)-r]=e,this._length=t+1,this._front=n,t+1},n.prototype.peekBack=function(){var e=this._length;if(0!==e)return this[this._front+e-1&this._capacity-1]},n.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},n.prototype.get=function(e){var t=e;if(t===(0|t)){var o=this._length;if(t<0&&(t+=o),!(t<0||t>=o))return this[this._front+t&this._capacity-1]}},n.prototype.isEmpty=function(){return 0===this._length},n.prototype.clear=function(){for(var e=this._length,t=this._front,o=this._capacity,n=0;n<e;++n)this[t+n&o-1]=void 0;this._length=0,this._front=0},n.prototype.toString=function(){return this.toArray().toString()},n.prototype.valueOf=n.prototype.toString,n.prototype.removeFront=n.prototype.shift,n.prototype.removeBack=n.prototype.pop,n.prototype.insertFront=n.prototype.unshift,n.prototype.insertBack=n.prototype.push,n.prototype.enqueue=n.prototype.push,n.prototype.dequeue=n.prototype.shift,n.prototype.toJSON=n.prototype.toArray,Object.defineProperty(n.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),n.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(i(1.5*this._capacity+16))},n.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var o=this._front,n=this._length;o+n>t&&function(e,t,o,n,r){for(var i=0;i<r;++i)o[i+n]=e[i+t],e[i+t]=void 0}(this,0,this,t,o+n&t-1)};var r=Array.isArray;function i(e){if("number"!=typeof e){if(!r(e))return 16;e=e.length}return t=Math.min(Math.max(16,e),1073741824),t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,1+(t|=t>>16);var t}t.exports=n},{}],146:[function(e,t,o){"use strict";var n=Object.prototype.hasOwnProperty,r="~";function i(){}function s(e,t,o){this.fn=e,this.context=t,this.once=o||!1}function a(e,t,o,n,i){if("function"!=typeof o)throw new TypeError("The listener must be a function");var a=new s(o,n||e,i),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),u.prototype.eventNames=function(){var e,t,o=[];if(0===this._eventsCount)return o;for(t in e=this._events)n.call(e,t)&&o.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},u.prototype.listeners=function(e){var t=r?r+e:e,o=this._events[t];if(!o)return[];if(o.fn)return[o.fn];for(var n=0,i=o.length,s=new Array(i);n<i;n++)s[n]=o[n].fn;return s},u.prototype.listenerCount=function(e){var t=r?r+e:e,o=this._events[t];return o?o.fn?1:o.length:0},u.prototype.emit=function(e,t,o,n,i,s){var a=r?r+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],p=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),p){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,o),!0;case 4:return l.fn.call(l.context,t,o,n),!0;case 5:return l.fn.call(l.context,t,o,n,i),!0;case 6:return l.fn.call(l.context,t,o,n,i,s),!0}for(u=1,c=new Array(p-1);u<p;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var f,d=l.length;for(u=0;u<d;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),p){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,o);break;case 4:l[u].fn.call(l[u].context,t,o,n);break;default:if(!c)for(f=1,c=new Array(p-1);f<p;f++)c[f-1]=arguments[f];l[u].fn.apply(l[u].context,c)}}return!0},u.prototype.on=function(e,t,o){return a(this,e,t,o,!1)},u.prototype.once=function(e,t,o){return a(this,e,t,o,!0)},u.prototype.removeListener=function(e,t,o,n){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var s=this._events[i];if(s.fn)s.fn!==t||n&&!s.once||o&&s.context!==o||c(this,i);else{for(var a=0,u=[],l=s.length;a<l;a++)(s[a].fn!==t||n&&!s[a].once||o&&s[a].context!==o)&&u.push(s[a]);u.length?this._events[i]=1===u.length?u[0]:u:c(this,i)}return this},u.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&c(this,t)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=r,u.EventEmitter=u,void 0!==t&&(t.exports=u)},{}],147:[function(e,t,o){(function(e){!function(e){function t(){}function o(e,t){if(e=void 0===e?"utf-8":e,t=void 0===t?{fatal:!1}:t,-1===r.indexOf(e.toLowerCase()))throw new RangeError("Failed to construct 'TextDecoder': The encoding label provided ('"+e+"') is invalid.");if(t.fatal)throw Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}function n(e){for(var t=0,o=Math.min(65536,e.length+1),n=new Uint16Array(o),r=[],i=0;;){var s=t<e.length;if(!s||i>=o-1){if(r.push(String.fromCharCode.apply(null,n.subarray(0,i))),!s)return r.join("");e=e.subarray(t),i=t=0}if(0==(128&(s=e[t++])))n[i++]=s;else if(192==(224&s)){var a=63&e[t++];n[i++]=(31&s)<<6|a}else if(224==(240&s)){a=63&e[t++];var c=63&e[t++];n[i++]=(31&s)<<12|a<<6|c}else if(240==(248&s)){65535<(s=(7&s)<<18|(a=63&e[t++])<<12|(c=63&e[t++])<<6|63&e[t++])&&(s-=65536,n[i++]=s>>>10&1023|55296,s=56320|1023&s),n[i++]=s}}}if(e.TextEncoder&&e.TextDecoder)return!1;var r=["utf-8","utf8","unicode-1-1-utf-8"];Object.defineProperty(t.prototype,"encoding",{value:"utf-8"}),t.prototype.encode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to encode: the 'stream' option is unsupported.");t=0;for(var o=e.length,n=0,r=Math.max(32,o+(o>>>1)+7),i=new Uint8Array(r>>>3<<3);t<o;){var s=e.charCodeAt(t++);if(55296<=s&&56319>=s){if(t<o){var a=e.charCodeAt(t);56320==(64512&a)&&(++t,s=((1023&s)<<10)+(1023&a)+65536)}if(55296<=s&&56319>=s)continue}if(n+4>i.length&&(r+=8,r=(r*=1+t/e.length*2)>>>3<<3,(a=new Uint8Array(r)).set(i),i=a),0==(4294967168&s))i[n++]=s;else{if(0==(4294965248&s))i[n++]=s>>>6&31|192;else if(0==(4294901760&s))i[n++]=s>>>12&15|224,i[n++]=s>>>6&63|128;else{if(0!=(4292870144&s))continue;i[n++]=s>>>18&7|240,i[n++]=s>>>12&63|128,i[n++]=s>>>6&63|128}i[n++]=63&s|128}}return i.slice?i.slice(0,n):i.subarray(0,n)},Object.defineProperty(o.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(o.prototype,"fatal",{value:!1}),Object.defineProperty(o.prototype,"ignoreBOM",{value:!1});var i=n;"function"==typeof Buffer&&Buffer.from?i=function(e){return Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf-8")}:"function"==typeof Blob&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&(i=function(e){var t=URL.createObjectURL(new Blob([e],{type:"text/plain;charset=UTF-8"}));try{var o=new XMLHttpRequest;return o.open("GET",t,!1),o.send(),o.responseText}catch(t){return n(e)}finally{URL.revokeObjectURL(t)}}),o.prototype.decode=function(e,t){if((t=void 0===t?{stream:!1}:t).stream)throw Error("Failed to decode: the 'stream' option is unsupported.");return e=e instanceof Uint8Array?e:e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer):new Uint8Array(e),i(e)},e.TextEncoder=t,e.TextDecoder=o}("undefined"!=typeof window?window:void 0!==e?e:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],148:[function(e,t,o){"use strict";var n=e(141),r=n(e(143)),i=n(e(142)),s=n(e(139));Object.defineProperty(o,"__esModule",{value:!0});var a=e(149);var c=["get","getKey","getAll","getAllKeys","count"],u=["put","add","delete","clear"],l=new Map;function p(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t){if(l.get(t))return l.get(t);var o=t.replace(/FromIndex$/,""),n=t!==o,i=u.indexOf(o)>=0;if(o in(n?IDBIndex:IDBObjectStore).prototype&&(i||c.indexOf(o)>=0)){var a=function(){var e=(0,s.default)(r.default.mark((function e(t){var s,a,c,u,l,p,f=arguments;return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=this.transaction(t,i?"readwrite":"readonly"),c=a.store,u=f.length,l=new Array(u>1?u-1:0),p=1;p<u;p++)l[p-1]=f[p];return n&&(c=c.index(l.shift())),e.next=6,Promise.all([(s=c)[o].apply(s,l),i&&a.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return l.set(t,a),a}}}a.replaceTraps((function(e){return(0,i.default)({},e,{get:function(t,o,n){return p(t,o)||e.get(t,o,n)},has:function(t,o){return!!p(t,o)||e.has(t,o)}})})),o.unwrap=a.unwrap,o.wrap=a.wrap,o.deleteDB=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.blocked,n=indexedDB.deleteDatabase(e);return o&&n.addEventListener("blocked",(function(){return o()})),a.wrap(n).then((function(){}))},o.openDB=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o.blocked,r=o.upgrade,i=o.blocking,s=o.terminated,c=indexedDB.open(e,t),u=a.wrap(c);return r&&c.addEventListener("upgradeneeded",(function(e){r(a.wrap(c.result),e.oldVersion,e.newVersion,a.wrap(c.transaction))})),n&&c.addEventListener("blocked",(function(){return n()})),u.then((function(e){s&&e.addEventListener("close",(function(){return s()})),i&&e.addEventListener("versionchange",(function(){return i()}))})).catch((function(){})),u}},{139:139,141:141,142:142,143:143,149:149}],149:[function(e,t,o){"use strict";var n,r,i=function(e,t){return t.some((function(t){return e instanceof t}))};var s=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap;var p={get:function(e,t,o){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return h(e[t])},set:function(e,t,o){return e[t]=o,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function f(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).indexOf(e)>=0?function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return e.apply(g(this),o),h(s.get(this))}:function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return h(e.apply(g(this),o))}:function(t){for(var o=arguments.length,n=new Array(o>1?o-1:0),r=1;r<o;r++)n[r-1]=arguments[r];var i=e.call.apply(e,[g(this),t].concat(n));return c.set(i,t.sort?t.sort():[t]),h(i)}}function d(e){return"function"==typeof e?f(e):(e instanceof IDBTransaction&&function(e){if(!a.has(e)){var t=new Promise((function(t,o){var n=function(){e.removeEventListener("complete",r),e.removeEventListener("error",i),e.removeEventListener("abort",i)},r=function(){t(),n()},i=function(){o(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",r),e.addEventListener("error",i),e.addEventListener("abort",i)}));a.set(e,t)}}(e),i(e,n||(n=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,p):e)}function h(e){if(e instanceof IDBRequest)return t=e,(o=new Promise((function(e,o){var n=function(){t.removeEventListener("success",r),t.removeEventListener("error",i)},r=function(){e(h(t.result)),n()},i=function(){o(t.error),n()};t.addEventListener("success",r),t.addEventListener("error",i)}))).then((function(e){e instanceof IDBCursor&&s.set(e,t)})).catch((function(){})),l.set(o,t),o;var t,o;if(u.has(e))return u.get(e);var n=d(e);return n!==e&&(u.set(e,n),l.set(n,e)),n}var g=function(e){return l.get(e)};o.instanceOfAny=i,o.replaceTraps=function(e){p=e(p)},o.reverseTransformCache=l,o.unwrap=g,o.wrap=h},{}],150:[function(e,t,o){(function(e){var o=null;"undefined"!=typeof WebSocket?o=WebSocket:"undefined"!=typeof MozWebSocket?o=MozWebSocket:void 0!==e?o=e.WebSocket||e.MozWebSocket:"undefined"!=typeof window?o=window.WebSocket||window.MozWebSocket:"undefined"!=typeof self&&(o=self.WebSocket||self.MozWebSocket),t.exports=o}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],151:[function(e,t,o){var n=function(e){"use strict";var t=Object.prototype,o=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function a(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,o){return e[t]=o}}function c(e,t,o,n){var r=t&&t.prototype instanceof p?t:p,i=Object.create(r.prototype),s=new _(n||[]);return i._invoke=function(e,t,o){var n="suspendedStart";return function(r,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw i;return k()}for(o.method=r,o.arg=i;;){var s=o.delegate;if(s){var a=S(s,o);if(a){if(a===l)continue;return a}}if("next"===o.method)o.sent=o._sent=o.arg;else if("throw"===o.method){if("suspendedStart"===n)throw n="completed",o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);n="executing";var c=u(e,t,o);if("normal"===c.type){if(n=o.done?"completed":"suspendedYield",c.arg===l)continue;return{value:c.arg,done:o.done}}"throw"===c.type&&(n="completed",o.method="throw",o.arg=c.arg)}}}(e,o,s),i}function u(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l={};function p(){}function f(){}function d(){}var h={};h[r]=function(){return this};var g=Object.getPrototypeOf,y=g&&g(g(C([])));y&&y!==t&&o.call(y,r)&&(h=y);var m=d.prototype=p.prototype=Object.create(h);function v(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){var n;this._invoke=function(r,i){function s(){return new t((function(n,s){!function n(r,i,s,a){var c=u(e[r],e,i);if("throw"!==c.type){var l=c.arg,p=l.value;return p&&"object"==typeof p&&o.call(p,"__await")?t.resolve(p.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(p).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}(r,i,n,s)}))}return n=n?n.then(s,s):s()}}function S(e,t){var o=e.iterator[t.method];if(void 0===o){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,S(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=u(o,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,l;var r=n.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function b(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function C(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:k}}function k(){return{value:void 0,done:!0}}return f.prototype=m.constructor=d,d.constructor=f,f.displayName=a(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,s,"GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},v(T.prototype),T.prototype[i]=function(){return this},e.AsyncIterator=T,e.async=function(t,o,n,r,i){void 0===i&&(i=Promise);var s=new T(c(t,o,n,r),i);return e.isGeneratorFunction(o)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},v(m),a(m,s,"Generator"),m[r]=function(){return this},m.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var o in e)t.push(o);return t.reverse(),function o(){for(;t.length;){var n=t.pop();if(n in e)return o.value=n,o.done=!1,o}return o.done=!0,o}},e.values=C,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(b),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(o,n){return s.type="throw",s.arg=e,t.next=o,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],s=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var a=o.call(i,"catchLoc"),c=o.call(i,"finallyLoc");if(a&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),b(o),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var n=o.completion;if("throw"===n.type){var r=n.arg;b(o)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:C(e),resultName:t,nextLoc:o},"next"===this.method&&(this.arg=void 0),l}},e}("object"==typeof t?t.exports:{});try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},{}],assignHelper:[function(e,t,o){var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,o=1,n=arguments.length;o<n;o++)for(var r in t=arguments[o])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};t.exports=n},{}],awaiterHelper:[function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};t.exports=n},{}],exportStarHelper:[function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};t.exports=r},{}],extendsHelper:[function(e,t,o){var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});t.exports=r},{}],generatorHelper:[function(e,t,o){var n=this&&this.__generator||function(e,t){var o,n,r,i,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){s.label=i[1];break}if(6===i[0]&&s.label<r[1]){s.label=r[1],r=i;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(i);break}r[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};t.exports=n},{}],readHelper:[function(e,t,o){var n=this&&this.__read||function(e,t){var o="function"==typeof Symbol&&e[Symbol.iterator];if(!o)return e;var n,r,i=o.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return s};t.exports=n},{}],spreadArrayHelper:[function(e,t,o){var n=this&&this.__spreadArray||function(e,t,o){if(o||2===arguments.length)for(var n,r=0,i=t.length;r<i;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))};t.exports=n},{}],valuesHelper:[function(e,t,o){var n=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,o=t&&e[t],n=0;if(o)return o.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};t.exports=n},{}]},{},[50])(50)}));
//# sourceMappingURL=al.min.js.map
