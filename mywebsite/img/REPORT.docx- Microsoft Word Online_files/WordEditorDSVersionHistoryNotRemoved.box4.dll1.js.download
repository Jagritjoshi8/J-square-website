'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1060:function(G,P,b){G.exports=b(1061)()?globalThis:b(1062)},1061:function(G){G.exports=function(){return"object"===typeof globalThis&&globalThis?globalThis.Array===Array:!1}},1062:function(G){function P(){if("object"===typeof self&&self)return self;if("object"===typeof window&&window)return window;throw Error("Unable to resolve global `this`");}G.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,
"__global__",{get:function(){return this},configurable:!0})}catch(b){return P()}try{return __global__?__global__:P()}finally{delete Object.prototype.z3n}}()},1063:function(G,P,b){Object.defineProperty(P,"__esModule",{value:!0});P.F3h=void 0;var k=b(834);P.F3h=function(f){return function(x){var u=f[x];switch(typeof u){case "boolean":return(0,k.getBooleanFeatureGate)(x,u);case "number":return(0,k.azh)(x,u);case "string":return(0,k.getStringFeatureGate)(x,u);default:throw Error("Wrong defaultValue type");
}}}},1064:function(G,P,b){Object.defineProperty(P,"__esModule",{value:!0});P.L3h=void 0;var k=b(835);P.L3h=function(){return function(f){return(0,k.isChangeGateEnabled)(f)}}},1065:function(G,P,b){function k(u){var w=(0,x.N_d)(void 0);void 0===w?(0,x.N_d)(void 0):(0,x.N_d)(function(){var r=w();return null===r?null:f.__assign(f.__assign({},r),u)});return w}Object.defineProperty(P,"__esModule",{value:!0});P.Iwm=P.Gwm=void 0;var f=b(77),x=b(835);P.Gwm=k;P.Iwm=function(u,w){return k(w)}},1066:function(G,
P,b){function k(u){function w(){return{}}for(var r,m,l={},z=0,F=Object.keys(u);z<F.length;z++){var L=F[z];l[L]=null===(r=u[L])||void 0===r?void 0:r.toString()}var E=null!==(m=(0,x.KPf)(void 0))&&void 0!==m?m:w;(0,x.KPf)(function(){return f.__assign(f.__assign({},E()),l)});return E}Object.defineProperty(P,"__esModule",{value:!0});P.Jwm=P.Hwm=void 0;var f=b(77),x=b(834);P.Hwm=k;P.Jwm=function(u,w){return k(w)}},1322:function(G,P,b){b.r(P);b.d(P,"Box4PasteSteward",function(){return aa});G=b(0);var k=
b(23),f=b(2),x=b(16),u=b(136),w=b(58),r=b(6),m=b(8),l=b(27),z=b(76),F=b(12),L=b(130),E=b(10),A=b(3),M=b(18),Q=b(5),R=b(66),K=b(228),J=b(39),O=b(87),N=b(40),V=b(44),W=b(30),ca=b(433),H=b(839),Z=b(1581);class aa extends Z.a{constructor(ja,Ba,la,ia,oa,ha,pa,Ea=null,Fa=null){super(ja,pa,Ea,Fa);this._formatting=this.Tua=null;this.zEa=!1;this.Fmb=null;this.tNb=-1;this.pob=0;this.Xrc=new z.a;this.nbm=4294967295;l.a(4223754,307,N.OutlineElementReader.Gg(ja));this.Omb=Ba;this.Omb.wUb(this);this.CJ=la;this.CJ.wUb(this);
this.Zn=ia;this.Oo=oa;this.q9l=ha;this.Tve=R.ListReader.Pg(this.zb);aa.hBl();aa.VAl();aa.EBl()}get Pqa(){return this.Tua||(this.Tua=k.a.instance.ra("Box4.IInternalLinkManager"))}get psd(){return this._formatting}get hWb(){return this.Tve&&!this.CJ.yxa}get Eub(){return 0<this.pob}reset(){super.reset();this._formatting=this.U6e(!1)}cKe(ja){l.a(4223762,307,N.OutlineElementReader.Gg(this.zb)||O.OutlineReader.hv(this.zb));this.H5b(!1);var Ba=new Q.GraphIterator;Ba.Wb(this.zb);ja=Z.a.Wf.eM(this.zb,this.cEc(ja));
this.qmd(Ba,!1);l.a(4223763,307,ja===this.zb.currentNode);l.a(4223764,307,E.ParagraphReader.tb(ja));-1!==this._formatting.Dr&&aa.paragraphEditor.vB(ja,this._formatting.Dr);if(aa.paragraphEditor.Zn&&!this.nZ.QGi){if(this._formatting.textIndent){var la=0;({unit:la,returnValue:oa}=aa.IPc(this._formatting.textIndent,la));var ia=!1;if(oa||!R.ListReader.oX){if(0>oa){ia=!0;var oa=-1*oa}la=aa.Xqd(oa,la);ia?aa.paragraphEditor.Zn.Zgb(ja,la):aa.paragraphEditor.Zn.Y9(ja,la)}}!this._formatting.marginLeft||aa.Dc.lAb||
R.ListReader.Pg(Ba)||(Ba=0,{unit:Ba,returnValue:ia}=aa.IPc(this._formatting.marginLeft,Ba),Ba=aa.Xqd(ia,Ba),aa.paragraphEditor.Zn.kla(ja,1,Ba))}(aa.hd.Bf||M.a.instance.J(3)&&F.App.wu.scc)&&ja.setValue(r.a.aAb,!0);this._formatting.lineSpacing&&aa.paragraphEditor.sA(ja,this._formatting.lineSpacing);if(this._formatting.vbc){Ba=[];ia=[];la=[];oa=this._formatting.vbc.split(" ");let Ea=1,Fa=0;for(let Ga=0;Ga<oa.length;Ga++){var ha=aa.lek(oa[Ga]),pa=aa.kek(oa[Ga]);if(-1!==ha)Ea=ha;else if(-1!==pa)Fa=pa;
else{ha=0;({unit:ha,returnValue:pa}=aa.IPc(oa[Ga],ha));ha=aa.Xqd(pa,ha);if(0<=ha&&ha<=this.nbm)Ba.push(ha),ia.push(Ea),la.push(Fa);else{l.b(555103310,307,15,"Invalid custom tab value. tabStops: "+this._formatting.vbc+" index: "+Ga);break}Ea=1;Fa=0}}0<Ba.length&&aa.paragraphEditor.VCj(ja,Ba,ia,la)}this._formatting.paragraph=ja;this.zEa=!0}qmd(ja,Ba){l.a(8128518,307,!Ba);this.kS&&(0<this.kS&&this.Zn.ozc(ja,this.kS),0>this.kS&&this.Zn.$La(ja,this.kS,0));ja&&this.Oo.x0d(ja,this.Eub);this.kS=0}O5d(ja){this.Xrc.add(ja)}TPe(){this.kS=
0}z9(ja,Ba=null){l.a(4223772,307,E.ParagraphReader.eg(this.zb));const la=this.zb.currentNode;this._formatting.oZf(la);if(!this.nZ.yZf(this.zb,Ba,!1)){var ia=la.la.last,oa=W.a.av(la);this.zEa&&(ia.formatting=this._formatting.kO.Ge(ia),M.a.instance.J(6)&&la.rl(),this.zEa=!1);ja=this.nZ.zcf(ja,Ba);this.nZ.YBa(this.zb.currentNode,this._formatting.J9,Ba);this.characterPropertiesEditor.replaceTextRange(oa,ja,void 0,void 0,A.a.paste)}}JAa(ja){this.nZ.FJd&&this.nZ.EId(ja)?(this.hE(),this.iE(ja)):(l.a(4223773,
307,E.ParagraphReader.eg(this.zb)),ja=W.a.av(this.zb.currentNode),this.characterPropertiesEditor.Lca(ja,Ba=>new ca.a(Ba)))}efb(){this.nZ.Ecf(this.zb)}Wra(ja){if(aa.Wxk(ja)){const Ba=this.zb.currentNode;E.ParagraphReader.tb(Ba)&&(Ba.A7b=ja.h1e)}else this.Omb.Wra(ja)}FAa(ja){this._formatting=ja;this.zEa=!0}vLa(ja){l.a(4223774,307,E.ParagraphReader.eg(this.zb));l.a(4223775,307,!this.Fmb);l.a(4223776,307,0>this.tNb);this.Fmb=ja;this.tNb=E.ParagraphReader.textLength(this.zb.currentNode)}uLa(){l.a(4223777,
307,E.ParagraphReader.eg(this.zb));l.a(4223778,307,!!this.Fmb);l.a(4223779,307,0<=this.tNb);let ja=W.a.createTextRange(this.zb.currentNode,this.tNb,E.ParagraphReader.textLength(this.zb.currentNode)),Ba="",la="";this.Pqa&&({yJf:Ba,Coh:la}=this.Pqa.qZf(L.HyperlinkReader.iJa(this.Fmb))).returnValue&&(this.Fmb=Ba,la&&(this.characterPropertiesEditor.replaceTextRange(ja,la),ja=W.a.createTextRange(this.zb.currentNode,this.tNb,E.ParagraphReader.textLength(this.zb.currentNode))));aa.hyperlinkEditor.BG(ja,
this.Fmb,!1);this.zEa=!0;this.Fmb=null;this.tNb=-1}iE(ja){this.cKe(ja);this._formatting.c6d(this.zb.currentNode);this.nZ.YBa(this.zb.currentNode,this._formatting.J9,ja)}hE(){l.a(4223808,307,E.ParagraphReader.eg(this.zb));aa.hyperlinkEditor.UBk(this.zb.currentNode);J.OutlineElementNavigator.Wc(this.zb)}bfb(){}afb(){}ALa(){}lZa(){}MAa(){l.a(4223809,307,N.OutlineElementReader.Gg(this.zb)||O.OutlineReader.hv(this.zb));let ja=!1;this.Eub||(ja=this.hWb||!0);ja||(this.kS+=1);this.pob++}KAa(){this.pob--;
let ja=!1;this.Eub||(ja=this.hWb||!0,this.Oo.cKf(this.Xrc));ja||--this.kS}zLa(ja){l.a(4223810,307,N.OutlineElementReader.Gg(this.zb)||O.OutlineReader.hv(this.zb));l.a(4223811,307,!!ja.listStyleType);this.Oo.w0d(this.mZl(ja))}LAa(){l.a(4223813,307,N.OutlineElementReader.Gg(this.zb));f.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(aa.Dc.lAb&&R.ListReader.Pg(this.zb)){const ja=E.ParagraphReader.Bl(this.zb.currentNode),Ba=this.q9l.nxb(this.zb);
H.a.Dc.JO||this.Oo.v0d(Ba,ja,null)}}nZa(ja){this.Omb.nZa(ja)}y9(ja){this.CJ.y9(ja)}v9(){this.CJ.v9()}x9(ja){this.CJ.x9(ja)}w9(){this.CJ.w9()}u9(ja){this.CJ.u9(ja)}t9(){this.CJ.t9()}static get paragraphEditor(){return aa.kh||(aa.kh=k.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return aa.Oi||(aa.Oi=k.a.instance.resolve("Box4.IHyperlinkEditor"))}static get hd(){return aa.Bb||(aa.Bb=k.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get i2f(){return aa.$b||
(aa.$b=k.a.instance.resolve("Box4.Styles.IWACStyleReader"))}static get nbc(){return aa.pCe}static set nbc(ja){aa.pCe=ja}static get Dc(){return K.a.getInstance()}static hBl(){const ja=M.a.instance.J(8);aa.wZa[1]=ja?V.StyleReader.wordStyleIdHeading1:V.StyleReader.styleIdHeading1;aa.wZa[2]=ja?V.StyleReader.wordStyleIdHeading2:V.StyleReader.styleIdHeading2;aa.wZa[3]=ja?V.StyleReader.wordStyleIdHeading3:V.StyleReader.styleIdHeading3;aa.wZa[4]=ja?V.StyleReader.F1a:V.StyleReader.eta;aa.wZa[5]=ja?V.StyleReader.G1a:
V.StyleReader.yNa;aa.wZa[6]=ja?V.StyleReader.H1a:V.StyleReader.zNa;aa.wZa[7]=ja?null:V.StyleReader.x0a}static VAl(){aa.Ara.unspecified=0;aa.Ara.defaultUnordered=1;aa.Ara.defaultOrdered=1;aa.Ara.none=0;aa.Ara.disc=1;aa.Ara.circle=2;aa.Ara.square=3;aa.Ara.decimal=1;aa.Ara.lowerAlpha=2;aa.Ara.lowerRoman=3;aa.Ara.upperAlpha=4;aa.Ara.upperRoman=5}static EBl(){aa.pCe=aa.i2f.lp()}static lek(ja){let Ba=-1;if(!ja)return Ba;ja=ja.toLowerCase();switch(ja){case "left":Ba=1;break;case "center":Ba=3;break;case "right":Ba=
4;break;case "decimal":Ba=6;break;case "bar":Ba=7}return Ba}static kek(ja){let Ba=-1;if(!ja)return Ba;ja=ja.toLowerCase();switch(ja){case "blank":Ba=0;break;case "dotted":Ba=1;break;case "dashed":Ba=2;break;case "lined":Ba=3}return Ba}static Qtb(ja){const Ba=x.a.substring(ja,0,2),la=x.a.substring(ja,2,4);return x.a.substring(ja,4,6)+la+Ba}static IPc(ja,Ba){Ba=0;const la=ja.length;var ia=x.a.substring(ja,0,la-2);ia=parseFloat(ia);ja=x.a.substr(ja,la-2,2);switch(ja){case "in":Ba=3;break;case "px":Ba=
7;break;case "cm":Ba=1;break;case "pt":Ba=5;break;default:m.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",ja),ia=0}return{returnValue:ia,unit:Ba}}static Xqd(ja,Ba){let la=0;switch(Ba){case 3:la=u.a.YD(ja);break;case 7:la=w.a.ry(ja,0);break;case 1:la=u.a.YOe(ja);break;case 5:la=u.a.YD(u.a.JDf(ja));break;default:m.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",
ja,Ba)}return la}static Wxk(ja){return!!ja&&!!ja.h1e&&""!==ja.h1e}}aa.kh=null;aa.Oi=null;aa.Bb=null;aa.$b=null;aa.wZa=Array(8);aa.Ara={};aa.pCe=null;Object(G.a)(aa,"Box4PasteSteward",Z.a,[])},1352:function(G,P,b){G=b(0);var k=b(2),f=b(1790),x=b(8);const u=(r,m)=>{const l={};let z=null;switch(r){case 0:z="HtmlProcessor";var F=m.a;null!=F&&(l.SessionID=F);var L=m.b.toString();null!=L&&(l.Elements=L);var E=m.c.toString();null!=E&&(l.PrunedElements=E);var A=m.d.toString();null!=A&&(l.TransparentElements=
A);var M=m.e.toString();null!=M&&(l.VoidElements=M);var Q=m.f.toString();null!=Q&&(l.UnknownElements=Q);break;case 1:z="WordConverter";var R=m.a;null!=R&&(l.SessionID=R);var K=m.b.toString();null!=K&&(l.BulletsConverted=K);var J=m.c.toString();null!=J&&(l.NumberedConverted=J);break;case 2:z="FormattingSteward";var O=m.a;null!=O&&(l.SourceApp=O);var N=m.b;null!=N&&(l.Browser=N);var V=m.c;null!=V&&(l.OperationId=V);var W=m.d.toString();null!=W&&(l.Lang=W);var ca=m.e.toString();null!=ca&&(l.TextDir=
ca);var H=m.f.toString();null!=H&&(l.Bold=H);var Z=m.g.toString();null!=Z&&(l.Math=Z);var aa=m.h.toString();null!=aa&&(l.Italics=aa);var ja=m.i.toString();null!=ja&&(l.Underline=ja);var Ba=m.j.toString();null!=Ba&&(l.Strikethrough=Ba);var la=m.k.toString();null!=la&&(l.Subscript=la);var ia=m.l.toString();null!=ia&&(l.Superscript=ia);var oa=m.m.toString();null!=oa&&(l.Fontsize=oa);var ha=m.n.toString();null!=ha&&(l.Fontface=ha);var pa=m.o.toString();null!=pa&&(l.GrowFontsize=pa);var Ea=m.p.toString();
null!=Ea&&(l.ShrinkFontsize=Ea);var Fa=m.q.toString();null!=Fa&&(l.FontColor=Fa);var Ga=m.r.toString();null!=Ga&&(l.FontHighlight=Ga);var $a=m.s.toString();null!=$a&&(l.ParagraphStyle=$a);var fa=m.t.toString();null!=fa&&(l.TextAlign=fa);var sa=m.u.toString();null!=sa&&(l.TextIndent=sa);var qa=m.v.toString();null!=qa&&(l.MarginLeft=qa);var va=m.w.toString();null!=va&&(l.ParagraphSpaceBefore=va);var Ca=m.x.toString();null!=Ca&&(l.ParagraphSpaceAfter=Ca);var ta=m.y.toString();null!=ta&&(l.LineSpace=
ta);var Wa=m.z.toString();null!=Wa&&(l.CellShadingColor=Wa);var Za=m.ba.toString();null!=Za&&(l.StyleDefinition=Za);var Ya=m.bb.toString();null!=Ya&&(l.TabStops=Ya);break;case 3:z="SemanticEvents";var Ka=m.a;null!=Ka&&(l.SessionID=Ka);var xa=m.b.toString();null!=xa&&(l.Text=xa);var Sa=m.c.toString();null!=Sa&&(l.LineBreak=Sa);var pb=m.d.toString();null!=pb&&(l.Image=pb);var Db=m.e.toString();null!=Db&&(l.File=Db);var Ua=m.f.toString();null!=Ua&&(l.FormattingChange=Ua);var Lb=m.g.toString();null!=
Lb&&(l.Anchor=Lb);var Va=m.h.toString();null!=Va&&(l.Paragraph=Va);var Sb=m.i.toString();null!=Sb&&(l.Math=Sb);var nb=m.j.toString();null!=nb&&(l.List=nb);var La=m.k.toString();null!=La&&(l.ListItem=La);var Ha=m.l.toString();null!=Ha&&(l.RenderAugmentation=Ha);var Aa=m.m.toString();null!=Aa&&(l.Span=Aa);break;case 4:z="SemanticTableEvents";var Ma=m.a;null!=Ma&&(l.SessionID=Ma);var cb=m.b.toString();null!=cb&&(l.Tables=cb);var ib=m.c.toString();null!=ib&&(l.TableRow=ib);var Rb=m.d.toString();null!=
Rb&&(l.TableCell=Rb);var Oa=m.e.toString();null!=Oa&&(l.TablePart=Oa);break;case 5:z="HtmlEvents";var lb=m.a;null!=lb&&(l.OperationId=lb);var gb=m.b;null!=gb&&(l.SourceApp=gb);var Nb=m.c;null!=Nb&&(l.Browser=Nb);var qc=null==m.d?null:m.d.toString();null!=qc&&(l.Text=qc);var Eb=null==m.e?null:m.e.toString();null!=Eb&&(l.A=Eb);var ec=null==m.f?null:m.f.toString();null!=ec&&(l.Abbr=ec);var Jb=null==m.g?null:m.g.toString();null!=Jb&&(l.Acronym=Jb);var vb=null==m.h?null:m.h.toString();null!=vb&&(l.Address=
vb);var xb=null==m.i?null:m.i.toString();null!=xb&&(l.Applet=xb);var lc=null==m.j?null:m.j.toString();null!=lc&&(l.Area=lc);var Lc=null==m.k?null:m.k.toString();null!=Lc&&(l.B=Lc);var uc=null==m.l?null:m.l.toString();null!=uc&&(l.Base=uc);var od=null==m.m?null:m.m.toString();null!=od&&(l.Basefont=od);var Cb=null==m.n?null:m.n.toString();null!=Cb&&(l.Bdo=Cb);var gc=null==m.o?null:m.o.toString();null!=gc&&(l.Big=gc);var Dc=null==m.p?null:m.p.toString();null!=Dc&&(l.Blockquote=Dc);var Ub=null==m.q?null:
m.q.toString();null!=Ub&&(l.Body=Ub);var Bb=null==m.r?null:m.r.toString();null!=Bb&&(l.Br=Bb);var fb=null==m.s?null:m.s.toString();null!=fb&&(l.Button=fb);var yb=null==m.t?null:m.t.toString();null!=yb&&(l.Caption=yb);var Wb=null==m.u?null:m.u.toString();null!=Wb&&(l.Center=Wb);var Xb=null==m.v?null:m.v.toString();null!=Xb&&(l.Cite=Xb);var Cc=null==m.w?null:m.w.toString();null!=Cc&&(l.Code=Cc);var Bc=null==m.x?null:m.x.toString();null!=Bc&&(l.Col=Bc);var pd=null==m.y?null:m.y.toString();null!=pd&&
(l.Colgroup=pd);var zd=null==m.z?null:m.z.toString();null!=zd&&(l.Dd=zd);var Jd=null==m.ba?null:m.ba.toString();null!=Jd&&(l.Del=Jd);var Ue=null==m.bb?null:m.bb.toString();null!=Ue&&(l.Dfn=Ue);var Sc=null==m.bc?null:m.bc.toString();null!=Sc&&(l.Dir=Sc);var kc=null==m.bd?null:m.bd.toString();null!=kc&&(l.Div=kc);var Pc=null==m.be?null:m.be.toString();null!=Pc&&(l.Dl=Pc);var Rd=null==m.bf?null:m.bf.toString();null!=Rd&&(l.Dt=Rd);var le=null==m.bg?null:m.bg.toString();null!=le&&(l.Em=le);var Fc=null==
m.bh?null:m.bh.toString();null!=Fc&&(l.Fieldset=Fc);var He=null==m.bi?null:m.bi.toString();null!=He&&(l.Font=He);var $e=null==m.bj?null:m.bj.toString();null!=$e&&(l.Form=$e);var Le=null==m.bk?null:m.bk.toString();null!=Le&&(l.Frame=Le);var df=null==m.bl?null:m.bl.toString();null!=df&&(l.Frameset=df);var Af=null==m.bm?null:m.bm.toString();null!=Af&&(l.H=Af);var Ve=null==m.bn?null:m.bn.toString();null!=Ve&&(l.Head=Ve);var Kc=null==m.bo?null:m.bo.toString();null!=Kc&&(l.Hr=Kc);var hd=null==m.bp?null:
m.bp.toString();null!=hd&&(l.Html=hd);var id=null==m.bq?null:m.bq.toString();null!=id&&(l.I=id);var oh=null==m.br?null:m.br.toString();null!=oh&&(l.Iframe=oh);var vf=null==m.bs?null:m.bs.toString();null!=vf&&(l.Img=vf);var Yc=null==m.bt?null:m.bt.toString();null!=Yc&&(l.Input=Yc);var sb=null==m.bu?null:m.bu.toString();null!=sb&&(l.Ins=sb);var Qb=null==m.bv?null:m.bv.toString();null!=Qb&&(l.Isindex=Qb);var Oc=null==m.bw?null:m.bw.toString();null!=Oc&&(l.Kbd=Oc);var wc=null==m.bx?null:m.bx.toString();
null!=wc&&(l.Label=wc);var yc=null==m.by?null:m.by.toString();null!=yc&&(l.Legend=yc);var ef=null==m.bz?null:m.bz.toString();null!=ef&&(l.Li=ef);var Je=null==m.ca?null:m.ca.toString();null!=Je&&(l.Link=Je);var fh=null==m.cb?null:m.cb.toString();null!=fh&&(l.Map=fh);var re=null==m.cc?null:m.cc.toString();null!=re&&(l.Math=re);var Se=null==m.cd?null:m.cd.toString();null!=Se&&(l.Menu=Se);var Ye=null==m.ce?null:m.ce.toString();null!=Ye&&(l.Meta=Ye);var Ji=null==m.cf?null:m.cf.toString();null!=Ji&&(l.Noframes=
Ji);var ah=null==m.cg?null:m.cg.toString();null!=ah&&(l.Noscript=ah);var ag=null==m.ch?null:m.ch.toString();null!=ag&&(l.Object=ag);var rg=null==m.ci?null:m.ci.toString();null!=rg&&(l.Ol=rg);var pi=null==m.cj?null:m.cj.toString();null!=pi&&(l.Optgroup=pi);var Rj=null==m.ck?null:m.ck.toString();null!=Rj&&(l.Option=Rj);var Ki=null==m.cl?null:m.cl.toString();null!=Ki&&(l.P=Ki);var Fd=null==m.cm?null:m.cm.toString();null!=Fd&&(l.Param=Fd);var Ld=null==m.cn?null:m.cn.toString();null!=Ld&&(l.Pre=Ld);var we=
null==m.co?null:m.co.toString();null!=we&&(l.Q=we);var Te=null==m.cp?null:m.cp.toString();null!=Te&&(l.S=Te);var Dj=null==m.cq?null:m.cq.toString();null!=Dj&&(l.Samp=Dj);var oi=null==m.cr?null:m.cr.toString();null!=oi&&(l.Script=oi);var ik=null==m.cs?null:m.cs.toString();null!=ik&&(l.Select=ik);var Nf=null==m.ct?null:m.ct.toString();null!=Nf&&(l.Small=Nf);var vj=null==m.cu?null:m.cu.toString();null!=vj&&(l.Span=vj);var Qj=null==m.cv?null:m.cv.toString();null!=Qj&&(l.Strike=Qj);var Jg=null==m.cw?null:
m.cw.toString();null!=Jg&&(l.Strong=Jg);var Mi=null==m.cx?null:m.cx.toString();null!=Mi&&(l.Style=Mi);var rf=null==m.cy?null:m.cy.toString();null!=rf&&(l.Sub=rf);var ld=null==m.cz?null:m.cz.toString();null!=ld&&(l.Sup=ld);var lg=null==m.da?null:m.da.toString();null!=lg&&(l.Tables=lg);var Cj=null==m.db?null:m.db.toString();null!=Cj&&(l.Tbody=Cj);var Bm=null==m.dc?null:m.dc.toString();null!=Bm&&(l.Td=Bm);var bi=null==m.dd?null:m.dd.toString();null!=bi&&(l.Textarea=bi);var ml=null==m.de?null:m.de.toString();
null!=ml&&(l.Tfoot=ml);var fg=null==m.df?null:m.df.toString();null!=fg&&(l.Th=fg);var Ej=null==m.dg?null:m.dg.toString();null!=Ej&&(l.Thead=Ej);var ui=null==m.dh?null:m.dh.toString();null!=ui&&(l.Title=ui);var Xl=null==m.di?null:m.di.toString();null!=Xl&&(l.Tr=Xl);var qf=null==m.dj?null:m.dj.toString();null!=qf&&(l.Tt=qf);var yk=null==m.dk?null:m.dk.toString();null!=yk&&(l.U=yk);var Qh=null==m.dl?null:m.dl.toString();null!=Qh&&(l.Ul=Qh);var rk=null==m.dm?null:m.dm.toString();null!=rk&&(l.Var=rk);
var yf=null==m.dn?null:m.dn.toString();null!=yf&&(l.Unknown=yf);break;case 6:z="List";var Cl=m.a;null!=Cl&&(l.SessionID=Cl);var bn=m.b.toString();null!=bn&&(l.MaxListLevel=bn)}l.Table=z;return Sys.Serialization.JavaScriptSerializer.serialize(l)};b.d(P,"a",function(){return w});class w{static get zja(){null==w.pnb&&(w.pnb=!!k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("UsageEditorLoggingIsDisabled"));return w.pnb}static get TTh(){null==w.Zne&&(w.Zne=!!k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("WordUsageEditorLoggingIsEnabled"));
return w.Zne}static XX(r){x.ULS.sendTraceTag(524038472,307,50,r)}static awh(r){const m={};m.a=r;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;return m}static o4l(r){w.zja||w.XX(u(0,r))}static Erh(r){const m={};m._sessionID=r;return m}static Abf(r){const m={};m.a=r;m.b=0;m.c=0;return m}static T8l(r){w.zja||w.XX(u(1,r))}static $vh(r,m){const l={};l.c=f.a[r];l.a=m;return l}static n4l(r,m){w.TTh&&r&&(r.b=m,w.XX(u(5,r)))}static zCh(r){const m={};m.a=r;m.b=0;m.c=0;m.d=0;m.e=0;m.f=0;m.g=0;m.h=0;m.i=0;m.j=0;m.k=0;m.l=0;
m.m=0;return m}static v7l(r){w.zja||w.XX(u(3,r))}static ACh(r){const m={};m.a=r;m.b=0;m.c=0;m.d=0;m.e=0;return m}static w7l(r){w.zja||w.XX(u(4,r))}static N7e(r,m){const l={};l.b=f.a[r];l.c=m;l.d=0;l.e=0;l.f=0;l.g=0;l.h=0;l.i=0;l.j=0;l.k=0;l.l=0;l.m=0;l.n=0;l.o=0;l.p=0;l.q=0;l.r=0;l.s=0;l.t=0;l.w=0;l.x=0;l.y=0;l.z=0;l.u=0;l.v=0;l.ba=0;l.bb=0;return l}static S3l(r,m){w.TTh&&r&&(r.a=m,w.XX(u(2,r)))}static i6k(r){const m={};m.a=r;m.b=-1;return m}static R4l(r){!w.zja&&r&&0<=r.b&&w.XX(u(6,r))}}w.pnb=null;
w.Zne=null;Object(G.a)(w,"UsageEditor",null,[])},1372:function(G,P,b){b.d(P,"a",function(){return x});G=b(0);var k=b(2),f=b(5);class x{static get tib(){return!!k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("WordDesignerTelemetryPerConstructIsEnabled")}static uab(u,w=!1){const r=f.GraphIterator.va(u);r.nc();return(w?r.Za(4):r.d4(4))?4:f.GraphIterator.va(u).La(36)?16:f.GraphIterator.va(u).La(14)?2:f.GraphIterator.va(u).La(38)?32:1}}Object(G.a)(x,"ConstructTypeHelper",null,[])},1393:function(G,
P,b){b.d(P,"a",function(){return W});G=b(0);var k=b(76),f=b(146),x=b(23),u=b(185),w=b(2),r=b(191),m=b(6),l=b(91),z=b(70),F=b(12),L=b(43),E=b(553),A=b(219),M=b(233),Q=b(10),R=b(66),K=b(338),J=b(21),O=b(14),N=b(280),V=b(3);class W{static get uf(){return A.ContextSetEditor.instance}static get Sf(){return M.a.instance}static get Kb(){return f.a.instance}static gv(){return W.vl||(W.vl=x.a.instance.za("Box4.IExternalSelectionManager"))}static get yC(){return W.uj||(W.uj=x.a.instance.resolve("Box4.IParagraphIndentationReader"))}static ijl(){this.LL||
(this.LL=new k.a,this.LL.add(V.a.nv),this.LL.add(V.a.font),this.LL.add(V.a.BY),this.LL.add(V.a.zha),this.LL.add(V.a.bold),this.LL.add(V.a.setItalic),this.LL.add(V.a.superscript),this.LL.add(V.a.subscript),this.LL.add(V.a.gtb),this.LL.add(V.a.zTa),this.LL.add(V.a.K8a),this.LL.add(V.a.$Oe),this.LL.add(V.a.L8a),this.LL.add(V.a.ftb),this.LL.add(V.a.wM),this.LL.add(V.a.OM),this.LL.add(V.a.clearFormatting),this.LL.add(V.a.P8a),this.LL.add(V.a.zwc));return this.LL}static Y1b(ca){return W.ijl().contains(ca)?
!0:!1}static Wu(ca,H,Z,aa,ja){var Ba=!0;if(!H.view.Cd)return 2;var la=H.view,ia=la.Ma;ia&&ia.Ca.Fa||(W.Kb.ib(l.a.re,{["Reason"]:z.a.noSelection}),Ba=!1);W.uf.dxa(J.ImageReader.nJc,la.Ma.If)&&(W.Kb.ib(l.a.re,{["Reason"]:z.a.dSe}),Ba=!1);if(W.uf.dxa(J.ImageReader.nXa,la.Ma.If))return W.Kb.ib(l.a.re,{["Reason"]:z.a.uxc}),8;var oa=!W.Y1b(ca);W.Sf.f2b(la.Ma.If,oa)&&(W.Kb.ib(l.a.re,{["Reason"]:z.a.dC}),Ba=!1);W.uf.dxa(J.ImageReader.zId,la.Ma.If)&&(W.Kb.ib(l.a.re,{["Reason"]:z.a.ZRe}),Ba=!1);W.uf.dxa(N.c,
la.Ma.If)&&(W.Kb.ib(l.a.re,{["Reason"]:z.a.$Re}),Ba=!1);W.uf.dxa(K.a.ajf,la.Ma.If)&&(W.Kb.ib(l.a.re,{["Reason"]:z.a.YRe}),Ba=!1);W.uf.J$(Q.ParagraphReader.EO,la.Ma.If)&&(W.Kb.ib(l.a.re,{["Reason"]:z.a.$L}),Ba=!1);W.gv()&&W.gv().instance&&W.gv().instance.JR(la.Ma.If)&&(W.Kb.ib(l.a.re,{["Reason"]:z.a.externalSelection}),Ba=!1);var ha=null;ia&&ia.Ca.Fa&&(ha=ia.Ca.Fa);ca===V.a.U2d&&ha&&ha.eC&&Q.ParagraphReader.IO(ha.sa.node)&&!R.ListReader.mq&&(Ba=!1);if(1===Z||!Ba||!ha)return Ba?32:8;Ba=ca===V.a.F4b||
ca===V.a.qVb||ca===V.a.D9b||ca===V.a.bZb;la=ca===V.a.aEb||ca===V.a.Vub||ca===V.a.S8b;oa=ca===V.a.$Ma||ca===V.a.aNa||ca===V.a.sA;const pa=new L.GraphTransaction(15);pa.Oa(ha.sa.node);ha=new k.a;let Ea=!1;if(Ba||la||oa)u.a.mark(7121),H=W.uf.Toh(H.lm);else{u.a.mark(7119);H=E.OutlineElementGeneralizer.xia(ia.Ca,!0);if(!H)return W.Kb.ib(l.a.ria,{["Reason"]:z.a.cwd}),pa.dispose(),8;ia=ca===V.a.WWa||ca===V.a.Xbb;H.Iv&&ia&&(Ea=W.Zsl(ha,H))}(ca===V.a.leftJustify||ca===V.a.F4b||ca===V.a.centerJustify||ca===
V.a.qVb||ca===V.a.rightJustify||ca===V.a.D9b||ca===V.a.fullJustify||ca===V.a.bZb)&&H.Iv&&1<H.length&&W.$sl(H)&&(ja||(ja={}),Object.getType(ja)===Object&&(ja.InContextSet=!0));w.AFrameworkApplication.pa.Le(H,ca,Z,!0,aa,ja);Ea&&W.Ahm(ha,H,ja);pa.dispose();F.App.oa.updateCommandUI();Ba||la||oa?u.a.mark(7122):u.a.mark(7120);return 32}static Zsl(ca,H){if(!H.Iv)return!1;let Z=!1,aa=!1;for(let Ba=0;Ba<H.length;Ba++)if(H.getContext(Ba).Kk){var ja=H.getContext(Ba).node;ja&&(ja=W.yC.Mab(ja),2===ja.specialIndentType?
(Z=!0,ca.add(Ba)):1!==ja.specialIndentType&&ja.specialIndentType||(aa=!0))}return aa&&Z}static Ahm(ca,H,Z){if(H.Iv)for(let ja=0;ja<ca.count;ja++){var aa=H.getContext(ca.J(ja));if(!aa.Kk)continue;aa=aa.node;const Ba=W.yC.Mab(aa);2!==Ba.specialIndentType||r.a.KX(Z.value,Ba.az)||aa.setValue(m.a.sk,Ba.az-Ba.m$)}}static dSf(ca,H){let Z=!0;H.contextId!==O.a.paragraph?Z=!1:W.Sf.SXa(H)?(W.Kb.ib(l.a.Nl,{["Reason"]:z.a.dC}),Z=!1):W.gv()&&W.gv().instance&&W.gv().instance.JR(H)?(W.Kb.ib(l.a.Nl,{["Reason"]:z.a.externalSelection}),
Z=!1):H.Kk&&(H=H.node,Q.ParagraphReader.tb(H)&&H.WN&&(W.Kb.ib(l.a.Nl,{["Reason"]:z.a.$L}),Z=!1));return{returnValue:1!==ca&&Z,jw:Z?32:8}}static $sl(ca){if(!ca.Iv)return!1;let H=1;for(let aa=0;aa<ca.length;aa++){var Z=ca.getContext(aa);if(Z&&Z.Kk&&Z.contextId===O.a.paragraph&&(Z=Z.node))if(Z=Q.ParagraphReader.zu(Z),!aa)H=Z;else if(Z!==H)return!0}return!1}}W.vl=null;W.uj=null;W.LL=null;Object(G.a)(W,"FormattingActionHelper",null,[])},1394:function(G,P,b){b.d(P,"a",function(){return f});b.d(P,"b",function(){return x});
var k=b(2);const f=u=>{switch(u){case 2:return WordEditorIntl.WordEditorStrings.L_ResultTypeHeader;case 4:return WordEditorIntl.WordEditorStrings.L_ResultTypeFooter;case 8:return WordEditorIntl.WordEditorStrings.L_ResultTypeFootnote;case 16:return WordEditorIntl.WordEditorStrings.L_ResultTypeEndnote;case 32:return WordEditorIntl.WordEditorStrings.L_ResultTypeComment}return""},x=()=>{var u;return null===(u=k.AFrameworkApplication.K)||void 0===u?void 0:u.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1)}},1403:function(G,P,b){b.r(P);G=b(0);var k=b(23),f=b(99),x=b(2),u=b(58),w=b(348),r=b(41),m=b(43),l=b(5);class z{aXe(Ub,Bb,fb){return 1===fb?32:z.wrk(Bb.node)}static wrk(Ub){const Bb=new l.GraphIterator;Bb.set(Ub);Bb.fn();Ub=new m.GraphTransaction(7);Ub.Lr(Bb);Bb.xf();Ub.dispose();return 32}}Object(G.a)(z,"DeleteOutlineLevelContentStrategy",null,[]);var F=b(128),L=b(172),E=b(67),A=b(219),M=b(19),Q=b(24),R=b(10),K=b(104),J=b(39),O=b(206),N=b(87),V=b(30);class W{constructor(Ub){this.Do=this.Xi=this.Bz=
this.HP=this.NH=null;this.Tga=Ub}get wsb(){return this.HP||(this.HP=k.a.instance.ra("Box4.IAutoCorrectRules"))}get z_(){return this.Bz||(this.Bz=k.a.instance.ra("Box4.IAutoCorrectScheduler"))}get BK(){return this.NH||(this.NH=k.a.instance.ra("Box4.Pages.IPageContentEditor"))}get vC(){return this.Do||(this.Do=k.a.instance.ra("Box4.IOutlineEditor"))}get ji(){return this.Xi||(this.Xi=this.Tga())}YZh(Ub,Bb,fb){if(this.vC&&W.hh){var yb=A.ContextSetEditor.C8e(Bb);Ub=yb.node;M.SelectionEditor.mj(yb)&&(yb=
V.a.Sb(Ub,R.ParagraphReader.textLength(Ub)));var Wb=K.FormattingReader.language(K.FormattingReader.zr(yb));yb=l.GraphIterator.va(fb.sc);W.Ag.STc(yb);var Xb=Ub=null;if(yb)for(let Cc=yb.Za(1);Cc&&!Xb;Cc=yb.Fh(1))N.OutlineReader.hra(Cc)&&(Xb=Cc);if(yb&&!Xb){if(!this.BK||!this.vC)return;Ub=new m.GraphTransaction(7);Ub.Lr(yb);Xb=this.BK.Nrd(yb);this.vC.t_(yb,!0);Wb&&(J.OutlineElementNavigator.Fd(yb),yb=V.a.Sb(yb.currentNode,0),W.hh.q0d(K.FormattingReader.zr(yb),Wb))}Wb=Q.SelectionFactory.en(Xb,!0);fb.Ma.setSelection(Wb);
M.SelectionEditor.ke(Bb)&&(fb=l.GraphIterator.va(Bb.node),fb.fn(),O.OutlineNavigator.LMf(fb),this.wsb&&this.z_&&N.OutlineReader.gz(fb,Bb,!0)&&(Bb=this.wsb.W1e(Bb,-1,!1,E.a.Sv))&&this.z_.Bxi(Bb));this.ji&&this.ji.ZD();Ub&&Ub.dispose()}}static get hh(){return W.nd||(W.nd=k.a.instance.ra("Box4.IFormattingEditor"))}static get instance(){return W._instance||(W._instance=W.wk())}static wk(){return new W(()=>k.a.instance.ra("Box4.IUndoManager"))}static get Ag(){return L.PageNavigator.instance}}W._instance=
null;W.nd=null;Object(G.a)(W,"TitleViewEditor",null,[]);var ca=b(49),H=b(409),Z=b(595),aa=b(22),ja=b(14),Ba=b(280),la=b(3);class ia{constructor(){this.Pbj=new z}eb(Ub){const Bb=Object(r.a)(this.Fch,this.Fch.fXe,"deleteView"),fb=Object(r.a)(this,this.aXe,"deleteOutlineLevelContent"),yb=Object(r.a)(this.tch,this.tch.Brk,"deleteParagraphContent");this.XIf(Ub,Bb,fb,yb);Ub.ka(la.a.backspace,ja.a.Ub,yb);Ub.ka(la.a.backspace,ja.a.xc,yb);Ub.ka(la.a.backspace,ja.a.endOfParagraph,f.ActionManager.lX);Ub.ka(la.a.backspace,
ja.a.outline,fb);Ub.ka(la.a.backspace,ja.a.view,Bb);Ub.Qb(la.a.backspace,1124);Ub.ka(la.a.Epa,ja.a.Ub,f.ActionManager.lX);Ub.ka(la.a.Epa,ja.a.xc,yb);Ub.ka(la.a.Epa,ja.a.endOfParagraph,f.ActionManager.lX);Ub.ka(la.a.Epa,ja.a.outline,fb);Ub.ka(la.a.Epa,ja.a.view,Bb);Ub.Aa(la.a.lsd,ja.a.view,Bb,1124);Ub.ka(la.a.lF,ja.a.Ub,yb);Ub.ka(la.a.lF,ja.a.xc,yb);Ub.ka(la.a.lF,ja.a.endOfParagraph,f.ActionManager.lX);Ub.ka(la.a.lF,ja.a.outline,fb);Ub.ka(la.a.lF,ja.a.view,Bb);Ub.Qb(la.a.lF,1124);Ub.Aa(la.a.qVe,ja.a.view,
Bb,1124);Ub.Aa(la.a.Uha,ja.a.view,ia.Uha,1028)}XIf(){}aXe(Ub,Bb,fb,yb,Wb){return this.Pbj.aXe(Ub,Bb,fb,yb,Wb)}static get Ag(){return L.PageNavigator.instance}static get Wf(){return ia.Vd||(ia.Vd=k.a.instance.resolve("Box4.IOutlineElementEditor"))}static get BK(){return ia.NH||(ia.NH=k.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get vC(){return ia.Do||(ia.Do=k.a.instance.resolve("Box4.IOutlineEditor"))}static get Ua(){return ia.Na||(ia.Na=k.a.instance.ra("Box4.IFeatureHelper"))}static Uha(Ub,
Bb,fb,yb,Wb){yb=Bb.view;if(!yb.Ma||!yb.Ma.Ca.Fa||M.SelectionEditor.Cl(yb.Ma.Ca.Fa))return 8;if(1===fb)return 32;fb=yb.Ma.Ca;const Xb=fb.Fa;var Cc=Xb.sa,Bc=null,pd=!1;if(fb.VG){if(Cc.contextId===ja.a.outline&&1===fb.length){for(Ub=l.GraphIterator.va(Cc.node);Ub.Xc();)Ub.xf();ia.vC.t_(Ub,!0);J.OutlineElementNavigator.Fd(Ub);Ub=Q.SelectionFactory.vd(Ub.currentNode,0);yb.Ma.setSelection(Ub);return 32}var zd=Cc.node;Bc=null;if(Ba.c(Cc)){var Jd=zd.Sd(yb.gb);Jd&&(Jd=Jd.hbo)&&0<=Jd.width&&0<=Jd.height&&(Bc=
new H.a(u.a.ym(Jd.x,0),u.a.ym(Jd.y,1)));Bc||(Bc=Z.a(zd))}else Bc=Z.a(Cc.node);Cc=l.GraphIterator.va(Cc.node);Cc.fn();ia.Ag.STc(Cc);zd=ia.BK.Nrd(Cc);Z.b(zd,Bc.x,Bc.y);ia.vC.t_(Cc,!0);Bc=Q.SelectionFactory.en(zd,!0)}else if(1===fb.length){pd=fb.last;Cc=ca.a.eub(pd);if(ia.Ua&&ia.Ua.isFeatureEnabled(39)&&A.ContextSetEditor.instance.RTf(Cc).returnValue)return 2;pd=pd.Pb;pd=!fb.kv&&(M.SelectionEditor.mj(pd)||R.ParagraphReader.Wk(pd)||M.SelectionEditor.l4(pd))}pd&&(pd=M.SelectionEditor.Ri(Xb,!1,!1,void 0,
!1),yb.Ma.setSelection(pd),x.AFrameworkApplication.pa.Le(Bb,la.a.hA,2,!1,null,Wb),Bc=yb.Ma.Ca.Fa,yb.Ma.setSelection(Xb));Wb||(Wb=new w.DictionaryPropertySet);Wb.setValue(F.a.Wzc,!0);x.AFrameworkApplication.pa.Le(Bb,la.a.lF,2,!0,null,Wb);if(Bc&&Bc.sa.Nc)return yb.Ma.setSelection(Bc),32;fb.VG&&W.instance.YZh(Ub,Bb.lm,yb);M.SelectionEditor.Cl(yb.Ma.Ca.Fa)||x.AFrameworkApplication.pa.Le(Bb,la.a.hA,2,!1,null,Wb);return 32}static vrk(Ub,Bb){if(1===Bb)return 32;Bb=new m.GraphTransaction(7);Bb.Oa(Ub);ia.Wf.b_a(Ub);
Bb.dispose();return 32}}ia.NH=null;ia.Vd=null;ia.Do=null;ia.Na=null;Object(G.a)(ia,"ADeleteActor",null,[]);var oa=b(18),ha=b(12),pa=b(161),Ea=b(1321),Fa=b(233);class Ga{Mqk(Ub,Bb,fb){({DeleteActor:Ub}=b(1403));if(1===fb)return 32;fb=ha.App.oa.Qo.Pe("ModelUpdate","DeleteAnchoredObject");Bb=Bb.node;const yb=new l.GraphIterator;yb.set(Bb);yb.La(12);const Wb=yb.yo(12);if(Ga.Sf.OJc(Wb))return 2;Ub.RSb(Wb);Ub=new m.GraphTransaction(7);Ub.Oa(Bb);yb.xf();Ub.dispose();fb.stop();return 32}static get Sf(){return Fa.a.instance}}
Object(G.a)(Ga,"DeleteAnchoredObjectStrategy",null,[]);var $a=b(51),fa=b(16),sa=b(246),qa=b(69),va=b(109),Ca=b(636);class ta{get Sf(){return Fa.a.instance}Brk(Ub,Bb,fb,yb,Wb){if(1===fb)return 32;yb=Ub===la.a.backspace;if(this.Sf.ag){if(this.Sf.HSh(Bb)&&ta.Ktb&&(fb=Bb.clone(),fb.$a+=1,--fb.Qa,this.Sf.I3b(fb)))return ta.Ktb.vpi([fb]),32;if(this.Sf.ikf(Bb,yb))return 2}if(ta.gv()&&ta.gv().instance&&ta.gv().instance.JR(Bb))return 4;var Xb=Bb.node;let Cc=Bb.cpBegin;fb=Bb.cpEnd;let Bc=Bb.Qa,pd=Bb.$a;const zd=
R.ParagraphReader.text(Xb),Jd=zd.length;let Ue=!1;if(Cc===fb){if(yb&&!Cc||!yb&&Cc===Jd)return 2;yb?({cp:Cc,returnValue:Ue}=this.Sf.p6h(Xb,Cc),Ue||({cp:Cc,wha:Bc,returnValue:Ue}=this.Sf.o6h(Bb,Cc,Bc)),Ue||(Cc--,fa.a.jx(zd,Cc)&&Cc--),Ub=la.a.NLe):({cp:fb,returnValue:Ue}=this.Sf.efm(Xb,fb),Ue||({cp:fb,wha:pd,returnValue:Ue}=this.Sf.dfm(Bb,fb,pd)),Ue||(fb++,fa.a.jx(zd,fb)&&fb++),Ub=la.a.hch)}Bb=Cc===fb?V.a.Sb(Xb,Cc):V.a.createTextRange(Xb,Cc,fb);Ue&&this.Sf.ag&&(yb?Bb.Qa=Bc:Bb.$a=pd);if(!this.Sf.I3b(Bb))return 2;
this.RSb(Xb);yb=new m.GraphTransaction(15);yb.ql=Ub;yb.Oa(Xb);Xb=Object(sa.a)(Ca.a,Wb)&&Wb.oVa;if(ta.hd.Bf&&!Xb){Xb=ta.hd.iTa();try{const Sc=ta.Wg.YWc(Bb);let kc;if(({type:kc}=Sc.NCd(kc)).returnValue){const Pc=Object(qa.a)(95,Wb);Pc&&Pc.ia(va.a.oif,!1)||4===kc?ta.hd.AZa=kc:ta.hd.Xq(kc)}Wb=0;for(let Pc=Sc.length-1;0<=Pc;--Pc){let Rd;const le=({DKd:Rd}=Sc.getContext(Pc)).returnValue;Rd?(ta.hyperlinkEditor.Aeb(le,null),Wb+=ta.Xj.nhb(le,2),ta.Xj.prd=fb+Wb):this.uch(le)}}finally{Xb&&Xb.dispose()}}else this.uch(Bb);
yb.dispose();return 32}RSb(){}static get hd(){return ta.Bb||(ta.Bb=k.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Xj(){return ta.rf||(ta.rf=k.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Wg(){return ta.zq||(ta.zq=k.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return ta.Oi||(ta.Oi=k.a.instance.resolve("Box4.IHyperlinkEditor"))}static gv(){return ta.vl||(ta.vl=
k.a.instance.za("Box4.IExternalSelectionManager"))}static get Ktb(){ta.nmb||(ta.nmb=k.a.instance.za("Box4.ContentControl.IContentControlOperator"));return ta.nmb.instance}}ta.Bb=null;ta.rf=null;ta.zq=null;ta.Oi=null;ta.vl=null;ta.nmb=null;Object(G.a)(ta,"ADeleteParagraphContentStrategy",null,[]);var Wa=b(174),Za=b(726),Ya=b(218),Ka=b(88),xa=b(76),Sa=b(78);class pb extends ta{constructor(){super();this.mn=this.Gz=this.Ao=this.Tb=null}get characterPropertiesEditor(){return this.Tb||(this.Tb=k.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get ap(){return this.Ao||
(this.Ao=k.a.instance.za("Box4.ContentControlConfigSettings"))}get B5b(){return this.Gz||(this.Gz=k.a.instance.resolve("Box4.Proofing.IModifiedRangeEditor"))}get lpa(){return this.mn||(this.mn=k.a.instance.resolve("Box4.IContentControlChpHelper"))}uch(Ub){this.Rqk(Ub)}LKj(Ub,Bb,fb,yb){this.ap.instance&&this.ap.instance.ag&&(Ub.cpBegin===Bb.cpBegin?Ub.Qa=Bb.Qa:fb&&(Ub.Qa=fb.Wa&&fb.Wa.length?0:-1),Ub.$a=yb)}RSb(Ub){const {DeleteActor:Bb}=b(1403);Bb.RSb(Ub)}Rqk(Ub){var Bb=Ub.node;const fb=Ya.b([new Wa.a(Ub.cpBegin,
Ub.cpEnd)],this.mkl(Ub));var yb=new Sa.a,Wb=[];pb.f9j(Bb,fb,yb,Wb);for(let Xb of yb.keys)1<yb.J(Xb)&&Za.a.K9h($a.a.Ee(Xb));this.PVm(Bb,Wb);this.B5b.Cwc(Bb);Bb=Ub.$a;yb=!!this.ap.instance&&this.ap.instance.ag;for(Wb=fb.length-1;0<=Wb;Wb--)Bb=this.deleteRange(Ub,fb[Wb],Bb,yb)}mkl(Ub){const Bb=[],fb=Ub.node;var yb=Ka.f(fb,Cc=>Cc.uha);for(var Wb of yb)yb=Wb.Xa.cp,Bb.push(new Wa.a(yb,yb+1));Wb=R.ParagraphReader.ZIa(fb);for(var Xb of Wb)Xb.AU&&pb.RKl(Xb,Ub)||Bb.push(Xb);Xb=!!this.ap.instance&&this.ap.instance.sja;
this.ap.instance&&this.ap.instance.ag||!Xb||!fb.vw||(pb.s6g&&pb.s6g.RUm(Ub),this.lpa&&Bb.push(...this.lpa.r6e(fb).toArray()));return Ya.a(Bb)}PVm(Ub,Bb){const fb=new xa.a;for(let yb of Bb)for(Bb=0;Bb<yb.length;){Bb=this.uwh(yb,Bb,0);if(-1===Bb)break;let Wb=this.uwh(yb,Bb+1,3);if(-1===Wb)break;if(yb.J(Bb).AU)for(;Wb>=Bb;){const Xb=yb.J(Wb);fb.add(Xb.zd);yb.remove(Xb);Wb--}Bb=Wb+1}Ub.Rka(oa.a.instance.J(6),fb)}uwh(Ub,Bb,fb){for(;Bb<Ub.length;Bb++){const yb=Ub.J(Bb);if(1===yb.XO&&yb.Mk===fb)return Bb}return-1}deleteRange(Ub,
Bb,fb,yb){let Wb=Bb.begin,Xb=Bb.end;Bb=null;yb&&(Bb=Ub.node.la.$g(Wb));Wb<Xb&&(yb=V.a.createTextRange(Ub.node,Wb,Xb),this.LKj(yb,Ub,Bb,fb),this.characterPropertiesEditor.replaceTextRange(yb,"",void 0,void 0,la.a.Ruc));return fb=Bb&&Bb.Wa&&Bb.Wa.length?Bb.Wa.length:-1}static get s6g(){return pb.Hl||(pb.Hl=k.a.instance.ra("WordEditor.ContentControl.IContentControlOperator"))}static RKl(Ub,Bb){return Ub.begin>=Bb.cpBegin&&Ub.end<=Bb.cpEnd}static f9j(Ub,Bb,fb,yb){let Wb=0;Ub=Ub.la;for(let Xb of Bb)for(;Wb<
Ub.length;){Bb=Ub.J(Wb);if(Bb.cp>=Xb.begin&&Bb.cp<Xb.end&&(Bb.je&&Bb.je.sck&&yb.push(Bb.je),Bb.Nh))for(let Cc=0;Cc<Bb.Nh.length;Cc++){const Bc=Bb.Nh.J(Cc).zm.toString();fb.Ja(Bc)?fb.Z(Bc,fb.J(Bc)+1):fb.Z(Bc,1)}++Wb}}}pb.Hl=null;Object(G.a)(pb,"DeleteParagraphContentStrategy",ta,[]);var Db=b(241);class Ua{static get cJ(){return Db.a.instance}static Yrk(Ub,Bb,fb){if(1===fb)return 32;Ub=Bb.node;return Ua.cJ.cod(Ub)?ia.vrk(Ub,fb):32}}Object(G.a)(Ua,"DeleteUnsupportedObjectStrategy",null,[]);var Lb=b(185),
Va=b(351),Sb=b(146),nb=b(282),La=b(8),Ha=b(66),Aa=b(903),Ma=b(40),cb=b(129),ib=b(863),Rb=b(408),Oa=b(506),lb=b(553),gb=b(763),Nb=b(175),qc=b(140),Eb=b(274),ec=b(490),Jb=b(33),vb=b(125);class xb{constructor(Ub,Bb,fb,yb){this.bVn=Ub;this.c5=fb;this.Ac=yb;this.actionId=Bb}}Object(G.a)(xb,"DeleteActionData",null,[]);var lc=b(887),Lc=b(228);class uc{get ag(){uc.Ao||(uc.Ao=k.a.instance.ra("Box4.ContentControlConfigSettings"));return uc.Ao?uc.Ao.ag:!1}KPi(Ub){return!M.SelectionEditor.tj(Ub)}P$e(Ub,Bb,fb){if(!Ub)return null;
if(!fb)return Ub;Bb=M.SelectionEditor.eVa(Ub,!Bb,{qA:!1,Cr:!0,kC:!0,uE:!0});return Q.SelectionFactory.jC(Ub,Bb.sa,!1)}fXe(Ub,Bb,fb,yb,Wb){if(1===fb)return 32;var Xb=!1;Ub===la.a.qVe&&(Ub=la.a.lF,Xb=!0);Ub===la.a.lsd&&(Ub=la.a.backspace,Xb=!0);Ub===la.a.Epa&&(Bb=new Oa.a(ha.App.oa.Da.Jb));if(!Bb.view.Cd)return 2;qc.GrippersManager.instance.uz(!1);const Cc=Ub===la.a.lF,Bc=Eb.a.Tuh(Bb);if(Xb&&this.ag&&Bc&&M.SelectionEditor.Cl(Bc)&&uc.Sf.ikf(Bc.sa,!Cc,!0))return 2;Xb=this.P$e(Bc,Cc,Xb);return this.$rk(Ub,
Bb,fb,yb,Wb,Xb,Cc)}$rk(Ub,Bb,fb,yb,Wb,Xb,Cc){const Bc=Bb.view,pd=Bc.Ma;var zd=Wb,Jd=Wb;Ub===la.a.Epa&&(Jd=zd=null,Xb=new Nb.Selection(Wb,!0));if(!Xb)return 32;const Ue=new xb(Bb,Ub,yb,Jd),Sc=this.Fmn(zd,Cc);zd=!1;if(({nJl:zd}={returnValue:!1,nJl:!1}).returnValue)return Ub=zd?la.a.deleteColumn:la.a.deleteRow,x.AFrameworkApplication.pa.Le(Bb,Ub,fb,!1,yb,Wb);if(this.ag&&uc.Ktb&&1===pd.Ca.length&&M.SelectionEditor.Cl(Xb)&&Xb.eC&&uc.Ktb.W8m(Xb.sa,Cc))return 32;let kc;Cc?Lb.a.mark(kc=5009):Lb.a.mark(kc=
5011);fb=new m.GraphTransaction(15);fb.ql=Ub;fb.Oa(Bc.sc);zd=null;let Pc=({E7m:zd}=this.KWk(Ub,Wb,pd,Xb,zd)).returnValue;Jd=null;({G2d:Jd}=A.ContextSetEditor.instance.RTf(Pc)).returnValue&&(Pc=Jd);if(!Pc)return fb.dispose(),32;this.ag&&uc.Ktb&&(Jd=A.ContextSetEditor.instance.LN(Pc),uc.Ktb.vpi(Jd));this.PPi(Pc);const Rd=this.MQk(Pc,Xb,Cc);let le=null;Cc?le=new gb.a(Xb):Rd&&(le=new gb.a(Rd));Jd=!1;if(M.SelectionEditor.ke(Pc)){const Fc=lc.a.RAd(Bc.sc,Sc);uc.hj.$c(()=>{this.Oqk(Bb,yb,Wb,Pc,Cc,le,Xb,Fc,
pd,Sc,Ue,Rd)},"DVS:DAIPC")}else uc.hd.Bf?(this.CFn(Ub,Bc.sc,Pc,Cc,Xb,pd,Sc,Ue,le),Jd=!0):Jd=this.uhi(Ub,Bc.sc,Pc,pd,Sc,Ue,le,zd);uc.DKk(pd);this.sui(Pc);fb.dispose();Lb.a.mark(kc+1);return Ub===la.a.Epa?Jd?32:8:32}uhi(Ub,Bb,fb,yb,Wb,Xb,Cc,Bc){Bb=lc.a.RAd(Bb,Wb);this.KPi(fb)&&Bb.X0a(fb);Ub=uc.Kb.Tm(Ub);Ub.properties.Z("CountOfParagraphsDeleted",uc.eo.YSe(fb).toString());fb=uc.Lvk(uc.Omn,Object(r.a)(this,this.Nmn,"shouldDispatchNoSpecialize"),fb,yb,Wb,Bb,Xb,Cc,Bc);Ub.end();return fb}CFn(Ub,Bb,fb,yb,
Wb,Xb,Cc,Bc,pd){var zd=0,Jd=null;const Ue=A.ContextSetEditor.instance.LN(fb),Sc=Ue[Ue.length-1];if(Sc.contextId===ja.a.paragraph||Sc.contextId===ja.a.endOfParagraph){var kc=l.GraphIterator.va(Sc.node);kc.nc();J.OutlineElementNavigator.Wc(kc);J.OutlineElementNavigator.Ir(kc,!0,!1)&&(Jd=J.OutlineElementNavigator.Fd(kc))&&(zd=uc.eo.textLength(Jd))}else zd=uc.eo.textLength(Sc.node)-Sc.cpEnd;kc=Object(qa.a)(95,Bc.Ac);if(kc=!!kc&&kc.ia(va.a.oif,!1))this.shi(Ub,Bb,fb,Xb,Cc,Bc,pd,!1,kc);else{kc=uc.hd.iTa();
try{this.shi(Ub,Bb,fb,Xb,Cc,Bc,pd,!0)}finally{kc&&kc.dispose()}}if(yb){if(fb.Iv){Ub=Ue.length-1;do Wb=Ue[Ub],Ub--;while(!Wb.node.isConnected&&0<=Ub)}else Wb=fb;if(!uc.eo.tb(Wb.node))return;switch(Sc.contextId){case ja.a.paragraph:case ja.a.endOfParagraph:zd=Jd&&Jd.isConnected?0:zd;break;case ja.a.Ub:case ja.a.xc:break;default:zd=0}zd=Q.SelectionFactory.vd(Wb.node,uc.eo.textLength(Wb.node)-zd);Wb.Xl===zd.sa.cpBegin&&(zd.sa.Qa=Wb.Qa)}else{zd=Wb.sa.node;if(!uc.eo.tb(zd))return;Jd=Wb.sa.contextId===ja.a.paragraph?
0:Wb.sa.contextId===ja.a.endOfParagraph?uc.eo.textLength(zd):Wb.sa.cpBegin;zd=Q.SelectionFactory.vd(zd,Jd)}ca.a.instance.setSelection(zd)}shi(Ub,Bb,fb,yb,Wb,Xb,Cc,Bc,pd=!1){fb=this.AOk(yb,fb);fb=uc.Wg.YWc(fb);({type:Jd}=fb.NCd(Jd)).returnValue&&(Bc&&4!==Jd?uc.hd.Xq(Jd):uc.hd.AZa=Jd);for(Bc=fb.length-1;0<=Bc;--Bc){var zd=void 0;var Jd=({DKd:zd}=fb.getContext(Bc)).returnValue;zd?(zd=pd&&Jd.contextId===ja.a.endOfParagraph&&Bc===fb.length-1,uc.hyperlinkEditor.Aeb(Jd,2),zd||uc.Xj.nhb(Jd,2)):this.uhi(Ub,
Bb,Jd,yb,Wb,Xb,Cc,null)}}AOk(Ub,Bb){if(Object(sa.a)(Rb.a,Bb)){Ub=lb.OutlineElementGeneralizer.xia(Ub.Ca,!0);for(let fb=0;fb<Ub.length;fb++)if(Ub.getContext(fb).contextId===ja.a.table)return Ub}return Bb}KWk(Ub,Bb,fb,yb,Wb){Ub===la.a.Epa?(Ub=Va.a.mxa(Bb),Wb=ec.SelectionReferenceFactory.instance.jub()):(Wb=null,Ub=1===fb.Ca.length?ca.a.eub(yb):fb.If);return{returnValue:Ub,E7m:Wb}}Y0j(Ub){return!Ub.Kk||Ub.contextId!==ja.a.paragraph||!uc.eo.tb(Ub.node)||uc.hd.Bf||uc.Sf.BJd(Ub)?!1:!0}PPi(Ub){if(Ub.Iv)for(let Bb=
0;Bb<Ub.length;Bb++)this.PPi(Ub.getContext(Bb));else this.Y0j(Ub)&&(Ub.node.dod=!0)}sui(Ub){if(Ub.Iv)for(let Bb=0;Bb<Ub.length;Bb++)this.sui(Ub.getContext(Bb));else Ub.Kk&&(Ub=Ub.node)&&uc.eo.tb(Ub)&&(Ub.dod=!1)}Oqk(Ub,Bb,fb,yb,Wb,Xb,Cc,Bc,pd,zd,Jd,Ue){const Sc=new l.GraphIterator,kc=yb.node;Sc.set(kc);Sc.nc();!M.SelectionEditor.gz(Sc.currentNode,yb,Wb)||uc.Sf.ag&&uc.Sf.HSh(yb)?uc.qrk(yb,Wb,Xb,Cc,Bc,pd,zd,Jd):this.prk(Ub,Bb,fb,yb,Wb,Xb,Cc,Bc,pd,Jd,Ue,Sc,kc)}Ypl(Ub,Bb,fb,yb,Wb){if(Ub||!Ha.ListReader.Pg(Bb))return{returnValue:!1,
response:Wb};Lc.a.cV&&(yb.Ac||(yb.Ac=new w.DictionaryPropertySet),yb.Ac.setValue(va.a.Uja,"delete"),yb.Ac.setValue(va.a.fda,"backspace"));Ub=ib.a.sXl;if(null===Ub||void 0===Ub?0:Ub.VQl(Bb,uc.Yb)){Lc.a.cV&&yb.Ac.setValue(va.a.fda,"backspace-autocorrect");Wb=Ub.sQi+" ";let Xb=V.a.Sb(fb,0);uc.characterPropertiesEditor.replaceTextRange(Xb,Wb);fb=Q.SelectionFactory.vd(fb,Wb.length);ca.a.instance.setSelection(fb);La.ULS.sendTraceTag(540386467,393,50,"Unlisted list with trigger string: {0}",Ub.sQi)}Wb=uc.Ska(Bb,
yb);return{returnValue:!0,response:Wb}}Kpl(Ub,Bb,fb,yb,Wb,Xb){return!Ub&&0<Ma.OutlineElementReader.n0(Bb)?(Xb=x.AFrameworkApplication.pa.Le(fb,la.a.S8b,2,!1,yb,Wb),{returnValue:!0,response:Xb}):{returnValue:!1,response:Xb}}Irl(Ub,Bb,fb,yb,Wb,Xb){return!Ub&&0<Ma.OutlineElementReader.sI(Bb)?(Xb=x.AFrameworkApplication.pa.Le(fb,la.a.GSc,2,!1,yb,Wb),{returnValue:!0,response:Xb}):{returnValue:!1,response:Xb}}Dql(Ub,Bb,fb,yb,Wb,Xb){return!Ub&&uc.Zn.Xsb(Bb)?(Xb=x.AFrameworkApplication.pa.Le(fb,la.a.lE,2,
!1,yb,Wb),{returnValue:!0,response:Xb}):{returnValue:!1,response:Xb}}nol(Ub,Bb,fb,yb,Wb,Xb,Cc,Bc,pd,zd){const Jd=new cb.a;Jd.Wb(Bb);return J.OutlineElementNavigator.yAa(Jd,!1,!Ub,!1)?(zd=!0,pd=32,(new l.GraphIterator).Wb(Jd),J.OutlineElementNavigator.Fd(Jd),Xb&&yb&&M.SelectionEditor.l4(yb.sa)?(fb.X0a(Wb),J.OutlineElementNavigator.Fd(Bb),uc.Wf.b_a(Bb.currentNode)):Jd.currentNode.BI?(fb.X0a(Wb),J.OutlineElementNavigator.Wc(Jd),Jd.xf()):Ub&&Xb?uc.Sf.aVh(Cc)&&!({sla:zd}=this.Uji(Ub,Cc,Jd.currentNode,
yb,zd)).returnValue&&(fb.X0a(Wb),uc.Oo.Ska(Bb),this.etd&&this.etd.FDm(Cc),Bb.xf()):Jb.TableReader.isTable(Jd)?(fb.X0a(Wb),this.Ech&&({response:pd,returnValue:zd}=this.Ech.Qqk(Ub,Jd,Bc))):uc.eo.tb(Jd.currentNode)&&(Xb=Ka.e(Jd.currentNode),1==Xb.length&&8==Xb[0].nh&&1==uc.eo.textLength(Jd.currentNode)&&(Xb=V.a.createTextRange(Jd.currentNode,0,1),uc.characterPropertiesEditor.replaceTextRange(Xb,"",void 0,void 0,la.a.Ruc)),({sla:zd}=this.Uji(Ub,Cc,Jd.currentNode,yb,zd)).returnValue||this.etd&&this.etd.Pqk(Ub,
fb,Wb,Bb,Cc,Jd)),{returnValue:!0,response:pd,sla:zd}):{returnValue:!1,response:pd,sla:zd}}Uji(Ub,Bb,fb,yb,Wb){if(uc.hd.Bf){if(uc.mpa){const Xb=Object(sa.a)(vb.AParagraphNode,fb)?uc.mpa.QJc(fb):!1,Cc=Object(sa.a)(vb.AParagraphNode,Bb)?uc.mpa.QJc(Bb):!1;if(Xb!==Cc)return{returnValue:!1,sla:Wb};if(Cc)return this.ag&&uc.gQj(Bb,fb,Ub)&&uc.hd.Xq(4),{returnValue:!1,sla:Wb}}Ub=Ub?Bb:fb;if(!Object(sa.a)(vb.AParagraphNode,Ub))return{returnValue:!1,sla:Wb};Bb=Ub.la.last;fb=x.AFrameworkApplication.userName;if(!Bb.Xh||
Bb.Xh.authorName!==fb)return uc.Xj.oGb(Ub,2),yb&&(ca.a.instance.setSelection(yb),Wb=!1),{returnValue:!0,sla:Wb}}return{returnValue:!1,sla:Wb}}Tpl(Ub,Bb,fb,yb,Wb,Xb,Cc,Bc){Ma.OutlineElementReader.gLl(Bb,Ub)||({response:Cc,sla:Bc}=uc.Ewk(fb,yb,Ub,Xb,Wb,Cc,Bc));return{returnValue:!1,response:Cc,sla:Bc}}prk(Ub,Bb,fb,yb,Wb,Xb,Cc,Bc,pd,zd,Jd,Ue,Sc){let kc=!1,Pc=2;const Rd=uc.eo.isEmpty(Ue),le=Ue.currentNode;J.OutlineElementNavigator.Wc(Ue);({response:Pc}=this.Ypl(Wb,Ue,le,zd,Pc)).returnValue||({response:Pc}=
this.Kpl(Wb,Ue,Ub,Bb,fb,Pc)).returnValue||({response:Pc}=this.Irl(Wb,Ue,Ub,Bb,fb,Pc)).returnValue||({response:Pc}=this.Dql(Wb,Ue,Ub,Bb,fb,Pc)).returnValue||({response:Pc,sla:kc}=this.nol(Wb,Ue,Bc,Jd,yb,Rd,Sc,pd,Pc,kc)).returnValue||({response:Pc,sla:kc}=this.Tpl(Wb,Ue,Bb,fb,Bc,Cc,Pc,kc));uc.l8h(Bc,32===Pc);kc&&uc.Uka(pd,Xb)}Fmn(Ub,Bb){return Ub&&Ub.hasProperty(F.a.Wzc)?!Ub.ia(F.a.Wzc,!1):this.EYk(Bb)}static get characterPropertiesEditor(){return uc.Tb||(uc.Tb=k.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Yb(){return uc.zc||
(uc.zc=k.a.instance.resolve("Box4.List.IListReader"))}static get eo(){return uc.Ba||(uc.Ba=k.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return uc.Oi||(uc.Oi=k.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Oo(){return uc.Un||(uc.Un=k.a.instance.resolve("Box4.List.IListEditor"))}static get Wf(){return uc.Iyg||(uc.Iyg=k.a.instance.resolve("Box4.IOutlineElementEditor"))}static get cJ(){return Db.a.instance}static get Zn(){return Aa.a.uxb}static get hd(){return uc.Bb||
(uc.Bb=k.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Xj(){return uc.rf||(uc.rf=k.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Wg(){return uc.zq||(uc.zq=k.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get Kb(){return Sb.a.instance}static get Sf(){return Fa.a.instance}static get Ktb(){uc.nmb||(uc.nmb=k.a.instance.za("Box4.ContentControl.IContentControlOperator"));return uc.nmb.instance}static get mpa(){return uc.Rf||
(uc.Rf=k.a.instance.ra("Box4.IContentControlReader"))}static get jK(){return uc.sT||(uc.sT=k.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get hj(){return nb.a.instance}static DKk(Ub){if(1===Ub.Ca.length&&(Ub=Ub.Ca.J(0),M.SelectionEditor.Cl(Ub))){var Bb=Ub.sa;Ub=Bb.node;Bb=Bb.cpBegin;var fb=uc.eo.text(Ub);Bb<fb.length&&0<Bb&&" "===fb.charAt(Bb-1)&&" "===fb.charAt(Bb)&&uc.characterPropertiesEditor.replaceTextRange(V.a.createTextRange(Ub,Bb-1,Bb),"\u00a0")}}static vSj(Ub,Bb){if(!Bb.hyperlink.G2b){const fb=
new m.GraphTransaction(15);try{fb.Oa(Ub.node),uc.jK.jP(Ub,Bb)}finally{fb&&fb.dispose()}Bb.hyperlink.aE&&uc.hd.Xq(2)}}static Ska(Ub,Bb){Ub=uc.Yb.Op(Ub).nq?la.a.RF:la.a.Ay;return x.AFrameworkApplication.pa.Le(Bb.bVn,Ub,2,!1,Bb.c5,Bb.Ac)}static Ewk(Ub,Bb,fb,yb,Wb,Xb,Cc){if(fb=M.SelectionEditor.eVa(yb,!fb,{qA:!1,Cr:!1,kC:!1,uE:!0})){yb=Q.SelectionFactory.jC(yb,fb.sa);Xb=32;for(fb=0;fb<yb.length;++fb){Wb.X0a(yb.J(fb));const Bc=x.AFrameworkApplication.pa.Le(yb.J(fb),la.a.lF,2,!0,Ub,Bb);2!==Bc&&(Xb=Bc)}32===
Xb&&(Cc=!0)}return{response:Xb,sla:Cc}}static Lvk(Ub,Bb,fb,yb,Wb,Xb,Cc,Bc,pd){let zd=!1;Ub(fb)?(zd=uc.qYe(fb,!0,yb,Wb,Xb,Cc))&&uc.WCa(Bc,yb,pd):Bb(fb)?(zd=uc.qYe(fb,!1,yb,Wb,Xb,Cc))&&uc.WCa(Bc,yb,pd):(Xb.normalize(),uc.WCa(Bc,yb,pd));return zd}static WCa(Ub,Bb,fb){fb&&fb.Uka()||uc.Uka(Bb,Ub)}static qYe(Ub,Bb,fb,yb,Wb,Xb){yb||N.OutlineReader.nKa(Ub)||(fb=uc.gZc(fb))&&Wb.rjn(fb);Ub=32===x.AFrameworkApplication.pa.Le(Ub,Xb.actionId,2,Bb,Xb.c5,Xb.Ac);uc.l8h(Wb,Ub);return Ub}static l8h(Ub,Bb){Bb?Ub.normalize():
Ub.cancel()}static Uka(Ub,Bb){Bb&&(Bb=Bb.restore())&&Ub.setSelection(Bb)}static qrk(Ub,Bb,fb,yb,Wb,Xb,Cc,Bc){let pd;!Bb&&({hyperlink:pd}=uc.jK.I2b(Ub)).returnValue?(fb=new gb.a(yb),uc.vSj(Ub,pd),Wb.normalize(),uc.Uka(Xb,fb)):uc.qYe(Ub,!1,Xb,Cc,Wb,Bc)&&(Bb&&uc.hd.Bf?(Bb=uc.Xj.prd)?(Xb.setSelection(Q.SelectionFactory.vd(Ub.node,Bb)),uc.Xj.prd=null):uc.Uka(Xb,fb):uc.Uka(Xb,fb))}static gQj(Ub,Bb,fb){fb?(fb=Ub,Ub=Bb):fb=Bb;Bb=uc.mpa.d3b(fb,!1);Ub=uc.mpa.d3b(Ub,!0);return!(Bb&&Ub)}static Omn(Ub){return Ub.Iv||
N.OutlineReader.nKa(Ub)||uc.eo.Wk(Ub)}static gZc(Ub){return(Ub=lb.OutlineElementGeneralizer.xia(Ub.Ca,!0))&&1===Ub.length&&(Ub=Ub.getContext(0).node,Jb.TableReader.gV(Ub))?Ub:null}}uc.zc=null;uc.Tb=null;uc.Iyg=null;uc.Ba=null;uc.Oi=null;uc.Un=null;uc.Bb=null;uc.rf=null;uc.zq=null;uc.nmb=null;uc.Rf=null;uc.Ao=null;uc.sT=null;Object(G.a)(uc,"ADeleteViewStrategy",null,[]);class od{Pqk(Ub,Bb,fb,yb,Wb,Xb){const Cc=Xb.currentNode;J.OutlineElementNavigator.Wc(Xb);Ub?(Bb.QPi(Xb.currentNode),od.Sf.PTh(fb,
Wb,Cc,!1)||od.Wf.merge(yb,Xb,!1,!1)):od.Sf.PTh(fb,Cc,Wb,!0)||od.Wf.merge(Xb,yb,!1,!1)}FDm(Ub){Ub&&R.ParagraphReader.tb(Ub)&&(Ea.a.BSc(Ub),od.Pyk.aJe(Ub))}static get Wf(){return od.Vd||(od.Vd=k.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Pyk(){return od.oMb||(od.oMb=k.a.instance.resolve("Box4.IDynamicRangeEditor"))}static get Sf(){return Fa.a.instance}}od.Vd=null;od.oMb=null;Object(G.a)(od,"DeleteParagraphNodeStrategy",null,[559]);class Cb{Qqk(Ub,Bb,fb){Ub&&(aa.moveToFirstRow(Bb),
aa.moveToFirstColumn(Bb),O.OutlineNavigator.I4(Bb),J.OutlineElementNavigator.Fd(Bb),fb.setSelection((new gb.a(Q.SelectionFactory.vd(Bb.currentNode,0))).restore()));return{returnValue:!1,response:2}}}Object(G.a)(Cb,"DeleteTableStrategy",null,[560]);class gc extends uc{constructor(){super();this.Sbj=new Cb;this.Rbj=new od}get Ech(){return this.Sbj}get etd(){return this.Rbj}KPi(Ub){return!M.SelectionEditor.tj(Ub)&&!M.SelectionEditor.K8(Ub)}P$e(Ub,Bb,fb){let yb,Wb,Xb,Cc;return!Bb&&Ub&&Ub.eC&&(yb=Ub.sa)&&
M.SelectionEditor.ke(yb)&&R.ParagraphReader.tb(yb.node)&&(Wb=yb.node.la.$g(yb.cpBegin))&&Wb.Lk&&(Xb=gc.SUk(Wb))&&Xb.hyperlink.aE&&(Cc=gc.nfl(Ub,Xb.cp))?Cc:super.P$e(Ub,Bb,fb)}Nmn(Ub){return M.SelectionEditor.tj(Ub)||gc.vLn.VXh(Ub)||M.SelectionEditor.K8(Ub)}EYk(Ub){return!Ub}MQk(Ub,Bb,fb){if(Ub.Kk&&M.SelectionEditor.ke(Ub)&&!fb){const yb=Ub.node;let Wb=Ub.cpBegin,Xb=-1;if(({cp:Wb}=gc.upf.p6h(yb,Wb)).returnValue)return Q.SelectionFactory.vd(yb,Wb);if(({cp:Wb,wha:Xb}=gc.upf.o6h(Ub,Wb,Xb)).returnValue)return Bb=
Q.SelectionFactory.vd(yb,Wb),Bb.sa.Qa=Xb,Bb.sa.$a=Xb,Bb}Bb=M.SelectionEditor.eVa(Bb,!fb,{qA:!0,Cr:!1,kC:!1,uE:!0});gc.upf.ag&&M.SelectionEditor.tj(Ub)&&(Bb.sa.$a=Bb.sa.Qa=fb?Ub.$a:Ub.Qa);return Bb}static get vLn(){return Db.a.instance}static get upf(){return Fa.a.instance}static SUk(Ub){const Bb=Ub.paragraph.la;let fb=null;Ub=Ub.cp;for(let yb=0;yb<Bb.length;yb++){const Wb=Bb.J(yb);if(Wb.cp>=Ub)break;Wb.Lk&&(fb=null);Wb.hyperlink&&(fb=Wb)}return fb}static nfl(Ub,Bb){var fb=M.SelectionEditor.jya(Ub,
{qA:!1,Cr:!1,kC:!0,uE:!0});if(!fb||!fb.eC||fb.sa.node!==Ub.sa.node)return null;fb=fb.sa;if(fb.cpBegin!==fb.cpEnd)return null;const yb=R.ParagraphReader.text(fb.node);for(let Wb=fb.cpBegin-1;Wb>=Bb;Wb--)if(!fa.a.Yt(yb.charCodeAt(Wb)))return Q.SelectionFactory.jC(Ub,V.a.Sb(fb.node,Wb+1),!1);return Q.SelectionFactory.jC(Ub,V.a.Sb(fb.node,Bb),!1)}}Object(G.a)(gc,"DeleteViewStrategy",uc,[]);b.d(P,"DeleteActor",function(){return Dc});class Dc extends ia{constructor(Ub,Bb,fb,yb,Wb){super();this.Qbj=new pb;
this.Veg=new Ga;this.Tbj=new gc;this.Hl=Ub;this.Ajc=Bb;this.Mjg=fb;this.oMb=yb;this.tl=Wb}get ag(){return this.Ajc.instance?this.Ajc.instance.ag:!1}get Fch(){return this.Tbj}get tch(){return this.Qbj}XIf(Ub,Bb,fb,yb){const Wb=Ua.Yrk,Xb=Object(r.a)(this.Veg,this.Veg.Mqk,"deleteAnchoredObject");Ub.ka(la.a.backspace,ja.a.anchoredObject,Xb);Ub.ka(la.a.backspace,ja.a.unsupportedObject,Wb);Ub.ka(la.a.lF,ja.a.anchoredObject,Xb);Ub.ka(la.a.lF,ja.a.unsupportedObject,Wb);Ub.ka(la.a.backspace,ja.a.paragraph,
Object(r.a)(this,this.deleteParagraph,"deleteParagraph"));Ub.ka(la.a.lF,ja.a.paragraph,Object(r.a)(this,this.deleteParagraph,"deleteParagraph"));Ub.ka(la.a.Epa,ja.a.paragraph,Object(r.a)(this,this.deleteParagraph,"deleteParagraph"));Ub.Qb(la.a.Epa,64);super.XIf(Ub,Bb,fb,yb)}deleteParagraph(Ub,Bb){Ub=Bb.node;Ea.a.BSc(Ub);this.oMb.aJe(Ub);this.tl&&this.tl.instance&&pa.App.v8d&&this.tl.instance.Ozf(Ub);Ub.vw&&(this.Hl.QUm(Ub,!this.ag),this.ag&&this.Mjg.instance&&this.Mjg.instance.PTi(Ub));return 0}static get instance(){return Dc._instance||
(Dc._instance=new Dc(k.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),k.a.instance.za("Box4.ContentControlConfigSettings"),k.a.instance.za("Box4.IContentControlEditor"),k.a.instance.resolve("Box4.IDynamicRangeEditor"),k.a.instance.za("WordEditor.Bookmark.IBookmarkManager")))}static RSb(Ub){oa.a.instance.J(4)&&ha.App.lc.$n&&ha.App.lc.zp.aF(Ub)}}Dc._instance=null;Object(G.a)(Dc,"DeleteActor",ia,[])},1404:function(G,P,b){b.r(P);G=b(0);var k=b(8),f=b(1788),x=b(1416),u;(function(Ga){Ga[Ga.external=
0]="external";Ga[Ga.msa=1]="msa";Ga[Ga.aad=2]="aad"})(u||(u={}));Object(G.b)("AuthorityType",u);class w{}Object(G.a)(w,"OAuthResult",null,[]);class r{constructor(Ga){this.Nmj=Ga}initialize(){return Promise.resolve(0)}RMd(){return Promise.resolve(0)}Pla(){k.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new w,{IsSuccess:!0,Token:this.Nmj}))}m6d(){return Promise.resolve(Object.assign(new w,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",
ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}X3d(){return!1}NEc(){return"MockAuthTokenStrategy"}}Object(G.a)(r,"MockAuthTokenStrategy",null,[478]);var m=b(1471);class l{static get(Ga,$a,fa){if(!fa)return Ga;let sa=0;return Promise.race([Ga,new Promise(qa=>{sa=window.setTimeout(()=>{qa($a)},fa)})]).then(qa=>{window.clearTimeout(sa);return Promise.resolve(qa)}).catch(()=>{window.clearTimeout(sa);return Promise.resolve($a)})}}Object(G.a)(l,"PromiseWithTimeout",
null,[]);var z=b(2),F=b(1327);class L{constructor(Ga,$a,fa,sa,qa){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=null;this.resource=Ga;this.scope=$a;this.silentLogin=fa;this.options=sa;this.correlationId=qa}}Object(G.a)(L,"TokenRequestParameters",null,[507]);var E=b(15),A=b(23);class M{constructor(){this.uLg=null;let Ga=z.AFrameworkApplication.K.Ga(z.AFrameworkApplication.Wea),$a=z.AFrameworkApplication.K.Ga(z.AFrameworkApplication.$Zf);this.BRb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",
Ga&&""!==Ga?Ga:"Unspecified",$a&&""!==$a?$a:"Unspecified")}initialize(){return new Promise(Ga=>{A.a.instance.za("Common.App.WopiIdentity.IWopiIdentity").execute($a=>{this.uLg=$a;Ga(0)})})}fd(Ga){const $a=["HTTPS:","API:"];let fa=!1;const sa=Ga.toLocaleUpperCase();for(const qa of $a)if(sa.startsWith(qa)){fa=!0;break}return fa||this.ZLl(Ga)?Ga+"/.default":Ga}ZLl(Ga){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(Ga)}RMd(){return Promise.resolve(0)}Pla(Ga,
$a,fa,sa,qa,va,Ca){if(E.a.AKa){qa=F.a.yVn;if(!qa)return $a=Object.assign(new w,{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve($a);if(!Array.contains(qa,Ga))return $a=Object.assign(new w,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+Ga}),Promise.resolve($a)}Ga=this.fd(fa);fa=new L(fa,Ga,!sa,null,z.AFrameworkApplication.userSessionId);return this.uLg.getAccessToken(fa,$a,Ca).then(ta=>Object.assign(new w,{IsSuccess:!0,
Token:ta.accessToken}),ta=>Object.assign(new w,{IsSuccess:!1,ErrorCode:ta}))}m6d(){return Promise.resolve(Object.assign(new w,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}X3d(){return!1}NEc(){return this.BRb}}Object(G.a)(M,"ParentFrameTokenStrategy",null,[478]);var Q=b(41),R=b(1351),K=b(76);class J{constructor(){this.reject=this.resolve=null;this.startTime=0;this.Aki=this.LVg=null}}
Object(G.a)(J,"PromiseWrapper",null,[]);class O{constructor(Ga=0){this.Vv=0;this.Yoc=!1;this.ew=new K.a;this._timeout=Ga}enqueue(Ga){return new Promise(($a,fa)=>{this.ew.add(Object.assign(new J,{Aki:Ga,resolve:$a,reject:fa}));this.process()})}process(){if(this.Yoc||this.Vv===this.ew.count)return!1;const Ga=this.ew.J(this.Vv++);try{this.Yoc=!0,Ga.Aki().then($a=>{this.Yoc=!1;this.mRe(Ga,$a,null,!0)}).catch($a=>{this.Yoc=!1;this.mRe(Ga,null,$a,!1)})}catch($a){this.Yoc=!1,this.mRe(Ga,null,$a,!1)}return!0}mRe(Ga,
$a,fa,sa){if(sa){const qa=()=>{Ga.resolve($a);this.process()};0<this._timeout?window.setTimeout(()=>{qa()},this._timeout):qa()}else{const qa=()=>{Ga.reject(fa);this.process()};0<this._timeout?window.setTimeout(()=>{qa()},this._timeout):qa()}}}Object(G.a)(O,"PromiseQueue",null,[]);class N{constructor(){this.correlationId=this.resolve=null}}Object(G.a)(N,"ResolveWithCorrelation",null,[]);var V=b(69),W=b(151),ca=b(844),H=b(90);class Z extends W.a{constructor(Ga,$a,fa,sa,qa,va,Ca){super(!1,!1,!0);this.rfg=
this.oua=null;this.aoa=Ga;this.crj=fa;this.ys=sa;this.qyj=qa;this.dnb=va;this.XE=document.createElement("iframe");this.XE.id="SharedAuthInteractiveFrame";this.XE.setAttribute("name","SharedAuthInteractiveFrame");this.XE.setAttribute("title","SharedAuthInteractiveFrame");this.XE.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.XE.style.border="0";this.XE.style.height="48px";this.XE.style.width="190px";$addHandler(this.XE,"error",Object(Q.a)(this,this.Usm,"onSharedAuthFrameError"));
Ga=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.aoa,$a,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1","&WacUserType=",z.AFrameworkApplication.userType);Ca&&(Ga+="&vnext=1");this.XE.src=Ga;this.Zbj=new Promise(ta=>{this.rfg=ta});this.sfg=!1}mNa(){this.oua={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.crj,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:z.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(Q.a)(this,
this.bik,"createFrame"),["resolveDialogStyles"]:this.rfg}};this.yc=5;this.Tg(CommonUIStrings.l_SignIn,Object(Q.a)(this,this.Iln,"sharedAuthConsentDialogHandler"),this.oua)}JVi(Ga=!1,$a=5){this.oua&&this.oua.bodyControls&&(!0!==Object(V.a)(Object,this.oua.bodyControls).frameLoaded&&(Object(V.a)(Object,this.oua.bodyControls).frameLoaded=!0),Ga!==Object(V.a)(Object,this.oua.bodyControls).frameLoadSuccess&&(Object(V.a)(Object,this.oua.bodyControls).frameLoadSuccess=Ga),$a!==this.oua.dialogButtonsOption&&
(this.oua.dialogButtonsOption=null,this.yc=$a),this.update(this.oua))}vsn(Ga,$a){const fa=new ca.a(H.a.Mln);fa.Values={["signInLabel"]:CommonUIStrings.l_SignIn,["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:z.AFrameworkApplication.isRtl,["messageCorrelationId"]:Ga,["dialogStyles"]:$a};this.ys.I_a(fa,this.XE.contentWindow,this.aoa)}ioh(){this.JVi(!1,6)}get PEi(){return this.XE}get Ztk(){return this.Zbj.then(Ga=>{this.sfg=!0;return Ga})}get $tk(){return this.sfg}Usm(){this.ioh()}bik(){return this.XE}Iln(Ga){0===
Ga&&(this.qyj.reject(Object.assign(new w,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.dnb(null))}}Object(G.a)(Z,"SharedAuthConsentDialog",W.a,[506]);var aa=b(849),ja=b(79),Ba=b(105),la=b(36),ia=b(133),oa=b(295);class ha{constructor(){this.XE=null;this.O7c=0;this.WOb=this.kSb=this.wbe=this.dnb=this.c7=this.yJg=null;this.ys=new aa.a(null,null);this.sjd=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthVNext",
!1);this.BRb="SharedAuthTokenStrategy "+(this.sjd?"BrowserAuth 1.20210701.2/MSAL 2.11.0":"BrowserAuth 1.20210426.1/MSAL 2.11.0");this.aoa=F.a.Kln;this.wFg=F.a.Jln;this.Wgg=F.a.enableConsoleLogging;this.edj=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.Fvj=z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",this.sjd);this.i6a={};this.qij=new O(1500)}NEc(){return this.BRb}initialize(){var {OAuthManager:Ga}=
b(1404);if("loadFrame"in this.i6a)return this.i6a.loadFrame.LVg;if(!this.aoa)return ja.Health.instance.recordKpiFailure(Ga.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),k.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);Ga=this.B3d("loadFrame");this.O7c=la.a.ie();var $a=this.aoa+this.wFg+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+z.AFrameworkApplication.userSessionId+"&WacUserType="+z.AFrameworkApplication.userType;
this.sjd&&($a+="&vnext=1");this.XE=document.createElement("iframe");this.Jff(this.XE);this.XE.style.cssText="height:0;width:0;display:none;";this.XE.id="SharedAuthFrame";this.XE.setAttribute("name","SharedAuthFrame");this.XE.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.XE.setAttribute("title","SharedAuthFrame");this.XE.src=$a;document.body.appendChild(this.XE);$a=la.a.ie()-this.O7c;k.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",
$a,this.XE.src);return Ga}RMd(Ga){this.wbe=Ga;const $a=new ca.a(H.a.SEi);$a.Values=this.lVg(Ga);Ga=this.B3d("initFrame");this.ys.I_a($a,this.XE.contentWindow,this.aoa);k.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");return Ga}Pla(Ga,$a,fa,sa,qa,va){const Ca=new ca.a(H.a.Nln),ta=this.KBh();Ca.Values=this.mRi(Ga,$a,fa,sa,qa,va,ta);Ga=this.B3d(ta);sa&&z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",
!1)?this.qij.enqueue(()=>new Promise(Wa=>{this.SHn(va,Ca,Wa,ta)})):(this.ys.I_a(Ca,this.XE.contentWindow,this.aoa),k.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",$a));return Ga}SHn(Ga,$a,fa,sa){const qa=this.i6a[sa];qa&&(this.kSb=$a,this.dnb=Object.assign(new N,{resolve:fa,correlationId:sa}),this.c7=new Z(this.aoa,this.wFg,Ga,this.ys,qa,fa,this.sjd),this.c7.mNa())}KBh(){return ia.a.create().toString()}mRi(Ga,$a,fa,sa,qa,va,Ca){const ta={};
ta.appName=Ga;ta.appId=$a;ta.target=fa;ta.withPopup=sa;ta.claims=qa;ta.promptMessage=va;ta.messageCorrelationId=Ca;return ta}Jff(Ga){$addHandler(Ga,"load",Object(Q.a)(this,this.Gom,"onIFrameLoaded"));$addHandler(Ga,"error",Object(Q.a)(this,this.Teb,"onIFrameError"));this.ys.JSa(this.aoa);this.ys.uu(H.a.VEi);this.ys.pA(H.a.VEi,Object(Q.a)(this,this.vsm,"onScriptLoaded"));this.ys.uu(H.a.UEi);this.ys.pA(H.a.UEi,Object(Q.a)(this,this.usm,"onScriptInitialized"));this.ys.uu(H.a.QEi);this.ys.pA(H.a.QEi,
Object(Q.a)(this,this.jom,"onGetTokenResponse"));this.ys.uu(H.a.WEi);this.ys.pA(H.a.WEi,Object(Q.a)(this,this.Epm,"onLoginResponse"));this.ys.uu(H.a.TEi);this.ys.pA(H.a.TEi,Object(Q.a)(this,this.bpm,"onInteractiveFlowReady"));this.ys.uu(H.a.REi);this.ys.pA(H.a.REi,Object(Q.a)(this,this.som,"onHideDialog"));this.ys.uu(H.a.OEi);this.ys.pA(H.a.OEi,Object(Q.a)(this,this.Xxf,"onCloseDialog"))}B3d(Ga){const $a=new J;$a.startTime=la.a.ie();const fa=new Promise((sa,qa)=>{$a.resolve=sa;$a.reject=qa});$a.LVg=
fa;this.i6a[Ga]=$a;return fa}Gom(){const Ga=la.a.ie()-this.O7c;k.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",Ga)}Teb(Ga){const {OAuthManager:$a}=b(1404),fa=la.a.ie()-this.O7c,sa=Object.assign(new oa.a,{durationMs:fa});ja.Health.instance.recordKpiFailure($a.kpiName,"SharedAuthWACOAuthAspxFrameError",!1,!0,sa);k.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",fa,this.Wgg?JSON.stringify(Ga):"")}vsm(Ga){const {OAuthManager:$a}=
b(1404),fa=this.i6a.loadFrame;var sa=la.a.ie()-fa.startTime,qa=Ga.Values.AuthLibrary.toString();Ga=Ga.Values.Success.toString();k.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",Ga,qa,sa);qa&&(this.BRb="SharedAuthTokenStrategy "+qa);qa=Boolean.parse(Ga);qa||(Ga=Ba.a.AD(),void 0!==Ga&&null!==Ga&&(Ga.set("AuthLibrary",this.NEc()),sa=Object.assign(new oa.a,{durationMs:sa,extendedProperties:Ga}),ja.Health.instance.recordKpiFailure($a.kpiName,
"SharedAuthStrategyInitFailed",!1,!0,sa)));fa.resolve(qa?0:1)}usm(Ga){if(Ga.Values.interactive&&this.kSb&&this.kSb.Values.messageCorrelationId){const fa=this.kSb.Values.messageCorrelationId.toString();if(Ga.Values.interactive&&this.c7){this.c7.Ztk.then(sa=>{this.ys.I_a(this.kSb,this.c7.PEi.contentWindow,this.aoa);this.c7.vsn(fa,sa);this.c7.JVi(!0);this.kSb=null});return}}Ga=this.i6a.initFrame;const $a=la.a.ie()-Ga.startTime;k.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",
$a);Ga.resolve(0)}jom(Ga){if(Ga.Values.messageCorrelationId&&Ga.Values.messageCorrelationId.toString()){var $a=Ga.Values.messageCorrelationId.toString(),fa=this.i6a[$a];if(fa){var sa=la.a.ie()-fa.startTime;k.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",sa);Ga.Values.isSuccess&&Ga.Values.isSuccess?fa.resolve(Ga.Values.response):fa.reject(Ga.Values.response);this.HRi($a)}else k.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else k.ULS.sendTraceTag(573112904,
3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}bpm(){if(this.c7.$tk)this.c7.ioh();else if(this.wbe&&this.c7){const Ga=new ca.a(H.a.SEi);Ga.Values=this.lVg(this.wbe,!0);this.ys.I_a(Ga,this.c7.PEi.contentWindow,this.aoa)}}som(){this.c7&&this.c7.iFd()}Xxf(Ga){Ga.Values.cancelled&&Ga.Values.cancelled&&Ga.Values.messageCorrelationId&&this.HRi(Ga.Values.messageCorrelationId.toString());this.c7&&this.c7.hide()}lVg(Ga,$a=!1){const fa={};fa.appIds=this.bSk();
fa.upn=Ga.loginHint;fa.authority=Ga.authority;fa.authorityType=Object(f.a)(u,Ga.authorityType);fa.tenantId=Ga.tenantId;fa.correlationId=z.AFrameworkApplication.userSessionId;fa.enableConsoleLogging=this.Wgg;fa.enablePopupFlash=this.edj;fa.skipUpnCheck=this.Fvj;fa.interactive=$a;return fa}bSk(){const Ga=[],$a=F.a.SJe;for(let fa in $a)Array.add(Ga,$a[fa]);return Ga}m6d(Ga,$a,fa,sa,qa,va){const Ca=new ca.a(H.a.Lln),ta=this.KBh();Ca.Values=this.mRi(Ga,$a,fa,sa,qa,va,ta);this.yJg=Ca;Ga=this.B3d(ta);k.ULS.sendTraceTag(555049437,
3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",$a);this.lqn();return Ga}X3d(){return!0}lqn(){this.WOb||(this.WOb=new R.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.WOb.id=16,this.WOb.qJd=!1,this.WOb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{k.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.ys.I_a(this.yJg,this.XE.contentWindow,this.aoa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,
!0),z.AFrameworkApplication.na.Ya.MSa(this.WOb,!0)||k.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Epm(Ga){if(Ga.Values.messageCorrelationId&&Ga.Values.messageCorrelationId.toString()){var $a=this.i6a[Ga.Values.messageCorrelationId.toString()];if($a){var fa=la.a.ie()-$a.startTime;k.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",fa);Ga.Values.isSuccess&&Ga.Values.isSuccess?$a.resolve(Ga.Values.response):
$a.reject(Ga.Values.response)}else k.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else k.ULS.sendTraceTag(555049439,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}HRi(Ga){this.dnb&&this.dnb.correlationId===Ga&&(this.dnb.resolve(null),this.dnb=null)}}Object(G.a)(ha,"SharedAuthTokenStrategy",null,[478]);class pa{constructor(Ga){this.V2=Ga;this.BRb="UnsupportedAuthTokenStrategy Reason="+
x.a[this.V2]}initialize(){return Promise.resolve(0)}RMd(){return Promise.resolve(0)}Pla(){return Promise.resolve(Object.assign(new w,{IsSuccess:!1,ErrorCode:x.a[this.V2],ErrorMessage:"Unable to get a token. Reason: ["+x.a[this.V2]+"]"}))}m6d(){return Promise.resolve(Object.assign(new w,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}X3d(){return!1}NEc(){return this.BRb}}Object(G.a)(pa,
"UnsupportedAuthTokenStrategy",null,[478]);var Ea=b(1310);b.d(P,"OAuthManager",function(){return Fa});class Fa{constructor(Ga=null){this.ufa=0;this.S$=null;this.Npb=0;const $a=la.a.ie();this.Xhj=this.gtk(Ga).then(fa=>fa?this.Oyl():(k.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.oI(),Math.floor(la.a.ie()-$a)),fa=Ba.a.AD(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.oI()),fa=Object.assign(new oa.a,{durationMs:Math.floor(la.a.ie()-
$a),extendedProperties:fa}),ja.Health.instance.recordKpiFailure(Fa.kpiName,"StrategyPickFailed",!1,!0,fa)),Promise.resolve(1))).then(fa=>0!==fa?Promise.resolve(fa):this.SZl())}htk(){var Ga=F.a.pem;Ga&&0<Ga.length?(this.ufa=1,this.S$=new r(Ga)):z.AFrameworkApplication.K.$("IsO365ConsumerHost")||z.AFrameworkApplication.K.$("IsO365CommercialHost")?z.AFrameworkApplication.K.$("IsAnonymousUser")?(this.ufa=2,this.S$=new pa(this.ufa)):(Ga=m.a.getAuthContext().loginHint)&&Ga.length?F.a.yGc?(this.ufa=1,this.S$=
new M):(this.ufa=1,this.S$=new ha):(this.ufa=3,this.S$=new pa(this.ufa)):(this.ufa=4,this.S$=new pa(this.ufa))}oI(){return this.S$?this.S$.NEc()||"Unknown":"None"}gtk(Ga=null){k.ULS.sendTraceTag(562128578,3E3,50,"Creating OAuthManager.");const $a=la.a.ie();return z.AFrameworkApplication.K.A1k().then(fa=>{fa?(this.htk(),Ga&&(this.S$=Ga),k.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",F.a.clientVersion,
F.a.appVersion,F.a.txk,this.oI(),Math.floor(la.a.ie()-$a))):k.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(la.a.ie()-$a));return Promise.resolve(fa)},()=>{k.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(la.a.ie()-$a));return Promise.resolve(!1)})}Oyl(){k.ULS.sendTraceTag(573390991,
3E3,50,"Initializing {0}",this.oI());const Ga=la.a.ie();return l.get(this.S$.initialize(),2,F.a.$Ff).then($a=>{if(0===$a)k.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",this.oI(),Math.floor(la.a.ie()-Ga));else if(1===$a){k.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.oI(),Math.floor(la.a.ie()-Ga));var fa=Ba.a.AD();void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.oI()),fa=Object.assign(new oa.a,
{durationMs:Math.floor(la.a.ie()-Ga),extendedProperties:fa}),ja.Health.instance.recordKpiFailure(Fa.kpiName,"StrategyInitFailed",!1,!0,fa))}else 2===$a&&(k.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.oI(),Math.floor(la.a.ie()-Ga)),fa=Ba.a.AD(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.oI()),fa=Object.assign(new oa.a,{durationMs:Math.floor(la.a.ie()-Ga),extendedProperties:fa}),ja.Health.instance.recordKpiFailure(Fa.kpiName,
"StrategyInitTimedOut",!1,!0,fa)));return Promise.resolve($a)},()=>{k.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.oI(),Math.floor(la.a.ie()-Ga));return Promise.resolve(1)})}SZl(){k.ULS.sendTraceTag(562128581,3E3,50,"Loading {0}",this.oI());const Ga=la.a.ie();return l.get(this.S$.RMd(m.a.getAuthContext()),2,F.a.$Ff).then($a=>{if(0===$a)k.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.oI(),
Math.floor(la.a.ie()-Ga));else if(1===$a){k.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.oI(),Math.floor(la.a.ie()-Ga));var fa=Ba.a.AD();void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.oI()),fa=Object.assign(new oa.a,{durationMs:Math.floor(la.a.ie()-Ga),extendedProperties:fa}),ja.Health.instance.recordKpiFailure(Fa.kpiName,"StrategyLoadFailed",!1,!0,fa))}else 2===$a&&(k.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.oI(),Math.floor(la.a.ie()-Ga)),fa=Ba.a.AD(),void 0!==fa&&null!==fa&&(fa.set("AuthLibrary",this.oI()),fa=Object.assign(new oa.a,{durationMs:Math.floor(la.a.ie()-Ga),extendedProperties:fa}),ja.Health.instance.recordKpiFailure(Fa.kpiName,"StrategyLoadTimedOut",!1,!0,fa)));return Promise.resolve($a)},()=>{k.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.oI(),Math.floor(la.a.ie()-Ga));return Promise.resolve(1)})}Pla(Ga,$a,fa=null){return this.Jcc(Ga,
$a,!1,null,"",fa)}nRi(Ga,$a,fa,sa,qa=null){return this.Jcc(Ga,$a,!0,fa,sa,qa)}Jcc(Ga,$a,fa,sa,qa,va,Ca=0){Ca+=1;k.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",Ga,this.yFb(Ga,$a),this.oI(),Ca);var ta=Ba.a.AD();void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.oI()),ta.set("AppName",Ga),ta.set("Target",this.yFb(Ga,$a)),ja.Health.instance.recordKpiUsage(Fa.kpiName,0,"WacOAuthFC",ta));if(!F.a.isEnabled){var Wa;return this.Fpf((Wa=
new w,Wa.IsSuccess=!1,Wa.Token=null,Wa.ErrorCode="NotEnabled",Wa.ErrorMessage="OAuthManager is disabled.",Wa),Ga)}const Za=F.a.SJe[Ga];if(void 0===Za||null===Za){k.ULS.sendTraceTag(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",Ga);var Ya;return this.Fpf((Ya=new w,Ya.IsSuccess=!1,Ya.Token=null,Ya.ErrorCode="DisallowedApp",Ya.ErrorMessage="Disallowed appName: "+Ga,Ya),Ga)}const Ka=la.a.ie(),xa=this;ta=this.Xhj.then(Ua=>xa.XFl(Ga,
Za,$a,fa,sa,qa,va,Ua));Wa=fa?0:F.a.$Ff;let Sa;Ya=(Sa=new w,Sa.IsSuccess=!1,Sa.Token=null,Sa.ErrorCode="authTokenStrategy_timeout",Sa.ErrorMessage="Auth Strategy timed out after ["+Wa+"] ms when fetching token",Sa);let pb=this,Db=this;return l.get(ta,Ya,Wa).then(Ua=>Ca<=Fa.Ibm&&(Ua.ErrorCode===Fa.xOi||Ua.ErrorCode===Fa.byn)?(k.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Ca,Math.floor(la.a.ie()-Ka)),pb.Jcc(Ga,$a,fa,sa,qa,va,Ca)):Ua.ErrorCode===Fa.xYh&&
!fa&&(k.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Ca,Fa.ghh),Fa.yAk&&pb.S$.X3d()&&pb.S$.m6d(Ga,Za,$a,fa,sa,qa).then(Lb=>Promise.resolve(pb.pNd(Lb,Ga,$a,Za,Ka))).catch(()=>{let Lb;const Va=(Lb=new w,Lb.IsSuccess=!1,Lb.Token=null,Lb.ErrorCode="authTokenStrategy_failure",Lb.ErrorMessage="LoginPopup failed, GetToken could not be called",Lb);return Promise.resolve(pb.pNd(Va,Ga,$a,Za,Ka))}),Fa.ghh)?pb.Jcc(Ga,$a,!0,sa,qa,va,Ca):
Promise.resolve(pb.pNd(Ua,Ga,$a,Za,Ka))).catch(()=>{let Ua;const Lb=(Ua=new w,Ua.IsSuccess=!1,Ua.Token=null,Ua.ErrorCode="authTokenStrategy_failure",Ua.ErrorMessage="Auth Strategy failed with an unknown error",Ua);return Promise.resolve(Db.pNd(Lb,Ga,$a,Za,Ka))})}XFl(Ga,$a,fa,sa,qa,va,Ca,ta){return 1===ta||2===ta?this.Fpf(Object.assign(new w,{IsSuccess:!1,Token:null,ErrorCode:1===ta?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),Ga):this.S$.Pla(Ga,$a,fa,sa,qa,va,
Ca).then(Wa=>Promise.resolve(this.m8h(Wa,!0,Ga))).catch(Wa=>Promise.resolve(this.m8h(Wa,!1,Ga)))}pNd(Ga,$a,fa,sa,qa){const va={};qa=la.a.ie()-qa;va.IsSuccess=Ga.IsSuccess;va.ErrorCode=Ga.IsSuccess?"Success":Ga.ErrorCode||"";va.ErrorMessage=Ga.IsSuccess?"Success":this.yFb($a,Ga.ErrorMessage||"");va.Target=this.yFb($a,fa||"");va.TimeInMS=Math.floor(qa);va.AuthLibrary=this.oI();va.AppName=$a;va.AuthorityType=Object(f.a)(u,m.a.nyd());va.UserType=this.Ykl(m.a.getAuthContext());va.IsAuthSupportedInSession=
x.a[this.ufa];va.RequestCount=++this.Npb;va.AppId=sa;k.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(va));Ga.IsSuccess||(fa=Ba.a.AD(),void 0!==fa&&null!==fa&&(fa.set("AppName",$a),fa.set("AuthLibrary",this.oI()),fa.set("ErrorCode",Ga.ErrorCode),fa.set("ErrorMessage",this.yFb($a,Ga.ErrorMessage)),$a=Object.assign(new oa.a,{durationMs:qa,extendedProperties:fa}),ja.Health.instance.recordKpiFailure(Fa.kpiName,"TryGetTokenFailure",!1,!0,$a)));return Ga}Fpf(Ga,$a){k.ULS.sendTraceTag(578435090,3E3,15,
"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",$a,this.yFb($a,Ga.ErrorMessage));const fa=Ba.a.AD();void 0!==fa&&null!==fa&&(fa.set("AppName",$a),fa.set("AuthLibrary",this.oI()),fa.set("ErrorCode",Ga.ErrorCode),fa.set("ErrorMessage",this.yFb($a,Ga.ErrorMessage)),$a=Object.assign(new oa.a,{extendedProperties:fa}),ja.Health.instance.recordKpiFailure(Fa.kpiName,"FailureBeforeGetToken",!1,!0,$a));return Promise.resolve(Ga)}vSh(Ga){return Ga===Ea.a.f5d}yFb(Ga,$a){return this.vSh(Ga)&&
$a?"REDACTED":$a}Ykl(Ga){return z.AFrameworkApplication.K.$("IsAnonymousUser")?"anonymous":!Ga.loginHint||1>Ga.loginHint.length?"empty":-1<Ga.loginHint.indexOf("guest#")?"guest":-1<Ga.loginHint.indexOf("ext#")?"external":0>Ga.upn.indexOf("@")?"no-at":"supported"}SGl(){return 1===this.ufa}m8h(Ga,$a,fa){let sa=null,qa=null,va=null,Ca=null;Ga?Ga.ErrorCode||Ga.ErrorMessage?(qa=Ga.ErrorCode?Ga.ErrorCode:Fa.gjh,va=Ga.ErrorMessage?Ga.ErrorMessage:"No message"):Ga.Token?$a?sa=Ga.Token:(qa=Fa.HUm,va="A rejected promise returned a token."):
(qa=Fa.gjh,va=JSON.stringify(Ga)):(qa=Fa.chm,va="No result came from Auth Token Strategy");Ga&&Ga.Telemetry&&!this.vSh(fa)&&(Ca=Ga.Telemetry,k.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Ca)));if(qa===Fa.Kem||qa===Fa.AEn)qa=Fa.xOi,va="Auth Library Timed Out";qa===Fa.BRj&&-1<va.indexOf(Fa.vAj)&&(qa=Fa.xYh);if(qa||va)sa=null;return Object.assign(new w,{IsSuccess:!!sa,Token:sa,ErrorCode:qa,ErrorMessage:va,Telemetry:Ca})}static get ghh(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",
!1)}static get yAk(){return z.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Fa.AEn="token_renewal_error";Fa.gjh="Exception";Fa.chm="NoResult";Fa.HUm="RejectToken";Fa.Kem="monitor_window_timeout";Fa.xOi="Timeout";Fa.byn="authTokenStrategy_timeout";Fa.BRj="login_required";Fa.vAj="AADSTS50058";Fa.xYh="Cookies Disabled";Fa.kpiName="OAuthManager";Fa.Ibm=2;Object(G.a)(Fa,"OAuthManager",null,[350])},1409:function(G,P,b){G=b(0);class k{constructor(r,
m,l,z){this.Paj=r;this.Psj=m;this.Nsj=l;this.Qsj=z}get zSe(){return this.Paj}get vMf(){return this.Psj}get sMf(){return this.Nsj}get resultType(){return this.Qsj}}Object(G.a)(k,"SearchContext",null,[1045]);class f{IUe(r,m,l,z){var F=l-m;let L;if(100<=F)F=m,L=l;else{F=Math.max(0,m+Math.ceil(F/2)-50);L=Math.min(r.length,F+100);F=Math.max(0,L-100);let A;if(F&&" "!==r.charAt(F-1)){A=Math.min(m,F+10);for(var E=F;E<A;++E)if(" "===r.charAt(E)){F=E+1;break}}if(L!==r.length&&" "!==r.charAt(L))for(A=Math.max(l,
L-10),E=L-1;E>=A;--E)if(" "===r.charAt(E)){L=E;break}}r=r.substring(F,L);return new k(r,m-F,l-F,z)}Wrd(r){return this.IUe(r.vzh(),r.begin,r.end,"")}}Object(G.a)(f,"SearchContextFactory",null,[1022]);var x=b(125),u=b(1394);b.d(P,"a",function(){return w});class w extends f{constructor(){super()}Wrd(r){let m=r.begin,l=r.end;const z=({begin:m,end:l}=w.B$k(r,m,l)).returnValue;r=u.a(r.type);return this.IUe(z,m,l,r)}static get instance(){return w._instance||(w._instance=new w)}static B$k(r,m,l){r=r.vzh();
return w.gqi(r,m,l)}static gqi(r,m,l){const z=x.AParagraphNode.l1(r);if(z.length<r.length){r=r.substring(0,m);const F=x.AParagraphNode.l1(r);r=r.length-F.length;m-=r;l-=r}return{returnValue:z,begin:m,end:l}}}w._instance=null;Object(G.a)(w,"EditorSearchContextFactory",f,[])},1411:function(G,P,b){G=b(0);var k=b(2),f=b(23),x=b(302),u=b(649),w=b(24),r=b(12),m=b(120),l=b(49),z=b(644),F=b(206),L=b(248),E=b(87),A=b(30),M=b(10),Q=b(3),R=b(6),K=b(552),J=b(922);class O{create(){return new J.a}}Object(G.a)(O,
"FootnoteEndnoteContainerNodeFactory",null,[472]);var N=b(507);b.d(P,"a",function(){return V});class V{constructor(W,ca,H,Z,aa,ja,Ba,la,ia){this.ajd=null;V.ga=W;this.aD=H;this.pve=Z;this.taj=ja;this.Vb=Ba;this.ya=aa;this.Zmj=la;this.Abj=ia;V.xg=ca}bPd(W,ca){this.MBk(W);W.Za(7);this.aD.tSh(W,ca)||W.ue(7)}MBk(W){if(this.pve.VUh(W)){var ca=!1,H=!1;if(W.Za(7)){do{const Z=W.currentNode;if(37===Z.type)switch(Z.getValue(R.a.S3)){case 0:H=!0;break;case 1:ca=!0}}while(W.Fh(7))}H||this.pNg(W,0);ca||this.pNg(W,
1)}}pNg(W,ca){const H=this.taj.create(1074135124);H.setValue(R.a.S3,ca);W.Je(H,7)}l9m(W){W&&this.yyi(W.uia)}yyi(W){W&&(W=w.SelectionFactory.vd(W.Xa.paragraph,W.Xa.cp+1),this.ya.setSelection(W))}egm(W){let ca=this.Zmj(W);void 0!==ca&&null!==ca?this.aD.vja(ca)&&(ca=this.aD.Uzh(ca)):ca=W;return this.Abj(ca)}Wsn(){this.ajd?V.xg.notificationBar.removeEntry(this.ajd):this.ajd=V.xg.notificationBar.jxa(WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingUnsupportedNotification,!1);V.xg.notificationBar.Jz(this.ajd)}yOj(W,
ca){W=this.Vb.xya(W,37,37);let H=!1;if(W.Xc()){do{const Z=W.currentNode;this.aD.imf(Z)?this.eTg(Z,ca):H=!0}while(W.ni())}H&&this.Wsn()}eTg(W,ca){K.e(W,H=>{V.uNk(H,ca);return!0},12)}Dsl(W,ca){W=this.aD.Lzd(W,ca);return W?(W=this.Vb.ff(W))?W.fB():!1:!1}Kuh(W,ca){W=this.aD.Lzd(W,ca);W=this.Vb.ff(W);if(W.Xc()){do if(ca=W.currentNode,1===ca.getValue(R.a.via))return ca;while(W.ni())}return null}static yDc(){return new V(k.AFrameworkApplication.pa,r.App.oa,N.a.instance,m.PageReader.instance,l.a.instance,
new O,new z.a,F.OutlineNavigator.bgm,L.WordSectionNavigator.zWe)}static get instance(){return V._instance||(V._instance=V.yDc())}static get paragraphEditor(){return V.kh||(V.kh=f.a.instance.resolve("Box4.IParagraphEditor"))}static uNk(W,ca){ca.wbb?V.paragraphEditor.Zn.Y9(W,E.OutlineReader.XJ(W)):V.paragraphEditor.Zn.Y9(W,0);W=A.a.createTextRange(W,0,M.ParagraphReader.textLength(W));V.ga.Le(W,Q.a.font,2,!0,new x.a,new u.a(ca.fontName));V.ga.Le(W,Q.a.nv,2,!0,new x.a,new u.a(ca.fontSize))}}V.ga=null;
V.xg=null;V._instance=null;V.kh=null;Object(G.a)(V,"FootnoteEndnoteEditor",null,[599])},1416:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);var k;(function(f){f[f.unknown=0]="unknown";f[f.supported=1]="supported";f[f.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";f[f.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";f[f.hostUnsupported=4]="hostUnsupported"})(k||(k={}));Object(G.b)("SupportStatus",k)},1438:function(G,P,b){b.d(P,"a",function(){return M});G=b(0);var k=b(348),
f=b(51),x=b(23),u=b(128),w=b(8),r=b(246),m=b(69),l=b(14),z=b(104),F=b(506),L=b(125),E=b(130),A=b(10);class M{constructor(Q,R,K,J,O,N=null,V="",W=!0,ca=!1){this.dVa=this.n3d=this.Bgb=this.Fki=this.HYd=null;this.qJc=!1;this.jff=null;this.Gwf=0;this.context=Q;this.kd=Q.view;this.Qy=R;this.Ac=O;this.cP=K;this.c5=J;this.NBa=this.failed=!1;this.VSd=null;this.xXa=this.Y2b=!1;this.Ftn=M.wSe(Q);this.browserName=V;this.YWi=W;this.xmf=ca;this.eOa=!1;this.mWb=0;if(Q=Object(r.a)(95,O)?O:null){this.Fki=new k.DictionaryPropertySet;
this.Fki.Zq(Q);K=Q.ia(u.a.JPc,f.a.nil);this.Jwc=K!=f.a.nil?K.toString():f.a.create().toString();if(Q.ia(u.a.chi,!1)){this.Y2b=!0;this.xXa=Q.ia(u.a.xXa,!1);this.VSd=N;for(N=this.kd.Ma.If;N.Iv;)N=N.getContext(0);if(O=Object(m.a)(L.AParagraphNode,N.node)){K=0;J=A.ParagraphReader.textLength(O);switch(N.contextId){case l.a.xc:K=N.cpBegin;J=N.cpEnd;break;case l.a.endOfParagraph:K=J}this.HYd=z.FormattingReader.Hzd(N.node,K,N.Qa);w.ULS.shipAssertTag(6305503,307,!!this.HYd);O=E.HyperlinkReader.JDc(O);for(const H of O)H.cpEnd<=
K||H.cpBegin>=J||M.hyperlinkEditor.jP(N.node,H.hyperlink)}}this.NBa=Q.ia(u.a.NBa,!1);this.eOa=Q.ia(u.a.eOa,!1);this.Bgb=Q.ia(u.a.Bgb,null)}else this.Jwc=f.a.create().toString();R&64&&(this.NBa=!0)}static get hyperlinkEditor(){return M.Oi||(M.Oi=x.a.instance.resolve("Box4.IHyperlinkEditor"))}static wSe(Q){if(Q){if(Q.Iv){for(let R=0;R<Q.length;R++)if(M.wSe(Q.getContext(R)))return!0;return!1}if(Object(r.a)(F.a,Q))return M.wSe(Q.lm);if(A.ParagraphReader.tb(Q.node)&&Q.node.aM)return!0}return!1}}M.Oi=null;
Object(G.a)(M,"ClipboardActionArguments",null,[])},1440:function(G,P,b){b.d(P,"a",function(){return K});G=b(0);var k=b(23),f=b(51),x=b(43),u=b(598),w=b(120),r=b(644),m=b(172),l=b(18),z=b(12),F=b(106),L=b(6),E=b(783),A=b(698),M=b(507),Q=b(1359),R=b(1411);class K{constructor(J,O,N,V,W,ca){this.aD=J;this.yEa=N;this.pve=V;this.Pfe=W;this.Vb=ca}mDl(J,O,N){const V=this.Ywh(O,J.node),W=J.node.Mb;if(!W)return null;const ca=new x.GraphTransaction(15);ca.Oa(J.node);ca.ql=N;N=this.nDl(V,O);K.oDl(N,W,J,O);ca.dispose();
return N}Ywh(J,O){const N=this.Vb.Dj();N.set(O);N.La(7);N.mc(7);this.yEa.bPd(N,J);return N}nDl(J,O){const N=A.a.createNode();N.properties.setValue(L.a.S3,O);J.Je(N,8);this.Pfe.ihk(N,O);return N}static get characterPropertiesEditor(){return K.Tb||(K.Tb=k.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get L$(){return K.MA||(K.MA=new u.WACStyleSet)}static set L$(J){K.MA=J}static yDc(){const {FootnoteEndnoteDefaultContentInserter:J}=b(1524);return new K(M.a.instance,Q.a.instance,R.a.instance,
w.PageReader.instance,J.instance,new r.a)}static get instance(){return K._instance||(K._instance=K.yDc())}static get Ag(){return K.dw||(K.dw=m.PageNavigator.instance)}static set Ag(J){K.dw=J}static oDl(J,O,N,V){l.a.instance.J(4)&&z.App.lc.$n&&z.App.lc.zp.aF(N.node);const W=new F.a;W.setValue(L.a.PYb,J.id);W.setValue(L.a.S3,V);const ca=O.At(W,f.a.create());K.characterPropertiesEditor.Lca(N,H=>E.a.getInstance(H,ca,J.id),K.Crh(N.node,V))}static Crh(J,O){let N=null;(J=K.Ag.Xs(J))&&(J=K.L$.vM(J))&&(N=
J.tqa(O?Box4Intl.Box4Strings.L_StyleWordFootnoteReference:Box4Intl.Box4Strings.L_StyleWordEndnoteReference));return N}}K._instance=null;K.Tb=null;K.MA=null;K.dw=null;Object(G.a)(K,"FootnoteEndnoteInserter",null,[670])},1445:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{static D_m(f,x){k.Sue=f;k.fye=x}static A_m(f,x){k.dye=f;k.mSa=x}static IBh(){return k.dye===k.mSa?String.format(WordEditorIntl.WordEditorStrings.l_ReplacedAllMessage,k.mSa,k.Sue,k.fye):String.format(WordEditorIntl.WordEditorStrings.l_ReplacedSomeMessage,
k.dye,k.mSa,k.Sue,k.fye)}}k.dye=0;k.mSa=0;k.Sue=null;k.fye=null;Object(G.a)(k,"ReplaceAllContext",null,[])},1464:function(G,P,b){b.r(P);G=b(0);var k=b(1797),f=b(51),x=b(2),u=b(434),w=b(23),r=b(1727),m=b(12),l=b(8),z=b(231),F=b(1799),L=b(13),E=b(20),A=b(1409);class M{constructor(La="",Ha="",Aa=!1,Ma=!1){this.tOl=Aa;this.JRl=Ma;this.actionId=La;this.hCa=Ha}}Object(G.a)(M,"SearchEntryPointContext",null,[]);class Q{constructor(La){this.Taa=null;this.nt=!1;this.cN=La}initialize(){this.YW();this.nz();this.v3(0)}nz(){this.Taa.nz()}dispose(){this.cN=
null}IEc(){return!1}get FD(){return this.Taa?this.Taa.FD:0}v3(La){this.Taa.v3(La)}get isVisible(){return this.nt}XHe(La){this.Taa&&this.Taa.R3n(La)}bri(La){this.Taa&&this.Taa.fbo(La)}WVi(La){this.Taa&&this.Taa.ueo(La)}f2g(){this.Taa&&this.Taa.X4n()}g_d(La){this.Taa&&this.Taa.g_d(La)}}Object(G.a)(Q,"FindReplacePane",null,[399,14]);var R=b(54),K=b(1665),J=b(81),O=b(80),N=b(1198),V=b(153),W=b(189),ca=b(1384),H=b(79),Z=b(59),aa=b(1287),ja=b(406),Ba=b(1317),la=b(428),ia=b(1340),oa=b(641),ha=b(41),pa=b(78),
Ea=b(956);class Fa{constructor(La){this.bjd=new pa.a;this.nma=new pa.a;this.annotationType=Ba.RoleDetectionAnnotation.getTypeName();La.UQm(Object(ha.a)(this,this.HDj,"addHeadingAnnotationEventResponder"))}HDj(La,Ha){this.bjd.Ja(La)?this.bjd.Z(La,Ha):this.bjd.add(La,Ha);(La=this.ORk(La))&&this.YOh(Ha,La,this.O6g(la.a.getTypeName()))}hK(La,Ha){let Aa;const Ma=La.parentPath.substr(La.parentPath.lastIndexOf("\\")+1),cb=La.content;if(!cb||this.rRl(cb))""!==Ma&&({value:Aa}=this.bjd.Ab(Ma,Aa)).returnValue&&
this.YOh(Aa,La,this.O6g(Ha)),Ha===la.a.getTypeName()?(Ha=null,({value:Ha}=this.nma.Ab(Ma,Ha)).returnValue?this.nma.Z(Ma,La):this.nma.add(Ma,La)):Ha===ia.a.getTypeName()&&this.nma.remove(Ma)}YOh(La,Ha,Aa){const Ma=this.n5k(Ha);Ha=this.PRk(Ha);0<Ha&&La(Aa,Ma,Ha)}PRk(La){try{return Number.parseInvariant(La.id.substr(2))}catch(Ha){l.ULS.sendTraceTag(554747009,367,10,Ha.toString())}return-1}ORk(La){let Ha;return({value:Ha}=this.nma.Ab(La,Ha)).returnValue?Ha:null}GEf(La){if(La)for(const Ha of La)this.hK(Ha,
"AugLoop_Core_AddOperation")}n5k(La){if(La=La.content)switch(La.roleType){case Ba.RoleType.Heading1:return 1;case Ba.RoleType.Heading2:return 2;case Ba.RoleType.Heading3:return 3;case Ba.RoleType.Heading4:return 4;case Ba.RoleType.Heading5:return 5;case Ba.RoleType.Heading6:return 6;case Ba.RoleType.Heading7:return 7;case Ba.RoleType.Heading8:return 8;case Ba.RoleType.Heading9:return 9}return-1}rRl(La){La=La.roleType;return La===Ba.RoleType.Heading1||La===Ba.RoleType.Heading2||La===Ba.RoleType.Heading3||
La===Ba.RoleType.Heading4||La===Ba.RoleType.Heading5||La===Ba.RoleType.Heading6||La===Ba.RoleType.Heading7||La===Ba.RoleType.Heading8||La===Ba.RoleType.Heading9}O6g(La){if(La===la.a.getTypeName()||La===oa.a.getTypeName())return Ea.a.oOg;if(La===ia.a.getTypeName())return Ea.a.ZWe;throw Error.create("Invalid operation type");}}Object(G.a)(Fa,"RoleDetectionAnnotationHandler",null,[337]);var Ga=b(75),$a=b(1578),fa=b(49),sa=b(76),qa=b(177),va=b(172),Ca=b(515);class ta extends qa.a{constructor(La,Ha){super(La,
Ha,m.App.Sea);this.Yrg=0;this.jLd=null;this.JWa=this.BUb=0;this.headingsReady=!1;this.lBa=this.hTa=0;this.i2h=!1;this.Wvg=this.Dlg=this.Ahg=null;this.CWe=!1}get Vmf(){return!0}get Ljh(){return this.Ahg}get oPd(){return this.Wvg}dYi(){this.Yrg=Date.now();window.setTimeout(Object(ha.a)(this,this.g4l,"logHeadings"),6E4);this.headingsReady&&(this.Dlg.style.display="none",this.JWa||this.BUb?(this.Ljh.style.display="none",this.container.style.display="block"):(this.container.style.display="none",this.Ljh.style.display=
"block"))}get FX(){return super.FX|496}g4l(){6E4<=Date.now()-this.Yrg&&l.ULS.sendTraceTag(42780191,367,50,"HeadingsCount: {0} AutoDetectedHeadingsCount: {1} , PurelyAutoDetectedHeadingsCount: {2}",this.JWa,this.hTa,this.lBa)}static zlk(La,Ha,Aa){var Ma=m.App.oa.Da.Zb;if(Ma&&(Ma=va.PageNavigator.instance.s0(Ma))){const cb=new ta(new Ca.a,w.a.instance.resolve("Box4.IHtmlViewRootFactory"));cb.JWa=0;cb.BUb=0;cb.jLd=null;cb.q8a(La);cb.Ahg=Ha;cb.Dlg=Aa;cb.NA(Ma);cb.headingsReady=!0;cb.dYi();cb.Wvg=null;
return cb}return null}}Object(G.a)(ta,"WordNavigationPaneHeadingsView",qa.a,[402,183,70,14]);var Wa=b(3);class Za{constructor(La){this.ga=La}Dlm(){this.cancelSearch()}Jnm(La){this.ga.hb(E.a.aDd,2,La)}Lzf(){this.cancelSearch()}cancelSearch(){this.ga.processAction(Wa.a.Zsb,2)}xsm(){this.ga.processAction(Wa.a.findOnPage,2)}onSearchQueryChanged(La){this.ga.hb(Wa.a.Kwd,2,La)}cum(){this.ga.processAction(E.a.replace,2)}dum(){this.ga.processAction(E.a.replaceAll,2)}Ztm(){this.ga.processAction(L.a.a2e,2)}$tm(){this.ga.processAction(L.a.p2e,
2)}bum(){this.ga.processAction(Wa.a.cVd,2)}aum(){this.ga.processAction(Wa.a.DPd,2)}t8b(La){this.ga.hb(E.a.t8b,2,La)}}Object(G.a)(Za,"FindReplaceActions",null,[401]);qa=b(332);class Ya{}Ya.WM=qa.a.O$a;Ya.m7b=0;Ya.Cpa="FindReplaceTaskPaneData";Ya.pP=WordEditorIntl.WordEditorStrings.L_NavigationPaneTitle;Object(G.a)(Ya,"FindReplaceConstants",null,[]);var Ka=b(1445);class xa{constructor(La){this.nlj=La}get ri(){return this.nlj.value}y8k(La){La=this.ri.ZVa(La);return this.lLl(La)?null:La}lLl(La){return La.id===
this.ri.lya.id}static get instance(){return xa._instance||(xa._instance=xa.gC())}static gC(){const La=new z.a(()=>r.FindManager.instance.ri);return new xa(La)}}xa._instance=null;Object(G.a)(xa,"SearchResultOrder",null,[]);var Sa=b(10),pb=b(274);class Db{constructor(La){this.Wqe=La}get TMa(){return this.Wqe.value}getSelectedText(){var La=this.TMa.Zpa;if(La){const Ha=La.cpBegin,Aa=La.cpEnd-Ha;if(0<Aa&&(La=La.node,Sa.ParagraphReader.tb(La)))return La.characterData.substr(Ha,Aa)}return null}static getInstance(){return Db.wk()}static wk(){const La=
new z.a(()=>pb.a.instance);return new Db(La)}}Object(G.a)(Db,"SelectionHelper",null,[]);var Ua=b(34),Lb=b(247);class Va extends Q{constructor(La,Ha,Aa,Ma,cb,ib,Rb,Oa,lb,gb){var Nb;super(La);this.amb=Ya.WM;this.hxj="FindReplaceTaskPaneProps";this.fb=R.FocusManager.instance();this.XFa=this.DW=this.nCe=null;this.lfc=x.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled");this.J1c=x.AFrameworkApplication.K.$("AutoDetectedHeadingsIsEnabled");this.Ny=new K.a;this.tkg=Ha;this.t3a=F.a.headings;this.Zsc=
k.a.initial;this.Zma=new sa.a;this.dQ="";this.ejc={matchCase:!1,matchWholeWord:!1};this.eye="";this.Qze=null;this.EN=Aa;this.hGg=!1;this.aqb=Ma;this.ya=cb;this.onj=ib;this.Yva=Rb;this.NE=Oa;this.Vbd=!0;this.N2=this.M2=!1;this.$e=lb;this.Rge=gb;this.rbe&&this.Yva.tUm(()=>{this.it()});(null===(Nb=x.AFrameworkApplication.K)||void 0===Nb?0:Nb.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenNavPaneOnBoot",!1))&&this.OFj()}OFj(){J.a.instance.ub(new O.a(5,1,5E3,()=>{const La=this.Rge.Mvh();null!=
La&&6<La.count&&(x.AFrameworkApplication.pa.processAction(E.a.QNa,2),this.X1c=window.performance.now(),Z.a("DefaultNavigationPaneOpened"))}))}get YCe(){return 1}get rbe(){return this.lfc&&this.J1c&&!!this.$e}LUi(){this.isVisible&&this.qsd===F.a.intelligentPlaceholder&&this.it()}get headingsReady(){return this.nNb?this.nNb.headingsReady:!1}set headingsReady(La){this.nNb&&(this.nNb.headingsReady=La)}get qsd(){return this.t3a}IHi(){this.t3a=F.a.headings;this.it()}BHi(){this.t3a=F.a.find;Z.a("NavigationPaneFind");
this.it()}rIi(){this.t3a=F.a.replace;this.it()}VHi(){this.t3a=F.a.intelligentPlaceholder;this.it()}tWc(La){this.hGg=La;this.it()}IEc(){return this.qsd===F.a.replace}get FD(){return this.Zsc}v3(La){this.Zsc=La;this.it()}XHe(La){this.FFj(La);this.it()}FFj(La){const Ha=this.onj(La[La.length-1]);if(Ha){let Aa=-1;for(let Ma=0;Ma<this.Zma.count;Ma++)if(Ha.id===this.Zma.J(Ma).id){Aa=Ma;break}-1===Aa?l.ULS.sendTraceTag(40776785,313,50,"Taskpane AddSearchResult gave illegal -1 index"):this.Zma.ez(Aa,this.n7g(La))}else this.Zma.addRange(this.n7g(La))}bri(La){for(let Ha of La)for(La=
this.Zma.count-1;0<=La;La--)if(this.Zma.J(La).id===Ha.id){this.Zma.removeAt(La);break}this.it()}WVi(La){for(let Ha of La)for(La=this.Zma.count-1;0<=La;La--)if(this.Zma.J(La).id===Ha.id){this.Zma.Z(La,this.m7g(Ha));break}this.it()}f2g(){this.Zma.clear();this.Qze=null;this.it()}g_d(La){this.Qze=La?La.id:null;this.it()}n7g(La){if(!La)return new sa.a;const Ha=new sa.a;for(let Aa of La)Ha.add(this.m7g(Aa));return Ha}m7g(La){const Ha=this.aqb.Wrd(La);return{id:La.id,searchBeginIndex:Ha.vMf,searchEndIndex:Ha.sMf,
searchResult:Ha.zSe}}f7d(){}ARn(){var La={};this.cN.t8b(La);La=La[N.a.Value];this.nCe=aa.c(La)?"":La;this.it()}XIa(){return this.dQ}Exb(){return this.eye}MPf(La){this.dQ=La;this.it()}clearSearch(){}initialize(){this.vgd=window.performance.now();const La=this.fb.fd(this.amb);La.parent=V.AFrame.uo;La.rK=!0;this.YW();this.v3(k.a.initial)}NM(){this.isVisible?(l.ULS.sendTraceTag(527237715,312,50,"Navpane is already open, so making it the selected task pane."),W.UISurfaces.Ms().then(La=>{La.setSelectedTaskPane(this.amb,
this.YCe);this.o5();this.Vbd&&this.aDi(!0);return null}).catch(La=>{Va.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],La)})):(this.xWc(),this.Vbd&&this.aDi(!1))}aDi(La){const Ha=this.tkg();Ha?this.dQ=Ha:La&&this.dQ||(this.dQ="");this.cN.onSearchQueryChanged(this.dQ)}fja(){W.UISurfaces.Ms().then(La=>{La.hideTaskPane(this.amb,this.YCe);return null}).catch(La=>{Va.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],La)})}YW(){this.EN.OHa();this.DW=this.EN.GWb(this.fb);
this.uDj()}xWc(){W.UISurfaces.Ms().then(La=>{this.vgd=window.performance.now();La.showTaskPane(this.amb,this.Tz());La=[Object.assign(new Ua.a,{name:"Tab",string:this.t3a})];const Ha=window.performance.now()-this.vgd;Z.a("NavigationPaneOpen",!0,Ha,La);return null}).catch(La=>{Va.recordQosError("NavPaneOpenActionFailure",["NavPaneInteractionFailed"],La)})}it(){W.UISurfaces.Ms().then(La=>{La.updateTaskPane(this.amb,this.Tz());return null}).catch(La=>{Va.recordQosError("NavPaneUpdateActionFailure",["NavPaneInteractionFailed"],
La)})}Tz(){const La={activeTab:F.a.initial};this.Ny.cGb(La);return Object.assign(new ca.a,{title:Ya.pP,hideHeader:!1,width:320,location:this.YCe,contentProps:La,onOpen:()=>{this.nt=!0;this.TTm();this.Vbd&&this.o5();m.App.oa.updateCommandUI();m.App.oa.RSa(Object(ha.a)(this,this.LUi,"updateIntelligentPlaceholderEntries"))},onClose:()=>{var Ha=window.performance.now();null!=this.X1c&&(5E3>window.performance.now()-this.X1c&&Z.a("DefaultNavigationPaneClosed"),this.X1c=null,this.nNb.CWe=!1);this.Z9();this.nt=
!1;this.RKn();try{this.cN.Lzf()}catch(Aa){Va.recordQosError("NavPaneCloseActionFailure",["NavPaneInteractionFailed"],Aa)}this.nCe="";this.Zsc=k.a.initial;m.App.oa.W8b(Object(ha.a)(this,this.LUi,"updateIntelligentPlaceholderEntries"));m.App.oa.updateCommandUI();Ha=window.performance.now()-Ha;Z.a("NavigationPaneClose",!0,Ha)},enableResize:!1,minResizeWidth:280,maxResizeWidth:920,isModernPane:!0})}TTm(){this.rbe&&!this.XFa&&ja.a.Yn().then(()=>{this.XFa=new Fa(this.Yva);this.$e.Ea(this.XFa,this.XFa.annotationType);
this.$e.getAnnotationsByType(this.XFa.annotationType).then(La=>{this.XFa.GEf(La)})})}RKn(){this.rbe&&this.XFa&&(this.$e.xb(this.XFa,this.XFa.annotationType),this.XFa=null)}uDj(){this.Ny.QI(this.k0k());this.Ny.QI(this.m0k());this.Ny.QI(this.w2k());this.Ny.QI(this.l4k());this.Ny.QI(this.pQk());this.Ny.QI(this.onLinkExecute());this.Ny.QI(this.onPivotTabExecute());this.Ny.QI(this.$fl());this.Ny.QI(this.z2k());this.Ny.QI(this.wil());this.Ny.QI(this.W3k());this.Ny.QI(this.ljl());this.Ny.QI(this.gdl())}ljl(){return La=>
{La.autoDetectedHeadingsToggleDisabled=this.Yva?!this.Yva.VRj():!0}}wil(){return La=>{La.type=this.hxj}}onLinkExecute(){return La=>{La.onLinkExecute=()=>{this.cN.xsm()}}}onPivotTabExecute(){return La=>{La.onPivotTabExecute=Ha=>{switch(Ha){case F.a.headings:this.IHi();break;case F.a.replace:this.rIi();break;case F.a.intelligentPlaceholder:this.VHi();break;default:this.BHi()}aa.b(this.dQ)&&(this.dQ=this.tkg(),this.dQ||(this.dQ=""),aa.b(this.dQ)||(this.cN.onSearchQueryChanged(this.dQ),this.it()))}}}$fl(){return La=>
{La.showOutOfSyncNotification=this.hGg}}z2k(){return La=>{La.headingsContent.headingsReady=this.headingsReady}}m0k(){return La=>{La.findSearchBoxContent={onSearchQueryChanged:Ha=>{this.dQ=Ha;this.it();this.cN.onSearchQueryChanged(Ha)},findOptions:this.ejc,matchCase:this.M2,matchWholeWord:this.N2,findSearchText:this.dQ,onClearButtonExecute:()=>{void 0!==this.dQ&&null!==this.dQ&&""!==this.dQ&&(this.dQ="",this.ya.setSelection(null),this.cN.Dlm())},onMatchCaseExecute:()=>{this.ejc.matchCase=!this.ejc.matchCase;
this.M2=!this.M2;this.it();this.cN.Ztm()},onMatchWholeWordExecute:()=>{this.ejc.matchWholeWord=!this.ejc.matchWholeWord;this.N2=!this.N2;this.it();this.cN.$tm()},onMenuClose:()=>{if(this.DW)this.DW.onMenuClose()},onMenuOpen:()=>{if(this.DW)this.DW.onMenuOpen()}}}}pQk(){return La=>{La.activeTab=this.qsd}}W3k(){return La=>{La.autoDetectedHeadingsToggleState=this.Yva?this.Yva.HLe:!1;!La.autoDetectedHeadingsToggleState&&this.Yva&&this.Yva.tYc(!1)}}k0k(){return La=>{const Ha={onReplaceAllExecute:()=>{this.cN.dum()},
onReplaceExecute:()=>{this.cN.cum()},onReplaceQueryChanged:Aa=>{this.eye=Aa;this.it()},replaceSearchText:this.eye};La.findReplaceContent={searchResults:this.Zma.toArray(),replaceSearchBoxContent:Ha,onNextSearchResultExecute:()=>{this.cN.aum()},onPrevSearchResultExecute:()=>{this.cN.bum()},onSearchResultSelected:Aa=>{const {FindReplaceUIManager:Ma}=b(1464);this.cN.Jnm(Aa);Ma.L1h(1)},selectedResultId:this.Qze,summaryLabel:this.nCe,explanationText:this.D_k(this.Zsc),haveTooManySearchResults:this.Zsc===
k.a.tooManyResults}}}D_k(La){switch(La){case k.a.initial:return WordEditorIntl.WordEditorStrings.l_LandingMessage;case k.a.noMatchesFound:return WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;case k.a.replaceAllComplete:return Ka.a.IBh();case k.a.tooManyResults:return WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage;default:return""}}gdl(){return La=>{La.replaceFollowUpsWithCommentsIsEnabled=!0}}l4k(){return La=>{var Ha=this.NE.dRk();const Aa=[];for(let Ma of Ha)Ha=this.NE.fyd(Ma.Mb,
Ma.id),Aa.push({id:Ma.id.toString(),intelligentPlaceholderAnchorText:Ha});La.intelligentPlaceholderContent={intelligentPlaceholderContentEntry:Aa,onIntelligentPlaceholderInputExecute:Ma=>{this.dQ=Ma;this.t3a=F.a.find;this.it();this.cN.onSearchQueryChanged(Ma)},onSearchResultSelected:Ma=>{this.it();Ma=f.a.Ee(Ma);this.NE.m9m(Ma)}}}}w2k(){return La=>{let Ha=()=>{};this.Yva&&(Ha=Object(ha.a)(this.Yva,this.Yva.tYc,"toggleAutoDetectedHeadings"));La.headingsContent={onHeaderInputExecute:Aa=>{this.dQ=Aa;
this.t3a=F.a.find;this.it();Z.a("NavigationPaneFind");this.cN.onSearchQueryChanged(Aa)},renderHeadingContent:(Aa,Ma,cb)=>{setTimeout(()=>{var ib=window.performance.now()-this.vgd;this.nNb=ta.zlk(Aa,Ma,cb);this.it();null!=this.X1c&&(this.nNb.CWe=!0);const Rb=window.performance.now()-this.vgd;Z.a("NavigationPaneHeadingsLoaded",!0,Rb);ib=[Object.assign(new Ua.a,{name:"HeadingFetchStart",double:ib}),Object.assign(new Ua.a,{name:"HeadingFetchFinished",double:Rb})];Z.a("NavigationPaneHeadingsLoadDetails",
!0,void 0,ib)},70)},autoDetectedHeadingsToggle:Ha,onHeadingsUnmounted:()=>{this.headingsReady=!1}}}}vCi(La){this.Vbd=La}o5(){this.fb.Kf(this.amb);l.ULS.sendTraceTag(40469190,312,50,"Taskpane now visible with focus on SearchBox")}Z9(){if(this.YXa()){var La;(La=Ga.InteractiveViewManager.instance.rc)?(La=La.IG,l.ULS.sendTraceTag(40469191,312,50,"Taskpane now hidden with focus on previous selection view.")):(La=this.fb.$Q,l.ULS.sendTraceTag(40469192,312,50,"Taskpane now hidden with focus on default scope."));
this.fb.Kf(La)}}YXa(){return!!this.fb.nf&&this.fb.nf.name===this.amb}static getInstance(){return Va.wk()}static wk(){return new Va(new Za(x.AFrameworkApplication.pa),Object(ha.a)(Db.getInstance(),Db.getInstance().getSelectedText,"getSelectedText"),$a.a.instance,A.a.instance,fa.a.instance,Object(ha.a)(xa.instance,xa.instance.y8k,"getNextSearchResult"),w.a.instance.ra("Box4.NavigationPaneViewElementManager.INavigationPaneViewElementManager"),w.a.instance.ra("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),
w.a.instance.ra("Box4.AugmentationLoop.IAnnotationStorage"),w.a.instance.resolve("WordEditor.TableOfContents.IDocumentHeadings"))}static recordQosError(La,Ha,Aa){var Ma;if(null===(Ma=x.AFrameworkApplication.K)||void 0===Ma?0:Ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.NavPaneQosLogging",!1))Ma=Object.assign(new Lb.a,{extendedProperties:new Map}),Aa&&Ma.extendedProperties.set("exception",Aa),H.Health.instance.recordQosError(La,Ha,!1,!0,!1,!1,Ma)}}Object(G.a)(Va,"ReactFindReplacePane",Q,[398,
399,14]);var Sb=b(1394);b.d(P,"FindReplaceUIManager",function(){return nb});class nb{constructor(La,Ha,Aa=null,Ma=null,cb=null,ib=null){this.X3c=this.MZ=0;this.N2=this.M2=this.Nqb=!1;this.Ek=this.uwg=this.ofa=null;this.Rza=this.Moe=!1;this.Zf=La;this.yj=Aa;this.aqb=Ma;this.Tsg=cb;this.Zc=ib;nb.VUb=new M}get zlf(){return this.Moe}set zlf(La){La!==this.Moe&&(this.Moe=La,this.$0g())}d1d(La){this.MZ=La;this.update();this.MZ||this.FD!==k.a.searchComplete&&this.FD!==k.a.tooManyResults?0<this.MZ&&this.FD===
k.a.noMatchesFound?this.v3(k.a.searchComplete):this.MZ>nb.bPi&&this.FD!==k.a.tooManyResults&&(l.ULS.sendTraceTag(4065350,312,50,"Shifting to TooManyResults UI"),this.v3(k.a.tooManyResults)):this.v3(k.a.noMatchesFound)}H_d(La){this.X3c=La;this.Rza&&this.update();this.Tsg&&!this.Tsg.value.kTc&&this.iPf()}reset(){}n2e(){this.Zc&&(this.Ek=this.Zc.Pe("UserAction","Find"));if(this.Rza||!this.FD)this.Rza=!1,l.ULS.sendTraceTag(4065351,312,50,"FindStarted");this.v3(k.a.searching)}vYb(){var La;this.Rza=!0;
let Ha=this.MZ?k.a.searchComplete:k.a.noMatchesFound;if(this.FD!==k.a.tooManyResults&&r.FindManager.instance){const Aa=r.FindManager.instance.ri;0<Aa.Tea&&(Aa.Tea>nb.bPi?Ha=k.a.tooManyResults:this.GQn(Aa))}this.v3(Ha);this.update();this.Ek&&(this.Ek.stop(),this.Ek=null);nb.eyi=f.a.create().toString();nb.L1h(0,this.F9a,this.XIa().length,this.MZ);Object(Sb.b)()&&(null===(La=this.Zf)||void 0===La?0:La.isVisible)&&(La={},x.AFrameworkApplication.pa.hb(L.a.BWd,2,La),La[u.a.On]&&x.AFrameworkApplication.pa.hb(L.a.nHd,
2,{CommandValueId:{query:this.XIa(),matchCase:this.M2,matchWholeWordOnly:this.N2,totalResultLimit:-1}}))}GQn(La){const Ha=La.lya;let Aa=Ha;const Ma=[];do Ma[Ma.length]=Aa,Aa=La.ZVa(Aa);while(Ha!==Aa);this.Zf.XHe(Ma);this.ofa&&this.Zf.g_d(this.ofa)}update(){this.Zf&&this.Zf.ARn()}get FD(){return this.Zf.FD}get F9a(){return this.Zf.qsd}ghb(La){this.zlf=La}$0g(){if(this.zlf)switch(this.FD){case k.a.searchComplete:case k.a.noMatchesFound:case k.a.tooManyResults:this.Zf.tWc(!0)}else this.Zf.tWc(!1)}v3(La){if(this.Zf.isVisible){switch(La){case k.a.noMatchesFound:case k.a.searchComplete:this.FD===
k.a.tooManyResults&&(La=k.a.tooManyResults)}this.Zf&&(this.Zf.v3(La),this.$0g());this.update();this.iPf()}}yIa(La,Ha){const Aa=this.Rza&&this.FD!==k.a.tooManyResults;switch(La){case 0:Aa&&this.Zf.XHe(Ha);break;case 1:Aa&&this.Zf.bri(Ha);break;case 4:Aa&&this.Zf.WVi(Ha);break;case 2:this.Zf.f2g();break;case 3:this.ofa=Ha[0],Aa&&0<this.MZ&&this.Zf.g_d(this.ofa)}}get matchCase(){return this.M2}set matchCase(La){this.M2!==La&&(this.M2=La,this.pUi())}get matchWholeWord(){return this.N2}set matchWholeWord(La){this.N2!==
La&&(this.N2=La,this.pUi())}pUi(){this.Zf.f7d()}XIa(){return this.Zf.XIa()}Exb(){return this.Zf.Exb()}MPf(La){this.Zf.MPf(La)}clearSearch(){this.Zf.clearSearch()}get sIi(){return 0<this.MZ&&this.FD!==k.a.replaceAllInProgress&&this.FD!==k.a.replaceAllComplete}Mbn(La){let Ha="";La?Ha=0<this.MZ?String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplacedAndMoveToNextResult,this.XIa(),this.Exb()):String.format(WordEditorIntl.WordEditorStrings.l_ReadoutReplaceWithNoMoreResults,this.XIa(),this.Exb()):
La||0<this.MZ&&(Ha=WordEditorIntl.WordEditorStrings.l_ReadoutReplaceSkippedAndMoveToNextResult);this.iPf(Ha)}dispose(){this.Zf.dispose()}IEc(){return this.Zf.IEc()}Agn(La,Ha=!0){La!==this.F9a&&(La===F.a.headings?(l.ULS.sendTraceTag(9056651,367,50,""),this.Zf.IHi()):La===F.a.find?this.Zf.BHi():La===F.a.replace?this.Zf.rIi():La===F.a.intelligentPlaceholder&&(Ha||this.Zf.vCi(Ha),this.Zf.VHi()))}uz(La,Ha=!0){this.Zf.vCi(Ha);La?(this.Nqb||this.Tff(),this.Zf.NM(),this.MZ||this.FD===k.a.noMatchesFound?x.AFrameworkApplication.K&&
x.AFrameworkApplication.K.$("WordEditorFindReplaceCancelButtonFixIsEnabled")&&this.Zf.v3(k.a.searchComplete):this.v3(k.a.initial)):this.Zf.fja()}Tff(){this.Nqb||(this.Zf.initialize(),this.Nqb=!0)}iPf(La=""){var Ha=this.udl();Ha&&(La=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,La,Ha));this.aqb&&Ha&&this.ofa&&this.FD!==k.a.tooManyResults&&this.FD!==k.a.replaceAllInProgress&&(Ha=this.aqb.Wrd(this.ofa),La=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,
La,Ha.zSe));(Ha=this.C_k())&&(La=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,La,Ha));this.yj&&La&&this.uwg!==La&&(this.uwg=La,this.yj.sendNotification(La,!0))}udl(){let La="";switch(this.FD){case k.a.startSearch:La=WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case k.a.searchComplete:La=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,this.X3c,this.MZ);break;case k.a.tooManyResults:this.Rza&&(La=String.format(WordEditorIntl.WordEditorStrings.l_ReadoutCurrentResult,
this.X3c,this.MZ));break;case k.a.noMatchesFound:La=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case k.a.replaceAllInProgress:La=WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgressReadout;break;case k.a.replaceAllComplete:La=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}return La}C_k(){let La="";switch(this.FD){case k.a.initial:La=String.format(WordEditorIntl.WordEditorStrings.l_FindReplaceResultSummaryScreenReaderNotification,WordEditorIntl.WordEditorStrings.l_LandingMessage,
this.e0k());break;case k.a.noMatchesFound:La=WordEditorIntl.WordEditorStrings.l_NoMatchesMessage;break;case k.a.replaceAllComplete:La=Ka.a.IBh();break;case k.a.tooManyResults:La=WordEditorIntl.WordEditorStrings.l_TooManyResultsMessage}return La}e0k(){let La="";this.M2&&this.N2?La=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOptions,WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):this.M2?La=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,
WordEditorIntl.WordEditorStrings.l_MatchCase):this.N2&&(La=String.format(WordEditorIntl.WordEditorStrings.l_SelectedSearchOption,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));return La}static getInstance(La){return nb.wk(La)}static wk(La){const Ha=Va.getInstance();return new nb(Ha,La,w.a.instance.resolve("Common.Utils.IAriaNotifier"),A.a.instance,new z.a(()=>r.FindManager.instance.VEb),m.App.oa.Qo)}static L1h(La,Ha=-1,Aa=-1,Ma=-1){l.ULS.sendTraceTag(4065352,312,50,"{0}",{["SearchOp"]:La,["SearchComplete.ResultsCount"]:Ma,
["SearchOpsCorrelation"]:nb.eyi,["ActionId"]:nb.VUb.actionId,["SourceControlId"]:nb.VUb.hCa,["IsNavPanOpenedAlready"]:nb.VUb.tOl,["IsSearchFromNavPane"]:nb.VUb.JRl,["CurrentTab"]:Ha,["QueryLength"]:Aa})}static OZj(La,Ha,Aa){Ha=void 0!==Ha&&null!==Ha?void 0===Ha.SourceControlId||null===Ha.SourceControlId?"Unknown":Ha.SourceControlId:La===E.a.Ahb?"FindKeyboardShorcut":La===E.a.Chb?"ReplaceKeyboardShorcut":"Unknown";switch(La){case E.a.zac:La="ShowHeadingsPane";break;case E.a.Ahb:La="ShowFindPane";break;
case E.a.Chb:La="ShowReplacePane";break;case E.a.Dac:La="ShowIntelligentPlaceholderPane";break;case E.a.QNa:La="ToggleNavigationPane";break;default:La="Unknown"}nb.VUb=new M(La,Ha,Aa,!0)}}nb.bPi=100;nb.eyi=null;nb.VUb=null;Object(G.a)(nb,"FindReplaceUIManager",null,[366,367,14])},1465:function(G,P,b){b.r(P);G=b(0);var k=b(92),f=b(67),x=b(2),u=b(153),w=b(23),r=b(54),m=b(959),l=b(121),z=b(12),F=b(8),L=b(41),E=b(20),A=b(332),M=b(461),Q=b(1359),R=b(1644),K=b(60),J=b(288),O=b(7),N=b(435),V=b(273),W=b(19),
ca=b(49),H=b(507),Z=b(1525);class aa{constructor(Ua,Lb,Va,Sb,nb,La,Ha){this.gwg=this.OAg=this.zjg=this.HH=this.d2a=this.QJb=this.pje=this.jfe=this.Qge=this.qT=this.Ana=this.Nna=null;this.fb=Ua;this.ga=Sb;this.Se=nb;this.jd=La;this.ya=Ha;this.wva=Va;this.K3=document.createElement("div");this.K3.classList.add("FootnoteEndnoteActionBarControl");this.K3.style.zIndex=String(V.a.IZe);this.K3.style.position="relative";this.aic=document.createElement("div");this.aic.classList.add("FootnoteEndnoteActionBarControlDividerElement");
this.K3.appendChild(this.aic);this.zfk();this.K3.appendChild(this.QJb);this.K3.appendChild(this.d2a);this.tW=k.KeyInputManager.mb(f.a.V5,0);this.CAl();this.BAl()}dca(Ua){F.ULS.shipAssertTag(4520065,308,this.wva.vja(Ua));this.HH!==Ua&&(this.HH=Ua,this.V6d(),Ua=this.wva.Icb(this.HH),this.aik(Ua),this.HH.WPg(Object(L.a)(this,this.V6d,"updateActionBarControl")),Ua?(this.Ana.title=WordEditorIntl.WordEditorStrings.L_NextFootnote,this.Nna.title=WordEditorIntl.WordEditorStrings.L_PrevFootnote):(this.Ana.title=
WordEditorIntl.WordEditorStrings.L_NextEndnote,this.Nna.title=WordEditorIntl.WordEditorStrings.L_PrevEndnote),this.wBa())}V6d(){const Ua=this.wva.xDc(this.HH),Lb=this.wva.k1k(this.HH);this.jfe.innerText=Ua.toString();this.pje.innerText=Lb.toString();R.a.TFb(this.Nna,1===Ua?!1:!0);R.a.TFb(this.Ana,Ua===Lb?!1:!0)}Yub(){this.HH&&(this.qT&&this.qT.parentNode===this.QJb&&this.QJb.removeChild(this.qT),this.Zea(),this.HH.mYm(Object(L.a)(this,this.V6d,"updateActionBarControl")),this.HH=null)}dispose(){this.fb.fd(A.a.mVa).Bp(this.tW)}aik(Ua){3===
this.ga.mode&&(Ua=Ua?WordEditorIntl.WordEditorStrings.L_FormatFootnotes:WordEditorIntl.WordEditorStrings.L_FormatEndnotes,this.qT=this.dTe("FootnoteEndnoteFormattingOptionButton","FootnoteEndnoteActionBarFormattingButton",Ua,null),K.a.wo(this.qT,K.a.oba,Ua),this.QJb.appendChild(this.qT))}ben(){const Ua=this.fb.getRegion(A.a.mVa);let Lb;if(this.Ana.disabled)if(this.Nna.disabled)if(this.qT&&!this.qT.disabled)Lb=this.qT;else return;else Lb=this.Nna;else Lb=this.Ana;Lb.focus();Ua.Sh.ov(Lb)}zfk(){this.QJb=
document.createElement("div");this.QJb.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarLeftDiv");this.d2a=document.createElement("div");this.d2a.classList.add("FootnoteEndnoteActionBarButtonHolder","FootnoteEndnoteActionBarRightDiv");this.Nna=this.dTe("FootnoteEndnotePreviousButton","FootnoteEndnoteActionBarNavigationButton","","LeftPageArrow_20x20x32");this.d2a.appendChild(this.Nna);this.jfe=N.b("span","FootnoteEndnoteActionBarCurrentCount","FootnoteEndnoteActionBar");
this.d2a.appendChild(this.jfe);this.Qge=N.b("span","FootnoteEndnoteActionBarDivider","FootnoteEndnoteActionBar");this.Qge.innerText=" / ";this.d2a.appendChild(this.Qge);this.pje=N.b("span","FootnoteEndnoteActionBarTotalCount","FootnoteEndnoteActionBar");this.d2a.appendChild(this.pje);this.Ana=this.dTe("FootnoteEndnoteNextButton","FootnoteEndnoteActionBarNavigationButton","","RightPageArrow_20x20x32");this.d2a.appendChild(this.Ana)}dTe(Ua,Lb,Va,Sb){Ua=R.a.YTa(Ua,Lb,Va,Sb,void 0===Sb||null===Sb);Ua.setAttribute(K.a.tg,
K.a.v_);return Ua}CAl(){const Ua=this.fb.fd(A.a.mVa);Ua.parent=l.AppFrame.uo;Ua.bindAction(this.tW,E.a.Vba);Ua.iba(Object(L.a)(this,this.ben,"setFocusOnEnabledButton"))}BAl(){var Ua=new J.DOMFocusListing(()=>this.K3);Ua.zBa=!1;Ua.vn(2);Ua.vn(1);Ua=this.fb.DNe(this.K3,this.fb.fd(A.a.mVa),Ua);Ua.rMa();Ua.mV=!0}wBa(){this.qT&&(this.Se.Ea(O.a.click,this.qT,Object(L.a)(this,this.fQe,"clickFormattingOptionsButtonEvent")),this.zjg=this.jd.fgb(this.qT,Object(L.a)(this,this.fQe,"clickFormattingOptionsButtonEvent"),
f.a.Nq));this.Se.Ea(O.a.click,this.Nna,Object(L.a)(this,this.hQe,"clickPrevButtonEvent"));this.OAg=this.jd.fgb(this.Nna,Object(L.a)(this,this.hQe,"clickPrevButtonEvent"),f.a.Nq);this.Se.Ea(O.a.click,this.Ana,Object(L.a)(this,this.gQe,"clickNextButtonEvent"));this.gwg=this.jd.fgb(this.Ana,Object(L.a)(this,this.gQe,"clickNextButtonEvent"),f.a.Nq);this.ya.aC(Object(L.a)(this,this.Kka,"processSetSelectionFinished"))}Zea(){this.qT&&(this.Se.xb(O.a.click,this.qT,Object(L.a)(this,this.fQe,"clickFormattingOptionsButtonEvent")),
this.jd.Xib(this.qT,this.zjg));this.Se.xb(O.a.click,this.Nna,Object(L.a)(this,this.hQe,"clickPrevButtonEvent"));this.jd.Xib(this.Nna,this.OAg);this.Se.xb(O.a.click,this.Ana,Object(L.a)(this,this.gQe,"clickNextButtonEvent"));this.jd.Xib(this.Ana,this.gwg);this.ya.fea(Object(L.a)(this,this.Kka,"processSetSelectionFinished"))}Kka(Ua,Lb){(Ua=Lb.rk.Fa)&&this.qT&&R.a.TFb(this.qT,W.SelectionEditor.Cl(Ua)?!0:!1)}gQe(){if(!this.Ana.disabled){const Ua=this.wva.Icb(this.HH)?E.a.ivf:E.a.hvf;this.ga.processAction(Ua,
2)}return!0}hQe(){if(!this.Nna.disabled){const Ua=this.wva.Icb(this.HH)?E.a.kvf:E.a.jvf;this.ga.processAction(Ua,2)}return!0}fQe(){this.qT&&!this.qT.disabled&&this.ga.processAction(E.a.HZh,2);return!0}static f1k(){return aa.g1k()}static g1k(){return new aa(r.FocusManager.instance(),Z.a.instance,H.a.instance,x.AFrameworkApplication.pa,z.App.oa.yx,z.App.oa.zB,ca.a.instance)}}Object(G.a)(aa,"FootnoteEndnoteActionBarControl",null,[675]);var ja=b(240),Ba=b(13),la=b(1411),ia=b(1604);class oa{constructor(Ua,
Lb,Va,Sb,nb,La,Ha,Aa,Ma,cb,ib,Rb){this.OB=null;this.hQ=!1;this.hg=this.ku=null;this.OPb=Ua;this.LXb=Lb;this.Bec=Va;this.Noj=Sb;this.gue=nb;this.Ck=La;this.s4a=Ha;this.Se=Aa;this.kzg=Ma;this.kcj=ib;this.Wp=this.OPb.ownerDocument.createElement("div");this.Wp.id="FootnoteEndnoteControlOverlay";this.Wp.className="EditingSurfaceOverlay";this.ZF=this.NWk();this.zY(!1);this.OPb.appendChild(this.Wp);this.OPb.appendChild(this.ZF);this.LXb.bind();this.rd=null;this.ga=Rb;this.yEa=cb}g2m(){const Ua=this.kzg();
Ua&&Ua.Rh&&(Ua.Igb=0,Ua.Gld())}sTi(Ua){if(this.Puc){const Lb=this.Puc.uia;Lb&&(Lb.fjf=Ua)}}get zF(){return this.hQ}get Puc(){return this.OB}get dialog(){return this.rd}get gm(){return this.hg||(this.hg=w.a.instance.za("Common.IZoomManager"))}OTe(){this.rd=ia.a.o1k()}DTc(){this.rd=null}show(Ua=!0){this.hQ||(this.sTi(!0),this.kcj(),this.zY(!0),this.nz(),Ua&&this.setFocus())}setFocus(){this.hQ&&(this.LXb.setInitialSelection(),this.Noj())}update(){this.hQ&&(this.OB.isConnected?this.Bec.V6d():this.dismiss())}dismiss(Ua=
!1,Lb=!1){this.hQ&&(this.sTi(!1),this.O5(),this.g2m(),this.zY(!1),this.gue(Lb),this.rd&&(this.ga.processAction(Ba.a.xzc,2),this.rd=null),!Ua&&this.OB&&this.OB.isConnected&&this.yEa.l9m(this.OB),this.Yub())}R0m(Ua){const Lb=null!==this.gm.instance?this.gm.instance.ei:1;this.ZF.style.width=Ua.W5g*Lb+"px";this.ku.style.width=Ua.Jxc*Lb+"px";this.ZF.style.marginLeft=Ua.WVb*Lb+"px";this.Ck?this.ku.style.marginRight=Ua.tSe*Lb+"px":this.ku.style.marginLeft=Ua.eWb*Lb+"px";if(Ua=this.kzg())Ua=Ua.XI,this.ZF.style.bottom=
Ua.offsetHeight-Ua.clientHeight+"px"}dca(Ua){F.ULS.shipAssertTag(4520073,308,this.s4a.vja(Ua));this.OB!==Ua&&(this.OB=Ua,this.LXb.dca(Ua),this.Bec.dca(this.OB))}dispose(){this.dismiss();this.LXb.dispose();this.Bec.dispose()}nz(){this.Se&&this.Se.Ea(O.a.click,this.Wp,Object(L.a)(this,this.onClick,"onClick"))}O5(){this.Se&&this.Se.xb(O.a.click,this.Wp,Object(L.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss(!1,!0);return!0}NWk(){let Ua;Ua=document.createElement("div");Ua.classList.add("FootnoteEndnoteControl");
this.ku=document.createElement("div");this.ku.classList.add("FootnoteEndnoteContent");this.ku.appendChild(this.LXb.K3);this.ku.appendChild(this.Bec.K3);Ua.appendChild(this.ku);return Ua}zY(Ua){Ua=(this.hQ=Ua)?"":"none";this.Wp.style.display=Ua;this.ZF.style.display=Ua}Yub(){this.OB&&(this.LXb.Yub(),this.Bec.Yub(),this.OB=null)}static cBd(){const Ua=z.App.oa.Da.Jb;return Ua&&Ua.Rh?Ua:null}static j1k(Ua,Lb,Va,Sb,nb){return new oa(Ua,Lb,Va,Sb,nb,x.AFrameworkApplication.isRtl,H.a.instance,ja.a.instance,
oa.cBd,la.a.instance,oa.Evk,x.AFrameworkApplication.pa)}static Evk(){x.AFrameworkApplication.pa.hb(Ba.a.Gbb,2,!0)}}Object(G.a)(oa,"FootnoteEndnoteControl",null,[674]);var ha=b(732),pa=b(5),Ea=b(206),Fa=b(39),Ga=b(10),$a=b(24),fa=b(88),sa=b(1524),qa=b(383),va=b(859),Ca=b(539),ta=b(1262),Wa=b(75),Za=b(246);class Ya extends qa.a{constructor(Ua,Lb,Va,Sb,nb,La,Ha,Aa,Ma,cb,ib,Rb,Oa,lb,gb,Nb,qc){super(A.a.jca,Va,Sb,nb,Ha,Aa,Ma,cb,ib,Rb,Oa,lb,gb,Nb,qc);this.pdg=Ua;this.yRa=La;this.yRa.VXc=this;Lb(this);this.features.gWf=
!0}get uSh(){return!0}tbf(){const Ua=this.pdg.q4e(this);return va.ViewReference.MD(Ua)}lYe(Ua){Object(Za.a)(Ya,Ua)||this.pdg.iYe()}JEc(){return Ca.a.O5h}onResize(){super.onResize();this.yRa.oih()}NA(Ua,Lb=null){super.NA(Ua,Lb);this.yRa.aih(this.sc.Oh)}detach(){this.yRa.nih();super.detach()}Fxd(){this.onResize()}static WTa(){const {FootnoteEndnoteControlManager:Ua}=b(1465);return new Ya(Ua.instance,ta.a.KRe,z.App.oa.Da,Wa.InteractiveViewManager.instance,()=>w.a.instance.resolve("Box4.IUndoManager"),
w.a.instance.resolve("WordEditor.SectionAlignedViewRepositioner"),x.AFrameworkApplication.pa,w.a.instance.resolve("Box4.IHtmlViewRootFactory"),w.a.instance.resolve("Box4.IInteractiveEventNotifier"),w.a.instance.za("Box4.ITextMetricsAdapter"),w.a.instance.resolve("Box4.IRotatingCoordinateConverter"),w.a.instance.za("Common.IZoomManager"),w.a.instance.ra("Box4.IContentControlViewElementManager"),w.a.instance.ra("Box4.CpConversionManagerImpl"),w.a.instance.ra("Box4.ContentControlConfigSettings"),w.a.instance.ra("Box4.IContentControlReader"),
w.a.instance.ra("Box4.IContentControlBoundaryNavigator"))}}Object(G.a)(Ya,"FootnoteEndnoteEditView",qa.a,[]);class Ka{constructor(Ua,Lb,Va,Sb=!1){this.hmb=null;this.yne=this.kag=!1;this.yj=null;this.fb=Ua;this.wva=Lb;this.jaa=Va();this.R8c=Sb;this.K3=document.createElement("div");this.K3.classList.add("FootnoteEndnoteEditControl");this.aic=document.createElement("div");this.aic.classList.add("FootnoteEndnoteEditControlDividerElement");this.qrb=(new ha.a(this.K3,"WACViewPanel_FootnoteEndnoteEditControl")).QC;
this.K3.appendChild(this.aic);this.K3.appendChild(this.qrb)}get Xu(){return this.yj||(this.yj=w.a.instance.resolve("Common.Utils.IAriaNotifier"))}dca(Ua){F.ULS.shipAssertTag(4520077,308,this.wva.vja(Ua));this.hmb!==Ua&&(this.hmb=Ua,this.vLe(this.hmb),this.yne=this.wva.Icb(this.hmb),this.R8c?(this.jaa.UFb(K.a.Bmd),this.fb.fd(A.a.jca).hba(Object(L.a)(this,this.MMk,"footnoteEndnoteOnFocus"))):this.jaa.ZAi(this.yne?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,
K.a.Bmd))}MMk(){const Ua=String.format("{0} {1}",this.yne?WordEditorIntl.WordEditorStrings.l_FootnoteEditingSurfaceAccessibilityTitleText:WordEditorIntl.WordEditorStrings.l_EndnoteEditingSurfaceAccessibilityTitleText,WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText);this.Xu.sendNotification(Ua,!0)}Yub(){const Ua=H.a.instance.Icb(this.hmb)?"Footnote":"Endnote";F.ULS.sendTraceTag(4006494,308,50,"{0}",{["Type"]:Ua,["CalloutHeight"]:this.K3.scrollHeight});this.T9a();this.hmb=
null}bind(){this.kag||(this.jaa.q8a(this.qrb),this.kag=!0)}setInitialSelection(){const Ua=this.kfl();Ua?this.jaa.setSelection(Ua):this.jaa.zVc()}dispose(){this.T9a()}vLe(Ua){this.T9a();this.jaa.NA(Ua,Ua.Oh)}T9a(){this.jaa.detach()}kfl(){let Ua=0;var Lb=null,Va=pa.GraphIterator.va(this.hmb);Ea.OutlineNavigator.I4(Va);if((Va=Fa.OutlineElementNavigator.Fd(Va))&&Ga.ParagraphReader.tb(Va)){if(Lb=Ka.U4k(Va)){Ua=Lb.Xa.cp+1;Lb=sa.FootnoteEndnoteDefaultContentInserter.Nbh;const Sb=Lb.length;Ua+Sb<=Ga.ParagraphReader.textLength(Va)&&
Va.characterData.substr(Ua,Sb)===Lb&&(Ua+=Sb)}Lb=$a.SelectionFactory.vd(Va,Ua)}return Lb}static l1k(){return Ka.m1k()}static m1k(){return new Ka(r.FocusManager.instance(),H.a.instance,()=>Ya.WTa(),x.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}static U4k(Ua){Ua=fa.i(Ua,10);return 0<Ua.length?Ua[Ua.length-1]:null}}Object(G.a)(Ka,"FootnoteEndnoteEditControl",null,[673]);var xa=b(1027);class Sa{constructor(Ua,Lb){this.uva=Ua;this.Ck=Lb}M_b(Ua,Lb){Ua=this.uva.M_b(Ua);
var Va=Lb.clientWidth;const Sb=Lb.scrollLeft,nb=Ua.W5g;let La=Ua.WVb,Ha=Ua.WVb,Aa=Sa.msf,Ma=Sa.nsf,cb=nb,ib=Ua.Jxc;this.Ck?Ma=Ua.tSe-Ha:Aa=Ua.eWb-La;Va<nb&&(La=Math.max(La-Sb,0),cb=Va-La,this.Ck?(Va=Lb.scrollWidth-Sb-Va,Ha=Lb.scrollWidth-Ua.WVb-nb,Ma=Math.max(Ua.tSe-Va-Ha,Sa.nsf),ib=cb-Ma-Sa.msf):(Aa=Math.max(Ua.eWb-Sb-La,Sa.msf),ib=cb-Aa-Sa.nsf));return new xa.a(La,cb,Aa,Ma,ib)}}Sa.msf=25;Sa.nsf=50;Object(G.a)(Sa,"FootnoteEndnoteViewPositionProvider",null,[]);class pb{constructor(Ua,Lb=0,Va=0){this.clientWidth=
Ua;this.scrollLeft=Lb;this.scrollWidth=Va?Va:Ua}}Object(G.a)(pb,"PageViewScrollContainerSizeInfo",null,[]);b.d(P,"FootnoteEndnoteControlManager",function(){return Db});class Db{constructor(Ua,Lb,Va,Sb,nb,La,Ha,Aa){this.IB=null;this.fb=Ua;this.Dn=Lb;this.tfj=Va;this.ufj=Sb;this.sfj=nb;this.uva=La;this.bna=Ha;this.pu=Aa;this.tW=k.KeyInputManager.mb(f.a.V5,0);this.Lff();this.KQ()}get control(){return this.IB}get dialog(){return this.control.dialog}get WQh(){return this.control.zF}OTe(){this.control.OTe()}DTc(){this.control.DTc()}bind(Ua){this.Pbk(Ua)}ZSf(Ua){if(this.control.Puc!==
Ua.STa)this.control.dismiss();else if(this.WQh)return;this.rXb();this.control.dca(Ua.STa);this.control.show(Ua.y1d)}rXb(){if(this.pu){const Ua=new m.a(!0);this.pu.qBa(Ua)}}IV(){this.control.setFocus()}yZc(){this.control.update()}iYe(Ua,Lb=!1){this.rXb();this.control.dismiss(Ua,Lb)}P0m(Ua){const Lb=Db.cBd().XI;Ua=this.uva.M_b(Ua,new pb(Lb.clientWidth,Lb.scrollLeft,Lb.scrollWidth));this.control.R0m(Ua)}dispose(){this.control.dispose();this.fb.fd(A.a.jca).Bp(this.tW)}q4e(Ua){F.ULS.shipAssertTag(4520074,
308,!!this.control);F.ULS.shipAssertTag(4520075,308,!!this.control.Puc);return this.r4e(this.control.Puc.id,Ua)}Pbk(Ua){const Lb=this.ufj(),Va=this.sfj();this.IB=this.tfj(Ua,Lb,Va,Object(L.a)(this,this.o5,"setFocusScopeForShow"),Object(L.a)(this,this.jen,"setFocusScopeForDismiss"))}Lff(){const Ua=this.fb.fd(A.a.jca);Ua.parent=3===x.AFrameworkApplication.pa.mode?l.AppFrame.iC:l.AppFrame.TRc;this.fb.pHe(A.a.jca);Ua.bindAction(this.tW,E.a.Vba)}KQ(){this.Dn.KQ(A.a.jca);this.Dn.KQ(A.a.mVa)}o5(){this.Dn.YB(A.a.jca);
this.Dn.YB(A.a.mVa);this.Dn.Bv(u.AFrame.Mp);this.fb.Atc(A.a.jca);this.fb.Kf(A.a.jca)}jen(Ua){this.Dn.Bv(A.a.jca);this.Dn.Bv(A.a.mVa);this.Dn.YB(u.AFrame.Mp);this.fb.Yyc(A.a.jca);(Ua||this.fb.nf&&(this.fb.nf.name===A.a.jca||this.fb.nf.name===A.a.mVa))&&this.fb.Kf(u.AFrame.Mp)}r4e(Ua,Lb){return()=>{const Va=Db.cBd().sc.Mb.Ra(Ua);this.bna.dYb();if(!Va.isConnected)return F.ULS.sendTraceTag(4520076,308,10,"{0}",{["Error"]:"Unable to restore footnoteEndnote control"}),null;this.ZSf(new M.a(Va,!0));return Lb}}static wk(){const Ua=
new Sa(w.a.instance.resolve("Box4.SectionAlignedViewPositionProvider"),x.AFrameworkApplication.isRtl);return new Db(r.FocusManager.instance(),z.App.oa.gu,oa.j1k,Ka.l1k,aa.f1k,Ua,Q.a.instance,w.a.instance.resolve("Box4.IPasteFloatieEventSource"),w.a.instance.resolve("Common.IAppSettingsManager"))}static cBd(){const Ua=z.App.oa.Da.Jb;return Ua&&Ua.Rh?Ua:null}static get instance(){return Db._instance||(Db._instance=Db.wk())}}Db._instance=null;Object(G.a)(Db,"FootnoteEndnoteControlManager",null,[657])},
1489:function(G,P,b){b.d(P,"a",function(){return f});b.d(P,"b",function(){return x});b.d(P,"c",function(){return u});var k=b(2);const f=(w,r)=>{const m=RegExp("mailto:(.*)").exec(w.url);r.email=m&&2===m.length?m[1]:w.url;r.resolveState=w.Tx.charAt(35)===b(1591).ACommentFormatTranslator.bRj?1:0},x=(w,r)=>{r.contentId=w.Tx},u=(w,r,m)=>{r.contentId=w.Tx;r.isCurrentUser=m.email===k.AFrameworkApplication.K.Ga("UserPrincipalName")}},1518:function(G,P,b){b.d(P,"a",function(){return f});G=b(0);P=b(159);var k=
b(103);class f extends P.a{constructor(){super();this.documentTypeConfidences=null;this.H_=Object.assign(new k.a,{T_:f.getTypeName(),B_:f.getBaseTypes()})}static getTypeName(){return"AugLoop_DocumentTypeClassifier_DocumentTypeClassifierAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(G.a)(f,"DocumentTypeClassifierAnnotation",P.a,[])},1521:function(G,P,b){b.d(P,"a",function(){return l});G=b(0);var k=b(2),f=b(79),x=b(8),u=b(41),w=b(91),r=b(70),m=b(591);class l{constructor(z,
F,L,E,A,M){this.Mve=null;this.HAg=0;this.fc=E;this.Hc=F;this.e2=A;this.tle=L;this.fgc=k.AFrameworkApplication.KSf();this.tde=z.appSettings.ChromeClipboardAccessOperationTimeout;this.cG=0;this.v$i=M;this.Cdj=z.$("EnableExternalPasteSupportOnMobileIsEnabled")}get SLa(){return this.e2.SLa}process(z,F){if(!this.cG)return this.Mzm(F);if(1===this.cG)return this.prepareForPaste(z,F);if(2===this.cG)return this.cG=3,this.Mve(z,F);3===this.cG&&this.e2.fDi(z,F);return!1}Mzm(z){let F=!0;this.Cdj&&(F=!(z.Qy&1));
this.Hc.G0&&F||z.Qy&512?(this.Mve=z.Qy&2?Object(u.a)(this.e2,this.e2.paste,"paste"):Object(u.a)(this.e2,this.e2.Pgi,"pasteInternal"),this.cG=2):(this.fgc?(this.cG=1,this.HAg=Date.now()):this.cG=2,this.Mve=Object(u.a)(this.e2,this.e2.paste,"paste"));m.a.n6l(z);return!0}prepareForPaste(z,F){z=!0;if(this.tle.value.Sii())this.cG=2;else{const L=Date.now()-this.HAg;L>this.tde&&(x.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",L),this.fc.ib(w.a.ria,{["Reason"]:r.a.Gei}),F.cP&&(F.cP.fail("Prepare for paste timed out",
!1),f.Health.instance.recordQosError("PreparePasteTimedOut",[m.a.WTd],!1,!0,!0,!1,null)),F.failed=!0,z=!1,this.v$i.w2m())}return z}}Object(G.a)(l,"ClipboardOperationPasteProcessor",null,[734])},1522:function(G,P,b){b.d(P,"a",function(){return V});G=b(0);P=b(223);var k=b(2),f=b(79),x=b(59),u=b(128),w=b(8),r=b(246),m=b(69),l=b(1788),z=b(41),F=b(18),L=b(3),E=b(91),A=b(70),M=b(961),Q=b(19),R=b(49),K=b(1438),J=b(1523),O=b(591),N=b(247);class V extends P.a{constructor(W,ca,H,Z,aa,ja,Ba,la,ia,oa,ha,pa,Ea,
Fa,Ga,$a,fa,sa,qa,va,Ca,ta,Wa,Za,Ya,Ka,xa,Sa=!0){super();this.zfa=this.Iz=null;this.iJ=this.Ix=0;this.m7a=this.Rze=this.G6=this.Od=null;this.xT=!1;this.yQ=!0;this.ilg=!1;this.init(W);this.jk("ClipboardOperation");this.$bb(ia,ca,aa,ja,Ba);this.fc=oa;this.yd=ha;this.Hc=pa;this.Fb=Ea;this.dcg=Fa;this.fcg=Ga;this.ecg=$a;this.Hde=fa;this.TKb=sa;this.Ide=qa;this.fgc=la;this.Vfc=va;this.lGa=Ca;this.jzj=Sa;this.zq=ta;this.Bb=Wa;this.Xi=Za;this.pu=Ya;this._context=Z;this.i_=Ka;this.hRb=xa;Ba&&Object(r.a)(95,
Ba)&&(this.G6=Object(m.a)(739,Ba.ia(u.a.bpa,null)));this.G6||(this.G6=this.i_.gXc());this.Vjb=void 0===H||null===H?"NotAvailable":Object(l.a)(J.a,H);this.G6.CNj(this.Vjb.split(", "));W=this._context;if(this.hRb){if(!V.h_g(W,this.Hde,this.fc,this.G6,Sa)){this.Xp=8;this.finish();return}this.Od=W.view;this.xT=3===this.Od.$Ab;this.Ix=0;this.iJ=H;this.m7a=fa.SLa}else{if(!W.view.Cd){this.fc.ib(E.a.re,{["Reason"]:A.a.tCb});this.G6.fail("Not in interactive view",!0);this.Xp=8;this.finish();return}this.Od=
W.view;if(!this.Od.Ma){this.fc.ib(E.a.re,{["Reason"]:A.a.noSelection});this.G6.fail("No selection manager",!0);this.Xp=8;this.finish();return}this.xT=3===this.Od.$Ab;this.Ix=0;this.iJ=H;this.m7a=fa.SLa;if(Sa&&!(this.m7a&&this.m7a.Fa&&this.m7a.length)){this.fc.ib(E.a.re,{["Reason"]:A.a.noSelection});this.G6.fail("No selection when one required",!0);this.Xp=8;this.finish();return}}fa=Q.SelectionEditor.Cl(this.m7a.Fa);fa=!(this.iJ&16&&fa);fa=qa.QHl(H,this.If)&&fa;1!==this.behavior&&fa||(fa||this.G6.fail("Clipboard operation disabled for selection",
!0),this.Xp=fa?32:8,this.lla());!this.ilg&&this.Hc.sh&&(x.b("IPadCCP"),this.ilg=!0)}get If(){this.Rze||(this.Rze=R.a.Knd(this.m7a));return this.Rze}O9(){super.O9();this.m7a=null}run(){this.Ix||this.setup();1===this.Ix&&this.process();2===this.Ix&&this.teardownSync();3===this.Ix&&this.teardownAsync();4===this.Ix&&this.finish()}setup(){if(this.iJ&256&&this.fgc){this.yD||this.TKb.Z4j(this,this.iJ,this.Vjb);this.yD.run();if(this.yD.inProgress)return;this.yQ=this.yD.Jda;this.npd();if(!this.yQ){this.G6.fail("No access to system clipboard",
!0);this.Xp=8;this.Ix=4;this.eNd();return}}else w.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}; {3}",this.iJ,this.Vjb,this.Hc.wD,this.actionId);this.iJ&32&&!this.yd.hId(this.Od.Ma.If)?(w.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.fc.ib(E.a.re,{["Reason"]:A.a.ZVe}),this.G6.fail("Cut not allowed",!0),this.Vfc.show(),this.Xp=8,this.Ix=4):(this.iJ&16||this.iJ&32)&&F.a.instance.J(3)&&this.zq.bKd(this.Od.Ma.Ca.Fa)?(this.G6.fail("Selected content deleted in coauthoring",
!0),this.Bb.QGb(),this.Xp=8,this.Ix=4):(this.iJ&4096&&(this.pu.C8b(Object.assign(new M.a,{WIc:!0,iS:this.Vjb})),this.Xi.undo()),this.Ide.MDm(this.iJ),!this.Od.sc&&k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("WordEditorPasteFailuresImprovementIsEnabled")?(this.G6.fail("Interactive view has null target node",!0),this.Xp=8,this.Ix=4):(this.Iz=this.Fb.Ob(15),this.Iz.ql=this.actionId,this.Iz.Oa(this.Od.sc),this.Ix=1))}process(){if(!this.yD){w.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",
this.iJ,this.Vjb,this.Hc.wD);w.ULS.shipAssertTag(6305507,307,!this.zfa);this.zfa=new K.a(this._context,this.iJ,this.G6,this.c5,this.DB,void 0,this.Hc.wD,this.jzj,this.xT);let W;W=this.iJ&65536?Object(z.a)(this.dcg,this.dcg.process,"process"):this.iJ&64?Object(z.a)(this.fcg,this.fcg.process,"process"):this.iJ&1?Object(z.a)(this.Hde,this.Hde.process,"process"):Object(z.a)(this.ecg,this.ecg.process,"process");this.iJ&16&&this.Od.Ma.pta.doh();this.lGa.create(this,W,this.zfa).jk("ClipboardAction")}w.ULS.shipAssertTag(6305536,
307,!!this.yD);this.yD.run();this.yD.inProgress||(this.npd(),this.Ix=this.fg?2:3)}teardownSync(){this.zfa.Y2b&&(this.Iz.ql=L.a.typing);this.zfa.qJc&&this.Iz.tAa(this.zfa.jff,this.zfa.Gwf);this.Iz.dispose();this.Xp=this.zfa.failed?8:32;this.Ix=4}teardownAsync(){if(this.yD){if(this.yD.run(),this.yD.inProgress)return}else if(this.zfa.Y2b&&(this.Iz.ql=L.a.typing),this.Iz.SBa(this),this.zfa.qJc&&this.Iz.tAa(this.zfa.jff,this.zfa.Gwf),this.Iz.dispose(),this.OGe)return;this.Xp=this.zfa.failed?8:32;this.Ix=
4}finish(){this.pu.C8b(Object.assign(new M.a,{WIc:!1}));this.lla();32===this.response?w.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.iJ,this.Vjb,this.Hc.wD):w.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.iJ,this.Vjb,this.Hc.wD);this.i_.bca(this.G6);V.XNm&&this.W2l()}eNd(){const W=!!(this.iJ&1),ca=this._context.view;ca&&
O.a.eNd(W,ca.Ma,this.Hc.wD)}W2l(){if(!(this.iJ&4||this.iJ&64)){var W=new Map;W.set("isCopy",String.format("{0}",!!(this.iJ&16)));W.set("isIPad",String.format("{0}",this.Hc.sh));f.Health.instance.recordKpiUsage(O.a.r0g,0,O.a.POe,W);this.yQ||(W=Object.assign(new N.a,{extendedProperties:W}),f.Health.instance.recordKpiFailure(O.a.r0g,O.a.v2j,!0,!0,W))}}static get XNm(){null==V.Lxe&&(V.Lxe=!!k.AFrameworkApplication.K&&k.AFrameworkApplication.K.$("RecordCcpErrorDialogKpiIsEnabled"));return V.Lxe}static iIf(W,
ca,H,Z){W&&W.ib(E.a.re,{["Reason"]:H});ca&&ca.fail(Z,!0)}static h_g(W,ca,H=null,Z=null,aa=!0){return W.view.Cd?W.view.Ma?!aa||ca.SLa&&ca.SLa.Fa&&ca.SLa.length?!0:(V.iIf(H,Z,A.a.noSelection,"Paste target is invalid"),!1):(V.iIf(H,Z,A.a.noSelection,"No selection manager"),!1):(V.iIf(H,Z,A.a.tCb,"Not in interactive view"),!1)}}V.Lxe=null;Object(G.a)(V,"ClipboardOperation",P.a,[])},1523:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);var k;(function(f){f[f.paste=1]="paste";f[f.textOnly=2]="textOnly";
f[f.overtype=4]="overtype";f[f.copy=16]="copy";f[f.deleteSelection=32]="deleteSelection";f[f.move=64]="move";f[f.useSystemClipboard=256]="useSystemClipboard";f[f.forceInternalClipboard=512]="forceInternalClipboard";f[f.reformatPastedContent=4096]="reformatPastedContent";f[f.pasteAsPlainText=8192]="pasteAsPlainText";f[f.showPlaceholderGlossary=65536]="showPlaceholderGlossary";f[f.reformatPastedContentWithDesignerPaste=131072]="reformatPastedContentWithDesignerPaste"})(k||(k={}));Object(G.b)("ClipboardActionFlags",
k)},1524:function(G,P,b){b.r(P);b.d(P,"FootnoteEndnoteDefaultContentInserter",function(){return A});G=b(0);var k=b(23),f=b(51),x=b(2),u=b(39),w=b(644),r=b(30),m=b(6),l=b(17),z=b(41),F=b(1041),L=b(788),E=b(1440);class A{constructor(M,Q,R,K,J=null){this.Vb=M;this.p$i=Q;this.Ck=R;A.Vd=K;this.Ndg=J||A.Uik}get vC(){return A.Do||(A.Do=k.a.instance.resolve("Box4.IOutlineEditor"))}ihk(M,Q){var R=this.Vb.Dj();R.set(M);this.vC.ecb(R,null,!0);A.Vd.gGb(R.currentNode,this.Ck);M=u.OutlineElementNavigator.Fd(R);
A.D5.EVc(Q?Box4Intl.Box4Strings.L_StyleWordFootnoteText:Box4Intl.Box4Strings.L_StyleWordEndnoteText,M);R=this.Ndg(R.currentNode);A.characterPropertiesEditor.replaceTextRange(R,A.Nbh);this.pDl(M,Q)}pDl(M,Q){var R=this.p$i(131073);R.setValue(m.a.Qp,1===Q?36:35);R.setValue(m.a.uha,!0);R.setValue(l.a.I5,!0);const K=M.Mb.At(R,f.a.create());R=this.Ndg(M);A.characterPropertiesEditor.Lca(R,J=>L.a.getInstance(J,K,!0),E.a.Crh(M,Q))}static wk(){return new A(new w.a,Object(z.a)(F.a.instance,F.a.instance.createInstance,
"createInstance"),x.AFrameworkApplication.isRtl,k.a.instance.resolve("Box4.IOutlineElementEditor"))}static get D5(){return A.yv||(A.yv=k.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get characterPropertiesEditor(){return A.Tb||(A.Tb=k.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get instance(){return A._instance||(A._instance=A.wk())}static Uik(M){return r.a.Sb(M,0)}}A.Nbh=" ";A.Vd=null;A._instance=null;A.Do=null;A.yv=null;A.Tb=null;Object(G.a)(A,"FootnoteEndnoteDefaultContentInserter",
null,[704])},1525:function(G,P,b){b.d(P,"a",function(){return w});G=b(0);var k=b(644),f=b(507),x=b(1359),u=b(1440);class w{constructor(r,m){this.bna=m}gDd(r,m,l){return(r=this.bna.Eyh(r.node,l?r.cpBegin:r.cpEnd,m))?r.o0():null}LGh(r,m){return(r=this.bna.Hbl(r.node,r.cpBegin,m))?r.o0():null}static yDc(){return new w(f.a.instance,x.a.instance,new k.a,u.a.instance)}static get instance(){return w._instance||(w._instance=w.yDc())}}w._instance=null;Object(G.a)(w,"FootnoteEndnoteNavigator",null,[669])},
1534:function(G,P,b){b.d(P,"a",function(){return w});G=b(0);var k=b(1583),f=b(2),x=b(35),u=b(23);class w{constructor(r,m,l,z,F,L){this.Dna=r;this.Ena=m;this.wle=l;this.ZV=z;this.C4c=F;this.lKb=L}get JHi(){return!this.Ena&&!this.wle}get e9h(){return 2===this.lKb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get Jih(){return CommonUIStrings.l_OICErrorMessageNoOffice}get dLh(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get Cbb(){return CommonUIStrings.l_OICErrorHelpLink}get DJh(){return"OICFailure"}get icon(){return 3}get gkd(){return 2===
this.lKb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get XHa(){return CommonUIStrings.l_DefaultDialogTitle}IMm(r){this.p9h(r)}GYl(r){this.p9h(r)}p9h(r){let m=10;1===r?(u.a.instance.resolve("Common.IOfficeTrialExperience").dof(this.lKb),m=3):2===r&&((!this.wle||this.wle(this.ZV))&&this.Ena&&k.a.instance.ekk(this.Ena,this.Dna,this.ZV),m=5);(0===r||1===r)&&this.Dna&&this.Dna(this.ZV);f.AFrameworkApplication.tTc(x.a.uei,this.C4c,m);this.dispose()}dispose(){this.ZV=
this.Ena=this.Dna=null}}Object(G.a)(w,"AOICErrorDialogWithTrial",null,[14])},1581:function(G,P,b){G=b(0);var k=b(2),f=b(15),x=b(23),u=b(551),w=b(1352),r=b(1224),m=b(27);class l{constructor(Ya,Ka=null){this.pnj=Ya;this.gU=Ka||w.a.N7e(f.a.Jsb,"")}get Bw(){return this.pnj}get Db(){return this.gU}eQf(Ya){this.Db.d++;return this.Bw.eQf(Ya)}W$b(Ya){this.Db.e++;return this.Bw.W$b(Ya)}jH(Ya){this.Db.f++;return this.Bw.jH(Ya)}bhb(Ya){this.Db.h++;return this.Bw.bhb(Ya)}r1(Ya){this.Db.i++;return this.Bw.r1(Ya)}v5(Ya){this.Db.j++;
return this.Bw.v5(Ya)}qla(Ya){this.Db.k++;return this.Bw.qla(Ya)}e$(Ya){this.Db.l++;return this.Bw.e$(Ya)}c0d(Ya){this.Db.m++;return this.Bw.c0d(Ya)}N_a(Ya,Ka=!1){this.Db.n++;return this.Bw.N_a(Ya,Ka)}fcf(){this.Db.o++;return this.Bw.fcf()}TTf(){this.Db.p++;return this.Bw.TTf()}at(Ya){this.Db.q++;return this.Bw.at(Ya)}Vsa(Ya){this.Db.r++;return this.Bw.Vsa(Ya)}J$b(Ya){this.Db.g++;return this.Bw.J$b(Ya)}HVc(Ya){return this.Bw.HVc(Ya)}dhb(Ya){this.Db.s++;return this.Bw.dhb(Ya)}H0d(Ya){this.Db.s++;return this.Bw.H0d(Ya)}OUe(Ya){this.Db.ba++;
return this.Bw.OUe(Ya)}O_d(Ya){this.Db.s++;return this.Bw.O_d(Ya)}chb(Ya){this.Db.s++;return this.Bw.chb(Ya)}lGb(Ya){this.Db.t++;return this.Bw.lGb(Ya)}Y0d(Ya){this.Db.u++;return this.Bw.Y0d(Ya)}wea(Ya){this.Db.v++;return this.Bw.wea(Ya)}ZQf(Ya){this.Db.bb++;return this.Bw.ZQf(Ya)}YBa(Ya){return this.Bw.YBa(Ya)}l5(Ya){this.Db.z++;return this.Bw.l5(Ya)}WLf(){return this.Bw.WLf()}xea(Ya,Ka){this.Db.w++;this.Db.x++;return this.Bw.xea(Ya,Ka)}sA(Ya){this.Db.y++;return this.Bw.sA(Ya)}clearFormatting(){return this.Bw.clearFormatting()}clone(){return new l(this.Bw.clone(),
this.Db)}}Object(G.a)(l,"FormattingStewardUsageCollector",null,[200]);class z extends l{constructor(Ya,Ka=null){super(Ya,Ka)}get L4(){return this.Bw}get Dr(){return this.L4.Dr}set Dr(Ya){this.L4.Dr=Ya}get textIndent(){return this.L4.textIndent}get marginLeft(){return this.L4.marginLeft}get vbc(){return this.L4.vbc}get cBa(){return this.L4.cBa}get lineSpacing(){return this.L4.lineSpacing}get kH(){return this.L4.kH}get leftIndent(){return this.L4.leftIndent}get J9(){return this.L4.J9}get paragraph(){return this.L4.paragraph}set paragraph(Ya){this.L4.paragraph=
Ya}get kO(){return this.L4.kO}get Gbc(){return this.L4.Gbc}c6d(Ya){return this.L4.c6d(Ya)}oZf(Ya){return this.L4.oZf(Ya)}clone(){const Ya=this.Bw.clone();return new z(Ya,this.Db)}}Object(G.a)(z,"FormattingStewardUsageCollector",l,[789,200]);var F=b(10),L=b(66),E=b(326),A=b(778),M=b(39),Q=b(206),R=b(87),K=b(40),J=b(51),O=b(348),N=b(139),V=b(16),W=b(79),ca=b(58),H=b(17),Z=b(6),aa=b(42),ja=b(247),Ba=b(484),la=b(350),ia=b(18),oa=b(110),ha=b(44),pa=b(71),Ea=b(186),Fa=b(1421),Ga=b(157),$a=b(30),fa=b(1154),
sa=b(630);class qa{constructor(Ya,Ka,xa,Sa,pb,Db,Ua,Lb,Va,Sb,nb=null){this.GB=this._paragraph=null;this.Hcd=0;this.vbg=this.Icd=null;this.fga=0;this.Zob=this.Gbc=this.leftIndent=this.kH=this.omc=this.cBa=this._tabStops=this._marginLeft=this._textIndent=null;this.paragraph=Ya;this.nd=Ka;this.yv=xa;this.Tk=Sa;this.lu=pb;this.RPa=Db;this.sL=Ua;this.l6=Lb;this.Qma=Va;this.fmb=Sb;nb?(m.a(4223818,307,!!nb.GB),this.GB=nb.GB.cpa(this.paragraph),this.Hcd=nb.r7b,this.Icd=nb.zCf,nb.cBa&&(this.cBa=new fa.a,this.cBa.afterSpacing.value=
nb.cBa.afterSpacing.value,this.cBa.beforeSpacing.value=nb.cBa.beforeSpacing.value),nb.lineSpacing&&(this.omc=nb.lineSpacing.clone()),this.fga=nb.fga,this.Gbc=nb.Gbc.clone(),this._textIndent=nb.textIndent,this._marginLeft=nb.marginLeft,this._tabStops=nb.vbc,this.kH=nb.kH,this.leftIndent=nb.leftIndent,nb.J9&&(this.Zob=nb.J9)):(this.GB=new Ea.a(this.paragraph,0),this.GB.formatting=new Ga.a(this.GB,J.a.nil),Ka=$a.a.av(Ya),Ka=this.lu.zr(Ka),this.hdn(Ka),this.Rpn(Ya)?(this.RPa.Cen(this.GB.formatting,Ka),
Ya.hasProperty(H.a.xk)?this.fga=Ya.getValue(H.a.xk):this.fga=0):this.fga=-1,this.Hcd=0,this.cBa=this.Icd=null,this.fmb&&(this.cBa=this.RPa.Fya(Ya),this.omc=this.RPa.cJa(Ya),this.kH=this.RPa.O_b(Ya),this.leftIndent=this.RPa.q0(Ya)),this.Gbc=new O.DictionaryPropertySet)}get paragraph(){return this._paragraph}set paragraph(Ya){m.a(4223816,307,!!Ya&&F.ParagraphReader.tb(Ya));this._paragraph=Ya}get kO(){return this.GB.formatting}get r7b(){return this.Hcd}get zCf(){return this.Icd}get Oz(){return this.vbg}get Dr(){return this.fga}set Dr(Ya){m.a(4223817,
307,1===Ya||2===Ya||3===Ya||6===Ya);this.fga=Ya}get textIndent(){return this._textIndent}get marginLeft(){return this._marginLeft}get vbc(){return this._tabStops}get lineSpacing(){return this.omc}get J9(){return this.Zob}get qb(){return this.Tk}hdn(Ya){const Ka=this.lu.language(Ya);Ka&&this.nd.fQf(this.GB.formatting,Ka,0,Ya.cache.bAb,!1)}Rpn(Ya){if(!ia.a.instance.J(10))return!0;Ya=this.qb.oe(this.qb.um(Ya));return Ya===ha.StyleReader.V_c||Ya===ha.StyleReader.wordStyleIdNormal||Ya===ha.StyleReader.Ejb||
Ya===ha.StyleReader.styleIdNormal}eQf(Ya){(Ya=u.a.af(Ya))&&this.nd.q0d(this.GB.formatting,Ya.LCID);return!0}W$b(){return!1}jH(Ya){this.nd.jH(this.GB.formatting,Ya);return!0}bhb(Ya){this.nd.setItalic(this.GB.formatting,Ya);return!0}r1(Ya){this.nd.r1(this.GB.formatting,Ya);return!0}v5(Ya){this.nd.v5(this.GB.formatting,Ya);return!0}qla(Ya){this.nd.qla(this.GB.formatting,Ya);return!0}e$(Ya){this.nd.e$(this.GB.formatting,Ya);return!0}c0d(Ya){if(0>=Ya)return!1;this.nd.nv(this.GB.formatting,Ya);return!0}N_a(Ya,
Ka){if(!Ya||""===Ya)return!1;if(({Cnh:xa}=N.FontUtils.PRi(Ya)).returnValue)return this.nd.CY(this.GB.formatting,xa.fontName),!0;var xa=!1;const Sa=N.FontUtils.qLa(Ya);Ka&&this.jdb(Sa,this.sL)&&(this.sL.spa(Ya),xa=!0);if(this.jdb(Sa,this.l6)||this.jdb(Sa,this.Qma))xa=!0;xa&&this.nd.CY(this.GB.formatting,Sa);return xa}jdb(Ya,Ka){return!!Ka&&Ka.isEnabled&&Ka.jdb(Ya)}fcf(){this.nd.lHh(this.GB.formatting);return!0}TTf(){this.nd.JIi(this.GB.formatting);return!0}at(Ya){var {Box4PasteSteward:Ka}=b(1322);
if(null===Ya||""===Ya)return!1;Ya=Ka.Qtb(Ya);Ka=null;this.J9&&this.J9.hasOwnProperty(Z.a.qe.id.toString())&&(Ka=this.J9[Z.a.qe.id.toString()]);this.nd.at(this.GB.formatting,Ya,Ka);return!0}Vsa(Ya){const {Box4PasteSteward:Ka}=b(1322);if(!Ya||""===Ya||!qa.Uml().contains(Ya))return!1;this.nd.Vsa(this.GB.formatting,Ka.Qtb(Ya));return!0}J$b(Ya){this.nd.J$b(this.GB.formatting,Ya);return!0}HVc(Ya){let Ka=0;switch(V.a.kg(Ya)){case "small-caps":Ka=1;break;case "uppercase":Ka=2}this.nd.Zk(this.GB.formatting,
aa.a.capitalization,Ka);return!0}l5(Ya){const {Box4PasteSteward:Ka}=b(1322);if(!Ya||""===Ya)return!1;this.Gbc.setValue(H.a.dI,parseInt(Ka.Qtb(Ya),16));return!0}chb(Ya){return 0>=Ya?!1:this.H0d(this.qb.rDh(Ya))}dhb(Ya){this.clearFormatting();this.Hcd=Ya;return!0}OUe(Ya){var {Box4PasteSteward:Ka}=b(1322),xa=new Map;xa.set("Source","CreateStyleCCP_FormattingSteward");W.Health.instance.recordKpiUsage(oa.a.wZi,0,oa.a.pF,xa);xa=pa.a.Zgl(Ya);Ya=[];Ya.push(xa);(Ya=pa.a.gHe(Ya,this.paragraph))?(Ka.nbc=this.qb.lp(),
m.b(593078085,3017,50,"Custom style created via paste.")):(Ka=new Map,Ka.set("Source","CreateStyleCCP_FormattingSteward"),Ka.set("IsStyleNull",(!xa).toString()),Ka=Object.assign(new ja.a,{extendedProperties:Ka}),W.Health.instance.recordKpiFailure(oa.a.wZi,"UnableToCreateStyle",!1,!0,Ka));return Ya}H0d(Ya){const {Box4PasteSteward:Ka}=b(1322);return Ya&&0<Ya.length&&Ka.nbc&&Ka.nbc.zg(Ya)?(this.Icd=Ya,!0):!1}O_d(Ya){const {Box4PasteSteward:Ka}=b(1322);return Ya&&0<Ya.length&&Ka.nbc&&Ka.nbc.zg(Ya)?(this.vbg=
Ya,!0):!1}oZf(Ya){if(this.Oz){Ya=this.qb.tw(Ya);if(!Ya)return m.a(41968715,307,!1),!1;(Ya=Ya.zg(this.Oz))&&this.nd.qhb(this.GB.formatting,Ya);return!0}return!1}xea(){return!1}sA(Ya){if(!Ya)return!1;const Ka=parseFloat(V.a.substring(Ya,0,V.a.kg(Ya).indexOf("px")));if(!isNaN(Ka))return this.omc=new sa.a(3,ca.a.ry(Ka,1)),!0;Ya=parseFloat(V.a.substring(Ya,0,V.a.kg(Ya).indexOf("%")));return isNaN(Ya)?!1:(this.omc=new sa.a(2,Ya/100),!0)}lGb(Ya){let Ka=0;if(!Ya||""===Ya)return!1;switch(Ya){case "left":Ka=
1;break;case "center":Ka=2;break;case "right":Ka=3;break;case "justify":Ka=6}if(!Ka)return!1;this.Dr=Ka;return!0}Y0d(Ya){this._textIndent=Ya;return!0}wea(Ya){this._marginLeft=Ya;return!0}ZQf(Ya){this._tabStops=Ya;return!0}YBa(Ya){this.Zob=JSON.parse(Ya);return this.J9?!0:!1}clearFormatting(){this.GB.formatting=new Ga.a(this.GB,J.a.nil);return!0}WLf(){this.fga=0;return!0}c6d(Ya){var {Box4PasteSteward:Ka}=b(1322);if(!ia.a.instance.J(10))return!1;if(0<this.r7b&&Ka.wZa[this.r7b]){m.a(4223819,307,1<=this.r7b);
m.a(4223820,307,7>=this.r7b);Ka=this.qb.tw(Ya);if(!Ka)return m.a(4223821,307,!1),!1;Ka=Ka.zg(b(1322).Box4PasteSteward.wZa[this.r7b]);this.yv.MK(Ka,Ya,!1);return!0}if(this.zCf){Ka=this.qb.tw(Ya);if(!Ka)return m.a(41968716,307,!1),!1;Ka=Ka.zg(this.zCf);this.yv.MK(Ka,Ya,!1);return!0}return!1}clone(){return new qa(this.paragraph,this.nd,this.yv,this.Tk,this.lu,this.RPa,this.sL,this.l6,this.Qma,this.fmb,this)}static Uml(){qa.SW||(qa.SW=new Ba.a(la.a.yi()),qa.SW.add(Fa.a.yellow),qa.SW.add(Fa.a.h_h),qa.SW.add(Fa.a.WTg),
qa.SW.add(Fa.a.Joh),qa.SW.add(Fa.a.blue),qa.SW.add(Fa.a.red),qa.SW.add(Fa.a.h7h),qa.SW.add(Fa.a.teal),qa.SW.add(Fa.a.green),qa.SW.add(Fa.a.purple),qa.SW.add(Fa.a.$3h),qa.SW.add(Fa.a.y9h),qa.SW.add(Fa.a.gray),qa.SW.add(Fa.a.rJi),qa.SW.add(Fa.a.black));return qa.SW}}qa.SW=null;Object(G.a)(qa,"FormattingSteward",null,[789,200]);class va{yZf(){return!1}zcf(Ya){return Ya}Ecf(){}YBa(){}w0d(){}EId(){return!1}get FJd(){return!1}sA(){}xea(){}P0d(){}get QGi(){return!1}}Object(G.a)(va,"NoOpPasteStewardBridge",
null,[536]);var Ca=b(76);class ta{constructor(Ya,Ka){this.Thm=Ya;this.Uhm=Ka||"Normal"}}Object(G.a)(ta,"NoteTagInfoBox4",null,[]);const Wa=Ya=>{const Ka=new Ca.a;for(const xa of Ya)Ya=new ta(xa.Thm,xa.Uhm),Ka.add(Ya);return Ka};b.d(P,"a",function(){return Za});class Za{constructor(Ya,Ka,xa=null,Sa=null){this.Qma=this.l6=this.sL=null;this.kMk=k.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.aAg=0;this.zb=Ya;this.I2=Ka;this.nZ=Sa||new va;this.Db=xa||w.a.N7e(f.a.Jsb,"")}get characterPropertiesEditor(){return Za.Tb||
(Za.Tb=x.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get fontService(){return this.sL||(this.sL=x.a.instance.ra("Box4.IFontService"))}get pUa(){return this.l6||(this.l6=x.a.instance.ra("Box4.CustomFontService"))}get $zk(){return this.Qma||(this.Qma=x.a.instance.ra("Box4.IEmbeddedFontService"))}reset(){}get dzc(){return this.U6e(!1)}U6e(Ya){m.a(4223770,307,K.OutlineElementReader.Gg(this.zb));const Ka=M.OutlineElementNavigator.Fd(this.zb);M.OutlineElementNavigator.Wc(this.zb);m.a(4223771,
307,!!Ka&&F.ParagraphReader.tb(Ka));Ya=new qa(Ka,Za.hh,Za.BB,Za.qb,Za.R3e,Za.CNk,this.fontService,this.pUa,this.$zk,this.kMk,void 0,Ya);return new z(Ya,this.Db)}z9(){}JAa(){}efb(){}Wra(){}FAa(){}vLa(){}uLa(){}iE(){}hE(){}bfb(){}afb(){}ALa(){}lZa(){}MAa(){}KAa(){}zLa(){}LAa(){}nZa(){}H5b(Ya){K.OutlineElementReader.Gg(this.zb)?(Za.Wf.Mqa(this.zb,!0),M.OutlineElementNavigator.Ir(this.zb,!1,!1)):R.OutlineReader.hv(this.zb)?Q.OutlineNavigator.I4(this.zb)?Ya?(this.zb.xf(),Za.vC.t_(this.zb,!1)):Za.Wf.OEb(this.zb):
Za.vC.t_(this.zb,!1):m.a(8128524,307,!1,"Unexpected node type {0} encountered",this.zb.Md)}cEc(Ya){let Ka=null;if(Ya&&Ya.Q4&&Ya.cultureName)try{Ka=Object.assign(new A.a,{languageId:u.a.af(Ya.cultureName).LCID})}catch(xa){m.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Ya.cultureName,xa)}Ka||null==this.I2||(Ka=Object.assign(new A.a,{languageId:this.I2}));return Ka}get kS(){return this.aAg}set kS(Ya){this.aAg=Ya}qmd(){}O5d(){}TPe(){}get hWb(){return!1}get Eub(){return!1}mZl(Ya){let Ka=1;
if(Ya.KTh){var xa=0;switch(Ya.listStyleType){case 1:Ka=0;break;case 7:Ka=1;break;case 8:Ka=2;break;case 9:Ka=3;break;case 10:Ka=4;break;case 11:Ka=5}}else switch(xa=1,Ya.listStyleType){case 1:Ka=0;break;case 3:Ka=1;break;case 4:Ka=2;break;case 5:Ka=3}let Sa;xa=(Sa=L.ListReader.oX)?E.a.$N(xa,Ka,Wa(Ya.vka),Ya.listId,Ya.qe,Ya.levelText,Ya.font):E.a.$N(xa,Ka,Wa(Ya.vka));3!==Ya.pq&&(xa.K1=Ya.pq);Ya.KTh&&!Ya.RPh&&(xa.vy=Sa&&0<Ya.listId&&0<=Ya.qe&&!Ya.w7b?Ya.$ac:Ya.dok);!xa.nq||3!==xa.listStyle&&5!==xa.listStyle||
(xa.Dr="right");r.a.zJc&&((Ya=Ya.Oof)&&xa.propertySet.Zq(Ya),xa.$Yb=!0);this.nZ.w0d(this.zb);return xa}y9(){}v9(){}x9(){}w9(){}u9(){}t9(){}static get Wf(){return Za.Vd||(Za.Vd=x.a.instance.resolve("Box4.IOutlineElementEditor"))}static get vC(){return Za.Do||(Za.Do=x.a.instance.resolve("Box4.IOutlineEditor"))}static get hh(){return Za.nd||(Za.nd=x.a.instance.resolve("Box4.IFormattingEditor"))}static get BB(){return Za.yv||(Za.yv=x.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get qb(){return Za.Tk||
(Za.Tk=x.a.instance.resolve("Box4.Styles.IWACStyleReader"))}static get R3e(){return Za.lu||(Za.lu=x.a.instance.resolve("Box4.IFormattingReader"))}static get CNk(){return Za.RPa||(Za.RPa=x.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}Za.Vd=null;Za.Do=null;Za.Tb=null;Za.nd=null;Za.yv=null;Za.Tk=null;Za.lu=null;Za.RPa=null;Za.zc=null;Object(G.a)(Za,"Box4PasteStewardBase",null,[768,188,189])},1583:function(G,P,b){G=b(0);var k=b(41),f=b(8),x=b(2),u=b(35),w=b(331),r=b(23);class m{constructor(K,
J,O,N){this.Yre=null;this.C4c=N;this.Dna=K;this.Ena=J;this.ZV=O;this.NFg=this.NBb.Mnn;K=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.bmj=K[0];this.amj=K[1]}get NBb(){return this.Yre||(this.Yre=r.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get Cbb(){return CommonUIStrings.l_OICErrorHelpLink}get gWc(){return this.NFg}get y3h(){return this.bmj}get x3h(){return this.amj}get w3h(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.NFg?
3:2}get YAc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get Bqd(){return!!this.Ena}get ZAc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get XHa(){return CommonUIStrings.l_DefaultDialogTitle}SHf(K){this.bOc(K)}Cof(K){this.bOc(K)}bOc(K){let J=10;this.Ena&&1===K&&(this.Ena(this.ZV),J=1);this.Dna&&this.Dna(this.ZV);this.kP(J)}BCb(){w.Redirect.showHelp("OICFailure");this.kP(2)}Wwf(){this.NBb.IZh();this.kP(4)}kP(K){f.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.C4c,K);x.AFrameworkApplication.tTc(u.a.sei,this.C4c,K)}dispose(){this.ZV=this.Dna=this.Ena=null}}Object(G.a)(m,"AOICErrorDialog",null,[14]);var l=b(25),z=b(132);class F extends m{constructor(K,J,O,N){super(K,J,O,N);this.u5a=this.cD=null;K=document.createElement("span");K.id="errorMessageText";K.innerText=this.errorMessage;K.appendChild(document.createElement("br"));K.appendChild(document.createElement("br"));this.cD=document.createElement("a");this.cD.href="#";this.cD.innerText=this.Cbb;K.appendChild(this.cD);
l.a.addHandler(this.cD,"click",Object(k.a)(this,this.BCb,"oicErrorHelpLinkHandler"));J=new z.StandardDialog;J.jf=this.id;this.gWc?(O=document.createElement("span"),N=document.createElement("span"),O.innerText=this.y3h,N.innerText=this.x3h,this.u5a=document.createElement("a"),this.u5a.href="#",this.u5a.innerText=this.w3h,K.appendChild(document.createElement("br")),K.appendChild(O),K.appendChild(this.u5a),K.appendChild(N),l.a.addHandler(this.u5a,"click",Object(k.a)(this,this.Wwf,"oicErrorMacOfferLinkHandler"))):
this.Bqd&&(K.appendChild(document.createElement("br")),K.appendChild(document.createElement("br")),O=document.createElement("span"),O.innerText=this.YAc,K.appendChild(O));this.Bqd?(J.yc=1,J.Nd(1,this.ZAc)):J.yc=0;J.mv(this.XHa,null,this.icon,Object(k.a)(this,this.Cof,"legacyOICErrorDialogHandler"),K);J.n5("errorMessageText")}dispose(){this.cD&&(l.a.removeHandler(this.cD,"click",Object(k.a)(this,this.BCb,"oicErrorHelpLinkHandler")),this.cD=null);this.u5a&&(l.a.removeHandler(this.u5a,"click",Object(k.a)(this,
this.Wwf,"oicErrorMacOfferLinkHandler")),this.u5a=null);super.dispose()}}Object(G.a)(F,"OICErrorDialog",m,[]);class L{constructor(K,J,O){this.Dna=J;this.Ena=K;this.ZV=O}get id(){return"OICErrorDialogWithDownload"}get Kih(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get Cbb(){return CommonUIStrings.l_OICErrorHelpLink}get YAc(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get ZAc(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get XHa(){return CommonUIStrings.l_DefaultDialogTitle}SHf(K){this.bOc(K)}Cof(K){this.bOc(K)}bOc(K){let J=
10;1===K&&(this.Ena(this.ZV),J=1);this.Dna&&this.Dna(this.ZV);this.kP(J)}BCb(){w.Redirect.showHelp("OICFailure");this.kP(2)}kP(K){x.AFrameworkApplication.tTc(u.a.tei,3,K)}dispose(){this.ZV=this.Ena=this.Dna=null}}Object(G.a)(L,"AOICErrorDialogWithDownload",null,[14]);class E extends L{constructor(K,J,O){super(K,J,O);this.cD=null;K=document.createElement("span");K.id="errorMessageText";K.innerText=this.Kih;K.appendChild(document.createElement("br"));K.appendChild(document.createElement("br"));this.cD=
document.createElement("a");this.cD.href="#";this.cD.innerText=this.Cbb;K.appendChild(this.cD);l.a.addHandler(this.cD,"click",Object(k.a)(this,this.BCb,"oicErrorHelpLinkHandler"));K.appendChild(document.createElement("br"));K.appendChild(document.createElement("br"));J=document.createElement("span");J.innerText=this.YAc;K.appendChild(J);J=new z.StandardDialog;J.jf=this.id;J.yc=1;J.Nd(1,this.ZAc);J.mv(this.XHa,null,this.icon,Object(k.a)(this,this.Cof,"legacyOICErrorDialogHandler"),K);J.n5("errorMessageText")}dispose(){this.cD&&
(l.a.removeHandler(this.cD,"click",Object(k.a)(this,this.BCb,"oicErrorHelpLinkHandler")),this.cD=null);super.dispose()}}Object(G.a)(E,"OICErrorDialogWithDownload",L,[]);var A=b(151);class M extends m{constructor(K,J,O,N){super(K,J,O,N);J={["errorMessage"]:this.errorMessage};J.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Cbb,["onExecute"]:V=>{this.BCb(V)}};this.gWc?(J.macOfficePreLinkText=this.y3h,J.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.w3h,
["onExecute"]:V=>{this.Wwf(V)}},J.macOfficePostText=this.x3h):this.Bqd&&(J.errorFileDownloadOffer=this.YAc);K=new A.a(!1,!1,!0);this.Bqd?(K.yc=1,K.Nd(1,this.ZAc)):K.yc=0;K.jf=this.id;J={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:J};K.Tg(this.XHa,Object(k.a)(this,this.SHf,"reactOICErrorDialogHandler"),J)}}Object(G.a)(M,"ReactOICErrorDialog",m,[]);class Q extends L{constructor(K,J,O){super(K,J,O);J={["errorMessage"]:this.Kih,["errorFileDownloadOffer"]:this.YAc};J.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.Cbb,["onExecute"]:N=>{this.BCb(N)}};K=new A.a(!1,!1,!0);K.yc=1;K.Nd(1,this.ZAc);K.jf=this.id;J={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:J};K.Tg(this.XHa,Object(k.a)(this,this.SHf,"reactOICErrorDialogHandler"),J)}}Object(G.a)(Q,"ReactOICErrorDialogWithDownload",L,[]);b.d(P,"a",function(){return R});class R{constructor(){this.una=!!x.AFrameworkApplication.na&&x.AFrameworkApplication.na.Ya.fA}dkk(K,J,O){this.una?new M(K,J,null,O):new F(K,J,null,O)}ekk(K,
J,O){this.una?new Q(K,J,O):new E(K,J,O)}fkk(K,J,O,N,V){const {ReactOICErrorDialogWithTrial:W}=b(1680),{OICErrorDialogWithTrial:ca}=b(1681);this.una?new W(K,J,O,null,N,V):new ca(K,J,O,null,N,V)}static get instance(){return R._instance||(R._instance=new R)}}R._instance=null;Object(G.a)(R,"OICErrorDialogFactory",null,[986])},1584:function(G,P,b){b.r(P);G=b(0);var k=b(434),f=b(23),x=b(99),u=b(92),w=b(67),r=b(1194),m=b(348),l=b(2),z=b(51),F=b(1255),L=b(146),E=b(36),A=b(15),M=b(257),Q=b(128),R=b(8),K=b(41),
J=b(231),O=b(246),N=b(69),V=b(303),W=b(14),ca=b(30),H=b(3),Z=b(12),aa=b(121),ja=b(506),Ba=b(49),la=b(1522),ia=b(1521),oa=b(591),ha=b(223);class pa extends ha.a{constructor(Ca,ta,Wa,Za,Ya,Ka){super();this.init(Ca);this.jk("DummyClipboardOperation");this.$bb(l.AFrameworkApplication.pa,ta,Za,Ya,Ka);this._context=Wa;this.Xp=8;this.lla()}run(){this.R4a=!0;this.aVc(this._context);this.LZa();this.Xp=32}}Object(G.a)(pa,"DummyClipboardOperation",ha.a,[]);ha=b(1392);class Ea extends ha.a{constructor(Ca,ta,
Wa,Za,Ya){super(Ca,ta,Ya);this.Ki=Wa;this.BAe=Za}Mcc(Ca){let ta;if(this.xN&&!Ca)return R.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,Jpa:null};ta=null;if(this.BAe&&!this.xN){const Wa=this.properties.ia(Q.a.Vgi,"");Wa&&(ta=this.Ki.Afb(Wa))}ta||(ta=this.Ki.Afb(Ca));return{returnValue:!0,Jpa:ta}}}Object(G.a)(Ea,"HtmlStringImportStrategy",ha.a,[]);var Fa=b(1667);class Ga extends Fa.a{constructor(Ca,ta,Wa,Za,Ya){super(Ca,ta,Wa,Za,Ya)}kAh(){return this.properties.ia(Q.a.B7b,
"")}Mcc(Ca){l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordUseClipboardDataHelperInMultiLineImportSettings");if(this.aGg){if(this.Ki)return Ca=this.Ki.NCf(Ca,!0),{returnValue:!0,Jpa:Ca};R.ULS.sendTraceTag(592269660,307,10,"_clipboardDataHelper should not be null")}return super.Mcc(Ca)}PLc(Ca){Ca=super.PLc(Ca);return Ca.length&&" "!==Ca?Ca:"\u00a0"}}Object(G.a)(Ga,"MultiLinePlainTextImportStrategy",Fa.a,[]);class $a extends ha.a{constructor(Ca,ta,Wa){super(Ca,ta,Wa)}Mcc(Ca){({ClipboardActor:ta}=
b(1584));if(this.xN&&!Ca)return R.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),{returnValue:!1,Jpa:null};var ta=ta.Nzm;ta.innerText=Ca;return{returnValue:!0,Jpa:ta}}}Object(G.a)($a,"PlainTextImportStrategy",ha.a,[]);var fa=b(91),sa=b(70);class qa{constructor(Ca){this.nra=this.dlf=!1;this.Xaa=Ca}Sii(){this.dlf||(this.dlf=!0,this.nra=!1,this.Xaa.prepareForPaste(()=>{this.nra=!0}));return this.nra}aRi(Ca){this.dlf=!1;Ca=this.Xaa.paste();return Ca?Ca.hasChildNodes()?{returnValue:!0,Jqd:Ca}:
(R.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),qa.Kb.ib(fa.a.XY,{["Reason"]:sa.a.X0e}),{returnValue:!1,Jqd:Ca}):(R.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),qa.Kb.ib(fa.a.Svb,{["Reason"]:sa.a.zWf}),{returnValue:!1,Jqd:Ca})}static get Kb(){return L.a.instance}}Object(G.a)(qa,"SystemClipboardImportStrategy",null,[743]);b.d(P,"ClipboardActor",function(){return va});class va{constructor(Ca,ta,Wa,Za,Ya,Ka,xa,Sa,pb,Db,Ua,Lb,Va,Sb,nb){this.k2c=null;this.tQa=0;this.f7c=this.Psc=
this.ulc=!1;this.wkb=k.a.On;this.i_=this.thd=null;this.z$i=Ca;this.Xaa=ta;this.fc=Wa;this.Ki=Za;this.ga=Ka;this.J2c=Db;this.TKb=Ua;this.Ic=Lb;this.Ue=Va;this.fb=pb;this.hRb=Sb;this.iRb=nb;Sa&&(this.ulc=Sa.$("SupportImageDragDropExternalIsEnabled"),this.Psc=Sa.$("UseClipboardDataHelperInMultiLineImportIsEnabled"),this.f7c=this.iRb&&Sa.$("HandleCtrlShiftVAsPasteTextOnlyIsEnabled"));this.Bx=new V.a;this.Bx.Z(H.a.paste,257);this.Bx.Z(H.a.Tda,8449);this.Bx.Z(H.a.F_,1);this.Bx.Z(H.a.ccb,1);this.Bx.Z(H.a.msb,
1);this.Bx.Z(H.a.vwa,1);this.Bx.Z(H.a.dHd,513);this.Bx.Z(H.a.reformatPastedContent,4097);this.Bx.Z(H.a.cgb,12289);this.Bx.Z(H.a.mMa,131073);this.Bx.Z(H.a.VCf,7);this.Bx.Z(H.a.Ngi,1);this.Bx.Z(H.a.YTd,8193);this.Bx.Z(H.a.copy,272);this.Bx.Z(H.a.lvc,16);this.Bx.Z(H.a.cut,304);this.Bx.Z(H.a.oNe,48);this.Bx.Z(H.a.YOd,64);this.Bx.Z(H.a.ZOd,64);this.Bx.Z(H.a.showPlaceholderGlossary,65536);this.ulc&&this.Bx.Z(H.a.mZe,1);this.f7c&&this.Bx.Z(H.a.y7b,this.Bx.J(H.a.YTd))}get lZh(){return this.tQa}set lZh(Ca){this.tQa=
Ca}get ENa(){return this.thd||(this.thd=f.a.instance.ra("Box4.Clipboard.ISystemClipboardAccessManager"))}get telemetry(){return this.i_||(this.i_=f.a.instance.ra("Common.Utils.Telemetry.ITelemetry"))}get Epd(){return this.z$i.value}get Yzn(){return this.Xaa}eb(){this.ga.Aa(H.a.hJm,W.a.application,Object(K.a)(this,this.uli,"queryPasteOptions"),97);this.ga.Aa(H.a.iJm,W.a.application,Object(K.a)(this,this.uli,"queryPasteOptions"),97);this.ga.Aa(H.a.aHf,W.a.application,Object(K.a)(this,this.fHf,"queryReformatPasteOptions"),
97);this.ga.Aa(H.a.bHf,W.a.application,Object(K.a)(this,this.fHf,"queryReformatPasteOptions"),97);this.ga.Aa(H.a.$Gf,W.a.application,Object(K.a)(this,this.fHf,"queryReformatPasteOptions"),97);this.ga.JQ(H.a.oNe,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),1028);this.ga.M7a(H.a.lvc,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"));this.ulc&&this.ga.JQ(H.a.mZe,W.a.view,Object(K.a)(this,this.yyk,"dropBrowserContent"),1028);this.ga.JQ(H.a.F_,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),
1028);this.ga.JQ(H.a.ccb,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),1028);this.ga.JQ(H.a.msb,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),1028);this.ga.JQ(H.a.vwa,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),1028);this.hRb&&this.ga.Aa(H.a.vTa,W.a.view,Object(K.a)(this,this.EFm,"processCallExecCommandPasteOperation"),1028);this.iRb&&this.ga.Aa(H.a.F8a,W.a.view,Object(K.a)(this,this.FFm,"processCallExecCommandPasteOperationTextOnly"),1028);this.ga.JQ(H.a.paste,W.a.view,Object(K.a)(this,
this.sU,"clipboardAction"),1028);this.ga.JQ(H.a.Tda,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),1028);this.ga.JQ(H.a.YTd,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),1028);this.ga.JQ(H.a.Ngi,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),1028);this.ga.JQ(H.a.VCf,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),1028);this.ga.JQ(H.a.reformatPastedContent,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),1028);this.ga.JQ(H.a.cgb,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),
1028);this.ga.ka(H.a.aFb,W.a.view,x.ActionManager.De);this.ga.ka(H.a.bhi,W.a.view,x.ActionManager.De);this.ga.ka(H.a.Zgi,W.a.view,x.ActionManager.De);this.ga.ka(H.a.$gi,W.a.view,x.ActionManager.De);this.ga.ka(H.a.ahi,W.a.view,x.ActionManager.De);this.ga.ka(H.a.Xgi,W.a.view,x.ActionManager.De);this.ga.M7a(H.a.YOd,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"));this.ga.M7a(H.a.ZOd,W.a.view,Object(K.a)(this,this.ZOd,"moveSelectedContentWithinCurrentParagraph"));this.ga.M7a(H.a.dHd,W.a.view,Object(K.a)(this,
this.sU,"clipboardAction"));this.ga.M7a(H.a.showPlaceholderGlossary,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"));this.f7c&&(this.ga.Aa(H.a.YUb,W.a.view,Object(K.a)(this,this.GFm,"processCallExecCommandPasteOperationTextOnlyShortcut"),1028),this.ga.JQ(H.a.y7b,W.a.view,Object(K.a)(this,this.sU,"clipboardAction"),1028));this.ga.ka(H.a.pah,W.a.view,x.ActionManager.De);this.ga.ka(H.a.Oah,W.a.view,x.ActionManager.De)}k1(){if(this.fb){const Ca=this.fb.fd(aa.AppFrame.iC);this.f7c&&Ca.bindAction(u.KeyInputManager.mb(w.a.$1a,
u.KeyInputManager.Bg|4),H.a.YUb)}else R.ULS.sendTraceTag(592196489,307,10,"Null focus manager and fail to register clipboard shortcuts.")}uli(Ca,ta,Wa,Za,Ya){if(1===Wa)return 32;Ya[r.a.On]=!1;return 32}yyk(Ca,ta,Wa,Za,Ya,Ka){R.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var xa=Ka.DataTransfer;Ka=xa.getData("text/html");xa=xa.getData("text/plain");let Sa=!1;const pb=new m.DictionaryPropertySet;0<Ka.length?(R.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),
pb.setValue(Q.a.jS,Ka),Sa=!0):0<xa.length&&(R.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),pb.setValue(Q.a.B7b,xa),Sa=!0);if(Sa){const Db=this.Bx.J(ta);return this.Epd.create(Ca,ta,Db,new J.a(()=>this.vzc(Db,pb)),Wa,Za,Ya,pb)}return null}fHf(Ca,ta,Wa,Za,Ya){if(ta="object"===typeof Ya?Ya:null)this.iRb?this.fcn(Ca,this.tQa,ta):Ca===H.a.aHf?(Ca=this.tQa!==H.a.reformatPastedContent&&this.tQa!==H.a.cgb,ta[this.wkb]=this.tQa===H.a.reformatPastedContent||Ca):Ca===H.a.bHf?
ta[this.wkb]=this.tQa===H.a.cgb:Ca===H.a.$Gf&&(ta[this.wkb]=this.tQa===H.a.mMa);return 32}fcn(Ca,ta,Wa){switch(ta){case H.a.cgb:case H.a.Tda:case H.a.y7b:ta=H.a.bHf;break;case H.a.mMa:ta=H.a.$Gf;break;default:ta=H.a.aHf}Wa[this.wkb]=Ca===ta}sU(Ca,ta,Wa,Za,Ya,Ka){if(l.AFrameworkApplication.protectFile||Z.App.mtb(Wa)&&this.uMl())return new pa(Ca,ta,Wa,Za,Ya,Ka);let xa=this.Bx.J(ta);1!==Za&&xa&1&&(this.tQa=ta);if(1!==Za){var Sa=Object(O.a)(95,Ka)?Ka:null;Ka?(xa&1&&(this.k2c=Sa),Sa=Sa?Sa.ia(Q.a.iS,0):
0,ta===H.a.paste&&Sa===H.a.vTa?xa=this.Bx.J(H.a.F_):ta===H.a.Tda&&Sa===H.a.F8a&&(xa=this.Bx.J(H.a.YTd))):!Ka&&xa&4096&&(Ka=this.k2c,Sa=Object(O.a)(95,Ka)?Ka:null)&&(Sa=Sa.ia(Q.a.JPc,z.a.nil),R.ULS.sendTraceTag(575255109,307,50,"Reformatting operation occurred. CorrelationId: {0}",Sa))}return this.Epd.create(Ca,ta,xa,new J.a(()=>this.vzc(xa,Ka)),Wa,Za,Ya,Ka)}Dal(){const Ca=Object(O.a)(95,this.k2c)?this.k2c:null;return Ca?Ca.ia(Q.a.JPc,z.a.nil):z.a.nil}GFm(Ca,ta,Wa,Za,Ya){return this.iOe(Ca,ta,Wa,Ya)}FFm(Ca,
ta,Wa,Za,Ya){return this.iOe(Ca,ta,Wa,Ya)}EFm(Ca,ta,Wa,Za,Ya){return this.iOe(Ca,ta,Wa,Ya)}iOe(Ca,ta,Wa,Za){if(1===Wa){if(!Object(O.a)(ja.a,ta)||!this.J2c)return 8;Wa=new J.a(()=>this.vzc(this.Bx.J(H.a.F_),Za));const Ya=this.J2c.create(Wa,Object(N.a)(95,Za));Wa=new ia.a(l.AFrameworkApplication.K,F.a.instance,Wa,L.a.instance,Ya,this.TKb);return la.a.h_g(ta,Wa)?32:8}if(2===Wa){if(this.Vmn(Z.App.vtc))return this.vTa(Ca);Z.App.J8b(()=>{this.vTa(Ca)});return 32}return 2}vTa(Ca){if(!this.Ic)return R.ULS.sendTraceTag(592454657,
307,10,"No _editingDomManager"),8;var ta=this.Ic.UIa();if(!ta)return R.ULS.sendTraceTag(592454658,307,10,"No ownerDocument"),8;ta=ta.am;if(!ta)return R.ULS.sendTraceTag(592454659,307,10,"No document"),8;R.ULS.sendTraceTag(592454660,307,50,"Calling execCommand. Command: {0}",Ca);this.Ue.nAk(Ca);Ca=E.a.Nvb(ta,"paste");ta=this.Ue.Euk();R.ULS.sendTraceTag(573388233,307,50,"PasteEventHandled: {0}",ta);if(Ca)return R.ULS.sendTraceTag(592454661,307,50,"execCommand succeeded"),32;this.rpl();R.ULS.sendTraceTag(592454662,
307,10,"execCommand failed");return 8}rpl(){this.ENa&&(this.ENa.TGb(),oa.a.eNd(!0,Ba.a.instance,A.a.wD));if(this.telemetry){const Ca=this.telemetry.gXc();Ca.UTb("CallExecCommandPasteOperation");Ca.fail("call to execCommand('paste') failed",!0);this.telemetry.bca(Ca)}}Vmn(Ca){let ta=!1;this.fb?this.fb.nf?ta=!this.fb.yif(this.fb.nf.name):R.ULS.sendTraceTag(573388235,307,10,"No CurrentScope"):R.ULS.sendTraceTag(573388234,307,10,"No _focusManager");if(ta){R.ULS.sendTraceTag(573388236,307,50,"CurrentScope: {0}",
this.fb.nf.name);if(1>Ca)return R.ULS.sendTraceTag(573388237,307,10,"Action callbacks will not execute"),!0;this.fb.onh();return!1}return!0}ZOd(Ca,ta,Wa,Za,Ya,Ka){Ka=ca.a.Sb(Ba.a.instance.Ca.Fa.sa.node,Ka);return this.sU(Ca,ta,Wa,Za,Ya,Ka)}uMl(){return l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableRibbonItemsOnIframeSelection",!1)?this.fb&&this.fb.nf.name.startsWith("IFrame-"):!1}vzc(Ca,ta){return Ca&256?new qa(this.Yzn):Ca&2?Ca&4096?
new Ea(ta,this.fc,this.Ki,Z.App.instance.hJc,Z.App.instance.gNa):new $a(ta,this.fc,Z.App.instance.gNa):ta.hasProperty(Q.a.B7b)?new Ga(ta,this.fc,this.Ki,this.Psc,Z.App.instance.gNa):new Ea(ta,this.fc,this.Ki,Z.App.instance.hJc,Z.App.instance.gNa)}static get Nzm(){return M.a.aCd("Box4PasteScratchPad")}g_g(Ca,ta,Wa,Za){return(Ca=this.sU(null,Ca?H.a.cut:H.a.copy,ta,1,Wa,Za))?Ca.response:8}}Object(G.a)(va,"ClipboardActor",null,[])},1591:function(G,P,b){b.r(P);G=b(0);var k=b(16),f=b(1791),x=b(1645);class u extends x.a{constructor(){super();
this.isCurrentUser=!1}}Object(G.a)(u,"IsMeAtMentionOptionalAttributes",x.a,[]);class w{constructor(){this.atmention=this.altText=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.color=this.highlight=null}}Object(G.a)(w,"DeltaAttributes",null,[]);var r=b(1422),m=b(10),l=b(73),z=b(17),F=b(8),L=b(1489);b.d(P,"ACommentFormatTranslator",function(){return E});class E{constructor(A){this.Ld=A}DNj(A,M){const Q=m.ParagraphReader.text(M);let R=null,K=null,J=null,O=
0;var N=0,V=!1;let W="";for(M.la||Q&&Q.length&&"\n"!==Q||F.ULS.sendTraceTag(50870150,327,10,"paragraph chps are null and paragraph text is null or empty");O<M.la.length;){const H=M.la.J(O),Z=H.cp;var ca=H.formatting?H.formatting.fm:null;W+=k.a.substring(Q,V?N+1:N,Z);H.Lk&&R&&(N=new f.a,N.fullName=W.startsWith("@")?W.substr(1):W,L.a(R,N),V=new u,L.c(R,V,N),A.ggf(W,N,V,!0),W="",R=null);H.Lk&&K&&(N=J||new w,N.link=K.url,A.yNh(W,N),W="",K=null);R&&K||""===W||(this.Ld.Asb&&J?(A.JNh(W,J),J=null):A.Nqa(W),
W="");H.hyperlink&&(H.hyperlink.Tx?R=H.hyperlink:H.hyperlink.url&&(K=H.hyperlink));this.Ld.Asb&&ca&&(J=new w,J.weight=ca.ia(z.a.bold,!1)?r.a.lsf:0,J.italic=ca.ia(z.a.italic,!1),J.underline=ca.ia(z.a.underline,!1),J.strikethrough=ca.ia(z.a.strikethrough,!1),this.Ld.Qzb&&(ca.hasProperty(z.a.highlight)&&(N=ca.getValue(z.a.highlight),J.highlight=l.a.SA(N)),ca.hasProperty(z.a.fontColor)&&(ca=ca.getValue(z.a.fontColor),J.color=l.a.SA(ca))));N=Z;V=!!H.blob;O++}}}E.aRj="_@_";E.bRj="Z";Object(G.a)(E,"ACommentFormatTranslator",
null,[471])},1604:function(G,P,b){G=b(0);var k=b(151),f=b(16),x=b(60),u=b(23),w=b(2),r=b(41),m=b(232),l=b(161);class z{static get vf(){return k.a.fy(z.ll,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsFont,WordEditorIntl.WordEditorStrings.l_FootnoteEndnoteFormattingOptionsIndent)}}z.ll="<div class='FootnoteEndnoteDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='FontPlaceholder'></div> </div> <div class='FootnoteEndnoteDialogIndentTitle UIFontBold' id='IndentTitle'> <label id='IndentTitleLabel' class='WACDialogLabel' for='IndentControl' >{1}</label> </div> <div class='normal' id='IndentControl'> <div id='IndentPlaceholderStyles' class='FootnoteEndnoteDialogIndentPlaceholder'></div> </div>";
Object(G.a)(z,"FootnoteEndnoteFormattingOptionsDialogHtml",null,[]);var F=b(20),L=b(3);b.d(P,"a",function(){return E});class E extends k.a{constructor(A,M,Q){super();this.Zkg=!1;this.pT=null;this.Es=M;this.YP=!1;this.SMb=E.pMk;this.xg=A;this.ga=Q;this.jf="FootnoteEndnoteFormattingOptionsDialog";this.yc=2;this.vf=z.vf;this.Nd(1,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyButton);this.Nd(2,WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogApplyAllButton);
this.Tg(WordEditorIntl.WordEditorStrings.L_FootnoteEndnoteFormattingOptionsDialogTitle,Object(r.a)(this,this.JMk,"footnoteEndnoteFormattingOptionsHandler"),null);this.wbb=!1;document.getElementById("FontStyleComboBox").focus()}get fontName(){return this.pT}set fontName(A){this.pT=A;if(A=document.getElementById("FontSizeComboBox"))A.focus(),this.xg.updateCommandUI()}get fontSize(){return this.SMb}get wbb(){return this.Zkg}set wbb(A){this.Zkg=A;this.BBm()}cS(){this.Fnd("FontStyleComboBox","FontPlaceholder",
F.a.wxd.toString(),F.a.dli.toString(),F.a.bQc.toString(),WoncaIntl.WoncaStrings.L_FontName,"100px");this.Fnd("FontSizeComboBox","FontPlaceholder",F.a.xxd.toString(),L.a.UQc.toString(),F.a.cQc.toString(),WoncaIntl.WoncaStrings.L_FontSize,"32px");const A=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',
f.a.yX(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),""),M=String.format('<div aria-hidden="true" role="presentation">\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}1.{0}</div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonSeparator"></div>\r\n\t\t\t<div class="FootnoteEndnoteDialogIndentButtonText">{1}2.{0}</div></div>',f.a.yX(WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesIndentButtonText),"&nbsp;&nbsp;&nbsp;&nbsp;");this.qvc("NoStyle","IndentPlaceholderStyles",
F.a.Qnh.toString(),F.a.eli.toString(),A,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesNoIndentButtonTitle,"Size110by75");this.qvc("FirstLineIndent","IndentPlaceholderStyles",F.a.Pnh.toString(),F.a.GGf.toString(),M,WordEditorIntl.WordEditorStrings.l_FootnoteEndnotesFirstLineIndentButtonTitle,"Size110by75")}Fnd(A,M,Q,R,K,J,O){Q=m.c(A,Q,!0,!0,R,K,f.a.Wd(J),!0,O);this.Ard(A,M,Q,"Medium")}qvc(A,M,Q,R,K,J,O){Q=m.i(A,Q,R,f.a.Wd(K),f.a.Wd(J),O);this.Ard(A,M,Q,"Large",J)}Ard(A,M,Q,R,K=null){M=document.getElementById(M);
this.Es.KGa(A,Q);Q=this.Es.yab(A,R);K&&x.a.gmd(Q,String.format("{0}Label",A),K);M.appendChild(Q);this.Es.lS(A)}BBm(){this.Es.lS("NoStyle");this.Es.lS("FirstLineIndent")}JMk(A){switch(A){case 1:this.ga.processAction(F.a.Mnh,2);break;case 2:this.ga.processAction(F.a.Nnh,2);break;case 0:this.ga.processAction(F.a.Onh,2)}}dispose(){this.YP||(this.Es.DC("FontStyleComboBox"),this.Es.DC("FontSizeComboBox"),this.Es.DC("NoStyle"),this.Es.DC("FirstLineIndent"),this.YP=!0);this.xg.updateCommandUI();super.dispose()}static get NNa(){return u.a.instance.resolve("Common.IStandaloneRootController").w5}static p1k(){return new E(l.App.Hk,
E.NNa,w.AFrameworkApplication.pa)}static o1k(){return E.p1k()}}E.pMk=-1;Object(G.a)(E,"FootnoteEndnoteFormattingOptionsDialog",k.a,[])},1633:function(G,P,b){var k=this&&this.MS||(Object.create?function(x,u,w,r){void 0===r&&(r=w);var m=Object.getOwnPropertyDescriptor(u,w);if(!m||("get"in m?!u.UV:m.writable||m.configurable))m={enumerable:!0,get:function(){return u[w]}};Object.defineProperty(x,r,m)}:function(x,u,w,r){void 0===r&&(r=w);x[r]=u[w]}),f=this&&this.__exportStar||function(x,u){for(var w in x)"default"===
w||Object.prototype.hasOwnProperty.call(u,w)||k(u,x,w)};Object.defineProperty(P,"__esModule",{value:!0});f(b(1634),P);f(b(1635),P);f(b(1636),P);f(b(1637),P);G.exports.TableCell||Object.defineProperty(G.exports,"TableCell",{enumerable:!0,get:function(){return G.exports.TableCell}});G.exports.TableCellVerticalAlignment||Object.defineProperty(G.exports,"TableCellVerticalAlignment",{enumerable:!0,get:function(){return G.exports.TableCellVerticalAlignment}});G.exports.TableRow||Object.defineProperty(G.exports,
"TableRow",{enumerable:!0,get:function(){return G.exports.TableRow}});G.exports.WordTable||Object.defineProperty(G.exports,"WordTable",{enumerable:!0,get:function(){return G.exports.WordTable}})},1634:function(G,P){Object.defineProperty(P,"__esModule",{value:!0})},1635:function(G,P){Object.defineProperty(P,"__esModule",{value:!0});P.TableCellVerticalAlignment=void 0;G=P.TableCellVerticalAlignment||(P.TableCellVerticalAlignment={});G[G.Top=0]="Top";G[G.Center=1]="Center";G[G.Bottom=2]="Bottom"},1636:function(G,
P,b){Object.defineProperty(P,"__esModule",{value:!0});P.OOXmlTableDesign=P.TableDesign=void 0;var k=b(215);G=function(){function f(x){k.SchemaObject.assign(f,this,x)}Object.defineProperty(f.prototype,"metadata",{get:function(){return this.M_},set:function(x){this.M_=x},enumerable:!1,configurable:!0});f.getTypeName=function(){return"AugLoop_Table_TableDesign"};f.getBaseTypes=function(){return["AugLoop_Core_Annotation"]};f.typeGuard=function(x){return k.SchemaObject.matchesTypesFor(x,[f.getTypeName()])};
f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();P.TableDesign=G;G=function(){function f(x){k.SchemaObject.assign(f,this,x)}Object.defineProperty(f.prototype,"metadata",{get:function(){return this.M_},set:function(x){this.M_=x},enumerable:!1,configurable:!0});f.getTypeName=function(){return"AugLoop_Table_OOXmlTableDesign"};f.getBaseTypes=function(){return["AugLoop_Table_TableDesign","AugLoop_Core_Annotation"]};f.typeGuard=function(x){return k.SchemaObject.matchesTypesFor(x,[f.getTypeName()])};
f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();P.OOXmlTableDesign=G},1637:function(G,P,b){Object.defineProperty(P,"__esModule",{value:!0});P.WordOOXmlTableTile=P.WordTable=P.Table=P.TableCell=P.TableRow=void 0;var k=b(215);G=function(){function f(x){k.SchemaObject.assign(f,this,x)}f.getTypeName=function(){return"AugLoop_Table_TableRow"};f.getBaseTypes=function(){return[]};f.typeGuard=function(x){return k.SchemaObject.matchesTypesFor(x,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};
return f}();P.TableRow=G;G=function(){function f(x){k.SchemaObject.assign(f,this,x)}f.getTypeName=function(){return"AugLoop_Table_TableCell"};f.getBaseTypes=function(){return[]};f.typeGuard=function(x){return k.SchemaObject.matchesTypesFor(x,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();P.TableCell=G;G=function(){function f(x){k.SchemaObject.assign(f,this,x)}f.getTypeName=function(){return"AugLoop_Table_Table"};f.getBaseTypes=function(){return[]};f.typeGuard=function(x){return k.SchemaObject.matchesTypesFor(x,
[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();P.Table=G;G=function(){function f(x){k.SchemaObject.assign(f,this,x)}f.getTypeName=function(){return"AugLoop_Table_WordTable"};f.getBaseTypes=function(){return["AugLoop_Table_Table"]};f.typeGuard=function(x){return k.SchemaObject.matchesTypesFor(x,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();P.WordTable=G;G=function(){function f(x){k.SchemaObject.assign(f,this,x)}f.getTypeName=function(){return"AugLoop_Table_WordOOXmlTableTile"};
f.getBaseTypes=function(){return["AugLoop_Table_WordTable","AugLoop_Table_Table"]};f.typeGuard=function(x){return k.SchemaObject.matchesTypesFor(x,[f.getTypeName()])};f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};return f}();P.WordOOXmlTableTile=G},1645:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(){this.contentId=""}}Object(G.a)(k,"AtMentionOptionalAttributes",null,[])},1674:function(G,P){Object.defineProperty(P,"__esModule",{value:!0});P.r8f=void 0;P.r8f={About:"About",
AboutFollowUps:"AboutFollowUps",AboutFollowUpsLearnMore:"AboutFollowUpsLearnMore",AboutKeytip:"AboutKeytip",Above:"Above",AcceptChange:"AcceptChange",AcceptChangeKeytip:"AcceptChangeKeytip",Accessibility:"Accessibility",AccessibilityHelp:"AccessibilityHelp",AccessibilityHelpDescription:"AccessibilityHelpDescription",AccessibilityHelpKeytip:"AccessibilityHelpKeytip",AccessibilityMode:"AccessibilityMode",AccessibilityTab:"AccessibilityTab",AccessibilityTabKeyTip:"AccessibilityTabKeyTip",Acronyms:"Acronyms",
AcronymsKeytip:"AcronymsKeytip",Activity:"Activity",ActivityContextMenuLabel:"ActivityContextMenuLabel",AdaptiveGroupTitle:"AdaptiveGroupTitle",AddFromFiles:"AddFromFiles",AddFromFilesKeytip:"AddFromFilesKeytip",AddInsKeytipPrefix:"AddInsKeytipPrefix",AdditionalControls:"AdditionalControls",AddSpaceAfterParagraph:"AddSpaceAfterParagraph",AddSpaceAfterParagraphKeytip:"AddSpaceAfterParagraphKeytip",AddSpaceBeforeParagraph:"AddSpaceBeforeParagraph",AddSpaceBeforeParagraphKeytip:"AddSpaceBeforeParagraphKeytip",
AddSpacingAfter:"AddSpacingAfter",AddSpacingBefore:"AddSpacingBefore",AddToHeaderOrFooter:"AddToHeaderOrFooter",AlignLeft:"AlignLeft",AlignLeftKeytip:"AlignLeftKeytip",AlignRight:"AlignRight",AlignRightKeytip:"AlignRightKeytip",AlignTextLeft:"AlignTextLeft",AlignTextLeftKeytip:"AlignTextLeftKeytip",AlignTextRight:"AlignTextRight",AlignTextRightKeytip:"AlignTextRightKeytip",AlignmentMenuLabel:"AlignmentMenuLabel",AllBookmarks:"AllBookmarks",AllBookmarksKeytip:"AllBookmarksKeytip",AllBorders:"AllBorders",
AllBordersKeyTip:"AllBordersKeyTip",AltText:"AltText",AltTextPictureStandalone:"AltTextPictureStandalone",AltTextTableStandalone:"AltTextTableStandalone",AltTextKeytip:"AltTextKeytip",ApplyStyle:"ApplyStyle",ApplyStylesKeytip:"ApplyStylesKeytip",AtAGlance:"AtAGlance",AtAGlanceKeytip:"AtAGlanceKeytip",AutoCorrectOptions:"AutoCorrectOptions",AutoCorrectOptionsKeytip:"AutoCorrectOptionsKeytip",AutoDetectedHeadingsFeatureName:"AutoDetectedHeadingsFeatureName",AutoDetectedHeadingsShow:"AutoDetectedHeadingsShow",
AutoDetectedHeadingsHide:"AutoDetectedHeadingsHide",AutoDetectedHeadingsMoreInfo:"AutoDetectedHeadingsMoreInfo",AutoDetectedHeadingsDisabledMoreInfo:"AutoDetectedHeadingsDisabledMoreInfo",AutoDetectedHeadingsLearnMore:"AutoDetectedHeadingsLearnMore",AutomaticFontColor:"AutomaticFontColor",BarTab:"BarTab",BarTabStop:"BarTabStop",Below:"Below",BevelEdgeRectangle:"BevelEdgeRectangle",BeveledMatteWhite:"BeveledMatteWhite",BeveledOvalBlack:"BeveledOvalBlack",BevelPerspective:"BevelPerspective",BevelPerspectiveLeftWhite:"BevelPerspectiveLeftWhite",
Bing:"Bing",Bold:"Bold",BoldKeytip:"BoldKeytip",Bookmarks:"Bookmarks",BookmarksKeytip:"BookmarksKeytip",BorderColor:"BorderColor",BorderColorKeytip:"BorderColorKeytip",BorderLineStyle:"BorderLineStyle",BorderLineStyleKeyTip:"BorderLineStyleKeyTip",BorderLineWeight:"BorderLineWeight",BorderLineWeightKeyTip:"BorderLineWeightKeyTip",BorderSelection:"BorderSelection",BorderSelectionKeytip:"BorderSelectionKeytip",BottomBorder:"BottomBorder",BottomBorderKeyTip:"BottomBorderKeyTip",BtnHeaderFooter:"BtnHeaderFooter",
BtnHeaderFooterKeytip:"BtnHeaderFooterKeytip",BulletLibraryTitle:"BulletLibraryTitle",BulletsInDocumentTitle:"BulletsInDocumentTitle",BulletStyle1:"BulletStyle1",BulletStyle1Keytip:"BulletStyle1Keytip",BulletStyle2:"BulletStyle2",BulletStyle2Keytip:"BulletStyle2Keytip",BulletStyle3:"BulletStyle3",BulletStyle3Keytip:"BulletStyle3Keytip",BusinessBarCompatMessage:"BusinessBarCompatMessage",BusinessBarCompatTitle:"BusinessBarCompatTitle",BusinessBarContainsMalformedHyperlinkUris:"BusinessBarContainsMalformedHyperlinkUris",
BusinessBarMarkedAsFinal:"BusinessBarMarkedAsFinal",BusinessBarODTDocument:"BusinessBarODTDocument",BusinessBarODTDocumentDetailsLink:"BusinessBarODTDocumentDetailsLink",BusinessBarODTDocumentTitle:"BusinessBarODTDocumentTitle",BusinessBarReadOnlyRecommended:"BusinessBarReadOnlyRecommended",BusinessBarSigned:"BusinessBarSigned",ButtonOfficeAddins:"ButtonOfficeAddins",ButtonOfficeAddinsKeytip:"ButtonOfficeAddinsKeytip",Cancel:"Cancel",CatchUpActivity:"CatchUpActivity",CatchUpActivityKeytip:"CatchUpActivityKeytip",
Cell:"Cell",CenterTab:"CenterTab",CenterTabStop:"CenterTabStop",CenterShadowRectangle:"CenterShadowRectangle",CentimeterUnitPlaceholder:"CentimeterUnitPlaceholder",ChangeCase:"ChangeCase",ChangeCaseKeytip:"ChangeCaseKeytip",ChangeCaseCapitalizeEachWord:"ChangeCaseCapitalizeEachWord",ChangeCaseLower:"ChangeCaseLower",ChangeCaseSentence:"ChangeCaseSentence",ChangeCaseToggle:"ChangeCaseToggle",ChangeCaseUpper:"ChangeCaseUpper",ChangePicture:"ChangePicture",ChangePictureKeytip:"ChangePictureKeytip",ChangePictureFromBingPicture:"ChangePictureFromBingPicture",
ChangePictureFromBingPictureKeytip:"ChangePictureFromBingPictureKeytip",ChangePictureFromHost:"ChangePictureFromHost",ChangePictureFromHostKeytip:"ChangePictureFromHostKeytip",ChangePictureFromLocalDevice:"ChangePictureFromLocalDevice",ChangePictureFromLocalDeviceKeytip:"ChangePictureFromLocalDeviceKeytip",ChangePictureFromMobileDevice:"ChangePictureFromMobileDevice",ChangePictureFromMobileDeviceKeytip:"ChangePictureFromMobileDeviceKeytip",ChangePictureFromOneDrive:"ChangePictureFromOneDrive",ChangePictureFromOneDriveKeytip:"ChangePictureFromOneDriveKeytip",
ChangePictureFromOnlineM365Picture:"ChangePictureFromOnlineM365Picture",ChangePictureFromOnlineM365PictureKeytip:"ChangePictureFromOnlineM365PictureKeytip",CharacterUnitPlaceholder:"CharacterUnitPlaceholder",Checklist:"Checklist",ChecklistKeytip:"ChecklistKeytip",ClassicView:"ClassicView",ClassicViewKeytip:"ClassicViewKeytip",Clear:"Clear",ClearAllTabStops:"ClearAllTabStops",ClearButtonTooltip:"ClearButtonTooltip",ClearFormatting:"ClearFormatting",ClearFormattingKeytip:"ClearFormattingKeytip",ClearFormattingOneLineRibbonKeytip:"ClearFormattingOneLineRibbonKeytip",
ClearPictureStyle:"ClearPictureStyle",ClearPictureStyleStandalone:"ClearPictureStyleStandalone",ClearSearch:"ClearSearch",ClearTableFormatting:"ClearTableFormatting",ClearTableFormattingStandalone:"ClearTableFormattingStandalone",ClearTableFormattingKeytip:"ClearTableFormattingKeytip",ClipArt:"ClipArt",ClipArtKeytip:"ClipArtKeytip",ClipboardKeytip:"ClipboardKeytip",Close:"Close",CloseMenu:"CloseMenu",CoauthorGalleryGroupChat:"CoauthorGalleryGroupChat",CoauthorGalleryGroupChatKeytip:"CoauthorGalleryGroupChatKeytip",
CoauthorGalleryKeytip:"CoauthorGalleryKeytip",CoauthorGalleryStatusLabel:"CoauthorGalleryStatusLabel",CoauthorGalleryOverflowTitle:"CoauthorGalleryOverflowTitle",CoauthorGalleryTooltip:"CoauthorGalleryTooltip",CoauthorEnterString:"CoauthorEnterString",Column:"Column",ContinueNumbering:"ContinueNumbering",Conversation:"Conversation",Comment:"Comment",CommentKeytip:"CommentKeytip",Comments:"Comments",CommentsKeytip:"CommentsKeytip",CommentsTooltip:"CommentsTooltip",CompoundFrameBlack:"CompoundFrameBlack",
ContactCardButton:"ContactCardButton",ContactCardButtonKeytip:"ContactCardButtonKeytip",ContactSupport:"ContactSupport",ContactSupportKeytip:"ContactSupportKeytip",ContinuousView:"ContinuousView",ContinuousViewKeytip:"ContinuousViewKeytip",ConvertToPresentation:"ConvertToPresentation",ConvertToPresentationDescription:"ConvertToPresentationDescription",ConvertToPresentationKeytip:"ConvertToPresentationKeytip",Copy:"Copy",CopyHeadingLink:"CopyHeadingLink",CopyHyperlink:"CopyHyperlink",CopyKeyboardShortcutMac:"CopyKeyboardShortcutMac",
CopyKeyboardShortcutWindows:"CopyKeyboardShortcutWindows",CopyKeytip:"CopyKeytip",CopyLinkKeytip:"CopyLinkKeytip",CopyLinkMenuButtonKeytip:"CopyLinkMenuButtonKeytip",CopyTo:"CopyTo",Corrections:"Corrections",CreateNewStyle:"CreateNewStyle",CreateNewStyleKeytip:"CreateNewStyleKeytip",CreatePullQuote:"CreatePullQuote",Crop:"Crop",CropKeytip:"CropKeytip",CropMoreOptions:"CropMoreOptions",CropMoreOptionsKeytip:"CropMoreOptionsKeytip",CropOptions:"CropOptions",CustomTables:"CustomTables",CustomDictionary:"CustomDictionary",
Cut:"Cut",CutKeyboardShortcutMac:"CutKeyboardShortcutMac",CutKeyboardShortcutWindows:"CutKeyboardShortcutWindows",CutKeytip:"CutKeytip",DarkModeGroupTitle:"DarkModeGroupTitle",DarkModeGroupTitleTooltip:"DarkModeGroupTitleTooltip",DarkModeToggle:"DarkModeToggle",DarkModeToggleKeytip:"DarkModeToggleKeytip",DarkModeSwitchBackground:"DarkModeSwitchBackground",DarkModeSwitchBackgroundAriaLabel:"DarkModeSwitchBackgroundAriaLabel",DarkModeSwitchBackgroundKeytip:"DarkModeSwitchBackgroundKeytip",DarkModeSwitchBackgroundTooltipDark:"DarkModeSwitchBackgroundTooltipDark",
DarkModeSwitchBackgroundTooltipLight:"DarkModeSwitchBackgroundTooltipLight",DecimalTab:"DecimalTab",DecimalTabStop:"DecimalTabStop",DecreaseIndent:"DecreaseIndent",DecreaseIndentKeytip:"DecreaseIndentKeytip",DefineNewBullet:"DefineNewBullet",DefineNewBulletKeytip:"DefineNewBulletKeytip",DegreeUnitPlaceholder:"DegreeUnitPlaceholder",Delete:"Delete",DeleteAllComments:"DeleteAllComments",DeleteAllCommentsKeytip:"DeleteAllCommentsKeytip",DeleteAllResolvedComments:"DeleteAllResolvedComments",DeleteAllResolvedCommentsKeytip:"DeleteAllResolvedCommentsKeytip",
DeleteBookmark:"DeleteBookmark",DeleteBookmarkFloatieLabel:"DeleteBookmarkFloatieLabel",DeleteCells:"DeleteCells",DeleteCellsKeytip:"DeleteCellsKeytip",DeleteColumn:"DeleteColumn",DeleteColumnKeytip:"DeleteColumnKeytip",DeleteComment:"DeleteComment",DeleteCommentStandalone:"DeleteCommentStandalone",DeleteCommentKeytip:"DeleteCommentKeytip",DeleteKeytip:"DeleteKeytip",DeleteEntireColumn:"DeleteEntireColumn",DeleteEntireRow:"DeleteEntireRow",DeleteRepeatedWord:"DeleteRepeatedWord",DeleteRow:"DeleteRow",
DeleteRowKeytip:"DeleteRowKeytip",DeleteStyles:"DeleteStyles",DeleteStylesKeytip:"DeleteStylesKeytip",DeleteSavedStyles:"DeleteSavedStyles",DeleteTable:"DeleteTable",DeleteTableKeytip:"DeleteTableKeytip",DeleteTableMenuKeytip:"DeleteTableMenuKeytip",DesignIdeas:"DesignIdeas",Designer:"Designer",DesignerKeytip:"DesignerKeytip",DesignerTooltip:"DesignerTooltip",DesignerProactiveTitle:"DesignerProactiveTitle",DesignerProactiveMessage:"DesignerProactiveMessage",DesignerFullPaneErrorMessage:"DesignerFullPaneErrorMessage",
DesignerUnsupportedWarningTitle:"DesignerUnsupportedWarningTitle",DesignerUnsupportedWarningMessage:"DesignerUnsupportedWarningMessage",DesignerDocumentTooLongWarningTitle:"DesignerDocumentTooLongWarningTitle",DesignerDocumentTooLongWarningMessage:"DesignerDocumentTooLongWarningMessage",DesignerMultipleAuthorsErrorTitle:"DesignerMultipleAuthorsErrorTitle",DesignerMultipleAuthorsErrorMessage:"DesignerMultipleAuthorsErrorMessage",DesignerTryAnywayLabel:"DesignerTryAnywayLabel",DesignerLearnMoreLabel:"DesignerLearnMoreLabel",
DesignerShowAllLabel:"DesignerShowAllLabel",DesignerFRETitle:"DesignerFRETitle",DesignerFREMessage:"DesignerFREMessage",DesignerSuggestionCardHeader:"DesignerSuggestionCardHeader",DesignerFixAndReviewAllTextFormattingLabel:"DesignerFixAndReviewAllTextFormattingLabel",DesignerReviewLabel:"DesignerReviewLabel",DesignerReviewAllAfterApplyingThemeLabel:"DesignerReviewAllAfterApplyingThemeLabel",DesignerParagraphSingular:"DesignerParagraphSingular",DesignerParagraphPlural:"DesignerParagraphPlural",DesignerSuggestionSingular:"DesignerSuggestionSingular",
DesignerSuggestionPlural:"DesignerSuggestionPlural",DesignerOKLabel:"DesignerOKLabel",DesignerNoSuggestionsLabel:"DesignerNoSuggestionsLabel",DesignerFixSingular:"DesignerFixSingular",DesignerFixPlural:"DesignerFixPlural",DesignerIssueSingular:"DesignerIssueSingular",DesignerIssuePlural:"DesignerIssuePlural",DesignerFixAndReviewAllLabel:"DesignerFixAndReviewAllLabel",DesignerFixAllLabel:"DesignerFixAllLabel",DesignerReviewAllLabel:"DesignerReviewAllLabel",DesignerReviewAllTooltip:"DesignerReviewAllTooltip",
DesignerReviewingLabel:"DesignerReviewingLabel",DesignerNoIssuesFoundLabel:"DesignerNoIssuesFoundLabel",DesignerKeepAllLabel:"DesignerKeepAllLabel",DesignerUndoAllLabel:"DesignerUndoAllLabel",DesignerAcceptAllLabel:"DesignerAcceptAllLabel",DesignerRejectAllLabel:"DesignerRejectAllLabel",DesignerTitleFontText:"DesignerTitleFontText",DesignerSubtitleFontText:"DesignerSubtitleFontText",DesignerHeadingFontText:"DesignerHeadingFontText",DesignerBodyFontText:"DesignerBodyFontText",DesignerTitlePreviewText:"DesignerTitlePreviewText",
DesignerHeadingPreviewText:"DesignerHeadingPreviewText",DesignerBodyPreviewText1:"DesignerBodyPreviewText1",DesignerBodyPreviewText2:"DesignerBodyPreviewText2",DesignerTitlePreviewText_V2:"DesignerTitlePreviewText_V2",DesignerSubtitlePreviewText_V2:"DesignerSubtitlePreviewText_V2",DesignerHeading1PreviewText_V2:"DesignerHeading1PreviewText_V2",DesignerHeading2PreviewText_V2:"DesignerHeading2PreviewText_V2",DesignerHeading3PreviewText_V2:"DesignerHeading3PreviewText_V2",DesignerBodyPreviewText1_V2:"DesignerBodyPreviewText1_V2",
DesignerBodyPreviewText2_V2:"DesignerBodyPreviewText2_V2",DesignerAuthorPreviewText:"DesignerAuthorPreviewText",DesignerCompanyInstitutionPreviewText:"DesignerCompanyInstitutionPreviewText",DesignerCompanyInstitutionPreviewText_V2:"DesignerCompanyInstitutionPreviewText_V2",DesignerDatePreviewText:"DesignerDatePreviewText",DesignerThemesSectionHeader:"DesignerThemesSectionHeader",DesignerThemesHeader:"DesignerThemesHeader",DesignerCoverPagesSectionHeader:"DesignerCoverPagesSectionHeader",DesignerThemesWithText2ImageSectionHeader:"DesignerThemesWithText2ImageSectionHeader",
DesignerTemplatesSectionHeader:"DesignerTemplatesSectionHeader",DesignerTextToImageNoSuggestions:"DesignerTextToImageNoSuggestions",DesignerShowMoreThemesLabel:"DesignerShowMoreThemesLabel",DesignerMoreThemesLoadedAlert:"DesignerMoreThemesLoadedAlert",DesignerSendFeedbackHeadingLabel:"DesignerSendFeedbackHeadingLabel",DesignerSendFeedbackLabel:"DesignerSendFeedbackLabel",DesignerSendFeedbackTooltip:"DesignerSendFeedbackTooltip",DesignerJoinTestingGroupHeadingLabel:"DesignerJoinTestingGroupHeadingLabel",
DesignerJoinTestingGroupLabel:"DesignerJoinTestingGroupLabel",DesignerJoinTestingGroupTooltip:"DesignerJoinTestingGroupTooltip",DesignerFeedbackCallout:"DesignerFeedbackCallout",DesignerStyleAriaLabel:"DesignerStyleAriaLabel",DesignerStyleThemeWithDecoratorAriaLabel:"DesignerStyleThemeWithDecoratorAriaLabel",DesignerStyleTabularTitleDecoratorAriaLabel:"DesignerStyleTabularTitleDecoratorAriaLabel",DesignerStyleThemeImageDecoratorAriaLabel:"DesignerStyleThemeImageDecoratorAriaLabel",DesignerText2ImageDecoratorAriaLabel:"DesignerText2ImageDecoratorAriaLabel",
DesignerStyleCoverPageDecoratorAriaLabel:"DesignerStyleCoverPageDecoratorAriaLabel",DesignerStyleTabularTitleDecoratorAltTextTitle:"DesignerStyleTabularTitleDecoratorAltTextTitle",DesignerStyleImageD10TIAltTextTitle:"DesignerStyleImageD10TIAltTextTitle",DesignerStyleImageD1TIAltTextTitle:"DesignerStyleImageD1TIAltTextTitle",DesignerStyleImageD6TIAltTextTitle:"DesignerStyleImageD6TIAltTextTitle",DesignerLoadingStyleAriaLabel:"DesignerLoadingStyleAriaLabel",DesignerStyleFontAvenir:"DesignerStyleFontAvenir",
DesignerStyleFontCentury:"DesignerStyleFontCentury",DesignerStyleFontSitka:"DesignerStyleFontSitka",DesignerStyleFontWalbaum:"DesignerStyleFontWalbaum",DesignerStyleFontRockwellNova:"DesignerStyleFontRockwellNova",DesignerStyleFontUnivers:"DesignerStyleFontUnivers",DesignerStyleFontSagona:"DesignerStyleFontSagona",DesignerStyleFontFranklin:"DesignerStyleFontFranklin",DesignerStyleFontPerpetua:"DesignerStyleFontPerpetua",DesignerStyleFontAmasisMTPro:"DesignerStyleFontAmasisMTPro",DesignerStyleFontSabonNextLT:"DesignerStyleFontSabonNextLT",
DesignerStyleFontTradeGothicNext:"DesignerStyleFontTradeGothicNext",DesignerStyleFontCooperBlack:"DesignerStyleFontCooperBlack",DesignerStyleFontNeueHaasGroteskTextPro:"DesignerStyleFontNeueHaasGroteskTextPro",DesignerStyleFontTisaOffcSerifPro:"DesignerStyleFontTisaOffcSerifPro",DesignerStyleFontQuireSans:"DesignerStyleFontQuireSans",DesignerStyleFontGillSansNova:"DesignerStyleFontGillSansNova",DesignerStyleFontSagonaBook:"DesignerStyleFontSagonaBook",DesignerStyleFontAvenirNextDemiBold:"DesignerStyleFontAvenirNextDemiBold",
DesignerStyleFontTheHand:"DesignerStyleFontTheHand",DesignerStyleFontGoudyType:"DesignerStyleFontGoudyType",DesignerStyleFontPlantagenetCherokee:"DesignerStyleFontPlantagenetCherokee",DesignerStyleFontFootlightMTLight:"DesignerStyleFontFootlightMTLight",DesignerStyleFontBaskervilleOldFace:"DesignerStyleFontBaskervilleOldFace",DesignerStyleFontLucidaCalligraphy:"DesignerStyleFontLucidaCalligraphy",DesignerStyleFontEbrima:"DesignerStyleFontEbrima",DesignerStyleFontCorbel:"DesignerStyleFontCorbel",DesignerStyleColorBlueAccent:"DesignerStyleColorBlueAccent",
DesignerStyleColorOrangeAccent:"DesignerStyleColorOrangeAccent",DesignerStyleColorGreenAccent:"DesignerStyleColorGreenAccent",DesignerStyleColorMediumSlateBlue:"DesignerStyleColorMediumSlateBlue",DesignerStyleColorRoyalBlue:"DesignerStyleColorRoyalBlue",DesignerStyleColorPacificBlue:"DesignerStyleColorPacificBlue",DesignerErrorStateTitle:"DesignerErrorStateTitle",DesignerErrorStateMessage:"DesignerErrorStateMessage",DesignerTemporaryIssueTitle:"DesignerTemporaryIssueTitle",DesignerTrackChangeUnsupportedMessage:"DesignerTrackChangeUnsupportedMessage",
DesignerErrorStateTryAgainButton:"DesignerErrorStateTryAgainButton",DesignerRevertButtonLabel:"DesignerRevertButtonLabel",DesignerApplyThemeDialogMessage:"DesignerApplyThemeDialogMessage",DesignerNextThemeButtonLabel:"DesignerNextThemeButtonLabel",DesignerPreviousThemeButtonLabel:"DesignerPreviousThemeButtonLabel",DesignerEnableContextualSuggestions:"DesignerEnableContextualSuggestions",DesignerDisableContextualSuggestionsForSession:"DesignerDisableContextualSuggestionsForSession",DesignerDisableContextualSuggestionsTemporary:"DesignerDisableContextualSuggestionsTemporary",
DesignerDisableContextualSuggestionsPermanently:"DesignerDisableContextualSuggestionsPermanently",Diagnostics:"Diagnostics",DiagnosticsBuild:"DiagnosticsBuild",DiagnosticsDescription:"DiagnosticsDescription",DiagnosticsSessionId:"DiagnosticsSessionId",DialogMove:"DialogMove",DictationLabel:"DictationLabel",DictationKeytip:"DictationKeytip",DigitalPrintKeytip:"DigitalPrintKeytip",DirectPrintJewelButton:"DirectPrintJewelButton",DirectPrintJewelButtonKeytip:"DirectPrintJewelButtonKeytip",DirectPrintJewelDescription:"DirectPrintJewelDescription",
DistributeColumns:"DistributeColumns",DistributeColumnsKeytip:"DistributeColumnsKeytip",DistributeMenu:"DistributeMenu",DistributeMenuKeytip:"DistributeMenuKeytip",DistributeRows:"DistributeRows",DistributeRowsKeytip:"DistributeRowsKeytip",DocChatLabel:"DocChatLabel",DocChatKeytip:"DocChatKeytip",DoNotCheckForThisIssue:"DoNotCheckForThisIssue",DoNotCheckSpellingOrGrammar:"DoNotCheckSpellingOrGrammar",DoubleFrameBlack:"DoubleFrameBlack",Download:"Download",DownloadACopy:"DownloadACopy",DownloadACopyKeytip:"DownloadACopyKeytip",
DownloadAsODT:"DownloadAsODT",DownloadAsODTDescription:"DownloadAsODTDescription",DownloadAsODTKeytip:"DownloadAsODTKeytip",DownloadAsPDF:"DownloadAsPDF",DownloadAsPDFDescription:"DownloadAsPDFDescription",DownloadAsPDFKeytip:"DownloadAsPDFKeytip",DownloadDescription:"DownloadDescription",DownloadErrorReport:"DownloadErrorReport",DraftView:"DraftView",DraftViewKeytip:"DraftViewKeytip",Drawing:"Drawing",DrawingKeytip:"DrawingKeytip",DropShadowRectangle:"DropShadowRectangle",Edit:"Edit",EditBookmark:"EditBookmark",
EditBookmarkFloatieLabel:"EditBookmarkFloatieLabel",EditDocument:"EditDocument",EditHyperlink:"EditHyperlink",EditIllustration:"EditIllustration",EditInWord:"EditInWord",EditInWordFileMenu:"EditInWordFileMenu",EditInWordFileMenuDescription:"EditInWordFileMenuDescription",EditInWordKeytip:"EditInWordKeytip",EditInWordOneLineRibbonKeytip:"EditInWordOneLineRibbonKeytip",EditInWordWebAppDescription:"EditInWordWebAppDescription",Editor:"Editor",EditorKeytip:"EditorKeytip",EditorScoreInStatusBarTooltip:"EditorScoreInStatusBarTooltip",
EditorScorePercent:"EditorScorePercent",EditorSettings:"EditorSettings",EditView:"EditView",EditViewKeytip:"EditViewKeytip",EmailLink:"EmailLink",EmailLinkKeytip:"EmailLinkKeytip",Embed:"Embed",EmbedDescription:"EmbedDescription",EmbedKeytip:"EmbedKeytip",EmojiPlural:"EmojiPlural",EmojiSingle:"EmojiSingle",EmojiSingleKeytip:"EmojiSingleKeytip",Endnote:"Endnote",EndnoteKeytip:"EndnoteKeytip",Endnotes:"Endnotes",EndnotesKeytip:"EndnotesKeytip",Enterlink:"Enterlink",EnterlinkKeytip:"EnterlinkKeytip",
EquationTools:"EquationTools",EquationToolsKeyTip:"EquationToolsKeyTip",EquationToolsGroup:"EquationToolsGroup",EquationToolsShortHandName:"EquationToolsShortHandName",Error:"Error",Exit:"Exit",ExitKeytip:"ExitKeytip",Explore:"Explore",Export:"Export",ExportToPresentation:"ExportToPresentation",ExportToPresentationDescription:"ExportToPresentationDescription",ExternalContentChangeDefaultDialogDescription:"ExternalContentChangeDefaultDialogDescription",ExternalContentChangeDefaultDialogInformation:"ExternalContentChangeDefaultDialogInformation",
ExternalContentChangeDefaultDialogTitle:"ExternalContentChangeDefaultDialogTitle",ExternalContentGalleryChangeDefault:"ExternalContentGalleryChangeDefault",ExternalContentGalleryContent:"ExternalContentGalleryContent",ExternalContentGalleryHyperLink:"ExternalContentGalleryHyperLink",ExternalContentGalleryLabel:"ExternalContentGalleryLabel",FileAboutKeytip:"FileAboutKeytip",FileHomeKeytip:"FileHomeKeytip",FileInfoKeytip:"FileInfoKeytip",FileMenuBackButton:"FileMenuBackButton",FileMenuBackButtonAriaLabel:"FileMenuBackButtonAriaLabel",
FileMenuBlankDocument:"FileMenuBlankDocument",FileMenuPrintToWeb:"FileMenuPrintToWeb",FileMenuPrintToWebDescription:"FileMenuPrintToWebDescription",FileNewKeytip:"FileNewKeytip",FileOpenKeytip:"FileOpenKeytip",FilePrintKeytip:"FilePrintKeytip",FileSaveAsKeytip:"FileSaveAsKeytip",FileShareKeytip:"FileShareKeytip",FileTransformKeytip:"FileTransformKeytip",Find:"Find",FindKeytip:"FindKeytip",FindReplace:"FindReplace",FindTooltip:"FindTooltip",FindReplaceToolTip:"FindReplaceToolTip",FindResultText:"FindResultText",
FindWholeWords:"FindWholeWords",FirstLineIndent:"FirstLineIndent",Fit:"Fit",FlipHorizontalKeytip:"FlipHorizontalKeytip",FlipVerticalKeytip:"FlipVerticalKeytip",FollowPresenter:"FollowPresenter",FontColorAutomaticKeytip:"FontColorAutomaticKeytip",FontColorYellow:"FontColorYellow",FontColorGreen:"FontColorGreen",FontColorCyan:"FontColorCyan",FontColorMagenta:"FontColorMagenta",FontColorBlue:"FontColorBlue",FontColorRed:"FontColorRed",FontColorDarkBlue:"FontColorDarkBlue",FontColorDarkCyan:"FontColorDarkCyan",
FontColorDarkGreen:"FontColorDarkGreen",FontColorDarkMagenta:"FontColorDarkMagenta",FontColorDarkRed:"FontColorDarkRed",FontColorDarkYellow:"FontColorDarkYellow",FontColorGrey:"FontColorGrey",FontColorLightGrey:"FontColorLightGrey",FontColorBlack:"FontColorBlack",FontName:"FontName",FontNameKeytip:"FontNameKeytip",FontPickerAllFontsSection:"FontPickerAllFontsSection",FontPickerPinnedFontsSection:"FontPickerPinnedFontsSection",FontPickerMruSection:"FontPickerMruSection",FontPickerOrganizationSection:"FontPickerOrganizationSection",
FontPickerInfoCommand:"FontPickerInfoCommand",FontPickerPinnedTooltip:"FontPickerPinnedTooltip",FontPickerUnpinnedTooltip:"FontPickerUnpinnedTooltip",FontPickerThemeFontTooltip:"FontPickerThemeFontTooltip",FontPickerEmbeddedFontTooltip:"FontPickerEmbeddedFontTooltip",FontPickerPremiumFontTooltip:"FontPickerPremiumFontTooltip",FontPickerMissingFontTooltip:"FontPickerMissingFontTooltip",FontPickerCompatibilityFontTooltip:"FontPickerCompatibilityFontTooltip",FontPickerNewFontHeader:"FontPickerNewFontHeader",
FontPickerSearchNoResult:"FontPickerSearchNoResult",FontPickerNoActionLabel:"FontPickerNoActionLabel",FontPickerPremiumFontsTitle:"FontPickerPremiumFontsTitle",FontPickerPremiumFontsBody:"FontPickerPremiumFontsBody",FontPickerPremiumFontsBody2:"FontPickerPremiumFontsBody2",FontPickerHelpContentTitle:"FontPickerHelpContentTitle",FontPickerPinnedFontAnnouncement:"FontPickerPinnedFontAnnouncement",FontPickerUnPinnedFontAnnouncement:"FontPickerUnPinnedFontAnnouncement",FontPickerNumberOfSuggestionsAnnouncement:"FontPickerNumberOfSuggestionsAnnouncement",
FontPickerNoSuggestionsAnnouncement:"FontPickerNoSuggestionsAnnouncement",FontPickerNumberOfSuggestionsInGroupAnnouncement:"FontPickerNumberOfSuggestionsInGroupAnnouncement",FontPickerPinnedDescription:"FontPickerPinnedDescription",FontPickerUnpinnedDescription:"FontPickerUnpinnedDescription",FontPickerFontPinningTooltip:"FontPickerFontPinningTooltip",FontPickerFontMissingFontTooltip:"FontPickerFontMissingFontTooltip",FontPickerFontOtherActionTooltip:"FontPickerFontOtherActionTooltip",FontSize:"FontSize",
FontSizeKeytip:"FontSizeKeytip",FontSize8:"FontSize8",FontSize9:"FontSize9",FontSize10:"FontSize10",FontSize11:"FontSize11",FontSize12:"FontSize12",FontSize14:"FontSize14",FontSize16:"FontSize16",FontSize18:"FontSize18",FontSize20:"FontSize20",FontSize24:"FontSize24",FontSize26:"FontSize26",FontSize28:"FontSize28",FontSize36:"FontSize36",FontSize48:"FontSize48",FontSize72:"FontSize72",Footnote:"Footnote",FootnoteKeytip:"FootnoteKeytip",FootnotesMenu:"FootnotesMenu",FormatPainter:"FormatPainter",FormatPainterKeytip:"FormatPainterKeytip",
FormatPicture:"FormatPicture",FormatPictureAltSectionTitle:"FormatPictureAltSectionTitle",FormatPictureAltDescriptionLabel:"FormatPictureAltDescriptionLabel",FormatPictureAltTitleLabel:"FormatPictureAltTitleLabel",FormatPictureCropSectionTitle:"FormatPictureCropSectionTitle",FormatPictureCropBottomLabel:"FormatPictureCropBottomLabel",FormatPictureCropLeftLabel:"FormatPictureCropLeftLabel",FormatPictureCropRightLabel:"FormatPictureCropRightLabel",FormatPictureCropTopLabel:"FormatPictureCropTopLabel",
FormatPictureKeytip:"FormatPictureKeytip",FormatPictureEllipses:"FormatPictureEllipses",FormatPictureRotationSectionTitle:"FormatPictureRotationSectionTitle",FormatPictureRotationDegreeLabel:"FormatPictureRotationDegreeLabel",FrenchAccessibilityStatementLinkText:"FrenchAccessibilityStatementLinkText",FullJustify:"FullJustify",FullJustifyKeytip:"FullJustifyKeytip",GetLink:"GetLink",GrammarSettings:"GrammarSettings",GrammarSettingsKeytip:"GrammarSettingsKeytip",GiveFeedback:"GiveFeedback",GiveFeedbackShort:"GiveFeedbackShort",
GiveFeedbackDescription:"GiveFeedbackDescription",GiveFeedbackKeytip:"GiveFeedbackKeytip",GoToLocation:"GoToLocation",GoToLocationKeytip:"GoToLocationKeytip",GridTables:"GridTables",GroupAlignment:"GroupAlignment",GroupAlignmentStandalone:"GroupAlignmentStandalone",GroupApps:"GroupApps",GroupArrange:"GroupArrange",GroupClipboard:"GroupClipboard",GroupChanges:"GroupChanges",GroupCommentsKeytip:"GroupCommentsKeytip",GroupDelete:"GroupDelete",GroupDictation:"GroupDictation",GroupDocumentViews:"GroupDocumentViews",
GroupDocumentViewsTooltip:"GroupDocumentViewsTooltip",GroupEditing:"GroupEditing",GroupFindReplaceKeytip:"GroupFindReplaceKeytip",GroupFont:"GroupFont",GroupFontKeytip:"GroupFontKeytip",GroupFontTooltip:"GroupFontTooltip",GroupFootnoteEndnote:"GroupFootnoteEndnote",GroupHeaderFooter:"GroupHeaderFooter",GroupHeaderFooterKeytip:"GroupHeaderFooterKeytip",GroupHomeParagraphKeytip:"GroupHomeParagraphKeytip",GroupImageAdjust:"GroupImageAdjust",GroupImageSize:"GroupImageSize",GroupImageSizeFlyout:"GroupImageSizeFlyout",
GroupImageSizeKeytip:"GroupImageSizeKeytip",GroupImageText:"GroupImageText",GroupInsert:"GroupInsert",GroupInsertTooltip:"GroupInsertTooltip",GroupLanguage:"GroupLanguage",GroupLinks:"GroupLinks",GroupMedia:"GroupMedia",GroupMerge:"GroupMerge",GroupMergeKeytip:"GroupMergeKeytip",GroupMultimedia:"GroupMultimedia",GroupPageBreak:"GroupPageBreak",GroupPageLayoutParagraph:"GroupPageLayoutParagraph",GroupPageLayoutParagraphKeytip:"GroupPageLayoutParagraphKeytip",GroupPageSetup:"GroupPageSetup",GroupPageSetupTooltip:"GroupPageSetupTooltip",
GroupParagraph:"GroupParagraph",GroupParagraphTooltip:"GroupParagraphTooltip",GroupParagraphKeytip:"GroupParagraphKeytip",GroupPictureFormat:"GroupPictureFormat",GroupPictureFormatTooltip:"GroupPictureFormatTooltip",GroupPictureKeytip:"GroupPictureKeytip",GroupProofing:"GroupProofing",GroupProofingTooltip:"GroupProofingTooltip",GroupSelect:"GroupSelect",GroupShading:"GroupShading",GroupSpelling:"GroupSpelling",GroupStyles:"GroupStyles",GroupStylesTooltip:"GroupStylesTooltip",GroupStylesKeytip:"GroupStylesKeytip",
GroupTable:"GroupTable",GroupTableBorders:"GroupTableBorders",GroupTableDeleteKeytip:"GroupTableDeleteKeytip",GroupTableTooltip:"GroupTableTooltip",GroupTableOfContents:"GroupTableOfContents",GroupTableOfContentsKeytip:"GroupTableOfContentsKeytip",GroupTableOptionsKeytip:"GroupTableOptionsKeytip",GroupTables:"GroupTables",GroupTableSelectKeytip:"GroupTableSelectKeytip",GroupTableStyleOptions:"GroupTableStyleOptions",GroupTableStyles:"GroupTableStyles",GroupTracking:"GroupTracking",GroupTrackingKeytip:"GroupTrackingKeytip",
GroupTrackMarkup:"GroupTrackMarkup",GroupTrackMarkupKeytip:"GroupTrackMarkupKeytip",GroupUndoRedo:"GroupUndoRedo",GroupUndoRedoTooltip:"GroupUndoRedoTooltip",GroupWordCount:"GroupWordCount",Grow:"Grow",GrowFont:"GrowFont",GrowFontSize:"GrowFontSize",GrowFontSizeKeytip:"GrowFontSizeKeytip",GrowKeytip:"GrowKeytip",HangingIndent:"HangingIndent",HeadingDetectionInIdeas:"HeadingDetectionInIdeas",HeadingsExplanationFirst:"HeadingsExplanationFirst",HeadingsExplanationSecond:"HeadingsExplanationSecond",HeadingsExplanationThird:"HeadingsExplanationThird",
HeadingsTab:"HeadingsTab",Help:"Help",HelpButtonDescription:"HelpButtonDescription",HelpButtonKeytip:"HelpButtonKeytip",HelpButtonTitle:"HelpButtonTitle",HelpButtonTitleKeytip:"HelpButtonTitleKeytip",HelpImproveOffice:"HelpImproveOffice",HelpKeytip:"HelpKeytip",HelpTabKeytip:"HelpTabKeytip",HideRuler:"HideRuler",Highlight:"Highlight",HighlightColor:"HighlightColor",Hyperlink:"Hyperlink",HyperlinkKeytip:"HyperlinkKeytip",Ideas:"Ideas",IdeasKeytip:"IdeasKeytip",Ignore:"Ignore",IgnoreAll:"IgnoreAll",
IgnoreOnce:"IgnoreOnce",Illustrations:"Illustrations",IllustrationsKeytip:"IllustrationsKeytip",ImmersiveReaderKeytip:"ImmersiveReaderKeytip",ImmersiveView:"ImmersiveView",InchUnitPlaceholder:"InchUnitPlaceholder",IncludePageCount:"IncludePageCount",IncludePageCountKeytip:"IncludePageCountKeytip",IncreaseIndent:"IncreaseIndent",IncreaseIndentKeytip:"IncreaseIndentKeytip",Info:"Info",InfoKeytip:"InfoKeytip",Information:"Information",InsertAbove:"InsertAbove",InsertAboveStandalone:"InsertAboveStandalone",
InsertAboveKeytip:"InsertAboveKeytip",InsertBelow:"InsertBelow",InsertBelowStandalone:"InsertBelowStandalone",InsertBelowKeytip:"InsertBelowKeytip",InsertBookmark:"InsertBookmark",InsertBookmarkKeytip:"InsertBookmarkKeytip",InsertFilesLink:"InsertFilesLink",InsertFilesLinkKeyTip:"InsertFilesLinkKeyTip",InsertHyperlink:"InsertHyperlink",InsertHyperlinkKeytip:"InsertHyperlinkKeytip",InsertIntelligentPlaceholder:"InsertIntelligentPlaceholder",InsertLeft:"InsertLeft",InsertLeftStandalone:"InsertLeftStandalone",
InsertLeftKeytip:"InsertLeftKeytip",InsertPictureFrom:"InsertPictureFrom",InsertRight:"InsertRight",InsertRightStandalone:"InsertRightStandalone",InsertRightKeytip:"InsertRightKeytip",InsertTableMenuKeytip:"InsertTableMenuKeytip",InsertTableDialogKeytip:"InsertTableDialogKeytip",InsertTableOfContents:"InsertTableOfContents",InsertTableOfContentsKeytip:"InsertTableOfContentsKeytip",InsertTabStop:"InsertTabStop",InsideBorders:"InsideBorders",InsideBordersKeyTip:"InsideBordersKeyTip",InsideHorizontalBorder:"InsideHorizontalBorder",
InsideHorizontalBorderKeyTip:"InsideHorizontalBorderKeyTip",InsideVerticalBorder:"InsideVerticalBorder",InsideVerticalBorderKeyTip:"InsideVerticalBorderKeyTip",Insights:"Insights",InsightsDictionary:"InsightsDictionary",InsightsMenu:"InsightsMenu",InsightsMenuKeytip:"InsightsMenuKeytip",InsightsMenuSimplification:"InsightsMenuSimplification",IntelligentPlaceholderTabExplanationFirst:"IntelligentPlaceholderTabExplanationFirst",IntelligentPlaceholderTabExplanationSecond:"IntelligentPlaceholderTabExplanationSecond",
IntelligentPlaceholderTabExplanationThird:"IntelligentPlaceholderTabExplanationThird",IntelligentPlaceholderTabKeyboardShortcut:"IntelligentPlaceholderTabKeyboardShortcut",IntelligentPlaceholderTab:"IntelligentPlaceholderTab",Italic:"Italic",ItalicKeytip:"ItalicKeytip",JewelText:"JewelText",JewelTextKeytip:"JewelTextKeytip",JustifyBottomCenter:"JustifyBottomCenter",JustifyBottomCenterKeytip:"JustifyBottomCenterKeytip",JustifyBottomLeft:"JustifyBottomLeft",JustifyBottomLeftKeytip:"JustifyBottomLeftKeytip",
JustifyBottomRight:"JustifyBottomRight",JustifyBottomRightKeytip:"JustifyBottomRightKeytip",JustifyCenter:"JustifyCenter",JustifyCenterKeytip:"JustifyCenterKeytip",JustifyMiddleCenter:"JustifyMiddleCenter",JustifyMiddleCenterKeytip:"JustifyMiddleCenterKeytip",JustifyMiddleLeft:"JustifyMiddleLeft",JustifyMiddleLeftKeytip:"JustifyMiddleLeftKeytip",JustifyMiddleRight:"JustifyMiddleRight",JustifyMiddleRightKeytip:"JustifyMiddleRightKeytip",JustifyTopCenter:"JustifyTopCenter",JustifyTopCenterKeytip:"JustifyTopCenterKeytip",
JustifyTopLeft:"JustifyTopLeft",JustifyTopLeftKeytip:"JustifyTopLeftKeytip",JustifyTopRight:"JustifyTopRight",JustifyTopRightKeytip:"JustifyTopRightKeytip",KeypointsInIdeas:"KeypointsInIdeas",KeytipStartSequence:"KeytipStartSequence",KeytipStartKeyMac:"KeytipStartKeyMac",KeytipStartKeyWindows:"KeytipStartKeyWindows",LabelIndent:"LabelIndent",LabelIndentAfterLtr:"LabelIndentAfterLtr",LabelIndentBeforeLtr:"LabelIndentBeforeLtr",LabelSpacing:"LabelSpacing",LabelSpacingAfter:"LabelSpacingAfter",LabelSpacingBefore:"LabelSpacingBefore",
LanguageDialogDescription:"LanguageDialogDescription",LearnMore:"LearnMore",Left:"Left",LeftBorder:"LeftBorder",LeftBorderKeyTip:"LeftBorderKeyTip",LeftIndent:"LeftIndent",LeftTab:"LeftTab",LeftTabStop:"LeftTabStop",LegacyView:"LegacyView",LegacyViewKeytip:"LegacyViewKeytip",LineSpacing:"LineSpacing",LineSpacing_1_0:"LineSpacing_1_0",LineSpacing_1_15:"LineSpacing_1_15",LineSpacing_1_5:"LineSpacing_1_5",LineSpacing_2_0:"LineSpacing_2_0",LineSpacing_2_5:"LineSpacing_2_5",LineSpacing_3_0:"LineSpacing_3_0",
LineSpacingKeytip:"LineSpacingKeytip",LineSpacingOptions:"LineSpacingOptions",LineSpacingOptionsKeytip:"LineSpacingOptionsKeytip",LineUnitPlaceholder:"LineUnitPlaceholder",ListLibraryTitle:"ListLibraryTitle",ListTables:"ListTables",LiveViewInBrowser:"LiveViewInBrowser",LoadingMessage:"LoadingMessage",LockAspectRatio:"LockAspectRatio",LockAspectRatioKeytip:"LockAspectRatioKeytip",LoopComponent:"LoopComponent",LoopComponentKeytip:"LoopComponentKeytip",LoopComponentPoll:"LoopComponentPoll",LoopComponentPollKeytip:"LoopComponentPollKeytip",
ManageAccess:"ManageAccess",ManageAccessKeytip:"ManageAccessKeytip",ManageDefaultStyle:"ManageDefaultStyle",MarkAsRead:"MarkAsRead",MarkAsReadTooltip:"MarkAsReadTooltip",MarkAsReadKeytip:"MarkAsReadKeytip",MarkSelectedText:"MarkSelectedText",MarkupOnPage:"MarkupOnPage",MarkupOnPageKeytip:"MarkupOnPageKeytip",MarkupOnPageTooltip:"MarkupOnPageTooltip",MarkupOnPageAllMarkup:"MarkupOnPageAllMarkup",MarkupOnPageAllMarkupDescription:"MarkupOnPageAllMarkupDescription",MarkupOnPageAllMarkupKeytip:"MarkupOnPageAllMarkupKeytip",
MarkupOnPageAllMarkupTooltip:"MarkupOnPageAllMarkupTooltip",MarkupOnPageSimpleMarkupDescription:"MarkupOnPageSimpleMarkupDescription",MarkupOnPageSimpleMarkup:"MarkupOnPageSimpleMarkup",MarkupOnPageSimpleMarkupKeytip:"MarkupOnPageSimpleMarkupKeytip",MarkupOnPageSimpleMarkupTooltip:"MarkupOnPageSimpleMarkupTooltip",MatchCase:"MatchCase",MenuBullets:"MenuBullets",MenuClipboard:"MenuClipboard",MenuClipboardTooltip:"MenuClipboardTooltip",MenuBulletsKeytip:"MenuBulletsKeytip",MenuFootnoteKeytip:"MenuFootnoteKeytip",
MenuFontColor:"MenuFontColor",MenuFontColorFullDesc:"MenuFontColorFullDesc",MenuFontColorKeytip:"MenuFontColorKeytip",MenuHighlightColor:"MenuHighlightColor",MenuHighlightColorKeytip:"MenuHighlightColorKeytip",MenuInsertTable:"MenuInsertTable",MenuInsertTableDialog:"MenuInsertTableDialog",MenuInsertTableFull:"MenuInsertTableFull",MenuInsertTableGrid:"MenuInsertTableGrid",MarkIntelligentPlaceholderComplete:"MarkIntelligentPlaceholderComplete",MenuMoreStyles:"MenuMoreStyles",MenuMoreStylesKeytip:"MenuMoreStylesKeytip",
MenuMultilevelList:"MenuMultilevelList",MenuMultilevelListKeytip:"MenuMultilevelListKeytip",MenuNumbering:"MenuNumbering",MenuNumberingKeytip:"MenuNumberingKeytip",MenuShadingColor:"MenuShadingColor",MenuShadingColorKeytip:"MenuShadingColorKeytip",MenuSpellingAndGrammarKeytip:"MenuSpellingAndGrammarKeytip",MenuStyles:"MenuStyles",MenuTableAlignKeytip:"MenuTableAlignKeytip",MenuTableTheme:"MenuTableTheme",MenuTableThemeKeytip:"MenuTableThemeKeytip",MergeCells:"MergeCells",MergeCellsKeytip:"MergeCellsKeytip",
MetalFrame:"MetalFrame",MetalOval:"MetalOval",MetalRoundedRectangle:"MetalRoundedRectangle",MobileDevice:"MobileDevice",MobileDeviceKeytip:"MobileDeviceKeytip",ModerateFrameBlack:"ModerateFrameBlack",ModerateFrameWhite:"ModerateFrameWhite",ModernUXOptIn:"ModernUXOptIn",More:"More",MoreDocuments:"MoreDocuments",MoreTemplates:"MoreTemplates",ModernTranslator:"ModernTranslator",ModernTranslatorDocumentTitle:"ModernTranslatorDocumentTitle",ModernTranslatorDocumentKeytip:"ModernTranslatorDocumentKeytip",
ModernTranslatorKeytip:"ModernTranslatorKeytip",ModernTranslatorSelectionTitle:"ModernTranslatorSelectionTitle",ModernTranslatorSelectionKeytip:"ModernTranslatorSelectionKeytip",ModernTranslatorSettingsTitle:"ModernTranslatorSettingsTitle",ModernTranslatorSettingsKeytip:"ModernTranslatorSettingsKeytip",ModernTranslatorTaskPaneTitle:"ModernTranslatorTaskPaneTitle",ModeSwitcherCalloutTextMarkedAsFinal:"ModeSwitcherCalloutTextMarkedAsFinal",ModeSwitcherCalloutTextOpenReadOnly:"ModeSwitcherCalloutTextOpenReadOnly",
ModeSwitcherCalloutTextViewOnly:"ModeSwitcherCalloutTextViewOnly",ModeSwitcherCalloutTextIsReviewer:"ModeSwitcherCalloutTextIsReviewer",ModeSwitcherCalloutTextTrackChangeForEveryoneEnabled:"ModeSwitcherCalloutTextTrackChangeForEveryoneEnabled",ModeSwitcherCalloutTitleMarkedAsFinal:"ModeSwitcherCalloutTitleMarkedAsFinal",ModeSwitcherCalloutTitleOpenReadOnly:"ModeSwitcherCalloutTitleOpenReadOnly",ModeSwitcherCalloutTitleViewOnly:"ModeSwitcherCalloutTitleViewOnly",ModeSwitcherCalloutTitleIsReviewer:"ModeSwitcherCalloutTitleIsReviewer",
ModeSwitcherCalloutTitleTrackChangeForEveryoneEnabled:"ModeSwitcherCalloutTitleTrackChangeForEveryoneEnabled",ModeSwitcherEditModeInMenuDescription:"ModeSwitcherEditModeInMenuDescription",ModeSwitcherEditModeInMenuLabel:"ModeSwitcherEditModeInMenuLabel",ModeSwitcherEditModeLabel:"ModeSwitcherEditModeLabel",ModeSwitcherEditModeKeytip:"ModeSwitcherEditModeKeytip",ModeSwitcherEditModeTooltip:"ModeSwitcherEditModeTooltip",ModeSwitcherFlyoutAnchorKeytip:"ModeSwitcherFlyoutAnchorKeytip",ModeSwitcherMenuTitle:"ModeSwitcherMenuTitle",
ModeSwitcherSuggestModeInMenuDescription:"ModeSwitcherSuggestModeInMenuDescription",ModeSwitcherSuggestModeInMenuLabel:"ModeSwitcherSuggestModeInMenuLabel",ModeSwitcherSuggestModeLabel:"ModeSwitcherSuggestModeLabel",ModeSwitcherSuggestModeKeytip:"ModeSwitcherSuggestModeKeytip",ModeSwitcherSuggestModeTooltip:"ModeSwitcherSuggestModeTooltip",ModeSwitcherViewModeInMenuDescription:"ModeSwitcherViewModeInMenuDescription",ModeSwitcherViewModeInMenuLabel:"ModeSwitcherViewModeInMenuLabel",ModeSwitcherViewModeLabel:"ModeSwitcherViewModeLabel",
ModeSwitcherViewModeKeytip:"ModeSwitcherViewModeKeytip",ModeSwitcherViewModeTooltip:"ModeSwitcherViewModeTooltip",ModeSwitcherWarningPromptTrackChangesOff:"ModeSwitcherWarningPromptTrackChangesOff",ModeSwitchSuggestingContextMenu:"ModeSwitchSuggestingContextMenu",MoreEmojis:"MoreEmojis",MoreEmojisKeytip:"MoreEmojisKeytip",MoreColors:"MoreColors",MoreColorsKeytip:"MoreColorsKeytip",MorePanes:"MorePanes",MoreStyles:"MoreStyles",MoreStylesKeytip:"MoreStylesKeytip",MoreSymbols:"MoreSymbols",MoreSymbolsKeytip:"MoreSymbolsKeytip",
MoreTabs:"MoreTabs",MoveTo:"MoveTo",MRUErrorMessage:"MRUErrorMessage",MRUMoreLink:"MRUMoreLink",MultilevelList:"MultilevelList",MultilevelListLabelNumericalStyle:"MultilevelListLabelNumericalStyle",MultilevelListLabelAlphanumericalStyle:"MultilevelListLabelAlphanumericalStyle",MultilevelListLabelBulletedStyle:"MultilevelListLabelBulletedStyle",Navigation:"Navigation",NavigationStandalone:"NavigationStandalone",NavigationPaneButtonText:"NavigationPaneButtonText",NavigationPaneButtonTextKeytip:"NavigationPaneButtonTextKeytip",
NegativeSign:"NegativeSign",New:"New",NewBlankDocument:"NewBlankDocument",NewComment:"NewComment",NewCommentKeytip:"NewCommentKeytip",NewKeytip:"NewKeytip",NextChange:"NextChange",NextChangeStandalone:"NextChangeStandalone",NextChangeKeytip:"NextChangeKeytip",NextComment:"NextComment",NextCommentStandalone:"NextCommentStandalone",NextCommentKeytip:"NextCommentKeytip",NewDocuments:"NewDocuments",NextProofingError:"NextProofingError",NextSearchResult:"NextSearchResult",NextSpellingError:"NextSpellingError",
NextSpellingErrorKeytip:"NextSpellingErrorKeytip",No:"No",NoBorder:"NoBorder",NoBorderKeyTip:"NoBorderKeyTip",NoHighlight:"NoHighlight",NoHighlightKeytip:"NoHighlightKeytip",NoSuggestions:"NoSuggestions",NoneListStyle:"NoneListStyle",NoneListStyleKeytip:"NoneListStyleKeytip",NumberDecimalDigits:"NumberDecimalDigits",NumberDecimalSeparator:"NumberDecimalSeparator",NumberNegativePattern:"NumberNegativePattern",NumberGroupSeparator:"NumberGroupSeparator",NumberGroupSizes:"NumberGroupSizes",NumberingLibraryTitle:"NumberingLibraryTitle",
NumberingInDocumentTitle:"NumberingInDocumentTitle",NumberStyle1:"NumberStyle1",NumberStyle2:"NumberStyle2",NumberStyle3:"NumberStyle3",NumberStyle4:"NumberStyle4",NumberStyle5:"NumberStyle5",Ok:"Ok",OneDrive:"OneDrive",OneDriveKeytip:"OneDriveKeytip",OnlinePicture:"OnlinePicture",OnlinePictureFromBing:"OnlinePictureFromBing",OnlinePictureFromBingKeytip:"OnlinePictureFromBingKeytip",OnlinePictureFromBingSingular:"OnlinePictureFromBingSingular",OnlinePictureFromHost:"OnlinePictureFromHost",OnlinePictureFromHostKeytip:"OnlinePictureFromHostKeytip",
OnlinePictureFromHostSingular:"OnlinePictureFromHostSingular",OnlinePictureKeytip:"OnlinePictureKeytip",OnlineVideo:"OnlineVideo",OnlineVideoKeytip:"OnlineVideoKeytip",Open:"Open",OpenAccessibilityCheckerPane:"OpenAccessibilityCheckerPane",OpenAccessibilityCheckerPaneKeytip:"OpenAccessibilityCheckerPaneKeytip",OpenCommentPane:"OpenCommentPane",OpenCommentPaneKeytip:"OpenCommentPaneKeytip",ToggleContextualComments:"ToggleContextualComments",ToggleContextualCommentsKeytip:"ToggleContextualCommentsKeytip",
ToggleCommentsPane:"ToggleCommentsPane",ToggleCommentsPaneKeytip:"ToggleCommentsPaneKeytip",OpenHyperlink:"OpenHyperlink",OpenHyperlinkInSidebar:"OpenHyperlinkInSidebar",OpenInApp:"OpenInApp",OpenInBrowser:"OpenInBrowser",OpenInDesktop:"OpenInDesktop",OpenInRichClientDescription:"OpenInRichClientDescription",OpenKeytip:"OpenKeytip",OpenNavPaneIntelligentPlaceholderTab:"OpenNavPaneIntelligentPlaceholderTab",Options:"Options",OutsideBorders:"OutsideBorders",OutsideBordersKeyTip:"OutsideBordersKeyTip",
OverflowWell0Keytip:"OverflowWell0Keytip",OverflowWell1Keytip:"OverflowWell1Keytip",OverflowWell2Keytip:"OverflowWell2Keytip",OverflowWell3Keytip:"OverflowWell3Keytip",OverflowWell4Keytip:"OverflowWell4Keytip",OverflowWell5Keytip:"OverflowWell5Keytip",OverflowWellLabel:"OverflowWellLabel",PageA4:"PageA4",PageA5:"PageA5",PageCountTooltip:"PageCountTooltip",PageCustomMargins:"PageCustomMargins",PageCustomMarginsDescription:"PageCustomMarginsDescription",PageCustomMarginsKeytip:"PageCustomMarginsKeytip",
PageCustomSizes:"PageCustomSizes",PageCustomSizesDescription:"PageCustomSizesDescription",PageCustomSizesKeytip:"PageCustomSizesKeytip",PageExecutive:"PageExecutive",PageLandscape:"PageLandscape",PageLandscapeKeytip:"PageLandscapeKeytip",PageLegal:"PageLegal",PageLetter:"PageLetter",PageMargins:"PageMargins",PageMarginsKeytip:"PageMarginsKeytip",PageMarginsTop:"PageMarginsTop",PageMarginsBottom:"PageMarginsBottom",PageMarginsLeft:"PageMarginsLeft",PageMarginsRight:"PageMarginsRight",PageModerate:"PageModerate",
PageNarrow:"PageNarrow",PageNormal:"PageNormal",PageNumbers:"PageNumbers",PageNumbersKeytip:"PageNumbersKeytip",PageOffice2003:"PageOffice2003",PageOrientation:"PageOrientation",PageOrientationKeytip:"PageOrientationKeytip",PagePortrait:"PagePortrait",PagePortraitKeytip:"PagePortraitKeytip",PageSize:"PageSize",PageSizeKeytip:"PageSizeKeytip",PageWide:"PageWide",PaginationGroupTitle:"PaginationGroupTitle",PaginationGroupTitleTooltip:"PaginationGroupTitleTooltip",ParagraphOptions:"ParagraphOptions",
ParagraphOptionsToolTip:"ParagraphOptionsToolTip",Paste:"Paste",PasteFloatieFlyout:"PasteFloatieFlyout",PasteKeyboardShortcutMac:"PasteKeyboardShortcutMac",PasteKeyboardShortcutWindows:"PasteKeyboardShortcutWindows",PasteKeepFormatting:"PasteKeepFormatting",PasteKeytip:"PasteKeytip",PasteOptions:"PasteOptions",PasteTextOnly:"PasteTextOnly",PasteTextOnlyKeyboardShortcutMac:"PasteTextOnlyKeyboardShortcutMac",PasteTextOnlyKeyboardShortcutWindows:"PasteTextOnlyKeyboardShortcutWindows",PasteTextOnlyKeytip:"PasteTextOnlyKeytip",
PasteWithMergedFormatting:"PasteWithMergedFormatting",PeopleWellFlyoutLabel:"PeopleWellFlyoutLabel",PeripheralCommentsButton:"PeripheralCommentsButton",PerspectiveShadowWhite:"PerspectiveShadowWhite",Picture:"Picture",PictureBorder:"PictureBorder",PictureBorderDashes:"PictureBorderDashes",PictureBorderKeytip:"PictureBorderKeytip",PictureBorderNoOutline:"PictureBorderNoOutline",PictureBorderStyleSolid:"PictureBorderStyleSolid",PictureBorderStyleRoundDot:"PictureBorderStyleRoundDot",PictureBorderStyleDash:"PictureBorderStyleDash",
PictureBorderWeight:"PictureBorderWeight",PictureBorderWeightFourPointFive:"PictureBorderWeightFourPointFive",PictureBorderWeightOne:"PictureBorderWeightOne",PictureBorderWeightOnePointFive:"PictureBorderWeightOnePointFive",PictureBorderWeightThree:"PictureBorderWeightThree",PictureBorderWeightTwoPointTwoFive:"PictureBorderWeightTwoPointTwoFive",PictureBorderWeightZeroPointFive:"PictureBorderWeightZeroPointFive",PictureBorderWeightZeroPointSevenFive:"PictureBorderWeightZeroPointSevenFive",PictureBorderWeightZeroPointTwoFive:"PictureBorderWeightZeroPointTwoFive",
PictureStandalone:"PictureStandalone",PictureFromDevice:"PictureFromDevice",PictureHeightLabel:"PictureHeightLabel",PictureHeightTooltip:"PictureHeightTooltip",PictureHeightTooltipKeytip:"PictureHeightTooltipKeytip",PictureKeytip:"PictureKeytip",PictureScaleLabel:"PictureScaleLabel",PictureScaleTooltip:"PictureScaleTooltip",PictureScaleTooltipKeytip:"PictureScaleTooltipKeytip",PictureSizeDialogLauncherKeytip:"PictureSizeDialogLauncherKeytip",PictureStyles:"PictureStyles",PictureWidthLabel:"PictureWidthLabel",
PictureWidthTooltip:"PictureWidthTooltip",PictureWidthTooltipKeytip:"PictureWidthTooltipKeytip",PinRibbonTooltip:"PinRibbonTooltip",PixelsUnitPlaceholder:"PixelsUnitPlaceholder",PlainTables:"PlainTables",PointUnitPlaceholder:"PointUnitPlaceholder",PreviousChange:"PreviousChange",PreviousChangeStandalone:"PreviousChangeStandalone",PreviousChangeKeytip:"PreviousChangeKeytip",PreviousComment:"PreviousComment",PreviousCommentStandalone:"PreviousCommentStandalone",PreviousCommentKeytip:"PreviousCommentKeytip",
PreviousSearchResult:"PreviousSearchResult",PreviousVersions:"PreviousVersions",PreviousVersionsDescription:"PreviousVersionsDescription",PreviousVersionsKeytip:"PreviousVersionsKeytip",Print:"Print",PrintKeytip:"PrintKeytip",PrintToPdf:"PrintToPdf",PrintToPdfDescription:"PrintToPdfDescription",PrintToPdfKeytip:"PrintToPdfKeytip",PrintView:"PrintView",PrintViewKeytip:"PrintViewKeytip",Privacy:"Privacy",PrivacyDescription:"PrivacyDescription",PrivacyKeytip:"PrivacyKeytip",ProofingSplitButton:"ProofingSplitButton",
ProtectDocument:"ProtectDocument",ProtectDocumentKeytip:"ProtectDocumentKeytip",PublishKeytip:"PublishKeytip",Question:"Question",QuickStyles:"QuickStyles",QuickStylesKeytip:"QuickStylesKeytip",ReadingTimeToggle:"ReadingTimeToggle",ReadView:"ReadView",ReadViewKeytip:"ReadViewKeytip",Recent:"Recent",RecentColors:"RecentColors",RecentDocuments:"RecentDocuments",RecentLinks:"RecentLinks",RecentLinksError:"RecentLinksError",RecentLinksKeyTip:"RecentLinksKeyTip",Recommended:"Recommended",Redo:"Redo",RedoKeytip:"RedoKeytip",
References:"References",Refinements:"Refinements",ReflectedBevelBlack:"ReflectedBevelBlack",ReflectedBevelWhite:"ReflectedBevelWhite",ReflectedPerspectiveRight:"ReflectedPerspectiveRight",ReflectedRoundedRectangle:"ReflectedRoundedRectangle",RejectChange:"RejectChange",RejectChangeKeytip:"RejectChangeKeytip",RelaxedPerspectiveWhite:"RelaxedPerspectiveWhite",RemoveHyperlink:"RemoveHyperlink",RemovePageNumbers:"RemovePageNumbers",RemovePageNumbersKeytip:"RemovePageNumbersKeytip",RemoveSpaceAfterParagraph:"RemoveSpaceAfterParagraph",
RemoveSpaceAfterParagraphKeytip:"RemoveSpaceAfterParagraphKeytip",RemoveSpaceBeforeParagraph:"RemoveSpaceBeforeParagraph",RemoveSpaceBeforeParagraphKeytip:"RemoveSpaceBeforeParagraphKeytip",RemoveTableOfContents:"RemoveTableOfContents",RemoveTableOfContentsKeytip:"RemoveTableOfContentsKeytip",RenameButtonDescription:"RenameButtonDescription",RenameButtonTitle:"RenameButtonTitle",RenameButtonTitleKeytip:"RenameButtonTitleKeytip",Replace:"Replace",ReplaceAll:"ReplaceAll",ReplaceBoxPlaceholder:"ReplaceBoxPlaceholder",
ReplaceKeytip:"ReplaceKeytip",ReplaceTooltip:"ReplaceTooltip",ReplyWithChanges:"ReplyWithChanges",ReplyWithChangesDescription:"ReplyWithChangesDescription",ReplyWithChangesKeytip:"ReplyWithChangesKeytip",ReportAbuse:"ReportAbuse",ReportAbuseDescription:"ReportAbuseDescription",ReportAbuseKeytip:"ReportAbuseKeytip",Reset:"Reset",ResetPicture:"ResetPicture",ResetPictureKeytip:"ResetPictureKeytip",Resize:"Resize",ResizeCurrentValue:"ResizeCurrentValue",ResizeMaxValue:"ResizeMaxValue",ResizeMinValue:"ResizeMinValue",
ResizeModeOff:"ResizeModeOff",ResizeModeOn:"ResizeModeOn",ResumeAssistantAsCV:"ResumeAssistantAsCV",ResumeAssistantAsCVKeytip:"ResumeAssistantAsCVKeytip",ResumeAssistantAsResume:"ResumeAssistantAsResume",ResumeAssistantAsResumeKeytip:"ResumeAssistantAsResumeKeytip",ResetToMSDefault:"ResetToMSDefault",Retry:"Retry",ReuseFiles:"ReuseFiles",ReuseFilesKeyTip:"ReuseFilesKeyTip",Rewrite:"Rewrite",RewriteKeytip:"RewriteKeytip",RewriteSuggestionsString:"RewriteSuggestionsString",RibbonInsertPageBreak:"RibbonInsertPageBreak",
RibbonInsertPageBreakKeytip:"RibbonInsertPageBreakKeytip",RibbonLabel:"RibbonLabel",RibbonOptionTextDirection:"RibbonOptionTextDirection",RibbonScalingData:"RibbonScalingData",RibbonToggleKeytip:"RibbonToggleKeytip",Right:"Right",RightBorder:"RightBorder",RightBorderKeyTip:"RightBorderKeyTip",RightIndent:"RightIndent",RightTab:"RightTab",RightTabStop:"RightTabStop",Rotate:"Rotate",RotatedWhite:"RotatedWhite",RotateFlipHorizontal:"RotateFlipHorizontal",RotateFlipVertical:"RotateFlipVertical",RotateLeft90:"RotateLeft90",
RotateLeft90Keytip:"RotateLeft90Keytip",RotateMoreOptions:"RotateMoreOptions",RotateMoreOptionsKeytip:"RotateMoreOptionsKeytip",RotateOptions:"RotateOptions",RotateRight90:"RotateRight90",RotateRight90Keytip:"RotateRight90Keytip",RotateShapeKeytip:"RotateShapeKeytip",RoundedDiagonalCornerWhite:"RoundedDiagonalCornerWhite",Row:"Row",Ruler:"Ruler",RulerTextKeytip:"RulerTextKeytip",Save:"Save",SaveACopyOnline:"SaveACopyOnline",SaveAs:"SaveAs",SaveAsButtonDescription:"SaveAsButtonDescription",SaveAsKeytip:"SaveAsKeytip",
SaveStyles:"SaveStyles",SaveStylesKeytip:"SaveStylesKeytip",SaveATranslatedCopyAndEditDescription:"SaveATranslatedCopyAndEditDescription",SearchableMenuRegionLabel:"SearchableMenuRegionLabel",SearchableMenuSearchBoxLabel:"SearchableMenuSearchBoxLabel",SearchAgain:"SearchAgain",SearchAgainExplanation:"SearchAgainExplanation",SearchButtonTooltip:"SearchButtonTooltip",SearchPlaceholder:"SearchPlaceholder",SearchDocumentFor:"SearchDocumentFor",Select:"Select",SelectCell:"SelectCell",SelectCellKeytip:"SelectCellKeytip",
SelectColumn:"SelectColumn",SelectColumnKeytip:"SelectColumnKeytip",SelectHyperlink:"SelectHyperlink",SelectKeytip:"SelectKeytip",SelectRow:"SelectRow",SelectRowKeytip:"SelectRowKeytip",SelectTable:"SelectTable",SelectTableKeytip:"SelectTableKeytip",Sensitivity:"Sensitivity",SensitivityKeytip:"SensitivityKeytip",SetLanguageMenu:"SetLanguageMenu",SetLanguageMenuKeytip:"SetLanguageMenuKeytip",SetNumberingValue:"SetNumberingValue",Share:"Share",SharedNotes:"SharedNotes",ShareKeytip:"ShareKeytip",ShareMenuButtonKeytip:"ShareMenuButtonKeytip",
SharePeripheralKeytip:"SharePeripheralKeytip",ShareWithPeople:"ShareWithPeople",ShareWithPeopleDescription:"ShareWithPeopleDescription",ShareWithPeopleKeytip:"ShareWithPeopleKeytip",ShiftCellsLeft:"ShiftCellsLeft",ShiftCellsUp:"ShiftCellsUp",ShiftCellsRight:"ShiftCellsRight",ShowActivity:"ShowActivity",ShowActivityKeytip:"ShowActivityKeytip",ShowBookmarks:"ShowBookmarks",ShowBookmarksKeytip:"ShowBookmarksKeytip",ShowEndnotes:"ShowEndnotes",ShowEndnotesKeytip:"ShowEndnotesKeytip",ShowFootnotes:"ShowFootnotes",
ShowFootnotesKeytip:"ShowFootnotesKeytip",ShowHideFormattingMarks:"ShowHideFormattingMarks",ShowHideFormattingMarksKeytip:"ShowHideFormattingMarksKeytip",ShowIntentSuggestion:"ShowIntentSuggestion",ShowIntentSuggestionShortcut:"ShowIntentSuggestionShortcut",ShowWordCountKeytip:"ShowWordCountKeytip",ShowReadingTimeKeytip:"ShowReadingTimeKeytip",Shrink:"Shrink",ShrinkFont:"ShrinkFont",ShrinkFontSize:"ShrinkFontSize",ShrinkFontSizeKeytip:"ShrinkFontSizeKeytip",ShrinkKeytip:"ShrinkKeytip",SimpleFrameBlack:"SimpleFrameBlack",
SimpleFrameWhite:"SimpleFrameWhite",SnipDiagonalCornerWhite:"SnipDiagonalCornerWhite",SmartLookup:"SmartLookup",SmartLookupKeytip:"SmartLookupKeytip",SmartLookupContextMenuSearchZeroTerm:"SmartLookupContextMenuSearchZeroTerm",SmartLookupSynonyms:"SmartLookupSynonyms",SoftEdgeOval:"SoftEdgeOval",SoftEdgeRectangle:"SoftEdgeRectangle",SpbWordCountAlt:"SpbWordCountAlt",SpbWordCountLabel:"SpbWordCountLabel",SpbWordCountTip:"SpbWordCountTip",SpecialIndent:"SpecialIndent",SpecialIndentFirstLine:"SpecialIndentFirstLine",
SpecialIndentFirstLineKeytip:"SpecialIndentFirstLineKeytip",SpecialIndentHanging:"SpecialIndentHanging",SpecialIndentHangingKeytip:"SpecialIndentHangingKeytip",SpecialIndentNone:"SpecialIndentNone",SpecialIndentNoneKeytip:"SpecialIndentNoneKeytip",SpecialIndentTooltip:"SpecialIndentTooltip",SpecialIndentTooltipKeytip:"SpecialIndentTooltipKeytip",SpinnerAuto:"SpinnerAuto",SpinnerDecrementButtonAriaLabel:"SpinnerDecrementButtonAriaLabel",SpinnerIncrementButtonAriaLabel:"SpinnerIncrementButtonAriaLabel",
SpinnerIndentAfterLtr:"SpinnerIndentAfterLtr",SpinnerIndentAfterLtrKeytip:"SpinnerIndentAfterLtrKeytip",SpinnerIndentBeforeLtr:"SpinnerIndentBeforeLtr",SpinnerIndentBeforeLtrKeytip:"SpinnerIndentBeforeLtrKeytip",SpinnerSpacingAfter:"SpinnerSpacingAfter",SpinnerSpacingAfterKeytip:"SpinnerSpacingAfterKeytip",SpinnerSpacingBefore:"SpinnerSpacingBefore",SpinnerSpacingBeforeKeytip:"SpinnerSpacingBeforeKeytip",SplitButtonRoleDescription:"SplitButtonRoleDescription",SplitCells:"SplitCells",SplitCellsKeytip:"SplitCellsKeytip",
StandardColors:"StandardColors",StartNewList:"StartNewList",StatsInIdeas:"StatsInIdeas",StockImages:"StockImages",StockImagesKeytip:"StockImagesKeytip",Strikethrough:"Strikethrough",StrikethroughKeytip:"StrikethroughKeytip",StyleOptions:"StyleOptions",SubmitFailed:"SubmitFailed",SubmitFailedDetails:"SubmitFailedDetails",SubmitSucceeded:"SubmitSucceeded",SubmitSucceededDetails:"SubmitSucceededDetails",Subscript:"Subscript",SubscriptKeytip:"SubscriptKeytip",Superscript:"Superscript",SuperscriptKeytip:"SuperscriptKeytip",
SwitchToClassicViewMode:"SwitchToClassicViewMode",SwitchToClassicViewModeKeytip:"SwitchToClassicViewModeKeytip",SwitchToUnifiedReadMode:"SwitchToUnifiedReadMode",SwitchToUnifiedReadModeKeytip:"SwitchToUnifiedReadModeKeytip",SymbolPlural:"SymbolPlural",SymbolSingle:"SymbolSingle",SymbolSingleKeytip:"SymbolSingleKeytip",TabDesign:"TabDesign",TabDesignKeytip:"TabDesignKeytip",TabDesignOneLineRibbonKeytip:"TabDesignOneLineRibbonKeytip",TabDeveloper:"TabDeveloper",TabDeveloperKeytip:"TabDeveloperKeytip",
TabFileKeytip:"TabFileKeytip",TabFormatPicture:"TabFormatPicture",TabFormatPictureKeytip:"TabFormatPictureKeytip",TabForYou:"TabForYou",TabForYouKeytip:"TabForYouKeytip",TabHome:"TabHome",TabHomeKeytip:"TabHomeKeytip",TabInsert:"TabInsert",TabInsertKeytip:"TabInsertKeytip",TabLayout:"TabLayout",TabLayoutKeytip:"TabLayoutKeytip",TabReferencesKeytip:"TabReferencesKeytip",Table:"Table",TableDesignGroupName:"TableDesignGroupName",TableDesignOverflowName:"TableDesignOverflowName",TableKeytip:"TableKeytip",
TabTableKeytip:"TabTableKeytip",TableLayoutGroupName:"TableLayoutGroupName",TableLayoutOverflowName:"TableLayoutOverflowName",TableStyleOptionBandedColumn:"TableStyleOptionBandedColumn",TableStyleOptionBandedColumnKeytip:"TableStyleOptionBandedColumnKeytip",TableStyleOptionBandedRow:"TableStyleOptionBandedRow",TableStyleOptionBandedRowKeytip:"TableStyleOptionBandedRowKeytip",TableStyleOptionFirstColumn:"TableStyleOptionFirstColumn",TableStyleOptionFirstColumnKeytip:"TableStyleOptionFirstColumnKeytip",
TableStyleOptionFirstRow:"TableStyleOptionFirstRow",TableStyleOptionFirstRowKeytip:"TableStyleOptionFirstRowKeytip",TableStyleOptionLastColumn:"TableStyleOptionLastColumn",TableStyleOptionLastColumnKeytip:"TableStyleOptionLastColumnKeytip",TableStyleOptionLastRow:"TableStyleOptionLastRow",TableStyleOptionLastRowKeytip:"TableStyleOptionLastRowKeytip",TableStyleOptionsKeytip:"TableStyleOptionsKeytip",TableStyles:"TableStyles",TableStylesKeytip:"TableStylesKeytip",TabMailings:"TabMailings",TabMailingsKeytip:"TabMailingsKeytip",
TabPageLayout:"TabPageLayout",TabPageLayoutKeytip:"TabPageLayoutKeytip",TabPictureTools:"TabPictureTools",TabReview:"TabReview",TabReviewKeytip:"TabReviewKeytip",TabTableTools:"TabTableTools",TabView:"TabView",TabViewKeytip:"TabViewKeytip",TaskPaneRoleDescription:"TaskPaneRoleDescription",TaskPaneTabs:"TaskPaneTabs",TaskPaneOpening:"TaskPaneOpening",TaskList:"TaskList",TaskListKeytip:"TaskListKeytip",TermsOfUse:"TermsOfUse",TellMeSearchPlaceholder:"TellMeSearchPlaceholder",TellMeSearchPlaceholderOnMac:"TellMeSearchPlaceholderOnMac",
TellMeSearchUnifiedAppPlaceholder:"TellMeSearchUnifiedAppPlaceholder",TellMeAlternativePlaceholder:"TellMeAlternativePlaceholder",TellMeActivationPlaceholder:"TellMeActivationPlaceholder",TellMeDeactivationPlaceholder:"TellMeDeactivationPlaceholder",TellMeAnswerForSearchLabel:"TellMeAnswerForSearchLabel",TellMeDefinition:"TellMeDefinition",TellMeKeytip:"TellMeKeytip",TellMeLabel:"TellMeLabel",TellMePlaceholder:"TellMePlaceholder",TellMeSuggestedQuery1:"TellMeSuggestedQuery1",TellMeSuggestedQuery2:"TellMeSuggestedQuery2",
TellMeSuggestedQuery3:"TellMeSuggestedQuery3",TellMeSuggestedQuery4:"TellMeSuggestedQuery4",TellMeSuggestedQuery5:"TellMeSuggestedQuery5",TellMeGetHelpLabel:"TellMeGetHelpLabel",TellMeSelectAll:"TellMeSelectAll",TellMeSmartLookupLabel:"TellMeSmartLookupLabel",TellMeSynonym:"TellMeSynonym",TellMeUpsellTrackChanges:"TellMeUpsellTrackChanges",TellMeUpsellInsertShapes:"TellMeUpsellInsertShapes",TellMeUpsellLabels:"TellMeUpsellLabels",TellMeUpsellInsertCitations:"TellMeUpsellInsertCitations",TellMeUpsellTextBox:"TellMeUpsellTextBox",
TellMeUpsellTableOfContents:"TellMeUpsellTableOfContents",TellMeUpsellSmartArt:"TellMeUpsellSmartArt",TellMeUpsellWordArt:"TellMeUpsellWordArt",TellMeUpsellMultiColumnLayout:"TellMeUpsellMultiColumnLayout",TellMeUpsellInsertEquations:"TellMeUpsellInsertEquations",TellMeDesktopFeature:"TellMeDesktopFeature",TellMeOpenInWord:"TellMeOpenInWord",TellMeOpenInDesktopDescription:"TellMeOpenInDesktopDescription",TellMeUpsellDesktopTitle:"TellMeUpsellDesktopTitle",TellMeUpsellDesktopDescription:"TellMeUpsellDesktopDescription",
TemplateMoreLink:"TemplateMoreLink",TemplateSectionErrorMessage:"TemplateSectionErrorMessage",TermsOfUseDescription:"TermsOfUseDescription",TermsOfUseKeytip:"TermsOfUseKeytip",TextAlignment:"TextAlignment",TextAlignmentAnchorKeytip:"TextAlignmentAnchorKeytip",TextDirLTR:"TextDirLTR",TextDirLTRKeytip:"TextDirLTRKeytip",TextDirLTRTooltip:"TextDirLTRTooltip",TextDirRTL:"TextDirRTL",TextDirRTLKeytip:"TextDirRTLKeytip",TextDirRTLTooltip:"TextDirRTLTooltip",TextHighlightColor:"TextHighlightColor",ThemeColors:"ThemeColors",
ThemeColorsMCU:"ThemeColorsMCU",ThickMatteBlack:"ThickMatteBlack",ThisDevice:"ThisDevice",ThirdPartyNotices:"ThirdPartyNotices",ThirdPartyNoticesDescription:"ThirdPartyNoticesDescription",ThirdPartyNoticesKeytip:"ThirdPartyNoticesKeytip",TimeToReadTooltip:"TimeToReadTooltip",TogglePageEnds:"TogglePageEnds",TogglePageEndsKeytip:"TogglePageEndsKeytip",ToggleProofingOn:"ToggleProofingOn",ToggleProofingOff:"ToggleProofingOff",ToggleProofingTooltipOn:"ToggleProofingTooltipOn",ToggleProofingTooltipOff:"ToggleProofingTooltipOff",
ToggleProofingInRibbonEnable:"ToggleProofingInRibbonEnable",ToggleProofingInRibbonDisable:"ToggleProofingInRibbonDisable",ToggleProofingOnExpB:"ToggleProofingOnExpB",ToggleProofingOffExpB:"ToggleProofingOffExpB",ToggleProofingTooltipOnExpB:"ToggleProofingTooltipOnExpB",ToggleProofingTooltipOffExpB:"ToggleProofingTooltipOffExpB",ToggleProofingInRibbonEnableExpB:"ToggleProofingInRibbonEnableExpB",ToggleProofingInRibbonDisableExpB:"ToggleProofingInRibbonDisableExpB",ToggleRibbonControl:"ToggleRibbonControl",
ToggleRibbonControlKeytip:"ToggleRibbonControlKeytip",ToggleRibbonGroup:"ToggleRibbonGroup",TopBorder:"TopBorder",TopBorderKeyTip:"TopBorderKeyTip",Transform:"Transform",TransformToWeb:"TransformToWeb",TransformDescription:"TransformDescription",ReviewDesignerSuggestion:"ReviewDesignerSuggestion",RibbonTabsGroupLabel:"RibbonTabsGroupLabel",TrackChanges:"TrackChanges",TrackChangesModeDropDown:"TrackChangesModeDropDown",TrackChangesModeDropDownSimpleMarkup:"TrackChangesModeDropDownSimpleMarkup",TrackChangesModeDropDownAllMarkup:"TrackChangesModeDropDownAllMarkup",
TrackChangesModeKeytip:"TrackChangesModeKeytip",TrackChangesModeHideTrackChanges:"TrackChangesModeHideTrackChanges",TrackChangesModeShowTrackChanges:"TrackChangesModeShowTrackChanges",TrackChangesLabel:"TrackChangesLabel",TrackChangesTooltip:"TrackChangesTooltip",TrackChangesForEveryone:"TrackChangesForEveryone",TrackChangesForEveryoneKeytip:"TrackChangesForEveryoneKeytip",TrackChangesJustMine:"TrackChangesJustMine",TrackChangesJustMineKeytip:"TrackChangesJustMineKeytip",TrackChangesKeytip:"TrackChangesKeytip",
TrackChangesOff:"TrackChangesOff",TrackChangesOffKeytip:"TrackChangesOffKeytip",Training:"Training",TrainingKeytip:"TrainingKeytip",TranscriptionLabel:"TranscriptionLabel",TranscriptionKeytip:"TranscriptionKeytip",TrustCenter:"TrustCenter",TrustCenterDescription:"TrustCenterDescription",TrustCenterKeytip:"TrustCenterKeytip",TryMacOffice:"TryMacOffice",TryMacOfficeDescription:"TryMacOfficeDescription",TryMacOfficeKeytip:"TryMacOfficeKeytip",TryOffice:"TryOffice",TryOfficeDescription:"TryOfficeDescription",
TryOfficeKeytip:"TryOfficeKeytip",Underline:"Underline",UnderlineKeytip:"UnderlineKeytip",Undo:"Undo",UndoKeytip:"UndoKeytip",UnpinRibbonTooltip:"UnpinRibbonTooltip",UpdateTableOfContents:"UpdateTableOfContents",UpdateTableOfContentsKeytip:"UpdateTableOfContentsKeytip",UpgradeOffice:"UpgradeOffice",UpgradeOfficeDescription:"UpgradeOfficeDescription",UserInterfaceFontName:"UserInterfaceFontName",UserInterfaceFontSize:"UserInterfaceFontSize",VersionHistory:"VersionHistory",ViewMoreOptionsGroupName:"ViewMoreOptionsGroupName",
ViewOriginal:"ViewOriginal",ViewPrevious:"ViewPrevious",Warning:"Warning",WebView:"WebView",WebViewKeytip:"WebViewKeytip",WhatsNew:"WhatsNew",WhatsNewKeytip:"WhatsNewKeytip",WheresTheSaveButton:"WheresTheSaveButton",WheresTheSaveButtonDescription:"WheresTheSaveButtonDescription",WheresTheSaveButtonKeytip:"WheresTheSaveButtonKeytip",WordCountKeytip:"WordCountKeytip",WordCountMenuItem:"WordCountMenuItem",WordCountToggle:"WordCountToggle",WordCountTooltip:"WordCountTooltip",WordPrediction:"WordPrediction",
WordPredictionKeytip:"WordPredictionKeytip",WordPredictionButtonToolTip:"WordPredictionButtonToolTip",WordPredictionDialogTitle:"WordPredictionDialogTitle",WordPredictionDialogButtonDescription:"WordPredictionDialogButtonDescription",WordPredictionDialogDescription:"WordPredictionDialogDescription",WordPredictionDialogSubDescription:"WordPredictionDialogSubDescription",WordPredictionDialogLearnMore:"WordPredictionDialogLearnMore",WordPredictionDialogFeedback:"WordPredictionDialogFeedback",WordPredictionDialogSeparator:"WordPredictionDialogSeparator",
WordTestFeature:"WordTestFeature",WrapText:"WrapText",WrapTextBehindText:"WrapTextBehindText",WrapTextBehindTextKeytip:"WrapTextBehindTextKeytip",WrapTextInFrontOfText:"WrapTextInFrontOfText",WrapTextInFrontOfTextKeytip:"WrapTextInFrontOfTextKeytip",WrapTextInLine:"WrapTextInLine",WrapTextInLineKeytip:"WrapTextInLineKeytip",WrapTextKeytip:"WrapTextKeytip",WrapTextSquareLeft:"WrapTextSquareLeft",WrapTextSquareLeftKeytip:"WrapTextSquareLeftKeytip",WrapTextSquareRight:"WrapTextSquareRight",WrapTextSquareRightKeytip:"WrapTextSquareRightKeytip",
Yes:"Yes",Zoom:"Zoom",ZoomInTooltip:"ZoomInTooltip",ZoomKeytip:"ZoomKeytip",ZoomLevel:"ZoomLevel",ZoomOutTooltip:"ZoomOutTooltip",ZoomTo100:"ZoomTo100",ZoomTo100Keytip:"ZoomTo100Keytip",TrackChangesForEveryoneLabel:"TrackChangesForEveryoneLabel",TrackChangesJustMineLabel:"TrackChangesJustMineLabel",ZoomTo100Label:"ZoomTo100Label",ZoomToFitPageWidthTooltip:"ZoomToFitPageWidthTooltip",NeedDesktopAppLabel:"NeedDesktopAppLabel",TellMeUpsellBibliography:"TellMeUpsellBibliography",TellMeUpsellWatermark:"TellMeUpsellWatermark",
TellMeUpsellSignature:"TellMeUpsellSignature",TellMeUpsellMailMerge:"TellMeUpsellMailMerge",TellMeUpsellTabStop:"TellMeUpsellTabStop",TellMeUpsellEnvelope:"TellMeUpsellEnvelope",TellMeUpsellBookmark:"TellMeUpsellBookmark",CommentPaneLabel:"CommentPaneLabel",CommentContextualLabel:"CommentContextualLabel",DesignerDisableContextualSuggestionsUntilUpdate:"DesignerDisableContextualSuggestionsUntilUpdate"};G.exports.WordRibbonStrings||Object.defineProperty(G.exports,"WordRibbonStrings",{enumerable:!0,
get:function(){return G.exports.r8f}})},1675:function(G,P,b){var k=this&&this.MS||(Object.create?function(x,u,w,r){void 0===r&&(r=w);var m=Object.getOwnPropertyDescriptor(u,w);if(!m||("get"in m?!u.UV:m.writable||m.configurable))m={enumerable:!0,get:function(){return u[w]}};Object.defineProperty(x,r,m)}:function(x,u,w,r){void 0===r&&(r=w);x[r]=u[w]}),f=this&&this.__exportStar||function(x,u){for(var w in x)"default"===w||Object.prototype.hasOwnProperty.call(u,w)||k(u,x,w)};Object.defineProperty(P,"__esModule",
{value:!0});f(b(1676),P);f(b(1677),P);G.exports.IntentIds||Object.defineProperty(G.exports,"IntentIds",{enumerable:!0,get:function(){return G.exports.IntentIds}});G.exports.ObjectSchemaType||Object.defineProperty(G.exports,"ObjectSchemaType",{enumerable:!0,get:function(){return G.exports.ObjectSchemaType}});G.exports.ObjectSemantic||Object.defineProperty(G.exports,"ObjectSemantic",{enumerable:!0,get:function(){return G.exports.ObjectSemantic}});G.exports.SearchSuggestionAnnotation||Object.defineProperty(G.exports,
"SearchSuggestionAnnotation",{enumerable:!0,get:function(){return G.exports.SearchSuggestionAnnotation}});G.exports.SearchSuggestionSignal||Object.defineProperty(G.exports,"SearchSuggestionSignal",{enumerable:!0,get:function(){return G.exports.SearchSuggestionSignal}});G.exports.SequenceType||Object.defineProperty(G.exports,"SequenceType",{enumerable:!0,get:function(){return G.exports.SequenceType}})},1676:function(G,P){Object.defineProperty(P,"__esModule",{value:!0});P.ObjectSchemaType=P.ObjectSemantic=
P.SequenceType=P.InputMethod=P.CommandSurface=P.IntentIds=void 0;(function(b){b.Logging="Logging";b.KeyPhrases="KeyPhrases";b.ZeroTermMenu="ZeroTermMenu"})(P.IntentIds||(P.IntentIds={}));(function(b){b.Canvas="Canvas";b.KeyboardShortcut="KeyboardShortcut";b.ClassicRibbon="ClassicRibbon";b.SimplifiedRibbon="SimplifiedRibbon";b.ContextMenu="ContextMenu";b.Floatie="Floatie";b.SearchBox="SearchBox";b.QuickAccessToolbar="QuickAccessToolbar"})(P.CommandSurface||(P.CommandSurface={}));(function(b){b.Unknown=
"Unknown";b.Keyboard="Keyboard";b.Mouse="Mouse";b.Touch="Touch";b.Pen="Pen";b.Voice="Voice"})(P.InputMethod||(P.InputMethod={}));(function(b){b.CommandId="CommandId";b.ControlId="ControlId"})(P.SequenceType||(P.SequenceType={}));(function(b){b.CurrentFocusedTile="CurrentFocusedTile";b.Selection="Selection";b.TileBefore="TileBefore";b.TileAfter="TileAfter";b.CommandIdHistory="CommandIdHistory";b.ControlIdHistory="ControlIdHistory"})(P.ObjectSemantic||(P.ObjectSemantic={}));(function(b){b.FormattedTextTile=
"FormattedTextTile";b.DocumentSelection="DocumentSelection";b.CommandExecutionSequence="CommandExecutionSequence"})(P.ObjectSchemaType||(P.ObjectSchemaType={}))},1677:function(G,P,b){Object.defineProperty(P,"__esModule",{value:!0});P.SearchSuggestionAnnotation=P.SearchSuggestionSignal=void 0;const k=b(215);class f{constructor(u){k.SchemaObject.assign(f,this,u)}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(u){return k.SchemaObject.matchesTypesFor(u,
[f.getTypeName()])}}P.SearchSuggestionSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class x{constructor(u){k.SchemaObject.assign(x,this,u)}get metadata(){return this.M_}set metadata(u){this.M_=u}static getTypeName(){return"AugLoop_SearchSuggestion_SearchSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(u){return k.SchemaObject.matchesTypesFor(u,[x.getTypeName()])}}P.SearchSuggestionAnnotation=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()}},1680:function(G,
P,b){b.r(P);b.d(P,"ReactOICErrorDialogWithTrial",function(){return u});G=b(0);var k=b(41);P=b(1534);var f=b(331),x=b(151);class u extends P.a{constructor(w,r,m,l,z,F){super(w,r,m,l,z,F);r={["errorMessage"]:this.Jih,["offerString"]:this.e9h};w=new x.a(!1,!1,!0);this.JHi?(w.yc=1,r.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.Cbb,["onExecute"]:()=>{f.Redirect.showHelp(this.DJh)}}):(w.yc=4,w.Nd(2,this.dLh));w.Nd(1,this.gkd);w.jf=this.id;r={["id"]:this.id,["dialogIcon"]:this.icon,
["bodyControls"]:r};w.Tg(this.XHa,Object(k.a)(this,this.IMm,"reactOICErrorDialogWithTrialHandler"),r)}}Object(G.a)(u,"ReactOICErrorDialogWithTrial",P.a,[])},1681:function(G,P,b){b.r(P);b.d(P,"OICErrorDialogWithTrial",function(){return x});G=b(0);var k=b(41);P=b(1534);var f=b(132);class x extends P.a{constructor(u,w,r,m,l,z){super(u,w,r,m,l,z);u=document.createElement("span");u.innerText=this.Jih;u.appendChild(document.createElement("br"));u.appendChild(document.createElement("br"));w=document.createElement("span");
w.innerText=this.e9h;u.appendChild(w);w=new f.StandardDialog;this.JHi?(w.yc=1,w.wHe(this.Cbb,this.DJh)):(w.yc=4,w.Nd(2,this.dLh));w.Nd(1,this.gkd);w.jf=this.id;w.mv(this.XHa,null,this.icon,Object(k.a)(this,this.GYl,"legacyOICErrorDialogWithTrialHandler"),u)}}Object(G.a)(x,"OICErrorDialogWithTrial",P.a,[])},1683:function(G,P,b){var k=this&&this.MS||(Object.create?function(x,u,w,r){void 0===r&&(r=w);Object.defineProperty(x,r,{enumerable:!0,get:function(){return u[w]}})}:function(x,u,w,r){void 0===r&&
(r=w);x[r]=u[w]}),f=this&&this.__exportStar||function(x,u){for(var w in x)"default"===w||Object.prototype.hasOwnProperty.call(u,w)||k(u,x,w)};Object.defineProperty(P,"__esModule",{value:!0});f(b(1684),P);f(b(1685),P);G.exports.SearchProviderSignal||Object.defineProperty(G.exports,"SearchProviderSignal",{enumerable:!0,get:function(){return G.exports.SearchProviderSignal}})},1684:function(G,P){Object.defineProperty(P,"__esModule",{value:!0})},1685:function(G,P,b){Object.defineProperty(P,"__esModule",
{value:!0});P.SearchProviderAnnotation=P.SearchProviderSignal=void 0;const k=b(215);class f{constructor(u){k.SchemaObject.assign(f,this,u)}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(u){return k.SchemaObject.matchesTypesFor(u,[f.getTypeName()])}}P.SearchProviderSignal=f;f.H_={T_:f.getTypeName(),B_:f.getBaseTypes()};class x{constructor(u){k.SchemaObject.assign(x,this,u)}get metadata(){return this.M_}set metadata(u){this.M_=
u}static getTypeName(){return"AugLoop_SearchProvider_SearchProviderAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(u){return k.SchemaObject.matchesTypesFor(u,[x.getTypeName()])}}P.SearchProviderAnnotation=x;x.H_={T_:x.getTypeName(),B_:x.getBaseTypes()}},1738:function(G,P,b){G=b(0);var k=b(23),f=b(2),x=b(16),u=b(51),w=b(191),r=b(79),m=b(146),l=b(17),z=b(42),F=b(6),L=b(8),E=b(41),A=b(69),M=b(59),Q=b(34),R=b(303),K=b(18),J=b(14),O=b(5),N=b(66),V=b(104),W=b(21),ca=
b(228),H=b(39),Z=b(248),aa=b(40),ja=b(262),Ba=b(22),la=b(88),ia=b(157),oa=b(784),ha=b(839),pa=b(3),Ea=b(91),Fa=b(70),Ga=b(12),$a=b(100),fa=b(43),sa=b(468),qa=b(553),va=b(219),Ca=b(19),ta=b(49),Wa=b(33),Za=b(233),Ya=b(10),Ka=b(1372),xa=b(1393),Sa=b(223),pb=b(185),Db=b(54),Ua=b(490);class Lb extends Sa.a{constructor(Ha,Aa,Ma,cb,ib,Rb,Oa,lb){super();this.EEg=this.Iz=null;this.init(Ha);this.jk("FormattingViewOperation");this.$bb(f.AFrameworkApplication.pa,Aa,cb,ib,Rb);this._context=Ma;this.b2a=0;this.Sj=
!0;this.kej=Oa;this.vl=lb}get qia(){return this.vl.instance}run(){const Ha=this._context.view;var Aa=null;Ha.Cd&&(Aa=Ha.Ma);if(Aa){var Ma=Aa.Ca.Fa,cb=!xa.a.Y1b(this.actionId);!Ma||Lb.Sf.Mlf(Ma,cb)?(Lb.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.dC}),this.Sj=!1):this.qia&&this.qia.s2b(Ma)?(Lb.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.externalSelection}),this.Sj=!1):Lb.uf.J$(Ya.ParagraphReader.EO,Aa.If)&&(Lb.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.$L}),this.Sj=!1)}else Lb.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.uda}),this.Sj=!1;1!==this.behavior&&
this.Sj||(this.Sj&&(Ma=Aa.Ca.Fa,1===Aa.Ca.length&&1===Ma.length&&Ca.SelectionEditor.tj(Ma.sa)&&la.b(Ma.sa)&&(Lb.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.wxc}),this.Sj=!1)),(Ma=this.Sj)&&this.actionId===pa.a.q5&&((Ma=Array.from(Aa.Ca.Fa).some(V.FormattingReader.c6g))||Lb.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.$Ye})),this.Xp=Ma?32:8,this.b2a=3);this.b2a||(pb.a.mark(5730),this.EEg=Ua.SelectionReferenceFactory.instance.jub(),Ma=Aa.Ca.Fa.sa,this.Iz=new fa.GraphTransaction(15),this.Iz.Oa(Ma.node),this.Iz.ql=this.actionId,
this.b2a=1);if(1===this.b2a){this.yD||this.aVc(this._context.lm);if(1===this.LZa())return;this.b2a=2}if(2===this.b2a){if(this.actionId===pa.a.q5)if(Aa=Aa.If,Aa.Iv)for(Ma=0;Ma<Aa.length;Ma++)cb=Aa.getContext(Ma),this.ORi(cb);else this.ORi(Aa);this.EEg.Uka(this.actionId===pa.a.BY||this.actionId===pa.a.zha);(Aa=Object(A.a)(29,this.Ac))&&!Aa.b0a||Db.FocusManager.instance().Kf(Ha.IG);this.Iz.dispose();this.Iz=null;Ga.App.oa.updateCommandUI();pb.a.mark(5731);this.b2a=3;this.Xp=32}3===this.b2a&&(this.kej.process(this.actionId,
this._context,this.behavior,this.response),this.lla())}ORi(Ha){(Ca.SelectionEditor.Rs(Ha)||Ca.SelectionEditor.mj(Ha))&&Ga.App.aJ.n$(Ha.node)}static get Sf(){return Za.a.instance}static get uf(){return va.ContextSetEditor.instance}static get Kb(){return m.a.instance}}Object(G.a)(Lb,"FormattingViewOperation",Sa.a,[]);var Va=b(904),Sb=b(777),nb=b(73);b.d(P,"a",function(){return La});class La{constructor(Ha,Aa,Ma=null){this.kpiName="ChangeCaseCommandUsage";this.d0="wwaengidc";this.UR=new Map;this.Rej=
Ha;this.kaa=Aa;this.tL=Ma}get recentColors(){return La.t6a||(La.t6a=k.a.instance.ra("Box4.UI.RecentColorsSectionHandler"))}get sxd(){return!!this.tL&&this.tL.enabled}eb(){const Ha=f.AFrameworkApplication.pa,Aa=Object(E.a)(this,this.fJm,"queryNonParagraphFormatting");(La.Ua?La.Ua.Xt(66):f.AFrameworkApplication.K&&f.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled"))?(Ha.ka(pa.a.font,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.nv,J.a.endOfParagraph,
Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.wM,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.OM,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.at,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.jla,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.A3,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.BY,J.a.endOfParagraph,Object(E.a)(this,
this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.a$,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.zha,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.bold,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.setItalic,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.underline,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.Aea,J.a.endOfParagraph,Object(E.a)(this,
this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.superscript,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.subscript,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.strikethrough,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.Bq,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.q5,J.a.endOfParagraph,Object(E.a)(this,this.QQ,"applyFormattingEOP")),Ha.ka(pa.a.clearFormatting,J.a.endOfParagraph,
Object(E.a)(this,this.QQ,"applyFormattingEOP"))):Ga.App.Ldb&&(Ha.ka(pa.a.font,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),Ha.ka(pa.a.nv,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),Ha.ka(pa.a.at,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),Ha.ka(pa.a.jla,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),Ha.ka(pa.a.A3,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),N.ListReader.mq&&
(Ha.ka(pa.a.bold,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),Ha.ka(pa.a.setItalic,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),Ha.ka(pa.a.superscript,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),Ha.ka(pa.a.subscript,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),Ha.ka(pa.a.strikethrough,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),Ha.ka(pa.a.Bq,J.a.endOfParagraph,Object(E.a)(this,
this.gha,"applyListFormattingEOP"))),Ha.ka(pa.a.wM,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")),Ha.ka(pa.a.OM,J.a.endOfParagraph,Object(E.a)(this,this.gha,"applyListFormattingEOP")));const Ma=Ga.App.P0a.xrd(cb=>qa.OutlineElementGeneralizer.xia(cb.Ca,!0));Ha.Aa(pa.a.$Oe,J.a.view,Object(E.a)(this,this.Hol,"handleChangeCaseMenu"),100);Ha.Aa(pa.a.vYc,J.a.xc,Object(E.a)(this,this.vYc,"toggleChangeCase"),1028);Ha.ka(pa.a.QZa,J.a.view,Object(E.a)(this,this.Xki,"queryCharacterFormatting"));
Ha.ka(pa.a.VQc,J.a.view,Object(E.a)(this,this.Xki,"queryCharacterFormatting"));Ha.ka(pa.a.Lka,J.a.view,Ma);Ha.ka(pa.a.Lka,J.a.paragraph,Object(E.a)(this,this.Lka,"queryParagraphFormatting"));Ha.ka(pa.a.Lka,J.a.image,Object(E.a)(this,this.ZIm,"queryImageFormatting"));Ha.ka(pa.a.Lka,J.a.unsupportedObject,Aa);Ha.ka(pa.a.Lka,J.a.table,Object(E.a)(this,this.aKm,"queryTableFormatting"));Ha.ka(pa.a.TZa,J.a.view,Ma);Ha.ka(pa.a.TZa,J.a.paragraph,Object(E.a)(this,this.TZa,"queryParagraphIndentation"));Ha.ka(pa.a.TZa,
J.a.table,Object(E.a)(this,this.bKm,"queryTableIndentation"));Ha.Qb(pa.a.QZa,99);Ha.Qb(pa.a.VQc,1127);Ha.Qb(pa.a.Lka,97);Ha.Qb(pa.a.TZa,97);this.GJ(Ha,pa.a.font);this.GJ(Ha,pa.a.nv);this.GJ(Ha,pa.a.wM);this.GJ(Ha,pa.a.OM);Ha.M7a(pa.a.Anh,J.a.view,Object(E.a)(this,this.jKe,"applyCharacterFormattingViewAsync"));Ha.Qb(pa.a.Anh,1092);this.GJ(Ha,pa.a.at);this.GJ(Ha,pa.a.jla);this.GJ(Ha,pa.a.A3);this.GJ(Ha,pa.a.BY);this.GJ(Ha,pa.a.a$);this.GJ(Ha,pa.a.ftb);this.GJ(Ha,pa.a.K8a);this.GJ(Ha,pa.a.L8a);this.GJ(Ha,
pa.a.zTa);this.GJ(Ha,pa.a.gtb);this.GJ(Ha,pa.a.zha);this.GJ(Ha,pa.a.bold);Ha.PFb(pa.a.bold,Object(E.a)(this,this.rwb,"generateActionArguments"));this.GJ(Ha,pa.a.setItalic);Ha.PFb(pa.a.setItalic,Object(E.a)(this,this.rwb,"generateActionArguments"));this.GJ(Ha,pa.a.underline);Ha.PFb(pa.a.underline,Object(E.a)(this,this.rwb,"generateActionArguments"));this.GJ(Ha,pa.a.Aea);this.GJ(Ha,pa.a.superscript);Ha.PFb(pa.a.superscript,Object(E.a)(this,this.rwb,"generateActionArguments"));this.GJ(Ha,pa.a.subscript);
Ha.PFb(pa.a.subscript,Object(E.a)(this,this.rwb,"generateActionArguments"));this.GJ(Ha,pa.a.strikethrough);Ha.PFb(pa.a.strikethrough,Object(E.a)(this,this.rwb,"generateActionArguments"));this.GJ(Ha,pa.a.Bq);Ha.PFb(pa.a.Bq,Object(E.a)(this,this.rwb,"generateActionArguments"));Ha.Aa(pa.a.lXa,J.a.xc,Object(E.a)(this,this.kmd,"applyCharacterFormatting"),96);Ha.M7a(pa.a.q5,J.a.view,Object(E.a)(this,this.jKe,"applyCharacterFormattingViewAsync"));Ha.ka(pa.a.q5,J.a.paragraph,Object(E.a)(this,this.yKe,"applyParagraphFormatting"));
Ha.ka(pa.a.q5,J.a.xc,Object(E.a)(this,this.kmd,"applyCharacterFormatting"));Ha.ka(pa.a.q5,J.a.Ub,Object(E.a)(this,this.rKe,"applyFormattingIp"));Ha.ka(pa.a.clearFormatting,J.a.view,Object(E.a)(this,this.s6j,"clearFormattingView"));Ha.ka(pa.a.clearFormatting,J.a.paragraph,Object(E.a)(this,this.r6j,"clearFormattingParagraph"));Ha.ka(pa.a.clearFormatting,J.a.xc,Object(E.a)(this,this.kmd,"applyCharacterFormatting"));Ha.ka(pa.a.clearFormatting,J.a.Ub,Object(E.a)(this,this.rKe,"applyFormattingIp"));Ha.Qb(pa.a.clearFormatting,
1036);Ha.ka(pa.a.P8a,J.a.xc,Object(E.a)(this,this.P8a,"clearFormattingParagraphLevel"));Ha.ka(pa.a.P8a,J.a.Ub,Object(E.a)(this,this.P8a,"clearFormattingParagraphLevel"));Ha.ka(pa.a.zwc,J.a.view,Object(E.a)(this,this.zwc,"clearFormattingMultiParagraphLevel"));Ha.ka(pa.a.mGb,J.a.view,xa.a.Wu);Ha.ka(pa.a.mGb,J.a.paragraph,Object(E.a)(this,this.yKe,"applyParagraphFormatting"));Ha.ka(pa.a.mGb,J.a.unsupportedObject,Object(E.a)(this,this.MTg,"applyTextDirectionToNonParagraph"));Ha.Qb(pa.a.mGb,1028);Ha.ka(pa.a.nGb,
J.a.view,xa.a.Wu);Ha.ka(pa.a.nGb,J.a.paragraph,Object(E.a)(this,this.yKe,"applyParagraphFormatting"));Ha.ka(pa.a.nGb,J.a.unsupportedObject,Object(E.a)(this,this.MTg,"applyTextDirectionToNonParagraph"));Ha.Qb(pa.a.nGb,1028)}GJ(Ha,Aa){Ha.M7a(Aa,J.a.view,Object(E.a)(this,this.jKe,"applyCharacterFormattingViewAsync"));Ha.ka(Aa,J.a.xc,Object(E.a)(this,this.kmd,"applyCharacterFormatting"));Ha.ka(Aa,J.a.Ub,Object(E.a)(this,this.rKe,"applyFormattingIp"));Ha.Qb(Aa,1036)}rwb(){return new oa.a(2)}Xki(Ha,Aa,
Ma,cb,ib){cb=!0;Aa.contextId!==J.a.view&&(cb=!1);if(1===Ma&&!cb)return 8;if(Ha===pa.a.VQc)Ha=ib.formatting,ib=ib.jUf;else{if(!Aa.view||!Aa.view.Cd)return 2;Aa=Aa.view;if(!Aa.Ma||!Aa.Ma.Ca.Fa)return 8;Ha=ib;ib=Aa.Ma.Ca}this.Rak(ib,Ha);return 32}Rak(Ha,Aa){for(const lb of Ha)for(const gb of lb){Ha=null;if(gb.contextId===J.a.xc){if(la.b(gb))continue;Ha=[];var Ma=gb.node.la;if(Ma){var cb=Ma.length-1;const Nb=gb.cpBegin,qc=gb.cpEnd;let Eb=!1;const ec=gb.node.characterData;if(ec&&""!==ec){var ib=ec.substr(Nb,
qc-Nb);ib&&""!==ib&&x.a.jSe(ib,0,ib.length)&&(Eb=!0)}ib=!1;for(let Jb=0;Jb<cb;Jb++){var Rb=Ma.J(Jb).cp,Oa=Ma.J(Jb+1).cp;if(Ma.J(Jb).formatting&&Math.max(Rb,Nb)<Math.min(Oa,qc)){if(ec&&""!==ec&&(Rb=Rb<Nb?Nb:Rb,Oa=ec.substr(Rb,(Oa<qc?Oa:qc)-Rb),!Eb&&x.a.jSe(Oa,0,Oa.length)))continue;ib=!0;Ha.push(Ma.J(Jb).formatting)}else if(ib)break}Ma.J(cb).formatting&&gb.cpEnd>Ma.J(cb).cp&&Ha.push(Ma.J(cb).formatting)}}else if(gb.contextId===J.a.paragraph&&!Ya.ParagraphReader.EO(gb)){if(Ha=[],Ma=gb.node.la)for(cb=
0;cb<Ma.length;cb++)Ma.J(cb).formatting&&Ha.push(Ma.J(cb).formatting)}else if(gb.contextId===J.a.endOfParagraph)Ha=[V.FormattingReader.zr(gb)];else if(gb.contextId===J.a.Ub){this.GIm(gb,Aa);return}if(Ha&&0<Ha.length)for(const Nb of Ha)if(V.FormattingReader.J_f(Aa,Nb.cache,gb))return}}GIm(Ha,Aa){if(Ha=V.FormattingReader.zr(Ha)){Ha=Ha.cache;var Ma=La.Ei.eK(l.a.bold,Ha.isBold);Aa.bold=Ma?1:0;Ma=La.Ei.eK(l.a.italic,Ha.isItalic);Aa.italic=Ma?1:0;Ma=La.Ei.eK(l.a.underline,Ha.isUnderline);Aa.underline=Ma?
1:0;Aa.underlineType=La.Ei.eK(l.a.underlineType,Ha.underlineType);Ma=La.Ei.eK(l.a.superscript,Ha.isSuperscript);Aa.superscript=Ma?1:0;Ma=La.Ei.eK(l.a.subscript,Ha.isSubscript);Aa.subscript=Ma?1:0;Ma=La.Ei.eK(l.a.strikethrough,Ha.isStrikethrough);Aa.strikethrough=Ma?1:0;Ma=La.Ei.eK(z.a.Bq,Ha.isDoubleStrikethrough);Aa.Bq=Ma?1:0;Ma=La.Ei.eK(l.a.font,Ha.qF);Aa.fontName=$a.a.JVa(Ma);Aa.K5=Ha.D1;Aa.fontSize=La.Ei.eK(l.a.fontSize,Ha.fontSize);Aa.fontColor=La.Ei.eK(l.a.fontColor,Ha.fontColor);Aa.highlight=
La.Ei.eK(l.a.highlight,Ha.highlight)}}jKe(Ha,Aa,Ma,cb,ib,Rb){return new Lb(Ha,Aa,Ma,cb,ib,Rb,this.Rej,La.gv())}kmd(Ha,Aa,Ma,cb,ib){var Rb,Oa;let lb=!0,gb=Aa;const Nb=!xa.a.Y1b(Ha);Aa.contextId!==J.a.xc&&Aa.contextId!==J.a.Ub?lb=!1:(La.Sf.T8(gb,!1,Nb)&&(La.Kb.ib(Ea.a.Nl,{["Reason"]:Fa.a.dC}),lb=!1),La.gv()&&La.gv().instance&&La.gv().instance.JR(gb)&&(lb=!1),lb&&Ca.SelectionEditor.tj(Aa)&&la.b(gb)&&(La.Kb.ib(Ea.a.Nl,{["Reason"]:Fa.a.wxc}),lb=!1),Ya.ParagraphReader.EO(Aa)&&(La.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.$L}),
lb=!1));if(1===Ma||!lb)return lb?32:8;if(Aa.contextId===J.a.Ub)return 2;this.ypn(Ha)&&(Aa=Ca.SelectionEditor.rIb(gb),Ca.SelectionEditor.ke(Aa)||(gb=Aa));Aa="boolean"===typeof ib&&ib;(null===(Rb=this.kaa)||void 0===Rb?0:Rb.annotateRange)&&Aa&&(null===(Oa=this.kaa)||void 0===Oa?0:Oa.Vcb(gb.node))?this.u_(gb,Ha,ib):La.N0a.u_(gb,qc=>{this.y$b(qc,Ha,ib,gb.cpEnd)},Aa);gb.node.kr&&(Rb=[Object.assign(new Q.a,{name:"Source",string:"CharacterFormatting"})],M.a("TOCFormatting",!0,void 0,Rb));this.EHl(Ha)&&this.Hod(gb,
Ha);cb&&Ka.a.tib&&(cb.dr|=Ka.a.uab(gb.node));return 32}ypn(Ha){return Ha===pa.a.underline||Ha===pa.a.Aea||Ha===pa.a.strikethrough||Ha===pa.a.Bq||Ha===pa.a.BY}vYc(Ha,Aa,Ma){return 1!==Ma&&2===Ma?(this.UR.set("Source","Shortcut"),Ha=Aa.node.characterData.substr(Aa.cpBegin,Aa.cpEnd-Aa.cpBegin),La.fmf(Ha,0,Ha.length)?this.Hod(Aa,pa.a.K8a):La.QSl(Ha,Ha.length)?this.Hod(Aa,pa.a.zTa):this.Hod(Aa,pa.a.L8a)):32}static I7e(Ha){return"string"===typeof Ha?{fontName:Ha,K5:-1,bold:2,italic:2}:Ha}u_(Ha,Aa,Ma){const cb=
Ha.cpBegin,ib=Ha.cpEnd;var Rb=Ha.node;let Oa=V.FormattingReader.zr(Ha),lb=cb;if(Aa==pa.a.wM||Aa==pa.a.OM)for(const gb of Rb.la)if(!(gb.cp<=cb)){if(gb.cp>=ib)break;gb.formatting&&gb.formatting.cache.fontSize!=Oa.cache.fontSize&&(Rb=this.nvh(Ha.node,Oa,Aa,Ma),this.kaa.annotateRange(Ha.node,lb,gb.cp,Rb),lb=gb.cp,Oa=gb.formatting)}Aa=this.nvh(Ha.node,Oa,Aa,Ma);this.kaa.annotateRange(Ha.node,lb,ib,Aa)}nvh(Ha,Aa,Ma,cb){const ib={},Rb=Object(A.a)(29,cb);Aa=Aa.cache;switch(Ma){case pa.a.bold:2===cb.value&&
(cb.value=Aa.isBold?0:1);ib[l.a.bold.id]=1===cb.value;break;case pa.a.setItalic:2===cb.value&&(cb.value=Aa.isItalic?0:1);ib[l.a.italic.id]=1===cb.value;break;case pa.a.underline:2===cb.value&&(cb.value=Aa.isUnderline?0:1);ib[l.a.underline.id]=1===cb.value;break;case pa.a.Aea:ib[l.a.underlineType.id]=cb.number;break;case pa.a.superscript:2===cb.value&&(cb.value=Aa.isSuperscript?0:1);ib[l.a.superscript.id]=1===cb.value;break;case pa.a.subscript:2===cb.value&&(cb.value=Aa.isSubscript?0:1);ib[l.a.subscript.id]=
1===cb.value;break;case pa.a.strikethrough:6!==f.AFrameworkApplication.pa.eF?L.ULS.sendTraceTag(529090079,340,50,"User used strikethrough from ribbon"):L.ULS.sendTraceTag(529090080,340,50,"User used strikethrough from keyboard shortcut");2===cb.value&&(cb.value=Aa.isStrikethrough?0:1);ib[l.a.strikethrough.id]=1===cb.value;break;case pa.a.Bq:2===cb.value&&(cb.value=Aa.isDoubleStrikethrough?0:1);ib[z.a.Bq.id]=1===cb.value;break;case pa.a.font:if(Rb&&Rb.Ac){const {fontName:lb,K5:gb,bold:Nb,italic:qc}=
La.I7e(Rb.Ac);cb=lb.substr(0,La.o4h);this.sxd&&(ib[F.a.jha.id]=cb,ib[F.a.Mpa.id]=cb,ib[F.a.ipa.id]=cb,ib[F.a.Aqa.id]=cb,ib[F.a.Cwa.id]=gb,ib[F.a.Uxa.id]=gb,ib[F.a.Ywa.id]=gb,ib[F.a.Zya.id]=gb);ib[l.a.font.id]=cb;ib[F.a.D1.id]=gb;if(Object(sa.a)()){cb=1==Nb;var Oa=1==qc;if(cb||Oa)ib[l.a.bold.id]=cb,ib[l.a.italic.id]=Oa}}break;case pa.a.at:cb=Sb.a.instance.Twa(Ha,cb);ib[l.a.fontColor.id]=cb;break;case pa.a.jla:Oa=Sb.a.instance.Twa(Ha,cb);ib[l.a.fontColor.id]=Oa;this.recentColors.P7a(cb)||L.ULS.sendTraceTag(529006977,
340,50,"Color selected from Recent Colors section. Menu: Font");break;case pa.a.A3:ib[l.a.fontColor.id]=nb.a.auto;break;case pa.a.BY:ib[l.a.highlight.id]=parseInt(cb,16);break;case pa.a.a$:ib[l.a.highlight.id]=parseInt(cb,16);this.recentColors.P7a(cb)||L.ULS.sendTraceTag(529006978,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case pa.a.zha:ib[l.a.highlight.id]=nb.a.auto;break;case pa.a.nv:ib[l.a.fontSize.id]=La.hh.UVb(Rb.Ac);break;case pa.a.wM:ib[l.a.fontSize.id]=this.H3k(Aa.fontSize);
break;case pa.a.OM:ib[l.a.fontSize.id]=this.tYk(Aa.fontSize);break;case pa.a.lXa:if(cb=null===(Oa=La.Xm)||void 0===Oa?void 0:Oa.lXa)for(const lb of cb.zi())ib[lb.id]=cb.pg(lb)}return ib}H3k(Ha){Ha=La.hh.wM(Ha);return La.hh.UVb(Ha)}tYk(Ha){Ha=La.hh.OM(Ha);return La.hh.UVb(Ha)}y$b(Ha,Aa,Ma,cb){var ib=Ha.cache;const Rb=Object(A.a)(29,Ma);switch(Aa){case pa.a.bold:2===Ma.value&&(Ma.value=ib.isBold?0:1);La.hh.jH(Ha,1===Ma.value);break;case pa.a.setItalic:2===Ma.value&&(Ma.value=ib.isItalic?0:1);La.hh.setItalic(Ha,
1===Ma.value);break;case pa.a.underline:2===Ma.value&&(Ma.value=ib.isUnderline?0:1);La.hh.r1(Ha,1===Ma.value);break;case pa.a.Aea:La.hh.Aea(Ha,Ma);break;case pa.a.superscript:2===Ma.value&&(Ma.value=ib.isSuperscript?0:1);La.hh.e$(Ha,1===Ma.value);break;case pa.a.subscript:2===Ma.value&&(Ma.value=ib.isSubscript?0:1);La.hh.qla(Ha,1===Ma.value);break;case pa.a.strikethrough:6!==f.AFrameworkApplication.pa.eF?L.ULS.sendTraceTag(539305613,340,50,"User used strikethrough from ribbon"):L.ULS.sendTraceTag(539305614,
340,50,"User used strikethrough from keyboard shortcut");2===Ma.value&&(Ma.value=ib.isStrikethrough?0:1);La.hh.v5(Ha,1===Ma.value);break;case pa.a.Bq:2===Ma.value&&(Ma.value=ib.isDoubleStrikethrough?0:1);La.hh.D$b(Ha,1===Ma.value);break;case pa.a.font:if(Rb&&Rb.Ac){const {fontName:Oa,K5:lb,bold:gb,italic:Nb}=La.I7e(Rb.Ac);La.hh.CY(Ha,Oa.substr(0,La.o4h));La.hh.X$b(Ha,lb);Object(sa.a)()&&(Ma=1==gb,cb=1==Nb,Ma||cb)&&(La.hh.jH(Ha,Ma),La.hh.setItalic(Ha,cb))}break;case pa.a.at:L.ULS.sendTraceTag(595153825,
340,50,"Font color is selected from Standard/Theme colors.");La.hh.at(Ha,Ma,null);break;case pa.a.jla:La.hh.at(Ha,Ma,null);this.recentColors.P7a(Ma)||L.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");break;case pa.a.A3:La.hh.A3(Ha);break;case pa.a.BY:L.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors.");La.hh.Vsa(Ha,Ma);break;case pa.a.a$:La.hh.Vsa(Ha,Ma);this.recentColors.P7a(Ma)||L.ULS.sendTraceTag(594899724,340,
50,"Color selected from Recent Colors section. Menu: Highlighter");break;case pa.a.zha:La.hh.rpd(Ha);break;case pa.a.nv:La.hh.nv(Ha,Rb.Ac);break;case pa.a.wM:La.hh.lHh(Ha);break;case pa.a.OM:La.hh.JIi(Ha);break;case pa.a.q5:ib=Ma.ia(F.a.noProof,!1);La.hh.fQf(Ha,Ma.getValue(l.a.iB),cb,ib);break;case pa.a.lXa:La.hh.d0d(Ha);break;case pa.a.clearFormatting:La.hh.yha(Ha);break;case pa.a.K8a:case pa.a.L8a:case pa.a.ftb:case pa.a.zTa:case pa.a.gtb:ib.AWa&&2===ib.capitalization&&La.hh.i6j(Ha)}}P8a(Ha,Aa,
Ma){let cb=!0;Ha=!xa.a.Y1b(Ha);Aa.contextId!==J.a.xc&&Aa.contextId!==J.a.Ub?cb=!1:(La.Sf.T8(Aa,!1,Ha)&&(La.Kb.ib(Ea.a.Nl,{["Reason"]:Fa.a.dC}),cb=!1),cb&&Ca.SelectionEditor.tj(Aa)&&la.b(Aa)&&(La.Kb.ib(Ea.a.Nl,{["Reason"]:Fa.a.wxc}),cb=!1),cb&&Ya.ParagraphReader.EO(Aa)&&(La.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.$L}),cb=!1));if(1===Ma||!cb)return cb?32:8;Aa=Aa.node;La.paragraphEditor.wVb(Aa,!1);Aa.kr&&(Aa=[Object.assign(new Q.a,{name:"Source",string:"ClearFormatting"})],M.a("TOCFormatting",!0,void 0,Aa));
return 32}zwc(Ha,Aa,Ma,cb,ib){Ha={};Ha[Va.a.gDa]=6168;Ha[Va.a.fDa]=6169;const Rb=Aa.view;var Oa=null;Rb.Rh&&(Oa=Rb);var lb=!0;let gb=32;Oa&&(Oa=Oa.Ma.Ca.Fa)&&(La.Sf.Mlf(Oa)?(La.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.dC}),gb=8,lb=!1):1===Ma&&(gb=32,lb=!1));lb&&(lb=new fa.GraphTransaction(1===Ma?3:15),lb.Oa(Rb.root),gb=Va.a.Bka(pa.a.P8a,Aa,Ma,cb,ib,Ha,12),lb.dispose());return gb}rKe(Ha,Aa,Ma,cb,ib){var Rb=!0,Oa=32;const lb=!xa.a.Y1b(Ha);Aa.contextId!==J.a.Ub?Rb=!1:La.Sf.T8(Aa,!1,lb)&&(La.Kb.ib(Ea.a.Nl,{["Reason"]:Fa.a.dC}),
Rb=!1);if(1===Ma||!Rb)return Rb?32:8;Ma=Aa.node;K.a.instance.J(8)&&Ha===pa.a.clearFormatting&&(La.Oo.Bwc(Ma),La.paragraphEditor.L2g(Ma),Rb=La.mHb.tw(Ma).zg(La.mHb.wordStyleIdNormal),La.D5.MK(Rb,Ma,!0));if(Ma=La.Ei.O$e(Aa))Oa=ta.a.eub(Ma),Oa=f.AFrameworkApplication.pa.Le(Oa,Ha,2,!1,cb,ib);else{cb=Object(A.a)(29,ib);Aa=V.FormattingReader.zr(Aa);if(!Aa)return 16;Aa=Aa.cache;switch(Ha){case pa.a.font:if(cb&&cb.Ac){const {fontName:gb,K5:Nb,bold:qc,italic:Eb}=La.I7e(cb.Ac);La.Ei.b0d(gb);La.Ei.X$b(Nb);Object(sa.a)()&&
(Ha=1==qc,ib=1==Eb,Ha||ib)&&(La.Ei.jH(Ha),La.Ei.setItalic(ib))}break;case pa.a.at:L.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors.");La.Ei.at(ib);break;case pa.a.jla:La.Ei.at(ib);this.recentColors.P7a(ib)||L.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");break;case pa.a.A3:La.Ei.A3();break;case pa.a.BY:L.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors.");La.Ei.Vsa(ib);break;
case pa.a.a$:La.Ei.Vsa(ib);this.recentColors.P7a(ib)||L.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case pa.a.zha:La.Ei.rpd();break;case pa.a.nv:La.Ei.nv(cb.Ac);break;case pa.a.wM:Ha=La.Ei.eK(l.a.fontSize,Aa.fontSize);La.Ei.nv(La.hh.wM(Ha));break;case pa.a.OM:Ha=La.Ei.eK(l.a.fontSize,Aa.fontSize);La.Ei.nv(La.hh.OM(Ha));break;case pa.a.bold:Ha=La.Ei.eK(l.a.bold,Aa.isBold);La.Ei.jH(!Ha);break;case pa.a.setItalic:Ha=La.Ei.eK(l.a.italic,Aa.isItalic);
La.Ei.setItalic(!Ha);break;case pa.a.underline:Ha=La.Ei.eK(l.a.underline,Aa.isUnderline);La.Ei.r1(!Ha);break;case pa.a.Aea:La.Ei.Aea(ib);break;case pa.a.superscript:Ha=La.Ei.eK(l.a.superscript,Aa.isSuperscript);La.Ei.e$(!Ha);break;case pa.a.subscript:Ha=La.Ei.eK(l.a.subscript,Aa.isSubscript);La.Ei.qla(!Ha);break;case pa.a.strikethrough:Ha=La.Ei.eK(l.a.strikethrough,Aa.isStrikethrough);La.Ei.v5(!Ha);break;case pa.a.Bq:Ha=La.Ei.eK(z.a.Bq,Aa.isDoubleStrikethrough);La.Ei.D$b(!Ha);break;case pa.a.clearFormatting:La.Ei.k_a();
break;case pa.a.q5:ib.hasProperty(l.a.iB)&&La.Ei.q5(ib.getValue(l.a.iB)),ib.hasProperty(F.a.noProof)&&(Ha=ib.getValue(F.a.noProof),La.Ei.Hgn(Ha))}}Ga.App.oa.updateCommandUI();return Oa}fXm(Ha,Aa){pa.a.clearFormatting===Aa&&H.OutlineElementNavigator.Al(Ha).properties.removeProperty(l.a.d1)}QQ(Ha,Aa,Ma,cb,ib){cb=La.Kb.Tm(pa.a.Edn);var Rb=!0;Aa.contextId!==J.a.endOfParagraph&&(Rb=!1);if(1===Ma||!Rb)return Rb?32:8;Ma=Aa.node;Rb=O.GraphIterator.va(Aa.node);Rb.nc();var Oa=Rb.d4(4);if((Rb=!!Oa&&La.Yb.V8(Oa))&&
!Ga.App.Ldb)return 8;var lb=!Ya.ParagraphReader.textLength(Ma);cb.properties.Z("Action",Ha.toString());cb.properties.Z("ListContext",Rb.toString());cb.properties.Z("IsEmptyParagraph",lb.toString());L.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",Ha,Rb,lb);Rb&&!ha.a.Dc.JO&&this.WUi(Ha,ib,Oa);if(!Rb||Rb&&La.Dc&&La.Dc.NXa){Rb=Ma.la.last;this.fXm(Ma,Ha);f.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled");if(f.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled",
!1)){lb=!!Rb.formatting;const gb=Ma.getValue(F.a.endOfParagraphFormatting);Oa=La.characterPropertiesEditor.jIa(Ma);lb=!lb&&gb&&gb.equals(u.a.nil)?new ia.a(Rb,u.a.nil):Oa.Ge(Oa.Xa)}else Oa=La.characterPropertiesEditor.jIa(Ma),lb=Oa.Ge(Oa.Xa);this.y$b(Oa,Ha,ib,Rb.cp);K.a.instance.J(3)&&La.Xj.VFb(Ma,Rb,Aa.cpBegin,Aa.cpEnd,lb,Oa,La.hd.Bf)}cb.end();return 32}WUi(Ha,Aa,Ma){const cb=Object(A.a)(29,Aa);switch(Ha){case pa.a.at:La.Wja.at(Ma,Aa);break;case pa.a.jla:La.Wja.at(Ma,Aa);break;case pa.a.nv:La.Wja.nv(Ma,
cb.Ac);break;case pa.a.A3:La.Wja.A3(Ma);break;case pa.a.wM:La.Wja.wM(Ma);break;case pa.a.OM:La.Wja.OM(Ma);break;case pa.a.font:La.Wja.ten(Ma,cb.Ac);break;case pa.a.bold:Ha=this.m9b(Aa,l.a.bold,Ma);La.Wja.jH(Ma,Ha);break;case pa.a.setItalic:Ha=this.m9b(Aa,l.a.italic,Ma);La.Wja.setItalic(Ma,Ha);break;case pa.a.subscript:Ha=this.m9b(Aa,l.a.subscript,Ma);La.Wja.qla(Ma,Ha);break;case pa.a.superscript:Ha=this.m9b(Aa,l.a.superscript,Ma);La.Wja.e$(Ma,Ha);break;case pa.a.strikethrough:Ha=this.m9b(Aa,l.a.strikethrough,
Ma);La.Wja.v5(Ma,Ha);break;case pa.a.Bq:Ha=this.m9b(Aa,z.a.Bq,Ma),La.Wja.D$b(Ma,Ha)}}m9b(Ha,Aa,Ma){2===Ha.value&&(Ha.value=Ma?Ma.ia(Aa,!1)?0:1:0);return 1===Ha.value}gha(Ha,Aa,Ma,cb,ib){cb=!0;const Rb=O.GraphIterator.va(Aa.node);Rb.nc();Aa.contextId===J.a.endOfParagraph&&Rb.d4(4)||(La.Kb.ib(Ea.a.Nl,{["Reason"]:Fa.a.Uof}),cb=!1);Aa=Rb.currentNode;if(!La.Yb.V8(Aa))return 8;if(1===Ma||!cb)return cb?32:8;ha.a.Dc.JO||this.WUi(Ha,ib,Aa);return 32}Lka(Ha,Aa,Ma,cb,ib){Ha=!0;Aa.contextId!==J.a.paragraph&&
(Ha=!1);if(1===Ma&&!Ha)return 8;Ma=Aa.node;-1!==ib.xk?ib.xk!==Ya.ParagraphReader.zu(Ma)&&(ib.xk=0):ib.xk=Ya.ParagraphReader.zu(Ma);K.a.instance.J(7)&&(Ha=La.yC.Mab(Ma),ib.Ar?(!ib.Ysl&&this.atl(ib.Ar,Ha)&&2===ib.Ar.specialIndentType&&(ib.Ar.specialIndentType=0),ib.Ar.Qyb===Ha.Qyb&&w.a.KX(ib.Ar.az,Ha.az)||(ib.Ar.az=Number.MAX_VALUE),ib.Ar.Ryb===Ha.Ryb&&w.a.KX(ib.Ar.mja,Ha.mja)||(ib.Ar.mja=Number.MAX_VALUE)):ib.Ar=Ha,Aa=La.uf.XUg(Aa.lm),void 0!==Aa&&null!==Aa&&(Aa=Aa.node,void 0!==Aa&&null!==Aa&&(Aa=
Z.WordSectionNavigator.instance.WO(Aa),void 0!==Aa&&null!==Aa&&(Aa=La.vh.fv(Aa)-(La.vh.sM(Aa)+La.vh.tM(Aa)+Ga.App.Jta),Ha.jHc=Aa-Ha.az,Ha.iHc=Aa-Ha.mja,ib.Ar.iHc=Math.min(ib.Ar.iHc,Ha.iHc),ib.Ar.jHc=Math.min(ib.Ar.jHc,Ha.jHc)))));K.a.instance.J(7)&&(Aa=La.WR.Fya(Ma),ib.TK?(ib.TK.beforeSpacing=La.WQg(Aa.beforeSpacing,ib.TK.beforeSpacing),ib.TK.afterSpacing=La.WQg(Aa.afterSpacing,ib.TK.afterSpacing),ib.TK.lineSpacing.unit===Aa.lineSpacing.unit&&w.a.KX(ib.TK.lineSpacing.value,Aa.lineSpacing.value)||
(ib.TK.lineSpacing.unit=0,ib.TK.lineSpacing.value=0)):ib.TK=Aa);Aa=new O.GraphIterator;Aa.set(Ma);Aa.La(11);if(Ma=Aa.mc(11))ib.isRtl=aa.OutlineElementReader.hk(Ma);Ma=La.Yb.Op(Aa);Aa=16;void 0!==Ma&&null!==Ma&&(Aa=Ma.listType);ib.listType=La.GXk(ib.listType,Aa);ib.lv=16===ib.listType?null:Ma;return 32}atl(Ha,Aa){return this.dUg(Ha,Aa)||this.dUg(Aa,Ha)}dUg(Ha,Aa){return(1===Ha.specialIndentType||!Ha.specialIndentType)&&2===Aa.specialIndentType}fJm(Ha,Aa,Ma,cb,ib){ib.isRtl=aa.OutlineElementReader.hk(H.OutlineElementNavigator.Al(Aa.node));
return 32}MTg(Ha,Aa,Ma){if(Ha===pa.a.nGb)Ha=!0;else if(Ha===pa.a.mGb)Ha=!1;else return 2;Ha&&this.K1h(Aa);if(1===Ma)return 32;La.Wf.fGb(H.OutlineElementNavigator.Al(Aa.node),Ha);return 32}ZIm(Ha,Aa,Ma,cb,ib){Ha=Aa.node;ib.isRtl=aa.OutlineElementReader.isRtl(H.OutlineElementNavigator.Al(Ha));ib.xk=W.ImageReader.zu(Ha);return 32}aKm(Ha,Aa,Ma,cb,ib){Ha=Aa.node;ib.isRtl=aa.OutlineElementReader.isRtl(H.OutlineElementNavigator.Al(Ha));ib.xk=Wa.TableReader.zu(Ha);-1!==ib.xk&&ib.xk||(ib.xk=ib.isRtl?3:1);
return 32}yKe(Ha,Aa,Ma,cb,ib){let Rb;if(!({jw:Rb}=xa.a.dSf(Ma,Aa)).returnValue)return Rb;const Oa=Aa.node;switch(Ha){case pa.a.mGb:La.Wf.W$b(Oa,!1);break;case pa.a.nGb:this.K1h(Aa);La.Wf.W$b(Oa,!0);break;case pa.a.q5:Rb=f.AFrameworkApplication.pa.Le(Aa.lm,Ha,Ma,!0,cb,ib),32===Rb&&Ya.ParagraphReader.Wk(Aa)&&La.CQc&&La.CQc.n$(Oa)}return 32}s6j(Ha,Aa,Ma,cb,ib){const Rb={};Rb[Va.a.gDa]=6168;Rb[Va.a.fDa]=6169;var Oa=Aa.view;const lb=new fa.GraphTransaction(1===Ma?3:15);lb.Oa(Oa.root);let gb=Va.a.Bka(Ha,
Aa,Ma,cb,ib,Rb,0),Nb=null;Oa.Rh&&(Nb=Oa);Oa=!0;let qc=null;Nb&&(qc=Nb.Ma.Ca.Fa)&&(Ha=!xa.a.Y1b(Ha),La.Sf.Mlf(qc,Ha)?(La.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.dC}),gb=8,Oa=!1):1===Ma&&(gb=32,Oa=!1),La.uf.J$(Ya.ParagraphReader.EO,Nb.Ma.If)&&(La.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.$L}),gb=8,Oa=!1));Oa&&this.USl(qc)&&(gb=Va.a.Bka(pa.a.P8a,Aa,Ma,cb,ib,Rb,12));lb.dispose();return gb}r6j(Ha,Aa,Ma){Ha=!0;Aa.contextId!==J.a.paragraph&&Aa.contextId!==J.a.Ub?Ha=!1:La.Sf.SXa(Aa)&&(La.Kb.ib(Ea.a.Nl,{["Reason"]:Fa.a.dC}),
Ha=!1);if(1===Ma||!Ha)return Ha?32:8;Aa=Aa.node;Ma=new fa.GraphTransaction(15);Ma.Oa(Aa);La.Oo.Bwc(Aa);La.paragraphEditor.wVb(Aa,!0);La.D5.YPe(Aa);Ma.dispose();return 2}Hol(Ha,Aa,Ma){Ha=!0;Aa.contextId!==J.a.view&&(Ha=!1);if(1===Ma&&!Ha)return 8;if(!Aa.view||!Aa.view.Cd)return 2;Aa=Aa.view;if(!Aa.Ma||!Aa.Ma.Ca.Fa)return 8;if(La.uf.J$(Ya.ParagraphReader.EO,Aa.Ma.If))return La.Kb.ib(Ea.a.re,{["Reason"]:Fa.a.$L}),8;Aa=Aa.Ma.Ca;for(const cb of Aa)for(const ib of cb)if(ib&&ib.contextId!==J.a.xc&&ib.contextId!==
J.a.Ub&&ib.contextId!==J.a.paragraph&&ib.contextId!==J.a.endOfParagraph)return 2;return 32}TZa(Ha,Aa,Ma,cb,ib){Ha=!0;Aa.contextId!==J.a.paragraph&&(Ha=!1);if(1===Ma&&!Ha)return 8;ib.Ar||(Aa=Aa.node,Ma=La.yC.Mab(Aa),ib.Ar=Ma,Ma=new O.GraphIterator,Ma.set(Aa),Ma.La(11),Aa=Ma.mc(11),ib.isRtl=Aa?aa.OutlineElementReader.hk(Aa):!1);return 32}bKm(Ha,Aa,Ma,cb,ib){Aa=Aa.node;Ha=H.OutlineElementNavigator.Al(Aa);ib.Ar||(Aa=this.T$k(Aa),Aa=La.yC.Mab(Aa),ib.Ar=Aa,ib.isRtl=aa.OutlineElementReader.isRtl(Ha));return 32}T$k(Ha){Ha=
O.GraphIterator.va(Ha);Ha.La(11);Ba.moveToCell(Ha,0,0);Ha.Xc();Ha.A8();return Ha.currentNode}USl(Ha){return!Ha||Ca.SelectionEditor.Cl(Ha)||1===Ha.length&&Ca.SelectionEditor.tj(Ha.sa)&&!Ca.SelectionEditor.Gcb(Ha.sa)?!1:!0}K1h(Ha){La.NDg.Ja(Ha.contextId)||(L.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",Ha.contextId),La.NDg.Z(Ha.contextId,!0))}EHl(Ha){return Ha===pa.a.ftb||Ha===pa.a.K8a||Ha===pa.a.L8a||Ha===pa.a.zTa||Ha===pa.a.gtb}Hod(Ha,Aa){const Ma=Ha.node,cb=Ma.characterData.substr(Ha.cpBegin,
Ha.cpEnd-Ha.cpBegin);this.UR.set("Command",Aa.toString());r.Health.instance.recordKpiUsage(this.kpiName,1,this.d0,this.UR);Aa=La.qCn(cb,Aa);Ma.gla(Ma.characterData.substr(0,Ha.cpBegin)+Aa+Ma.characterData.substr(Ha.cpEnd));return 32}static get hh(){return La.nd||(La.nd=k.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return La.Tb||(La.Tb=k.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return La.kh||(La.kh=k.a.instance.resolve("Box4.IParagraphEditor"))}static get WR(){return La.Gx||
(La.Gx=k.a.instance.resolve("Box4.ILineSpacingHelper"))}static get mHb(){return La.Tk||(La.Tk=k.a.instance.resolve("Box4.Styles.IWACStyleReader"))}static get D5(){return La.yv||(La.yv=k.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get Wf(){return La.Vd||(La.Vd=k.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Ei(){return La.Xm||(La.Xm=k.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get Wja(){return La.$ua||(La.$ua=k.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get yC(){return La.uj||
(La.uj=k.a.instance.resolve("Box4.IParagraphIndentationReader"))}static gv(){return La.vl||(La.vl=k.a.instance.za("Box4.IExternalSelectionManager"))}static get Dc(){return ca.a.getInstance()}static get uf(){return va.ContextSetEditor.instance}static get Sf(){return Za.a.instance}static get Kb(){return m.a.instance}static get Ua(){return La.Na||(La.Na=k.a.instance.ra("Box4.IFeatureHelper"))}static get CQc(){return Ga.App.aJ}static get hd(){return La.Bb||(La.Bb=k.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Xj(){return La.rf||
(La.rf=k.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get N0a(){return La.nG||(La.nG=k.a.instance.resolve("Box4.TextFormattingHelper"))}static get Yb(){return La.zc||(La.zc=k.a.instance.resolve("Box4.List.IListReader"))}static get Oo(){return La.Un||(La.Un=k.a.instance.resolve("Box4.List.IListEditor"))}static get vh(){return ja.a.instance}static GXk(Ha,Aa){return 42===Ha?Aa:Ha!==Aa||16===Ha?16:Ha}static WQg(Ha,Aa){Ha.aId||(Aa.aId?Aa=Ha:Aa.unit===Ha.unit&&w.a.KX(Aa.value,
Ha.value)||(Aa.value=-1));return Aa}static qCn(Ha,Aa){switch(Aa){case pa.a.K8a:return Ha.toLowerCase();case pa.a.L8a:return 6!==f.AFrameworkApplication.pa.eF?L.ULS.sendTraceTag(539305615,340,50,"User changed the case via ribbon"):L.ULS.sendTraceTag(539305616,340,50,"User changed the case from keyboard shortcut"),Ha.toUpperCase();case pa.a.ftb:case pa.a.zTa:return La.c3j(Ha,Aa===pa.a.zTa);case pa.a.gtb:return La.tEn(Ha);default:return Ha}}static tEn(Ha){let Aa="";for(let Ma=0;Ma<Ha.length;Ma++)Aa=
Ha.charAt(Ma)===Ha.charAt(Ma).toUpperCase()?Aa+Ha.charAt(Ma).toLowerCase():Aa+Ha.charAt(Ma).toUpperCase();return Aa}static c3j(Ha,Aa){let Ma,cb,ib=!0,Rb=Ha.length,Oa=0,lb=La.fmf(Ha,Oa,Rb);for(;0<Rb;){cb=Ma=!1;var gb=Rb;let qc;var Nb=void 0;for(Nb=0;0<gb&&La.s5j(Ha.charAt(Oa+Nb));Nb++,gb--)cb=La.dKd(Ha.charAt(Oa+Nb));for(qc=Nb;0<gb&&!(Ma=La.dKd(Ha.charAt(Oa+Nb)))&&" "!==Ha.charAt(Oa+Nb)&&"/"!==Ha.charAt(Oa+Nb);Nb++,gb--);gb=Nb-qc;if(0>=gb)break;Oa+=qc;Nb=Ha.substr(Oa,gb);Nb=Nb===Nb.toUpperCase();if(lb||
!Nb)Ha=ib||cb||Aa?Ha.substr(0,Oa)+Ha.charAt(Oa).toUpperCase()+Ha.substr(Oa+1,gb-1).toLowerCase()+Ha.substr(Oa+gb):Ha.substr(0,Oa)+Ha.substr(Oa,gb).toLowerCase()+Ha.substr(Oa+gb);Rb-=gb+qc;Oa+=gb;if(ib=Ma)Oa++,Rb--,lb=La.fmf(Ha,Oa,Rb)}return Ha}static fmf(Ha,Aa,Ma){for(;0<Ma&&!La.dKd(Ha.charAt(Aa));){if(Ha.charAt(Aa)!==Ha.charAt(Aa).toUpperCase())return!1;Aa++;Ma--}return!0}static QSl(Ha,Aa){for(var Ma=0;0<Aa&&!La.dKd(Ha.charAt(Ma));){if(Ha.charAt(Ma)!==Ha.charAt(Ma).toLowerCase())return!1;Ma++;Aa--}return!0}static dKd(Ha){return"."===
Ha||"!"===Ha||"?"===Ha?!0:!1}static s5j(Ha){return-1==="0123456789".indexOf(Ha)&&Ha.toUpperCase()===Ha.toLowerCase()}}La.nd=null;La.Vd=null;La.NDg=new R.a;La.Gx=null;La.Tb=null;La.kh=null;La.Tk=null;La.yv=null;La.Xm=null;La.$ua=null;La.uj=null;La.vl=null;La.Na=null;La.Bb=null;La.rf=null;La.nG=null;La.t6a=null;La.zc=null;La.Un=null;La.o4h=31;Object(G.a)(La,"TextFormattingActor",null,[])},1788:function(G,P,b){b.d(P,"a",function(){return k});const k=(f,x)=>{var u=f.w6i;if(!u){u=[];for(var w in f)"string"===
typeof w&&u.push({key:w,value:f[w]});u.sort((r,m)=>r.value-m.value);f.w6i=u}u=[];for(w=1;0<x;)x&1&&f[w]&&u.push(f[w]),w<<=1,x>>=1;if(u.length&&0===x)return u.reverse().join(", ")}},1790:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);var k;(function(f){f[f.chrome=0]="chrome";f[f.edge=1]="edge";f[f.firefox=2]="firefox";f[f.IE=3]="IE";f[f.safari=4]="safari";f[f.others=5]="others";f[f.unknown=6]="unknown";f[f.electron=7]="electron";f[f.chromiumEdge=8]="chromiumEdge";f[f.teamsElectron=9]="teamsElectron"})(k||
(k={}));Object(G.b)("BrowserCode",k)},1791:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(G.a)(k,"AtMentionAttributes",null,[])},1797:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);var k;(function(f){f[f.initial=0]="initial";f[f.startSearch=1]="startSearch";f[f.searching=2]="searching";f[f.searchComplete=3]="searchComplete";f[f.replaceAllInProgress=4]="replaceAllInProgress";f[f.replaceAllComplete=5]="replaceAllComplete";
f[f.tooManyResults=6]="tooManyResults";f[f.noMatchesFound=7]="noMatchesFound"})(k||(k={}));Object(G.b)("FindReplaceViewType",k)},1799:function(G,P,b){b.d(P,"a",function(){return k});var k;(function(f){f[f.initial=0]="initial";f[f.headings=1]="headings";f[f.find=2]="find";f[f.replace=3]="replace";f[f.intelligentPlaceholder=4]="intelligentPlaceholder"})(k||(k={}))},1806:function(G,P,b){function k(a,c){c=Object.assign(new aa.a,{name:"LinkType",string:c});f(zb.a.YCl,a,[c])}function f(a,c,h,v=!0){c&&c.UILocation&&
Object(re.d)(a,v,re.e,0,c.UILocation,0,h)}function x(a,c){var h;return a===Im.none?"none":null===(h=dz[a])||void 0===h?void 0:h[c]}function u(a,c,h){return{type:"ShortcutDiscoverySettingsModel",actionId:a,tFi:c,label:h}}b.r(P);var w=b(0),r=b(8),m=b(41),l=b(2),z=b(31),F=b(16),L=b(166),E=b(90);class A{constructor(a){this.iYf=0;this.Cyb=this.c8b=this.v0a=null;this.MV=l.AFrameworkApplication.na.Qo;this.VU=a;this.VU.uu(E.a.QAi);this.VU.pA(E.a.QAi,Object(m.a)(this,this.urm,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.Cyb)return r.ULS.sendTraceTag(589050652,
344,100,"Returning existing promise"),this.Cyb;this.v0a=this.MV.Pe("ComponentAttach","getCustomAuthConfig");return this.Cyb=new Promise((a,c)=>{const h={};let v=!1,B=!1,X=0;this.iYf=window.setInterval(()=>{4>X?(X++,this.VU.Qg(E.a.getCustomAuthConfig,h)):(window.clearInterval(this.iYf),v=!0,r.ULS.sendTraceTag(588087303,344,10,z.c({["error"]:"Request timeout after 4 retries."})),c("Request timeout."))},1E3);this.c8b=(ma,Pa)=>{window.clearInterval(this.iYf);v||B||(B=!0,ma?(r.ULS.sendTraceTag(589050653,
344,50,"Resolving Promise with authConfig"),a(ma)):(r.ULS.sendTraceTag(589050654,369,10,z.c({["error"]:Pa.toString()})),c(Pa)))};this.VU.Qg(E.a.getCustomAuthConfig,h)})}urm(a){try{const c=z.a(a.Values[L.a.DZj]);let h=l.AFrameworkApplication.K.Ga("Application")||"";h=F.a.kg(h);c.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+h+"%3Facctsw%3D1&prompt=select_account";c.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+h+"%3Facctsw%3D1";c.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+
h+"%3Facctsw%3D1&prompt=select_account";c.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+h+"%3Facctsw%3D1";this.v0a&&(this.v0a.stop(),this.v0a=null);this.c8b(c,"")}catch(c){r.ULS.sendTraceTag(589050655,344,10,z.c({["error"]:c.message,["stack"]:c.stack})),this.c8b(null,c.message)}}}Object(w.a)(A,"AccountSwitchingManager",null,[348]);var M=b(168);class Q{get name(){return"Common.App.AccountSwitching"}yb(a){a.register(A,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").singleInstance().Pc(()=>
new A(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){M.a.instance.Lb(new Q)}}Object(w.a)(Q,"AccountSwitchingPackage",null,[1,2]);var R;(function(a){a[a.generalException=0]="generalException";a[a.invalidArgument=1]="invalidArgument";a[a.notAllowed=2]="notAllowed";a[a.apiNotAvailable=3]="apiNotAvailable";a[a.unresolvedPendingRequest=4]="unresolvedPendingRequest";a[a.timeout=5]="timeout";a[a.adalTimeout=6]="adalTimeout";a[a.userNotSignedIn=7]="userNotSignedIn";a[a.userAborted=
8]="userAborted";a[a.silentSignInFailed=9]="silentSignInFailed";a[a.invalidResourceUrl=10]="invalidResourceUrl";a[a.invalidGrant=11]="invalidGrant";a[a.connectionLost=12]="connectionLost";a[a.clientError=13]="clientError";a[a.serverError=14]="serverError"})(R||(R={}));Object(w.b)("ErrorCodes",R);b(1629);class K{constructor(a,c){this.requestCallback=this.requestParameters=null;this.requestParameters=a;this.requestCallback=c}}Object(w.a)(K,"OutstandingRequest",null,[]);class J{}J.jhm="AADSTS50058";
J.invalidResourceUrl="AADSTS50001";J.bhm="AADSTS65001";J.Lhm="AADSTS70011";J.userAborted="13002";J.ACm="Popup Window is null";J.zCm="Popup Window closed";J.adalTimeout="Token renewal operation failed due to timeout";J.BEn="tokenRevoked";Object(w.a)(J,"WopiHostErrorType",null,[]);var O=b(1327),N=b(51),V=b(1628);class W{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(w.a)(W,"WopiIdentityInfo",null,[817]);class ca{constructor(a,c,h){this.expiration=
this.authority=this.accessToken=null;this.accessToken=a;this.authority=c;this.expiration=h}}Object(w.a)(ca,"WopiIdentityToken",null,[816]);var H=b(15),Z=b(126),aa=b(34),ja=b(169);class Ba{constructor(a){this._initialized=!1;this.f7b={};this.A3d={};this.MV=l.AFrameworkApplication.na.Qo;this.aef=a}X_e(a){this._initialized||(a.uu(E.a.tii),a.pA(E.a.tii,Object(m.a)(this,this.trm,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(a,c,h=null){this.rAa(a,c);return new Promise((v,B)=>{if(this.shf(c))if(c in
this.f7b)B("unresolvedPendingRequest");else{var X=window.setTimeout(()=>{r.ULS.sendTraceTag(37856032,344,10,z.c({["error"]:"Request timeout.",["callerId"]:c}));B("timeout")},12E4);this.H4e(a,c,h,(ma,Pa)=>{window.clearTimeout(X);ma?v(ma):(r.ULS.sendTraceTag(37856033,369,15,z.c({["error"]:R[Pa]})),B(Pa))})}else r.ULS.sendTraceTag(37856034,344,10,z.c({["error"]:"Caller is not allowed."})),B("notAllowed")})}getPrimaryIdentityInfo(a){return new Promise((c,h)=>{this.shf(a)?this.Ubl((v,B)=>{v?c(v):(r.ULS.sendTraceTag(37856064,
369,10,z.c({["error"]:B.toString()})),h(B))}):(r.ULS.sendTraceTag(37856065,344,10,z.c({["error"]:"Caller is not allowed."})),h("notAllowed"))})}getAuthContext(a){return new Promise((c,h)=>{const v=this.getAuthContextSync(a);v?c(v):h("notAllowed")})}getAuthContextSync(a){if(this.shf(a)){const c=new V.a;c.upn=l.AFrameworkApplication.K.Ga("UserPrincipalName");c.userId=l.AFrameworkApplication.K.Ga("LoggableUserId");c.authority=l.AFrameworkApplication.K.Ga("HostAuthAuthority");c.tenantId=l.AFrameworkApplication.K.Ga("TenantId");
c.isAnonymous=l.AFrameworkApplication.K.$("IsAnonymousUser");c.supportsAuthToken=this.Pvl(a);a=l.AFrameworkApplication.K.Ga("HostAuthType");c.authorityType="aad"===a.toLowerCase()?2:"msa"===a.toLowerCase()?1:0;return c}r.ULS.sendTraceTag(40751647,344,10,z.c({["error"]:"Caller is not allowed."}));return null}Pvl(a){const c=O.a.yGc;return H.a.AKa?c&&O.a.BNi?Array.contains(O.a.BNi,a.toLowerCase()):!1:c}H4e(a,c,h,v){var B=[];Array.add(B,Object.assign(new aa.a,{name:"CallerId",string:c}));Array.add(B,
Object.assign(new aa.a,{name:L.a.NUf,string:a.correlationId}));Z.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:B}));B=N.a.create().toString();const X="getAccessToken_"+B,ma=this.MV.Pe("ComponentAttach",X);this.A3d[X]=ma;const Pa={};Pa[L.a.OUf]=B;Pa[L.a.Rvn]=a.resource;Pa[L.a.Svn]=a.scope;Pa[L.a.rKi]=l.AFrameworkApplication.K.Ga("HostAuthType");Pa[L.a.Vvn]=l.AFrameworkApplication.K.Ga("UserPrincipalName");Pa[L.a.Tvn]=a.silentLogin;
Pa[L.a.Ovn]=a.options;Pa[L.a.NUf]=a.correlationId;Pa[L.a.Pvn]=c;h&&(Pa[L.a.addinName]=h.AddinName,Pa[L.a.Nvn]=h.AddinTrustId);this.aef.execute(mb=>{this.X_e(mb);mb.Qg(E.a.getAuthToken,Pa)});this.f7b[B]=new K(a,v)}Ubl(a){const c=l.AFrameworkApplication.K.Ga("UserName"),h=l.AFrameworkApplication.K.Ga("UserPrincipalName"),v=l.AFrameworkApplication.K.Ga("LoggableUserIdSpace"),B=new W;B.email=h;B.displayName=c;switch(v){case "OrgIdPuid":B.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":B.authority=
"MicrosoftAccount";break;default:B.authority=v}a(B,null)}trm(a){let c=null;try{let v=a.Values[L.a.OUf];const B=a.Values[L.a.Mvn],X=a.Values[L.a.rKi],ma=a.Values[L.a.Uvn];let Pa=null,mb=null;const Tb=this.f7b[v];if("undefined"!==typeof Tb&&Tb){var h=[];Array.add(h,Object.assign(new aa.a,{name:L.a.NUf,string:Tb.requestParameters.correlationId}));Z.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:h}));c=Tb.requestCallback;
delete this.f7b[v];"undefined"!==typeof B&&B&&B.length?mb=new ca(B,X,ma):Pa=R[this.K$l(a)];h="getAccessToken_"+v;h in this.A3d&&(this.A3d[h].stop(),delete this.A3d[h]);c(mb,Pa)}else r.ULS.sendTraceTag(37856066,344,10,z.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:v}))}catch(v){a=a.Values[L.a.OUf],a in this.f7b&&delete this.f7b[a],this.ZMd(),r.ULS.sendTraceTag(37856067,344,10,z.c({["error"]:v.message,["stack"]:v.stack})),c&&c(null,"generalException")}}shf(a){var c=l.AFrameworkApplication.Rml();
a=a.toLowerCase();for(const h of c)if(a===h.toLowerCase())return!0;c=O.a.SJe;for(let h in c)if(a===c[h].toLowerCase())return!0;return!1}K$l(a){a=a.Values[L.a.Qvn];this.ZMd();r.ULS.sendTraceTag(39068821,344,15,z.c({["error"]:a}));return a?-1<a.indexOf(J.jhm)?9:-1<a.indexOf(J.ACm)||-1<a.indexOf(J.zCm)?12:-1<a.indexOf(J.invalidResourceUrl)?10:-1<a.indexOf(J.userAborted)?8:-1<a.indexOf(J.Lhm)||-1<a.indexOf(J.bhm)||a===J.BEn?11:-1<a.indexOf(J.adalTimeout)?6:0:13}rAa(a,c){a=this.jQm(a.resource);r.ULS.sendTraceTag(39921882,
344,50,z.c({["callerId"]:c,["resource"]:a}))}ZMd(){r.ULS.sendTraceTag(39068822,344,50,z.c({["userAgent"]:window.navigator.userAgent}))}jQm(a){return(a?a:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(w.a)(Ba,"WopiIdentityManager",null,[804]);class la{constructor(){this.W=null}get name(){return"Common.App.WopiIdentity"}yb(a){this.W=a;a.register(Ba,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").singleInstance().Pc(()=>
new Ba(a.za("Postmessage.IHostPostmessenger")))}init(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.Io(Object(m.a)(this,this.Mv,"onFullAppSettingsReady"))}Mv(){try{this.W.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(a){r.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+a)}}dispose(){}static main(){M.a.instance.Lb(new la)}}Object(w.a)(la,"WopiIdentityPackage",null,[1,2]);var ia=b(502),oa=b(350),ha=b(69),pa;(function(a){a[a.applicationFeatureHelperHandler=
0]="applicationFeatureHelperHandler";a[a.cloudPolicySettings=1]="cloudPolicySettings";a[a.alternateAuthToken=2]="alternateAuthToken"})(pa||(pa={}));Object(w.b)("ApplicationFeatureHelperRequestType",pa);class Ea{constructor(){this.message=null;this.httpStatusCode=0}}Object(w.a)(Ea,"HttpRequstToPromiseRejectData",null,[]);var Fa=b(79),Ga=b(176);class $a{constructor(a,c){this.qa=a;this.Qe=c}cUe(a,c,h,v=null,B=null,X=null,ma=null,Pa=null){const mb=pa[h],Tb=mb+"RequestFailure";Fa.Health.instance.recordKpiUsage(Tb,
0,"jpittsdirects",null);return new Promise((rc,Tc)=>{r.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",mb);const vd=null!=ma?ma:this.qa.vb("ApplicationFeatureHelperRequestQueueTimeout",15E3),ee=null!=Pa?Pa:this.qa.vb("ApplicationFeatureHelperRequestSentTimeout",3E4);this.Qe.oTb(a,1,null,this.n2k(h,v),X,1,Ie=>{r.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",
mb);try{if(void 0===Ie||null===Ie||void 0===Ie.data||null===Ie.data||void 0===Ie.data.qd||null===Ie.data.qd){Fa.Health.instance.recordKpiFailure(Tb,"Invalid RequestSucceededEventArgs",!1,!0,null);let Yf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",mb);Tc(this.GEc(Yf,Ie))}else if(Ie.data.we!==Ga.a.wA){Fa.Health.instance.recordKpiFailure(Tb,"HttpStatusCode_"+Ie.data.we.toString(),!1,!0,null);let Yf=
String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Ie.data.we,mb);Tc(this.GEc(Yf,Ie))}else{void 0!==B&&null!==B&&void 0!==Ie.data.oj&&null!==Ie.data.oj&&B(Ie.data.oj);var Xe=c(Ie.data.qd);if(Xe)r.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",mb),rc(Xe);else{Fa.Health.instance.recordKpiFailure(Tb,
"Parse Failure",!1,!0,null);let Yf=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",mb);Tc(this.GEc(Yf,Ie))}}}catch(Yf){Fa.Health.instance.recordKpiFailure(Tb,"Unexpected Failure",!1,!0,null),Xe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Yf,mb),Tc(this.GEc(Xe,Ie))}},Ie=>{r.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",
mb);let Xe;Ie.data?(Fa.Health.instance.recordKpiFailure(Tb,"HttpStatusCode_"+Ie.data.we.toString(),!1,!0,null),Xe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Ie.data.we,Ie.data.qd||"No Data",mb)):(Fa.Health.instance.recordKpiFailure(Tb,"Invalid RequestFailedEventArgs",!1,!0,null),Xe=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
mb));Tc(this.GEc(Xe,Ie))},void 0,void 0,vd,ee)})}GEc(a,c){const h=new Ea;h.message=a;h.httpStatusCode=c&&c.data?c.data.we:-1;return h}n2k(a,c){const h={};h["x-UserDataSignature"]=this.qa.Ga("UserDataSignature");h["x-LicensingIsEnabled"]=this.qa.$("LicensingIsEnabled").toString();h["x-CacheIsEnabled"]=this.qa.$("LicensingRedisIsEnabled").toString();h["x-OcpsIsEnabled"]=this.qa.$("OcpsIsEnabled").toString();h["x-LicensingAADIdIsEnabled"]=this.qa.$("LicensingAadIdIsEnabled").toString();0===a&&(h["x-LicenseCheckOnTenantEnabled"]=
this.qa.$("LicensingForSafeLinksIsEnabled").toString(),h["x-SupportUserConsentDependentFeatures"]=this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1).toString(),h["x-AFHUserConsentGroupValue"]=this.qa.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),h["x-UseShellServiceForUserConsentGroup"]=this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),h["x-UseSALForLicensing"]=
this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),h["x-SMBUserLicensingEnabled"]=this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString());if(c)for(let v of c.keys)h[v]=c.J(v);return h}}Object(w.a)($a,"HttpRequestToPromiseUtility",null,[]);var fa;(function(a){a[a.loki=0]="loki";a[a.augloopACLP=1]="augloopACLP"})(fa||(fa={}));Object(w.b)("AlternateAuthSupportApp",fa);class sa{constructor(){this.Token=null;
this.ExpirationTime=0}}Object(w.a)(sa,"WacAlternateAuthToken",null,[]);class qa{constructor(a,c){this.zEn=3E5;if(void 0===a||null===a||void 0===c||null===c)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.qa=a;this.v1c=new ia.a(oa.a.yi());this.jkc=new $a(a,c);void 0!==O.a.sqf&&null!==O.a.sqf&&void 0!==O.a.xNd&&null!==O.a.xNd&&0<O.a.xNd&&(a=new sa,a.Token=O.a.sqf,a.ExpirationTime=O.a.xNd,this.v1c.Z("loki",a))}ERk(){let a=null;this.v1c.Ja(fa[0])&&(a=this.v1c.J(fa[0]));return void 0===
a||null===a||this.YTl(a)?this.vGk():Promise.resolve(a.Token)}YTl(a){return a.ExpirationTime-Date.now()<this.zEn}vGk(){const a=new ia.a(oa.a.yi());a.Z("X-AlternateAuthApp",fa[0]);return this.jkc.cUe(this.Aab("/afhs/AlternateAuthHelperHandler.ashx"),Object(m.a)(this,this.Jym,"parseAlternateAuthTokenResponse"),2,a).then(c=>{r.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",fa[0]);this.v1c.Z(fa[0],c);return c.Token},c=>{c=
Object(ha.a)(Ea,c);r.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",c.message,c.httpStatusCode);return null})}Jym(a){let c=null;({dv:c}=z.d(a));r.ULS.sendTraceTag(545821457,3004,c?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",a);return c}Aab(a){return String.format("{0}{1}?{2}",this.qa.Ga("WebServiceBase"),a,l.AFrameworkApplication.kl)}}Object(w.a)(qa,"AlternateAuthHelper",null,[782]);var va=b(440);
class Ca{constructor(a,c,h){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=a;this.isEnabled=c;this.tierName=h}}Object(w.a)(Ca,"FeatureStateChangeArgs",null,[]);var ta=b(105),Wa=b(190),Za=b(74),Ya=b(133),Ka;(function(a){a[a.Enabled=0]="Enabled";a[a.Disabled=1]="Disabled"})(Ka||(Ka={}));Object(w.b)("FeatureState",Ka);var xa=b(23),Sa=b(13),pb=b(295);class Db{constructor(a,c,h=null,v=null,B=null){this.L$a=this.Tna=this.KCg=this.k5a=this.Wgd=null;this.jkc=new $a(a,c);this.qa=
a;this.xlj=a.vb("LicensingMaxRetryAttempts",0);this.ioe=a.$("IsO365ConsumerHost");this.hoe=a.$("IsO365CommercialHost");this.A9c=a.$("PremiumUpsellIsEnabled");this.icg=h;this.JKg=v;this.ga=B;this.j5a=a.$("LicensingIsEnabled");this.xob=a.$("OcpsIsEnabled")&&this.hoe;this.nFe=a.$("ShowPrivacyDialog")&&!!v;this.Skc=a.$("IsAnonymousUser");this.s1e=new Promise(X=>{X(!1)});this.Pib=new Promise(X=>{X(!0)});this.K$a=new ia.a(oa.a.yi());this.ujd=this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",
!1);this.ctg=this.u5k();this.Bkf()&&!this.Skc?(void 0!==l.AFrameworkApplication.na&&null!==l.AFrameworkApplication.na&&(this.Wgd=l.AFrameworkApplication.na.Qo,void 0!==this.Wgd&&null!==this.Wgd&&(this.k5a=this.Wgd.cLa("WebServiceCall","ApplicationFeatureHelperService"))),this.L$a=this.AZf()):this.L$a=new Promise(X=>{X({})});this.L$a.catch(X=>{r.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(X))});this.ujd&&(this.A9c=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(X=>{this.A9c=this.qa.$("PremiumUpsellIsEnabled")&&
X;return null}))}u5k(){const a=this.qa.hF("AllLicensedFeatures")?this.qa.bB("AllLicensedFeatures"):[],c=new va.a;for(let h=0;h<a.length;h++)c.add(a[h]);return c}Bkf(){return this.hoe||this.ioe}AZf(a=0,c=!1){r.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",c);const h=ta.a.AD();h&&(h.set("retryAttempt",a.toString()),h.set("forceRefresh",c.toString()),h.set("isO365ConsumerHost",this.ioe.toString()),h.set("isO365CommercialHost",this.hoe.toString()),
h.set("isFreemiumUpsellEnabled",this.A9c.toString()));Fa.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",h);Fa.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",h);void 0!==this.k5a&&null!==this.k5a&&this.k5a.start();let v=null;c&&(v=new ia.a(oa.a.yi()),v.Z("x-LicensingForceRefresh","true"));this.KCg=new Date;return(this.j5a?this.jkc.cUe(this.Aab("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(m.a)(this,this.Oym,"parseApplicationFeatureHelperResponse"),
0,v,Object(m.a)(this,this.yFm,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(B=>{const X=Object.assign(new pb.a,{durationMs:this.iLi()});X.extendedProperties=h;X.extendedProperties&&B&&(X.extendedProperties.set("featureCount",Za.a.count(B).toString()),X.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in B).toString()),X.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in B).toString()),this.Tna&&X.extendedProperties.set("fromCache",
(this.Tna<this.KCg).toString()));Fa.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",X);return B},B=>{const X=Object.assign(new pb.a,{durationMs:this.iLi()}),ma=Object(ha.a)(Ea,B);if(!ma)return r.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Fa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,X),new Promise((Pa,mb)=>{mb(B)});X.extendedProperties=
h;X.extendedProperties&&X.extendedProperties.set("status",ma.httpStatusCode.toString());Fa.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,X);return 408===ma.httpStatusCode&&++a<=this.xlj?this.AZf(a):new Promise((Pa,mb)=>{mb(ma)})})}Oym(a){(a=z.b(a))?(r.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),r.ULS.sendTraceTag(50938594,3004,50,"{0}",a)):r.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return a.Features}Aab(a){var c=String.format("{0}{1}",this.qa.Ga("WebServiceBase"),a);this.qa.hF("ApplicationFeatureHelperHttpCachingEnabled")&&this.qa.$("ApplicationFeatureHelperHttpCachingEnabled")&&(a=Db.EAd(this.qa))&&0<a.length&&(this.ujd&&(a+="ucbf"),c=new Wa.QueryStringBuilder(c),c.Hd("afhskey",a),c=c.toString());return c}isFeatureEnabled(a,c){if(!this.xob&&!this.nFe&&!this.j5a)return this.Pib;r.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",
a);if("ConnectedServices"===a){var h=this.xob?this.icg.Cia("ControllerConnectedServicesEnabled"):this.Pib;const X=this.nFe?this.JKg.getSettings().then(ma=>2!==ma.yG,()=>c):this.Pib;return h.then(ma=>ma?X:this.s1e)}h=null;h=this.xob?this.icg.isFeatureEnabled(a):this.Pib;let v=null;v=this.j5a?this.MKl(a,c):this.Pib;let B=null;B=this.nFe?this.JKg.isFeatureEnabled(a):this.Pib;return h.then(X=>X?B.then(ma=>ma?v:this.s1e):this.s1e).then(X=>{this.O0h(a,X,!0);return X},()=>{this.O0h(a,c,!1);return c})}O0h(a,
c,h){r.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",a,c,h)}getFeatureTier(a,c){if(!this.j5a)return new Promise(h=>{h(2)});r.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",a);return this.L$a.then(h=>this.FCd(a,h,c),()=>c)}isFreemiumUpsellEnabled(){return this.A9c&&this.ioe&&!this.Skc}launchUpsellExperience(a,c=null){r.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",
a));var h=ta.a.AD();h&&(h.set("experienceId",a),c&&h.set("campaignId",c));Fa.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",h);if(h=xa.a.instance.ra("Common.IInProductMessagingUIManager")){const v=Object(m.a)(this,this.epl,"handleDimeTaskComplete");h.CZh(a,v,c)}else r.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),Fa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.ga.hb(Sa.a.Rxd,
2,{["experience"]:a})}vBa(a,c){if(!this.j5a)return null;if(!a||!c)return r.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const h=Ya.a.create().toString();this.K$a.Ja(a)||this.K$a.Z(a,new ia.a(oa.a.yi()));this.K$a.J(a).add(h,c);r.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",h,a));return h}R8b(a,c){this.j5a&&(a&&this.K$a.Ja(a)?
c&&Ya.a.Nc(c)?this.K$a.J(a).Ja(c)?(r.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",c,a)),this.K$a.J(a).remove(c)):r.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",c,a)):r.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",
c,a)):r.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",a)))}FCd(a,c,h){return this.ujd?a in c?c[a].LicenseTier:h:a in c?this.xzm(c[a],h):h}xzm(a,c){switch(a.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return c}}epl(){r.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.L$a.then(a=>{this.qoi(a)}).catch(()=>
{this.qoi({})})}qoi(a){r.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const c=this.AZf(0,!0);c.then(h=>{this.L$a=c;Za.a.count(h)>Za.a.count(a)?Fa.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Fa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(let v of this.K$a.keys)if(v in h){const B=this.FCd(v,h,0);v in a?this.FCd(v,a,0)!==B&&this.rwf(v,!0,B):this.rwf(v,!0,B)}else v in
a&&this.rwf(v,!1,this.FCd(v,a,0))}).catch(h=>{Fa.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);r.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(h))})}rwf(a,c,h){r.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",a,c,h);c=new Ca(a,c,h);h=this.K$a.J(a);for(let v of h)try{v.value(c)}catch(B){r.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",
a,v.key,B.message))}}LKl(a,c){if(this.j5a){const h=this.ctg.contains(a);let v=!0,B="",X=!1;return this.L$a.then(ma=>{a in ma?(ma=ma[a],B=Ka[ma.FeatureState],v=1!==ma.FeatureState):v=!h;this.d1h(a,h,B,X,c,v);return v},()=>{X=!0;h&&(v=c);this.d1h(a,h,B,X,c,v);return v})}return this.Pib}d1h(a,c,h,v,B,X){r.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",a,c,v,h,B,X)}MKl(a,c){if(this.ujd)return this.LKl(a,
c);if(this.j5a){if(this.ctg.contains(a))return this.L$a.then(h=>a in h,()=>c);r.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",a)}return this.Pib}yFm(a){try{a&&"Date"in a&&(this.Tna=new Date(a.Date),r.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.Tna.toString()))}catch(c){r.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
c)}}iLi(){if(void 0!==this.k5a&&null!==this.k5a){const a=this.k5a.Yg;this.k5a.stop();return a}return null}static EAd(a){try{if(H.a.Y3d){const c=a.Ga("UserDataSignature").split(".");if(1<c.length){const h=window.self.atob(c[1]),v=JSON.parse(h).LocalStorageKey;if(void 0!==v&&null!==v&&0<v.length)return v}}}catch(c){r.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",c.toString())}return null}}Object(w.a)(Db,"ApplicationFeatureHelper",null,[783]);var Ua=b(76);class Lb{constructor(a,
c){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=a.PolicySettings;a=new Date;a.setMinutes(a.getMinutes()+c);this.ExpirationTime=a.getTime()}}Object(w.a)(Lb,"CloudPolicySettingsCacheData",null,[]);var Va=b(1189),Sb=b(353),nb=b(221);class La{static PIi(){return l.AFrameworkApplication.K.$("SideCarIsEnabled")?La.b_d&&La.OIc?new Promise(a=>{a(!0)}):new Promise((a,c)=>{La.b_d=nb.a.create(l.AFrameworkApplication.K.Ga("SideCarUrl"));Sb.a.iR(La.b_d);La.b_d.MQ((h,v)=>{(La.OIc=v.succeeded)?
a(v.succeeded):c(v.succeeded)})}):new Promise(a=>{a(!1)})}}La.OIc=!1;La.b_d=null;Object(w.a)(La,"SideCarLoader",null,[]);class Ha{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}}Object(w.a)(Ha,"CloudPolicySettingsData",null,[]);class Aa{constructor(a,c){this.dde=0;this.Npd=null;this.jkc=new $a(a,c);this.qa=a;c=a.Ga("HostAuthType");this.xob=a.$("OcpsIsEnabled")&&a.$("IsO365CommercialHost")&&!(void 0===c||null===c)&&"aad"===c.toLowerCase();this.Twg=z.b(a.Ga("OcpsDefaultSettings")||
"{}");this.Bmc=this.EAd();c=this.qa.hF("ServicesControlsMicrosoftControllerServicesList")?this.qa.bB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.D3c=new va.a;for(let h=0;h<c.length;h++)this.D3c.add(c[h]);this.xob&&!a.$("IsAnonymousUser")&&a.$("SideCarIsEnabled")?this.Npd=this.XHn():this.Npd=this.zZf(this.xob,this.Aab("/afhs/CloudPolicySettings.ashx"),Object(m.a)(this,this.Sym,"parseCloudPolicySettingsResponse"));this.Npd.then(()=>null).catch(h=>{r.ULS.sendTraceTag(50622685,3004,
10,JSON.stringify(h))})}Cia(a,c=!0){if(!this.xob){const X=this;return new Promise(ma=>{ma(X.jEc(a))})}let h=this,v=this;const B=this.Npd.then(X=>{try{let ma=null;X.PolicySettings&&"unknown"in X.PolicySettings&&(ma=X.PolicySettings.unknown);if(ma){if(a in ma&&void 0!==ma[a]&&null!==ma[a])return new Promise(mb=>{mb("0"!==ma[a])});const Pa=a.toLowerCase();if(Pa in ma&&void 0!==ma[Pa]&&null!==ma[Pa])return new Promise(mb=>{mb("0"!==ma[Pa])});r.ULS.sendTraceTag(51512667,3004,50,"Policy"+a+" not found, using default");
return new Promise(mb=>{mb(h.jEc(a))})}return new Promise(Pa=>{Pa(h.jEc(a))})}catch(ma){return r.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+a+" policy value. Error Message: {0}",ma.message),h.handleError(ma.toString(),c,h.jEc(a))}},X=>v.handleError(X,c,v.jEc(a)));B.then(X=>{r.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",a,X);return null});return B}isFeatureEnabled(a,c=!0){if(this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))return this.OKl(a,c);let h=new Promise(B=>{B(!0)}),v="";this.D3c.contains(a)&&(v="ControllerConnectedServicesEnabled",h=this.Cia(v,c));h.then(B=>{r.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",a,B,v);return null});return h}OKl(a,c=!0){let h=new Promise(B=>{B(!0)}),v="";"mso_sendASmile"===a?v="Enabled":"Survey"===a||"FloodgateSurvey"===a?v="SurveyEnabled":this.D3c.contains(a)&&(v="ControllerConnectedServicesEnabled");
""!==v&&(h=this.Cia(v,c));h.then(B=>{r.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",a,B,v);return null});return h}handleError(a,c,h){return c?new Promise(v=>{v(h)}):new Promise((v,B)=>{B(a)})}zZf(a,c,h){if(!a)return Promise.resolve(new Ha);let v=!1,B=null;Fa.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let X=this.lTe("GetCloudPolicySettings");return(new Promise((ma,Pa)=>{if(void 0!==
this.Bmc&&null!==this.Bmc&&0<this.Bmc.length){const mb=this.AHn();if(void 0!==mb&&null!==mb){v=!0;ma(mb);return}}this.jkc.cUe(c,h,1,null,Object(m.a)(this,this.KFm,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.qa.vb("CloudPolicySettingsRequestQueueTimeout",15E3),this.qa.vb("CloudPolicySettingsRequestSentTimeout",3E4)).then(mb=>{r.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.GIn(mb);ma(mb);return mb},mb=>{Pa(mb);return null})})).then(ma=>
{({Qv:X,returnValue:B}=this.w3d(X));var Pa=ta.a.AD();Pa&&Pa.set("FromCache",v.toString());Pa=Object.assign(new pb.a,{durationMs:B,extendedProperties:Pa});Fa.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Pa);return ma})}XHn(){return La.PIi().then(()=>{r.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}Aab(a){return String.format("{0}{1}",this.qa.Ga("WebServiceBase"),
a)}Sym(a){let c=null;({dv:c}=z.d(a));r.ULS.sendTraceTag(50622687,3004,c?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",a);return c}KFm(a){try{if(void 0!==a&&null!==a&&"CheckIn-Interval"in a){const c=parseInt(a["CheckIn-Interval"]);void 0!==c&&null!==c&&0<c&&(this.dde=c)}}catch(c){r.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",c)}}jEc(a){return a in this.Twg?"0"!==this.Twg[a]:!0}AHn(){try{const a=Va.a.instance.getItem(this.Bmc);
if(void 0===a||null===a)return r.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;r.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",a);const c=JSON.parse(a);if(void 0===c||null===c)return r.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===c.ExpirationTime||null===c.ExpirationTime)return r.ULS.sendTraceTag(51662939,
3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(c.ExpirationTime)).getTime()<Date.now())return r.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const h=new Ha;h.PolicySettings=c.PolicySettings;h.ControllerConnectedServicesFeatureNames=new Ua.a;this.qa.hF("ServicesControlsMicrosoftControllerServicesList")&&this.qa.bB("ServicesControlsMicrosoftControllerServicesList");for(let v of this.D3c)h.ControllerConnectedServicesFeatureNames.add(v);
r.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return h}catch(a){return r.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",a.toString()),null}}GIn(a){try{if(void 0===a||null===a||void 0===a.PolicySettings||null===a.PolicySettings)r.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.dde)r.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");
else{const c=new Lb(a,this.dde),h=JSON.stringify(c);r.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",h);Va.a.instance.setItem(this.Bmc,h);r.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(c){r.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",c.toString())}}EAd(){const a=Db.EAd(this.qa);return a&&0<a.length?"OCPS"+a:null}lTe(a){const c=xa.a.instance.ra("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");
return void 0!==c&&null!==c?c.Pe("WebServiceCall",a):null}w3d(a){if(void 0!==a&&null!==a){const c=a.Yg;a.stop();return{returnValue:c,Qv:null}}return{returnValue:null,Qv:a}}}Object(w.a)(Aa,"CloudPolicySettingsHelper",null,[780]);class Ma{constructor(){this.Ofh=this.gXi=this.yG=0;this.Pfh=this.hXi=this.Otb="";this.yBe=this.fOa=2}clone(){const a=new Ma;a.yG=this.yG;a.gXi=this.gXi;a.Ofh=this.Ofh;a.Otb=this.Otb;a.hXi=this.hXi;a.Pfh=this.Pfh;a.fOa=this.fOa;a.yBe=this.src;return a}get src(){return this.yBe}serialize(a=
null){const c={};if(!a||a.contains(Ma.xCb))c[Ma.xCb]=this.yG;if(!a||a.contains(Ma.$Nc))c[Ma.$Nc]=this.Otb;if(!a||a.contains(Ma.aOc))c[Ma.aOc]=this.fOa;return JSON.stringify(c)}static create(a,c=null){const h=new Ma;h.yBe=a;void 0!==c&&null!==c&&(Ma.xCb in c&&(h.yG=c[Ma.xCb]),Ma.$Nc in c&&(h.Otb=c[Ma.$Nc]),Ma.aOc in c&&(h.fOa=c[Ma.aOc]));return h}static deserialize(a,c){try{const h=JSON.parse(a);if(void 0!==h&&null!==h)return Ma.create(c,h);r.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
a);throw Error.argument("settingsData");}catch(h){throw r.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",h.toString()),h;}}}Ma.xCb="CCS";Ma.$Nc="CCSTime";Ma.aOc="OfficePrivacyRoamedNoticeShown";Object(w.a)(Ma,"UserPrivacySettings",null,[]);var cb=b(137);class ib{constructor(a,c){if(void 0===a||null===a||void 0===c||null===c)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.qa=a;this.Qe=c;this.pAe=this.Kc=null}Aab(a){var c=String.format("{0}RoamingServiceHandler.ashx?action=",
this.qa.appSettings.RoamingServiceHandlerWebServiceBase||"");c=new Sys.StringBuilder(c);c.append(a);c.append("&");c.append(l.AFrameworkApplication.kl);return c.toString()}executeRequest(a,c,h,v=null){return this.Qe.Ttc(a,c,v,null,h,"33",!1,null,6E4)}saveSettings(a){return new Promise((c,h)=>{try{if(void 0===this.Kc||null===this.Kc||void 0===a||null===a)r.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),h("Can't determine setting changes to save");
else{var v=this.Kc.yG!==a.yG;if(2===this.Kc.src&&v)this.v7m(a),c(!0);else{var B=this.Yan(a);if(void 0===B||null===B||!B.length)r.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),h("No changes to save");else if(1===this.Kc.src)c(this.JRi(B));else if(0===this.Kc.src){r.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",B);const X=this.executeRequest(this.Aab("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",
B);X.continueWith(()=>{if(X.Hn||X.Gh)r.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),c(!1);else{var ma=X.result;void 0!==ma.args&&null!==ma.args&&void 0!==ma.args.data&&null!==ma.args.data&&ma.args.data.we===Ga.a.wA?(r.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),c(!0)):(r.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),c(!1))}})}}}}catch(X){r.ULS.sendTraceTag(50860930,
3004,10,"SaveUserPrivacySettings: Exception = {0}",X.toString()),c(!1)}})}Yan(a){if(void 0===this.Kc||null===this.Kc||void 0===a||null===a)throw Error.invalidOperation("User Privacy settings have not been initialized");const c=new Ua.a;0===a.src?(this.Kc.yG!==a.yG&&(c.add(Ma.xCb),c.add(Ma.$Nc)),this.Kc.fOa!==a.fOa&&c.add(Ma.aOc)):1===a.src&&this.Kc.yG!==a.yG&&c.add(Ma.xCb);return c.count?a.serialize(c):(r.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.pAe){const a=this;this.pAe=new Promise(c=>{try{a.Kc?c(a.Kc.clone()):a.RHn().then(h=>{a.Kc=h;c(a.Kc.clone());return null},()=>{a.PHn().then(h=>{a.Kc=h;c(a.Kc.clone());return null},()=>{a.QHn().then(h=>{a.Kc=h;c(a.Kc.clone());return null},()=>{r.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");a.Kc=new Ma;c(a.Kc.clone());return null});return null});return null})}catch(h){r.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
h.toString()),a.Kc=new Ma,c(a.Kc.clone())}})}return this.pAe}RHn(){return new Promise((a,c)=>{try{const v=-1!==window.location.href.indexOf("&wd_pn=2");if(this.qa.$("PrivacyDialogShouldCheckRoaming")||v){var h=this.executeRequest(this.Aab("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");h.continueWith(()=>{try{if(h.Hn||h.Gh)r.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const B=h.result;if(B&&B.args&&B.args.data)if(B.args.data.we!==
Ga.a.wA)r.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",B.args.data.we);else{if(B.args.data.qd){a(ib.parse(B.args.data.qd,0));r.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",B.args.data.qd);return}r.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else r.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");
c("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(B){r.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",B.toString()),c("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else r.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),c("Roaming should not be used")}catch(v){r.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",
v.toString()),c("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}PHn(){return new Promise((a,c)=>{try{const h=cb.a.get("WacUPToggleState");let v=null;void 0!==h&&null!==h&&0<h.length&&(v=decodeURIComponent(h));if(void 0!==v&&null!==v&&0<v.length){const B=ib.parse(v,1);r.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",B.toString());a(B)}else{const B=Ma.create(1),X=new Ua.a;X.add(Ma.xCb);const ma=B.serialize(X);this.JRi(ma)?(r.ULS.sendTraceTag(51258449,
3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",ma),a(B)):(r.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",ma),c("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(h){r.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",h.toString()),c("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}QHn(){return new Promise(a=>
{try{var c=-1!==window.location.href.indexOf("&wdccsoff=1");let h=Ma.create(2);c?(h.yG=2,l.AFrameworkApplication.Sdh(),r.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",h.toString())):(h.yG=1,r.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",h.toString()));a(h)}catch(h){r.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",h.toString()),
c=Ma.create(2),c.yG=1,a(c)}})}v7m(a){r.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===a.yG?l.AFrameworkApplication.Sdh():l.AFrameworkApplication.sAk();r.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",a)}JRi(a){try{r.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",a);const c=this.qa.Ga("PrivacyCookieDomain")||"";if(!c||!c.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");
r.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",a);return cb.a.dEi("WacUPToggleState",a,cb.a.fLa,c)}catch(c){return r.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",c.toString()),!1}}isFeatureEnabled(a){return this.getSettings().then(c=>{const h=this.qa.hF("ServicesControlsMicrosoftControllerServicesList")?this.qa.bB("ServicesControlsMicrosoftControllerServicesList"):[],v=new va.a;for(let B=0;B<h.length;B++)v.add(h[B]);return v.contains(a)?
2!==c.yG:!0},()=>{r.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",a);return!0})}static parse(a,c){try{return r.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",a,c),Ma.deserialize(a,c)}catch(h){throw r.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",h.toString()),h;}}}Object(w.a)(ib,"UserPrivacySettingsHelper",null,[781]);class Rb{constructor(){this.W=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}yb(a){this.W=
a;this.W.register(780,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").singleInstance().Pc(()=>new Aa(l.AFrameworkApplication.K,l.AFrameworkApplication.fe));this.W.register(781,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").singleInstance().Pc(()=>new ib(l.AFrameworkApplication.K,l.AFrameworkApplication.fe));this.W.register(782,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").singleInstance().Pc(()=>new qa(l.AFrameworkApplication.K,l.AFrameworkApplication.fe));
this.W.register(783,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").singleInstance().Pc(()=>new Db(l.AFrameworkApplication.K,l.AFrameworkApplication.fe,this.W.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.W.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),l.AFrameworkApplication.pa))}init(){l.AFrameworkApplication.K.Io(()=>{const a=this.W.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");l.AFrameworkApplication.K.$("LicensingIsEnabled")&&
(a.isFeatureEnabled("LicensingTestFeature",!1).then(c=>{r.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",c,l.AFrameworkApplication.K.Ga("IsAnonymousUser"));return null}),a.getFeatureTier("LicensingTestFeature",0).then(c=>{r.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",c,l.AFrameworkApplication.K.Ga("IsAnonymousUser"));
return null}));this.W.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.eCn()})}dispose(){}eCn(){try{l.AFrameworkApplication.K.$("SideCarIsEnabled")&&La.PIi().then(a=>{r.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",a);return a})}catch(a){}}static main(){M.a.instance.Lb(new Rb)}}Object(w.a)(Rb,"ApplicationFeatureHelperPackage",null,[1,2]);var Oa=b(174);class lb{JAd(a,c){let h;const v=[];for(;h=c.exec(a);){const B=h.index;
v.push(new Oa.a(B,B+h[0].length))}return v}isEndPuncSpecialCase(a){const c=this.JAd(a,lb.Nun);for(const h of c)if(h.end===a.length)return!0;return!1}hBc(a){for(const c of lb.wEk){const h=this.JAd(a,c);if(0<h.length&&!h[0].begin)return h[0].end-1}return 0}findBeginBoundary(a,c,h){var v=a.substring(h,c);a=this.JAd(v,lb.zhh);for(c=a.length-1;0<=c;c--){const B=v.substring(0,a[c].end);if(!this.isEndPuncSpecialCase(B))return v=v.substring(a[c].begin,v.length),h+a[c].end+this.hBc(v)}return h}findEndBoundary(a,
c,h){var v=a.substring(c,h);a=this.JAd(v,lb.zhh);for(h=0;h<a.length;h++){const B=v.substring(0,a[h].end);if(!this.isEndPuncSpecialCase(B))return v=v.substring(a[h].begin,v.length),c+a[h].end+this.hBc(v)}return-1}}lb.T0e="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b]|[\u00bb\u2019\u201d\u203a\"']|[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])*[\u2028\u2029\n\r])";
lb.U0e="([?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t])+)";lb.V0e="([\u3002\uff61]([)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]|[\u2639\u263a\u263b])*)";lb.wEk=
[new RegExp(lb.T0e,"ig"),new RegExp(lb.U0e,"ig"),new RegExp(lb.V0e,"ig")];lb.pUf="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";lb.sUf="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";lb.rUf="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";
lb.qUf=lb.sUf+"|"+lb.rUf;lb.tUf="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";lb.uUf="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";lb.vUf="(([A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]|[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]|[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45])[.])+|(([\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d])[.\ufe52\uff0e])+";
lb.wUf="([\uff21-\uff3a\uff41-\uff5a])[.\ufe52\uff0e]";lb.POf="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f])("+
lb.qUf+"|"+lb.tUf+"|"+lb.uUf+")";lb.OOf="([ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]|[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]|[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]|[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]|[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]|[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]|[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a])("+
lb.vUf+")";lb.awf=lb.pUf+"|"+lb.wUf;lb.oUf=lb.awf+"|"+lb.POf+"|"+lb.OOf;lb.zhh=RegExp("[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]|[\u3002\uff61]","ig");lb.Nun=new RegExp(lb.oUf,"g");Object(w.a)(lb,"ProofingSentenceSeparatorScriptSharp",null,[776]);class gb{t0c(a,c){const h=[];let v;for(;null!=(v=c.exec(a));){const B=v.index;h.push({begin:B,end:B+v[0].length})}return h}isEndPuncSpecialCase(a){return this.t0c(a,gb.p4i).some(c=>
c.end==a.length)}hBc(a){for(const c of gb.u1i){const h=this.t0c(a,c);if(0<h.length&&0==h[0].begin)return h[0].end-1}return 0}findBeginBoundary(a,c,h){var v=a.substring(h,c);a=this.t0c(v,gb.c4f);for(c=a.length-1;0<=c;c--){const B=v.substring(0,a[c].end);if(!this.isEndPuncSpecialCase(B))return v=v.substring(a[c].begin,v.length),h+a[c].end+this.hBc(v)}return h}findEndBoundary(a,c,h){var v=a.substring(c,h);a=this.t0c(v,gb.c4f);for(h=0;h<a.length;h++){const B=v.substring(0,a[h].end);if(!this.isEndPuncSpecialCase(B))return v=
v.substring(a[h].begin,v.length),c+a[h].end+this.hBc(v)}return-1}}gb.o0i="[)]}\u0f3b\u0f3d\u2046\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\uff09\uff3d\uff5d\uff60\uff63]";gb.k4i="[\u2639\u263a\u263b]";gb.i6f="[\x00-\b\n-\u0019\u007f-\u009f\u2028-\u2029\u202f\u205f]";gb.j1i="[0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\uff10-\uff19]";
gb.n3i="[\u00b2\u00b3\u00b9\u00bc\u00bd\u00be\u09f4-\u09f9\u0bf0\u0bf1\u0bf2\u0c78-\u0c7e\u0d70-\u0d75\u0f2a-\u0f33\u1369-\u137c\u17f0-\u17f9\u3007\u3021-\u3029\u3038\u3039\u303a]";gb.N6f="[!-#%-*,-/:-;?-@[-]_{}\u00a1\u00ab\u00ac\u00b7\u00bb\u00bf\u037e\u0387\u055a-\u055f\u0589-\u058a\u05be\u05c0\u05c3\u05c6\u05f3-\u05f4\u0609-\u060a\u060c-\u060d\u061b\u061e-\u061f\u066a-\u066d\u06d4\u0964-\u0965\u0970\u0df4\u0e4f\u0e5a-\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u104a-\u104f\u10fb\u1361-\u1368\u166d-\u166e\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a-\uff1b\uff1f-\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]";
gb.Symbol="[$+<=>^`|~\u00a2\u00a3\u00a4\u00a5-\u00a9\u00ac\u00ae\u00af\u00b0\u00b1\u00b4\u00b6\u00b8\u00d7\u00f7\u02c2-\u02c5\u02d2-\u02df\u02e5-\u02eb\u02ed\u02ef-\u02ff\u0375\u0384\u0385\u03f6\u0482\u0606\u0607\u0608\u060b\u060e\u060f\u06de\u06e9\u06fd\u06fe\u09f2\u09f3\u09fa\u0af1\u0b70\u0bf3-\u0bfa\u0c7f\u0d79\u0e3f\u0f01\u0f02\u0f03\u0f13\u0f15\u0f16\u0f17\u0f1a-\u0f1f\u0f34\u0f36\u0f38\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce\u0fcf\u109e\u109f\u1390-\u1399\u17db\u2044\u2052\u3004\u3012\u3013\u3020\u3036\u3037\u303e\u303f\u309b\u309c\uff04\uff0b\uff1c\uff1d\uff1e\uff3e\uff40\uff5c\uff5e\uffe0-\uffe6\uffe8-\uffee]";
gb.h6f="[\u0600-\u0603\u06dd\u180e\u200b-\u200d\u2060-\u2064\u206a-\u206f]";gb.w2i="[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d0\u00d1-\u00d6\u00d8-\u00f6\u00f8-\u01ba\u01bc-\u01bf\u01c4-\u0293\u0295-\u0373\u0376\u0377\u037b\u037c\u037d\u0386\u0388\u0389\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0523\u0531-\u0556\u0561-\u0587\u10a0-\u10c5]";gb.v2i="[\uff21-\uff3a\uff41-\uff5a]";gb.t2i="[\u01bb\u01c0-\u01c3\u0294\u05d0-\u05ea\u05f0\u05f1\u05f2\u0621-\u063f\u0641-\u064a\u066e\u066f-\u06d3\u0671\u06d5\u06ee\u06ef\u06fa\u06fb\u06fc\u06ff\u0904-\u0939\u093d\u0950\u0958-\u0961\u0972\u097b-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df\u09e0\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a19\u0a1a-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d3d\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8b\u1780-\u17b3\u17d7\u17dc\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10d0-\u10fa\u1100-\u1159\u115f\u1160-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1820-\u1877\u1880-\u18a8\u18aa\u3006\u303c\uac00-\ud7a3\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]";
gb.s2i="[\u3041-\u3096\u309f\u30a1-\u30fa\u30ff\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\uff66-\uff9d]";gb.u2i="[\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e45]";gb.m9d="[?!.\u0589\u06d4\u0701\u0702\u0964\u0965\u1362\u166e\u1803\u1809\u2cf9\u2cfe\u3002\ua4ff\ua60e\ua6f3\ufe12\ufe52\uff0e\uff61]";gb.b4f="[\u3002\uff61]";gb.J0c="[ \u00a0\u2000-\u200a\u202f\u205f\u3000\t]";gb.A1i="[\u00bb\u2019\u201d\u203a\"']";gb.F9d=gb.o0i+"|"+gb.k4i;gb.x2i="[\u2028\u2029\n\r]";gb.r2i="("+gb.J0c+"|"+gb.i6f+"|"+gb.N6f+"|"+gb.h6f+
")";gb.q2i="("+gb.J0c+"|"+gb.i6f+"|"+gb.N6f+"|"+gb.Symbol+"|"+gb.h6f+"|"+gb.j1i+"|"+gb.n3i+")";gb.T0e="("+gb.m9d+"("+gb.F9d+"|"+gb.A1i+"|"+gb.J0c+")*"+gb.x2i+")";gb.U0e="("+gb.m9d+"("+gb.F9d+")*("+gb.J0c+")+)";gb.V0e="("+gb.b4f+"("+gb.F9d+")*)";gb.u1i=[new RegExp(gb.T0e,"ig"),new RegExp(gb.U0e,"ig"),new RegExp(gb.V0e,"ig")];gb.pUf="[.\u3002\ufe52\uff0e\uff61]{2,6}|[.]([ ][.]){1,5}";gb.sUf="(((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]";
gb.rUf="((([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])?([\uff36]?[\uff29]{1,3}|[\uff29][\uff36\uff38]|[\uff36]))|([\uff2c]?[\uff38]{1,3}|[\uff38][\uff2c\uff23]|[\uff2c])|(([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c])?([\uff56]?[\uff49]{1,3}|[\uff49][\uff56\uff58]|[\uff56]))|([\uff4c]?[\uff58]{1,3}|[\uff58][\uff4c\uff43]|[\uff4c]))[.\ufe52\uff0e]";gb.qUf=gb.sUf+"|"+gb.rUf;gb.tUf="([0-9]{1,4}[.]|[\uff10-\uff19]{1,4}[.\ufe52\uff0e])";gb.uUf="([0-9]+(([ao\u00aa\u00ba\u1d43\u1d52])|((er)[ao]?)|(([\u1d49][\u02b3])[\u1d43\u1d52]?)|([mdtvn][ao])|([\u1d50\u1d48\u1d57\u1d5b\u207f][\u1d43\u02b3]))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-z\u00c0\u00c4\u00c8\u00c9\u00d4\u00d6\u00dc\u00df\u00e0\u00e4\u00e8\u00e9\u00f4\u00f6\u00fc]+((STR)|(str))[.])";
gb.vUf="(("+gb.w2i+"|"+gb.t2i+"|"+gb.u2i+")[.])+|(("+gb.s2i+")[.\ufe52\uff0e])+";gb.wUf="("+gb.v2i+")[.\ufe52\uff0e]";gb.POf=gb.r2i+"("+gb.qUf+"|"+gb.tUf+"|"+gb.uUf+")";gb.OOf=gb.q2i+"("+gb.vUf+")";gb.awf=gb.pUf+"|"+gb.wUf;gb.oUf=gb.awf+"|"+gb.POf+"|"+gb.OOf;gb.c4f=new RegExp(gb.m9d+"|"+gb.b4f,"ig");gb.p4i=new RegExp(gb.oUf,"g");Object(w.a)(gb,"ProofingSentenceSeparator",null,[776]);class Nb{constructor(){this.W=null}get name(){return"Box4.ProofingGrammarCheck"}yb(a){this.W=a;l.AFrameworkApplication.K.$("ProofingSentenceSeparatorTypeScriptIsEnabled")?
a.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new gb).singleInstance():a.ha("Box4.Proofing.IProofingSentenceSeparator",()=>new lb).singleInstance()}init(){this.W.resolve("Box4.Proofing.IProofingSentenceSeparator")}dispose(){}static main(){M.a.instance.Lb(new Nb)}}Object(w.a)(Nb,"Box4GrammarCheckPackage",null,[1,2]);var qc=b(92),Eb=b(12),ec=b(75),Jb=b(7),vb=b(67);class xb{constructor(a,c,h,v){var B;this.xye=this.n$c=this.wme=this.jd=null;this.wrg=this.bnb=this.pna=this.tna=this.Qbe=!1;this.Baa=
0;this.HSf=!1;this.Ic=a;this.Kh=c;this.qfc=h;this.Rb=v;this.KFi=null===(B=l.AFrameworkApplication.K)||void 0===B?void 0:B.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfEarlyExitAtMentions",!1);this.reset()}Wuc(a,c){this.tna||(this.tna=!0,a.Qqa?this.n8a(c):a.lba(()=>{this.tna||this.n8a(c)}))}dispose(){this.bnb&&(Eb.App.oa.$bc.xb(Jb.a.input,this.Rb.editingView.editingElement,Object(m.a)(this,this.Ila,"textInputHandler")),this.bnb=!1);this.Qbe&&(this.jd.xb(Jb.a.Tuc,this.Rb.editingView.editingElement,
Object(m.a)(this,this.SVg,"beforeKeyUpHandler")),this.Qbe=!1);this.wrg&&(this.jd.xb(Jb.a.tG,this.Rb.editingView.editingElement,Object(m.a)(this,this.m8a,"beforeKeyDownHandler")),this.jd.xb(Jb.a.Hg,this.Rb.editingView.editingElement,Object(m.a)(this,this.JKa,"keyUpHandler")));Eb.App.oa.eea(Object(m.a)(this,this.gDb,"onWindowResize"));this.jLi()}gDb(){this.reset()}Xoi(a){this.wme=a}ipi(a){this.xye=a}Yoi(a){this.n$c=a}$Sj(){this.pna=!0;l.AFrameworkApplication.Mg("ContextIQAtMentionEntryPoint-Treatment;ContextIQAtMentionEntryPoint-Control")}jLi(){this.pna=
!1}n8a(a){this.jd=a;this.Rb.rc?this.Rb.rc.Rh&&(Eb.App.kvc&&H.a.V3d||H.a.so?(Eb.App.oa.$bc.Ea(Jb.a.input,this.Rb.editingView.editingElement,Object(m.a)(this,this.Ila,"textInputHandler"),null),this.bnb=!0):this.jd&&H.a.Gi&&(this.jd.Ea(Jb.a.Tuc,this.Rb.editingView.editingElement,Object(m.a)(this,this.SVg,"beforeKeyUpHandler")),this.Qbe=!0),this.jd&&(this.jd.Ea(Jb.a.tG,this.Rb.editingView.editingElement,Object(m.a)(this,this.m8a,"beforeKeyDownHandler")),this.jd.Ea(Jb.a.Hg,this.Rb.editingView.editingElement,
Object(m.a)(this,this.JKa,"keyUpHandler")),this.wrg=!0),this.qfc.JPg(Object(m.a)(this,this.OLe,"backspaceDeleteHandler")),Eb.App.oa.r_(Object(m.a)(this,this.gDb,"onWindowResize"))):r.ULS.sendTraceTag(593376530,324,10,"SelectionView is null. AtMentions will not work in this session")}m8a(a){this.Baa=a.Sa.keyCode;if(this.KFi){var c=a.Sa.rawEvent.key;c&&c!==xb.aI||(this.HSf=!0)}return this.pna&&this.n$c?a.Sa.keyCode===vb.a.V5||a.Sa.keyCode===vb.a.Nq||a.Sa.keyCode===vb.a.Sv?(c=!1,a.Sa.keyCode===vb.a.V5?
(r.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),c=!0):a.Sa.keyCode===vb.a.Nq?r.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):a.Sa.keyCode===vb.a.Sv&&r.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this.n$c(a),c&&this.reset(),!0):a.Sa.keyCode===vb.a.F$||a.Sa.keyCode===vb.a.O1||a.Sa.keyCode===vb.a.cZ||a.Sa.keyCode===vb.a.dZ?(this.n$c(a),!0):!1:!1}Ila(a){if(!this.KFi||this.HSf||
this.pna){this.HSf=!1;var c=this.sEc(),h=this.hDc(a.Sa.target),v=a.Sa.rawEvent.inputType;return(void 0!==v&&null!==v||this.Baa!==vb.a.PC&&this.Baa!==vb.a.U5)&&"deleteContentBackward"!==v&&"deleteContentForward"!==v?this.eIh(c,h,a.Sa.target):!1}}eIh(a,c,h){if(1>c)return!1;a=a.replace(new RegExp(xb.hA,"g"),"");const v=a.charAt(c-1);this.pna&&v!==xb.aI?this.wcf(a,c,h):this.pna||v!==xb.aI?this.pna&&v===xb.aI&&r.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this.wme&&
(this.reset(),this.REm(c,a)&&(this.$Sj(),this.wcf(a,c,h),r.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===c?"true":"false")));return this.pna}SVg(a){if(1!==a.Sa.rawEvent.key.length)return!1;const c=this.sEc(),h=this.hDc(a.Sa.target);return this.eIh(c,h,a.Sa.target)}JKa(a){if(!this.pna)return!1;const c=this.sEc(),h=this.hDc(a.Sa.target);(a.Sa.keyCode===vb.a.PC||a.Sa.keyCode===vb.a.U5||(a.Sa.keyCode===vb.a.vOa||a.Sa.keyCode===vb.a.uec)&&a.Sa.ctrlKey)&&this.wcf(c,h,a.Sa.target);
return!1}reset(){this.tna=!1;this.jLi();this.xye&&this.xye()}hDc(a){return this.Kh.mZb(2,a)}sEc(){return this.Ic.Gn().innerText}REm(a,c){return 0>a-2||this.h3j(c.charAt(a-2))?!0:!1}h3j(a){return F.a.d9(a)||"("===a}wcf(a,c,h){if(!a||""===a||0>c)this.reset();else{const {gyi:v,RUg:B}=this.HWl(a,c);this.wme(v,h,B)}}HWl(a,c){let h=this.mSk(a,c);if(0<=h&&c<=a.length)return{gyi:a.substring(h,c),RUg:h};this.reset();return{gyi:"",RUg:h}}mSk(a,c){let h=-1;for(let v=c;0<=v&&63>=c-v;v--)if(a.charAt(v)===xb.aI){h=
v;break}return h}yol(a){a=this.hDc(a.Sa.target);a=this.sEc().charAt(a-1);this.pna&&a===xb.aI&&this.reset()}Yol(a){a=this.hDc(a.Sa.target);a=this.sEc().charAt(a);this.pna&&a===xb.aI&&this.reset()}OLe(a,c){this.Baa=c.Ahf?vb.a.PC:c.isDelete?vb.a.U5:this.Baa;this.pna&&(c.Ahf?this.yol(c.LYh):c.isDelete&&this.Yol(c.LYh))}}xb.aI="@";xb.hA="\n";Object(w.a)(xb,"AtMentionsListener",null,[775]);class lc{constructor(){this.W=null}get name(){return"Box4.AtMentions"}yb(a){this.W=a;this.W.ha("Box4.AtMentions.IAtMentionsListener",
()=>new xb(this.W.resolve("Box4.IEditingDomManager"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.BackspaceDeleteEventSource"),ec.InteractiveViewManager.instance)).singleInstance()}init(){l.AFrameworkApplication.K.$("CanvasAtMentionDetectionIsEnabled")&&l.AFrameworkApplication.K.Io(()=>{this.W.resolve("Box4.AtMentions.IAtMentionsListener").Wuc(Eb.App.oa.Da,qc.KeyInputManager.instance)})}dispose(){this.W.resolve("Box4.AtMentions.IAtMentionsListener").dispose()}static main(){M.a.instance.Lb(new lc)}}
Object(w.a)(lc,"Box4AtMentionsPackage",null,[1,2]);class Lc{get name(){return"Box4.Workers"}yb(){}init(){}dispose(){}static main(){M.a.instance.Lb(new Lc)}}Object(w.a)(Lc,"Box4WorkersPackage",null,[1,2]);var uc=b(303),od=b(78);class Cb{constructor(){this.rDa=new od.a}p1(a,c){this.rDa.Z(a,c)}N4e(a){({value:a}=this.rDa.Ab(a));return a}}Object(w.a)(Cb,"AggregationMethodsForActivityName",null,[]);var gc=b(236);class Dc{constructor(){this.Idd=new uc.a;this.rDa=new uc.a}p1(a,c,h){this.rDa.Ja(a)&&this.rDa.J(a)||
this.rDa.Z(a,new Cb);this.rDa.J(a).p1(c,h)}N4e(a,c){return this.rDa.Ja(a)&&this.rDa.J(a)?this.rDa.J(a).N4e(c):null}AEc(a){this.Idd.Ja(a)&&this.Idd.J(a)||this.Idd.Z(a,new gc.a);return this.Idd.J(a)}$ah(a,c){this.AEc(a).add(c)}}Object(w.a)(Dc,"ActivityAggregationInfo",null,[805]);var Ub=b(246),Bb=b(874),fb=b(888);class yb extends Bb.a{constructor(a,c){super(a);this.LEe=(this.Q6i=c)?c.L0k():fb.a.y4e()}get iwa(){return this.Q6i}get activityName(){return this.iwa.name}get startTime(){return this.iwa.startTime}get endTime(){return this.iwa.endTime}end(){}cancel(){}r3e(){}XNn(){this.ZYb.Z("AM",
this.iwa.mode.toString());this.ZYb.Z("C",this.iwa.count.toString());this.ZYb.Z("DA",this.iwa.agh.toFixed(2));this.ZYb.Z("DV",this.iwa.Kyk.toFixed(2))}n$e(a){return this.iwa.n$e(a)}J$e(){return this.iwa.J$e()}qTb(){for(let a of this.iwa.jwa)a.qTb()}}Object(w.a)(yb,"AggregatedActivity",Bb.a,[]);class Wb{constructor(a,c){this.Gae=0;this.Pta=a;this.yOa=c}iLj(a,c){this.Gae=c;for(c=0;c<a.count;c++){const h=a.J(c);this.jLj(h)}}jLj(a){const c=Object(ha.a)(yb,a);if(c)if(1===this.Gae)this.hLj(c);else if(2===
this.Gae){this.kLj(c);for(let h of this.yOa.AEc(this.Pta)){const v=c.iwa.jwa.J(0);v.properties.Ja(h)&&a.properties.Z(h,v.properties.J(h))}}}hLj(a){for(let c of this.yOa.AEc(this.Pta))this.twi(a,c)}kLj(a){for(let c of a.J$e())this.twi(a,c)}twi(a,c){const h=this.yOa.N4e(this.Pta,c);if(h){const v=a.n$e(c);a.properties.Z(c,h(v))}}}Object(w.a)(Wb,"PropertyAggregationHelper",null,[]);var Xb=b(953);class Cc{constructor(a,c,h,v,B){this.cKb=a;this.yOa=c;this.Ocg=B;this.pae=v;this.Ukj=h}get GMg(){return this.Ukj.value}dxc(a){if(Object(Ub.a)(Xb.a,
a))a.dxc();else if(Object(Ub.a)(yb,a)&&this.pae.n_g(a.activityName.toString())){a=Object(ha.a)(yb,a);a.XNn();a=a.J3h();var c=[];Array.add(c,a);a=z.c(c);r.ULS.sendTraceTag(6907266,213,50,a)}}swa(a,c){const h=(new Date).getTime();var v=this.Ocg.list.J(a);const B=({mLj:v}=this.RQk(v)).returnValue;this.Ocg.list.Z(a,new Ua.a);c&&(v=this.dfk(v,h,this.cKb.MGh));0<v.count&&(new Wb(a,this.yOa)).iLj(v,B)}dfk(a,c,h){const v=new Ua.a;for(let B=0;B<a.count;B++){const X=a.J(B);X.startTime>c-h?X.qTb():v.add(X)}return v}RQk(a){const c=
this.GMg.uOi(a);a=this.GMg.qDn(a);const h=this.nLj(c,a);return{returnValue:h,mLj:1===h?c:a}}nLj(a,c){return a.count*this.cKb.S5h<c.count?1:2}get enabled(){return this.cKb.enabled}qTb(){}}Object(w.a)(Cc,"ActivityAggregationManager",null,[803]);class Bc{constructor(a){this.enabled=!1;this.s4h=500;this.x5h=2;this.S5h=5;this.MGh=3E4;this.nBc(a.appSettings)}nBc(a){this.enabled=Boolean.parse(a[Bc.n_e]||"false");this.s4h=parseInt(a[Bc.obm]||"500");this.x5h=parseInt(a[Bc.Vdm]||"2");this.S5h=parseInt(a[Bc.rem]||
"5");this.MGh=parseInt(a[Bc.lnl]||"30000")}}Bc.n_e="ActivityAggregationEnabled";Bc.obm="ActivityAggregationMaxInterval";Bc.Vdm="ActivityAggregationMinChain";Bc.rem="ActivityAggregationModeFactor";Bc.lnl="ActivityAggregationGraceWindow";Object(w.a)(Bc,"ActivityAggregationParams",null,[]);class pd{constructor(a,c){this.yOa=a;this.a9f=c}uOi(a,c=1){if(!a||!a.count)return a;const h=new Ua.a;var v=null;for(let B=0;B<a.count;B++){const X=a.J(B);if(!X)continue;const ma=X.activityName;v?v.oVl(X)?v.add(X):
(v=v.process(),h.addRange(v),v=this.a9f(ma,c),v.add(X)):(v=this.a9f(ma,c),v.add(X))}v&&(a=v.process(),h.addRange(a));return h}qDn(a){if(!a||!a.count)return a;const c={};var h=null;for(let B=0;B<a.count;B++){const X=a.J(B);if(X){if(!h){h=new Ua.a;var v=this.yOa.AEc(X.activityName);for(let ma of v)h.add(ma)}v=this.pcl(X,h);null!==v&&(v in c&&c[v]||(c[v]=new Ua.a),c[v].add(X))}}a=new Ua.a;for(const B of Za.a.rM(c))h=this.uOi(c[B],2),a.addRange(h);return a}pcl(a,c){let h="";for(let v of c)h+=v,h=a.properties.Ja(v)&&
void 0!==a.properties.J(v)&&null!==a.properties.J(v)?h+a.properties.J(v):h+"null";return h}}Object(w.a)(pd,"ActivityAggregationSchemes",null,[802]);class zd{constructor(a,c,h,v,B){this.wq=this.lh=0;this.cKb=h;this.Kec=v;this.yOa=B;this.name=a;this.eD=c;this.jwa=new Ua.a}get mode(){return this.eD}get count(){return this.jwa.count}get startTime(){return this.lh}get endTime(){return this.wq}get agh(){if(!this.count)return 0;let a=0;for(let c of this.jwa)a+=c.endTime-c.startTime;return a/this.count}get Kyk(){if(!this.count)return 0;
let a=0;const c=this.agh;for(let h of this.jwa){const v=h.endTime-h.startTime;a+=(v-c)*(v-c)}return a/this.count}add(a){this.count?this.wq=a.endTime>this.endTime?a.endTime:this.endTime:(this.lh=a.startTime,this.wq=a.endTime);this.jwa.add(a)}oVl(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.cKb.s4h}process(){if(this.count>=this.cKb.x5h){const a=new Ua.a,c=this.Kec(this);a.add(c);return a}return this.jwa}n$e(a){const c=new Ua.a;for(let h of this.jwa)if(h.properties.Ja(a)){const v=h.properties.J(a);
c.add(v)}else c.add(null);return c}J$e(){const a=this.yOa.AEc(this.name),c=new gc.a;for(let h of this.qRk())a.contains(h)||c.add(h);return c}qRk(){const a=new gc.a;if(!this.jwa)return a;for(let c of this.jwa)for(let h of c.properties.keys)a.add(h);return a}L0k(){return this.jwa.J(0).uniqueID}}Object(w.a)(zd,"ActivityCollection",null,[801]);class Jd{constructor(){this.Kkb=new uc.a}get list(){return this.Kkb}add(a){const c=a.activityName;if(this.Kkb.Ja(c)&&this.Kkb.J(c)){const h=this.J3k(this.Kkb.J(c),
a);this.Kkb.J(c).insert(h,a)}else this.Kkb.Z(c,new Ua.a),this.Kkb.J(c).add(a)}J3k(a,c){for(let h=a.count-1;0<=h;h--)if(c.startTime>a.J(h).startTime)return h+1;return 0}}Object(w.a)(Jd,"CompletedActivitiesHelper",null,[799]);class Ue{constructor(){this.W=null}get name(){return"Common.App.ActivityAggregator"}init(){l.AFrameworkApplication.UK(()=>{this.W.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}yb(a){this.W=a;const c=v=>new yb(()=>a.ra("Common.App.Activities.IActivityAggregationManager"),
v),h=(v,B)=>new zd(v,B,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),c,a.resolve("Common.IActivityAggregationInfo"));a.register(Cc,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").singleInstance().Pc(()=>new Cc(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.te("Common.App.ActivityAggregator.IActivityAggregationSchemes"),a.resolve("Common.App.Activities.IActivityThrottler"),
a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));a.register(Bc,"Common.App.ActivityAggregator.ActivityAggregationParams").singleInstance().Pc(()=>new Bc(l.AFrameworkApplication.K));a.register(Dc,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").singleInstance().Pc(()=>new Dc);a.register(pd,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").singleInstance().Pc(()=>
new pd(a.resolve("Common.IActivityAggregationInfo"),h));a.register(Jd,"Common.App.ActivityAggregator.CompletedActivitiesHelper").singleInstance().Pc(()=>new Jd)}static main(){M.a.instance.Lb(new Ue)}}Object(w.a)(Ue,"ActivityAggregatorPackage",null,[1,2]);var Sc=b(505),kc=b(1202);class Pc{constructor(a){this.YAg=0;this.$ce=null;this.Lrj=a}get chat(){return window.swc}get isInitialized(){return!!this.chat}get MRf(){return this.Lrj.value}eb(){this.isInitialized?this.I8b():this.$Sm(Object(m.a)(this,this.I8b,
"registerActionsInternal"))}I8b(){r.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(a=>{a.getChatsContainer(Object(m.a)(this,this.ulm,"onChatContainerReady"))}).catch(a=>{r.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",a)}),this.chat.getChatsCounter().then(a=>{a.onChatsCountChange(Object(m.a)(this,this.m3j,"chatCountChanged"))}).catch(a=>{r.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",
a)}),this.chat.getKeyboard().then(a=>{a.onKeyDown(Object(m.a)(this,this.xlm,"onChatKeyPress"))}).catch(a=>{r.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",a)}))}catch(a){r.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",a)}}m3j(a){r.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",a);if(!a)this.MRf.tlm();else if(1===a&&!this.YAg){const c=document.getElementById(this.$ce?this.$ce:kc.a.ltb);c?this.MRf.ylm(c,Object(m.a)(this,this.UFn,"transferFocusToChat")):
r.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.YAg=a}ulm(a){this.$ce=a}xlm(a){a.ctrlKey&&"f6"===a.key.toLowerCase()&&this.TFn(a.shiftKey)}$Sm(a){Sc.a.instance.Ea(Jb.a.Bzn,window.self,()=>{a();return!0})}UFn(){r.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&this.chat.getFocuser().then(a=>{a.focusConversationInput()}).catch(a=>{r.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",a)})}catch(a){r.ULS.sendTraceTag(50595974,
333,10,"Failed to transfer focus to chat: {0}",a)}}TFn(a){r.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.MRf.vlm(a)}}Object(w.a)(Pc,"ChatManager",null,[794]);var Rd=b(63);class le{constructor(){this.ma=new Rd.a;this.Zxj=!1}WIj(a){this.ma.addHandler("OnTopRowControlsCreatedEvent",a)}FIj(a){this.ma.addHandler("OnRenameTextboxStatusChangedEventKey",a)}get REn(){return this.Zxj}pmi(a){this.ma.raiseEvent("OnRenameTextboxStatusChangedEventKey",a?"true":"false")}}Object(w.a)(le,
"HeaderEventSource",null,[]);var Fc=b(153),He=b(288);class $e{constructor(a,c,h,v,B){this.Gid=null;this.fb=a;this.Dn=c;this.Bi=h;this.byj=v;this.ga=B}Ooi(a,c,h,v=null){const B=this.fb.fd(c);B.parent=h;B.rK=!0;v&&B.hba(v);this.Bi.lwa(c,a,!1);this.byj.lwa(c,a,!1);c=new He.DOMFocusListing(()=>a);c.vn(2);c.vn(1);c.vn(8);c.vn(5);c.vn(3);c.vn(6);this.fb.qha(()=>a,B,c).mV=!0;c=qc.KeyInputManager.mb(vb.a.Sv,0);h=qc.KeyInputManager.mb(vb.a.Sv,4);B.Bp(c);B.Bp(h)}onFlexPaneOpen(a){this.Ooi(a,kc.a.q5b,kc.a.zJa);
this.fb.Kf(kc.a.q5b);this.Dn.mwa(kc.a.q5b)}onFlexPaneClose(){this.Dn.Bv(kc.a.q5b);this.fb.Kf(kc.a.zJa)}ylm(a,c){this.Gid||(this.Gid=c,this.Ooi(a,kc.a.ltb,Fc.AFrame.IJ,Object(m.a)(this,this.wlm,"onChatFocus")));this.fb.Kf(kc.a.ltb);this.Dn.mwa(kc.a.ltb)}wlm(){this.Gid&&this.Gid()}tlm(){this.Dn.Bv(kc.a.ltb);this.fb.x3e(Fc.AFrame.Mp)}vlm(a){this.ga.processAction(a?Sa.a.m1e:Sa.a.n9d,2)}}Object(w.a)($e,"ReactSharedHeaderFocusManager",null,[793]);var Le=b(99),df=b(920),Af=b(47),Ve=b(36),Kc=b(64);class hd{constructor(a){this.ga=
a}eb(){this.ga.ka(Sa.a.Rxd,Kc.a.frame,Object(m.a)(this,this.c7h,"navigateToUpsellPage"));this.ga.ka(Sa.a.iOk,Kc.a.frame,Object(m.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.ga.ka(Sa.a.z0m,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.mti,Kc.a.frame,Le.ActionManager.De)}c7h(a,c,h,v,B){if(1===h)return 32;a=8;2===h&&(h=this.V5e(B,"experience","gopremiumribbon"),B=Af.a.Y3("2116536"),B=Af.a.qm(B,"ocid",df.b(l.AFrameworkApplication.na.Ya.Rm,l.AFrameworkApplication.na.Ya.yda,h)),
Ve.a.Ql(B,"_blank",void 0,"NavigateToUpsellPage"),a=32,this.ga.processAction(Sa.a.mti,2),r.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return a}launchUpsellExperience(a,c,h,v,B){if(1===h)return 32;var X=8;2===h&&(r.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(X=xa.a.instance.ra("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?(a=this.V5e(B,"experience","gopremium"),B=this.V5e(B,"dimeCampaignId",null),X.launchUpsellExperience(a,B),X=32):(r.ULS.sendTraceTag(594874952,
340,15,"ApplicationFeatureHelper not available"),X=this.c7h(a,c,h,v,B)));return X}V5e(a,c,h){a&&a[c]&&(h=Object(ha.a)(String,a[c]));return h}}Object(w.a)(hd,"UpsellActor",null,[791]);class id{constructor(){this.W=null}get name(){return"Common.App.Header"}init(){xa.a.instance.resolve("Common.App.Header.IUpsellActor").eb();xa.a.instance.resolve("Common.App.Header.IChatManager").eb()}dispose(){}yb(a){this.W=a;this.W.register(le,"Common.App.Header.HeaderEventSource").singleInstance();this.W.register(hd,
"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").singleInstance().Pc(()=>new hd(l.AFrameworkApplication.pa));this.W.register($e,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").singleInstance().Pc(()=>new $e(l.AFrameworkApplication.na.Pn,l.AFrameworkApplication.na.gu,l.AFrameworkApplication.na.RY,l.AFrameworkApplication.na.Y4d,l.AFrameworkApplication.pa));this.W.register(Pc,"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").singleInstance().Pc(()=>
new Pc(this.W.te("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){M.a.instance.Lb(new id)}}Object(w.a)(id,"CommonAppHeaderPackage",null,[1,2]);var oh=b(1351);class vf{static pqh(a,c){switch(a){case 3:return vf.jml(c);case 2:return vf.$9k(c);case 1:return vf.z_k(c)}return""}static jml(a){switch(a){case 1:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static $9k(a){switch(a){case 1:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString();
case 2:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static z_k(a){switch(a){case 1:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return l.AFrameworkApplication.K.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(a,c,h){if(H.a.sh||H.a.mK)window.setTimeout(()=>{vf.ioi(h,vf.RCd())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(vf.jSg(h),a,0,!1)}static F7j(a,c,h,v){c&&
v&&v();vf.openInClient(a,c,h)}static RCd(){return H.a.sh?1:H.a.mK?2:H.a.eYa?3:H.a.qk?4:0}static Vll(a){switch(a){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static Wll(a){switch(a){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}}static get hkf(){return"zh-CN"===window.navigator.language}static ioi(a,c){1===c?(r.ULS.sendTraceTag(17151569,
306,50,"User Directed to App Store"),a=vf.pqh(a,c),8<H.a.OWa?Ve.a.Ql(a,void 0,void 0,"RedirectToAppStore"):Ve.a.lwb(a)):document.hidden||(vf.hkf?(a=l.AFrameworkApplication.K.appSettings.WildFireUrlChinaStoreAndroid.toString())?(r.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),Ve.a.lwb(a)):r.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(r.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(vf.pqh(a,
c),null,null)))}static jSg(a){switch(a){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get O1d(){return(H.a.eYa||H.a.qk)&&H.a.In}static get apn(){return H.a.sh||H.a.mK}static Jqh(a){switch(a){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static OTh(a){return(a=vf.y4k(a))&&""!==a?Boolean.parse(a):!1}static hRf(a){vf.Afn(a)}static y4k(a){try{return localStorage.getItem(a)}catch(c){return r.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+c.message),null}}static Afn(a){try{localStorage.setItem(a,"true")}catch(c){r.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+c.message)}}}vf.K1g="ChromeExtensionBarDismiss";Object(w.a)(vf,"WildFireUtilities",null,[]);var Yc=b(366);class sb{constructor(){this.Vae=new Yc.a;this.Tae=new Yc.a;this.Sae=new Yc.a;this.NVj(this.Vae);this.MVj(this.Tae);this.LVj(this.Sae);this.zle=new Yc.a;
this.yle=new Yc.a;this.xle=new Yc.a;this.XYj(this.zle);this.WYj(this.yle);this.VYj(this.xle);this.ude=new Yc.a;this.dWj(this.ude);this.Irb(this.ude);this.Irb(this.Sae);this.Irb(this.Tae);this.Irb(this.Vae);this.Irb(this.yle);this.Irb(this.zle);this.Irb(this.xle)}mCd(a,c){switch(a){case 1:return this.Wml(c);case 2:return this.MRk(c)}return vf.O1d?this.ude:null}NVj(a){a.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
a.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}MVj(a){a.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}LVj(a){a.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}XYj(a){a.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);a.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);a.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);a.add("OverlayBig","Get the Word app");a.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");a.add("OverlaySmallSplit1",
"Discover Word");a.add("OverlaySmallSplit2","designed for the iPad.");a.add("SkipButton","Skip for now")}dWj(a){a.add("Headline","Get the Office Online extension for Chrome");a.add("UseAppButton","Get the extension");a.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}WYj(a){a.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);a.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);
a.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);a.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);a.add("OverlayBig","Get the PowerPoint app");a.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");a.add("OverlaySmallSplit1","Discover PowerPoint");a.add("OverlaySmallSplit2","designed for the iPad.");a.add("SkipButton","Skip for now")}VYj(a){a.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);a.add("UseAppButton",
CommonUIStrings.l_WildFireBizBarUseAppButtonText);a.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);a.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);a.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}Irb(a){a.add("Corporation","Microsoft Corporation")}Wml(a){switch(a){case 3:return this.zle;case 2:return this.yle;case 1:return this.xle}return null}MRk(a){switch(a){case 3:return this.Vae;case 2:return this.Tae;case 1:return this.Sae}return null}static get instance(){sb._instance||
(sb._instance=new sb);return sb._instance}}sb._instance=null;Object(w.a)(sb,"WildFireStringFactory",null,[]);class Qb{constructor(a,c,h,v,B=null,X=null){this.Iue=null;this._id=a;this.lwe=c;this.bgj=B;this.blc=v;this.Bqc=X;this.u2a=null;this.Usc=h;this.Lrc=sb.instance.mCd(c,a)}qgk(){this.u2a=new oh.a(this.title,this.message,null);this.u2a.addButton(this.kZj,Object(m.a)(this,this.clm,"onButtonOneClick"),"");this.Usc&&this.u2a.JOg(this.qZj,Object(m.a)(this,this.hlm,"onButtonTwoClick"));this.u2a.Cha=
Object(m.a)(this,this.jvk,"dismissBar");this.u2a.image=3;this.u2a.id=16;this.u2a.closeable=!0}get title(){return this.Lrc.J("Headline")}get message(){return this.Lrc.J("CallToAction")}get kZj(){return this.Usc?this.Lrc.J("InstallButton"):this.Lrc.J("UseAppButton")}get qZj(){return this.Usc?this.Lrc.J("OpenAppButton"):""}clm(){this.Usc?this.sEl():this.DSn()}hlm(){this.Usc&&this.Wum()}get BYg(){return this.u2a}get tZa(){this.Iue||(this.Iue=this.bgj());return this.Iue}sEl(){r.ULS.sendTraceTag(17932829,
306,50,"Install App Button of BusinessBar Clicked");this.blc&&this.Bqc&&this.Bqc();vf.ioi(this._id,this.lwe)}Wum(){this.tZa&&(r.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.blc&&this.Bqc&&this.Bqc(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(vf.jSg(this._id),this.tZa,0,!1))}DSn(){vf.O1d?this.gZj():(r.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),vf.hRf("BizBarClicked"),1!==this.lwe&&2!==this.lwe||vf.F7j(this.tZa,this.blc,this._id,this.Bqc))}gZj(){this.blc?
r.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):r.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");Ve.a.lwb(l.AFrameworkApplication.K.appSettings.WildFireChromeExtensionUrl.toString())}kvk(){this.blc?r.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):r.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");vf.hRf(vf.K1g)}jvk(){vf.O1d?this.kvk():(vf.hRf(vf.Jqh(this._id)),r.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static YUe(){const a=l.AFrameworkApplication.na.Ya;
new Qb(a.Rm,vf.RCd(),8<H.a.OWa,1===a.yda,()=>a.Bba,a.BNf());r.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}}Object(w.a)(Qb,"WildFireBusinessBar",null,[]);class Oc{get name(){return"Common.App.WildFire"}aHe(a){const c=l.AFrameworkApplication.na.Ya;let h=!1;a&&(a.qgk(),a.BYg&&(h=c.MSa(a.BYg,!0)));return h}xgk(){var a=l.AFrameworkApplication.na.Ya;a=new Qb(a.Rm,vf.RCd(),!1,1===a.yda);this.aHe(a)&&r.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}YUe(a,c,h,v,B,X){a=new Qb(a,
h,v,c,B,X);this.aHe(a)&&r.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}lnk(){const a=l.AFrameworkApplication.na.Ya;var c=l.AFrameworkApplication.K;const h=a.Rm,v=1===a.yda;if(c.$(vf.Vll(h))){var B=vf.RCd(),X=8<H.a.OWa;if(2!==h||2!==B||!v){c=c.$(vf.Wll(h));var ma=a.BNf(),Pa=()=>a.Bba;c&&!vf.OTh(vf.Jqh(h))&&this.YUe(h,v,B,X,Pa,ma)}}}init(){var a=l.AFrameworkApplication.K;const c=a.$("WildFireChromeExtensionEnabled");a=a.$("WildFireChromeExtensionBar")&&c;vf.O1d&&a&&!vf.OTh(vf.K1g)?this.xgk():
(document.body&&vf.apn&&this.lnk(),l.AFrameworkApplication.pa.ka(Sa.a.gof,Kc.a.frame,Object(m.a)(this,this.gof,"launchWildFireBusinessBar")))}gof(a,c,h,v,B){if(1===h)return 32;if(!B)return 8;this.YUe(B.app,B.mode,B.platform,B.useTwoButton,null,null);return 32}dispose(){}yb(){}static main(){M.a.instance.Lb(new Oc)}}Object(w.a)(Oc,"PackageManager",null,[1,2]);class wc{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=
this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(w.a)(wc,"BrowserInfo",null,[]);class yc{constructor(){this.Version=
this.Name=null}}Object(w.a)(yc,"PluginInfo",null,[]);class ef{static zYa(){if(l.AFrameworkApplication.K.$("LogBrowserInfoIsEnabled")){var a=ef.wOk();try{const c=JSON.stringify(a);r.ULS.sendTraceTag(6903563,102,50,c)}catch(c){r.ULS.sendTraceTag(6903564,102,15,c.message)}}else r.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static abl(){const a=window.navigator.plugins;if(!a||!a.length)return null;const c=[];for(let h=0;h<a.length;h++){const v=a[h].name,B=a[h].version;
Array.add(c,Object.assign(new yc,{Name:v,Version:B}))}return c}static wOk(){const a=new wc,c=new Sys.StringBuilder;ef.tF(h=>{a.DocElemClientHeight=h},()=>document.documentElement.clientHeight,c);ef.tF(h=>{a.DocElemClientWidth=h},()=>document.documentElement.clientWidth,c);ef.tF(h=>{a.DocElemOffsetHeight=h},()=>document.documentElement.offsetHeight,c);ef.tF(h=>{a.DocElemOffsetWidth=h},()=>document.documentElement.offsetWidth,c);ef.tF(h=>{a.ScreenAvailHeight=h},()=>window.screen.availHeight,c);ef.tF(h=>
{a.ScreenAvailWidth=h},()=>window.screen.availWidth,c);ef.tF(h=>{a.ScreenWidth=h},()=>window.screen.width,c);ef.tF(h=>{a.ScreenHeight=h},()=>window.screen.height,c);ef.tF(h=>{a.ScreenLogicalXdpi=h},()=>window.screen.logicalXDPI,c);ef.tF(h=>{a.ScreenLogicalYdpi=h},()=>window.screen.logicalYDPI,c);ef.tF(h=>{a.ScreenDeviceXdpi=h},()=>window.screen.deviceXDPI,c);ef.tF(h=>{a.ScreenDeviceYdpi=h},()=>window.screen.deviceYDPI,c);ef.tF(h=>{a.WinInnerHeight=h},()=>window.self.innerHeight,c);ef.tF(h=>{a.WinInnerWidth=
h},()=>window.self.innerWidth,c);ef.tF(h=>{a.WinOuterHeight=h},()=>window.self.outerHeight,c);ef.tF(h=>{a.WinOuterWidth=h},()=>window.self.outerWidth,c);ef.tF(h=>{a.WinOrientation=h},()=>window.self.orientation,c);ef.tF(h=>{a.WinDevicePixelRatio=h},()=>window.self.devicePixelRatio,c);ef.tF(h=>{a.SupportsTouch=h},()=>H.a.BXc,c);ef.tF(h=>{a.NavAppName=h},()=>window.navigator.appName,c);ef.tF(h=>{a.NavAppVersion=h},()=>window.navigator.appVersion,c);ef.tF(h=>{a.NavLanguage=h},()=>window.navigator.browserLanguage||
window.navigator.language,c);ef.tF(h=>{a.NavUserAgent=h},()=>window.navigator.userAgent,c);ef.tF(h=>{a.NavPlatform=h},()=>window.navigator.platform,c);ef.tF(h=>{a.NavPlugins=h},ef.abl,c);ef.tF(h=>{a.CalculatedDevicePixelRatio=h},()=>ef.devicePixelRatio,c);a.Error=c.toString();return a}static get devicePixelRatio(){const a=window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/window.screen.logicalXDPI:a}static tF(a,c,h){try{const v=c();a(v)}catch(v){h.isEmpty()||h.append(" | "),h.append(v.message||
"null")}}}Object(w.a)(ef,"BrowserInfoLogger",null,[]);class Je{get name(){return"Common.App.BrowserInfoLogger"}yb(){}init(){ef.zYa()}dispose(){}static main(){M.a.instance.Lb(new Je)}}Object(w.a)(Je,"BrowserInfoLoggerPackage",null,[1,2]);class fh{constructor(){this.ma=new Rd.a}yTb(a){this.ma.addHandler("OnEditHappenedEvent",a)}ZSc(a){this.ma.removeHandler("OnEditHappenedEvent",a)}VKm(){this.ma.raiseEvent("OnEditHappenedEvent")}}Object(w.a)(fh,"EditNotificationEventSource",null,[]);var re=b(59),Se=
b(80);class Ye{constructor(a,c,h,v,B,X,ma=0){this.rhe=!1;this.qhe=this.vob=null;this.EKg=!1;this.Ta=c;this.ubd=a;this.D4a=h;this.o2=v;this.CKg=B;this.Mcj=X;this.b5c=0;this.g7c=!1;try{0<ma&&(this.b5c=ma,3E5>this.b5c&&(this.b5c=3E5),this.Ta&&!this.qhe&&(this.qhe=new Se.a(3,2,this.b5c,Object(m.a)(this,this.u0m,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Ta.ub(this.qhe)))}catch(Pa){r.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+
Pa)}}get lXi(){return this.EKg}sud(){this.lXi?this.g7c=!0:(this.EKg=!0,Fa.Health.instance.addQosPillar("Save"),Fa.Health.instance.addQosPillar("ContentCreation"),re.c(Sa.a.editDocument));this.rhe=!0;this.CKg&&this.CKg.JMg();this.o2&&this.o2.VKm();l.AFrameworkApplication.ug&&l.AFrameworkApplication.ug.aam();this.Mcj&&!this.vob&&(this.NUc(null),this.vob=new Se.a(3,2,this.ubd,Object(m.a)(this,this.NUc,"sendPostMessageIfNecessary"),113),this.Ta.ub(this.vob))}NUc(){this.rhe&&(this.D4a.CWR(()=>this.D4a.result.Qg(E.a.editNotification,
null)),r.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.rhe=!1)}u0m(){try{this.g7c&&(re.c(Sa.a.editDocument),this.g7c=!1)}catch(a){this.g7c=!1,r.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+a)}}}Object(w.a)(Ye,"EditNotificationManager",null,[796]);class Ji{constructor(a,c,h,v,B){this.yke=this.vob=null;this.WPa=this.lae=!1;this.Ta=c;this.ubd=a;this.D4a=h;this.Bi=v;this.aue=B;this.Uoi(null)}Uoi(){const a=
document.getElementById(l.AFrameworkApplication.VTb);!this.WPa&&this.Bi&&a&&(this.Bi.Ea(Jb.a.qV,a,Object(m.a)(this,this.Dsf,"mouseActivityHandler"),null),this.WPa=!0);this.aue(()=>{this.dispose()})}Dsf(){this.WPa&&(this.Bi.xb(Jb.a.qV,document.getElementById(l.AFrameworkApplication.VTb),Object(m.a)(this,this.Dsf,"mouseActivityHandler")),this.WPa=!1);this.JMg();return!1}JMg(){this.lae=!0;this.yke||(this.yke=new Se.a(3,2,this.ubd,Object(m.a)(this,this.Uoi,"registerHandlerTask"),112),this.Ta.ub(this.yke));
this.vob||(this.NUc(null),this.vob=new Se.a(3,2,this.ubd,Object(m.a)(this,this.NUc,"sendPostMessageIfNecessary"),111),this.Ta.ub(this.vob))}NUc(){this.lae&&(this.D4a.CWR(()=>this.D4a.result.Qg(E.a.aTn,null)),r.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.lae=!1)}dispose(){this.WPa&&(this.Bi.xb(Jb.a.qV,document.getElementById(l.AFrameworkApplication.VTb),Object(m.a)(this,this.Dsf,"mouseActivityHandler")),this.WPa=!1)}}Object(w.a)(Ji,
"UserActivityHostNotificationManager",null,[795,14]);var ah=b(165),ag=b(81),rg=b(677);class pi{constructor(){this.W=null}get name(){return"Common.App.EditNotification"}init(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.Io(Object(m.a)(this,this.Mv,"onFullAppSettingsReady"))}Mv(){pi.$yk&&0<pi.FZe&&(this.W.register(fh,"Common.App.HostNotification.EditNotificationEventSource").singleInstance(),this.W.register(Ji,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").singleInstance().Pc(()=>
new Ji(6E4,ag.a.instance,rg.a.Vp(this.W.za("Postmessage.IHostPostmessenger")),ah.a.instance,l.AFrameworkApplication.UK)),this.W.register(Ye,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").singleInstance().Pc(()=>new Ye(pi.FZe,ag.a.instance,rg.a.Vp(this.W.za("Postmessage.IHostPostmessenger")),this.W.resolve("Common.App.HostNotification.EditNotificationEventSource"),this.W.ra("Common.Interface.IUserActivityHostNotificationManager"),pi.azk,pi.Wyk)),
this.W.resolve("Common.Interface.IEditNotificationManager"),r.ULS.shipAssertTag(38086291,209,0<pi.FZe,"EditNotification Interval is less than or equal to 0."))}yb(a){this.W=a}dispose(){}static get FZe(){return l.AFrameworkApplication.K?parseInt(l.AFrameworkApplication.K.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get Wyk(){return l.AFrameworkApplication.K?parseInt(l.AFrameworkApplication.K.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0}static get $yk(){return!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("EditNotificationIsEnabled")}static get azk(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("EditNotificationPostMessageIsEnabled")}static main(){M.a.instance.Lb(new pi)}}Object(w.a)(pi,"CommonHostNotificationPackage",null,[1,2]);class Rj{constructor(a,c,h){this.sqb=null;this.Ta=a;this.ga=c;this.Zig=h.create()}jgb(){this.sqb?r.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(r.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),
this.sqb=new Se.a(2,1,3E4,Object(m.a)(this,this.Z1d,"showFloatPane"),67),this.Ta.ub(this.sqb))}Z1d(){this.sqb=null;r.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.Zig.display()}oMa(){this.ga.ka(Sa.a.Z1d,Kc.a.frame,Object(m.a)(this,this.crn,"showFloatPaneHandler"))}crn(a,c,h,v,B){return a!==Sa.a.Z1d?2:1===h?32:2===h&&B?(r.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",B),B?this.jgb():(this.sqb?(r.ULS.sendTraceTag(23674914,
207,50,"Hide float pane via removing show task!"),this.Ta.me(this.sqb)):(r.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.Zig.remove(null)),this.sqb=null),32):8}}Object(w.a)(Rj,"FloatPaneActor",null,[806]);var Ki=b(83),Fd=b(96),Ld=b(25),we=b(60);class Te{constructor(a,c,h,v,B){this.kre=this.$jc=this.sed=this.uRa=this.Jaa=this.LOa=this.hce=this.L6=this.Joc=this.vmc=this.wmc=this.fje=null;this.Ta=c;this.qa=a;this.Se=h;this.W=B;this.Uta=v}C8g(){this.L6=document.createElement("div");
this.L6.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeIn");this.L6.style.width=this.Jaa.width+"px";(this.kre=this.b9k(this.Uta))?(this.uRa=document.createElement("a"),this.uRa.setAttribute(we.a.tg,we.a.Sx),this.Se.Ea(Jb.a.click,this.uRa,Object(m.a)(this,this.qci,"onRedirectClick")),this.uRa.href=this.kre,this.uRa.target="_blank",this.uRa.appendChild(this.Jaa),this.L6.appendChild(this.uRa)):this.L6.appendChild(this.Jaa);this.LOa=document.createElement("a");this.LOa.setAttribute(we.a.tg,
we.a.v_);this.LOa.className="StandardButton WACFloatPaneCloseButton";this.LOa.title=CommonUIStrings.l_Close;this.LOa.tabIndex=-1;this.hce=Fd.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.hce.setAttribute(we.a.tg,we.a.Sx);this.LOa.appendChild(this.hce);this.Se.Ea(Jb.a.click,this.LOa,Object(m.a)(this,this.onClose,"onClose"));this.L6.appendChild(this.LOa);this.Joc.appendChild(this.L6)}v3k(a){const c=this.qa.$("O365PromotionHasStarted");
switch(a){case 2:return Ki.a.K7(String.format("adppt{0}.png",c?"sale":""));case 1:return Ki.a.K7(String.format("adxls{0}.png",c?"sale":""));case 3:return Ki.a.K7(String.format("addoc{0}.png",c?"sale":""))}return null}b9k(a){const c=this.qa.Ga("O365AdPaneRedirectedURL");switch(a){case 1:return String.format(c,"Excel");case 2:return String.format(c,"PowerPoint");case 3:return String.format(c,"Word")}return null}hide(a=null){this.$jc=null;this.L6&&!this.sed&&(a?r.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):
r.ULS.sendTraceTag(23674903,207,50,"User clicks button to close the float pane."),this.L6.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.L6.style.height="0px",this.sed=new Se.a(2,1,1E3,Object(m.a)(this,this.remove,"remove"),67),this.Ta.ub(this.sed))}remove(){this.L6&&this.Joc&&(this.uRa&&this.Se.xb(Jb.a.click,this.uRa,Object(m.a)(this,this.qci,"onRedirectClick")),this.Se.xb(Jb.a.click,this.LOa,Object(m.a)(this,this.onClose,"onClose")),this.Joc.removeChild(this.L6),this.L6=
null);this.sed=null}display(){if(this.fje=this.W.ra("Common.IFloatPaneContainer"))if(this.Joc=this.fje.container){var a=this.v3k(this.Uta);a?(r.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),this.Jaa=document.createElement("img"),this.Jaa.className="WACFloatPaneImage",this.wmc=Object(m.a)(this,this.Dpm,"onLoadImageFinish"),Ld.a.addHandler(this.Jaa,Jb.a.load,this.wmc),this.vmc=Object(m.a)(this,this.Cpm,"onLoadImageError"),Ld.a.addHandler(this.Jaa,Jb.a.error,this.vmc),
this.Jaa.src=a):r.ULS.sendTraceTag(23674907,207,15,"The target image is empty, can't show the float pane.")}else r.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else r.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}Dpm(){const a=this.qa.vb("O365AdPaneShowingDuration",60);this.C8g();this.L6.style.display="block";this.L6.style.height=this.Jaa.height+"px";this.$jc=new Se.a(2,1,1E3*a,Object(m.a)(this,
this.hide,"hide"),67);this.Ta.ub(this.$jc);this.wqi()}Cpm(){r.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.wqi();this.Jaa=null}wqi(){this.wmc&&this.Jaa&&Ld.a.removeHandler(this.Jaa,Jb.a.load,this.wmc);this.wmc=null;this.vmc&&this.Jaa&&Ld.a.removeHandler(this.Jaa,Jb.a.error,this.vmc);this.vmc=null}qci(){r.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.$jc&&this.Ta.me(this.$jc);
this.hide();return!0}dispose(){this.hide()}}Object(w.a)(Te,"FloatPane",null,[814]);class Dj{constructor(a,c,h,v,B){this.Ta=c;this.qa=a;this.Se=h;this.W=B;this.Uta=v}create(){return new Te(this.qa,this.Ta,this.Se,this.Uta,this.W)}}Object(w.a)(Dj,"FloatPaneFactory",null,[798]);var oi=b(240);class ik{constructor(){this.W=null}get name(){return"Common.App.FloatPane"}get nSh(){return l.AFrameworkApplication.K.$("O365AdvertisementIsEnabled")&&l.AFrameworkApplication.K.$("IsShowAdvertisementPaneEnabled")}init(){this.nSh&&
(r.ULS.sendTraceTag(23674944,207,50,"Setup task to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").jgb(),r.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.W.resolve("Common.App.FloatPane.IFloatPaneActor").oMa())}yb(a){this.W=a;this.nSh&&(this.W.register(Dj,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").Pc(()=>new Dj(l.AFrameworkApplication.K,l.AFrameworkApplication.Cb,oi.a.instance,l.AFrameworkApplication.na.Ya.Rm,
this.W)).singleInstance(),this.W.register(Rj,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").Pc(()=>new Rj(l.AFrameworkApplication.Cb,l.AFrameworkApplication.pa,this.W.resolve("Common.App.FloatPane.IFloatPaneFactory"))).singleInstance())}dispose(){}static main(){M.a.instance.Lb(new ik)}}Object(w.a)(ik,"FloatPanePackage",null,[1,2]);var Nf=b(1471);class vj{}Object(w.a)(vj,"LokiTokenResult",null,[]);class Qj{constructor(a){this.zbd=a}W8e(){const a=this.r6k();return a?
Qj.Bkf?new Promise((c,h)=>{this.zbd.continueWith(()=>{this.zbd.Hn||this.zbd.Gh?h(Error.create("Error downloading auth library")):this.zbd.result.Pla("Loki",a).then(v=>{v=l.AFrameworkApplication.K.$("ForceLokiFallbackToACLPTokenIsEnabled")?this.u6k():v.IsSuccess&&v.Token?Object.assign(new vj,{isSuccess:!0,token:v.Token,errorMessage:null}):Object.assign(new vj,{isSuccess:!1,token:null,errorMessage:JSON.stringify(v)});c(v);return v})})}):Promise.resolve(Object.assign(new vj,{isSuccess:!1,token:null,
errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new vj,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Nf.a.yqh())}))}u6k(){const a=l.AFrameworkApplication.K.Ga("LokiUserDataSignature")||"";return Object.assign(new vj,{isSuccess:!0,token:a,errorMessage:null})}r6k(){let a=null;const c=Nf.a.nyd();2===c?a=l.AFrameworkApplication.K.Ga("LokiAADAppId"):1===c&&(a=l.AFrameworkApplication.K.Ga("LokiMSAAppId"));
return a}static get Bkf(){return l.AFrameworkApplication.K.$("IsO365CommercialHost")||l.AFrameworkApplication.K.$("IsO365ConsumerHost")}}Object(w.a)(Qj,"LokiTokenManager",null,[792]);class Jg{get name(){return"Common.App.LivePersonaUtils"}init(){xa.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}yb(a){a.register(Qj,"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").singleInstance().Pc(()=>new Qj(rg.a.Vp(a.za("Common.App.OAuth.IOAuthManager"))))}static main(){M.a.instance.Lb(new Jg)}}
Object(w.a)(Jg,"LivePersonaUtilsPackage",null,[1,2]);class Mi{constructor(a){this.Oae=a}BRh(a){if(!this.Oae)return!0;a=Af.a.b8e(a);if(!a)return!1;a=a.toLowerCase();for(let c=0;c<this.Oae.length;c++)if(a.endsWith(this.Oae[c]))return!0;return!1}}Object(w.a)(Mi,"DomainAllowListManager",null,[]);class rf{constructor(a,c){this.WVe=null;this.HDe=a;this.url=c}get Z0f(){return Af.a.Bsa(this.url)}get tq(){return this.HDe}rYf(){const a={},c=this.tq;a.a=this.Z0f;a.b=this.round(c.navigationStart);a.c=this.round(c.unloadEventStart);
a.d=this.round(c.unloadEventEnd);a.e=this.round(c.redirectStart);a.f=this.round(c.redirectEnd);a.g=this.round(c.fetchStart);a.h=this.round(c.domainLookupStart);a.i=this.round(c.domainLookupEnd);a.j=this.round(c.connectStart);a.k=this.round(c.connectEnd);a.l=void 0!==c.secureConnectionStart&&null!==c.secureConnectionStart?this.round(c.secureConnectionStart):0;a.m=this.round(c.requestStart);a.n=this.round(c.responseStart);a.o=this.round(c.responseEnd);a.q=this.round(c.domInteractive);a.r=this.round(c.domContentLoadedEventStart);
a.s=this.round(c.domContentLoadedEventEnd);a.t=this.round(c.domComplete);a.u=this.round(c.loadEventStart);a.v=this.round(c.loadEventEnd);a.w=this.WVe;return a}round(a){return Math.round(1E3*a)/1E3}}Object(w.a)(rf,"PerformanceTimingEntry",null,[]);const ld=(a,c)=>{const h={};let v=null;switch(a){case 0:v="ResourceTiming";a=c.a;null!=a&&(h.Url=a);a=c.b;null!=a&&(h.InitiatorType=a);a=null==c.c?null:c.c.toString();null!=a&&(h.RedirectStart=a);a=null==c.d?null:c.d.toString();null!=a&&(h.RedirectEnd=a);
a=null==c.e?null:c.e.toString();null!=a&&(h.FetchStart=a);a=null==c.f?null:c.f.toString();null!=a&&(h.DomainLookupStart=a);a=null==c.g?null:c.g.toString();null!=a&&(h.DomainLookupEnd=a);a=null==c.h?null:c.h.toString();null!=a&&(h.ConnectStart=a);a=null==c.i?null:c.i.toString();null!=a&&(h.ConnectEnd=a);a=null==c.j?null:c.j.toString();null!=a&&(h.SecureConnectionStart=a);a=null==c.k?null:c.k.toString();null!=a&&(h.RequestStart=a);a=null==c.l?null:c.l.toString();null!=a&&(h.ResponseStart=a);a=null==
c.m?null:c.m.toString();null!=a&&(h.ResponseEnd=a);a=c.n;null!=a&&(h.CustomText=a);a=null==c.o?null:c.o.toString();null!=a&&(h.DecodedBodySize=a);a=null==c.p?null:c.p.toString();null!=a&&(h.EncodedBodySize=a);c=null==c.q?null:c.q.toString();null!=c&&(h.TransferSize=c);break;case 1:v="PerformanceTiming",a=c.a,null!=a&&(h.Url=a),a=null==c.b?null:c.b.toString(),null!=a&&(h.NavigationStart=a),a=null==c.c?null:c.c.toString(),null!=a&&(h.UnloadEventStart=a),a=null==c.d?null:c.d.toString(),null!=a&&(h.UnloadEventEnd=
a),a=null==c.e?null:c.e.toString(),null!=a&&(h.RedirectStart=a),a=null==c.f?null:c.f.toString(),null!=a&&(h.RedirectEnd=a),a=null==c.g?null:c.g.toString(),null!=a&&(h.FetchStart=a),a=null==c.h?null:c.h.toString(),null!=a&&(h.DomainLookupStart=a),a=null==c.i?null:c.i.toString(),null!=a&&(h.DomainLookupEnd=a),a=null==c.j?null:c.j.toString(),null!=a&&(h.ConnectStart=a),a=null==c.k?null:c.k.toString(),null!=a&&(h.ConnectEnd=a),a=null==c.l?null:c.l.toString(),null!=a&&(h.SecureConnectionStart=a),a=null==
c.m?null:c.m.toString(),null!=a&&(h.RequestStart=a),a=null==c.n?null:c.n.toString(),null!=a&&(h.ResponseStart=a),a=null==c.o?null:c.o.toString(),null!=a&&(h.ResponseEnd=a),a=null==c.p?null:c.p.toString(),null!=a&&(h.DomLoading=a),a=null==c.q?null:c.q.toString(),null!=a&&(h.DomInteractive=a),a=null==c.r?null:c.r.toString(),null!=a&&(h.DomContentLoadedEventStart=a),a=null==c.s?null:c.s.toString(),null!=a&&(h.DomContentLoadedEventEnd=a),a=null==c.t?null:c.t.toString(),null!=a&&(h.DomComplete=a),a=null==
c.u?null:c.u.toString(),null!=a&&(h.LoadEventStart=a),a=null==c.v?null:c.v.toString(),null!=a&&(h.LoadEventEnd=a),c=c.w,null!=c&&(h.CustomText=c)}h.Table=v;return Sys.Serialization.JavaScriptSerializer.serialize(h)};var lg=b(37),Cj=b(184),Bm=b(149);class bi{constructor(a,c=null,h=null){this.sg=a;this.Y0f=this;this.ifj=c||(()=>window.location.href);this.ahe=new Mi(h)}run(){if(bi.A8a(window.performance))try{const B=this.ifj();if(bi.jyj.exec(B)&&this.ahe.BRh(B)){var a=new rf(window.performance.timing,
B);Bm.a.instance.VNm(a.tq.fetchStart);Bm.a.instance.WNm(a.tq.navigationStart);Bm.a.instance.pV(lg.a.QNk,"connectStart","requestStart");Bm.a.instance.pV(lg.a.$Nk,"requestStart","responseStart");Bm.a.instance.pV(lg.a.cOk,"responseStart","responseEnd");this.Y0f.BBb(1,a.rYf());this.sg.Xe(lg.a.YYb,a.tq.fetchStart);this.sg.Xe(lg.a.WNk,a.tq.domainLookupStart);this.sg.Xe(lg.a.VNk,a.tq.domainLookupEnd);this.sg.Xe(lg.a.SNk,a.tq.connectStart);this.sg.Xe(lg.a.eOk,a.tq.secureConnectionStart);this.sg.Xe(lg.a.RNk,
a.tq.connectEnd);this.sg.Xe(lg.a.aOk,a.tq.requestStart);this.sg.Xe(lg.a.T3e,a.tq.responseStart);this.sg.Xe(lg.a.XNk,a.tq.responseEnd-a.tq.responseStart);this.sg.Xe(lg.a.bOk,a.tq.responseStart-a.tq.requestStart);var c=0,h=0,v=0;({transferSize:c,o_e:h,pWe:v}=this.lIn(B)).returnValue&&(this.sg.Xe(lg.a.gOk,c),this.sg.Xe(lg.a.TNk,v),this.sg.Xe(lg.a.YNk,h));this.sg.Xe(lg.a.ZNk,a.tq.navigationStart)}}catch(B){r.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",B)}}lIn(a){let c,
h,v;v=h=c=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:c,o_e:h,pWe:v};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:c,o_e:h,pWe:v};a=a[0];var B=a.transferSize;void 0!==c&&null!==c&&(c=B);B=a.decodedBodySize;void 0!==B&&null!==B&&(v=B);a=a.encodedBodySize;void 0!==a&&null!==a&&(h=a);return{returnValue:!0,transferSize:c,o_e:h,pWe:v}}BBb(a,
c){r.ULS.sendTraceTag(4551815,306,50,ld(a,c))}static get instance(){return bi._instance||(bi._instance=new bi(Cj.a.instance,null,l.AFrameworkApplication.K.$("PerfTimingLoggerFilterDomainsIsEnabled")?l.AFrameworkApplication.K.bB("ResourceLoggerDomainAllowList"):null))}static A8a(a){return!(void 0===a||null===a)&&!(void 0===a.timing||null===a.timing)}}bi._instance=null;bi.jyj=RegExp("^https?://.*","i");Object(w.a)(bi,"PerformanceTimingLogger",null,[790]);class ml{constructor(a,c){this.WVe=null;this.HDe=
a;this.behavior=c;this.url=this.tq.name}get Z0f(){return 2===this.behavior?this.url:Af.a.Bsa(this.url)}get tq(){return this.HDe}rYf(){const a={},c=this.tq;a.a=this.Z0f;a.b=c.initiatorType;a.c=this.round(c.redirectStart);a.d=this.round(c.redirectEnd);a.e=this.round(c.fetchStart);a.f=this.round(c.domainLookupStart);a.g=this.round(c.domainLookupEnd);a.h=this.round(c.connectStart);a.i=this.round(c.connectEnd);a.j=void 0!==c.secureConnectionStart&&null!==c.secureConnectionStart?this.round(c.secureConnectionStart):
0;a.k=this.round(c.requestStart);a.l=this.round(c.responseStart);a.m=this.round(c.responseEnd);a.o=this.round(ml.B_b(c,"decodedBodySize"));a.p=this.round(ml.B_b(c,"encodedBodySize"));a.q=this.round(ml.B_b(c,"transferSize"));a.n=this.WVe;return a}round(a){return Math.round(1E3*a)/1E3}static B_b(a,c){return a[c]}}Object(w.a)(ml,"ResourceTimingEntry",null,[818]);class fg{constructor(a,c=null,h=100){this.S9f=a;this.Sgd=c;this.Tec={};this.P9i=h}WGn(a){var c=a.name.toLowerCase();const h=Af.a.O9e(c);this.h3m(h,
c)&&(h in this.Tec?r.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",h):(c={},c.fetchstart=a.fetchStart,c.responseend=a.responseEnd,c.iscached=this.VTl(a),c.encodedsize=ml.B_b(a,"encodedBodySize"),c.decodedsize=ml.B_b(a,"decodedBodySize"),this.Tec[h]=c))}h3m(a,c){if(this.S9f)return Array.contains(this.S9f,a);if(this.Sgd)for(a=Af.a.p0(c),c=0;c<this.Sgd.length;c++)if(this.Sgd[c]&&a.endsWith(this.Sgd[c]))return!0;return!1}VTl(a){try{const c=ml.B_b(a,"transferSize");
if(c)return!c;r.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.P9i}catch(c){r.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",c.message)}return!1}OPm(){if(Za.a.ve(this.Tec))r.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var a=l.AFrameworkApplication.e0?l.AFrameworkApplication.e0.split(";"):
[],c=Object.assign(new pb.a,{extendedProperties:ta.a.AD()});c.extendedProperties.set("Flights",z.c(a));this.f1h(c,this.Tec,Fa.Health.instance)}}f1h(a,c,h){if(c){var v=0,B=0,X=0,ma=0,Pa=0,mb=0,Tb=0,rc=0,Tc=0,vd=0,ee=0;for(let Xe in c){var Ie=c[Xe];try{const Yf=Object(ha.a)(Object,Ie);if(!Yf)continue;const Hh=Yf.iscached?Boolean.parse(Yf.iscached.toString()):!1,Fi=Yf.fetchstart?this.parseFloat(Yf.fetchstart.toString()):0,wk=(Yf.responseend?this.parseFloat(Yf.responseend.toString()):0)-Fi,Gk=Yf.encodedsize?
this.parseFloat(Yf.encodedsize.toString()):0,Kl=Yf.decodedsize?this.parseFloat(Yf.decodedsize.toString()):0;v+=wk;ma+=Gk;Tb+=Kl;vd++;Hh?(X+=wk,mb+=Gk,Tc+=Kl,ee++):(B+=wk,Pa+=Gk,rc+=Kl)}catch(Yf){r.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Yf.message)}}a.extendedProperties.set("StaticResources",z.c(c));a.extendedProperties.set("TotalResourceDownloadLatency",v.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",
B.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",X.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",ma.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Pa.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",mb.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Tb.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",rc.toString());
a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Tc.toString());a.extendedProperties.set("TotalNumberOfResourcesDownloaded",vd.toString());a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",ee.toString());h.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);h.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(w.a)(fg,"AppStaticResourceManager",
null,[]);class Ej extends Sys.EventArgs{constructor(a){super();this.entries=a}}Object(w.a)(Ej,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class ui{constructor(a,c,h=null,v=null,B=100){this.qpe=!1;this.Jm=null;this.ahc=0;this.ma=new Rd.a;this.cfc=null;this.zW=!1;this.SIg=0;this.Ta=a;this.Geg=0;this.Y0f=this;this.ahe=new Mi(h);this.PH=c;v&&(this.cfc=new fg(null,v,B))}get DXg(){try{return!(void 0===this.PH||null===this.PH)&&!(void 0===this.PH.getEntriesByType||null===this.PH.getEntriesByType)}catch(a){return r.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",a),!1}}get spk(){return this.Geg}get isActive(){return this.zW}get jYf(){return this.SIg}sPg(a){this.ma.addHandler(ui.l0e,a)}Ari(a){this.ma.removeHandler(ui.l0e,a)}yb(a,c){const h=this.jYf!==a;this.SIg=a;this.isActive&&this.Ta&&h&&(this.me(),this.ub());this.Geg=c}ytc(){!this.isActive&&this.DXg&&(this.ub(),this.zW=!0)}deactivate(a){this.isActive&&(this.me(),a&&this.flush(),this.zW=!1)}flush(){if(this.isActive&&
this.DXg)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.ahc&&r.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",a.length-this.ahc);const c=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);c&&(window.performance.clearResourceTimings(),this.ahc=0);const h=[];for(let v=this.ahc;v<a.length;v++)this.ahe.BRh(a[v].name)&&(this.cfc&&this.cfc.WGn(a[v]),h.push(new ml(a[v],
this.spk)));c||(this.ahc=a.length);this.ma.raiseEvent(ui.l0e,new Ej(h));for(a=0;a<h.length;a++)0!==h[a].behavior&&2!==h[a].behavior||this.Y0f.BBb(0,h[a].rYf());0<h.length&&r.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",h.length)}catch(c){r.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",c)}}BBb(a,c){r.ULS.sendTraceTag(4310804,306,50,ld(a,c))}PNm(){this.cfc.OPm()}ub(){this.Ta&&0<this.jYf&&
(this.Jm=new Se.a(3,2,1E3*this.jYf,()=>{this.flush()},5),this.Ta.ub(this.Jm),this.qpe=!0)}me(){this.qpe&&(this.Ta.me(this.Jm),this.Jm=null,this.qpe=!1)}}ui.l0e="EntriesAvailable";Object(w.a)(ui,"ResourceTimingLogger",null,[771,790]);class Xl{constructor(){this.W=null}get name(){return"Common.ResourceTiming"}init(){this.W.resolve("Common.NetworkTiming.IResourceTimingLogger");bi.instance.run()}dispose(){}yb(a){this.W=a;let c=null;if(l.AFrameworkApplication.K.$("ResourceLoggerFilterDomainsIsEnabled"))try{c=
l.AFrameworkApplication.K.bB("ResourceLoggerDomainAllowList")}catch(B){r.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const h=[];h.push(Af.a.p0(Ki.a.B5).toLowerCase());h.push(Af.a.p0(Ki.a.VVc).toLowerCase());const v=l.AFrameworkApplication.K.vb("AppStaticResourceMonitorCacheThresholdInMs",100);a.register(771,"Common.NetworkTiming.IResourceTimingLogger").singleInstance().Pc(()=>new ui(l.AFrameworkApplication.Cb,window.performance,c,h,v))}static main(){M.a.instance.Lb(new Xl)}}
Object(w.a)(Xl,"ResourceTimingPackage",null,[1,2]);var qf=b(231);class yk{constructor(){this.hae={}}rBj(a){this.hae[a.id.toString()]=a}dim(a){const c=this.hae;for(let h in c)c[h].notify(a,!1);this.hae={}}SIm(a,c){c&&this.rBj(c);return this.Bci(a,c)}a_e(a){this.dim(a)}Pgh(a,c){a.notify(c,!0)}}Object(w.a)(yk,"AEventEmitter",null,[726]);var Qh;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]="waiting";a[a.shouldRetry=2]="shouldRetry";a[a.complete=3]="complete"})(Qh||(Qh={}));Object(w.b)("EventResultState",
Qh);class rk{constructor(){this._state=0}get state(){return this._state}set state(a){r.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:Qh[this._state],["NewState"]:Qh[a]},"ResultType",this.QBh());this._state=a}}Object(w.a)(rk,"AEventResult",null,[725]);class yf extends rk{constructor(){super();this.aCe=this.fpc=null;this.state=0;this.Lme=this.xng=!1}get K9(){return this.fpc}get w0a(){return this.aCe}get yEl(){return this.xng}QBh(){return"GetMoreInfo Result"}}Object(w.a)(yf,
"GetMoreInfoResult",rk,[837,725]);var Cl=b(1391),bn=b(1369),Yl=b(921);class rj{constructor(a,c,h,v,B,X,ma,Pa){this.ga=a;this.Qe=c;this.xg=h;this.Uta=v;this.Ta=B;this.Hy=X;this.Agj=ma;this.nhd=Pa}bRm(){this.M5b.ka(Sa.a.Z6b,Kc.a.frame,Object(m.a)(this,this.Z6b,"openUrlInNewTab"));this.M5b.ka(Sa.a.pBf,Kc.a.frame,Object(m.a)(this,this.pBf,"openDocumentUrl"));l.AFrameworkApplication.Wba?this.l1h():this.M5b.Aa(Sa.a.$td,Kc.a.frame,Object(m.a)(this,this.$td,"documentLoaded"),96)}Z6b(a,c,h,v,B){B&&B.MenuItemId&&
(r.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:B.SourceControlId,["AppType"]:Yl.a[this.oLa]}),Ve.a.Ql(B.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}pBf(a,c,h,v,B){if(B&&B.MenuItemId){const X=l.AFrameworkApplication.K.$("WacInTabOpenMRUIsEnabledForUiHost"),ma=l.AFrameworkApplication.K.$("UiHostSupportsDocRebootFeatures");r.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",X,ma);
if(X&&ma){r.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:B.SourceControlId,["AppType"]:Yl.a[this.oLa]});a=B.MenuItemId.toString();const Pa={};Pa[L.a.G8b]="1";Pa[L.a.documentUrl]=a;Pa[L.a.reason]=bn.a.open;r.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");l.AFrameworkApplication.uO().execute(mb=>{mb.Qg(E.a.jvb,Pa)})}else this.Z6b(a,c,h,v,B)}return 32}$td(){this.l1h();return 32}XKa(a,c,h=""){if(c&&c.yF){const v=Cl.a[c.status];c=c.yF.getTime();
const B=this.wt()-c;r.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:v,["ElapsedMs"]:B,["StartTime"]:c,["Notes"]:h})}else r.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}l1h(){var a=l.AFrameworkApplication.K.$("QPGVCI"),c=Af.a.tX(document.URL,"wdNewAndOpenCt",a);if(c){c=parseInt(c);var h=Af.a.tX(document.URL,"wdPreviousSession",a);a=Af.a.tX(document.URL,"wdPreviousCorrelation",
a);var v=l.AFrameworkApplication.K.$("NAOPLP");if(l.AFrameworkApplication.Wba){var B=l.AFrameworkApplication.Wba.getTime();!c||c>B?r.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:c,["DocumentLoadedTime"]:B,["SessionId"]:h,["Correlation"]:a}):r.ULS.sendTraceTag(5849683,202,v?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:B-c,["ClickTimestamp"]:c,["SessionId"]:h,["Correlation"]:a})}else r.ULS.sendTraceTag(5849681,
202,v?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:c,["SessionId"]:h,["Correlation"]:a})}}get M5b(){return this.ga.value}get yNc(){return this.Qe.value}get p7h(){return this.xg.value}get oLa(){return this.Uta.value}get tPd(){return this.Ta.value}get wt(){return this.Hy}get nLa(){return this.Agj.value}get z0a(){return this.nhd.value}static get instance(){return rj._instance||(rj._instance=rj.hq())}static hq(){return new rj(new qf.a(()=>
l.AFrameworkApplication.pa),new qf.a(()=>l.AFrameworkApplication.fe),new qf.a(()=>l.AFrameworkApplication.na),new qf.a(()=>l.AFrameworkApplication.na.Ya.Rm),new qf.a(()=>l.AFrameworkApplication.Cb),()=>(new Date).getTime(),new qf.a(()=>l.AFrameworkApplication.na.Ya.nLa),new qf.a(()=>l.AFrameworkApplication.z0a))}}rj._instance=null;Object(w.a)(rj,"NewAndOpenCommonHelpers",null,[723]);class Ci{constructor(a,c,h){this.Rfd=this.Jm=null;this.Lye=0;this.Utj=a;this.Ta=c;this.dfg=h}WKj(){this.Lye=this.v9b+
1}aMf(a){this.Jm&&(this.Ta.me(this.Jm),this.Jm=null);a&&(this.Lye=0)}Dwn(a){const c=this.BDn;0<=c?(this.WKj(),this.aMf(!1),this.Jm=new Se.a(4,1,c,a,107),this.Ta.ub(this.Jm)):(this.aMf(!0),r.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.dfg}))}get v9b(){return this.Lye}get BDn(){return this.v9b>=this.Jzi.length?-1:this.Jzi[this.v9b]}get Jzi(){if(!this.Rfd){const a=(this.Utj.value||"0").split(",");this.Rfd=[];for(let c=0;c<a.length;c++){const h=parseInt(a[c]);isNaN(h)?r.ULS.sendTraceTag(5849677,
202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.dfg,["Entry"]:a[c]}):Array.add(this.Rfd,h)}}return this.Rfd}}Object(w.a)(Ci,"RetryHelper",null,[]);class wj extends yk{constructor(a,c){super();this.hva=a;this.jqc=new Ci(c,this.kNc.tPd,"GetMoreInfo");this.Eo=new yf}k$l(){this.drf("Document opened")}tjk(a){return()=>{this.drf(a,!0)}}Bci(a,c=null){r.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:a});3===this.Eo.state?(c&&this.Pgh(c,
this.Eo),r.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:a})):this.drf(a);return this.Eo}drf(a,c=!1){this.jqc.aMf(!c);1===this.Eo.state?r.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.jqc.v9b}):(r.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.jqc.v9b}),this.Eo.state=1,c=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.kNc.nLa,
l.AFrameworkApplication.kl),this.kNc.yNc.oTb(c,1,null,null,[wj.lAg,wj.hHg],5,this.mik(),this.lik(a)))}mik(){return a=>{var c=!1;let h=!1;var v=!1,B;l.AFrameworkApplication.K.$("GetMoreInfoDataFromResponseBody")&&(a.data.qd?({dv:B}=z.d(a.data.qd)).returnValue?B?(v=!0,this.Eo.aCe=B.StorageServiceDisplayName,this.Eo.fpc=wj.jYh(B.PersonalFileStorageUrl)?B.PersonalFileStorageUrl:"",""===this.Eo.K9&&"SharePointOnlineConsumer"===l.AFrameworkApplication.K.Ga("FileSource")&&(this.Eo.fpc=Af.a.Bsa(l.AFrameworkApplication.breadcrumbFolderUrl)),
c=""===this.Eo.K9&&""!==this.Eo.w0a):r.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):r.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):r.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));v||((B=a.data.oj)?(this.Eo.aCe=
(B[wj.hHg]||"").toString(),c=(B[wj.lAg]||"").toString(),this.Eo.fpc=wj.jYh(c)?c:"",""===this.Eo.K9&&"SharePointOnlineConsumer"===l.AFrameworkApplication.K.Ga("FileSource")?(this.Eo.fpc=Af.a.Bsa(l.AFrameworkApplication.breadcrumbFolderUrl),c=""===this.Eo.K9&&""!==this.Eo.w0a):c=""===c&&""!==this.Eo.w0a):(r.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),h=!0));v=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",
this.jqc.v9b,h,c,v);this.kNc.XKa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",a.data,v);this.Zzi(3,c,h)}}lik(a){return c=>{this.kNc.XKa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",c.data,"Failure");this.Zzi(2);this.jqc.Dwn(this.tjk(a))}}Zzi(a,c=!1,h=!1){this.Eo.state=a;this.Eo.xng=c;this.Eo.Lme=h;this.a_e(this.Eo)}get kNc(){return this.hva.value}static get instance(){return wj._instance||(wj._instance=wj.hq())}static hq(){return new wj(new qf.a(()=>rj.instance),
new qf.a(()=>l.AFrameworkApplication.C7k))}static jYh(a){if(!a)return r.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(F.a.kg(a).startsWith("https://"))return!0;r.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}wj.lAg="PersonalFileStorageUrl";wj.hHg="StorageServiceDisplayName";wj._instance=null;Object(w.a)(wj,"GetMoreInfoActor",yk,[]);class Fj{constructor(a,c,h,v,B){this.Jhj=6E4;this.PLh="inactive";this.BMg="active";
this.zW=!0;this.Ta=a;this.Ifj=c;this.Hy=h;this.jid=v;this.ma=new Rd.a;B&&this.uwn();this.Hrg=this.sxh()}ZGe(a){this.ma.addHandler(this.BMg,a)}sEj(a){this.ma.addHandler(this.PLh,a)}uwn(){const a=new Se.a(5,2,this.Jhj,Object(m.a)(this,this.Uxl,"inactiveLoop"),108);this.Vxl.ub(a)}Uxl(){const a=this.sxh(),c=this.wt()-a;c>this.i5d&&this.zW&&(r.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:c}),this.zW=!1,this.ma.raiseEvent(this.PLh));a-this.Hrg>this.i5d&&(this.zW=!0,
this.ma.raiseEvent(this.BMg));this.Hrg=a}get Vxl(){return this.Ta.value}get sxh(){return this.Ifj}get wt(){return this.Hy}get i5d(){return this.jid.value}static get instance(){return Fj._instance||(Fj._instance=Fj.hq())}static hq(){return new Fj(new qf.a(()=>ag.a.instance),()=>l.AFrameworkApplication.Xnf.getTime(),()=>(new Date).getTime(),new qf.a(()=>l.AFrameworkApplication.i5d),!0)}}Fj._instance=null;Object(w.a)(Fj,"InactivityManager",null,[]);var sk=b(1514);class xn extends rk{constructor(){super();
this.Umj=this.Nvg=this.Mvg=null;this.state=this.UIg=0;this.Lme=!1}get Zsf(){return this.Mvg}get G6h(){return this.Nvg}get FDn(){return this.UIg}QBh(){return"MruActor Result"}}Object(w.a)(xn,"MruResult",rk,[724,725]);class yn{constructor(a,c,h){this.task=null;this.Wyb=a;this.NMc=c;this.taskManager=h;this.retryCount=this.bIc=0;this.Rwe=this.jLc=null}UPl(a,c){return a===Ga.a.RYb||20===c||18===c||3===c}mRl(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===
a||23===a||26===a||27===a||28===a}get bVd(){return this.Rwe}reset(){this.bIc=this.retryCount=0;this.Rwe=this.jLc=null;this.task&&(this.taskManager.me(this.task),this.task=null)}ZBl(a,c,h,v){this.Rwe=String.format("{0}_{1}",h,v);if(this.retryCount>=this.NMc)return r.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.UPl(h,v))return r.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.mRl(v)&&1<=this.bIc)return this.jLc=h,!1;c=Math.max(c,this.Wyb*
Math.pow(2,this.bIc));if(26===v)c=Math.max(c,3E4);else if(27===v||28===v)c=Math.max(c,6E4);9===v||412===h&&(null==this.jLc||412!==this.jLc)?c=500:this.bIc+=1;this.jLc=h;this.retryCount+=1;this.task&&this.taskManager.me(this.task);r.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",c);this.task=new Se.a(2,1,c,a,107);this.taskManager.ub(this.task);return!0}}Object(w.a)(yn,"RetryManager",null,[]);var yh=b(171);class Sm{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=
this.folderName=this.documentUrl=null}}Object(w.a)(Sm,"WriteOptions",null,[]);var vi=b(551);class aj extends yk{constructor(a,c,h,v,B,X,ma){super();this.hva=a;this.Mlj=c;this.s6a=new yn(l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.AK.tPd);this.G7a=new yn(l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",
15E3),l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.AK.tPd);this.Orj=h;this.LLg=v;this.mAj={};this.lga=new xn;this.efj=B;this.abd="";this.nJ=X;this.$gg=ma;this.hed="";this.Trj=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25)}get Q8d(){return this.mAj}zUm(){this.AK.M5b.ka(Sa.a.hsi,Kc.a.frame,Object(m.a)(this,this.aZm,"renameMruEntry"))}aZm(){return this.g3f("Rename")}y$l(){this.M3h("File Opened")}z$l(){this.M3h("IntervalUpdate")}M3h(a){r.ULS.sendTraceTag(5849670,
202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.g3f(a)}WIa(a){(a=F.a.WIa(a))&&a.startsWith(".")&&(a=a.substring(1,a.length));return a}mqh(){switch(this.AK.oLa){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}dll(a){var c=this.efj();if(!c)return null;const h=new Sm;h.documentUrl=this.$gg.value?encodeURI(c):c;h.mruItemId=this.abd;h.app=this.mqh();if(c=this.nJ())h.folderName=c.breadcrumbFolderName,
c=c.Ry,h.documentName=F.a.rI(c),h.documentExt=this.WIa(c);a&&(h.documentName?h.documentName.length?255<=h.documentName.length?a.set("DocumentNameLength","Long"):2084<=h.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength","Null"));return JSON.stringify(h)}g3f(a,c=!1){if(4===this.AK.oLa&&!l.AFrameworkApplication.$zc)return 2;var h=ta.a.AD();h&&(h.set("Trigger",a),h.set("IsRetry",c?"true":"false"),h.set("MruIdSent",this.abd?"true":"false"),
h.set("URLEncoded",this.$gg.value?"true":"false"));Fa.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",h);a=this.dll(h);if(!a)return c=!l.AFrameworkApplication.mJb,h&&(h.set("WebEditingIsEnabled",l.AFrameworkApplication.mJb?"true":"false"),h.set("ProtectedFile",l.AFrameworkApplication.protectFile?"true":"false")),Fa.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",c,!1,Object.assign(new pb.a,{extendedProperties:h})),2;this.G7a&&!c&&this.G7a.reset();h=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",
this.AK.nLa,this.rpf);this.LLg?this.Q8d["X-FileId"]=l.AFrameworkApplication.kl:h+=String.format("&{0}",l.AFrameworkApplication.kl);l.AFrameworkApplication.sessionStartInfoSettings&&(this.Q8d["X-Office-AudienceGroup"]=Object(ha.a)(String,l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");this.Q8d["X-Timeout"]=15E3;return this.AK.yNc.ai(h,2,a,this.Q8d,!0,5,Object(m.a)(this,this.NZn,"writeMruV2EntryOnServerSuccessCallback"),Object(m.a)(this,this.qnk,"createWriteMruV2EntryOnServerFailureCallback"),
null,void 0,void 0,void 0,void 0,"4")}NZn(a){this.JHh(a.data)}JHh(a){const c=ta.a.AD();this.G7a&&(c&&this.G7a.bVd&&(c.set("LastError",this.G7a.bVd),c.set("NumRetries",this.G7a.retryCount.toString())),this.G7a.reset());const h=sk.c(a.qd);h&&h.diagnostics_data&&(this.abd=h.diagnostics_data.mru_id);a=+a.VQ-+a.yF;c&&c.set("RequestDuration",a.toString());Fa.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new pb.a,{extendedProperties:c}))}qnk(a){if(a.data.we===Ga.a.Gyc)this.JHh(a.data);else{var c=
a.data.we===Ga.a.Yda,h=ta.a.AD();this.SHh(this.G7a,a,this.Zmk(),h);h&&(h.set("StatusCode",a.data.we.toString()),c||this.lHe(a.data,h));Fa.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",a.data.we),c,!1,Object.assign(new pb.a,{extendedProperties:h}))}}Zmk(){return()=>{this.g3f("Retry",!0)}}K7k(){this.f5b("Polling")}J7k(){this.f5b("Retry",!0)}n$l(){this.f5b("Open")}m$l(){this.f5b("Activity")}l$l(){this.f5b("OpenRecentLinks",!1,!0)}E3h(){this.f5b("ActivityRecentLinks",!1,
!0)}f5b(a,c=!1,h=!1){r.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const v=ta.a.AD();v&&(v.set("Trigger",a),v.set("IsRetry",c?"true":"false"),h&&v.set("RecentLinks","true"));Fa.Health.instance.recordKpiUsage("GetMru",0,"smartfio",v);this.s6a&&!c&&this.s6a.reset();h?this.c9g(Object(m.a)(this,this.L7k,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(m.a)(this,this.G7k,"getMruForRecentLinksFromServerFailureCallback"),!0):this.c9g(Object(m.a)(this,this.M7k,"getMruV2FromServerSuccessCallback"),
Object(m.a)(this,this.I7k,"getMruFromServerFailureCallback"))}lHe(a,c){a&&a.oj&&(a=a.oj["X-CorrelationId"])&&c.set("ServerCorrelationId",a)}Y3l(a,c){a&&(c&&c.set("RequestDuration",(+a.VQ-+a.yF).toString()),Fa.Health.instance.recordKpiSuccess("GetMru",Object.assign(new pb.a,{extendedProperties:c})))}M7k(a){this.vyh(a)}vyh(a,c=!1){var h="";let v=null,B=null,X=null;const ma=sk.c(a.data.qd);ma&&(v=ma.places?ma.places.items:[],B=ma.documents?ma.documents.items:[],(X=sk.a(ma,c))&&(h=z.c(X)));l.AFrameworkApplication.na&&
l.AFrameworkApplication.na.Ya.rKa&&yh.c()&&(c?this.hed=h:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(h,!0)));h=ta.a.AD();this.s6a&&(h&&this.s6a.bVd&&(h.set("LastError",this.s6a.bVd),h.set("NumRetries",this.s6a.retryCount.toString())),this.s6a.reset());c&&h&&h.set("RecentLinks","true");X||v||B?(c?this.AK.XKa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",a.data,"Success"):this.AK.XKa("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.n7d(3,X,v,B),this.Y3l(a.data,
h)):(c?this.AK.XKa("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",a.data,"Failure: Invalid JSON"):this.AK.XKa("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),h&&this.lHe(a.data,h),Fa.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new pb.a,{extendedProperties:h})),this.n7d(3,null,null,null,!0));this.a_e(this.lga)}L7k(a){this.vyh(a,!0)}SHh(a,c,h,v){let B=0,X=0;const ma=sk.c(c.data.qd);ma&&(null!=ma.response_code&&(B=ma.response_code,
v&&v.set("MruResponseCode",B.toString()),9===B&&(this.abd="")),ma.error_data&&null!=ma.error_data.retry_after_ms&&(X=ma.error_data.retry_after_ms,v&&v.set("ExpectedRetryAfter",X.toString())));a&&(c=a.ZBl(h,X,c.data.we,B),v&&(v.set("CurrentRetryCount",a.retryCount.toString()),v.set("RetryScheduled",c?"true":"false")))}I7k(a){this.uyh(a)}uyh(a,c=!1){const h=a.data.we===Ga.a.Yda,v=ta.a.AD();v&&(v.set("StatusCode",a.data.we.toString()),c&&v.set("RecentLinks","true"),h||this.lHe(a.data,v));c?this.AK.XKa("MruActor.GetMruForRecentLinksFromServerFailureCallback",
a.data,"Failure"):this.AK.XKa("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.n7d(2);this.SHh(this.s6a,a,Object(m.a)(this,this.J7k,"getMruFromServerRetryTask"),v);Fa.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.we),h,!1,Object.assign(new pb.a,{extendedProperties:v}));this.a_e(this.lga);l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.rKa&&yh.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),c?this.hed=null:appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}G7k(a){this.uyh(a,!0)}n7d(a,c=null,h=null,v=null,B=!1){if(3!==this.lga.state||3===a)this.lga.Mvg=c,this.lga.Nvg=h,this.lga.Umj=v,this.lga.state=a,this.lga.Lme=B,this.lga.UIg=this.AK.wt()}Bci(a,c){r.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.lga.state});c&&3===this.lga.state&&this.Pgh(c,this.lga);return this.lga}c9g(a,c,h=!1){this.n7d(1);let v;const B={};v=h?String.format(this.AK.nLa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.Trj,"OfficeSuite",this.rpf,"ClassicMru"):String.format(this.AK.nLa+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.mqh(),this.rpf);this.Orj.value||(v+="&entity=docs");l.AFrameworkApplication.sessionStartInfoSettings&&(B["X-Office-AudienceGroup"]=Object(ha.a)(String,l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||"");h&&(B["X-Office-Application"]="147");this.LLg?B["X-FileId"]=l.AFrameworkApplication.kl:v+=String.format("&{0}",l.AFrameworkApplication.kl);
this.AK.yNc.ai(v,1,null,B,!0,5,a,c,null)}get AK(){return this.hva.value}get rpf(){return this.Mlj.value}static get instance(){return aj._instance||(aj._instance=aj.hq())}static hq(){return new aj(new qf.a(()=>rj.instance),new qf.a(()=>vi.a.af(l.AFrameworkApplication.lcid).name),new qf.a(()=>l.AFrameworkApplication.na.Ya.fA),l.AFrameworkApplication.K.$("MruWriteFileIdInHeader"),()=>l.AFrameworkApplication.na.Ya.Bba,()=>l.AFrameworkApplication.Yr,new qf.a(()=>l.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled")))}}
aj._instance=null;Object(w.a)(aj,"MruActor",yk,[]);class bg{constructor(){this.Msc=this.JBg=this.W=null;this.Yf=!1}get name(){return"Common.App.NewAndOpen.Core"}yb(a){this.W=a;a.register(723,"Common.INewAndOpenCommonHelpers").singleInstance().Pc(()=>rj.instance);a.register(726,"Common.IEventEmitter<Common.IGetMoreInfoResult>").singleInstance().Pc(()=>wj.instance);a.register(726,"Common.IEventEmitter<Common.IMruResult>").singleInstance().Pc(()=>aj.instance)}init(){l.AFrameworkApplication.K.Io(()=>
{this.XWa()})}XWa(){this.W.resolve("Common.INewAndOpenCommonHelpers");this.W.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.W.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;rj.instance.bRm();l.AFrameworkApplication.BAa&&(a=!0);l.AFrameworkApplication.XHf&&(aj.instance.n$l(),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&aj.instance.l$l(),0<l.AFrameworkApplication.H6h&&this.ONg(),this.mln(),a=!0);l.AFrameworkApplication.z0a&&
a&&wj.instance.k$l();l.AFrameworkApplication.BPn&&(a=aj.instance,a.zUm(),a.y$l(),ag.a.instance.ub(this.CPn))}mln(){Fj.instance.ZGe(Object(m.a)(aj.instance,aj.instance.m$l,"makeGetMruRequestActivityTrigger"));l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&Fj.instance.ZGe(Object(m.a)(aj.instance,aj.instance.E3h,"makeGetMruForRecentLinksRequestActivityTrigger"));Fj.instance.ZGe(Object(m.a)(this,this.ONg,"addGetMruFromServerTask"));Fj.instance.sEj(Object(m.a)(this,
this.rrk,"deleteGetMruFromServerTask"))}rrk(){ag.a.instance.me(this.I6h)}ONg(){ag.a.instance.ub(this.I6h)}get I6h(){return this.JBg||(this.JBg=new Se.a(5,2,l.AFrameworkApplication.H6h,Object(m.a)(aj.instance,aj.instance.K7k,"getMruFromServerTask"),109))}get CPn(){return this.Msc||(this.Msc=new Se.a(2,2,6E4*l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(m.a)(aj.instance,aj.instance.z$l,"makeUpdateMruTask"),197))}dispose(){this.Yf||
(this.Yf=!0,this.Msc&&(ag.a.instance.me(this.Msc),this.Msc=null))}}Object(w.a)(bg,"CorePackageManager",null,[1,2,14]);var zh=b(1364),Gi=b(102);class gh{static HAk(a){return gh.pYg("New",a)}static IAk(a){return gh.pYg("Open",a)}static UXg(a,c){return gh.sTa("LoadingMenuSection",gh.R1l,a,gh.svc("lblLoading",c))}static tvc(a,c,h=null,v=null){return gh.sTa("MessageMenuSection",gh.F6h,c,gh.svc("lblMessage",a,h,v))}static vXj(a){return gh.UXg(a,CommonUIStrings.l_VoicedLoadingText)}static wXj(a,c){return gh.tvc(CommonUIStrings.l_NewCreationLocationMessage,
a.labelText,c.K9,c.w0a)}static uXj(a,c){return gh.tvc(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,c.w0a,"\n\n"),a.labelText)}static YXg(a){return gh.tvc(CommonUIStrings.l_NewGenericErrorMessage,a.labelText)}static sXj(a,c,h){return gh.sTa("menuNewBlank",gh.Wtl,h?a.labelText:null,gh.ovc(a.pJh,a.qJh,a.rJh,null,a.PWa,a.MGc,c,"blank"))}static FYj(){return gh.svc("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static lYg(){return gh.svc("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static GYj(a,
c){return gh.sTa("menuNewTemplates",a,null,c)}static qXj(a,c){return gh.sTa("menuNewMoreTemplates",gh.Knh,null,gh.ovc("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,a,c))}static TVj(a,c,h){let v="";h&&c&&(v=gh.sTa("BrowseMoreMenuSection",gh.Knh,null,gh.ovc("btnBrowseMore",c,c,null,null,null,a||"1959943459",h)));return v}static svc(a,c,h=null,v=null){let B=v;c&&0<c.length&&(B=gh.z7h.CZa(c).trimEnd(),B=0<=B.indexOf("{0}")?String.format(B,
v):String.format("{0} {1}",B,v));h=h&&v?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',F.a.Wd(h),F.a.Wd(v),F.a.Wd(B)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',F.a.Wd(a||""),gh.z7h.CZa(F.a.Wd(c||"")),h)}static ovc(a,c,h,v,B,X,ma,Pa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
F.a.Wd(a||""),F.a.Wd(c||""),F.a.Wd(h||""),v||"32by32",F.a.Wd(B||""),F.a.Wd(X||""),ma,F.a.Wd(Pa||""))}static pYg(a,c){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',a,c)}static sTa(a,c,h,v){h=h?String.format('Title="{0}"',F.a.Wd(h)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
F.a.Wd(a||""),F.a.Wd(c||""),h,v)}}gh.F6h="MenuMru";gh.R1l="MenuLoading";gh.Wtl="MenuHeader";gh.Knh="MenuFooter";gh.z7h=Gi.a.Sz("\n","&#10;");Object(w.a)(gh,"NewAndOpenXmlUtilities",null,[]);class Zi{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(w.a)(Zi,"HostInformation",null,[]);class sm{constructor(a,c,h,v,B,X){this.cDe=this.Iu=this.m2c=null;this.wgd=this.WAe=!1;this.Wug=0;this.DAe=this.Doe=!1;this.hva=a;this.$ic=c;this.TPa=new qf.a(()=>new zh.a(h.value,Object(m.a)(this,
this.oxb,"getMoreInfoEventReceived")));this.Smj=v;this.C5a=B;this.cvj=X;this.jrc=this.K1d;2===this.K4.oLa&&(this.DAe=!0)}get nba(){switch(this.K4.oLa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}eb(){const a=this.K4.M5b;a.ka(Sa.a.newDocument,Kc.a.frame,Object(m.a)(this,this.newDocument,"newDocument"));a.Aa(Sa.a.CUd,Kc.a.frame,Object(m.a)(this,this.CUd,"populateNewMenu"),96)}newDocument(a,c,h,v,B){return 1===h?32:2===h&&B&&B.MenuItemId&&
B.SourceControlId?this.uyc(B.MenuItemId,B.SourceControlId):8}uyc(a,c){var h=this.yPd.F9g;if(null===h)return 8;var v=l.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(l.AFrameworkApplication.JAb&&v){r.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const B={};B[L.a.template]=a;B[L.a.nba]=this.nba;B[L.a.lcid]=l.AFrameworkApplication.lcid.toString();B[L.a.reason]=bn.a.uUe;l.AFrameworkApplication.uO().execute(X=>
{X.Qg(E.a.uyc,B)})}else v=(new Date).getTime(),c=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",h,F.a.ui(this.BAa),F.a.ui(a),F.a.ui(this.nba),F.a.ui(l.AFrameworkApplication.lcid.toString()),F.a.ui(v.toString()),F.a.ui(c),F.a.ui(l.AFrameworkApplication.canary),l.AFrameworkApplication.kl),(h=l.AFrameworkApplication.K.Ga("ScenarioId"))&&""!==h&&(c+="&wdscenarioid="+F.a.ui(h)),c+="&"+l.AFrameworkApplication.eCd(),l.AFrameworkApplication.PXa&&
(c+="&"+l.AFrameworkApplication.GAd()),(h=this.Iu?this.Iu.K9:null)&&(c+="&DestinationUrl="+F.a.ui(h)),Ve.a.Ql(c,"_blank",void 0,"CreateNewDocument");2===this.K4.oLa&&r.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:Yl.a[this.K4.oLa],["Template"]:a});return 32}V7l(a){let c=Number.MAX_VALUE,h=Number.MIN_VALUE;const v=window.performance;if(v&&"undefined"!==typeof v.getEntriesByName){for(let X=0;X<a.length;X++){var B=v.getEntriesByName(a[X]);B&&0<B.length&&(B=B[0],
c=Math.min(parseInt(String(B.fetchStart)),c),h=Math.max(parseInt(String(B.responseEnd)),h))}h>c&&r.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:h-c,["MinFetchStart"]:c,["MaxResponseEnd"]:h})}}CUd(a,c,h,v,B){if(1===h)return this.DAe&&(l.AFrameworkApplication.m9("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.DAe=!1),32;2!==h||this.Doe||(this.Wug=(new Date).getTime(),r.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",
{["ShouldShowTemplates"]:this.K1d,["CachedNewMenuXmlExists"]:!!this.m2c,["ShouldCallGetMoreInfo"]:this.K4.z0a}));return this.mCm(B)}mCm(a){a&&(this.m2c?a.PopulationXML=this.m2c:(this.K4.z0a&&!this.Iu&&this.Jgm.jj("Opened New menu",!0),a.PopulationXML=this.QPk(this.getTemplateListJson())));return 32}NVh(){return!this.K4.z0a||!!this.Iu&&3===this.Iu.state&&!!this.Iu.w0a&&!!this.Iu.K9}QQl(){return l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.rKa?!0:this.NVh()}getTemplateListJson(){if(!this.K1d||
!this.QQl())return null;if(this.jrc&&!this.wgd){var a="9";const c=l.AFrameworkApplication.K.appSettings;"NumberOfTemplatesInBackstage"in c&&(a=c.NumberOfTemplatesInBackstage);let h=this.nba;"TemplateCollectionId"in c&&(h=c.TemplateCollectionId);a=String.format(this.K4.nLa+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",F.a.ui(l.AFrameworkApplication.lcid.toString()),F.a.ui(h),a);Boolean.parse(c.AppendOriginQueryParam||"false")&&(a+="&org=backstage");a+="&"+l.AFrameworkApplication.eCd();l.AFrameworkApplication.PXa&&
(a+="&"+l.AFrameworkApplication.GAd());this.K4.yNc.ai(a,1,null,null,!1,2,v=>{this.K4.XKa("CreateNewActor.GetTemplateListJson",v.data);this.dCn(v.data.qd)},v=>{this.K4.XKa("CreateNewActor.GetTemplateListJson",v.data);this.cCn()},null,void 0,void 0,void 0,void 0,"5");this.jrc=!1}return this.cDe}dCn(a){this.cDe=a;this.jrc=!1;this.hSc();if(l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.rKa&&yh.c()){a=l.AFrameworkApplication.K.$("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const c=
l.AFrameworkApplication.JAb;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.cDe,!0,a&&c))}}cCn(){this.wgd=this.jrc=!0;this.hSc();l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.rKa&&yh.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));Fa.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}Saf(a){var c=0;for(var h=0;h<a.length;h++)if("ST"===a[h].ImageType){c=h;break}const v=a.length?
a[c]:null;a=v?v.Url||"":"";var B;let X=h=c=!1;if(v&&(B=v.AspectRatio))B=parseFloat(B),1>B?c=!0:1.5<B?h=!0:1===B&&(X=!0);else switch(r.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:a}),this.K4.oLa){case 3:c=!0;break;case 2:h=!0;break;case 5:X=!0}return{returnValue:a,Dxl:c?"95by123":h?"123by69":X?"100by100":"123by95"}}QPk(a){a=({w1d:c}=this.tXj(a,this.yPd,this.yPd.wvc||"1056925771")).returnValue;if(c){this.m2c=a;var c=(new Date).getTime()-this.Wug;r.ULS.sendTraceTag(5849604,
202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:c})}return a}oxb(a,c){r.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Iu||3!==a.state?2===a.state&&(r.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.WAe=!0,this.hSc()):(this.Iu=a,c||this.hSc(),l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.rKa&&yh.c()&&yh.d("setFileMenuHostInformation")&&(a=Object.assign(new Zi,{hostUrl:this.Iu.K9,hostName:this.Iu.w0a,
folderUrl:l.AFrameworkApplication.breadcrumbFolderUrl,folderName:l.AFrameworkApplication.breadcrumbFolderName}),r.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(a))))}tXj(a,c,h){let v;v=!1;const B=this.NVh();let X="";this.K4.z0a&&(this.WAe?(X=gh.YXg(c),this.WAe=!1,r.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Iu?B?X=gh.wXj(c,this.Iu):this.Iu.yEl?
(v=!0,this.jrc=!1,X=gh.uXj(c,this.Iu),r.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(v=!0,X=gh.YXg(c),r.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Iu.K9,["StorageServiceDisplayNameIsSet"]:!!this.Iu.w0a})):(X=gh.vXj(c.labelText),r.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));B&&(X+=gh.sXj(c,h,!X)+({w1d:v}=
this.EYj(a,h)).returnValue);return{returnValue:gh.HAk(X),w1d:v}}EYj(a,c){let h;h=!1;if(!this.K1d)return h=!0,r.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",w1d:h};let v="",B="",X="MenuTemplate";if(this.wgd)v=gh.lYg(),this.wgd=!1,r.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(a){try{const ma=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0);v=this.DYj(ma,c);r.ULS.sendTraceTag(5849612,202,
50,"Rendering File>New with template buttons");l.AFrameworkApplication.A7h&&"OneDrive"===this.BAa&&(B=gh.qXj(this.Kgm,l.AFrameworkApplication.A7h))}catch(ma){r.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:a}),v=gh.lYg()}h=!0}else X="MenuLoading",v=gh.FYj(),r.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:gh.GYj(X,v)+B,w1d:h}}DYj(a,c){let h="";const v=[];for(let X=0;X<a.length;X++){var B=
a[X];let ma="";if(B){const Pa=B.Title,mb=B.AssetId;B=B.Thumbnails;mb&&Pa&&B&&({Dxl:B,returnValue:ma}=this.Saf(B),h+=gh.ovc("jbtnNewTemplate"+X,Pa,null,B,null,ma,c,mb))}v[X]=ma}a=new Se.a(4,1,5E3,()=>{this.V7l(v)},106);this.K4.tPd.ub(a);return h}hSc(){this.Doe=!0;this.K4.p7h.UCa(this.yPd.$Bc);this.Doe=!1}get K4(){return this.hva.value}get yPd(){return this.$ic.value}get Jgm(){return this.TPa.value}get Kgm(){return this.Smj.value}get BAa(){return this.C5a.value}get K1d(){return this.cvj.value}}Object(w.a)(sm,
"CreateNewActor",null,[]);class cf{constructor(){this._initialized=!1;this.eCe={}}getString(a){this.rih();return this.get(a)}contains(a){this.rih();return a.toString()in this.eCe}rih(){this._initialized||(this.ZFj(),this._initialized=!0)}Q7a(a,c){this.eCe[a.toString()]=c}get(a){return this.eCe[a.toString()]}}Object(w.a)(cf,"AIntlHelper",null,[]);class Pk extends cf{constructor(){super()}ZFj(){this.Q7a(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.Q7a(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.Q7a(2,CommonUIStrings.l_Open);this.Q7a(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.Q7a(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.Q7a(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Pk._instance||(Pk._instance=new Pk)}static xvm(a){return Pk.instance.getString(a)}}Pk._instance=null;Object(w.a)(Pk,"MruActorIntlHelper",cf,[]);var Id;(function(a){a[a.success=0]="success";a[a.failure=1]="failure";a[a.spinner=2]="spinner";a[a.none=3]="none"})(Id||(Id={}));Object(w.b)("DisplayState",
Id);class rd{constructor(a,c,h,v,B,X,ma,Pa){this.uce=null;this.NFe=!0;this.l2c="";this.Txj=0;this.FOb=null;this.mqe=3;this.qa=Pa;this.hva=a;this.foa=c;this.Vdj=h;this.s9i=v;this.r9i=B;this.TPa=new qf.a(()=>new zh.a(X.value,null));this.Lfj=new qf.a(()=>new zh.a(ma.value,Object(m.a)(this,this.Dfm,"mruEventResultReceived")));this.qa.$("WacInTabOpenMRUIsEnabledForUiHost");this.qa.$("UiHostSupportsDocRebootFeatures")}Dfm(a,c){this.FOb=a;c||this.uoi()}FTm(){this.AK.M5b.Aa(Sa.a.eEf,Kc.a.frame,Object(m.a)(this,
this.eEf,"populateMruMenu"),96)}eEf(a,c,h,v,B){return 1!==h&&B?this.lCm(B):32}lCm(a){this.nBk();this.mBk();a.PopulationXML=gh.IAk(this.l2c+this.uce);return 32}nBk(){var a=3;let c=!1;if(this.l2c&&this.Txj===this.FOb.FDn)r.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),a=this.mqe;else{r.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var h=this.AK.wt();this.FOb=
this.Cfm.jj("File Open opened",!0);this.l2c&&2!==this.mqe&&3!==this.FOb.state?c=!0:(a=this.Bfl(this.FOb),l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.rKa&&yh.c()&&a&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(a,!0)),this.l2c=({ygm:a}=this.RPk(this.FOb)).returnValue);h=this.AK.wt()-h;r.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:h})}2!==a&&(h={["DisplayState"]:Id[a]},1!==a&&(h.IsStale=c),
r.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",h));this.mqe=a}Bfl(a){let c;try{c=z.c(a.Zsf)}catch(h){c=null,r.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",h)}return c}mBk(){this.NFe?(r.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.uce=({NVn:this.NFe}=this.g$l()).returnValue):r.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");r.ULS.sendTraceTag(5849633,
202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.NFe,["NotDisplayingLink"]:!this.uce})}RPk(a){let c;1===a.state||0===a.state?(r.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),a=2,c=gh.UXg(this.lWa(2),this.lWa(5))):3===a.state&&a.Zsf?(c=this.rXj(a.Zsf),a=0):(r.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),c=gh.tvc(this.lWa(1),this.lWa(2)),a=1);return{returnValue:c,ygm:a}}rXj(a){let c;const h=this.ZMc.wvc||
"2155708348";if(a.length){c=gh.svc("lblRecentDocuments",this.lWa(3));let v=0;for(let B=0;B<a.length;B++){const X=a[B];"FileName"in X&&"DocumentUrl"in X&&"Path"in X&&(c+=gh.ovc("MruButton"+B,X.FileName.toString(),X.Path.toString(),null,this.ZMc.PWa,this.ZMc.MGc,h,X.DocumentUrl.toString()),X.IsPinned&&v++)}c=gh.sTa("RecentDocumentsMenuSection",gh.F6h,this.lWa(2),c);r.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:a.length,["NumPinnedDocuments"]:v})}else c=
gh.tvc(this.lWa(0),this.lWa(2)),r.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return c}g$l(){let a;a=!0;let c=this.jVj;var h=this.iVj;if(c&&h||!this.AK.z0a)a=!1;else{const v=this.KAd.jj("File Open",!1);3===v.state&&(c=v.K9,h=v.w0a,a=!1)}h=h?String.format(this.lWa(4),h):null;return{returnValue:gh.TVj(this.ZMc.wvc,h,c),NVn:a}}uoi(){this.AK.p7h.UCa(this.ZMc.$Bc)}get AK(){return this.hva.value}get lWa(){return this.foa.value}get ZMc(){return this.Vdj.value}get jVj(){return this.s9i.value}get iVj(){return this.r9i.value}get KAd(){return this.TPa.value}get Cfm(){return this.Lfj.value}}
Object(w.a)(rd,"MruRenderer",null,[]);var ge=b(1370);class Me{constructor(a,c,h,v,B,X,ma){this.Iu=null;this.oEg=!1;this.Yma=this.oZ=0;this.gnj=a;this.ePb=c;this.fbd=h;this.$ic=v;this.C5a=B;this.hva=X;this.TPa=new qf.a(()=>new zh.a(ma.value,Object(m.a)(this,this.oxb,"getMoreInfoEventReceived")))}uyc(){!this.Iu&&this.Cvf.z0a?this.KAd.jj("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}oxb(a){if(!this.Iu&&3===a.state)this.Iu=a;else if(2===a.state){this.oEg?r.ULS.sendTraceTag(24904471,202,
10,"After second try GetMoreResult still fail."):(this.KAd.jj("NewDocumentFromStream",!0),this.oEg=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.oZ=(new Date).getTime();var a=this.QGk.F9g;if(null===a)this.ePb(null);else{var c=this.fbd.menuItemId,h=this.fbd.hCa,v=this.fbd.cyn,B=this.fbd.YGk;this.Yma="streamBase64"===v?B.length/1024:0;r.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.nba,this.Yma);var X=(new Date).getTime();a=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
a,F.a.ui(this.BAa),F.a.ui(c),F.a.ui(this.nba),F.a.ui(l.AFrameworkApplication.lcid.toString()),F.a.ui(X.toString()),F.a.ui(h),F.a.ui(l.AFrameworkApplication.canary),l.AFrameworkApplication.kl,F.a.ui(v));a+="&"+l.AFrameworkApplication.eCd();l.AFrameworkApplication.PXa&&(a+="&"+l.AFrameworkApplication.GAd());(c=this.Iu?this.Iu.K9:null)&&(a+="&DestinationUrl="+F.a.ui(c));this.Cvf.yNc.ai(a,2,B,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(m.a)(this,this.Bgm,"newDocumentFromStreamSuccessHandler"),
Object(m.a)(this,this.Agm,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}Bgm(a){if(a&&a.data&&a.data.qd)if(({dv:c}=z.d(a.data.qd)).returnValue)if(a=c,a.StatusCode!==Ga.a.wA&&a.StatusCode!==Ga.a.Gyc)r.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.nba,this.Yma,a.StatusCode),this.ePb(null);else if(a.NewDocumentUrl&&""!==a.NewDocumentUrl){var c=(new Date).getTime()-this.oZ;r.ULS.sendTraceTag(35156359,
202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.nba,this.Yma,c);this.gnj(a.NewDocumentUrl)}else r.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.nba,this.Yma),this.ePb(null);else r.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.nba,this.Yma,{["ResponseData"]:ge.a.YYc(a.data.qd)}),this.ePb(null);else r.ULS.sendTraceTag(24904473,
202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.nba,this.Yma),this.ePb(null)}Agm(a){a&&a.data&&r.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.nba,this.Yma,a.data.status);this.ePb(null)}get nba(){switch(this.Cvf.oLa){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get QGk(){return this.$ic.value}get BAa(){return this.C5a.value}get Cvf(){return this.hva.value}get KAd(){return this.TPa.value}}
Object(w.a)(Me,"NewDocumentFromStreamOperation",null,[]);class me{constructor(a,c,h,v){this.$ic=a;this.C5a=c;this.hva=h;this.Kfj=v}create(a,c,h){return new Me(a,c,h,this.$ic,this.C5a,this.hva,this.Kfj)}}Object(w.a)(me,"NewDocumentFromStreamOperationFactory",null,[813]);var nl=b(114);class zn{get name(){return"Common.App.NewAndOpen.UX"}yb(a){a.register(me,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").singleInstance().Pc(()=>
new me(new qf.a(()=>l.AFrameworkApplication.na.Ya.x7e()),new qf.a(()=>l.AFrameworkApplication.BAa),new qf.a(()=>a.ra("Common.INewAndOpenCommonHelpers")),new qf.a(()=>a.ra("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){l.AFrameworkApplication.K.Io(()=>{this.XWa()})}XWa(){const a=rg.a.Vp(xa.a.instance.za("Common.INewAndOpenCommonHelpers")),c=rg.a.Vp(xa.a.instance.za("Common.IEventEmitter<Common.IGetMoreInfoResult>"));l.AFrameworkApplication.BAa&&nl.Task.WAA.call(null,a,c).continueWith(()=>
{const h=new sm(new qf.a(()=>a.result),new qf.a(()=>l.AFrameworkApplication.na.Ya.x7e()),new qf.a(()=>c.result),new qf.a(()=>l.AFrameworkApplication.na.Ya.y7e().wvc||"1959943459"),new qf.a(()=>l.AFrameworkApplication.BAa),new qf.a(()=>l.AFrameworkApplication.xOl));h.eb();h.hSc()});if(l.AFrameworkApplication.XHf){const h=rg.a.Vp(xa.a.instance.za("Common.IEventEmitter<Common.IMruResult>"));nl.Task.WAA.call(null,a,c,h).continueWith(()=>{const v=new rd(new qf.a(()=>a.result),new qf.a(()=>Pk.xvm),new qf.a(()=>
l.AFrameworkApplication.na.Ya.y7e()),new qf.a(()=>l.AFrameworkApplication.wvm),new qf.a(()=>l.AFrameworkApplication.vvm),new qf.a(()=>c.result),new qf.a(()=>h.result),l.AFrameworkApplication.K);v.FTm();v.uoi()})}}dispose(){}}Object(w.a)(zn,"UXPackageManager",null,[1,2,14]);var oe=b(132);class th extends oe.StandardDialog{constructor(){super();this.yc=0;this.Nd(1,CommonUIStrings.l_DialogClose)}cR(a){this.Fw(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}zYe(a){this.Fw(a,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(w.a)(th,"ErrorDialog",oe.StandardDialog,[807]);var oj=b(405);class nf{hqh(){r.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const a=new oj.a;a.Jf("api.onedrive.com");return a.task}}Object(w.a)(nf,"OneDriveConsumerEndpointHelper",null,[770]);var Ni=b(35);class tg{constructor(a,c,h,v){this.Cob=this.EAa=null;this.oAe=this.qAe=!1;this.tPb=null;this.qa=a;this.E1c=c;this.Lnb=h;this.KE=v}get XRg(){return this.E1c}get K(){return this.qa}j_b(){this.tPb||
(this.tPb=this.X6b?nb.a.create(this.X6b,null,null,null,!1):null);return this.tPb}setup(a){this.Cob=a;this.qAe||this.oAe?this.qAe&&this.Cob&&this.Cob(!0):(a=this.j_b())?(this.oAe=!0,a.Odb.continueWith(c=>{this.mqm(c)}),Sb.a.iR(a)):(r.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Cob(!1))}kzf(a){r.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",a.exception?a.exception.toString():"No error detail.")}mqm(a){this.oAe=
!1;if(a.Gh)this.kzf(a),this.Cob(!1);else try{this.qAe=!0,r.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Bff(),r.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.Cob(!0)}catch(c){r.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",c.toString()),this.Cob(!1)}}iXc(a){this.EAa=a;this.Lnb?r.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(r.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(m.a)(this,this.txf,"onApiReady")))}txf(a){a?this.uLd():this.fo()}fo(){this.KE().cR(Ni.a.Kum)}onSuccess(a){r.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.EAa&&this.EAa(!0,a)}dispose(){this.tPb&&this.tPb.dispose()}}Object(w.a)(tg,"AOneDriveFilePickerApiManager",null,[815,14]);class Ih extends tg{constructor(a,c,h,v,B,X){super(c,h,v,X);this.wl=null;this.boa=a;this.kvj=B}get X6b(){return this.K.Ga("OneDriveApiUrl")}start(a,c){this.wl=a;
this.iXc(c)}Bff(){WL.init(1===this.XRg||2===this.XRg?{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.K.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}iXc(a){this.EAa=a;!this.Lnb&&this.boa.nIc?(r.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(m.a)(this,this.txf,"onApiReady"))):(r.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.kvj())}uLd(){try{r.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.wl).then(Object(m.a)(this,this.onSuccess,"onSuccess"),Object(m.a)(this,this.onFailure,"onFailure"))}catch(a){r.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",a,a.stack),this.fo()}}onFailure(a){if(a&&a.error){if("user_canceled"===a.error.code){r.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}r.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",a.error.code,
a.error.message)}else r.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.EAa&&this.EAa(!1,a);this.fo()}}Object(w.a)(Ih,"OneDriveFilePickerApiManagerV5",tg,[]);class Ri extends tg{constructor(a,c,h,v,B){super(a,c,h,v);this.A7c=this.hyg=null;this.hdj=B;this.options={};this.options.clientId=this.K.Ga("OneDriveApiV7ClientId");this.options.cancel=Object(m.a)(this,this.t5d,"toggleHostDivVisibility")}get X6b(){return this.K.Ga("OneDriveApiV72Url")}start(a,c){this.A7c=c;const h=
this.hdj.hqh();h.continueWith(()=>{r.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.hyg=h.result;this.iXc((v,B)=>{this.t5d();a(v,B)})},3);h.continueWith(()=>{r.ULS.sendTraceTag(24134242,352,15,h.exception.message);this.t5d()},5)}Bff(){this.options.success=a=>{const c={};c.data=a;this.onSuccess(c)};this.options.error=a=>{const c={};c.error=a;this.onFailure(c)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=
this.hyg;this.options.advanced.iframeParentDiv=this.A7c}uLd(){try{r.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.t5d(),OneDrive.open(this.options)}catch(a){r.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",a.message),this.fo()}}onFailure(a){this.EAa&&this.EAa(!1,a);this.fo()}t5d(){this.A7c.style.visibility="hidden"===this.A7c.style.visibility?"":"hidden"}}Object(w.a)(Ri,"OneDriveFilePickerApiManagerV7",tg,[]);class wi extends tg{constructor(a,
c,h,v){super(a,c,h,v);this.L7i=a;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.K.Ga("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get X6b(){return this.K.Ga("OneDriveApiV72Url")}start(a,c,h,v){this.options.advanced.iframeParentDiv=h;this.options.advanced.endpointHint=v;this.options.cancel=c;this.L7i.$("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive=
{},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.iXc(a)}iXc(a){this.EAa=a;this.Lnb?r.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(r.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(m.a)(this,this.txf,"onApiReady")))}Bff(){this.options.success=a=>{const c={};c.data=a;this.onSuccess(c)};this.options.error=a=>{const c={};c.error=a;this.onFailure(c)}}uLd(){try{r.ULS.sendTraceTag(23881879,
216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(a){r.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",a.message,a.stack),this.fo()}}kzf(a){r.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",a.exception?a.exception.toString():"No error detail.");Sb.a.gXm(this.X6b);this.tPb=null}fo(){this.KE().zYe(Ni.a.R6m)}onFailure(a){this.EAa&&this.EAa(!1,a)}}Object(w.a)(wi,"OneDriveFilePickerApiManagerV72",
tg,[]);class Ne{constructor(a){this.olsSessionId=this.value=this.key=null;this.olsSessionId=a}}Object(w.a)(Ne,"IExtraData",null,[]);class ke extends wi{constructor(a,c,h,v){super(a,c,h,v);this.options.advanced.filter=a.Ga("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=l.AFrameworkApplication.hSg;a.$("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=a.Ga("OneDriveApiV72CommandMode")||"none");a.$("OneDriveApiV72QosExtraDataEnabled")&&
(this.options.qosExtradata=new Ne(l.AFrameworkApplication.userSessionId))}get X6b(){return this.K.Ga("OneDriveApiV72Url")}uLd(){try{r.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",l.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(a){r.ULS.sendTraceTag(26071183,
352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",a.message,a.stack),this.fo()}}}Object(w.a)(ke,"OneDriveFilePickerApiOpenManagerV72",wi,[]);class tm{constructor(a){this.Zp=null;this.Qe=a;this.Jye=3}hqh(){this.Zp=new oj.a;r.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.AOf();return this.Zp.task}AOf(a=null){const c=String.format("GetMoreInfoHandler.ashx?{0}",l.AFrameworkApplication.uub);this.Qe.oTb(c,1,null,a,["PersonalFileStorageUrl",
"X-NewKey"],2,Object(m.a)(this,this.D7k,"getMoreInfoSucceeded"),Object(m.a)(this,this.B7k,"getMoreInfoFailed"),void 0,void 0,void 0,void 0,"21")}B7k(a){if(a.data.we===Ga.a.Yda&&"X-NewKey"in a.data.oj){r.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const c={};c["X-Key"]=a.data.oj["X-NewKey"];this.AOf(c)}else 0<this.Jye?(r.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",
this.Jye),this.Jye--,this.AOf()):(r.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Zp.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}D7k(a){"PersonalFileStorageUrl"in a.data.oj&&""!==a.data.oj.PersonalFileStorageUrl?(r.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Zp.Jf(a.data.oj.PersonalFileStorageUrl)):(r.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),
this.Zp.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(w.a)(tm,"OneDriveForBusinessEndpointHelper",null,[770]);var yg=b(680);class Pe{constructor(){this.W=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}yb(a){this.W=a;this.W.register(Ih,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").singleInstance().Pc(()=>new Ih(yg.a.instance,l.AFrameworkApplication.K,
l.AFrameworkApplication.kia,l.AFrameworkApplication.yra,l.AFrameworkApplication.GTf,()=>new th));l.AFrameworkApplication.y3b?this.W.register(770,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Pc(()=>new nf):this.W.register(770,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").singleInstance().Pc(()=>new tm(l.AFrameworkApplication.fe));this.W.register(Ri,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").singleInstance().Pc(()=>new Ri(l.AFrameworkApplication.K,
l.AFrameworkApplication.kia,l.AFrameworkApplication.yra,()=>new th,this.W.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.W.register(wi,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").singleInstance().Pc(()=>new wi(l.AFrameworkApplication.K,l.AFrameworkApplication.kia,l.AFrameworkApplication.yra,()=>new th));this.W.register(ke,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").singleInstance().Pc(()=>new ke(l.AFrameworkApplication.K,
l.AFrameworkApplication.kia,l.AFrameworkApplication.yra,()=>new th))}static main(){M.a.instance.Lb(new Pe)}}Object(w.a)(Pe,"PackageManager",null,[1,2]);class wd{constructor(a,c,h,v,B,X){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=a;this.WebAffinitizedUrl=c;this.PolicyCookie=h;this.PolicyCookieTTL=v;this.WasServiceDown=B;this.AffinitizedUrl=X}}Object(w.a)(wd,"SafeLinksData",null,
[]);class Wk{constructor(a,c){this.L4d=a;this.Qv=c}}Object(w.a)(Wk,"SafeLinksGetUrlReputationRequestData",null,[]);class zk{constructor(a,c,h,v){this.qa=a;this.Qe=c;this.cgj=h;zk.Zc=v}Lcc(a,c,h){try{var v=null;zk.Zc&&(v=zk.Zc.Pe("WebServiceCall","SafeLinksGetUrlReputation"));const B=new Wk(c,v);v={};v.AffinitizedUrl=a;v.TargetUrl=c;v.PolicyCookie=h;const X=z.c(v);this.Qe.ai(this.cgj,2,X,null,!1,2,Object(m.a)(this,this.lom,"onGetUrlReputationSuccessCallback"),Object(m.a)(this,this.kom,"onGetUrlReputationFailureCallback"),
B,void 0,void 0,3E3,3E3,"36");return!0}catch(B){r.ULS.sendTraceTag(588788033,378,10,B.message)}return!1}lom(a){let c="OnGetUrlReputationSuccessCallback: ",h=10;const v=a.data.state;try{const B=z.b(a.data.qd).reputationResults[0],X=B.navigateUrl.length,ma=v.L4d.length,Pa=B.navigateUrl===v.L4d;B.navigateUrl&&0<B.navigateUrl.length&&(v.L4d=B.navigateUrl);c+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",a.data.we,B.verdict,ma.toString(),
X.toString(),Pa.toString());h=50}catch(B){c+=String.format("Exception {0}",B.message)}this.DHh(v,c,h)}kom(a){let c="OnGetUrlReputationFailureCallback: ";const h=a.data.state;try{c+=String.format("HttpStatus {0}",a.data.we)}catch(v){c+=String.format("Exception {0}",v.message)}this.DHh(h,c,10)}DHh(a,c,h){a.Qv&&(a.Qv.stop(),a.Qv=null);r.ULS.sendTraceTag(588788034,378,h,c);Ve.a.Ql(a.L4d,void 0,"noopener,noreferrer","SafeLinksNav")}}zk.Zc=null;Object(w.a)(zk,"SafeLinksNavigationHelper",null,[]);var Zl;
(function(a){a[a.enabledByPolicy=0]="enabledByPolicy";a[a.disabledByPolicy=1]="disabledByPolicy";a[a.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";a[a.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(Zl||(Zl={}));Object(w.b)("SafeLinksNavigationState",Zl);class Vh{constructor(a,c,h,v=!1,B=null,X=null){this.umb=this.tmb=0;this.aJc=this.X6c=!1;this.Y5a=null;this.qOb=!0;this.Sfd=null;r.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.qa=a;this.Qe=
c;this.kkb=h;Vh.Zc=X;this.Wzj=v?this.qa.Ga("SafeLinksHandlerWebServiceBase"):this.qa.Ga("WebServiceBase");this.ozj=this.qa.Ga("SafeLinksHashedUserId");this.BZn=this.qa.Ga("SafeLinksWorkloadIdHeaderValue");this.zad=this.qa.vb("SafeLinksMaxGetPolicyBootRetries",2);this.Aad=this.qa.vb("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.p9c=this.zRl();this.o9c=this.yRl();r.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.p9c,this.o9c);if(this.p9c&&
this.o9c){c=(a=this.lZb())?a.IsSafeLinksEnabled.toLowerCase():"";h=this.Zkf();r.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",c,h);var ma=!a||"unknown"===c||a.WasServiceDown||h,Pa=ta.a.AD();Pa&&(Pa.set("shouldGetSafeLinksDataFromServer",ma.toString()),Pa.set("isSafeLinksEnabledCacheValue",c.toString()));this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksLicenseCheck",!1)&&B?(this.qOb=!1,B.execute(mb=>{mb.isFeatureEnabled("MsoUrlreputation",
!0).then(Tb=>{this.qOb=Tb;Pa.set("isUserLicensedForSafeLinks",this.qOb.toString());Fa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Pa);this.qOb&&ma&&this.YBd(!0);return null})})):(Fa.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Pa),ma&&this.YBd(!0))}}get appName(){return this.kkb}get n8d(){return this.Wzj}get userId(){return this.ozj}get cbl(){const a=this.n8d?this.n8d+"/":"",c=new Wa.QueryStringBuilder("SafeLinksHandler.ashx");c.Hd("app",this.appName);
this.qa.$("SafeLinksUseDebugHeader")&&c.Hd("action","debug");this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&c.Hd("s2satpop","1");this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&c.Hd("s2saat","1");this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&c.Hd("s2se03","1");return String.format("{0}{1}&{2}",a,c.toString(),l.AFrameworkApplication.kl)}get Hkl(){const a=this.n8d?this.n8d+
"/":"",c=new Wa.QueryStringBuilder("SafeLinksHandler.ashx");c.Hd("app",this.appName);this.qa.$("SafeLinksUseDebugHeader")&&c.Hd("action","debug");this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&c.Hd("s2satpop","1");this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&c.Hd("s2saat","1");this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&c.Hd("s2se03","1");c.Hd("slrt","GetUrlReputation");
return String.format("{0}{1}&{2}",a,c.toString(),l.AFrameworkApplication.kl)}get ggm(){Vh.qze||(Vh.qze=new zk(this.qa,this.Qe,this.Hkl,Vh.Zc));return Vh.qze}Lcc(a){if(!a)return r.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var c=this.nMl(a);r.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",c,this.p9c,this.o9c,this.qOb);if(!(c&&
this.p9c&&this.o9c&&this.qOb))return!1;c=0;const h=({state:c}=this.zpn()).returnValue;r.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",Zl[c]);const v=ta.a.AD();v&&v.set("SafeLinksNavigationState",Zl[c]);Fa.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",v);if(!h)return 2!==c&&3!==c||Fa.Health.instance.recordKpiFailure("SafeLinksNavigations",Zl[c],!1,!0,null),!1;r.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink");
if(this.Xpn())return this.Zkf()?!1:this.ggm.Lcc(this.QQk(),a,this.AAh());if(!this.Zkf())return this.xRi(a),!0;this.Y5a=a;r.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.aJc=!1;this.YBd();return!0}nMl(a){a=a.toLowerCase();const c=this.qa.bB("SafeLinksUnsupportedProtocols");if(c)for(let h=0;h<c.length;h++)if(a.startsWith(c[h]))return!1;return!0}YBd(a=!1){var c=ta.a.AD();c&&c.set("isOnBootRequest",a.toString());Fa.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",
1,"jpittsdirects",c);Fa.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",c);c=this.lTe("SafeLinksGetPolicy");this.Qe.ai(this.cbl,1,null,null,!0,2,Object(m.a)(this,this.tel,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(m.a)(this,this.sel,"getSafeLinksDataFromServer_OnFailureCallback"),c,void 0,void 0,void 0,void 0,"23");this.aJc=a;this.X6c=!0;a?this.tmb++:this.umb++}tel(a){let c=Ga.a.Jhm,h="";try{this.X6c=this.aJc=!1;var v=a.data.state;const vd=({Qv:v}=this.w3d(v)).returnValue,
ee=Object.assign(new pb.a,{durationMs:vd});Fa.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",ee);r.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",a.data.we,a.data.qd.length,vd);if(a.data.we!==Ga.a.wA)h="Unexpected httpStatus: "+a.data.we.toString();else{v=null;try{v=z.b(a.data.qd)}catch(Ie){h="Exception:"+Ie.toString()+" deserializing response";return}if(v){var B=v.IsSafeLinksEnabled;if(void 0===
B||null===B||0>=B.length)h="Invalid isSafeLinksEnabledString";else{r.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",B);var X=Vh.SCf(B);if(void 0===v.WebAffinitizedUrl||null===v.WebAffinitizedUrl||0>=v.WebAffinitizedUrl.length)h="Invalid WebAffinitizedUrl";else if(void 0===v.PolicyCookie||null===v.PolicyCookie||0>=v.PolicyCookie.length)h="Invalid PolicyCookie";else if(void 0===v.PolicyCookieTTL||null===v.PolicyCookieTTL)h="Invalid PolicyCookieTTL";else{var ma=v.WebAffinitizedUrl,
Pa=v.PolicyCookie,mb=v.AffinitizedUrl,Tb=new Date;Tb.setMinutes(Tb.getMinutes()+(5<v.PolicyCookieTTL?v.PolicyCookieTTL-5:0));var rc=Tb.getTime(),Tc=new wd(B,ma,Pa,rc,!1,mb);this.nAi(Tc);c=a.data.we;this.Y5a&&(X?(this.xRi(this.Y5a),this.umb=this.tmb=0):(r.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),Fa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Ve.a.lwb(this.Y5a)),this.Y5a=null)}}}else h="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(vd){h=
"GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+vd.toString()}finally{c!==Ga.a.wA&&this.CHh(c,h)}}sel(a){this.X6c=!1;let c=500,h="";try{let v=a.data.state;const B=({Qv:v}=this.w3d(v)).returnValue,X=Object.assign(new pb.a,{durationMs:B});c=a.data.we;Fa.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+c.toString(),!1,!0,X);h="Request Failed, Status="+Cl.a[a.data.status]+" Duration: "+B}catch(v){h="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+
v.toString()}finally{this.CHh(c,h)}}CHh(a,c=""){try{if(r.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",a,c),this.tmb<this.zad&&this.umb<this.Aad)this.YBd(this.aJc);else{this.aJc=!1;r.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this.tmb,this.umb,a,c);c=null;const h=ta.a.AD();h&&(h.set("HttpStatus",a.toString()),c=Object.assign(new pb.a,{extendedProperties:h}));
Fa.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,c);const v=new wd("false","","",0,!0,"");this.nAi(v);this.Y5a&&(r.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),Fa.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),Ve.a.lwb(this.Y5a),this.Y5a=null)}}catch(h){r.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",
h.toString())}}xRi(a){const c=this.AAh(),h=this.Oll(),v={};v.Url=a;v.SafeLinksCookie=c;v.CorrelationId=Ya.a.create().toString();v.WorkloadId=this.BZn;v.UserAgentInfo=H.a.wD+"|"+this.appName;r.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",v.CorrelationId);Ve.a.qEf(Ve.a.bma(4),h,v)}zRl(){const a=this.qa.Ga("IsSafeLinksEnabledForUser");return a?Vh.SCf(a):!1}yRl(){const a=this.qa.bB("SafeLinksDisabledBrowsers");if(H.a.o4){if(this.qa.hF("SafeLinksForTeamsIsEnabled")&&
this.qa.$("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(a,"Electron"))return!1}else if(Array.contains(a,H.a.wD))return!1;return"officecomhwa"===(this.qa.Ga(l.AFrameworkApplication.Wea)||"").toLowerCase()?!1:!0}Xpn(){return-1!==window.location.href.indexOf("&wd_slnh=1")?!0:H.a.o4}zpn(){let a;a=0;const c=this.lZb(),h=c?c.IsSafeLinksEnabled:"";if(""!==h)return c.WasServiceDown?(r.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===h.toLowerCase()?
(r.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:Vh.SCf(h),state:a};if(this.X6c)return a=3,r.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:a};if(this.tmb>=this.zad||this.umb>=this.Aad)return a=2,r.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.tmb,this.zad,this.umb,this.Aad),{returnValue:!1,state:a};r.ULS.sendTraceTag(23900182,
378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.zad+this.Aad-(this.tmb+this.umb));return{returnValue:!0,state:a}}AAh(){const a=this.lZb();return a?a.PolicyCookie:""}Oll(){const a=this.lZb();return a?a.WebAffinitizedUrl:""}QQk(){const a=this.lZb();return a?a.AffinitizedUrl:""}B_k(){const a=new Date;try{const c=this.lZb();a.setTime(c?c.PolicyCookieTTL:0)}catch(c){r.ULS.sendTraceTag(24462658,
378,10,"Exception occured while fetching expiration time from cache: {0}",c)}return a}Zkf(){const a=this.B_k();return!!a&&a.getTime()<Date.now()}lZb(){if(!this.Sfd){const a=Va.a.instance.getItem(this.userId);if(!a||""===a)return null;this.Sfd=JSON.parse(a)}return this.Sfd}nAi(a){if(void 0===a||null===a)throw Error.argumentNull("safeLinksData");if(void 0===a.IsSafeLinksEnabled||null===a.IsSafeLinksEnabled||0>=a.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");
this.Sfd=a;a.WasServiceDown||this.QZn(a)}QZn(a){a=JSON.stringify(a);Va.a.instance.setItem(this.userId,a)}lTe(a){return void 0!==Vh.Zc&&null!==Vh.Zc?Vh.Zc.Pe("WebServiceCall",a):null}w3d(a){if(void 0!==a&&null!==a){const c=a.Yg;a.stop();return{returnValue:c,Qv:null}}return{returnValue:null,Qv:a}}static SCf(a){return"false"!==a.toLowerCase()?!0:!1}}Vh.Zc=null;Vh.qze=null;Object(w.a)(Vh,"SafeLinksManager",null,[773]);const wl=a=>{switch(a){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";
case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}},Dg=a=>{switch(a){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};class fc{constructor(){this.W=null}get name(){return"Common.App.SafeLinks"}yb(a){this.W=a}init(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.Io(Object(m.a)(this,this.Mv,"onFullAppSettingsReady"))}dispose(){}Mv(){l.AFrameworkApplication.K.$("WACSafeLinksIsEnabled")&&(this.W.register(Vh,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").singleInstance().Pc(()=>
new Vh(l.AFrameworkApplication.K,l.AFrameworkApplication.fe,String.format("{0}-{1}",wl(l.AFrameworkApplication.na.Ya.Rm),Dg(l.AFrameworkApplication.na.Ya.yda)),!1,this.W.za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),l.AFrameworkApplication.na.Qo)),this.W.ra("Common.App.SafeLinks.ISafeLinksManager"))}static main(){M.a.instance.Lb(new fc)}}Object(w.a)(fc,"SafeLinksPackage",null,[1,2]);var xj=b(173);class ng{constructor(a){this.ma=new Rd.a;this.xg=a}R7a(a){this.ma.addHandler(ng.Ssa,
a)}aTc(a){this.ma.removeHandler(ng.Ssa,a)}S7a(a){this.ma.addHandler(ng.RNa,a)}X8b(a){this.ma.removeHandler(ng.RNa,a)}JIe(a){this.ma.addHandler(ng.lcc,a)}cTf(){this.ma.raiseEvent(ng.Ssa)}gdf(){return xj.a.instance.vKa(l.AFrameworkApplication.Uw)}}ng.Ssa="SE";ng.TUc="SEP";ng.RNa="SER";ng.lcc="TRP";Object(w.a)(ng,"NullSessionExpirationManager",null,[715,716]);class Cf{constructor(){this.crc=this.hqb=!1;const a=l.AFrameworkApplication.Uw;0>=a||(this.Uw=a,r.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",
{["AccessTokenTtl"]:this.Uw,["NowGetTime"]:(new Date).getTime(),["BootTime"]:l.AFrameworkApplication.nU}),xj.a.instance.wQg(Object(m.a)(this,this.P6b,"onSessionExpiredDetected")),xj.a.instance.vQg(Object(m.a)(this,this.$Rd,"onSessionExpiringDetected")))}P6b(){xj.a.instance.dsi(Object(m.a)(this,this.P6b,"onSessionExpiredDetected"));r.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.Dcf()}$Rd(){xj.a.instance.QYm(Object(m.a)(this,this.$Rd,"onSessionExpiringDetected"));this.crc||this.hqb||
(r.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.crc=!0,this.HTf())}Dcf(){this.hqb||(l.AFrameworkApplication.kP(Ni.a.OFb),this.hqb=!0,this.u2d())}}Object(w.a)(Cf,"ASessionExpirationManager",null,[]);var gg=b(151),pf=b(430);class $k{constructor(a,c,h,v){this.VXf="";this.Z0c=a;this.bFg=h;this.YEg=v;this.Oog=c;a=(new Date(this.Z0c)).format(l.AFrameworkApplication.sFi);this.VXf=this.Oog?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,
a)}q$b(a){1===a?this.bFg&&this.bFg(this.Oog):0===a&&l.AFrameworkApplication.pa.hb(Sa.a.close,2,pf.g)}dispose(){this.YEg&&this.YEg()}}$k.id="SessionExpirationDialog";Object(w.a)($k,"SessionExpirationDialogSharedProperties",null,[]);class ol{}ol.vf="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(w.a)(ol,"SessionExpirationDialogHtml",null,[]);class Tg extends gg.a{constructor(a,c,h,v){super(c);
const B={};this.TRa=new $k(a,c,h,v);this.jf=$k.id;l.AFrameworkApplication.j_g?(this.yc=1,this.Nd(0,CommonUIStrings.l_DialogClose)):(this.yc=0,this.Zr=!1);c||1===l.AFrameworkApplication.na.mode?this.Nd(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Nd(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.vf=ol.vf;B.WACSessionExpirationText=this.TRa.VXf;this.Tg(CommonUIStrings.l_DefaultDialogTitle,Object(m.a)(this,this.q$b,"sessionExpirationDialogHandler"),B);this.n5(this.hi("WACSessionExpirationText"))}q$b(a){this.TRa.q$b(a)}xdf(){this.hide()}dispose(){super.dispose();
this.TRa&&this.TRa.dispose()}}Object(w.a)(Tg,"LegacySessionExpirationDialog",gg.a,[809]);class xd extends oe.StandardDialog{constructor(a,c,h,v){super(c);this.TRa=new $k(a,c,h,v);this.jf=$k.id;l.AFrameworkApplication.j_g?(this.yc=1,this.Nd(0,CommonUIStrings.l_DialogClose)):(this.yc=0,this.Zr=!1);c||1===l.AFrameworkApplication.na.mode?this.Nd(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Nd(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.mv(CommonUIStrings.l_DefaultDialogTitle,
this.TRa.VXf,0,Object(m.a)(this,this.q$b,"sessionExpirationDialogHandler"))}q$b(a){this.TRa.q$b(a)}xdf(){this.hide()}dispose(){super.dispose();this.TRa&&this.TRa.dispose()}}Object(w.a)(xd,"SessionExpirationDialog",oe.StandardDialog,[809]);const Si=(a,c,h,v)=>l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.fA&&l.AFrameworkApplication.K.$("ReactStandardSessionExpirationDialogIsEnabled")?new xd(a,c,h,v):new Tg(a,c,h,v);var Sj=b(147);class Re extends Cf{constructor(a){super();this.tgd=this.kRb=
!0;this.KW=null;this.ma=new Rd.a;this.xg=a}R7a(a){this.ma.addHandler(Re.Ssa,a)}aTc(a){this.ma.removeHandler(Re.Ssa,a)}S7a(a){this.ma.addHandler(Re.RNa,a)}X8b(a){this.ma.removeHandler(Re.RNa,a)}JIe(a){this.ma.addHandler(Re.lcc,a)}gdf(){return xj.a.instance.vKa(l.AFrameworkApplication.Uw)}cTf(a){this.kRb=a}HTf(){if(!this.KW&&!Sj.a.MJ){if(this.tgd){const a=Object(m.a)(this,this.tXb,"disposeCallback");this.KW=Si(this.Uw,!1,Object(m.a)(this,this.r$b,"sessionExpirationHandler"),a)}this.ma.raiseEvent(Re.TUc)}}u2d(){this.KW&&
(this.KW.bAa&&this.KW.xdf(),this.KW=null);if(this.kRb){const a=Object(m.a)(this,this.tXb,"disposeCallback");this.KW=Si(this.Uw,!0,Object(m.a)(this,this.r$b,"sessionExpirationHandler"),a)}this.ma.raiseEvent(Re.Ssa)}tXb(){this.KW=null}r$b(a){(a||this.xg.Vuc())&&this.xg.refreshDocument(null)}}Re.Ssa="SE";Re.TUc="SEP";Re.RNa="SER";Re.lcc="TRP";Object(w.a)(Re,"SessionExpirationManager",Cf,[715,716]);class Ae{}Ae.zAj="Aborting";Ae.wkd="ActivityDuration";Ae.error="Error";Ae.lDk="Errors";Ae.failed="Failed";
Ae.dwb="FirstActivity";Ae.initialized="Initialized";Ae.kickedOut="KickedOut";Ae.$Wl="LastActivity";Ae.p4m="RetryOverride";Ae.QYd="RequestGroups";Ae.j_a="Requests";Ae.bZd="Responses";Ae.C_d="SessionDuration";Ae.status="Status";Ae.success="Success";Ae.Gyn="Successful";Ae.B$="Tokens";Ae.QDf="PollingDuration";Object(w.a)(Ae,"SessionExpirationStrings",null,[]);class Ml{constructor(a){this.Dz={};this.qfa={};this.b6a={};this.b1h=15;this.Kqg=!1;this.Wtj=new Date;this.y$c=new Date;this.Ta=a;this.JL=new Se.a(2,
2,6E4*this.b1h,Object(m.a)(this,this.e_i,"writeMeasures"),135,"SL",!1);this.Ta.ub(this.JL);this.XAl()}e_i(){r.ULS.sendTraceTag(41964821,217,50,r.ULS.aLc({["Aggregate"]:this.qfa,["Current"]:this.Dz}))}XAl(){this.qfa[Ae.QYd]=0;this.qfa[Ae.j_a]=0;this.qfa[Ae.bZd]=0;this.qfa[Ae.status]=Ae.initialized;this.qfa[Ae.dwb]=new Date;this.qfa[Ae.C_d]=0;this.qfa[Ae.wkd]=0;this.qfa[Ae.C_d]=0;this.Dz[Ae.C_d]=0;this.qfa[Ae.wkd]=0;this.Dz[Ae.wkd]=0}get JBm(){this.b6a[Ae.QDf]=+new Date-+this.b6a[Ae.dwb];return this.b6a}iff(a,
c){var h=a[c];h=h?h:0;h++;a[c]=h;this.gQf(a)}gQf(a){const c=new Date;a[Ae.wkd]=+c-+this.y$c;this.y$c=c;a[Ae.C_d]=+this.y$c-+this.Wtj;a[Ae.$Wl]=this.y$c}YMa(a,c){this.Dz[a]=c;this.gQf(this.Dz)}KAi(a,c){this.Dz[a]=c;this.gQf(this.Dz)}k1b(a){this.iff(this.Dz,a);this.iff(this.qfa,a);this.iff(this.b6a,a)}flush(){this.Kqg||(this.qfa[Ae.status]=this.Dz[Ae.status],this.e_i(this.JL),this.Ta.d5(this.JL,6E4*this.b1h))}T1m(){const a=this.Dz[Ae.status];a&&(this.qfa[Ae.status]=a);this.Dz={}}i2m(){this.b6a={};this.b6a[Ae.QDf]=
0;this.b6a[Ae.dwb]=new Date}stop(){r.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.Kqg=!0;this.Ta.me(this.JL)}}Object(w.a)(Ml,"SessionLogger",null,[711]);class mh{constructor(a,c){this.qid=a;this.X3a=c}get B$(){return this.qid}get errors(){return this.X3a}}Object(w.a)(mh,"TokenRefreshArgs",null,[777]);var ya=b(354);class Ab extends Sys.EventArgs{constructor(a,c,h,v,B,X,ma){super();this.b6a=a;this.Zhi=c;this.QYd=v;this.failed=B;this.j_a=X;this.bZd=ma}}
Object(w.a)(Ab,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);class Vb{constructor(a,c=null,h=null){this.crc=this.hqb=!1;this.tgd=this.kRb=!0;this.ma=new Rd.a;this.erc=this.B$c=this.jed=!1;this.ipb=null;this.vAg=10;this.S9c=!1;this.PDe=a;this.spe=l.AFrameworkApplication.qVl;this.Ta=ag.a.instance;r.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:l.AFrameworkApplication.Uw,["NowGetTime"]:(new Date).getTime(),["BootTime"]:l.AFrameworkApplication.nU});
this.Qc=c||new Ml(ag.a.instance);this.Jga=h;xj.a.instance.wQg(Object(m.a)(this,this.uAj,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));xj.a.instance.vQg(Object(m.a)(this,this.VLg,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));ya.SessionStatusManager.instance.MIj(Object(m.a)(this,this.VLg,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));ya.SessionStatusManager.instance.lJj(Object(m.a)(this,this.lDm,"preemptiveTokenRefresh"));this.fsg=new Date;l.AFrameworkApplication.pVl&&
(xj.a.instance.IOe=Object(m.a)(this,this.kQm,"refreshAccessTokenWhenSessionExpired"));l.AFrameworkApplication.K&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.vAg=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1))}R7a(a){this.ma.addHandler(Vb.Ssa,a)}aTc(a){this.ma.removeHandler(Vb.Ssa,
a)}S7a(a){this.ma.addHandler(Vb.RNa,a)}X8b(a){this.ma.removeHandler(Vb.RNa,a)}JIe(a){this.ma.addHandler(Vb.lcc,a)}gdf(){return xj.a.instance.vKa(l.AFrameworkApplication.Uw)}kQm(){this.FEd(!1);return!xj.a.instance.vKa(l.AFrameworkApplication.Uw)}uAj(a,c){xj.a.instance.hKd?this.P6b(a,c):this.spe?(this.B$c=!1,this.FEd(!1)):this.P6b(a,c)}VLg(a,c){xj.a.instance.Qlf?this.$Rd(a,c):this.FEd(!0)}FEd(a){if(!this.jed&&!this.B$c)if(this.Jga&&this.Jga.Kn)this.erc=!0,this.Qc.YMa(Ae.status,Ae.kickedOut),this.Qc.flush(),
this.Qc.stop();else if(r.ULS.sendTraceTag(40420955,217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",a,this.erc),this.erc)this.u2d();else{this.Qc.flush();this.Qc.T1m();this.Qc.k1b(Ae.QYd);this.jed=!0;this.S9c||(this.Qc.i2m(),this.S9c=!0,this.Ufk());const c=this.PDe.AQm(a);c.continueWith(()=>{if(this.PDe.dHm(c))this.Qc.k1b(Ae.Gyn),this.Qc.YMa(Ae.status,Ae.success),this.tgd=!1,this.spe&&(this.kRb=!1),this.B$c=!1,this.fsg=new Date,this.Kxn(),this.ma.raiseEvent(Vb.RNa,new mh(c.result.B$,null));
else{const h=c.result.errors;this.Qc.k1b(Ae.failed);this.Qc.YMa(Ae.status,Ae.failed);a||(this.erc=this.PDe.GJd(h));this.erc&&this.Qc.YMa(Ae.zAj,JSON.stringify(h));this.B$c=!0;this.ma.raiseEvent(Vb.RNa,new mh(null,h))}this.Qc.flush();this.jed=!1})}}P6b(){this.spe||xj.a.instance.dsi(Object(m.a)(this,this.P6b,"onSessionExpiredDetected"));r.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.Dcf(xj.a.instance.hKd)}$Rd(){this.crc||this.hqb||(r.ULS.sendTraceTag(39408095,217,50,"SessionExpiringDetected - Showing expiring dialog."),
this.crc=!0,this.HTf(xj.a.instance.Qlf))}Dcf(a){if(!this.hqb){var c=a?Ni.a.gbn:Ni.a.OFb;const h=Object.assign(new pb.a,{extendedProperties:new Map});h.extendedProperties.set("ErrorCode",String.format("{0}",c));l.AFrameworkApplication.kP(c,void 0,["SessionExpired"],h);a||(a=new Date,c=new Date(l.AFrameworkApplication.nU),r.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",c,a,+a-+c),864E5>+a-+c&&Fa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",
["SessionExpired"],!0,!0,!1,!0,h),2592E5>+a-+c&&Fa.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,h));this.hqb=!0;this.u2d()}}Kxn(){this.S9c&&(this.Ta.me(this.ipb),this.S9c=!1)}Ufk(){this.ipb=new Se.a(2,2,1E3*this.vAg,Object(m.a)(this,this.yEn,"tokenRefreshPolling"),135);this.Ta.ub(this.ipb)}yEn(){const a=this.Qc.JBm;r.ULS.sendTraceTag(555255521,217,50,"{0}",z.c(a));this.ma.raiseEvent(Vb.lcc,new Ab(a,a[Ae.QDf],a[Ae.dwb],a[Ae.QYd],a[Ae.failed],
a[Ae.j_a],a[Ae.bZd]))}lDm(){3E5<+new Date-+this.fsg?(r.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.FEd(!1)):r.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}Vb.Ssa="SE";Vb.TUc="SEP";Vb.RNa="SER";Vb.lcc="TRP";Object(w.a)(Vb,"ASessionExpirationManagerWithRefresh",null,[]);class oc extends Vb{constructor(a,c,h=null,v=null){super(c,h,v);this.KW=null;this.xg=a}cTf(a){this.kRb=a}HTf(a){if(!this.KW&&!Sj.a.MJ){if(a){var c=
Object(m.a)(this,this.tXb,"disposeCallback");this.KW=Si(l.AFrameworkApplication.Hgb,!1,Object(m.a)(this,this.r$b,"sessionExpirationHandler"),c)}else if(this.tgd){if(this.jed)return;c=Object(m.a)(this,this.tXb,"disposeCallback");this.KW=Si(l.AFrameworkApplication.Uw,!1,Object(m.a)(this,this.r$b,"sessionExpirationHandler"),c)}r.ULS.sendTraceTag(39408096,217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",Vb.TUc,a);this.ma.raiseEvent(Vb.TUc)}}u2d(){this.KW&&(this.KW.bAa&&this.KW.xdf(),this.KW=null);
if(this.kRb){this.Qc.stop();if(this.Jga&&this.Jga.Kn)return;const a=Object(m.a)(this,this.tXb,"disposeCallback");this.KW=Si(l.AFrameworkApplication.Uw,!0,Object(m.a)(this,this.r$b,"sessionExpirationHandler"),a)}r.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",Vb.Ssa);this.ma.raiseEvent(Vb.Ssa)}tXb(){this.KW=null}r$b(a){(a||this.xg.Vuc())&&this.xg.refreshDocument(null)}}Object(w.a)(oc,"SessionExpirationManagerWithRefresh",Vb,[715,716]);class Wc{constructor(a,c,h=null,v=null){this.qKg=!1;this._instance=
null;this._frame=a;this.Tl=c;this.Qc=h||new Ml(ag.a.instance);this.Jga=v}create(){this.qKg=l.AFrameworkApplication.fYa;if(!this.qKg)return new Re(this._frame);l.AFrameworkApplication.Bh("WOPITokenRefreshIsEnabled");r.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this._instance)switch(l.AFrameworkApplication.uWn){case 1:r.ULS.sendTraceTag(39408090,217,50,"Creating new NullSessionExpirationManager");this._instance=new ng(this._frame);break;case 2:r.ULS.sendTraceTag(39408091,
217,50,"Creating new SessionExpirationManagerWithRefresh");this._instance=new oc(this._frame,this.Tl,this.Qc,this.Jga);break;default:r.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this._instance=new Re(this._frame)}r.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this._instance).getName());return this._instance}}Object(w.a)(Wc,"SessionExpirationManagerFactory",null,[714]);class cd{}Object(w.a)(cd,"Error",
null,[]);class yd{}Object(w.a)(yd,"NamedResult",null,[]);class sc extends yd{}Object(w.a)(sc,"ErrorInfo",yd,[]);var Xd=b(939),Sd=b(27);class wf{constructor(a,c,h,v=null,B=!1,X=null,ma=!1){this.DRa=0;this.n7a=this.Jm=null;this.qid=new Ua.a;this.X3a=new Ua.a;this.Zp=null;this.rpe=!1;this.Ta=a;this.AAg=c;this.AAg.execute(Pa=>{Pa.pA(E.a.bef,Object(m.a)(this,this.zom,"onHostResponseReceived"))});this.PFa=h;this.$Ig=new Xd.a("WebServiceCall","TokenRefresh");this.Qc=v||new Ml(a);this.Qtj=B;this.Ve=X?X:ya.SessionStatusManager.instance;
this.Ygg=ma}zom(a){if(a.MessageId!==E.a.bef)Sd.b(39408099,306,15,"Unexpected message.");else{var c=new Ua.a,h=new Ua.a;this.Qc.k1b(Ae.bZd);var v=a.Values[L.a.Pzi];if(!v||0>=v.length)Sd.b(40122317,306,15,"Found no tokens in the dictionary"),v=a.Values;Sd.b(40122318,306,100,"The Tokens array contains {0} tokens",v.length);this.Qc.YMa("Correlation",a.CorrelationId);var B="";for(let Pa=0;Pa<v.length;Pa++){this.Qc.KAi(Ae.B$,v.length);var X=v[Pa],ma=X;if(!ma||!ma.Name)continue;this.Qc.k1b(ma.Name);const mb=
X;if(mb&&mb.Value)Sd.b(39408128,306,100,"Received token with name: {0}",mb.Name),c.add(mb),this.qid.add(mb),this.Qc.YMa(Ae.status,Ae.success),this.Ygg&&this.Ve&&this.Ve.z2m();else if(X=this.Gel(X),Sd.b(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",ma.Name,JSON.stringify(X),this.n7a),h.add(X),this.X3a.add(X),B=JSON.stringify(X),this.Qc.YMa(Ae.error,JSON.stringify(X)),this.Qc.YMa(Ae.status,Ae.failed),this.Ygg)for(const Tb of X.Errors)ma=this.q_k(Tb),this.Ve&&
this.Ve.BGj(ma)}0<h.count&&""!==B?(v=Object.assign(new pb.a,{extendedProperties:new Map}),v.extendedProperties.set("Errors",B),Fa.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,v)):Fa.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Sd.b(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",c.count,h.count,a.CorrelationId,this.n7a);0<h.count&&!this.GJd(h)?(a=this.PFa.xdl(h),a!==this.PFa.EMf&&(this.Qc.KAi(Ae.p4m,
a),this.Ta.d5(this.Jm,a))):(this.Qc.flush(),this.Jm&&(Sd.b(39408131,306,100,"Deleting task {0} from task manager",this.Jm.name),this.Ta.me(this.Jm)),this.Zp&&!this.Zp.task.isCompleted&&this.Zp.Jf(new mh(c,h)))}}Gel(a){if(!a)return null;const c=Object.assign(new sc,{Name:a.Name,Errors:[]});for(const h of a.Errors)a=new cd,a.Id=h.Id,a.Details=this.Fel(h.Details),c.Errors.push(a);return c}Fel(a){if(!a)return"";const c=a.toLowerCase();return 0<c.indexOf("<!doctype")?this.u$e("Seems to contain HTML - Contains <!DOCTYPE"):
0<c.indexOf("<html")?this.u$e("Seems to contain HTML - Contains <html>"):500<c.length?this.u$e(String.format("Error details content too long: Length: {0}",c.length)):a}u$e(a){return String.format("{0} - Reason: [{1}]","### REDACTED ###",a)}requestTokensOnce(){this.Yti()}Yti(){l.AFrameworkApplication.Mg("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.DRa>=this.PFa.Arf?(Sd.b(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.n7a),this.Ihk(this.Zp)):
(Fa.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.d$m())}d$m(){const a={};a[L.a.Pzi]=this.PFa.B$;const c=Ya.a.create().toString();Sd.b(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.PFa.B$),this.DRa+1,c,this.n7a);this.AAg.execute(h=>{h.Qg(E.a.XJe,a,c)});this.DRa++;this.Qc.k1b(Ae.j_a)}Ihk(a){const c=new Ua.a;for(let h=0;h<this.PFa.B$.length;h++){const v=Object.assign(new sc,{Name:this.PFa.B$[h],Errors:[Object.assign(new cd,
{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});c.add(v);this.X3a.add(v)}this.Ta.me(this.Jm);this.Qc.YMa(Ae.lDk,JSON.stringify(this.X3a));this.Qc.YMa(Ae.status,Ae.failed);a&&!a.task.isCompleted&&a.Jf(new mh(new Ua.a,this.X3a))}AQm(a){this.$Ig.start();this.rpe=a;this.n7a=Ya.a.create().toString();Sd.b(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.n7a,this.rpe);this.DRa=0;this.X3a.clear();
this.qid.clear();this.Zp=new oj.a;this.Jm=new Se.a(this.PFa.priority,2,this.PFa.EMf,Object(m.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,E.a.XJe,!0);this.Qtj&&this.Yti();this.Ta.ub(this.Jm);return this.Zp.task}dHm(a){this.$Ig.stop();const c=this.ysl(a.result.errors);r.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!c,this.n7a,
this.rpe,this.DRa,this.X3a.count,0<a.result.errors.count?a.result.errors.J(0).Name:"",0<a.result.errors.count&&0<a.result.errors.J(0).Errors.length?a.result.errors.J(0).Errors[0].Id:"",0<a.result.errors.count&&0<a.result.errors.J(0).Errors.length?a.result.errors.J(0).Errors[0].Details:"");return c?!1:this.cHm(a.result.B$)}GJd(a){return this.PFa.GJd(a)}cHm(a){for(let c=0;c<a.count;c++){const h=a.J(c);if(h.Name===L.a.accessToken){const v=(new Date).getTime();h.Expiry>l.AFrameworkApplication.Uw?(r.ULS.sendTraceTag(39706827,
217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:h.Expiry,["NowGetTime"]:v,["BootTime"]:l.AFrameworkApplication.nU},"PreviousAccessTokenTtl",l.AFrameworkApplication.Uw),l.AFrameworkApplication.accessToken=h.Value,l.AFrameworkApplication.Uw=Math.floor(h.Expiry),l.AFrameworkApplication.x2f=v,l.AFrameworkApplication.IGa=Math.floor(h.Expiry)):r.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:h.Expiry,["NowGetTime"]:v,
["BootTime"]:l.AFrameworkApplication.nU},"PreviousAccessTokenTtl",l.AFrameworkApplication.Uw)}}return!0}ysl(a){let c=!1;for(let h=0;h<a.count;h++){c=!0;const v=a.J(h);r.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",v.Name,JSON.stringify(v.Errors),this.n7a)}return c}q_k(a){let c=Ni.a.OFb;a=parseInt(a.Id);if(isNaN(a))c=Ni.a.iZi;else{switch(a){case 401:c=Ni.a.y2f;break;case 403:c=Ni.a.gZi;break;case 500:c=Ni.a.hZi;break;case 503:c=Ni.a.kZi}c===Ni.a.OFb&&(c=
500<a?Ni.a.jZi:Ni.a.fZi)}return c}}Object(w.a)(wf,"TokenRefreshManager",null,[713]);class Xi{constructor(){this.EMf=l.AFrameworkApplication.z2f;this.Arf=l.AFrameworkApplication.vWn;this.B$=l.AFrameworkApplication.Tml();this.priority=l.AFrameworkApplication.xWn;this.bDg=this.cin();this.YFe=l.AFrameworkApplication.Sml();this.Ooe=!1;this.gDg=l.AFrameworkApplication.z2f;l.AFrameworkApplication.K&&(this.Ooe=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorIsEnabled",
!1))&&(this.gDg=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorMilliseconds",l.AFrameworkApplication.z2f))}GJd(a){const c=JSON.stringify(a);if(this.YFe&&0<this.YFe.length)for(const h of this.YFe)if(0<h.length&&0<=c.indexOf(h))return!0;if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StopTokenRefreshOn403",!1))for(let h of a)if(h.Errors)for(const v of h.Errors)if(v&&"403"===v.Id)return!0;return!1}xdl(a){try{if(a)for(let c of a)if(c.Errors)for(const h of c.Errors){if(h.Id in
this.bDg)return Number.parseInvariant(this.bDg[h.Id].toString());if(this.Ooe)try{if(500<=Number.parseInvariant(h.Id))return l.AFrameworkApplication.Mg("RetryIntervalOverrideOnServerError;RetryIntervalOverrideOnServerErrorcf"),this.gDg}catch(v){r.ULS.sendTraceTag(540541017,217,50,"Unable to parse Error id to int. Exception {0}, ErrorId: {1}",v.toString(),h.Id)}}}catch(c){r.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",c.toString())}return this.EMf}cin(){const a=
{};try{if(!l.AFrameworkApplication.$Cd()||0>=l.AFrameworkApplication.$Cd().length||""===l.AFrameworkApplication.$Cd()[0])return a;for(const c of l.AFrameworkApplication.$Cd())0<c.length&&(a[c]=l.AFrameworkApplication.wWn)}catch(c){r.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",c.toString())}return a}}Object(w.a)(Xi,"TokenRefreshPolicy",null,[712]);class Ak{constructor(){this.W=null}get name(){return"Common.App.SessionExpiration"}init(){l.AFrameworkApplication.K.Io(()=>
{this.XWa()})}XWa(){this.W.resolve("Common.ISessionExpirationManagerFactory");this.W.resolve("Common.ISessionExpirationManager");this.W.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}yb(a){this.W=a;a.register(711,"Common.App.SessionExpiration.ISessionLogger").singleInstance().Pc(()=>new Ml(ag.a.instance));a.register(712,"Common.App.SessionExpiration.ITokenRefreshPolicy").singleInstance().Pc(()=>new Xi);a.register(713,"Common.App.SessionExpiration.ITokenRefreshManager").singleInstance().Pc(()=>
new wf(ag.a.instance,l.AFrameworkApplication.uO(),a.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),a.resolve("Common.App.SessionExpiration.ISessionLogger"),l.AFrameworkApplication.K.$("WopiTokenRefreshSendTokenRequestWithoutTasks"),a.ra("Common.ISessionStatus"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1)));a.register(714,"Common.ISessionExpirationManagerFactory").singleInstance().Pc(()=>new Wc(l.AFrameworkApplication.na,
a.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),a.resolve("Common.App.SessionExpiration.ISessionLogger"),a.ra("Common.ISessionStatus")));a.register(715,"Common.ISessionExpirationManagerWithDialog").singleInstance().Pc(()=>a.resolve("Common.ISessionExpirationManagerFactory").create());a.register(716,"Common.ISessionExpirationManager").singleInstance().Pc(()=>a.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){M.a.instance.Lb(new Ak)}}Object(w.a)(Ak,"SessionExpirationPackage",
null,[1,2]);var ph=b(683),Ah=b(410),Hg=b(335),qh=b(198);class xi extends qh.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(w.a)(xi,"PersonaButtonProps",qh.a,[]);class wa{AWb(a,c){if(a&&!(1>a.length)&&c){var h=Object.assign(new Hg.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.Whk(a,h.ControlList);c.push(h)}}Whk(a,c){const h=Object.assign(new ph.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,
Menu:Object.assign(new Ah.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(c,h);c=Object.assign(new Hg.a,{Title:"",ControlList:[]});Array.add(h.Menu.MenuSectionList,c);this.Hkk(a,c.ControlList)}Hkk(a,c){for(let h=0;h<a.length;h++){const v=Object.assign(new xi,{ExternalId:String.format("CoauthorPersona_{0}",h),Command:"336231556",DisplayName:a[h].userName,LabelText:a[h].userName,ImageBackColor:a[h].color,PersonaId:a[h].email,IsAnonymous:a[h].isAnonymous});
Array.add(c,v)}}}Object(w.a)(wa,"PresenceContextMenuSectionBuilder",null,[749]);var kb=b(72);class Pb{constructor(a,c,h,v){this.tma=this.Pq=this.Jm=this.rd=this.zDa=null;this.ygd=a;this.hvj=v;this.ygd.nIc&&(this.Jm=new Se.a(3,2,5E3,Object(m.a)(this,this.CRj,"authenticationCheckTask"),2),l.AFrameworkApplication.Cb.ub(this.Jm),this.eb(c,h));this.ygd.dHj(()=>{this.ECb()});this.ygd.oPg(()=>{this.FCb()})}get NN(){return this.Pq||(this.Pq=xa.a.instance.ra("CommonUI.IBusinessBar"))}get CYg(){return this.tma||
(this.tma=xa.a.instance.ra("CommonUI.IBusinessBarEntryFactory"))}eb(a,c){const h=l.AFrameworkApplication.pa;h.Aa(Sa.a.nVg,Kc.a.frame,a,96);h.Aa(Sa.a.oVg,Kc.a.frame,c,96);h.ka(Sa.a.L_g,Kc.a.frame,Le.ActionManager.lX);h.ka(Sa.a.M_g,Kc.a.frame,Le.ActionManager.lX);h.ka(Sa.a.fof,Kc.a.frame,Le.ActionManager.lX)}ECb(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);l.AFrameworkApplication.pa.processAction(Sa.a.nVg,2)}FCb(){this.NBn();l.AFrameworkApplication.pa.processAction(Sa.a.oVg,2)}CRj(){this.ygd.authenticationCheck()}NBn(){this.rd&&
(this.rd.hide(),this.rd.dispose(),this.rd=null);this.zDa&&this.NN&&(l.AFrameworkApplication.Qj||this.NN.removeEntry(this.zDa),this.zDa.dispose(),this.zDa=null)}showDialog(a){kb.a.pz(this.rd);this.rd=new oe.StandardDialog;this.hvj||(this.rd.Zr=!1,this.rd.yc=0);this.rd.Nd(1,CommonUIStrings.l_SignIn);this.rd.vS(CommonUIStrings.l_DefaultDialogTitle,a,Object(m.a)(this,this.Vha,"dialogHandler"))}Vha(a){1===a?(yg.a.hUd(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),l.AFrameworkApplication.pa.processAction(Sa.a.fof,
2)):(this.kqn(),l.AFrameworkApplication.pa.processAction(Sa.a.M_g,2))}kqn(){this.NN&&this.CYg&&(this.zDa=this.CYg.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.zDa.closeable=!0,this.zDa.addButton(CommonUIStrings.l_SignIn,Pb.Nsb,""),this.zDa.Cha=Object(m.a)(this,this.cZj,"businessBarEntryCloseHandler"),this.NN.Jz(this.zDa,!1))}cZj(){this.Vuk();l.AFrameworkApplication.pa.processAction(Sa.a.L_g,2)}Vuk(){this.Jm&&(l.AFrameworkApplication.Cb.me(this.Jm),
this.Jm=null)}dispose(){this.Jm=this.rd=this.zDa=null}static Nsb(){yg.a.hUd();l.AFrameworkApplication.pa.processAction(Sa.a.fof,2)}}Object(w.a)(Pb,"SignOutResponseUI",null,[14]);class Hb{get name(){return"Common.App.UI"}yb(a){a.register(wa,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").singleInstance()}init(){}dispose(){kb.a.pz(Hb.boa);Hb.boa=null}static main(){M.a.instance.Lb(new Hb)}static szl(a,c,h){Hb.Zpn()&&(Hb.boa=new Pb(yg.a.instance,
a,c,h))}static Zpn(){return l.AFrameworkApplication.qPd&&!l.AFrameworkApplication.$Ja}}Hb.boa=null;Object(w.a)(Hb,"CommonAppUIPackage",null,[1,2]);class bd{get name(){return"Common.App.DialogWithLinkToResource"}yb(){}init(){}dispose(){}static main(){M.a.instance.Lb(new bd)}}Object(w.a)(bd,"CommonAppDialogWithLinkToResourcePackage",null,[1,2]);var nc=b(54);class Qe{constructor(a){this.iw=a;this.Vv=Array.indexOf(this.iw,this.ica)}dispose(){this.iw=null}get dO(){return this.iw[this.Vv]}ov(a){this.$Uc(a,
!1);return!0}TYb(a){this.$Uc(a,!0)}$Uc(a,c){a&&(this.dO!==a||c)&&(a.tabIndex=0,nc.FocusManager.ZM(a));Array.contains(this.iw,a)&&(this.Vv=Array.indexOf(this.iw,a))}get mji(){let a=this.Vv;do if(a)if(0<a&&a<this.iw.length)a--;else break;else a=this.iw.length-1;while(!He.DOMFocusListing.PUa(this.iw[a])&&a!==this.Vv);return this.iw[a]}get I7h(){let a=this.Vv;do if(a===this.iw.length-1)a=0;else if(0<=a&&a<this.iw.length-1)a++;else break;while(!He.DOMFocusListing.PUa(this.iw[a])&&a!==this.Vv);return this.iw[a]}get ica(){let a=
0;for(;!He.DOMFocusListing.PUa(this.iw[a])&&a<this.iw.length;)a++;return He.DOMFocusListing.PUa(this.iw[a])?this.iw[a]:null}get p4b(){let a=this.iw.length-1;for(;!He.DOMFocusListing.PUa(this.iw[a])&&0<a;)a--;return He.DOMFocusListing.PUa(this.iw[a])?this.iw[a]:null}}Object(w.a)(Qe,"DialogFocusListing",null,[93]);var ye=b(52);class lf extends oe.StandardDialog{constructor(a,c,h,v=null){super();this.Kaa=this.Nu=this.c4a=null;this.iw=[];this.Rcd=c;this.Bi=a;this.Sgj=h;this.Pfd=v;this.Ek=new Xd.a("LoadResource",
"LoadPrintablePdf")}Pxa(){this.yc=5;this.width=40;const a=document.createElement("span");a.id=this.hi("DirectPrintHeaderContent");const c=document.createElement("span");c.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(c,"DirectPrintHeader");this.Kaa=document.createElement("iframe");this.Kaa.name="pdfObjectFrame";this.Kaa.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.Kaa.onload=Object(m.a)(this,this.ZEm,"printablePdfLoaded");if(this.Pfd&&0<this.Pfd.count){var h=
Af.a.X9e(this.Rcd,this.Pfd);const v=Af.a.hKf(this.Rcd,this.Pfd);this.Nu=document.createElement("form");this.Nu.id="printPreviewPostForm";this.Nu.method="POST";this.Nu.target=this.Kaa.name;this.Nu.action=v;for(let B of h)h=document.createElement("input"),h.type="hidden",h.name=B.key,h.value=B.value,this.Nu.appendChild(h)}else this.Kaa.setAttribute("src",this.Rcd);Sys.UI.DomElement.addCssClass(this.Kaa,Sj.a.Qwg);this.Sgj?(Sys.UI.DomElement.addCssClass(this.Kaa,"DirectPrintPdfObjectHidden"),c.innerText=
CommonUIStrings.l_DirectPrintDialogSuccessText,we.a.wo(this.Kaa,we.a.Rx,we.a.$m)):(Sys.UI.DomElement.addCssClass(this.Kaa,"DirectPrintPdfObject"),this.iw.push(this.Kaa));a.appendChild(c);a.appendChild(document.createElement("br"));a.appendChild(this.Kaa);this.Nu&&a.appendChild(this.Nu);a.appendChild(document.createElement("br"));a.appendChild(this.Lbk(this.Nu?"#":this.Rcd));this.Ek.start();this.feb(CommonUIStrings.l_AppTitle,null,null,null,null,a);this.n5(this.hi("DirectPrintHeaderContent"));this.Nu&&
this.Nu.submit();this.Xhk();r.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}Lbk(a){const c=document.createElement("span");var h=document.createElement("span");h.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;c.appendChild(h);l.AFrameworkApplication.K&&(2===l.AFrameworkApplication.na.Ya.Rm&&l.AFrameworkApplication.K.$("PPTDisableDirectPrintDialogDownloadPDFLink")||1===l.AFrameworkApplication.na.Ya.Rm&&l.AFrameworkApplication.K.$("XLODisableDirectPrintDialogOpenPDFLink"))?
(a=document.createElement("span"),2===l.AFrameworkApplication.na.Ya.Rm?a.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===l.AFrameworkApplication.na.Ya.Rm&&(a.innerText=CommonUIStrings.l_InternalError_Directive,r.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.c4a=a,c.appendChild(document.createElement("br")),c.appendChild(a)):(h=document.createElement("a"),h.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,h.href=a,h.target=
"_blank",h.id="PrintPDFLink",h.className="AllowBrowserClick",this.c4a=h,c.appendChild(document.createElement("br")),c.appendChild(h),this.Nu&&Ld.a.addHandler(h,"click",Object(m.a)(this,this.ntm,"onSubmit")),this.Bi.Ea(Jb.a.click,this.c4a,Object(m.a)(this,this.Sfh,"downloadPDFLinkClicked"),null));this.iw.push(this.c4a);return c}ntm(a){this.Nu&&(this.Nu.target="_blank",this.Nu.submit());a.preventDefault()}Xhk(){if(0<this.iw.length){const a=new Qe(this.iw),c=nc.FocusManager.instance().gk();c&&(this.c4a.focus(),
c.Sh=a,c.mV=!0)}}Sfh(){r.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}iMc(){r.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}ZEm(){r.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Ek&&this.Ek.stop()}dispose(){this.c4a&&(this.Bi.xb(Jb.a.click,this.c4a,Object(m.a)(this,this.Sfh,"downloadPDFLinkClicked")),this.c4a=null);ye.a.Zs(this.Kaa);this.Kaa=null;super.dispose()}}Object(w.a)(lf,"DirectPrintDialog",
oe.StandardDialog,[784]);class rh{constructor(a){this.Bi=a}hZk(a,c,h=null){return new lf(this.Bi,a,c,h)}}Object(w.a)(rh,"DirectPrintDialogFactory",null,[759]);class Eg{constructor(a,c){this._url=a;this.jpj=c}Feh(){this.jpj?Ve.a.downloadFile(this._url):Ve.a.Ql(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(w.a)(Eg,"OpenUrlInTabDialogDownloadBehavior",null,[808,14]);class Qf extends oe.StandardDialog{constructor(a,c=!0,h=!1,v=null,B=null,X=!1){super();
this.XMb=this.WMb=this.Nu=this.SZ=null;var ma=this.mYf?this.mYf:CommonUIStrings.l_DefaultDialogTitle;Qf.I0b=X;this.ehe=v||new Eg(a,!0);const Pa=[],mb=[];Qf.vP&&(this.Eld&&this.Eld.forEach(Tc=>{Array.add(Pa,Tc)}),this.MQg&&this.MQg.forEach(Tc=>{Array.add(mb,Tc)}));c?h?(this.yc=4,this.Nd(1,this.buttonText),this.Nd(2,CommonUIStrings.l_DialogClose)):(this.yc=6,this.Nd(0,CommonUIStrings.l_DialogClose)):this.yc=5;X=document.createElement("span");this.Iyc&&(X.className=this.Iyc);v=document.createElement("a");
v.innerText=this.I4b;v.href=a;v.target="_blank";v.id=this.TLc;v.className=Fc.AFrame.xJe;var Tb=!H.a.o4&&!!B&&0<B.count;if(Tb){const Tc=Af.a.X9e(a,B);B=Af.a.hKf(a,B);v.href="#";v.target="_self";this.Nu=document.createElement("form");this.Nu.id="printPreviewPostForm1";this.Nu.method="post";this.Nu.target="_blank";this.Nu.action=B;for(var rc of Tc)B=document.createElement("input"),B.type="hidden",B.name=rc.key,B.value=rc.value,this.Nu.appendChild(B)}else this.Nu=null;this.Nu||Qf.I0b?Qf.I0b||Array.add(mb,
{["type"]:"AppLinkProps",["id"]:this.TLc,["text"]:this.I4b,["onExecute"]:()=>{this.Pmi()}}):Array.add(mb,{["type"]:"AppLinkProps",["id"]:this.TLc,["text"]:this.I4b,["handler"]:{["href"]:Tb?"#":a,["target"]:Tb?"_self":"_blank"}});this.NYa&&Array.add(Pa,this.NYa);h?(a=document.createElement("span"),a.innerText=this.NYa.replace("{0}",""),X.appendChild(a)):this.o5h?(a=document.createElement("span"),a.id=this.hi("message"),rc=document.createElement("span"),B=document.createElement("span"),Tb=this.NYa.split("{0}"),
rc.innerText=Tb[0],B.innerText=Tb[1],a.appendChild(rc),a.appendChild(v),a.appendChild(B),X.appendChild(a)):(a=document.createElement("span"),a.innerText=this.NYa,X.appendChild(a),X.appendChild(document.createElement("br")),X.appendChild(document.createElement("br")),X.appendChild(v),Qf.I0b||Array.add(Pa,"{0}"));this.Nu&&X.appendChild(this.Nu);Qf.vP&&(this.Ddb&&(this.BLc?this.CNg(this.Ddb,this.BLc):(Array.add(Pa,"{0}"),Array.add(mb,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.Ddb,
["onExecute"]:()=>{}}))),this.zkd(Pa,mb));this.feb(ma,null,this.mef,null,Object(m.a)(this,this.Vha,"dialogHandler"),Qf.vP?null:X);this.n5(this.hi("message"));!Qf.vP&&this.BLc&&this.Ddb&&(ma=document.createElement("div"),ma.className="WACDialogLearnMoreLinkContainer",this.SZ=document.createElement("a"),this.SZ.innerText=this.Ddb,this.SZ.href=this.BLc,this.SZ.target="_blank",this.SZ.id=this.hi("LearnMoreLinkId"),this.SZ.className=Fc.AFrame.xJe,ma.appendChild(this.SZ),c?this.pc.insertBefore(ma,this.pc.lastChild):
this.pc.appendChild(ma),this.n5(String.format("{0} {1}",this.hi("message"),this.hi("LearnMoreLinkId"))));this.hic=v;h?this.AY(this.ZC):this.AY(this.hic);this.Dpf();l.AFrameworkApplication.na.RY.Ea(Jb.a.click,this.hic,Object(m.a)(this,this.Rfh,"downloadLinkClicked"),null);this.SZ&&l.AFrameworkApplication.na.RY.Ea(Jb.a.click,this.SZ,Object(m.a)(this,this.WZh,"learnMoreLinkClicked"),null);this.jT=!1}get mef(){return null}get mYf(){return null}get NYa(){return null}get BLc(){return null}get Ddb(){return null}get o5h(){return!1}get buttonText(){return CommonUIStrings.l_Open}get Iyc(){return null}get Eld(){return null}get MQg(){return null}kha(){this.Nu&&
(this.WMb||(this.WMb=Object(m.a)(this,this.Qjm,"onActionButtonClicked"),this.Uo.Ea(Jb.a.click,this.ZC,this.WMb)),this.XMb||(this.XMb=Object(m.a)(this,this.Rjm,"onActionButtonKeyUp"),this.jd.Ea(Jb.a.Hg,this.ZC,this.XMb)));super.kha()}Qjm(a){this.ojh(a);return!0}Rjm(a){return this.cLc(a,Object(m.a)(this,this.ojh,"executeDismissActionButtonFromArgs"))}ojh(a){this.Nu&&this.Nu.submit();this.Mvb(a.Ud)}iMc(){}Rfh(){this.Epf();this.Nu?this.Nu.submit():this.ehe.Feh();return!0}WZh(){return!1}dispose(){this.ehe.dispose();
this.hic&&(l.AFrameworkApplication.na.RY.xb(Jb.a.click,this.hic,Object(m.a)(this,this.Rfh,"downloadLinkClicked")),this.hic=null);this.SZ&&(l.AFrameworkApplication.na.RY.xb(Jb.a.click,this.SZ,Object(m.a)(this,this.WZh,"learnMoreLinkClicked")),this.SZ=null);this.Uo&&this.WMb&&(this.Uo.xb(Jb.a.click,this.ZC,this.WMb),this.WMb=null);this.jd&&this.XMb&&(this.jd.xb(Jb.a.Hg,this.ZC,this.XMb),this.XMb=null);super.dispose()}Pmi(){this.Nu&&(document.body.appendChild(this.Nu),this.Nu.submit(),document.body.removeChild(this.Nu))}Vha(a){1===
a&&(this.iMc(),this.Nu?Qf.vP&&this.Pmi():this.ehe.Feh());this.dispose()}static get vP(){return l.AFrameworkApplication.na.Ya.fA&&l.AFrameworkApplication.na.Ya.HVh}static get I0b(){return Qf.Klg}static set I0b(a){Qf.Klg=a}}Qf.Klg=!1;Object(w.a)(Qf,"ADialogWithLinkToResource",oe.StandardDialog,[]);class jg extends Qf{constructor(a,c,h=null,v=!0,B=!1){super(a,!0,!(jg.ljb&&v),new Eg(a,c),h,B);jg.ljb=jg.ljb&&v;if(jg.ljb){c=document.createElement("iframe");v=null;B=this.Wtk;c.name="pdfObjectFrame";c.id=
"pdfObjectIFrame";if(h&&0<h.count){const X=Af.a.X9e(a,h);a=Af.a.hKf(a,h);v=document.createElement("form");v.id="printPreviewPostForm";v.method="POST";v.target=c.name;v.action=a;for(let ma of X)a=document.createElement("input"),a.type="hidden",a.name=ma.key,a.value=ma.value,v.appendChild(a)}else c.src=a;B.appendChild(c);v&&(B.appendChild(v),v.submit());Sys.UI.DomElement.addCssClass(c,"DirectPrintPdfObjectHidden");we.a.wo(c,we.a.Rx,we.a.$m)}}get mef(){return"Print_32x32x32"}get mYf(){return jg.ljb?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get NYa(){return jg.ljb?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get Eld(){const a=[];Array.add(a,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Qf.I0b){let c=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==l.AFrameworkApplication.na.Ya.Iah&&(c=l.AFrameworkApplication.na.Ya.Iah);Array.add(a,c)}return jg.ljb?a:null}get I4b(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get TLc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get Iyc(){return l.AFrameworkApplication.AUa?
"UIFontDialogTextLarge":null}Dpf(){r.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}Epf(){l.AFrameworkApplication.$k.UWa(9540);r.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}iMc(){r.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get ljb(){return!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.fA&&l.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")&&!(H.a.o4||H.a.Gi||H.a.Qh||H.a.qAb)&&!l.AFrameworkApplication.LKc&&
l.AFrameworkApplication.K.$("ShouldHostDefaultToNativeBrowserPrintExperience")}static set ljb(a){}}Object(w.a)(jg,"PrintDialogWithLinkToPdf",Qf,[]);class Ng{constructor(a){this.isEnabled=Boolean.parse(a.DirectPrintIsEnabled||"false");this.qQl=Boolean.parse(a.DirectPrintProbeIsEnabled||"false");this.fNl=Boolean.parse(a.DirectPrintEnabledForInternetExplorer||"false");this.oHb=(a.DirectPrintSupportedMimeTypes||"").split(Ng.YXe);this.$hb=(a.DirectPrintSupportedPlugins||"").split(Ng.YXe);this.Lxl=(a.DirectPrintImmersivePreviewPlugins||
"").split(Ng.YXe);this.IRh=Boolean.parse(a.DirectPrintEnabledForEdge||"false");this.KHl=Boolean.parse(a.ChromePrintLayoutFixIsEnabled||"false");this.y5j=parseInt(a.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.psf=14;this.A5h=14394;if(a=a.DirectPrintMinimalSupportedEdgeVersion){const c=a.split(".");2===c.length?(this.psf=parseInt(c[0]),this.A5h=parseInt(c[1])):r.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",a)}else r.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}Ng.YXe=",";Object(w.a)(Ng,"DirectPrintBrsSettings",null,[]);class ci{constructor(a,c){this.aWf=a;this.$hb=c}}Object(w.a)(ci,"DirectPrintProbeResults",null,[]);var bj=b(183);class Xk{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){this.rjd=null;this.dcj=a;this.ync=c;this.cte=h;this.gjj=v;this.hkj=B;this.upc=new qf.a(Object(m.a)(this,this.Ybl,"getProbeResults"));this.C3a=X;this.atg=mb;this.ZT=ma;this.vlc=Pa;this.Akj=Tb}get fO(){return this.dcj}start(){}sFm(){this.fO.qQl&&
this.C6l()}XJm(){const a=Array(this.fO.oHb.length);if(void 0!==this.ync&&null!==this.ync)for(let c=0;c<this.fO.oHb.length;c++)a[c]=this.fO.oHb[c]in this.ync&&this.gjj(this.ync[this.fO.oHb[c]]);return a}YJm(){const a=Array(this.fO.$hb.length),c=!(void 0===this.cte||null===this.cte);for(let h=0;h<this.fO.$hb.length;h++){const v=this.fO.$hb[h];a[h]=c&&v in this.cte?!0:this.hkj(v)}return a}whl(){const a=this.XJm(),c=Array(a.length);for(let h=0;h<a.length;h++)c[h]=a[h]?this.sFk(this.ync[this.fO.oHb[h]]):
null;return c}sFk(a){if(void 0===a||null===a)return null;a=a.enabledPlugin;return void 0===a||null===a?null:a.name}C6l(){r.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.upc.value.aWf,this.upc.value.$hb)}Ybl(){var a=this.whl();const c=this.YJm(),h={},v={};for(let B=0;B<this.fO.oHb.length;B++)h[this.fO.oHb[B]]=a[B];for(a=0;a<this.fO.$hb.length;a++)v[this.fO.$hb[a]]=c[a];return new ci(h,v)}Qpn(){return this.Akj||!this.fO.isEnabled||l.AFrameworkApplication.LKc?!1:this.Ryn()}Wpn(){if(null!=
this.rjd)return this.rjd;const a=Xk.HRh(this.fO);return this.rjd=this.fO.IRh&&a||this.JHl()}JHl(){return H.a.In&&this.fO.KHl&&H.a.x5j>=this.fO.y5j?!0:!1}Ryn(){if(!this.vlc(this.fO))return!1;var a=Za.a.getValues(this.upc.value.aWf);for(const c of a)if(void 0!==c&&null!==c)return!0;a=Za.a.getValues(this.upc.value.$hb);for(const c of a)if(c)return!0;return!1}Lsl(){const a=Za.a.getValues(this.upc.value.aWf);for(const c of a)if(bj.a.contains(this.fO.Lxl,c))return!0;return!1}fsn(a,c=null){l.AFrameworkApplication.na&&
l.AFrameworkApplication.K.$("DirectPrintDialogAsStandardDialogIsEnabled")?this.atg(a,c):this.Qpn()?this.Xvk(a,this.Lsl()&&!0,c):this.atg(a,c)}Xvk(a,c,h=null){const v=this.ZT.Pe("UserAction","OpenDirectPrintDialog");this.C3a.hZk(a,c,h).Pxa();v.stop()}static VSl(a){try{return new ActiveXObject(a),!0}catch(c){r.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",a)}return!1}static uKl(a){return void 0===a||null===a?!1:!(void 0===a.enabledPlugin||null===a.enabledPlugin)}static create(a){const c=
new Ng(l.AFrameworkApplication.K.appSettings);let h=null;try{h=window.navigator.mimeTypes}catch(Tb){r.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let v=null;try{v=window.navigator.plugins}catch(Tb){r.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const B=Xk.uKl,X=Xk.VSl;a=a.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const ma=l.AFrameworkApplication.na.Qo,Pa=Xk.XSl,mb=!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.fA&&
!l.AFrameworkApplication.K.$("PrintDialogFallbackLinkEnabled");return new Xk(c,h,v,B,X,a,ma,Pa,(Tb,rc)=>new jg(Tb,!1,rc,!0,mb),l.AFrameworkApplication.$Ja)}static XSl(a){return H.a.In||H.a.Gi&&a.fNl||a.IRh&&Xk.HRh(a)?!0:!1}static HRh(a){var c=H.a.vvb;if(c){var h=c.split(".");if(2===h.length)return c=parseInt(h[0]),h=parseInt(h[1]),c>a.psf||c===a.psf&&h>=a.A5h}return!1}}Object(w.a)(Xk,"DirectPrintManager",null,[740]);class Bk{constructor(){this.vlb=this.W=null}get name(){return"Common.App.DirectPrint"}yb(a){this.W=
a;a.register(rh,"Common.App.DirectPrint.DirectPrintDialogFactory").singleInstance().Pc(()=>new rh(l.AFrameworkApplication.na.RY));a.register(740,"Common.App.DirectPrint.IDirectPrintManager").singleInstance().Pc(()=>Xk.create(this.W))}init(){this.vlb=this.W.resolve("Common.App.DirectPrint.IDirectPrintManager");this.vlb.start()}dispose(){}}Object(w.a)(Bk,"PackageManager",null,[1,2]);class he{constructor(a,c=3E4){this.zYf=9E5;this.BYf=1E4;this.N2h=this.e5b=null;this.Hqf=0;this.Xyc=Date.now;this.HCd=
a;this.B5d=c;this.hyd()}PEh(a=!0){const c=this.Xyc();if(c<this.Hqf+this.zYf)return c>this.Hqf+this.BYf&&this.hyd(),this.N2h;a&&this.hyd();return null}getToken(a=!0){return(a=this.PEh(a))?Promise.resolve(a):this.hyd()}hyd(){return this.e5b=this.e5b||new Promise(a=>{this.HCd().then(c=>{this.e5b=null;""!==c&&c&&(this.N2h=c,this.Hqf=this.Xyc(),a(c));a(null)}).catch(()=>{this.e5b=null;a(null)});window.setTimeout(()=>{this.e5b=null;a(null)},this.B5d)})}}Object(w.a)(he,"OAuthCacheManager",null,[]);class mj{static gqa(a){return""!==
a&&a?mj.VMj[a.toLowerCase()]:""}static ojl(a,c){const h=Date.now();var v=mj.bck();const B=l.AFrameworkApplication.K.Ga("UserPrincipalName"),X=mj.gqa(a);r.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+a);if(""===B||!B)return r.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===X||!X)return r.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+a),Promise.resolve("");const ma=Ya.a.create().toString();v=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none",
"https://login.microsoftonline.com",X,encodeURIComponent(c),encodeURIComponent(B),encodeURIComponent(v),ma);const Pa=document.createElement("iframe");Pa.style.display="none";Pa.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");Pa.src=v;document.body.appendChild(Pa);return new Promise(mb=>{mj.Jem(Pa.contentWindow).then(Tb=>{document.body.removeChild(Pa);const rc=new od.a,Tc=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let vd;for(;vd=Tc.exec(Tb);)3!==vd.length&&(r.ULS.sendTraceTag(593862983,
1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",vd.length),mb("")),rc.Z(vd[1],vd[2]);rc.Ja("access_token")?(r.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",c,a,Date.now()-h),mb(rc.J("access_token"))):(r.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",c,a,(Date.now()-h).toString()),mb(""))}).catch(Tb=>{try{document.body.removeChild(Pa)}catch(rc){}r.ULS.sendTraceTag(593862980,
1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",c,a,JSON.stringify(Tb),(Date.now()-h).toString());mb("")})})}static bck(){const a=window.location.protocol,c=window.location.host;var h=l.AFrameworkApplication.K.Ga("OAuthManagerHostPathOverride");if(void 0===h||null===h){h=window.location.pathname;const v=h.lastIndexOf("/");h=0<=v?h.substring(0,v+1):""}return a+"//"+c+h+"WacOAuth.html"}static Jem(a){return new Promise((c,h)=>{let v=0,B=0;B=window.setInterval(()=>
{if(200<v++)window.clearInterval(B),h("Exceeded 10000ms timeout after 200 polls");else{var X=null,ma=null;try{if(!a||a.closed){window.clearInterval(B);h("Window or Frame is closed before completion");return}X=a.location.href;ma=a.location.hash}catch(Pa){}X&&"about:blank"!==X&&ma&&""!==ma&&(window.clearInterval(B),c(ma))}},50)})}}mj.VMj={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(w.a)(mj,"OAuthHelper",null,[]);class Jk{constructor(a,
c){this.token=a;this.source=c}}Object(w.a)(Jk,"TokenResult",null,[]);var um=b(95),wg=b(235);class Jh{constructor(){this.G4=null;this.ehg={};this.jcc=new ia.a(oa.a.yi())}getToken(a,c,h=!1){if(this.jcc.Ja(c))return this.jcc.J(c).getToken();const v=new he(()=>h?this.QEh(a,c):this.HCd(a,c));this.jcc.Z(c,v);return v.getToken()}mjl(a,c,h=!1){if(this.jcc.Ja(c))return this.jcc.J(c).PEh();const v=new he(()=>h?this.QEh(a,c):this.HCd(a,c));this.jcc.Z(c,v);return null}HCd(a,c){const h=Date.now();return mj.ojl(a,
c).then(v=>new Jk(v,"SSOStack")).then(v=>new Promise(B=>{v.token&&""!==v.token?(r.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",a,v.source,Date.now()-h),this.Ogb("GetTokenInternal",!0,Date.now()-h,a,"","",c),B(v.token)):(r.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",a,Date.now()-h),this.Ogb("GetTokenInternal",!1,Date.now()-h,a,"GetTokenSilent Failed","SSO Token provider failed!",c),B(""))}))}QEh(a,c){if(!this.G4)try{this.G4=
xa.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(h){r.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+h)}return this.G4?new Promise(h=>{const v=Date.now();this.G4.Pla(a,c).then(B=>{const X=B.Token;!B.IsSuccess||this.XTl(X)?(this.Ogb("GetTokenInternalImplicitJS",!1,Date.now()-v,a,B.ErrorCode,B.ErrorMessage,c),h(null)):(this.Ogb("GetTokenInternalImplicitJS",!0,Date.now()-v,a,B.ErrorCode,B.ErrorMessage,c),h(X))}).catch(B=>{B=B?z.c(B):"";this.Ogb("GetTokenInternalImplicitJS",
!1,Date.now()-v,a,"Caught Exception",B,c);h(null)})}):new Promise(h=>{this.Ogb("GetTokenInternalImplicitJS",!1,0,a,"Null OAuthManager","OAuthManager not set");h(null)})}Ogb(a,c,h,v,B="",X="",ma=""){var Pa="Search"===v;const mb=[];a=um.a.Jia(Pa?"Event":"EventName",a,2);v=um.a.Jia("AppName",v,2);Array.add(mb,a);Array.add(mb,v);Pa&&(v=um.a.Jia("LatencyType","FetchToken",2),Array.add(mb,v));B&&""!==B&&(B=um.a.Jia("ErrorCode",B,2),Array.add(mb,B));X&&""!==X&&(X=um.a.Jia("ErrorMessage",X,2),Array.add(mb,
X));ma&&""!==ma&&(X=!(ma in this.ehg),this.ehg[ma]=X,X=um.a.Jia("WarmUpCall",X.toString(),1),Array.add(mb,X),ma=um.a.Jia("Service",this.Ffl(ma),2),Array.add(mb,ma));Pa=Pa?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";c=Object.assign(new wg.a,{name:Pa,samplingPolicy:2,dataFields:mb,succeeded:c,durationMs:h});Z.a.sendActivityEvent(c)}Ffl(a){return a===l.AFrameworkApplication.tqf?"Loki":a===l.AFrameworkApplication.UVf?"Substrate":l.AFrameworkApplication.K&&a===l.AFrameworkApplication.K.Ga("SmartLookupShredderServiceEndpoint")?
"Shredder":"Other"}XTl(a){return!a||!a.length}}Object(w.a)(Jh,"SearchOAuthManager",null,[705]);class Sf{constructor(){this.W=null}get name(){return"Common.App.SearchOAuthManager"}yb(a){this.W=a;this.W.register(705,"Common.App.SearchCommon.ISearchOAuthManager").singleInstance().Pc(()=>new Jh)}init(){}dispose(){}static main(){M.a.instance.Lb(new Sf)}}Object(w.a)(Sf,"SearchOAuthPackage",null,[1,2]);var Kh=b(202),Kd=b(5),dd=b(21),Gc=b(19),sd=b(10);class tb{constructor(a,c,h){this.Wte=this.Ipb=this.Tte=
this.Hpb=this.Dqe=null;this.yj=a;this.Qcj=c;this.ya=h;this.init()}init(){this.Qcj.Ea(Object(m.a)(this,this.jpl,"handleEditingViewUpdatesSafe"));this.Hpb=new Yc.a;this.Tte=new Yc.a;this.Ipb=new Yc.a;this.Wte=new Kh.a}j1(a){this.Hpb.add(a.key,a)}L8b(a){this.Ipb.add(a.key,a)}jpl(a){try{this.ipl(a)}catch(c){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",c.message,c.stack),r.ULS.sendTraceTag(5285580,334,10,a)}}ipl(a){let c;({JVe:c}=tb.THn(this.ya.Ca.Fa,
c)).returnValue&&(a=tb.LWk(a,this.Dqe,c),this.MFm(a,c),this.Dqe=c)}MFm(a,c){a=this.UQk(a,c);let h;({notification:h}=tb.KHn(a,h)).returnValue&&this.yj.sendNotification(h,!1)}UQk(a,c){const h=new Yc.a;h.Z(1,new Kh.a);h.Z(0,new Kh.a);a.forEach(v=>{3===v?(tb.rSf(c.node)||this.B1m(c),this.Q$k(h,c)):v||this.iXk(h,c);return!0});return h}B1m(a){this.Hpb.forEach((c,h)=>{h.reset(a);return!0})}iXk(a,c){let h=new Yc.a;tb.rSf(c.node)||(h=this.gXk(c.cpBegin));this.hXk(a,this.Tte,h,tb.Syi(this.Dqe,c));this.Tte=
h}gXk(a){const c=new Yc.a;this.Hpb.forEach((h,v)=>{h=null;({bF:h}=v.ICa(a)).returnValue&&c.Z(v.key,h);return!0});return c}hXk(a,c,h,v){const B=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;c.forEach((X,ma)=>{const Pa=this.Hpb.J(X).$u||ma.title;let mb;({value:mb}=h.Ab(X)).returnValue?v&&mb.contentObject!==ma.contentObject&&(Pa&&a.J(1).add(Pa),X=this.Hpb.J(X).$u,X=String.format(B,mb.title,X),mb.description&&(X+=", "+mb.description),a.J(0).add(X)):Pa&&a.J(1).add(Pa);return!0});h.forEach((X,ma)=>
{c.Ja(X)||(X=this.Hpb.J(X).$u,X=String.format(B,ma.title,X),ma.description&&(X+=", "+ma.description),a.J(0).add(X));return!0})}Q$k(a,c){c=this.Qgl(c.node);c=this.X8j(c);this.Rgl(a,this.Wte,c);this.Wte=c}Qgl(a){const c=new Kd.GraphIterator;c.set(a);if(!c.La(1))return null;const h=new Kh.a;for(;1!==c.Md;)this.Ipb.forEach((v,B)=>{let X;({Jha:X}=B.Icc(c)).returnValue&&h.add(X);return!0}),c.ob();h.reverse();return h}X8j(a){a=a.toArray();let c=0;for(;c<a.length-1;){var h=a[c];if(h.mE===a[c+1].mE&&(this.Ipb.J(h.mE),
({$8j:h}={returnValue:!1,$8j:null}).returnValue)){a.splice(c,2,h);continue}c++}return new Kh.a(a)}Rgl(a,c,h){var v;for(v=0;v<Math.min(h.length,c.length)&&h.J(v).contentId.equals(c.J(v).contentId);v++){var B=this.Ipb.J(h.J(v).mE).Lwb(h.J(v),c.J(v));B&&(h.J(v).description&&(B+=", "+h.J(v).description),a.J(0).add(B))}for(B=v;B<h.length;B++){let X=this.Ipb.J(h.J(B).mE).Lwb(h.J(B),null);X&&(h.J(B).description&&(X+=", "+h.J(B).description),a.J(0).add(X))}for(h=v;h<c.length;h++)(v=this.Ipb.J(c.J(h).mE).$u)&&
a.J(1).add(v)}static LWk(a,c,h){const v=new Kh.a;(a=a||tb.R9m(c,h))?(v.add(3),v.add(0)):tb.Syi(c,h)&&v.add(0);return v}static R9m(a,c){return!a||!a.node.id.equals(c.node.id)}static Syi(a,c){return!a||!a.equals(c)}static THn(a,c){c=null;if(!a||!(Gc.SelectionEditor.Cl(a)||(a=Gc.SelectionEditor.Ri(a,!0,!1),Gc.SelectionEditor.Cl(a)||a.sa&&tb.rSf(a.sa.node))))return{returnValue:!1,JVe:c};c=a.sa;return{returnValue:!!c,JVe:c}}static KHn(a,c){const h=new Kh.a;a.J(1).forEach(v=>{v=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,
v);h.add(v);return!0});a.J(0).forEach(v=>{v=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,v);h.add(v);return!0});c=h.toArray().join(" ");return{returnValue:0<h.length,notification:c}}static rSf(a){return dd.ImageReader.ix(a)||sd.ParagraphReader.axa(a)}}Object(w.a)(tb,"AccessibilityContextManager",null,[701]);class vc{constructor(a,c){this.oqg=!1;this.Gqc=null;this.Lfd=this.ijd=!1;this.Bgg=null;this.Ta=a;this.jL=c}get xtl(){return!!this.Gqc}Ea(a){this.oqg||(this.jL.GPg(Object(m.a)(this,
this.Ild,"afterEditingViewValidateEventHandler")),this.oqg=!0);this.Bgg=a}Ild(a,c){(c.uP||c.dla)&&this.oim(c.uP,c.dla)}oim(a,c){this.xtl&&this.Ta.me(this.Gqc);this.ijd=this.ijd||a;this.Lfd=this.Lfd||c;this.Gqc=new Se.a(5,1,vc.ADk,()=>{this.Bgg(this.ijd,this.Lfd);this.reset()},126);this.Ta.ub(this.Gqc)}reset(){this.Gqc=null;this.Lfd=this.ijd=!1}}vc.ADk=100;Object(w.a)(vc,"EditingViewOnAfterValidateEventsConsolidator",null,[699]);var $c=b(49);class Td{constructor(){this.W=null}get name(){return"Box4.Accessibility"}init(){Eb.App.uUg&&
this.W.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}yb(a){this.W=a;a.ha("Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator",()=>new vc(l.AFrameworkApplication.Cb,a.resolve("Box4.ContentEditableViewEventSource"))).as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").singleInstance();a.ha("Box4.Accessibility.AccessibilityContextManager",()=>new tb(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),
$c.a.instance)).as("Box4.Accessibility.IAccessibilityContextManager").singleInstance()}static main(){M.a.instance.Lb(new Td)}}Object(w.a)(Td,"Box4AccessibilityPackage",null,[1,2]);var Ee=b(146),xf=b(910),cg=b(1462),sh=b(796),bh=b(185),qi=b(1342),gf=b(43),ne=b(24),ch=b(130),Oe=b(30),zb=b(3);class Fh extends qi.a{constructor(){super(...arguments);this.yAg=this.Tua=null}get Pqa(){return this.Tua||(this.Tua=xa.a.instance.ra("Box4.IInternalLinkManager"))}get wii(){return this.yAg||(this.yAg=xa.a.instance.ra("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get cA(){return!0}get commandId(){return zb.a.LRj}$ha(a){bh.a.mark(7012);
const c=new gf.GraphTransaction(15);c.Oa(a);var h=this.eE,v=this.aY,B=sd.ParagraphReader.text(a),X=B.substring(h,v);const ma=({CNc:Pa}=F.a.EVf(X)).returnValue;X!==ma&&(h+=Pa,v=h+ma.length);X=Oe.a.createTextRange(a,h,v);var Pa=B.substring(h,v);Fh.$Ml(B,h,v)&&(this.Tb.replaceTextRange(Oe.a.createTextRange(a,h-1,v+1),Pa,!0,!1),--h,--v,X=Oe.a.createTextRange(a,h,v),h=ne.SelectionFactory.vd(a,v),$c.a.instance.setSelection(h));h=ch.HyperlinkReader.iJa(Pa);Fh.hyperlinkEditor.BG(X,h,!1);B=Pa="";v=!1;this.Pqa&&
({yJf:Pa,Coh:B}=this.Pqa.qZf(h)).returnValue&&(h=Pa,v=!0,Pa=ch.HyperlinkReader.aB(X,!1),Fh.hyperlinkEditor.jP(Pa[0].paragraph,Pa[0].hyperlink),""!==B&&(this.Tb.replaceTextRange(X,B,!0,!1),X=Oe.a.createTextRange(a,this.eE,this.eE+B.length),a=ne.SelectionFactory.vd(a,this.eE+this.eE+B.length),$c.a.instance.setSelection(a)),Fh.hyperlinkEditor.BG(X,h,!1));c.dispose();!v&&this.wii&&this.wii.PCm(X,h);bh.a.mark(7013)}set cA(a){super.cA=a}static get hyperlinkEditor(){return Fh.Oi||(Fh.Oi=xa.a.instance.resolve("Box4.IHyperlinkEditor"))}static $Ml(a,
c,h){h=h!==a.length&&('"'===a.charAt(h)||"\u201d"===a.charAt(h));return!!c&&('"'===a.charAt(c-1)||"\u201c"===a.charAt(c-1))&&h}}Fh.Oi=null;Object(w.a)(Fh,"HyperlinkAction",qi.a,[]);class Lh{constructor(a){this.Tb=a}Aik(a,c,h){return new Fh(null,a,c,h,this.Tb)}}Object(w.a)(Lh,"HyperlinkActionFactory",null,[591]);var li=b(233);class Dh{constructor(){this.W=null}get name(){return"Box4.AutoCorrect"}yb(a){this.W=a;a.ha("Box4.AutoCorrect.AutoCorrectRules",()=>new cg.a(a.resolve("Box4.IHyperlinkActionFactory"),
a.resolve("Box4.ICharacterPropertiesEditor"),li.a.instance,l.AFrameworkApplication.pa,l.AFrameworkApplication.K,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)).as("Box4.IAutoCorrectRules").singleInstance();a.ha("Box4.AutoCorrect.AutoCorrectOptionsInfo",()=>new xf.a(a.resolve("Box4.IRoamingServiceRequestManager"),l.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled"))).as("Box4.IAutoCorrectOptionsInfo").singleInstance();a.ha("Box4.AutoCorrect.AutoCorrectScheduler",
()=>new sh.a(a.resolve("Box4.IAutoCorrectRules"),$c.a.instance,Ee.a.instance,l.AFrameworkApplication.K,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.IUndoManager"),a.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>"))).as("Box4.IAutoCorrectScheduler").singleInstance();a.ha("Box4.AutoCorrect.HyperlinkAction.Factory",()=>new Lh(a.resolve("Box4.ICharacterPropertiesEditor"))).as("Box4.IHyperlinkActionFactory").singleInstance()}init(){this.W.resolve("Box4.IAutoCorrectRules").b_l();
const a=l.AFrameworkApplication.K;a.$("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.$("IsRoamingServiceEnabled")&&this.W.resolve("Box4.IAutoCorrectOptionsInfo").rSk()}dispose(){}static main(){M.a.instance.Lb(new Dh)}}Object(w.a)(Dh,"Box4AutoCorrectPackage",null,[1,2]);class di{get name(){return"Box4.Clipboard"}init(){}dispose(){}yb(){}static main(){M.a.instance.Lb(new di)}}Object(w.a)(di,"Box4ClipboardPackage",null,[1,2]);class nj{get name(){return"Box4.ImageEditors"}yb(){}init(){}dispose(){}static main(){M.a.instance.Lb(new nj)}}
Object(w.a)(nj,"Box4ImageEditorsPackage",null,[1,2]);class sj{jGi(){return{iGi:!0,aZi:!1}}}Object(w.a)(sj,"CursorMovementValidator",null,[587]);class yi{Pji(a,c,h,v,B,X){return a?l.AFrameworkApplication.pa.Le(a,c,h,!0,B,X):8}}Object(w.a)(yi,"ListContextManager",null,[586]);class Cg{get name(){return"Box4.ListEditors"}yb(a){a.ha("Box4.ListEditors.CursorMovementValidator",()=>new sj).as("Box4.List.ICursorMovementValidator").singleInstance();a.ha("Box4.ListEditors.ListContextManager",()=>new yi).as("Box4.ListEditors.IListContextManager")}init(){}dispose(){}static main(){M.a.instance.Lb(new Cg)}}
Object(w.a)(Cg,"Box4ListEditorsPackage",null,[1,2]);class mi{get name(){return"Box4.NotebookLevelEditors"}yb(){}init(){}dispose(){}static main(){M.a.instance.Lb(new mi)}}Object(w.a)(mi,"Box4NotebookLevelEditorsPackage",null,[1,2]);var ei=b(1356),If=b(121),pl=b(706),ic=b(14);const Nl=(a,c,h,v,B)=>{if(c.contextId===ic.a.view)switch(a){case zb.a.search:return Eb.App.oa.Da.Ira.jHn(),Eb.App.XK.pCi(),32;case zb.a.findOnPage:return 1!==h&&(Eb.App.oa.Da.Ira.jHn(),Eb.App.XK.sQf()),32;case zb.a.tui:return Eb.App.oa.Da.Jb&&
Eb.App.oa.Da.Jb.Rh?(1!==h&&(pl.a.DFb?Eb.App.XK.c2m():Eb.App.XK.sQf()),a=32):a=8,a;case zb.a.Zsb:case zb.a.E_g:return 1===h?a=pl.a.DFb?32:8:(Eb.App.XK.c2m(),a=32),a;case zb.a.cVd:return 1!==h&&Eb.App.XK.eDd(),32;case zb.a.oji:return(a=Ve.a.EIa(document.body.ownerDocument))&&a.id===If.AppFrame.byi&&Eb.App.XK.eDd(),32;case zb.a.DPd:return 1!==h&&Eb.App.XK.dDd(),32;case zb.a.J7h:return(a=Ve.a.EIa(document.body.ownerDocument))&&a.id===If.AppFrame.byi&&Eb.App.XK.dDd(),32;case zb.a.lBi:return Eb.App.XK.hco(),
32;case zb.a.KTc:return Eb.App.XK.KTc(),32;case zb.a.cef:return 1!==h&&"string"===typeof B&&Eb.App.XK.cef(B),32;case zb.a.Kxi:return 1!==h&&Eb.App.XK.sQf(),32;case zb.a.Lxi:return 1!==h&&Eb.App.XK.pCi(),32;case zb.a.FMg:return Eb.App.XK.f8n(),32;case zb.a.dyi:return Eb.App.XK.pCi(),"string"===typeof B&&(Eb.App.XK.FIm(B),pl.a.DFb=!0),32;case zb.a.Kwd:return Eb.App.XK.sQf(),"string"===typeof B&&(Eb.App.XK.FIm(B),pl.a.DFb=!0),32}return 2};class Jo{get name(){return"Box4.Search"}yb(a){a.ha("Box4.Search.FindManagerHelper",
()=>ei.FindManagerHelper.instance).as("Box4.Search.IFindManagerHelper").singleInstance()}init(){Sb.a.kSc(Nl)}dispose(){}}Object(w.a)(Jo,"PackageManager",null,[1,2]);class Nd{get name(){return"Box4.TableEditors"}yb(){}init(){}dispose(){}static main(){M.a.instance.Lb(new Nd)}}Object(w.a)(Nd,"Box4TableEditorsPackage",null,[1,2]);class be{get name(){return"Box4.TextLevelEditors"}yb(){}init(){}dispose(){}static main(){M.a.instance.Lb(new be)}}Object(w.a)(be,"Box4TextLevelEditorsPackage",null,[1,2]);var Di=
b(101),uh=b(348),Uc=b(128),Qc=b(786),og=b(1357);class xl{constructor(a,c,h){this.mu=this.Pfa=this.Iga=null;this.xA=this.Dfe=this.FDa=0;this.ega=this.C9c=this.OPa=this.NPa=!1;this.l8c=this.Kmg=this.Mmg=0;this.mGa=!1;this.w6=a;this.ga=c;this.Lj=h;this.mGa=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SingleImageDragAdapterIsEnabled",!1)}AF(a){return!Eb.App.oa.Da.isEditingAllowed||ya.SessionStatusManager.instance.gi?!1:""!==this.FDc(a.Ud)}DF(a){if(!this.AF(a))return!1;
this.mGa&&this.nfn(a);this.xA=this.w6.Qwb();this.Whn(a);this.Xhn();({B2b:this.C9c,T3b:this.ega}=this.QCi(this.Dfe));this.Yhn();this.Iga=a.JF;this.mu=new Sys.UI.Point(0,0);[this.Mmg,this.Kmg]=this.w6.getDimensions();r.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}GM(a){this.Pfa=a.JF;this.UZj();this.l8c=og.b(this.mu.x,this.mu.y,this.Mmg,this.Kmg,this.C9c,this.ega,this.l8c,l.AFrameworkApplication.K.$("SmoothImageHelperGetScaleIsEnabled"));this.w6.x0f(this.l8c,this.C9c,this.ega);
return!0}nx(){this.setSize();r.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}zK(){this.w6.$Lf();r.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")}nfn(a){this.w6=Di.a.Ra(a.Ud,Qc.a)}Xhn(){this.Dfe=(Math.floor((this.xA+22)/45)%8+this.FDa)%8}QCi(a){let c,h;if(this.xA&&90!==this.xA&&180!==this.xA&&270!==this.xA&&360!==this.xA||this.cNl(a))return{B2b:!0,T3b:!0};c=h=!1;switch(a){case 1:case 5:c=!0;break;case 3:case 7:h=!0}return{B2b:h,T3b:c}}Yhn(){this.OPa=this.NPa=!1;switch(this.Dfe){case 0:this.OPa=
this.NPa=!0;break;case 1:case 2:this.OPa=!0;break;case 7:case 6:this.NPa=!0}}cNl(a){return!(a%2)}FDc(a){var c=a.classList.toString();-1===c.indexOf("WACImageResizeHandle")&&a.parentNode&&(c=a.parentNode.classList.toString());a=c.split(" ");for(c=0;c<a.length;c++){const h=a[c].toString();if(h.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==h)return h}return""}Whn(a){switch(this.FDc(a.Ud)){case "WACImageResizeHandleNW":this.FDa=0;break;case "WACImageResizeHandleN":this.FDa=1;break;case "WACImageResizeHandleNE":this.FDa=
2;break;case "WACImageResizeHandleE":this.FDa=3;break;case "WACImageResizeHandleSE":this.FDa=4;break;case "WACImageResizeHandleS":this.FDa=5;break;case "WACImageResizeHandleSW":this.FDa=6;break;case "WACImageResizeHandleW":this.FDa=7}}UZj(){var a=1;this.Lj.instance&&(a=this.Lj.instance.ei);const c=(this.Pfa.x-this.Iga.x)/a;a=(this.Pfa.y-this.Iga.y)/a;this.mu.x=this.NPa?-c:c;this.mu.y=this.OPa?-a:a}setSize(){const a=new uh.DictionaryPropertySet;a.setValue(Uc.a.aHc,100*this.l8c);a.setValue(Uc.a.DLh,
!0);if(90===this.xA||270===this.xA){let c,h;({B2b:c,T3b:h}=this.QCi(this.FDa));a.setValue(Uc.a.Kef,c);a.setValue(Uc.a.Lef,h)}else a.setValue(Uc.a.Kef,this.C9c),a.setValue(Uc.a.Lef,this.ega);this.ga.hb(zb.a.d1b,2,a)}}Object(w.a)(xl,"ImageResizeDragAdapter",null,[159]);class sq{constructor(a,c){this.ga=a;this.Lj=c}w3k(a){return new xl(a,this.ga,this.Lj)}}Object(w.a)(sq,"ImageResizeDragAdapterFactory",null,[580]);var Tm=b(638),ri=b(487),al=b(134),Of=b(136);class zg{constructor(a,c,h,v,B,X){this.Lx=this.Py=
this.Qmb=this.Pfa=this.Iga=this.KRa=null;this.RQa=this.BSa=0;this.Pa=null;this.Yf=this.Xye=!1;this.ga=a;this.ya=c;this.Od=h;this.w6=v;this.Lj=B;this.zmc=this.BJ=0;this.Y6=X}Vrd(){this.Y6?ya.SessionStatusManager.instance.gi||(this.Lx=Tm.a.createElement(this.Y6.ownerDocument,ri.a.span),this.Lx.className="WacImgRotateHandle WacImgRotateBase",this.Py=Fd.createClusteredImage(24,24,"RotationArrow_24x24x32","WacImgRotateArrow",!1,""),this.Py.style.left="-12px",this.Py.style.position="absolute",this.Lx.appendChild(this.Py),
this.Y6.appendChild(this.Lx),this.Xye=!0):r.ULS.sendTraceTag(50868820,322,15,"_selectElement is null when creating rotate handle")}HYb(a){this.Xye&&!this.Yf||r.ULS.sendTraceTag(50597971,322,15,"{0}",{["Message"]:"FlipRotateGripper called before create gripper or after dispose",["RotationGripperCreated"]:this.Xye,["IsDisposed"]:this.Yf});this.Lx&&this.Py||(r.ULS.sendTraceTag(50597972,322,15,"{0}",{["Message"]:"_rotateHandle or _rotateGripper is null. Call CreateRotationHandle again",["SelectElementIsNull"]:!this.Y6,
["RotateHandleIsNull"]:!this.Lx,["RotateGripperIsNull"]:!this.Py}),this.Vrd());a?(this.Py&&this.Py.classList.add("Flipped"),this.Lx&&this.Lx.classList.add("Flipped"),al.a.Z_d(this.Py,!0,!0)):(this.Py&&this.Py.classList.remove("Flipped"),this.Lx&&this.Lx.classList.remove("Flipped"),al.a.Z_d(this.Py,!1,!1))}QBd(){this.Vrd();return this.Py}AF(a){return Eb.App.oa.Da.isEditingAllowed&&a&&!ya.SessionStatusManager.instance.gi?(this.KRa=this.ya.If)?!0:!1:!1}DF(a){if(!this.AF(a))return!1;this.KRa=this.ya.If;
if(this.Pa=dd.ImageReader.Jk(this.KRa))return this.Iga=this.Eia(a),this.Qmb=Sys.UI.DomElement.getBounds(this.Y6),this.BSa=0<dd.ImageReader.MDc(this.Pa)?dd.ImageReader.MDc(this.Pa):0,this.RQa=dd.ImageReader.k8e(this.Pa),r.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;r.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");return!1}GM(a){this.Pfa=this.Eia(a);this.bOe();if(this.w6)return this.w6.bdc(this.BJ,this.zmc),r.ULS.sendTraceTag(25179723,
322,100,"Image rotate drag move is happening."),!0;r.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}nx(){this.BSa=this.BJ=og.c(this.BJ);this.d$();r.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}zK(){this.w6.bdc(this.RQa,0);r.ULS.sendTraceTag(22052888,322,50,"Image rotate drag event canceled.")}Eia(a){return this.Od.PIa(a)}bOe(){var a=1;this.Lj&&this.Lj.instance&&(a=this.Lj.instance.ei);var c=new Sys.UI.Point(this.Qmb.x+
this.Y6.clientWidth/2*a,this.Qmb.y+this.Y6.clientHeight/2*a);a=og.a(this.Iga,c);c=og.a(this.Pfa,c);this.BJ=Math.round(Of.a.Sli(c-a));0<this.BSa&&(this.BJ+=this.BSa-this.RQa);this.zmc=this.BJ;this.BJ+=this.RQa}d$(){const a=new uh.DictionaryPropertySet;a.setValue(Uc.a.e1b,0);a.setValue(Uc.a.kK,this.BJ);this.ga.hb(zb.a.imageRotate,2,a)}dispose(){r.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");this.Yf||(this.Lx&&(this.Py&&this.Lx.contains(this.Py)&&(this.Lx.removeChild(this.Py),
this.Py=null),this.Y6&&this.Y6.contains(this.Lx)&&(this.Y6.removeChild(this.Lx),this.Lx=null)),this.Yf=!0)}}Object(w.a)(zg,"ImageRotateDragAdapter",null,[577,159,14]);class Dl{constructor(a,c,h){this.ga=a;this.ya=c;this.Lj=h}create(a,c,h){return new zg(this.ga,this.ya,a,c,this.Lj,h)}}Object(w.a)(Dl,"ImageRotateDragAdapterFactory",null,[579]);var Cm=b(964),bo=b(38);class Ol{constructor(a,c,h,v){this.Qmb=this.Pfa=this.Iga=this.KRa=null;this.RQa=this.BSa=0;this.Pa=null;this.ga=a;this.ya=c;this.Lj=h;
this.zmc=this.BJ=0;this.Rb=v}AF(a){return Eb.App.oa.Da.isEditingAllowed&&!ya.SessionStatusManager.instance.gi&&a&&this.uRl(a.Ud)?(this.KRa=this.ya.If)?!0:!1:!1}HYb(){}QBd(){return null}DF(a){if(!this.AF(a))return!1;this.w6=Di.a.Ra(a.Ud,Qc.a);if(!this.w6)return!1;this.Y6=this.w6.GUc;if(!this.Y6)return!1;this.KRa=this.ya.If;this.Pa=dd.ImageReader.Jk(this.KRa);if(!this.Pa)return!1;this.Iga=this.Eia(a);this.Qmb=Sys.UI.DomElement.getBounds(this.Y6);this.BSa=0<dd.ImageReader.MDc(this.Pa)?dd.ImageReader.MDc(this.Pa):
0;this.RQa=dd.ImageReader.k8e(this.Pa);return!0}GM(a){this.Pfa=this.Eia(a);this.bOe();if(this.w6)return this.w6.bdc(this.BJ,this.zmc),!0;r.ULS.sendTraceTag(538809933,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}nx(){this.BSa=this.BJ=og.c(this.BJ);this.d$()}zK(){this.w6.bdc(this.RQa,0)}uRl(a){return Object(bo.a)(a,Cm.c)||Object(bo.a)(a,Cm.b)||Object(bo.a)(a,Cm.a)||!!a.parentElement&&Object(bo.a)(a.parentElement,Cm.a)}Eia(a){return this.Rb.rc.PIa(a)}bOe(){var a=1;
this.Lj&&this.Lj.instance&&(a=this.Lj.instance.ei);var c=new Sys.UI.Point(this.Qmb.x+this.Y6.clientWidth/2*a,this.Qmb.y+this.Y6.clientHeight/2*a);a=og.a(this.Iga,c);c=og.a(this.Pfa,c);this.BJ=Math.round(Of.a.Sli(c-a));0<this.BSa&&(this.BJ+=this.BSa-this.RQa);this.zmc=this.BJ;this.BJ+=this.RQa}d$(){const a=new uh.DictionaryPropertySet;a.setValue(Uc.a.e1b,0);a.setValue(Uc.a.kK,this.BJ);this.ga.hb(zb.a.imageRotate,2,a)}}Object(w.a)(Ol,"ImageRotateDragAdapterSimplified",null,[577,159]);class El{constructor(){this.W=
null}get name(){return"Box4.Images"}yb(a){this.W=a;this.W.ha("Box4.Images.ImageResizeDragAdapter",()=>new xl(null,l.AFrameworkApplication.pa,xa.a.instance.za("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapter").singleInstance();this.W.ha("Box4.Images.ImageRotateDragAdapterUpdated",()=>new Ol(l.AFrameworkApplication.pa,$c.a.instance,xa.a.instance.za("Common.IZoomManager"),ec.InteractiveViewManager.instance)).as("Box4.Images.IImageRotateDragAdapter").singleInstance();this.W.ha("Box4.Images.ImageResizeDragAdapterFactory",
()=>new sq(l.AFrameworkApplication.pa,xa.a.instance.za("Common.IZoomManager"))).as("Box4.Images.IImageResizeDragAdapterFactory").singleInstance();this.W.ha("Box4.Images.ImageRotateDragAdapterFactory",()=>new Dl(l.AFrameworkApplication.pa,$c.a.instance,xa.a.instance.za("Common.IZoomManager"))).as("Box4.Images.IImageRotateDragAdapterFactory").singleInstance()}init(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SingleImageDragAdapterIsEnabled",
!1)?(this.W.resolve("Box4.Images.IImageResizeDragAdapter"),this.W.resolve("Box4.Images.IImageRotateDragAdapter")):(this.W.resolve("Box4.Images.IImageResizeDragAdapterFactory"),this.W.resolve("Box4.Images.IImageRotateDragAdapterFactory"))}dispose(){}static main(){M.a.instance.Lb(new El)}}Object(w.a)(El,"Box4ImagesPackage",null,[1,2]);var jp=b(269),ii=b(109),Yb=b(6),dh=b(628),of=b(447),Dm=b(626),kg=b(18),Um=b(253),Vm=b(254),An=b(1593),xg=b(1649),tk=b(1054);class yl extends xg.a{constructor(a,c,h){super(a,
c,h);this.hdd=this.z7a=null}get MV(){return l.AFrameworkApplication.na.Qo}vzd(a){switch(a){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}}w_c(a){return yl.Eta(a,this.uFh())}uFh(){return yl.qFe}Eta(a,c=null){a=this.w_c(a);return 0!==a?(c&&c.Mkd(),2===a&&(c=this.vzd(a),this.fo(this.juh(a),c)),!1):!0}xIa(a,c){r.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.aBf=c;bh.a.mark(5576);this.hdd=
this.MV.Pe("LoadResource","PictureUploadTime");this.OGd()?this.JYd(a):this.XOc()}fo(a,c){const h=new oe.StandardDialog;h.yc=0;h.Fw(a,CommonUIStrings.l_ImageUploadFailedTitle,c,null)}XOc(){r.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");super.XOc();this.hdd&&(this.hdd.stop(),this.hdd=null)}WGb(){this.z7a=(new tk.a).create();this.z7a.message=CommonUIStrings.l_ImageUploadWait;this.z7a.yc=5;this.z7a.Zr=!1;this.z7a.PK(null,null,null)}Kpd(){this.z7a&&(this.z7a.close(),this.z7a=null)}static Mtl(a,
c){a=F.a.kg(a);for(let h=0;h<c.length;++h)if(a.endsWith(c[h]))return!0;return!1}static Eta(a,c=null){c||(c=yl.qFe);return a?yl.Mtl(a,c)?0:2:1}}yl.qFe=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(w.a)(yl,"PictureUploader",xg.a,[]);var Wm;(function(a){a[a.validPicture=0]="validPicture";a[a.noPictureSpecified=1]="noPictureSpecified";a[a.invalidExtension=2]="invalidExtension";a[a.pictureTooLarge=3]="pictureTooLarge"})(Wm||(Wm={}));Object(w.b)("PictureValidationResult",Wm);var Be=b(58),Ed=
b(17),zi=b(42),fi=b(247);class zl{constructor(){this.mR=null}}Object(w.a)(zl,"ImageData",null,[]);var Qk=b(48),kk=b(1594),$l=b(1433),tp=b(1467);class Fl extends gg.a{constructor(a,c=!0){super(!1,!1,Fl.vP);this.nQb=null;this.sig=!1;this.iw=[];this.Mq=null;this.B7a=a;this.cuj=c;this.q6=this.NHg=!1;this.vSa=null;this.Eie=!1;this.vf=this.Utk;this.jf="InsertFileDialog";this.Nd(1,this.gkd);Fl.vP?(this.nQb={["id"]:this.jf,["bodyControls"]:{["uploadButtonProps"]:{["label"]:CommonUIStrings.l_DialogChooseFile,
["onExecute"]:Object(m.a)(this,this.num,"onUploadButtonClick")}},["uploadStatusLabel"]:CommonUIStrings.l_DialogNoFileChosen,["onFrameReady"]:Object(m.a)(this,this.Ynm,"onFrameReady")},this.Tg(this.titleText,Object(m.a)(this,this.EGd,"insertDialogHandler"),this.nQb),this.jT=!0):(this.showDialog(this.titleText,Object(m.a)(this,this.EGd,"insertDialogHandler")),c&&this.ckn(),(a=this.qyd(1))&&this.iw.push(a),(a=this.qyd(0))&&this.iw.push(a),this.cVi(),this.jT=!1)}get LWi(){return this.B7a}validate(){this.Mq.mR||
r.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Mq.mR.value?!0:(Fl.Fw(CommonUIStrings.l_FileUploadNoFileSpecified),!1)}Ynm(a){this.cuj&&(this.Mq=this.RDi(a,this.B7a))}num(){this.Mq&&this.Mq.mR&&(this.sig||(this.Mq.bTm(Object(m.a)(this,this.yyf,"onFileChosen")),this.sig=!0),this.Mq.Wkh())}yyf(a){this.nQb.uploadStatusLabel=a;this.P5(this.titleText,Object(m.a)(this,this.EGd,"insertDialogHandler"),this.nQb)}EGd(a){1===a&&this.isEnabled()?Fl.vP&&this.Mq.mR&&!this.Mq.mR.value?
(this.nQb.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.P5(this.titleText,Object(m.a)(this,this.EGd,"insertDialogHandler"),this.nQb)):(this.iFd(),this.B7a.xIa(this.Mq,Object(m.a)(this,this.dispose,"dispose"))):0===a&&this.hide()}ckn(){this.Eie=!1;this.Mq=this.RDi(document.getElementById("uploadFrameContainer"),this.B7a);l.AFrameworkApplication.K.$("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.vSa=Object(m.a)(this,this.bBf,"onUploadFrameLoad"),Ld.a.addHandler(this.Mq.iFrame,
"load",this.vSa));this.Mq.mR||r.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.Wji()}bBf(){this.Wji()}Wji(){if(this.Mq&&!this.Eie){var a=this.Mq.mR;a&&(Ld.a.addHandler(a,Jb.a.ah,Object(m.a)(this,this.onKeyDown,"onKeyDown")),a=[a],this.iw=a.concat.apply(a,this.iw),this.cVi(),this.Eie=!0)}}dispose(){if(this.Mq&&!Fl.vP){const a=this.Mq.mR;a&&Ld.a.removeHandler(a,Jb.a.ah,Object(m.a)(this,this.onKeyDown,"onKeyDown"));this.vSa&&Ld.a.removeHandler(this.Mq.iFrame,"load",this.vSa)}this.Mq=
null;super.dispose()}cVi(){if(0<this.iw.length){const a=new Qe(this.iw),c=nc.FocusManager.instance().gk();c&&(this.iw[0].focus(),c.Sh=a,c.mV=!0)}}onKeyDown(a){4!==nc.FocusManager.instance().aki(a)&&a.preventDefault()}static get vP(){return l.AFrameworkApplication.na.Ya.fA&&l.AFrameworkApplication.na.Ya.KVh}static Fw(a){const c=document.getElementById("errorText");c.innerText=a;c.style.display="inline-block"}}Object(w.a)(Fl,"InsertFileDialog",gg.a,[]);class Dp{static get vf(){return gg.a.fy(Dp.ll,
CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}Dp.ll="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(w.a)(Dp,"InsertImageDialogHtml",null,[]);class cn extends Fl{constructor(a,c=!0){super(a,c)}get gkd(){return CommonUIStrings.l_ImageUploadButtonText}get titleText(){return CommonUIStrings.l_ImageUploadingTitle}get Utk(){return Dp.vf}validate(){this.Mq.mR||
r.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var a=Object(ha.a)(yl,this.LWi);const c=a.w_c(this.Mq.mR.value);return 0!==c?(a=a.vzd(c),Fl.Fw(a),!1):!0}}Object(w.a)(cn,"InsertImageDialog",Fl,[]);class Ck extends cn{constructor(a){super(a)}RDi(a,c){const h=l.AFrameworkApplication.na.Ya.fA&&l.AFrameworkApplication.na.Ya.KVh;return new tp.a(a,Object(m.a)(c,c.U6b,"onUploadFrameInitialized"),Object(m.a)(c,c.Ata,"uploadResponseReceived"),l.AFrameworkApplication.K,!h)}isEnabled(){return Ck.gx.tha(this.LWi.context)}static get gx(){return Ck.Og||
(Ck.Og=xa.a.instance.resolve("Box4.Images.IImageEditor"))}}Ck.Og=null;Object(w.a)(Ck,"Box4InsertImageDialog",cn,[]);class dn{Cdk(a){return new Promise((c,h)=>{this.Ddk(a).then(v=>{c(v)},v=>{h(v)})})}P6g(a){return new Promise((c,h)=>{const v=new FileReader;v.addEventListener("load",()=>{c(v.result)},!1);v.addEventListener("error",()=>{h("FileReader exception ("+v.error.name+")")});v.readAsDataURL(a)})}Ddk(a){return new Promise((c,h)=>{this.P6g(a).then(v=>{this.HSe(v,"image/jpeg").then(B=>{c(B)},B=>
{h(B)})},v=>{h(v)})})}HSe(a,c){return new Promise((h,v)=>{let B=new Image;B.addEventListener("load",()=>{const X=document.createElement("canvas"),ma=X.getContext("2d");X.width=B.width;X.height=B.height;ma.drawImage(B,0,0);h(X.toDataURL(c))});B.addEventListener("error",()=>{v("Image failed to load")});B.src=a})}}Object(w.a)(dn,"ImageFormatConverter",null,[]);const Km=["ImageInsertFailed"];class am extends yl{constructor(a,c,h,v,B,X,ma=!0){super(a,c,h);this.Nua=this.Sk=this.yE=this.Jd=null;this.wkh=
"wwaengidc";this.kpiName="ImageFileExtension";this.Llc="LocalDeviceUpload";this.UR=new Map;this.clh=0;this.A7a=null;this.Cie="";this.Yma=0;this.yj=null;this.Nmb="";this.uug=50;this.Vjg=this.Qic=this.wrc=this.Mnc=!1;this.wug=19922944;this.Mwg=0;this.Gie=[];this.qig=[];this.Ite=0;this.r9c=!1;this.Xd=v;this.Xi=B;this.ga=X;this.utg=h.$("WACLocalRenderingForInsertLocalImageIsEnabled");this.Kug=h.vb("ImageUploadMaxByteSize",Number.MAX_VALUE);this.r9c=!!h&&h.getBooleanFeatureGate("Microsoft.Office.WordOnline.PictureUploadSupportsWebp",
!1);ma&&this.showDialog();Eb.App.ZXf.addHandler(this)}get tTh(){return this.K.$("JfifImageInsertIsEnabled")}get M0(){return this.Llc}get fileExtension(){return this.Cie}get fileSize(){return this.Yma}get KWi(){return this.A7a}get Xu(){return this.yj||(this.yj=xa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get ngf(){return!H.a.dA&&this.M0===this.Llc}showDialog(){$l.a(this.K)?(this.mXb=!1,this.Mq=new tp.a(document.body,Object(m.a)(this,this.U6b,"onUploadFrameInitialized"),Object(m.a)(this,this.Ata,
"uploadResponseReceived"),this.K,!1,void 0,!0)):$l.b()||this.lCb&&H.a.CF?(this.mXb=!1,this.Mq=new tp.a(document.body,Object(m.a)(this,this.U6b,"onUploadFrameInitialized"),Object(m.a)(this,this.Ata,"uploadResponseReceived"),this.K,!1)):(this.mXb=!0,this.Mq=(new Ck(this)).Mq)}juh(a){switch(a){case Wm.noPictureSpecified:return Qk.a.noPictureSpecified;case Wm.invalidExtension:return Qk.a.NDl;case Wm.pictureTooLarge:return Qk.a.a0h}return Ni.a.unknown}JYd(a){this.ngf||(this.Jd.Eh()?(r.ULS.sendTraceTag(36783362,
322,50,"Box4PictureUploader.ReplicatePlaceholder"),kk.a.instance.W0f(this.Jd.Eh()),this.Jd.Eh().contentReplicator.forceOutbound(Object(m.a)(this,this.Wzf,"onPlaceholderNodeSaved"),Object(m.a)(this,this.MZa,"processFailure"),a)):this.MZa(a,157))}cQl(){return $l.c(this.Jd)}Wzf(a){r.ULS.sendTraceTag(36783363,322,50,"Box4PictureUploader.OnPlaceholderNodeSaved");if(a){var c={},h=this.yE?this.yE.properties.Gb.toString():this.Jd.Gb.toString();c[of.a.kc]=this.yE?this.yE.id.toString():this.Jd.id.toString();
c[of.a.classId]=h;this.Xd.hasProperty(Yb.a.imageType)&&(c[dh.a.imageType]=this.Xd.getValue(Yb.a.imageType));this.Xd.hasProperty(Yb.a.DR)&&(c[dh.a.DR]=this.Xd.getValue(Yb.a.DR));this.Xd.hasProperty(ii.a.Yba)&&(c[dh.a.Yba]=this.Xd.getValue(ii.a.Yba));kg.a.instance.J(4)&&this.Xd.hasProperty(Yb.a.Pdb)&&(c[dh.a.Pdb]=this.Xd.getValue(Yb.a.Pdb));$l.d(a,this.Jd,this.Sk,c)&&(this.tXc(a),am.d6b++)}else r.ULS.sendTraceTag(16869584,352,15,"InsertPicture:UploadFrame is null")}tXc(a){a.tXc();this.A7a=a.A7a}Ata(a){this.clh=
+new Date-+this.KWi;this.gNd();r.ULS.sendTraceTag(36783364,322,50,"Box4PictureUploader.UploadResponseReceived");$l.e(this,a,this.Jd)}ySn(){r.ULS.sendTraceTag(36783365,322,50,"Box4PictureUploader.UploadComplete");this.XOc();am.d6b--;this.ga.processAction(Sa.a.q1a,2);this.Jd?kk.a.instance.idc(this.Jd.Eh(),0):r.ULS.sendTraceTag(42468439,339,50,"Not able to notify upload notifier for completion");this.Xu.sendNotification(Box4Intl.Box4Strings.l_ImageUploaded,!0)}MZa(a,c){if(this.q4m(a))r.ULS.sendTraceTag(16798870,
352,50,"InsertPicture:OutboundRetry:Retry={0}:Error={1}",this.retryCount,c.toLocaleString());else{a=Object.assign(new fi.a,{extendedProperties:new Map});a.extendedProperties.set("result",c.toLocaleString());Fa.Health.instance.recordQosError("PictureFromLocalUploadRequestFailed",Km,!1,!0,!1,!1,a);a=this.u0e(c);r.ULS.sendTraceTag(16798871,352,10,"InsertPicture:Failure:Retries={0}:Error={1}",this.retryCount,c.toLocaleString());var h=this.Jd.sF(),v=new gf.GraphTransaction(15,zb.a.DO);v.Oa(this.Jd);am.gx.vea(this.Xd,
a);am.gx.aXm(this.Jd,this.yE);dd.ImageReader.HBi(this.Xd);v.dispose();this.XHi(a);this.Xi.yVb(h,!1);this.XOc();am.d6b--;kk.a.instance.idc(this.Jd.Eh(),c)}}XHi(a){const c=new oe.StandardDialog;c.yc=0;c.Fw(Qk.a.invalidImageFile,CommonUIStrings.l_ImageUploadFailedTitle,a,null)}u0e(a){switch(a){case 23:return Box4Intl.Box4Strings.l_ImageUploadSizeError;default:return Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord}}x3i(a){return new Promise(c=>{const h=new FileReader;h.addEventListener("load",()=>{h.result.length>
this.wug?this.W0h():(this.Nmb+=String.format('<img src="{0}"></img>',h.result),this.Ite++);c()},!1);h.addEventListener("error",()=>{r.ULS.sendTraceTag(545093780,322,10,"Box4PictureUploader.PopulateImagePasteHTML fileReader error {0}",h.error);c()});h.readAsDataURL(a)})}W1i(){if(this.Nmb&&0<this.Nmb.length){const a=new uh.DictionaryPropertySet;a.setValue(Uc.a.jS,this.Nmb);a.setValue(Uc.a.Q8,!0);this.ga.hb(zb.a.F_,2,a)}this.Uqn()}Uqn(){let a="";this.Vjg?a=Box4Intl.Box4Strings.l_ImageUploadFailedMsgWord:
this.Mnc&&this.Qic&&this.wrc?a=Box4Intl.Box4Strings.l_MultipleImageUploadFormatSizeAndMaxNumberExceededError:this.Mnc&&this.Qic?a=Box4Intl.Box4Strings.l_MultipleImageUploadFormatAndMaxNumberExceededError:this.Mnc&&this.wrc?a=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndMaxNumberExceededError:this.wrc&&this.Qic?a=Box4Intl.Box4Strings.l_MultipleImageUploadSizeAndFormatError:this.wrc?a=Box4Intl.Box4Strings.l_MultipleImageUploadSizeError:this.Qic?a=Box4Intl.Box4Strings.l_MultipleImageUploadFormatError:
this.Mnc&&(a=Box4Intl.Box4Strings.l_MultipleImageUploadMaxNumberExceededError);""!==a&&(this.XHi(a),this.D2i())}tGj(a){this.Nmb+=String.format('<img src="{0}"></img>',a);this.Ite++}W0h(){this.wrc=!0;r.ULS.sendTraceTag(524873990,322,10,"Image too large");const a=Object.assign(new fi.a,{extendedProperties:new Map});a.extendedProperties.set("type","Image too large");Fa.Health.instance.recordQosError("PictureFromLocalInvalid",Km,!0,!0,!1,!1,a)}V0h(){this.Qic=!0;r.ULS.sendTraceTag(545093781,322,10,"Image filetype not supported");
const a=Object.assign(new fi.a,{extendedProperties:new Map});a.extendedProperties.set("type","Filetype invalid");Fa.Health.instance.recordQosError("PictureFromLocalInvalid",Km,!0,!0,!1,!1,a)}R0h(a){this.Vjg=!0;r.ULS.sendTraceTag(524873991,322,15,"Something went wrong during paste with format conversion: {0}",a)}fwn(a){const c=new dn;if(this.w_c(a.name)===Wm.validPicture)return c.P6g(a);if(yl.Eta(a.name,tp.a.rFe)===Wm.validPicture)return c.Cdk(a)}Kdk(a){return new Promise(c=>{const h=this.fwn(a);void 0===
h&&(this.R0h("Failed starting conversion work"),c());h.then(v=>{v.length>this.wug?this.W0h():this.tGj(v);c()},v=>{this.R0h(v);c()})})}FUl(a){return this.w_c(a.name)===Wm.validPicture||yl.Eta(a.name,tp.a.rFe)===Wm.validPicture}cDl(){const a=[];if(this.Mq.mR.files){this.Mwg=this.Mq.mR.files.length;this.Mq.mR.files.length>this.uug&&(this.Mnc=!0);this.r9c&&this.WGb();for(let c=0;c<this.Mq.mR.files.length&&this.uug;c++){const h=this.Mq.mR.files[c];this.Gie.push(h.name);this.qig.push(h.size);h&&(this.r9c?
this.FUl(h)?a.push(this.Kdk(h)):this.V0h():this.w_c(h.name)!=Wm.validPicture?this.V0h():a.push(this.x3i(h)))}}Promise.all(a).then(()=>{this.r9c&&this.Kpd();this.W1i()});return!0}PDl(){this.Sk=Ya.a.create();this.Xd||(this.Xd=new uh.DictionaryPropertySet);this.utg&&this.Nua&&this.Xd.setValue(ii.a.i0h,this.Nua);var a=480;let c=320;var h=this.context.view;this.K.$("WordEditorAutoResizeImageIsEnabled")&&(h=h.Vf.editingElement.clientWidth,0<h&&h<a&&(c=Math.floor(1*h/a*c),a=h,this.Xd.setValue(ii.a.Yba,h)));
this.Xd.setValue(Ed.a.A4,Be.a.ym(a,0));this.Xd.setValue(Ed.a.Rja,Be.a.ym(c,1));this.Xd.setValue(zi.a.CX,1);this.Xd.setValue(Uc.a.Q8,!0);kg.a.instance.J(4)&&this.Xd.setValue(Yb.a.Pdb,Box4Intl.Box4Strings.l_Picture);a=am.gx.Heh(this.context,this.Xd,this.Sk);if(!a)return!1;this.Jd=a.node;this.Xd=(this.yE=a.blob)?this.yE.properties:this.Jd.properties;kg.a.instance.J(4)&&Eb.App.lc.$n&&Eb.App.lc.zp.aF(this.Jd);return!0}OGd(){return this.ngf?this.cDl():this.PDl()}D2i(){this.UR.set("FileExtensions",this.QVk());
this.UR.set("FileSizeInBytes",this.qig.toString());this.UR.set("Source",this.M0);this.UR.set("NumberOfImagesAttemptedToInsert",this.Mwg.toString());this.UR.set("NumberOfImagesPasted",this.Ite.toString());Fa.Health.instance.recordKpiUsage("MultipleImageInsert",0,this.wkh,this.UR)}QVk(){let a="";for(let c=0;c<this.Gie.length;++c)a=a+this.Auh(this.Gie[c])+",";return a}xIa(a,c){this.utg&&(this.Nua=new zl,this.Nua.mR=a.mR);super.xIa(a,c)}U6b(a){this.Mq=a;if(!this.mXb){if(this.K7d){if($l.a(this.K)||this.lCb&&
H.a.CF){a.Ttd(Object(m.a)(this,this.Inm,"onFileChosen$2"));return}const c=a.Ttd(null),h=this.Buh(a);h&&(this.Cie=h.name,this.Yma=h.size);if(!this.Eta(c,a)||!this.M1f(h,a)){a=Object.assign(new fi.a,{extendedProperties:new Map});a.extendedProperties.set("type",this.Eta(c,this.Mq)?"Image too large":"FileType invalid");Fa.Health.instance.recordQosError("PictureFromLocalInvalid",Km,!0,!0,!1,!1,a);this.gNd();return}}this.xIa(a,null)}}Inm(a){if(!this.ngf){var c=this.Buh(this.Mq);c&&(this.Cie=c.name,this.Yma=
c.size);if(!this.Eta(a,this.Mq)||!this.M1f(c,this.Mq)){c=Object.assign(new fi.a,{extendedProperties:new Map});c.extendedProperties.set("type",this.Eta(a,this.Mq)?"Image too large":"FileType invalid");Fa.Health.instance.recordQosError("PictureFromLocalInvalid",Km,!0,!0,!1,!1,c);this.gNd();return}}this.xIa(this.Mq,null)}YEd(){return!!am.d6b}gNd(){this.UR.set("FileExtension",this.Auh(this.fileExtension));this.UR.set("Source",this.M0);this.UR.set("FileSizeInBytes",this.fileSize.toString());this.UR.set("RequestTimeInMs",
this.clh.toString());Fa.Health.instance.recordKpiUsage(this.kpiName,0,this.wkh,this.UR)}Auh(a){return a&&(a=a.split("."),1<a.length)?a[a.length-1].substring(0,4):""}uFh(){return this.tTh?tp.a.MKg:yl.qFe}Buh(a){return(a=a.mR)?a.files[0]:null}M1f(a,c){return a&&a.size>this.Kug?(c&&c.Mkd(),a=this.vzd(Wm.pictureTooLarge),this.fo(this.juh(Wm.pictureTooLarge),a),!1):!0}vzd(a){switch(a){case Wm.noPictureSpecified:return CommonUIStrings.l_ImageUploadNoFileSpecified;case Wm.invalidExtension:return this.tTh?
CommonUIStrings.l_WordImageUploadUnsupportedFileType:CommonUIStrings.l_ImageUploadUnsupportedFileType;case Wm.pictureTooLarge:return String.format(CommonUIStrings.l_ImageUploadSizeErrorWithLimit,Math.round(this.Kug/1E6));default:return""}}static get gx(){return am.Og||(am.Og=xa.a.instance.resolve("Box4.Images.IImageEditor"))}}am.Og=null;am.d6b=0;Object(w.a)(am,"Box4PictureUploader",yl,[641,642]);var kp=b(876),uk=b(123);class Gj{constructor(){this.Vq=this.Xo=this.mpb=this.GIg=this.nKb=this.t$i=null;
this.Bye=0;this.Kma=this.Ete=this.Bpb=null;this.edg=0;this.qbe=this.YZ=this.Vpe=null;this.Yng=!1;this.Bae=this.xae=this.Cae=null}get assetId(){return this.nKb}get thumbnailUrl(){return this.GIg}get QEm(){return this.mpb}get displayName(){return this.Kma}get dimensions(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,this.Xo,this.Vq)}get kKj(){if(this.xae&&this.Bae&&this.Cae){const a=document.createElement("a");a.setAttribute("href",this.Cae);a.setAttribute("target","_blank");
a.innerText=this.Bae;return a}return null}get KQg(){return this.xae}get fileSize(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this.edg)}get kMm(){const a=document.createElement("span");var c=0;if(this.Bpb&&0<this.Bpb.length){var h=this.Bpb.indexOf("."),v=0>h?this.Bpb:this.Bpb.substring(0,h);for(v=Number.parseInvariant(v);c<v&&5>c;c++)a.appendChild(Fd.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",uk.a.Ah("box42.png"),"","",!0,""));0<h&&(h=Number.parseInvariant(this.Bpb.substr(h+
1)),3>h?a.appendChild(Fd.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",uk.a.Ah("box42.png"),"","",!0,"")):8>h?a.appendChild(Fd.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",uk.a.Ah("box42.png"),"","",!0,"")):a.appendChild(Fd.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",uk.a.Ah("box42.png"),"","",!0,"")),c++)}for(;5>c;c++)a.appendChild(Fd.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",uk.a.Ah("box42.png"),"","",!0,""));this.Ete&&
(c=document.createElement("span"),c.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this.Ete),a.appendChild(c));return a}get K2m(){return 0<this.Bye?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this.Bye):""}get zRj(){if(this.Yng){var a=document.createElement("span");a.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity;return a}if(this.qbe&&this.YZ)return Gj.ejk(this.qbe,this.YZ);a=document.createElement("span");a.innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft;
return a}get keywords(){let a;if(this.Vpe){const c=this.Vpe.split(",");a=Array(c.length);for(let h=0;h<c.length;h++)a[h]=c[h].trim()}else a=[];return a}static qOk(a){const c=new Gj;for(let h=0;h<a.childNodes.length;h++){const v=a.childNodes[h];if(1===v.nodeType)try{const B=v.firstChild.nodeValue;switch(v.nodeName){case "src":c.t$i=B;break;case "assetid":c.nKb=B;break;case "thumb":"64x64"===v.attributes.getNamedItem("size").nodeValue?c.GIg=Gj.AQi(B):"192x192"===v.attributes.getNamedItem("size").nodeValue&&
(c.mpb=Gj.AQi(B));break;case "imagedim":if(B){const ma=B.indexOf("x");0<ma&&ma<B.length&&(c.Xo=B.substr(0,ma),c.Vq=B.substr(ma+1))}break;case "resolution":c.Bye=Number.parseInvariant(B);break;case "rating":c.Bpb=B;break;case "numofratings":c.Ete=B;break;case "displayname":c.Kma=B;break;case "contentlength":c.edg=Number.parseInvariant(B)/1024;break;case "subject":c.Vpe=B;break;case "provider":c.YZ=B;break;case "attributionlink":c.qbe=B;break;case "iscsc":c.Yng=1===Number.parseInvariant(B);break;case "additional":const X=
v.firstChild;if(v.hasChildNodes()&&X&&"id"===X.nodeName&&1===Number.parseInvariant(X.text))for(let ma=0;ma<v.childNodes.length;ma++){const Pa=v.childNodes[ma];switch(Pa.nodeName){case "caption":c.xae=Pa.text;break;case "value":c.Cae=Pa.text;break;case "string":c.Bae=Pa.text}}}}catch(B){}}return c}static ejk(a,c){const h=document.createElement("a");h.setAttribute("href",a);h.setAttribute("target","_blank");h.innerText=c;return h}static AQi(a){let c;return a&&0<(c=a.indexOf("://"))?a.substr(c+1):a}}
Object(w.a)(Gj,"ClipArtSearchResult",null,[]);class Ko{static get vf(){return gg.a.fy(Ko.ll,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)}}Ko.ll="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>";
Object(w.a)(Ko,"InsertClipartDialogHtml",null,[]);class vo extends gg.a{constructor(a){super();this.Lua=this.Imb=0;this.PAg=null;this.Kwe=!1;this.YPb=this.lRa=this.xL=null;this.acg=a;this.vf=Ko.vf;this.jf="InsertClipartDialog";this.Nd(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText);this.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,Object(m.a)(this,this.yCl,"insertClipartDialogHandler"));this.Yp=document.getElementById("clipartsearchresults");this.Afd=Object(m.a)(this,this.onKeyDown,
"onKeyDown");Ld.a.addHandler(this.Yp,"keydown",this.Afd);this.zfd=Object(m.a)(this,this.onScroll,"onScroll");Ld.a.addHandler(this.Yp,"scroll",this.zfd);this.bU=document.getElementById("textInput");this.Shd=Object(m.a)(this,this.Asm,"onSearchQueryKeyDown");Ld.a.addHandler(this.bU,"keydown",this.Shd);this.Thd=Object(m.a)(this,this.Uci,"onSearchQueryAddCharacters");Ld.a.addHandler(this.bU,"keypress",this.Thd);this.Uhd=Object(m.a)(this,this.Uci,"onSearchQueryAddCharacters");Ld.a.addHandler(this.bU,"paste",
this.Uhd);this.Dfc=document.getElementById("btnSearch");this.Dfc.setAttribute("src",uk.a.Ah("search.16x16x32.png"));this.yfd=Object(m.a)(this,this.Tci,"onSearchButton");Ld.a.addHandler(this.Dfc,"click",this.yfd);this.dMb=document.getElementById("clipartpreviewimage");this.Nge=document.getElementById("clipartattributedisplayname");this.K3a=document.getElementById("clipartseesimilar");this.Mge=document.getElementById("clipartdimensions");this.Zhc=document.getElementById("clipartadditionalvalue");this.Oge=
document.getElementById("clipartratingvalue");this.rPa=document.getElementById("clipartattributionvalue");this.sPa=document.getElementById("clipartkeywords");this.Kge=document.getElementById("clipartadditionalname");this.Pge=document.getElementById("clipartratingname");this.Lge=document.getElementById("clipartattributionname");this.Mwe=Object(m.a)(this,this.frm,"onPreviewClip");this.xDe=Object(m.a)(this,this.Ftm,"onThumbnailLoadError");this.M7c=Object(m.a)(this,this.Jai,"onHyperlinkClick");this.N7c=
Object(m.a)(this,this.Fom,"onHyperlinkKeyDown");this.Tpe=Object(m.a)(this,this.bbi,"onKeywordClick");this.Upe=Object(m.a)(this,this.mpm,"onKeywordKeyDown");this.Cfd=Object(m.a)(this,this.Wci,"onSeeSimilarClick");this.Dfd=Object(m.a)(this,this.Bsm,"onSeeSimilarKeyDown");this.bU.focus();this.tea(1,!1)}dispose(){this.Yp&&this.c2g();this.Yp&&this.Afd&&(Ld.a.removeHandler(this.Yp,"keydown",this.Afd),this.Afd=null);this.Yp&&this.zfd&&(Ld.a.removeHandler(this.Yp,"scroll",this.zfd),this.zfd=null);this.Yp=
null;this.bU&&this.Shd&&(Ld.a.removeHandler(this.bU,"keydown",this.Shd),this.Shd=null);this.bU&&this.Thd&&(Ld.a.removeHandler(this.bU,"keypress",this.Thd),this.Thd=null);this.bU&&this.Uhd&&(Ld.a.removeHandler(this.bU,"paste",this.Uhd),this.Uhd=null);this.bU=null;this.Dfc&&this.yfd&&(Ld.a.removeHandler(this.Dfc,"click",this.yfd),this.Dfc=this.yfd=null);this.Lge=this.Pge=this.Kge=this.sPa=this.rPa=this.Oge=this.Zhc=this.Mge=this.K3a=this.Nge=this.dMb=this.Dfd=this.Cfd=this.Upe=this.Tpe=this.N7c=this.M7c=
this.YPb=this.xDe=this.Mwe=null;this.lRa&&(this.lRa.dispose(),this.lRa=null);super.dispose()}wS(){super.wS();document.getElementById(this.hi("WACDialogPanel")).style.width=String.format("{0}px",656)}Tci(a){const c=this.bU.value;c&&0<c.trim().length&&(this.search(this.bU.value),this.tea(1,!1));a.preventDefault();a.stopPropagation()}search(a){this.LFb(a,!1,Object(m.a)(this,this.qki,"processSearchResults"))}LFb(a,c,h){this.Lua=this.Imb=0;this.c2g();if(this.xL&&a===this.PAg&&this.Kwe===c)window.setTimeout(Object(m.a)(this,
this.seh,"displaySearchResults"),500);else{this.xL&&(Array.clear(this.xL),this.xL=null);this.PAg=a;this.Kwe=c;var v=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');v.append("<query>");v.append(F.a.Wd(a));v.append("</query>");v.append("<mediatype>Illustration</mediatype>");v.append("<mediatype>Photo</mediatype>");v.append("<filetype>jpg</filetype>");v.append("<filetype>jpeg</filetype>");v.append("<filetype>gif</filetype>");v.append("<filetype>bmp</filetype>");v.append("<filetype>tif</filetype>");
v.append("<filetype>tiff</filetype>");v.append("<filetype>png</filetype>");v.append("</search>");a=l.AFrameworkApplication.lcid.toString(16).toUpperCase();for(let B=a.length;4>B;B++)a="0"+a;l.AFrameworkApplication.fe.ai(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Eb.App.webServiceBase,a,dh.a.mtn,c.toString()),2,v.toString(),{"Content-Type":"text/xml; charset=utf-8"},!0,2,h,Object(m.a)(this,this.onError,"onError"),null)}}L8m(a){this.LFb(a.assetId,!0,Object(m.a)(this,
this.qki,"processSearchResults"));this.xL||(this.xL=[],this.xL.push(a))}Asm(a){(a?a.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.Tci(a),a.preventDefault(),a.stopPropagation())}Uci(a){100<=this.bU.value.length&&(a.preventDefault(),a.stopPropagation())}frm(a){a=Number.parseInvariant(a.target.parentNode.id.substr(4));this.jji(a);this.OPf(a)}onScroll(){if(this.Yp&&this.Yp.children&&!(2>this.Yp.children.length)){var a=this.Yp.children[0].children[0],c=this.Yp.clientHeight-(a.clientHeight-a.children[0].clientHeight+
2)+this.Yp.scrollTop,h=a.clientHeight+2,v=parseInt(String(this.Yp.scrollTop/h));a=parseInt(String(c/h));var B=parseInt(String(this.Yp.clientWidth/h));a<c/h&&a<parseInt(String(this.xL.length/B))&&a++;for(c=v;c<a;c++)for(h=0;h<B;h++){var X=c*B+h;v=this.xL[X];(X=document.getElementById("clip"+X))&&!X.childNodes.length&&(v=this.Q$g(v),X.appendChild(v))}}}Q$g(a){const c=document.createElement("img");c.classList.add("ClipartThumbImage");c.setAttribute("src",a.thumbnailUrl);a=a.displayName?a.displayName:
Box4Intl.Box4Strings.l_ClipartImageAltNoCaption;c.setAttribute("title",a);c.setAttribute("alt",a);Ld.a.addHandler(c,"click",this.Mwe);Ld.a.addHandler(c,"error",this.xDe);return c}Xrk(a){1===a.childNodes.length&&(a=a.childNodes[0],Ld.a.removeHandler(a,"click",this.Mwe),Ld.a.removeHandler(a,"error",this.xDe))}Ftm(a){a.target.setAttribute("src",uk.a.Ah("phthumb.64x64x32.png"))}grm(a){a.target.setAttribute("src",uk.a.Ah("phpreview.96x96x32.png"))}jji(a){const c=this.xL[a];var h=c.QEm;this.a2g();this.YPb=
Object(m.a)(this,this.grm,"onPreviewLoadError");var v=document.createElement("img");v.setAttribute("src",h);if(c.displayName)h=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,c.displayName);else{h=new Sys.StringBuilder;for(let B=0;B<c.keywords.length&&5>B;B++)B&&h.append(", "),h.append(c.keywords[B]);h=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,h.toString())}v.setAttribute("title",h);v.setAttribute("alt",h);Ld.a.addHandler(v,"error",this.YPb);this.dMb.appendChild(v);
v=document.getElementById("clip"+this.Imb);v.classList.remove("ClipartSelectedImage");v=document.getElementById("clip"+a);v.classList.add("ClipartSelectedImage");this.Imb=a;c.displayName&&(this.Nge.innerText=c.displayName);a=document.createElement("a");a.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink;a.setAttribute("href",'""');Ld.a.addHandler(a,"click",this.Cfd);Ld.a.addHandler(a,"keydown",this.Dfd);this.K3a.appendChild(a);this.Mge.innerText=String.format("{0} | {1} | {2}",c.dimensions,c.K2m,
c.fileSize);(a=c.kKj)&&c.KQg?(this.Zhc.parentNode.style.display="block",this.Kge.innerText=c.KQg,this.Zhc.appendChild(a)):this.Zhc.parentNode.style.display="none";this.Oge.appendChild(c.kMm);ye.a.I_(this.rPa);if(a=c.zRj)this.rPa.appendChild(a),"a"===a.nodeName.toLowerCase()&&(Ld.a.addHandler(a,"click",this.M7c),Ld.a.addHandler(a,"keydown",this.N7c));this.sPa.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(a=0;a<c.keywords.length;a++)v=c.keywords[a],h=document.createElement("a"),h.innerText=v,
h.setAttribute("href",'""'),Ld.a.addHandler(h,"click",this.Tpe),Ld.a.addHandler(h,"keydown",this.Upe),this.sPa.appendChild(h),a<c.keywords.length-1&&(v=document.createElement("span"),v.innerText=", ",this.sPa.appendChild(v));this.Pge.innerText=Box4Intl.Box4Strings.l_ClipartRating;this.Lge.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy;this.tea(1,!0)}a2g(){this.dMb&&1===this.dMb.childNodes.length&&(this.YPb&&(Ld.a.removeHandler(this.dMb.childNodes[0],"error",this.YPb),this.YPb=null),ye.a.I_(this.dMb));
this.rPa&&0<this.rPa.childNodes.length&&"a"===this.rPa.childNodes[0].nodeName.toLowerCase()&&(this.M7c&&Ld.a.removeHandler(this.rPa.childNodes[0],"click",this.M7c),this.N7c&&Ld.a.removeHandler(this.rPa.childNodes[0],"keydown",this.N7c));this.K3a&&0<this.K3a.children.length&&"a"===this.K3a.children[0].nodeName.toLowerCase()&&(this.Cfd&&Ld.a.removeHandler(this.K3a.children[0],"click",this.Cfd),this.Dfd&&Ld.a.removeHandler(this.K3a.children[0],"keydown",this.Dfd),ye.a.I_(this.K3a));if(this.sPa){for(let a=
0;a<this.sPa.childNodes.length;a++){const c=this.sPa.childNodes[a];"a"===c.nodeName.toLowerCase()&&(Ld.a.removeHandler(c,"click",this.Tpe),Ld.a.removeHandler(c,"keydown",this.Upe))}ye.a.I_(this.sPa)}this.Nge.innerText="";this.Mge.innerText="";ye.a.I_(this.Zhc);ye.a.I_(this.Oge);ye.a.I_(this.rPa);this.sPa.innerText="";this.Kge.innerText="";this.Pge.innerText="";this.Lge.innerText=""}Jai(a){Ve.a.Ql(a.target.attributes.getNamedItem("href").value,a.target.attributes.getNamedItem("target").value,void 0,
"InsertClipartDialog");a.stopPropagation();a.preventDefault()}Fom(a){(a?a.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.Jai(a)}bbi(a){const c=a.target.innerText;this.bU&&(this.bU.value=c);this.search(c);a.stopPropagation();a.preventDefault();this.tea(1,!1)}mpm(a){(a?a.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.bbi(a)}Wci(a){this.xL&&(this.L8m(this.xL[this.Imb]),a.stopPropagation(),a.preventDefault(),this.bU.value="",this.tea(1,!1))}Bsm(a){(a?a.keyCode:window.event.keyCode)===
Sys.UI.Key.enter&&this.Wci(a)}onKeyDown(a){if(a.keyCode>=Sys.UI.Key.left&&a.keyCode<=Sys.UI.Key.down){let c=0;switch(a.keyCode){case Sys.UI.Key.up:c=-5;break;case Sys.UI.Key.down:c=5;break;case Sys.UI.Key.left:c=-1;break;case Sys.UI.Key.right:c=1}this.Lua=this.Lua+c<this.Yp.children.length-1?0>this.Lua+c?0:this.Lua+c:this.Yp.children.length-1;this.OPf(this.Lua);a.preventDefault();a.stopPropagation()}else a.keyCode===Sys.UI.Key.enter?(a=Number.parseInvariant(a.target.id.substr(4)),0<=a&&a<this.Yp.children.length&&
this.Eyi(a)):a.keyCode===Sys.UI.Key.tab&&(this.Lua=a.shiftKey?Math.max(0,this.Lua-1):Math.min(this.Lua+1,this.Yp.children.length-1))}Eyi(a){if(!(this.Yp.children.length<=a||0>a)){var c=this.Yp.children[a],h=this.Yp.children[0];h=h.clientHeight-h.children[0].clientHeight+2;this.Yp.scrollTop+this.Yp.clientHeight<c.offsetTop+c.clientHeight?this.Yp.scrollTop=c.offsetTop-3*c.clientHeight-h:this.Yp.scrollTop>c.offsetTop&&(this.Yp.scrollTop=c.offsetTop-h/2);this.jji(a)}}validate(){return!0}onError(){this.Yp&&
(this.Yp.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)}qki(a){if(this.Yp)if(a.data.T9){var c=a.data.T9.lastChild.childNodes;this.xL||(this.xL=[]);for(a=0;a<c.length&&100>this.xL.length;a++){var h=c[a];1===h.nodeType&&"image"===h.nodeName&&(h=Gj.qOk(h),this.xL.push(h))}this.seh();this.xL.length||(this.Yp.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(a.data.qd){a=F.a.HLi(a.data.qd);try{c=parseInt(a)}catch(v){c=14}this.Yp.innerText=26===c?Box4Intl.Box4Strings.l_ClipartCannotConnect:
Box4Intl.Box4Strings.l_ClipartNoResultsFound}}seh(){if(this.xL){ye.a.I_(this.Yp);this.lRa&&(this.lRa.dispose(),this.lRa=null);this.Yp.focus();this.Yp.classList.remove("ClipartSearchInProgress");for(let c=0;c<this.xL.length;c++){var a=document.createElement("a");a.setAttribute("href","#");a.id="itab"+c;const h=document.createElement("span");h.id="clip"+c;h.classList.add("ClipartImageContainer");a.appendChild(h);this.Yp.appendChild(a);c<parseInt(String(this.Yp.clientHeight/h.clientHeight))*parseInt(String(this.Yp.clientWidth/
h.clientWidth))&&(a=this.Q$g(this.xL[c]),h.appendChild(a))}this.Kwe&&(this.Eyi(this.Imb),this.OPf(this.Imb))}}c2g(){if(nc.FocusManager.rH()){var a=nc.FocusManager.instance().getRegion(this.lI);a&&a.Sh.ov(this.bU)}else this.bU.focus();for(a=0;a<this.Yp.childNodes.length;a++){const c=this.Yp.childNodes[a];1===c.childNodes.length&&this.Xrk(c.childNodes[0])}ye.a.I_(this.Yp);this.a2g();this.tea(1,!1);this.lRa=new kp.a(Box4Intl.Box4Strings.l_ClipartSearching);this.lRa.HWh=!1;this.Yp.appendChild(this.lRa.element);
this.Yp.classList.add("ClipartSearchInProgress")}yCl(a){1===a&&this.xL&&vo.gx.tha(this.acg.context)&&(a=this.xL[this.Imb])&&this.acg.lCa(a)}OPf(a){this.Lua=a;a=this.Yp.children[this.Lua];nc.FocusManager.rH()?nc.FocusManager.instance().getRegion(this.lI).Sh.ov(a):a.focus()}static get gx(){return vo.Og=vo.Og||xa.a.instance.resolve("Box4.Images.IImageEditor")}}vo.Og=null;Object(w.a)(vo,"InsertClipartDialog",gg.a,[]);class Ij extends am{constructor(a,c,h,v,B,X){super(a,c,h,v,B,X,!1);new vo(this)}lCa(a){this.OGd()&&
this.Jd.Eh().contentReplicator.forceOutbound(Object(m.a)(this,this.Xqm,"onPlaceholderNodeSaved$3"),null,a)}Xqm(a){if(this.cQl()){var c=this.Jd.Eh(),h=c.contentReplicator.Ss.toString(),v=new Sys.Net.WebRequest;v.set_url("ClipArtUpload.ashx");v=new Sys.StringBuilder(v.getResolvedUrl());this.kU(v,dh.a.assetId,a.assetId,!0);this.kU(v,of.a.lcid,l.AFrameworkApplication.lcid.toString());this.kU(v,of.a.kc,this.yE?this.yE.id.toString():this.Jd.id.toString());this.kU(v,of.a.cellId,c.Nk.toString());this.kU(v,
of.a.fileId,c.fr);this.kU(v,of.a.Soa,h);this.kU(v,of.a.S_,this.Sk.toString());a=Vm.a.vp;kg.a.instance.J(4)&&(a=this.Jd.ia(ii.a.JI,Vm.a.vp));this.kU(v,of.a.JI,a.toString());this.kU(v,of.a.Bjb,"1");c.FG&&this.kU(v,of.a.FG,c.FG);this.kU(v,of.a.classId,this.yE?this.yE.properties.Gb.toString():this.Jd.Gb.toString());this.Xd.hasProperty(Yb.a.imageType)&&this.kU(v,dh.a.imageType,this.Xd.getValue(Yb.a.imageType).toString());Um.a.instance.AGj(v);l.AFrameworkApplication.fe.ai(v.toString(),2,"",{},!1,2,Object(m.a)(this,
this.zSn,"uploadFinished"),Object(m.a)(this,this.uploadFailed,"uploadFailed"),null);am.d6b++}}kU(a,c,h,v){a.append(v?"?":"&");a.append(F.a.ui(c));a.append("=");a.append(F.a.ui(h))}zSn(a){if(({group:c}=Dm.a.D$(a.data.qd,c)).returnValue){var c=c.Responses[0];c.tgb=a.data.yF;c.Hs=a.data.oj?a.data.oj[jp.a.L3]:"";this.Ata(c)}else this.uploadFailed(null)}uploadFailed(){const a=new An.a;a.StatusCode=14;this.Ata(a)}u0e(a){switch(a){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;
default:return super.u0e(a)}}Ata(a){super.Ata(a);am.d6b--}}Object(w.a)(Ij,"ClipartUploader",am,[]);class Sn{constructor(a,c,h){this.Og=a;this.Xi=c;this.ga=h}eb(){this.ga.Aa(zb.a.pNh,ic.a.view,Object(m.a)(this,this.zCl,"insertClipartDialogView"),260)}zCl(a,c,h,v,B){if(!this.Og||!this.Og.value)return r.ULS.sendTraceTag(524109267,306,15,"ImageEditor not available"),8;a=this.Og.value.tha(c);return 2===h&&a?(new Ij(c,ag.a.instance,l.AFrameworkApplication.K,B,this.Xi,this.ga),32):1===h?a&&Eb.App.R2g?32:
8:2}}Object(w.a)(Sn,"ClipArtActor",null,[]);class Pp{constructor(){this.W=null}get name(){return"Box4.ClipArt"}yb(a){this.W=a;a.ha("Box4.ClipArt.ClipArtActor",()=>new Sn(a.te("Box4.Images.IImageEditor"),a.resolve("Box4.IUndoManager"),l.AFrameworkApplication.pa)).singleInstance()}init(){this.W.resolve("Box4.ClipArt.ClipArtActor").eb();const a=Eb.App.oa;a&&a.updateCommandUI()}dispose(){}}Object(w.a)(Pp,"ClipartPackage",null,[1,2]);class Bn{constructor(a){this.HRa=this.rRa=this.ORa=this.NRa=null;this.Zrg=
this.rg=this.B6=!1;this.nye=this.Dsg=null;this.psg=0;this.qa=this.ysg=null;this.o2=a;this.BP=3;this.Xkc=!0}initialize(a,c,h){this.NRa=this.H$e(a,c);this.ORa=CommonUIStrings.l_SavingStatus;this.rRa=CommonUIStrings.l_ReadOnlyStatus;this.HRa=CommonUIStrings.l_ReviewModeStatus;this.o2&&this.o2.execute(v=>{v.yTb(Object(m.a)(this,this.QZc,"updateToSavingStatus"))});this.rg=!0;this.qa=h;return!0}ijb(a,c){this.B6=a;this.BP=c;this.cOa(this.Xkc)}cOa(a){!this.Xkc&&a&&(this.ysg=new Date);this.Xkc=a;a=null;3===
this.BP&&(a=this.Xkc?this.NRa:this.ORa);this.Mvk(a)}H$e(a,c){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):c&&c.length?String.format(CommonUIStrings.l_SavedToStatus,c):CommonUIStrings.l_SavedStatus}QZc(){this.cOa(!1)}n7k(){switch(this.BP){case 1:return this.rRa;case 2:return this.HRa;default:return null}}NJl(a){return this.Zrg===this.B6&&this.psg===this.BP&&this.Dsg===a}jeh(a){appChrome.getHeaderApi().then(c=>{c.updateDocumentTitleStatus(this.B6,a,this.n7k(),
this.ysg,this.Xkc);return null});this.nye=null}Mvk(a){this.rg&&yh.c()&&!this.NJl(a)&&(Ve.a.JLf()?(this.nye&&r.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.nye=window.requestIdleCallback(()=>{this.jeh(a)})):window.requestAnimationFrame(()=>{this.jeh(a)}),this.Zrg=this.B6,this.Dsg=a,this.psg=this.BP)}}Object(w.a)(Bn,"ReactSaveStatusUIHandler",null,[626]);class Lo{constructor(a,c){this.VU=null;this.NRa=CommonUIStrings.l_SavedStatus;this.ORa=
CommonUIStrings.l_SavingStatus;this.rRa=CommonUIStrings.l_ReadOnlyStatus;this.HRa=CommonUIStrings.l_ReviewModeStatus;this.C4a=c;this.o2=a;this.BP=3;this.J6a=!0}IF(){this.o2&&this.o2.execute(a=>{a.yTb(Object(m.a)(this,this.QZc,"updateToSavingStatus"))});this.C4a.execute(a=>{this.VU=a})}ijb(a,c){this.BP=c;3===c?this.cOa(this.J6a):2===c?this.OZf(this.HRa):this.OZf(this.rRa)}QZc(){this.cOa(!1)}cOa(a){this.J6a=a;this.OZf(this.J6a?this.NRa:this.ORa)}OZf(a){this.VU&&this.VU.Qg(E.a.fJn,this.Ybk(a))}Ybk(a){const c=
{};c.StatusText=a;return c}}Object(w.a)(Lo,"SaveStatusPostMessageHandler",null,[626]);var bk=b(902);class bm{constructor(a,c,h,v){this.HRa=this.rRa=this.ORa=this.NRa=null;this.dob=0;this.JW=this.vze=this.jkb=this.gbe=this.IDe=null;this.ef=a;this.x4a=c;this.o2=h;this.Ck=v;this.Wog=!0;this.B6=!1;this.BP=3;this.J6a=!0}initialize(a,c){if(!this.ef)return!1;this.NRa=this.H$e(a,c);this.ORa=CommonUIStrings.l_SavingStatus;this.rRa=CommonUIStrings.l_ReadOnlyStatus;this.HRa=CommonUIStrings.l_ReviewModeStatus;
this.IF();return!0}H$e(a,c){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):c&&c.length?String.format(CommonUIStrings.l_SavedToStatus,c):CommonUIStrings.l_SavedStatus}IF(){this.x4a&&this.x4a.execute(a=>{a.WIj(Object(m.a)(this,this.C$g,"createStatusAndModeElements"));a.FIj(Object(m.a)(this,this.srn,"showHideSaveStatusElement"));a.REn&&this.C$g(null,null)});this.o2&&this.o2.execute(a=>{a.yTb(Object(m.a)(this,this.QZc,"updateToSavingStatus"))})}Yea(){this.JW&&this.ef&&
this.ef.wta(this.JW)}srn(a,c){this.ijb("true"===c,this.BP)}ijb(a,c){this.B6=a;this.BP=c;this.gbe&&(this.gbe.style.display=this.B6||3===this.BP||!this.IDe?"none":"");this.jkb&&(this.jkb.style.display=this.B6||3===this.BP?"none":"",this.jkb.innerText=1===this.BP?this.rRa:this.HRa,this.jkb.title=1===this.BP?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.vze&&(this.vze.style.display=this.B6||1===this.BP||!this.IDe&&!this.jkb?"none":"");this.JW&&(this.JW.style.display=
this.B6||1===this.BP?"none":"",this.cOa(this.J6a),this.JW.title=CommonUIStrings.l_SaveStatusTooltip)}C$g(a,c){a=document.getElementById(bk.CuiHelper.Xtl);c&&c.oWn||!a||""===this.NRa||""===this.ORa||""===this.rRa||""===this.HRa||(this.IDe=document.getElementById(bk.CuiHelper.kNe),this.gbe=bk.CuiHelper.urd(a,"BreadcrumbAppModeDash","-"),this.jkb=bk.CuiHelper.urd(a,"BreadcrumbAppModeStatus",1===this.BP?this.rRa:this.HRa),this.lUi(this.jkb),this.vze=bk.CuiHelper.urd(a,"BreadcrumbSaveStatusDash","-"),
this.JW=bk.CuiHelper.urd(a,"BreadcrumbSaveStatus",this.NRa),this.lUi(this.JW),this.ijb(this.B6,this.BP))}QZc(){this.cOa(!1)}cOa(a){this.J6a=a;this.SQn(this.J6a?this.NRa:this.ORa)}SQn(a){!this.JW||3!==this.BP&&2!==this.BP||(this.Wog&&!this.J6a?(this.dob=this.JW.offsetWidth<this.dob?this.dob:this.JW.offsetWidth,this.MLn(this.ORa),this.Wog=!1):this.JW.innerText=a)}lUi(a){a.style.direction=this.Ck?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.Ck?"right":"left";a.style.display=this.B6?"none":
"";a.setAttribute("Unselectable","on")}MLn(a){this.JW&&(this.JW.style.width="",this.JW.innerText=a,this.dob=this.JW.offsetWidth<this.dob?this.dob:this.JW.offsetWidth,a=al.a.Zz(this.JW),this.JW.style.width=this.dob-ye.a.FK(a.paddingLeft)-ye.a.FK(a.paddingRight)+1+"px")}}Object(w.a)(bm,"SaveStatusUIHandler",null,[626]);var Pl=b(68);class hm{constructor(){this.wze=this.Bxe=this.cGa=this.W=null}get name(){return"Common.App.SaveStatus"}yb(a){this.W=a;l.AFrameworkApplication.K.$("PostMessageEmbedded")&&
l.AFrameworkApplication.BR?this.W.register(Lo,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Pc(()=>new Lo(this.W.za("Common.App.HostNotification.EditNotificationEventSource"),this.W.za("Postmessage.IHostPostmessenger"))):l.AFrameworkApplication.na.Ya.kmf||(l.AFrameworkApplication.na.Ya.WG?this.W.register(Bn,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Pc(()=>
new Bn(this.W.za("Common.App.HostNotification.EditNotificationEventSource"))):this.W.register(bm,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").singleInstance().Pc(()=>new bm(Pl.EventHandlerManager.instance,this.W.za("Common.App.Header.HeaderEventSource"),this.W.za("Common.App.HostNotification.EditNotificationEventSource"),l.AFrameworkApplication.isRtl)))}init(){l.AFrameworkApplication.K.Io(Object(m.a)(this,this.Mv,"onFullAppSettingsReady"))}Mv(){const a=
l.AFrameworkApplication.K,c=!!l.AFrameworkApplication.na.Ya&&4===l.AFrameworkApplication.na.Ya.Rm;if(a.$("WordEditorAutoSaveImprovementIsEnabled")||a.$("PptEditorSaveStatusInHeaderEnabled")||c&&a.$("SimplifiedReactRibbonUxIsEnabled")||a.$("ExcelSaveStatusInHeaderEnabled")||a.$("VisioSaveStatusInHeaderEnabled"))l.AFrameworkApplication.K.$("PostMessageEmbedded")&&l.AFrameworkApplication.BR?(this.wze=this.W.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.wze.IF():l.AFrameworkApplication.na.Ya.kmf||
(l.AFrameworkApplication.na.Ya.WG?(this.Bxe=this.W.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.Bxe.initialize(a.$("IsSkyDrive"),a.Ga("HostNameToIncludeInSavedStatus"),l.AFrameworkApplication.K):(this.cGa=this.W.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.cGa.initialize(a.$("IsSkyDrive"),a.Ga("HostNameToIncludeInSavedStatus")))}dispose(){this.cGa&&this.cGa.Yea()}}Object(w.a)(hm,"PackageManager",null,[1,2]);var Ti=b(1469);class Al{get name(){return"Common.App.EventsCachePackage"}yb(){}init(){Ti.a.instance.init()}dispose(){}static main(){M.a.instance.Lb(new Al)}}
Object(w.a)(Al,"EventsCachePackage",null,[1,2]);var ck=b(118),Rh=b(188),Fm=b(1294),Jj=b(1193),Uf=b(434),Fg=b(1334),on=b(1313),De=b(1287),bl=b(276),Zd=b(1290);class Eh{constructor(a){this.eog=!1;this.e1c=this.el=null;this.gae=!1;this.IB=a}get control(){return this.IB}get Gc(){return this.control.Gc}get root(){return this.control.root}get FF(){return this.control.FF}get GSa(){return this.control.GSa}get Yi(){return this.control.Yi}get fC(){return this.control.fC}rG(){}initialize(){}ev(a,c,h){this.control.Fwk(a,
c,h)}yk(){De.c(this.control.vg.Command)||this.ps(this.control.vg.Command,null,null)}ps(a,c,h){let v=0;this.root&&(v=this.root.Fka(a,c,h));this.control.enabled=0<(v&1);return v}t1a(){let a=this.control.visible;this.root.CNa&&(a=this.Gc[bl.a.visible],a!==this.control.visible&&(this.control.visible=a,this.root.L5b=!0));return a}l0f(){const a=Zd.a.Yla(this.Gc[bl.a.labelText],this.control.vg.LabelText);this.p0d(a)}p0d(a){this.control.labelText!==a&&(this.fC.forEach(c=>{c.p0d(a)}),this.control.labelText=
a,this.root.UYa=!0)}OIb(){const a=Zd.a.Yla(this.Gc[bl.a.alt],this.control.vg.Alt);this.Y$b(a)}Y$b(a){this.control.tooltip!==a&&(this.fC.forEach(c=>{c.Y$b(a)}),this.control.tooltip=a)}bfa(){const a=Zd.a.Yla(this.Gc[Jj.a.Image16by16Class],this.control.vg.Image16by16Class),c=Zd.a.Yla(this.Gc[Jj.a.Image32by32Class],this.control.vg.Image32by32Class);var h=Zd.a.Yla(this.Gc[Jj.a.Image48by48Class],this.control.vg.Image48by48Class);h=De.b(h)?c:h;this.xuc(this.fC.small,a);this.xuc(this.fC.medium,a);this.xuc(this.fC.large,
c);this.xuc(this.fC.aun,a);this.xuc(this.fC.n4b,h)}xuc(a,c){!a||De.c(a.gO)||De.c(c)||a.gO.className===c||(a.gO.className=c)}qNn(a){if(!De.b(a)&&this.root.eWf){for(const c of this.control.rRe){const h=c.dR===a;h&&(this.control.PGe=c);this.control.visible&&(c.By=h)}this.control.visible&&(this.root.UYa=!0)}}EKj(){if(this.fC.n4b&&this.fC.n4b.kM&&this.fC.n4b.k$a){const a=this.fC.n4b.kM,c=Zd.a.Yla(this.Gc[Uf.a.Description],this.control.vg.Description);De.b(c)&&(a.style.position="relative",a.style.top=(a.parentNode.offsetHeight-
a.offsetHeight)/2+"px",a.style.padding="0px")}}onFocus(){const a=this.Yi;Object(Ub.a)(Fg.a,a)?this.FF.bjb(a):this.root.Ntb=this.control;return!1}onBlur(){const a=this.Yi;this.control.yAb()&&Zd.a.rs(a.Hb,"cui-ctl-menu-hovered-without-focus");this.root.Ntb=null;return!1}sV(a){if(this.control.yAb()){var c=this.FF.yla;const h=c===this.root.WBb-1;c=h?null:this.root.gA[c+1];this.sQe(!1);h||this.control===c||Zd.a.rs(c.jBb,on.MenuLauncher.YMc);this.control.enabled&&this.control.Ks?h?this.control.IV():(Zd.a.ze(this.Yi.Hb,
"cui-ctl-menu-hovered-without-focus"),c.Zba=this.control.Ks):h?this.FF.setFocus(a.He):(c.Zba=this.FF.Hb,this.FF.Tka())}return!1}HM(){this.control.yAb()&&Zd.a.rs(this.Yi.Hb,"cui-ctl-menu-hovered-without-focus");return!1}onKeyDown(a){let c=!1;if(!De.c(a.Sa)&&!De.c(a.Sa.rawEvent)){const h=a.Sa.keyCode;a=a.Sa.rawEvent.shiftKey;h===Sys.UI.Key.enter&&(c=!0);if(Object(Ub.a)(Fg.a,this.Yi)){const v=this.FF;if(!De.c(v)){const B=v.yla,X=0===this.root.NY,ma=!De.c(this.control.Eym);if(h!==Sys.UI.Key.tab&&h!==
Sys.UI.Key.left&&h!==Sys.UI.Key.right&&h!==Sys.UI.Key.up&&h!==Sys.UI.Key.down&&h!==Sys.UI.Key.esc)return c;Ve.a.VPe();h!==Sys.UI.Key.tab||a?h===Sys.UI.Key.tab&&a?(v.kI(1),c=!0):h===Sys.UI.Key.left&&X||h===Sys.UI.Key.right&&!X?(ma?v.kI(2):0<B&&this.root.ITa(B,!0,!1),c=!0):h===Sys.UI.Key.right&&X||h===Sys.UI.Key.left&&!X?(ma&&v.kI(4),c=!0):h===Sys.UI.Key.up?(v.kI(5),c=!0):h===Sys.UI.Key.down?(v.kI(6),c=!0):h===Sys.UI.Key.esc&&(this.root.ITa(B,!0,!1),c=!0):(v.kI(0),c=!0)}}}return c}ox(a){let c=!1;if(!De.c(a.Sa)&&
!De.c(a.Sa.rawEvent)){const h=a.Sa.keyCode;qc.KeyInputManager.JIh(a)||h!==Sys.UI.Key.enter&&h!==Sys.UI.Key.space||(c=this.ocf(a),c||(this.ev(a.Ud,1,a.Sa),c=!0))}return c}uC(a){this.gRe();if(this.GSa){let c=!0;2===a.He&&(c=a.o9===Sys.UI.MouseButton.leftButton);c&&this.Yi&&this.rkd(this.Yi.Hb)}(a.Sa.type.toLowerCase()!==Jb.a.YM||this.GSa)&&a.Sa.preventDefault();return!1}get Rhf(){return this.eog}qAk(){this.eog=!0}gRe(){this.Rhf&&this.control.root.a9a()}Yra(a){Object(Ub.a)(Fg.a,this.Yi)&&!this.GSa&&
2===a.He&&a.o9===Sys.UI.MouseButton.leftButton?(this.ev(a.Ud,a.He,a.Sa),a=!0):a=this.control.Dpa(a);return a}onClick(a){let c=!1;Object(Ub.a)(Fg.a,this.Yi)&&!this.GSa&&3===a.He&&(this.ev(a.Ud,a.He,a.Sa),c=!0);return H.a.sh?!1:c}gfb(a){return this.iQd(a)}RAa(a){this.Dpa(a);return!1}iQd(a){return De.c(this.el)?!1:(this.$Of(Ve.a.HJd(this.DMg,a.clientPoint)),!0)}y6b(a){let c=!1;this.Dpa(a)&&(c=!0);3!==a.He&&(a=!0,!this.root&&Eh.xwf&&(r.ULS.sendTraceTag(588084884,207,50,"Root is null"),a=!1),a&&this.root.Cba(),
c=!0);return c}B6b(a){return this.Dpa(a)}z6b(a){return this.iQd(a)}A6b(a){return this.Dpa(a)}w6b(a){return 3===a.He?(this.root.Cba(),!0):!1}x6b(){return!1}get DMg(){!De.c(this.el)&&De.c(this.e1c)&&(this.e1c=Ve.a.getElementBounds(this.el));return this.e1c}$Of(a){this.gae!==a&&(this.gae=a,this.QGe(this.gae))}QGe(a){De.c(this.el)||Zd.a.PV(this.el,Fm.Control.ukd,a)}rkd(a){this.control.enabled&&(this.el=a,this.root.Etc=this.control,this.$Of(!0),this.root.sba(this.control,!1))}Dpa(a){if(!De.c(this.el)){this.$Of(!1);
let c=!!this.root;if(Eh.xwf){const h=Le.ActionManager.gwa(parseInt(this.control.vg.Command))||"";r.ULS.sendTraceTag(588084885,207,50,"Root not null: {0}, Action: {1}",c,h)}c&&this.root.b8(this.control,!1);De.c(a)||Ve.a.HJd(this.DMg,a.clientPoint)&&this.ev(this.el,a.He,a.Sa);c=!!this.root;Eh.xwf&&r.ULS.sendTraceTag(588084886,207,50,"Root not null: {0}",c);c&&(this.root.Etc=null);this.e1c=this.el=null;return!0}return!1}kI(a){return Object(Ub.a)(Fg.a,this.Yi)&&2!==a&&4!==a&&!Ve.a.J1b(this.control.Ks)?
this.IV():!1}IV(){try{if(this.control.visible){const a=this.control.Ks;if(!De.c(a))return a.focus(),!0}}catch(a){}return!1}sQe(a){const c=this.FF;De.c(c)||this.root.ITa(c.yla+1,a)}mka(){}ocf(){return!1}Cca(a){let c=null;a&&a.rawEvent&&(c={},c[Eh.triggerTime]=a.rawEvent.timeStamp);return c}static get xwf(){null==Eh.zte&&(Eh.zte=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("NullCheckRootInOnModalBodyPointerDownIsEnabled"));return Eh.zte}}Eh.triggerTime="TriggerTime";Eh.zte=null;Object(w.a)(Eh,
"ControlBehavior",null,[637]);var im=b(127);class Hj extends Eh{constructor(a){super(a)}get button(){return this.control}get properties(){return this.control.vg}rG(a){const c=a.ml;a=a.dR;De.c(c)||(Sc.a.instance.Ea(Jb.a.focus,c,Object(m.a)(this,this.onFocus,"onFocus")),Sc.a.instance.Ea(Jb.a.blur,c,Object(m.a)(this,this.onBlur,"onBlur")),Rh.a.instance.Ea(Jb.a.pointerOver,c,Object(m.a)(this,this.sV,"onPointerOver")),Rh.a.instance.Ea(Jb.a.pointerOut,c,Object(m.a)(this,this.HM,"onPointerOut")),qc.KeyInputManager.instance.BC(Jb.a.ah,
c,Object(m.a)(this,this.onKeyDown,"onKeyDown"),a),qc.KeyInputManager.instance.BC(Jb.a.hs,c,Object(m.a)(this,this.fE,"onKeyPress"),a),qc.KeyInputManager.instance.BC(Jb.a.Hg,c,Object(m.a)(this,this.ox,"onKeyUp"),a),Rh.a.instance.Ea(Jb.a.pointerDown,c,Object(m.a)(this,this.uC,"onPointerDown")),Rh.a.instance.Ea(Jb.a.GK,c,Object(m.a)(this,this.Yra,"onPointerUp")),oi.a.instance.Ea(Jb.a.click,c,Object(m.a)(this,this.onClick,"onClick")),im.a.instance.Ea(Jb.a.XM,c,Object(m.a)(this,this.gfb,"onTouchMove")),
im.a.instance.Ea(Jb.a.oH,c,Object(m.a)(this,this.RAa,"onTouchEnd")))}ev(a,c,h){this.control.enabled&&(a=null,this.Yi&&this.Yi.CJc()&&this.FF&&(a=this.root.gA[this.FF.yla])&&!this.Rhf&&(a.SMa(this.button),a=null),this.executeCommand(this.control.vg.Command,c,!0,h),a&&a.SMa(this.button))}executeCommand(a,c,h,v){if(!De.c(a)){const B=this.Gc;B.CommandValueId=this.button.Dwb();B.MenuItemId=this.button.vg.MenuItemId;B.SourceControlId=this.control.id;this.root.executeCommand(a,B,this.Yi,c,h,null,this.Cca(v))}}yk(){De.c(this.control.vg.Command)||
0<(this.ps(this.properties.Command,this.properties.QueryCommand,this.Gc)&2)&&this.t1a()&&this.aOa()}aOa(){this.l0f();this.OIb();this.bfa()}onFocus(a){super.onFocus(a);this.$Uf();return!1}onBlur(a){super.onBlur(a);this.t_e();return!1}onKeyDown(a){let c=super.onKeyDown(a);De.c(a.Sa)||this.ZRf(a.ho,a.Sa.keyCode)&&(c=!1);return c}fE(a){let c=!1;De.c(a.Sa)||De.c(a.Sa.rawEvent)||(this.ZRf(a.ho,a.Sa.rawEvent.keyCode)?(this.ev(a.Ud,a.He,a.Sa),c=!0):a.Sa.preventDefault());return c}ZRf(a,c){if(H.a.Gi&&c===
Sys.UI.Key.enter)switch(a){case "MenuMru":case "MenuTemplate":case "MenuHeader":case "MenuFooter":return!0}return!1}ox(a){let c=!1;De.c(a.Sa)||this.ZRf(a.ho,a.Sa.keyCode)||(c=super.ox(a));return c}$Uf(){this.control.enabled&&this.executeCommand(this.properties.CommandPreview,0,!1,null)}t_e(){this.control.enabled&&this.executeCommand(this.properties.CommandRevert,0,!1,null)}}Object(w.a)(Hj,"ButtonBehavior",Eh,[]);var Rk=b(1426);class Ql{}Ql.Color="Color";Ql.IndexColorSelected="ColorSelected";Object(w.a)(Ql,
"ColorPickerCommandProperties",null,[]);class bp extends Eh{constructor(a){super(a);this.Qqc=this.Jt=-1}get colorPicker(){return this.control}get yHa(){return this.colorPicker.t9j.yHa}get properties(){return this.colorPicker.vg}ev(a,c,h){if(this.control.enabled){const v=this.Gc;v.Color=bp.NAd(a)[Rk.ColorPicker.Zpd];a=null;Zd.a.oq(this.properties.Stateful)&&this.Yi&&this.Yi.CJc()&&this.FF&&(a=this.root.gA[this.FF.yla]);this.root.executeCommand(this.properties.Command,v,this.Yi,c,!0,null,this.Cca(h));
a&&a.SMa(this.colorPicker)}}yk(){var a=this.Gc;a.SourceControlId=this.properties.Id;if(0<(this.ps(this.properties.Command,this.properties.QueryCommand,a)&2)&&(a=-1,Ql.IndexColorSelected in this.Gc&&(a=this.Gc[Ql.IndexColorSelected]),a!==this.Qqc)){const c=this.yHa;0<=a&&a<c.length&&this.FTi(c[a],!0);0<=this.Qqc&&this.Qqc<c.length&&this.FTi(c[this.Qqc],!1);this.Qqc=a}}FTi(a,c){c?Zd.a.ze(a,"cui-colorpicker-selected"):Zd.a.rs(a,"cui-colorpicker-selected")}rG(a){for(let c=0;c<a.xGe.length;++c){const h=
a.xGe[c];Sc.a.instance.Ea(Jb.a.focus,h,Object(m.a)(this,this.Qxf,"onCellFocus"));Sc.a.instance.Ea(Jb.a.blur,h,Object(m.a)(this,this.plm,"onCellBlur"));qc.KeyInputManager.instance.Ea(Jb.a.ah,h,Object(m.a)(this,this.onKeyDown,"onKeyDown"));qc.KeyInputManager.instance.Ea(Jb.a.Hg,h,Object(m.a)(this,this.ox,"onKeyUp"));oi.a.instance.Ea(Jb.a.click,h,Object(m.a)(this,this.qlm,"onCellClick"));Rh.a.instance.Ea(Jb.a.GK,h,Object(m.a)(this,this.Sxf,"onCellPointerUp"));Rh.a.instance.Ea(Jb.a.pointerOver,h,Object(m.a)(this,
this.Rxf,"onCellPointerOver"));Rh.a.instance.Ea(Jb.a.pointerDown,h,Object(m.a)(this,this.rlm,"onCellPointerDown"))}}Qxf(a){a=bp.NAd(a.Ud);this.FF.bjb(this.Yi);this.Y6d(a,!0);return!0}plm(a){this.Y6d(bp.NAd(a.Ud),!1);return!0}Y6d(a,c){c?(this.Jt=parseInt(a.getAttribute("arrayPosition")),Zd.a.ze(a,"cui-colorpicker-hoveredOver"),this.$Uf(a)):(this.Jt=-1,this.t_e(a),Zd.a.rs(a,"cui-colorpicker-hoveredOver"))}qlm(a){3===a.He&&this.ev(a.Ud,a.He,a.Sa);return!0}Sxf(a){3!==a.He&&this.ev(a.Ud,a.He,a.Sa);return!0}Rxf(a){this.sQe(!1);
a=parseInt(bp.NAd(a.Ud).getAttribute("arrayPosition"));this.fVc(a);return!0}rlm(){return!1}$Uf(a){if(this.control.enabled){const c=this.properties.CommandPreview;if(!De.b(c)){const h=this.Gc;h.Color=a[Rk.ColorPicker.Zpd];this.root.executeCommand(c,h,this.Yi,0,!1)}}}t_e(a){if(this.control.enabled){const c=this.properties.CommandRevert;if(!De.b(c)){const h=this.Gc;h.Color=a[Rk.ColorPicker.Zpd];this.root.executeCommand(c,h,this.Yi,0,!1)}}}kI(a){a=Fm.Control.X2e(this.Jt,this.colorPicker.width,this.yHa.length,
a);if(a!==this.Jt&&this.fVc(a))return!0;this.Y6d(this.yHa[this.Jt],!1);return!1}IV(){return this.fVc(0)}fVc(a){return this.yHa&&this.yHa.length>a&&(a=this.yHa[a],a.firstChild)?(a.firstChild.focus(),!0):!1}mka(){-1!==this.Jt&&this.Y6d(this.yHa[this.Jt],!1)}static NAd(a){return bp.S7k(a)}static S7k(a){var c=["td"];const h=c.length;if(!a)return null;for(var v=0;v<h;v++)if(a.tagName.toLowerCase()===c[v].toLowerCase())return a;for(a=a.parentNode;a;){for(v=0;v<h;v++)if(a.tagName.toLowerCase()===c[v].toLowerCase())return a;
a=a.parentNode}return null}}Object(w.a)(bp,"ColorPickerBehavior",Eh,[]);var Gl=b(261),Mo=b(307),tq=b(1515),No=b(634),na=b(1320),bb=b(1503);class ub{constructor(a,c){this.yxj=a;this.Png=c}$_d(a,c,h,v){if(De.c(a)||De.c(c))return null;const B=new bb.a;const X=v.x;var ma=v.y;const Pa=v.width;var mb=v.height;let Tb;ub.nXb(c,"flyoutWidth");v=ub.nXb(c,"flyoutRealHeight");const rc=ub.nXb(c,"viewportWidth");var Tc=ub.nXb(c,"viewportHeight"),vd=ub.nXb(c,"viewableLeft");const ee=ub.nXb(c,"viewableTop"),Ie=this.yxj;
let Xe=!1,Yf=!1;const Hh=1===h,Fi=4===h,wk=this.Png;a.style.maxHeight="none";a.style.top="0px";a.style.overflowY="visible";a.style.width="auto";Tb=this.N4h(a);B.pYi=Tc;B.a2f=rc;if(Hh)Ie?c=X+Pa:(c=X-Tb,B.Bdb=!0),mb=ma;else{var Gk="";Pa>Tb&&(Tb=Pa,Gk=(Tb-2*na.Menu.uOd).toString());Ie?c=X:(c=X+Pa-Tb,B.Bdb=!0);mb=ma+mb;""!==Gk&&(a.style.minWidth=Gk+"px")}wk&&(mb+=ee,c+=vd);a.style.top=mb+"px";a.style.left=c+"px";let Kl=!1;Gk=!1;Tb<=rc?c+Tb>vd+rc?(Hh&&Ie&&X-Tb>vd||Fi&&X-Tb>vd?(c=X-Tb,wk&&(c+=vd),Gk=B.Bdb=
!0):(c=vd+rc-Tb,Xe=!0),Kl=!0):c<vd&&(Hh&&!Ie&&X+Pa+Tb<vd+rc?(c=X+Pa,wk&&(c+=vd),B.Bdb=!1,Gk=!0):(c=vd,Yf=!0,B.Bdb=!0),Kl=!0):Ie?(c=vd,Kl=!0,B.Bdb=!0):(c=vd+rc-Tb,Kl=!0,B.Bdb=!1);Kl&&(a.style.left=c+"px");B.JYb=mb;mb+v<=ee+Tc&&3!==h||(B.iof=!0,{Fgm:h,QLk:ma,nLl:Tc,GRl:vd}=this.B2e(h,mb,v,ma,ee,Tc),mb!==h&&(a.style.top=h+"px",B.JYb=h),-1<ma&&(a.style.maxHeight=ma+"px"),Tc&&(a.style.bottom="0px",a.style.height="auto"),vd&&this.j$l(a,Ie,Hh,Gk,Yf,Xe,rc,X,Pa));B.aCc=c;B.W2e=Tb;B.T2e=v;return B}B2e(a,c,
h,v,B,X){let ma,Pa,mb;ma=-1;mb=Pa=!1;const Tb=c,rc=B+X-c;c=v-h;const Tc=this.Png;let vd=!1;0>c&&(c=B);Tc||(v-=B);h<=v&&1!==a||(4===a||1===a?h<X?(c=X-h,Pa=!0):(c=B,vd=mb=Pa=!0):(v<rc&&3!==a?(c=Tb,Pa=!0):ma=v,mb=!0));Tc&&(Pa=!1,vd?ma=X:c+=B);return{Fgm:c,QLk:ma,nLl:Pa,GRl:mb}}j$l(a,c,h,v,B,X,ma,Pa,mb){a.style.overflowY="scroll";a.style.width="auto";if(c){if(X||v)a.style.left="",a.style.right=(X?0:ma-Pa)+"px"}else B||v||(a.style.left="",a.style.right=(h?ma-Pa:ma-Pa-mb)+"px")}gZk(a){const c={};if(De.c(a))return c;
c.viewportWidth=ye.a.nWa();c.viewportHeight=ye.a.z8();De.c(c.viewportWidth)&&(c.viewportWidth=document.documentElement.clientWidth,c.viewportHeight=document.documentElement.clientHeight);De.c(c.viewportWidth)&&(c.viewportWidth=document.body.clientWidth,c.viewportHeight=document.body.clientHeight);c.viewableTop=window.pageYOffset;c.viewableLeft=window.pageXOffset;De.c(c.viewableTop)&&(c.viewableTop=document.documentElement.scrollTop,c.viewableLeft=document.documentElement.scrollLeft);De.c(c.viewableTop)&&
(c.viewableTop=document.body.scrollTop,c.viewableLeft=document.body.scrollLeft);c.flyoutRealHeight=a.scrollHeight!==a.offsetHeight?a.scrollHeight+2*na.Menu.uOd:a.scrollHeight;const h=a.style.overflowY;a.style.overflowY="visible";c.flyoutWidth=this.N4h(a);a.style.overflowY=h;return c}N4h(a){return a.offsetWidth}static nXb(a,c){return De.c(a)?0:a[c]}}Object(w.a)(ub,"MenuPositioner",null,[]);var dc=b(1338),xc=b(1380),Nc=b(1506),qd=b(1504),ae=b(1501),Pd=b(1502),ce=b(1509),tf=b(1329),zf=b(1423);class hb extends Eh{constructor(a){super(a);
this.wse=0;this.Trg=null;this.Vve=-1;this.e5c=null;this.PDf=this.Skg=!1;this.Dmj=new ub(0===this.root.NY,Zd.a.oq(this.root.properties.DivSyndicated))}get Y4h(){return this.Dmj}get Ws(){return this.control}get properties(){return this.control.vg}get menu(){return this.Ws.menu}set menu(a){this.Ws.menu=a}get KI(){return this.Ws.KI}set KI(a){this.Ws.KI=a}get EVg(){De.c(this.e5c)&&(this.e5c=hb.vik());return this.e5c}get zGi(){let a=!this.root.Xef;Object(Ub.a)(358,this.root)&&1===this.root.WBb&&(a=!0);
return a}ev(a,c){Object(Ub.a)(358,this.root)&&this.root.M_e();this.Ws.VX(c)}VX(a){if(this.Ws.enabled&&!this.KI){var c=Ee.a.instance.Tm(Sa.a.VX);c.properties.add("Id",this.Ws.vg.Id);c.properties.add("InputMethod",Gl.a[a]);c.end();bh.a.mark(10326);Ve.a.qOd(this.Ws.vg.Id,"MenuOpen");this.Ws.Ks&&(this.Ws.Zba=Ve.a.EIa(this.Ws.Ks.ownerDocument));this.wse=a;this.dii(a);this.w_d();this.Ws.k1a(this.Ws.Ks,!0)}}w_d(){De.c(this.properties.PopulateAsyncTriggerCommand)||this.Skg||(this.eim(),this.Skg=!0)}eim(){const a=
{};a[tq.a.Callback]=Object(m.a)(this,this.soi,"refreshMenuCallback");this.root.executeCommand(this.properties.PopulateAsyncTriggerCommand,a,this.Yi,0,!1)}soi(){this.Ws.nMa()}nMa(){this.KI&&this.dii(this.wse,!0)}dii(a,c=!1){var h=!0;if(Zd.a.oq(this.properties.PopulateDynamically)){h=!1;const v=this.VPc(a);v!==this.Trg&&(h=this.dEf(v,c));h=h||!this.KI}h&&(c=l.AFrameworkApplication.na.Qo,h=null,c&&(h=c.Pe("LoadResource","Menu Initialization")),this.ZWa(a),h&&h.stop(),this.sRd())}ZWa(a){if(!De.c(this.menu)){if(this.Ws.yZa){var c=
this.Ws.Yi;if(c&&c.keytip){var h=c.keytip.key.toLocaleLowerCase();this.menu.mhn(String.format("{0} {1}",this.Ws.yZa,c.keytip.TZe),this.Ws.RLa&&""!==this.Ws.RLa?String.format("{0}-{1}",this.Ws.RLa,h):h)}}this.menu.jia();Zd.a.ze(this.menu.Hb,this.Ws.$Ie);Zd.a.PV(this.menu.Hb,"cui-touch",3===a||this.root.H5d);if(this.menu.hasItems()){this.menu.rG();c=this.Yi;c.Qhh();c.KGc=!0;c.Je(this.menu);c.KGc=!1;this.menu.bii();h=Object(Ub.a)(zf.a,this.root);var v=null,B=!1;h&&(v=this.root,B=v.c0a,v.c0a=!1);var X=
this.menu.Hb;X.style.visibility="hidden";X.style.position="absolute";X.style.top="0px";X.style.left="0px";H.a.Gi&&!H.a.xja&&(X.style.maxHeight="100px",X.style.overflowY="scroll");document.body.appendChild(X);this.HKj();this.GCm(X);Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.GBj();Zd.a.ze(this.Ws.jBb,on.MenuLauncher.YMc);var ma=this.root.WBb;this.snn&&this.root.sba(this.control,!0);X.style.zIndex=String(l.AFrameworkApplication.na.yoa);this.root.eEj(this.Ws);this.menu.yla=ma;X.style.visibility=
"visible";ma=this.Krh();if(Object(Ub.a)(Pd.a,this.menu)){X.style.position="fixed";const Pa=this.root.gA[0];Pa&&Pa.menu&&Pa.menu.Hb?100!==Ve.a.kEc(this.root.gA[0].menu.Hb)&&Mo.a.uTf(X,ma,Object(m.a)(this,this.jJe,"afterShowMenu")):Mo.a.uTf(X,ma,Object(m.a)(this,this.jJe,"afterShowMenu"))}else Mo.a.uTf(X,ma,Object(m.a)(this,this.jJe,"afterShowMenu"));this.KI=!0;this.menu.hof=!0;!H.a.sh&&this.Ws.y$m&&this.menu.setFocus(a);h&&(v.c0a=B);h=this.properties.CommandMenuOpen;De.b(h)||this.root.executeCommand(h,
null,c,a,!1)}}bh.a.mark(10327)}sRd(){}GBj(){this.Vve=Zd.a.$sb(this.Vve);this.Vve=window.setTimeout(Object(m.a)(this,this.HBj,"addAndPositionBackFrameInternal"),50)}HBj(){this.menu&&this.menu.Hb&&(document.body.appendChild(this.EVg),this.CCm())}CCm(){const a=this.EVg;var c=this.menu.Hb;a.style.position="absolute";a.style.visibility="hidden";a.style.left=c.style.left;a.style.right=c.style.right;a.style.top=c.style.top;a.style.bottom=c.style.bottom;let h=c.offsetWidth;c=c.offsetHeight;H.a.xja&&(h-=4,
c-=4);a.style.width=h.toString()+"px";a.style.height=c.toString()+"px";a.style.visibility="visible"}get snn(){return this.root.WBb?!1:!0}jJe(a){a.element&&(a.element.style.filter="",a.element.style.opacity="",this.menu&&this.menu.Hb===a.element&&Object(Ub.a)(ae.a,this.menu)&&Mo.a.$Lj(this.Krh()))}Krh(){const a=this.menu.children,c=[];if(Object(Ub.a)(ae.a,this.menu))for(let h=0;h<a.count;h++){const v=a.J(h);Array.add(c,v.separator);for(let B=0;B<v.children.count;B++){const X=v.children.J(B);Array.add(c,
X.Hb)}}return c}HKj(){var a=this.menu.children;for(let h=0;h<a.count;h++){const v=a.J(h).children;for(let B=0;B<v.count;B++){var c=v.J(B);if(Object(Ub.a)(Fg.a,c)){const X=c;if("Menu32"===X.dR||"Menu48"===X.dR)c=c.control,c.behavior&&(Object(Ub.a)(xc.a,c)||Object(Ub.a)(qd.a,c))&&c.behavior.EKj()}}}0<a.count&&(a=a.J(0),De.c(a.separator)||(a.separator.style.display="none"),De.c(a.m5d)||Zd.a.ze(a.m5d,"cui-menusection-titleAtTop"))}GCm(a){if(!De.c(a)){a.style.top="0px";a.style.left="0px";a.style.bottom=
"";a.style.right="";a.style.width="";a.style.minWidth="";var c=No.a.create();try{const h=this.Y4h.gZk(a),v=this.VDc();let B=this.root.$_d(a,h,this.Ws.vOd,v);B||(B=this.Y4h.$_d(a,h,this.Ws.vOd,v));this.root.Z4h=B}finally{c&&c.dispose()}}}VDc(){const a=Ve.a.getElementBounds(this.Ws.jBb);var c=this.FF;De.c(c)||De.c(c.Hb)||(c=Ve.a.getElementBounds(c.Hb),a.x=c.x+na.Menu.uOd,a.width=c.width-2*na.Menu.uOd);Object(Ub.a)(tf.a,this.Ws.xLd)&&(a.height=0);return a}epa(){if(this.Ws.KI){r.ULS.sendTraceTag(6688860,
207,50,"Menu closing {0}",{["Id"]:this.Ws.vg.Id});this.menu.mka();this.Hqi();this.KI=!1;this.menu.hof=!1;this.root.b8(this.control,!0);this.zGi?l.AFrameworkApplication.na.MTc(this.Ws.Zba,this.wse):this.u3m();this.Ws.Zba=null;var a=this.Ws.jBb;Zd.a.rs(a,on.MenuLauncher.YMc);this.Ws.k1a(this.Ws.Ks,!1);Zd.a.rs(a,"cui-ctl-menu-hovered-without-focus");this.menu.Tka();De.b(this.properties.CommandMenuClose)||this.root.executeCommand(this.properties.CommandMenuClose,null,this.Yi,0,!1);this.Gqi()}}u3m(){const a=
this.Ws.Zba;if(a)try{a.focus()}catch(c){}}Gqi(){ye.a.Zs(this.menu.Hb);ye.a.Zs(this.e5c);Zd.a.wta(this.menu.Hb)}VPc(a){if(this.PDf&&Zd.a.oq(this.properties.PopulateOnlyOnce)||De.c(this.properties.PopulateQueryCommand))return null;if(void 0===a||null===a)a=0;const c=this.Ws.W5e();return 0<(this.root.Fka(this.properties.PopulateQueryCommand,this.properties.PopulateQueryCommand,c,a)&1)?c.PopulationXML:null}dEf(a,c=!1){if(this.PDf&&Zd.a.oq(this.properties.PopulateOnlyOnce))return!0;let h=null;this.Trg=
a;De.c(a)||(h=this.yjk(a));De.c(h)||(this.PDf=!0);if(c){this.root.H6j(this.Ws);if(De.c(h)||!h.hasItems())return this.epa(),!1;this.Hqi();this.Gqi()}this.pgn(h);return!0}Z$h(){}yjk(a){a=dc.Builder.Zqd(a);if(!De.c(a)){const c=new ce.a;c.X2g=!0;c.parentId=this.control.id;let h;h=Object(Ub.a)(Nc.a,this.control);return this.root.WL.rTa(a,c,h)}return null}pgn(a){De.c(a)||(De.c(this.menu)||this.menu.dispose(),this.menu=a,this.Z$h())}Hqi(){const a=this.menu.parent;a?(a.KGc=!0,a.removeChild(this.menu.id),
a.KGc=!1):r.ULS.sendTraceTag(572330335,207,10,"Parent not found for the Menu component {0}",this.menu.id)}onKeyDown(a){let c=!1;De.c(a.Sa)||De.c(a.Sa.rawEvent)||Object(Ub.a)(Fg.a,this.Yi)||!a.Sa.rawEvent.altKey||a.Sa.keyCode!==Sys.UI.Key.down||(this.ev(a.Ud,1,a.Sa),c=!0);c||(c=super.onKeyDown(a));return c}uC(a){this.gRe();2===a.He&&a.o9!==Sys.UI.MouseButton.leftButton||this.ev(a.Ud,a.He,a.Sa);a.Sa.preventDefault();return!1}ocf(a){if(!this.FF||!this.FF.inKeytipMode||!this.Ws.kbi)return!1;this.Ws.kbi(this.Yi,
a);return!0}static vik(){const a=Zd.a.createElement("iframe");a.style.position="absolute";a.style.visibility="hidden";a.style.borderWidth="0px";return a}}Object(w.a)(hb,"MenuLauncherBehavior",Eh,[647,637]);var cc=b(1507);class Ac extends hb{constructor(a){super(a)}get nr(){return this.iAc.properties}get iAc(){return this.control}get aIa(){return this.iAc.aIa}rG(){Rh.a.instance.Ea(Jb.a.pointerDown,this.aIa.ml,Object(m.a)(this,this.uC,"onPointerDown"));qc.KeyInputManager.instance.Ea(Jb.a.ah,this.aIa.ml,
Object(m.a)(this,this.onKeyDown,"onKeyDown"));qc.KeyInputManager.instance.Ea(Jb.a.Hg,this.aIa.ml,Object(m.a)(this,this.ox,"onKeyUp"))}yk(){const a=this.Gc[cc.a.SelectedItemId];if(0<(this.ps(this.nr.Command,this.nr.QueryCommand,this.Gc)&2)){const c=this.Gc[cc.a.SelectedItemId];De.c(c)||a===c||this.iAc.AUc(c)||(this.Gc[cc.a.SelectedItemId]=null)}}}Object(w.a)(Ac,"DropDownBehavior",hb,[]);var Rc=b(579),Bd=b(1332);class qe extends Ac{constructor(a){super(a);this.DPa=null;this.dte=this.anb=this.eva=!1;
this.Xoc=null;this.Voc=-1}get K_(){return this.control}get RN(){return this.K_.RN}get cF(){return this.K_.cF}get FId(){return this.Gc[Rc.a.IsFreeForm]}set FId(a){this.Gc[Rc.a.IsFreeForm]=a}rG(a){Rh.a.instance.Ea(Jb.a.pointerDown,a.ml,Object(m.a)(this,this.uC,"onPointerDown"));const c=a.Np;Sc.a.instance.Ea(Jb.a.focus,c,Object(m.a)(this,this.Ueb,"onInputFocus"));Sc.a.instance.Ea(Jb.a.blur,c,Object(m.a)(this,this.Xra,"onInputBlur"));qc.KeyInputManager.instance.Ea(Jb.a.ah,c,Object(m.a)(this,this.Uom,
"onInputKeyDown"));qc.KeyInputManager.instance.Ea(Jb.a.hs,c,Object(m.a)(this,this.Vom,"onInputKeyPress"));ah.a.instance.Ea(Jb.a.p9,c,Object(m.a)(this,this.Yyf,"onInputMouseUp"));Rh.a.instance.Ea(Jb.a.pointerDown,c,Object(m.a)(this,this.Xom,"onInputPointerDown"));Rh.a.instance.Ea(Jb.a.pointerDown,a.Bgh,Object(m.a)(this,this.vzf,"onMenuButtonPointerDown"))}yk(){0<(this.ps(this.cF.Command,this.cF.QueryCommand,this.Gc)&2)&&(this.anb||this.zWi(),this.QNn())}Z$h(){this.K_.menuItems=null;var a;var c=a=null;
if(!De.c(this.menu)){this.J_d();for(let v of this.menu.children)for(let B of v.children)if(Object(Ub.a)(Fg.a,B)){var h=B;h=h.control;Object(Ub.a)(640,h)&&(a=h,a=a.vg.MenuItemId);Object(Ub.a)(633,h)&&(c=h,c=c.kWa());De.c(a)||De.c(c)||(this.K_.menuItems[c]=a,a=c=null)}}}Xom(a){Object(Ub.a)(358,this.root)&&2===a.He&&(this.DPa=Ve.a.EIa(this.control.Ks.ownerDocument),this.control.Ks.focus());return!1}uC(a){this.gRe();let c=!1;3===a.He&&(c=super.uC(a),this.J_d());c&&a.Sa.preventDefault();return!1}vzf(a){let c=
!1;if(2!==a.He||a.o9===Sys.UI.MouseButton.leftButton)this.ev(a.Ud,a.He,a.Sa),this.J_d(),c=!0;c&&a.Sa.preventDefault();return!1}Uom(a){let c=!1;if(!De.c(a.Sa)&&!De.c(a.Sa.rawEvent)){const h=a.Sa.keyCode;a=a.Sa.rawEvent.shiftKey;Zd.a.oq(this.cF.AutoComplete);if(h===Sys.UI.Key.enter)this.UQ(),this.lMf(),Object(Ub.a)(Bd.Ribbon,this.root)&&this.root.kX(),c=!0;else if(h===Sys.UI.Key.tab){if(this.UQ(),this.lMf(),Object(Ub.a)(Bd.Ribbon,this.root)&&(c=this.root.K8d(this.Yi.Hb,!a)),Object(Ub.a)(358,this.root))return!0}else h===
Sys.UI.Key.backspace||h===Sys.UI.Key.del?this.control.enabled?(this.FOe(),this.Xoc=null):c=!0:h===Sys.UI.Key.esc?(this.qMf(),this.lMf(),Object(Ub.a)(Bd.Ribbon,this.root)&&this.root.kX(),c=!0):h===Sys.UI.Key.down&&(this.VX(1),this.J_d(),c=!0)}return c}Vom(a){if(!this.control.enabled)return!0;!De.c(a.Sa)&&a.Sa.charCode&&this.nqk();return!1}Yyf(){return this.eva?!1:this.eva=!0}IDk(){this.Voc=-1;const a=this.RN.Np,c=a.value,h=this.A0k(c);if(h){a.value=h.key;if(a.setSelectionRange)a.setSelectionRange(c.length,
a.value.length);else if(a.createTextRange){const v=a.createTextRange();v.moveStart("character",c.length);v.moveEnd("character",a.value.length);v.select()}this.Xoc=h.value}else this.Xoc=null}A0k(a){const c=this.K_.menuItems;for(let h in c){const v={key:h,value:c[h]};if(v.key.toLowerCase().startsWith(a.toLowerCase()))return v}return null}nqk(){Zd.a.oq(this.cF.AutoComplete)&&-1===this.Voc&&(this.dte&&(this.VPc(0),this.dte=!1),this.Voc=window.setTimeout(Object(m.a)(this,this.IDk,"executeAutoComplete"),
this.K_.GRj))}FOe(){Zd.a.oq(this.cF.AutoComplete)&&(this.Voc=Zd.a.$sb(this.Voc))}Ueb(a){if(this.KI)return this.menu.setFocus(0),!0;Object(Ub.a)(358,this.root)&&(nc.FocusManager.instance().rA("ribbon"),this.root.dGc=!1);this.onFocus(a);this.anb=!0;Zd.a.ze(this.RN.ml,"cui-cb-focus");Zd.a.oq(this.cF.PopulateDynamically)&&(this.dte=!0);Ve.a.wUc(this.RN.Np);De.c(this.menu)||this.menu.Yk();return this.eva=!1}Xra(){this.anb=!1;this.UQ();Zd.a.rs(this.RN.ml,"cui-cb-focus");return!1}lMf(){Object(Ub.a)(358,
this.root)&&(void 0!==this.DPa&&null!==this.DPa&&l.AFrameworkApplication.na.MTc(this.DPa,2),this.DPa=null)}UQ(){if(this.control.enabled){this.FOe();var a=this.RN.Np;if(void 0===this.Gc[Rc.a.Value]||null===this.Gc[Rc.a.Value]||a.value!==this.Gc[Rc.a.Value].toString())if(this.K_.AUc(this.Xoc))this.FId=!1,this.Gc[Rc.a.Value]=a.value,a={["IsFreeForm"]:!1,["CommandValueId"]:this.K_.FUc.Dwb(),["MenuItemId"]:this.K_.FUc.vg.MenuItemId},this.root.executeCommand(this.cF.Command,a,this.Yi,0,!1);else{if(!Zd.a.oq(this.cF.AutoComplete)){var c=
this.K_.menuItems[a.value];if(!De.b(c)&&this.K_.AUc(c)){this.FId=!1;this.Gc[Rc.a.Value]=a.value;a={["IsFreeForm"]:!1,["CommandValueId"]:this.K_.FUc.Dwb(),["MenuItemId"]:c};this.root.executeCommand(this.cF.Command,a,this.Yi,0,!1);return}}c=!De.b(a.value)&&""!==F.a.Csa(a.value);this.K_.uRg&&c?(this.FId=!0,this.Gc[Rc.a.Value]=a.value,this.root.executeCommand(this.cF.Command,{["IsFreeForm"]:!0,["Value"]:a.value},this.Yi,0,!1)):this.qMf()}}else this.qMf()}qMf(){this.FOe();this.Xoc=null;this.zWi()}zWi(){const a=
this.Gc[Rc.a.Value]||"";a!==this.RN.Np.value&&(this.RN.Np.value=a);this.K_.AUc(this.K_.menuItems[a])}QNn(){const a=this.Gc[Rc.a.FontStyle]||"normal";a!==this.RN.Np.style.fontStyle&&(this.RN.Np.style.fontStyle=a)}J_d(){this.control.Ks&&this.menu&&this.control.Ks.setAttribute(we.a.wUg,this.menu.id)}}Object(w.a)(qe,"ComboBoxBehavior",Ac,[]);class Jf extends hb{constructor(a){super(a)}get Mqd(){return this.control}VDc(){let a=0;this.menu&&this.menu.Hb&&2===this.menu.horizontalAlignment&&(a=this.menu.Hb.clientWidth);
return new Sys.UI.Bounds(this.Mqd.x-a,this.Mqd.y,this.Mqd.kof,this.Mqd.jof)}}Object(w.a)(Jf,"ContextMenuLauncherBehavior",hb,[]);class dg extends hb{constructor(a){super(a)}get xtd(){return this.control}VDc(){return new Sys.UI.Bounds(this.xtd.x,this.xtd.y,this.xtd.kof,this.xtd.jof)}}Object(w.a)(dg,"DialogMenuLauncherBehavior",hb,[]);var Qg=b(1190);class Df extends hb{constructor(a){super(a);this.gte=!1;this.Xuj=!Zd.a.Uca(this.nr.ShouldRefreshWhenDropped)}get bqa(){return this.control}get nr(){return this.control.vg}rG(a){a=
a.ml;De.c(a)||(Sc.a.instance.Ea(Jb.a.focus,a,Object(m.a)(this,this.onFocus,"onFocus")),Sc.a.instance.Ea(Jb.a.blur,a,Object(m.a)(this,this.onBlur,"onBlur")),Rh.a.instance.Ea(Jb.a.pointerOver,a,Object(m.a)(this,this.sV,"onPointerOver")),qc.KeyInputManager.instance.Ea(Jb.a.ah,a,Object(m.a)(this,this.onKeyDown,"onKeyDown")),qc.KeyInputManager.instance.Ea(Jb.a.Hg,a,Object(m.a)(this,this.ox,"onKeyUp")),Rh.a.instance.Ea(Jb.a.pointerDown,a,Object(m.a)(this,this.uC,"onPointerDown")))}yk(){De.c(this.control.vg.Command)||
(this.bqa.KI&&!this.Xuj?this.gte=!0:(0<(this.ps(this.nr.Command,this.nr.QueryCommand,this.Gc)&2)&&this.t1a()&&this.aOa(),Zd.a.oq(this.nr.RefreshableMenu)&&this.KI&&this.menu.DBm()))}aOa(){this.NNn();this.bfa();this.wOn();this.bqa.Fef=this.Gc[Qg.a.ImageIsVisible]}NNn(){const a=Zd.a.Yla(this.Gc[Qg.a.LabelText],this.nr.LabelText),c=this.Gc[Qg.a.LabelTextUserGeneratedPlaceholderReplacements];if(this.control.labelText!==a||this.nr.LabelTextUserGeneratedPlaceholderReplacements!==c)this.fC.medium&&this.ONn(this.fC.medium.kM,
a,c),this.root.UYa=!0,this.control.labelText=a,this.nr.LabelTextUserGeneratedPlaceholderReplacements=c}ONn(a,c,h){const v=a.lastChild;Zd.a.JAi(a,c+" ",h);c=De.c(v);r.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",c?"":v.nodeType.toString());c||a.appendChild(v)}wOn(){const a=this.Gc[Qg.a.ImageBackColor];this.fC.forEach(c=>{Df.gOj(c.gO,a)})}VX(a){"faPrint"===this.control.id&&"jewelWordEditor"===this.control.root.id&&(l.AFrameworkApplication.m9("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),
l.AFrameworkApplication.pa.processAction(Sa.a.Dtd,2));"faRemix"!==this.control.id&&"faTransform"!==this.control.id&&"faPublish"!==this.control.id||"jewelWordEditor"!==this.control.root.id||l.AFrameworkApplication.pa.processAction(Sa.a.Dtd,2);Object(Ub.a)(Fg.a,this.Yi)&&(this.KI||this.sQe(!0),this.control.enabled&&this.IV());super.VX(a)}epa(){super.epa();this.gte&&(this.gte=!1,this.yk())}sV(a){return this.control.yAb()?(this.bqa.KI?(this.root.G_g(),Zd.a.ze(this.bqa.jBb,on.MenuLauncher.YMc),this.bqa.Zba=
this.control.Ks):(super.sV(a),this.ev(a.Ud,a.He,a.Sa)),!1):super.sV(a)}onKeyDown(a){let c=!1;if(!De.c(a.Sa)&&!De.c(a.Sa.rawEvent)){if(Object(Ub.a)(Fg.a,this.Yi)){const h=a.Sa.rawEvent,v=a.Sa.keyCode,B=0===this.root.NY;h.shiftKey||h.ctrlKey||!(v===Sys.UI.Key.right&&B||v===Sys.UI.Key.left&&!B)||(c=this.ocf(a),c||(this.ev(a.Ud,1,a.Sa),c=!0))}c||(c=super.onKeyDown(a))}return c}static gOj(a,c){De.c(a)||De.c(c)||a.style.backgroundColor===c||(a.style.backgroundColor=c)}}Object(w.a)(Df,"FlyoutAnchorBehavior",
hb,[]);var Pf=b(1194);class hg extends Eh{constructor(a){super(a)}get cZb(){return this.control}get properties(){return this.cZb.properties}get Gba(){return this.cZb.Gba}rG(a){a=a.zvb;Sc.a.instance.Ea(Jb.a.focus,a,Object(m.a)(this,this.onFocus,"onFocus"));Sc.a.instance.Ea(Jb.a.blur,a,Object(m.a)(this,this.onBlur,"onBlur"));Rh.a.instance.Ea(Jb.a.pointerOver,a,Object(m.a)(this,this.sV,"onPointerOver"));Rh.a.instance.Ea(Jb.a.pointerOut,a,Object(m.a)(this,this.HM,"onPointerOut"));qc.KeyInputManager.instance.Ea(Jb.a.ah,
a,Object(m.a)(this,this.onKeyDown,"onKeyDown"));qc.KeyInputManager.instance.Ea(Jb.a.Hg,a,Object(m.a)(this,this.ox,"onKeyUp"));Rh.a.instance.Ea(Jb.a.pointerDown,a,Object(m.a)(this,this.uC,"onPointerDown"));Rh.a.instance.Ea(Jb.a.GK,a,Object(m.a)(this,this.Yra,"onPointerUp"));im.a.instance.Ea(Jb.a.XM,a,Object(m.a)(this,this.gfb,"onTouchMove"));im.a.instance.Ea(Jb.a.oH,a,Object(m.a)(this,this.RAa,"onTouchEnd"))}yk(){const a=this.Gc[Pf.a.On],c=this.Gc[Pf.a.IsRtl];this.fWi();if(0<(this.ps(this.properties.Command,
this.properties.QueryCommand,this.Gc)&2)){var h=!De.c(this.Gc[Pf.a.InnerHTML])||!De.c(this.properties.InnerHTML),v=!De.c(this.properties.Image);h||v||(this.control.enabled=!1);v=this.Gba.zvb;if(!De.c(v)){if(h){h=Zd.a.Yla(this.Gc[Pf.a.InnerHTML],this.properties.InnerHTML);if(null===v.innerHTML||null===h||F.a.kg(v.innerHTML)!==F.a.kg(h))v.innerHTML=h;""===h&&(this.control.enabled=!1)}h=v.title;const B=Zd.a.Yla(this.Gc[Pf.a.Alt],this.properties.Alt);B===h||this.control.kSf||(v.title=B)}v=this.Gc[Pf.a.IsRtl];
a===this.Gc[Pf.a.On]&&c===v||this.control.dDb()}}fWi(){const a=this.Gc;a[Pf.a.CommandValueId]=this.control.Dwb();a.MenuItemId=this.control.vg.MenuItemId;a.SourceControlId=this.properties.Id}ev(a,c,h){if((a=this.Yi)&&this.control.enabled){const v=this.root;if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ExcelBorderMenuCompactionEnabled")&&a.CJc()&&this.FF){const B=v.gA[this.FF.yla];B?B.SMa(this.cZb):r.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.fWi();
this.Gc[Pf.a.On]||(this.Gc[Pf.a.On]=!0,this.control.dDb());"Menu"===a.dR&&Zd.a.rs(this.Gba.ml,"cui-gallerybutton-focused");v.executeCommand(this.properties.Command,this.Gc,a,c,!0,null,this.Cca(h))}}onFocus(a){super.onFocus(a);Zd.a.ze(this.Gba.ml,"cui-gallerybutton-focused");return!1}onBlur(a){super.onBlur(a);Zd.a.rs(this.Gba.ml,"cui-gallerybutton-focused");return!1}}Object(w.a)(hg,"GalleryButtonBehavior",Eh,[]);var Ui=b(1510),Zh=b(1205),Nn=b(1355);class jm extends Eh{constructor(a){super(a);this.OQa=
-1}get x1b(){return this.control}get properties(){return this.x1b.vg}get Vwc(){return this.x1b.Vwc}get Zdf(){var a=null;if(this.Yi&&(a=this.Yi.parent,!Object(Ub.a)(Nn.a,a)))throw Error.create("InsertTable must live inside of a MenuSection.");return a}get Zyb(){return this.x1b.QGd.Zyb}get hPc(){return this.x1b.QGd.hPc}ev(a,c,h){if(this.control.enabled){a=this.o8e(this.nZb(a));const v=this.Ayd(a);this.Vwc[Zh.a.Rows]=this.SBd(a)+1;this.Vwc[Zh.a.Columns]=v+1;this.root.executeCommand(this.properties.Command,
this.Vwc,this.Yi,c,!0,null,this.Cca(h))}}rG(a){var c=a.ml;const h=a.s0g;a=a.cells;Rh.a.instance.Ea(Jb.a.pointerOut,c,Object(m.a)(this,this.xmm,"onControlPointerOut"));im.a.instance.Ea(Jb.a.XM,c,Object(m.a)(this,this.zmm,"onControlTouchMove"));im.a.instance.Ea(Jb.a.oH,c,Object(m.a)(this,this.ymm,"onControlTouchEnd"));for(c=0;c<a.length;++c)this.fRj(h[c],a[c])}fRj(a,c){Sc.a.instance.Ea(Jb.a.focus,a,Object(m.a)(this,this.Qxf,"onCellFocus"));Rh.a.instance.Ea(Jb.a.pointerOver,c,Object(m.a)(this,this.Rxf,
"onCellPointerOver"));Rh.a.instance.Ea(Jb.a.GK,c,Object(m.a)(this,this.Sxf,"onCellPointerUp"));qc.KeyInputManager.instance.Ea(Jb.a.ah,c,Object(m.a)(this,this.onKeyDown,"onKeyDown"));qc.KeyInputManager.instance.Ea(Jb.a.Hg,c,Object(m.a)(this,this.ox,"onKeyUp"));im.a.instance.Ea(Jb.a.YM,c,Object(m.a)(this,this.slm,"onCellTouchStart"))}o8e(a){return parseInt(a.id.substr(this.x1b.id.length+1))}FHh(a){this.EHh(this.o8e(a))}SBd(a){return Math.floor(a/Ui.a.SNc)}Ayd(a){return a%Ui.a.SNc}EHh(a){if(a!==this.OQa){var c=
this.Ayd(a),h=this.SBd(a),v=-1;let B=-1;-1!==this.OQa&&(v=this.SBd(this.OQa),B=this.Ayd(this.OQa));for(;v!==h||B!==c;)v<h?this.WCi(++v,B,!0):v>h?(this.WCi(v,B,!1),v--):B<c?this.yAi(++B,v,!0):B>c&&(this.yAi(B,v,!1),B--);this.Zdf?this.Zdf.JDi(this.trh(h+1,c+1)):(h=(c=this.control.rRe)&&0<c.length?c[0]:null,v=this.Yi,r.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",{["CtrlComps"]:!!c,["FirstComp"]:!!h,["FirstCompPar"]:!!h&&!!h.parent,["DispComp"]:!!v,["DispCompPar"]:!!v&&!!v.parent}));
this.OQa=a}}WCi(a,c,h){for(let v=0;v<=c;v++)this.pAi(a,v,h)}yAi(a,c,h){for(let v=0;v<=c;v++)this.pAi(v,a,h)}pAi(a,c,h){c=a*Ui.a.SNc+c;a=this.Zyb[c];c=this.hPc[c];h?(a.className="cui-it-activeCell",c.className="cui-it-activeCellOuter"):(a.className="cui-it-inactiveCell",c.className="cui-it-inactiveCellOuter")}Sxf(a){this.ev(a.Ud,a.He,a.Sa);return!0}nZb(a){for(;a.hasChildNodes();)a=a.childNodes[0];return De.c(a.tagName)||"a"!==a.tagName.toLowerCase()?null:a.parentNode.parentNode}KDi(a){const c=this.o8e(a);
a.childNodes[0].childNodes[0].title=this.trh(this.SBd(c)+1,this.Ayd(c)+1)}trh(a,c){let h=this.properties.Alt;De.c(h)&&(h=this.properties.MenuSectionTitle);return h=String.format(h,c.toString(),a.toString())}ugb(){if(this.Yi){for(var a=0;a<Ui.a.$5b;a++)this.Zyb[a].className="cui-it-inactiveCell",this.hPc[a].className="cui-it-inactiveCellOuter";this.OQa=-1;a=this.properties.MenuSectionInitialTitle;De.c(a)&&(a="");this.Zdf.JDi(a)}}Rxf(a){this.control.enabled&&(a=this.nZb(a.Ud),this.fVc(a),this.GYe(a));
return!1}GYe(a){this.KDi(a);this.FHh(a)}Qxf(a){if(!this.control.enabled)return!1;a=this.nZb(a.Ud);this.KDi(a);this.FHh(a);return!1}xmm(a){Ve.a.Ykf(this.x1b.QGd.ml,a.clientPoint)||this.ugb();return!1}slm(a){if(!this.control.enabled)return!1;a=this.nZb(a.Ud);this.GYe(a);return!0}zmm(a){if(!this.control.enabled)return!1;a=Ve.a.ozd(a.clientPoint);if(!a||"table"===a.tagName.toLowerCase())return!1;(a=this.nZb(a))?this.GYe(a):this.ugb();return!0}ymm(a){if(!this.control.enabled)return!1;var c=Ve.a.ozd(a.clientPoint);
if(!c||"table"===c.tagName.toLowerCase())return this.ugb(),!0;(c=this.nZb(c))?this.ev(c,3,a.Sa):this.ugb();return!0}kI(a){a=Fm.Control.X2e(this.OQa,Ui.a.SNc,Ui.a.$5b,a);if(a!==this.OQa)return this.Zyb[a].firstChild.focus(),this.EHh(a),!0;this.ugb();this.OQa=-1;return!1}IV(){const a=this.Zyb[0];if(De.c(a))return!1;a.firstChild.focus();return!0}fVc(a){if(De.c(a))return!1;a.firstChild.firstChild.focus();return!0}mka(){this.ugb()}}Object(w.a)(jm,"InsertTableBehavior",Eh,[]);class Jq extends hb{constructor(a){super(a)}yk(){this.control.enabled=
!!this.menu}ev(a,c,h){l.AFrameworkApplication.pa.hb(Sa.a.QKa,2,c,this.Cca(h))}}Object(w.a)(Jq,"JewelMenuLauncherBehavior",hb,[]);var Qp=b(1198);class Fp extends Eh{constructor(a){super(a)}get properties(){return this.control.vg}yk(){0<(this.ps(this.properties.Command,this.properties.QueryCommand,this.Gc)&2)&&this.t1a()&&this.aOa()}aOa(){this.NRn();this.bfa();this.OIb()}NRn(){const a=this.control.labelText;let c=this.Gc[Qp.a.Value];De.c(c)&&(c=this.properties.LabelText,De.c(c)&&(c=""));c!==a&&this.p0d(c)}rG(a){a=
a.ml;De.c(a)||(Rh.a.instance.Ea(Jb.a.pointerDown,a,Object(m.a)(this,this.uC,"onPointerDown")),Rh.a.instance.Ea(Jb.a.pointerOver,a,Object(m.a)(this,this.sV,"onPointerOver")),Rh.a.instance.Ea(Jb.a.pointerOut,a,Object(m.a)(this,this.HM,"onPointerOut")))}}Object(w.a)(Fp,"LabelBehavior",Eh,[]);var Lm=b(1390),Kj=b(1303),Qd=b(1505);class Kq extends hb{constructor(a){super(a);this.dme=this.Mde=!1;this.zNb=this.WJb=null;if(this.eOb=l.AFrameworkApplication.K.$("TellMeRedesignIsEnabled"))this.WJb=this.us.kea.LightImage16by16Class,
this.zNb=this.us.kea.DarkImage16by16Class}get us(){return this.control}PPd(a,c,h,v){c&&(this.us.Zba=h,l.AFrameworkApplication.na.Ygb());if(Object(Ub.a)(Kj.a,a)&&v){h=new Lm.a;h.CommandLocation=this.root.g5;h.InvocationMethod=0;const B={};(a=a.control)&&a.vg&&(B.CommandId=a.vg.Command,B.ControlId=a.vg.Id,B.CloseAllMenus=c,a.FF&&a.FF.parent&&a.FF.parent.id&&(B.ParentControlId=a.FF.parent.id.split("-")[0]),this.root.GC&&this.root.GC.pIa(v,B,h))}}epa(){this.us.Zba||(this.us.Zba=this.us.xw);!this.us.Nem&&
this.eOb&&(Zd.a.rs(this.us.xw,"cui-sb-focus"),Zd.a.rs(this.us.UY,"cui-sb-focus"),Zd.a.rs(this.us.Osa,this.WJb),Zd.a.ze(this.us.Osa,this.zNb));this.Mde=!0;super.epa();this.Mde=!1;this.FHf()}get zGi(){return!this.us.ZLa}sRd(){this.us.sRd()}ZWd(){this.dme||this.Mde||(this.dme=!0,this.us.raiseEvent(Qd.a.kXa,null))}FHf(){this.KI||this.us.dgf||(this.dme=!1,this.us.raiseEvent(Qd.a.szb,null))}Vyf(a){Zd.a.rs(this.us.xw,"cui-sb-focus");Zd.a.rs(this.us.UY,"cui-sb-focus");this.eOb&&!this.us.KI&&(Zd.a.rs(this.us.Osa,
this.WJb),Zd.a.ze(this.us.Osa,this.zNb));this.us.raiseEvent(Qd.a.blur,a);this.FHf();this.us.Zba=this.us.xw;return!1}Wyf(a){Zd.a.ze(this.us.xw,"cui-sb-focus");Zd.a.ze(this.us.UY,"cui-sb-focus");this.eOb&&(Zd.a.rs(this.us.Osa,this.zNb),Zd.a.ze(this.us.Osa,this.WJb));this.us.raiseEvent(Qd.a.focus,a);this.ZWd();return!1}xAf(){this.eOb&&(Zd.a.ze(this.us.UY,"cui-sb-hover"),Zd.a.ze(this.us.xw,"cui-sb-hover"),Zd.a.rs(this.us.Osa,this.zNb),Zd.a.ze(this.us.Osa,this.WJb));return!1}wAf(){this.eOb&&(Zd.a.rs(this.us.UY,
"cui-sb-hover"),Zd.a.rs(this.us.xw,"cui-sb-hover"),this.us.KI||this.us.dgf||(Zd.a.rs(this.us.Osa,this.WJb),Zd.a.ze(this.us.Osa,this.zNb)));return!1}}Object(w.a)(Kq,"SearchBoxBehavior",hb,[639,637]);class vm{}vm.Value="value";vm.MinValue="MinValue";vm.MaxValue="MaxValue";vm.Text="Text";Object(w.a)(vm,"SliderCommandProperties",null,[]);class Rp extends Eh{constructor(a){super(a)}get gUf(){return this.control}get u1(){return this.gUf.u1}get properties(){return this.control.vg}initialize(){}ev(){}rG(a){a=
a.Np;Sc.a.instance.Ea(Jb.a.focus,a,Object(m.a)(this,this.onFocus,"onFocus"));Sc.a.instance.Ea(Jb.a.blur,a,Object(m.a)(this,this.onBlur,"onBlur"));Sc.a.instance.Ea(Jb.a.change,a,Object(m.a)(this,this.s9,"onChange"));Sc.a.instance.Ea(Jb.a.input,a,Object(m.a)(this,this.s9,"onChange"))}onFocus(a){this.u1.ml&&Sys.UI.DomElement.addCssClass(this.u1.ml,"cui-sldr-onfocus");return super.onFocus(a)}onBlur(a){this.u1.ml&&Sys.UI.DomElement.removeCssClass(this.u1.ml,"cui-sldr-onfocus");return super.onBlur(a)}s9(){this.bak(this.u1.Np.value);
return!0}bak(a){this.Gc[vm.Value]=parseFloat(a);this.root.executeCommand(this.properties.Command,this.Gc,this.Yi,0,!1)}yk(){const a=this.Gc[vm.Value],c=this.Gc[vm.MaxValue],h=this.Gc[vm.Text];var v=this.ps(this.properties.Command,this.properties.QueryCommand,this.Gc);this.u1&&this.u1.Np&&(this.u1.Np.disabled=!this.control.enabled);if(0<(v&2)){v=this.Gc[vm.Value];const B=this.Gc[vm.MaxValue],X=this.Gc[vm.Text];(B!==c||v!==a||h!==X)&&this.u1&&this.u1.Np&&(this.u1.Np.setAttribute(we.a.Hmd,String.format("{0}",
B)),this.u1.Np.setAttribute("max",String.format("{0}",B)),this.u1.Np.value=v,this.u1.kM.innerText=this.Gc[vm.Text])}}}Object(w.a)(Rp,"SliderBehavior",Eh,[]);var pg=b(1197);class yj extends Eh{constructor(a){super(a);this.ybd=0;this.x7a=null;this.d$c=!1;this.OKg=null;this.wBe=!1;this.zed=this.Tcd=-1;this.eva=!1}get spinner(){return this.control}get qE(){return this.spinner.qE}get properties(){return this.control.vg}initialize(){const a=this.spinner.G1f;this.OKg=this.XJn(a);this.ybd=a[0].min;this.x7a=
a[0];this.d$c=!1}ev(){}rG(a){const c=a.Np,h=a.TXb;a=a.rAc;Sc.a.instance.Ea(Jb.a.focus,c,Object(m.a)(this,this.onFocus,"onFocus"));Sc.a.instance.Ea(Jb.a.blur,c,Object(m.a)(this,this.onBlur,"onBlur"));qc.KeyInputManager.instance.Ea(Jb.a.ah,c,Object(m.a)(this,this.onKeyDown,"onKeyDown"));qc.KeyInputManager.instance.Ea(Jb.a.hs,c,Object(m.a)(this,this.fE,"onKeyPress"));qc.KeyInputManager.instance.Ea(Jb.a.Hg,c,Object(m.a)(this,this.ox,"onKeyUp"));Sc.a.instance.Ea(Jb.a.change,c,Object(m.a)(this,this.s9,
"onChange"));ah.a.instance.Ea(Jb.a.p9,c,Object(m.a)(this,this.Yyf,"onInputMouseUp"));Rh.a.instance.Ea(Jb.a.pointerDown,h,Object(m.a)(this,this.V9h,"onArrowPointerDown"));Rh.a.instance.Ea(Jb.a.pointerDown,a,Object(m.a)(this,this.V9h,"onArrowPointerDown"));Rh.a.instance.Ea(Jb.a.GK,h,Object(m.a)(this,this.W9h,"onArrowPointerUp"));Rh.a.instance.Ea(Jb.a.GK,a,Object(m.a)(this,this.W9h,"onArrowPointerUp"));im.a.instance.Ea(Jb.a.XM,h,Object(m.a)(this,this.Y9h,"onArrowTouchMove"));im.a.instance.Ea(Jb.a.XM,
a,Object(m.a)(this,this.Y9h,"onArrowTouchMove"));im.a.instance.Ea(Jb.a.oH,h,Object(m.a)(this,this.X9h,"onArrowTouchEnd"));im.a.instance.Ea(Jb.a.oH,a,Object(m.a)(this,this.X9h,"onArrowTouchEnd"))}onFocus(a){super.onFocus(a);Zd.a.ze(this.qE.ml,"cui-spn-focus");this.control.enabled&&Ve.a.wUc(this.qE.Np);return this.eva=!1}onBlur(a){super.onBlur(a);Zd.a.rs(this.qE.ml,"cui-spn-focus");return!1}onKeyDown(a){let c=!1;if(!De.c(a.Sa)&&!De.c(a.Sa.rawEvent)){const h=a.Sa.keyCode,v=a.Sa.rawEvent.shiftKey;if(h===
Sys.UI.Key.up||h===Sys.UI.Key.down)this.root.iif(this.control)||this.TKi(h===Sys.UI.Key.up,a.He),c=!0;else if(h===Sys.UI.Key.enter)this.UQ(),Object(Ub.a)(Bd.Ribbon,this.root)&&this.root.kX(),c=!0;else if(h===Sys.UI.Key.tab)this.UQ(),Object(Ub.a)(Bd.Ribbon,this.root)&&(c=this.root.K8d(this.Yi.Hb,!v));else if(h===Sys.UI.Key.esc)this.h9b(),Object(Ub.a)(Bd.Ribbon,this.root)&&this.root.kX(),c=!0;else if(h===Sys.UI.Key.backspace||h===Sys.UI.Key.del)c=!this.control.enabled}return c}fE(){return!this.control.enabled}ox(){this.dpk();
return!1}s9(){this.UQ();return!1}Yyf(){return this.eva?!1:this.eva=!0}V9h(a){var c=!1;let h=!0;2===a.He&&(h=a.o9===Sys.UI.MouseButton.leftButton);h&&(c=a.Ud,this.TKi(c===this.qE.TXb||c===this.qE.Mgh||c===this.qE.Lgh,a.He),c=!0);return c}W9h(a){return this.Dpa(a)}Y9h(a){return this.iQd(a)}X9h(a){return this.Dpa(a)}Zxl(a){if(this.control.enabled){var c=!1;if(!this.d$c){var h=this.F3k(a);h=a?h+this.x7a.step:h-this.x7a.step;h=Math.min(h,this.x7a.max);h=Math.max(h,this.x7a.min);h!==this.ybd&&(this.fRe(h,
this.x7a),this.root.executeCommand(this.properties.Command,this.Gc,this.Yi,0,!1),c=!0)}c||(c=this.properties.SpinCommand,h=this.Gc,h.Increment=a,De.c(c)||this.root.executeCommand(c,h,this.Yi,0,!1))}}F3k(a){const c=Math.pow(10,l.AFrameworkApplication.numberFormat.WPd),h=Math.round(this.x7a.step*c);let v=Math.round(this.ybd*c)/h;v=a?Math.floor(v):Math.ceil(v);return v*h/c}TKi(a,c){if(this.control.enabled){this.UQ();const h=a?this.qE.TXb:this.qE.rAc;switch(c){case 2:case 3:this.wBe=a;this.rkd(h);break;
case 1:this.wBe=a,this.qBj(h)}}}uLi(){this.H_g();this.S1j()}Ybh(){-1===this.Tcd&&(this.Tcd=window.setTimeout(Object(m.a)(this,this.z_m,"repeatSpin"),500))}H_g(){this.Tcd=Zd.a.$sb(this.Tcd)}z_m(){this.H_g();-1===this.zed&&(this.Z2d(),this.zed=window.setInterval(Object(m.a)(this,this.Z2d,"spin"),50))}S1j(){this.zed=Zd.a.O1j(this.zed)}Z2d(){this.Zxl(this.wBe)}qBj(a){this.root.sba(this.control,!1);Zd.a.ze(a,Fm.Control.ukd);this.Z2d();this.Ybh()}dpk(){this.root.b8(this.control,!1);this.uLi();Zd.a.rs(this.qE.TXb,
Fm.Control.ukd);Zd.a.rs(this.qE.rAc,Fm.Control.ukd)}G$b(a){this.qE.Np.value!==a&&(this.qE.Np.value=a)}h9b(){this.G$b(this.Gc[pg.a.Text])}NAi(a){this.G$b(a);this.Gc[pg.a.Text]=a;this.d$c=!0}Ycn(a,c,h){this.G$b(h);this.Gc[pg.a.Text]=h;this.Gc[pg.a.Number]=a;this.Gc[pg.a.UnitType]=c.type;this.ybd=a;this.x7a=c;this.qE.Np.setAttribute(we.a.jLe,h);this.qE.Np.setAttribute(we.a.CUg,String.format("{0}",c.min));this.qE.Np.setAttribute(we.a.Hmd,String.format("{0}",c.max));this.d$c=!1}J4g(a){var c;if(({Ihm:c}=
this.CSl(a)).returnValue)this.NAi(c);else{({number:a,g1a:c}=F.a.Dgi(a,this.OKg,l.AFrameworkApplication.numberFormat));let h=this.K6d(c);0===c&&De.c(h)&&(h=this.K6d(this.Gc[pg.a.UnitType]));this.fRe(a,h)}}fRe(a,c){a=this.hwf(a,c);if(isNaN(a)||De.c(c))this.h9b();else{const h=l.AFrameworkApplication.numberFormat;let v;v=F.a.pya(a,c.type,h);v=v.replace(6===c.type?h.XPd:h.oDf,"");this.Ycn(a,c,v)}}CSl(a){let c,h=!1;c="";a=a.trim();const v=this.spinner.DXi;if(!De.c(v))for(let B=0;B<v.length;B++)if(v[B].toLowerCase()===
a.toLowerCase()){c=v[B];h=!0;break}return{returnValue:h,Ihm:c}}hwf(a,c){return isNaN(a)||De.c(c)?Number.NaN:c.hwf(a)}K6d(a){let c=null;const h=this.spinner.G1f;for(let v=0;v<h.length;v++)if(h[v].type===a){c=h[v];break}return c}XJn(a){const c=a.length,h=Array(c);for(let v=0;v<c;v++)h[v]=a[v].type;return h}UQ(){if(this.control.enabled){const a=this.Gc[pg.a.Text],c=this.qE.Np.value;c!==a&&(this.J4g(c),this.Gc[pg.a.Text]!==a&&this.root.executeCommand(this.properties.Command,this.Gc,this.Yi,0,!1))}else this.h9b()}yk(){var a=
this.Gc[pg.a.Text],c=this.Gc[pg.a.Number];const h=this.Gc[pg.a.UnitType],v=this.Gc[pg.a.MaxValue];if(0<(this.ps(this.properties.Command,this.properties.QueryCommand,this.Gc)&2)){const B=this.Gc[pg.a.Text],X=this.Gc[pg.a.Number],ma=this.Gc[pg.a.UnitType],Pa=this.Gc[pg.a.MaxValue];Pa!==v&&(this.K6d(ma).max=Pa,this.qE.Np.setAttribute(we.a.Hmd,String.format("{0}",Pa)));B!==a?""===B?this.NAi(B):this.J4g(B):isNaN(X)||X===c&&ma===h||this.fRe(X,this.K6d(ma));a=this.qE.ml.title;c=Zd.a.Yla(this.Gc[pg.a.Alt],
this.properties.Alt);c!==a&&(this.qE.Np.title=c,this.qE.TXb.title=c,this.qE.rAc.title=c)}}QGe(a){super.QGe(a);a?(this.Z2d(),this.Ybh()):this.uLi()}}Object(w.a)(yj,"SpinnerBehavior",Eh,[638,637]);var Tj=b(306),lp=b(1059);class en extends hb{constructor(a){super(a);this.YOb=!0;this.ykb=!1}get v1(){return this.control}get nr(){return this.v1.properties}rG(a){const c=a.ml,h=a.j$a;a=a.tAc;Sc.a.instance.Ea(Jb.a.focus,c,Object(m.a)(this,this.onFocus,"onFocus"));Sc.a.instance.Ea(Jb.a.blur,c,Object(m.a)(this,
this.onBlur,"onBlur"));qc.KeyInputManager.instance.Ea(Jb.a.ah,c,Object(m.a)(this,this.onKeyDown,"onKeyDown"));qc.KeyInputManager.instance.Ea(Jb.a.Hg,c,Object(m.a)(this,this.ox,"onKeyUp"));H.a.so&&16>this.MZk()&&(Rh.a.instance.Ea(Jb.a.pointerDown,c,Object(m.a)(this,this.pdi,"onSplitbuttonPointerDownPointerUp")),Rh.a.instance.Ea(Jb.a.GK,c,Object(m.a)(this,this.pdi,"onSplitbuttonPointerDownPointerUp")));Rh.a.instance.Ea(Jb.a.pointerOver,h,Object(m.a)(this,this.elm,"onButtonPointerOver"));Rh.a.instance.Ea(Jb.a.pointerOut,
h,Object(m.a)(this,this.dlm,"onButtonPointerOut"));Rh.a.instance.Ea(Jb.a.pointerDown,h,Object(m.a)(this,this.j$h,"onButtonPointerDown"));Rh.a.instance.Ea(Jb.a.GK,h,Object(m.a)(this,this.k$h,"onButtonPointerUp"));im.a.instance.Ea(Jb.a.XM,h,Object(m.a)(this,this.glm,"onButtonTouchMove"));im.a.instance.Ea(Jb.a.oH,h,Object(m.a)(this,this.flm,"onButtonTouchEnd"));Rh.a.instance.Ea(Jb.a.pointerDown,a,Object(m.a)(this,this.vzf,"onMenuButtonPointerDown"));Rh.a.instance.Ea(Jb.a.pointerOver,a,Object(m.a)(this,
this.Mpm,"onMenuButtonPointerOver"));Rh.a.instance.Ea(Jb.a.pointerOut,a,Object(m.a)(this,this.Lpm,"onMenuButtonPointerOut"))}ev(a,c,h){Sys.UI.DomElement.containsCssClass(a,"cui-ctl-a1")?this.ykb&&(this.v1.on=!this.v1.on,a=this.Gc,a.CommandValueId=this.control.Dwb(),this.root.executeCommand(this.nr.Command,a,this.Yi,c,!0,null,this.Cca(h))):this.YOb&&super.ev(a,c,h)}ox(a){const c=a.Sa.keyCode;return c===Sys.UI.Key.enter||c===Sys.UI.Key.space?(a=this.Gc,a.CommandValueId=this.control.Dwb(),this.root.executeCommand(this.nr.Command,
a,this.Yi,1,!0),!0):super.ox(a)}yk(){const a=this.root.Fka(this.nr.Command,this.nr.QueryCommand,this.Gc),c=0<(a&1);let h=!0;h=De.c(this.nr.CommandMenuOpen)?c:0<(this.root.Fka(this.nr.CommandMenuOpen,null,null)&1);if(h!==this.YOb||c!==this.ykb||(h||c)!==this.control.enabled)this.control.enabled=h||c,c!==this.ykb&&this.pnm(c),h!==this.YOb&&this.qnm(h),this.YOb=h,this.ykb=c;if(0<(a&2)){this.bfa();const v=Zd.a.Yla(this.Gc[lp.a.LabelText],this.nr.LabelText);this.Gc[lp.a.ApplyLabelTextToControlOnly]?this.v1.QYb(B=>
{B.ml.title=v;B.j$a.removeAttribute("title");B.tAc.removeAttribute("title")}):this.v1.QYb(B=>{B.j$a.title=v});this.Gc[lp.a.EnsureControlRoleIsButton]&&this.v1.QYb(B=>{we.a.wo(B.ml,we.a.tg,we.a.v_)});De.c(this.Gc[lp.a.Visible])||this.t1a()&&this.aOa()}this.v1.Zh(this.v1.on&&c)}aOa(){this.l0f();this.OIb();this.bfa()}qnm(a){this.v1.QYb(c=>{Zd.a.UBa(c.tAc,a)});this.DSc();this.YOb=a}pnm(a){this.v1.QYb(c=>{Zd.a.UBa(c.j$a,a)});this.DSc();this.ykb=a}DSc(){const a=this.v1.zab();De.c(a)||(Zd.a.rs(a.childNodes[0],
"cui-ctl-split-hovered-primary"),Zd.a.rs(a.childNodes[0],"cui-ctl-split-hovered-secondary"),Zd.a.rs(a.childNodes[1],"cui-ctl-split-hovered-primary"),Zd.a.rs(a.childNodes[1],"cui-ctl-split-hovered-secondary"))}pdi(a){if(0!==Tj.a(a.Sa))return!1;let c=!1;a.eventName===Jb.a.pointerDown?c=this.j$h(a):a.eventName===Jb.a.GK&&(c=this.k$h(a));return c}j$h(a){let c=!1;const h=a.He;switch(h){case 3:this.Spn()?this.ev(this.Yi.Hb,h,a.Sa):this.rkd(this.v1.veh);c=!0;break;case 2:a.o9===Sys.UI.MouseButton.leftButton&&
(this.rkd(this.v1.veh),c=!0)}c&&a.Sa.preventDefault();return!1}Spn(){const a=this.Yi.dR;return"Small"===a||"Medium"===a||"Menu16"===a||"MenuTellMe"===a}k$h(a){return this.Dpa(a)}glm(a){return this.iQd(a)}flm(a){return this.Dpa(a)}onFocus(a){super.onFocus(a);this.Ldf(!0,!0);return!1}onBlur(a){super.onFocus(a);this.DSc();return!1}elm(){this.control.enabled&&this.ykb&&this.Ldf(!0,this.v1.on);return!1}dlm(){this.control.enabled&&this.ykb&&this.DSc();return!1}vzf(a){let c=!1;if(2!==a.He||a.o9===Sys.UI.MouseButton.leftButton)this.ev(a.Ud,
a.He,a.Sa),c=!0;c&&a.Sa.preventDefault();return!1}Mpm(){this.control.enabled&&this.YOb&&this.Ldf(this.v1.on,!0);return!1}Lpm(){this.DSc();return!1}Ldf(a,c){const h=this.control.zab();De.c(h)||(Zd.a.ze(h.childNodes[0],a?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),Zd.a.ze(h.childNodes[1],c?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))}MZk(){var a=H.a.vvb;return a&&(a=a.split("."),2===a.length)?parseInt(a[0]):0}}Object(w.a)(en,"SplitButtonBehavior",hb,[]);
var fn=b(1204);class Fr extends Eh{constructor(a){super(a);this.anb=this.eva=!1;this.udj=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ExcelTableRenameEnabled")}get textBox(){return this.control}get y$(){return this.textBox.y$}get jXf(){return this.textBox.vg}rG(a){a=a.Np;Sc.a.instance.Ea(Jb.a.focus,a,Object(m.a)(this,this.onFocus,"onFocus"));Sc.a.instance.Ea(Jb.a.blur,a,Object(m.a)(this,this.onBlur,"onBlur"));qc.KeyInputManager.instance.Ea(Jb.a.ah,a,Object(m.a)(this,this.onKeyDown,"onKeyDown"));
qc.KeyInputManager.instance.Ea(Jb.a.hs,a,Object(m.a)(this,this.fE,"onKeyPress"));qc.KeyInputManager.instance.Ea(Jb.a.Hg,a,Object(m.a)(this,this.ox,"onKeyUp"));Sc.a.instance.Ea(Jb.a.change,a,Object(m.a)(this,this.s9,"onChange"));ah.a.instance.Ea(Jb.a.p9,a,Object(m.a)(this,this.BLa,"onMouseUp"))}onFocus(a){super.onFocus(a);this.anb=!0;Zd.a.ze(this.y$.ml,"cui-tb-focus");this.control.enabled&&Ve.a.wUc(this.y$.Np);return this.eva=!1}onBlur(a){this.anb=!1;super.onBlur(a);Zd.a.rs(this.y$.ml,"cui-tb-focus");
return!1}onKeyDown(a){let c=super.onKeyDown(a);if(!De.c(a.Sa)&&!De.c(a.Sa.rawEvent)){const h=a.Sa.keyCode,v=a.Sa.rawEvent.shiftKey;h===Sys.UI.Key.tab?(this.UQ(),Object(Ub.a)(Bd.Ribbon,this.root)&&(c=this.root.K8d(this.Yi.Hb,!v))):h===Sys.UI.Key.enter?this.udj&&(this.UQ(),Object(Ub.a)(Bd.Ribbon,this.root)&&this.root.kX(),c=!0):h===Sys.UI.Key.esc?(this.h9b(),Object(Ub.a)(Bd.Ribbon,this.root)&&this.root.kX(),c=!0):h===Sys.UI.Key.backspace||h===Sys.UI.Key.del?c=!this.control.enabled:a.Fha&&(Ld.a.D_g(a.Sa),
c=!1)}return c}fE(){return!this.control.enabled}ox(){return!1}s9(){this.UQ();return!1}BLa(){return this.y$.isEditable?this.eva?!1:this.eva=!0:(Ve.a.wUc(this.y$.Np),!0)}G$b(a){this.y$.Np.value!==a&&(this.y$.Np.value=a)}h9b(){this.G$b(this.Gc[fn.a.Text])}UQ(){if(this.control.enabled&&this.y$.isEditable){const a=this.y$.Np.value;a!==this.Gc[fn.a.Text]&&(this.Gc[fn.a.Text]=a,this.root.executeCommand(this.jXf.Command,this.Gc,this.Yi,0,!1))}else this.h9b()}yk(){const a=this.Gc[fn.a.Text];if(0<(this.ps(this.jXf.Command,
this.jXf.QueryCommand,this.Gc)&2)&&!this.anb){const c=this.Gc[fn.a.Text];c!==a&&this.G$b(c)}}}Object(w.a)(Fr,"TextBoxBehavior",Eh,[636,637]);var Lq=b(1333);class wo extends Eh{constructor(a){super(a)}get toggleButton(){return this.control}get properties(){return this.control.vg}ev(a,c,h){this.control.enabled&&(Zd.a.Uca(this.properties.TogglesWhenExecuted)||this.toggle(),this.Gc.CommandValueId=this.toggleButton.Dwb(),this.Gc.MenuItemId=this.toggleButton.vg.MenuItemId,this.Gc.SourceControlId=this.control.id,
this.root.executeCommand(this.properties.Command,this.Gc,this.Yi,c,!Zd.a.Uca(this.properties.CloseMenuWhenExecuted),v=>{Zd.a.oq(this.properties.UpdateHtmlPostToggle)&&(32===v?this.$Oi():this.YOi())},this.Cca(h)))}YOi(){this.Gc[Uf.a.On]=!this.Gc[Uf.a.On]}$Oi(){this.toggleButton.Zh(this.Gc[Uf.a.On]);(this.toggleButton.Bta&&this.toggleButton.O7d||Zd.a.oq(this.properties.UpdateHtmlPostToggle))&&this.aOa()}toggle(){this.YOi();Zd.a.oq(this.properties.UpdateHtmlPostToggle)||this.$Oi()}onKeyDown(a){const c=
super.onKeyDown(a);if(!c&&!De.c(a.Sa)&&this.FF){const h=a.Sa.keyCode;h!==Sys.UI.Key.enter&&h!==Sys.UI.Key.space||a.Sa.preventDefault()}return c}yk(){De.c(this.properties.MenuItemId)||(this.Gc.MenuItemId=this.properties.MenuItemId);0<(this.ps(this.properties.Command,this.properties.QueryCommand,this.Gc)&2)&&this.t1a()&&this.aOa()}aOa(){this.toggleButton.Zh(this.Gc[Uf.a.On]);this.qNn(Zd.a.Yla(this.Gc[Uf.a.DisplayMode],""));this.l0f();this.bfa();this.SOn();Uf.a.Alt in this.Gc&&this.OIb()}SOn(){const a=
this.fC.n4b;if(a&&a.k$a){var c=Zd.a.Yla(this.Gc[Uf.a.Description],this.properties.Description);c!==a.k$a.innerText&&(a.k$a.innerText=c,a.kM&&!Object(Ub.a)(Lq.Jewel,this.root)&&(c=!De.b(c),Zd.a.PV(a.kM,"UIFontBold",c),Zd.a.PV(a.kM,"cui-ctl-mediumlabel-nodescription",!c)))}}rG(a){a=a.ml;Sc.a.instance.Ea(Jb.a.focus,a,Object(m.a)(this,this.onFocus,"onFocus"));Sc.a.instance.Ea(Jb.a.blur,a,Object(m.a)(this,this.onBlur,"onBlur"));Rh.a.instance.Ea(Jb.a.pointerOver,a,Object(m.a)(this,this.sV,"onPointerOver"));
Rh.a.instance.Ea(Jb.a.pointerOut,a,Object(m.a)(this,this.HM,"onPointerOut"));qc.KeyInputManager.instance.Ea(Jb.a.ah,a,Object(m.a)(this,this.onKeyDown,"onKeyDown"));qc.KeyInputManager.instance.Ea(Jb.a.Hg,a,Object(m.a)(this,this.ox,"onKeyUp"));Rh.a.instance.Ea(Jb.a.pointerDown,a,Object(m.a)(this,this.uC,"onPointerDown"));Rh.a.instance.Ea(Jb.a.GK,a,Object(m.a)(this,this.Yra,"onPointerUp"));oi.a.instance.Ea(Jb.a.click,a,Object(m.a)(this,this.onClick,"onClick"));im.a.instance.Ea(Jb.a.XM,a,Object(m.a)(this,
this.gfb,"onTouchMove"));im.a.instance.Ea(Jb.a.oH,a,Object(m.a)(this,this.RAa,"onTouchEnd"))}}Object(w.a)(wo,"ToggleButtonBehavior",Eh,[]);class Vg{constructor(a){this.Y$i=a;this.vie={["Button"]:c=>new Hj(c),["FileMenuButton"]:c=>new Hj(c),["ColorPicker"]:c=>new bp(c),["ComboBox"]:c=>new qe(c),["ContextMenuControl"]:c=>new Jf(c),["ContextMenuLauncher"]:c=>new Jf(c),["DialogMenuLauncher"]:c=>new dg(c),["DropDown"]:c=>new Ac(c),["FlyoutAnchor"]:c=>new Df(c),["GalleryButton"]:c=>new hg(c),["StatefulColorFlyoutAnchor"]:c=>
new Df(c),["JewelMenuLauncher"]:c=>new Jq(c),["Label"]:c=>new Fp(c),["Placeholder"]:c=>new Eh(c),["SearchBox"]:c=>new Kq(c),["Separator"]:c=>new Eh(c),["SplitButton"]:c=>new en(c),["StatefulColorSplitButton"]:c=>new en(c),["StatefulImageSplitButton"]:c=>new en(c),["TextBox"]:c=>new Fr(c),["ToggleButton"]:c=>new wo(c)}}fhh(){this.vie[Fm.Control.PNh]=a=>new jm(a)}l_e(){this.vie[Fm.Control.TJi]=a=>new yj(a)}HSk(a){const c=this.vie[a.controlType];(a=c?c(a):null)&&this.Y$i&&a.qAk();return a}static get instance(){return Vg._instance||
(Vg._instance=new Vg(!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("CUICommitChangeFixIsEnabled")))}}Vg._instance=null;Object(w.a)(Vg,"ControlBehaviorFactory",null,[617]);var Xm=b(1424),Bl=b(1299);class Tn extends on.MenuLauncher{constructor(a,c,h,v){super(a,c,h,v);this.Psg=null;this.HGa=this.jtc=0;this.GC=null;this.hmc=this.gmc=0;this.$f("Menu");this.enabled=!0}get x(){return this.jtc}get y(){return this.HGa}get jof(){return this.gmc}get kof(){return this.hmc}get controlType(){return"DialogMenuLauncher"}Q_a(){}k1a(){}W5e(){const a=
{};a.MenuId=this.id;a.DialogMoveCommand=this.nr.DialogMoveCommand;a.DialogCloseCommand=this.nr.DialogCloseCommand;return a}FXl(a,c){this.jtc=a.x;this.HGa=a.y;this.gmc=a.height;this.hmc=a.width;this.VX(c)}YN(a){this.Psg=Zd.a.createElement("span");return new Bl.a(a,this.Psg)}get nr(){return this.vg}jpa(a,c,h){return new Tn(a,this.id,c,h)}}Object(w.a)(Tn,"DialogMenuLauncher",on.MenuLauncher,[]);var In=b(1425);class Rl extends Xm.a{constructor(a,c){super(a,c);this.j2a=null}get TGe(){return this.j2a}get ndh(){return this.properties}get g5(){return 20}Yk(){super.Yk();
De.c(this.Hb)&&this.Xz();this.Hb=Zd.a.vMa(this.Hb);this.mU(this.Hb);this.dirty=!1}mM(a){if(!Object(Ub.a)(In.a,a))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot");}GTe(a,c,h,v){h=new na.Menu(this,c,h,v,null);a||(a={});a.CommandMenuOpen=this.ndh.CommandMenuOpen;a.CommandMenuClose=this.ndh.CommandMenuClose;a=new Tn(this,c,a,h);this.nub[c]=a;c=new In.a(this,"dock"+c);c.Je(a.ZN("Menu"));this.Je(c);this.refresh()}bTf(a,c,h,v){const B=this.nub[a];if(De.c(B))throw Error.create('The dialog menu "'+
a+'" does not exist');B.FXl(new Sys.UI.Bounds(c,h,0,0),v);this.j2a=B.menu}tQe(a){a=this.nub[a];De.c(a)||(a.epa(),this.j2a=null)}tRd(){this.j2a=null}dispose(){const a=this.nub;for(let c in a)a[c].dispose();super.dispose()}}Object(w.a)(Rl,"DialogMenuRoot",Xm.a,[]);class Gr{constructor(){this.LabelText=this.TextDirection=this.ImageSpinner=this.ImageExpandedArrowClass=this.ImageExpandedArrow=this.ImageCollapsedArrowClass=this.ImageCollapsedArrow=this.ImageUncheckMarkClass=this.ImageUncheckMark=this.ImageCheckMarkClass=
this.ImageCheckMark=this.ImageUpArrow8by8Class=this.ImageUpArrow8by8=this.ImageUpArrowClass=this.ImageUpArrow=this.ImageSideArrowClass=this.ImageSideArrow=this.ImageDownArrow8by8Class=this.ImageDownArrow8by8=this.ImageDownArrowClass=this.ImageDownArrow=this.DivSyndicated=null}}Object(w.a)(Gr,"RootProperties",null,[]);class Dn extends Gr{constructor(){super()}}Object(w.a)(Dn,"StandaloneRootProperties",Gr,[]);class cs extends Dn{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}
Object(w.a)(cs,"DialogMenuRootProperties",Dn,[]);class cm{constructor(){const a=new cs;a.ImageSideArrow=l.AFrameworkApplication.qp;a.ImageSideArrowClass=Fd.getImageClass("SubmenuFlyoutArrow_13x13x32");a.TextDirection=l.AFrameworkApplication.isRtl?"rtl":"ltr";this.wc=new Rl("DialogMenuRootId",a);this.wc.GC=this;this.wc.refresh();l.AFrameworkApplication.pa.Aa(Sa.a.WDf,Kc.a.frame,Object(m.a)(this,this.WDf,"populateDialogMenu"),96)}get SY(){return this.wc}pIa(a,c,h,v,B=null){a=parseInt(a);v=l.AFrameworkApplication.pa;
h&&(v.eF=h.CommandLocation,v.i4=h.InvocationMethod);c=v.hb(a,2,c,B);this.wc.refresh();return 32===c}$za(a){return a?32===l.AFrameworkApplication.pa.processAction(parseInt(a),1):!0}ps(){this.SY.root.yk()}GTe(a,c,h){const v={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};v.DialogMoveCommand=c;v.DialogCloseCommand=h;this.SY.GTe(v,a,"","")}bTf(a,c,h,v){this.SY.bTf(a,c,h,v)}tQe(a){this.SY.tQe(a)}WDf(a,c,h,v,B){if(1===h)return 32;a=new Sys.StringBuilder;
a.append('<Menu Id="dialogMenu">');a.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');a.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',B.DialogMoveCommand,CommonUIStrings.l_DialogMove));a.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',B.DialogCloseCommand,CommonUIStrings.l_DialogClose));a.append("</Controls></MenuSection>");a.append("</Menu>");B.PopulationXML=a.toString();return 32}dispose(){this.wc&&
(this.wc.dispose(),this.wc=null)}}Object(w.a)(cm,"DialogMenuRootUser",null,[311,14,581]);class lk{constructor(a,c,h){this.blb=this.Ogd=this.unc=this.Gk=null;this.ime=this.fgd=!1;this.vjc=a;this.jd=c;this.xq=h;this.dOb=l.AFrameworkApplication.isRtl}get Yef(){return this.ime}QCk(a){a?(this.Gk=a,this.ime=!0,this.fgd=!1,this.jd.capture(Object(m.a)(this,this.uWl,"keyEventHandler"),null),this.xq.Ea(Jb.a.pointerDown,this.vjc,Object(m.a)(this,this.I7b,"pointerDownHandler")),this.unc||this.Hjk(),this.Gk.appendChild(this.unc),
this.kAl()):r.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")}S0e(){this.ime=!1;this.Ogd=this.blb=null;this.IWm();this.BJf();this.Gk=null}BJf(){this.jd.releaseCapture();this.xq.xb(Jb.a.pointerDown,this.vjc,Object(m.a)(this,this.I7b,"pointerDownHandler"))}kAl(){if(this.Gk.style.left.endsWith("px")&&this.Gk.style.right.endsWith("px"))this.blb=new Sys.UI.Point(al.a.AV(this.dOb?this.Gk.style.right:this.Gk.style.left),al.a.AV(this.Gk.style.top));else{const a=this.dOb?this.vjc.offsetWidth-
(this.Gk.offsetLeft+this.Gk.offsetWidth+al.a.AV(this.Gk.style.marginRight)):this.Gk.offsetLeft-al.a.AV(this.Gk.style.marginLeft),c=this.Gk.offsetTop-al.a.AV(this.Gk.style.marginTop);this.tDi(a,c);this.blb=new Sys.UI.Point(a,c)}this.Ogd=this.blb}Hjk(){this.unc=Fd.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}IWm(){this.unc.parentNode===this.Gk&&this.Gk.removeChild(this.unc)}uWl(a){if(!this.Yef)return!1;a.Sa.preventDefault();if(a.eventName===Jb.a.ah){const c=a.Sa.ctrlKey?
1:10;let h;switch(a.Sa.keyCode){case vb.a.O1:this.E5b(0,-1*c);break;case vb.a.F$:this.E5b(0,1*c);break;case vb.a.qjb:h=this.dOb?1:-1;this.E5b(h*c,0);break;case vb.a.rjb:h=this.dOb?-1:1;this.E5b(h*c,0);break;case vb.a.ZCa:this.h6h(this.Ogd.x,this.Ogd.y);this.fgd=!0;break;case vb.a.Nq:this.fgd=!0}}a.eventName===Jb.a.Hg&&this.fgd&&this.S0e();return!0}I7b(a){if(!this.Yef)return!1;a.Sa.preventDefault();this.S0e();return!0}E5b(a,c){this.h6h(this.blb.x+a,this.blb.y+c)}h6h(a,c){a=this.IKj(a,c);this.tDi(a.x,
a.y);this.blb=a}tDi(a,c){this.dOb?this.Gk.style.right=a+"px":this.Gk.style.left=a+"px";this.Gk.style.top=c+"px"}IKj(a,c){const h=this.dOb?al.a.AV(this.Gk.style.marginRight):al.a.AV(this.Gk.style.marginLeft),v=al.a.AV(this.Gk.style.marginTop);return new Sys.UI.Point(Math.min(Math.max(-h,a),this.vjc.offsetWidth-this.Gk.offsetWidth-h),Math.min(Math.max(-v,c),this.vjc.offsetHeight-this.Gk.offsetHeight-v))}}Object(w.a)(lk,"KeyMoveAdapter",null,[582]);var km=b(1492),Oq=b(1366);class jo{get name(){return"CUI.Behavior"}yb(a){l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&(a.register(581,"Common.UI.IDialogMenuRootUser").singleInstance().Pc(()=>new cm),a.register(582,"Common.IKeyMoveAdapter").singleInstance().Pc(()=>new lk(l.AFrameworkApplication.na.Iia(),qc.KeyInputManager.instance,Rh.a.instance)));a.register(Oq.a,"CommandUI.RootManager").as("Common.IRootManager").singleInstance().Pc(()=>Oq.a.instance)}init(){km.a.BSe=Vg.instance;const a=Oq.a.instance.$vi;for(let c=0;c<a.length;++c){const h=Object(ha.a)(583,
a[c]);h&&h.iIa()}ck.a.get_instance().iH(6)}dispose(){}static main(){M.a.instance.Lb(new jo,5)}}Object(w.a)(jo,"CuiBehaviorPackage",null,[1,2]);class et{constructor(a){const c=new Dn;c.ImageUpArrow=c.ImageDownArrow=c.ImageSideArrow=c.ImageCheckMark=c.ImageUncheckMark=c.ImageDownArrow8by8=c.ImageUpArrow8by8=a;c.ImageUpArrowClass=Fd.getImageClass("RibbonUpArrow_5x3x32");c.ImageDownArrowClass=Fd.getImageClass("SplitButtonArrow_5x3x32");c.ImageUpArrow8by8Class=Fd.getImageClass("RibbonUpArrow_8x8x32");
c.ImageDownArrow8by8Class=Fd.getImageClass("SplitButtonArrow_8x8x32");c.ImageSideArrowClass=Fd.getImageClass("SubmenuFlyoutArrow_13x13x32");c.ImageCheckMarkClass=Fd.getImageClass("CheckboxChecked_16x16x32");c.ImageUncheckMarkClass=Fd.getImageClass("CheckboxUnchecked_16x16x32");c.TextDirection=l.AFrameworkApplication.isRtl?"rtl":"ltr";this.Ou=Xm.a.dmk(c);this.Ou.refresh()}get w5(){return this.Ou}dispose(){this.Ou.dispose()}}Object(w.a)(et,"StandaloneRootController",null,[830,14]);var vp=b(1578),jf=
b(232);class Sp{constructor(a){this.Ypc=a}create(a,c){const h=new Sys.StringBuilder;this.Ayc(h,a,c);this.fUe(h,a);return h.toString()}dub(a,c){const h=[];this.LUe(h,a,c);this.gUe(h,a);return h}Ayc(a,c,h){switch(c.errorType){case 0:a.append(this.Ypc.build());break;case 1:case 2:a.append(this.wNe(c,h))}}LUe(a,c,h){switch(c.errorType){case 0:a.push(this.Ypc.dYg());break;case 1:case 2:a.push(this.lWj(c,h))}}fUe(a,c){a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>');a.append(jf.a("btnIgrnoreSpellingError",
(2===c.errorType?zb.a.QCa:zb.a.Eqa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null));a.append("</Controls></MenuSection>")}gUe(a,c){const h=Object.assign(new Hg.a,{ControlList:[]});c=2===c.errorType?"UnknownSpellingError":"IgnoreSpellingError";Array.add(h.ControlList,Object.assign(new qh.a,{ExternalId:c}));a.push(h)}wNe(a,c){a=this.zPk(a.suggestions,c);return 0<a.length?jf.j("msUnknownWord",jf.e(null,a),"Menu16"):jf.j("msUnknownWord",jf.e(null,[jf.a("btnNoSuggestions",zb.a.QCa.toString(),
Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}zPk(a,c){const h=[];if(a){const v=Math.min(c.length,a.length);for(let B=0;B<v;++B)a[B]&&h.push(jf.a("btnCorrectWord"+B,c[B].toString(),a[B]))}return h}lWj(a,c){const h=Object.assign(new Hg.a,{Id:"Suggestions",ControlList:[]});this.yPk(a.suggestions,c,h.ControlList);0>=h.ControlList.length&&(a=Object.assign(new qh.a,{ExternalId:"NoSuggestions"}),h.ControlList.push(a));return h}yPk(a,c,h){if(a){const v=Math.min(c.length,a.length);for(let B=0;B<
v;++B){if(!a[B])continue;const X=Object.assign(new qh.a,{ExternalId:"btnCorrectWord"+B,Command:c[B].toString(),LabelText:a[B]});h.push(X)}}}}Object(w.a)(Sp,"DefaultProofingContextMenuCreator",null,[]);var En=b(643);class bq{constructor(a,c){this.Heg=a;this.Ggg=c;this.Mga=[zb.a.oib,zb.a.pib,zb.a.qib,zb.a.PHb,zb.a.QHb]}create(a,c){return c?Object(Ub.a)(En.a,c)?this.Ggg.create(a,c,this.Mga):this.Heg.create(c,this.Mga):""}AWb(a,c){return c?Object(Ub.a)(En.a,c)?this.Ggg.dub(a,c,this.Mga):this.Heg.dub(c,
this.Mga):null}}Object(w.a)(bq,"ProofingContextMenuSectionFactory",null,[590]);class xo{build(){const a=[jf.a("btnDeleteRepeatedWord",zb.a.Gxa.toString(),Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return jf.j("msRepeatedWord",jf.e(null,a),"Menu16")}dYg(){const a=Object.assign(new Hg.a,{ControlList:[]}),c=Object.assign(new qh.a,{ExternalId:"DeleteRepeatedWord"});a.ControlList.push(c);return a}}Object(w.a)(xo,"ProofingRepeatedWordSectionBuilder",null,[589]);var ug=b(573);class yo{static get vf(){return gg.a.fy(yo.ll,
Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}yo.ll="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> </table> </div>";
Object(w.a)(yo,"AutoCorrectOptionsDialogHTML",null,[]);class Tp{static get vf(){return gg.a.fy(Tp.ll,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}Tp.ll="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='ReplaceTextAsYouTypeLabel' class='\"WACDialogInlineLabel\"' for='ReplaceTextAsYouType'>{1}</label> </td> </tr> <tr> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='CapitalizeFirstLetterOfSentencesLabel' class='\"WACDialogInlineLabel\"' for='CapitalizeFirstLetterOfSentences'>{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5> <tr> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='ReplaceOrdianalsWithSuperscriptLabel' class='\"WACDialogInlineLabel\"' for='ReplaceOrdianalsWithSuperscript'>{5}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='ReplaceHyphensWithDashLabel' class='\"WACDialogInlineLabel\"' for='ReplaceHyphensWithDash'>{6}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='ReplaceFractionsWithFractionCharacterLabel' class='\"WACDialogInlineLabel\"' for='ReplaceFractionsWithFractionCharacter'>{7}</label> </td> </tr> <tr> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='ReplaceQuoteWithSmartQuoteLabel' class='\"WACDialogInlineLabel\"' for='ReplaceQuoteWithSmartQuote'>{8}</label> </td> </tr> </table> </div>";
Object(w.a)(Tp,"AutoCorrectOptionsDialogHTML2",null,[]);class Sk extends gg.a{constructor(a,c){super();this.XS=a;this.Oaa=c;this.jf="AutoCorrectOptionsDialog"}tTf(){r.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.vf=this.Oaa?Tp.vf:yo.vf;const a={};a.ReplaceTextAsYouType=this.XS.xMa;a.CapitalizeFirstLetterOfSentences=this.XS.ood;a.ReplaceOrdianalsWithSuperscript=this.XS.DYd;a.ReplaceHyphensWithDash=this.XS.jTc;a.ReplaceFractionsWithFractionCharacter=this.XS.CYd;this.Oaa&&
(a.ReplaceQuoteWithSmartQuote=this.XS.oLf);this.Tg(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(m.a)(this,this.Pbn,"setAutoCorrectOptionsHandler"),a)}Pbn(a,c){kg.a.instance.J(9)&&(1!==a?r.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):c.ReplaceTextAsYouType!==this.XS.xMa||c.CapitalizeFirstLetterOfSentences!==this.XS.ood||c.ReplaceOrdianalsWithSuperscript!==this.XS.DYd||c.ReplaceHyphensWithDash!==this.XS.jTc||c.ReplaceFractionsWithFractionCharacter!==
this.XS.CYd||this.Oaa&&c.ReplaceQuoteWithSmartQuote!==this.XS.oLf?(a={},a.ReplaceTextAsYouType=c.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=c.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=c.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=c.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=c.ReplaceFractionsWithFractionCharacter,this.Oaa&&(a.ReplaceQuoteWithSmartQuote=c.ReplaceQuoteWithSmartQuote),this.XS.W6m(a),r.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:c.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:c.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:c.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:c.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:c.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.Oaa,["ReplaceQuoteWithSmartQuote"]:this.Oaa&&c.ReplaceQuoteWithSmartQuote}),
Eb.App.oa.updateCommandUI(!0)):r.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(w.a)(Sk,"AutoCorrectOptionsDialog",gg.a,[588]);class fj{static get vf(){return gg.a.fy(fj.ll,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}fj.ll="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(w.a)(fj,"AltTextDialogWithDescriptionHtml",null,[]);class Sl extends gg.a{constructor(){super();this.vf=fj.vf;this.jf="BaseAltTextDialogWithDescription"}iTe(a){const c={};c[Sl.CJe]=this.X4e(a);c[Sl.BJe]=this.PYk(a)||"";this.Tg(CommonUIStrings.l_AlternativeTextDialogTitle,Object(m.a)(this,this.PLj,"altTextDialogHandler"),c);a=document.getElementById(Sl.CJe);a.focus();a.select()}CU(a){return a.Ud.id===Sl.BJe?!1:super.CU(a)}}Sl.CJe="titleText";Sl.BJe="descriptionText";Object(w.a)(Sl,"BaseAltTextDialogWithDescription",
gg.a,[]);var Wf=b(33);class uq extends Sl{constructor(a,c,h,v,B){super();this.k7a=this.k3c=null;this.ak=c;this.Mi=h;this.Fb=v;this.Bb=B;this.iTe(a)}PYk(a){this.k3c=a.node;this.k7a=Wf.TableReader.VDh(a);return Wf.TableReader.saf(this.k7a)}X4e(a){this.k3c=a.node;this.k7a=Wf.TableReader.VDh(a);return Wf.TableReader.taf(this.k7a)}PLj(a,c){if(1===a){a=Wf.TableReader.taf(this.k7a);const h=Wf.TableReader.saf(this.k7a),v=c[Sl.CJe];c=c[Sl.BJe];this.hide();const B=this.Fb.Ob(15);try{B.Oa(this.k3c),this.ak.S0d(this.k7a,
v),this.ak.yDi(this.k7a,c)}finally{B&&B.dispose()}v===a&&c===h||this.Bb.Xq(16)}kg.a.instance.J(4)&&this.Mi.$n&&this.Mi.zp.aF(this.k3c)}}Object(w.a)(uq,"TableAltTextDialog",Sl,[]);class cl{constructor(a,c,h){this.ak=a;this.Fb=c;this.Bb=h}create(a){return new uq(a,this.ak,Eb.App.lc,this.Fb,this.Bb)}}Object(w.a)(cl,"TableAltTextDialogFactory",null,[]);const Mm=()=>{Eb.App.wRg=!0;return 32},ko=(a,c,h,v,B)=>{if(1===h)return 32;if(!({point:a,wF:c}=pn(B)).returnValue)return 16;Eb.App.oa.tac(a,c);return 32},
Hr=(a,c,h,v,B)=>{if(1===h)return 32;if(!({point:a,wF:c}=pn(B)).returnValue)return 16;Eb.App.oa.FY(a,c);return 32},pn=a=>{let c=null,h=0;if(!a)return{returnValue:!1,point:c,wF:h};a=a.split(",");if(3>a.length)return{returnValue:!1,point:c,wF:h};c=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));h=parseInt(a[2]);return{returnValue:!0,point:c,wF:h}};var ql=b(1650);class Gp extends Sys.EventArgs{constructor(a,c,h,v,B){super();this.controlId=a;this.commandId=v;this.time=B}}Object(w.a)(Gp,"CommandClickEventArgs",
Sys.EventArgs,[]);class rl{constructor(a,c){this.jna=a.K6e();this.Ygc=a;this.e2a=c}pIa(a,c,h,v=null,B=null){h&&(this.e2a.eF=h.CommandLocation,this.e2a.i4=h.InvocationMethod,this.e2a.W8a=h.CommandTabName);a=parseInt(a);let X=this.Ygc.nuh(a,c,h);X.gvf&&(X=this.Ygc.nuh(X.EJ,c,h));if(void 0!==X.NUa&&null!==X.NUa)return X.NUa;if(X.qyb)B=32;else{var ma=null;this.jna&&this.jna.rEf&&(ma=this.jna.rEf(X,B));X.ada||X.bKc?X.fya?B=16:(B=this.e2a.hb(X.EJ,X.g3b?2:1,X.Ac,B),2===B&&(B=32)):X.fya?B=this.e2a.Jka(null,
X.EJ,X.Ac,Pa=>{v&&v(Pa.response)},B):(B=this.e2a.hb(X.EJ,2,X.Ac,B),v&&v(B));this.jna&&this.jna.mEf&&this.jna.mEf(X,B,ma);if(c&&h&&-1!==h.InvocationMethod&&h.InvocationMethod){h=c.LegacyId;if(void 0===h||null===h)h="";ma=c.ParentMenuId;void 0!==ma&&null!==ma||!c.MenuId||(ma=c.MenuId);let Pa=c.SqmControlId;void 0!==Pa&&null!==Pa||!c.SourceControlId||(Pa=c.SourceControlId);(void 0!==Pa&&null!==Pa||void 0!==ma&&null!==ma)&&ql.a.NKm(new Gp(Pa,h,ma,Le.ActionManager.gwa(a),Date.now()))}}X.ada&&32===B&&this.jna&&
this.jna.xwa&&this.jna.xwa(X,c);X.bKc&&32===B&&this.jna&&this.jna.ZSa&&this.jna.ZSa(X,c);return 32===B||1===B}$za(a,c=null){if(l.AFrameworkApplication.Qj||ag.a.instance.Kv)return!1;null!=c&&null!=c.UILocation&&(this.e2a.eF=c.UILocation);const h=parseInt(a);if(!a||h===Le.ActionManager.c_e)return!0;a=this.Ygc.euh(h,c);a.gvf&&(a=this.Ygc.euh(a.EJ,c));if(void 0!==a.NUa&&null!==a.NUa)return a.NUa;h===Sa.a.iTb&&c&&(a.Ac=c);return 32===this.e2a.hb(a.EJ,1,a.Ac)}clearCache(){this.Ygc.clearCache()}}Object(w.a)(rl,
"GeneralCuiUser",null,[310,311]);var br=b(179),dl=b(71),gj=b(44),co=b(1212);class lm{constructor(a,c,h,v){this.XB=null;this.Xfg="DocumentProofingFailed";this.nDe=a;this.Lva=c;this.T1c=h;this.gG=v}get BB(){return this.XB||(this.XB=xa.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}Uel(a){a=this.gG.ccl(this.nDe);return{returnValue:this.gG.UVa(this.nDe),DHm:a}}ROn(a,c){const h=dl.a.Vy();if(h){var v=new br.ScriptSharpLegacyMap;v.add(Ed.a.iB,a);v.add(Yb.a.noProof,c);a=new gf.GraphTransaction(15);a.Oa(h);
this.BB.D5b(gj.StyleReader.wordStyleIdNormal,v,h)?co.a.iQi():(r.ULS.sendTraceTag(555775183,375,10,"Style could not be modified"),co.a.recordQosError(this.Xfg,[co.a.xpc],"Style could not be modified"));a.dispose()}else r.ULS.sendTraceTag(555775182,375,10,"PageContentNode not found"),co.a.recordQosError(this.Xfg,[co.a.xpc],"PageContentNode not found")}rdn(a,c){this.ROn(a,c)}Din(a,c){if(this.Lva){var h=new uh.DictionaryPropertySet;this.T1c.execute(v=>{v.MAc(a)});h.setValue(Ed.a.iB,a);h.setValue(Yb.a.noProof,
c);c=new gf.GraphTransaction(15);c.set(Eb.App.aj.Pk);this.Lva.q5(h);c.dispose()}}ke(){return Gc.SelectionEditor.ke(this.nDe)}}Object(w.a)(lm,"LanguageEditor",null,[585]);var dm=b(574),em=b(216),Xj=b(86);class Ym{constructor(a=!1,c=0){this.languages=Ym.WCh(vi.a.FXk());this.W$c=new em.a;this.hMa=[];this.pQb=new dm.a;this.hni=a;this.PBg=0>=c?7:c;this.OBg=this.Kxe=0;this.dlg=!1;a&&(this.rBl(),l.AFrameworkApplication.UK(()=>{this.Y6l()}))}rBl(){for(var a of this.languages)this.W$c.Z(a.LCID,a);a=[];try{const v=
cb.a.get("RecentlyUsedLcids");if(v&&""!==v){const B=decodeURIComponent(v).split(",").slice(0,this.PBg);for(const X of B){let ma;({value:ma}=this.W$c.Ab(parseInt(X),ma)).returnValue&&a.push(ma)}}}catch(v){r.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",v.message),Array.clear(a)}if(a.length)for(var c of a){var h=c.LCID;this.pQb.contains(h)||(this.hMa.push(c),this.pQb.add(h))}else c=l.AFrameworkApplication.lcid,({value:h}=this.W$c.Ab(c,
h)).returnValue&&(this.hMa.push(h),this.pQb.add(c));this.$wi()}$wi(){const a=Xj.toArray(Xj.select(Xj.asEnumerable(this.hMa),c=>c.LCID)).join(",");cb.a.dNa("RecentlyUsedLcids",a,180)}P4k(a,c,h){let v=-1,B=null;c=Ym.WCh(this.hMa);this.hni&&0<c.length&&(B=Xj.toArray(Xj.Si(Xj.asEnumerable(c),(Pa,mb)=>{a===Pa.LCID&&-1===v&&(v=mb);return{["key"]:mb,["text"]:Pa.displayName,["value"]:Pa.LCID.toString()}})));let X=0;B&&(X=B.length);h=X;const ma=Xj.toArray(Xj.Si(Xj.asEnumerable(this.languages),(Pa,mb)=>{a===
Pa.LCID&&-1===v&&(v=X+mb);return{["key"]:X+mb,["text"]:Pa.displayName,["value"]:Pa.LCID.toString()}}));c=v;return 0<X?{returnValue:B.concat.apply(B,ma),selectedIndex:c,kKi:h}:{returnValue:ma,selectedIndex:c,kKi:h}}Cfn(a,c){if(this.hni&&({value:h}=this.W$c.Ab(a,h)).returnValue){c=a!==c;if(this.pQb.contains(a))a=Array.indexOf(this.hMa,h),0<=a&&(Array.removeAt(this.hMa,a),this.hMa.push(h)),c&&this.Kxe++;else{this.pQb.add(a);this.hMa.push(h);if(this.hMa.length>this.PBg){var h=this.hMa.shift();this.pQb.remove(h.LCID)}c&&
this.OBg++}this.$wi()}}Y6l(){const a=this.Kxe+this.OBg;!this.dlg&&0<a&&(r.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",100*this.Kxe/a),this.dlg=!0)}static WCh(a){a=Array.clone(a);a.sort((c,h)=>c.displayName.localeCompare(h.displayName));return a}}Object(w.a)(Ym,"LanguageListHelper",null,[584]);var mk=b(182);class Oo extends mk.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(w.a)(Oo,"NumberButtonProps",mk.a,[]);var Nm=b(219);class Ek{static get HY(){return Ek.Z6a||
(Ek.Z6a=xa.a.instance.ra("Box4.ISpacingCommands"))}static get uf(){return Nm.ContextSetEditor.instance}static get WR(){return Ek.Gx||(Ek.Gx=xa.a.instance.ra("Box4.ILineSpacingHelper"))}static get oGi(){return!!Ek.HY}static eb(){const a=l.AFrameworkApplication.pa;a.ka(zb.a.O7b,ic.a.view,Ek.O7b);a.Qb(zb.a.O7b,1124);a.ka(zb.a.O7b,ic.a.paragraph,Ek.WOn)}static O7b(a,c,h,v,B){if(1===h||!Ek.oGi)return Ek.oGi?32:8;if(!Ek.bUh){var X=[];X.push(Object.assign(new Oo,{ExternalId:"LineSpacing1_00",Number:1,Type:0}));
X.push(Object.assign(new Oo,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0}));X.push(Object.assign(new Oo,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0}));X.push(Object.assign(new Oo,{ExternalId:"LineSpacing2_00",Number:2,Type:0}));X.push(Object.assign(new Oo,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0}));X.push(Object.assign(new Oo,{ExternalId:"LineSpacing3_00",Number:3,Type:0}));B.MenuItems=jf.g(X);Ek.bUh=!0}r.ULS.sendTraceTag(588394560,340,50,"Line Spacing Menu is opened");c=c.view.Ma;
X=null;c&&c.Ca.Fa&&(X=c.Ca.Fa);c=Ek.uf.Toh(X.sa);l.AFrameworkApplication.pa.Le(c,a,h,!0,v,B);return 32}static WOn(a,c){let h=a=!0;c=Ek.WR.Fya(c.node);var v=c.beforeSpacing;let B=!1;1===v.unit&&(B=!0);if(B||0<v.value)a=!1;c=c.afterSpacing;v=!1;1===c.unit&&(v=!0);if(v||0<c.value)h=!1;appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ek.WFj,!a));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ek.tXm,a));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ek.VFj,
!h));appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(Ek.sXm,h));return 32}}Ek.WFj="AddSpaceBeforeParagraph";Ek.VFj="AddSpaceAfterParagraph";Ek.tXm="RemoveSpaceBeforeParagraph";Ek.sXm="RemoveSpaceAfterParagraph";Ek.bUh=!1;Ek.Z6a=null;Ek.Gx=null;Object(w.a)(Ek,"LineSpacingRibbonMenu",null,[]);var Hi=b(189),Lj=b(1221),eo=b(1199);const wp=(a,c,h)=>{if(1===h)return 32;a=Eb.App.oa.notificationBar.jxa("Automation test",!1);a.image=3;Eb.App.oa.notificationBar.Jz(a);return 32},qr=(a,c,h,
v,B)=>{let X;if(!({ZWi:X}=Up(B)).returnValue)return 16;Hi.UISurfaces.dK().then(ma=>{let Pa=null;var mb=Object.assign(new Lj.a,{label:"OK",onExecute:()=>{Pa&&ma.removeNotification(Pa)}});mb=Object.assign(new eo.a,{target:"#"+If.AppFrame.$Mf,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:mb,useTeachingStyles:X});mb=ma.callout(mb);Pa=ma.addNotification(mb);return null},ma=>{r.ULS.sendTraceTag(593352341,383,15,"Failed to GetNotificationsAPIAsync: {0}",ma);return null});
return 32},Up=a=>{let c=!1;if(!a)return{returnValue:!1,ZWi:c};c=Boolean.parse(a);return{returnValue:!0,ZWi:c}};var zo=b(1795);let Po,Ao,cq,Qo;class Ro{constructor(){this.xva=new Ua.a;this.nqg=!1}P7a(a){const c=this.xva.indexOf(a);let h=!0;if(-1!==c){h=!1;if(!c)return h;this.xva.removeAt(c)}this.xva.insert(0,a);r.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",a);11===this.xva.count&&(r.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",
this.xva.J(10)),this.xva.removeAt(10));this.sQn();return h}sQn(){r.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");const a=[];for(let h=0;h<this.xva.count;h++){var c="#"+this.xva.J(h).substring(4,6)+this.xva.J(h).substring(2,4)+this.xva.J(h).substring(0,2);c=Object.assign(new zo.a,{Color:this.xva.J(h),Alt:c,DisplayColor:c});a.push(appChrome.api.colorPickerCell(c.Color,c.DisplayColor,c.Alt))}for(const h of Ro.Srj)appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(h,
a));this.nqg||this.sPn();this.nqg=!0}sPn(){for(const a of Object.keys(Ro.Xug)){r.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",a);const c=Ro.Xug[a],h=[];for(const v of c)h.push(appChrome.api.menuSection([v],v in Ro.xse?Ro.xse[v].toString():null));appChrome.api.dispatch(appChrome.actions.updateMenu(a,h,Ro.xse[a].toString()))}}}Ro.Xug={["FontColor"]:(Qo=new Ua.a,Qo.add("AutomaticFontColor"),Qo.add("ThemeFontColorPickerMCU"),Qo.add("ThemeFontColorPicker"),Qo.add("StandardFontColorPicker"),
Qo.add("RecentFontColorPicker"),Qo.add("MoreFontColors"),Qo),["CellShading"]:(cq=new Ua.a,cq.add("ThemeShadingColorPickerMCU"),cq.add("ThemeShadingColorPicker"),cq.add("StandardShadingColorPicker"),cq.add("RecentCellShadingColorPicker"),cq.add("ClearShadingColor"),cq.add("MoreCellShadingColors"),cq),["PictureBorders"]:(Ao=new Ua.a,Ao.add("ThemePictureBorderColorPickerMCU"),Ao.add("ThemePictureBorderColorPicker"),Ao.add("StandardPictureBorderColorPicker"),Ao.add("RecentPictureBorderColorPicker"),Ao.add("MorePictureBorderColors"),
Ao.add("NoPictureBorder"),Ao.add("PictureBorderWeightOptions"),Ao.add("PictureBorderStyleOptions"),Ao)};Ro.xse={["StandardFontColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["StandardShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuStandardColors,["RecentFontColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentHighlighterColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentCellShadingColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,["RecentPictureBorderColorPicker"]:Box4Intl.Box4Strings.L_MenuRecentColors,
["FontColor"]:Box4Intl.Box4Strings.L_FontColor,["Highlighter"]:Box4Intl.Box4Strings.L_HighlightColor,["CellShading"]:Box4Intl.Box4Strings.L_CellShadingColor,["PictureBorders"]:"Picture Border"};Ro.Srj=(Po=new Ua.a,Po.add("RecentFontColorPicker"),Po.add("RecentCellShadingColorPicker"),Po.add("RecentPictureBorderColorPicker"),Po);Object(w.a)(Ro,"RecentColorsSectionHandler",null,[]);var ds=b(1665),qn=b(1384);class Ir{constructor(a){this.$pj=a}Cda(){}Ada(a){this.$pj.aim(a)}}Object(w.a)(Ir,"DataBuddyActionListener",
null,[43]);class wm{constructor(){this.type="DataBuddyTaskPaneProps";this.onClearClick=this.clearButtonLabel=this.actions=null}}Object(w.a)(wm,"DataBuddyTaskPaneProps",null,[]);class Om{constructor(a){this.isVisible=!1;this.WV=new Ua.a;this.aae=null;this.EN=a;this.Ny=new ds.a;this.fb=nc.FocusManager.instance()}initialize(){this.aae=new Ir(this);this.EN.OHa();this.Ny.QI(this.bFj());this.Ny.QI(this.pCj())}toggle(){this.isVisible?this.hide():this.show()}aim(a){if(2===a.behavior){const c=Le.ActionManager.gwa(a.actionId)||
a.actionId.toString();c.startsWith("Query")||(this.WV.add(c+": "+Om.jQk(a.response)),this.it())}}hide(){Hi.UISurfaces.Ms().then(a=>{a.hideTaskPane(Om.Iw,2);return null})}show(){Hi.UISurfaces.Ms().then(a=>{a.showTaskPane(Om.Iw,this.Tz());return null});this.isVisible&&Hi.UISurfaces.Ms().then(a=>{a.setSelectedTaskPane(Om.Iw);return null})}bFj(){return a=>{a.actions=this.WV.toArray();a.clearButtonLabel=CommonUIStrings.l_WAC_DataBuddyClearButtonLabel}}pCj(){return a=>{a.onClearClick=()=>{this.WV.clear();
this.it()}}}eb(){l.AFrameworkApplication.pa.P9(this.aae)}h1a(){l.AFrameworkApplication.pa.qZc(this.aae)}Tz(){const a=new wm;this.Ny.cGb(a);return Object.assign(new qn.a,{title:"Data Buddy",hideHeader:!1,width:Om.width,location:2,contentProps:a,onOpen:()=>{this.o5();this.eb();this.isVisible=!0;l.AFrameworkApplication.na.updateCommandUI()},onClose:()=>{this.Z9();this.h1a();this.isVisible=!1;this.it();l.AFrameworkApplication.na.updateCommandUI()},isModernPane:!0})}it(){Hi.UISurfaces.Ms().then(a=>{a.updateTaskPane(Om.Iw,
this.Tz());return null})}o5(){this.fb.Kf(Om.Iw)}Z9(){this.YXa()&&this.fb.Kf(this.fb.$Q)}YXa(){return!!this.fb.nf&&this.fb.nf.name===Om.Iw}static jQk(a){switch(a){case 0:return"Unattempted";case 1:return"In Progress";case 2:return"Not Handled";case 4:return"Handle Externally";case 8:return"Failed";case 16:return"Error";case 32:return"Succeeded";case 64:return"Delayed";default:return a.toString()}}}Om.Iw="DataBuddyTaskPane";Om.width=300;Object(w.a)(Om,"Box4DataBuddyTaskPane",null,[578]);class cr{constructor(a){this.xg=
a}ZNa(a){this.xg&&this.xg.xE(a)}yZc(){this.xg&&this.xg.NZc(void 0)}}Object(w.a)(cr,"RibbonButtonUpdater",null,[576]);var Fk=b(371);class Jn{constructor(){this.BBe=this.W=null}get name(){return"Box4.UI"}yb(a){this.W=a;a.ha("Box4.IGeneralCuiUser",()=>new rl(a.resolve("Box4.UI.CuiActionBridge"),l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.UI.TableAltTextDialogFactory",()=>new cl(a.resolve("Box4.ITableEditor"),new Fk.a,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();
a.ha("Box4.UI.ILanguageEditor",()=>new lm($c.a.instance.If,a.ra("Box4.ITextFormattingCommands"),a.za("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.ha("CommandUI.StandaloneRootController",()=>new et(l.AFrameworkApplication.qp)).as("Common.IStandaloneRootController").singleInstance();a.ha("Box4.UI.IAutoCorrectOptionsDialog",()=>new Sk(a.resolve("Box4.IAutoCorrectOptionsInfo"),l.AFrameworkApplication.K.$("ReplaceQuoteWithSmartQuoteIsEnabled")));a.ha("Box4.UI.LanguageListHelper",()=>
new Ym(l.AFrameworkApplication.K.$("RecentlyUsedLanguagesListIsEnabled"))).as("Box4.UI.ILanguageListHelper").singleInstance();a.register(xo,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").singleInstance();a.ha("Box4.UI.DefaultProofingContextMenuCreator",()=>new Sp(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"))).singleInstance();a.ha("Box4.UI.ProofingContextMenuSectionFactory",()=>new bq(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),
a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator"))).as("Box4.UI.IProofingContextMenuSectionFactory").singleInstance();a.ha("Box4.RibbonButtonUpdater",()=>new cr(this.W.resolve("Box4.IAppFrame"))).as("Common.IRibbonButtonUpdater").singleInstance();a.ha("Box4.UI.RecentColorsSectionHandler",()=>new Ro).singleInstance();a.ha("Common.IDataBuddyTaskPane",()=>new Om(vp.a.instance)).singleInstance()}init(){var a=Eb.App.oa;const c=a.Ya;Hb.szl(Object(m.a)(c,c.ECb,"onAuthenticationLost"),Object(m.a)(c,
c.FCb,"onAuthenticationRestored"),a.F1j);ug.a.eb();a=l.AFrameworkApplication.pa;a.ka(zb.a.EEm,ic.a.application,Mm);a.Aa(zb.a.yqn,ic.a.application,ko,96);a.Aa(zb.a.drn,ic.a.application,Hr,96);a=l.AFrameworkApplication.pa;a.Aa(zb.a.Jsn,ic.a.application,wp,96);a.Aa(zb.a.rqn,ic.a.application,qr,96);Ek.eb();this.yBl();this.BBe=this.W.resolve("Common.IStandaloneRootController")}yBl(){this.W.za("Box4.IGeneralCuiUser").execute(a=>{this.W.za("Common.IStandaloneRootController").execute(c=>{c.w5.GC=a})})}dispose(){this.BBe.dispose();
this.BBe=null}static main(){M.a.instance.Lb(new Jn,6)}}Object(w.a)(Jn,"Box4UIPackage",null,[1,2]);var rn=window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]},Bo=b(1666);class On{get name(){return"Box4.Insights"}init(){}dispose(){}yb(a){a.ha("Box4.Insights.Box4InsightsSelection",
()=>new Bo.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance()}}Object(w.a)(On,"Box4InsightsPackage",null,[1,2]);const sn=a=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+a)};var pj=b(407),lo=b(325);class Mj{constructor(a,c){this.lh=this.U$c=0;this.wkg=c;this.$wj=a}seb(){return this.U$c-this.lh>=this.$wj}reset(){this.lh=this.U$c=this.wkg()}update(){this.U$c=this.wkg()}}Object(w.a)(Mj,
"TimeBasedTaskYieldStrategy",null,[503]);class Pm{seb(){return!1}reset(){}update(){}}Object(w.a)(Pm,"NullTaskYieldStrategy",null,[503]);var sl=b(1225);class vq{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(w.a)(vq,"CatchUpConfiguration",
null,[]);class Hp{constructor(){this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}}Object(w.a)(Hp,"SharedControllerFactoryParameters",null,[]);var S=b(161),ba=b(20);class eb{constructor(a,c,h,v){this.Uv=a;this.yj=c;this.ga=h;this.fb=v;this.z$c=this.A$c=null;this.S8c=!1;this.ga.ka(ba.a.IOi,ic.a.view,Object(m.a)(this,
this.Otm,"onToggleActivityAnnouncements"));this.fb.fd(Fc.AFrame.uo).bindAction(qc.KeyInputManager.mb(vb.a.uec,6),ba.a.IOi)}Otm(a,c){(this.S8c=!this.S8c)&&c.lm&&c.lm.contextId===ic.a.Ub&&this.m1g(c.lm.node,c.lm.Xl);return 32}a1(a,c){this.S8c&&this.yj&&c&&c.rk&&c.rk.Fa&&c.rk.Fa.sa&&c.rk.Fa.sa.node&&c.rk.Fa.sa.contextId===ic.a.Ub&&this.m1g(c.rk.Fa.sa.node,c.rk.Fa.sa.Xl)}m1g(a,c){a&&(this.a8h(a)?(this.A$c&&this.A$c.id.equals(a.id)||(this.yj.sendNotification(WordEditorIntl.WordEditorStrings.L_CatchUpActivityParagraphAnnouncementTemplate,
!1),this.A$c=a),this.f$l(a,c)):this.z$c=this.A$c=null)}a8h(a){return 0<this.Uv.pxb(a).count}f$l(a,c){if(a){var h=-1,v=null,B=null;for(let X=0;X<a.la.length;X++){const ma=a.la.J(X);if(!(null==B||ma.changeStart&&ma.changeStart.equals(v))&&c>=h&&c<=ma.cp&&!v.equals(this.z$c))if(this.Uv.$zb(v)){(a=this.Uv.vCc(v,a.id))&&0<a.actors.length&&a.displayTimestamp&&(a=String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityChangeAnnouncementTemplate,a.actors[0].displayName,a.displayTimestamp.toLocaleString()),
this.yj.sendNotification(a,!1),this.z$c=v);break}else this.z$c=null;ma.changeStart&&!ma.changeStart.equals(v)&&(h=ma.cp,v=ma.changeStart);B=ma.changeStart}}}}Object(w.a)(eb,"ActivityAnnouncementManager",null,[]);var Mb=b(1200),hc=b(682),Hc=b(694),Zc=b(484);class Dd{constructor(){this.activityId=null;this.type=0;this.priorityId=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(w.a)(Dd,"Activity",null,[]);var xe=b(401);class af extends Dd{constructor(){super();
this.Ot=this.objectId=null}static yz(a){const c=new Zc.a(new xe.a);if(a.Ot)for(let h of a.Ot)c.add(h);return c}}Object(w.a)(af,"RevisionSetActivity",Dd,[]);class eg{constructor(a,c,h){this.wee=null;this.pU=a;this.Eb=c;this.v8h=h}mIn(a){if(a)switch(a.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:this.Eb.hb(Sa.a.XYa,2,null);break;default:this.fim()}else r.ULS.sendTraceTag(593049027,3012,10,"Null activity: TryNotifyContentDoesNotExist. Unable to notify.")}fim(){this.v8h.then(a=>{var c=
Object.assign(new eo.a,{target:'[data-unique-id~="CatchUpWithChanges"]',showCloseIcon:!0,content:CommonUIStrings.l_ChangeDoesNotExistNotification,calloutProps:Object.assign(new Mb.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1})});c=a.callout(c);const h=Object.assign(new hc.a,{expirationOptions:Object.assign(new Hc.a,{displayTimeoutSeconds:10,onExpire:Object(m.a)(this,this.dismiss,"dismiss")})});this.wee=a.addNotification(c,h)})}dismiss(){this.v8h.then(a=>{a.removeNotification(this.wee);return this.wee=
null})}doesContentExist(a){if(!a)return r.ULS.sendTraceTag(593049026,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(a.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!a.navigationId)return r.ULS.sendTraceTag(593049025,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const c={};c.NavigationId=atob(a.navigationId);if(8===this.Eb.hb(Sa.a.fud,2,c))return!1;break;case 1:return this.fxk(a)}return!0}fxk(a){a=af.yz(a);return a?0<this.pU.EDc(a).count:
(r.ULS.sendTraceTag(593049024,3012,10,"Null changeIds: DoRevisionsExist. Default to false."),!1)}}Object(w.a)(eg,"ActivityContentManager",null,[622]);var Xg=b(1279),hh=b(1792),qg=b(1013),vk=b(642);class nk{constructor(){this.Ot=this.TU=null}compare(a){if(!a)return!1;if(this.TU&&a.TU){if(this.TU.count!==a.TU.count)return!1;for(let c of this.TU)if(!a.TU.contains(c))return!1}else if(!a.TU&&this.TU||!this.TU&&a.TU)return!1;if(a.Ot&&this.Ot){if(a.Ot.count!==this.Ot.count)return!1;for(let c of this.Ot)if(!a.Ot.contains(c))return!1}else if(!this.Ot&&
a.Ot||!a.Ot&&this.Ot)return!1;return!0}}Object(w.a)(nk,"ActivityHighlightableObject",null,[]);class vh extends Xg.a{constructor(a,c){super();this.Pwe=this.bQb=null;this.i1c=a;this.Uv=c;this.r6=[new hh.a(qg.a.e0g,qg.a.d0g),new hh.a(qg.a.b0g,qg.a.a0g),new hh.a(qg.a.tod,qg.a.uod),new hh.a(qg.a.vod,qg.a.MOe)]}get Ayb(){return 1}get Jbb(){return this.r6}get gja(){return!0}Xab(a,c){if(a=Object(ha.a)(nk,a))if(a.TU)for(let h of a.TU)c.add(h);else r.ULS.sendTraceTag(594900750,377,15,"Activity Highlight: no highlightable paragraphs")}CLa(a,
c){if(this.fx.RHa){var h=this.i1c.F_a,v=this.i1c.Lbb,B=!!h&&h.compare(v),X=this.fx.RHa,ma=X.action,Pa=this.vnn(X,a),mb=!1;2!==ma&&ma&&(mb=(mb=this.fx.oLd)?1===mb.type:!!h||!!v);c=c.UZa("*");for(let Tb=0,rc=c.length;Tb<rc;Tb++){const Tc=c[Tb],vd=this.ZZk(Tc,qg.a.xod);if(vd&&vd.ur)if(this.mWm(Tc),1===X.type)switch(ma){case 0:Pa&&h.Ot.contains(vd.ur)&&this.omd(Tc,2,vd,!1);break;case 2:Pa&&v.Ot.contains(vd.ur)&&this.omd(Tc,B?2:1,vd,!1);break;default:this.M0b(a,Tc,vd,!1)}else mb?this.M0b(a,Tc,vd,!1):this.M0b(a,
Tc,vd,!0)}this.bQb&&(this.bQb.classList.add(qg.a.vod),this.Pwe=this.bQb=null)}}ZZk(a,c){return Di.a.Ra(a,c)}vnn(a,c){if(a&&a.XD){const h=a.XD,v=a.action;if(1===a.type&&(2===v||!v)&&h.TU)return h.TU.contains(c);if(h.Ot)for(let B of h.Ot){a=this.Uv.TZb(B);for(let X of a)if(X===c)return!0}}return!1}M0b(a,c,h,v){const B=this.i1c.F_a,X=this.i1c.Lbb;B&&B.Ot.contains(h.ur)&&(!B.TU||B.TU.contains(a))?this.omd(c,2,h,v):X&&X.Ot.contains(h.ur)&&(!X.TU||X.TU.contains(a))&&this.omd(c,1,h,v)}omd(a,c,h,v){a&&vk.a(a)&&
(a.classList.add(this.I2k(2===c,v)),this.Sen(a,h,v))}Sen(a,c,h){this.bQb?-1!==c.cpEnd&&this.Pwe.cpEnd!==c.cpBegin&&(this.bQb.classList.add(h?qg.a.MOe:qg.a.vod),a.classList.add(h?qg.a.uod:qg.a.tod)):a.classList.add(h?qg.a.uod:qg.a.tod);a.classList.add(qg.a.c0g);this.bQb=a;this.Pwe=c}mWm(a){this.fx.a_a(a);this.jVm(a)}jVm(a){a.classList.remove(qg.a.tod,qg.a.uod,qg.a.c0g,qg.a.vod,qg.a.MOe)}I2k(a,c){return c?a?qg.a.a0g:qg.a.d0g:a?qg.a.b0g:qg.a.e0g}}Object(w.a)(vh,"ActivityHighlightActor",Xg.a,[]);var wh=
b(1793),xm=b(175);class tl{constructor(a,c,h,v,B,X,ma,Pa){this.E2=a;this.HL=c;this.Uv=h;this.Tpj=B;this.ya=X;this.yj=Pa;this.fb=ma;this.HL.JJd=!1}Yci(a,c,h){a?this.bvl(a,c,h):this.HL.F_a&&(a=Object.assign(new wh.a,{action:1,type:1,XD:null,LM:this.HL.F_a}),this.HL.F_a=null,this.E2.LF(a))}bvl(a,c,h){if(c){a=new Zc.a(new xe.a);for(B of c){var v=this.Uv.TCc(B);for(let X=0;X<v.length;X++){const ma=v[X];this.Uv.$zb(ma)&&a.add(ma)}}var B=this.Uv.EDc(a);B=this.b8g(B,a);v=this.HL.F_a;this.HL.F_a=B;B=Object.assign(new wh.a,
{action:0,type:1,XD:this.HL.F_a,LM:v});this.E2.LF(B);h&&!this.w8m(c.J(0),a)||this.e$m(c.J(0),a)}else r.ULS.sendTraceTag(589345503,377,10,"HighlightActivity: no target nodes for activityId {0}",a.activityId)}w8m(a,c){if(!a)return r.ULS.sendTraceTag(587239560,377,10,"ScrollToHighlightParagraph: No target node from activity"),!1;if(12!==a.type)return r.ULS.sendTraceTag(587239561,377,10,"ScrollToHighlightParagraph: target node is not a paragraph"),!1;c=this.jXk(a,c);return this.Tpj.U9b(a.id,c)?this.setSelection(a,
c)?!0:!1:(r.ULS.sendTraceTag(587239563,377,10,"ScrollToHighlightParagraph: call to ScrollToParagraphMatchingNodeId failed"),!1)}e$m(a,c){a=this.J2k(a,c);c=new Sys.StringBuilder;for(let h=0;h<a.count;h++)c.append(String.format(WordEditorIntl.WordEditorStrings.L_CatchUpActivityHighlightReadoutTemplate,h+1,a.count,a.J(h)));this.yj.sendNotification(c.toString(),!0)}setSelection(a,c){if(!a||!sd.ParagraphReader.tb(a))return r.ULS.sendTraceTag(579396806,377,10,"SetSelection: Invalid node provided"),!1;if(0>
c)return r.ULS.sendTraceTag(579396807,377,10,"SetSelection: Invalid cp provided"),!1;this.HL.JJd=!0;a=Oe.a.Sb(a,c);a=new xm.Selection([a],!0);this.ya.setSelection(a);nc.FocusManager.rH()&&this.fb.Kf(Fc.AFrame.Mp);return!0}jXk(a,c){if(c&&0<c.count)for(let h=0;h<a.la.length;h++){const v=a.la.J(h);if(v.changeStart&&c.contains(v.changeStart))return v.cp}r.ULS.sendTraceTag(36824330,377,15,"Could not find the matching change in the paragraph, return default cp 0");return 0}J2k(a,c){const h=new Ua.a;if(c&&
0<c.count&&a){let v=-1;for(let B=0;B<a.la.length;B++){const X=a.la.J(B);if(-1!==v&&X.isChangeEnd)if(X.changeStart&&c.contains(X.changeStart))continue;else h.add(a.characterData.substring(v,X.cp)),v=-1;X.changeStart&&c.contains(X.changeStart)&&(v=X.cp)}}return h}kci(a,c){if(a)switch(a.type){case 1:if(c){a=new Zc.a(new xe.a);for(var h of c){c=this.Uv.TCc(h);for(let v=0;v<c.length;v++){const B=c[v];this.Uv.$zb(B)&&a.add(B)}}}else a=af.yz(a);c=this.Uv.EDc(a);this.HL.Lbb=this.b8g(c,a);h=Object.assign(new wh.a,
{action:2,type:1,XD:this.HL.Lbb,LM:null});this.E2.LF(h)}else this.HL.Lbb&&(h=Object.assign(new wh.a,{action:3,type:1,XD:null,LM:this.HL.Lbb}),this.HL.Lbb=null,this.E2.LF(h))}b8g(a,c){var h=null;if(a){h=new va.a;for(let v of a)12===v.type&&h.add(v)}a=new nk;a.TU=h;a.Ot=c?c:this.X7k(h);return a}X7k(a){const c=new Zc.a(new xe.a);if(!a)return c;for(let h of a)for(let v of this.Uv.pxb(h))c.add(v);return c}}Object(w.a)(tl,"ActivityHighlightManager",null,[]);var So=b(1277),tn=b(119),Qm=b(55);class Vp{constructor(){this.activityIds=
this.container=this.target=null;this.isSticky=!1;this.dirHint=0}}Object(w.a)(Vp,"CreateIndicatorTooltipParameters",null,[]);class dr{constructor(){this.clearSticky=!1}}Object(w.a)(dr,"DismissIndicatorTooltipParameters",null,[]);class er{constructor(){this.target=null;this.isSticky=!1}}Object(w.a)(er,"UpdateIndicatorTooltipParameters",null,[]);class Pq extends Sys.EventArgs{constructor(a,c,h){super();this.dwb=a;this.jMh=c;this.son=h}}Object(w.a)(Pq,"ActivityIndicatorEventArg",Sys.EventArgs,[]);class es{constructor(){this.kMh=
new Map;this.lMh=new Set}IFn(a,c){this.lMh.add(a);this.kMh.set(a,c)}NMl(a){return this.PRh(a.htmlElement)}Fll(){let a=new Set;for(let c of this.lMh){const h=this.kMh.get(c);h&&this.MMl(h)&&a.add(c)}return a}MMl(a){return a.parentElement&&this.PRh(a.parentElement)}PRh(a){const c=ye.a.z8();a=Ve.a.IIa(a);return 0<=a&&a<=c}}Object(w.a)(es,"IndicatorVisibilityTracker",null,[]);const dq=()=>l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsCatchUpP1TelemetryEnabled",!1),cp=
()=>l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsBlueDotsNewSurveyTriggerEnabled",!1);class Co extends So.a{constructor(a,c,h,v,B,X,ma,Pa,mb){super();this.ma=new Rd.a;this.Ymb=this.x6=null;this.Uv=a;this.mae=c;this.$mg=h;this.Vhj=v;this.Gj=B;this.w2=null;this.Ta=ma;this.Lec=Pa;this.mme=new es;this.uv=mb;this.ee&&(this.ee.aha(Object(m.a)(this,this.pTd,"pageViewOnScrolledEvent")),this.ee.dQg(Object(m.a)(this,this.Tfi,"pageViewOnResizeEvent")));X&&X.execute(Tb=>{Tb.Z4(Object(m.a)(this,
this.Gq,"onZoomChanged"))})}get ee(){return this.Gj&&this.Gj.Rh?this.Gj:(r.ULS.sendTraceTag(579396804,377,15,"Could not obtain valid PageView."),null)}dUa(a,c,h){if(this.x6){var v=Qm.a(this.x6);if(a===v)return this.x6}const B=a.Fe.ownerDocument;v=Tm.a.createElement(B,ri.a.div);v.className=qg.a.l2j;v.style.left=c+"px";v.style.top=h+"px";c=Tm.a.createElement(B,ri.a.div);c.className=this.uv?qg.a.i0g:qg.a.f0g;v.style.cursor="pointer";c.style.cursor="pointer";v.appendChild(c);ah.a.instance.Ea(Jb.a.yK,
v,Object(m.a)(this,this.onMouseEnter,"onMouseEnter"));ah.a.instance.Ea(Jb.a.bH,v,Object(m.a)(this,this.nka,"onMouseLeave"));oi.a.instance.Ea(Jb.a.click,v,Object(m.a)(this,this.eZa,"onClickEvent"));ah.a.instance.Ea(Jb.a.contextMenu,v,Object(m.a)(this,this.hY,"onContextMenu"));r.ULS.sendTraceTag(41457152,377,50,"An activity indicator has been created!");this.C4l(a);c=this.L8k(a);this.mme.IFn(c,v);this.mme.NMl(a)&&this.Oai(c);return v}vGb(a){return this.ymn(a)}aub(a){const c=this.A_j(a),h=[];h.push(this.dUa(a.P4,
c,a.B_c[0].y-a.H8[0].y));return h}A_j(a){let c=qg.a.Dyl+(0>a.CLc?-a.CLc:0);const h=Be.a.Vh(a.leftMargin,0)/2;1>=h&&r.ULS.sendTraceTag(578082778,377,50,"Margin is too small to show indicators");c=c>h?h:c;c=c<qg.a.g0g?qg.a.g0g:c;return l.AFrameworkApplication.isRtl?a.H8[0].width/this.zoom+c:-c}EFi(a){if(a&&393230===a.Gb||393251===a.Gb){const c=this.Uv.pxb(a);if(c)for(let h of c)if(a===this.Uv.LZb(h))return!0}return!1}ymn(a){for(let c of sd.ParagraphReader.ex(a.Ia,!0,!1))if(this.EFi(c))return!0;return!1}eb(a){a.ka(ba.a.kHi,
ic.a.Ub,Object(m.a)(this,this.Wql,"handleShowCatchUpActivitiesForParagraph"));a.ka(ba.a.pTf,ic.a.Ub,Object(m.a)(this,this.Yql,"handleShowIndicatorFlyoutForActivity"))}Yql(a,c,h,v,B){if(!B)return r.ULS.sendTraceTag(592540299,377,50,"Null actionData: HandleShowIndicatorFlyoutForActivity"),8;c=af.yz(B.Activity);a=null;if(B.NodeId&&(B=tn.b(B.NodeId),!N.a.Go(B,N.a.nil)&&(B=this.Uv.yvh(B),this.FZf(B,!1))))return 32;for(let X of c)if(this.Uv.$zb(X)){B=this.Uv.LZb(X);if(this.FZf(B,!0))return 32;B&&!a&&(a=
B)}if(this.FZf(a,!1))return 32;r.ULS.sendTraceTag(589866521,377,15,"Unable to find indicator from ShowIndicatorFlyoutForActivity");return 8}Wql(a,c,h,v,B){r.ULS.sendTraceTag(595126290,377,50,"User requested to Show Catch-Up Activities for a Paragraph from the Context Menu.");B&&c&&c.Kk&&(a=c.node)&&((a=this.Lec.eAd(a))?this.qkd(a,!1,!1):r.ULS.sendTraceTag(595126289,377,50,"Unable to obtain indicator container for node after context menu action."));return 32}FZf(a,c){if(!a)return!1;const h=this.Lec.eAd(a);
if(h)return this.qkd(h,!1,!0),!0;if(!c){let v;this.GRc((v=new Ua.a,v.add(a),v),!1,!0,!0);c=new Se.a(3,1,0,Object(m.a)(this,this.Lsn,"showTooltipForIndicatorTask"),181);c.customData=a;this.Ta.ub(c);return!0}return!1}Lsn(a){(a=this.Lec.eAd(a.customData))&&this.qkd(a,!1,!1)}Hik(a,c=!1){c&&this.tpd(!0);if(a&&a.parentNode){var h=this.Caf(a);h=this.uQk(h);this.w2||(this.w2=document.createElement("Div"),document.getElementById(l.AFrameworkApplication.VTb).appendChild(this.w2));this.mae.createActivityIndicatorTooltip(Object.assign(new Vp,
{target:a,container:this.w2,activityIds:h,isSticky:c,dirHint:9}));c&&(this.x6=a)}else r.ULS.sendTraceTag(36794392,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}bBk(a){a&&a.classList.add(qg.a.wod)}wbi(a,c){return this.qkd(a,c,!1)}qkd(a,c,h){if(c&&a===this.x6)return!0;const v=this.Caf(a);c||this.VTf();this.Hik(a,!c);this.bBk(a.getElementsByClassName(this.uv?qg.a.i0g:qg.a.f0g)[0]);this.GRc(v,c,!0,h);this.Y0h(v,c?1:2);
cp()&&this.Vhj.sNd();c&&(this.Ymb=a);return!0}onMouseEnter(a){return this.wbi(a.$p,!0)}tpd(a=!1){this.mae.dismissActivityIndicatorTooltips(Object.assign(new dr,{clearSticky:a}));this.Ymb=null;a&&(this.x6=null)}KIi(a){a&&a.classList.remove(qg.a.wod)}VTf(){this.x6&&this.KIi(this.x6.getElementsByClassName(qg.a.wod)[0])}nka(a){a=a.$p;if(a===this.x6)return!0;this.fqi(a);return!0}fqi(a){const c=this.Caf(a);this.GRc(c,!0,!1,!1);this.KIi(a.getElementsByClassName(qg.a.wod)[0]);this.tpd(!1);this.Ymb=null}Caf(a){let c=
null;(a=(a=Qm.a(a))?a.Ia:null)&&11===a.type&&(c=sd.ParagraphReader.ex(a,!0,!1));return c}eZa(a){this.Ymb=null;return this.wbi(a.$p,!1)}hY(){this.VTf();this.tpd(!0);return!1}MPe(){const a=!!this.Ymb;if(this.x6||a)this.VTf(),this.tpd(!0),this.GRc(null,!1,!1,!1),this.GRc(null,!0,!1,!1)}Gq(){this.Tfi()}UGj(a){this.ma.addHandler(Co.LMg,a)}VGj(a){this.ma.addHandler(Co.MMg,a)}GRc(a,c,h,v){let B=null;if(h&&a){for(let X of a)if(h=this.Uv.TCc(X))for(let ma=0;ma<h.length;ma++){const Pa=h[ma];if(this.Uv.$zb(Pa)){B=
this.Uv.vCc(Pa,X.id);break}}if(!B){r.ULS.sendTraceTag(36717344,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in this GraphNode.");return}}c?this.ma.raiseEvent(Co.LMg,new Pq(B,a,!1)):this.ma.raiseEvent(Co.MMg,new Pq(B,a,v))}uQk(a){const c=[];if(a)for(let v of a){var h=this.Uv.pxb(v);for(let B of h)(h=this.Uv.vCc(B,v.id))&&c.push(h.activityId)}!c.length&&a&&a.count&&r.ULS.sendTraceTag(36844643,377,15,"Activity Indicator unable to obtain associated Activity for changeIds in these Nodes.");
return c}KUi(a){a&&a.parentNode?(this.mae.updateActivityIndicatorTooltip(Object.assign(new er,{target:a,isSticky:!0})),this.x6=a):r.ULS.sendTraceTag(40935511,377,50,"Activity Indicator is gone (probably due to co-auth change on paragraph), so don't re-render the sticky flyout for it.")}pTd(){this.x6&&this.KUi(this.x6);this.Ymb&&this.fqi(this.Ymb);this.Rom()}Tfi(){this.x6?this.KUi(this.x6):this.MPe()}Rom(){let a=this.mme.Fll();for(let c of a)this.Oai(c)}Oai(a){this.$mg.X0h(a,3)}L8k(a){return(a=sd.ParagraphReader.ex(a.Ia,
!0,!1))&&a.count?a.J(0).id:null}C4l(a){a=sd.ParagraphReader.ex(a.Ia,!0,!1);this.Y0h(a,0)}Y0h(a,c){a&&a.count&&this.B4l(a.J(0).id,c)}B4l(a,c){this.$mg.X0h(a,c)}}Co.LMg="ActivityIndicatorPreviewed";Co.MMg="ActivityIndicatorSelected";Object(w.a)(Co,"ActivityIndicatorActor",So.a,[]);var ie=b(39);class mo{constructor(a,c,h){this.Uv=a;this.lid=c;this.Gj=h}get ee(){return this.Gj&&this.Gj.Rh?this.Gj:(r.ULS.sendTraceTag(555356833,377,15,"Could not obtain valid PageView."),null)}eAd(a){r.ULS.sendTraceTag(555356834,
377,50,"Attempting to find the indicator container related to changes in a given node.");const c=this.xwh(a);if(!c){r.ULS.sendTraceTag(555356835,377,50,"Looking in different nodes to find the indicator container related to grouped changes on the desired node.");a=this.Uv.pxb(a);for(let h of a)if(a=this.Uv.LZb(h),a=this.xwh(a))return a}return c}xwh(a){if(!a||12!==a.type)return r.ULS.sendTraceTag(539779146,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid node provided."),null;if(!a)return r.ULS.sendTraceTag(539779147,
377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid paragraph node."),null;var c=this.lid.ICd(a);if(!c||11!==c.type)return r.ULS.sendTraceTag(539779148,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find top level outline element."),null;c=c.Sd(this.ee.gb);if(!c||!c.htmlElement)return r.ULS.sendTraceTag(539779149,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid view element."),null;var h=ye.a.OIa(c.htmlElement,mo.KMg);if(h)return h;c=c.$1e();if(!c)return r.ULS.sendTraceTag(539779150,
377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid list container wrapper."),null;c=ye.a.OUk(c,mo.KMg);if(!c)return r.ULS.sendTraceTag(539779151,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: invalid indicators array."),null;for(h=0;h<c.length;h++){const v=Qm.a(c[h]),B=ie.OutlineElementNavigator.Al(a);if(v&&v.Ia&&B&&v.Ia.id.equals(B.id))return c[h]}r.ULS.sendTraceTag(539779152,377,100,"ActivityIndicatorHelper.GetIndicatorForNode: could not find indicator.");return null}T3k(a){a=
this.Uv.yvh(a);if(!a||12!==a.type)return r.ULS.sendTraceTag(555356864,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get paragraph node from node Id."),N.a.nil;a=this.eAd(a);if(!a)return r.ULS.sendTraceTag(541888733,377,15,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get indicator from paragraph node."),N.a.nil;a=Qm.a(a);return a?a.Ia.id:(r.ULS.sendTraceTag(555356865,377,10,"ActivityIndicatorHelper.GetIndicatorIdForNodeId: could not get view element from paragraph node."),
N.a.nil)}}mo.KMg="CatchUpActivityIndicatorContainer";Object(w.a)(mo,"ActivityIndicatorHelper",null,[]);var fr=b(1437);class eq{constructor(a,c,h,v,B,X,ma){this.p1b=a;this.pageContentNode=c;this.WGe=h;this.Eb=v;this.pU=B;this.Rd=X;this.sIc=ma;this.p1b.hgb(this.WGe)}initialize(){this.Eb.ka(ba.a.S3h,Kc.a.frame,Object(m.a)(this,this.bam,"markCatchUpChangeRead"))}get MIh(){return!!this.pU.YO&&0<this.pU.YO.count||!!this.pU.N5b&&0<this.pU.N5b.count}iBf(a){const c=a&&a.wywaActivities?a.wywaActivities.length:
0;if(!this.sIc||0<c||!a){const h=new Map;h.set("activityCount",c.toString());this.Rd.Pm("CatchUpActivitiesReady",0,{extendedProperties:h})}a?this.sIc&&0==a.wywaActivities.length||this.Tjm(a.wywaActivities):(r.ULS.shipAssertTag(36538305,377,!1),this.sIc||Object(fr.a)(),this.Rd.pi("CatchUpActivitiesReady","CatchUpActivitiesPayloadIsInvalid",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}))}Tjm(a){a?(r.ULS.sendTraceTag(36509256,377,50,"Catch-Up Activities are Ready and Indicators should be created."),
this.Vkn(a),a=this.pU.uGj(a),this.Wkn(a)):r.ULS.sendTraceTag(50959501,377,10,"activities passed in is null!")}bam(a,c,h){if(1===h)return this.MIh?32:8;2===h&&(this.MIh&&(this.WGe.MPe(),this.$5j()),r.ULS.sendTraceTag(38138719,377,50,z.c({["MarkAsRead invoked"]:!0})));Eb.App.oa.updateCommandUI();return 8}Vkn(a){if(a){var c=new Ua.a;for(let h of a)switch(h.type){case 2:case 3:case 4:case 10:a=4===h.type?h.tgi:h.contentId,c.add(a),this.pU.N5b.add(a)}0<c.count&&(r.ULS.sendTraceTag(51196435,377,50,"{0}",
c.count),this.Eb.hb(Sa.a.r7h,2,c.toArray()))}}Wkn(a){const c=new Zc.a(new xe.a),h=new gf.GraphTransaction(3);try{h.Oa(this.pageContentNode);for(let v of a){const B=this.pU.LZb(v);B&&this.WGe.EFi(B)&&(c.add(B.id),this.p1b.E1b(B,!0))}}finally{h&&h.dispose()}0<a.count&&Eb.App.oa.updateCommandUI();a={};a.highlightedNodeCount=c.count;r.ULS.sendTraceTag(36509257,377,50,"{0}",z.c(a))}$5j(){r.ULS.sendTraceTag(36509258,377,50,"Catch-Up Activity Indicators requested to be cleared.");0<this.pU.N5b.count&&(this.Eb.hb(Sa.a.heh,
2,this.pU.N5b.toArray()),this.pU.N5b.clear());const a=this.T7j(this.pU.YO);this.eVm(a)}eVm(a){r.ULS.sendTraceTag(36509259,377,50,"Catch-Up Activities some Indicators requested to be removed.");const c=new gf.GraphTransaction(3);try{c.Oa(this.pageContentNode);for(let h of a){this.pU.YO.remove(h);for(let v of this.pU.TZb(h))this.p1b.E1b(v,!0)}this.pU.T1g()}finally{c&&c.dispose()}}T7j(a){const c=new Zc.a(new xe.a);for(let h of a)c.add(h);return c}}Object(w.a)(eq,"ActivityIndicatorManager",null,[]);class wq{constructor(){this.Lbb=
this.F_a=null;this.isFirstDocumentOpen=this.JJd=!1}}Object(w.a)(wq,"ActivityStateManager",null,[621]);var Tl=b(89);class xq{constructor(a,c){this.y2c={};this.HOa=a;this.nu=c;this.N5b=new Ua.a}get YO(){return this.HOa.YO}initialize(){if(this.nu){r.ULS.sendTraceTag(41302109,377,15,"Build ChangeIdCache with graph tree traversal");this.HOa.initialize(null);var a=new gf.GraphTransaction(0);try{a.Oa(this.nu);const c=Tl.a.zn(this.nu);for(;c.moveNext();)(sd.ParagraphReader.eg(c.iterator)||dd.ImageReader.GX(c.currentNode))&&
this.HOa.Xcc(c.currentNode)}finally{a&&a.dispose()}}else r.ULS.sendTraceTag(36824331,377,15,"PageContentNode is null")}pZb(a){return this.HOa.pZb(a)}pxb(a){const c=new Zc.a(new xe.a);if(!a)return c;a=this.HOa.pZb(a);for(let h=0;h<a.length;h++){const v=a[h];this.$zb(v)&&c.add(v)}return c}TZb(a){return this.HOa.TZb(a)}EDc(a){const c=new Ua.a;if(a)for(let h of a)c.addRange(this.TZb(h));return c}uGj(a){const c=new Zc.a(new xe.a);if(a)for(let h of a)if(1===h.type&&(a=h))for(let v of a.Ot){c.add(v);this.YO.add(v);
const B=v.toString();this.y2c[B]||(this.y2c[B]=new Ua.a);this.y2c[B].add(a)}this.T1g();return c}$zb(a){return this.YO&&a?this.YO.contains(a):!1}vCc(a,c){if(a&&(a=this.y2c[a.toString()])&&0<a.count){for(let h of a)if(h.objectId.equals(c))return h;return a.J(0)}return null}LZb(a){return this.HOa.LZb(a)}T1g(){this.HOa.J5j()}TCc(a){return this.HOa.TCc(a)}yvh(a){if(!this.nu)return null;const c=this.nu.Mb;return c?c.Ra(a):null}}Object(w.a)(xq,"ChangeIdCache",null,[]);var Ul=b(159),no=b(103);class Do extends Ul.a{constructor(){super();
this.activityClassifications=this.inferences=this.correspondingRequest=null;this.H_=Object.assign(new no.a,{T_:Do.getTypeName(),B_:Do.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesResponse"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(w.a)(Do,"ChangeSummariesResponse",Ul.a,[]);var dp=b(431);class Qq extends dp.a{constructor(){super();this.activityChanges=this.documentContent=this.requestId=null;this.H_=Object.assign(new no.a,{T_:Qq.getTypeName(),
B_:Qq.getBaseTypes()})}static getTypeName(){return"AugLoop_ChangeSummaries_ChangeSummariesRequest"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(w.a)(Qq,"ChangeSummariesRequest",dp.a,[]);var fo=b(428),Eo=b(452),Un=b(234),mp=b(453);class Os{constructor(){this.N8b=this.FTc=null}}Object(w.a)(Os,"ActionPair",null,[]);class ft{constructor(a,c,h,v){this.b3=a;this.q2a=c;this.$e=h;this.Ta=v;this.ome=null;this.axe=new od.a;this.LCg=new od.a}Ayn(a){const c=Object.assign(new fo.a,{parentPath:["Signal",
Qq.getTypeName()],items:[Object.assign(new Eo.a,{body:a})]});return this.initialize().then(()=>{const h=new Promise((v,B)=>{this.axe.Z(a.requestId,Object.assign(new Os,{FTc:v,N8b:B}))});this.LCg.Z(a.requestId,new Date);r.ULS.sendTraceTag(561111456,377,50,"ChangeSummariesAugloopProvider.SubmitRequest: submitting request to aug-loop, timeout duration = {0}",ft.Xti);this.q2a.getAugLoopRuntimeManager().submitOperation(Object.assign(new mp.a,{operation:c}));this.Uhn(a.requestId);return h})}initialize(){this.ome||
(this.ome=this.b3.Yn().then(()=>{this.$e.Ea(this,Do.getTypeName())}));return this.ome}hK(a,c){if(a&&Un.a.getTypeNameFor(a.content)===Do.getTypeName())if(a=a.content){var h=this.Dpi(a.correspondingRequest);h?c!==fo.a.getTypeName()?h.N8b("Invalid operation type"):(r.ULS.sendTraceTag(579745162,377,50,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: resolving augloop request, time since request = {0}",this.g9e(a.correspondingRequest)),h.FTc(a)):r.ULS.sendTraceTag(589083081,377,15,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: cannot find action pair to resolve promise, time since request = {0}",
this.g9e(a.correspondingRequest))}else r.ULS.sendTraceTag(589083080,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: null response from ChangeSummariesRequest");else r.ULS.sendTraceTag(589600964,377,10,"ChangeSummariesAugloopProvider.HandleAnnotationEvent: invalid annotation event")}Uhn(a){const c=new Se.a(3,1,ft.Xti,Object(m.a)(this,this.VAk,"endRequestWithTimeout"),176);c.dkd=0;c.customData=a;this.Ta.ub(c)}VAk(a){a=a.customData;const c=this.Dpi(a);c&&(r.ULS.sendTraceTag(579745163,377,
15,"ChangeSummariesAugloopProvider.EndRequestWithTimeout: augloop request timed out, time since request = {0}",this.g9e(a)),c.N8b("Request timeout"))}Dpi(a){if(!a)return null;let c;if(!({value:c}=this.axe.Ab(a,c)).returnValue)return null;this.axe.remove(a);return c}g9e(a){if(!a)return-1;let c;return({value:c}=this.LCg.Ab(a,c)).returnValue?(new Date).getTime()-c.getTime():-1}static get Xti(){return l.AFrameworkApplication.K.vb("ChangeSummariesRequestTimeoutMs",5E3)}}Object(w.a)(ft,"ChangeSummariesAugloopProvider",
null,[337]);class Hl{constructor(){this.activityGroups=null}}Object(w.a)(Hl,"FeaturedActivityGroupPayload",null,[]);class To{constructor(a,c,h,v,B){this.Asj=a;this.v8i=c;this.i$i=h;this.ycj=v;this.$jb=B}getFeaturedActivityGroups(a){return a&&a.wywaActivities&&a.wywaActivities.length?this.ycj.spb.then(()=>this.T_k(a)):To.d_e}Iol(a,c,h){if(!c)return r.ULS.sendTraceTag(574103583,377,15,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: response is null"),null;sn("TranslateFeaturedActivityGroups");
h=this.i$i.mGn(a,c,h.wywaActivities);r.ULS.sendTraceTag(542942800,377,50,"ChangeSummariesDataProvider.HandleChangeSummariesResponse: sent changes to aug-loop = {0}, received inferences from aug-loop = {1}, provided items to the flyout = {2}",0<a.activityChanges.length,0<c.inferences.length,0<h.length);this.$jb.set(c.correspondingRequest,h);return Object.assign(new Hl,{activityGroups:h})}T_k(a){sn("BuildFeaturedActivityGroupRequest");const c=this.Asj.bWj();if(!c||!c.documentContent||!c.activityChanges)return r.ULS.sendTraceTag(588379905,
377,15,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummariesRequest is null"),To.d_e;if(!c.documentContent.length||!c.activityChanges.length)return To.d_e;r.ULS.sendTraceTag(578954499,377,50,"ChangeSummariesDataProvider.GetFeaturedActivityGroupsInternal: ChangeSummaries Request Id: "+c.requestId);sn("SubmitFeaturedActivityGroupRequest");return this.v8i.Ayn(c).then(h=>this.Iol(c,h,a))}}To.d_e=Promise.resolve(Object.assign(new Hl,{activityGroups:[]}));Object(w.a)(To,"ChangeSummariesDataProvider",
null,[619]);class np{constructor(a,c){this.Uv=a;this.ixj=c}bWj(){const a=new Ua.a,c=new Ua.a,h=new Zc.a(new xe.a);var v=this.Uv.YO;if(!v||!v.count)return np.g_e;v=this.Uv.EDc(v);if(!v||!v.count)return r.ULS.sendTraceTag(592056450,377,15,"ChangeSummariesRequestBuilder.BuildChangeSummariesRequest: no GraphNodes exist for the new changeIds"),np.g_e;for(let B of v)h.contains(B.id)||(h.add(B.id),this.vGm(B,a,c));return c.count&&a.count?Object.assign(new Qq,{activityChanges:c.toArray(),documentContent:a.toArray(),
requestId:tn.a(N.a.create())}):np.g_e}vGm(a,c,h){if(sd.ParagraphReader.tb(a)){var v=sd.ParagraphReader.plainText(a);if(v&&v.length){c.add(v);v=this.Uv.pxb(a);v=this.Rnl(v);for(let B of v){v=new Ua.a;const X=this.getTextRanges(a,B);for(let ma of X)v.add({changeEnd:ma.Oud,changeSpanId:ma.$an,changeStart:ma.startIndex,contentIndex:c.count-1,locationId:tn.a(a.id)});(v=this.Cfk(B,v.toArray()))&&h.add(v)}}else r.ULS.sendTraceTag(591975071,377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: no content available")}else r.ULS.sendTraceTag(592056452,
377,15,"ChangeSummariesRequestBuilder.ProcessParagraph: node did not cast to AParagraphNode")}Rnl(a){const c=new od.a;for(let h of a)(a=this.oAh(h))?(c.Ja(a)||c.Z(a,new Zc.a(new xe.a)),c.J(a).add(h)):r.ULS.sendTraceTag(579712270,377,15,"ChangeSummariesRequestBuilder.GroupChangeIdsByUser: unable to get person id from change id");return c.values}Cfk(a,c){const h=[];let v=null;for(let B of a)if(a=this.Uv.vCc(B,N.a.nil)){if(!v){const X=this.oAh(B);if(!X||!X.length){r.ULS.sendTraceTag(579712272,377,15,
"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get person id from change id");continue}v=X}h.push(a)}else r.ULS.sendTraceTag(579712271,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: unable to get activity from change id");return h.length?v?c.length?{activityId:h[0].activityId,changes:c,personId:v,timestamp:h[0].displayTimestamp.toISOString()}:(r.ULS.sendTraceTag(579712273,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no changes provided for ActivityChange"),
null):(r.ULS.sendTraceTag(579605389,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: could not get personId for ActivityChange"),null):(r.ULS.sendTraceTag(579605388,377,15,"ChangeSummariesRequestBuilder.CreateActivityChange: no activities exist for ActivityChange"),null)}oAh(a){a=this.Uv.vCc(a,N.a.nil);if(!a)return r.ULS.sendTraceTag(579712274,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: unable to get activity from change id"),null;a=a.actors;if(!a||!a.length||
!a[0])return r.ULS.sendTraceTag(592056451,377,15,"ChangeSummariesRequestBuilder.GetPersonIdResponsibleForChangeId: no people are associated with this Activity in ChangeSummariesRequest"),null;let c=a[0].id;c&&c.length||(c=a[0].email);return c}getTextRanges(a,c){const h=new Ua.a;if(!c||!c.count||!a)return h;let v=-1,B=new Zc.a(new xe.a);for(let X=0;X<a.la.length;X++){const ma=a.la.J(X);if(-1!==v&&ma.isChangeEnd){if(ma.changeStart&&c.contains(ma.changeStart)){B.add(ma.changeStart);continue}h.add({startIndex:v,
Oud:ma.cp,$an:this.ixj.Czi(B)});v=-1;B=new Zc.a(new xe.a)}ma.changeStart&&c.contains(ma.changeStart)&&(v=ma.cp,B.add(ma.changeStart))}return h}}np.g_e=Object.assign(new Qq,{activityChanges:[],documentContent:[],requestId:tn.a(N.a.nil)});Object(w.a)(np,"ChangeSummariesRequestBuilder",null,[]);class Tk{constructor(){this.changes=this.content=null}}Object(w.a)(Tk,"ContentChange",null,[]);class ep{constructor(){this.ranking=0;this.reasons=this.contentChanges=this.locationId=this.activities=null}}Object(w.a)(ep,
"FeaturedActivityGroup",null,[]);class ul{constructor(){this.end=this.start=0}}Object(w.a)(ul,"TextRange",null,[]);class xp{constructor(a){this.Lec=a}mGn(a,c,h){if(!c)return r.ULS.sendTraceTag(588379906,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is null"),xp.Gud;if(!c.inferences)return r.ULS.sendTraceTag(588379907,377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.Inferences is null"),xp.Gud;if(!c.activityClassifications)return r.ULS.sendTraceTag(588379908,
377,10,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response.ActivityClassifications is null"),xp.Gud;if(!c.inferences.length||!c.activityClassifications.length)return r.ULS.sendTraceTag(561111455,377,50,"ChangeSummariesResponseTranslator.TranslateResponseToActivityGroups: response is empty"),xp.Gud;const v=[],B=new ia.a(new xe.a);for(let X of c.inferences){const ma=this.lGn(X,a,c,h);if(!ma)continue;const Pa=this.Lec.T3k(tn.b(ma.locationId));Pa.equals(N.a.nil)?v.push(ma):
B.Ja(Pa)?B.J(Pa).ranking>ma.ranking&&B.Z(Pa,ma):B.add(Pa,ma)}a=[...Array.from(B.values),...v];a.sort((X,ma)=>X.ranking-ma.ranking);return a.slice(0,xp.jbm)}lGn(a,c,h,v){if(!a||bj.a.ve(a.activitiesInGroup))return r.ULS.sendTraceTag(588379909,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: inference is empty"),null;const B=new Ua.a,X=new od.a;let ma=null;for(let mb of a.activitiesInGroup){if(!mb){r.ULS.sendTraceTag(588379910,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity is null");
continue}if(0>mb.activityIndex||mb.activityIndex>=h.activityClassifications.length){r.ULS.sendTraceTag(588379911,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: groupActivity.ActivityIndex is invalid");continue}const Tb=h.activityClassifications[mb.activityIndex];if(!Tb||bj.a.ve(Tb.contents))r.ULS.sendTraceTag(588379912,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activityClassification is empty");else{var Pa=this.HHk(v,Tb.activityId);if(Pa){B.add(Pa);
for(let rc of mb.changes){if(!rc){r.ULS.sendTraceTag(576251591,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef is null");continue}Pa=rc.value;if(0>Pa||Pa>=Tb.contents.length){r.ULS.sendTraceTag(576251592,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContentRef index is invalid");continue}Pa=Tb.contents[Pa];if(!Pa){r.ULS.sendTraceTag(576251593,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: changeContent is null");
continue}const Tc=c.documentContent[Pa.contentIndex],vd=Object.assign(new ul,{start:Pa.changeStart,end:Pa.changeEnd});if(X.Ja(Tc))X.J(Tc).add(vd);else{let ee;X.Z(Tc,(ee=new Ua.a,ee.add(vd),ee))}ma||(ma=Pa.locationId)}}else r.ULS.sendTraceTag(588379913,377,10,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: activity is null")}}if(!B.count)return r.ULS.sendTraceTag(588379914,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no activities for ActivityGroup"),null;c=this.Zjl(X);
return c.count?Object.assign(new ep,{ranking:a.ranking.value,reasons:[1],activities:B.toArray(),contentChanges:c.toArray(),locationId:ma}):(r.ULS.sendTraceTag(588379915,377,15,"ChangeSummariesResponseTranslator.TranslateInferenceToGroup: no content change for ActivityGroup"),null)}HHk(a,c){for(let h of a)if(h&&h.activityId&&h.activityId===c)return h;return null}Zjl(a){const c=new Ua.a;for(let v of a){a=v.key;const B=v.value;B.Sc((X,ma)=>X.start-ma.start);var h=B.J(0).start;if(h>xp.t4h){h-=xp.t4h;
a=a.substring(h,a.length);for(let X of B)X.start-=h,X.end-=h}c.add(Object.assign(new Tk,{content:a,changes:B.toArray()}))}return c}}xp.Gud=[];xp.t4h=10;xp.jbm=4;Object(w.a)(xp,"ChangeSummariesResponseTranslator",null,[]);class mm{constructor(){this.$jb=new od.a;this.mye=new od.a}set(a,c){if(c.length&&a){this.$jb.Z(a,c);for(let h of c)if(h.activities)for(let v of h.activities)v&&v.activityId?this.mye.Z(v.activityId,a):r.ULS.sendTraceTag(573920657,377,15,"FeaturedActivityGroupCache.Set: null activity in group");
else r.ULS.sendTraceTag(573920656,377,15,"FeaturedActivityGroupCache.Set: null activities for group")}}get(a){return a&&this.$jb.Ja(a)?this.$jb.J(a):null}j9l(a){return a&&this.mye.Ja(a)?this.mye.J(a):null}}Object(w.a)(mm,"FeaturedActivityGroupCache",null,[]);class Ia{constructor(a){this.$jb=a;this.rbg=new Map}eb(a){a.ka(ba.a.XMd,Kc.a.frame,Object(m.a)(this,this.XMd,"logActivityNavigationDetails"))}XMd(a,c,h,v,B){if(!B)return r.ULS.sendTraceTag(574103576,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null actionData"),
8;a=B.Activity;if(!a)return r.ULS.sendTraceTag(574103577,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: null activity"),8;c=this.$jb.j9l(a.activityId);if(!c)return r.ULS.sendTraceTag(574103578,377,15,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: No matching request Id found"),8;h=af.yz(a);r.ULS.sendTraceTag(574103579,377,50,"FeaturedActivityGroupTelemetryActor.LogActivityNavigationDetails: [RequestId={0};ActivityId={1};ChangeIds={2}]",c,a.activityId,
this.Czi(h));return 32}Czi(a){let c=0;const h=Array(a.count);for(let v of a)a=this.x9k(v),h[c]=tn.a(a),c++;return h.join(",")}x9k(a){let c=this.rbg.get(a);if(c&&c!=N.a.nil)return c;c=N.a.create();this.rbg.set(a,c);return c}}Object(w.a)(Ia,"FeaturedActivityGroupTelemetryActor",null,[]);class Xa extends Sys.EventArgs{constructor(a){super();this.node=a}}Object(w.a)(Xa,"OnParagraphVisitedArgs",Sys.EventArgs,[]);class qb{constructor(a,c,h){this.xQ=null;this.Ta=a;this.DSa=c;this.nu=h;this.ma=new Rd.a;this.spb=
new Promise(v=>{this.xQ=v})}zIj(a){this.ma.addHandler("OPV",a)}dTj(){this.cPg(null)}cPg(a){const c=new Se.a(3,1,0,Object(m.a)(this,this.rGn,"traverseDocument"),182);c.customData=a;this.Ta.ub(c)}rGn(a){this.DSa.reset();a=this.Qjl(a.customData);let c=null;for(;a.moveNext();){const h=a.currentNode;if(h&&(sd.ParagraphReader.tb(h)&&this.ma.raiseEvent("OPV",new Xa(h)),this.DSa.update(),this.DSa.seb())){c=h;break}}c?this.cPg(c):this.xQ(!0)}Qjl(a){if(!a)return Tl.a.zn(this.nu);a=Kd.GraphIterator.va(a);a.La(7);
return Tl.a.eq(a,this.nu)}}Object(w.a)(qb,"DocumentTraverser",null,[]);class $b{constructor(a,c){this.Dn=a;this.fb=c}initialize(){const a=this.fb.fd(Fc.AFrame.jVb);a.rK=!0;a.parent=Fc.AFrame.uo;a.iba(Object(m.a)(this,this.aMk,"focusOnFirstFlyoutItem"));this.Dn.KQ(Fc.AFrame.jVb)}enableF6Focus(){this.Dn.YB(Fc.AFrame.jVb)}disableF6Focus(){this.Dn.Bv(Fc.AFrame.jVb)}aMk(){const a=document.getElementById("flyoutItem0");a&&(r.ULS.sendTraceTag(588129371,3012,50,"Focused on the catch-up flyout via ctrl+F6"),
a.focus())}}Object(w.a)($b,"FlyoutFocus",null,[612]);var tc=b(787);class Vc{constructor(a,c,h){this.Cag=this.Ukg=this.flc=this.w9c=!1;this.jje=this.i2c=null;this.ga=a;this.$ig=c;this.fb=h}get V2e(){return this.jje?this.jje:(r.ULS.sendTraceTag(578401728,3012,15,"Attempted to get _flyoutShowTimestamp before the value was set."),new Date)}set V2e(a){this.jje=a}initialize(){this.eb()}registerButtonClickedEvent(a){this.i2c&&r.ULS.sendTraceTag(588129366,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");
this.i2c=a.buttonClickedCallback}onFlyoutInitialized(){var a;this.w9c&&r.ULS.sendTraceTag(588129367,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const c=(new Date).getTime()-this.V2e.getTime();r.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",c);this.w9c=!0;(null===(a=l.AFrameworkApplication.K)||void 0===a?0:a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1))||tc.a.YYa("ribbon","catchUp");
re.c(Sa.a.n2j,!0,void 0,void 0,void 0,c)}onFlyoutVisibilityChanged(a){this.flc!==a.flyoutIsVisible&&(this.flc=a.flyoutIsVisible,Eb.App.oa&&Eb.App.oa.updateCommandUI(!0),this.flc&&this.Cag&&this.fb.Kf(Fc.AFrame.jVb),this.flc||this.$ig&&this.$ig.H2l())}logFlightTriggers(a){a.hasFlyoutData&&l.AFrameworkApplication.Mg("WoCha187;WoCha187cf")}eb(){this.ga.ka(Sa.a.MOi,Kc.a.frame,Object(m.a)(this,this.Qtm,"onToggleCatchUpFlyout"));this.ga.Aa(Sa.a.Ali,Kc.a.frame,Object(m.a)(this,this.lrm,"onQueryToggleCatchUpFlyout"),
96)}lrm(a,c,h,v,B){B[Uf.a.Visible]=!0;B[Uf.a.On]=this.flc&&this.w9c;return 32}Qtm(a,c,h){if(1===h)return this.w9c?(this.Ukg||(this.Ukg=!0,r.ULS.sendTraceTag(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.i2c)return r.ULS.sendTraceTag(588129369,3012,10,"OnToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."),8;this.Cag=!0;this.i2c();return 32}}Object(w.a)(Vc,"FlyoutRibbonButton",null,[613]);var gd=b(144);class Ad{constructor(a,c){this.YO=
null;this.uHd=this.gVh=!1;this.pU=a;this.Rd=c;this.ncb=new gd.a;this.bHd=new Map;this.ncb.Z(1,new Zc.a(new xe.a));this.ncb.Z(0,new Zc.a(new xe.a));this.ncb.Z(2,new Zc.a(new xe.a));this.ncb.Z(3,new Zc.a(new xe.a));this.bHd.set(3,"CatchUpIndicatorVisible");this.bHd.set(1,"CatchUpIndicatorPreviewed");this.bHd.set(2,"CatchUpIndicatorSelected");this.xYd=0}X0h(a,c){if(this.ncb.J(c).add(a)){this.D4l(c);switch(c){case 0:r.ULS.sendTraceTag(592545740,377,50,"LogIndicatorTelemetry: indicator rendered");break;
case 1:r.ULS.sendTraceTag(592545739,377,50,"LogIndicatorTelemetry: indicator hovered");break;case 2:r.ULS.sendTraceTag(592545738,377,50,"LogIndicatorTelemetry: indicator clicked");break;case 3:r.ULS.sendTraceTag(528593420,377,50,"LogIndicatorTelemetry: indicator visible")}this.j1g()}}Mqm(a){this.cCk();a=this.pU.pxb(a);for(let c of a)if(this.YO.remove(c)){this.xYd++;break}}cCk(){if(!this.YO){this.YO=new Zc.a(new xe.a);for(let a of this.pU.YO)this.YO.add(a)}}ALj(){r.ULS.sendTraceTag(590890074,377,50,
"Total number of renderable indicators: {0}",this.xYd);this.j1g()}j1g(){this.xYd&&(this.b4j(),this.O3j())}b4j(){!this.gVh&&.5<=this.ncb.J(0).count/this.xYd&&(this.gVh=!0,re.c(Sa.a.p2j),r.ULS.sendTraceTag(590926531,377,50,"User started Catch Up Passive Session"))}O3j(){if(!this.uHd){var a="";1<=this.ncb.J(1).count&&(this.uHd=!0,a="previews");1<=this.ncb.J(2).count&&(this.uHd=!0,a="selections");this.uHd&&(re.c(Sa.a.i2j),r.ULS.sendTraceTag(590926532,377,50,"User started Catch Up Active Session due to {0}",
a))}}D4l(a){(a=this.bHd.get(a))&&this.Rd.Pm(a,0)}}Object(w.a)(Ad,"IndicatorTelemetryActor",null,[]);var je=b(471);b(935);class mf{constructor(a,c){this.n1d=a;this.Uvc=c}Hll(){return this.Uvc.promise.then(a=>a.getWywaActivitiesResponse)}getActivities(a,c){return je.b(this.n1d.requestActivities(a,c))}getRelevantActivities(a,c){return this.Uvc.promise.then(h=>h.getWywaActivitiesResponse.WywaWaterline===a?Promise.resolve(h.getRelevantActivitiesResponse):je.b(this.n1d.requestRelevantActivities(a,c)))}getActivityFeed(){return this.Uvc.promise.then(a=>
void 0!==a.activityFeed?Promise.resolve(a.activityFeed):je.b(this.n1d.requestActivityFeed()))}updateWaterline(){return je.b(this.n1d.o1m())}}Object(w.a)(mf,"ActivityRepository",null,[]);var Wg=b(937);class si{constructor(a){this.nk=a}get ee(){return this.nk&&this.nk.Rh?this.nk:null}U9b(a,c){return this.ee?this.ee.vOe(a,!0)?this.ee.U9b(a,c,!0,!0):(r.ULS.sendTraceTag(579396803,377,15,"ScrollToHighlightParagraph: unable to scroll to desired paragraph"),null):null}}Object(w.a)(si,"PageViewWrapper",null,
[]);class mg{constructor(a,c,h,v,B){this.activityContentManager=a;this.Eb=c;this.Mxk=h;this.Rd=v;this.Eyl=B}mqf(a){if(dq()){var c=new Map;c.set("activityType",a.type.toString());this.Rd.Pm("CatchUpNavigateToActivity",0,{extendedProperties:c})}}Gpf(a){dq()&&this.Rd.pi("CatchUpNavigateToActivity",a,{},{name:"CatchUpExperienceDegraded",Lm:"NavigateToActivityFailed"})}Zfm(a){try{const c=a.activity;this.mqf(a.activity);cp()&&1==c.type&&this.Eyl.sNd();if(!this.activityContentManager.doesContentExist(c))return this.activityContentManager.mIn(c),
this.Gpf("Content does not exist"),Promise.resolve(2);const h={};let v=0;switch(c.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:h.ActivityId=c.activityId;h.NavigationId=atob(c.navigationId);v=this.Eb.hb(Sa.a.SQe,2,h);break;case 1:h.Activity=c,h.NodeId=a.locationId,v=this.Eb.hb(ba.a.pTf,2,h),h.NodeId&&this.Eb.hb(ba.a.XMd,2,h)}8==v&&this.Gpf("Action failed")}catch(c){return r.ULS.sendTraceTag(592237846,3012,10,"Exception thrown trying to navigate to an activity. {0}",c),this.Gpf("Exception was thrown"),
Promise.resolve(3)}return Promise.resolve(1)}navigateToActivity(a){return this.Mxk.spb.then(()=>this.Zfm(a))}}Object(w.a)(mg,"WordActivityNavigationManager",null,[611]);var Ai;(function(a){a[a.default=0]="default";a[a.D48X48=1]="D48X48";a[a.D64X64=2]="D64X64";a[a.D96X96=3]="D96X96";a[a.D120X120=4]="D120X120";a[a.D240X240=5]="D240X240";a[a.D360X360=6]="D360X360";a[a.D432X432=7]="D432X432";a[a.D504X504=8]="D504X504";a[a.D648X648=9]="D648X648"})(Ai||(Ai={}));Object(w.b)("ProfilePhotoDimension",Ai);var ti=
b(717),Mh=b(1278),ve=b(555);class te{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(w.a)(te,"ActivityRequestPayload",null,[]);class Ke{constructor(){this.color=this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(w.a)(Ke,"Person",null,[]);class Vf extends Dd{constructor(){super();this.relationship=0}}Object(w.a)(Vf,"TaskActivity",Dd,[]);class Bf extends Dd{constructor(){super();
this.contentId=null}}Object(w.a)(Bf,"CommentActivity",Dd,[]);class Vi extends Bf{constructor(){super()}}Object(w.a)(Vi,"CommentReplyActivity",Bf,[]);class Sh extends Bf{constructor(){super();this.tgi=null}}Object(w.a)(Sh,"MentionActivity",Bf,[]);class qj{constructor(a,c,h,v){this.YJb=a;this.Z5a=c;this.Zwe=h;this.HL=v;this.HL.isFirstDocumentOpen=!1}requestWYWAActivities(){return this.YJb.Hll().then(a=>{if(!a||a.StatusCode&&155!==a.StatusCode)throw this.tUe("GetWYWAActivities",a);155===a.StatusCode&&
(r.ULS.sendTraceTag(40433563,377,50,"No waterline is found on GetWywaActivities request."),this.HL.isFirstDocumentOpen=!0);const c=this.bZf(a.People);return Object.assign(new te,{activities:this.R5d(a.Activities,c),actors:c,hasMore:!a.AllWYWA,highWaterline:a.HighWaterline,lowWaterline:a.LowWaterline,wywaWaterline:a.WywaWaterline,isFirstDocumentOpen:155===a.StatusCode})})}requestActivities(a,c){return this.YJb.getActivities(a,c).then(h=>{if(!h||h.StatusCode)throw this.tUe("GetActivities",h);const v=
this.bZf(h.People);return Object.assign(new te,{activities:this.R5d(h.Activities,v),actors:v,hasMore:!h.RequestedRetrieved,highWaterline:h.HighWaterline,lowWaterline:h.LowWaterline})})}requestRelevantActivities(a){return this.YJb.getRelevantActivities(a,this.HL.isFirstDocumentOpen).then(c=>{if(!c||c.StatusCode)throw this.tUe("GetRelevantActivities",c);const h=this.bZf(c.People),v=this.R5d(c.NewActivities,h,2);c=this.R5d(c.OutstandingActivities,h,3);for(let B of c)v.push(B);return Object.assign(new te,
{activities:v,actors:h})})}requestActivityFeed(){return this.YJb.getActivityFeed().then(a=>({activityFeedItems:a}))}R5d(a,c,h=1){const v=[];if(!a)return v;for(let ma of a){var B=null;a=[];a.push(c[ma.CreatorIndex]);switch(ma.ActivityType){case 1:B=ma;var X=new af;X.Ot=new Ua.a;for(let Pa of B.ChangeIds)X.Ot.add(tn.b(Pa));X.objectId=tn.b(B.ObjectId);B=X;break;case 2:B=ma;X=new Bf;X.contentId=B.ContentId;X.navigationId=B.NavigationId;B=X;break;case 4:B=ma;X=new Sh;a.push(c[B.MentioneeIndex]);X.tgi=
B.ParentContentId;X.navigationId=B.NavigationId;B=X;break;case 3:case 10:B=ma;X=new Vi;a.push(c[B.RepliedIndex]);X.contentId=B.ContentId;X.navigationId=B.NavigationId;B=X;break;case 6:case 7:case 8:case 9:B=ma,X=new Vf,a.push(c[B.MentioneeIndex]),X.navigationId=B.NavigationId,X.relationship=B.Relationship,B=X}B&&(B.actors=a,B.displayTimestamp=new Date(ma.DisplayTimestamp),B.activityId=tn.b(ma.ActivityId).toString(),B.type=ma.ActivityType,1!==h&&(B.relevancy=h),v.push(B))}return v}$3m(a,c,h){return this.Zwe&&
!De.b(a)&&this.Zwe.JKd?this.Zwe.HWb(c,h,l.AFrameworkApplication.kl,Ai.default):a}bZf(a){if(!a)return null;const c=Array(a.length);for(let h=0;h<a.length;h++){if(!a[h])continue;const v=new Ke;v.id=a[h].Id;v.provider=a[h].Provider;v.displayName=a[h].DisplayName;v.email=a[h].Email;v.imageUrl=this.$3m(a[h].PictureUrl,a[h].Email,a[h].Provider);this.Z5a&&(v.color=this.Z5a.gFc(new ti.a(v.email,void 0,v.displayName),Mh.a.catchUpFlyout));c[h]=v}return c}tUe(a,c){let h="null";c&&(h=ve.a[c.StatusCode]);return Error.create(String.format("{0} failed with status code: {1}.",
a,h))}}Object(w.a)(qj,"WordActivityRequestManager",null,[610]);class $h{constructor(a,c,h){this.ebd=0;this.Epc=!1;this.$rg=null;this.qa=a;this.YJb=h;c.HIe(()=>{this.Epc=!0;this.$rg=new Date;this.ebd=0})}start(){this.XZd()}updateWaterline(){if(Eb.App.lostSession)r.ULS.sendTraceTag(51217553,391,100,"The session is lost. Stop fetching new activities.");else if(this.Epc||3>=this.ebd){this.Epc?this.Epc=!1:this.ebd++;const a=Math.max(this.qa.vb("WordEditorActivityManagementMaturityMiliSeconds",30001)+5E3-
(+new Date-+this.$rg),0);r.ULS.sendTraceTag(39396256,391,100,"Requesting new activities in {0}ms",a);nl.Task.delay(a).continueWith(()=>{this.YJb.updateWaterline().then(()=>{this.XZd();return null}).catch(()=>{this.XZd();this.Epc=!0;this.ebd=0})})}else this.XZd()}XZd(){window.setTimeout(Object(m.a)(this,this.updateWaterline,"updateWaterline"),6E4)}}Object(w.a)($h,"WordEditorActivityScheduler",null,[]);class hj{constructor(){this.resolve=null;this.promise=new Promise(a=>{this.resolve=a})}icn(a){this.resolve(a)}}
Object(w.a)(hj,"CatchUpNetworkRequestWorkerCache",null,[]);class Uo{constructor(a,c,h,v){this.lok=a;this.K=c;this.Rd=h;this.Flf=v}iBf(a){a&&a.authors&&this.z4l(a.authors)}z4l(a){for(let c of a)c&&c.displayName===this.lok&&(this.Flf?this.Rd.pi("CatchUpActivitiesReady","CatchUpShowsChangesFromCurrentAuthor",{isIntentional:!1},{name:"CatchUpExperienceDegraded"}):(Object(fr.a)(),Fa.Health.instance.recordQosError("CatchUpShowsChangesFromCurrentAuthor",["CatchUpExperienceDegraded"],!1,!1,!0,!1,null)),r.ULS.sendTraceTag(571745507,
377,15,"LogIfWywaAuthorMatchesCurrentUser: WYWA author has same name as current user [same id={0},same email={1}]",c.id===this.K.Ga("PresenceUserId"),c.email===this.K.Ga("UserPrincipalName")))}}Object(w.a)(Uo,"WywaAuthorComparator",null,[]);class us{constructor(a){this.j$=a}sNd(){this.j$&&this.j$.execute(a=>a.logActivity("CatchUpIndicatorSurveyNomination",null))}}Object(w.a)(us,"IndicatorSurveyActor",null,[]);var Kn=b(915),gt=b(907);class Ip{constructor(){this.btb=this.container=null;this.q2j={jUa:"webasynccollabeng",
featureName:"CatchUp",occ:"CatchUpFeatureUsage",cJb:7}}get name(){return"WordEditor.CatchUpActivity"}get k2j(){return l.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")}get Khf(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ChangeSummariesEnabled",!1)}get ERh(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpDynamicEntryPointEnabled",!1)}get eRh(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CatchUpCustomDynamicEntryPointEnabled",
!1)}get nhf(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}get sIc(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.isCatchUpActivitiesReadyTelemetryFixEnabled",!1)}get tUl(){return l.AFrameworkApplication.K.$("IsUserFromDifferentTenant")}get Flf(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsSameAuthorKpiTelemetryEnabled",!1)}yb(a){sn("Configure");this.container=
a;a.ha("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache",()=>new hj).singleInstance()}init(){sn("Init");this.k2j&&(M.a.instance.registerOnPackageInit("WordEditor.Workers",()=>{this.container.resolve("Box4.Workers.IWebWorkerRouter").Qg(2,4,l.AFrameworkApplication.rootQuerySignature,Eb.App.webServiceBase+"OneNote.ashx",2,this.nhf)}),sn("HotStore"),Eb.App.Rea.Vyb.execute(()=>{sn("ChromeReady");ck.a.get_instance().Vk(7,()=>{sn("ScriptDownload");(l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("catchUpActivity"):this.container.resolve("Common.IDynamicScriptLoaderProvider").$C.loadScript("catchUpActivity")).catch(a=>{r.ULS.sendTraceTag(592233361,377,10,"Failed to load the resources for the CatchUpActivity feature: {0}",a)}).then(()=>this.olm()).catch(a=>{r.ULS.sendTraceTag(36548867,377,10,"Failed to initialize the CatchUpActivity feature: {0}",a)})})}))}olm(){sn("CreateObjectsAndInitializeState");this.A3l();this.Rfk();return this.vAl()}A3l(){r.ULS.sendTraceTag(592217358,
377,50,"CatchUpActivity feature enabled successfully");r.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");r.ULS.sendTraceTag(594401288,3012,50,"Tasks and outstanding data is enabled");this.Khf&&r.ULS.sendTraceTag(588130079,3012,50,"ChangeSummaries is enabled");this.ERh&&r.ULS.sendTraceTag(553911650,3012,50,"DynamicEntryPoint is enabled");this.eRh&&r.ULS.sendTraceTag(553769042,3012,50,"CustomDynamicEntryPoint is enabled");r.ULS.sendTraceTag(545036493,3012,50,"IsUserFromDifferentTenant: {0}",
this.tUl);this.nhf&&r.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")}vAl(){this.$Al();this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").V2e=new Date;sn("InitializeCatchUpApp");return this.btb.initialize(Object.assign(new vq,{featuredActivityGroupsEnabled:this.Khf,summaryStringEnabled:!0,dynamicEntryPointEnabled:this.ERh,customDynamicEntryPointEnabled:this.eRh,activityFeedDataEnabled:this.nhf})).then(()=>{this.container.resolve("WordEditor.CatchUpActivity.WordEditorActivityScheduler").start()})}Rfk(){this.container.ha("WordEditor.CatchUpActivity.ChangeIdCache",
()=>new xq(this.container.resolve("WordEditor.CatchUpActivity.IChangeIdObjectIdCache"),S.App.Hk.Da.Jb.sc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger",()=>new Kn.a(Fa.Health.instance,new gt.a,this.q2j)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IActivityStateManager",()=>new wq).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityContentManager",()=>new eg(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
l.AFrameworkApplication.pa,Hi.UISurfaces.dK(),l.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).as("Common.App.CatchUpActivity.IActivityContentManager").singleInstance();this.container.ha("WordEditor.CatchUpActivity.Network.ActivityRepository",()=>new mf(new Wg.a(rg.a.HOi(this.container.za("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper")),()=>l.AFrameworkApplication.rootQuerySignature,Eb.App.webServiceBase+"OneNote.ashx",2,rg.a.HOi(this.container.za("Common.App.CatchUpActivity.ICatchUpRequestHandler"))),
this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityRequestManager",()=>new qj(this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"),this.container.resolve("Common.App.People.IPeopleColorUtils"),this.container.resolve("Common.App.People.IUserProfilePictureUtilsV2"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),l.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightManager",()=>new tl(this.container.resolve("Box4.Highlight.IHighlightManager"),this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),S.App.Hk.Da.Jb,new si(S.App.Hk.Da.Jb),$c.a.instance,nc.FocusManager.instance(),this.container.resolve("Common.Utils.IAriaNotifier"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.DocumentTraverser",()=>
{let a;a=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfYieldableDocumentTraversalIsEnabled",!1)?new Mj(50,Ve.a.ie):new Pm;return new qb(l.AFrameworkApplication.Cb,a,S.App.Hk.Da.Jb.sc)}).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorSurveyActor",()=>new us(this.container.za("Common.ISystemInitiatedFeedback"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IActivityNavigationManager",()=>new mg(this.container.resolve("WordEditor.CatchUpActivity.ActivityContentManager"),
l.AFrameworkApplication.pa,this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),l.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutRibbonButton",()=>new Vc(l.AFrameworkApplication.pa,this.container.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"),
nc.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutRibbonButton").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FlyoutFocus",()=>new $b(pj.a.instance,nc.FocusManager.instance())).as("Common.App.CatchUpActivity.IFlyoutFocus").singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupCache",()=>new mm).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorHelper",()=>new mo(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.container.resolve("WordEditor.Indicator.TopLevelOutlineElementCache"),S.App.Hk.Da.Jb)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor",()=>new Ia(this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"))).singleInstance();this.container.ha("Common.App.CatchUpActivity.IChangeSummariesDataProvider",()=>new To(new np(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor")),
new ft(this.container.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.container.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.container.resolve("Box4.AugmentationLoop.IAnnotationStorage"),l.AFrameworkApplication.Cb),new xp(this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper")),this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser"),this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupCache"),l.AFrameworkApplication.K.$("CatchUpFlyoutMockDataIsEnabled"))).singleInstance();
this.btb=catchUpActivity.FactoryGlobal.getWordCatchUpAppInstance(Object.assign(new Hp,{activityContentManager:this.container.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.container.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.container.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),appColorUpdateIsEnabled:l.AFrameworkApplication.K.$("AppColorUpdateIsEnabled"),changeSummariesDataProvider:this.container.resolve("Common.App.CatchUpActivity.IChangeSummariesDataProvider"),
dataCulture:l.AFrameworkApplication.dataCulture,flyoutRibbonButton:this.container.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),flyoutFocus:this.container.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),uiCulture:l.AFrameworkApplication.uiCulture,ulsLogger:new lo.a}));this.btb.setWebpackPublicPath(l.AFrameworkApplication.LV);this.container.ha("WordEditor.CatchUpActivity.ActivityHighlightActor",()=>new vh(this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"))).singleInstance();
this.container.ha("WordEditor.CatchUpActivity.WordEditorActivityScheduler",()=>new $h(l.AFrameworkApplication.K,sl.a.instance,this.container.resolve("WordEditor.CatchUpActivity.Network.ActivityRepository"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.IndicatorTelemetryActor",()=>new Ad(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"))).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorActor",
()=>new Co(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.btb.getActivityIndicatorTooltipManager(),this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor"),this.container.resolve("WordEditor.CatchUpActivity.IndicatorSurveyActor"),S.App.Hk.Da.Jb,this.container.za("Common.IZoomManager"),l.AFrameworkApplication.Cb,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorHelper"),!!Eb.App.instance&&Eb.App.instance.Cja)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityIndicatorManager",
()=>new eq(this.container.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,S.App.Hk.Da.Jb.sc,this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor"),l.AFrameworkApplication.pa,this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.sIc)).singleInstance();this.container.ha("WordEditor.CatchUpActivity.ActivityAnnouncementManager",()=>new eb(this.container.resolve("WordEditor.CatchUpActivity.ChangeIdCache"),
this.container.resolve("Common.Utils.IAriaNotifier"),l.AFrameworkApplication.pa,nc.FocusManager.instance())).singleInstance();this.container.ha("WordEditor.CatchUpActivity.WywaAuthorComparator",()=>new Uo(l.AFrameworkApplication.userName,l.AFrameworkApplication.K,this.container.resolve("WordEditor.CatchUpActivity.IFeatureUsageAndHealthLogger"),this.Flf)).singleInstance()}$Al(){var a=this.container.resolve("Box4.Highlight.IHighlightManager"),c=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightActor");
a.ggb(c);const h=this.container.resolve("WordEditor.CatchUpActivity.ActivityHighlightManager");a=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager");const v=this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorActor");c=this.container.resolve("WordEditor.CatchUpActivity.ActivityAnnouncementManager");const B=this.container.resolve("WordEditor.CatchUpActivity.IActivityStateManager"),X=$c.a.instance,ma=this.container.resolve("WordEditor.CatchUpActivity.DocumentTraverser");
X.aC(()=>{B.JJd?B.JJd=!1:(B.F_a&&h.Yci(null,null,!1),B.Lbb&&h.kci(null,null),v.MPe())});X.aC(Object(m.a)(c,c.a1,"onSelectionChanged"));this.btb.getWywaEvent().addListener(Object(m.a)(a,a.iBf,"onWywaActivityReady"));a=this.container.resolve("WordEditor.CatchUpActivity.WywaAuthorComparator");this.btb.getWywaEvent().addListener(Object(m.a)(a,a.iBf,"onWywaActivityReady"));ma.zIj((Pa,mb)=>{mb&&this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor").Mqm(mb.node)});ma.spb.then(()=>{this.container.resolve("WordEditor.CatchUpActivity.IndicatorTelemetryActor").ALj()});
this.btb.getWywaEvent().addListener(()=>{ma.dTj()});v.UGj((Pa,mb)=>{mb&&h.kci(mb.dwb,mb.jMh)});v.VGj((Pa,mb)=>{mb&&h.Yci(mb.dwb,mb.jMh,mb.son)});v.eb(l.AFrameworkApplication.pa);this.Khf&&this.container.resolve("WordEditor.CatchUpActivity.FeaturedActivityGroupTelemetryActor").eb(l.AFrameworkApplication.pa);this.container.resolve("WordEditor.CatchUpActivity.FlyoutRibbonButton").initialize();this.container.resolve("WordEditor.CatchUpActivity.FlyoutFocus").initialize();this.container.resolve("WordEditor.CatchUpActivity.ActivityIndicatorManager").initialize();
this.qsn()}qsn(){yh.c()&&(r.ULS.sendTraceTag(591673372,3012,50,"WordEditorCatchUpActivityPackageManager.ShowRibbonControls"),appChrome.api.dispatch([appChrome.actions.updateControlHiddenState("MarkCatchUpChangeAsRead",!1)]))}dispose(){}}Object(w.a)(Ip,"WordEditorCatchUpActivityPackageManager",null,[1,2]);var oo=b(145),Yg=b(406),yp=b(1314),fq=b(444),go=b(1434),ok=b(1317),fs=b(1516),vs=b(1435),ht=b(596),it=b(1517),Jr=b(770),Kr=b(162),hn=b(1330);class gs{constructor(){this.px=this.annotation=null}}Object(w.a)(gs,
"AnnotationChangedData",null,[]);class ws{constructor(a,c,h,v,B,X,ma,Pa=!1,mb){this.annotationType=a;this.uwa=c;this.xo=h;this.I3d=v;this.o_c=B;this.rTn=X;this.Da=ma;this.CFi=Pa;this.K=mb;this.Qv=null;this.jVh=!1;this.Bd=new Rd.a;this.VNc=0}pG(a){this.Bd.addHandler("AnnotationChangedEvent",a)}VI(a){this.Bd.removeHandler("AnnotationChangedEvent",a)}register(){return this.o_c().then(()=>{0===this.VNc&&(this.CFi&&(this.Qv=this.xo.Pe("WebServiceCall",this.annotationType)),this.uwa.Ea(this,this.annotationType));
this.VNc++})}unregister(){return this.o_c().then(()=>(new Promise(a=>setTimeout(a,this.K.vb(Kr.a.$sk,3E3)))).then(()=>{0<this.VNc&&(this.VNc--,0===this.VNc&&this.uwa.xb(this,this.annotationType))}))}eZb(){return this.o_c().then(()=>this.uwa.getAnnotationsByType(this.annotationType))}gqh(a){a=Yg.a.wI(a);return(a=this.uwa.fqh(a))&&0<a.count?a.toArray().filter(c=>Un.a.matchesTypesFor(c.content,[this.annotationType])):[]}getParent(a){return a?a.parent?a.parent:a.parentPath?this.rTn(this.Da.Zb.Lc,a.parentPath):
null:(r.ULS.shipAssertTag(575930380,3016,!1),null)}$ba(a){a.timestamp||(a.timestamp=Date.now());a=Object.assign(new Jr.a,{parentPath:["Signal",Un.a.getTypeNameFor(a)],items:[Object.assign(new Eo.a,{body:a})]});this.I3d.submitOperation(a)}dAk(a,c){a=Object.assign(new fo.a,{parentPath:["Signal",c],items:[Object.assign(new Eo.a,{body:a})]});this.I3d.submitOperation(a)}hK(a,c){a?c?(this.CFi&&!this.jVh&&(this.Qv.stop(),this.jVh=!0),this.Bd.Fca&&(a=new hn.a(Object.assign(new gs,{annotation:a,px:c})),this.Bd.raiseEvent("AnnotationChangedEvent",
a))):r.ULS.shipAssertTag(575930382,3016,!1):r.ULS.shipAssertTag(575930381,3016,!1)}}Object(w.a)(ws,"AnnotationManager",null,[654,337]);class jt{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.CG=a;this.yZd=c;this.WYb=h;this.BIa=v;this.a8=B;this.kYc=X;this.z$=ma;this.YHb=Pa;this.EXb=mb;this.bEb=Tb;this.fBn=rc}}Object(w.a)(jt,"AnnotationManagerHolder",null,[655]);class gq{constructor(a,c){this.oLj=a;this.o_c=c}submitOperation(a){return this.o_c().then(()=>{this.oLj.getAugLoopRuntimeManager().submitOperation(Object.assign(new mp.a,
{operation:a}))})}}Object(w.a)(gq,"SubmitOperationHelper",null,[]);var Uk=b(781),I=b(1518),ra=b(933),ab=b(66),Fb=b(125),ac=b(88);class Xc{constructor(a,c,h){this.a8=a;this.im=c;this.lTd=h;this.Qxa={};this.Zeh=!1;this.Peb=(v,B)=>{B.data.px===fo.a.getTypeName()&&B.data.annotation&&B.data.annotation.annotationType===I.a.getTypeName()&&(v=B.data.annotation.content)&&v.documentTypeConfidences.length&&(this.Yeh=v.documentTypeConfidences[0].documentTypeLabel,r.ULS.sendTraceTag(541078657,3016,50,"Document type obtained: {0}",
this.Yeh))};this.a8.pG(this.Peb);this.a8.register();this.Qxa={["docType"]:null,["characterCount"]:null,["paragraphCount"]:null,["imageCount"]:null,["tableCount"]:null,["listElementsCount"]:null,["blobsCount"]:null,["pageCount"]:null,["currentPage"]:null}}PDc(){this.Zeh||(this.a8.$ba(new ra.a),r.ULS.sendTraceTag(541078658,3016,50,"Document type classifier signal sent"),this.Zeh=!0);this.Zwk();this.Qxa.docType=this.Yeh;this.Qxa.characterCount=this.characterCount;this.Qxa.paragraphCount=this.mY;this.Qxa.imageCount=
this.AO;this.Qxa.tableCount=this.Dla;this.Qxa.listElementsCount=this.q_h;this.Qxa.blobsCount=this.cWg;this.Qxa.pageCount=this.lTd.cFc();this.Qxa.currentPage=this.lTd.Nzh();return this.Qxa}Zwk(){this.mY=this.cWg=this.q_h=this.Dla=this.AO=this.characterCount=0;var a=this.im.xya(S.App.Hk.Da.Jb.sc,7,7).currentNode,c=Kd.GraphIterator.va(a);for(a=Tl.a.eq(c,a);a.moveNext();)if(c=a.currentNode)if(dd.ImageReader.ix(c))this.AO++;else if(Wf.TableReader.gV(c))this.Dla++;else if(ab.ListReader.F0(c))this.q_h++;
else if(sd.ParagraphReader.tb(c)){var h=ac.e(c);for(let v=0;v<h.length;v++)5===h[v].nh?this.AO++:this.cWg++;h=Fb.AParagraphNode.l1(c.characterData);h=h.trim();this.characterCount+=h.length;0<h.length&&!sd.ParagraphReader.P8(c)&&!sd.ParagraphReader.IO(c)&&this.mY++}}}Object(w.a)(Xc,"LoggingDocumentInfo",null,[602]);class Md{constructor(){this.ma=new Rd.a}TIj(a){this.ma.addHandler("OnTaskPaneReviewStateChanged",a)}AYm(a){this.ma.removeHandler("OnTaskPaneReviewStateChanged",a)}VHj(a){this.ma.addHandler("BlueDotClickedEvent",
a)}jYm(a){this.ma.removeHandler("BlueDotClickedEvent",a)}hIj(a){this.ma.addHandler("OnFormattingMarkedForReview",a)}jIj(a){this.ma.addHandler("OnFormattingReviewCompleted",a)}gIj(a){this.ma.addHandler("OnFormattingAccept",a)}iIj(a){this.ma.addHandler("OnFormattingReject",a)}IIj(a){this.ma.addHandler("OnReviewInvalidated",a)}oQg(a){this.ma.addHandler("OnTraigeAction",a)}GIe(a){this.ma.addHandler("OnReviewVisibilityChanged",a)}uYm(a){this.ma.removeHandler("OnReviewVisibilityChanged",a)}THj(a){this.ma.addHandler("OnBeforeReviewNavigation",
a)}EIj(a){this.ma.addHandler("OnRegisterEnhancement",a)}VIj(a){this.ma.addHandler("onTooltipVisibilityChanged",a)}BYm(a){this.ma.removeHandler("onTooltipVisibilityChanged",a)}B8b(a){a?this.ma.raiseEvent("OnTaskPaneReviewStateChanged",new hn.a(a)):r.ULS.shipAssertTag(575930374,3016,!1)}qLm(a){a?this.ma.raiseEvent("BlueDotClickedEvent",new hn.a(a)):r.ULS.shipAssertTag(575930375,3016,!1)}tLm(a){a?this.ma.raiseEvent("OnFormattingMarkedForReview",new hn.a(a)):r.ULS.shipAssertTag(575930376,3016,!1)}vLm(a){a?
this.ma.raiseEvent("OnFormattingReviewCompleted",new hn.a(a)):r.ULS.shipAssertTag(573850377,3016,!1)}sLm(a){a?this.ma.raiseEvent("OnFormattingAccept",new hn.a(a)):r.ULS.shipAssertTag(575930377,3016,!1)}uLm(a){a?this.ma.raiseEvent("OnFormattingReject",new hn.a(a)):r.ULS.shipAssertTag(575930378,3016,!1)}wLm(a){a?this.ma.raiseEvent("OnReviewInvalidated",new hn.a(a)):r.ULS.shipAssertTag(575930379,3016,!1)}HHf(a){a?this.ma.raiseEvent("OnTraigeAction",new hn.a(a)):r.ULS.shipAssertTag(573850378,3016,!1)}hmi(a){a?
this.ma.raiseEvent("OnReviewVisibilityChanged",new hn.a(a)):r.ULS.shipAssertTag(573850379,3016,!1)}pLm(a){a?this.ma.raiseEvent("OnBeforeReviewNavigation",new hn.a(a)):r.ULS.shipAssertTag(573687395,3016,!1)}xEb(a){a?this.ma.raiseEvent("OnRegisterEnhancement",new hn.a(a)):r.ULS.shipAssertTag(555055117,3016,!1)}zmi(a){a?this.ma.raiseEvent("onTooltipVisibilityChanged",new hn.a(a)):r.ULS.shipAssertTag(540587343,3016,!1)}}Object(w.a)(Md,"ReviewEvents",null,[601]);class bf{constructor(a){this.W=null;if(!a)throw oo.a.argument("Workspace is null");
this.Fs=a}get name(){return"WordEditor.Designer.Common"}init(){}yb(a){a?(this.W=a,a.ha("WordEditor.Designer.Common.AL.ISubmitOperationHelper",()=>new gq(this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),Yg.a.Yn)).singleInstance(),a.ha("WordEditor.Designer.IDesignerControl",()=>new Uk.a(a.resolve("Box4.IFeatureHelper"),a.resolve("Common.IAppSettingsManager"),l.AFrameworkApplication.uiCulture)).singleInstance(),a.ha("WordEditor.Designer.Common.Review.IReviewEvents",()=>new Md).singleInstance(),
a.ha("WordEditor.Designer.Common.AL.IAnnotationManagerHolder",()=>new jt(this.hxa(ok.DocumentRoleDetectionAnnotation.getTypeName()),this.hxa(ok.RoleDetectionAnnotation.getTypeName()),this.hxa(yp.FormattingSuggestionsSummaryAnnotation.getTypeName(),!0),this.hxa(yp.FormattingSuggestionsAnnotation.getTypeName()),this.hxa(fq.DocumentTypeClassifierAnnotation.getTypeName()),this.hxa(vs.ThemeExtractorAnnotation.getTypeName()),this.hxa(ht.ThemeGeneratorAnnotation.getTypeName()),this.hxa(fs.TextToImageAnnotation.getTypeName()),
this.hxa(go.DocumentPullQuoteAnnotation.getTypeName()),this.hxa(go.PullQuoteAnnotation.getTypeName()),this.hxa(it.TableTypeAnnotation.getTypeName()))).singleInstance(),a.ha("WordEditor.Designer.DocumentInfo",()=>new Xc(a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").a8,a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("WordEditor.IPageNumberFinder"))).singleInstance()):r.ULS.shipAssertTag(575767060,3016,!1)}dispose(){}hxa(a,c=!1){return new ws(a,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),Yg.a.Yn,Yg.a.Qab,this.Fs,c,this.W.resolve("Common.IAppSettingsManager"))}}Object(w.a)(bf,"PackageManager",null,[1,2]);var Hf=b(1340),Zg=b(1304),gi=b(1519);class Ei extends Sys.EventArgs{constructor(a,c){super();this.node=a;this.Ovf=c}}Object(w.a)(Ei,"RoleChangeArgs",Sys.EventArgs,[]);class Il{constructor(a){this.Yf=!1;this.VE=a;this.VE.Q8c++}dispose(){this.Yf||
(this.Yf=!0,this.VE.Q8c--)}}Object(w.a)(Il,"InvalidationSuspension",null,[14]);class Kk{constructor(){this.EXc=null;this.role=this.JOd=0;this.psb=this.TJd=this.wja=this.O3b=!1;this.WNd=this.DMc=this.rVa=null;this.placeholder=!1;this.imageId=null;this.removed=!1;this.Fyc=null}get Jcb(){return!this.role||!this.rVa||!this.rVa.length}hFl(){this.psb=this.TJd=!0}IUl(){return!!this.role||!!this.rVa||!!this.EXc}}Object(w.a)(Kk,"RoleState",null,[625]);class nm{constructor(a,c,h,v,B,X){this.rg=!1;this.jHd=
null;this.hrf=new Yc.a;this.Olg=0;this.s5m=(ma,Pa)=>{Pa.data.px===fo.a.getTypeName()&&(Pa=Pa.data.annotation,(ma=Pa.content)?(Pa=this.GQb.getParent(Pa))&&this.E0d(Pa,Zg.e(ma.roleType),!1,void 0,null!=ma.listID?ma.listID:0,ma.listItemlevel,ma.listItemPrefix):r.ULS.shipAssertTag(575813856,3016,!1))};this.Dxk=(ma,Pa)=>{if(Pa.data.px===fo.a.getTypeName())if(ma=Pa.data.annotation.content)for(r.ULS.sendTraceTag(556074199,3016,50,ma.confidence.toString()),this.hrf=new Yc.a,Pa=0;ma.listInfos&&Pa<ma.listInfos.length;Pa++){const mb=
ma.listInfos[Pa];this.hrf.Z(mb.listID,mb)}else r.ULS.shipAssertTag(556323522,3016,!1)};this.ZTh=(ma,Pa)=>{ma=ma.bL;if(!ma||ma.ia(Yb.a.FWe,!1))return!1;ma=ma.getValue(Yb.a.Kta);if(!ma)return!1;ma=Zg.f(ma);return 1!=ma&&ma!=Pa.role};this.ENk=(ma,Pa)=>{ma=Pa.data.annotation;const mb=this.J6c.getParent(ma);if(mb)if(Pa.data.px===fo.a.getTypeName()){const Tb=Pa.data.annotation.content;Tb?this.c$(mb,rc=>{this.jHd&&rc.Fyc&&this.jHd>rc.Fyc&&!rc.psb||rc.role!==rc.JOd||this.ZTh(mb,rc)?(r.ULS.sendTraceTag(572301727,
3016,50,"InvalidationTimestamp: {0} | InvalidatedFlag: {1} | RlmRole==ModelRole: {2}",this.jHd,rc.psb,rc.role===rc.JOd),rc.EXc=Tb.suggestions):(rc.rVa=Tb.suggestions,rc.psb=!1)}):r.ULS.shipAssertTag(575813859,3016,!1)}else Pa.data.px===Hf.a.getTypeName()&&this.c$(mb,Tb=>{Tb.rVa=null;Tb.EXc=null});else r.ULS.shipAssertTag(575813858,3016,!1,`Parent not found for annotation id: ${ma.id} parentPath: ${ma.parentPath}`)};this.Unm=(ma,Pa)=>{(ma=Pa.data.paragraphNode)?this.c$(ma,mb=>{mb.wja=!0}):r.ULS.shipAssertTag(575930368,
3016,!1)};this.Wnm=(ma,Pa)=>{(ma=Pa.data.paragraphNode)?this.c$(ma,mb=>{mb.wja=!1;5!==Pa.data.state&&(mb.rVa=null)}):r.ULS.shipAssertTag(573850380,3016,!1)};this.Snm=(ma,Pa)=>{(ma=Pa.data.paragraphNode)?this.c$(ma,mb=>{mb.wja=!0}):r.ULS.shipAssertTag(575930369,3016,!1)};this.Vnm=(ma,Pa)=>{(ma=Pa.data.paragraphNode)?this.E0d(ma,1,!0,!0):r.ULS.shipAssertTag(575930370,3016,!1)};this.SAf=(ma,Pa)=>{(ma=Pa.data.paragraphNode)?this.E0d(ma,Pa.data.Ovf,!0,!0):r.ULS.shipAssertTag(575484484,3016,!1)};this.tnl=
(ma,Pa)=>{if(Pa.node){var mb=Pa.node;ma=this.QD(mb);27==ma.role&&r.ULS.sendTraceTag(541435078,3016,50,"Pull Quote node deleted.");ma.wja&&27!==ma.role&&28!==ma.role&&this.yEi(this.xgb-1);ma.Jcb||27===ma.role||28===ma.role||this.rEi(this.inconsistenciesCount-1);this.c$(mb,Tb=>{Tb.removed=!0});this.oW.KIc()||setTimeout(()=>this.removeNode(mb),1E4)}else r.ULS.shipAssertTag(575930371,3016,!1)};this.removeNode=ma=>{this.Jqi(ma.id)};this.Jqi=ma=>{let Pa;({value:Pa}=this.vq.Ab(ma));(null===Pa||void 0===
Pa?0:Pa.removed)&&this.vq.remove(ma)};this.MWm=()=>{const ma=this.vq.keys.toArray().filter(Pa=>this.vq.J(Pa).removed);ma.sort((Pa,mb)=>this.vq.J(Pa).Fyc.getTime()-this.vq.J(mb).Fyc.getTime());ma.slice(0,10).forEach(Pa=>{this.Jqi(Pa)})};this.snl=(ma,Pa)=>{Pa.node?(ma=Pa.node,this.DJd(ma)?this.c$(ma,mb=>{mb.removed=!1}):this.c$(ma,mb=>{mb.psb=!1})):r.ULS.shipAssertTag(540672206,3016,!1)};this.unl=(ma,Pa)=>{Pa.node?this.hSf(Pa.property,Pa.node)&&(ma=Pa.node,this.Q8c||ma.VUd?this.c$(ma,mb=>{mb.psb=!1}):
this.c$(ma,mb=>{mb.hFl();mb.EXc&&(mb.rVa=mb.EXc,mb.role=mb.JOd)}).wja&&this.GRa.wLm(new gi.a(Pa.node))):r.ULS.shipAssertTag(575930372,3016,!1)};this.Arm=(ma,Pa)=>{switch(Pa.data.role){case 27:const mb=Pa.data;this.c$(Pa.data.paragraphNode,rc=>{rc.role=27;rc.O3b=!0;rc.placeholder=mb.placeholder});break;case 28:const Tb=Pa.data;this.c$(Pa.data.paragraphNode,rc=>{rc.role=28;rc.O3b=!0;rc.placeholder=Tb.placeholder;rc.imageId=Tb.imageId});break;case 2:this.c$(Pa.data.paragraphNode,rc=>{rc.role=2})}};this.J6c=
a;this.GQb=c;this.Uge=h;this.oW=X;this.Wm=v;this.GRa=B;this.vq=new Yc.a;this.ma=new Rd.a;this.Q8c=this.cfd=this.u8c=0}get yFl(){return this.Q8c}lIj(a){this.ma.addHandler(nm.Nai,a)}JIj(a){this.ma.addHandler(nm.Ici,a)}jQg(a){this.ma.addHandler(nm.oAf,a)}vYm(a){this.ma.removeHandler(nm.oAf,a)}get inconsistenciesCount(){return this.u8c}rEi(a){this.u8c!==a&&(this.u8c=a,this.ma.raiseEvent(nm.Nai,new hn.a(this.u8c)))}get xgb(){return this.cfd}yEi(a){this.cfd!==a&&(this.cfd=a,this.ma.raiseEvent(nm.Ici,new hn.a(this.cfd)))}get Kdf(){return this.Olg}DJd(a){return this.vq.Ja(a.id)}D6k(a){var c,
h;return null===(h=null===(c=this.hrf)||void 0===c?void 0:c.Ab(a))||void 0===h?void 0:h.value}cAh(a,c){var h,v,B;const X=new Map;for(const ma of c)if((c=ma)&&c.isConnected){const Pa=null!==(B=null===(v=null===(h=this.vq.Ab(c.id))||void 0===h?void 0:h.value)||void 0===v?void 0:v.role)&&void 0!==B?B:1;a.has(Pa)&&(X.has(Pa)?X.get(Pa).add(c):X.set(Pa,new Ua.a([c])))}return X}QD(a){if(!a)return r.ULS.shipAssertTag(575813855,3016,!1),null;let c;return({value:c}=this.vq.Ab(a.id)).returnValue?c:Object.assign(new Kk,
{role:1,O3b:!1})}Z0m(){this.jHd=new Date;return new Il(this)}register(){this.J6c.register();this.GQb.register();this.Uge.register()}unregister(){this.J6c.unregister();this.GQb.unregister();this.Uge.unregister()}initialize(){if(!this.rg){const a=this.Wm.Yd(12);a.Mt(this.tnl);a.Yo(this.snl);a.Yl(this.unl);this.J6c.pG(this.ENk);this.GQb.pG(this.s5m);this.Uge.pG(this.Dxk);this.GRa.iIj(this.Vnm);this.GRa.gIj(this.Snm);this.GRa.hIj(this.Unm);this.GRa.jIj(this.Wnm);this.GRa.oQg(this.SAf);this.GRa.EIj(this.Arm);
this.rg=!0}}Ad(){}E0d(a,c,h,v=!1,B=0,X=0,ma){let Pa=0,mb=!1;this.c$(a,Tb=>{const rc=Tb.TJd||!Tb.role;h||(Tb.JOd=c);if(v||rc)mb=Tb.role!==c,Pa=Tb.role,Tb.role=c,Tb.O3b=h,Tb.TJd=!1,Tb.DMc=B,Tb.WNd=X,Tb.listItemPrefix=ma,Tb.Fyc=new Date});if(mb){const Tb=c-4;Tb>this.Kdf&&8>Tb&&(this.Olg=Tb);1===c&&this.c$(a,rc=>{rc.rVa=null});this.ma.raiseEvent(nm.oAf,new hn.a(new Ei(a,c,Pa)))}}c$(a,c){let h;if(({value:h}=this.vq.Ab(a.id)).returnValue){a=h.Jcb;const v=h.wja;c(h);if(27!==h.role&&28!==h.role){if(h.removed)return h;
a!==h.Jcb&&this.rEi(this.inconsistenciesCount+(a?1:-1));v!==h.wja&&this.yEi(this.xgb+(v?-1:1))}}else c(h=new Kk),h.IUl()&&(this.oW.KIc()&&this.vq.count>Kr.a.u5m&&(r.ULS.sendTraceTag(525165656,3016,50,this.vq.count.toString()),this.MWm()),this.vq.add(a.id,h));return h}hSf(a,c){({value:c}=this.vq.Ab(c.id));return 28===(null===c||void 0===c?void 0:c.role)?!(null===c||void 0===c?0:c.placeholder)&&a===Ed.a.Pl:!(null===c||void 0===c?0:c.placeholder)&&(a===Ed.a.Pl||a===Ed.a.mm||Array.contains(Fb.AParagraphNode.Dca(),
a))}}nm.Nai="OnInconsistenciesChanged";nm.Ici="OnRoleReviewCount";nm.oAf="OnRoleChanged";Object(w.a)(nm,"RoleLifecycleManager",null,[607,608,609]);class Rf{constructor(a,c,h,v,B){this.GRa=a;this.GQb=c;this.$e=h;this.Wm=v;this.VE=B;this.rg=!1;this.SAf=(X,ma)=>{(X=ma.data.paragraphNode)?this.aUi(X,()=>!0,Pa=>Pa.userSetRole=Zg.d(ma.data.Ovf)):r.ULS.shipAssertTag(557057378,3016,!1)};this.LOc=(X,ma)=>{0<this.VE.yFl||this.hSf(ma.property)&&this.aUi(ma.node,Pa=>!(Pa&&Pa.isInvalidated),Pa=>Pa.isInvalidated=
!0)}}initialize(){this.rg||(this.GRa.oQg(this.SAf),this.Wm.Yd(12).Yl(this.LOc),this.rg=!0)}Ad(){}aUi(a,c,h){if(a=(a=this.GQb.gqh(a))&&1===a.length&&a[0]){var v=a.content;v=v&&v.M_&&v.M_.customMetadata;c(v)&&(c=new ok.RoleDetectionCustomMetadata,c.isInvalidated=v&&v.isInvalidated,c.userSetRole=v&&v.userSetRole,h(c),this.$e.PLn(a,c))}}hSf(a){return a===Ed.a.Pl||a===Ed.a.mm||Array.contains(Fb.AParagraphNode.Dca(),a)}}Object(w.a)(Rf,"RoleDetectionMetadataUpdater",null,[606]);var Jp=b(958);class Gu{constructor(a,
c){this.I3d=a;this.kvb=c;this.vOc=(h,v)=>{h=v.data;if(h.px==Jp.a.getTypeName()||h.px==Jp.n.getTypeName())if(h=h.annotation&&h.annotation.content)this.runId=h.runId};this.revisionId=0}initialize(){this.kvb.pG(this.vOc)}Ad(){this.kvb.VI(this.vOc)}Gkm(){if(void 0===this.runId)Promise.resolve();else{var a=new ok.RoleDetectionSettings({acceptedRunId:this.runId});a=new Jp.a({parentPath:["session","doc","main"],items:[{id:"RoleDetectionSettings",body:a,revId:(this.revisionId++).toString()}]});this.I3d.submitOperation(a)}}}
Object(w.a)(Gu,"RoleDetectionSettingsUpdater",null,[]);class Pi{constructor(a,c,h){this.vEl=a;this.uwa=c;this.Ne=h;this.VNh=this.initialized=!1;this.T9h=()=>{this.bGi()&&(this.QMh(),this.uwa.cYm(this.T9h))}}initialize(){this.initialized||(this.Nff(),this.initialized=!0)}Ad(){}Nff(){this.bGi()?this.QMh():this.uwa.HHj(this.T9h)}bGi(){return!this.VNh&&(this.Ne.nRh()||this.uwa.yHd(ok.DocumentRoleDetectionAnnotation.getTypeName())||this.uwa.yHd(ok.RoleDetectionAnnotation.getTypeName()))}QMh(){for(const a of this.vEl)a.initialize();
this.VNh=!0}}Object(w.a)(Pi,"RLMInitializer",null,[]);class Zt{constructor(a,c,h){this.X1=a;this.Fs=c;this.H1c=h;this.W=null;this.Fea=()=>{this.$Hc();this.Fs.ogb(this.Fea)};if(!a)throw oo.a.argument("AppLifecycleManager is null");if(!c)throw oo.a.argument("Workspace is null");if(!h)throw oo.a.argument("ApplicationInstance is null");}get name(){return"WordEditor.DocumentUnderstanding.RLM"}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>this.El())}yb(a){this.W=a;a.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater",
()=>new Gu(this.W.resolve("WordEditor.Designer.Common.AL.ISubmitOperationHelper"),a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CG)).singleInstance();a.ha("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater",()=>new Rf(a.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").yZd,a.resolve("Box4.AugmentationLoop.IAnnotationStorage"),a.resolve("Box4.Graph.IGraphInstance"),a.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();
a.ha("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager",()=>new nm(a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").BIa,a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").yZd,a.resolve("WordEditor.Designer.Common.AL.IAnnotationManagerHolder").CG,a.resolve("Box4.Graph.IGraphInstance"),a.resolve("WordEditor.Designer.Common.Review.IReviewEvents"),a.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance();a.ha("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader",
()=>a.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager")).singleInstance();a.ha("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer",()=>new Pi([this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"),this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionMetadataUpdater")],a.resolve("Box4.AugmentationLoop.IAnnotationStorage"),a.resolve("WordEditor.Designer.IDesignerControl"))).singleInstance()}dispose(){}El(){this.H1c.WG?this.X1.Vk(16,()=>this.rHc()):
this.rHc()}rHc(){this.Fs.Qqa?this.$Hc():this.Fs.lba(this.Fea)}$Hc(){this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleDetectionSettingsUpdater").initialize();this.W.resolve("WordEditor.DocumentUnderstanding.RLM.IRLMInitializer").initialize()}}Object(w.a)(Zt,"PackageManager",null,[1,2]);class Et{constructor(){this.ContractVersion=0;this.FileName=this.Paragraphs=null}static construct(a,c){const h=new Et;h.ContractVersion=a;h.FileName=c;h.Paragraphs=[];return h}}Object(w.a)(Et,"DocumentSwayPreviewContent",
null,[]);class xs{constructor(){this.TextRuns=this.ParagraphFormatting=this.RawText=null;this.ParagraphIndex=0;this.IsRTL=!1}static Adk(a,c,h,v){const B=new xs;B.RawText=a;B.ParagraphFormatting=c;B.TextRuns=h;B.IsRTL=v;B.ParagraphIndex=0;return B}}Object(w.a)(xs,"ParagraphContent",null,[]);var fm=b(100),iv=b(1051);class za{constructor(){this.Name=null;this.Size=0}static construct(a,c){const h=new za;h.Name=a;h.Size=c;return h}}Object(w.a)(za,"FontData",null,[]);class Qa{constructor(){this.IsUppercase=
this.IsUnderline=this.IsBold=!1;this.Font=null;this.LeftIndent=this.Alignment=0}static construct(a,c,h,v,B,X){const ma=new Qa;ma.IsBold=a;ma.IsUnderline=c;ma.IsUppercase=h;ma.Font=v;ma.Alignment=B;ma.LeftIndent=X;return ma}}Object(w.a)(Qa,"TextFormatting",null,[]);class Da{constructor(){this.RunFormatting=this.RawText=null}static construct(a,c){const h=new Da;h.RawText=a;h.RunFormatting=c;return h}}Object(w.a)(Da,"TextRunContent",null,[]);var ua=b(104),Ta=b(40);class wb{constructor(a,c){this.oLb=
null;this.jlj=a;this.qL=c||""}get qxm(){return this.jlj.value}oFk(){const a=Date.now(),c=Et.construct(2,this.qL);c.Paragraphs=this.lRk();const h={};h.ExtractionDurationInMs=(Date.now()-a).toString();r.ULS.sendTraceTag(25268374,382,50,"{0}",h);return c}lRk(){const a=new Ua.a;var c=0;let h=0,v=!1;var B=new Kd.GraphIterator;B.set(this.qxm);B=Tl.a.zn(B.currentNode);const X=new Yc.a(0);for(;B.moveNext()&&2100>h&&25>c;){var ma=B.currentNode;if(sd.ParagraphReader.tb(ma)&&!sd.ParagraphReader.P8(ma)){!v&&
sd.ParagraphReader.IO(ma)&&(v=!0);let Pa=Fb.AParagraphNode.l1(ma.characterData);Pa=Pa.trim();if(0<Pa.length){const mb=this.I$k(ma);mb.ParagraphIndex=c;c++;h+=Pa.length;a.add(mb);this.QOn(X,sd.ParagraphReader.language(ma))}}}this.oLb=this.EXk(X);c={};c.documentHasList=v;r.ULS.sendTraceTag(25776736,382,50,"{0}",c);return a.toArray()}EXk(a){let c=-1,h=1033;for(let v of a.keys.toArray())v&&a.J(v)>c&&(c=a.J(v),h=v);return vi.a.af(h)}QOn(a,c){a.Ja(c)?a.Z(c,a.J(c)+1):a.Z(c,1)}I$k(a){const c=Fb.AParagraphNode.l1(a.characterData),
h=this.M$k(a),v=this.Pil(a);a=this.DPl(a);return xs.Adk(c,h,v,a)}M$k(a){const c=sd.ParagraphReader.Mm(a,Ed.a.bold,!1),h=sd.ParagraphReader.Mm(a,Ed.a.underline,!1);var v=sd.ParagraphReader.Mm(a,Ed.a.fontSize,fm.a.jI);const B=sd.ParagraphReader.Mm(a,Ed.a.font,fm.a.kF);var X=sd.ParagraphReader.zu(a);X=this.O4e(X);const ma=!!sd.ParagraphReader.Mm(a,zi.a.capitalization,0);a=(new iv.a).q0(a).value/20;v=za.construct(B,v);return Qa.construct(c,h,ma,v,X,a)}Pil(a){const c=new Ua.a;for(let B=0;B<a.la.length-
1;B++){var h=a.la.J(B),v=a.la.J(B+1);h.formatting&&(v=Fb.AParagraphNode.l1(a.characterData.substr(h.cp,v.cp-h.cp)),h=this.Qil(h.formatting),h=Da.construct(v,h),c.add(h))}return c.toArray()}Qil(a){const c=ua.FormattingReader.QEc(a,Ed.a.bold,!1),h=ua.FormattingReader.QEc(a,Ed.a.underline,!1);var v=ua.FormattingReader.QEc(a,Ed.a.fontSize,fm.a.jI);const B=ua.FormattingReader.QEc(a,Ed.a.font,fm.a.kF);v=za.construct(B,v);a=!!ua.FormattingReader.QEc(a,zi.a.capitalization,0);return Qa.construct(c,h,a,v,5,
0)}O4e(a){switch(a){case 1:return 0;case 3:return 1;case 2:return 2;case 6:return 3;case 0:return 5;default:return 4}}DPl(a){const c=new Kd.GraphIterator;c.set(a);c.La(11);return(a=c.mc(11))?Ta.OutlineElementReader.hk(a):!1}}Object(w.a)(wb,"DocumentContentExtractor",null,[575]);class Kb{get name(){return"WordEditor.DocumentContentExtractor"}init(){}dispose(){}yb(a){a.ha("WordEditor.DocumentContentExtractor.DocumentContentExtractor",()=>new wb(new qf.a(()=>S.App.Hk.Da.Jb.sc),l.AFrameworkApplication.Yr.Ry)).as("Box4.DocumentContentExtractor.IDocumentContentExtractor").singleInstance()}static main(){M.a.instance.Lb(new Kb)}}
Object(w.a)(Kb,"DocumentContentExtractorPackage",null,[1,2]);class Zb{}Zb.vf="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(w.a)(Zb,"EmbedDialogHtml",null,[]);class pc{constructor(a,c,h,v){this.a7b=a;this.RWa=c;this.SSd=h;this.value=v}}Object(w.a)(pc,"OptionInfo",null,[]);class Ec{constructor(a,c,h){this.eOf=a;this.b1b=c;this.RWa=h}}Object(w.a)(Ec,"SectionInfo",null,[]);
var ad=b(243);class Mc extends gg.a{constructor(a,c=!1){super(!1,!1,c);this.n5c=476;this.wMb=288;this.pge=798;this.Xqj=476;this.Wqj=288;this.EPc={};this.Lgb=[];this.lT=this.gRa=this.Job=this.ulb=this.hcd=this.ZPb=null;this.yic=l.AFrameworkApplication.xGc;this.mpb=a;this.Nue=Object(m.a)(this,this.Kvm,"optionClickHandler");this.qoc=Object(m.a)(this,this.Lvm,"optionKeyHandler");this.nbe=Object(m.a)(this,this.MQj,"arrowClickHandler");this.mKb=Object(m.a)(this,this.NQj,"arrowKeyHandler");this.Rhd=Object(m.a)(this,
this.oCn,"textAreaOnFocusHandler");this.Sjj=c;this.vf=Zb.vf;this.yc=0;this.jf="EmbedDialog"}get Vq(){return this.wMb}set Vq(a){this.wMb=a}pIi(a){const c={["id"]:this.jf,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:Af.a.oo(this.mpb,"wdPreview","1"),["initialEmbedUrl"]:this.yic,["getEmbedCode"]:Mc.cuh,
["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const h of Object.keys(a))c[h]=a[h];this.yc=1;this.Nd(1,CommonUIStrings.l_CopyAction);this.Nd(0,CommonUIStrings.l_Close);this.Tg(CommonUIStrings.l_Embed,null,c)}wac(){if(this.Sjj)this.pIi({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.ZPb=document.getElementById("embedpreviewpane");this.hcd=document.getElementById("embedoptionpane");this.ZPb.style.width=String.format("{0}px",this.Xqj);this.gRa=document.createElement("iframe");
this.gRa.className=Mc.Vqj;this.gRa.frameBorder="0";this.gRa.style.height=String.format("{0}px",this.Wqj);this.gRa.tabIndex=-1;this.ZPb.appendChild(this.Xrd(CommonUIStrings.l_Preview,this.gRa,Mc.SAg,Mc.RAg,Mc.SAg,!0));this.lT=document.createElement("textarea");this.lT.className=Mc.Xcj;Sys.UI.DomElement.addCssClass(this.lT,ad.a.yJe);this.lT.id=Mc.Ogg;H.a.sh||(this.lT.readOnly=!0);this.lT.rows=4;this.lT.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.lT.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;
this.lT.setAttribute(we.a.pba,String.format("{0} {1}",Mc.Ngg,Mc.Mgg));this.ZPb.appendChild(this.Xrd(CommonUIStrings.l_EmbedCode,this.lT,Mc.Ngg));Ld.a.addHandler(this.lT,"focus",this.Rhd);var a=document.createElement("span");a.className=Mc.Gej;a.innerText=CommonUIStrings.l_CopyText;a.id=Mc.Mgg;this.ZPb.appendChild(a);this.ulb=document.createElement("div");this.ulb.className=Mc.ccj;this.hcd.appendChild(this.Xrd(CommonUIStrings.l_Dimensions,this.ulb));this.Job=document.createElement("div");this.hcd.appendChild(this.Fgk(Mc.ryg,
this.Job));this.yc=0;this.Nd(1,CommonUIStrings.l_Close);this.U_f();this.IVi();H.a.sh||this.lT.focus()}}dispose(){if(this.EPc){var a=this.EPc;for(let c in a){const h=a[c];this.Uo.xb(Jb.a.click,h.a7b,this.Nue);this.jd.xb(Jb.a.ah,h.a7b,this.qoc);this.jd.xb(Jb.a.Hg,h.a7b,this.qoc)}this.qoc=this.Nue=this.EPc=null}if(this.Lgb){for(a=0;a<this.Lgb.length;++a)this.Uo.xb(Jb.a.click,this.Lgb[a].b1b,this.nbe),this.jd.xb(Jb.a.ah,this.Lgb[a].b1b,this.mKb),this.jd.xb(Jb.a.hs,this.Lgb[a].b1b,this.mKb),this.jd.xb(Jb.a.Hg,
this.Lgb[a].b1b,this.mKb);this.jd=this.nbe=this.Lgb=null}this.Rhd&&this.lT&&(Ld.a.removeHandler(this.lT,"focus",this.Rhd),this.Rhd=null);this.lT=this.gRa=this.Job=this.ulb=this.hcd=this.ZPb=null;super.dispose()}Mka(){super.Mka();this.pc.style.width=String.format("{0}px",this.pge);this.etb()}vNn(a,c){const h=Af.a.oo(this.yic,a,c);return this.yic!==h?(this.yic=h,this.mpb=Af.a.oo(this.mpb,a,c),!0):!1}U_f(){this.lT&&(this.lT.innerText=Mc.cuh(this.yic,this.n5c,this.wMb))}IVi(){this.gRa&&this.gRa.contentWindow.location.replace(Af.a.oo(this.mpb,
"wdPreview","1"))}e7d(a,c){this.vNn(a,c)&&(this.U_f(),this.IVi())}Xrd(a,c,h=null,v=null,B=null,X=!1){const ma=document.createElement("div");ma.className=Mc.Etj;v&&(ma.id=v);B&&ma.setAttribute(we.a.pba,B);X&&(ma.tabIndex=0);v=document.createElement("span");v.className=Mc.Ftj;v.innerText=a;h&&(v.id=h);ma.appendChild(v);ma.appendChild(c);return ma}Fgk(a,c){const h=this.Xrd(CommonUIStrings.l_Interaction,c),v=this.zj.createElement("div");v.className=Mc.a8i;v.id=Mc.g$f+a;v.setAttribute(we.a.tg,we.a.v_);
v.tabIndex=0;h.insertBefore(v,c);a=Fd.createClusteredImage(16,16,Mc.b8i,Mc.c8i,!0,"");v.appendChild(a);a=a.childNodes[0];a.className=Fd.getImageClass(Mc.dgg);a.title=CommonUIStrings.l_Expand;v.title=CommonUIStrings.l_Expand;c.style.visibility="hidden";c=new Ec(c,v,a);Array.add(this.Lgb,c);this.Uo.BC(Jb.a.click,v,this.nbe,c);this.jd.BC(Jb.a.ah,v,this.mKb,c);this.jd.BC(Jb.a.hs,v,this.mKb,c);this.jd.BC(Jb.a.Hg,v,this.mKb,c);return h}MQj(a){this.z0g(a);return!0}NQj(a){return this.cLc(a,Object(m.a)(this,
this.z0g,"changeArrowState"))}z0g(a){a=a.ho;"visible"===a.eOf.style.visibility?(a.eOf.style.visibility="hidden",a.RWa.className=Fd.getImageClass(Mc.dgg),a.RWa.title=CommonUIStrings.l_Expand,a.b1b.title=CommonUIStrings.l_Expand):(a.eOf.style.visibility="visible",a.RWa.className=Fd.getImageClass(Mc.Kyj),a.RWa.title=CommonUIStrings.l_Collapse,a.b1b.title=CommonUIStrings.l_Collapse)}t8g(a,c){const h=document.createElement("div");h.className=Mc.oyg;h.id=a+Mc.pyg;var v=this.zj.createElement("div");v.tabIndex=
0;v.className=Mc.wbg;v.id=a+Mc.cgc;v.setAttribute(we.a.tg,we.a.aLe);v.setAttribute(we.a.Bwa,we.a.$m);v.setAttribute(we.a.pba,a+Mc.SLb);h.appendChild(v);h.setAttribute(we.a.tg,we.a.Sx);var B=Fd.createClusteredImage(16,16,Mc.Dbg,Mc.Cbg,!0,"");v.appendChild(B);B=B.childNodes[0];B.id=a+Mc.qyg;B.className=Fd.getImageClass(Mc.jde);v=new pc(h,B,v,1);this.EPc[a]=v;this.Uo.BC(Jb.a.click,h,this.Nue,a);v=document.createElement("span");v.className=Mc.SLb;v.innerText=c;v.id=a+Mc.SLb;h.appendChild(v);this.jd.BC(Jb.a.ah,
h,this.qoc,a);this.jd.BC(Jb.a.Hg,h,this.qoc,a);return h}Kvm(a){this.Iei(a);return!0}Lvm(a){return this.cLc(a,Object(m.a)(this,this.Iei,"optionHandler"))}Iei(a){const c=this.EPc[a.ho.toString()];c.value?(c.value=0,c.RWa.className=Fd.getImageClass(Mc.GEe),c.SSd.setAttribute(we.a.Bwa,we.a.$H)):(c.value=1,c.RWa.className=Fd.getImageClass(Mc.jde),c.SSd.setAttribute(we.a.Bwa,we.a.$m));this.e7d(a.ho.toString(),c.value.toString())}oCn(){this.lT.select()}static cuh(a,c,h){if(!Mc.qte){const v=String.format('<a target="_blank" href="{0}">{1}</a>',
F.a.DGc("https://office.com"),CommonUIStrings.l_Office),B=String.format('<a target="_blank" href="{0}">{1}</a>',F.a.DGc("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Mc.qte=String.format(CommonUIStrings.l_NoFrames,v,B)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',F.a.DGc(a),c,h,Mc.qte)}}Mc.qte=null;Mc.jde="CheckboxChecked_16x16x32";Mc.GEe="CheckboxUnchecked_16x16x32";Mc.Kyj="OutlookSearchChevronUp_16x16x32";Mc.dgg="OutlookSearchChevronDown_16x16x32";
Mc.Dbg="CommentChecked";Mc.b8i="UpArrowServer";Mc.SLb="EmbedDescription";Mc.Etj="EmbedSectionHeader";Mc.Ftj="EmbedSectionName UIFontBold";Mc.Gej="EmbedCodeFooter";Mc.Cbg="EmbedOptionImage";Mc.Vqj="EmbedPreviewFrame";Mc.Xcj="EmbedCodeTextArea";Mc.oyg="EmbedOption";Mc.ccj="EmbedDimensionSection";Mc.c8i="EmbedArrowIcon";Mc.a8i="WACGlyph EmbedArrowHolder";Mc.wbg="EmbedCheckBoxHolder";Mc.pyg="Option";Mc.qyg="OptionImage";Mc.Ogg="EmbedCode";Mc.Ngg="EmbedCodeHeader";Mc.SAg="Preview";Mc.RAg="PreviewHeader";
Mc.ryg="Options";Mc.g$f="Arrow";Mc.cgc="Check";Mc.Mgg="EmbedCodeFooter";Object(w.a)(Mc,"EmbedDialog",gg.a,[]);class jd extends pc{constructor(a,c,h,v,B){super(a,c,h,v);this.$Wa=B}}Object(w.a)(jd,"OptionInputInfo",pc,[]);class md extends Mc{constructor(a,c){super(a,md.vP);this.d7=null;this.Rhc=[];this.Ngd=Object(m.a)(this,this.Ewn,"startOnOptionClickHandler");this.wRb=Object(m.a)(this,this.Fwn,"startOnOptionKeyHandler");this.xcd=Object(m.a)(this,this.Bqm,"onPageNumberChanged");this.zge=Object(m.a)(this,
this.Ymm,"onDimensionChanged");this.EE=c}wac(){if(md.vP){var a=md.RMm,c=[];c.push({["id"]:"wdPrint",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.EE.sji,["urlTransformFunctionOnChange"]:a},{["id"]:"wdEmbedCode",["checkboxInitialValue"]:!0,["checkboxLabel"]:this.EE.koi,["urlTransformFunctionOnChange"]:a},{["id"]:"wdStartOn",["checkboxInitialValue"]:!1,["checkboxLabel"]:this.EE.OKi,["urlTransformFunctionOnChange"]:a,["textInputProps"]:{["title"]:this.EE.PKi}});this.pIi({["dimensionsOptions"]:{["isMultipleChoice"]:!1,
["defaultWidth"]:this.n5c,["defaultHeight"]:this.wMb,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:this.EE.ZYi,["heightLabel"]:this.EE.BJh},["interactionOptions"]:c})}else super.wac(),this.xNg(this.EE.ZYi,"EmbedWidthInput",this.n5c),this.xNg(this.EE.BJh,"EmbedHeightInput",this.wMb),this.Job.appendChild(this.t8g("wdPrint",this.EE.sji)),this.Job.appendChild(this.t8g("wdEmbedCode",this.EE.koi)),this.kCj(this.EE.OKi),this.etb(),nc.FocusManager.rH()&&(a=nc.FocusManager.instance(),c=[document.getElementById(Mc.Ogg),
document.getElementById("EmbedWidthInput"),document.getElementById("EmbedHeightInput"),document.getElementById(Mc.g$f+Mc.ryg),document.getElementById("wdPrint"+Mc.cgc),document.getElementById("wdEmbedCode"+Mc.cgc),document.getElementById("wdStartOn"+Mc.cgc),document.getElementById("wdStartOnText"),document.getElementById(Sj.a.c1c),document.getElementById(Mc.RAg)],c=new Qe(c),a.gk().Sh=c,H.a.sh?this.AY(document.getElementById(Sj.a.c1c)):this.lT.select())}dispose(){if(!md.vP){if(this.Rhc){for(let a=
0;a<this.Rhc.length;++a)Ld.a.removeHandler(this.Rhc[a],"change",this.zge);this.Rhc=this.zge=null}this.xcd&&(Ld.a.removeHandler(this.d7.$Wa,"change",this.xcd),this.xcd=null);this.Ngd&&(this.Uo.xb(Jb.a.click,this.d7.a7b,this.Ngd),this.Ngd=null);this.wRb&&(this.jd.xb(Jb.a.ah,this.d7.a7b,this.wRb),this.jd.xb(Jb.a.Hg,this.d7.a7b,this.wRb),this.wRb=null);this.d7=null}super.dispose()}xNg(a,c,h){const v=document.createElement("label");v.className="EmbedInputPrefix";v.innerText=a;this.ulb.appendChild(v);a=
document.createElement("input");a.className=c;a.id=c;a.value=h.toString();a.type="text";a.setAttribute("data-lpignore","true");v.setAttribute("for",c);this.ulb.appendChild(a);this.Rhc.push(a);Ld.a.addHandler(a,"change",this.zge);this.ulb.appendChild(document.createElement("br"))}Ymm(a){"EmbedWidthInput"===a.target.id?this.n5c=this.fvd(a.target,375):this.wMb=this.fvd(a.target,250);this.U_f()}fvd(a,c){let h=parseInt(a.value);if(isNaN(h)||h<c)h=c;a.value=h.toString();return h}Bqm(a){a=this.fvd(a.target,
1);1===this.d7.value&&this.e7d("wdStartOn",a.toString())}kCj(a){const c=document.createElement("div");c.className=Mc.oyg+" EmbedInlineOption";c.id="wdStartOn"+Mc.pyg;const h=this.zj.createElement("div");h.tabIndex=0;h.className=Mc.wbg;h.id="wdStartOn"+Mc.cgc;h.setAttribute(we.a.tg,we.a.aLe);h.setAttribute(we.a.Bwa,we.a.$H);h.setAttribute(we.a.pba,"wdStartOn"+Mc.SLb);c.appendChild(h);c.setAttribute(we.a.tg,we.a.Sx);var v=Fd.createClusteredImage(16,16,Mc.Dbg,Mc.Cbg,!0,"");h.appendChild(v);v=v.childNodes[0];
v.id="wdStartOn"+Mc.qyg;v.className=Fd.getImageClass(Mc.GEe);const B=document.createElement("span");B.className=Mc.SLb;B.innerText=a;B.id="wdStartOn"+Mc.SLb;c.appendChild(B);this.Job.appendChild(c);a=document.createElement("input");a.className="EmbedPageNumberInput";a.id="wdStartOnText";a.type="text";a.title=this.EE.PKi;a.setAttribute("data-lpignore","true");this.Job.appendChild(a);Ld.a.addHandler(a,"change",this.xcd);this.d7=new jd(c,v,h,0,a);this.e7d("wdStartOn","1");this.Uo.Ea(Jb.a.click,c,this.Ngd);
this.jd.Ea(Jb.a.ah,c,this.wRb);this.jd.Ea(Jb.a.Hg,c,this.wRb)}Ewn(a){this.MKi(a);return!0}Fwn(a){return this.cLc(a,Object(m.a)(this,this.MKi,"startOnOptionHandler"))}MKi(){let a=1;this.d7.value?(this.d7.value=0,this.d7.RWa.className=Fd.getImageClass(Mc.GEe),this.d7.SSd.setAttribute(we.a.Bwa,we.a.$H)):(this.d7.value=1,this.d7.RWa.className=Fd.getImageClass(Mc.jde),a=this.fvd(this.d7.$Wa,1),this.d7.SSd.setAttribute(we.a.Bwa,we.a.$m));this.e7d("wdStartOn",a.toString())}static get vP(){return l.AFrameworkApplication.na.Ya.fA}static RMm(a,
c,h,v=null){if("wdPrint"===c||"wdEmbedCode"===c)return Af.a.oo(a,c,h?"1":"0");if("wdStartOn"===c){let B="1";h&&v&&(v=parseInt(v),!isNaN(v)&&1<=v&&(B=v.toString()));return Af.a.oo(a,c,h?B:"1")}return a}}Object(w.a)(md,"WordEmbedDialog",Mc,[]);class $d{constructor(a,c,h,v,B){this.qaa=null;this.ga=a;this.C4a=c;this.dN=h;this.EE=v;this.pma=B}eb(){this.ga.ka(this.dN,Kc.a.frame,Object(m.a)(this,this.Qqn,"showEmbedCode"));this.C4a.execute(Object(m.a)(this,this.Ryf,"onHostPostmessengerCreated"))}Ryf(a){r.ULS.shipAssertTag(4994850,
332,!!a);this.qaa=a;l.AFrameworkApplication.$Ja||(this.qaa.uu(E.a.i_g),this.qaa.pA(E.a.i_g,Object(m.a)(this,this.wac,"showEmbedDialog")))}wac(a){a=a.Values.HostEmbeddedViewUrl.toString();l.AFrameworkApplication.xGc=a;this.pma.ZZe=a;(new md(a,this.EE)).wac()}Qqn(a,c,h){if(2===h)if(l.AFrameworkApplication.xGc)(new md(this.pma.ZZe,this.EE)).wac();else return l.AFrameworkApplication.$k.UWa($d.$0i),l.AFrameworkApplication.c1f&&this.qaa.Qg(E.a.LGk,null)?32:l.AFrameworkApplication.na.T0(!0,l.AFrameworkApplication.C1e);
return 32}}$d.$0i=10381;Object(w.a)($d,"EmbedActor",null,[]);class Vd{}Object(w.a)(Vd,"WordEmbedDialogStrings",null,[]);var Yd=b(250);class de extends $d{constructor(a,c){super(a,c,ba.a.hTf,Object.assign(new Vd,{ZYi:WordEditorIntl.WordEditorStrings.l_Width,BJh:WordEditorIntl.WordEditorStrings.l_Height,sji:WordEditorIntl.WordEditorStrings.l_PrintOption,koi:WordEditorIntl.WordEditorStrings.l_ReembedOption,OKi:WordEditorIntl.WordEditorStrings.l_StartOnOption,PKi:WordEditorIntl.WordEditorStrings.l_StartPage}),
Yd.WoncaApp.instance)}}Object(w.a)(de,"EmbedActor",$d,[]);class se{constructor(){this.W=null}get name(){return"WordEditor.Embed"}yb(a){this.W=a;a.ha("WordEditor.Embed.EmbedActor",()=>new de(l.AFrameworkApplication.pa,a.za("Postmessage.IHostPostmessenger"))).singleInstance()}init(){this.W.resolve("WordEditor.Embed.EmbedActor").eb()}dispose(){}}Object(w.a)(se,"EmbedPackage",null,[1,2]);class We{constructor(a,c,h){this.mu=this.Pfa=this.Iga=null;this.bEa=0;this.hOb=this.XNb=this.LNb=this.pOb=this.OPa=
this.NPa=!1;this.Og=a;this.Lj=h}AF(a){return Eb.App.oa.Da.isEditingAllowed?""!==this.FDc(a.Ud):!1}DF(a){if(!this.AF(a))return!1;this.Scn(a);this.Tcn();this.Ucn();this.Iga=a.JF;this.mu=new Sys.UI.Point(0,0);r.ULS.sendTraceTag(22381023,322,50,"Image Crop drag started");return!0}GM(a){this.Pfa=a.JF;this.h_j();this.Og.JUi(this.mu.x,this.mu.y,this.pOb,this.LNb,this.XNb,this.hOb,!1);return!0}nx(){this.Og.JUi(this.mu.x,this.mu.y,this.pOb,this.LNb,this.XNb,this.hOb,!0);r.ULS.sendTraceTag(22381024,322,50,
"Image Crop drag succeeded")}zK(){this.Og.T1j();r.ULS.sendTraceTag(22381025,322,50,"Image Crop drag canceled")}Tcn(){this.hOb=this.XNb=this.LNb=this.pOb=!1;switch(this.bEa){case 1:this.pOb=!0;break;case 5:this.LNb=!0;break;case 3:this.hOb=!0;break;case 7:this.XNb=!0;break;case 0:this.XNb=this.pOb=!0;break;case 2:this.hOb=this.pOb=!0;break;case 6:this.XNb=this.LNb=!0;break;case 4:this.hOb=this.LNb=!0}}Ucn(){this.OPa=this.NPa=!1;switch(this.bEa){case 0:this.OPa=this.NPa=!0;break;case 1:case 2:this.OPa=
!0;break;case 7:case 6:this.NPa=!0}}FDc(a){var c=a.className;-1===c.indexOf("WACImageCropHandle")&&a.parentNode&&(c=a.parentNode.className);a=c.split(" ");for(c=0;c<a.length;c++){const h=a[c].toString();if(h.startsWith("WACImageCropHandle")&&"WACImageCropHandles"!==h)return h}return""}Scn(a){switch(this.FDc(a.Ud)){case "WACImageCropHandleNW":this.bEa=0;break;case "WACImageCropHandleN":this.bEa=1;break;case "WACImageCropHandleNE":this.bEa=2;break;case "WACImageCropHandleE":this.bEa=3;break;case "WACImageCropHandleSE":this.bEa=
4;break;case "WACImageCropHandleS":this.bEa=5;break;case "WACImageCropHandleSW":this.bEa=6;break;case "WACImageCropHandleW":this.bEa=7}}h_j(){var a=1;this.Lj.instance&&(a=this.Lj.instance.ei);const c=(this.Pfa.x-this.Iga.x)/a;a=(this.Pfa.y-this.Iga.y)/a;this.mu.x=this.NPa?-c:c;this.mu.y=this.OPa?-a:a}}Object(w.a)(We,"ImageCropDragAdapter",null,[159]);class Ze{constructor(a,c){this.ga=a;this.Lj=c}l3k(a){return new We(a,this.ga,this.Lj)}}Object(w.a)(Ze,"ImageCropDragAdapterFactory",null,[574]);var Zf=
b(225),uf=b(191),$f=b(426),Ig=b(639),Kf=b(91),Ef=b(70),Bh=b(408),Rg=b(865),Nj=b(528),vg=b(120),Yi=b(360),Sg=b(338),Gm=b(778),Rm=b(206),zj=b(87),Fe=b(22),Bi=b(280),Vo=b(374),Yk=b(129);class el{constructor(a,c,h,v,B,X,ma,Pa){this.SHc=this.$b=this.Lw=null;this.Do=a;this.Vd=c;this.Fb=h;this.kh=v;this.Tb=B;this.ya=X;this.vl=ma;this.LA=Pa}get qU(){return this.Lw||(this.Lw=xa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get qb(){return this.$b||(this.$b=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Kd(){return vg.PageReader.instance}ffn(a,
c,h){const v=this.Fb.Ob(15);v.Oa(c.node);this.vea(a,h);v.dispose()}efn(a,c,h){const v=this.Fb.Ob(15);v.Oa(c.node);this.WFb(a,h);v.dispose()}vea(a,c){a.setValue(Ed.a.imageAltText,c)}WFb(a,c){a.setValue(Yb.a.BX,c)}mfn(a,c){a.setValue(Ed.a.Mbb,c)}GBi(a,c){a.setValue(Yb.a.WU,c)}ifn(a,c,h,v,B){let X=0;var ma=0;({width:X,height:ma}=dd.ImageReader.bxb(a,X,ma));ma-=(c+h)/1E5*ma;this.XBa(a,X-(v+B)/1E5*X);this.WBa(a,ma);this.ZBi(a);a.setValue(Yb.a.TGc,c);a.setValue(Yb.a.QGc,h);a.setValue(Yb.a.RGc,v);a.setValue(Yb.a.SGc,
B)}mDi(a,c,h,v){const B=this.Fb.Ob(15);B.Oa(c.node);this.T_d(a,h,v);B.dispose()}T_d(a,c,h){this.XBa(a,c);this.WBa(a,h);this.ZBi(a);a.removeProperty(Uc.a.oUd);a.removeProperty(Uc.a.nUd)}XBa(a,c){a.setValue(Ed.a.A4,c);a.setValue(Uc.a.iza,-1)}WBa(a,c){a.setValue(Ed.a.Rja,c);a.setValue(Uc.a.hza,-1)}vB(a,c){a.setValue(Yb.a.sGc,c);a.setValue(Ed.a.xk,c);a.setValue(Ed.a.iV,c)}Ijn(a,c){a.setValue(Yb.a.ZHb,c)}Sbn(a,c){a.setValue(Yb.a.eMe,c)}Ljn(a){if(!dd.ImageReader.S8(a)&&a.Kk){var c=a.node;if(dd.ImageReader.GX(c)){const B=
this.Fb.Ob(15);B.Oa(a.node);a=Kd.GraphIterator.va(c);a.La(12);a=a.parentNode;var h=a.properties.pg(Yb.a.yp),v=c.properties.getValue(Yb.a.runId);c.ia(Yb.a.Ib,Vm.a.wP);const X=a.la;c.Ig.apply(c,[Yb.a.sGc,Ed.a.xk,Ed.a.iV,Yb.a.eMe,Yb.a.ZHb,Yb.a.U7a]);h=this.C6e(v,h,X);v=Oe.a.Sb(a,h);this.kh.FSe(c,v);(c=this.LA.bO(a,h,h+1))&&this.ya.setSelection(c);this.qU.fla(a,h,h+1);B.dispose()}}}ePf(a,c){if(a.properties.hasProperty(Yb.a.k3)){const h=a.properties.pg(Yb.a.k3);h.push(c);a.properties.setValue(Yb.a.k3,
Array.clone(h))}else a.properties.setValue(Yb.a.k3,[c])}b1d(a,c,h=0,v=!1){if(a.Kk){var B=this.Fb.Ob(15),X=a.node;B.Oa(X);if(dd.ImageReader.S8(a)){const Tb=new Nj.a;Tb.Zq(dd.ImageReader.Jk(a));var ma=X.la,Pa=this.uIk(a.cpBegin,ma);this.ZPj(a.cpEnd,ma,Pa)&&r.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");ma=ma.J(Pa).blob;Pa=ma.zd;var mb=X.properties.pg(Yb.a.yp);mb=this.pMm(mb);Pa=mb[Pa];mb=X.ia(Yb.a.Ib,Vm.a.wP);if(ma=Object(ha.a)(Rg.ImageBlobObject,ma))ma.tGb=!1;
this.Tb.replaceTextRange(a,"");ma&&(ma.tGb=!0);Tb.properties.setValue(Yb.a.runId,Pa);Tb.properties.setValue(Yb.a.Ib,mb);a=Kd.GraphIterator.va(X);a.La(12);a.Je(Tb,6);this.ePf(a.currentNode,Tb.anchor.node.id);X=Tb}h&&this.vB(X.properties,h);this.Sbn(X.properties,v);this.Ijn(X.properties,c);this.qU.x$b(X);(c=this.LA.fq(X))&&this.ya.setSelection(c);B.dispose()}}ONf(a,c){if(!(0>=c)){var h=Be.a.ym(c,0),v=dd.ImageReader.oC(a),B=dd.ImageReader.PD(a);v>h&&(B*=h/v,this.XBa(a,h),this.WBa(a,B),r.ULS.sendTraceTag(37843205,
322,50,"Scale image width and height to fit constraining width {0} : ",c))}}ZPj(a,c,h){const v=c.length;if(h>=v||!c.J(h).Ke)return!1;const B=new dm.a;for(;h<v;h++){const X=c.J(h);if(X.cp>a||!X.Ke)break;for(let ma=0;ma<X.Ke.length;ma++){if(B.contains(X.Ke.J(ma).Oj))return!0;B.add(X.Ke.J(ma).Oj)}}return!1}pMm(a){for(var c=0;c<a.length&&!a[c];)c++;if(c===a.length)for(var h=0;h<a.length;)a[h]=h+1,h++;else{var v=a[c];h=c-1;for(var B=v-1;0<=h;)a[h]=B,h--,B--;B=0;for(h=c+1;h<a.length;)(c=a[h])?c<v?(v=c+
B,a[h]=v):v=c:(B+=2,v++,a[h]=v),h++}return a}l2e(a,c){let h=0;for(;h<c.length&&!(a<c[h]);)h++;return h}C6e(a,c,h){let v=0;const B=this.l2e(a,c);let X=0;if(B===c.length)X=h.length-1;else for(;X<h.length;){c=h.J(X);if(c.formatting&&c.formatting.zd===B)break;X++}X<h.length?v=h.J(X).cp:r.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{["Index"]:X,["RunId"]:a,["CharacterPropertiesArrayLength"]:h.length});return v}uIk(a,c){let h=0;for(;h<c.length&&c.J(h).cp!==a;)h++;h===c.length&&
r.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{["Index"]:h,["CharacterPropertiesArrayLength"]:c.length});return h}ZBi(a){a.setValue(Ed.a.Zca,!0)}SUd(a,c,h,v=!1){c&&h?(c=Math.max(c,Ig.a.C5h),h=Math.max(h,Ig.a.C5h)):h=c=Ig.a.Abh;a.setValue(Ed.a.A4,Be.a.ym(c,0));a.setValue(Ed.a.Rja,Be.a.ym(h,1));a.setValue(Ed.a.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading);a.setValue(zi.a.CX,1);a.setValue(Yb.a.Wca,v)}NGd(){return null}Heh(a,c,h){let v=
null;c=({pCb:v}=this.Ieh(a,c,h)).returnValue;v&&a.view.Ma.setSelection(v);return c}Ieh(a,c,h){var v=null;if(!this.tha(a))return{returnValue:null,pCb:v};var B=a.view;const X=this.Fb.Ob(15,zb.a.gzb);X.Oa(B.sc);c||(c=new uh.DictionaryPropertySet);c.setValue(Uc.a.eyk,!0);let ma=B.Ma.If;var Pa=new Gm.a;if(!Gc.SelectionEditor.ke(ma)){if(2===l.AFrameworkApplication.pa.processAction(zb.a.Uha,2))return X.dispose(),{returnValue:null,pCb:v};ma=B.Ma.If}else if(ma.Kk&&sd.ParagraphReader.tb(ma.node)){kg.a.instance.J(4)&&
Eb.App.lc.$n&&Eb.App.lc.zp.aF(ma.node);B=ua.FormattingReader.zr(ma);if(!B)return X.dispose(),{returnValue:null,pCb:v};B.cache.hz&&(B=B.Ge(null),el.hh.EV(B));Pa.formatting=B.mi;Pa.languageId=ua.FormattingReader.language(B);kg.a.instance.J(10)&&(Pa.kDa=this.qb.um(ma.node))}if(!ma.Kk)return X.dispose(),{returnValue:null,pCb:v};if(!this.Agf(a.lm,c))return X.dispose(),this.SHc=null,{returnValue:null,pCb:v};a=this.SHc;this.SHc=null;1===a.location?(v=a.node,c=Vo.a.instance.gbf(v),ie.OutlineElementNavigator.Ir(c,
!1,!1)||(Rm.OutlineNavigator.lZd(c),this.Do.t_(c,!0,Pa)),ie.OutlineElementNavigator.Fd(c),Wf.TableReader.isTable(c)&&(Object(Ub.a)(Yk.a,c)||Object(Ub.a)(Yi.a,c)?(Pa=new Kd.GraphIterator,Pa.set(c.currentNode),Fe.moveToCellContent(Pa,0,0),c.set(Pa.currentNode)):Fe.moveToCellContent(c,0,0),Ta.OutlineElementReader.Gg(c)?ie.OutlineElementNavigator.Fd(c):c=Vo.a.instance.gbf(v)),v=sd.ParagraphReader.xu(c.currentNode)?this.LA.vd(c.currentNode,0):this.LA.fq(c.currentNode)):a.location||(Pa=a.blob.Xa.cp+1,v=
this.LA.bO(a.node,Pa-1,Pa));X.tAa(h,1);X.ql=zb.a.gzb;X.dispose();return{returnValue:a,pCb:v}}Agf(){return!1}tha(a){a.contextId===ic.a.view&&a.view.Cd&&a.view.Ma&&(a=a.view.Ma.If);if(!a)return el.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.noSelection}),!1;if(el.Sf.Kba(a))return el.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.dC}),!1;if(this.vl&&this.vl.instance&&this.vl.instance.JR(a))return el.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.externalSelection}),!1;if(this.Kd.D0)return el.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.compatMode}),!1;if(a.Kk)return zj.OutlineReader.yJd(a)?
(el.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.gSe}),!1):dd.ImageReader.zId(a)?(el.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.ZRe}),!1):Bi.c(a)?(el.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.$Re}),!1):Sg.a.ajf(a)?(el.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.YRe}),!1):sd.ParagraphReader.EO(a)||dd.ImageReader.xPh(a)?(el.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.$L}),!1):!0;if(Bh.a.lUh(a)){let c=!0;for(let h=0;h<a.length;++h){const v=a.getContext(h);if(!v.Kk)return!1;c&&!sd.ParagraphReader.EO(v)&&(c=!1)}return c?(el.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.$L}),!1):
!0}return!1}aXm(a,c){const h=this.Fb.Ob(7);h.Oa(a);if(12===a.type){c=c.Xa.cp;var v=sd.ParagraphReader.textLength(a);v=Oe.a.dM(c,c+1,c+1===v?!0:!1,a);this.Tb.replaceTextRange(v,"");a=Oe.a.Sb(a,c);this.ya.setSelection(ne.SelectionFactory.yn(a))}else this.Vd.b_a(a);h.dispose()}static get hh(){return el.nd||(el.nd=xa.a.instance.resolve("Box4.IFormattingEditor"))}static get Sf(){return li.a.instance}static get Kb(){return Ee.a.instance}}el.nd=null;Object(w.a)(el,"ImageEditor",null,[573]);class om{constructor(a,
c,h,v=0){this.node=a;this.blob=c;this.location=h;this.DR=v}}Object(w.a)(om,"InsertPictureResult",null,[]);var Wo=b(281),po=b(1016),Pn=b(106),hs=b(1015),yq=b(756),pm=b(1035);class Rq extends el{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee){super(a,c,h,v,B,X,ma,Pa);this.ebj="WACImageCropHandleNW WACImageCropHandleN WACImageCropHandleNE WACImageCropHandleW WACImageCropHandleE WACImageCropHandleSW WACImageCropHandleS WACImageCropHandleSE".split(" ");this.m3a="WACImageCropInnerHandleTop WACImageCropInnerHandleTopBorder WACImageCropInnerHandleBottom WACImageCropInnerHandleBottomBorder WACImageCropInnerHandleLeft WACImageCropInnerHandleLeftBorder WACImageCropInnerHandleRight WACImageCropInnerHandleRightBorder".split(" ");
this.AH=this.OEa=this.wua=null;this.Dfa=Array(8);this.f8c=this.Pua=null;this.PEa=!1;this.e8c=this.Xle=null;this.O3c=this.yPa=!1;this.lQ=this.kQ=this.jQ=this.mQ=this.gT=this.fT=this.eT=this.hT=this.JT=this.KT=0;this.Fmg=vd;X.aC(Object(m.a)(this,this.a1,"onSelectionChanged"));this.jd=Tc;this.EH=Zf.a.instance;this.ga=l.AFrameworkApplication.pa;this.Bb=Tb;this.rf=mb;this.Na=ee}j0d(a,c,h,v,B){a.hasProperty(Uc.a.UKa)&&a.removeProperty(Uc.a.UKa);const X=Array(4);X[0]=c;X[1]=h;X[2]=v;X[3]=B;a.setValue(Yb.a.oY,
X)}YVm(a){a.setValue(Yb.a.jza,0);a.setValue(Yb.a.Gfb,"");this.j0d(a,0,0,0,0)}$Pf(a,c,h,v,B){a.setValue(Yb.a.TGc,c);a.setValue(Yb.a.QGc,h);a.setValue(Yb.a.RGc,v);a.setValue(Yb.a.SGc,B)}l0d(a,c,h,v){a.setValue(Yb.a.kK,c);a.setValue(Yb.a.YFc,h);a.setValue(Yb.a.gGc,v);a.setValue(Uc.a.kK,-1)}MGd(a,c){a=a.node;const h=Kd.GraphIterator.va(a);if(sd.ParagraphReader.tb(a)&&sd.ParagraphReader.isEmpty(h)){var v=a.properties.pg(Yb.a.Ib);c.setValue(Yb.a.Ib,v);c.setValue(Yb.a.runId,1);v=new pm.a;c&&v.Zq(c);h.Je(v,
6);this.ePf(a,v.anchor.node.id);this.qU.x$b(v);return new om(v,null,3)}return null}NGd(a,c){var h=this.cAd();c&&h.Zq(c);h.setValue(Yb.a.imageType,1);let v=0;kg.a.instance.J(5)&&(v=uf.a.nE(),h.setValue(Yb.a.DR,v));const B=a.node.Mb.At(h,h.id);h=this.Tb.Lca(a,X=>new Rg.ImageBlobObject(X,B));Wo.GraphTransactionManager.instance.zyf(a.node);if(this.Bb.Bf){const X=new gf.GraphTransaction(15);X.Oa(a.node);this.rf.rla(a.node,a.cpBegin,a.cpBegin+1,1,null);X.dispose()}this.qU.lHa&&!c.ia(Yb.a.Wca,!1)&&this.qU.fla(a.node,
a.cpBegin,a.cpBegin+1);return new om(a.node,h,0,v)}Agf(a,c){if(!this.tha(a))return!1;const h=this.Fb.Ob(7);h.Oa(a.node);l.AFrameworkApplication.K.$("ContentAppIsEnabled")&&c.ia(Yb.a.yPh,!1)?this.SHc=this.MGd(a,c):this.SHc=this.NGd(a,c);h.dispose();return!0}QEb(a,c,h,v){if(!h.tb(a))return!1;h=this.Fb.Ob(7,zb.a.Hnl);h.Oa(a);var B=a.properties.ia(Ed.a.pl,[]);B.push(0);for(let X of B)if((B=v.q5e(a,X))&&5===B.nh&&B.id.equals(c))return this.Tb.replaceTextRange(Oe.a.createTextRange(a,X,X+1),""),h.dispose(),
!0;h.dispose();r.ULS.sendTraceTag(588817112,3001,10,"RemoveInlineImageFromParagraph: Failed to remove image.");return!1}mVm(a,c,h,v){if(!dd.ImageReader.GX(a))return!1;c.set(a);c.La(12);const B=c.yo(12);if(!B)return r.ULS.sendTraceTag(588817114,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image because unable to acquire containing graph node."),!1;if(h.OJc(B))return r.ULS.sendTraceTag(588817115,3001,10,"RemoveAnchoredImageFromParagraph: Failed to remove anchored image."),!1;
v(a);h=this.Fb.Ob(7);h.Oa(a);c.xf();h.dispose();return!0}Q_m(a,c,h,v){return dd.ImageReader.nXa(a)?this.E_m(a,h):dd.ImageReader.S8(a)?this.S_m(a,c,h,v):!1}S_m(a,c,h,v){const B=this.cAd();h&&B.Zq(h);h=0;kg.a.instance.J(5)&&(h=uf.a.nE(),B.setValue(Yb.a.DR,h));h=a.node.Mb;a=a.node;v=v.JCc(a,5);for(let X of v)if(X.id.equals(c)){this.Tb.replaceTextRange(Oe.a.createTextRange(a,X.Xa.cp,X.Xa.cp+1),"");const ma=h.At(B,B.id);c=Oe.a.Sb(a,X.Xa.cp);this.Tb.Lca(c,Pa=>new Rg.ImageBlobObject(Pa,ma));return!0}return!1}E_m(a,
c){if(!dd.ImageReader.nXa(a))return!1;kg.a.instance.J(5)&&c.setValue(Yb.a.DR,uf.a.nE());a=a.node;var h=a.anchor.node.id;a=Kd.GraphIterator.va(a);a.La(12);const v=a.parentNode;let B;v.properties.hasProperty(Yb.a.k3)?(B=v.properties.pg(Yb.a.k3),h=N.a.indexOf(B,h),-1!==h&&Array.removeAt(B,h)):B=[];v.properties.setValue(Yb.a.k3,Array.clone(B));a.xf();h=this.Na&&this.Na.isFeatureEnabled(78)?new po.a:new Nj.a;h.Zq(c);a.Je(h,6);this.ePf(v,h.anchor.node.id);return!0}wYc(a,c){this.PEa?this.r_e():this.hwn(a,
c)}ofn(a,c){a.setValue(Uc.a.kK,c)}q3k(a){let c=null,h=null;if(!a)return r.ULS.sendTraceTag(22381026,322,15,"Unable to obtain Image Element Container for Crop due to null Context."),{returnValue:null,view:c,jh:h};if(!ec.InteractiveViewManager.instance.rc)return r.ULS.sendTraceTag(22381027,322,15,"Unable to obtain Image Element Container for Crop due to null SelectionView."),{returnValue:null,view:c,jh:h};const v=a.node;if(!v)return r.ULS.sendTraceTag(22381056,322,15,"Unable to obtain Image Element Container for Crop due to null Context Node."),
{returnValue:null,view:c,jh:h};h=v.Mb;const B=v.Sd(ec.InteractiveViewManager.instance.rc.gb);if(!B)return r.ULS.sendTraceTag(23961792,322,15,"Unable to obtain Image Element Container for Crop due to null Html View Element."),{returnValue:null,view:c,jh:h};c=B.Fe;if(a.Kk&&dd.ImageReader.S8(a)){a=dd.ImageReader.bJa(a);if(!a)return r.ULS.sendTraceTag(22381057,322,15,"Unable to obtain Image Element Container for Crop due to null Blob from Context."),{returnValue:null,view:c,jh:h};a=a.dWa(c);if(!a)return r.ULS.sendTraceTag(22381058,
322,15,"Unable to obtain Image Element Container for Crop due to null Presenter from Blob."),{returnValue:null,view:c,jh:h};a=a.element}else if(dd.ImageReader.ix(v))a=B.htmlElement;else return r.ULS.sendTraceTag(22381059,322,15,"Unable to obtain Image Element Container for Crop due to context not being Image blob nor Image node."),{returnValue:null,view:c,jh:h};return{returnValue:a,view:c,jh:h}}$kn(a){for(let v=0;v<this.Dfa.length;v++){this.Dfa[v]=a.ij(ri.a.span);this.Dfa[v].className="WACImageCropHandles "+
this.ebj[v];if(2>=v){var c=a.ij(ri.a.span);c.className=this.m3a[0];var h=a.ij(ri.a.span);h.className=this.m3a[1];this.Dfa[v].appendChild(c);this.Dfa[v].appendChild(h)}else 4<v&&(c=a.ij(ri.a.span),c.className=this.m3a[2],h=a.ij(ri.a.span),h.className=this.m3a[3],this.Dfa[v].appendChild(c),this.Dfa[v].appendChild(h));if(!v||3===v||5===v)c=a.ij(ri.a.span),c.className=this.m3a[4],h=a.ij(ri.a.span),h.className=this.m3a[5],this.Dfa[v].appendChild(c),this.Dfa[v].appendChild(h);else if(2===v||4===v||7===
v)c=a.ij(ri.a.span),c.className=this.m3a[6],h=a.ij(ri.a.span),h.className=this.m3a[7],this.Dfa[v].appendChild(c),this.Dfa[v].appendChild(h)}}hwn(a,c){r.ULS.sendTraceTag(22381060,322,50,"Starting Image Cropping Mode.");if(this.PEa)r.ULS.sendTraceTag(22381061,322,100,"Attempted to start Crop Mode when it was already On.");else{var h=null,v=null;if((this.Pua=({view:h,jh:v}=this.q3k(c)).returnValue)&&h){this.Pua.classList.add("ImageCropMode");this.wua=h.ij(ri.a.div);this.wua.className="WACImageCropMode";
this.OEa=h.ij(ri.a.SWa);this.OEa.className="WACImageCropBase";this.AH=h.ij(ri.a.span);this.AH.className="WACImageCropSrcRect";this.$kn(h);this.wua.appendChild(this.AH);for(h=0;h<this.Dfa.length;h++)this.AH.appendChild(this.Dfa[h]);this.wua.appendChild(this.OEa);this.OEa.style.visibility="";this.OEa.style.display="";this.Pua.appendChild(this.wua);this.FCm(a);v=dd.ImageReader.Hya(a,v);h=dd.ImageReader.J1(a,Uc.a.Lda,null);this.OEa.src=h?h:dd.ImageReader.cxb(v);this.Fmg&&this.Fmg.execute(B=>{this.f8c||
(this.f8c=B.l3k(this))});this.yPa||(this.EH.HF(this.Pua,this.f8c),this.yPa=!0);this.jd&&this.jd.Ea(Jb.a.tG,ec.InteractiveViewManager.instance.editingView.editingElement,Object(m.a)(this,this.Tra,"onBeforeKeyDown"));this.PEa=!0;this.Xle=a;this.e8c=c;this.O3c=!1;a=new gf.GraphTransaction(4);a.Oa(this.e8c.node);this.Xle.setValue(Uc.a.$qa,this.PEa);a.dispose()}else r.ULS.sendTraceTag(22381062,322,15,"Unable to start Crop Mode because unable to obtain Image Element Container from given Context.")}}FCm(a){const c=
Be.a.Re(dd.ImageReader.oC(a),0),h=Be.a.Re(dd.ImageReader.PD(a),1),v=Math.max(dd.ImageReader.Qia(a),0),B=Math.max(dd.ImageReader.Nia(a),0),X=Math.max(dd.ImageReader.Oia(a),0),ma=Math.max(dd.ImageReader.Pia(a),0);this.KT=1E5*c/(1E5-(X+ma));this.JT=1E5*h/(1E5-(v+B));this.hT=Math.floor(v*this.JT/1E5);this.eT=Math.floor(B*this.JT/1E5);this.fT=Math.floor(X*this.KT/1E5);this.gT=Math.floor(ma*this.KT/1E5);this.AH.style.top=this.hT+"px";this.AH.style.bottom=this.eT+"px";this.AH.style.left=this.fT+"px";this.AH.style.right=
this.gT+"px";this.OEa.style.width=this.KT+"px";this.OEa.style.height=this.JT+"px";dd.ImageReader.py(a)&&(this.wua.style.width=this.KT+"px",this.wua.style.height=this.JT+"px");this.mQ=this.hT;this.jQ=this.eT;this.kQ=this.fT;this.lQ=this.gT}r_e(a=!1){r.ULS.sendTraceTag(22381063,322,50,"Ending Image Cropping Mode.");this.PEa?(a||this.X$j(),this.OEa?ye.a.Ux(this.OEa):r.ULS.sendTraceTag(23961793,322,15,"Unable to clear imageCropBase dom element because it was already null."),this.Pua?(this.wua?this.wua.parentNode===
this.Pua?this.Pua.removeChild(this.wua):r.ULS.sendTraceTag(24174606,322,15,"Unable to Remove child divImageCropMode from imageElementContainer, because it was no longer a child of it."):r.ULS.sendTraceTag(23961794,322,15,"Unable to clear Crop mode div because it was already null."),this.Pua.classList.remove("ImageCropMode"),this.PEa=!1,a=new gf.GraphTransaction(4),a.Oa(this.e8c.node),this.Xle.setValue(Uc.a.$qa,this.PEa),a.dispose(),this.yPa&&(this.EH.VF(this.Pua,this.f8c),this.yPa=!1),this.jd&&this.jd.xb(Jb.a.tG,
ec.InteractiveViewManager.instance.editingView.editingElement,Object(m.a)(this,this.Tra,"onBeforeKeyDown")),this.Pua=this.wua=null):r.ULS.sendTraceTag(22381065,322,15,"Unable to finish Image Crop clean-up because unable to obtain Image Element Container from Context.")):r.ULS.sendTraceTag(22381064,322,100,"Attempted to End Image Crop Mode when it was already off.")}a1(){this.PEa&&this.r_e()}Tra(a){this.PEa&&a.Sa.keyCode!==vb.a.Nq&&this.r_e(!0);return!1}JUi(a,c,h,v,B,X,ma){if(h){h=Math.max(this.hT-
c,0);let Pa=Math.floor(this.JT)-this.eT-h;5<=Pa?(this.mQ=h,this.jQ=this.eT):5>Pa&&0<=Pa||0>Pa&&!this.eT?(this.mQ=h-(5-Pa),this.jQ=this.eT):0>Pa&&5>=Math.abs(Pa)?(this.mQ=Math.floor(this.JT)-this.eT,this.jQ=Math.max(this.eT-(h-(this.JT-this.eT))-(5-Math.abs(Pa)),0)):(this.mQ=Math.floor(this.JT)-this.eT,this.jQ=Math.max(this.eT-(h-(this.JT-this.eT)),0));this.AH.style.top=this.mQ+"px";this.AH.style.bottom=this.jQ+"px";ma&&(this.hT=this.mQ,this.eT=this.jQ)}v&&(c=Math.max(this.eT-c,0),v=Math.floor(this.JT)-
this.hT-c,5<=v?(this.jQ=c,this.mQ=this.hT):5>v&&0<=v||0>v&&!this.hT?(this.jQ=c-(5-v),this.mQ=this.hT):0>v&&5>=Math.abs(v)?(this.jQ=Math.floor(this.JT)-this.hT,this.mQ=Math.max(this.hT-(c-(this.JT-this.hT))-(5-Math.abs(v)),0)):(this.jQ=Math.floor(this.JT)-this.hT,this.mQ=Math.max(this.hT-(c-(this.JT-this.hT)),0)),this.AH.style.top=this.mQ+"px",this.AH.style.bottom=this.jQ+"px",ma&&(this.hT=this.mQ,this.eT=this.jQ));B&&(B=Math.max(this.fT-a,0),c=Math.floor(this.KT)-this.gT-B,5<=c?(this.kQ=B,this.lQ=
this.gT):5>c&&0<=c||0>c&&!this.gT?(this.kQ=B-(5-c),this.lQ=this.gT):0>c&&5>=Math.abs(c)?(this.kQ=Math.floor(this.KT)-this.gT,this.lQ=Math.max(this.gT-(B-(this.KT-this.gT))-(5-Math.abs(c)),0)):(this.kQ=Math.floor(this.KT)-this.gT,this.lQ=Math.max(this.gT-(B-(this.KT-this.gT)),0)),this.AH.style.left=this.kQ+"px",this.AH.style.right=this.lQ+"px",ma&&(this.fT=this.kQ,this.gT=this.lQ));X&&(a=Math.max(this.gT-a,0),X=Math.floor(this.KT)-this.fT-a,5<=X?(this.lQ=a,this.kQ=this.fT):5>X&&0<=X||0>X&&!this.fT?
(this.lQ=a-(5-X),this.kQ=this.fT):0>X&&5>=Math.abs(X)?(this.lQ=Math.floor(this.KT)-this.fT,this.kQ=Math.max(this.fT-(a-(this.KT-this.fT))-(5-Math.abs(X)),0)):(this.lQ=Math.floor(this.KT)-this.fT,this.kQ=Math.max(this.fT-(a-(this.KT-this.fT)),0)),this.AH.style.left=this.kQ+"px",this.AH.style.right=this.lQ+"px",ma&&(this.fT=this.kQ,this.gT=this.lQ));ma&&(this.O3c=!0,Eb.App.oa.updateCommandUI())}T1j(){this.mQ=this.hT;this.jQ=this.eT;this.kQ=this.fT;this.lQ=this.gT;this.AH.style.top=this.mQ+"px";this.AH.style.bottom=
this.jQ+"px";this.AH.style.left=this.kQ+"px";this.AH.style.right=this.lQ+"px"}X$j(){if(this.O3c){r.ULS.sendTraceTag(22381066,322,50,"Commiting new Image Cropping Properties.");var a=Math.floor(1E5*this.hT/this.JT),c=Math.floor(1E5*this.eT/this.JT),h=Math.floor(1E5*this.fT/this.KT),v=Math.floor(1E5*this.gT/this.KT),B=new uh.DictionaryPropertySet;B.setValue(Uc.a.Ubb,a);B.setValue(Uc.a.Rbb,c);B.setValue(Uc.a.Sbb,h);B.setValue(Uc.a.Tbb,v);this.ga.Le(this.e8c,ba.a.wLh,2,!1,null,B)}else r.ULS.sendTraceTag(23070481,
322,50,"No New Cropping Properties To Commit.")}$qa(){return this.PEa}JXk(){return{top:this.mQ,bottom:this.jQ,left:this.kQ,right:this.lQ}}yOn(a,c){if(0>a)r.ULS.sendTraceTag(22552777,322,15,"Unexpected negative value for new Crop properties.");else{switch(c){case 0:this.hT=this.mQ=Math.min(Math.floor(this.JT)-this.jQ-5,a);this.AH.style.top=this.mQ+"px";break;case 1:this.eT=this.jQ=Math.min(Math.floor(this.JT)-this.mQ-5,a);this.AH.style.bottom=this.jQ+"px";break;case 2:this.fT=this.kQ=Math.min(Math.floor(this.KT)-
this.lQ-5,a);this.AH.style.left=this.kQ+"px";break;case 3:this.gT=this.lQ=Math.min(Math.floor(this.KT)-this.kQ-5,a),this.AH.style.right=this.lQ+"px"}this.O3c=!0}}cAd(){if(!this.Na)return new Pn.a;const a=this.Na.isFeatureEnabled(208),c=this.Na.isFeatureEnabled(78);return a?c?new hs.a:new yq.a:new Pn.a}}Object(w.a)(Rq,"ImageEditor",el,[572,573]);class zq{constructor(){this.W=null}get name(){return"WordEditor.ImageEditors"}yb(a){this.W=a;this.W.ha("WordEditor.ImageEditors.ImageCropDragAdapterFactory",
()=>new Ze(l.AFrameworkApplication.pa,xa.a.instance.za("Common.IZoomManager"))).as("WordEditor.IImageCropDragAdapterFactory").singleInstance();this.W.ha("WordEditor.ImageEditors.ImageEditor",()=>new Rq(a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.ISelectionManager"),a.za("Box4.IExternalSelectionManager"),a.resolve("Box4.ISelectionFactory"),
a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.CatchUpActivity.IChangeIdEditor"),qc.KeyInputManager.instance,a.za("WordEditor.IImageCropDragAdapterFactory"),a.ra("Box4.IFeatureHelper"))).as("WordEditor.IImageEditor").as("Box4.Images.IImageEditor").singleInstance()}init(){this.W.resolve("WordEditor.IImageCropDragAdapterFactory")}dispose(){}static main(){M.a.instance.Lb(new zq)}}Object(w.a)(zq,"WordEditorImageEditorsPackage",
null,[1,2]);class Hu{}Object(w.a)(Hu,"FolderContentEditor",null,[1239]);class Lr{}Object(w.a)(Lr,"PageEditor",null,[1139]);var jn=b(172);class rr extends Lr{constructor(){super()}get Ag(){return jn.PageNavigator.instance}}Object(w.a)(rr,"PageEditor",Lr,[]);class cj{get name(){return"WordEditor.NotebookLevelEditors"}yb(a){a.ha("Box4.NotebookLevelEditors.FolderContentEditor",()=>new Hu).as("Box4.Folder.IFolderContentEditor").singleInstance();a.ha("WordEditor.NotebookLevelEditors.PageEditor",()=>new rr).as("Box4.Pages.IPageEditor").singleInstance()}init(){}dispose(){}static main(){M.a.instance.Lb(new cj)}}
Object(w.a)(cj,"WordEditorNotebookLevelEditorsPackage",null,[1,2]);class is{get UDb(){return l.AFrameworkApplication.Pfb}Aba(){r.ULS.sendTraceTag(37034014,342,50,"User clicked on the Privacy statement.");Ve.a.Ql(this.UDb,"_blank",void 0,"SendUsYourFileDialog.PrivacyLink");return!0}}Object(w.a)(is,"PrivacyLinkHandler",null,[273]);class Sq{constructor(a,c){this.iue=null;this.Stj=a;this.Rtj=c}showDialog(a){this.iue=a;this.Rtj.create().Tg(Object(m.a)(this,this.dpl,"handleDialog"))}dpl(a){1===a&&this.Stj.tzi();
this.iue();this.iue.prototype}}Object(w.a)(Sq,"SendUsYourFileController",null,[257]);class fl extends oe.StandardDialog{constructor(a,c,h){super();this.eQb=null;this.Se=a;this.tpc=c;this.EE=h}Tg(a){this.yc=1;this.Nd(1,this.EE.send);this.Nd(0,this.EE.ihm);r.ULS.shipAssertTag(37034013,342,!this.eQb,"privacy anchor should be null before initializing it.");const c=this.Rtk();this.feb(this.EE.hNj,null,"CancelRequest_32x32x32",null,a,c);this.n5(this.hi(fl.zzi))}Rtk(){const a=document.createElement("span");
a.innerText=this.EE.tFm;const c=document.createElement("span");c.innerText=this.EE.$Bn;c.style.fontWeight=this.EE.kTn;const h=document.createElement("span");h.innerText=this.EE.Gan;const v=this.Zbk(),B=document.createElement("span");B.id=this.hi(fl.zzi);B.appendChild(a);B.appendChild(document.createElement("br"));B.appendChild(document.createElement("br"));B.appendChild(c);B.appendChild(document.createElement("br"));B.appendChild(h);B.appendChild(document.createElement("br"));B.appendChild(document.createElement("br"));
B.appendChild(document.createElement("br"));B.appendChild(v);return B}Zbk(){const a=document.createElement("span"),c=document.createElement("a");c.innerText=this.EE.dFm;c.href=this.tpc.UDb||"";a.appendChild(c);this.eQb=c;this.Se.Ea(Jb.a.click,this.eQb,Object(m.a)(this.tpc,this.tpc.Aba,"clickHandler"));return a}dispose(){this.eQb&&(this.Se.xb(Jb.a.click,this.eQb,Object(m.a)(this.tpc,this.tpc.Aba,"clickHandler")),this.eQb=null);super.dispose()}}fl.zzi="sendUsYourFileId";Object(w.a)(fl,"SendUsYourFileDialog",
oe.StandardDialog,[272]);class ym{create(){return xa.a.instance.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialog")}}Object(w.a)(ym,"Factory",null,[271]);var Wp=b(548);class Aq extends Wp.a{constructor(){super();this.FileId=null}ol(){return 38}static construct(a){const c=new Aq;c.FileId=a;return c}}Object(w.a)(Aq,"CreateSendUsYourFileRequest",Wp.a,[]);var Kp=b(955);class jv{constructor(a,c,h){this.T$=a;this.eQ=c;this.Tlj=h}tzi(a=!1){if(this.eQ){const c=Aq.construct(this.eQ()),h=new Kp.a;h.Kq=
c;h.status=1;h.GF="BootErrorReport";a=a?this.T$(null):this.T$(v=>{this.ITc(h,v)});a.WH(h);a.DU();this.Tlj()}}ITc(a){5===a.statusCode&&this.tzi(!0)}}Object(w.a)(jv,"SendUsYourFileManager",null,[258]);class Mr{constructor(a,c){this.W=null;this.EE=a;this.eQ=c}yb(a){this.W=a;this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings",()=>this.EE).singleInstance();this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileDialog",()=>new fl(oi.a.instance,new is,this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileDialogStrings")));
this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileManager",()=>new jv(c=>this.zia(0,c),this.eQ,()=>{r.ULS.sendTraceTag(42022664,342,50,"send us your file request is now sent.")}));this.W.ha("Wac.Common.SendUsYourFile.ISendUsYourFileController",()=>{const c=new ym;return new Sq(this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileManager"),c)}).singleInstance()}init(){this.W.resolve("Wac.Common.SendUsYourFile.ISendUsYourFileController")}dispose(){}}Object(w.a)(Mr,"SendUsYourFilePackageManager",
null,[]);var Iu=b(524),Iv=b(901),sr;(function(a){a[a.none=0]="none";a[a.oneNote=1]="oneNote";a[a.word=2]="word";a[a.wordViewer=3]="wordViewer";a[a.powerPoint=4]="powerPoint"})(sr||(sr={}));Object(w.b)("AppMode",sr);class Mf{get hNj(){return CommonUIStrings.l_AppTitle}get send(){return CommonUIStrings.l_Send}get ihm(){return CommonUIStrings.l_NoThanks}get tFm(){return WordEditorIntl.WordEditorStrings.L_ProblemOpeningDocument}get $Bn(){return WoncaIntl.WoncaStrings.l_SaveErrorReportTitle}get kTn(){return CommonUIStrings.l_UserInterfaceFontWeightBold}get Gan(){return WordEditorIntl.WordEditorStrings.L_SendUsYourFileDialogText}get dFm(){return CommonUIStrings.l_PrivacyStatement}}
Object(w.a)(Mf,"WordEditorSendUsYourFileDialogStrings",null,["__INTERFACE__@1js/wac-common:ISendUsYourFileDialogStrings"]);class ij extends Mr{constructor(){super(new Mf,()=>l.AFrameworkApplication.rootQuerySignature)}zia(a,c){return new Iv.a(a,c,"SendUsYourFile.ashx",sr.word,Eb.App.webServiceBase,void 0,void 0,Iu.a.amIAlone,Iu.a.Qui,Iu.a.Sti)}get name(){return"WordEditor.SendUsYourFile"}static main(){M.a.instance.Lb(new ij)}}Object(w.a)(ij,"PackageManager",Mr,["__INTERFACE__@1js/msoserviceplatform:IPackage",
"__INTERFACE__@1js/msoserviceplatform:IContainerConfiguration"]);var gl=b(644),Ce=b(605),Nh=b(411);class Lk extends Nh.a{constructor(){super();this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(w.a)(Lk,"IconGalleryButtonProps",Nh.a,[]);var Aj=b(117),Tf=b(29),op=b(158),kn=b(73),Uj=b(777),Og=b(167),Xp=b(1520);class Zm{constructor(a,c,h,v,B,X){this.Poh=a;this.gallerySectionId=c;this.WEk=h;this.vLj=v;this.commandId=B;this.queryCommandId=X}}Object(w.a)(Zm,
"BorderStyleMenuPropsArguments",null,[]);class Qn{constructor(a,c,h,v,B,X,ma){this.FUb=a;this.ILi=c;this.width=h;this.Q8h=v;this.height=B;this.k_h=X;this.altText=ma}}Object(w.a)(Qn,"TableBorderStyleProperties",null,[]);class Ff{constructor(){this.JWg=[new Qn(Ff.BJi,"","2",1,8,0,"Solid Line"),new Qn(Ff.Sah,"5,3","1",1,8,0,"Dashed Line"),new Qn(Ff.Hfh,"1,1","1",1,8,0,"Dotted Line"),new Qn(Ff.Jfh,"","1",2,8,3,"Double Line")];this.KWg=[new Qn(Ff.RWg,"","1",1,8,0,"0.25pt"),new Qn(Ff.OWg,"","1",1,8,0,"0.5pt"),
new Qn(Ff.UWg,"","2",1,8,0,"0.75pt"),new Qn(Ff.PWg,"","2",1,8,0,"1pt"),new Qn(Ff.NWg,"","3",1,8,0,"1.5pt"),new Qn(Ff.VWg,"","4",1,8,0,"2.25pt"),new Qn(Ff.TWg,"","4",1,8,0,"3pt"),new Qn(Ff.MWg,"","5",1,8,0,"4.5pt"),new Qn(Ff.SWg,"","6",1,8,0,"6pt")]}initialize(){this.xSm()}bPk(){const a=new Zm("Line Style gallery","DefaultLineStyleOptions","LineStyleOptionsGallery",this.JWg,zb.a.khb,zb.a.qHf);return this.hph(a)}cPk(){const a=new Zm("Line Weight gallery","DefaultLineWeightOptions","LineWeightOptionsGallery",
this.KWg,zb.a.lhb,zb.a.rHf);return this.hph(a)}Sqh(a){switch(a){case Ff.BJi:return Og.a.GUb;case Ff.Sah:return Og.a.w8a;case Ff.Hfh:return Og.a.jvc;case Ff.Jfh:return Og.a.E_;default:return Og.a.Toa}}Tqh(a){switch(a){case Ff.RWg:return Og.a.QWg;case Ff.OWg:return Og.a.KMe;case Ff.UWg:return Og.a.DUb;case Ff.PWg:return Og.a.v8a;case Ff.NWg:return Og.a.nha;case Ff.VWg:return Og.a.Hwa;case Ff.TWg:return Og.a.vba;case Ff.MWg:return Og.a.kTa;case Ff.SWg:return Og.a.Gwa;default:return Og.a.uD}}hph(a){const c=
new Ah.a,h=new Hg.a,v=Object.assign(new Ce.a,{Id:a.Poh,ExternalId:a.gallerySectionId,ExternalGalleryId:a.WEk,Type:4,Width:1,GalleryItems:[]});for(let X of a.vLj){var B={};const ma={};ma.width=Ff.YYl;ma.height=Ff.XYl;B.root=ma;B=Object.assign(new Lk,{Id:X.FUb,ExternalId:String.format("{0}_GalleryButton",X.FUb),Icon:X.FUb,Command:a.commandId.toString(),QueryCommand:a.queryCommandId.toString(),MenuItemId:X.FUb,FullIconStyle:B,ShouldSetTitle:"true",Alt:X.altText});v.GalleryItems.push(B)}h.ControlList=
[];c.MenuSectionList=[];h.ControlList.push(v);c.MenuSectionList.push(h);c.UpdateDynamically=!0;return c}xSm(){const a={};for(let c of this.JWg)a[c.FUb]=appChrome.buildBorderStyleIcon(c.ILi,c.width,c.Q8h,c.height,c.k_h);for(let c of this.KWg)a[c.FUb]=appChrome.buildBorderStyleIcon(c.ILi,c.width,c.Q8h,c.height,c.k_h);appChrome.api.registerIconProvider(()=>a)}acn(a,c,h){if(!a)return r.ULS.sendTraceTag(578073118,306,15,"table border context should not be null."),!1;if(a.contextId!==ic.a.z1)return r.ULS.sendTraceTag(577910617,
306,15,"Context should be of type table border. Getting context of type: {0}",a.contextId),!1;switch(a.border){case 2:this.EY(Aj.a.tR(a),a.node,5,h,c);break;case 0:this.EY(Aj.a.tR(a),a.node,3,h,c);break;case 1:this.EY(Aj.a.tR(a),a.node,4,h,c);break;case 3:this.EY(Aj.a.tR(a),a.node,0,h,c);break;case 7:this.EY(Aj.a.tR(a),a.node,1,h,c);break;case 8:this.EY(Aj.a.tR(a),a.node,2,h,c);break;case 6:this.EY(Aj.a.tR(a),a.node,1,h,c);this.EY(Aj.a.tR(a),a.node,2,h,c);break;case 5:this.EY(Aj.a.tR(a),a.node,3,
h,c);this.EY(Aj.a.tR(a),a.node,5,h,c);this.EY(Aj.a.tR(a),a.node,4,h,c);this.EY(Aj.a.tR(a),a.node,0,h,c);break;case 4:this.EY(Aj.a.tR(a),a.node,3,h,c),this.EY(Aj.a.tR(a),a.node,5,h,c),this.EY(Aj.a.tR(a),a.node,4,h,c),this.EY(Aj.a.tR(a),a.node,0,h,c),this.EY(Aj.a.tR(a),a.node,1,h,c),this.EY(Aj.a.tR(a),a.node,2,h,c)}return!0}pPf(a,c,h,v){if(!c)return r.ULS.sendTraceTag(578073119,306,15,"cell border context should not be null."),!1;if(c.contextId!==ic.a.LY)return r.ULS.sendTraceTag(577910656,306,15,"Context should be of type cell border. Getting context of type: {0}",
c.contextId),!1;var B=c.node;const X=new Kd.GraphIterator;X.set(B);X.La(14);B=Tf.TableCellReader.NIa(X);switch(c.border){case 2:this.VMa(a,c.node,5,v,h,B);this.C0d(c.node,5,h);this.I_d(a,c.uVa(),3,h,v,B);break;case 0:this.VMa(a,c.node,3,v,h,B);this.C0d(c.node,3,h);this.I_d(a,c.uVa(),1,h,v,B);break;case 1:this.VMa(a,c.node,4,v,h,B);this.C0d(c.node,4,h);this.I_d(a,c.uVa(),0,h,v,B);break;case 3:this.VMa(a,c.node,0,v,h,B),this.C0d(c.node,0,h),this.I_d(a,c.uVa(),2,h,v,B)}return!0}ZJm(a,c){if(Gc.SelectionEditor.BKc(a)&&
c)switch(a=Object(ha.a)(op.TableNodeBorderContext,a),a.border){case 2:this.uM(a.node,Ff.an.gK(5),c);break;case 0:this.uM(a.node,Ff.an.gK(3),c);break;case 3:this.uM(a.node,Ff.an.gK(0),c);break;case 1:this.uM(a.node,Ff.an.gK(4),c);break;case 7:this.uM(a.node,Ff.an.gK(1),c);break;case 8:this.uM(a.node,Ff.an.gK(2),c);break;case 5:c=this.uM(a.node,Ff.an.gK(5),c);c=this.uM(a.node,Ff.an.gK(3),c);c=this.uM(a.node,Ff.an.gK(0),c);this.uM(a.node,Ff.an.gK(4),c);break;case 6:c=this.uM(a.node,Ff.an.gK(1),c);this.uM(a.node,
Ff.an.gK(2),c);break;case 4:c=this.uM(a.node,Ff.an.gK(5),c),c=this.uM(a.node,Ff.an.gK(3),c),c=this.uM(a.node,Ff.an.gK(0),c),c=this.uM(a.node,Ff.an.gK(4),c),c=this.uM(a.node,Ff.an.gK(1),c),this.uM(a.node,Ff.an.gK(2),c)}}DIm(a,c){if(Gc.SelectionEditor.CKc(a)&&c)switch(a=Object(ha.a)(op.TableNodeBorderContext,a),a.border){case 2:this.uM(a.node,Ff.an.pM(5),c);break;case 0:this.uM(a.node,Ff.an.pM(3),c);break;case 3:this.uM(a.node,Ff.an.pM(0),c);break;case 1:this.uM(a.node,Ff.an.pM(4),c)}}x5e(a,c,h){h=
null;if(!a)return r.ULS.sendTraceTag(575980876,306,15,"Node should not be null"),h;a.properties.hasProperty(c.size)&&(h=new Xp.a,h.weight=a.properties.ia(c.size,Og.a.uD),h.style=a.properties.ia(c.style,Og.a.Toa),h.color=a.properties.ia(c.color,0));return h}oPf(a,c,h){a?h?(a.properties.setValue(c.size,h.weight),a.properties.setValue(c.style,h.style),a.properties.setValue(c.color,h.color)):r.ULS.sendTraceTag(575980878,306,15,"Property Value object should not be null"):r.ULS.sendTraceTag(575980877,306,
15,"Node should not be null")}NEb(a,c){a?(a.properties.removeProperty(c.size),a.properties.removeProperty(c.style),a.properties.removeProperty(c.color)):r.ULS.sendTraceTag(575980879,306,15,"Node should not be null")}EY(a,c,h,v,B){B=this.DRn(a,c,h,v,B);this.u$b(c,Ff.an.gK(h),B);switch(h){case 5:this.uMa(c,2,v,B);break;case 4:this.uMa(c,1,v,B);break;case 0:this.uMa(c,3,v,B);break;case 3:this.uMa(c,0,v,B);break;case 1:this.uMa(c,7,v,B);break;case 2:this.uMa(c,8,v,B)}}DRn(a,c,h,v,B){if(3!==v){var X=Ff.Ff.mzd(a,
c,h,3);void 0!==X&&null!==X&&X!==Og.a.WW&&(X=kn.a.B9b(X),B.color=Ff.acc.Twa(c,X))}1!==v&&(X=Ff.Ff.mzd(a,c,h,1),void 0!==X&&null!==X&&X!==Og.a.tD&&(B.weight=parseFloat(X)*Og.a.EUb));2!==v&&(a=Ff.Ff.mzd(a,c,h,2),void 0!==a&&null!==a&&a!==Og.a.tD&&(B.style=a));return B}VMa(a,c,h,v,B,X){v&&(B=this.qMn(a,c,X,h,v,B));this.u$b(c,Ff.an.pM(h),B)}qMn(a,c,h,v,B,X){if(3!==B){var ma="",Pa=Ff.Ff.Twb(a,c,v,!1,!0,h,3);Pa&&(ma=Pa.Isb);void 0!==ma&&null!==ma&&ma!==Og.a.WW&&(ma=kn.a.B9b(ma),X.color=Ff.acc.Twa(c,ma))}if(1!==
B){ma="";if(Pa=Ff.Ff.Twb(a,c,v,!1,!0,h,1))ma=Pa.Isb;void 0!==ma&&null!==ma&&ma!==Og.a.tD&&(X.weight=parseFloat(ma)*Og.a.EUb)}if(2!==B){B="";if(a=Ff.Ff.Twb(a,c,v,!1,!0,h,2))B=a.Isb;void 0!==B&&null!==B&&B!==Og.a.tD&&(X.style=B)}return X}Hem(a){let c=0,h=0;({hem:c,Pbm:h}=this.h7k(a.style,c,h));a.weight<c&&(a.weight=c);a.weight>h&&(a.weight=h);return a}h7k(a,c,h){switch(a){case Og.a.GUb:case Og.a.w8a:case Og.a.jvc:c=2;h=48;break;case Og.a.E_:c=2;h=24;break;default:c=2,h=48}return{hem:c,Pbm:h}}I_d(a,
c,h,v,B,X){if(c)if(v)for(let ma=0;ma<c.length;ma++)switch(h){case 2:this.VMa(a,c[ma],5,B,v,X);break;case 0:this.VMa(a,c[ma],3,B,v,X);break;case 1:this.VMa(a,c[ma],4,B,v,X);break;case 3:this.VMa(a,c[ma],0,B,v,X)}else r.ULS.sendTraceTag(578073121,306,15,"tableBorderPropertyValue should not be null");else r.ULS.sendTraceTag(578073120,306,15,"Adjacent cell array should not be null")}C0d(a,c,h){const v=new Kd.GraphIterator;v.set(a);v.La(14);const B=Tf.TableCellReader.sqa(a);a=Tf.TableCellReader.oO(a);
Fe.forEachCell(v,B,a,(X,ma,Pa)=>{X=X.currentNode;Tf.TableCellReader.lq(X)&&0==Pa&&0<ma&&this.u$b(X,Ff.an.pM(c),h)})}u$b(a,c,h){a?(h=this.Hem(h),a.properties.setValue(c.color,h.color),a.properties.setValue(c.size,h.weight),a.properties.setValue(c.style,h.style)):r.ULS.sendTraceTag(578073122,306,15,"Graph node should not be null")}uMa(a,c,h,v){if(a){var B=Wf.TableReader.kf(a),X=Wf.TableReader.Eg(a),ma=new Kd.GraphIterator,Pa=[];for(let mb=0;mb<B;mb++)for(let Tb=0;Tb<X;Tb++)if(ma.set(a),Fe.moveToCell(ma,
mb,Tb),ma&&ma.currentNode&&!Tf.TableCellReader.lf(ma))switch(c){case 2:Tf.TableCellReader.O8(ma)&&Array.add(Pa,op.TableNodeBorderContext.M3(ma.currentNode,2));break;case 0:Tf.TableCellReader.Vca(ma)&&Array.add(Pa,op.TableNodeBorderContext.M3(ma.currentNode,0));break;case 3:Tf.TableCellReader.Xjf(a,ma.currentNode)&&Array.add(Pa,op.TableNodeBorderContext.M3(ma.currentNode,3));break;case 1:Tf.TableCellReader.Yjf(a,ma.currentNode)&&Array.add(Pa,op.TableNodeBorderContext.M3(ma.currentNode,1));break;case 7:Tf.TableCellReader.Yjf(a,
ma.currentNode)||Array.add(Pa,op.TableNodeBorderContext.M3(ma.currentNode,1));break;case 8:Tf.TableCellReader.Xjf(a,ma.currentNode)||Array.add(Pa,op.TableNodeBorderContext.M3(ma.currentNode,3))}for(a=0;a<Pa.length;a++)switch(c=Pa[a],c.border){case 2:this.ASc(c.node,Ff.an.pM(5),h,v);this.OXd(c.uVa(),Ff.an.pM(0),h,v);break;case 0:this.ASc(c.node,Ff.an.pM(3),h,v);this.OXd(c.uVa(),Ff.an.pM(4),h,v);break;case 1:this.ASc(c.node,Ff.an.pM(4),h,v);this.OXd(c.uVa(),Ff.an.pM(3),h,v);break;case 3:this.ASc(c.node,
Ff.an.pM(0),h,v),this.OXd(c.uVa(),Ff.an.pM(5),h,v)}}else r.ULS.sendTraceTag(578073123,306,15,"Table node should not be null")}OXd(a,c,h,v){if(a)for(let B=0;B<a.length;B++)this.ASc(a[B],c,h,v);else r.ULS.sendTraceTag(578062292,306,15,"Adjacent cell array should not be null")}ASc(a,c,h,v){if(a){var B=a.ia(c.color,Ff.tWe),X=a.ia(c.size,Ff.vWe),ma=a.ia(c.style,Ff.uWe),Pa=new Xp.a;Pa.weight=v.weight;Pa.style=v.style;Pa.color=v.color;2!==h||B===Ff.tWe&&X===Ff.vWe?3!==h||ma===Ff.uWe&&X===Ff.vWe?1!==h||B===
Ff.tWe&&ma===Ff.uWe?(a.properties.removeProperty(c.color),a.properties.removeProperty(c.size),a.properties.removeProperty(c.style)):(Pa.color=B,Pa.style=ma,this.u$b(a,c,Pa)):(Pa.style=ma,Pa.weight=X,this.u$b(a,c,Pa)):(Pa.color=B,Pa.weight=X,this.u$b(a,c,Pa))}else r.ULS.sendTraceTag(578073152,306,15,"Graph node should not be null")}uM(a,c,h){var v=a.properties.ia(c.style,Og.a.tD);v!==Og.a.tD&&(h.lineStyle!==Og.a.tD?h.lineStyle!==v&&(h.lineStyle=Og.a.QUj):h.lineStyle=v);v=a.properties.ia(c.size,Og.a.uD);
v!==Og.a.uD&&(h.QLc!==Og.a.uD?h.QLc!==v&&(h.QLc=Og.a.IUj):h.QLc=v);a=a.properties.ia(c.color,0);a=kn.a.SA(a);a!==Og.a.WW&&(h.borderColor!==Og.a.WW?h.borderColor!==a&&(h.borderColor=Og.a.AUj):h.borderColor=a);return h}static get an(){return Ff.fN||(Ff.fN=Og.a.instance)}static get Ff(){return Ff.Hp||(Ff.Hp=xa.a.instance.ra("WordEditor.IWACTableStyleReader"))}static get acc(){return Ff.jsc||(Ff.jsc=Uj.a.instance)}}Ff.YYl="110px";Ff.XYl="20px";Ff.BJi="SolidLineStyle";Ff.Sah="DashedLineStyle";Ff.Hfh="DottedLineStyle";
Ff.Jfh="DoubleLineStyle";Ff.RWg="BorderPointSizeOneQuarter";Ff.OWg="BorderPointSizeOneHalf";Ff.UWg="BorderPointSizeThreeQuarters";Ff.PWg="BorderPointSizeOne";Ff.NWg="BorderPointSizeOneAndHalf";Ff.VWg="BorderPointSizeTwoAndQuarter";Ff.TWg="BorderPointSizeThree";Ff.MWg="BorderPointSizeFourAndHalf";Ff.SWg="BorderPointSizeSix";Ff.uWe="single";Ff.vWe=4;Ff.tWe=0;Ff.fN=null;Ff.Hp=null;Ff.jsc=null;Object(w.a)(Ff,"TableBorderManager",null,[571]);var un=b(821),$m=b(57),zp=b(192);class Lp{constructor(a,c){this.YBg=
this.pwg=null;this.mHa=a;this.Nyg=c}get Zei(){return this.Nyg}get hka(){return this.pwg}get LIf(){return this.YBg}NCi(a,c){this.YBg=a;this.pwg=c}$gn(a){this.Nyg=a}}Object(w.a)(Lp,"CellNodeAndOutlineElementInfoForInsertion",null,[]);var ai=b(97),hq=b(196),Vl=b(363),tr=b(142),iq=b(262),Nr=b(552),Or=b(84),kt=b(412),yw=b(846);class gm extends un.a{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc=null,Tc=null){super(a,c,h,Tc,rc);this.$2a=yw.a.instance;this.ma=new Rd.a;this.QOe=[Yb.a.NHb,Yb.a.G0a,Yb.a.MHb,Yb.a.JHb,
Yb.a.E0a,Yb.a.IHb,Yb.a.HHb,Yb.a.D0a,Yb.a.GHb,Yb.a.LHb,Yb.a.F0a,Yb.a.KHb];this.g$i=[Yb.a.tK,Yb.a.Zt,Ed.a.xk,Ed.a.iV];this.zh=v;this.Hqb=B;this.Vb=X;this.ya=ma;this.oT=Pa;this.Hl=mb;this.Ajc=Tb;this.mJg=rc;this.cyj=Tc}get jh(){return this.zh.value}get Dq(){return this.oT?this.oT.instance:null}FIe(a){this.ma.addHandler("OnParagraphDelete",a)}get ag(){return!!this.Ajc.instance&&this.Ajc.instance.ag}PHc(a,c,h,v,B){c.setValue(Yb.a.Ib,uf.a.nE());c.setValue(Yb.a.gIl,B);Nr.b(v,c,[Yb.a.MY]);super.PHc(a,c,h,
v,B)}xGd(a,c,h,v,B){const X=this.KFc(c,h,v,B);this.brd(X,c,!1);return super.xGd(a,c,h,v,B)}Dkd(a,c,h,v,B){const X=this.KFc(c,h,v,B);this.brd(X,c,!0);super.Dkd(a,c,h,v,B);return X}RSe(a,c,h,v){c=this.KFc(a,c,h,v);this.brd(c,a,!0);return c}insertRows(a,c,h,v){const B=$m.a.ir(a),X=new Kd.GraphIterator;X.Wb(a);const ma=X.currentNode;X.Za(1);let Pa;Pa=c?a.dB(1):a.currentNode;const mb=a.ob();if(!mb)throw Error.create("table row insertion cannot be performed on a null tableNode");const Tb=Wf.TableReader.kf(mb),
rc=mb.XQ.Ff;let Tc=!1;try{mb.Yka=1;const vd=this.$2a.oab(mb,rc.jy(mb));this.ZBa(a.currentNode);this.Vla(a);this.pEj(h,a,Pa,X,ma,c,v);const ee=this.$2a.oab(mb,rc.jy(mb));this.Y_a(mb,Wf.TableReader.kf(mb)+h);Tc=!0;this.hHd(mb,vd,ee)}finally{mb.Yka=0,Tc||this.Y_a(mb,Wf.TableReader.kf(mb)+h)}B+1!==Tb||c?!B&&c&&gm.Vgf(mb,h):gm.Vgf(mb,B);c=B+h+(c?0:1);c<Tb+h&&this.VOh(mb,c);return a.currentNode}pEj(a,c,h,v,B,X,ma){let Pa=null,mb=null;for(var Tb=0;Tb<a;++Tb){var rc=zp.a.instance.createInstance(393251);mb||
(mb=rc);Pa=rc;this.PHc(c,rc,h,B,X)}a=Wf.TableReader.Eg(c.currentNode);h=!0;do{h?(c.qh(Pa),h=!1):c.ue(1);B=Array(a);for(Tb=0;Tb<a;++Tb){rc=this.PHa();const Tc=this.RSe(rc,v.currentNode,X,!0);let vd=null;Tc.lf||(vd=ma(Tc));B[Tb]=new Lp(rc,vd);B[Tb].NCi(Tc,null);v.ue(1)}for(Tb=0;Tb<a;++Tb)rc=B[Tb].mHa,c.h3(rc,1,un.a.FEa?un.a.FEa():null),Tf.TableCellReader.lq(rc)||(this.lsb(c,rc,B[Tb].Zei),this.u7g(B[Tb].LIf,rc,!0));v.d4(1)}while(c.currentNode!==mb)}insertColumns(a,c,h,v,B){let X=a.currentNode,ma=!1,
Pa=Wf.TableReader.Eg(a.currentNode);const mb=Pa;try{this.ZBa(a.currentNode);this.Vla(a);const Tb=X.XQ.Ff;X.Yka=1;const rc=this.$2a.oab(X,Tb.jy(X));Pa=Wf.TableReader.Eg(a.currentNode);-1===c&&(c=Pa);this.nEj(a,v,h,c,B);X=a.currentNode;Pa+=v;this.fIf(a,Pa,v,c);ma=!0;const Tc=this.$2a.oab(X,Tb.jy(X));this.hHd(X,rc,Tc)}finally{X.Yka=0,ma||this.fIf(a,Pa,v,c)}c!==mb||h?!c&&h&&gm.Ugf(X,v):gm.Ugf(X,c-1)}nEj(a,c,h,v,B){var X=a.currentNode;v=h?v:v-1;a.Za(1);var ma=new Ua.a;do{var Pa=a.cB(v,1);a.ob();var mb=
Array(c);for(let rc=0;rc<c;++rc){var Tb=this.PHa();const Tc=this.M8k(a,Pa,h),vd=this.RSe(Tb,Pa,h,!1);Tb=new Lp(Tb,null);Tb.NCi(vd,Tc);mb[rc]=Tb}ma.add(mb)}while(a.Fh(1));h=ma.toArray();for(v=0;v<h.length;v++)for(ma=0;ma<c;ma++)Pa=h[v][ma],mb=Pa.LIf,mb.lf||Pa.$gn(B(mb));a.set(X);a.Za(1);B=0;do{for(X=0;X<c;++X)v=h[B][X],ma=v.mHa,a.bzb(ma,v.hka,1,un.a.FEa?un.a.FEa():null),Tf.TableCellReader.lq(ma)||(this.lsb(a,ma,v.Zei),this.u7g(v.LIf,ma,!1));B++}while(a.Fh(1))}hHd(a,c,h){if(c){var v=2===a.Yka,B=[],
X=new Kd.GraphIterator;X.set(a);for(var ma=X.Za(1);ma;){for(ma=X.Za(1);ma;){const Pa=ma.id.toString();Pa in c&&c[Pa]===h[Pa]&&(!v||!Tf.TableCellReader.Vca(X)&&!Tf.TableCellReader.O8(X))||B.push(ma);ma=X.Fh(1)}ma=X.Fh(1)}if(0<B.length){c=new gf.GraphTransaction(3);try{c.set(a.Oh);for(let Pa of B)Pa.fHd()}finally{c&&c.dispose()}}}}deleteRows(a,c){const h=$m.a.ir(a),v=h+c;let B=a.ob();const X=B.XQ.Ff;let ma=!1;r.ULS.sendTraceTag(579479247,341,50,"Performing DeleteRows. Table node Id: {0}, Table Node Type: {1},  Row index: {2}, Row count to delete: {3}",
B.id.toString(),B.type,h,c);const Pa=Wf.TableReader.kf(B);try{B.Yka=2;const mb=this.$2a.oab(B,X.jy(B));this.ZBa(a.currentNode);this.Vla(a);for(let rc=v-1;rc>=h;--rc){a.cB(rc,1);let Tc=a.Za(1);for(;Tc;)this.pOc(Tc,!0),Tc=a.Fh(1);this.yWa(a);r.ULS.sendTraceTag(579479248,341,50,"Deleting table row node: ID:{0}, Type:{1}",a.currentNode.id.toString(),a.Md);a.xf()}B=a.currentNode;const Tb=this.$2a.oab(B,X.jy(B));this.Y_a(B,Wf.TableReader.kf(B)-c);this.JQd(a);ma=!0;this.hHd(B,mb,Tb)}finally{B.Yka=0,ma||
(this.Y_a(a.currentNode,Wf.TableReader.kf(a.currentNode)-c),this.JQd(a))}Pa===v&&0<=h-1&&gm.Vgf(B,h-1);h<Pa-c&&this.VOh(B,h)}deleteColumns(a,c,h){a=Object(ha.a)(Kd.GraphIterator,a);let v=Object(ha.a)(kt.a,a.currentNode),B=Wf.TableReader.Eg(a.currentNode);const X=v.XQ.Ff;let ma=!1;r.ULS.sendTraceTag(579479249,341,50,"Performing DeleteColumns. Table Node Id:{0}, Table Node type:{1}, Column Index: {2}, Column count to delete: {3}",v.id.toString(),v.type,c,h);const Pa=B;try{v.Yka=2;const mb=this.$2a.oab(v,
X.jy(v));this.ZBa(a.currentNode);this.Vla(a);-1===c&&(c=B-h);a.Za(1);do for(let rc=c+h-1;rc>=c;--rc)a.cB(rc,1),this.pOc(a.currentNode,!1),this.yWa(a),a.xf();while(a.Fh(1));B-=h;this.eIf(a,B,c,h);ma=!0;v=Object(ha.a)(kt.a,a.currentNode);const Tb=this.$2a.oab(v,X.jy(v));this.hHd(v,mb,Tb);this.IQd(a)}finally{v&&(v.Yka=0),ma||(this.eIf(a,B,c,h),this.IQd(a))}Pa===c+h&&0<=c-1&&gm.Ugf(v,c-1)}mergeCells(a,c,h){if(a&&(1!==c||1!==h)){var v=new Kd.GraphIterator;v.Wb(a);v.La(14);this.sUe(v,c,h);this.$Ln(v,c,
h);v.ob();v.ob();this.lbi(v)}}fKi(a,c,h){if(a&&(1!==c||1!==h)){var v=new Kd.GraphIterator;v.Wb(a);v.La(14);this.amk(v,c,h);v.ob();v.ob();this.odi(v)}}pOc(a,c){r.ULS.sendTraceTag(579479250,341,50,"Table cell getting deleted. ID:{0}, Type:{1}",a.id.toString(),a.type);this.Wol(a,c,Object(m.a)(this,this.bGf,"promoteToNonGhostCellImpl"))}bGf(a,c){const h=a.currentNode;h.lf=!1;this.brd(c.currentNode,a.currentNode,!0);h.removeProperty(Yb.a.skippedCell);h.removeProperty(Yb.a.renderCell);1===h.colSpan&&1===
h.rowSpan&&h.ywc();un.a.Do.t_(a,!0,un.a.zzh(c.currentNode));Fe.returnToCell(a);l.AFrameworkApplication.Mg("tableFormatting;tableFormattingCF");l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableFormattingIssues",!1)&&this.Lek(c,a)}tcf(a,c,h){super.tcf(a,c,h);1===c.controlCell.colSpan&&1===c.controlCell.rowSpan?c.controlCell.ywc():!h&&c.AZd&&(a.vJa?1<a.colSpan&&(c=new Kd.GraphIterator,c.set(a),c.La(15),Fe.moveToNextColumn(c),c.currentNode.colSpan=
a.colSpan-1):(h=new Kd.GraphIterator,h.set(c.controlCell),h.La(15),c=Or.a(h),h=new Kd.GraphIterator,h.set(a),h.La(15),Fe.moveToColumnByIndex(h,c),--h.currentNode.colSpan))}KFc(a,c,h,v){const B=super.KFc(a,c,h,v);if(a.lf&&!v){var X=c.Hra;X.AZd&&(v=un.a.oZb(X.controlCell,v),!X.Spd&&h||X.Spd===v-1&&!h?a.colSpan=1:(h=new Kd.GraphIterator,h.set(X.controlCell),h.La(15),X=Or.a(h),h=new Kd.GraphIterator,h.set(c),h.La(15),Fe.moveToColumnByIndex(h,X),h.currentNode.colSpan+=1))}B.ia(Yb.a.skippedCell,!1)&&(a.lf=
!0,a.J0=!0,a.zhb=!0);return B}JQd(a){this.JIb(a,Yb.a.complexTable)}IQd(a){this.JIb(a,Yb.a.complexTable)}lbi(a){this.JIb(a,Yb.a.complexTable)}odi(a){this.JIb(a,Yb.a.complexTable)}Lek(a,c){if(a&&c){let h;a=Kd.GraphIterator.va(a.currentNode);Rm.OutlineNavigator.I4(a)&&(a.Za(2),a=a.currentNode,12==a.type&&(h=a.pg(Ed.a.xk)));h&&(a=new Kd.GraphIterator,a.Wb(c),Rm.OutlineNavigator.I4(a)&&a.Za(2)&&(c=a.currentNode,12==c.type&&c.Uh(Ed.a.xk,h)))}}brd(a,c,h){a&&(Nr.b(a,c,this.QOe),Nr.b(a,c,[Ed.a.dI]),h&&Nr.b(a,
c,[Yb.a.VK,Yb.a.UM,Yb.a.sCa,Yb.a.qCa,Yb.a.Lea,Yb.a.skippedCell,Yb.a.renderCell]))}u7g(a,c,h){a&&(a=Kd.GraphIterator.va(a),a.nc(),a.Xc(),c=Kd.GraphIterator.va(c),c.nc(),c.Xc(),Ta.OutlineElementReader.Gg(a)&&ie.OutlineElementNavigator.Fd(a)&&Ta.OutlineElementReader.Gg(c)&&ie.OutlineElementNavigator.Fd(c)&&Nr.b(a.currentNode,c.currentNode,this.g$i),h&&(ie.OutlineElementNavigator.Wc(a),ie.OutlineElementNavigator.Wc(c),ab.ListReader.Pg(a)&&(h=gm.FZl.Op(a),h.vy=ai.a.Ih,{pza:h}=gm.Oo.Loa(h.propertySet,c,
h))))}yWa(a){this.ag&&this.Hl.SUm(a.currentNode);for(a=hq.a.gq(a);a.moveNext();)if(sd.ParagraphReader.tb(a.currentNode)){const c=ac.e(a.currentNode);for(let h of c)h.Eda();this.ma.raiseEvent("OnParagraphDelete",a.currentNode)}else ab.ListReader.Pg(a.iterator)&&this.Dq&&this.Dq.Ska(a.iterator)}vB(a,c){let h=null;if(this.mJg.Bf){const v=Object(ha.a)(kt.a,a);v&&(h=v.hP())}Wf.TableReader.hk(a)&&(1===c?c=3:3===c&&(c=1));super.vB(a,c);this.mJg.Bf&&this.cyj.f$(a,h);Object(Ub.a)(kt.a,a)&&un.a.Vd.BDi(Object(ha.a)(kt.a,
a),(new Vl.a(1,0)).jt)}uQf(a,c){const h=Array(c),v=this.bEh(a)/c;for(let B=0;B<c;B++)h[B]=Math.max(Be.a.ym(tr.a.Cla,0),v);a.setValue(Ed.a.Hw,h)}tCi(a){a.setValue(Yb.a.tableLayout,0)}UQg(a,c,h,v,B){const X=Array(h);for(var ma=0,Pa=0;ma<v;++ma)X[ma]=c[ma],Pa+=X[ma];for(;ma<h;++ma)X[ma]=0>ma-B?c[0]:c[ma-B],Pa+=X[ma];ma=this.bEh(a.currentNode);if(Pa>ma)for(Pa=ma/Pa,ma=0;ma<h;++ma)X[ma]=Math.max(Be.a.ym(tr.a.Cla,0),X[ma]*Pa);return X}bEh(a){var c=Kd.GraphIterator.va(a);a=Be.a.ym(Be.a.Vh(Wf.TableReader.ODh(c),
0),0);if(c.La(16))return Fe.returnToCell(c),c=tr.a.rcc(c.currentNode),Be.a.ym(Be.a.Vh(c,0),0)-a;c=iq.a.DYc(c);return Be.a.ym(Be.a.Vh(c,0),0)-a}oO(a,c,h){const v=new Kd.GraphIterator;v.set(a);Fe.moveToCell(v,c,h);return v.currentNode.ia(Yb.a.colSpan,1)}XUc(a){var c=Eb.App.oa.Da.Su;if(c.Cd&&(c=a.Sd(c.gb))){var h=!1,v=Wf.TableReader.Eg(a),B=a.ia(Ed.a.Hw,Array(v));for(var X of B)if(!X){h=!0;break}if(h){B=bj.a.clone(B);X=a.ia(Yb.a.complexTable,!1);r.ULS.sendTraceTag(36726403,341,50,"Performing set column widths: columnCount {0} | columnWidths: {1} | isComplexTable: {2}",
v,B,X);h=1;var ma=0;for(let mb=0;mb<v;)if(X&&(h=this.oO(a,0,mb)),1<h){for(var Pa=0;Pa<h;Pa++)B[mb]||(B[mb]=this.fyh(0)),mb++;ma+=h-1}else(Pa=c.IXk(mb-ma))||r.ULS.sendTraceTag(36726404,341,50,"Got no width for graph column {0} (ghost cells {1})",mb,ma),B[mb]||(B[mb]=this.fyh(Pa)),mb++;a.setValue(Ed.a.Hw,B)}}}fyh(a){return Be.a.ym(Math.max(a,tr.a.Cla),0)}ZBa(a){a=Kd.GraphIterator.va(a);this.XUc(a.currentNode);a.La(14)&&(Fe.returnToContainingTable(a),this.XUc(a.currentNode))}yDi(a,c){c&&a.setValue(Yb.a.H5,
c)}S0d(a,c){c&&a.setValue(Yb.a.Bbc,c)}l2g(a,c){const h=Wf.TableReader.Eg(a);un.a.k6j(a,c,h)}edn(a,c,h){let v;if(!({tableNode:v}=this.G3b(a)).returnValue)return!1;if(c&&h&&c.length===h.length){if(!this.Bwk(v,c))return!1;for(let B=0;B<c.length;++B){const X=this.Hqb.cVc(a,c[B],h[B]);if(X)return r.ULS.sendTraceTag(17584922,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",X),!1}this.TOd(v);return!0}return!1}HNj(a,c){let h;if(!({tableNode:h}=this.G3b(a)).returnValue||
Wf.TableReader.fz(h))return!1;var v=Object(ha.a)(Kd.GraphIterator,this.Vb.ff(h));Fe.moveToLastRow(v);var B=Wf.TableReader.kf(h);if(c&&0<c.length){this.insertRows(v,!1,c.length,()=>null);v=Wf.TableReader.kf(h);var X=this.Vb.ff(h);B=this.LDh(X,B,v-1);for(v=0;v<B.length;++v){X=B[v];const ma=c[v];for(let Pa=0;Pa<X.length;++Pa){let mb;if(mb=ma&&ma[Pa]?this.Hqb.cVc(a,X[Pa],ma[Pa].toString()):this.Hqb.cVc(a,X[Pa],""))return r.ULS.sendTraceTag(17584923,341,10,"Unexpected failure to set data into table content control cell. error code is {0}",
mb),!1}}}this.TOd(h);return!0}pNj(a,c){let h;if(!({tableNode:h}=this.G3b(a)).returnValue||Wf.TableReader.fz(h))return!1;var v=this.Vb.ff(h),B=Wf.TableReader.Eg(h);if(c&&0<c.length){this.insertColumns(Object(ha.a)(Kd.GraphIterator,v),B,!1,c[1].length,()=>null);var X=Wf.TableReader.Eg(h);v=this.Phl(v,B,X-1);for(B=0;B<v.length;++B){X=c[B];const ma=v[B];for(let Pa=0;Pa<ma.length;++Pa){let mb;if(mb=X&&X[Pa]?this.Hqb.cVc(a,ma[Pa],X[Pa].toString()):this.Hqb.cVc(a,ma[Pa],""))return r.ULS.sendTraceTag(17584924,
341,10,"Unexpected failure to set data into table content control cell. error code is {0}",mb),!1}}}this.TOd(h);return!0}Iqk(a){let c;if(!({tableNode:c}=this.G3b(a)).returnValue)return!1;let h=this.OVa(c);const v=Wf.TableReader.kf(c);var B=this.Vb.ff(c);B=this.LDh(B,h,v-1);for(let X=0;X<B.length;++X){const ma=B[X];for(let Pa=0;Pa<ma.length;++Pa){const mb=this.Hqb.tpi(a,ma[Pa]);if(mb)return r.ULS.sendTraceTag(17584925,341,10,"Unexpected failure to release content control in table cell. error code is {0}",
mb),!1}}h=h?h:1;a=this.Vb.ff(c);a.QG(h)&&15===a.Md&&this.deleteRows(Object(ha.a)(Kd.GraphIterator,a),v-h);this.TOd(c);return!0}OVa(a){let c=0;const h=this.Vb.ff(a);let v=h.Xc();for(;v&&v.ia(Yb.a.FAb,!1);)c++,v=h.Ns();return!c&&gj.StyleReader.J0a.uR(a)&32?1:c}$Ln(a,c,h){var v,B;const X=a.currentNode,ma=new Kd.GraphIterator;ma.Wb(a);let Pa=null,mb=null,Tb=null;const rc=Og.a.instance.pM(3),Tc=Og.a.instance.pM(4),vd=Og.a.instance.pM(5),ee=Og.a.instance.pM(0);Fe.forEachCell(ma,c,h,(Ie,Xe,Yf)=>{Ie=Ie.currentNode;
Xe||Yf||(Pa=gm.wx.x5e(Ie,rc,Pa));Xe||Yf!==h-1||(mb=gm.wx.x5e(Ie,Tc,mb));0<Xe&&!Yf&&(Pa?gm.wx.oPf(Ie,rc,Pa):gm.wx.NEb(Ie,rc),mb?gm.wx.oPf(Ie,Tc,mb):gm.wx.NEb(Ie,Tc),gm.wx.NEb(Ie,vd),Xe!==c-1&&gm.wx.NEb(Ie,ee));Yf||Xe!==c-1||(Tb=gm.wx.x5e(Ie,ee,Tb))});a=null===(B=null===(v=null===Eb.App||void 0===Eb.App?void 0:Eb.App.oa)||void 0===v?void 0:v.Da)||void 0===B?void 0:B.Su;mb?(v=op.TableNodeBorderContext.M3(X,1),gm.wx.pPf(Aj.a.Om(a),v,mb,0)):gm.wx.NEb(X,Tc);v=op.TableNodeBorderContext.M3(X,0);if(Pa)gm.wx.pPf(Aj.a.Om(a),
v,Pa,0);else for(v=Object(ha.a)(op.TableNodeBorderContext,v).uVa(),B=0;B<v.length;B++)gm.wx.NEb(v[B],Tc);Tb?gm.wx.oPf(X,ee,Tb):gm.wx.NEb(X,ee)}Bwk(a,c){for(let v=0;v<c.length;++v){var h=this.Vb.ff(c[v]);if(h.La(14)&&(h=h.mc(14),a.id===h.id))continue;return!1}return!0}G3b(a){let c=null;if(a&&a.yh.toString()!==a.Ti.toString())return{returnValue:!1,tableNode:c};c=this.jh.Ra(a.yh);return 14===c.type&&this.Hqb.G3b(a)?{returnValue:!0,tableNode:c}:{returnValue:!1,tableNode:c}}LDh(a,c,h){const v=[];Fe.forEachCellInTable(Object(ha.a)(Kd.GraphIterator,
a),(B,X,ma)=>{if(X>=c&&X<=h)ma||v.push([]),Tf.TableCellReader.lf(B)||Array.add(v[X-c],B.currentNode);else if(X>h)return!1;return!0});return v}Phl(a,c,h){const v=[];Fe.forEachCellInTable(Object(ha.a)(Kd.GraphIterator,a),(B,X,ma)=>{ma>=c&&ma<=h&&(ma===c&&v.push([]),Tf.TableCellReader.lf(B)||Array.add(v[X],B.currentNode));return!0});return v}TOd(a){if(a&&14===a.type){a=Object(ha.a)(Kd.GraphIterator,this.Vb.ff(a));const c=new Ua.a;sd.ParagraphReader.Yab(a,!0,!1,c);a=ne.SelectionFactory.vd(c.J(c.count-
1),0);this.ya.setSelection(a)}}static get characterPropertiesEditor(){return gm.Tb||(gm.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get wx(){gm.ioa||(gm.ioa=xa.a.instance.ra("WordEditor.ITableBorderManager"));return gm.ioa}static get FZl(){return gm.zc||(gm.zc=xa.a.instance.resolve("Box4.List.IListReader"))}static get Oo(){return gm.Un||(gm.Un=xa.a.instance.resolve("Box4.List.IListEditor"))}VOh(a,c){const h=new Kd.GraphIterator;h.set(a);Fe.moveToFirstRow(h);Fe.moveToRowByIndex(h,
c);do h.currentNode.lj(4,!0);while(Fe.moveToNextRow(h))}static Vgf(a,c){if(a){var h=Wf.TableReader.kf(a),v=Wf.TableReader.Eg(a);if(!(!Eb.App.oa.Da.Su.Cd||0>c||c>=h))for(h=new Kd.GraphIterator,h.set(a),a=0;a<v;a++){a?Fe.moveToNextColumn(h):Fe.moveToCell(h,c,a);if(!h||!h.currentNode||16!==h.currentNode.type)continue;let B=h.currentNode;Tf.TableCellReader.lq(B)&&(B=Tf.TableCellReader.tia(B));B&&B.lj(4,!0)}}else r.ULS.sendTraceTag(577868247,306,15,"Can not invalidate row when there is no table node")}static Ugf(a,
c){if(a){var h=Wf.TableReader.kf(a),v=Wf.TableReader.Eg(a),B=new Kd.GraphIterator;if(!(!Eb.App.oa.Da.Su.Cd||0>c||c>=v))for(v=0;v<h;v++){B.set(a);Fe.moveToCell(B,v,c);if(!B||!B.currentNode)continue;let X=B.currentNode;Tf.TableCellReader.lq(X)&&(X=Tf.TableCellReader.tia(X));X&&X.lj(4,!0)}}else r.ULS.sendTraceTag(577868248,306,15,"Can not invalidate column when there is no table node")}}gm.Tb=null;gm.ioa=null;gm.zc=null;gm.Un=null;Object(w.a)(gm,"TableEditor",un.a,[569,570]);class Ft{get name(){return"WordEditor.TableEditors"}yb(a){l.AFrameworkApplication.K.$("TableEditorsDelayInitializationEnabled")&&
(a.ha("WordEditor.TableEditors.TableEditor",()=>new gm(a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("WordEditor.IWACTableStyleReader"),new qf.a(()=>Eb.App.oa.Da.Zb.Lc),a.resolve("WordEditor.ContentControl.ITableContentControlEditor"),new gl.a,$c.a.instance,a.za("WordEditor.IFlatListEditor"),a.resolve("Box4.ContentControl.IContentControlOperator"),a.za("Box4.ContentControlConfigSettings"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)).as("WordEditor.ITableEditor").as("Box4.ITableEditor").singleInstance(),
a.ha("WordEditor.TableEditors.TableBorderManager",()=>new Ff).as("WordEditor.ITableBorderManager").singleInstance())}init(){}dispose(){}static main(){M.a.instance.Lb(new Ft)}}Object(w.a)(Ft,"WordEditorTableEditorsPackage",null,[1,2]);class kv{get name(){return"WordEditor.TextLevelEditors"}yb(){}init(){}dispose(){}static main(){M.a.instance.Lb(new kv)}}Object(w.a)(kv,"WordEditorTextLevelEditorsPackage",null,[1,2]);var Gt=b(1728),hx=b(409),ys=b(697),pp=b(211),$t=b(248);class Bq{constructor(a){this.Apj=
a}qkk(){const a=zp.a.instance.createInstance(393228);a.setValue(Ed.a.MI,pp.a.first);a.setValue(Ed.a.mWg,0);a.setValue(Ed.a.A4,zj.OutlineReader.Hbh);(new ys.OutlineIndentInfo(!0)).ixi(a);return a}t_(a,c,h=null){const v=a.currentNode;if(!a.qC(1))return this.ecb(a,null,c,h);Ta.OutlineElementReader.UG(a)&&ie.OutlineElementNavigator.Xsf(a,!0);return Ta.OutlineElementReader.Gg(a)?Bq.Wf.bA(a,!1,c,h):(a.RTc(v),null)}i1j(a){return zj.OutlineReader.Mkf(a.currentNode)||Ta.OutlineElementReader.Gg(a)||Ta.OutlineElementReader.UG(a)||
Tf.TableCellReader.isTableCell(a)}ecb(a,c=null,h=!1,v=null){if(!this.i1j(a))return null;const B=Bq.Wf.gub();this.rin(B,a);a.bzb(B,c,1,null);a.qh(B);h&&(Bq.Wf.eM(a,v),ie.OutlineElementNavigator.Wc(a));return B}rin(a,c){if(c=this.cel(c))switch(c.type){case 11:Bq.Wf.xZe(c,a,!0);break;case 8:c=Bq.Kd.isRtl(c),Bq.Wf.gGb(a,c)}}cel(a){return this.Apj.eel(a)}fGb(a,c){a.setValue(Ed.a.iV,c?11:9)}kdn(a,c){const h=$t.WordSectionNavigator.instance.WO(a);return h?zj.OutlineReader.XJ(a)!==c?(h.setValue(Yb.a.GWe,
c),!0):!1:null}static get Kd(){return vg.PageReader.instance}static get Wf(){return Bq.Vd||(Bq.Vd=xa.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Wf(a){Bq.Vd=a}}Bq.Vd=null;Bq.nd=null;Object(w.a)(Bq,"OutlineEditor",null,[604]);const Jv=a=>{a.ha("Box4.OutlineLevelEditors.OutlineEditor",()=>new Bq(a.resolve("Box4.IOutlineElementNodeIdFactory"))).as("Box4.IOutlineEditor").singleInstance();a.ha("Box4.OutlineLevelEditors.OutlineElementEditor",()=>new Gt.a(a.te("Box4.IOutlineEditor"),a.te("Box4.List.IListEditor"),
a.te("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IBox4GraphWriter"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.resolve("Box4.Styles.IWACStyleEditor"),a.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IOutlineElementEditor").singleInstance()};class Kv{get name(){return"Box4.OutlineLevelEditors"}yb(a){Jv(a)}init(){}dispose(){}static main(){M.a.instance.Lb(new Kv)}}Object(w.a)(Kv,"Box4OutlineLevelEditorsPackage",
null,[1,2]);class Pr{constructor(a){this.vsd=null;this.l9h=a.Ga("OfficeOnlineChromeExtensionId");this.r9h=a.Ga("ChromeClipboardAccessExtensionId");this.uHl=a.$("OfficeOnlineChromeExtensionIsEnabled");this.AFg=!this.UOl();this.vsd=this.uhb?this.r9h:this.l9h}P1m(){this.vsd===this.l9h&&this.NTh&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.vsd=this.r9h;this.AFg=!0}get uhb(){return this.AFg}UOl(){if(this.uHl&&this.NTh){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");
if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&"true"===a}return!1}get NTh(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(c){r.ULS.sendTraceTag(19452045,307,50,c.toString())}return a}}Object(w.a)(Pr,"ChromeExtensionHelper",null,[937]);var Ht=b(1255),jj=b(475),zw=b(1213);
class js{create(a){return new zw.a(a)}}Object(w.a)(js,"Factory",null,[729]);var Xf=b(110);class Ju{constructor(a,c,h){this.Wyj=a;this.$b=c;this.jSa=h}eb(){this.jSa.Aa(zb.a.FUd,ic.a.application,this.FUd.bind(this),96);this.jSa.ka(zb.a.ddc,ic.a.view,this.vRn.bind(this));this.jSa.Aa(zb.a.Eli,ic.a.view,this.wRn.bind(this),96)}FUd(a,c,h,v,B){if(1===h)return 32;a=Object.assign(new Ah.a,{ExternalId:"StylesGalleryContextMenu",UpdateDynamically:!0,MenuSectionList:[]});c=[];h=Object.assign(new Hg.a,{ControlList:[]});
Array.add(h.ControlList,Object.assign(new qh.a,{ExternalId:"UpdateStyle",QueryCommand:"QueryUpdateStyle"}));c.push(h);Array.addRange(a.MenuSectionList,c);B.MenuItems=a;return 32}wRn(a,c,h,v,B){if(1===h)return 32;a=dl.a.RLi();null==a&&8;a=this.$b.pC(a);B[Jj.a.LabelText]=String.format(F.a.Wd(Box4Intl.Box4Strings.l_UpdateStyleCommand),a);return 32}vRn(a,c,h){a=dl.a.AAb(c);if(1===h||a)return a?8:32;h=new Map;h.set("Source","StyleContextMenuActor");h.set("Action","UpdateStyle");Fa.Health.instance.recordKpiUsage(Xf.a.Fjb,
0,Xf.a.pF,h);this.Wyj.zRn(c)?Sd.b(539842578,3018,50,"User Successfully Updated styles from UI"):(c=new Map,c.set("Source","StyleContextMenuActor"),c.set("Action","UpdateStyle"),c=Object.assign(new fi.a,{extendedProperties:c}),Fa.Health.instance.recordKpiFailure(Xf.a.Fjb,"UpdateStyleFailed",!1,!0,c),Sd.b(539842780,3018,50,"User tried to update a style via UI, but we were unable to update it."));return 32}}Object(w.a)(Ju,"StyleContextMenuActor",null,[]);var Vn=b(903),au=b(1322),Ps=b(433),Ku=b(1581);
class Vj extends Ku.a{constructor(a,c,h,v,B,X,ma=null,Pa=null){super(a,X,ma,Pa);this._formatting=this.kh=null;this.zEa=!1;this.fmb=l.AFrameworkApplication.K.$("FollowDestinationFormattingPasteIsEnabled");this.pob=0;this.Xrc=new Ua.a;Sd.a(8128527,307,Ta.OutlineElementReader.Gg(a));this.CJ=c;this.CJ.wUb(this);this.Zn=h;this.Oo=v;this.Yb=B;this.dNe=Pa;this.Tve=ab.ListReader.Pg(this.zb)}get paragraphEditor(){return this.kh||(this.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}get psd(){return null}get hWb(){return this.Tve&&
!this.CJ.yxa}get Eub(){return 0<this.pob}z9(a,c){if(!this.nZ.yZf(this.zb,c,!0)){Sd.a(8701077,307,sd.ParagraphReader.eg(this.zb));var h=this.zb.currentNode,v=Oe.a.av(h);this.fmb&&this._formatting.kO&&(h=h.la.last,this.zEa&&(h.formatting=this._formatting.kO.Ge(h),this.zEa=!1),a=this.nZ.zcf(a,c),this.nZ.YBa(this.zb.currentNode,this._formatting.J9,c));this.characterPropertiesEditor.replaceTextRange(v,a)}}JAa(){Sd.a(8701078,307,sd.ParagraphReader.eg(this.zb));const a=Oe.a.av(this.zb.currentNode);this.characterPropertiesEditor.Lca(a,
c=>new Ps.a(c))}efb(){this.nZ.Ecf(this.zb)}FAa(){this.fmb&&(this.zEa=!0)}vLa(){Sd.a(8701079,307,sd.ParagraphReader.eg(this.zb))}uLa(){Sd.a(8701080,307,sd.ParagraphReader.eg(this.zb))}iE(a){this.CJ.yxa||(this.fmb?(this.cKe(a),this._formatting.c6d(this.zb.currentNode),a&&"P"===a.Q4.wFd&&this.dNe.xea(this.zb.currentNode,this._formatting.cBa),this.nZ.YBa(this.zb.currentNode,this._formatting.J9,a)):this.fTj(a))}hE(){this.CJ.yxa||this.EAc()}ALa(){}lZa(){}MAa(){Sd.a(8701081,307,Ta.OutlineElementReader.Gg(this.zb)||
zj.OutlineReader.hv(this.zb)||sd.ParagraphReader.eg(this.zb)&&this.CJ.yxa);let a=!1;this.Eub||(a=this.hWb||!0);a||(this.kS+=1);this.pob++}KAa(){this.pob--;let a=!1;this.Eub||(a=this.hWb||!0,this.Oo.cKf(this.Xrc));a||--this.kS}zLa(a){Sd.a(8701082,307,Ta.OutlineElementReader.Gg(this.zb)||zj.OutlineReader.hv(this.zb)||sd.ParagraphReader.eg(this.zb)&&this.CJ.yxa);Sd.a(8701083,307,!!a.listStyleType)}LAa(){Sd.a(8701084,307,Ta.OutlineElementReader.Gg(this.zb)||sd.ParagraphReader.eg(this.zb)&&this.CJ.yxa);
this.CJ.yxa||Sd.a(8701085,307,this.zb.pp(2))}y9(a){this.CJ.y9(a)}v9(){this.CJ.v9()}O5d(a){this.Xrc.add(a)}x9(a){this.CJ.x9(a)}w9(){this.CJ.w9()}u9(a){this.CJ.u9(a)}t9(){this.CJ.t9()}fTj(a){this.H5b(!1);(new Kd.GraphIterator).Wb(this.zb);a=Ku.a.Wf.eM(this.zb,this.cEc(a));Sd.a(8128534,307,a===this.zb.currentNode);Sd.a(8128535,307,sd.ParagraphReader.tb(a))}EAc(){Sd.a(8128536,307,sd.ParagraphReader.eg(this.zb));ie.OutlineElementNavigator.Wc(this.zb)}reset(){this.fmb&&(super.reset(),this._formatting=this.U6e(!0))}cKe(a){this.H5b(!1);
(new Kd.GraphIterator).Wb(this.zb);a=Ku.a.Wf.eM(this.zb,this.cEc(a));Sd.a(36577367,307,a===this.zb.currentNode);Sd.a(36577368,307,sd.ParagraphReader.tb(a));-1!==this._formatting.Dr&&this.paragraphEditor.vB(a,this._formatting.Dr);this._formatting.lineSpacing&&this.dNe.sA(a,this._formatting.lineSpacing);this._formatting.kH&&this.dNe.P0d(a,this._formatting.kH);this.zEa=!0;this._formatting.paragraph=a}static Xqd(a,c){let h=0;switch(c){case 3:h=Of.a.YD(a);break;case 7:h=Be.a.ry(a,0);break;case 1:h=Of.a.YOe(a);
break;case 5:h=Of.a.YD(Of.a.JDf(a));break;default:r.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,c)}return h}}Object(w.a)(Vj,"TextOnlyBox4PasteSteward",Ku.a,[]);class Ap{constructor(a,c,h,v){this.Mob=a;this.Un=c;this.zc=h;this.nZ=v}create(a,c,h,v,B=null,X=null,ma=null){return 1===a?new Vj(c,v,this.Mob,this.Un,this.zc,B,X,this.nZ):new au.Box4PasteSteward(c,h,v,this.Mob,this.Un,this.zc,B,X,this.nZ,ma)}}Object(w.a)(Ap,"Box4PasteStewardFactory",
null,[731]);var hl=b(220),jq=b(372),Qs=b(646),il=b(455),Aw=b(703),Qr=b(267),Rr=b(1192);class ji{static get cwl(){return ji.ghj}static get jwl(){return ji.khj}static get hwl(){return ji.jhj}static get uf(){return ji.Ey||(ji.Ey=Nm.ContextSetEditor.instance)}static get uh(){return ji.ak||(ji.ak=xa.a.instance.resolve("Box4.ITableEditor"))}static kGm(a,c){const h=a.currentNode;Fe.forEachCell(a,c.rowSpan,c.colSpan,(v,B,X)=>{const ma=v.currentNode;ma!==h&&(ma.lf=!0,ji.Zch(v),!X&&1<=c.colSpan&&(ma.colSpan=
c.colSpan),ji.sBi(v,c.Kea,B,X,c.rowSpan,c.colSpan))})}static UGm(a,c){Fe.forEachCell(a,c.rowSpan,c.colSpan,h=>{ji.pPj(h);ji.Zch(h)})}static pPj(a){a=a.currentNode;a.lf=!0;a.J0=!0;a.zhb=!0}static Zch(a){a&&(a.Za(1),Object(Ub.a)(Qs.a,a.currentNode)&&a.xf())}static PPj(a,c,h){0<c&&(a=Object(ha.a)(hl.TableCellNode,a.currentNode))&&(a.width=h?c:Be.a.ym(c,0))}static COj(a,c,h){if(a=Object(ha.a)(jq.TableNode,a.currentNode))0<c&&(a.sk=Be.a.ry(c,0)),0<h&&(a.IM=Be.a.ry(h,0))}static NPj(a,c){void 0!==c&&null!==
c&&a.currentNode.properties.setValue(Yb.a.Lea,ji.jwl[c+""])}static oPj(a,c){void 0!==c&&null!==c&&""!==c&&(c=parseInt(au.Box4PasteSteward.Qtb(c),16),a.currentNode.properties.setValue(Ed.a.dI,c))}static xKj(a){if(!a)r.ULS.sendTraceTag(537997910,3022,15,"Table cell should not be null");else if(16==a.type){var c=new Kd.GraphIterator;c.set(a);if(c.La(14)){var h=Or.a(c),v=Tf.TableCellReader.oO(a);if(c.mc(14)){a=c.currentNode;var B=Wf.TableReader.Fia(c),X=Array.clone(B);c=Wf.TableReader.$Dc(c);var ma=0,
Pa=0;for(var mb=0;mb<B.length;mb++)mb>=h&&mb<h+v?c[mb]>B[mb]&&(ma+=c[mb]-B[mb],X[mb]=c[mb]):Pa+=B[mb]>c[mb]?B[mb]-c[mb]:0;if(Pa<ma)for(h=0;h<B.length;h++)X[h]=c[h];else for(mb=0;mb<B.length;mb++)(mb<h||mb>=h+v)&&B[mb]>c[mb]&&(X[mb]-=(B[mb]-c[mb])/Pa*ma);a.tU=X}}}}static Ikl(a){var c=new Kd.GraphIterator;c.Wb(a);if((a=Rm.OutlineNavigator.LMf(c))&&zj.OutlineReader.hv(c)){c=a.pg(Yb.a.Po);const h=a.pg(Yb.a.marginLeft);a=a.pg(Yb.a.marginRight);return c-h-a}return 0}static ZQl(a){return!(void 0===a||null===
a||1===a)}static ccn(a,c,h,v,B){if(void 0===c||null===c||""!==c){switch(c){case "thin":c=Of.a.vUd(.25);break;case "initial":case "medium":c=Of.a.vUd(.5);break;case "thick":c=Of.a.vUd(1);break;default:c=ji.Lgl(c,h,v)}B.currentNode.properties.setValue(a,c)}}static bcn(a,c,h){void 0!==c&&null!==c&&c&&h.currentNode.properties.setValue(a,ji.hwl[c+""])}static $bn(a,c,h){void 0!==c&&null!==c&&""!==c&&(c=parseInt(au.Box4PasteSteward.Qtb(c),16),h.currentNode.properties.setValue(a,c))}static Lgl(a,c,h){let v=
0,B=0;a=({unit:B}=au.Box4PasteSteward.IPc(a,B)).returnValue;switch(B){case 5:v=Of.a.vUd(a);break;case 1:v=Of.a.L2j(a);break;case 3:v=Of.a.QLh(a);break;case 7:v=Be.a.iBm(a,h)}if(6===c||7===c||10===c)v/=3;return Math.round(v)}static Mgl(a,c){let h=0,v=0;a=({unit:v}=au.Box4PasteSteward.IPc(a,v)).returnValue;switch(v){case 5:h=Of.a.osa(a);break;case 1:h=Of.a.XOe(a);break;case 3:h=Of.a.mza(a);break;case 7:h=Be.a.ym(a,c)}return h}static L_d(a,c,h,v,B,X,ma){if(B&&(!ma||16===B.Md||ma||14!==B.Md)&&12!==h){if(ma)switch(v){case 5:v=
Yb.a.Abc;var Pa=Yb.a.FHb;var mb=Yb.a.iib;var Tb=0;break;case 4:v=Yb.a.zbc;Pa=Yb.a.DHb;mb=Yb.a.hib;Tb=1;break;case 0:v=Yb.a.xbc;Pa=Yb.a.xHb;mb=Yb.a.dib;Tb=0;break;case 3:v=Yb.a.ybc;Pa=Yb.a.BHb;mb=Yb.a.fib;Tb=1;break;default:return}else switch(v){case 5:v=Yb.a.MHb;Pa=Yb.a.G0a;mb=Yb.a.NHb;Tb=0;break;case 4:v=Yb.a.KHb;Pa=Yb.a.F0a;mb=Yb.a.LHb;Tb=1;break;case 0:v=Yb.a.GHb;Pa=Yb.a.D0a;mb=Yb.a.HHb;Tb=0;break;case 3:v=Yb.a.IHb;Pa=Yb.a.E0a;mb=Yb.a.JHb;Tb=1;break;default:return}void 0!==B.currentNode&&null!==
B.currentNode&&(ji.ZQl(h)?(ji.$bn(v,a,B),ji.bcn(Pa,h,B),ji.ccn(mb,c,h,Tb,B)):X||ma||B.currentNode.properties.setValue(Pa,"nil"))}}static sBi(a,c,h,v,B,X){v||(ji.nTg(c,a,!1,!1),ji.AKe(c,a,!0,!1));v===X-1&&ji.AKe(c,a,!0,!1);h||ji.OTg(c,a,!0,!1);h===B-1&&ji.WSg(c,a,!0,!1)}static VSg(a,c,h,v){a&&(ji.OTg(a,c,h,v),ji.AKe(a,c,h,v),ji.WSg(a,c,h,v),ji.nTg(a,c,h,v))}static OTg(a,c,h,v){ji.L_d(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,5,c,h,v)}static AKe(a,c,h,v){ji.L_d(a.borderRightColor,a.borderRightWidth,
a.borderRightStyle,4,c,h,v)}static WSg(a,c,h,v){ji.L_d(a.borderBottomColor,a.borderBottomWidth,a.borderBottomStyle,0,c,h,v)}static nTg(a,c,h,v){ji.L_d(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,3,c,h,v)}static M_d(a,c,h){if(h&&16===h.Md&&""!==a){switch(c){case 3:c=Yb.a.sCa;var v=0;break;case 2:c=Yb.a.UM;v=1;break;case 0:c=Yb.a.qCa;v=0;break;case 1:c=Yb.a.VK;v=1;break;default:return}(a=ji.Mgl(a,v))&&h.currentNode.properties.setValue(c,a)}}static XNj(a,c){c&&(ji.GPj(c,a),ji.kPj(c,a),ji.cOj(c,
a),ji.NOj(c,a))}static GPj(a,c){ji.M_d(a.D2j,3,c)}static kPj(a,c){ji.M_d(a.C2j,2,c)}static cOj(a,c){ji.M_d(a.A2j,0,c)}static NOj(a,c){ji.M_d(a.B2j,1,c)}static hOj(a,c,h,v){var B=0;const X=Array(a.length);var ma=0;v&&(ma=(ma=Of.a.VZf(ji.Ikl(c)))?ma:1);for(v=0;v<a.length;v++)X[v]=0<ma?ma/100*a[v]:Be.a.ym(a[v],0),B+=X[v];a=h.getValue(Ed.a.Hw);v=new Kd.GraphIterator;v.Wb(c);c=0;if(Tf.TableCellReader.LX(v)){if(a=Fe.returnToContainingCell(v))c=a.width;ma=Or.a(v);v=Fe.returnToContainingTable(v);if(-1!==
ma&&ma<=v.tU.length){let Pa=0;for(let mb=ma;mb<ma+a.colSpan&&mb<v.tU.length;mb++)Pa+=v.tU[mb];c=Math.min(c,Pa);c===Pa&&(c-=Be.a.ym(ji.pgm,0))}}else if(a)for(ma=0;ma<a.length;ma++)c+=a[ma];if(0<c&&B>c&&B)for(B=c/B,c=0;c<X.length;c++)X[c]*=B;h.setValue(Ed.a.Hw,X)}static lPj(a,c){a.currentNode.setValue(Yb.a.MY,Be.a.ym(c,1))}static Oin(a){var c,h,v=a.Ca,B=a.If;a=ji.uf.mO(B,16);if(B=ji.uf.RQ(B,14))if(B=B.node,!B||14!==B.type)r.ULS.sendTraceTag(537507990,306,15,"Table node must be present");else if(!a)r.ULS.sendTraceTag(537507991,
306,15,"Cell context must be present");else{if(!((null===(h=null===(c=null===v||void 0===v?void 0:v.Fa)||void 0===c?void 0:c.Gd)||void 0===h?0:h.sa)&&v.Fa.Gd.sa.contextId===ic.a.LY&&il.TableBorderSelectionCache.mJa()&&0<il.TableBorderSelectionCache.mJa().length)){il.TableBorderSelectionCache.wHc(B);c=il.TableBorderSelectionCache.i5;c.leftMostColumnSelected=Number.MAX_SAFE_INTEGER;c.rightMostColumnSelected=Number.MIN_SAFE_INTEGER;c.topMostRowSelected=Number.MAX_SAFE_INTEGER;c.bottomMostRowSelected=
Number.MIN_SAFE_INTEGER;for(h=0;h<a.length;h++){if(a.getContext(h).contextId!==ic.a.tableCell)return;v=a.getContext(h).node;if(!Tf.TableCellReader.lq(v)){var X=new Kd.GraphIterator;X.set(v);if(X.La(14)&&Fe.getContainingTable(X)===B){X.mc(14);X=Tf.TableCellReader.rya(X,v);if(!X)return;Array.add(il.TableBorderSelectionCache.mJa(),new Aw.a(v,X.rowIndex,X.Km,v.rowSpan,v.colSpan));c.leftMostColumnSelected=Math.min(c.leftMostColumnSelected,X.Km);c.rightMostColumnSelected=Math.max(c.rightMostColumnSelected,
X.Km);c.topMostRowSelected=Math.min(c.topMostRowSelected,X.rowIndex);c.bottomMostRowSelected=Math.max(c.bottomMostRowSelected,X.rowIndex)}}}il.TableBorderSelectionCache.i5=c}}else r.ULS.sendTraceTag(537145810,306,15,"IP in table should be there")}static nxi(a){if(a&&14===a.type){var c=new Kd.GraphIterator;c.set(a);if(c.nc()){var h=a.tU,v=Wf.TableReader.$Dc(c),B=Fe.returnToContainingCell(c),X=Fe.getContainingTable(c);if(B&&X){var ma=Or.a(c),Pa=Tf.TableCellReader.oO(B);if(c.mc(14)){var mb=Wf.TableReader.Fia(c);
c=0;for(let Tb=ma;Tb<ma+Pa;Tb++)c+=mb[Tb];ma=tr.a.tO(B,X,Yb.a.VK,Yb.a.Ela,0);B=tr.a.tO(B,X,Yb.a.UM,Yb.a.jta,0);c-=Be.a.ym(ma+B,0);B=0;for(X=0;X<h.length;X++)B+=h[X];B=c/B;X=0;for(ma=0;ma<h.length;ma++)h[ma]*=B,h[ma]<v[ma]&&(h[ma]=v[ma]),X+=h[ma];X>c&&(h=Array.clone(v));v=new gf.GraphTransaction(4);v.Oa(a);a.tU=h;v.dispose()}}}}else r.ULS.sendTraceTag(524932511,3022,15,"Table node should not be null")}static Z_m(a){if(!a||!Wf.TableReader.qmf(a)||1!=a.ro())return r.ULS.sendTraceTag(525361986,3022,50,
"Outline iterator should contain a single table"),null;r.ULS.sendTraceTag(525361987,3022,50,"Pasting table over cell selection");let c=new Kd.GraphIterator;c.set(a.currentNode);c.La(14);ie.OutlineElementNavigator.Fd(c);let h=new Kd.GraphIterator;h.set(a.currentNode);h.La(14);if(!h.mc(14)||!c||14!=c.currentNode.type)return null;if(a=Fe.getContainingTableCell(c))if(a=Tf.TableCellReader.rya(h,a)){if(il.TableBorderSelectionCache.oFc())var v=this.lfl();else{v=Wf.TableReader.kf(c.currentNode)-(Wf.TableReader.kf(h.currentNode)-
a.rowIndex);var B=Wf.TableReader.Eg(c.currentNode)-(Wf.TableReader.Eg(h.currentNode)-a.Km);this.yFj(h,v,B);v=new Qr.a(a.Km,Wf.TableReader.Eg(h.currentNode)-1,a.rowIndex,Wf.TableReader.kf(h.currentNode)-1)}if(!v)return null;B=v.bottomMostRowSelected-v.topMostRowSelected+1;var X=v.rightMostColumnSelected-v.leftMostColumnSelected+1;B=Math.min(B,Wf.TableReader.kf(c.currentNode));X=Math.min(X,Wf.TableReader.Eg(c.currentNode));for(let ma=0;ma<B;ma++){Fe.moveToCell(h,ma+v.topMostRowSelected,v.leftMostColumnSelected);
Fe.moveToCell(c,ma,0);for(let Pa=0;Pa<X;Pa++)ma==a.rowIndex-v.topMostRowSelected&&Pa==a.Km-v.leftMostColumnSelected||this.r6h(c,h),Fe.moveToNextColumn(h),Fe.moveToNextColumn(c);h.Kr(14);c.Kr(14)}Fe.moveToCell(h,a.rowIndex,a.Km);a.rowIndex-v.topMostRowSelected<Wf.TableReader.kf(c.currentNode)&&a.Km-v.leftMostColumnSelected<Wf.TableReader.Eg(c.currentNode)?Fe.moveToCell(c,a.rowIndex-v.topMostRowSelected,a.Km-v.leftMostColumnSelected):c=null;this.r6h(c,h);h.Kr(14);Fe.moveToCell(h,v.topMostRowSelected,
v.leftMostColumnSelected);h.Xc();return h.currentNode}}static Pzm(a){if(a&&Wf.TableReader.qmf(a)&&1==a.ro()){var c=new Kd.GraphIterator;c.set(a.currentNode);a=Yk.a.va(a.currentNode);c.fn()&&a.fn()&&(ie.OutlineElementNavigator.J4(a,!1,!0),Ta.OutlineElementReader.Gg(a)&&1==a.ro()&&(ie.OutlineElementNavigator.Fd(c),ie.OutlineElementNavigator.Fd(a),c&&a&&c.currentNode!=a.currentNode&&Wf.TableReader.isTable(c)&&Wf.TableReader.isTable(a)&&this.hdm(c,a)&&(r.ULS.sendTraceTag(525361989,3022,50,"Pasting table below table"),
c.xf(),c.xf())))}else r.ULS.sendTraceTag(525361988,3022,50,"Outline iterator should contain a single table")}static r6h(a,c){if(c&&Tf.TableCellReader.isTableCell(c)){var h=c.ro();if(a&&Tf.TableCellReader.isTableCell(a))for(;a.fB();)a.Xc(),c.Je(a.currentNode,a.role),a.xf();else h--;for(;0<h--;)c.Xc(),c.xf()}}static hdm(a,c){if(!Wf.TableReader.isTable(a)||!Wf.TableReader.isTable(c))return!1;var h=Wf.TableReader.Eg(a.currentNode),v=Wf.TableReader.Eg(c.currentNode);if(h!=v)return r.ULS.sendTraceTag(525361990,
3022,50,"Number of columns in source and target table should be same"),!1;h=Wf.TableReader.kf(a.currentNode);v=Wf.TableReader.kf(c.currentNode);let B=new gf.GraphTransaction(4);B.Oa(c.currentNode);c.currentNode.setValue(Ed.a.hta,h+v);for(B.dispose();a.fB();){a.Xc();c.Je(a.currentNode,1);h=new Kd.GraphIterator;h.set(a.currentNode);a.xf();h.Xc();do h.currentNode&&16==h.currentNode.type&&(h.currentNode.E3=c.currentNode);while(h.Ns())}return!0}static yFj(a,c,h){ji.Hua=Rr.a.f_b;0<c&&(Fe.moveToLastRow(a),
r.ULS.sendTraceTag(523896290,307,50,"Begin insert rows: "+c),this.uh.insertRows(a,!1,c,this.Hua),r.ULS.sendTraceTag(523896291,307,50,"Completed inserting rows."),a.mc(14));0<h&&(r.ULS.sendTraceTag(523896320,307,50,"Begin insert columns: "+h),this.uh.insertColumns(a,Wf.TableReader.Eg(a.currentNode),!1,h,this.Hua),r.ULS.sendTraceTag(523896321,307,50,"Completed inserting columns."))}static lfl(){return il.TableBorderSelectionCache?il.TableBorderSelectionCache.i5:null}}ji.pgm=8;ji.Obh="Table Grid";ji.Ey=
null;ji.Hua=null;ji.ghj=Za.a.F1("MsoNormalTable","Normal Table","MsoTableGrid",ji.Obh,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3",
"MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6",
"MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3",
"MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6",
"Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful",
"Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1",
"MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4",
"List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1",
"List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4",
"List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5",
"MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6");
ji.khj=Za.a.F1("0","center","1","top","2","center","3","bottom");ji.jhj=Za.a.F1("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(w.a)(ji,"Box4TableStewardHelper",null,[]);class Mk{constructor(a,c,h){this.Kw=null;this.qob=0;this.C6=null;this.zb=a;this.uh=h}wUb(a){this.Kw=a}get yxa(){return 0<this.qob}y9(a){Sd.a(7869459,307,!!this.Kw);Sd.a(7869460,307,Ta.OutlineElementReader.Gg(this.zb)||zj.OutlineReader.hv(this.zb));
Sd.b(38563978,307,50,"Table pasting started");this.Kw.H5b(!0);const c=new Kd.GraphIterator;c.Wb(this.zb);var h=ji.cwl[a.styleId];h||(h=ji.Obh);h=this.uh.bQm(this.zb,a.rowCount,a.U8a,h,a.tableLook,this.Kw.cEc(a),a.aQh);a.DWf&&(Sd.b(573691298,3022,100,"Applying table border properties"),ji.VSg(a.DWf,this.zb,!1,!0));a.eGd&&(Sd.b(573691299,3022,100,"Applying indentation properties"),ji.COj(this.zb,a.eGd.spaceBefore,a.eGd.spaceAfter));a.Tpd&&(Sd.b(573691328,3022,100,"Applying column widths"),ji.hOj(a.Tpd,
this.zb,Object(ha.a)(jq.TableNode,h),a.TXa));this.Kw.qmd(c,!1);this.qob++;ab.ListReader.Pg(c)&&this.Kw.O5d(c.currentNode);Sd.a(7869461,307,Wf.TableReader.isTable(this.zb))}v9(){Sd.a(7869462,307,!!this.Kw);Sd.a(7869463,307,$m.a.isTableRow(this.zb));Sd.b(38563979,307,50,"Table pasting finished");this.u4&&this.zb.Kr(14)&&ji.nxi(this.zb.rm);ie.OutlineElementNavigator.Wc(this.zb);this.qob--}x9(a){Sd.a(7869464,307,!!this.Kw);Sd.b(573691329,3022,100,"Table row pasting started");Wf.TableReader.isTable(this.zb)?
Fe.moveToFirstRow(this.zb):$m.a.isTableRow(this.zb)&&Fe.moveToNextRow(this.zb);a.height&&(Sd.b(573691330,3022,100,"Applying table row height"),ji.lPj(this.zb,a.height));Sd.a(7869465,307,$m.a.isTableRow(this.zb))}w9(){Sd.a(7869466,307,!!this.Kw);Sd.a(7869467,307,Tf.TableCellReader.isTableCell(this.zb));Fe.returnToContainingRow(this.zb)}u9(a){Sd.a(7869468,307,!!this.Kw);Sd.a(7869469,307,!this.Kw.kS);$m.a.isTableRow(this.zb)?Fe.moveToFirstColumn(this.zb):Tf.TableCellReader.isTableCell(this.zb)?Fe.moveToNextColumn(this.zb):
Sd.a(7869471,307,!1);if(this.zb.currentNode){Sd.b(573691331,3022,100,"Table cell pasting started");var c=Object(ha.a)(hl.TableCellNode,this.zb.currentNode);Sd.a(50689760,307,!c&&16!==this.zb.currentNode.type||!!c&&16===this.zb.currentNode.type);if(c){var h=new Kd.GraphIterator;h.Wb(this.zb);if(a.x3b)Sd.b(573691332,3022,100,"Processing skipped cell"),ji.UGm(h,a);else{if(1<a.colSpan||1<a.rowSpan){const v=Fe.returnToContainingTable(h);if(!v)return;v.setValue(Yb.a.complexTable,!0);h.Wb(this.zb);Sd.b(573691333,
3022,100,"Processing merged cell");ji.kGm(h,a);c.rowSpan=a.rowSpan;c.colSpan=a.colSpan}ji.oPj(this.zb,a.shadingColor);ji.NPj(this.zb,a.verticalAlignment);ji.XNj(this.zb,a.o4d);ji.VSg(a.Kea,this.zb,!a.colSpan&&!a.rowSpan,!1);(new Kd.GraphIterator).Wb(this.zb);Fe.forEachCell(h,a.rowSpan,a.colSpan,(v,B,X)=>{Sd.b(573691334,3022,100,"Setting ghost cell borders");ji.sBi(v,a.Kea,B,X,a.rowSpan,a.colSpan)});ji.PPj(this.zb,a.width,a.TXa);Sd.a(7869472,307,zj.OutlineReader.hv(this.zb))}}}}t9(){Sd.a(7869473,307,
!!this.Kw);Sd.a(7869474,307,Ta.OutlineElementReader.Gg(this.zb)||Tf.TableCellReader.isTableCell(this.zb));Fe.returnToCell(this.zb);Sd.a(7869475,307,0>=this.Kw.kS);this.Kw.TPe()}get u4(){null==this.C6&&(l.AFrameworkApplication.Mg("he991617;3eed2178"),this.C6=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.C6}}Object(w.a)(Mk,"Box4TableSteward",null,[753,189]);class zs{constructor(a,c,h){this.Kw=
null;this.qob=0;this.zb=a;this.uh=h}wUb(a){this.Kw=a}get yxa(){return 0<this.qob}y9(){this.yxa&&(Sd.a(8787101,307,sd.ParagraphReader.eg(this.zb)),ie.OutlineElementNavigator.Wc(this.zb));Sd.a(8701086,307,!!this.Kw);Sd.a(8701087,307,Ta.OutlineElementReader.Gg(this.zb)||zj.OutlineReader.hv(this.zb));this.qob++}v9(){Sd.a(8701088,307,!!this.Kw);ie.OutlineElementNavigator.Wc(this.zb);this.qob--;if(this.yxa){this.Kw.H5b(!0);const a=zs.Wf.eM(this.zb);Sd.a(8787102,307,a===this.zb.currentNode);Sd.a(8787103,
307,sd.ParagraphReader.eg(this.zb))}}x9(a){Sd.a(8701089,307,!!this.Kw);this.Kw.H5b(!0);const c=new Kd.GraphIterator;c.Wb(this.zb);this.Kw.qmd(c,!1);ab.ListReader.Pg(c)&&this.Kw.O5d(c.currentNode);a=zs.Wf.eM(this.zb,this.Kw.cEc(a));Sd.a(8701090,307,a===this.zb.currentNode);Sd.a(8701091,307,sd.ParagraphReader.eg(this.zb))}w9(){Sd.a(8701120,307,!!this.Kw);Sd.a(8701121,307,sd.ParagraphReader.eg(this.zb));ie.OutlineElementNavigator.Wc(this.zb)}u9(){Sd.a(8701122,307,!!this.Kw);Sd.a(8701123,307,sd.ParagraphReader.eg(this.zb));
Sd.a(8701124,307,!this.Kw.kS);var a=this.zb.currentNode;sd.ParagraphReader.textLength(a)&&(a=Oe.a.av(a),this.Kw.characterPropertiesEditor.replaceTextRange(a,", "))}t9(){Sd.a(8701125,307,!!this.Kw);Sd.a(8701126,307,sd.ParagraphReader.eg(this.zb));Sd.a(8701127,307,0>=this.Kw.kS);this.Kw.TPe()}static get Wf(){return zs.Vd||(zs.Vd=xa.a.instance.resolve("Box4.IOutlineElementEditor"))}}zs.Vd=null;Object(w.a)(zs,"TextOnlyBox4TableSteward",null,[753,189]);class Lv{constructor(a,c,h=!1,v=!1){this.Un=a;this.ak=
c;this.hqj=h;this.pqj=v}create(a,c){return 1===a?new zs(c,this.Un,this.ak):new Mk(c,this.Un,this.ak,this.hqj,this.pqj)}}Object(w.a)(Lv,"Box4TableStewardFactory",null,[732]);class ix{create(){return new Yk.a}}Object(w.a)(ix,"Factory",null,[730]);class jx{constructor(a){this.ga=a}Wem(a){if(4===a)a=zb.a.hAa;else if(2===a)a=zb.a.iea;else if(1===a)a=zb.a.EIb;else if(3===a)a=zb.a.LUa;else return;this.ga.processAction(a,2)}A$a(){this.ga.processAction(zb.a.A$a,2)}}Object(w.a)(jx,"SelectionCommands",null,
[728]);var Lu=b(249),ig=b(963),bu=b(140),It=b(594);class cu{constructor(){this.VKc=!1;this.qVn=l.AFrameworkApplication.K.Ga("WordEditorVisiFontFileUri");this.sVn=l.AFrameworkApplication.K.Ga("WordEditorVisiRtlFontFileUri");this.rVn=l.AFrameworkApplication.K.Ga("WordEditorVisiPilcrowFontFileUri");this.nVn=l.AFrameworkApplication.K.Ga("WordEditorVisiCarriageReturnFontFileUri");this.pVn=l.AFrameworkApplication.K.Ga("WordEditorVisiCarriageReturnRtlFontFileUri")}wEn(){this.VKc=!this.VKc}vEn(a){this.wEn();
let c=a.getElementsByClassName("VisiFontStyle")[0],h=a.getElementsByClassName("VisiFontRtlStyle")[0],v=a.getElementsByClassName("VisiFontPilcrowStyle")[0],B=a.getElementsByClassName("VisiFontCarriageReturnStyle")[0],X=a.getElementsByClassName("VisiFontCarriageReturnRtlStyle")[0];c||(c=document.createElement("Style"),c.className="VisiFontStyle",ye.a.Ew(c,""),a.appendChild(c));h||(h=document.createElement("Style"),h.className="VisiFontRtlStyle",ye.a.Ew(h,""),a.appendChild(h));v||(v=document.createElement("Style"),
v.className="VisiFontPilcrowStyle",ye.a.Ew(v,""),a.appendChild(v));B||(B=document.createElement("Style"),B.className="VisiFontCarriageReturnStyle",ye.a.Ew(B,""),a.appendChild(B));X||(X=document.createElement("Style"),X.className="VisiFontCarriageReturnRtlStyle",ye.a.Ew(X,""),a.appendChild(X));if(this.VKc)return r.ULS.sendTraceTag(593294047,324,50,"Formatting markers are inserted"),this.zuc(c)&&this.zuc(h)&&this.zuc(v)&&this.zuc(B)&&this.zuc(X);r.ULS.sendTraceTag(593294046,324,50,"Formatting markers are removed");
return this.USc(c)&&this.USc(h)&&this.USc(v)&&this.USc(B)&&this.USc(X)}zuc(a){return""===ye.a.hy(a)?("VisiFontStyle"===a.className?ye.a.Ew(a,this.uDc("WordVisi_MSFontService",this.qVn)):"VisiFontRtlStyle"===a.className?ye.a.Ew(a,this.uDc("WordVisiRtl_MSFontService",this.sVn)):"VisiFontPilcrowStyle"===a.className?ye.a.Ew(a,this.uDc("WordVisiPilcrow_MSFontService",this.rVn)):"VisiFontCarriageReturnStyle"===a.className?ye.a.Ew(a,this.uDc("WordVisiCarriageReturn_MSFontService",this.nVn)):"VisiFontCarriageReturnRtlStyle"===
a.className&&ye.a.Ew(a,this.uDc("WordVisiCarriageReturnRtl_MSFontService",this.pVn)),!0):!1}USc(a){return""!==ye.a.hy(a)?(ye.a.Ew(a,""),!0):!1}uDc(a,c){return"@font-face { font-family: "+a+"; src: url('"+c+"'); unicode-range: U+0020, U+00A0, U+200B, U+2003; font-display: swap; }"}}Object(w.a)(cu,"VisiMarkersOperation",null,[720]);var Xo=b(1354),qk=b(833);class Er extends Xo.a{constructor(a,c){super(a,c);this.qme=-1;this.cmb=0;this.gje=null;this.Omg=!1;this.rke=[];this.M9c=!1;this.Zvg=!0;this.nue=
this.v7c=null;this.preventDismissOnScroll=this.XUd=this.U7b=!1;this.J3=null;this.Eid=!1;this.dGc=!0;this.nt=!1;this.Zog=l.AFrameworkApplication.K.$("FloatieLightDismissIsEnabled");Er.eCg||(l.AFrameworkApplication.pa.ka(Sa.a.showFloatie,Kc.a.frame,Le.ActionManager.De),Er.eCg=!0)}get Umh(){return this.WL}set Umh(a){this.WL=a}get rPi(){return this.Eid}get cHc(){return this.Omg}set cHc(a){this.Omg=a;this.cmb=0}get By(){return!0}get cssClass(){return l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.s4?
"cui-floatie MLRVisualRefresh":"cui-floatie"}get isVisible(){return this.nt}XMa(){for(let a of this.children)if(a.XMa())return!0;return!1}get g5(){return 9}Je(a){this.rke[this.rke.length]=a;super.Je(a)}Yk(){super.Yk();De.c(this.Hb)&&this.Xz();this.Hb=Zd.a.vMa(this.Hb);this.mU(this.Hb);this.dirty=!1}y6b(a){3===a.He||this.XUd||this.Ty(a);return!1}B6b(){return!1}z6b(a){3!==a.He&&this.dGc&&!this.U7b&&this.IPn(a);return!1}A6b(){return!1}w6b(a){3===a.He&&this.Ty(a);return!1}x6b(a){void 0!==this.J3&&null!==
this.J3||this.preventDismissOnScroll||this.Ty(a);return!1}uC(){this.M_e();return!1}tRd(){this.cHc=!0}IPn(a){if(a=uf.a.uXb(a.clientPoint,this.gje)){if(this.cHc){if(!this.cmb||a<this.cmb)this.cmb=a;a-=this.cmb}a-=this.qme;0>a&&(a=0);const c=255-4*a;0>=c&&63.75<=a?this.Ty():H.a.setOpacity(this.Hb,Math.max(c/255,0))}else this.cHc=!1,this.cmb=0,H.a.setOpacity(this.Hb,1)}hOn(a){let c=null;void 0!==this.v7c&&null!==this.v7c&&(c=this.v7c(a));a=null;for(const h of this.rke){let v=!this.rPi&&h.GXh;if(!v&&void 0!==
c&&null!==c)for(let B=0;B<c.length;B++)if(h.id===c[B]){v=!0;break}h.Hb.style.display=v?"none":"";h.sXb=!v;v||(a=h)}a&&(a.sXb=!1)}$uh(){const a=this.Hb.style.top,c=this.Hb.style.left;this.Hb.style.top="0px";this.Hb.style.left="0px";const h=this.Ywb();this.Hb.style.top=a;this.Hb.style.left=c;return h}Ywb(){const a=this.Hb.style.visibility,c=this.Hb.style.display;this.Hb.style.visibility="hidden";this.Hb.style.display="";const h=Ve.a.getElementBounds(this.Hb);this.Hb.style.display=c;this.Hb.style.visibility=
a;return h}ooi(a){3===a||this.H5d?(Sys.UI.DomElement.addCssClass(this.Hb,qk.a.Hib),this.Eid=!0):(Sys.UI.DomElement.removeCssClass(this.Hb,qk.a.Hib),this.Eid=!1);this.hOn(a)}h0a(a,c,h,v=!1){this.isVisible||(this.J3||!this.Zvg&&this.preventDismissOnScroll||(this.Zvg=!1,Ve.a.qOd("ShowLegacyFloatie",""),l.AFrameworkApplication.pa.processAction(Sa.a.showFloatie,2)),this.ooi(h),this.dGc=!0,this.cmb=0,this.cHc=!1,!this.Zog||void 0!==this.J3&&null!==this.J3?(this.M9c=!1,this.sba(this,!1)):(this.M9c=!0,this.eTj(this)),
c=v?a:this.DCm(a,c),this.Hb.style.top=c.y.toString()+"px",this.Hb.style.left=c.x.toString()+"px",this.ps(),this.gje=this.Ywb(),this.qme=uf.a.uXb(a,this.gje),H.a.setOpacity(this.Hb,1),this.Hb.style.zIndex=String(l.AFrameworkApplication.na.yoa),this.Hb.style.display="",this.nt=!0)}DCm(a,c){const h=this.rPi?30:17,v=this.$uh(),B=ye.a.nWa(),X=ye.a.z8();a=new Sys.UI.Point(a.x,a.y);1===c?a.y-=v.height:3===c?(a.y-=v.height,a.x-=v.width):2===c&&(a.x-=v.width);a.x+v.width>B&&(a.x=Math.floor(B-v.width));0>a.x&&
(a.x=0);a.y=3===c||1===c?a.y-h:a.y+h;0>a.y&&(a.y=0);a.y+v.height>X&&(a.y=X-v.height);return a}ECm(a,c){const h=a.Z4h;if(h){this.ooi(c);var v=this.$uh();this.J3=a;a=h.a2f-h.aCc>v.width;var B=h.aCc+h.W2e>v.width,X=h.JYb>v.height+17,ma=h.pYi-(h.JYb+h.T2e)>v.height+17;v=new Sys.UI.Point(h.aCc,h.JYb);B||a||(B=!0,v.x=h.a2f);a=h.Bdb?h.iof?ma?B?2:0:B?3:1:X?B?3:1:B?2:0:h.iof?ma?a?0:2:a?1:3:X?a?1:3:a?0:2;if(3===a||2===a)v.x=h.aCc+h.W2e;if(2===a||0===a)v.y=h.JYb+h.T2e;this.h0a(v,a,c);this.dGc=!1;c=this.J3.TGe.Hb;
void 0!==c&&null!==c&&(c.style.zIndex=String(l.AFrameworkApplication.na.yoa))}}U_(){let a=super.U_();this.Ty()&&(a=!0);return a}Ty(a=null){if(!this.isVisible)return!1;void 0!==this.Etc&&null!==this.Etc&&this.Etc.Dpa(null);void 0!==this.J3&&null!==this.J3&&this.J3.Cba();this.Cba();this.Zog&&this.M9c?this.PAk(this):this.b8(this,!1);this.M9c=!1;this.qme=-1;this.J3=null;this.Hb.style.display="none";this.nt=!1;this.nue&&this.nue(a);return!0}M_e(){void 0!==this.J3&&null!==this.J3&&(this.J3.HSa=null,this.J3.Cba(),
this.J3=null,this.IOd.style.zIndex=String(l.AFrameworkApplication.na.hwa),this.Hb.style.zIndex=String(l.AFrameworkApplication.na.yoa))}rSm(a){this.v7c=a}cTm(a){this.nue=a}set By(a){super.By=a}}Er.eCg=!1;Object(w.a)(Er,"Floatie",Xo.a,[630,358,359]);class jk{constructor(a,c){this.It=this.wEa=null;this.x2h=a;this.pwi=c}get Wmh(){return this.wEa}Ckn(a){this.wEa=a}Ywb(){return this.It.Ywb()}Yqa(){return this.It?this.It.isVisible:!1}ZVg(a){this.Ckn(a)}showFloatie(a,c){this.h0a(c.location,c.wF,c.isRtl)}h0a(a,
c,h){h=h?this.pwi:this.x2h;this.dvd();this.It&&this.It.h0a(a,h,c)}Ty(){this.It&&this.It.Ty()}dvd(){this.wEa&&!this.It&&(this.It=Object(ha.a)(Er,this.wEa()))}Pvd(){}}Object(w.a)(jk,"AFloatieManager",null,[746]);class Sy extends jk{constructor(){super(1,3);this.ONi=!1;this.Tch=""}h0a(a,c,h){h=h?this.pwi:this.x2h;this.dvd();this.It&&(this.It.isVisible&&this.It.Ty(),this.ONi||this.It.yk(),this.It.h0a(a,h,c,!0))}dvd(){this.Wmh&&!this.It&&(this.It=this.wEa())}Pvd(){if(this.It&&this.It.isVisible){const a=
Object(ha.a)(Fm.Control,this.It.controls["PasteFloatie.FlyoutAnchor"]);a.behavior.ev(a.zab(),1,null)}}DPf(a){this.Tch=a}ajb(a,c,h){if(this.It){const v=this.It.controls[this.Tch];v&&(v.Gc[bl.a.labelText]=a,v.Gc[bl.a.alt]=c,h&&v.behavior.yk())}}}Object(w.a)(Sy,"PasteFloatieManager",jk,[]);var Bu=b(912);class as{constructor(){this.Jc=null}get $u(){return null}getTitle(){return null}Dth(){return null}reset(a){this.Jc=a.node}ICa(a){a=ac.d(this.Jc,a);let c=null;if(!a||a.nh!==this.nh)return{returnValue:!1,
bF:c};c=Object.assign(new Bu.a,{mE:this.key,contentObject:a,title:this.getTitle(a),description:this.Dth(a)});return{returnValue:!0,bF:c}}}Object(w.a)(as,"BlobDetailsProvider",null,[430,431]);class Ev extends as{constructor(){super()}get key(){return"EQUATION"}get nh(){return 11}get $u(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(w.a)(Ev,"EquationDetailsProvider",as,[]);class ax{constructor(){this.vmg=null}get key(){return"LINK"}get $u(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.vmg=
ch.HyperlinkReader.JDc(a.node)}ICa(a){let c=null;for(const h of this.vmg)if(h.cpBegin<=a&&a<h.cpEnd)return c=Object.assign(new Bu.a,{mE:this.key,contentObject:h.hyperlink}),{returnValue:!0,bF:c};return{returnValue:!1,bF:c}}}Object(w.a)(ax,"HyperlinkDetailsProvider",null,[430,431]);var bt=b(1191),uw=b(806);class Ty{constructor(){this.hrg=!1}get key(){return"IFRAMENODE"}get $u(){return this.hrg?Box4Intl.Box4Strings.l_IFrameVideoTitle:Box4Intl.Box4Strings.l_IFrameWebContentTitle}Icc(a){let c=null;a=
a?sd.ParagraphReader.Jab(a.currentNode):null;if(!a)return{returnValue:!1,Jha:c};c=Object.assign(new bt.a,{mE:this.key,contentId:a.id,contentObject:a});return{returnValue:!0,Jha:c}}Lwb(a,c){a=a?Object(ha.a)(uw.a,a.contentObject):null;c=c?Object(ha.a)(uw.a,c.contentObject):null;let h="";c&&a.id===c.id||(this.hrg=a.dYa,h=String.format(Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,a.$u,this.$u));return h}}Object(w.a)(Ty,"IFrameDetailsProvider",null,[745,431]);class pr extends as{constructor(){super()}get key(){return"IMAGE"}get nh(){return 5}get $u(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return dd.ImageReader.Z3(a.properties)}Dth(a){return dd.ImageReader.PVa(a.properties)}}
Object(w.a)(pr,"ImageDetailsProvider",as,[]);class Ag{get key(){return"IMAGENODE"}get $u(){return Box4Intl.Box4Strings.l_ImageContentTitle}Icc(a){let c=null;if(!a||!dd.ImageReader.ix(a.currentNode))return{returnValue:!1,Jha:c};c=Object.assign(new bt.a,{mE:this.key,contentId:a.currentNode.id,contentObject:a.currentNode});return{returnValue:!0,Jha:c}}Lwb(a,c){a=a.contentObject;const h=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;let v="";c&&a.id===c.contentObject.id||(v=String.format(h,dd.ImageReader.Z3(a.properties),
Box4Intl.Box4Strings.l_ImageContentTitle));return v}}Object(w.a)(Ag,"ImageNodeDetailsProvider",null,[745,431]);let ip,Ks;class Jm{constructor(a,c){this.mhg=null;this.Fj=c;this.gxe=a;this.key=Jm.keys.J(a);this.$u=Jm.$ck.J(a)}reset(a){this.mhg=this.Fj.l0(a.node)}ICa(a){var c=Jm.XJk(this.mhg||[],h=>this.OIl(a,h));c=this.Ygk(c);return{returnValue:!!c,bF:c}}OIl(a,c){return c.begin<=a&&a<c.end&&(!c.errorDetails||this.gxe===c.errorDetails.proofingType)}Ygk(a){return a?Object.assign(new Bu.a,{mE:this.key,
contentObject:a.errorDetails,description:this.wab()}):null}wab(){return l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static XJk(a,c){for(const h of a)if(c(h))return h;return null}}Jm.keys=(Ks=new gd.a,Ks.add(1,"SPELLINGERROR"),Ks.add(2,"GRAMMATICALERROR"),Ks.add(3,"ADVANCEDERROR"),Ks);Jm.$ck=(ip=new gd.a,ip.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),ip.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),
ip.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),ip);Object(w.a)(Jm,"ProofingDetailsProvider",null,[430,431]);class Cu{constructor(){this.tableNode=null;this.Rpd=this.zZd=this.columns=this.rows=0}}Object(w.a)(Cu,"TableInfo",null,[]);class Io{get key(){return"TABLE"}get $u(){return Box4Intl.Box4Strings.l_TableContentTitle}Icc(a){var c=null;if(!Tf.TableCellReader.isTableCell(a))return{returnValue:!1,Jha:c};c=new Kd.GraphIterator;c.Wb(a);a=new Cu;a.zZd=$m.a.ir(c)+1;a.Rpd=Or.a(c)+1;
Fe.returnToContainingTable(c);a.tableNode=c.currentNode;a.columns=Wf.TableReader.Eg(a.tableNode);a.rows=Wf.TableReader.kf(a.tableNode);c=Object.assign(new bt.a,{mE:this.key,contentId:a.tableNode.id,contentObject:a});return{returnValue:!0,Jha:c}}Lwb(a,c){a=a.contentObject;const h=new Kh.a;c||h.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));c&&c.contentObject.Rpd===a.Rpd||h.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.Rpd));c&&c.contentObject.zZd===
a.zZd||h.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.zZd));return h.toArray().join(" ")}}Object(w.a)(Io,"TableDetailsProvider",null,[745,431]);class Uh{constructor(a,c){this.BEa=a;this.Fj=c}aJf(){this.BEa.execute(a=>{a.j1(new ax);a.j1(new Jm(1,this.Fj));a.j1(new Jm(2,this.Fj));a.j1(new Jm(3,this.Fj));a.j1(new Ev);a.j1(new pr);a.L8b(new Io);a.L8b(new Ag);a.L8b(new Ty)})}}Object(w.a)(Uh,"AccessibilityActor",null,[]);class Li{constructor(a,c,h){this.jSa=a;this.B8i=h}eb(){this.jSa.Aa(zb.a.lei,
ic.a.view,Object(m.a)(this,this.Xum,"openAutoCorrectOptionsView"),1028)}Xum(a,c,h){if(1===h)return 32;this.B8i().tTf();return 32}}Object(w.a)(Li,"AutoCorrectActor",null,[]);var Ik=b(1729);class Xt{constructor(){this.nOd=!0}Wra(){}nZa(){}wUb(){}Rzf(){}k0d(){}get D7b(){return!1}get Deb(){return 0}get z4h(){return!1}get S_(){return Ya.a.nil}}Object(w.a)(Xt,"TextOnlyBox4ImageSteward",null,[744]);class Ls{constructor(a,c,h,v,B,X,ma=!1,Pa=!1,mb=!1,Tb=!1){this.Og=a;this.Ta=c;this.Xi=h;this.Dkc=v;this.FW=
B;this.T5a=ma;this.Ove=Pa;this.Ple=mb;this.Fre=Tb;this.Na=X}create(a,c,h,v){return 1===a?new Xt:new Ik.a(c,this.Og,this.Ta,this.Xi,this.Na,this.Dkc,this.FW,this.T5a,this.Ove,this.Ple,this.Fre,h,v)}}Object(w.a)(Ls,"Box4ImageStewardFactory",null,[719]);var lh=b(45);class bx{constructor(a){this.FJd=a}pPl(a){if(!a||!a.$y||1>a.$y.count)return!1;const c=[lh.a.hah,lh.a.gah];return!!this.zyd(a.$y,1,h=>this.yqd(h,c))}FRh(a){return!a||!a.$y||1>a.$y.count?!1:!!this.zyd(a.$y,1,c=>this.yqd(c,[lh.a.GG]))}FMl(a){return!a||
!a.$y||1>a.$y.count?!1:!!this.zyd(a.$y,2,c=>this.yqd(c,[lh.a.HLd]))}eg(a){return!a||!a.$y||1>a.$y.count?!1:!!this.zyd(a.$y,1,c=>this.yqd(c,[lh.a.xV]))}EId(a){if(!a||!a.$y)return!1;a=a.$y;for(let c=0;c<a.count;++c)if(!a.J(c)||0<a.J(c).yRj)return!1;return!0}mDk(a,c){return this.FRh(c)||this.FMl(c)?"":a}zyd(a,c,h){if(a&&0<a.count)for(let v=a.count-1;0<=v;--v){if(h(a.J(v)))return a.J(v);if(a.count-v>=c)break}return null}yqd(a,c){a=a&&a.QKh?a.QKh.split(" "):null;if(!a)return!1;for(const h of c)if(0<=Array.indexOf(a,
h))return!0;return!1}}Object(w.a)(bx,"Box4PasteStewardUtils",null,[718]);var Cp=b(659);class gv{constructor(){this.F_h={};this.usd=-1}}Object(w.a)(gv,"LevelLists",null,[]);class ho{constructor(a,c,h){this.N5=this.level=0;this.qkh=null;this.w7b=!1;this.level=a;this.Ndc=c;this.Qei=h}}Object(w.a)(ho,"ListItemMetadata",null,[]);class lv{constructor(){this.N5=0;this.tagName="UL";this.NBc=null;this.ignore=!1;this.UNc=0}}Object(w.a)(lv,"ListMetadata",null,[]);class lj{constructor(a){this.nodes=a;this.Q_=
0;this.lists={};this.Yja=[];this.s4b=null;this.sxa=[];this.sxa[0]=new gv}}Object(w.a)(lj,"WordConverterArguments",null,[]);var uo=b(1352);class Ll{constructor(a=null){this.kbd=1;this.gU=a||uo.a.Abf("")}get Db(){return this.gU}process(a,c){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&0<a.length&&(a=new Cp.a(c,Object(m.a)(this,this.AFf,"processNodesDiscovery"),new lj(a)),a.jk("Word Converter Operation"),a.fg=!c||c.fg,a.run())}AFf(a,c){const h=c.nodes[c.Q_];var v=Ll.J8e(h);if(v){let B=c.sxa[v.level-
1];B||(B=new gv,c.sxa[v.level-1]=B);c.s4b&&Ll.EEc(h)!==c.s4b&&Ll.K1m(c);let X=B.F_h[v.Ndc];if(!X)X=new lv,X.N5=this.kbd++,X.NBc=Ll.s7e(h,5),X.ignore=!X.NBc||!X.NBc.length,X.tagName=Ll.zzd(X.NBc),B.F_h[v.Ndc]=X,c.lists[X.N5.toString()]=X;else if(!X.ignore&&1===X.UNc){const ma=Ll.s7e(h,5);X.tagName=X.NBc===ma?"UL":"OL"}v.N5=X.N5;X.ignore||"OL"===X.tagName&&0<X.UNc&&B.usd!==v.N5?(X.ignore=!0,c.sxa[0].usd=-1,c.sxa=c.sxa.slice(0,1)):(c.sxa.length>v.level&&(c.sxa=c.sxa.slice(0,v.level)),B.usd=v.N5,c.Yja[c.Yja.length]=
v,X.UNc++);c.s4b=h}else if((v=c.s4b)&&Ll.EEc(h)===v&&h.tagName===v.tagName&&h.className===v.className){v.appendChild(v.ownerDocument.createElement("BR"));for(v.appendChild(v.ownerDocument.createElement("BR"));h.firstChild;)v.appendChild(h.firstChild);h.parentNode.removeChild(h)}c.Q_++;if(c.nodes.length<=c.Q_){if(!c.Yja.length)return!1;c.Q_=0;a.wh(Object(m.a)(this,this.zFf,"processNodeConvert"))}return!0}zFf(a,c){var h=c.Yja[c.Q_];a=h.Qei;const v=c.lists[h.N5.toString()];if(!v.ignore&&(h=Ll.z9k(a,
h,v))){Ll.xwc(a,5);const B=a.ownerDocument.createElement("LI");for(;a.firstChild;)B.appendChild(a.firstChild);h.appendChild(B);a.parentNode.removeChild(a);"UL"===v.tagName?this.Db.b++:this.Db.c++}c.Q_++;return c.Q_<c.Yja.length}static z9k(a,c,h){let v=Ll.coi(a,c.level,h);const B=Di.a.Ra(v,"UniqueListId");if(B&&B!==c.N5||!B&&v.firstChild)a=a.ownerDocument.createElement(h.tagName),v.parentNode.insertBefore(a,v.nextSibling),v=a;Di.a.Gl(v,"UniqueListId",c.N5);return Ll.LSe(v,h)}static LSe(a,c){if(c.tagName!==
a.tagName){c=a.ownerDocument.createElement(c.tagName);for(Di.a.Gl(c,"UniqueListId",Di.a.Ra(a,"UniqueListId"));a.firstChild;)c.appendChild(a.firstChild);a.parentNode.insertBefore(c,a);a.parentNode.removeChild(a);a=c}return a}static coi(a,c,h){let v=null,B;1===c?B=Ll.EEc(a):(v=Ll.coi(a,c-1,null),B=v.lastChild);if(B&&1===B.nodeType){const X=B.tagName.toUpperCase();if("UL"===X||"OL"===X)return B}h=a.ownerDocument.createElement(h?h.tagName:"UL");1===c?a.parentNode.insertBefore(h,a):v.appendChild(h);return h}static xwc(a,
c){for(let h=0;h<a.childNodes.length;h++){const v=a.childNodes[h];1===v.nodeType&&1<c&&Ll.xwc(v,c-1);if(Ll.Hif(v)||Ll.mJc(v))a.removeChild(v),h--}}static J8e(a){if(1===a.nodeType){const c=Ll.S_b(a,"mso-list");if(c&&0<c.length)try{const h=c.split(" ");if(3===h.length){const v=Number.parseInvariant(h[1].substr(5));return new ho(v,c,a)}}catch(h){}}return null}static zzd(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static s7e(a,c){let h=null;for(let v=0;!h&&v<a.childNodes.length;v++){const B=
a.childNodes[v];Ll.mJc(B)?(h="string"===typeof B.innerText?B.innerText.trim():B.textContent.trim(),h.length||(h="o")):1===B.nodeType&&1<c&&(h=Ll.s7e(B,c-1))}return h}static mJc(a){return 1===a.nodeType&&(a=Ll.S_b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static Hif(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static S_b(a,c){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(c)){a=a.split(";");for(let h=0;h<a.length;h++){const v=a[h].split(":");
if(2===v.length&&v[0].trim()===c)return v[1].trim()}}return null}static EEc(a){do a=a.previousSibling;while(a&&Ll.QIc(a));return a}static QIc(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(Ll.ire,""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:Ll.QIc(a.firstChild):!0}static K1m(a){for(let c=0;c<a.sxa.length;c++){const h=a.sxa[c];h&&(h.usd=-1)}}}Ll.ire=RegExp("[\n|\r]","gi");Object(w.a)(Ll,"WordConverter",null,[187]);class xk{constructor(){this.N5=
0;this.L4b=Array(9)}}Object(w.a)(xk,"FullListMetadata",null,[]);var Zq=b(918);class Hd{constructor(){this.level=0;this.tagName="UL";this.jeb=null;this.ignore=!1;this.UNc=0;this.listStyle="BulletListStyle1";this.Yja=new Zq.a;this.font=this.levelText=""}}Object(w.a)(Hd,"ListLevelMetadata",null,[]);var Yt=b(1224),Oh=b(545);class Hm{constructor(a=null){this.gU=a||uo.a.Abf("");this.kbd=Number.parseInvariant((new Date).format("HHmmss"))}get Db(){return this.gU}process(a,c){if(a&&a.querySelectorAll){const X=
a.querySelectorAll("p");if(X&&0<X.length){for(var h=0,v=!1,B=X[0].parentNode;5>h&&B&&B!==a;){h++;const ma=B.id.toLowerCase();if(ma&&ma.length&&-1!==ma.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(B,"WACEditing")&&Sys.UI.DomElement.containsCssClass(B,"EditingSurfaceBody")){v=!0;break}B=B.parentNode}if(v&&B!==a){h=a.firstChild;for(v=!1;0<B.children.length&&B.children[0]!==h;)a.insertBefore(B.children[0],h),v=!0;if(v)for(;h;)B=h.nextSibling,a.removeChild(h),h=B}a=new Cp.a(c,Object(m.a)(this,
this.AFf,"processNodesDiscovery"),new lj(X));a.jk("Word Converter Operation");a.fg=!c||c.fg;a.run()}}}AFf(a,c){const h=c.nodes[c.Q_];var v=Hm.J8e(h);if(v){let X=v.Ndc.replace(RegExp("level[0-9]"),"").trim();X=X&&X.length?X:v.Ndc;let ma=c.lists[X];ma||(ma=new xk,ma.N5=this.kbd++);let Pa=ma.L4b[v.level-1];Pa||(Pa=new Hd,Pa.level=v.level);var B=h.parentNode;if(B&&"li"===B.tagName.toLowerCase()){if(B=B.parentNode)!(B=B.tagName.toUpperCase())||"OL"!==B&&"UL"!==B||(Pa.tagName=B)}else Pa.jeb=Hm.uuh(h,5),
Pa.jeb&&Pa.jeb.length||(Pa.jeb=Hm.maf(h,5)),Pa.ignore=!Pa.jeb||!Pa.jeb.length,Pa.tagName=Hm.zzd(Pa.jeb),"UL"===Pa.tagName&&(Pa.font=this.gvh(h,5));v.N5=ma.N5;Pa.UNc++;Pa.ignore||"li"===h.parentNode.tagName.toLowerCase()||(B=(B=Hm.maf(h,5))?B:Pa.jeb)&&B.length&&(v.qkh=B,(B=Hm.fgn(h,B,Pa.listStyle,v.level-1))&&B.length&&(Pa.listStyle=B));c.Yja[c.Yja.length]=v;Pa.Yja.contains(v)||Pa.Yja.add(v);if(void 0===ma.L4b[v.level-1]||null===ma.L4b[v.level-1]||ma.L4b[v.level-1]!==Pa)ma.L4b[v.level-1]=Pa;c.lists[X]&&
c.lists[X]===ma||(c.lists[X]=ma);c.s4b=h}else if((v=c.s4b)&&Hm.EEc(h)===v&&h.tagName===v.tagName&&h.className===v.className){v.appendChild(v.ownerDocument.createElement("BR"));for(v.appendChild(v.ownerDocument.createElement("BR"));h.firstChild;)v.appendChild(h.firstChild);h.parentNode.removeChild(h)}c.Q_++;if(c.nodes.length<=c.Q_){if(!c.Yja.length)return!1;c.Q_=0;a.wh(Object(m.a)(this,this.zFf,"processNodeConvert"))}return!0}zFf(a,c){a=c.Yja[c.Q_];var h=a.Qei,v=a.Ndc.replace(RegExp("level[0-9]"),
"").trim();v=v&&v.length?v:a.Ndc;v=c.lists[v];var B=v.L4b[a.level-1],X=h.parentNode.tagName.toLowerCase();if(!B.ignore&&h.parentNode&&"li"!==X){if(X=Hm.hjk(h,B)){Hm.xwc(h,5);const ma=h.ownerDocument.createElement("LI");ma.setAttribute("data-aria-level",String.format("{0}",a.level));ma.setAttribute(Oh.a.WLc,String.format("{0}",v.N5));"UL"===B.tagName&&(ma.setAttribute(Oh.a.RLd,String.format("{0}",a.qkh)),ma.setAttribute(Oh.a.Pof,String.format("{0}",B.font)));for(;h.firstChild;)ma.appendChild(h.firstChild);
X.appendChild(ma);h.parentNode.removeChild(h);"UL"===B.tagName?this.Db.b++:this.Db.c++}}else"li"===X&&(B=B.tagName,h=h.parentNode,a.w7b&&(a=h.parentNode)&&a.tagName.toUpperCase()===B&&a.setAttribute("data-pasteFromRc","true"),h.setAttribute(Oh.a.WLc,String.format("{0}",v.N5)),"UL"===B?this.Db.b++:this.Db.c++);c.Q_++;return c.Q_<c.Yja.length}gvh(a,c){let h=null;for(let v=0;!h&&v<a.childNodes.length;v++){const B=a.childNodes[v];h=Hm.$0k(B);!h&&1===B.nodeType&&1<c&&(h=this.gvh(B,c-1))}return h}static hjk(a,
c){a=Hm.fjk(a,c.tagName);return Hm.LSe(a,c)}static LSe(a,c){if(c.tagName!==a.tagName){for(c=a.ownerDocument.createElement(c.tagName);a.firstChild;)c.appendChild(a.firstChild);a.parentNode.insertBefore(c,a);a.parentNode.removeChild(a);a=c}return a}static fjk(a,c){c=a.ownerDocument.createElement(c?c:"UL");var h=a.getAttribute("start");h&&0<h.length&&(c.setAttribute("start",h),a.removeAttribute("start"));(h=a.className)&&0<h.length&&(h="OL"===c.tagName?Yt.a.MCd(h,"NumberListStyle"):Yt.a.MCd(h,"BulletListStyle"),
0<h.length&&(Sys.UI.DomElement.addCssClass(c,h),Sys.UI.DomElement.removeCssClass(a,h)));a.parentNode.insertBefore(c,a);return c}static xwc(a,c){for(let h=0;h<a.childNodes.length;h++){const v=a.childNodes[h];1===v.nodeType&&1<c&&Hm.xwc(v,c-1);if(Hm.Hif(v)||Hm.mJc(v))a.removeChild(v),h--}}static J8e(a){if(1===a.nodeType){var c=Hm.S_b(a,"mso-list");if(c&&0<c.length)try{var h=c.split(" ");if(3===h.length){const v=Number.parseInvariant(h[1].substr(5)),B=new ho(v,c,a);B.w7b=!0;return B}}catch(v){}else if((h=
a.parentNode)&&"li"===h.tagName.toLocaleLowerCase()&&(c=h.getAttribute("data-"+we.a.Fmd),h=h.getAttribute(Oh.a.WLc),c&&h&&0<c.length&&0<h.length))return a=new ho(Number.parseInvariant(c),h+" level"+c,a),a.w7b=!1,a}return null}static fgn(a,c,h,v){if("p"===a.tagName.toLowerCase()&&c&&c.length){if("UL"===Hm.zzd(c))return h=Hm.FTk(c),Sys.UI.DomElement.addCssClass(a,h),h;var B=c.match(RegExp("^[0-9]+"));return B&&B.length?(h="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,h),a.setAttribute("start",
B[0]),h):(B=c.match(RegExp("^[a-zA-Z]+")))&&B.length&&(B=B[0],v=(c=B.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&c.length?Hm.Pdl(h,v):1,1!==v&&((h=Hm.Rqd(a,B,RegExp("^[ivxlcdm]+"),F.a.W6g,"NumberListStyle3"))||(h=Hm.Rqd(a,B,RegExp("^[IVXLCDM]+"),F.a.W6g,"NumberListStyle5")))||v&&((h=Hm.Rqd(a,B,RegExp("^[a-z]+"),F.a.V6g,"NumberListStyle2"))||(h=Hm.Rqd(a,B,RegExp("^[A-Z]+"),F.a.V6g,"NumberListStyle4"))))?h:"NumberListStyle1"}return null}static FTk(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";
default:return"BulletListStyle1"}}static Pdl(a,c){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(c%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static Rqd(a,c,h,v,B){return(c=c.match(h))&&c.length?(v=v(c[0]),v=1>v?1:v,Sys.UI.DomElement.addCssClass(a,B),a.setAttribute("start",v+""),B):null}static zzd(a){return Hm.vHl(a)?"UL":"OL"}static vHl(a){return!a||
"\u00a7"===a||"\u00b7"===a||"o"===a||"-"===a||"\u00d8"===a||"v"===a||"\u00fc"===a||"\u2666"===a||"\u00a8"===a}static maf(a,c){let h=null;var v;let B,X;for(let ma=-1;!h&&ma<a.childNodes.length;ma++){const Pa=-1===ma?a:a.childNodes[ma];if(Pa)if((v=Pa.innerHTML)&&0<v.length){if(B=v.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=B&&(X=v.indexOf("\x3c!--[endif]--\x3e"),0<=X)){v=v.substring(B,X+14);Pa.innerHTML=Pa.innerHTML.replace(v,"");if(v.length){a=a.ownerDocument.createElement("span");a.innerHTML=v;
h=a.innerText.trim();break}h&&h.length||(h="o")}}else 0<=ma&&1===Pa.nodeType&&1<c&&(h=Hm.maf(Pa,c-1))}return h}static $0k(a){let c=null;1===a.nodeType&&((c=Hm.fvh(a,"font-family"))||(c=Hm.fvh(a,"mso-ascii-font-family")));return c}static fvh(a,c){return(a=Hm.S_b(a,c))&&0<a.length?a.trim():null}static uuh(a,c){let h=null;for(let v=0;!h&&v<a.childNodes.length;v++){const B=a.childNodes[v];Hm.mJc(B)?(h="string"===typeof B.innerText?B.innerText.trim():B.textContent.trim(),h.length||(h="o"),B.parentNode.removeChild(B)):
1===B.nodeType&&1<c&&(h=Hm.uuh(B,c-1))}return h}static mJc(a){return 1===a.nodeType&&(a=Hm.S_b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static Hif(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static S_b(a,c){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(c)){a=a.split(";");for(let h=0;h<a.length;h++){const v=a[h].split(":");if(2===v.length&&v[0].trim()===c)return v[1].trim()}}return null}static EEc(a){do a=a.previousSibling;while(a&&
Hm.QIc(a));return a}static QIc(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(Hm.ire,""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:Hm.QIc(a.firstChild):!0}}Hm.ire=RegExp("[\n|\r]","gi");Object(w.a)(Hm,"WacAndRichClientWordConverter",null,[187]);class Bw{constructor(a){this.oX=a.$("ExternalPasteImprovementsEnabled")&&a.$("ListMarkerIsEnabled")}create(a=null){return this.oX?new Hm(a):new Ll(a)}}Object(w.a)(Bw,"Box4WordConverterFactory",
null,[717]);var $x=b(1584);class cx{constructor(a,c,h,v,B){this.ghg=0;this.fc=a;this.Hc=c;this.tde=B;this.Xaa=h;this.lGa=v}Z4j(a,c,h){r.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",c,h,this.Hc.wD);a.fg&&this.Hc.In&&window.chrome&&r.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",c);this.Xaa.VAc(!!(c&16));this.lGa.create(a,Object(m.a)(this,this.MVn,"waitingForEnsureAccessOperationResult"),
null).jk("ClipboardPreProcess");this.ghg=Date.now()}w2m(){this.Xaa.reset()}MVn(a){let c=!0;const h=this.Xaa.fCk;null!=h?(a.Jda=h,c=!1):Date.now()-this.ghg>this.tde&&(r.ULS.sendTraceTag(18354843,307,50,null),this.fc.ib(Kf.a.ria,{["Reason"]:Ef.a.Gei}),c=a.Jda=!1);return c}}Object(w.a)(cx,"ClipboardOperationClipboardAccessHelper",null,[708]);class vw{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe){this.jQa=null;this.ga=a;this.fc=c;this.Dx=h;this.Vd=v;this.ya=B;this.Xaa=X;this.Ba=ma;this.yd=Pa;
this.rn=mb;this.Vb=Tb;this.N5a=rc;this.ved=Tc;this.LA=vd;this.Ki=Ie;this.xNb=ee?ee.$("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.R9c=ee?ee.$("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.Na=Xe}get Wf(){return this.Vd}get Kb(){return this.fc}get HIc(){if(null==this.jQa)if(this.Na)if(this.Na.pk.isCompleted)this.jQa=this.Na.isFeatureEnabled(44)&&this.Na.isFeatureEnabled(4);else return!1;else this.jQa=!1;return this.jQa}HVn(a){a.gZ();return!0}x7g(a,c){a=c.Qy;r.ULS.shipAssertTag(18130960,307,!!(a&
16));if(a&256){let v=!1,B;H.a.uKa&&l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");this.HIc&&c.kd&&c.kd.Vf&&(v=this.Ki.WNg(c.kd.Vf.editingElement));B=this.Ki.Hcf(c.kd.Vf.editingElement,!1);var h=c.kd.Vf.editingElement;this.Ki.ghf(h,!1,1);this.xNb&&H.a.uKa?(h=c.kd.Vf.editingElement,this.Ki.mLf(h,"data-src","data-srcurl"),a=this.Xaa.copy(),this.Ki.mLf(h,"data-srcurl","data-src")):this.R9c&&c.kd&&c.kd.Vf?(h=this.Ki.bPe(c.kd.Vf.editingElement,c.kd.Qt,
!0),a=this.Xaa.copy(),h&&this.Ki.bPe(c.kd.Vf.editingElement,c.kd.Qt,!1)):(this.Ki.vri(c.kd.Vf.editingElement),a=this.Xaa.copy());this.HIc&&v&&this.Ki.vXm(c.kd.Vf.editingElement);B&&this.Ki.Hcf(c.kd.Vf.editingElement,!0);h=c.kd.Vf.editingElement;this.Ki.ghf(h,!1,0);if(!a)return r.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.Kb.ib(Kf.a.Svb,{["Reason"]:Ef.a.zWf}),c.cP&&c.cP.fail("SystemClipboard did not copy",!1),c.failed=!0,!1}return!0}USe(a,c){const h=c.kd;r.ULS.shipAssertTag(18130961,
307,!!(c.Qy&16));c.Ftn?this.Dx.s2g():this.Dx.grd(h,a);return!0}och(a,c){var h=c.context,v=c.Ac;const B=c.c5;var X=!1;a=this.ya.Ca.Fa.Pb;if(this.Ba.Wk(a)||this.yd.mj(a)){const ma=this.Vb.ff(a.node),Pa=ma.nc();r.ULS.shipAssertTag(18130962,307,Pa);this.rn.Wc(ma);this.N5a.Qcb(ma)&&(X=!0)}v=c.Qy&64?new uh.DictionaryPropertySet:v||new uh.DictionaryPropertySet;v.setValue(Uc.a.Wzc,!1);h=this.ga.Le(h,zb.a.lF,2,!0,B,v);8===h&&(r.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Kb.ib(Kf.a.ria,{["Reason"]:Ef.a.nch}),
c.cP&&c.cP.fail("DeleteKey failed",!1),c.failed=!0);32===h&&X&&(c=this.ya.Ca.Fa,this.yd.Cl(c)&&c.sa.node===a.node&&!this.Ba.textLength(c.sa.node)&&(c=this.Vb.ff(c.sa.node),a=this.yd.vs(c),r.ULS.shipAssertTag(18130964,307,a),this.rn.Wc(c),this.N5a.tId(c)||(a=this.ved.create(),a.Wb(c),this.rn.J4(a,!1,!1),X=this.rn.Fd(a),this.Ba.tb(X)&&(this.rn.Wc(a),this.Wf.merge(a,c,!1,!1),this.ya.setSelection(this.LA.vd(X,this.Ba.textLength(X)))))));return!0}}Object(w.a)(vw,"ClipboardOperationCutCopy",null,[741]);
class dx{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe){this.ga=a;this.fc=c;this.Dx=h;this.Xaa=X;this.ya=B;this.Vd=v;this.Ba=ma;this.yd=Pa;this.rn=mb;this.Vb=Tb;this.N5a=rc;this.ved=Tc;this.LA=vd;this.qa=ee;this.Ki=Ie;this.Na=Xe}create(){return new vw(this.ga,this.fc,this.Dx,this.Vd,this.ya,this.Xaa,this.Ba,this.yd,this.rn,this.Vb,this.N5a,this.ved,this.LA,this.qa,this.Ki,this.Na)}}Object(w.a)(dx,"Factory",null,[707]);class hv{}Object(w.a)(hv,"ClipboardOperationCutStrategy",null,[706]);var Wx=
b(1522);class Du{constructor(a,c){this.n3c=null;this.Dx=a;this.e2=c;this.cG=0}process(a,c){this.cG||(this.n3c=[Object(m.a)(this,this.Eek,"copyGlossarySelection"),Object(m.a)(this.e2,this.e2.Kzm,"pasteGlossaryPlaceholder")]);let h=!0;this.cG<this.n3c.length&&(h=this.n3c[this.cG++](a,c));return h?this.cG<this.n3c.length:!1}Eek(a,c){if(!Object(Ub.a)(95,c.Ac))return!1;const h=Object(ha.a)(95,c.Ac);if(!h.hasProperty(Uc.a.Jbf))return!1;const v=h.getValue(Uc.a.Jbf),B=c.kd,X=B.Ma;this.Dx.aXi();X.wFb(()=>
{X.setSelection(v,void 0,!0);this.Dx.grd(B,a)},!0);return!0}}Object(w.a)(Du,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[738]);var Gv=b(591);class Xx{constructor(a){this.flb=null;this.qZ=a;this.cG=-1}process(a,c){-1===this.cG&&(this.Gok(a,c),this.cG=0);let h=!1;this.cG<this.flb.length&&(h=this.flb[this.cG++](a,c));return h?this.cG<this.flb.length:!1}Gok(a,c){H.a.G0||c.Qy&512?(this.flb=[Object(m.a)(this.qZ,this.qZ.USe,"copyInternal")],r.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):
!a.fg&&c.Qy&256?(this.flb=[Object(m.a)(this.qZ,this.qZ.HVn,"waitBeforeCopy"),Object(m.a)(this.qZ,this.qZ.x7g,"copyExternal"),Object(m.a)(this.qZ,this.qZ.USe,"copyInternal")],r.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.flb=[Object(m.a)(this.qZ,this.qZ.x7g,"copyExternal"),Object(m.a)(this.qZ,this.qZ.USe,"copyInternal")],r.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));
c.Qy&32&&(a=Object(m.a)(this.qZ,this.qZ.och,"deleteForCut"),this.flb.push(a),r.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));Gv.a.V2l(c)}}Object(w.a)(Xx,"ClipboardOperationCutCopyProcessor",null,[736]);class ex{constructor(a,c,h,v){this.Zad=null;this.Dx=a;this.ya=c;this.qZ=h;this.e2=v;this.cG=0}process(a,c){this.cG||(this.Zad=[Object(m.a)(this,this.Hek,"copyMovedSelection"),Object(m.a)(this.qZ,this.qZ.och,"deleteForCut"),Object(m.a)(this,
this.nNc,"moveIp"),Object(m.a)(this.e2,this.e2.Pgi,"pasteInternal"),Object(m.a)(this.e2,this.e2.fDi,"setSelectionAfterPaste")]);let h=!0;this.cG<this.Zad.length&&(h=this.Zad[this.cG++](a,c));return h?this.cG<this.Zad.length:!1}Hek(a,c){c=c.kd;this.Dx.FSn();this.Dx.grd(c,a);return!0}nNc(a,c){c=new xm.Selection([c.Ac],!0);this.ya.setSelection(c,a);return!0}}Object(w.a)(ex,"ClipboardOperationMoveProcessor",null,[737]);var Yx=b(1521);class Eu{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh){this.Dx=
a;this.ga=c;this.fgc=h;this.fc=v;this.yd=B;this.Hc=X;this.Fb=ma;this.J2c=Pa;this.y$i=mb;this.TKb=Tb;this.Ide=rc;this.Vfc=Tc;this.lGa=vd;this.zq=ee;this.Bb=Ie;this.Xi=Xe;this.pu=Yf;this.i_=Hh}create(a,c,h,v,B,X,ma,Pa,mb=!0){const Tb=this.J2c.create(v,Object(ha.a)(95,Pa));var rc=this.y$i.create();const Tc=new Du(this.Dx,Tb),vd=new ex(this.Dx,$c.a.instance,rc,Tb);rc=new Xx(rc);v=new Yx.a(l.AFrameworkApplication.K,Ht.a.instance,v,Ee.a.instance,Tb,this.TKb);return new Wx.a(a,c,h,B,X,ma,Pa,this.fgc,this.ga,
this.fc,this.yd,this.Hc,this.Fb,Tc,vd,rc,v,this.TKb,this.Ide,this.Vfc,this.lGa,this.zq,this.Bb,this.Xi,this.pu,this.i_,l.AFrameworkApplication.OSf(),mb)}}Object(w.a)(Eu,"Factory",null,[700]);class ww{constructor(a,c){this.fyb=a.T7e(c);this.bTe=a.mXk(c);this.otb=a.N5e(c);this.r8a=a.r5e(c)}static MD(a){return ww.hq(a)}static hq(a){return new ww(It.a.instance,a)}}Object(w.a)(ww,"CpUsageHelper",null,[]);class Zx{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc){this.C6=null;this.fc=a;this.Dx=c;this.Toc=h;this.soa=
v;this.ya=B;this.ga=X;this.tle=ma;this.HEe=mb;this.Pve=Pa;this.Xge=Tb;this.Gde=rc;this.Bb=Tc;this.Rzg=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorPasteFailuresImprovementIsEnabled")}get ji(){return this.HEe.value}get Wla(){return this.soa}get Kb(){return this.fc}get SLa(){return this.Pve.SLa}paste(a,c){const h=this.Bb.iTa();try{const v=c.kd,B=c.Qy;this.u4&&(this.ya&&this.ya.Ca&&this.ya.Ca.Fa&&il.TableBorderSelectionCache.Fkn(this.ya.Ca.Fa.kv||this.ya.Ca.Fa.HAb),ji.Oin(this.ya));
r.ULS.shipAssertTag(18131010,307,!!(B&1));Object(Ub.a)(95,c.Ac)&&c.Ac.setValue(ii.a.Yba,v.Vf.editingElement.clientWidth);this.Gde.JIn(a,c);let X;if(!({Jqd:X}=this.tle.value.aRi(X)).returnValue)return this.mMc(c,"HTML import strategy failed",!1),Fa.Health.instance.recordQosError("HtmlImportStrategyFailed",[Gv.a.WTd],!1,!0,!0,!1,null),!1;this.ji.ZD();let ma=!0,Pa=null;const mb=this.Xge.create(X),Tb=c.YWi;if((!v||!v.Ma)&&this.Rzg)return this.mMc(c,"Fail to set selection.",!1),Fa.Health.instance.recordQosError("SetSelectionFailed",
[Gv.a.WTd],!1,!0,!0,!1,null),!1;v.Ma.wFb(()=>{Tb&&2===this.ga.processAction(zb.a.Uha,2)?ma=!1:(Pa=Tb?this.ya&&this.ya.Ca&&this.ya.Ca.Fa?this.ya.Ca.Fa.sa:null:c.Ac)?(r.ULS.shipAssertTag(18158338,307,Gc.SelectionEditor.ke(Pa)),this.h1h(Pa,"paste")):r.ULS.sendTraceTag(591958036,307,15,"ipContext is null. useSelection: {0}; ",Tb)},this.Pve.hVh);if(!ma)return this.mMc(c,"fail to deleteForReplace.",!0),!1;if(!Pa&&this.Rzg)return this.mMc(c,"null ipContext after RunAgainstSelectionCollection.",!0),!1;if(!Pa.node||
!Pa.node.isConnected)return this.mMc(c,"node is null or not connected in ip context.",!0),!1;v.editingView.disable(!0,25);mb.restore();this.Toc.Gzm(X,Pa,a);return!0}finally{h&&h.dispose()}}mMc(a,c,h){a.failed=!0;a.cP&&a.cP.fail(c,h)}Kzm(a,c){const h=Object(ha.a)(95,c.Ac).getValue(Uc.a.uGh);r.ULS.shipAssertTag(20492440,307,Gc.SelectionEditor.ke(h));if(!this.A1g(h,c))return!1;this.ji.ZD();c=(new Fk.a).Ob(15);c.Oa(this.Dx.Qea);this.Toc.AOh(h,a);this.Dx.s2g();c.dispose();return!0}Pgi(a,c){const h=this.ya.Ca.Fa.sa;
if(!this.A1g(h,c))return!1;this.ji.ZD();this.ga.processAction(zb.a.Uha,2);this.h1h(h,"intPaste");this.Toc.AOh(h,a);return!0}A1g(a,c){if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("AbortClipboardOperationForInvalidIpContext")){if(!a||!a.Nc)return r.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!c&&c.xmf),c.cP&&(c.cP.fail("Invalid ipContext before InternalPasteAtIp",!0),c.failed=!0),!1;if(!Gc.SelectionEditor.ke(a))return r.ULS.sendTraceTag(587843167,307,15,"Ip context is not insertion point. IsTouch: {0}; contextId: {1}; ipContext.Node: {2}; ipContext.Node.Anchor: {3};",
!!c&&c.xmf,a.contextId,!!a.node,!!a.node&&!!a.node.anchor),c.cP&&(c.cP.fail("ipContext is not insertion point in InternalPasteAtIp",!0),c.failed=!0),!1}return!0}h1h(a,c){c=ww.MD(c);this.Wla.jOm(c,a.node,a.cpBegin);this.Wla.X2l(c.bTe);this.Wla.Npf(c.fyb);this.Wla.Bpf(c.otb);this.Wla.zpf(c.r8a)}fDi(a,c){if(!c.YWi)return!1;c.Qy&64&&this.Dx.$Wi();if(!c.dVa)return r.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Kb.ib(Kf.a.XY,{["Reason"]:Ef.a.pcb}),c.cP&&c.cP.fail("No selection after paste",
!1),c.failed=!0,!1;this.Pve.wSn(c);this.ji.ZD();return!1}get u4(){null==this.C6&&(l.AFrameworkApplication.Mg("he991617;3eed2178"),this.C6=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.C6}}Object(w.a)(Zx,"ClipboardOperationPaste",null,[735]);class rq{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.fc=a;this.Dx=c;this.Toc=h;this.soa=v;this.ya=B;this.ga=X;this.HEe=Pa;this.nqj=ma;this.Xge=mb;this.Gde=
Tb;this.Bb=rc}create(a,c){c=this.nqj.create(this.ya,c);return new Zx(this.fc,this.Dx,this.Toc,this.soa,this.ya,this.ga,a,c,this.HEe,this.Xge,this.Gde,this.Bb)}}Object(w.a)(rq,"Factory",null,[702]);var Jt=b(1438);class Kg{constructor(a,c){this.nyn=a;this.Hym=c}}Object(w.a)(Kg,"ParagraphFormatStore",null,[]);class ur{constructor(a,c,h,v){this.ya=a;this.Ba=c;this.$b=h;this.ipe=v}JIn(a,c){if(c.Y2b&&this.ipe){c=a.Jda;var h=this.ya.Ca.Fa.sa.node,v=null;this.Ba.tb(h)&&(v=this.$b.um(h),h=this.Ba.cWa(h),v=
new Kg(v,h));c=new Jt.a(c.context,c.Qy,c.cP,c.c5,c.Ac,v);a.Jda=c}}}Object(w.a)(ur,"ClipboardOperationPasteOvertypeStrategy",null,[703]);class Wn{constructor(a){this.wre=null;this.ya=a;a.wFb(c=>{this.wre=c},!1)}get hVh(){return!1}wSn(a){a=this.gJe(a);this.setSelection(this.ya,a)}gJe(a){let c=a.dVa;(a.eOa||a.NBa)&&a.n3d&&(c=ne.SelectionFactory.jC(a.n3d,c.sa));return c}setSelection(a,c){a.setSelection(c)}}Object(w.a)(Wn,"AClipboardOperationPasteStrategy",null,[754]);class qo extends Wn{constructor(a){super(a)}get SLa(){return this.wre}}
Object(w.a)(qo,"ClipboardOperationPasteToLiveSelectionStrategy",Wn,[]);class Mv extends Wn{constructor(a,c){super(a);this.IFe=null;this.lnc=c;a.wFb(h=>{this.IFe=h},!0)}get hVh(){return!0}get SLa(){return this.IFe}gJe(a){let c=super.gJe(a);a.Ac.setValue(Uc.a.Tgi,c);return c=this.lnc.oyh(this.wre.Fa,this.IFe.Fa,c)}}Object(w.a)(Mv,"ClipboardOperationPasteToVirtualSelectionStrategy",Wn,[]);class Kt{constructor(a){this.lnc=null;this.HFe=a.$("EnableVirtualSelectionInSelectionManager")}create(a,c){return c&&
c.ia(Uc.a.eOa,!1)&&this.HFe?new Mv(a,this.kVn):new qo(a)}get kVn(){this.lnc||(this.lnc=xa.a.instance.ra("Box4.Actors.IVirtualSelectionMerger"));return this.lnc}}Object(w.a)(Kt,"ClipboardOperationPasteStrategyFactory",null,[697]);class ay{constructor(a,c,h,v,B){this.fc=a;this.ya=c;this.Mi=h;this.Gm=v;this.zkj=B}MDm(a){this.zkj&&(a&1||a&32)&&this.Mi.$n&&this.ya.SSb()}QHl(a,c){return a&1&&this.Gm.Kba(c,!0)?(this.fc.ib(Kf.a.re,{["Reason"]:Ef.a.dC}),!1):!0}}Object(w.a)(ay,"ClipboardOperationWordStrategy",
null,[]);class lt{constructor(){}jek(a,c){if(c)if(c=c.sheet)if(c=c.cssRules){var h=Array.clone(c);h.reverse();var v=c=0,B=0,X=0;for(const Pa of h){h=Pa.style;var ma=Pa.selectorText;h=h?h.cssText:null;ma=ma?ma.split(","):null;if(h&&ma&&Pa.type===Pa.STYLE_RULE){X+=ma.length;for(const mb of ma){0<=mb.indexOf("#")&&c++;0<=mb.indexOf(".")&&v++;0>mb.indexOf("#")&&0>mb.indexOf(".")&&B++;ma=null;try{ma=a.querySelectorAll(mb)}catch(Tb){r.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",
mb,Tb.message)}if(ma)for(let Tb=0;Tb<ma.length;Tb++)ma[Tb].setAttribute("style",h+(ma[Tb].getAttribute("style")||""))}}}r.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",X,c,v,B)}else this.Q1h();else this.Q1h()}Q1h(){r.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",H.a.wD)}}Object(w.a)(lt,"ExternalPasteCssConverter",null,
[698]);var Vy=b(1029);class Nv{constructor(a,c=null,h=null){this.ae=a;this.gU=c||uo.a.zCh("");this.Xwj=h||uo.a.ACh("")}get Db(){return this.gU}get WWf(){return this.Xwj}y9(a){this.WWf.b++;this.ae.y9(a)}v9(){this.ae.v9()}x9(a){this.WWf.c++;this.ae.x9(a)}w9(){this.ae.w9()}u9(a){this.WWf.d++;this.ae.u9(a)}t9(){this.ae.t9()}reset(){this.ae.reset()}get dzc(){return this.ae.dzc}z9(a,c){this.Db.b++;this.ae.z9(a,c)}JAa(a){this.Db.c++;this.ae.JAa(a)}efb(a){this.Db.b++;this.ae.efb(a)}Wra(a){this.Db.d++;this.ae.Wra(a)}FAa(a){this.Db.f++;
this.ae.FAa(a)}vLa(a,c){this.Db.g++;this.ae.vLa(a,c)}uLa(){this.ae.uLa()}iE(a){this.Db.h++;this.ae.iE(a)}hE(){this.ae.hE()}bfb(){this.ae.bfb()}afb(){this.ae.afb()}ALa(a,c){this.Db.i++;this.ae.ALa(a,c)}lZa(){this.ae.lZa()}MAa(a){this.Db.j++;this.ae.MAa(a)}KAa(){this.ae.KAa()}zLa(a){this.Db.k++;this.ae.zLa(a)}LAa(){this.ae.LAa()}nZa(a){this.Db.l++;this.ae.nZa(a)}}Object(w.a)(Nv,"SemanticEventUsageCollector",null,[188,189]);var ro=b(582);class Mu{constructor(a,c=null,h=null,v=null){this.baj="span p div br a img label b font i strong u em h1 h2 h3 h4 h5 h6 table tbody td tr li ol ul".split(" ");
this.ae=a;this.gU=c||uo.a.$vh(H.a.Jsb,"");this.kt=h;this.Quj=v?v.$("ParseStyleForHtmlTagEventIsEnabled"):!1;this.Ruj=v?v.$("ParseStyleForUncommonHtmlTagEventIsEnabled"):!1;this.Mcg=new Zc.a(oa.a.yi());for(const B of this.baj)this.Mcg.add(B)}get Db(){return this.gU}get xn(){return this.kt}wg(a){return a?a+1:1}reset(){this.ae.reset()}pQd(){this.ae.pQd()}kcf(a){if(a&&this.xn&&(a.getAttribute&&(a.getAttribute(ro.a.Vok)&&(this.xn.xoh=!0),a.getAttribute(ro.a.Fsd)&&(this.xn.GNk=!0),a.getAttribute(ro.a.Vyc)&&
(this.xn.kQe=a.getAttribute(ro.a.Vyc)),a.getAttribute(ro.a.Zok)&&(this.xn.yoh=!0)),a.id&&a.id.startsWith&&a.id.startsWith(ro.a.jnl)&&(this.xn.INk=!0),a.className&&a.className.split))for(const c of a.className.split(" ")){c.startsWith(ro.a.Num)&&(this.xn.KNk=!0);c.startsWith(ro.a.YCm)&&(this.xn.zoh=!0);c.startsWith(ro.a.kXn)&&(this.xn.Aoh=!0);if(c.startsWith(H.a.nNe)&&c.length===H.a.nNe.length+1){const h=parseInt(F.a.substring(c,c.length-1,c.length));isNaN(h)||(this.xn.Vxc=h)}if(c===ro.a.Kfm||c===
ro.a.Lfm)this.xn.Oxd=!0}return this.ae.kcf(a)}onClose(){this.ae.onClose()}z9(a,c){this.xn&&(this.xn.LNk=!0);this.Db.d=this.wg(this.Db.d);this.ae.z9(a,c)}hQd(a){this.Db.e=this.wg(this.Db.e);this.Ug(a);return this.ae.hQd(a)}$wf(a){this.Db.f=this.wg(this.Db.f);this.Ug(a);return this.ae.$wf(a)}axf(a){this.Db.g=this.wg(this.Db.g);this.Ug(a);return this.ae.axf(a)}exf(a){this.Db.h=this.wg(this.Db.h);this.Ug(a);return this.ae.exf(a)}uxf(a){this.Db.i=this.wg(this.Db.i);this.Ug(a);return this.ae.uxf(a)}vxf(a){this.Db.j=
this.wg(this.Db.j);this.Ug(a);this.ae.vxf(a)}oQd(a){this.Db.k=this.wg(this.Db.k);this.Ug(a);return this.ae.oQd(a)}wxf(a){this.Db.l=this.wg(this.Db.l);this.Ug(a);this.ae.wxf(a)}xxf(a){this.Db.m=this.wg(this.Db.m);this.Ug(a);this.ae.xxf(a)}yxf(a){this.Db.n=this.wg(this.Db.n);this.Ug(a);return this.ae.yxf(a)}sQd(a){this.Db.o=this.wg(this.Db.o);this.Ug(a);return this.ae.sQd(a)}tQd(a){this.Db.p=this.wg(this.Db.p);this.Ug(a);return this.ae.tQd(a)}Mxf(a){this.Db.q=this.wg(this.Db.q);this.Ug(a);return this.ae.Mxf(a)}uQd(a){this.Db.r=
this.wg(this.Db.r);this.Ug(a);this.ae.uQd(a)}Oxf(a){this.Db.s=this.wg(this.Db.s);this.Ug(a);return this.ae.Oxf(a)}wQd(a){this.Db.t=this.wg(this.Db.t);this.Ug(a);return this.ae.wQd(a)}xQd(a){this.Db.u=this.wg(this.Db.u);this.Ug(a);return this.ae.xQd(a)}AQd(a){this.Db.v=this.wg(this.Db.v);this.Ug(a);return this.ae.AQd(a)}BQd(a){this.Db.w=this.wg(this.Db.w);this.Ug(a);return this.ae.BQd(a)}Zxf(a){this.Db.x=this.wg(this.Db.x);this.Ug(a);this.ae.Zxf(a)}$xf(a){this.Db.y=this.wg(this.Db.y);this.Ug(a);return this.ae.$xf(a)}GQd(a){this.Db.z=
this.wg(this.Db.z);this.Ug(a);return this.ae.GQd(a)}HQd(a){this.Db.ba=this.wg(this.Db.ba);this.Ug(a);return this.ae.HQd(a)}LQd(a){this.Db.bb=this.wg(this.Db.bb);this.Ug(a);return this.ae.LQd(a)}MQd(a){this.Db.bc=this.wg(this.Db.bc);this.Ug(a);return this.ae.MQd(a)}OQd(a){this.Db.bd=this.wg(this.Db.bd);this.Ug(a);return this.ae.OQd(a)}PQd(a){this.Db.be=this.wg(this.Db.be);this.Ug(a);return this.ae.PQd(a)}RQd(a){this.Db.bf=this.wg(this.Db.bf);this.Ug(a);return this.ae.RQd(a)}TQd(a){this.Db.bg=this.wg(this.Db.bg);
this.Ug(a);return this.ae.TQd(a)}xyf(a){this.Db.bh=this.wg(this.Db.bh);this.Ug(a);return this.ae.xyf(a)}XQd(a){this.Db.bi=this.wg(this.Db.bi);this.Ug(a);return this.ae.XQd(a)}Eyf(a){this.Db.bj=this.wg(this.Db.bj);this.Ug(a);return this.ae.Eyf(a)}Gyf(a){this.Db.bk=this.wg(this.Db.bk);this.Ug(a);this.ae.Gyf(a)}Hyf(a){this.Db.bl=this.wg(this.Db.bl);this.Ug(a);return this.ae.Hyf(a)}$Qd(a){this.Db.bm=this.wg(this.Db.bm);this.Ug(a);return this.ae.$Qd(a)}aRd(a){this.Db.bm=this.wg(this.Db.bm);this.Ug(a);
return this.ae.aRd(a)}bRd(a){this.Db.bm=this.wg(this.Db.bm);this.Ug(a);return this.ae.bRd(a)}cRd(a){this.Db.bm=this.wg(this.Db.bm);this.Ug(a);return this.ae.cRd(a)}dRd(a){this.Db.bm=this.wg(this.Db.bm);this.Ug(a);return this.ae.dRd(a)}eRd(a){this.Db.bm=this.wg(this.Db.bm);this.Ug(a);return this.ae.eRd(a)}Myf(a){this.Db.bn=this.wg(this.Db.bn);return this.ae.Myf(a)}fRd(a){this.Db.bo=this.wg(this.Db.bo);this.Ug(a);this.ae.fRd(a)}Syf(a){this.Db.bp=this.wg(this.Db.bp);return this.ae.Syf(a)}gRd(a){this.Db.bq=
this.wg(this.Db.bq);this.Ug(a);return this.ae.gRd(a)}Tyf(a){this.Db.br=this.wg(this.Db.br);this.Ug(a);return this.ae.Tyf(a)}iRd(a){this.xn&&(this.xn.JNk=!0);this.Ug(a);this.Db.bs=this.wg(this.Db.bs);this.ae.iRd(a)}Zyf(a){this.Db.bt=this.wg(this.Db.bt);this.Ug(a);this.ae.Zyf(a)}jRd(a){this.Db.bu=this.wg(this.Db.bu);this.Ug(a);return this.ae.jRd(a)}ezf(a){this.Db.bv=this.wg(this.Db.bv);this.Ug(a);return this.ae.ezf(a)}mRd(a){this.Db.bw=this.wg(this.Db.bw);this.Ug(a);return this.ae.mRd(a)}nRd(a){this.Db.bx=
this.wg(this.Db.bx);this.Ug(a);return this.ae.nRd(a)}pRd(a){this.Db.by=this.wg(this.Db.by);this.Ug(a);return this.ae.pRd(a)}qRd(a){this.xn&&(this.xn.Oxd=!0);this.Db.bz=this.wg(this.Db.bz);this.Ug(a);return this.ae.qRd(a)}qzf(a){this.Db.ca=this.wg(this.Db.ca);this.Ug(a);this.ae.qzf(a)}tzf(a){this.Db.cb=this.wg(this.Db.cb);this.Ug(a);return this.ae.tzf(a)}rRd(a){this.xn&&(this.xn.HNk=!0);this.Db.cc=this.wg(this.Db.cc);this.Ug(a);return this.ae.rRd(a)}onMenuOpen(a){this.Db.cd=this.wg(this.Db.cd);this.Ug(a);
return this.ae.onMenuOpen(a)}xzf(a){this.Db.ce=this.wg(this.Db.ce);this.ae.xzf(a)}Ezf(a){this.Db.cf=this.wg(this.Db.cf);this.Ug(a);return this.ae.Ezf(a)}Fzf(a){this.Db.cg=this.wg(this.Db.cg);this.Ug(a);return this.ae.Fzf(a)}Gzf(a){this.Db.ch=this.wg(this.Db.ch);this.Ug(a);return this.ae.Gzf(a)}CRd(a){this.xn&&(this.xn.Oxd=!0);this.Db.ci=this.wg(this.Db.ci);this.Ug(a);return this.ae.CRd(a)}Izf(a){this.Db.cj=this.wg(this.Db.cj);this.Ug(a);return this.ae.Izf(a)}DRd(a){this.Db.ck=this.wg(this.Db.ck);
this.Ug(a);return this.ae.DRd(a)}GRd(a){this.Db.cl=this.wg(this.Db.cl);this.Ug(a);return this.ae.GRd(a)}Qzf(a){this.Db.cm=this.wg(this.Db.cm);this.Ug(a);this.ae.Qzf(a)}MRd(a){this.Db.cn=this.wg(this.Db.cn);this.Ug(a);return this.ae.MRd(a)}$zf(a){this.Db.co=this.wg(this.Db.co);this.Ug(a);return this.ae.$zf(a)}TRd(a){this.Db.cp=this.wg(this.Db.cp);this.Ug(a);return this.ae.TRd(a)}URd(a){this.Db.cq=this.wg(this.Db.cq);this.Ug(a);return this.ae.URd(a)}uAf(a){this.Db.cr=this.wg(this.Db.cr);return this.ae.uAf(a)}AAf(a){this.Db.cs=
this.wg(this.Db.cs);this.Ug(a);return this.ae.AAf(a)}cSd(a){this.Db.ct=this.wg(this.Db.ct);this.Ug(a);return this.ae.cSd(a)}dSd(a){this.Db.cu=this.wg(this.Db.cu);this.Ug(a);return this.ae.dSd(a)}fSd(a){this.Db.cv=this.wg(this.Db.cv);this.Ug(a);return this.ae.fSd(a)}gSd(a){this.Db.cw=this.wg(this.Db.cw);this.Ug(a);return this.ae.gSd(a)}EAf(a){this.Db.cx=this.wg(this.Db.cx);return this.ae.EAf(a)}hSd(a){this.Db.cy=this.wg(this.Db.cy);this.Ug(a);return this.ae.hSd(a)}jSd(a){this.Db.cz=this.wg(this.Db.cz);
this.Ug(a);return this.ae.jSd(a)}lSd(a){this.xn&&(this.xn.XYb=!0);this.Db.da=this.wg(this.Db.da);this.Ug(a);return this.ae.lSd(a)}JAf(a){this.xn&&(this.xn.XYb=!0);this.Db.db=this.wg(this.Db.db);this.Ug(a);return this.ae.JAf(a)}UOc(a){this.xn&&(this.xn.XYb=!0);this.Db.dc=this.wg(this.Db.dc);this.Ug(a);return this.ae.UOc(a)}KAf(a){this.Db.dd=this.wg(this.Db.dd);this.Ug(a);return this.ae.KAf(a)}LAf(a){this.Db.de=this.wg(this.Db.de);this.Ug(a);return this.ae.LAf(a)}oSd(a){this.xn&&(this.xn.XYb=!0);this.Db.df=
this.wg(this.Db.df);this.Ug(a);return this.ae.oSd(a)}MAf(a){this.xn&&(this.xn.XYb=!0);this.Db.dg=this.wg(this.Db.dg);this.Ug(a);return this.ae.MAf(a)}PAf(a){this.Db.dh=this.wg(this.Db.dh);this.Ug(a);return this.ae.PAf(a)}sSd(a){this.xn&&(this.xn.XYb=!0);this.Db.di=this.wg(this.Db.di);this.Ug(a);return this.ae.sSd(a)}tSd(a){this.Db.dj=this.wg(this.Db.dj);this.Ug(a);return this.ae.tSd(a)}uSd(a){this.Db.dk=this.wg(this.Db.dk);this.Ug(a);return this.ae.uSd(a)}vSd(a){this.xn&&(this.xn.Oxd=!0);this.Db.dl=
this.wg(this.Db.dl);this.Ug(a);return this.ae.vSd(a)}zSd(a){this.Db.dm=this.wg(this.Db.dm);this.Ug(a);return this.ae.zSd(a)}Ug(a){const c=a.Qd;if(c&&this.xn){var h=c.tagName.toLowerCase();if(this.Quj&&this.GQh(h)||this.Ruj&&!this.GQh(h))if("font"===h&&this.wzm(a),c.style&&(a=c.style))for(const v of a)v&&0<v.length&&this.xn.ZFd(c.tagName,v)}}wzm(a){if((a=a.Qd)&&"font"===a.tagName.toLowerCase()&&this.xn){var c=a.getAttribute("face");c&&0<c.length&&this.xn.ZFd(a.tagName,"font-attr-face");(c=a.getAttribute("color"))&&
0<c.length&&this.xn.ZFd(a.tagName,"font-attr-color");(c=a.getAttribute("size"))&&0<c.length&&this.xn.ZFd(a.tagName,"font-attr-size")}}GQh(a){return this.Mcg.contains(a)}}Object(w.a)(Mu,"HtmlEventUsageCollector",null,[201]);class kx{constructor(a,c,h=!1){this.Qd=a;this.$y=c;this.UNj=h}}Object(w.a)(kx,"TagEventParam",null,[]);class Wl{constructor(a,c=null){this.R4c=this._prunedElements=this.uEe=this._voidElements=null;this.oc=a;this.gU=c||uo.a.awh("");this.bkn()}get Db(){return this.gU}Iim(a,c,h){this.uEe[c]?
this.E8h():(this.Db.e++,(c=this.R4c[c])&&c(new kx(a,h,!1)),this.Db.b++)}E8h(){this.Db.d++}Bim(){this.Db.c++}pim(a,c,h){if(this.uEe[c])this.E8h();else{if(c=this.R4c[c])return this.Db.b++,c(new kx(a,h,!1));this.Db.f++}return 2}bkn(){this._voidElements=Za.a.F1("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.uEe=Za.a.F1("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,
"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this._prunedElements=Za.a.F1("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);const a=this.oc,c=this.oc,h=this.oc,v=this.oc,B=this.oc,X=this.oc,ma=this.oc,Pa=this.oc,mb=this.oc,Tb=this.oc,rc=this.oc,Tc=this.oc,vd=this.oc,ee=this.oc,Ie=this.oc,Xe=this.oc,Yf=this.oc,Hh=this.oc,
Fi=this.oc,wk=this.oc;this.R4c=Za.a.F1("A",Object(m.a)(this.oc,this.oc.hQd,"onAOpen"),"ABBR",Object(m.a)(this.oc,this.oc.$wf,"onAbbrOpen"),"ACRONYM",Object(m.a)(this.oc,this.oc.axf,"onAcronymOpen"),"ADDRESS",Object(m.a)(this.oc,this.oc.exf,"onAddressOpen"),"APPLET",Object(m.a)(this.oc,this.oc.uxf,"onAppletOpen"),"AREA",Object(m.a)(this.oc,this.oc.vxf,"onAreaTag"),"B",Object(m.a)(this.oc,this.oc.oQd,"onBOpen"),"BASE",Object(m.a)(this.oc,this.oc.wxf,"onBaseTag"),"BASEFONT",Object(m.a)(this.oc,this.oc.xxf,
"onBasefontTag"),"BDO",Object(m.a)(this.oc,this.oc.yxf,"onBdoOpen"),"BIG",Object(m.a)(this.oc,this.oc.sQd,"onBigOpen"),"BLOCKQUOTE",Object(m.a)(this.oc,this.oc.tQd,"onBlockquoteOpen"),"BODY",Object(m.a)(this.oc,this.oc.Mxf,"onBodyOpen"),"BR",Object(m.a)(this.oc,this.oc.uQd,"onBrTag"),"BUTTON",Object(m.a)(this.oc,this.oc.Oxf,"onButtonOpen"),"CAPTION",Object(m.a)(this.oc,this.oc.wQd,"onCaptionOpen"),"CENTER",Object(m.a)(this.oc,this.oc.xQd,"onCenterOpen"),"CITE",Object(m.a)(this.oc,this.oc.AQd,"onCiteOpen"),
"CODE",Object(m.a)(this.oc,this.oc.BQd,"onCodeOpen"),"COL",Object(m.a)(this.oc,this.oc.Zxf,"onColTag"),"COLGROUP",Object(m.a)(this.oc,this.oc.$xf,"onColgroupOpen"),"DD",Object(m.a)(this.oc,this.oc.GQd,"onDdOpen"),"DEL",Object(m.a)(this.oc,this.oc.HQd,"onDelOpen"),"DFN",Object(m.a)(this.oc,this.oc.LQd,"onDfnOpen"),"DIR",Object(m.a)(this.oc,this.oc.MQd,"onDirOpen"),"DIV",Object(m.a)(this.oc,this.oc.OQd,"onDivOpen"),"DL",Object(m.a)(this.oc,this.oc.PQd,"onDlOpen"),"DT",Object(m.a)(this.oc,this.oc.RQd,
"onDtOpen"),"EM",Object(m.a)(this.oc,this.oc.TQd,"onEmOpen"),"FIELDSET",Object(m.a)(this.oc,this.oc.xyf,"onFieldsetOpen"),"FONT",Object(m.a)(this.oc,this.oc.XQd,"onFontOpen"),"FORM",Object(m.a)(this.oc,this.oc.Eyf,"onFormOpen"),"FRAME",Object(m.a)(this.oc,this.oc.Gyf,"onFrameTag"),"FRAMESET",Object(m.a)(this.oc,this.oc.Hyf,"onFramesetOpen"),"H1",Object(m.a)(this.oc,this.oc.$Qd,"onH1Open"),"H2",Object(m.a)(this.oc,this.oc.aRd,"onH2Open"),"H3",Object(m.a)(this.oc,this.oc.bRd,"onH3Open"),"H4",Object(m.a)(this.oc,
this.oc.cRd,"onH4Open"),"H5",Object(m.a)(this.oc,this.oc.dRd,"onH5Open"),"H6",Object(m.a)(this.oc,this.oc.eRd,"onH6Open"),"HEAD",Object(m.a)(this.oc,this.oc.Myf,"onHeadOpen"),"HR",Object(m.a)(this.oc,this.oc.fRd,"onHrTag"),"HTML",Object(m.a)(this.oc,this.oc.Syf,"onHtmlOpen"),"I",Object(m.a)(this.oc,this.oc.gRd,"onIOpen"),"IFRAME",Object(m.a)(this.oc,this.oc.Tyf,"onIframeOpen"),"IMG",Object(m.a)(this.oc,this.oc.iRd,"onImgTag"),"INPUT",Object(m.a)(this.oc,this.oc.Zyf,"onInputTag"),"INS",Object(m.a)(this.oc,
this.oc.jRd,"onInsOpen"),"ISINDEX",Object(m.a)(this.oc,this.oc.ezf,"onIsindexOpen"),"KBD",Object(m.a)(this.oc,this.oc.mRd,"onKbdOpen"),"LABEL",Object(m.a)(this.oc,this.oc.nRd,"onLabelOpen"),"LEGEND",Object(m.a)(this.oc,this.oc.pRd,"onLegendOpen"),"LI",Object(m.a)(this.oc,this.oc.qRd,"onLiOpen"),"LINK",Object(m.a)(this.oc,this.oc.qzf,"onLinkTag"),"MAP",Object(m.a)(this.oc,this.oc.tzf,"onMapOpen"),"MATH",Object(m.a)(this.oc,this.oc.rRd,"onMathOpen"),"MENU",Object(m.a)(this.oc,this.oc.onMenuOpen,"onMenuOpen"),
"META",Object(m.a)(this.oc,this.oc.xzf,"onMetaTag"),"NOFRAMES",Object(m.a)(this.oc,this.oc.Ezf,"onNoframesOpen"),"NOSCRIPT",Object(m.a)(this.oc,this.oc.Fzf,"onNoscriptOpen"),"OBJECT",Object(m.a)(this.oc,this.oc.Gzf,"onObjectOpen"),"OL",Object(m.a)(this.oc,this.oc.CRd,"onOlOpen"),"OPTGROUP",Object(m.a)(this.oc,this.oc.Izf,"onOptgroupOpen"),"OPTION",Object(m.a)(this.oc,this.oc.DRd,"onOptionOpen"),"P",Object(m.a)(this.oc,this.oc.GRd,"onPOpen"),"PARAM",Object(m.a)(this.oc,this.oc.Qzf,"onParamTag"),"PRE",
Object(m.a)(this.oc,this.oc.MRd,"onPreOpen"),"Q",Object(m.a)(this.oc,this.oc.$zf,"onQOpen"),"S",Object(m.a)(this.oc,this.oc.TRd,"onSOpen"),"SAMP",Object(m.a)(this.oc,this.oc.URd,"onSampOpen"),"SCRIPT",Object(m.a)(this.oc,this.oc.uAf,"onScriptOpen"),"SELECT",Object(m.a)(this.oc,this.oc.AAf,"onSelectOpen"),"SMALL",Object(m.a)(a,a.cSd,"onSmallOpen"),"SPAN",Object(m.a)(c,c.dSd,"onSpanOpen"),"STRIKE",Object(m.a)(h,h.fSd,"onStrikeOpen"),"STRONG",Object(m.a)(v,v.gSd,"onStrongOpen"),"STYLE",Object(m.a)(B,
B.EAf,"onStyleOpen"),"SUB",Object(m.a)(X,X.hSd,"onSubOpen"),"SUP",Object(m.a)(ma,ma.jSd,"onSupOpen"),"TABLE",Object(m.a)(Pa,Pa.lSd,"onTableOpen"),"TBODY",Object(m.a)(mb,mb.JAf,"onTbodyOpen"),"TD",Object(m.a)(Tb,Tb.UOc,"onTdOpen"),"TEXTAREA",Object(m.a)(rc,rc.KAf,"onTextareaOpen"),"TFOOT",Object(m.a)(Tc,Tc.LAf,"onTfootOpen"),"TH",Object(m.a)(vd,vd.oSd,"onThOpen"),"THEAD",Object(m.a)(ee,ee.MAf,"onTheadOpen"),"TITLE",Object(m.a)(Ie,Ie.PAf,"onTitleOpen"),"TR",Object(m.a)(Xe,Xe.sSd,"onTrOpen"),"TT",Object(m.a)(Yf,
Yf.tSd,"onTtOpen"),"U",Object(m.a)(Hh,Hh.uSd,"onUOpen"),"UL",Object(m.a)(Fi,Fi.vSd,"onUlOpen"),"VAR",Object(m.a)(wk,wk.zSd,"onVarOpen"))}}Object(w.a)(Wl,"AHtmlProcessor",null,[]);class lx{constructor(a,c){this.childNodes=a.childNodes;this.$y=c;this.sVe=0;this.eId=!1}}Object(w.a)(lx,"HtmlProcessorArguments",null,[]);var Ov=b(917);class mt extends Wl{constructor(a,c=null){super(a,c);this.poe=null}get MPl(){null==this.poe&&(this.poe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("CopyAndPasteTextFromWordWin32FixIsEnabled"):
!1);return this.poe}process(a,c=null){a&&(this.oc.reset(),this.Lji(new lx(a,new Zq.a),c))}Lji(a,c){a.childNodes.length&&(a=new Cp.a(c,Object(m.a)(this,this.JFm,"processChild"),a),a.jk("HTML Processing Operation"),c||(a.fg=!0),a.run())}JFm(a,c){const h=c.childNodes[c.sVe];if(3===h.nodeType)return this.oc.pQd(),this.oc.z9(h.nodeValue,new kx(h,c.$y.Rsh())),mt.Pcc(c);if(1!==h.nodeType)return mt.Pcc(c);if(!c.eId){const B=F.a.zy(h.tagName);if(!mt.dsl(h))if(this._prunedElements[B])this.Bim();else{mt.Y$l(h);
this.oc.pQd();var v=h.id;const X=h.tagName,ma=c.$y.Rsh(),Pa=h.getAttribute?h.getAttribute("class"):null;v=new Ov.a(v,X,Pa?Pa:"",h.attributes?h.attributes.length:0);v.Nc&&ma.add(v);if(this._voidElements[B])return this.Iim(h,B,ma),mt.Pcc(c);v=!1;switch(this.pim(h,B,ma)){case 1:v=!0;break;case 3:return mt.Pcc(c)}switch(this.oc.kcf(h)){case 1:v=!0}c.eId=v;this.Lji(new lx(h,ma),a);if(!a.fg)return!0}}if(c.eId){if(this.MPl&&!this.R4c[F.a.zy(h.tagName)])return mt.Pcc(c);this.oc.onClose()}return mt.Pcc(c)}static Y$l(a){3!==
a.nodeType&&Di.a.Gl(a,"alreadyPasted",!0)}static dsl(a){return 3!==a.nodeType&&Di.a.Ra(a,"alreadyPasted")}static Pcc(a){a.sVe++;a.eId=!1;return a.sVe<a.childNodes.length}}Object(w.a)(mt,"HtmlProcessor",Wl,[]);var JA=b(973);class nt{constructor(a){this.Q_=0;this.Q2g=null;this.node=a}}Object(w.a)(nt,"ChartConverterArguments",null,[]);class by{constructor(a=null){this._imgNodesConverted=0;this.gU=a||uo.a.Erh("")}get Db(){return this.gU}process(a,c){a&&(this._imgNodesConverted=0,a.querySelectorAll&&(a=
a.querySelectorAll("div"),1===a.length&&(a=new Cp.a(c,this.iFk.bind(this),new nt(a[0])),a.jk("Chart Converter Operation"),a.fg=!c||c.fg,a.run())))}iFk(a,c){var h=c.node;if(1<c.Q_)return!1;if(1===h.nodeType&&"DIV"===h.tagName){const v=h.getAttribute(ro.a.Fsd);if(v){const B=h.getAttribute(ro.a.fWe),X=h.getAttribute(ro.a.gWe),ma=h.getAttribute(ro.a.dWe),Pa=h.getAttribute(ro.a.eWe),mb=h.getAttribute(ro.a.Vyc);h=h.getAttribute(ro.a.hWe);B&&Pa&&X&&"chart"===X&&mb&&"XLO"===mb&&(c.Q2g=new JA.a(v,B,X,ma,Pa,
mb,h))}}a.wh(this.Bem.bind(this));return!0}Bem(a,c){var h=c.node;if(a=c.Q2g)1===h.childElementCount&&1===h.firstChild.nodeType&&"IMG"===h.firstChild.tagName?(h=h.firstChild,h.setAttribute(ro.a.Fsd,a.ccpId),h.setAttribute(ro.a.fWe,a.pKey),h.setAttribute(ro.a.gWe,a.type),h.setAttribute(ro.a.eWe,a.dc),h.setAttribute(ro.a.Vyc,a.client),a.version&&h.setAttribute(ro.a.hWe,a.version),a.count&&h.setAttribute(ro.a.dWe,a.count),this._imgNodesConverted++):r.ULS.sendTraceTag(541361690,307,15,"Invalid html received"),
this.gU._imgNodesConverted=this._imgNodesConverted;c.Q_++;return!1}}Object(w.a)(by,"ChartConverter",null,[]);var Pv=b(1790);class Tq{constructor(){this.Qy=0;this.Vxc=6;this.GNk=this.xoh=!1;this.kQe=null;this.Aoh=this.zoh=this.KNk=this.INk=this.yoh=!1;this.progId=null;this.JNk=this.XYb=this.Oxd=this.HNk=this.LNk=!1;this.Wzm=this.v7b=0;this.wBf=this.platform=null;this.Gmb={}}get iUf(){if(null!==this.kQe)switch(this.kQe){case "XLO":return"Excel Online"}if(this.Aoh)return"Word Online";if(this.zoh||this.yoh)return"PowerPoint Online";
if(this.xoh)return"Excel Online";switch(this.progId){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}l4l(){r.ULS.sendTraceTag(51406241,307,50,JSON.stringify(this.SWj()))}m4l(){const a=this.Gmb;for(const h in a){var c=h;const v=a[h];v&&(v.SourceApp=this.iUf,v.Browser=Pv.a[this.v7b],v.TagName=c,v.OperationId=this.wBf,r.ULS.sendTraceTag(51406242,307,50,JSON.stringify(v)))}}ZFd(a,c){a&&a.length&&
c&&c.length&&(a=a.toLowerCase(),c=c.toLowerCase(),a in this.Gmb||(this.Gmb[a]={}),this.Gmb[a][c]=this.Wgl(a,c)+1)}Wgl(a,c){if(!(a&&a.length&&c&&c.length&&this.Gmb&&a in this.Gmb))return 0;a=a.toLowerCase();c=c.toLowerCase();return(a=this.Gmb[a])&&c in a?a[c]:0}SWj(){const a={};a.ActionIdFlags=this.Qy;a.SourceApp=this.iUf;a.CopySourceBrowser=this.Vxc;a.PasteBrowser=this.v7b;a.IsSameBrowserPaste=this.ARl(this.Vxc,this.v7b);a.IsCrossBrowserPaste=this.SIl(this.Vxc,this.v7b);a.IsUncategorizedBrowserPaste=
this.gUl(this.Vxc,this.v7b);a.Platform=this.platform;a.OperationId=this.wBf;return a}ARl(a,c){return 5===a||6===a?!1:a===c}SIl(a,c){return 6===a?!1:a!==c}gUl(a,c){return 5===a&&5===c}}Object(w.a)(Tq,"HtmlContentMetadata",null,[]);var Yo=b(1788),Cw=b(931),ot=b(326),As=b(228),Wy=b(1523);class an{constructor(a,c,h,v,B,X){this.Pu=this.X6a=this.Un=this.zc=this.kh=this.$b=this.XB=null;this.Dqg=!1;this.uL=this.ved=this.Sve=this.Lw=this.Bb=this.zq=this.rf=this.fPi=this.vne=null;this.Jza=a;this.$2e=this.VLa=
null;this.Dh=c;this.transaction=h;this.kW=v;this.Fs=B;this.A2=X}get ti(){return this.Pu||(this.Pu=xa.a.instance.ra("Box4.Styles.StyleSettings"))}get K(){return l.AFrameworkApplication.K}get Qve(){return!!this.K&&this.K.$("PasteTextOnlyKeepDestinationStyleIsEnabled")}get Sqj(){return!!this.K&&this.K.$("PreserveEopFormattingPasteIsEnabled")}get KD(){return this.uL||(this.uL=xa.a.instance.resolve("Box4.IFontStylesGalleryCache"))}get isProgressiveStyleEnabled(){return this.ti&&this.ti.isProgressiveStyleEnabled}get BB(){return this.XB||
(this.XB=xa.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get qb(){return this.$b||(this.$b=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get paragraphEditor(){return this.kh||(this.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}get Yb(){return this.zc||(this.zc=xa.a.instance.resolve("Box4.List.IListReader"))}get Oo(){return this.Un||(this.Un=xa.a.instance.resolve("Box4.List.IListEditor"))}get Hhb(){return this.X6a||(this.X6a=xa.a.instance.ra("Box4.List.ISingleLevelListEditor"))}get Xj(){return this.rf||
(this.rf=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get Wg(){return this.zq||(this.zq=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get hd(){return this.Bb||(this.Bb=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get qU(){return this.Lw||(this.Lw=xa.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get $Td(){return this.Sve||(this.Sve=xa.a.instance.ra("Box4.IPastedParagraphSpaceHandler"))}set $Td(a){this.Sve=
a}get dhi(){return!1}get UFi(){return this.K.$("WordEditorAutoResizeImageIsEnabled")}xjh(){}get pId(){return!1}Sgi(a){var c=void 0===this.Dh.Qy||null===this.Dh.Qy?"not available":Object(Yo.a)(Wy.a,this.Dh.Qy);r.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.Dh.Qy,c);r.ULS.shipAssertTag(6305487,307,Gc.SelectionEditor.ke(this.Jza));if(this.OPd)return r.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.Dh.dVa=ne.SelectionFactory.yn(this.Jza),a.wh(Object(m.a)(this,this.Dfb,"pasteTeardown")),
!0;if(!this.Jza.node)return r.ULS.sendTraceTag(572330334,307,10,"Something's wrong! The IP is pointing to a null node. Aborting paste"),!1;c=new Kd.GraphIterator;c.set(this.Jza.node);Gc.SelectionEditor.vs(c);ie.OutlineElementNavigator.Wc(c);this.fPi=c.origin;if(this.dhi)return c.Kr(10),this.xjh(c,a),a.wh(Object(m.a)(this,this.Min,"setSelectionAfterPastingOutlines")),!0;this.kW&&this.kW.Ykm(this.Jza);if(!this.Cvn(this.Jza))return this.Dh.cP&&(this.Dh.cP.fail("SplitLine Failed",!0),this.Dh.failed=!0),
this.Dh.dVa=ne.SelectionFactory.yn(this.Jza),a.wh(Object(m.a)(this,this.Dfb,"pasteTeardown")),!0;const h=new Yk.a;h.Wb(c);ie.OutlineElementNavigator.Ir(h,!1,!1);this.VLa=new Cw.a(c);this.$2e=new Cw.a(h);a.wh(Object(m.a)(this,this.Jzm,"pasteExecution"));return!0}Jzm(a){bh.a.mark(5568);this.wjh(a);let c=Object(m.a)(this,this.qcm,"mergeAfterPaste");if(this.cUh){const h=this.OGi();h&&(c=Object(m.a)(this,this.Dfb,"pasteTeardown"));r.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",
h)}a.wh(c);return!0}OGi(){return!1}get cUh(){return this.K.$("PptCcpFix2IsEnabled")}get mnn(){return this.K.$("CopyAndPasteOneParagraphIndentationFixIsEnabled")}qcm(a){bh.a.mark(5569);var c=new Kd.GraphIterator;this.VLa.restore(c);an.u4||(this.VLa=null);var h=new Kd.GraphIterator;this.$2e.restore(h);this.$2e=null;r.ULS.shipAssertTag(6305489,307,Ta.OutlineElementReader.Gg(c));r.ULS.shipAssertTag(6305490,307,Ta.OutlineElementReader.Gg(h));ie.OutlineElementNavigator.Fd(c);var v=sd.ParagraphReader.eg(c)?
sd.ParagraphReader.textLength(c.currentNode):0;ie.OutlineElementNavigator.Wc(c);ie.OutlineElementNavigator.Fd(h);r.ULS.shipAssertTag(6305491,307,sd.ParagraphReader.eg(h));var B=sd.ParagraphReader.textLength(h.currentNode);ie.OutlineElementNavigator.Wc(h);let X=this.fWc;var ma=new Yk.a;ma.Wb(c);ie.OutlineElementNavigator.Ir(ma,!1,!1);var Pa=ma.currentNode===h.currentNode,mb=!!this.Dh&&!!(this.Dh.Qy&8192);let Tb=!1;!mb&&this.Dh.Ac&&Object(Ub.a)(uh.DictionaryPropertySet,this.Dh.Ac)&&(mb=(mb=this.Dh.Ac.pg(Uc.a.B7b))&&
""!==mb?!0:!1);if(Pa){v=Kd.GraphIterator.va(c.currentNode);sd.ParagraphReader.xu(ie.OutlineElementNavigator.Fd(v))||(c=h);c.currentNode.id!==h.currentNode.id&&(r.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",ab.ListReader.Pg(c),ab.ListReader.Pg(h)),mb=an.Wf.merge(c,h,!0,mb),r.ULS.shipAssertTag(6305492,307,mb));h=c;var rc=!0}else{Pa=!!(this.Dh.Qy&4);rc=this.hd.Bf&&Pa&&this.Dh.xXa;this.$Td&&this.Dh&&!Pa&&(this.$Td.XHh(c,
!1),this.$Td.XHh(h,!0));ie.OutlineElementNavigator.Fd(ma);Pa=sd.ParagraphReader.eg(ma)?sd.ParagraphReader.textLength(ma.currentNode):0;ie.OutlineElementNavigator.Wc(ma);this.IPj(ma,c,h);var Tc=new Yk.a;Tc.Wb(ma);ie.OutlineElementNavigator.Ir(Tc,!1,!1);an.u4&&Tc.currentNode.id===h.currentNode.id&&(this.Dqg=!0);if(this.qU.lHa||this.mnn)if(Tc.rm.id!==h.rm.id){for(;ma.currentNode.id!==h.currentNode.id;)ie.OutlineElementNavigator.Fd(ma,!1),this.qU.TBa(Oe.a.create(ma.currentNode)),ma.ob(),ie.OutlineElementNavigator.Ir(ma,
!1,!1);ma.Wb(c);ie.OutlineElementNavigator.Ir(ma,!1,!1)}else Tb=!0;this.kW&&({fWc:X,$pa:ma}=this.kW.AGm(c,h,X,ma));if(this.Dh.HYd&&(r.ULS.shipAssertTag(6305493,307,this.Dh.Y2b),Tc=new Kd.GraphIterator,Tc.Wb(ma),Tc=ie.OutlineElementNavigator.Fd(Tc))){var vd=this.Dh.HYd.Ge(Tc.la.J(0));Tc.la.J(0).formatting=vd}Tc=0;mb&&this.Qve&&(Tc=1);vd=this.Inn(c,ma,Tc);this.Dh.n3d=null;if(this.Dh.NBa||this.Dh.eOa)this.Dh.n3d=this.Cgl(vd?c.currentNode:ma.currentNode,vd);var ee=!1;vd&&(ee=ab.ListReader.Pg(c),r.ULS.sendTraceTag(40691870,
307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",ee,ab.ListReader.Pg(h)),this.vne=ee=an.Wf.merge(c,ma,!0,mb,h,void 0,Tb,rc,this.Qve),this.Jnn(c,Tc)&&this.Ocm(c,h,Tc,mb));Tc=an.Vzm.iBl(c,ma,h,v,ee,this.pId);var Ie=!1;if(X){const Xe=new Yk.a;Xe.Wb(h);ie.OutlineElementNavigator.J4(Xe,!1,!1);Ie=ab.ListReader.Pg(Xe);const Yf=ab.ListReader.Pg(h);rc=an.Wf.merge(Xe,h,!0,mb,void 0,!0,void 0,rc,this.Qve,this.Sqj);r.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",
Ie,Yf,rc?"True":"False, will cause IP to reset to zero.");h=(Ie=rc)?Xe:h}else rc=!1,r.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");this.qU.lHa&&Tb&&(vd&&!this.kLl(Tc,ee)?(ma=new Kd.GraphIterator,ma.Wb(c),c=ie.OutlineElementNavigator.Fd(ma),this.qU.fla(c,v,v+Pa)):X&&!this.BNl(Tc,Ie)?(c=new Kd.GraphIterator,c.Wb(ma),c=ie.OutlineElementNavigator.Fd(c),this.qU.fla(c,0,Pa)):(c=new Kd.GraphIterator,c.Wb(ma),c=ie.OutlineElementNavigator.Fd(c),this.qU.TBa(Oe.a.create(c))));
this.QCm(Tc);this.isProgressiveStyleEnabled&&!mb&&this.KD.DGm(Tc)}r.ULS.shipAssertTag(6305494,307,h.Nc);mb=ie.OutlineElementNavigator.Fd(h);B=rc?sd.ParagraphReader.textLength(mb)-B:0;c=!1;Object(Ub.a)(95,this.Dh.Ac)&&(c=this.Dh.Ac.ia(Uc.a.Q8,!1));this.Dh.dVa=c?ne.SelectionFactory.bO(mb,B-1,B):ne.SelectionFactory.vd(mb,B);kg.a.instance.J(10)&&this.Dh&&this.Dh.Y2b&&sd.ParagraphReader.tb(mb)&&this.Dh.VSd&&((B=this.Dh.VSd.nyn)&&this.BB.MK(B,mb,!0),(B=this.Dh.VSd.Hym)&&this.paragraphEditor.yTg(mb,B));
a.wh(Object(m.a)(this,this.Dfb,"pasteTeardown"));return!0}kLl(a,c){return!c&&!!a&&Ta.OutlineElementReader.Gg(a.$pa)&&Ta.OutlineElementReader.h9a(a.$pa)}BNl(a,c){return!c&&!!a&&Ta.OutlineElementReader.Gg(a.xdb)&&Ta.OutlineElementReader.h9a(a.xdb)}QCm(a){an.Aii&&a&&an.Aii.yGm(a)}Inn(a,c,h){ab.ListReader.Pg(a)?(an.Dc.vAb&&this.Hhb&&this.Hhb.mff(a),c=ab.ListReader.Pg(c)?this.hGi:!0):Ta.OutlineElementReader.isEmpty(a,!0)&&!h?(an.Wf.FUa(a),c=!1):c=ab.ListReader.mq||!ab.ListReader.Pg(c);this.kW&&(c=this.kW.R4j(a,
c));return c}Jnn(a,c){return ab.ListReader.Pg(a)||1===c?!0:!1}Ocm(a,c,h,v){const B=ab.ListReader.Pg(a);if(B){if(v=new Yk.a,v.Wb(a),ie.OutlineElementNavigator.Ir(v,!1,!1),v.rm.id!==c.rm.id){h=this.Yb.Op(a);this.Yb.lB(a);var X=a.currentNode.ia(Yb.a.listID,0);a.ob();var ma=this.Yb.lJi,Pa=!0;for(h.vy=ai.a.Ih;v.currentNode.id!==c.currentNode.id;){if(!ma||!Ta.OutlineElementReader.hpn(v))if(!ab.ListReader.Pg(v))({pza:h}=this.Oo.Loa(h.propertySet,v,h)),Pa=!1;else if(B){Pa=this.Yb.M8e(v);var mb=this.Yb.Ev(a.currentNode,
X,Pa);mb=mb?ot.a.fX(mb,null):h;Pa=ot.a.$N(mb.listType,h.listStyle,null,0,Pa,"","");Pa.Geb=a.currentNode;this.Oo.shn(Pa);this.Oo.x0d(v,!0);Pa=!1}ie.OutlineElementNavigator.Ir(v,!1,!1)}ma&&Pa&&this.Oo.tVg()}}else if(1===h)for(h=new Yk.a,h.Wb(a),ie.OutlineElementNavigator.Fd(h),a=sd.ParagraphReader.eg(h)?h.currentNode:null,X=this.qb.oCd(h),ie.OutlineElementNavigator.Wc(h),ie.OutlineElementNavigator.Ir(h,!1,!1);h.currentNode.id!==c.currentNode.id;)ie.OutlineElementNavigator.Fd(h),ma=sd.ParagraphReader.eg(h)?
h.currentNode:null,ie.OutlineElementNavigator.Wc(h),ma&&a&&v&&(X&&this.BB.MK(X,ma,!0),this.A2.j5h(a,ma,B),this.A2.KYa(a,ma,1,!0)),ie.OutlineElementNavigator.Ir(h,!1,!1)}IPj(a,c,h){var v=!1;if(this.hd.Bf){var B=!1;this.kW&&(B=c.currentNode,B=this.kW.PPl(B)||this.kW.Tkf(B));B?this.hd.AZa=4:v=!0}if(v){for(;a.currentNode!==h.currentNode;){ie.OutlineElementNavigator.Fd(a,!1);v=this.Wg.YWc(Oe.a.create(a.currentNode));let X;({type:X}=v.NCd(X)).returnValue&&this.hd.Xq(X);for(B=0;B<v.length;B++){let ma;const Pa=
({DKd:ma}=v.getContext(B)).returnValue;ma&&(an.hyperlinkEditor.Aeb(Pa,1),this.Xj.nhb(Pa,1,null,!0))}a.ob();ie.OutlineElementNavigator.Ir(a,!1,!1)}a.Wb(c);ie.OutlineElementNavigator.Ir(a,!1,!1)}}Cgl(a,c){a=Kd.GraphIterator.va(a);ie.OutlineElementNavigator.Fd(a);return sd.ParagraphReader.tb(a.currentNode)?(c=c?sd.ParagraphReader.textLength(a.currentNode):0,ne.SelectionFactory.vd(a.currentNode,c)):Wf.TableReader.gV(a.currentNode)?ne.SelectionFactory.fq(a.currentNode):null}Min(a){const c=Kd.GraphIterator.va(this.fPi);
c.qC(1);this.Dh.dVa=ne.SelectionFactory.en(c.currentNode,!1);a.wh(Object(m.a)(this,this.Dfb,"pasteTeardown"));return!0}Dfb(){var a=void 0===this.Dh.Qy||null===this.Dh.Qy?"not available":Object(Yo.a)(Wy.a,this.Dh.Qy);r.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.Dh.Qy,a);r.ULS.shipAssertTag(6305497,307,!!this.Dh.dVa);an.u4&&this.VLa&&(a=new Kd.GraphIterator,this.VLa.restore(a),this.VLa=null,this.orl(a));this.transaction.dispose();a=this.Fs.Su;if(!a.Cd||!a.editingView.wj)return!1;
a.editingView.KBn();return!1}orl(a){if(a){if(this.pId&&Wf.TableReader.Jv(a)&&this.Dqg){if(null!=this.vne&&0==this.vne){var c=new Yk.a;c.Wb(a);ie.OutlineElementNavigator.Ir(c,!1,!1);a.Wb(c)}c=ji.Z_m(a);let h=sd.ParagraphReader.Bl(c);c&&h&&(this.Dh.dVa=ne.SelectionFactory.vd(h,0),a=Kd.GraphIterator.va(c))}else ji.Pzm(a);a&&Wf.TableReader.Jv(a)&&Fe.returnToContainingCell(a)&&ji.xKj(a.currentNode)}else r.ULS.sendTraceTag(525361991,3022,50,"Preceding iterator should not be null.")}umn(a,c){const h=new Kd.GraphIterator;
h.Wb(a);a=ie.OutlineElementNavigator.Fd(h);c=sd.ParagraphReader.tb(a)&&c===sd.ParagraphReader.textLength(a);r.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",c);return c}Cvn(a){r.ULS.shipAssertTag(6305498,307,Gc.SelectionEditor.ke(a));const c=Kd.GraphIterator.va(a.node);var h=c.nc();ie.OutlineElementNavigator.Wc(c);h&&a.Nc||r.ULS.sendTraceTag(40425481,307,15,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:h,["ipContextNodeType"]:a.node.type,["isValidIpContext"]:a.Nc});
if(!Ta.OutlineElementReader.Gg(c)&&(r.ULS.sendTraceTag(594072134,307,10,"sourceOE is not an OutlineElement"),this.K.$("AbortClipboardOperationWhenFailToRootAtOEIsEnabled")))return!1;h=an.Wf.Mqa(c,!0);const v=this.umn(c,a.cpBegin);an.Wf.o$(c,h,a,!1,!1,!0,v);return!0}static get hyperlinkEditor(){return an.Oi||(an.Oi=xa.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Kd(){return vg.PageReader.instance}static get Wf(){return an.Vd||(an.Vd=xa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Dc(){return As.a.getInstance()}static get Ua(){return an.Na||
(an.Na=xa.a.instance.ra("Box4.IFeatureHelper"))}static get Aii(){return an.Uzg||(an.Uzg=xa.a.instance.resolve("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste"))}static get Vzm(){return an.Tzg||(an.Tzg=xa.a.instance.resolve("Box4.Actors.PastedContentsPostProcessorHelper"))}static get u4(){null==this.C6&&(l.AFrameworkApplication.Mg("he991617;3eed2178"),this.C6=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",
!1):!1);return this.C6}}an.Na=null;an.Vd=null;an.Oi=null;an.Uzg=null;an.Tzg=null;an.C6=null;Object(w.a)(an,"APasteExecutionManager",null,[]);class Sr{constructor(a){this.si=a}reset(){this.si.reset()}get dzc(){return this.si.dzc}z9(a,c){this.si.z9(a,c)}JAa(a){this.si.JAa(a)}efb(a){this.si.efb(a)}Wra(a){this.si.Wra(a)}FAa(a){this.si.FAa(a)}vLa(a,c){this.si.vLa(a,c)}uLa(){this.si.uLa()}iE(a){this.si.iE(a)}hE(){this.si.hE()}bfb(){this.si.bfb()}afb(){this.si.afb()}MAa(a){this.si.MAa(a)}KAa(){this.si.KAa()}zLa(a){this.si.zLa(a)}LAa(){this.si.LAa()}nZa(a){this.si.nZa(a)}y9(a){this.si.y9(a)}v9(){this.si.v9()}x9(a){this.si.x9(a)}w9(){this.si.w9()}u9(a){this.si.u9(a)}t9(){this.si.t9()}ALa(a,
c){this.si.ALa(a,c)}lZa(){this.si.lZa()}}Object(w.a)(Sr,"AHtmlNormalizer",null,[188,189]);class Qv extends Sr{constructor(a){super(a);this.eH=!1}z9(a,c){this.eH?this.IK.VJ(()=>{this.RFf(a,c)}):this.RFf(a,c)}RFf(a,c){this.si.z9(a,c)}JAa(a){this.eH?this.IK.VJ(()=>{this.tFf(a)}):this.tFf(a)}tFf(a){this.si.JAa(a)}Wra(a){this.eH?this.IK.VJ(()=>{this.rQc(a)}):this.rQc(a)}rQc(a){this.si.Wra(a)}FAa(a){this.eH?this.IK.VJ(()=>{this.sFf(a)}):this.sFf(a)}sFf(a){this.si.FAa(a)}vLa(a,c){this.eH?this.IK.VJ(()=>
{this.oFf(a,c)}):this.oFf(a,c)}oFf(a,c){this.si.vLa(a,c)}uLa(){this.eH?this.IK.VJ(Object(m.a)(this,this.nFf,"processAnchorEnd")):this.nFf()}nFf(){this.si.uLa()}iE(a){this.eH?this.IK.VJ(()=>{this.DFf(a)}):this.DFf(a)}DFf(a){this.si.iE(a)}hE(){this.eH?this.IK.VJ(Object(m.a)(this,this.CFf,"processParagraphEnd")):this.CFf()}CFf(){this.si.hE()}bfb(){this.eH?this.IK.VJ(Object(m.a)(this,this.FFf,"processPreFormattedTextStart")):this.FFf()}FFf(){this.si.bfb()}afb(){this.eH?this.IK.VJ(Object(m.a)(this,this.EFf,
"processPreFormattedTextEnd")):this.EFf()}EFf(){this.si.afb()}MAa(a){this.eH?this.IK.VJ(()=>{this.xFf(a)}):this.xFf(a)}xFf(a){this.si.MAa(a)}KAa(){this.eH?this.IK.VJ(Object(m.a)(this,this.uFf,"processListEnd")):this.uFf()}uFf(){this.si.KAa()}zLa(a){this.eH?this.IK.VJ(()=>{this.wFf(a)}):this.wFf(a)}wFf(a){this.si.zLa(a)}LAa(){this.eH?this.IK.VJ(Object(m.a)(this,this.vFf,"processListItemEnd")):this.vFf()}vFf(){this.si.LAa()}y9(a){this.eH?this.IK.VJ(()=>{this.QFf(a)}):this.QFf(a)}QFf(a){this.si.y9(a)}v9(){this.eH?
this.IK.VJ(Object(m.a)(this,this.NFf,"processTableEnd")):this.NFf()}NFf(){this.si.v9()}x9(a){this.eH?this.IK.VJ(()=>{this.PFf(a)}):this.PFf(a)}PFf(a){this.si.x9(a)}w9(){this.eH?this.IK.VJ(Object(m.a)(this,this.OFf,"processTableRowEnd")):this.OFf()}OFf(){this.si.w9()}u9(a){this.eH?this.IK.VJ(()=>{this.MFf(a)}):this.MFf(a)}MFf(a){this.si.u9(a)}t9(){this.eH?this.IK.VJ(Object(m.a)(this,this.LFf,"processTableCellEnd")):this.LFf()}LFf(){this.si.t9()}ALa(a,c){this.eH?this.IK.VJ(()=>{this.yFf(a,c)}):this.yFf(a,
c)}yFf(a,c){this.si.ALa(a,c)}lZa(){this.eH?this.IK.VJ(Object(m.a)(this,this.fki,"processMathEnd")):this.fki()}fki(){this.si.lZa()}}Object(w.a)(Qv,"AQueuingHtmlNormalizer",Sr,[]);var Qz=b(1740);class gr{constructor(){this.sxe=new Qz.a}VJ(a){this.sxe.enqueue(a)}flush(a=!1){for(a&&this.Q_d();!this.sxe.isEmpty;)this.sxe.dequeue()();a&&this.VYd()}Q_d(){}VYd(){}}Object(w.a)(gr,"QueuedEventManager",null,[]);class Lt extends gr{constructor(a){super();this.id=void 0;this.GVe=null;this.XId=!1;this.QLa="";this.WId=
this.IJd=!1;this.vVe=this.NWb=null;this.wNc=0;this.yJc=this.JKc=this.Cmf=!1;this.table=null;this.xvf=0;this.EW=a}get puc(){return!!this.table}Q_d(){this.EW.e7b.push(this.EW.currentState);this.EW.currentState=this}VYd(){this.EW.currentState=this.EW.e7b.pop()}}Lt.nextId=void 0;Object(w.a)(Lt,"ContentState",gr,[]);var Dw=b(297);class Rv{constructor(a,c,h){this.colSpan=a.colSpan;this.rowSpan=a.rowSpan;this.width=a.width;this.height=a.height;this.TXa=a.TXa;this.shadingColor=a.shadingColor;this.verticalAlignment=
a.verticalAlignment;this.Kea=a.Kea;this.o4d=a.o4d;this.x3b=a.x3b;this.u3=a.u3;this.contents=h;this.Yml=c}}Object(w.a)(Rv,"TableCell",null,[]);var Lg=b(971),Xy=b(972),Yy=b(975),mx=b(976),Nu=b(974);class Zy extends gr{constructor(a,c){super();this.EW=a;this.XHg=new Zq.a;this.OP=new Zq.a;this.yse=[];this.jfd=[];this.WDa=-1;this.ZOa=0;this.Nij=c.aQh;this.Mij=c.oHl;this.Mwj=c.DWf;this.Xo=c.width;this.pqg=c.TXa;this.kgj=new Dw.a(new Ov.a(c.Q4.TKh,c.Q4.wFd),c.$y,c.vka,c.cultureName,c.ewa);this.Rhj=c.eGd;
this.Dhd=c.styleId;this.Swj=c.tableLook}get si(){return this.EW.si}bEm(a){this.WDa++;this.XHg.add(a);this.jfd[this.WDa]=a.height;this.ZOa=0}get Ynk(){for(;this.ZOa>=this.OP.count;)this.OP.add(Array(this.WDa+1));return this.OP.J(this.ZOa)}cHe(a,c,h,v,B,X,ma){if(0>this.WDa)return!1;for(;this.yse[this.ZOa]>=this.WDa;)this.ZOa++;a=new Rv(a,new Dw.a(c,h,v,B,X),ma);this.Ynk[this.WDa]=a;if(1<a.rowSpan)for(c=this.WDa+a.rowSpan-1,v=this.ZOa,h=this.ZOa+a.colSpan-1;v<=h;v++)this.yse[v]>=c||(this.yse[v]=c);this.ZOa+=
a.colSpan;this.jfd[this.WDa]<a.height&&(this.jfd[this.WDa]=a.height);return!0}Q_d(){this.EW.currentState.table=this}VYd(){this.EW.currentState.table=null}gnh(){this.flush(!0);const a=this.WDa+1;var c=Array(a);for(var h=0;h<a;h++)c[h]=Array(this.OP.count);h=!0;var v=0;for(var B=0;B<this.OP.count;B++){var X=this.OP.J(B),ma=!0;for(var Pa=0;Pa<a;Pa++){var mb=X[Pa];mb&&(ma=!1,c[Pa][B+v]=new Yy.a(mb.colSpan,mb.rowSpan,mb.width,mb.height,void 0,void 0,void 0,void 0,mb.TXa,mb.x3b))}ma?(this.OP.removeAt(B),
B--,++v):h=!1}if(!h){(c=this.pqg?this.EW.PZg(c,this.Xo/100):this.EW.PZg(c))&&c.length!==this.OP.count&&(c=null);this.EW.u$a(!0);this.EW.Jpd();this.si.y9(new Nu.a(a,this.OP.count,this.Xo,this.pqg,c,this.Nij,this.Mij,this.Mwj,this.Rhj,this.Dhd,this.Swj,this.kgj));for(c=0;c<a;c++){h=this.XHg.J(c);this.si.x9(new mx.a(this.jfd[c],new Dw.a(h.Q4,h.$y,h.vka,h.cultureName,h.ewa)));for(h=0;h<this.OP.count;h++){v=this.OP.J(h)[c];var Tb=!!this.Dhd&&""!==this.Dhd&&"Custom"!==this.Dhd;B=v?v.colSpan:0;X=v?v.rowSpan:
0;ma=v?v.width:0;Pa=v?v.height:0;mb=v?v.u3:0;const rc=v?v.TXa:!1,Tc=v&&(65536&mb||!Tb)?v.shadingColor:"",vd=v?v.verticalAlignment:0,ee=v?v.x3b:!1;Tb=v?this.EW.S8k(v.Kea,h,c,this.OP,Tb,v.u3):new Lg.a;const Ie=v?v.o4d:new Xy.a,Xe=v?v.Yml:null;this.si.u9(new Yy.a(B,X,ma,Pa,Tc,vd,Tb,Ie,rc,ee,mb,new Dw.a(Xe?Xe.Q4:null,Xe?Xe.$y:null,Xe?Xe.vka:null,Xe?Xe.cultureName:null,Xe?Xe.ewa:null)));v&&!v.x3b&&(v.contents.Q_d(),v.contents.flush(),this.EW.u$a(!1),this.EW.Jpd(),v.contents.VYd());this.si.t9()}this.si.w9()}this.si.v9();
this.EW.currentState.yJc=!1;this.EW.jih(!1)}}}Object(w.a)(Zy,"NormalizedTable",gr,[]);class cy{constructor(a=!1,c=!1){this.wjj=a;this.c_=c}get QMl(){return this.wjj}get p$(){return this.c_}}Object(w.a)(cy,"HtmlNormalizerSettings",null,[206]);var Rz=b(750);class du extends Qv{constructor(a,c=null){super(a);this.e7b=new Rz.a;this.vNb=c||new cy}reset(){super.reset();this.currentState=new Lt(this);this.e7b.clear();this.eH=!1}get IK(){return this.currentState&&this.currentState.puc?this.currentState.table:
this.currentState}hvd(a=!1){this.currentState.XId||(this.Jpd(),this.si.iE(this.currentState.GVe),this.currentState.XId=!0,this.currentState.yJc=!1);a||!this.currentState.NWb||this.currentState.WId||(this.si.vLa(this.currentState.NWb,this.currentState.vVe),this.currentState.WId=!0)}TAc(){this.currentState.WId&&(this.si.uLa(),this.currentState.WId=!1)}gCk(){this.currentState.XId&&(this.si.hE(),this.currentState.XId=!1,this.currentState.QLa="")}jih(a){this.currentState.JKc&&(this.currentState.yJc?a||
(this.si.iE(null),this.si.hE(),this.si.LAa(),this.currentState.JKc=!1):(this.si.LAa(),this.currentState.JKc=!1,this.currentState.yJc=!0))}u$a(a){this.TAc();this.gCk();this.jih(a)}yvm(a){this.si.MAa(new Oh.a(2,1,a));this.currentState.wNc++;this.currentState.Cmf=!0}Jpd(){!this.currentState.JKc&&this.currentState.Cmf&&(this.si.KAa(),this.currentState.wNc--,this.currentState.Cmf=!1)}RFf(a,c){a=this.Hhm(a);if(""!==a)if(this.hvd(),this.currentState.IJd)this.SFf(a,c);else{a=a.split(du.zZj);for(let h=0;h<
a.length-1;h++)this.SFf(a[h],c),this.si.efb(c);this.SFf(a[a.length-1],c)}}yFf(a,c){""!==a&&(this.hvd(),this.si.ALa(a,c))}tFf(a){this.vNb.p$||this.TAc();this.hvd(!0);this.si.JAa(a)}sFf(a){this.currentState.puc||this.si.FAa(a)}rQc(a){this.currentState.NWb&&(a.href=this.currentState.NWb);super.rQc(a)}oFf(a,c){this.TAc();this.currentState.NWb=a;this.currentState.vVe=c}nFf(){this.TAc();this.currentState.NWb=null;this.currentState.vVe=null}DFf(a){this.currentState.GVe=a;this.u$a(!0)}CFf(){this.currentState.GVe=
null;this.u$a(!0)}FFf(){this.currentState.IJd=!0}EFf(){this.currentState.IJd=!1}xFf(a){this.u$a(!1);this.Jpd();this.si.MAa(a);this.currentState.wNc++}uFf(){this.u$a(!1);this.si.KAa();this.currentState.wNc--}wFf(a){this.u$a(!1);this.currentState.wNc||this.yvm(a);this.si.zLa(a);this.currentState.JKc=!0;this.currentState.yJc=!0}vFf(){this.u$a(!1)}y9(a){this.currentState.puc||(this.eH=!0,this.currentState.table=new Zy(this,a))}QFf(){}v9(){if(this.currentState.table){var a=this.currentState.table;this.currentState.table=
null;this.e7b.isEmpty?(this.eH=!1,a.gnh()):this.IK.VJ(Object(m.a)(a,a.gnh,"flushTable"))}}NFf(){}x9(a){this.currentState.puc&&this.currentState.table.bEm(a)}PFf(){}w9(){}OFf(){}u9(a){let c=!1;if(this.currentState.puc){const h=new Lt(this);this.currentState.table.cHe(a,new Ov.a(a.Q4.TKh,a.Q4.wFd),a.$y,a.vka,a.cultureName,a.ewa,h)?(this.e7b.push(this.currentState),this.currentState=h):c=!0}else c=!0;c&&this.currentState.xvf++}MFf(){}t9(){0<this.currentState.xvf?this.currentState.xvf--:this.currentState=
this.e7b.pop()}LFf(){}PZg(a,c=1){if(!a)return null;const h=a.length;if(!h)return null;const v=a[0].length;for(var B=1;B<h;B++)if(a[B].length!==v)return null;B=Array(v+1);B[0]=0;const X=Array(v+1);for(var ma=0;ma<X.length;ma++)X[ma]=!1;ma=new Ua.a;for(let mb=0;mb<v;mb++){for(var Pa=0;Pa<h;Pa++){const Tb=a[Pa][mb];if(Tb&&0<Tb.width){const rc=Math.min(mb+Tb.colSpan,v);B[rc]=B[mb]+Tb.width*(Tb.TXa?c:1);X[rc]=!0}}if(X[mb+1]){Pa=B[mb+1]-B[mb];if(0>=Pa)return null;ma.add(Pa)}else B[mb+1]=B[mb]}return ma.toArray()}Gam(a,
c){1&c||(a.borderTopStyle=12);16&c||(a.borderRightStyle=12);256&c||(a.borderBottomStyle=12);4096&c||(a.borderLeftStyle=12);return a}S8k(a,c,h,v,B,X){if(!a)return null;B&&(a=this.Gam(a,X));if(0>h||0>c||c>v.count-1)return a;0<=c-1&&h<=v.J(c-1).length-1&&1===a.borderLeftStyle&&(B=v.J(c-1)[h])&&1!==B.Kea.borderRightStyle&&(a.borderLeftStyle=B.Kea.borderRightStyle,a.borderLeftColor=B.Kea.borderRightColor,a.borderLeftWidth=B.Kea.borderRightWidth);0<=h-1&&h<=v.J(c).length-1&&1===a.borderTopStyle&&(c=v.J(c)[h-
1])&&1!==c.Kea.borderBottomStyle&&(a.borderTopStyle=c.Kea.borderBottomStyle,a.borderTopColor=c.Kea.borderBottomColor,a.borderTopWidth=c.Kea.borderBottomWidth);return a}Hhm(a){this.currentState.IJd||(a=this.vNb.QMl?a.replace(du.lwl," "):a.replace(du.kwl," "));a.startsWith(" ")&&(this.currentState.QLa.endsWith(" ")||""===this.currentState.QLa)&&(a=F.a.substring(a,1,a.length));return a}SFf(a,c){""!==a&&(this.si.z9(a,c),this.currentState.QLa+=a)}}du.kwl=RegExp("[ \t\f\u200b\r\n]+","g");du.lwl=RegExp("[ \f\u200b\r\n]+",
"g");du.zZj="\t";Object(w.a)(du,"DefaultHtmlNormalizer",Qv,[]);class pt extends du{constructor(a,c,h){super(a,h);this.Alg=!1;this.Omb=c}static xJl(a){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DesignerImageUrl",!1)&&a?(a=pt.Fsk.exec(a))&&0<a.length:!1}rQc(a){this.Omb.D7b&&(l.AFrameworkApplication.yra?this.Alg||(a=new oe.StandardDialog,a.yc=0,a.Nd(1,CommonUIStrings.l_DialogClose),a.mv(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,
1,null),this.Alg=!0):this.Omb.z4h?this.Omb.nOd=!0:a.src&&""!==a.src?Af.a.u8(a.src)!==Af.a.u8(window.location.href)||pt.xJl(a.src)?a.src.startsWith("data:")&&19922944<a.src.length?l.AFrameworkApplication.pa.processAction(zb.a.Zgi,2):a.src.startsWith("webkit-fake-url")?l.AFrameworkApplication.pa.processAction(zb.a.Xgi,2):(this.TAc(),this.hvd(!0),this.si.Wra(a)):l.AFrameworkApplication.pa.processAction(zb.a.ahi,2):l.AFrameworkApplication.pa.processAction(zb.a.$gi,2))}}pt.Fsk=RegExp(".\\/we\\/s\\/\\d+_resources\\/\\d+\\/D.+.png");
Object(w.a)(pt,"Box4HtmlNormalizer",du,[]);class mv{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.htmlProcessor=a;this.Mef=c;this.k3j=h;this.pZi=v;this.DNk=B;this.W9m=X;this.X9m=ma;this.vFd=Pa;this.ewl=mb;this.gwl=Tb;this.MZl=rc}}Object(w.a)(mv,"ExecutePasteArguments",null,[]);class hr extends an{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe){super(c,h,v,Tb,Tc,Ie);this.$fa=null;this.qga=a;this.bce=B;this.Zle=X;this.RCe=ma;this.ZFe=Pa;this.ikc=mb;this.vNb=ee;this.qa=rc;this.omg=Object.assign(new Vy.a,
{g2b:2===this.Dh.mWb||3===this.Dh.mWb});this.pie=vd;this.I7c=Xe;this.gRb=rc.$("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.juj=rc.$("ParseStyleFromRawHtmlHeadIsEnabled");this.Yuj=rc.$("RemoveSpacesAfterEndFragmentIsEnabled")}get OPd(){return!1}get pId(){return!0}wjh(a){this.$fa=new Kd.GraphIterator;this.VLa.restore(this.$fa);r.ULS.shipAssertTag(6305550,307,Ta.OutlineElementReader.Gg(this.$fa));this.Dh.cP&&this.Dh.cP.UTb("external");var c=this.Dh.Qy&8192?1:0,h=this.Zle.value.create(c,
this.$fa,this.Dh.Jwc,this.Dh.Bgb);const v=this.RCe.value.create(c,this.$fa),B=uo.a.Erh(l.AFrameworkApplication.userSessionId),X=uo.a.Abf(l.AFrameworkApplication.userSessionId),ma=uo.a.N7e(H.a.Jsb,this.Dh.Jwc),Pa=uo.a.zCh(l.AFrameworkApplication.userSessionId),mb=uo.a.ACh(l.AFrameworkApplication.userSessionId),Tb=this.gRb?this.QAl():null,rc=uo.a.$vh(H.a.Jsb,this.Dh.Jwc),Tc=uo.a.awh(l.AFrameworkApplication.userSessionId),vd=this.ikc.SFi?uo.a.i6k(l.AFrameworkApplication.userSessionId):null;c=this.bce.value.create(c,
this.$fa,h,v,null,ma,this.WLj);c=new Nv(c,Pa,mb);c=new pt(c,h,this.vNb);c=new Yt.a(c,this.ikc,this.omg,vd);c=new Mu(c,rc,Tb,this.qa);c=new mt(c,Tc);h=new mv(c,h,B,X,ma,Pa,mb,Tb,rc,Tc,vd);h=new Cp.a(a,Object(m.a)(this,this.zhm,"normalizeHtmlGlobally"),h);h.jk("paste and request pictures");h.fg=!a||a.fg;h.run()}get WLj(){return this.qga.getElementsByTagName("a").length}zhm(a){this.I7c.ZYh(this.qga)&&l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordRemoveSpacesAfterEndFragmentSettings");
this.Yuj&&this.I7c.OGn(this.qga);a.wh(Object(m.a)(this,this.fEm,"preprocessStyle"));return!0}fEm(a){if(this.juj){const c=this.qga.getElementsByTagName("style");if(c&&0<c.length){r.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let h=0;h<c.length;h++)this.pie.jek(this.qga,c[h]),c[h]&&(c[h].parentNode.removeChild(c[h]),h--)}}a.wh(Object(m.a)(this,this.xek,"convertWordListHtml"));return!0}xek(a,c){this.ZFe.value.create(c.pZi).process(this.qga,
a);(c=xa.a.instance.ra("Box4.IFeatureHelper"))&&c.isFeatureEnabled(22)?a.wh(Object(m.a)(this,this.Edk,"convertChartHtml")):a.wh(Object(m.a)(this,this.Zji,"processHtml"));return!0}Edk(a,c){(new by(c.k3j)).process(this.qga,a);a.wh(Object(m.a)(this,this.Zji,"processHtml"));return!0}Zji(a,c){c.htmlProcessor.process(this.qga,a);c=c.Mef&&c.Mef.D7b?Object(m.a)(this,this.aFb,"requestImages"):Object(m.a)(this,this.xhh,"endPasteOperation");a.wh(c);return!0}aFb(a,c){if(c=c.Mef){let h=!1,v=!1,B=!1,X=!1,ma=-1;
const Pa=new uh.DictionaryPropertySet,mb=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(Ub.a)(95,this.Dh.Ac)){h=this.Dh.Ac.ia(Yb.a.Wca,!1);const Tb=this.Dh.Ac.ia(Uc.a.jS,"");B=this.Dh.Ac.ia(Uc.a.Q8,!1);X=this.Dh.Ac.ia(Ed.a.Zca,!1);mb.test(Tb)&&(v=!0);this.UFi&&(ma=this.Dh.Ac.ia(ii.a.Yba,-1))}else this.Dh.Qy&256&&this.qga&&(h=!0,mb.test(this.qga.innerHTML)&&(v=!0));Pa.setValue(Yb.a.Wca,h);Pa.setValue(Uc.a.PKc,v);Pa.setValue(Uc.a.Q8,B);Pa.setValue(ii.a.Yba,ma);Pa.setValue(Ed.a.Zca,
X);c.k0d(Pa);c.Rzf();c.Deb&&(this.Dh.qJc=!0,this.Dh.jff=c.S_,this.Dh.Gwf=c.Deb,h&&!B&&re.c(zb.a.bFk),l.AFrameworkApplication.pa.processAction(zb.a.aFb,2))}a.wh(Object(m.a)(this,this.xhh,"endPasteOperation"));return!0}xhh(a,c){uo.a.T8l(c.pZi);uo.a.o4l(c.gwl);uo.a.v7l(c.W9m);uo.a.w7l(c.X9m);uo.a.R4l(c.MZl);a="Others";c.vFd&&(c.vFd.l4l(),c.vFd.m4l(),a=c.vFd.iUf);uo.a.n4l(c.ewl,a);uo.a.S3l(c.DNk,a);return!1}QAl(){const a=new Tq;a.v7b=H.a.Jsb;this.Dh&&(a.Qy=this.Dh.Qy,a.wBf=this.Dh.Jwc,this.Dh.Ac&&(a.progId=
this.Dh.Ac.ia(Uc.a.Wgi,"")));this.qga&&this.qga.innerHTML&&(a.Wzm=this.qga.innerHTML.length);l.AFrameworkApplication.sessionStartInfoSettings&&(a.platform=l.AFrameworkApplication.sessionStartInfoSettings.Platform);return a}get hGi(){return!0}get fWc(){r.ULS.shipAssertTag(6305551,307,!!this.$fa);if(this.ikc.TFi(this.omg)){let a=!1;Ta.OutlineElementReader.Gg(this.$fa)&&(this.$fa.A8(),a=!0);const c=sd.ParagraphReader.eg(this.$fa)&&!this.$fa.currentNode.ia(Uc.a.VRh,!1);a&&this.$fa.ob();return c}return sd.ParagraphReader.eg(this.$fa)}}
Object(w.a)(hr,"ExternalPasteExecutionManager",an,[]);class dy{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.bce=a;this.Zle=c;this.RCe=h;this.ZFe=v;this.ikc=B;this.kW=X;this.qa=ma;this.pie=Pa;this.vNb=mb;this.A2=Tb;this.I7c=rc}create(a,c,h,v){return new hr(a,c,h,v,this.bce,this.Zle,this.RCe,this.ZFe,this.ikc.value,this.kW,this.qa,Eb.App.oa.Da,this.pie,this.vNb,this.A2,this.I7c)}}Object(w.a)(dy,"Factory",null,[695]);class $y{ZYh(a){if(!a||!a.childNodes)return!1;const c=a.childNodes.length;return 2>
c?!1:this.wKl(a.childNodes[c-2])&&this.mVl(a.childNodes[c-1])}OGn(a){this.ZYh(a)&&(a.removeChild(a.lastChild),r.ULS.sendTraceTag(579371169,307,50,"Remove spaces after end fragment"))}eIl(a){return!!a&&8===a.nodeType}KTl(a){return!!a&&3===a.nodeType}wKl(a){return this.eIl(a)&&"EndFragment"===a.nodeValue}mVl(a){if(!this.KTl(a))return!1;a=a.nodeValue;return!!a&&!a.trim().length}}Object(w.a)($y,"HtmlNormalizerHelper",null,[696]);var qt=b(370),Ou=b(214),ey=b(968),az=b(704);class vn{constructor(a,c,h,v){this.ltd=
this.jtd=null;this.VWc=a;this.w4d=c;this.GJi=h;this.IJi=v}}Object(w.a)(vn,"TableSimplificationInformation",null,[]);var KA=b(241),LA=b(819),kq=b(271);class Sz extends Sys.EventArgs{constructor(a){super();this.yr=a}}Object(w.a)(Sz,"AfterTrimCompleteOnCopyArgs",Sys.EventArgs,[]);var nx=b(1592);class jh extends nx.a{constructor(a,c,h,v){super(a,c,{});this.d$b=[];for(a=0;a<h.length;a++)this.d$b.push(...h.J(a).toArray());this.IHa=0;this.uw=v;this.yr={}}}Object(w.a)(jh,"BasicInternalCopyArguments",nx.a,
[]);class Mt extends Sys.EventArgs{constructor(a){super();this.yr=a}}Object(w.a)(Mt,"BeforePasteArguments",Sys.EventArgs,[]);class Tz extends Sys.EventArgs{constructor(a,c,h,v){super();this.paragraph=a;this.cpBegin=c;this.cpEnd=h;this.yr=v}}Object(w.a)(Tz,"BeforeTrimOnCopyArguments",Sys.EventArgs,[]);var bz=b(1639),cz=b(1640);class Ew{constructor(a,c,h,v,B,X,ma,Pa,mb){this.Dbc=a;this.source=c;this.target=h;this.HBf=v;this.rowIndex=B;this.Km=X;this.bwc=ma;this.Qgi=Pa;this.kd=mb}}Object(w.a)(Ew,"CoreInternalTablePasteArguments",
null,[]);class Fw extends Sys.EventArgs{constructor(a,c,h,v,B){super();this.operation=a;this.Fei=c;this.original=h;this.clone=v;this.yr=B}}Object(w.a)(Fw,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);class dk{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie){this.hU=this.Rr=this.Na=null;this.rte=!1;this.C6=this.Hua=null;this.hPb=X;this.uj=ma;this.Og=a;this.MCe=c;this.Do=h;this.Vd=v;this.Un=B;this.qa=Pa;this.Fb=Tb;this.tjd=mb.create(2097162);this.ZIf(this.tjd);this.jhe=mb.create(2097162);this.ZIf(this.jhe);
this.GFe=mb.create(2097162);this.ZIf(this.GFe);this.Whd=this.tjd;this.kW=rc;this.g_=Tc;this.Bb=vd;this.$qc=ee;this.Ttj=ee.substr(0,3);this.A2=Ie}get paragraphEditor(){return dk.kh||(dk.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}get Ua(){return this.Na||(this.Na=xa.a.instance.ra("Box4.IFeatureHelper"))}get Bt(){return this.Rr?this.Rr.Bt:0}get Gtb(){return this.Rr.Fa.Gtb}get aya(){return this.Rr.Fa.aya}get Qea(){return this.Whd}get bOi(){return this.GFe}get hSe(){return this.Rr.VG&&!this.rte}gEi(){this.rte=
!0}get iei(){return!this.Rr.VG}get Wla(){return It.a.instance}get LPl(){return this.qa.$("InternalPasteTableWithReplacingCellIsEnabled")}ZIf(a){var c=new LA.a(-1);this.hPb.Pk.OGa(c);const h=new Kd.GraphIterator;h.set(c);l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordNoRenderGraphTransactionInternalClipboardSettings");c=3;this.qa&&this.qa.$("NoRenderGraphTransactionInternalClipboardIsEnabled")&&(c=0);c=this.Fb.Ob(c);c.Lr(h);h.Je(a,80);c.dispose()}grd(a,c=null){a=a.Ma;this.Rr=
a.Ca.clone();this.rte=!1;a=Kd.GraphIterator.va(a.TY);const h=Kd.GraphIterator.va(this.Qea),v=this.Fb.Ob(3,zb.a.internalCopy);v.Lr(h);a.Za(82);do a.currentNode.bJb(null);while(a.Fh(82));a=new Cp.a(c,Object(m.a)(this,this.A6j,"clearInternalClipboard"),new jh(a,h,this.Rr,v));a.jk("InternalCopy");a.fg=!c||c.fg;a.run()}A6j(a,c){bh.a.mark(5566);c=c.target;if(c.Xc())return c.xf(),!0;a.wh(Object(m.a)(this,this.dBc,"executeCopy"));return!0}dBc(a,c){c=new bz.a(c,null);c=new Cp.a(a,Object(m.a)(this,this.Xxc,
"coreCopySetup"),c);c.jk("ExecuteCoreCopyToInternalClipboard");c.run();a.wh(Object(m.a)(this,this.MGn,"trimNewText"));return!0}Xxc(a,c){if(!c.source.Xc())return c.Dh&&(c.Dh.epd=null),r.ULS.shipAssertTag(6305560,307,!1),!1;a.wh(Object(m.a)(this,this.D7g,"coreCopyIteration"));return!0}D7g(a,c){const h=c.insertAfter,v=c.source,B=c.target,X=v.currentNode;var ma=this.iei;if(!X.Bja)return a.wh(Object(m.a)(this,this.Wxc,"coreCopyIncrement")),!0;c.Dh.uGb&&(c.uGb=!0);if(!this.m4j(c))return c.efa.Cza.c++,a.wh(Object(m.a)(this,
this.Wxc,"coreCopyIncrement")),!0;if(!c.uGb&&(X.lYb()&&c.efa.Cza.c++,X.lYb()||ma&&!X.Wcb(this.Bt)))return a.wh(Object(m.a)(this,this.Wxc,"coreCopyIncrement")),!0;if(!c.uGb&&ma&&!X.ux)return v.fB()&&(c.G7d=!0,c=new Cp.a(a,Object(m.a)(this,this.Xxc,"coreCopySetup"),new bz.a(c,h)),c.jk("RecursiveCoreCopyToInternalClipboard"),c.run()),a.wh(Object(m.a)(this,this.Wxc,"coreCopyIncrement")),!0;ma=B.currentNode.Eh().Lc;ma=Nr.a(X,ma,!0);ma.aif=!0;this.Wla.tXd(c.efa.fyb,ma);B.TG(ma,h,18===v.parentNode.type?
1:v.role);B.qh(ma);c.insertAfter=ma;sd.ParagraphReader.tb(ma)&&(this.OFm(a,Object(m.a)(this,this.Xxc,"coreCopySetup"),X,ma,c),this.NFm(a,X,ma));this.uih(X,ma);v.fB()&&(r.ULS.shipAssertTag(6305562,307,!c.G7d),c=new Cp.a(a,Object(m.a)(this,this.Xxc,"coreCopySetup"),new bz.a(c,null)),c.jk("RecursiveCoreCopyToInternalClipboard"),c.run());a.wh(Object(m.a)(this,this.Wek,"coreCopyIterationPostProcessing"));return!0}Wek(a,c){var h=c.source;const v=c.target;var B=v.currentNode,X=h.currentNode;sd.ParagraphReader.eg(v)&&
(c.tCf[X.id.toString()]=B);if(sd.ParagraphReader.tb(B)){if(0<sd.ParagraphReader.JDh(X))if(0<this.uj.sI(X).jt)X.setValue(Yb.a.OLa,0);else{const ma=this.uj.n0(X).jt;this.paragraphEditor.Zn.Y9(B,ma)}if(!this.BIc&&this.A2.Rgi){h.ob();if(!Wf.TableReader.Jv(v)&&h.Xza&&!this.aya)for(const ma of this.A2.uCf)B.removeProperty(ma);h.qh(X)}}if(kg.a.instance.J(6)&&sd.ParagraphReader.tb(B)){for(X=0;X<B.wordRunProperties.length;X++)B.wordRunProperties.yp.Z(X,kq.CharacterPropertiesEditor.ZO),B.wordRunProperties.Jr.Z(X,
kq.CharacterPropertiesEditor.bS);r.ULS.shipAssertTag(6305564,307,kg.a.instance.J(4));r.ULS.shipAssertTag(6305565,307,!!Eb.App.lc);(this.Bb.Bf||kg.a.instance.J(3)&&Eb.App.wu.scc)&&B.setValue(Yb.a.aAb,!0);B.Ig(Yb.a.Zvb,Yb.a.Xfi,Yb.a.mCf);kg.a.instance.J(3)&&sd.ParagraphReader.tb(B)&&B.Ig(Yb.a.tKa)}this.iei&&(this.tih(v),Wf.TableReader.isTable(v)&&(B=this.Rr.aO(),B.moveNext(),(B=Tf.TableCellReader.rya(h,B.current.node))||(B=new az.a(0,0)),h=new vn(B,v,Wf.TableReader.Fia(h),Wf.TableReader.D$e(h)),this.MCe.value.q2m(h)));
Ta.OutlineElementReader.Gg(v)&&!v.pp(2)&&(this.Vd.eM(v),v.ob());v.ob();c.Dh&&(c.Dh.epd=c.insertAfter);a.wh(Object(m.a)(this,this.Wxc,"coreCopyIncrement"));return!0}Wxc(a,c){c.G7d&&(c.insertAfter=c.epd,c.G7d=!1);if(!c.source.Ns()){c.Dh&&(c.Dh.epd=c.insertAfter);const h=c.source;11!==h.Md||h.eEc(-1)||this.pGm(a,h.currentNode,c.target.currentNode,c);return!1}a.wh(Object(m.a)(this,this.D7g,"coreCopyIteration"));return!0}m4j(a){const c=a.source;if(Ta.OutlineElementReader.Gg(c)&&c.uJa(12)){const h=c.Xc();
if(sd.ParagraphReader.tb(h)&&h.ia(Yb.a.ZK,null))return c.ob(),a.uGb=!1;c.ob()}else if(sd.ParagraphReader.tb(c.rm)&&c.rm.ia(Yb.a.ZK,null))return!1;return!0}NFm(a,c,h){c=ac.e(c);h=ac.e(h);for(let v=0;v<c.length;v++)c[v].Kxf(h[v],a,Object(m.a)(this,this.Xxc,"coreCopySetup"))}MGn(a,c){if(c.IHa>=c.d$b.length)return dk.ma.raiseEvent("AfterTrimCompleteOnCopy",new Sz(c.yr)),a.wh(Object(m.a)(this,this.Vek,"copyTeardown")),!0;a=c.d$b[c.IHa];var h=a.node,v=a.cpBegin;let B=a.cpEnd;if(!Gc.SelectionEditor.Rs(a))if(!c.IHa&&
Gc.SelectionEditor.mj(a))B=v=sd.ParagraphReader.textLength(h);else if(sd.ParagraphReader.Wk(a))v=0,B=sd.ParagraphReader.textLength(h);else if(Gc.SelectionEditor.K8(a)){r.ULS.shipAssertTag(6305568,307,!c.IHa);var X=Kd.GraphIterator.va(h);v=X.La(12);r.ULS.shipAssertTag(6305569,307,v);h=X.origin;B=v=sd.ParagraphReader.textLength(h)}else{if(zj.OutlineReader.yJd(a))for(a=hq.a.zn(a.node);a.moveNext();)X=a.currentNode,sd.ParagraphReader.tb(X)&&Array.add(c.d$b,Oe.a.createTextRange(X,0,sd.ParagraphReader.textLength(X)));
c.IHa++;return!0}X=c.tCf[h.id.toString()];r.ULS.shipAssertTag(6305570,307,!!X);if(!X)return r.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:c.IHa,["SelectedContextsLength"]:c.d$b.length,["SelectedNodeType"]:h.type,["ContextId"]:a.contextId}),c.IHa++,!0;h=ac.e(X);let ma,Pa=!1;for(ma=h.length-1;0<=ma;ma--)if(!h[ma].Nwa)if(4===h[ma].nh)h[ma].Xa.blob=null,h[ma].Xa.blob=new Ps.a(h[ma].Xa),c.efa.Cza.e++;else{h[ma].Xa.blob=null;if(kg.a.instance.J(6)&&-1!==h[ma].zd){var mb=
h[ma].Xa.formatting,Tb=void 0,rc=void 0;mb&&-1===mb.zd?(rc=h[ma].zd+1,Tb=h[ma].U0-1,mb.zd=h[ma].zd):(Tb=h[ma].U0,rc=h[ma].zd);for(mb=0;mb<Tb;mb++)X.wordRunProperties.removeAt(rc,16);0<Tb&&(Pa=!0)}Tb="";Bi.f(h[ma])?(Tb=" ",c.efa.Cza.f++):Bi.g(h[ma])&&(rc=Bi.b(h[ma]))&&(Tb=Bi.a(rc),c.efa.Cza.g++);rc=h[ma].Xa.cp;rc>=v&&rc<B&&(dk.characterPropertiesEditor.replaceTextRange(Oe.a.createTextRange(X,rc,rc+1),Tb),B=B-1+Tb.length,c.efa.Cza.i++)}Pa&&X.rl();this.XWm(X);dk.ma.raiseEvent("BeforeTrimOnCopy",new Tz(X,
v,B,c.yr));h=sd.ParagraphReader.textLength(X);B<h&&dk.characterPropertiesEditor.replaceTextRange(Oe.a.createTextRange(X,B,h),"");0<v&&dk.characterPropertiesEditor.replaceTextRange(Oe.a.createTextRange(X,0,v),"");this.qol(X,c.efa.Cza);!sd.ParagraphReader.textLength(X)&&c.IHa===c.d$b.length-1&&Gc.SelectionEditor.Rs(a)&&(a=Kd.GraphIterator.va(X),a.La(25)&&(ie.OutlineElementNavigator.Wc(a),this.Vd.FUa(a),c.IHa&&(this.Rr.Fa.aya=!0)));this.Wla.ZRc(c.efa.JTd,c.efa.otb,c.efa.r8a,X);c.IHa++;return!0}XWm(a){const c=
a.la;if(kg.a.instance.J(6)&&c){var h=new Ua.a,v=new Ua.a;for(let B=0;B<c.length;B++){const X=c.J(B);X.Zi&&h.add(X);if(X.Wa){for(let ma=0;ma<X.Wa.length;ma++)v.add(X.Wa.J(ma).zd);X.Wa=null}}a.Rka(!0,v);for(const B of h)B.Zi=null}}Vek(a,c){this.Qea.bJb(null);c.uw.dispose();bh.a.mark(5567);this.xhm();this.hU=c.efa;this.w0h("Copy");this.RHl&&r.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get RHl(){return!Kd.GraphIterator.va(this.Qea).Xc()}aXi(){this.Whd=this.GFe}$Wi(){this.Whd=this.tjd}FSn(){this.Whd=
this.jhe}get sUl(){return this.Qea===this.tjd}get WJl(){return this.Qea===this.jhe}s2g(){const a=Kd.GraphIterator.va(this.Qea);for(;a.Xc();)a.xf()}w0h(a){const c=this.hU.Cza.b;a+="-"+c;this.hU.Cza.b=a;this.hU.fyb.b=a;this.hU.JTd.b=a;this.hU.otb.b=a;this.hU.r8a.b=a;this.Wla.F4l(this.hU.Cza);this.Wla.Npf(this.hU.fyb);this.Wla.w1h(this.hU.JTd);this.Wla.Bpf(this.hU.otb);this.Wla.zpf(this.hU.r8a);this.hU.Cza.b=c;this.hU.fyb.b=c;this.hU.JTd.b=c;this.hU.otb.b=c;this.hU.r8a.b=c}Mgi(a,c,h,v,B=null,X=null){this.w0h("Paste");
c=Kd.GraphIterator.va(c);const ma=Kd.GraphIterator.va(this.Qea);var Pa=null;B&&(Pa=new hx.a(zj.OutlineReader.zbh,zj.OutlineReader.eqk),Pa=B.equals(new hx.a(-1,-1))?new hx.a(0,0):B.K3d(Pa));if(this.tOh())if(ma.Xc(),dd.ImageReader.ix(ma.currentNode))B=ma.currentNode,ma.ob(),ma.TG(this.Vd.gub(),null,1),ma.Xc(),ma.TG(B,null,2),ma.ob(),ma.qh(B),ma.xf(),this.gEi();else if(Ou.isFloatingEmbeddedFileNode(ma.currentNode)){B=ma.currentNode;ma.ob();ma.TG(this.Vd.gub(),null,1);ma.Xc();var mb=this.Vd.eM(ma);mb=
Oe.a.Sb(mb,0);dk.characterPropertiesEditor.replaceTextRange(mb,"<<"+Ou.getEmbeddedFileName(B)+">>");ma.ob();ma.ob();ma.qh(B);ma.xf();this.gEi()}this.kW&&this.kW.Tkf(h)||!this.LPl||!this.CXh(ma,c)?(bh.a.mark(5564),ma.currentNode.bJb(null),a={},a[dk.Jef]=v,ab.ListReader.F0(h)&&(a[ey.a.zOh]=!0),h=new cz.a(ma,c,h,Pa,a),v=new Cp.a(X,Object(m.a)(this,this.Zxc,"corePasteSetup"),h),v.jk("ExecuteCorePasteFromInternalClipboard"),v.fg=!X||X.fg,this.BFm(h),v.run()):(ma.currentNode.bJb(null),r.ULS.sendTraceTag(7869376,
307,50,"Begin internal paste table in table"),this.Y_m(X,ma,c,Pa,a),r.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended."))}eXh(a){if(a&&a.Nc){const c=Kd.GraphIterator.va(this.Qea);return this.CXh(c,a)}return!1}CXh(a,c){if(Tf.TableCellReader.zKa(c)&&1===a.ro()){a.Za(1);if(Ta.OutlineElementReader.Gg(a)){ie.OutlineElementNavigator.Fd(a);if(Wf.TableReader.isTable(a)){Wf.TableReader.fz(a.currentNode)&&r.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");
if(c.La(14)&&!Wf.TableReader.fz(Fe.getContainingTable(c))){if(r.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!this.u4)return!0}else if(r.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),this.BIc&&!this.u4)return!0;if(this.u4)return!0}ie.OutlineElementNavigator.Wc(a)}a.ob()}return!1}Y_m(a,c,h,v,B){let X,ma;let Pa;h.La(14);X=$m.a.ir(h);ma=Or.a(h);h.mc(14);var mb=Wf.TableReader.kf(h.currentNode);Pa=Wf.TableReader.Eg(h.currentNode);const Tb=Wf.TableReader.kf(c.currentNode),
rc=Wf.TableReader.Eg(c.currentNode);r.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};  and target insert index: {5},{6}",mb,Pa,Tb,rc,X,ma);if(this.u4&&il.TableBorderSelectionCache.oFc())this.Bjn(),mb=Math.min(this.K4d+1,mb),Pa=Math.min(this.cXf+1,Pa),this.cXf-this.pBn==Pa-1&&(this.tNi==this.K4d?ma=0:this.K4d-this.tNi==mb-1&&(h.Xc(),X=$m.a.ir(h),ma=Or.a(h)));else{this.Hua=Rr.a.f_b;var Tc=X+Tb-mb;0<Tc&&(Fe.moveToLastRow(h),r.ULS.sendTraceTag(8716374,
307,50,"Begin insert rows: "+Tc),this.MCe.value.insertRows(h,!1,Tc,this.Hua),r.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),h.mc(14));Tc=ma+rc-Pa;if(0<Tc){r.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+Tc);try{this.MCe.value.insertColumns(h,Pa,!1,Tc,this.Hua)}catch(vd){throw r.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",vd.toString()),vd;}r.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}}mb=this.vUk(mb,Pa,Tb,rc,X,ma);r.ULS.sendTraceTag(8716378,
307,50,"Begin paste cell contents");a=new Cp.a(a,Object(m.a)(this,this.Rzm,"pasteTableOperationRun"),new Ew(null,c,h,v,X,ma,mb,null,B));a.jk("ExecuteCorePasteTableInTable");a.fg=!1;a.run()}Rzm(a,c){if(c.Dbc){if(c.Dbc.inProgress)return!0;Tf.TableCellReader.isTableCell(c.source)||c.source.mc(16);if(this.lfm(c))return!1}else Wf.TableReader.isTable(c.target)||c.target.mc(14),Wf.TableReader.isTable(c.source)||c.source.mc(14),Fe.moveToCell(c.target,c.rowIndex,c.Km),Fe.moveToCell(c.source,0,0);if(Tf.TableCellReader.lf(c.source)||
Tf.TableCellReader.lf(c.target))return!0;this.Hzm(c,a);return!0}xhm(){if(this.BIc){for(var a=Kd.GraphIterator.va(this.Qea),c=a.currentNode;14!==a.Md;)if(c=a.Xc(),!c){r.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.n8h(c)}}Chm(a){this.BIc&&this.n8h(a)}PDn(a){const c=Kd.GraphIterator.va(a);this.Do.ecb(c,null,!0);a.lf=!1;a.rowSpan=1;a.colSpan=1}n8h(a){if(a&&14===a.type){r.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");
var c={},h=Wf.TableReader.kf(a),v=Wf.TableReader.Eg(a),B=Kd.GraphIterator.va(a);Fe.forEachCellInTable(B,(X,ma,Pa)=>{const mb={};X=X.currentNode;if(16===X.type)if(X.lf)dk.b5g(ma,Pa)in c||(this.PDn(X),mb.IsGhostCell="->false");else{dk.nQm(a,X,ma,Pa,h,(rc,Tc,vd)=>{mb.rowSpan=String.format("{0}:{1}->{2}",rc,Tc,vd)});dk.mQm(a,X,Pa,ma,v,(rc,Tc,vd)=>{mb.colSpan=String.format("{0}:{1}->{2}",rc,Tc,vd)});const Tb=String.format("{0},{1}-{2},{3}",ma,Pa,ma+X.rowSpan,Pa+X.colSpan);for(let rc=0;rc<X.rowSpan;rc++)for(let Tc=
0;Tc<X.colSpan;Tc++)if(rc||Tc)c[dk.b5g(ma+rc,Pa+Tc)]=Tb}if(0<qt.a(mb).length){if(void 0===mb.IsGhostCell||null===mb.IsGhostCell){if(void 0===mb.rowSpan||null===mb.rowSpan)mb.rowSpan=X.rowSpan;if(void 0===mb.colSpan||null===mb.colSpan)mb.colSpan=X.colSpan}r.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",ma,Pa,mb)}return!0});dk.Hyk(c)}}qol(a,c){if(a&&sd.ParagraphReader.tb(a)){var h=0,v=Kd.GraphIterator.va(a);for(v.Za(6);!v.jq;){var B=v.currentNode;v.Fh(6);dd.ImageReader.ix(B)?dd.ImageReader.wlf(B)?
Kd.GraphIterator.va(B).uJa(59)?r.ULS.sendTraceTag(590455048,307,50,"HandleAnchoredObjectsForInternalCopy: Not converting anchored image to inline."):(this.paragraphEditor.FSe(B,Oe.a.Sb(a,h)),c.d++,h++):(B=Kd.GraphIterator.va(B),B.La(12),B.xf(),c.h++):r.ULS.shipAssertTag(6305571,307,!1)}}}get BIc(){return!!this.qa&&this.qa.$("ComplexTableCellPasteWithFormattingIsEnabled")}vUk(a,c,h,v,B,X){const ma=[];let Pa,mb,Tb,rc;this.u4&&il.TableBorderSelectionCache.oFc()?(Pa=Math.min(a,B+h),mb=Math.min(c,X+v),
rc=B):(rc=0,Pa=Math.max(B+h,a));for(;rc<Pa;rc++)for(this.u4&&il.TableBorderSelectionCache.oFc()?Tb=X:(Tb=0,mb=X+v,rc<B?Tb=c:rc>=B&&rc<Math.min(B+h,a)?Tb=X:rc>=B+h&&rc<a?Tb=c:mb=Math.max(X+v,c));Tb<mb;Tb++)ma.push(Array(2)),ma[ma.length-1][0]=rc,ma[ma.length-1][1]=Tb;return ma}Zxc(a,c){if(!c.source.Xc())return a.wh(Object(m.a)(this,this.Dfb,"pasteTeardown")),!0;a.wh(Object(m.a)(this,this.F7g,"corePasteIteration"));return!0}i0m(a,c){if(this.BIc)if(!c||!a)r.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",
{["source"]:a,["table"]:c});else if(16===c.currentNode.type&&16===a.parentNode.type){c=c.currentNode;a=a.parentNode;var h={};c.lf!==a.lf&&(c.lf=a.lf,h.IsGhostCell=c.lf);c.J0!==a.J0&&(c.J0=a.J0,h.IsSkippedCell=c.J0);c.zhb!==a.zhb&&(c.zhb=a.zhb,h.ShouldRenderCell=c.zhb);c.colSpan!==a.colSpan&&(h.ColSpan=String.format("{0}<={1}.",c.colSpan,a.colSpan),c.colSpan=a.colSpan);c.rowSpan!==a.rowSpan&&(h.RowSpan=String.format("{0}<={1}.",c.rowSpan,a.rowSpan),c.rowSpan=a.rowSpan);qt.a(h)}}F7g(a,c){const h=c.source,
v=c.target,B=h.currentNode;if(!B.Bja||!B.jHa||this.ipn(h,v))return a.wh(Object(m.a)(this,this.Yxc,"corePasteIncrement")),!0;if(kg.a.instance.J(3)&&Ta.OutlineElementReader.Gg(h)){if(!ie.OutlineElementNavigator.Fd(h).jHa)return ie.OutlineElementNavigator.Wc(h),a.wh(Object(m.a)(this,this.Yxc,"corePasteIncrement")),!0;ie.OutlineElementNavigator.Wc(h)}r.ULS.shipAssertTag(6305608,307,!B.lYb());var X=v.currentNode.Eh().Lc;X=Nr.a(B,X,!0);X.wLa();X.iVh=!0;this.i0m(h,v);v.TG(X,c.insertAfter,h.role);v.qh(X);
c.insertAfter=X;kg.a.instance.J(4)&&Eb.App.lc.$n&&Eb.App.lc.zp.aF(X);this.uih(B,X);c=new Cp.a(a,Object(m.a)(this,this.Zxc,"corePasteSetup"),new cz.a(h,v,null,c.HBf,c.yr));c.jk("RecursiveCorePasteOperation");c.run();a.wh(Object(m.a)(this,this.Zek,"corePasteIterationPostProcessing"));return!0}ipn(a,c){let h=!1;Ta.OutlineElementReader.Gg(a)&&(h=Ta.OutlineElementReader.WN(a)&&this.ATl(c));return h}ATl(a){if(a)return a=a.Md,36===a||38===a||16===a;throw Error.argument("IsTargetNodeInValidForIFrameContent: target iterator is null for paste.");
}xGm(a,c,h){c=ac.e(c);const v=ac.e(h);for(let B=c.length-1;0<=B;B--){if(!c[B].nac(h)){const X=Oe.a.createTextRange(h,c[B].Xa.cp,c[B].Xa.cp+1);dk.characterPropertiesEditor.replaceTextRange(X,"")}c[B].nOc(v[B],a,Object(m.a)(this,this.Zxc,"corePasteSetup"),this.WJl)}}Zek(a,c){const h=c.target,v=h.currentNode,B=c.source,X=B.currentNode;let ma=-1;c.yr[dk.Jef]&&(ma=c.yr[dk.Jef]);sd.ParagraphReader.tb(v)&&(this.CGm(a,Object(m.a)(this,this.Zxc,"corePasteSetup"),X,v,c),this.xGm(a,X,v));v.r9();c.yr[ey.a.zOh]?
22===v.type&&(Tf.TableCellReader.LX(B)||v.setValue(Yb.a.listID,Number.MAX_VALUE)):this.Un.Nsi(v);if(sd.ParagraphReader.tb(v)&&(c=ac.i(v,5),0<c.length)){for(const Pa of c)!Pa.properties.hasProperty(Yb.a.Gfb)&&Pa.properties.hasProperty(Yb.a.RPc)&&(c=Pa.properties.getValue(Yb.a.RPc),Pa.properties.setValue(Yb.a.Gfb,c)),dd.ImageReader.U1b()?dd.ImageReader.KAb(Pa.properties)&&this.Og.ONf(Pa.properties,ma):dd.ImageReader.py(Pa.properties)||this.Og.ONf(Pa.properties,ma);v.Eh().contentReplicator.forceOutbound(null,
null,null)}this.tih(h);this.JRn(X,v);Wf.TableReader.gV(v)&&r.ULS.sendTraceTag(524919814,3022,50,"TablePasted");this.u4&&Tf.TableCellReader.zKa(h)&&ji.nxi(v);h.ob();a.wh(Object(m.a)(this,this.Yxc,"corePasteIncrement"));return!0}JRn(a,c){if(kg.a.instance.J(3)&&Wf.TableReader.gV(a)){let h=0;const v=Wf.TableReader.kf(a);for(const B of Wf.TableReader.Xy(a,0,v-1))B.tE&&h++;a=this.Fb.Ob(4);a.Oa(c);c.properties.setValue(Ed.a.hta,v-h);a.dispose()}}Yxc(a,c){if(!c.source.Ns())return a.wh(Object(m.a)(this,this.Dfb,
"pasteTeardown")),!0;a.wh(Object(m.a)(this,this.F7g,"corePasteIteration"));return!0}Dfb(){bh.a.mark(5565);return!1}get u4(){null==this.C6&&(l.AFrameworkApplication.Mg("he991617;3eed2178"),this.C6=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TableCCPNewExperienceIsEnabled",!1):!1);return this.C6}OPd(){return!Kd.GraphIterator.va(this.Qea).Xc()}tOh(){return this.hSe?1===Kd.GraphIterator.va(this.Qea).ro():!1}Tsh(a){try{return this.YWk(a)}catch(c){return r.ULS.sendTraceTag(23643968,
307,10,"GetCopySourceFromDOMTree failed with exception:{0}",c.message),0}}YWk(a){let c=0;if(a&&(c=this.XWk(a),!c&&a.childNodes))for(let h=0;h<a.childNodes.length&&!(c=this.Tsh(a.childNodes[h]));h++);return c}XWk(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const c of a)if(c.startsWith(this.Ttj))return c.startsWith(this.$qc)?this.Bt&&c===this.$qc+this.Bt?3:2:1}return 0}OFm(a,c,h,v,B){B.yr||(B.yr={});dk.ma.raiseEvent("OnParagraphCopy",new Fw(a,c,h,v,B.yr))}pGm(a,
c,h,v){v.yr||(v.yr={});dk.ma.raiseEvent("OnCopyComplete",new Fw(a,null,c,h,v.yr))}BFm(a){a.yr||(a.yr={});dk.ma.raiseEvent("BeforePaste",new Mt(a.yr))}CGm(a,c,h,v,B){dk.ma.raiseEvent("OnParagraphPaste",new Fw(a,c,h,v,B.yr))}tih(a){Tf.TableCellReader.isTableCell(a)&&(a.Za(1)||this.Do.t_(a,!0),a.ob())}uih(a,c){this.g_.tra(c)&&(c.width=a.width)}static EIe(a){dk.ma.addHandler("OnParagraphCopy",a)}static tld(a){dk.ma.addHandler("OnParagraphPaste",a)}static sYm(a){dk.ma.removeHandler("OnParagraphPaste",
a)}static ZHj(a){dk.ma.addHandler("OnCopyComplete",a)}static hHj(a){dk.ma.addHandler("BeforePaste",a)}static QXm(a){dk.ma.removeHandler("BeforePaste",a)}static iHj(a){dk.ma.addHandler("BeforeTrimOnCopy",a)}static cHj(a){dk.ma.addHandler("AfterTrimCompleteOnCopy",a)}static get characterPropertiesEditor(){return dk.Tb||(dk.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get cJ(){return KA.a.instance}static get Kd(){return vg.PageReader.instance}static Hyk(a){const c={};for(const h of qt.a(a)){const v=
a[h];c[v]=v in c?String.format("{0}|{1}",c[v],h):h}1<=qt.a(c).length&&r.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",c)}static mQm(a,c,h,v,B,X){c.colSpan>B-h&&(X&&X("A",c.colSpan,B-h),c.colSpan=B-h);a=dk.ctn(a,c,v,h);c.colSpan!==a&&(X&&X("B",c.colSpan,a),c.colSpan=a)}static nQm(a,c,h,v,B,X){c.rowSpan>B-h&&(X&&X("A",c.rowSpan,B-h),c.rowSpan=B-h);a=dk.dtn(a,c,h,v);c.rowSpan!==a&&(X&&X("B",c.rowSpan,a),c.rowSpan=a)}static ctn(a,c,h,v){return dk.LIi(a,c.colSpan,(B,X)=>{Fe.moveToCell(B,
h,v+X)})}static dtn(a,c,h,v){return dk.LIi(a,c.rowSpan,(B,X)=>{Fe.moveToCell(B,h+X,v)})}static LIi(a,c,h){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!h)throw Error.argumentNull("MoveToCellAction");for(let B=1;B<c;B++){var v=Kd.GraphIterator.va(a);h(v,B);v=v.currentNode;if(!v||16!==v.type||!v.lf)return B}return c}static b5g(a,c){return a+","+c}Hzm(a,c){for(;a.target.Xc();)a.target.xf();a.Dbc=new Cp.a(c,a.Qgi?a.Qgi:Object(m.a)(this,this.Zxc,"corePasteSetup"),new cz.a(a.source,
a.target,null,a.HBf));a.Dbc.jk("ExecuteCorePasteCellContentInCell");a.Dbc.fg=!1;a.Dbc.run()}lfm(a){let c=!1;if(this.u4&&il.TableBorderSelectionCache.oFc()){const h=Or.a(a.target),v=$m.a.ir(a.target),B=Math.min(this.K4d,a.bwc[a.bwc.length-1][0]),X=Math.min(this.cXf,a.bwc[a.bwc.length-1][1]);Tf.TableCellReader.jKa(a.target)||Tf.TableCellReader.jKa(a.source)||v==B&&h==X?c=!0:(Tf.TableCellReader.isTableCell(a.target)||a.target.mc(16),Tf.TableCellReader.U8(a.source)?(Tf.TableCellReader.jKa(a.target)||
(Fe.moveToNextRow(a.target),Fe.moveToColumnByIndex(a.target,a.Km),r.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")),Fe.moveToNextOrPreviousCell(a.source,!1,!1)):Tf.TableCellReader.U8(a.target)||h==X?(Fe.moveToNextRow(a.source),Fe.moveToColumnByIndex(a.source,0),r.ULS.sendTraceTag(537519906,307,50,"Move to next row to replace cell contents"),Fe.moveToNextRow(a.target),Fe.moveToColumnByIndex(a.target,a.Km),r.ULS.sendTraceTag(537519907,307,50,"Move to next row to replace cell contents")):
(Fe.moveToNextOrPreviousCell(a.target,!1,!1),Fe.moveToNextOrPreviousCell(a.source,!1,!1)))}else Tf.TableCellReader.jKa(a.source)?c=!0:(Tf.TableCellReader.isTableCell(a.target)||a.target.mc(16),Tf.TableCellReader.U8(a.source)?(Fe.moveToNextRow(a.target),Fe.moveToColumnByIndex(a.target,a.Km),r.ULS.sendTraceTag(537716887,307,50,"Move to next row to replace cell contents")):Fe.moveToNextOrPreviousCell(a.target,!1,!1),Fe.moveToNextOrPreviousCell(a.source,!1,!1));c&&(this.kW&&this.kW.zGm(a.target,a.bwc),
Wf.TableReader.isTable(a.target)||a.target.mc(14),this.Chm(a.target.currentNode),r.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"));return c}Bjn(){this.K4d=il.TableBorderSelectionCache.i5.bottomMostRowSelected;this.cXf=il.TableBorderSelectionCache.i5.rightMostColumnSelected;this.pBn=il.TableBorderSelectionCache.i5.leftMostColumnSelected;this.tNi=il.TableBorderSelectionCache.i5.topMostRowSelected}}dk.ma=new Rd.a;dk.Tb=null;dk.kh=null;dk.Jef="PasteConstrainingWidth";Object(w.a)(dk,
"InternalClipboard",null,[]);var nv=b(595);class Gw extends an{constructor(a,c,h,v,B,X,ma,Pa){super(a,c,h,B,X,Pa);this.Dx=v;this.hG=ma}get Gj(){return this.hG.value}get OPd(){return this.Dx.OPd()}get dhi(){const a=this.Dx;return a.hSe&&!a.tOh()}xjh(a,c){r.ULS.shipAssertTag(6305616,307,zj.OutlineReader.hv(a));const h=nv.a(a.currentNode);if(zj.OutlineReader.isEmpty(a)){var v=Oe.a.create(a.currentNode);a.Kr(8);l.AFrameworkApplication.pa.Le(v,zb.a.lF,2,!0,null,null)}else a.Kr(8);(v=a.qC(1))&&a.ob();this.Dx.Mgi(this.Dh.kd,
a.currentNode,v,-1,h,c)}wjh(a){const c=new Kd.GraphIterator;this.VLa.restore(c);r.ULS.shipAssertTag(6305618,307,Ta.OutlineElementReader.Gg(c));this.Dh.cP&&this.Dh.cP.UTb("internal");let h=-1;if(this.UFi&&Object(Ub.a)(95,this.Dh.Ac))h=this.Dh.Ac.ia(ii.a.Yba,-1);else{const v=this.kYk(c.currentNode);h=v?v.clientWidth:h}this.Dx.Mgi(this.Dh.kd,c.parentNode,c.currentNode,h,null,a);this.cUh&&(this.VLa.restore(c),Ta.OutlineElementReader.Gg(c)&&this.Dx.eXh(c)&&(a=ie.OutlineElementNavigator.Fd(c)))&&(this.Dh.dVa=
ne.SelectionFactory.vd(a,0))}kYk(a){return a?(a=a?a.Sd(this.Gj.gb):null)?a.htmlElement:null:null}OGi(){const a=new Kd.GraphIterator;this.VLa.restore(a);return this.Dx.eXh(a)}get hGi(){return ab.ListReader.mq}get fWc(){return!this.Dx.aya&&!this.Dx.hSe}}Object(w.a)(Gw,"InternalPasteExecutionManager",an,[]);class Uz{constructor(a,c,h,v){this.Dx=a;this.kW=c;this.hG=h;this.A2=v}create(a,c,h){return new Gw(a,c,h,this.Dx,this.kW,Eb.App.oa.Da,this.hG,this.A2)}}Object(w.a)(Uz,"Factory",null,[694]);var Hw;
(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(Hw||(Hw={}));Object(w.b)("CopySource",Hw);class Cq{constructor(a,c,h){this.Dx=a;this.Ang=c;this.Bdj=h}Gzm(a,c,h){r.ULS.shipAssertTag(6305620,307,!!a);r.ULS.shipAssertTag(6305621,307,Gc.SelectionEditor.ke(c));r.ULS.shipAssertTag(6305622,307,!!h);r.ULS.shipAssertTag(6305623,307,Object(Ub.a)(Jt.a,h.Jda));
const v=h.Jda;v.mWb=this.Dx.Tsh(a);this.E4l(a,v);const B=this.eNl(v);var X=new gf.GraphTransaction(7,zb.a.paste);X.Oa(c.node);c.node.sF().UD.D7(8);B?(r.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",v.Qy,v.browserName),a=this.Ang.create(c,v,X)):(r.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",v.Qy,v.mWb,v.browserName),Cq.x4l(a),a=this.Bdj.create(a,c,v,X));h=new Cp.a(h,Object(m.a)(a,a.Sgi,"pasteSetup"),null);h.jk("Paste");h.run()}eNl(a){return!this.NPl(a)&&
3===a.mWb}NPl(a){return 1===(a.Qy&8192?1:0)}AOh(a,c){r.ULS.shipAssertTag(6305624,307,Gc.SelectionEditor.ke(a));r.ULS.shipAssertTag(6305625,307,!!c);r.ULS.shipAssertTag(6305626,307,Object(Ub.a)(Jt.a,c.Jda));const h=new gf.GraphTransaction(7,zb.a.dHd);h.Oa(a.node);a=this.Ang.create(a,c.Jda,h);c=new Cp.a(c,Object(m.a)(a,a.Sgi,"pasteSetup"),null);c.jk("InternalPasteAtIp");c.run()}E4l(a,c){if(a){let h=!1,v=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?v=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&
(h=!0);(h||v)&&r.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",Hw[c.mWb],h,v)}}static x4l(a){a&&Cq.Xzj.test(a.innerText)&&r.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl")}}Cq.Xzj=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(w.a)(Cq,"PasteCoordinator",null,[]);class ov{constructor(a,c,h,v,B){this.$pa=a;this.xdb=
c;this.Uzm=h;this.Tzm=v;this.pId=B}}Object(w.a)(ov,"PastedContentsPostProcessorParams",null,[]);class Nt{iBl(a,c,h,v,B,X){a=this.H0k(a,c,B);h=this.$4k(h);if(!a||!h)return null;v=this.Hal(a,v,B);B=this.Gal(h);return new ov(a,h,v,B,X)}H0k(a,c,h){a=h?a:c;if(!Ta.OutlineElementReader.Gg(a))return null;c=new Yk.a;c.Wb(a);return c}$4k(a){if(!Ta.OutlineElementReader.Gg(a))return null;const c=new Yk.a;c.Wb(a);ie.OutlineElementNavigator.J4(c,!1,!1);return c}Hal(a,c,h){ie.OutlineElementNavigator.Fd(a);let v=
-1;sd.ParagraphReader.eg(a)&&(v=h?c:0);ie.OutlineElementNavigator.Wc(a);return v}Gal(a){ie.OutlineElementNavigator.Fd(a);const c=sd.ParagraphReader.eg(a)?sd.ParagraphReader.textLength(a.currentNode):-1;ie.OutlineElementNavigator.Wc(a);return c}}Object(w.a)(Nt,"PastedContentsPostProcessorHelper",null,[]);var Yp=b(568),Pg=b(959),y=b(957);class U{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){this.mfe=null;this.Wne=!1;this.Pcd=null;this.l$c=this.YEa=!1;this.Kna=a;this.pu=c;this.Rb=h;this.vdd=v;this.gh=B;this.bpb=
X;this.qa=ma;this.jqj=Pa;this.ou=mb;this.B2=Tb;this.own()}own(){this.pu.mQg(Object(m.a)(this,this.ern,"showFloatieHandler"));this.pu.QPg(Object(m.a)(this,this.rLk,"floatieDismissedHandler"))}Uhk(a,c){this.bpb.Tgf();1===this.jqj.gik(c.KPc)?r.ULS.sendTraceTag(575255107,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",c.correlationId):this.showFloatie(a,c)?(this.YEa?this.YEa=!1:this.vUm(),this.lSc(),a="Box4 Paste floatie created."+String.format(" PasteCommand: {0}, CorrelationId: {1}",zb.a.OU(c.iS)||
"Unknown",c.correlationId),r.ULS.sendTraceTag(40379588,307,50,a),this.Ycc()):r.ULS.sendTraceTag(575255108,307,50,"Box4 Paste floatie not created. CorrelationId: {0}",c.correlationId)}Ty(a){this.Wne||!this.Kna.Yqa()&&!this.YEa||(a&&(this.bpb.Tgf(),this.MSi(),r.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this.Pcd)),this.YEa=!a,this.O6d(),this.Kna.Ty())}vUm(){this.l$c||(this.mfe=this.Rb.rc,Ld.a.addHandler(this.mfe.container,"scroll",Object(m.a)(this,
this.CFb,"scrollHandler")),this.gh.r_(Object(m.a)(this,this.gea,"resizeHandler")),this.l$c=!0)}MSi(){this.l$c&&(Ld.a.removeHandler(this.mfe.container,"scroll",Object(m.a)(this,this.CFb,"scrollHandler")),this.gh.eea(Object(m.a)(this,this.gea,"resizeHandler")),this.l$c=!1)}Ycc(){const a=new y.a(0,l.AFrameworkApplication.isRtl);a.location=this.bpb.Eab();this.bpb.rLl(a.location)?this.showFloatie(null,a):this.pu.qBa(new Pg.a(!1))}gea(){this.Ycc()}CFb(){this.Ycc()}rLk(a,c){this.Ty(c.DHk)}ern(a,c){this.Uhk(a,
c)}lSc(){this.vdd.nIj(Object(m.a)(this,this.Hbi,"onOnlyKeyPressed"));this.pu.VPg(Object(m.a)(this.Kna,this.Kna.Pvd,"expandFloatie"));this.pu.hQg(Object(m.a)(this,this.Ugi,"pastedFloatieStatusChange"));this.ou.Yo(Object(m.a)(this,this.Gda,"onParagraphConnect"));this.ou.Mt(Object(m.a)(this,this.YCb,"onParagraphDisconnected"));this.ou.Yl(Object(m.a)(this,this.Z0,"onParagraphPropertyChanged"))}O6d(){this.vdd.pYm(Object(m.a)(this,this.Hbi,"onOnlyKeyPressed"));this.pu.Pri(Object(m.a)(this.Kna,this.Kna.Pvd,
"expandFloatie"));this.pu.Xri(Object(m.a)(this,this.Ugi,"pastedFloatieStatusChange"));this.ou.oE(Object(m.a)(this,this.Gda,"onParagraphConnect"));this.ou.R9(Object(m.a)(this,this.YCb,"onParagraphDisconnected"));this.ou.WI(Object(m.a)(this,this.Z0,"onParagraphPropertyChanged"))}Ugi(a,c){this.Wne=c.WIc;c.iS&&(this.Pcd=c.iS);c.ISf&&this.Kna.Yqa()&&this.Ycc()}Z0(a,c){c.property===Ed.a.lastModifiedTime&&(this.B2.DVe.contains(zb.a.v0f)||this.DHf(c))}YCb(a,c){this.DHf(c)}Gda(a,c){c.nif||this.DHf(c)}DHf(a){a.node.loading||
this.pu.qBa(new Pg.a(!0))}showFloatie(a,c){c||(c=new y.a(0,l.AFrameworkApplication.isRtl));c.location||(c.location=this.bpb.Eab());if(!c.location)return!1;this.YEa&&(this.YEa=!1,this.lSc());this.Kna.showFloatie(a,c);return!0}Hbi(){Yp.a.instance.keyCode===vb.a.Dta&&this.pu.bmi()}}Object(w.a)(U,"PasteFloatieEventManager",null,[]);class da{constructor(a,c){this.Ki=a;this.YF=c}gik(a){return Xj.any(Xj.where(Xj.asEnumerable(da.Tyn),c=>this.YF.hKc(c)))?(a=this.Ki.Afb(a))&&(a=a.innerText)&&0<a.trim().length?
0:1:1}}da.Tyn=[zb.a.reformatPastedContent.toString(),zb.a.cgb.toString()];Object(w.a)(da,"PasteFloatieFeatureSetBuilder",null,[]);class Na{constructor(){this.lsa=null;this.z7b=0}}Object(w.a)(Na,"PasteFloatieAnchorData",null,[]);class jb{constructor(a,c,h,v,B){this.apb=null;this.ya=a;this.FN=c;this.Rb=h;this.nfj=v;this.Kna=B}Tgf(){this.apb=null}Eab(){const a=this.E7e(this.apb)||this.BZg();if(!a){let c="null",h="null";if(this.apb&&this.apb.lsa){if(!this.Rb.rc)return r.ULS.sendTraceTag(51143187,307,
15,"SelectoinView is null when we try to get floatie position"),null;c=Object.getType(this.apb.lsa).getName();const v=this.apb.lsa.kj(this.Rb.rc.gb);v&&(h=Object.getType(v).getName())}r.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",c,h)}return a}rLl(a){if(!a)return!1;const c=this.Kna.Ywb(),h=this.nfj(this.Rb.rc.container);a=new Sys.UI.Bounds(a.x,a.y,c.width,c.height);return a.y>=h.y&&a.y+a.height<=h.y+h.height}BZg(){if(!this.ya||!this.ya.Ca||
!this.ya.Ca.Fa)return r.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var a=this.ya.Ca.Fa.sa,c=!a.cpBegin&&!a.cpEnd;let h=a.node;if(h&&c){do h=this.MAh(h);while(h&&Object(Ub.a)(Fb.AParagraphNode,h)&&!h.characterData.trim().length)}let v="";const B=Object(ha.a)(Fb.AParagraphNode,h);B&&(v=B.characterData.length===a.cpBegin||c?B.characterData.trimEnd():B.characterData.substring(0,a.cpBegin).trimEnd());c=B?v.length:a.cpBegin;a=Object.assign(new Na,
{lsa:Object(ha.a)(150,(B?Object(ha.a)(150,B):Object(ha.a)(150,h))||a.node),z7b:c});return this.E7e(a)}MAh(a){const c=new Kd.GraphIterator;if(!a.anchor)return null;c.set(a);if(!c.nc())return null;c.mc(11);return c.RD()?c.Za(2):null}E7e(a){if(!a||!a.lsa)return null;this.apb=a;const c=this.Rb.rc;if(!c)return r.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;a=this.bwh(a,c);if(!a)return null;l.AFrameworkApplication.isRtl&&this.Kna.Yqa()&&(a.x-=this.Kna.Ywb().width);
return new Sys.UI.Point(a.x+a.width,a.y+a.height)}bwh(a,c){c=Object(ha.a)(169,a.lsa.kj(c.gb));if(!c)return null;let h=null;if(Object(Ub.a)(Fb.AParagraphNode,a.lsa)){const v=Object(ha.a)(102,c);if(!v)return null;try{h=this.FN.XW(a.z7b,v,0<a.z7b,!1,!1,!1),h.height+=jb.uLk}catch(B){r.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",B),h=null}}else Object(Ub.a)(jq.TableNode,a.lsa)&&(h=Object(ha.a)(149,c).waf());h||(h=c.getBounds());return h}}jb.uLk=
2;Object(w.a)(jb,"PasteFloatiePositionProvider",null,[]);class Ib{constructor(a,c){this.Mhc=a;this.u$i=c}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get woh(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get $Ve(){return CommonUIStrings.l_ClipboardCut}get arf(){return CommonUIStrings.l_ClipboardCut_Mac}get WSe(){return CommonUIStrings.l_ClipboardCopy}get $qf(){return CommonUIStrings.l_ClipboardCopy_Mac}get XCf(){return CommonUIStrings.l_ClipboardPaste}get brf(){return CommonUIStrings.l_ClipboardPaste_Mac}get Tda(){return CommonUIStrings.l_ClipboardPasteText}get crf(){return CommonUIStrings.l_ClipboardPasteText_Mac}get lQe(){return this.u$i}get S2g(){return CommonUIStrings.l_ClipboardExtensionLink}get S8a(){return CommonUIStrings.l_ClipboardExtensionSuggestion}Qjh(){r.ULS.sendTraceTag(8716421,
307,50,null);Ve.a.Ql(this.lQe,"_blank",void 0,"ClipboardAccessExtensionLink")}S9(a,c){let h=H.a.qk;l.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(h=H.a.sh||h);return h?String.format(c,"\u2318"):a}dispose(){this.Mhc=null}RHf(a){this.A7g(a)}AYl(a){this.A7g(a)}A7g(a){this.Mhc&&this.Mhc(a)}}Ib.id="CopyPasteShortcutDialog";Ib.PNi="CopyPasteText";Object(w.a)(Ib,"ACopyPasteShortcutDialog",null,[14]);class mc extends Ib{constructor(a,c,h){super(a,c);a=document.createElement("span");a.className=
"WACCopyPasteShortcutDialogTextPanel";c=document.createElement("span");c.id=Ib.PNi;var v=document.createElement("span");v.innerText=this.woh;var B=document.createElement("span");B.className="UIFontBold";B.innerText=this.S9(this.$Ve,this.arf);const X=document.createElement("span");X.className="UIFontBold";X.innerText=this.S9(this.WSe,this.$qf);const ma=document.createElement("span");ma.className="UIFontBold";ma.innerText=this.S9(this.XCf,this.brf);c.appendChild(v);c.appendChild(document.createElement("br"));
c.appendChild(B);c.appendChild(X);c.appendChild(ma);h.$("PasteTextOnlyShortcutDialogIsEnabled")&&(H.a.In||H.a.Qh)&&(h=document.createElement("span"),h.className="UIFontBold",h.innerText=this.S9(this.Tda,this.crf),c.appendChild(h));a.appendChild(c);this.lQe?(r.ULS.sendTraceTag(8716420,307,50,null),h=document.createElement("span"),c=document.createElement("a"),c.href="#",c.innerText=this.S2g,Ld.a.addHandler(c,"click",Object(m.a)(this,this.Qjh,"extensionLinkHandler")),h.appendChild(c),B=this.S8a.indexOf("{0}"),
-1!==B&&(v=this.S8a.substring(0,B),B=this.S8a.substring(B+3,this.S8a.length),v=document.createTextNode(v),B=document.createTextNode(B),h.insertBefore(v,c),h.appendChild(B)),a.appendChild(document.createElement("br")),a.appendChild(h)):r.ULS.sendTraceTag(8716422,307,50,null);h=new oe.StandardDialog;h.yc=0;h.jf=Ib.id;h.mv(this.titleText,null,0,Object(m.a)(this,this.AYl,"legacyCopyPasteShortcutDialogHandler"),a);h.n5(Ib.PNi)}}Object(w.a)(mc,"CopyPasteShortcutDialog",Ib,[]);class Jc extends Ib{constructor(a,
c){super(a,c);c={};a=this.uEl;c.extensionStartText=this.PEk;c.extensionLink=null;c.extensionEndText=null;c.shortcutsMessageText=this.cmn;c.cutText=this.S9(this.$Ve,this.arf);c.copyText=this.S9(this.WSe,this.$qf);c.pasteText=this.S9(this.XCf,this.brf);4!==l.AFrameworkApplication.na.Ya.Rm&&(c.pasteTextOnly=this.S9(this.Tda,this.crf));c={["id"]:"CopyPasteInstallDialog",["bodyControls"]:c};const h=new gg.a(!1,!1,!0);h.jf="CopyPasteInstallDialog";h.yc=0;h.Nd(1,this.tEl);h.yY(1);h.Tg(a,Object(m.a)(this,
this.RHf,"reactCopyPasteShortcutDialogHandler"),c)}get cmn(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get tEl(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get uEl(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get PEk(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}static Tpn(){var a=window.location.origin;return a?RegExp("^https:\\/\\/((.*?(word-edit|powerpoint|onenote|excel|visio)\\.(officeapps\\.live\\.com|partner\\.officewebapps\\.cn|gov\\.online\\.office365\\.us|dod\\.online\\.office365\\.us))|(project\\.microsoft\\.com))$",
"g").test(a):!1}}Object(w.a)(Jc,"ReactCopyPasteInstallDialog",Ib,[]);class kd extends Ib{constructor(a){super(a,null);this.VZh="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";var c={};a=this.Ygm;var h="";let v="";this.messageText&&(h=this.messageText.split(" {")[0],v=this.messageText.split("} ")[1]);c.startText=h;c.endText=v;c.cutText=this.Hok;c.copyText=this.Gek;c.pasteText=this.Lzm;
c.cutShortcutText=this.S9(this.Iok,this.U9l);c.copyShortcutText=this.S9(this.Rek,this.T9l);c.pasteShortcutText=this.S9(this.Ozm,this.W9l);c.imageSrc=Ki.a.K7("NoClipboardAccessDialogImage.svg");c.imageAltText=this.imageAltText;c.primaryButtonLabel=this.VEm;this.VZh&&(r.ULS.sendTraceTag(527986756,307,50,"Learn more link is available"),c.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.Ddb,["onExecute"]:()=>{this.vYl()}});c={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:c};
h=new gg.a(!1,!1,!0);h.yc=0;h.jf="CopyPasteNoClipboardAccessDialog";h.Tg(a,Object(m.a)(this,this.RHf,"reactCopyPasteShortcutDialogHandler"),c)}get Ygm(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get Ddb(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get imageAltText(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get VEm(){return CommonUIStrings.l_DialogOk}get Hok(){return CommonUIStrings.l_CutString}get Iok(){return CommonUIStrings.l_CutShortcut}get U9l(){return CommonUIStrings.l_CutShortcut_Mac}get Gek(){return CommonUIStrings.l_CopyString}get Rek(){return CommonUIStrings.l_CopyShortcut}get T9l(){return CommonUIStrings.l_CopyShortcut_Mac}get Lzm(){return CommonUIStrings.l_PasteString}get Ozm(){return CommonUIStrings.l_PasteShortcut}get W9l(){return CommonUIStrings.l_PasteShortcut_Mac}vYl(){r.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");Ve.a.Ql(this.VZh,"_blank",void 0,"learnMoreLink")}}Object(w.a)(kd,"ReactCopyPasteNoClipboardAccessDialog",Ib,[]);class Wd extends Ib{constructor(a,c,h){super(a,c);a={};a.forwardElementText=this.woh;a.cutText=this.S9(this.$Ve,this.arf);a.copyText=this.S9(this.WSe,this.$qf);a.pasteText=this.S9(this.XCf,this.brf);h.$("PasteTextOnlyShortcutDialogIsEnabled")&&(H.a.In||H.a.Qh)&&(a.pasteTextOnly=this.S9(this.Tda,this.crf));this.lQe?(r.ULS.sendTraceTag(40726914,307,50,
null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.S2g,["onExecute"]:v=>{this.Qjh(v)}},h=this.S8a.indexOf("{0}"),-1!==h&&(a.suggestionPrefixElement=this.S8a.substring(0,h),a.suggestionSuffixElement=this.S8a.substring(h+3,this.S8a.length))):r.ULS.sendTraceTag(40726915,307,50,null);h={["id"]:Ib.id,["bodyControls"]:a};a=new gg.a(!1,!1,!0);a.yc=0;a.jf=Ib.id;a.Tg(this.titleText,Object(m.a)(this,this.RHf,"reactCopyPasteShortcutDialogHandler"),h)}}Object(w.a)(Wd,"ReactCopyPasteShortcutDialog",
Ib,[]);class Ud{constructor(){this.una=!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.fA}BTe(a,c,h=!1){r.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.una,h));this.una?h?new Jc(a,c):new Wd(a,c,l.AFrameworkApplication.K):new mc(a,c,l.AFrameworkApplication.K)}static get instance(){return Ud._instance||(Ud._instance=new Ud)}}Ud._instance=null;Object(w.a)(Ud,"CopyPasteShortcutDialogFactory",null,[942]);class hf{constructor(a,c,h,v,
B,X,ma,Pa){this.KFg=this.rpg=this.TBe=!1;this.thd=a;this.Rb=c;this.Fs=h;this.fb=v;this.Ic=B;this.Ue=X;this.Hc=ma;Pa&&(this.KFg=Pa.$("ShouldLogExecCommandCopySuccess"))}get ENa(){return this.thd}get KXa(){return this.rpg}set KXa(a){this.rpg=a;this.Ue.ignoreClipboardEvents=a}VAc(a){this.ENa.VAc(a);a||this.dYc(!0)}get fCk(){return this.ENa.tMf}prepareForPaste(a){this.KXa=!0;this.ENa.prepareForPaste(a,this.aXf)}reset(){this.KXa=!1}paste(){var a=null;let c=null;if(!this.ENa.nJb){(a=this.Rb.rc)&&this.fb.Kf(a.IG);
var h=this.Fs.Su;if(!h.Cd||!h.editingView.wj)return null;c=h.editingView;a=this.Ic.Gn();this.KXa=!0;h.dDa()}h=null;try{c&&c.JDm(),h=a=this.ENa.fBc(this.aXf,a)}catch(v){r.ULS.shipAssertTag(6305672,307,!1),this.qHh()}this.KXa=!1;return h}copy(){var a=this.Rb.rc;a&&this.fb.Kf(a.IG);a=this.Fs.Su;if(!a.Cd||1!==a.editingView.mode)return!1;this.KXa=!0;let c;try{const h=new Map;h.set("View","ContentEditableView");Fa.Health.instance.recordKpiUsage(Gv.a.Aod,0,Gv.a.POe,h);const v=this.ENa.K0e(this.aXf);c=!0;
this.KFg&&r.ULS.sendTraceTag(558384097,307,50,"execCommandCopySuccess, {0}, browser: {1}",v,this.Hc.wD);if(!v){const B=Object.assign(new fi.a,{extendedProperties:h});Fa.Health.instance.recordKpiFailure(Gv.a.Aod,Gv.a.q0g,!0,!0,B)}}catch(h){r.ULS.shipAssertTag(6305673,307,H.a.Qh),r.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",H.a.wD),c=!1}this.KXa=!1;return c?!0:!1}dYc(){if(this.TBe)return!0;var a=this.Fs.Su;if(!a.Cd||!a.editingView.wj)return!1;
const c=a.editingView;a=this.Ic.Gn();this.KXa=!0;const h=new zw.a(a);let v=!1;try{v=this.ENa.dYc(a,()=>{c.wpd()},()=>{c.Psa()})}catch(B){r.ULS.shipAssertTag(6305674,307,!H.a.Gi)}h.restore();this.KXa=!1;v?this.TBe=!0:(r.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",H.a.wD),H.a.Gi||this.qHh());return v}qHh(){this.TBe=!1;if(l.AFrameworkApplication.xVn)Ud.instance.BTe(null,null);else{const a=new oe.StandardDialog;a.yc=0;a.vS(CommonUIStrings.l_ClipboardAccessDeniedTitle,
CommonUIStrings.l_ClipboardAccessDenied,null)}}get aXf(){const a=this.Ic.UIa();return a?a.am:null}}Object(w.a)(hf,"SystemClipboard",null,[693]);class $g{constructor(a,c,h){this.pjd=!1;this.Rjd=this.yQ=this.osg=this.Fde=this.I2c=null;this.sde=a.$("ChromeClipboardAccessExtensionSuggestionIsEnabled");this.kke=a.Ga("ChromeClipboardAccessExtensionLink");this.Z3a=c;this.Ki=h;this.Rte=a.Ga("ChromeClipboardAccessExtensionId");this.ezj=a.$("UseGetClipboardDataIsEnabled");this.SBg=a.$("RecordExtensionInstallStatusKpiIsEnabled");
this.ASb=!1;a.$("CcpInstallDialogIsEnabled")&&l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.fA&&(this.ASb=Jc.Tpn()||a.$("IgnoreDomainCheckCcpInstallDialog"),r.ULS.sendTraceTag(587314304,307,50,"_useInstallDialog: {0}",this.ASb));this.Pic=null}VAc(a){a?this.yQ=!0:(this.yQ=null,chrome.runtime&&chrome.runtime.sendMessage?(this.Pic=this.Z3a.vsd,this.Z3a.uhb?(this.pjd=this.ezj,this.h1g()):(this.pjd=!0,this.h1g(),r.ULS.sendTraceTag(19256732,307,50,N.a.create().toString()))):(this.TGb(),this.yQ=
!1))}get tMf(){return this.yQ}get nJb(){return this.Rjd}dYc(){return!0}K0e(a){r.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy");(a=Ve.a.Nvb(a,"copy"))||r.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)));return a}P5e(a){if(!a)return null;var c=a.img;const h=a.text;a=a.html;const v=this.Ki.wyi(!!c,!!h,a);let B=null;if(3===v){if(!a)return null;c=this.Ki.Zjh(a);(c=this.Ki.fkh(c))&&(a+=c);B=this.Ki.Afb(a)}else 2===
v?B=this.Ki.NCf(h,!0):1===v&&(B=this.Ki.Afb(c));return B}fBc(a,c){if(this.nJb)c=this.P5e(this.Fde),this.Fde=null;else{if(!this.I2c)return c;a=document.implementation.createHTMLDocument("doc");a.body.innerHTML=this.I2c;c=a.body;this.I2c=null}return c}prepareForPaste(a){const c=N.a.create();this.osg=c;this.Z3a.uhb?r.ULS.sendTraceTag(7377737,307,50,c.toString()):r.ULS.sendTraceTag(19256735,307,50,c.toString());const h={};h.command=this.nJb?"getClipboardData":"paste";chrome.runtime.sendMessage(this.Pic,
h,v=>{c.equals(this.osg)?this.nJb?this.Fde=v:this.I2c=v:r.ULS.sendTraceTag(7385868,307,50,null);r.ULS.sendTraceTag(7377738,307,50,c.toString());chrome.runtime.lastError&&(this.Ayk(),this.Z3a.uhb?r.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):r.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));a()})}TGb(){r.ULS.sendTraceTag(8716423,307,50,null);let a=null;this.ASb?a=this.kke+this.Rte:this.sde&&(a=this.kke+this.Pic);Ud.instance.BTe(Object(m.a)(this,this.yCm,"popupInstallDialogHandler"),
a,this.ASb)}yCm(a){1===a?(r.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.sde)),this.ASb&&(r.ULS.sendTraceTag(594882642,307,50,String.format("_useInstallDialog={0}",this.ASb)),Ve.a.Ql(this.kke+this.Rte,"_blank",void 0,"ChromeCCPInstallDialog"))):a||r.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.sde))}Ayk(){this.Z3a.P1m();this.TGb()}xzi(a,c){chrome.runtime.sendMessage(a,{command:"test",object:"ping"},c)}w3j(){const a=N.a.create();this.Z3a.uhb?
r.ULS.sendTraceTag(592491466,307,50,a.toString()):r.ULS.sendTraceTag(591984031,307,50,a.toString());chrome.runtime.sendMessage(this.Pic,{command:"getAvailableCommands"},c=>{r.ULS.sendTraceTag(592491467,307,50,a.toString());c?Object(Ub.a)(Array,c)?(r.ULS.sendTraceTag(592491470,307,50,"Extension responded: {0}",c),this.Rjd=-1!==Array.indexOf(c,"getClipboardData")):(r.ULS.sendTraceTag(592491469,307,15,"ChromeApi has non-string[] response. o: {0}",c),this.Rjd=!1):(r.ULS.sendTraceTag(592491468,307,15,
"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.Rjd=!1)})}h1g(){const a=N.a.create();this.Z3a.uhb?r.ULS.sendTraceTag(7726105,307,50,a.toString()):r.ULS.sendTraceTag(591984032,307,50,a.toString());this.pjd&&this.w3j();this.xzi(this.Pic,c=>{r.ULS.sendTraceTag(7726106,307,50,a.toString());c&&"ping"===c?this.yQ=!0:(c?"ping"!==c&&r.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",c,chrome.runtime.lastError?
chrome.runtime.lastError.message:null):r.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.TGb(),this.yQ=!1);this.pjd&&!this.nJb&&r.ULS.sendTraceTag(592491471,307,50,"No response for CheckGetClipboardDataExistenceAsync")})}a1h(a,c){const h={};h.OfficeOnlineExtensionInstallationStatus=a;h.OfficeClipboardExtensionInstallationStatus=c;r.ULS.sendTraceTag(51144839,307,50,JSON.stringify(h));this.SBg&&(a&&Fa.Health.instance.recordKpiSuccess($g.Zwg,
null),c&&Fa.Health.instance.recordKpiSuccess($g.Wwg,null))}t3l(){this.SBg&&(Fa.Health.instance.recordKpiUsage($g.Zwg,1,$g.Bhg,null),Fa.Health.instance.recordKpiUsage($g.Wwg,1,$g.Bhg,null));if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.Z3a.uhb;this.xzi(this.Rte,c=>{this.a1h(a,!!c)})}else this.a1h(!1,!1)}}$g.Zwg="OfficeOnlineExtensionInstallationStatus";$g.Wwg="OfficeClipboardExtensionInstallationStatus";$g.Bhg="wwccp";Object(w.a)($g,"ChromeSystemClipboardAccessManager",null,[722]);class ni{constructor(a,
c){this.yQ=null;this.Hc=a;this.qa=c;this.S8i=!this.qa.$("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.qa.$("BlockCopyCutOnFirefoxIsEnabled");this.buj=c.$("SetResultForEnsureAccessOperationForElectronIsEnabled")}VAc(a){this.S8i&&a&&this.Hc.Qh?(this.TGb(),this.yQ=!1):this.yQ=!0}get tMf(){return this.yQ}get nJb(){return!1}K0e(a){return Ve.a.Nvb(a,"copy")}fBc(a,c){Ve.a.Nvb(a,"paste");return c}prepareForPaste(a){a()}dYc(a,c,h){if(this.Hc.o4)return this.buj&&(this.yQ=!1),!1;c();h();a=this.fBc(a.ownerDocument,
a);c=a.innerHTML;a.innerHTML=Ya.a.create().toString();h();a=this.fBc(a.ownerDocument,a);return this.yQ=a=c===a.innerHTML}TGb(){Ud.instance.BTe(null,null)}}Object(w.a)(ni,"DefaultSystemClipboardAccessManager",null,[722]);class Nk{constructor(a,c,h){this.yQ=this.u6=this.PPb=this.rga=this.bRa=this.E2c=null;this.Ki=c;this.kRa=h;this.lmj=a.vb("ClipboardDataImageBlobLimitaton",10);a.$("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.Huj=a.$("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}VAc(a){this.Huj&&
a&&(this.yQ=!0)}get tMf(){return this.yQ}get nJb(){return!1}K0e(a){return a?Ve.a.Nvb(a,Jb.a.copy):!1}fBc(a,c){this.bRa&&(c=this.bRa,this.bRa=null);return c}prepareForPaste(a,c=null){if(a&&c){this.E2c=a;this.PPb=c;$addHandler(this.PPb,Jb.a.paste,Object(m.a)(this,this.Ubi,"onPasteEvent"));this.u6=this.rga=null;if(this.DRi(this.PPb)){if(this.u6&&0<this.u6.length&&(!this.rga||this.Ki.L7d(this.rga))){this.kRa.X6g(this.u6,Object(m.a)(this,this.Hom,"onImageConverted"));this.bRa&&!this.bRa.hasChildNodes()&&
r.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes.");return}this.rga&&this.rga.innerHTML&&((this.bRa=this.UKh(this.rga.innerHTML))&&!this.bRa.hasChildNodes()&&r.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),ye.a.Ux(this.rga))}this.nmh()}else a&&a()}dYc(a){return this.yQ=a=this.DRi(a.ownerDocument)}Ubi(a){try{a&&a.rawEvent&&((this.rga=a.rawEvent.target)&&this.rga.id&&-1<this.rga.id.indexOf("Paste")?(r.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+
this.rga.id),this.rga=null):this.u6=this.h3k(a.rawEvent))}catch(c){r.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+c.toString())}}Hom(a){a&&(this.kRa.nGi&&(a=String.format('<img src="{0}">',a)),this.bRa=this.UKh(a));this.nmh()}nmh(){this.PPb&&($removeHandler(this.PPb,Jb.a.paste,Object(m.a)(this,this.Ubi,"onPasteEvent")),this.PPb=null);this.E2c&&(this.E2c(),this.E2c=null)}h3k(a){let c=null;(a=this.Ki.Xrh(a))&&({Def:c}=this.Ki.gRi(a,this.lmj,this.kRa.q4h));
return c}DRi(a){return Ve.a.Nvb(a,Jb.a.paste)}UKh(a){const c=document.implementation.createHTMLDocument("doc");c.body.innerHTML=a;return c.body}TGb(){}}Object(w.a)(Nk,"EdgeSystemClipboardAccessManager",null,[722]);class tj{constructor(a,c,h,v){this.qa=a;this.m$i=c;this.Ki=h;this.Hc=v}create(){let a=null;l.AFrameworkApplication.KSf()&&this.Hc.In&&window.chrome?(r.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),a=new $g(this.qa,this.m$i,this.Ki),this.qa.$("LogChromeExtensionInstallationStatusIsEnabled")&&
a.t3l()):this.qa.$("EdgeContextMenuPasteFixIsEnabled")&&this.Hc.so?(r.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),a=new Nk(this.qa,xa.a.instance.resolve("Box4.IClipboardDataHelper"),xa.a.instance.resolve("Box4.IProcessImageStrategy"),xa.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(r.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),a=new ni(this.Hc,this.qa));return a}}Object(w.a)(tj,"SystemClipboardAccessManagerFactory",
null,[684]);class qp{FDk(a){return a}}Object(w.a)(qp,"DeleteTableSegmentStrategy",null,[682]);var zm=b(553),Ln=b(904);class jl{constructor(){this.uj=this.kh=null}get Zn(){return Vn.a.uxb}get paragraphEditor(){return this.kh||(this.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}get nY(){return this.paragraphEditor.Zn}get Kb(){return Ee.a.instance}get yC(){return this.uj||(this.uj=xa.a.instance.resolve("Box4.IParagraphIndentationReader"))}yuc(a,c,h,v,B,X,ma){let Pa=2;if(!a.Cd)return 2;const mb=
a.Ma;if(!mb)return this.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.uda}),8;if(l.AFrameworkApplication.K.$("Box4PartialPromoteDemoteIsEnabled")){a=this.p_g(c===zb.a.lE,h,!0);if(1===v)return a?32:8;a&&(Pa=Ln.a.C7b(c,h,v,B,X,ma))}else Pa=Ln.a.C7b(c,h,1,B,X,ma),1!==v&&32===Pa?(a.Ma.YRd(),a=new gf.GraphTransaction(15),a.Oa(h.view.sc),Pa=this.p_g(c===zb.a.lE,h,!1)?Ln.a.C7b(c,h,v,B,X,ma):8,a.dispose()):1!==v&&8===Pa&&(a.Ma.YRd(),this.Bak(c,h,mb));return Pa}p_g(a,c,h){c=c.view.Ma;if(!c||!c.Ca.Fa)return this.Kb.ib(Kf.a.re,
{["Reason"]:Ef.a.tCb}),!1;if(c.Ca.VG)return this.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.gSe}),!1;c=zm.OutlineElementGeneralizer.xia(c.Ca,!1);if(!c)return this.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.cwd}),!1;let v=!1;for(let B=0;B<c.length;B++){const X=c.getContext(B),ma=new Kd.GraphIterator;ma.set(X.node);Gc.SelectionEditor.vs(ma);if(!Ta.OutlineElementReader.Gg(ma))if(h)continue;else return this.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.KUa}),!1;if(a?!this.Zn.Xsb(ma):!this.Zn.bVb(ma))if(h)continue;else return this.Kb.ib(Kf.a.zXb,
{["Reason"]:Ef.a.JOe}),!1;v=!0}return h?v:!0}Bak(a,c,h){const v=new gf.GraphTransaction(15);try{v.Oa(c.view.sc);c=!0;const B=zm.OutlineElementGeneralizer.xia(h.Ca,!1);for(let X=0;X<B.length;X++){const ma=B.getContext(X),Pa=new Kd.GraphIterator;Pa.set(ma.node);Gc.SelectionEditor.vs(Pa);if(!Ta.OutlineElementReader.Gg(Pa))c=!1;else if(a===zb.a.lE?this.Zn.Xsb(Pa):this.Zn.bVb(Pa))switch(c=!1,a){case zb.a.lE:this.Zn.$La(Pa,-1,0);break;case zb.a.gM:this.Zn.ozc(Pa,1)}}if(c){const X=h.Ca.Fa;for(h=0;h<X.length;h++){const ma=
X.J(h);if(ma.Kk){const Pa=this.yC.Mab(ma.node),mb=Pa.m$;if(a===zb.a.lE?Pa.az>mb:Pa.az<18*mb){const Tb=new Kd.GraphIterator;Tb.set(ma.node);this.nY.Xsa(Tb,1,a===zb.a.lE?Pa.az>=2.5*mb?Pa.az-2*mb:mb:Pa.az<16*mb?Pa.az+2*mb:18*mb)}}}}}finally{v&&v.dispose()}}}Object(w.a)(jl,"IndentationActorExtension",null,[681]);var ks=b(292),Sv=b(673),Zo=b(1073);class eu{constructor(a,c){this.qn=new uh.DictionaryPropertySet;this.nnb=!1;this.Tk=this.Lva=this.sva=this.Qkb=null;this.tL=a;this.jjg=c}get wib(){return this.Lva||
(this.Lva=xa.a.instance.ra("Box4.ITextFormattingCommands"))}get hh(){return eu.nd||(eu.nd=xa.a.instance.resolve("Box4.IFormattingEditor"))}get qb(){return this.Tk||(this.Tk=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}k_a(){this.nnb||(this.qn.JJf(),this.Qkb=null,this.xWm())}Qek(a){var c;const h=null!==(c=ua.FormattingReader.zr(a))&&void 0!==c?c:ua.FormattingReader.Hzd(a.node,a.cpBegin,-1);!h.cache.hz&&(a=h.fm)&&(c=new uh.DictionaryPropertySet,c.Zq(a),c.Zq(this.qn),c.hasProperty(zi.a.Oz)&&
(this.Qkb=h.paragraph.Mb),this.qn=c)}hasProperty(a){return this.qn.hasProperty(a)}aGc(){return 0<this.qn.hI()}get lXa(){return this.qn}freeze(){this.nnb=!0}vCa(){this.nnb=!1}eK(a,c){return this.lXa.ia(a,c)}nv(a){this.qn.setValue(Ed.a.fontSize,this.hh.UVb(a));this.DY()}fontSize(){return this.qn.ia(Ed.a.fontSize,fm.a.jI)}b0d(a){this.qn.setValue(Ed.a.font,a);this.jjg&&this.jjg.execute(c=>{null==c?r.ULS.sendTraceTag(527029267,324,10,"IFontNameFormattingStrategy is null after future execution"):c.b0d(this.qn)});
this.tL&&this.tL.enabled&&(Sd.b(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.tL.wen(this.qn,a));this.DY()}X$b(a){this.qn.setValue(Yb.a.D1,a);this.tL&&this.tL.enabled&&(Sd.b(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.tL.Jjn(this.qn,a));this.DY()}at(a){a=Uj.a.instance.Twa($c.a.instance.Ca.Fa.sa.node,a);this.qn.setValue(Ed.a.fontColor,a);this.DY()}A3(){this.qn.setValue(Ed.a.fontColor,kn.a.auto);this.DY()}fontColor(){return this.qn.ia(Ed.a.fontColor,
kn.a.nil)}Vsa(a){this.qn.setValue(Ed.a.highlight,parseInt(a,16));this.DY()}rpd(){this.qn.setValue(Ed.a.highlight,kn.a.auto);this.DY()}isBold(){return this.qn.ia(Ed.a.bold,!1)}jH(a){this.qn.setValue(Ed.a.bold,a);this.DY()}isItalic(){return this.qn.ia(Ed.a.italic,!1)}setItalic(a){this.qn.setValue(Ed.a.italic,a);this.DY()}isUnderline(){return this.qn.ia(Ed.a.underline,!1)}r1(a){this.qn.setValue(Ed.a.underline,a);this.qn.setValue(Ed.a.underlineType,a?fm.a.AIb:fm.a.SV);this.DY()}underlineType(){return this.qn.ia(Ed.a.underlineType,
fm.a.SV)}Aea(a){a<fm.a.AIb||a>fm.a.SV||(this.qn.setValue(Ed.a.underline,a!==fm.a.SV),this.qn.setValue(Ed.a.underlineType,a),this.DY())}isSuperscript(){return this.qn.ia(Ed.a.superscript,!1)}e$(a){this.qn.setValue(Ed.a.superscript,a);a&&this.isSuperscript()&&this.qn.setValue(Ed.a.subscript,!1);this.DY()}isSubscript(){return this.qn.ia(Ed.a.subscript,!1)}qla(a){this.qn.setValue(Ed.a.subscript,a);a&&this.isSubscript()&&this.qn.setValue(Ed.a.superscript,!1);this.DY()}isStrikethrough(){return this.qn.ia(Ed.a.strikethrough,
!1)}v5(a){this.qn.setValue(Ed.a.strikethrough,a);this.DY()}isDoubleStrikethrough(){return this.qn.ia(zi.a.Bq,!1)}D$b(a){this.qn.setValue(zi.a.Bq,a);this.DY()}Drh(){return this.qn.ia(zi.a.Oz,null)}qhb(a,c){var h;this.qn.JJf();(null===(h=l.AFrameworkApplication.K)||void 0===h?0:h.$("WACStyleCallStackLoggingIsEnabled"))&&1073872969!==a.Gb&&Sd.b(525091603,3017,10,`Invalid propertySet of ClassId : ${a.Gb} .`+` Call Stack: ${ks.a.eqa(0,Xf.a.cZa)}`);this.qn.setValue(zi.a.Oz,a.id);this.Qkb=c.Mb;this.DY()}q5(a){let c=
Ed.a.iB;if(kg.a.instance.J(1)){const h=Sv.a.CLd(a);switch(h){case 1:c=Yb.a.XAb;break;case 2:c=Yb.a.YAb}this.qn.setValue(Yb.a.languageHint,h)}this.qn.setValue(c,a);this.DY()}language(){let a=Ed.a.iB;if(kg.a.instance.J(1))switch(this.qn.ia(Yb.a.languageHint,0)){case 1:a=Yb.a.XAb;break;case 2:a=Yb.a.YAb}return this.qn.ia(a,0)}Hgn(a){this.qn.setValue(Yb.a.noProof,a);this.DY()}bAb(){return this.qn.ia(Yb.a.noProof,!1)}JOl(){return this.qn.hasProperty(Yb.a.noProof)}wNl(){return kg.a.instance.J(1)?this.qn.hasProperty(Ed.a.iB)||
this.qn.hasProperty(Yb.a.XAb)||this.qn.hasProperty(Yb.a.YAb):this.qn.hasProperty(Ed.a.iB)}DY(){if(H.a.qbc){var a=$c.a.instance.Ca.Fa.sa,c=a.node;if(c===this.sva)this.sva.lj(16,!0);else{this.sva=c;c=this.sva.NV();try{this.sva.c8(a.cpBegin).iKa=!0}finally{c&&c.dispose()}}}}xWm(){if(H.a.qbc&&this.sva){var a=0,c=this.sva.NV();try{for(let h=this.sva.la.length-1;0<=h;h--){const v=this.sva.la.J(h);v.iKa&&(v.iKa=!1,a++,v.isEmpty&&this.sva.la.removeAt(h))}}finally{c&&c.dispose()}this.sva=null}}cdk(a){if(a.cpBegin!==
a.cpEnd)return!1;a=a.node.la.$g(a.cpBegin);return!!a&&a.iKa}tKe(a){if(this.wib){this.freeze();var c=new gf.GraphTransaction(7);c.Oa(a.node);this.wib.d0d(a);this.vCa();this.k_a();c.dispose()}}O$e(a){const c=sd.ParagraphReader.text(a.node);return a.cpBegin&&a.cpBegin!==c.length&&!F.a.Yt(c.charCodeAt(a.cpBegin))&&Zo.a.instance.KVa(c,a.cpBegin-1)!==a.cpBegin&&Gc.SelectionEditor.gdb(a)?(a=Gc.SelectionEditor.a0(a,!1))?1<a.length||Gc.SelectionEditor.tj(a.sa)?a:null:null:null}}eu.nd=null;Object(w.a)(eu,"InsertionPointFormatting",
null,[680]);class Bs{constructor(a){this.ga=a}get Eb(){return this.ga}aZj(a,c,h=null){const v=new uh.DictionaryPropertySet;v.setValue(Uc.a.$t,a);v.setValue(Uc.a.zra,c);h&&v.Zq(h);v.CommandSource="autobulleting";this.Eb.hb(zb.a.Ay,2,v)}numbering(a,c,h,v,B){const X=new uh.DictionaryPropertySet;X.setValue(Uc.a.$t,a);X.setValue(Uc.a.zra,c);X.setValue(Uc.a.RKa,h);B&&X.setValue(ii.a.JN,B);v&&X.setValue(Yb.a.Fq,v);As.a.cV&&(X.setValue(ii.a.Uja,"autocorrect"),B&&X.setValue(ii.a.fda,B));X.CommandSource="autonumbering";
return 32===this.Eb.hb(zb.a.RF,2,X)}}Object(w.a)(Bs,"ListCommands",null,[679]);var ls=b(223);class rt extends ls.a{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){super();this.iQb=this.un=this.UDa=null;this.init(a);this.jk(rc);this.$bb(Pa,c,v,B,X);this.DB=X;this._context=h;this.ya=mb;this.yd=Tb;this.Pna=ma;this.Ix=0}run(){this.sPe();this.Ix||this.oln();1===this.Ix&&this.VGm();2===this.Ix&&this.MBn();3===this.Ix&&this.KJk()}sPe(){this.ya.Ca&&this.ya.Ca.Fa?1===this.behavior&&(this.Pna.sPe(this._context)?this.Xp=
32:this.Xp=2,this.Ix=3):(r.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.Xp=2,this.Ix=3)}oln(){this.KXj();this.Pna.CRf(this.UDa)?(this.QWj(),this.Ix=1):(this.Xp=8,this.Ix=3)}VGm(){this.yD||new Cp.a(this,Object(m.a)(this,this.QFm,"processCurrentNodeAtBegin"),this.DB);do if(this.yD.run(),this.yD.inProgress&&!this.fg)return;while(this.yD.inProgress);this.npd();this.Ix=2}MBn(){this.Pna.lXf(this)?this.Xp=32:this.Xp=8;this.Ix=3}KJk(){this.lla()}QFm(a,c){c=this.Pna.iVd(this.UDa,c);
a.wh(Object(m.a)(this,this.oOk,"fromHereToEnd"));return c}oOk(a,c){if(this.un.moveNext())return a=this.un.currentNode,12!==a.type||a===this.UDa.node?!0:this.Pna.tQc(a,c);this.sYj();a.wh(Object(m.a)(this,this.pOk,"fromStartToHere"));return!0}pOk(a,c){if(this.un.moveNext()){const h=this.un.currentNode;return 12!==h.type?!0:h===this.UDa.node?(a.wh(Object(m.a)(this,this.RFm,"processCurrentNodeAtEnd")),!0):this.Pna.tQc(h,c)}return!1}RFm(a,c){this.Pna.jVd(this.UDa,c);return!1}KXj(){let a=this.ya.Ca.Fa;
if(a=this.yd.Ri(a,!0,!1))this.UDa=a.sa;this.UDa&&this.UDa.node&&(this.iQb=this.Pna.bBh(this.UDa.node))}QWj(){if(!this.iQb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new Yk.a;a.set(this.UDa.node);a.La(this.iQb.type);this.un=hq.a.eq(a,this.iQb);this.un.Fl(Object(m.a)(this.Pna,this.Pna.Tac,"spellErrorFilter"),null)}sYj(){if(!this.iQb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new Yk.a;a.set(this.iQb);this.un=hq.a.gq(a);this.un.Fl(Object(m.a)(this.Pna,this.Pna.Tac,
"spellErrorFilter"),null)}}Object(w.a)(rt,"ProofingWholeDocumentOperation",ls.a,[]);var fu=b(277);class ir extends Dn{constructor(){super();this.CommandMenuClose=this.CommandMenuOpen=null}}Object(w.a)(ir,"ContextMenuRootProperties",Dn,[]);var Vx=b(1735);class gu{constructor(a){const c=new ir;c.ImageSideArrow=l.AFrameworkApplication.qp;c.ImageSideArrowClass=Fd.getImageClass("SubmenuFlyoutArrow_13x13x32");c.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection;c.CommandMenuOpen=zb.a.DUd.toString();
this.yIg=new Vx.ContextMenuRoot("ContextMenuRootName",c);a.execute(h=>{this.SY.GC=h});this.SY.refresh();l.AFrameworkApplication.pa.ka(Sa.a.showContextMenu,Kc.a.frame,Le.ActionManager.De);l.AFrameworkApplication.pa.ka(Sa.a.uac,Kc.a.frame,Le.ActionManager.De)}get SY(){return this.yIg}dispose(){this.SY&&(this.SY.dispose(),this.yIg=null)}showContextMenu(a,c){this.PGb(a,c.clientPoint,c.He)}oWb(a,c,h,v,B){this.SY.oWb(a,c,h,v,B)}f0a(a,c,h){Ve.a.qOd(this.SY.HSa?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu",
"");Eb.App.oa.kNk();this.ps();this.SY.f0a(a,c,h);this.SY.HSa?l.AFrameworkApplication.pa.processAction(Sa.a.uac,2):l.AFrameworkApplication.pa.processAction(Sa.a.showContextMenu,2)}PGb(a,c,h){this.f0a(a,new Sys.UI.Bounds(c.x,c.y,0,0),h)}ps(){this.SY.root.yk()}U_(){return this.SY.U_()}uac(a,c,h,v){const B=this.SY;let X=!1;h=Object(ha.a)(Er,h);B.HSa=h;v.Zsa(a,c);B.TGe?h&&(h.ECm(B,c),X=!0):(r.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",v.iok()),B.HSa=null);return X}}
Object(w.a)(gu,"AContextMenuController",null,[721,14]);class Dr{}Dr.d8b="faProofing";Dr.ogh="EditorMenuSection";Object(w.a)(Dr,"ContextMenuControlId",null,[]);var Fv=b(506);class Bt{constructor(a){this.yd=a}sPe(a){a=Object(ha.a)(Fv.a,a);return!!a&&!!a.view&&a.view.Cd}CRf(){return!0}iVd(){return!0}tQc(){return!0}jVd(){}lXf(){return!0}Tac(a){if(a.jq)return!0;a=a.role;return 1===a||2===a||3===a||4===a||5===a}bBh(a){if(!a||!this.yd)return a;const c=new Yk.a;c.set(a);if(this.yd.vs(c)){for(;!c.jq;)c.ob();
return c.currentNode}return a}}Object(w.a)(Bt,"SimpleProofingWholeDocumentCallBacks",null,[620]);class Pu{constructor(a){this.value=a}}Object(w.a)(Pu,"RefBool",null,[]);class fv{constructor(){this.$Ac=this.qCb=null;this.qSi=new Pu(!1)}}Object(w.a)(fv,"FindNextErrorOperationParam",null,[]);var Js=b(1407);class pv extends Bt{constructor(a,c,h,v){super(c);this.Fj=a;this.hrc=h;this.t8i=v}iVd(a,c){return!this.spf(a.node,a.cpBegin,c)}tQc(a,c){return!this.spf(a,0,c)}jVd(a,c){this.spf(a.node,0,c);Object(ha.a)(fv,
c)}spf(a,c,h){h=Object(ha.a)(fv,h);if(sd.ParagraphReader.tb(a)&&!a.BI)if(ua.FormattingReader.zr(Oe.a.Sb(a,c)).cache.bAb)h.qSi.value=!0;else{if(Js.a.hx())return c=this.t8i.wGk(a,c,this.hrc),null!=c?(h.qCb=c,h.$Ac=a,!0):!1;const v=this.Fj.l0(a);for(let B=0;B<v.length;B++){const X=v[B];if(X.begin>=c&&!X.errorDetails.FXa()&&(!this.hrc||this.hrc(X.errorDetails)))return h.qCb=X,h.$Ac=a,!0}return!1}}}Object(w.a)(pv,"FindNextErrorCallbackSteps",Bt,[]);var Fn=b(454);class Qu{constructor(a,c,h,v,B,X,ma,Pa,
mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf){this.ga=c;this.Fj=a;this.Okj=h;this.Tb=v;this.Fb=B;this.ya=X;this.vl=ma;this.yd=Pa;this.jGa=mb;this.Gm=Tb;this.fc=rc;this.z2a=Yf;this.VP=Object(ha.a)(gu,Tc);this.cOb=vd.$Jc;this.kBg=ee;this.hkb=Ie;this.oRa=Xe;this.X0c=new gd.a;this.X0c.Z(1,zb.a.BUf);this.X0c.Z(2,zb.a.Pbf);this.X0c.Z(3,zb.a.FVf);this.oed=new gd.a;this.oed.Z(1,zb.a.CUf);this.oed.Z(2,zb.a.Qbf);this.oed.Z(3,zb.a.GVf)}eb(){const a=this.ga,c=Object(m.a)(this,this.cfk,"correctError"),h=Object(m.a)(this,this.W8j,
"collapseIp");a.Aa(zb.a.GSd,ic.a.view,Object(m.a)(this,this.uvm,"openLanguageDialogView"),1028);a.ka(zb.a.Gxa,ic.a.Ub,Object(m.a)(this,this.Gxa,"deleteRepeatedWord"));a.ka(zb.a.Eqa,ic.a.Ub,Object(m.a)(this,this.Eqa,"ignoreSpellingError"));a.ka(zb.a.oib,ic.a.Ub,c);a.ka(zb.a.pib,ic.a.Ub,c);a.ka(zb.a.qib,ic.a.Ub,c);a.ka(zb.a.PHb,ic.a.Ub,c);a.ka(zb.a.QHb,ic.a.Ub,c);a.ka(zb.a.Gxa,ic.a.view,h);a.ka(zb.a.Eqa,ic.a.view,h);a.ka(zb.a.oib,ic.a.view,h);a.ka(zb.a.pib,ic.a.view,h);a.ka(zb.a.qib,ic.a.view,h);a.ka(zb.a.PHb,
ic.a.view,h);a.ka(zb.a.QHb,ic.a.view,h);a.Qb(zb.a.Gxa,1028);a.Qb(zb.a.Eqa,1028);a.Qb(zb.a.oib,1028);a.Qb(zb.a.pib,1028);a.Qb(zb.a.qib,1028);a.Qb(zb.a.PHb,1028);a.Qb(zb.a.QHb,1028);a.ka(zb.a.kta,Kc.a.frame,Le.ActionManager.De);this.cOb&&a.Aa(zb.a.DUd,ic.a.view,Object(m.a)(this,this.DUd,"populateProofingSecondaryMenu"),1124);a.Aa(zb.a.ENc,ic.a.view,Object(m.a)(this,this.QIk,"findNextProofingError"),1028);a.Aa(zb.a.dGf,ic.a.xc,Object(m.a)(this,this.k$m,"sendClickNoActionFeedback"),1124);this.PSm([zb.a.Y2d,
zb.a.BUf,zb.a.CUf,zb.a.hDd,zb.a.Pbf,zb.a.Qbf,zb.a.D3d,zb.a.FVf,zb.a.GVf])}PSm(a){for(let c=0;c<a.length;c++)this.ga.Aa(a[c],ic.a.view,Le.ActionManager.lX,1028)}$Tm(a){this.hrc=a}W8j(a,c,h,v,B){c=this.ya.Ca.Fa;if(!c)return this.fc.ib(Kf.a.re,{["Reason"]:Ef.a.noSelection}),2;c=this.yd.Ri(c,!0,!1);return this.ga.Le(c.sa,a,h,!1,v,B)}uvm(a,c,h){if(1===h)return this.ga.processAction(zb.a.q5,1);this.Okj().tTf();return 32}k6d(a){return a?a.errorDetails?!1:(r.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),
this.fc.ib(Kf.a.Svb,{["Reason"]:"ErrorRangeMissingErrorDetails"}),bh.a.mark(4671),!0):(r.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this.fc.ib(Kf.a.Svb,{["Reason"]:"RequestedErrorRangeNotFound"}),bh.a.mark(4671),!0)}Gxa(a,c,h){if(1===h)return 32;bh.a.mark(4670);h=this.Fj.Lia(c);if(this.k6d(h))return 8;c=c.node;const v=this.Fb.Ob(15);let B=h.begin;" "===sd.ParagraphReader.text(c).charAt(B-1)&&B--;v.Oa(c);const X=this.Tb.replaceTextRange(Oe.a.createTextRange(c,0<h.begin?
h.begin-1:0,h.end),"",!0,!1);this.ya.setSelection(ne.SelectionFactory.vd(c,X+B));v.dispose();h.errorDetails.Iib(a);bh.a.mark(4671);return 32}Z6l(a){let c;({value:c}=this.oed.Ab(a.errorDetails.proofingType,0)).returnValue&&(this.ga.processAction(c,2),r.ULS.sendTraceTag(527799886,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",c,a.errorDetails.proofingType))}Eqa(a,c,h){if(1===h)return 32;r.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");if(Js.a.hx())return this.z2a.ncf(c,
null,Fn.b.IgnoreOnce),32;bh.a.mark(4670);h=this.Fj.Lia(c);if(this.k6d(h))return 8;c=c.node;const v=this.Fb.Ob(15);v.Oa(c);this.Fj.mgb(c,[h],!0);c.setValue(Ed.a.cSe,!0);v.dispose();h.errorDetails.Iib(a);bh.a.mark(4671);r.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.Z6l(h);this.oRa.oLh(h,c,!0);return 32}aXk(a){switch(a){case zb.a.oib:return 0;case zb.a.pib:return 1;case zb.a.qib:return 2;case zb.a.PHb:return 3;case zb.a.QHb:return 4;default:return-1}}g2l(a){let c;({value:c}=
this.X0c.Ab(a.errorDetails.proofingType,0)).returnValue&&(this.ga.processAction(c,2),r.ULS.sendTraceTag(527799887,375,50,"ProofingActor: Logging {0} command for {1} proofingType.",c,a.errorDetails.proofingType))}cfk(a,c,h){var v=!this.Gm.T8(c);this.vl&&this.vl.instance&&this.vl.instance.JR(c)&&(v=!1);if(1===h||!v)return v?32:8;this.ga.processAction(zb.a.kta,2);bh.a.mark(4670);v=this.aXk(a);if(0>v)return 8;if(Js.a.hx())return this.z2a.ncf(c,v,Fn.b.Apply),32;h=this.Fj.Lia(c);if(this.k6d(h))return 8;
c=c.node;var B=h.errorDetails.suggestions;if(!B)return this.fc.ib(Kf.a.Svb,{["Reason"]:"NoSuggestionsFound"}),bh.a.mark(4671),8;v=v<B.length?B[v]:null;if(!v)return this.fc.ib(Kf.a.Svb,{["Reason"]:"RequestedSuggestionIsNull"}),bh.a.mark(4671),8;this.hkb.J(4)&&Eb.App.lc.$n&&Eb.App.lc.zp.aF(c);v=v.replace("  "," \u00a0");B=this.Fb.Ob(15);B.Oa(c);const X=this.Tb.replaceTextRange(Oe.a.createTextRange(c,h.begin,h.end),v,!0,!1,zb.a.kta);this.ya.setSelection(ne.SelectionFactory.vd(c,h.begin+v.length+X));
B.dispose();h.errorDetails.Iib(a);bh.a.mark(4671);this.g2l(h);return 32}k$m(a,c){c=this.Fj.Lia(c);if(this.k6d(c))return 8;c.errorDetails.Iib(a);return 32}v8m(a,c,h,v){a.oea();(a=h.Sd(a.gb))?(v=fu.a.Zo(a,l.AFrameworkApplication.isRtl?v.begin:v.end),this.jGa.Zsa(new Sys.UI.Point(v.x,v.y+v.height),c)):r.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}QIk(a,c,h,v,B){if(!c.view.Cd)return 2;const X=c.view;if(!this.ya.Ca.Fa)return this.fc.ib(Kf.a.re,{["Reason"]:Ef.a.noSelection}),
2;if(1===h)return 32;const ma=new fv,Pa=new pv(this.Fj,this.yd,this.hrc,this.z2a);c=new rt(null,a,c,h,v,ma,Pa,this.ga,this.ya,this.yd,null);c.fg=!0;c.run();if(c.isCompleted&&ma.qCb){if(c=ne.SelectionFactory.vd(ma.$Ac,ma.qCb.begin),c=ne.SelectionFactory.jC(c,Oe.a.Sb(ma.$Ac,ma.qCb.end)),!this.kBg.instance||!this.kBg.instance.oEm(ma.qCb,c,X)){this.ya.setSelection(c);let mb=0;B&&(mb=B.wF);X.G1d=!1;ag.a.instance.ub(new Se.a(1,1,1,()=>{this.v8m(X,mb,ma.$Ac,ma.qCb)}))}}else{const mb=new oe.StandardDialog;
mb.yc=0;Eb.App.aJ.vKc?mb.Dea(CommonUIStrings.l_DefaultDialogTitle,ma.qSi.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(mb.Dea(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Eb.App.aJ.cld(()=>{mb.bAa&&(mb.hide(),this.ga.processAction(a,2))}))}return 32}DUd(a,c,h){if(1===h)return 32;this.VP&&this.VP.SY&&(a=this.VP.SY.nbf(Dr.d8b))&&!a.KI&&(a.VX(0),a.menu.kI(0));return 32}}Object(w.a)(Qu,
"ProofingActor",null,[]);var hu=b(318),vr=b(1372);class Tv{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){this.uL=this.Vua=this.kbc=null;this.BLk="StyleUsageActivity";this.CLk="StylesFloodgateSurveyIsEnabled";this.Pu=null;this.yv=c;this.nd=h;this.Ey=v;this.Xm=B;this.Gm=X;this.fc=ma;this.nG=Pa;this.Kzj=mb;this.$b=Tb}get ti(){return this.Pu||(this.Pu=xa.a.instance.ra("Box4.Styles.StyleSettings"))}get D5(){return this.yv}get uf(){return this.Ey}get Ei(){return this.Xm}get hh(){return this.nd}get Sf(){return this.Gm}get Kb(){return this.fc}get N0a(){return this.nG}get A_c(){return this.Kzj}get qb(){return this.$b}get eKa(){null==
this.Vua&&(l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),this.Vua=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.Vua}eb(){const a=l.AFrameworkApplication.pa,c=Eb.App.P0a.E8g(12);kg.a.instance.J(8)&&(a.ka(zb.a.applyStyle,ic.a.xc,Object(m.a)(this,this.wPj,"applyStyleToTextRange")),a.ka(zb.a.pBa,ic.a.xc,Object(m.a)(this,this.VJm,"queryStyleTextRange")),
a.ka(zb.a.applyStyle,ic.a.Ub,Object(m.a)(this,this.uPj,"applyStyleToIp")),a.ka(zb.a.pBa,ic.a.Ub,Object(m.a)(this,this.TJm,"queryStyleIp")));a.ka(zb.a.applyStyle,ic.a.paragraph,Object(m.a)(this,this.vPj,"applyStyleToParagraph"));a.ka(zb.a.applyStyle,ic.a.view,Object(m.a)(this,this.xPj,"applyStyleView"));a.Qb(zb.a.applyStyle,1036);a.ka(zb.a.pBa,ic.a.view,Object(m.a)(this,this.WJm,"queryStyleView"));a.ka(zb.a.pBa,ic.a.paragraph,Object(m.a)(this,this.UJm,"queryStyleParagraph"));a.Qb(zb.a.pBa,99);a.ka(zb.a.HDb,
ic.a.view,c);a.ka(zb.a.HDb,ic.a.paragraph,Object(m.a)(this,this.HDb,"populateMenuMoreStyles"));a.Qb(zb.a.HDb,1127);a.Aa(zb.a.BKe,ic.a.view,Object(m.a)(this,this.bHa,"applyStyleShortcut"),4);a.Aa(zb.a.CKe,ic.a.view,Object(m.a)(this,this.bHa,"applyStyleShortcut"),4);a.Aa(zb.a.DKe,ic.a.view,Object(m.a)(this,this.bHa,"applyStyleShortcut"),4);a.Aa(zb.a.EKe,ic.a.view,Object(m.a)(this,this.bHa,"applyStyleShortcut"),4);a.Aa(zb.a.FKe,ic.a.view,Object(m.a)(this,this.bHa,"applyStyleShortcut"),4);a.Aa(zb.a.GKe,
ic.a.view,Object(m.a)(this,this.bHa,"applyStyleShortcut"),4);a.Aa(zb.a.HKe,ic.a.view,Object(m.a)(this,this.bHa,"applyStyleShortcut"),4);a.Aa(zb.a.ITg,ic.a.view,Object(m.a)(this,this.bHa,"applyStyleShortcut"),4);a.Aa(zb.a.JTg,ic.a.view,Object(m.a)(this,this.bHa,"applyStyleShortcut"),4);a.Aa(zb.a.KTg,ic.a.view,Object(m.a)(this,this.bHa,"applyStyleShortcut"),4);this.kbc=Array(10);gj.StyleReader.R0d(this.kbc)}Vgl(a){switch(a){case zb.a.BKe:return 0;case zb.a.CKe:return 1;case zb.a.DKe:return 2;case zb.a.EKe:return 3;
case zb.a.FKe:return 4;case zb.a.GKe:return 5;case zb.a.HKe:return 6;case zb.a.ITg:return 7;case zb.a.JTg:return 8;case zb.a.KTg:return 9;default:return-1}}bHa(a,c,h,v){a=this.Vgl(a);return 0>a||a>this.kbc.length?2:(a=this.kbc[a])?l.AFrameworkApplication.pa.Le(c,zb.a.applyStyle,h,!0,v,a):2}HDb(a,c,h,v,B){a=!0;c.contextId!==ic.a.paragraph&&c.contextId!==ic.a.xc&&c.contextId!==ic.a.Ub&&(a=!1);if(1===h||!a)return a?32:8;if(2===h&&!B)return 8;c=this.qb.tw(c.node);h=kg.a.instance.J(8);B.MenuItems=hu.a.E7k(c,
h);return 32}UJm(a,c,h,v,B){a=!0;c.contextId!==ic.a.paragraph&&(a=!1);if(1===h&&!a)return 8;h=c.node;a=this.qb.um(h);if(!a||!B)return r.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",B,h,a),8;B.ANa.Zq(a.Fg());this.eKa&&(B.gJc=dl.a.Ilf(c,a));return 32}vPj(a,c,h,v,B){if(c.contextId!==ic.a.paragraph)return 8;if(this.Sf.SXa(c,!1))return this.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.dC}),8;if(1===h)return 32;h=c.node;if(sd.ParagraphReader.axa(h)||!B)return 8;const X=this.jaf(B,
h);if(!X)return this.Kb.ib(Kf.a.XY,{["Reason"]:Ef.a.Tvb}),8;if(2!==this.qb.Gv(X))return 2;a=new gf.GraphTransaction(15);this.ti&&this.ti.isProgressiveStyleEnabled&&this.KD.Fac(B);a.Oa(h);this.Ei.k_a();this.D5.MK(X,h,!1);const ma=this.qb.tw(h);ma&&this.qb.ny(X,ma)&&Sd.b(593078098,3017,50,"Custom linked style applied by user");h.kr&&(h=[Object.assign(new aa.a,{name:"Source",string:"ApplyStyle"})],re.a("TOCFormatting",!0,void 0,h));a.dispose();B=F.a.oU(B);v.dr=B>>>16^B&65535;v&&vr.a.tib&&(v.GD|=vr.a.uab(c.node));
return 32}VJm(a,c,h,v,B){a=!0;c.contextId!==ic.a.xc&&(a=!1);if(1===h&&!a)return 2;h=c.node;a=ua.FormattingReader.zr(c);a=ua.FormattingReader.vqa(a);if(this.eKa){if(!B||!h)return r.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",B,h),8;a=a||this.qb.um(h);if(!a)return r.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;B.gJc=dl.a.Ilf(c,a)}else{if(!a)return 2;if(!B)return 8}B.ANa.Zq(a.Fg());return 32}wPj(a,c,h,v,B){if(c.contextId!==ic.a.xc||!kg.a.instance.J(8))return 8;
this.Sf.SXa(c);if(1===h)return 32;a=c.node;if(!B)return 8;const X=this.jaf(B,c.node);if(!X)return this.Kb.ib(Kf.a.XY,{["Reason"]:Ef.a.Tvb}),8;if(1!==this.qb.Gv(X))return 2;h=this.qb.tw(a);if(!h)return this.Kb.ib(Kf.a.XY,{["Reason"]:Ef.a.mkh}),8;if(!h.zg(this.qb.oe(X)))return this.Kb.ib(Kf.a.XY,{["Reason"]:Ef.a.Tvb}),8;const ma=new gf.GraphTransaction(7);try{if(this.ti&&this.ti.isProgressiveStyleEnabled&&this.KD.Fac(B),ma.Oa(a),this.D5.I0f(a,h),this.N0a.u_(c,Pa=>{this.hh.yha(Pa);this.hh.qhb(Pa,X)}),
a.kr){const Pa=[Object.assign(new aa.a,{name:"Source",string:"ApplyStyle"})];re.a("TOCFormatting",!0,void 0,Pa)}}finally{ma&&ma.dispose()}h&&this.qb.ny(X,h)&&Sd.b(593078097,3017,50,"Custom linked style applied by user");B=F.a.oU(B);v.dr=B>>>16^B&65535;v&&vr.a.tib&&(v.GD|=vr.a.uab(c.node));return 32}TJm(a,c,h,v,B){a=!0;c.contextId!==ic.a.Ub&&(a=!1);if(1===h&&!a)return 2;h=this.D5.$gl(c);a=c.node;if(this.eKa){if(!B||!a)return r.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",B,a),
8;h=h||this.qb.um(a);if(!h)return r.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;B.gJc=dl.a.Ilf(c,h)}else{if(!h)return 2;if(!B)return 8}B.ANa.Zq(h.Fg());return 32}uPj(a,c,h,v,B){if(c.contextId!==ic.a.Ub||!kg.a.instance.J(8))return 8;if(this.Sf.SXa(c,!1))return this.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.dC}),8;if(1===h)return 32;var X=c.node;if(!B)return 8;h=this.jaf(B,c.node);if(!h)return this.Kb.ib(Kf.a.XY,{["Reason"]:Ef.a.Tvb}),8;const ma=this.qb.Gv(h);if(1!==ma&&2!==
ma)return 2;(c=this.Ei.O$e(c))?(c=$c.a.eub(c),a=l.AFrameworkApplication.pa.Le(c,a,2,!1,v,B)):(a=new gf.GraphTransaction(7),this.ti&&this.ti.isProgressiveStyleEnabled&&this.KD.Fac(B),a.Oa(X),this.D5.jjn(h,X),a.dispose(),a=32);X.kr&&(c=[Object.assign(new aa.a,{name:"Source",string:"ApplyStyle"})],re.a("TOCFormatting",!0,void 0,c));(X=this.qb.tw(X))&&this.qb.ny(h,X)&&Sd.b(593078096,3017,50,"Custom linked style applied by user");B=F.a.oU(B);v.dr=B>>>16^B&65535;return a}WJm(a,c,h,v,B){if(kg.a.instance.J(8)){const X=
this.A_c.Bka(a,c,h,v,B,null,0);if(2!==X)return X}return this.A_c.Bka(a,c,h,v,B,null,12)}xPj(a,c,h,v,B){const X={};X[this.A_c.gDa]=6168;X[this.A_c.fDa]=6169;let ma=12;if(kg.a.instance.J(8)){if(!c.view.Cd)return 2;var Pa=c.view.Ma,mb=Pa?Pa.If:null;if(!mb)return this.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.noSelection}),8;if(this.uf.dxa(dd.ImageReader.nXa,mb))return this.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.uxc}),8;if(this.uf.J$(sd.ParagraphReader.EO,mb))return this.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.$L}),8;if(this.Sf.f2b(mb,
!1))return this.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.dC}),8;mb=this.qb.lp();if(B&&mb){const Tb=mb.zg(B);if(Tb){const rc=this.qb.r0(Tb,mb);let Tc=this.qb.Gv(Tb);rc&&(Pa=Pa.Ca.J(0),Pa.eC&&Pa.sa.contextId===ic.a.xc||2===Pa.length&&Pa.sa.contextId===ic.a.xc&&Pa.Pb.contextId===ic.a.endOfParagraph)&&(Tc=1,B=rc.getValue(zi.a.EK));1===Tc?ma=0:3===Tc&&(ma=14);!this.qb.ny(Tb,mb)&&this.qb.MR(Tb)&&(Pa=this.qb.oe(Tb),Sd.b(562317522,3017,50,String.format("{0}: style applied by user",Pa)));this.C$(this.BLk,this.CLk)}}}return this.A_c.Bka(a,
c,h,v,B,X,ma)}C$(a,c){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$(c)&&window.setTimeout(()=>{const h=xa.a.instance.za("Common.ISystemInitiatedFeedback");h&&h.execute(v=>{v.logActivity(a,c)})},Tv.Dxa)}jaf(a,c){if(a&&c&&sd.ParagraphReader.tb(c))c=this.qb.tw(c);else return null;return c.zg(a)}get KD(){return this.uL||(this.uL=xa.a.instance.resolve("Box4.IFontStylesGalleryCache"))}}Tv.Dxa=5E3;Object(w.a)(Tv,"StyleActor",null,[]);var fy=b(1738);class Iw{constructor(a){this.ga=a}get Eb(){return this.ga}d0d(a,
c=!1){this.Eb.Le(a,zb.a.lXa,2,!0,null,c)}q5(a){this.Eb.hb(zb.a.q5,2,a)}}Object(w.a)(Iw,"TextFormattingCommands",null,[676]);class fp{constructor(a,c,h,v){this.gEe=this.iJg=!1;this.ga=a;this.qa=c;this.v4a=h;this.ya=v}get dFn(){return this.gEe}eb(){this.ga.Aa(Sa.a.YM,ic.a.view,Object(m.a)(this,this.eFn,"touchStartHandler"),4);this.ga&&this.qa&&(this.qa.$("TouchImageGrippiesResizedIsEnabled")&&(this.ga.Aa(zb.a.QYf,ic.a.view,Object(m.a)(this,this.bGm,"processImageOnTouchSelection"),4),this.ga.Aa(zb.a.SYf,
ic.a.view,Object(m.a)(this,this.aGm,"processImageOnClickSelection"),4)),this.qa.$("HideGrippersWhenPinchingIsEnabled")&&(this.ga.Aa(Sa.a.RKi,ic.a.application,Object(m.a)(this,this.WGm,"processStartPinchToZoom"),4),this.ga.Aa(Sa.a.x_e,ic.a.application,Object(m.a)(this,this.YFm,"processEndPinchToZoom"),4)),Pl.EventHandlerManager.instance.gTm(()=>{this.Vtm()}));Eb.App.oa.Da.Jb&&Eb.App.oa.Da.Jb.Cd&&Eb.App.oa.Da.Jb.aha(()=>{this.x8m()});this.ya&&this.ya.aC(Object(m.a)(this,this.oka,"onProcessSetSelectionFinished"))}hMm(){re.c(zb.a.cFn);
this.gEe=!0}x8m(){const a=window.performance.now();fp.Lqe&&250>a-fp.Lqe&&1E3<a-fp.zsg&&(re.c(zb.a.bFn),fp.zsg=a);this.v4a&&fp.Ua&&fp.Ua.Xt(197)&&this.v4a.showFloatie()}eFn(a,c,h){if(2!==h)return 2;this.iJg||(this.iJg=!0);l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");return 32}bGm(a,c,h,v,B){if(2!==h)return 2;this.$ji(B,!0);return 32}aGm(a,c,h,v,B){if(2!==
h)return 2;this.$ji(B,!1);return 32}WGm(a,c,h){if(2!==h)return 2;if(!this.v4a)return 8;this.v4a.Ful();return 32}YFm(a,c,h){if(2!==h)return 2;if(!this.v4a)return 8;this.v4a.v3m();return 32}bGl(a,c){if(c){var h=null;H.a.lH&&a&&(h=a.getSelection());a=null;h&&"Caret"===h.type&&(a=h.getRangeAt(0))&&this.v4a&&this.v4a.fOn(a.getBoundingClientRect(),c)}}Vtm(){fp.Lqe=window.performance.now()}$ji(a,c){if(a)for(a=a.firstChild;a;){if("SPAN"===a.tagName&&Object(bo.a)(a,fp.Bxl)){for(a=a.firstChild;a;)this.DKj(a,
c),a=a.nextSibling;break}a=a.nextSibling}}DKj(a,c){if(Object(bo.a)(a,fp.BLh)){const h="WACImageResizeHandleTouch"+this.c2k(a);c?a.classList.add(fp.CLh,h):a.classList.remove(fp.CLh,h)}}c2k(a){for(const c of a.className.split(" "))if(c.startsWith("WACImageResizeHandle")&&c!==fp.BLh)return F.a.substring(c,20,c.length);return""}oka(a,c){3===c.wF&&Gc.SelectionEditor.Cl(c.rk.Fa)&&(re.c(zb.a.$En),l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordExtendPageHeightInTouchSettings"),this.gEe=
!0)}static get Ua(){return fp.Na||(fp.Na=xa.a.instance.ra("Box4.IFeatureHelper"))}}fp.BLh="WACImageResizeHandles";fp.CLh="WACImageResizeHandlesTouch";fp.Bxl="WACImgSelection";fp.Lqe=0;fp.zsg=0;fp.Na=null;Object(w.a)(fp,"TouchInputActor",null,[678]);class Ct{get gDa(){return Ln.a.gDa}get fDa(){return Ln.a.fDa}get Ddc(){return Ln.a.Ddc}Bka(a,c,h,v,B,X,ma){return Ln.a.Bka(a,c,h,v,B,X,ma)}C7b(a,c,h,v,B,X){return Ln.a.C7b(a,c,h,v,B,X)}static get instance(){Ct._instance||(Ct._instance=new Ct);return Ct._instance}}
Ct._instance=null;Object(w.a)(Ct,"ViewActionHandlerProxy",null,[677]);class Uv{constructor(a,c){this.kpiName="VisiMarkersUsage";this.d0="wwaengidc";this.UR=new Map;this.ga=a;this.JFe=c}eb(){this.ga.Aa(zb.a.D2d,ic.a.application,Object(m.a)(this,this.Zsn,"showVisiMarks"),1);this.ga.Aa(zb.a.wli,ic.a.application,Object(m.a)(this,this.pJm,"queryShowVisiMarks"),96)}Zsn(a,c,h,v,B){if(1===h)return 32;if(!B)return 2;this.UR.set("Source",Gl.a[this.ga.i4]);this.JFe.VKc?this.UR.set("Action","Removed"):this.UR.set("Action",
"Applied");Fa.Health.instance.recordKpiUsage(this.kpiName,1,this.d0,this.UR);a=document.getElementsByTagName("head")[0];if(!this.JFe.vEn(a))return r.ULS.sendTraceTag(593294045,324,15,"Toggling Formatting markers failed"),8;Eb.App.oa.xE({ShowVisiMarkers:"ToggleButtonModel"});return 32}pJm(a,c,h,v,B){if(1===h)return 32;B[Uf.a.On]=this.JFe.VKc;return 32}}Object(w.a)(Uv,"VisiMarkersActor",null,[]);class st{yb(a){a.ha("Box4.Actors.Box4PasteStewardFactory",()=>new Ap(Vn.a.uxb,a.resolve("Box4.List.IListEditor"),
a.resolve("Box4.List.IListReader"),a.resolve("Box4.Actors.IBox4PasteStewardBridge"))).as("Box4.Actors.IBox4PasteStewardFactory").singleInstance();a.ha("Box4.Actors.Box4PasteStewardUtils",()=>new bx(l.AFrameworkApplication.K.$("WacPasteBrAsNewParagraphIsEnabled"))).as("Box4.Actors.IBox4PasteStewardUtils").singleInstance();a.ha("Box4.Actors.ClipboardActor",()=>new $x.ClipboardActor(a.te("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),Ee.a.instance,a.resolve("Box4.IClipboardDataHelper"),
$c.a.instance,l.AFrameworkApplication.pa,a.resolve("Box4.IUndoManager"),l.AFrameworkApplication.K,nc.FocusManager.instance(),a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),l.AFrameworkApplication.OSf(),l.AFrameworkApplication.dHi())).singleInstance();a.ha("Common.App.ChromeExtensionHelper.IChromeExtensionHelper",()=>new Pr(l.AFrameworkApplication.K)).singleInstance();
a.ha("Box4.Clipboard.ISystemClipboardAccessManagerFactory",()=>new tj(l.AFrameworkApplication.K,a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),Ht.a.instance)).singleInstance();a.ha("Box4.Clipboard.ISystemClipboardAccessManager",()=>a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create()).singleInstance();a.ha("Box4.Actors.ISystemClipboard",()=>new hf(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),ec.InteractiveViewManager.instance,
Eb.App.oa.Da,nc.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),Ht.a.instance,l.AFrameworkApplication.K)).singleInstance();a.ha("Box4.Clipboard.IClipboardOperationCutStrategy",()=>new hv).singleInstance();a.ha("Box4.Actors.IDeleteTableSegmentStrategy",()=>new qp).singleInstance();a.ha("Box4.ISelectionFactory",()=>new ig.a).singleInstance();a.ha("Box4.IRenderOrderGraphIteratorFactory",()=>new ix).singleInstance();a.ha("Common.IDomElementContentStateFactory",
()=>new js).singleInstance();a.ha("Box4.Actors.IClipboardOperationPasteOvertypeStrategy",()=>new ur($c.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IWACStyleReader"),kg.a.instance.J(10))).singleInstance();a.ha("Box4.Actors.PastedContentsPostProcessorHelper",()=>new Nt).singleInstance();a.ha("Box4.Actors.PasteFloatiePositionProvider",()=>new jb($c.a.instance,a.resolve("Box4.ITextMetricsAdapter"),ec.InteractiveViewManager.instance,Ve.a.getElementBounds,a.resolve("Box4.UI.PasteFloatieManager"))).singleInstance();
a.ha("Box4.Actors.PasteFloatieFeatureSetBuilder",()=>new da(a.resolve("Box4.IClipboardDataHelper"),Eb.App.wu.wG)).singleInstance();a.ha("Box4.Actors.PasteFloatieEventManager",()=>new U(a.resolve("Box4.UI.PasteFloatieManager"),a.resolve("Box4.IPasteFloatieEventSource"),ec.InteractiveViewManager.instance,jj.a.instance(),l.AFrameworkApplication.na,a.resolve("Box4.Actors.PasteFloatiePositionProvider"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Eb.App.aj.Pk.Yd(12),
a.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();a.ha("Box4.Actors.IClipboardOperationPasteFactory",()=>new rq(Ee.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),It.a.instance,$c.a.instance,l.AFrameworkApplication.pa,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),a.te("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).singleInstance();
a.ha("Box4.Actors.IClipboardOperationCutCopyFactory",()=>new dx(l.AFrameworkApplication.pa,Ee.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),$c.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),Lu.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),
a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.ra("Box4.IFeatureHelper"))).singleInstance();a.ha("Box4.Actors.IClipboardOperationClipboardAccessHelper",()=>new cx(Ee.a.instance,Ht.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),l.AFrameworkApplication.K.appSettings.ChromeClipboardAccessOperationTimeout)).singleInstance();a.ha("Box4.Actors.IClipboardOperationPasteStrategyFactory",()=>new Kt(l.AFrameworkApplication.K)).singleInstance();
a.ha("Box4.Actors.IClipboardOperationFactory",()=>new Eu(a.resolve("Box4.Actors.InternalClipboard"),l.AFrameworkApplication.pa,l.AFrameworkApplication.KSf(),Ee.a.instance,Lu.a.instance,Ht.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),a.resolve("Box4.ICannotCutDialog"),
a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();a.ha("Box4.Actors.IExternalPasteExecutionManagerFactory",()=>new dy(a.te("Box4.Actors.IBox4PasteStewardFactory"),a.te("Box4.Actors.IBox4ImageStewardFactory"),a.te("Box4.Actors.IBox4TableStewardFactory"),
a.te("Box4.Actors.IBox4WordConverterFactory"),a.te("HtmlImport.IHtmlTranslatorSettings"),a.ra("Box4.IContentControlCopyPasteHelper"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),a.resolve("HtmlImport.IHtmlNormalizerSettings"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.resolve("Box4.Actors.IHtmlNormalizerHelper"))).singleInstance();a.ha("Box4.Actors.InternalClipboard",()=>new dk(a.resolve("Box4.Images.IImageEditor"),a.te("Box4.ITableEditor"),
a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.List.IListEditor"),Eb.App.aj,a.resolve("Box4.IParagraphIndentationReader"),l.AFrameworkApplication.K,a.resolve("Box4.Graph.IGraphNodeFactory"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.ra("Box4.IContentControlCopyPasteHelper"),a.resolve("Box4.ITableCellReader"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").Bzi,a.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();
a.ha("Box4.Actors.IInternalPasteExecutionManagerFactory",()=>new Uz(a.resolve("Box4.Actors.InternalClipboard"),a.ra("Box4.IContentControlCopyPasteHelper"),new qf.a(()=>Eb.App.oa.Da.Jb),a.resolve("Box4.IFormattingPropertyTransitStrategy"))).singleInstance();a.ha("Box4.List.IListCommands",()=>new Bs(l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.Actors.PasteCoordinator",()=>new Cq(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"))).singleInstance();
a.ha("Box4.Actors.Box4ImageStewardFactory",()=>new Ls(a.resolve("Box4.Images.IImageEditor"),l.AFrameworkApplication.Cb,a.resolve("Box4.IUndoManager"),a.ra("Box4.Actors.IImageStewardBridge"),Eb.App.oa.notificationBar,a.ra("Box4.IFeatureHelper"),a.resolve("Common.IAppSettingsManager").$("WordEditorPastePictureFailedImprovementIsEnabled"),a.resolve("Common.IAppSettingsManager").$("NotificationBarImageErrorIsEnabled"),a.resolve("Common.IAppSettingsManager").$("ImageAccessibilityAltTextOnlyIsEnabled"),
a.resolve("Common.IAppSettingsManager").$("LogActionForFailedLocalImagePasteIsEnabled"))).as("Box4.Actors.IBox4ImageStewardFactory").singleInstance();a.ha("Box4.Actors.Box4TableStewardFactory",()=>new Lv(xa.a.instance.resolve("Box4.List.IListEditor"),xa.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").$("PasteComplexTablesIsEnabled"),a.resolve("Common.IAppSettingsManager").$("PasteTableCellMarginImprovementsIsEnabled"))).as("Box4.Actors.IBox4TableStewardFactory").singleInstance();
a.ha("Box4.Actors.ClipboardOperationWordStrategy",()=>new ay(Ee.a.instance,$c.a.instance,Eb.App.lc,li.a.instance,kg.a.instance.J(4))).singleInstance();a.ha("Box4.Actors.Box4WordConverterFactory",()=>new Bw(l.AFrameworkApplication.K)).as("Box4.Actors.IBox4WordConverterFactory").singleInstance();a.ha("Box4.Actors.IExternalPasteCssConverter",()=>new lt(l.AFrameworkApplication.K)).singleInstance();a.ha("Box4.Actors.IHtmlNormalizerHelper",()=>new $y).singleInstance();a.ha("Box4.ISelectionCommands",()=>
new jx(l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.ITextFormattingCommands",()=>new Iw(l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.Actors.AccessibilityActor",()=>new Uh(a.za("Box4.Accessibility.IAccessibilityContextManager"),a.resolve("Box4.Proofing.IErrorRangeEditor"))).singleInstance();a.ha("Box4.Actors.InsertionPointFormatting",()=>new eu(a.ra("Box4.IFontSlotProvider"),a.za("Box4.Actors.IFontNameFormattingStrategy"))).as("Box4.IInsertionPointFormatting").singleInstance();
a.ha("Box4.UI.PasteFloatieManager",()=>new Sy).as("Box4.UI.IFloatieManager").singleInstance();a.ha("Box4.Actors.ProofingActor",()=>new Qu(xa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),l.AFrameworkApplication.pa,()=>xa.a.instance.resolve("Box4.UI.ILanguageDialog"),xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),xa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),$c.a.instance,xa.a.instance.za("Box4.IExternalSelectionManager"),Lu.a.instance,xa.a.instance.resolve("Box4.ISelectionContextMenuProvider"),
li.a.instance,Ee.a.instance,xa.a.instance.resolve("Box4.IContextMenuController"),xa.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),xa.a.instance.za("Box4.Actors.IProofingErrorPresenter"),kg.a.instance,xa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),xa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();a.ha("Box4.Actors.StyleActor",()=>new Tv(xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),xa.a.instance.resolve("Box4.Styles.IWACStyleEditor"),
xa.a.instance.resolve("Box4.IFormattingEditor"),Nm.ContextSetEditor.instance,xa.a.instance.resolve("Box4.IInsertionPointFormatting"),li.a.instance,Ee.a.instance,xa.a.instance.resolve("Box4.TextFormattingHelper"),Ct.instance,xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();a.ha("Box4.Actors.StyleContextMenuActor",()=>new Ju(xa.a.instance.resolve("Box4.IUpdateStyleManager"),xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.Actors.TextFormattingActor",
()=>new fy.a(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.IBox4GraphWriter"),a.ra("Box4.IFontSlotProvider"))).singleInstance();a.ha("Box4.Actors.AutoCorrectActor",()=>new Li(l.AFrameworkApplication.pa,Ee.a.instance,()=>xa.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog"))).singleInstance();a.ha("Box4.Actors.TouchInputActor",()=>new fp(l.AFrameworkApplication.pa,l.AFrameworkApplication.K,bu.GrippersManager.instance,$c.a.instance)).as("Box4.ITouchInputActor").singleInstance();
a.register(cu,"Box4.VisiMarkersOperation").as("Box4.IVisiMarkersOperation").singleInstance();a.ha("Box4.Actors.VisiMarkersActor",()=>new Uv(l.AFrameworkApplication.pa,a.resolve("Box4.IVisiMarkersOperation"))).singleInstance();a.ha("Box4.Actors.IndentationActorExtension",()=>new jl).as("Box4.Actors.IIndentationActorExtension").singleInstance()}}Object(w.a)(st,"Box4ActorsComponentConfiguration",null,[2]);var ox=b(960);const Jw=()=>{const a=Vv;l.AFrameworkApplication.pa.ka(zb.a.hZe,ic.a.embeddedFile,
a);l.AFrameworkApplication.pa.ka(zb.a.hZe,ic.a.IYb,a);l.AFrameworkApplication.pa.ka(zb.a.gZe,ic.a.embeddedFile,Ss);l.AFrameworkApplication.pa.ka(zb.a.gZe,ic.a.IYb,Ss)},Vv=(a,c,h)=>Eb.App.Htd?8:2===h?(a=new oe.StandardDialog,a.yc=4,a.yY(1),a.Nd(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.Nd(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.DTf(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,Rs),32):2,Rs=a=>{1===a&&l.AFrameworkApplication.pa.processAction(zb.a.gZe,
2)},Ss=(a,c,h)=>{if(Eb.App.Htd)return 8;if(1===h)return c.node.hasProperty(Ed.a.embeddedFileContainer)?32:2;if(2===h&&(c.contextId===ic.a.view&&c.view.Ma&&(c=c.view.Ma.If),Ou.isEmbeddedFileOrFloatingEmbeddedFileContext(c))){a=ox.a.d0k(c.node);cb.a.qkn();try{Wv(a)}catch(v){r.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",v)}}return 32},Wv=a=>{Ve.a.Ql(a,void 0,void 0,"EmbeddedFileActor.SaveFile")};var iu=b(699),Xv=b(492),px=b(1439),Kw=b(1595);class ms{constructor(a){this.$S=null;
this.tse=a}get znh(){this.$S||(this.$S=new Kw.a(ms.L3g),this.ZWa(this.$S));return this.$S}ZWa(a){a.gba(1,zb.a.A3);a.gba(3,zb.a.at);a.gba(4,zb.a.at);a.gba(5,zb.a.jla);a.gba(6,zb.a.Ida);a.rTb(this.tse,1)}eb(){const a=l.AFrameworkApplication.pa;a.ka(zb.a.Ida,ic.a.view,Object(m.a)(this,this.Ida,"openMoreColorsDialog"));a.ka(zb.a.GDb,ic.a.view,Object(m.a)(this,this.GDb,"populateFontColor"));a.Qb(zb.a.GDb,1127)}Ida(a,c,h,v,B){if(1===h)return 32;l.AFrameworkApplication.pa.hb(zb.a.QZa,2,B);a=B&&0<=B.fontColor&&
16777215>=B.fontColor?B.fontColor:0;Eb.App.oa.Ty();(new px.a(ms.L3g,zb.a.jla)).qWc(a);return 32}GDb(a,c,h,v,B){if(1===h)return 32;if(2===h&&!B)return 8;a=ms.Kd.aBd(c);c=new iu.a;h=null;32===l.AFrameworkApplication.pa.hb(zb.a.QZa,2,c)&&c&&(h=c.fontColor);v="";h&&!c.NYb&&(v=kn.a.SA(h)||"");this.znh.c$b=v;a=this.znh.Uxd(a,Eb.App.HVb);if(!a)return 8;B.MenuItems=a;r.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened.");return 32}static W0k(){return new ms(Xv.a.instance)}static get instance(){return ms.fj||
(ms.fj=ms.W0k())}static get Kd(){return vg.PageReader.instance}}ms.L3g="Font";ms.fj=null;Object(w.a)(ms,"FontColorActor",null,[]);class tt{constructor(a){this.ga=a}eb(){this.ga.ka(zb.a.xei,ic.a.view,Object(m.a)(this,this.Ida,"openMoreColorsDialog"))}Ida(a,c,h,v,B){if(1===h)return 32;l.AFrameworkApplication.pa.hb(zb.a.QZa,2,B);a=B&&0<=B.highlight&&16777215>=B.highlight?B.highlight:0;Eb.App.oa.Ty();(new px.a("Highlighter",zb.a.a$)).qWc(a);return 32}static K2k(){return new tt(l.AFrameworkApplication.pa)}static get instance(){return tt.fj||
(tt.fj=tt.K2k())}}tt.fj=null;Object(w.a)(tt,"HighlighterColorActor",null,[]);var Fo=b(282),Lw;(function(a){a.Heading="Heading";a.Bookmark="Bookmark";a.Url="Url";a.RecentLinks="RecentLinks"})(Lw||(Lw={}));Object(w.b)("InsertLinkUserActivitySource",Lw);class xh{constructor(a,c,h){this.kmb=this.rf=this.tl=this.Tua=null;this.alc=!1;this.DB=null;this.Od=ec.InteractiveViewManager.instance.rc;this.Tj=a;this.tl=h;this.DB=c;xh.p_&&Gc.SelectionEditor.tj(a)&&(a=Gc.SelectionEditor.WYc(this.Tj),Gc.SelectionEditor.tj(a)?
this.Tj=a:r.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=Gc.SelectionEditor.rIb(this.Tj);Gc.SelectionEditor.tj(a)&&(this.Tj=a)}get Pqa(){return this.Tua||(this.Tua=xa.a.instance.ra("Box4.IInternalLinkManager"))}get Xj(){return this.rf||(this.rf=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}Gjf(){return null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertInternalLinkIsEnable",
!1)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get nNh(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}Kjh(a,c,h){if(c!==this.Tj.cpEnd||a!==this.Tj.cpBegin)a=ne.SelectionFactory.bO(h,a,c),this.Od.Ma.setSelection(a),this.Tj=Gc.SelectionEditor.rIb(a.sa.clone())}Hth(a){const c=ch.HyperlinkReader.K_b(this.Tj);let h=this.Tj.cpBegin,v=this.Tj.cpEnd,B="";if(!c.length)return this.kmb=a.substring(this.Tj.cpBegin,this.Tj.cpEnd),{returnValue:!0,l_d:B,Nvd:h,Ovd:v,BFd:c};if(c[0].hyperlink){let X=
0,ma=0,Pa=Math.max(0,a.length-1),mb=0;for(let Tb=0;Tb<c.length;Tb++)c[Tb].cpBegin>=ma&&({cpBegin:X,cpEnd:ma}=xh.jK.q8(this.Tj,c[Tb],X,ma),Pa=Math.min(X,Pa),mb=Math.max(ma,mb));h=Math.min(Pa,h);v=Math.max(mb,v);this.kmb=a.substring(h,v);h===Pa&&(B=c[0].hyperlink.url);return{returnValue:!0,l_d:B,Nvd:h,Ovd:v,BFd:c}}return{returnValue:!1,l_d:B,Nvd:h,Ovd:v,BFd:c}}jZf(a){kg.a.instance.J(3)&&xh.hd.iZf(a)}JGd(a,c){if(this.Od.jr){var h=ch.HyperlinkReader.K_b(this.Tj);var v=this.Od.Ma.Ca.Fa;if(v){v=v.sa;sd.ParagraphReader.Wk(v)&&
(v=Oe.a.createTextRange(v.node,0,sd.ParagraphReader.textLength(v.node)));if(xh.p_&&Gc.SelectionEditor.tj(v)){var B=Gc.SelectionEditor.WYc(v);Gc.SelectionEditor.tj(B)?v=B:r.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}B=Gc.SelectionEditor.rIb(v);Gc.SelectionEditor.tj(B)&&(v=B);if(0!==a&&32===l.AFrameworkApplication.pa.Le(v,zb.a.insertHyperlink,1,!0,null,null)&&this.Tj.equals(v)){bh.a.mark(5562);kg.a.instance.J(4)&&
Eb.App.lc&&Eb.App.lc.$n&&this.Od.Ma.SSb();a=new gf.GraphTransaction(15);a.Oa(this.Tj.node);this.Tj.node.sF().UD.D7(4);v=c.txtDisplay;B=!1;if(this.Gjf()&&null!=c.linkurl)if(B=!0,c.isHeading){k(this.DB,"Heading");const X=c.paragraphNode,ma=c.startCp,Pa=c.endCp;c=this.tl.Pqh(X);this.tl.$Sb(c,ma,Pa,X,X,!1)}else k(this.DB,"Bookmark"),c=c.linkurl;else k(this.DB,"Url"),c=c.txtLink.trim();this.insertLink(v,c,h,B);a.ql=zb.a.insertHyperlink;a.dispose();bh.a.mark(5563);this.Tj.node.Ivb();this.SQ()}else this.Od.BS()}else r.ULS.sendTraceTag(41522314,
324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}MPi(a,c,h,v,B,X=!1){v?(v=Oe.a.createTextRange(this.Tj.node,this.Tj.cpBegin,this.Tj.cpBegin+a.length),xh.hyperlinkEditor.hgh(v,h,c),a=ne.SelectionFactory.vd(this.Tj.node,this.Tj.cpBegin+a.length)):(xh.hyperlinkEditor.Aeb(this.Tj,2),this.Xj.nhb(this.Tj,2),h=Oe.a.Sb(this.Tj.node,this.Tj.cpEnd),xh.characterPropertiesEditor.replaceTextRange(h,a,!0),v=Oe.a.createTextRange(this.Tj.node,this.Tj.cpEnd,this.Tj.cpEnd+a.length),xh.hyperlinkEditor.BG(v,
c,B,!1,!0,X),a=ne.SelectionFactory.vd(this.Tj.node,this.Tj.cpEnd+a.length));a&&this.Od.Ma.setSelection(a)}insertLink(a,c,h,v=!1){var B=null;a||(a=c,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RemoveLinkUrlLineBreak",!0)&&(a=a.replace(/[\r\n\v]/g,"")));if(c&&(!h.length||c!==h[0].hyperlink.url)&&!v){c=ch.HyperlinkReader.iJa(c);var X="";this.Pqa&&({yJf:X}=this.Pqa.qZf(c)).returnValue&&(c=X)}this.alc||(a=xh.hyperlinkEditor.d0m(a));let ma=!1;X=!1;if(c){var Pa=0<h.length;
B=!0;xh.rNl&&(B=sd.ParagraphReader.text(this.Tj.node).substring(this.Tj.cpBegin,this.Tj.cpEnd)!==a);if(xh.hd.Bf&&1===h.length&&!h[0].hyperlink.aE&&!(h[0].cpBegin>this.Tj.cpBegin&&h[0].cpEnd<=this.Tj.cpEnd)){this.MPi(a,c,h[0].hyperlink,!B,Pa,v);return}if(Pa)for(var mb=0;mb<h.length;mb++)h[mb].hyperlink.aE&&(X=!0),xh.hyperlinkEditor.jP(this.Tj.node,h[mb].hyperlink,!1);B&&xh.characterPropertiesEditor.replaceTextRange(this.Tj,a,!X);B||!xh.hd.Bf||X||this.Xj.nhb(this.Tj,1);h=Oe.a.createTextRange(this.Tj.node,
this.Tj.cpBegin,this.Tj.cpBegin+a.length);xh.hyperlinkEditor.BG(h,c,Pa,X,!0,v);B=ne.SelectionFactory.vd(this.Tj.node,this.Tj.cpBegin+a.length)}else if(0<h.length){v=h[0];const Tb=({cpBegin:Pa,cpEnd:mb}=xh.jK.q8(this.Tj,v,Pa,mb)).returnValue;v.hyperlink.aE&&(X=!0);c?v.hyperlink.vbb?(c!==v.hyperlink.url&&(xh.hd.Bf&&!X?(h=Oe.a.createTextRange(this.Tj.node,Pa,Pa+a.length),xh.hyperlinkEditor.hgh(h,v.hyperlink,c)):xh.jK.vOn(c,Tb)),a!==this.kmb&&(xh.characterPropertiesEditor.replaceTextRange(Oe.a.createTextRange(this.Tj.node,
Pa,mb),a,!0),c=Oe.a.createTextRange(this.Tj.node,Pa,Pa+a.length),this.jZf(c),B=ne.SelectionFactory.vd(this.Tj.node,Pa+a.length),ma=!0)):xh.hd.Bf&&!X?(Pa=sd.ParagraphReader.text(this.Tj.node).substring(this.Tj.cpBegin,this.Tj.cpEnd)===a,this.MPi(a,c,h[0].hyperlink,Pa,!1)):(xh.jK.aKf(this.Tj,Tb),xh.characterPropertiesEditor.replaceTextRange(Oe.a.createTextRange(this.Tj.node,Pa,mb),a,!X),h=Oe.a.createTextRange(this.Tj.node,Pa,Pa+a.length),xh.hyperlinkEditor.BG(h,c,!1,X),B=ne.SelectionFactory.vd(this.Tj.node,
Pa+a.length)):xh.hyperlinkEditor.jP(v.paragraph,v.hyperlink)}(ma||X)&&xh.hd.Xq(X?2:7);B&&this.Od.Ma.setSelection(B);Eb.App.DGn()}static get hyperlinkEditor(){return xh.Oi||(xh.Oi=xa.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return xh.Tb||(xh.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hd(){return xh.Bb||(xh.Bb=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get jK(){return xh.sT||(xh.sT=xa.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get rNl(){null==
xh.One&&(xh.One=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("KeepHyperlinkFormatFixIsEnabled"):!1);return xh.One}static get Szb(){null==xh.onb&&(xh.onb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return xh.onb}static get p_(){null==xh.KS&&(xh.KS=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return xh.KS}}xh.Oi=null;xh.Tb=null;xh.Bb=null;xh.sT=null;xh.One=null;xh.onb=null;xh.KS=null;
xh.source="Source";xh.b4g="CommandingInterface";xh.dvb="DisplayText";xh.url="Url";xh.id="InsertLinkDialog";Object(w.a)(xh,"AInsertLinkDialog",null,[14]);class Uq{static get vf(){return gg.a.fy(Uq.ll,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}Uq.ll="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(w.a)(Uq,"InsertLinkDialogHtml",null,[]);class ju extends xh{constructor(a,c){super(a,c);this.rd=new gg.a;this.rd.jf=xh.id;let h=this.kmb="";var v=sd.ParagraphReader.text(this.Tj.node);let B=this.Tj.cpBegin,X=this.Tj.cpEnd;({l_d:h,Nvd:B,Ovd:X,BFd:v}=this.Hth(v));(c="object"===typeof c?c:null)&&(c[xh.source]&&c[xh.source]===xh.b4g||c[xh.url]&&c[xh.dvb])?this.insertLink(c[xh.dvb],c[xh.url],v):(v[0]&&this.Kjh(B,X,v[0].paragraph),this.rd.vf=Uq.vf,""===h.trim()&&this.rd.Nd(1,this.nNh),c={["txtLink"]:h,
["txtDisplay"]:this.kmb},this.rd.ztd=Object(m.a)(this,this.CU,"dialogDefaultEnterKeyHandler"),this.rd.ytd=Object(m.a)(this,this.CU,"dialogDefaultEnterKeyHandler"),this.rd.Tg(this.titleText,Object(m.a)(this,this.JGd,"insertLinkDialogHandler"),c),xh.Szb&&(c=document.getElementById("txtLink"),Ld.a.addHandler(c,Jb.a.input,Object(m.a)(this,this.kZa,"onLinkChanged")),Ld.a.addHandler(c,Jb.a.change,Object(m.a)(this,this.kZa,"onLinkChanged"))),document.getElementById("txtLink").focus(),xh.p_?0<ac.g(Oe.a.dM(B,
X,!1,this.Tj.node)).length&&(this.alc=!0,document.getElementById("txtDisplay").disabled=!0):1>=v.length&&xh.jK.Z5g(a,v[0],1===v.length)&&(this.alc=!0,document.getElementById("txtDisplay").disabled=!0))}kZa(){if(this.rd){const a=document.getElementById("txtLink");this.rd.tea(1,!a||!a.value.length||ch.HyperlinkReader.CKa(a.value))}}CU(a){return this.rd?xh.Szb?this.rd.arh(this.rd.LLb)?this.rd.CU(a):!1:this.rd.CU(a):!1}SQ(){if(xh.Szb){const a=document.getElementById("txtLink");a&&(Ld.a.removeHandler(a,
Jb.a.change,Object(m.a)(this,this.kZa,"onLinkChanged")),Ld.a.removeHandler(a,Jb.a.input,Object(m.a)(this,this.kZa,"onLinkChanged")))}this.rd&&(this.rd=null)}}Object(w.a)(ju,"InsertLinkDialog",xh,[]);class Ru{constructor(a,c,h,v,B){this.linkurl=a;this.isHeading=c;this.startCp=h;this.endCp=v;this.paragraphNode=B}}Object(w.a)(Ru,"HeadingDataForLinkDialog",null,[]);class qv{constructor(a,c){this.linkurl=a;this.isHeading=c}}Object(w.a)(qv,"BookmarkDataForLinkDialog",null,[]);class Mw{constructor(a,c,h,
v,B,X){this.key=a;this.name=c;this.startIndex=h;this.count=v;this.level=B;this.isCollapsed=X}}Object(w.a)(Mw,"GroupHeaderDataForLinkDialog",null,[]);class Yv{constructor(a,c){this.selectedIndex=a;this.selectedGroupId=c}}Object(w.a)(Yv,"SelectedItemFromLinkDialogGroupedList",null,[]);class Su extends xh{constructor(a,c,h,v,B){super(a,c,v);this.Rge=h;this.Me=B;const X=new gg.a(!1,!1,!0);h={};h.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;h.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
l.AFrameworkApplication.Mg("InsertInternalLinkIsEnable;InsertInternalLinkIsEnablecf");this.Gjf()&&(h.insertInternalLinkEnabled=!0,h.enterLinkTabLabel=Box4Intl.Box4Strings.l_EnterLinkText,h.thisDocumentTabLabel=Box4Intl.Box4Strings.l_ThisDocumentText,h.groupedList=this.V1k());var ma=this.kmb="";ma=sd.ParagraphReader.text(this.Tj.node);v=this.Tj.cpBegin;B=this.Tj.cpEnd;let Pa;({l_d:ma,Nvd:v,Ovd:B,BFd:Pa}=this.Hth(ma));if((c="object"===typeof c?c:null)&&(c[xh.source]&&c[xh.source]===xh.b4g||c[xh.url]&&
c[xh.dvb]))this.insertLink(c[xh.dvb],c[xh.url],Pa);else{Pa[0]&&this.Kjh(v,B,Pa[0].paragraph);c=CommonUIStrings.l_DialogOk;""===ma.trim()&&(c=this.nNh);X.Nd(1,c);this.Gjf()&&ma&&ma.startsWith(F.a.s8a)?(c=this.afl(ma,h.groupedList))?h.groupedList.selectedItem=c:h.txtLink=ma:h.txtLink=ma;h.txtDisplay=this.kmb;xh.p_?0<ac.g(Oe.a.dM(v,B,!1,this.Tj.node)).length&&(this.alc=!0,h.textDisplayDisabled=!0):1>=Pa.length&&xh.jK.Z5g(a,Pa[0],1===Pa.length)&&(this.alc=!0,h.textDisplayDisabled=!0);var mb={["id"]:xh.id,
["bodyControls"]:h};this.Me.$c(()=>{X.Tg(this.titleText,Object(m.a)(this,this.JGd,"insertLinkDialogHandler"),mb)},"RILD:IAS")}}afl(a,c){c=c.items;const h=a.substring(F.a.s8a.length),v=this.tl.R9e(h);a=-1;let B=0;for(let X=0;X<c.length;X++)if(c[X].isHeading&&0!=v.count&&c[X].paragraphNode.id==v.J(0).id){a=X;break}else if(!c[X].isHeading&&c[X].linkurl==h){a=X;B=1;break}c=new Yv(a,B);return-1!=a?c:null}V1k(){const a={};let c=[],h=0,v=0;var B=this.Rge.Mvh();null!=B&&(h=B.count,c=c.concat(this.x2k(B)));
B=this.tl.yCc(!1);null!=B&&(v=B.count,c=c.concat(this.eTk(B)));a.groups=this.p2k(h,v);a.items=c;return a}p2k(a,c){const h=[];let v=new Mw("ThisDocumentTabHeadings",Box4Intl.Box4Strings.l_InsertLinkHeadings,0,a,0,!0);h.push(v);a=new Mw("ThisDocumentTabBookmarks",Box4Intl.Box4Strings.l_InsertLinkBookmarks,a,c,0,!0);h.push(a);return h}x2k(a){const c=[];for(const h of a)a=new Ru(h.characterData,!0,h.begin,h.end,h.paragraphNode),c.push(a);return c}eTk(a){const c=[];for(const h of a)a=h.pg(Yb.a.Vr).toString(),
a=new qv(a,!1),c.push(a);return c}SQ(){}}Object(w.a)(Su,"ReactInsertLinkDialog",xh,[]);class Ts{constructor(){this.una=!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.fA}o9g(a,c,h,v){this.una?new Su(a,c,h,v,Fo.a.instance):new ju(a,c)}static get instance(){return Ts._instance||(Ts._instance=new Ts)}}Ts._instance=null;Object(w.a)(Ts,"InsertLinkDialogFactory",null,[683]);class Xn extends gg.a{constructor(a){super();this.BQ=a;this.Od=ec.InteractiveViewManager.instance.rc;this.Cs=this.Od.Ma.Ca.Fa;
this.s2e=a[0].cpBegin;this.Jnf=a[a.length-1].cpEnd;this.jf="InsertMultiParagraphLinkDialog";a=this.ENn();this.showDialog("",a)}showDialog(a,c){r.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.vf=Uq.vf;""===c.trim()&&this.Nd(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:c,["txtDisplay"]:a};this.Tg(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(m.a)(this,this.JGd,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=
!0;Xn.Szb&&(a=document.getElementById("txtLink"),Ld.a.addHandler(a,Jb.a.input,Object(m.a)(this,this.kZa,"onLinkChanged")),Ld.a.addHandler(a,Jb.a.change,Object(m.a)(this,this.kZa,"onLinkChanged")))}hide(){if(Xn.Szb){const a=document.getElementById("txtLink");a&&(Ld.a.removeHandler(a,Jb.a.change,Object(m.a)(this,this.kZa,"onLinkChanged")),Ld.a.removeHandler(a,Jb.a.input,Object(m.a)(this,this.kZa,"onLinkChanged")))}super.hide()}kZa(){const a=document.getElementById("txtLink");this.tea(1,!a||!a.value.length||
ch.HyperlinkReader.CKa(a.value))}CU(a){return Xn.Szb?this.arh(this.LLb)?super.CU(a):!1:super.CU(a)}ENn(){let a,c;var h="";const v=this.BQ.length;var B=ch.HyperlinkReader.aB(this.BQ[0],!1);0<B.length&&({cpBegin:a,cpEnd:c}=Xn.jK.q8(this.BQ[0],B[0],a,c),a<=this.BQ[0].cpBegin&&(h=B[0].hyperlink.url),this.s2e=Math.min(this.s2e,a));B=ch.HyperlinkReader.aB(this.BQ[v-1],!1);0<B.length&&({cpBegin:a,cpEnd:c}=Xn.jK.q8(this.BQ[v-1],B[B.length-1],a,c),this.Jnf=Math.max(this.Jnf,c));this.iHn(this.s2e,this.Jnf);
return h}iHn(a,c){const h=this.BQ.length;if(a!==this.BQ[0].cpBegin||c!==this.BQ[h-1].cpEnd){a=Oe.a.Sb(this.BQ[0].node,a);a=ne.SelectionFactory.yn(a);c=Oe.a.Sb(this.BQ[h-1].node,c);c=ne.SelectionFactory.jC(a,c);a=this.zEh(c.sa.clone());const v=this.zEh(c.Pb.clone());a&&v&&(this.BQ[0]=a,this.BQ[h-1]=v,this.Od.Ma.setSelection(c),this.Cs=c)}}JGd(a,c){if(this.Od.jr){var h=this.Od.Ma.Ca.Fa;if(h)if(h.equals(this.Cs)&&0!==a){a=new gf.GraphTransaction(15);a.Oa(this.BQ[0].node);for(h=0;h<this.BQ.length;h++)this.BQ[h].node.sF().UD.D7(4);
h=c.txtLink.trim();c=this.Jqk();h=this.ZCl(h);(c||h)&&Xn.hd.Xq(7);this.hide();a.dispose()}else this.Od.BS()}}ZCl(a){if(!a)return!1;a=ch.HyperlinkReader.iJa(a);for(let h=0;h<this.BQ.length;h++){var c=this.BQ[h];if(Xn.p_&&Gc.SelectionEditor.tj(c)&&(c=Gc.SelectionEditor.WYc(c),!Gc.SelectionEditor.tj(c)))continue;c=Oe.a.createTextRange(this.BQ[h].node,c.cpBegin,c.cpEnd);this.jZf(c);Xn.hyperlinkEditor.BG(c,a,!1)}return!0}jZf(a){kg.a.instance.J(3)&&Xn.hd.iZf(a)}zEh(a){return sd.ParagraphReader.Wk(a)&&!Gc.SelectionEditor.l4(a)&&
sd.ParagraphReader.textLength(a.node)?Oe.a.createTextRange(a.node,0,sd.ParagraphReader.textLength(a.node)):Gc.SelectionEditor.tj(a)?a:null}Jqk(){let a=!1;for(const c of this.BQ){const h=ch.HyperlinkReader.aB(c,!1);h&&(a=Xn.jK.aKf(c,h)||a)}return a}static get jK(){return Xn.sT||(Xn.sT=xa.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get hd(){return Xn.Bb||(Xn.Bb=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return Xn.Oi||(Xn.Oi=
xa.a.instance.resolve("Box4.IHyperlinkEditor"))}static get p_(){null==Xn.KS&&(Xn.KS=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Xn.KS}static get Szb(){null==Xn.onb&&(Xn.onb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("HyperlinkUrlValidationIsEnabled"):!1);return Xn.onb}}Xn.sT=null;Xn.Bb=null;Xn.Oi=null;Xn.KS=null;Xn.onb=null;Object(w.a)(Xn,"InsertMultiParagraphLinkDialog",gg.a,[]);class Ge{static get bookmarkManager(){return Ge.tl||
(Ge.tl=xa.a.instance.te("WordEditor.Bookmark.FullBookmarkManager").value)}static get BXb(){return Ge.Mma||(Ge.Mma=xa.a.instance.te("WordEditor.TableOfContents.StyleBasedDocumentHeadings").value)}static get Sf(){return li.a.instance}static get lpa(){return Ge.W$||(Ge.W$=xa.a.instance.ra("Box4.IContentControlChpHelper"))}static get jK(){return Ge.sT||(Ge.sT=xa.a.instance.resolve("Box4.IHyperlinkStrategy"))}static gv(){return Ge.vl||(Ge.vl=xa.a.instance.za("Box4.IExternalSelectionManager"))}static get hd(){return Ge.Bb||
(Ge.Bb=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Wg(){return Ge.zq||(Ge.zq=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get uf(){return Nm.ContextSetEditor.instance}static get Kb(){return Ee.a.instance}static get qNc(){null==Ge.Sjb&&(Ge.Sjb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Ge.Sjb}static get p_(){null==Ge.KS&&(Ge.KS=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Ge.KS}static get hyperlinkEditor(){return Ge.Oi||(Ge.Oi=xa.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return Ge.Tb||(Ge.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get cKc(){Ge.W9c||(l.AFrameworkApplication.K?(l.AFrameworkApplication.Mg("recentLinks;recentLinkscf"),Ge.W9c=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",
!1)):Ge.W9c=!1);return Ge.W9c}static get lDn(){Ge.KIg||(Ge.KIg=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.timeInMillisBetweenTwoMRUCalls",6E4):6E4);return Ge.KIg}static eb(){const a=l.AFrameworkApplication.pa;a.ka(zb.a.insertHyperlink,ic.a.view,Ge.V0b);a.ka(zb.a.insertHyperlink,ic.a.Ub,Ge.insertLink);a.ka(zb.a.insertHyperlink,ic.a.xc,Ge.insertLink);a.Qb(zb.a.insertHyperlink,1028);a.ka(zb.a.jP,ic.a.view,Ge.V0b);a.ka(zb.a.jP,ic.a.Ub,Ge.Bqi);a.ka(zb.a.jP,
ic.a.xc,Ge.Bqi);a.Qb(zb.a.jP,1028);a.ka(zb.a.e_d,ic.a.view,Ge.V0b);a.ka(zb.a.e_d,ic.a.Ub,Ge.Ayi);a.ka(zb.a.e_d,ic.a.xc,Ge.Ayi);a.ka(zb.a.ELa,ic.a.view,Ge.V0b);a.ka(zb.a.ELa,ic.a.Ub,Ge.Aei);a.ka(zb.a.ELa,ic.a.xc,Ge.Aei);a.ka(zb.a.ELa,ic.a.image,Ge.qBf);a.ka(zb.a.ELa,ic.a.gwb,Ge.qBf);kg.a.instance.J(5)&&a.ka(zb.a.ELa,ic.a.anchoredObject,Ge.qBf);a.ka(zb.a.erd,ic.a.view,Ge.V0b);Ge.cKc&&(a.Aa(Sa.a.XZa,ic.a.view,this.V0b.bind(this),1028),a.ka(Sa.a.XZa,ic.a.Ub,this.XZa.bind(this)),a.ka(Sa.a.XZa,ic.a.xc,
this.XZa.bind(this)),a.Qb(Sa.a.XZa,1028),a.ka(Sa.a.pgf,ic.a.Ub,this.XZa.bind(this)),a.ka(Sa.a.pgf,ic.a.xc,this.XZa.bind(this)),a.Qb(Sa.a.pgf,1028),a.ka(Sa.a.fEf,ic.a.view,this.fEf.bind(this)),a.ka(Sa.a.$Df,ic.a.view,this.$Df.bind(this)),a.Aa(Sa.a.fcb,ic.a.Ub,this.fcb.bind(this),1028),a.Aa(Sa.a.fcb,ic.a.xc,this.fcb.bind(this),1028))}static XZa(a,c){if(!Ge.cKc)return 2;a=Ge.KXi(c);return 32!=a?a:!Ge.BKa(c,!0,null).returnValue||Ge.ZVb(c)?8:32}static fEf(a,c,h,v,B){if(!Ge.cKc)return 2;if(1===h)return 32;
Ge.qXd(Ge.Hqj,Ge.Iqj,Ge.NBg);Fo.a.instance.$c(()=>{Ge.w0f();B.MenuItems=Object.assign(new Ah.a,{Id:"RecentLinksList",MenuSectionList:[],UpdateDynamically:!0});const X=this.i$g();X?(r.ULS.sendTraceTag(526242130,324,50,"Recent Links data load success in ribbon"),Array.add(B.MenuItems.MenuSectionList,X)):Ge.hii(B,Ge.NBg)},"HA:PRLF");return 32}static $Df(a,c,h,v,B){if(!Ge.cKc)return 2;if(1===h)return 32;Ge.qXd(Ge.Fqj,Ge.Gqj,Ge.MBg);Fo.a.instance.$c(()=>{Ge.w0f();B.MenuItems=Object.assign(new Ah.a,{Id:"InsertLinkFlyoutList",
MenuSectionList:[],UpdateDynamically:!0});Array.add(B.MenuItems.MenuSectionList,this.Mik());const X=this.i$g(!0);X?(r.ULS.sendTraceTag(526242132,324,50,"Recent Links data load success in context menu"),Array.add(B.MenuItems.MenuSectionList,X)):Ge.hii(B,Ge.MBg)},"HA:PILF");return 32}static hii(a,c){r.ULS.sendTraceTag(524911777,324,50,"Recent Links could not load in "+c);Ge.qXd(Ge.snj,Ge.tnj,c);Array.add(a.MenuItems.MenuSectionList,this.dlk());Ge.w0f(!0)}static dlk(){const a=this.EUe("RecentLinksNoDataSection",
!1);Array.add(a.ControlList,Object.assign(new qh.a,{ExternalId:"RecentLinksNoDataSection",LabelText:"No links available right now"}));return a}static Mik(){const a=this.EUe("InsertLinkSection");Array.add(a.ControlList,Object.assign(new qh.a,{ExternalId:"InsertLink"}));return a}static i$g(a=!1){if(aj.instance.hed){var c=this.EUe("RecentLinksSection",a);a=JSON.parse(aj.instance.hed);this.Ixe.clear();a.forEach(h=>{this.Ixe.set(h.DocumentUrl,h.FileName);const v=Ge.Ncl(h.FileName);var B=Ge.t1k(h.TimeStamp),
X=Array,ma=X.add,Pa=c.ControlList,mb=Object,Tb=mb.assign,rc=new qh.a,Tc=h.DocumentUrl,vd=Sa.a.fcb,ee=Sa.a.fcb;B=v!==h.FileName?h.FileName+"\n"+B:B;var Ie=h.FileName;let Xe="SaveAsWordDocx_32";switch(h.App){case "Word":Xe="SaveAsWordDocx_32";break;case "PowerPoint":Xe="SaveAsPowerPointPptx_32";break;case "Excel":Xe="SaveAsExcelXlsx_32"}ma.call(X,Pa,Tb.call(mb,rc,{ExternalId:Tc,Command:vd,CommandValueId:ee,LabelText:v,Alt:B,AriaDescription:Ie,ExternalImageId:Xe,KeyTip:h.FileName}))});return c}}static EUe(a,
c=!1){return Object.assign(new Hg.a,{Title:c?"Recent Links":"",Id:a,DisplayMode:"Menu",ShowMenuSectionSeparator:!1,ControlsId:"Ctrl_"+a,ControlList:[]})}static fcb(a,c,h,v,B){if(!Ge.cKc)return 2;if(!B||B.CommandValueId!=Sa.a.fcb)return 32;Ge.qXd(Ge.fij,Ge.gij,Ge.Urj);h=c;c=new gf.GraphTransaction(15);c.ql=a;c.Oa(h.node);v=Ge.BKa(h,!0,null).hyperlink;h=Gc.SelectionEditor.rIb(h);if(v)Ge.pKf(h),a=ne.SelectionFactory.bO(h.node,Math.min(h.cpBegin,v.cpBegin),Math.max(h.cpEnd,v.cpEnd)),$c.a.instance.setSelection(a),
h=a.sa;else if(Gc.SelectionEditor.ke(h)){var X;Gc.SelectionEditor.gdb(h)&&(X=Gc.SelectionEditor.a0(h,!1));X||(X=this.Ixe.get(B.SourceControlId),Ge.characterPropertiesEditor.replaceTextRange(h,X,!0,void 0,a),X=ne.SelectionFactory.bO(h.node,h.cpBegin,h.cpBegin+X.length));if(X&&($c.a.instance.setSelection(X),h=X.sa,Ge.ZVb(h)))return Ge.hd.QGb(!1),8}try{Ge.hyperlinkEditor.BG(h,B.SourceControlId,0<ch.HyperlinkReader.K_b(h).length);const ma=ne.SelectionFactory.vd(h.node,h.cpEnd);ma&&$c.a.instance.setSelection(ma);
k(B,"RecentLinks")}finally{c&&c.dispose()}r.ULS.sendTraceTag(526242134,324,50,"Recent Links inserted");return 32}static V0b(a,c,h,v,B){if(Ge.qNc)return Ge.vwl(a,c,h,v,B);if(!c.view.Cd)return 2;var X=c.view.Ma;if(!X||!X.Ca||!X.Ca.length)return 8;var ma=X.Ca.Fa;let Pa=ma.sa.clone();if(2===ma.length){if(ma=ma.J(1),!Gc.SelectionEditor.tj(Pa)||!Gc.SelectionEditor.mj(ma)||Pa.node!==ma.node)return 8}else if(2<ma.length)return 8;if(X.Ca.VG)return 8;if(Ge.uf.J$(sd.ParagraphReader.EO,X.If))return Ge.Kb.ib(Kf.a.re,
{["Reason"]:Ef.a.$L}),8;sd.ParagraphReader.Wk(Pa)&&!Gc.SelectionEditor.l4(Pa)&&(X=Pa.node,Pa=Oe.a.createTextRange(X,0,sd.ParagraphReader.textLength(X)));return a===zb.a.erd?Ge.z7g(c,Pa,h,v):l.AFrameworkApplication.pa.Le(Pa,a,h,!0,v,B)}static vwl(a,c,h,v,B){if(!c.view.Cd)return 2;var X=c.view.Ma;if(!X||!X.Ca||!X.Ca.length||X.Ca.VG)return 8;var ma=X.Ca.Fa;if(X=Ge.Xlf(ma))ma=Ge.Jaf(ma.sa.clone(),!0);else{let Pa=ma.J(0).clone(),mb=1;for(;mb<ma.length&&(!sd.ParagraphReader.textLength(Pa.node)||Gc.SelectionEditor.mj(Pa)||
Ge.p_&&ac.l(Pa));)Pa=ma.J(mb).clone(),mb++;ma=Ge.Jaf(Pa,!1)}return Ge.p_&&Gc.SelectionEditor.tj(ma)&&ac.l(ma)||!Gc.SelectionEditor.tj(ma)&&!X?8:a===zb.a.erd?Ge.z7g(c,ma,h,v):l.AFrameworkApplication.pa.Le(ma,a,h,!0,v,B)}static Xlf(a){if(1===a.length)return!0;if(2===a.length){const c=a.sa.clone();a=a.J(1);return Gc.SelectionEditor.tj(c)&&Gc.SelectionEditor.mj(a)&&c.node===a.node?!0:!1}return!1}static $4g(a,c){a=null;const h=[];for(let v=0;v<c.length;v++){const B=Ge.Jaf(c.J(v).clone(),!1);if(Gc.SelectionEditor.tj(B))Ge.p_&&
ac.l(B)||h.push(B);else if(!Gc.SelectionEditor.mj(B)&&!sd.ParagraphReader.Wk(B))return{returnValue:!1,m9a:a}}a=h;return{returnValue:!Ge.p_||0<a.length?!0:!1,m9a:a}}static insertLink(a,c,h,v,B){if(Ge.qNc)return Ge.fDl(c,h,B);a=Ge.KXi(c);if(32!==a)return a;let X;if(!({hyperlink:X}=Ge.BKa(c,!0,X)).returnValue||Ge.ZVb(c))return 8;if(1===h)return 32;if(!X&&Gc.SelectionEditor.ke(c)&&Gc.SelectionEditor.gdb(c)&&(h=Gc.SelectionEditor.a0(c,!1))&&($c.a.instance.setSelection(h),c=h.sa,Ge.ZVb(c)))return Ge.hd.QGb(!1),
8;X&&r.ULS.sendTraceTag(593875799,324,50,"Edit link");Ts.instance.o9g(c,B,Ge.BXb,Ge.bookmarkManager);return 32}static KXi(a){return!Ge.rOe()||!Ge.fod(a)||a.node.kr||$c.a.instance.Ca.VG?8:kg.a.instance.J(5)&&Gc.SelectionEditor.S8(a)?2:32}static fDl(a,c,h){var v=$c.a.instance.Ca.Fa;const B=Ge.Xlf(v);let X;if(B)X=[a];else if(!({m9a:X}=Ge.$4g(X,v)).returnValue)return 8;if(!Ge.rOe())return 8;for(a=0;a<X.length;a++)if(!Ge.fod(X[a]))return 8;if($c.a.instance.Ca.VG)return 8;a=Array(X.length);v=null;for(let ma=
0;ma<X.length;ma++)if(a[ma]=X[ma],!({hyperlink:v}=Ge.BKa(a[ma],!0,v)).returnValue||Ge.ZVb(a[ma]))return 8;if(1===c)return 32;if(!v&&1===a.length&&B&&Gc.SelectionEditor.ke(a[0])&&Gc.SelectionEditor.gdb(a[0])&&(c=Gc.SelectionEditor.a0(a[0],!1))&&($c.a.instance.setSelection(c),a[0]=c.sa,Ge.ZVb(a[0])))return Ge.hd.QGb(!1),8;B?Ts.instance.o9g(a[0],h,Ge.BXb,Ge.bookmarkManager):new Xn(a,h);return 32}static Bqi(a,c,h){if(Ge.qNc)return Ge.yWm(a,c,h);if(!Ge.fod(c)||kg.a.instance.J(5)&&Gc.SelectionEditor.S8(c))return 2;
let v;if(!({hyperlink:v}=Ge.BKa(c,!1,v)).returnValue)return 2;if(2===h){h=new gf.GraphTransaction(15);try{h.ql=a,h.Oa(v.paragraph),Ge.pKf(c)}finally{h&&h.dispose()}v.hyperlink.aE&&Ge.hd.Xq(2)}return 32}static yWm(a,c,h){const v=$c.a.instance.Ca.Fa;let B;if(Ge.Xlf(v))B=[c];else if(!({m9a:B}=Ge.$4g(B,v)).returnValue)return 8;if(!Ge.rOe())return 8;for(c=0;c<B.length;c++)if(!Ge.fod(B[c]))return 8;if(1===h&&!({hyperlink:X}=Ge.BKa(B[0],!1,X)).returnValue)return 2;if(2===h){for(h=0;h<B.length;h++)if(!({hyperlink:X}=
Ge.BKa(B[h],!0,X)).returnValue)return 2;var X=new gf.GraphTransaction(15);try{const ma=B[0];X.ql=a;X.Oa(ma.node);for(a=0;a<B.length;a++)Ge.pKf(B[a])}finally{X&&X.dispose()}Ge.hd.Xq(7)}return 32}static pKf(a){const c=ch.HyperlinkReader.K_b(a);let h=0,v=0;for(let B=0;B<c.length;B++)if(c[B].cpBegin>=v){const X=({cpBegin:h,cpEnd:v}=Ge.jK.q8(a,c[B],h,v)).returnValue;Ge.jK.aKf(a,X)}}static Ayi(a,c,h){if(kg.a.instance.J(5)&&dd.ImageReader.wcb(c))return 2;let v;if(!({hyperlink:v}=Ge.BKa(c,!1,v)).returnValue)return 2;
if(2===h){let B,X;({cpBegin:B,cpEnd:X}=Ge.jK.q8(c,v,B,X));$c.a.instance.setSelection(ne.SelectionFactory.bO(v.paragraph,B,X))}return 32}static Aei(a,c,h){let v;if(kg.a.instance.J(5)&&({hyperlink:v}=Ge.LUl(c,v)).returnValue)r.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!({hyperlink:v}=Ge.BKa(c,!1,v)).returnValue)return 2;2===h&&Eb.App.MYb(v.hyperlink.url);return 32}static qBf(a,c,h){a=dd.ImageReader.q8(c.node);if(!a)return 2;2===h&&Eb.App.MYb(a);return 32}static z7g(a,
c,h,v){if(kg.a.instance.J(5)&&dd.ImageReader.wcb(c)||!ec.InteractiveViewManager.instance.editingView.wj)return 2;let B;if(!({hyperlink:B}=Ge.BKa(c,!1,B)).returnValue)return 2;if(1===h)return 32;let X,ma;({cpBegin:X,cpEnd:ma}=Ge.jK.q8(c,B,X,ma));$c.a.instance.setSelection(ne.SelectionFactory.bO(B.paragraph,X,ma));c=ec.InteractiveViewManager.instance.Swa.ownerDocument.createElement("span");c.innerText=B.hyperlink.url;c.style.backgroundColor="rgb(255, 255, 255)";return l.AFrameworkApplication.pa.Le(a,
zb.a.drd,2,!0,v,c)}static BKa(a,c,h){h=null;if(Gc.SelectionEditor.tj(a)){const v=ac.g(a),B=bj.a.all(v,X=>6===X.nh);if(0<v.length&&(!Ge.p_||!B)||Ge.Sf.ag&&Ge.lpa&&0<Ge.lpa.Nyd(a).count)return{returnValue:!1,hyperlink:h}}return Ge.BUl(a,c,h)}static LUl(a,c){c=null;return dd.ImageReader.wcb(a)&&(c=ch.HyperlinkReader.VZb(a))?{returnValue:!0,hyperlink:c}:{returnValue:!1,hyperlink:c}}static BUl(a,c,h){h=null;const v=ch.HyperlinkReader.K_b(a);return v.length?v[0].hyperlink?(h=v[0],a.cpBegin<v[0].cpBegin?
{returnValue:c,hyperlink:h}:{returnValue:!0,hyperlink:h}):{returnValue:!1,hyperlink:h}:{returnValue:c,hyperlink:h}}static ZVb(a){if(kg.a.instance.J(3)){a=Ge.Wg.lJa(a.node,a.cpBegin,a.cpEnd);for(let c=0;c<a.count;++c)if(2===a.J(c).uc.changeType)return!0}return!1}static rOe(){return kg.a.instance.J(3)?!0:!kg.a.instance.J(3)||!Eb.App.wu.scc}static fod(a){return Ge.Sf.Kba(a)||Ge.gv()&&Ge.gv().instance&&Ge.gv().instance.JR(a)?!1:!0}static Jaf(a,c){return sd.ParagraphReader.Wk(a)&&!Gc.SelectionEditor.l4(a)&&
(sd.ParagraphReader.textLength(a.node)||c)?Oe.a.createTextRange(a.node,0,sd.ParagraphReader.textLength(a.node)):a}static Ncl(a){return a&&a.length<=Ge.gni?a:a.substring(0,Ge.gni)+"..."}static t1k(a){try{const c=new Date(a);return"Last Modified: "+c.toLocaleString(void 0,{weekday:"long"})+" at "+c.toLocaleString(void 0,{hour:"numeric",minute:"numeric"})}catch(c){return""}}static w0f(a=!1){let c=Date.now();if(a||c-Ge.jZh>Ge.lDn)aj.instance.E3h(),Ge.jZh=c}static qXd(a,c,h){const v=new Map;v.set("Source",
h);v.set("Action",c);Fa.Health.instance.recordKpiUsage(a,0,this.LPa,v)}}Ge.W$=null;Ge.sT=null;Ge.vl=null;Ge.Bb=null;Ge.zq=null;Ge.Sjb=null;Ge.KS=null;Ge.tl=null;Ge.Mma=null;Ge.Oi=null;Ge.Tb=null;Ge.Ixe=new Map;Ge.W9c=null;Ge.gni=35;Ge.jZh=Date.now();Ge.LPa="wwaengidc";Ge.Urj="RecentLinks";Ge.NBg="RecentLinksRibbonOptions";Ge.MBg="RecentLinksContextMenuOptions";Ge.Hqj="PopulateRecentLinksRibbon";Ge.Iqj="PopulateRecentLinksRibbonAction";Ge.Fqj="PopulateRecentLinksContextMenu";Ge.Gqj="PopulateRecentLinksContextMenuAction";
Ge.snj="PopulateRecentLinksContextMenu";Ge.tnj="PopulateRecentLinksContextMenuAction";Ge.fij="InsertRecentLinks";Ge.gij="InsertRecentLinksAction";Object(w.a)(Ge,"HyperlinkActor",null,[]);class Vk{static get Zn(){return Vn.a.uxb}static get uf(){return Nm.ContextSetEditor.instance}static get Sf(){return li.a.instance}static get Kb(){return Ee.a.instance}static get xF(){return ec.InteractiveViewManager.instance}static gv(){return Vk.vl||(Vk.vl=xa.a.instance.za("Box4.IExternalSelectionManager"))}static get ryl(){return Vk.Ymg||
(Vk.Ymg=xa.a.instance.resolve("Box4.Actors.IIndentationActorExtension"))}static eb(){const a=l.AFrameworkApplication.pa;a.ka(zb.a.lE,ic.a.view,Vk.yuc);a.ka(zb.a.lE,ic.a.outlineElement,Vk.ETg);a.Qb(zb.a.lE,1036);a.ka(zb.a.gM,ic.a.view,Vk.yuc);a.ka(zb.a.gM,ic.a.outlineElement,Vk.ETg);a.Qb(zb.a.gM,1036)}static yuc(a,c,h,v,B){const X=c.view;if(!X.Cd)return 2;var ma=X.Ma;if(!ma)return Vk.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.uda}),8;ma=ma.If;if(!ma)return Vk.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.noSelection}),8;if(Eb.App.mtb(c))return 8;
if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Vk.Sf.f2b(ma))return Vk.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.dC}),8;if(1===h)return 32;if(Vk.uf.dxa(Vk.HJe,ma))return Vk.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.uxc}),8;if(Vk.uf.J$(sd.ParagraphReader.EO,ma))return Vk.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.$L}),8;if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.TocFormatting",!1)&&Vk.Sf.f2b(ma))return Vk.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.dC}),
8;if(Vk.gv()&&Vk.gv().instance&&Vk.gv().instance.JR(ma))return Vk.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.externalSelection}),8;ma={};ma[Ln.a.gDa]=5794;ma[Ln.a.fDa]=5795;return Vk.ryl.yuc(X,a,c,h,v,B,ma)}static ETg(a,c,h,v,B){var X,ma;if(c.contextId!==ic.a.outlineElement)return 2;var Pa=c.clone().xUf();if(Wf.TableReader.gXh(Pa)){if(Vk.Sf.hXh(Pa))return Vk.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.dC}),8}else if(Vk.Sf.SXa(Pa))return Vk.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.dC}),2;Pa=new Kd.GraphIterator;Pa.set(c.node);Gc.SelectionEditor.vs(Pa);
if(!Ta.OutlineElementReader.Gg(Pa))return 2;let mb;switch(a){case zb.a.lE:mb=Vk.Zn.Xsb(Pa);break;case zb.a.gM:mb=Vk.Zn.bVb(Pa);break;default:return 2}if(1===h||!mb)return mb?32:8;h=0;a===zb.a.gM&&B&&B.ia(Uc.a.uVg,!1)&&(h|=2);if(Ta.OutlineElementReader.WN(Pa))return Vk.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.$L}),2;(null===(ma=null===(X=Vk.xF)||void 0===X?void 0:X.rc)||void 0===ma?0:ma.FI)&&Vk.xF.editingView&&(Vk.xF.editingView.NF=!0);switch(a){case zb.a.lE:Vk.Zn.$La(Pa,-1,h);break;case zb.a.gM:Vk.Zn.ozc(Pa,
1)}v&&vr.a.tib&&(v.dr|=vr.a.uab(c.node,!0));return 32}}Vk.vl=null;Vk.HJe=dd.ImageReader.nXa;Vk.Ymg=null;Object(w.a)(Vk,"IndentationActor",null,[]);var qm=b(1393);class Qi{static get paragraphEditor(){return Qi.kh||(Qi.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}static get uh(){return Qi.ak||(Qi.ak=xa.a.instance.resolve("Box4.ITableEditor"))}static get Sf(){return li.a.instance}static get Kb(){return Ee.a.instance}static gv(){return Qi.vl||(Qi.vl=xa.a.instance.za("Box4.IExternalSelectionManager"))}static eb(){const a=
l.AFrameworkApplication.pa;a.ka(zb.a.leftJustify,ic.a.view,qm.a.Wu);a.ka(zb.a.leftJustify,ic.a.paragraph,Qi.wwa);a.ka(zb.a.leftJustify,ic.a.table,Qi.IKe);a.Qb(zb.a.leftJustify,1036);a.ka(zb.a.centerJustify,ic.a.view,qm.a.Wu);a.ka(zb.a.centerJustify,ic.a.paragraph,Qi.wwa);a.ka(zb.a.centerJustify,ic.a.table,Qi.IKe);a.Qb(zb.a.centerJustify,1036);a.ka(zb.a.rightJustify,ic.a.view,qm.a.Wu);a.ka(zb.a.rightJustify,ic.a.paragraph,Qi.wwa);a.ka(zb.a.rightJustify,ic.a.table,Qi.IKe);a.Qb(zb.a.rightJustify,1036);
a.ka(zb.a.fullJustify,ic.a.view,qm.a.Wu);a.ka(zb.a.fullJustify,ic.a.paragraph,Qi.wwa);a.Qb(zb.a.fullJustify,1036);a.ka(zb.a.Szc,ic.a.view,qm.a.Wu);a.ka(zb.a.Szc,ic.a.paragraph,Qi.wwa);a.Qb(zb.a.Szc,1036);a.ka(zb.a.VAb,ic.a.view,qm.a.Wu);a.ka(zb.a.VAb,ic.a.paragraph,Qi.wwa);a.Qb(zb.a.VAb,1036);a.ka(zb.a.IVc,ic.a.view,qm.a.Wu);a.ka(zb.a.IVc,ic.a.paragraph,Qi.wwa);a.Qb(zb.a.IVc,1036);a.ka(zb.a.F4b,ic.a.view,qm.a.Wu);a.ka(zb.a.F4b,ic.a.paragraph,Qi.wwa);a.Qb(zb.a.F4b,1036);a.ka(zb.a.qVb,ic.a.view,qm.a.Wu);
a.ka(zb.a.qVb,ic.a.paragraph,Qi.wwa);a.Qb(zb.a.qVb,1036);a.ka(zb.a.D9b,ic.a.view,qm.a.Wu);a.ka(zb.a.D9b,ic.a.paragraph,Qi.wwa);a.Qb(zb.a.D9b,1036);a.ka(zb.a.bZb,ic.a.view,qm.a.Wu);a.ka(zb.a.bZb,ic.a.paragraph,Qi.wwa);a.Qb(zb.a.bZb,1036)}static IKe(a,c,h,v){let B=!0;if(!c)return 8;Wf.TableReader.gXh(c)?Qi.Sf.hXh(c)?(Qi.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.dC}),B=!1):Qi.gv()&&Qi.gv().instance&&Qi.gv().instance.JR(c)&&(Qi.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.externalSelection}),B=!1):(Qi.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.aZe}),
B=!1);if(1===h||!B)return B?32:8;c=c.node;switch(a){case zb.a.leftJustify:Qi.uh.vB(c,1);break;case zb.a.centerJustify:Qi.uh.vB(c,2);break;case zb.a.rightJustify:Qi.uh.vB(c,3)}v&&vr.a.tib&&(v.dr|=2);return 32}static wwa(a,c,h,v,B){let X=!0;c.contextId!==ic.a.paragraph?X=!1:Qi.Sf.SXa(c)?(Qi.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.dC}),X=!1):Qi.gv()&&Qi.gv().instance&&Qi.gv().instance.JR(c)&&(Qi.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.externalSelection}),X=!1);if(1===h||!X)return X?32:8;c=c.node;h=sd.ParagraphReader.zu(c);
switch(a){case zb.a.leftJustify:case zb.a.F4b:Qi.paragraphEditor.vB(c,1===h&&Qi.AKd(B)?6:1);break;case zb.a.centerJustify:case zb.a.qVb:Qi.paragraphEditor.vB(c,2===h&&Qi.AKd(B)?1:2);break;case zb.a.rightJustify:case zb.a.D9b:Qi.paragraphEditor.vB(c,3===h&&Qi.AKd(B)?1:3);break;case zb.a.fullJustify:case zb.a.bZb:Qi.paragraphEditor.vB(c,6===h&&Qi.AKd(B)?1:6);break;case zb.a.VAb:Qi.paragraphEditor.vB(c,11);break;case zb.a.Szc:Qi.paragraphEditor.vB(c,7);break;case zb.a.IVc:Qi.paragraphEditor.vB(c,13)}v&&
vr.a.tib&&(v.dr|=vr.a.uab(c));return 32}static AKd(a){let c=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(c=a.InContextSet);return!c}}Qi.ak=null;Qi.kh=null;Qi.vl=null;Object(w.a)(Qi,"JustificationActor",null,[]);const qx=()=>{const a=l.AFrameworkApplication.pa;a.ka(zb.a.save,Kc.a.frame,gy);a.ka(zb.a.sync,Kc.a.frame,rx)},rx=(a,c,h)=>{if(1===h)return 32;l.AFrameworkApplication.pa.processAction(zb.a.Zsb,2);Eb.App.aj.g4d();return 32},gy=(a,c,h)=>{if(1===h)return 2===Eb.App.oa.mode?
32:8;l.AFrameworkApplication.pa.processAction(zb.a.Zsb,2);if(2!==Eb.App.oa.mode)return 32;Eb.App.aj.Xwi(null,null);return 32};class ku{eb(){const a=l.AFrameworkApplication.pa;a.ka(zb.a.activateRibbonTab,ic.a.view,Object(m.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.Qb(zb.a.activateRibbonTab,5);a.ka(zb.a.BYh,ic.a.view,Object(m.a)(this,this.XXl,"launchJewelOpenMenuShortcut"))}activateRibbonTab(a,c,h,v,B){Eb.App.wu.wG.qZd(B.toString());return 32}XXl(a,c,h,v,B){l.AFrameworkApplication.m9("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");
Eb.App.wu.wG.AYh(1,B.toString());return 32}static get instance(){return ku._instance||(ku._instance=ku.wk())}static wk(){return new ku}}ku._instance=null;Object(w.a)(ku,"RibbonActor",null,[]);class Cs{constructor(a,c){this.Xi=null;this.Tga=a;this.JDa=c}get ji(){return this.Xi||(this.Xi=this.Tga())}eb(){const a=l.AFrameworkApplication.pa,c=Object(m.a)(this,this.JJn,"undoRedo");a.Aa(zb.a.undo,ic.a.view,c,1028);a.Aa(zb.a.redo,ic.a.view,c,1028)}JJn(a,c,h,v,B){c=c.view;if(!c.Cd)return Cs.Kb.ib(Kf.a.re,
{["Reason"]:Ef.a.tCb}),8;v=a===zb.a.undo?this.ji.wX:this.ji.xJa;if(1===h)return v?32:8;if(!v)return r.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===zb.a.undo?"undo":"redo"),this.JDa.value.tSi(),Cs.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.FJn}),2;h=new gf.GraphTransaction(3);h.Oa(c.sc);h.kPf();a=a===zb.a.undo?this.ji.undo():this.ji.redo();h.dispose();B&&bu.GrippersManager.instance.PIb(B.wF);if(a)return 32;Cs.Kb.ib(Kf.a.zXb,{["Reason"]:Ef.a.T7h});return 8}static get instance(){return Cs._instance||
(Cs._instance=Cs.wk())}static wk(){const a=xa.a.instance;return new Cs(()=>a.resolve("Box4.IUndoManager"),a.te("Box4.ICoauthCashTelemetry"))}static get Kb(){return Ee.a.instance}}Cs._instance=null;Object(w.a)(Cs,"UndoActor",null,[]);class Nw{constructor(){this.W=null}get name(){return"Box4.Actors"}yb(a){this.W=a;(new st).yb(a)}init(){var a=this.W.resolve("Box4.Actors.ClipboardActor");a.eb();a.k1();Jw();ms.instance.eb();Ge.eb();Vk.eb();Qi.eb();this.W.resolve("Box4.Actors.TouchInputActor").eb();tt.instance.eb();
this.W.resolve("Box4.ISelectAllHandlers").eb();qx();kg.a.instance.J(9)&&this.W.resolve("Box4.Actors.ProofingActor").eb();ku.instance.eb();(a=this.W.ra("Box4.IFeatureHelper"))?a.pk.continueWith(()=>{this.hpi()}):this.hpi();Rr.a.eb(Eb.App.P0a);this.W.resolve("Box4.Actors.TextFormattingActor").eb();Cs.instance.eb();this.W.resolve("Box4.Actors.AccessibilityActor").aJf();this.W.resolve("Box4.IClipboardCommands");this.W.resolve("Box4.Actors.PasteFloatieEventManager");Eb.App.oa.updateCommandUI()}hpi(){kg.a.instance.J(10)&&
(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsUpdateStyleContextMenuEnabled",!1)&&this.W.resolve("Box4.Actors.StyleContextMenuActor").eb(),this.W.resolve("Box4.Actors.StyleActor").eb())}dispose(){}static main(){M.a.instance.Lb(new Nw)}}Object(w.a)(Nw,"Box4ActorsPackage",null,[1,2]);class sx extends Bt{constructor(a,c,h,v){super(a);this.lia=h;this.jea=v;this.Y2f=0;this.Qv=c.cLa("UserAction","WordOnlineAddToDictionary")}CRf(a){this.uvd=this.lia.Lia(a);
if(!this.L3j())return!1;const c=this.uvd.errorDetails.token;this.jea.iPg(c);if(!this.jea.eYc(c))return r.ULS.sendTraceTag(541618644,375,10,"[Add to Dictionary]: Unable to save word to roaming dictionary."),!1;r.ULS.sendTraceTag(541618645,375,50,"[Add to Dictionary]: Starting ProofingWholeDocument operation.");this.Qv.start();this.transaction=new gf.GraphTransaction(15);this.transaction.Oa(a.node);return!0}iVd(a){this.XDb(a.node);return!0}tQc(a){this.XDb(a);return!0}jVd(a){this.XDb(a.node)}lXf(a){this.transaction.dispose();
this.uvd.errorDetails.Iib(a.actionId);this.jea.WZd("unused corelation id.");this.Qv.stop();r.ULS.sendTraceTag(541618646,375,50,String.format("[Add to Dictionary]: Actual errors removed: {0}. Duration in milliseconds: {1}. Type: {2}",this.Y2f,this.Qv.Yg,this.uvd.errorDetails.proofingType));return!0}Tac(a,c){const h=a.role;return super.Tac(a,c)||9===h||10===h||13===h||7===h||8===h}XDb(a){if(a){var c=this.lia.l0(a,h=>this.jea.eYc(h.errorDetails.token));this.lia.mgb(a,c,!0);this.Y2f+=c.length}}L3j(){var a,
c;return null!==(c=null===(a=this.uvd)||void 0===a?void 0:a.errorDetails)&&void 0!==c&&c.token?!0:(r.ULS.sendTraceTag(541618647,375,10,"[Add to Dictionary]: Was not able to get the token from the error range."),!1)}}Object(w.a)(sx,"AddToDictionaryCallbackSteps",Bt,[]);class tx{constructor(a,c,h,v,B,X,ma){this.Eb=a;this.Ma=c;this.Tyi=h;this.lia=v;this.xo=B;this.jea=X;this.yHm=ma;this.kol=(Pa,mb,Tb,rc,Tc,vd)=>{const ee=new sx(this.Tyi,this.xo,this.lia,this.jea);return new rt(Pa,mb,Tb,rc,Tc,vd,ee,this.Eb,
this.Ma,this.Tyi,"AddToDictionaryThroughProofingWholeDocumentOperation")}}eb(){this.Eb.JQ(zb.a.addToDictionary,ic.a.view,this.kol,1124);this.yHm.STm(this.jea)}}Object(w.a)(tx,"PersonalDictionaryOrchestrator",null,[]);class ux{get name(){return"Box4.PersonalDictionary"}yb(a){this.container=a;a.register(tx,"Box4.PersonalDictionary.PersonalDictionaryOrchestrator").singleInstance().Pc(()=>new tx(l.AFrameworkApplication.pa,$c.a.instance,Lu.a.instance,a.resolve("Box4.Proofing.IErrorRangeEditor"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
a.resolve("IRoamingDictionary"),a.resolve("Box4.Proofing.ProofingCheckOperator")))}init(){this.container.resolve("Box4.PersonalDictionary.PersonalDictionaryOrchestrator").eb()}dispose(){}static main(){ck.a.get_instance().Vk(7,()=>{M.a.instance.Lb(new ux)})}}Object(w.a)(ux,"PersonalDictionaryPackage",null,[1,2]);class ns{constructor(a,c,h,v,B,X){this.W2a=this.$S=null;this.ga=a;this.Yhd=c;this.tse=h;this.qva=v;this.Bb=B;this.rf=X}get recentColors(){return ns.t6a||(ns.t6a=xa.a.instance.ra("Box4.UI.RecentColorsSectionHandler"))}get LEi(){this.$S||
(this.$S=new Kw.a("Shading"),this.ZWa(this.$S));return this.$S}ZWa(a){a.gba(2,zb.a.qtb);a.gba(3,zb.a.l5);a.gba(4,zb.a.l5);a.rTb(this.tse,1)}eb(){this.ga.ka(zb.a.EDb,ic.a.view,Object(m.a)(this,this.EDb,"populateCellShadingColor"));this.ga.ka(zb.a.EDb,ic.a.tableCell,Object(m.a)(this,this.EDb,"populateCellShadingColor"));this.ga.Qb(zb.a.EDb,1126);this.ga.ka(zb.a.Xvc,ic.a.view,Rr.a.rCc);this.ga.ka(zb.a.Xvc,ic.a.tableCell,Object(m.a)(this,this.Xvc,"cellShadingColorMenuOpen"));this.ga.Qb(zb.a.Xvc,1028);
this.ga.ka(zb.a.l5,ic.a.view,Rr.a.rCc);this.ga.ka(zb.a.l5,ic.a.tableCell,Object(m.a)(this,this.dI,"cellShadingColor"));this.ga.Qb(zb.a.l5,1028);this.ga.ka(zb.a.qtb,ic.a.view,Rr.a.rCc);this.ga.ka(zb.a.qtb,ic.a.tableCell,Object(m.a)(this,this.qtb,"clearCellShadingColor"));this.ga.Qb(zb.a.qtb,1028);this.ga.ka(zb.a.dEb,ic.a.view,Object(m.a)(this,this.EIm,"queryCellShadingColorView"));this.ga.ka(zb.a.dEb,ic.a.tableCell,Object(m.a)(this,this.dEb,"queryCellShadingColor"));this.ga.Qb(zb.a.dEb,1124);this.ga.ka(zb.a.w$b,
ic.a.view,Rr.a.rCc);this.ga.ka(zb.a.w$b,ic.a.tableCell,Object(m.a)(this,this.E2j,"cellShadingCustomColor"));this.ga.Qb(zb.a.w$b,1028);this.ga.ka(zb.a.sBf,ic.a.view,Object(m.a)(this,this.Ida,"openMoreColorsDialog"));this.ga.Qb(zb.a.sBf,1028)}bN(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");a&&a.execute(c=>{c.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},
5E3)}Xvc(a,c,h,v,B){return this.BWh(c,h,B,!1)?32:8}dI(a,c,h,v,B){if(!({jw:a}=this.MFi(c,h,B,!0)).returnValue)return a;r.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");B=this.Yhd.Twa(c.node,B);this.yAm(c.node,B);this.bN();return 32}qtb(a,c,h,v,B){if(!({jw:a}=this.MFi(c,h,B,!1)).returnValue)return a;this.uAm(c.node);return 32}EIm(a,c,h,v,B){if(1===h)return 32;if(!c||!c.view.Cd)return 2;a=c.view.Ma;if(!a)return 2;a=a.If;if(!a)return 2;a=ns.uf.mO(a,16);
if(!a||!a.length)return 2;c=null;for(h=0;h<a.length;h++){v=a.getContext(h);if(!v||v.contextId!==ic.a.tableCell)return 2;const X={};this.RHh(v,X);if(X.CellShading)if(c&&c!==X.CellShading){c=null;break}else c=X.CellShading;else{c=null;break}}B.CellShading=c;return 32}dEb(a,c,h,v,B){return 1===h?32:this.RHh(c,B)}EDb(a,c,h,v,B){if(1===h)return 32;a=c.contextId===ic.a.view?this.qva.aBd(c):this.N9e(c);h={};c=null;32===l.AFrameworkApplication.pa.hb(zb.a.dEb,2,h)&&h&&(c=h.CellShading);h="";c&&(h=kn.a.SA(c)||
"");this.LEi.c$b=h;a=this.LEi.Uxd(a,Eb.App.HVb);if(!a)return 8;B.MenuItems=a;r.ULS.sendTraceTag(592996034,340,50,"Cell Shading dropdown menu is opened.");return 32}Ida(a,c,h,v,B){if(1===h)return 32;Eb.App.oa.Ty();l.AFrameworkApplication.pa.hb(zb.a.dEb,2,B);this.W2a=new px.a("Shading",zb.a.w$b);this.W2a.qWc(B&&B.CellShading?B.CellShading:0);return 32}E2j(a,c,h,v,B){if(1===h)return 32;l.AFrameworkApplication.pa.hb(zb.a.l5,2,B);this.recentColors.P7a(B)||r.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}",
"Shading");return 32}MFi(a,c,h,v){return this.BWh(a,c,h,v)?{returnValue:2===c,jw:32}:(2==c&&Rr.a.recordQosError("CellShadingButtonClickNoResponse",["TableInteractionFailed"],Ef.a.JFk),{returnValue:!1,jw:8})}BWh(a,c,h,v){return a.contextId!==ic.a.tableCell||2===c&&(v&&!h||!a.node)?!1:!0}yAm(a,c){const h=new gf.GraphTransaction(15);h.Oa(a);this.ADi(a);a.properties.setValue(Ed.a.dI,c);h.dispose()}uAm(a){const c=new gf.GraphTransaction(15);c.Oa(a);this.ADi(a);a.properties.removeProperty(Ed.a.dI);c.dispose()}N9e(a){return a.contextId!==
ic.a.tableCell?null:(a=ns.Ag.Xs(a.node))?a:null}ADi(a){if(this.Bb&&this.Bb.Bf&&(a=Object(ha.a)(hl.TableCellNode,a))){const c=a.hP();this.rf.GVc(a,c)}}RHh(a,c){if(a.contextId!==ic.a.tableCell)return 8;(a=a.node)&&a.hasProperty(Ed.a.dI)&&(c.CellShading=a.getValue(Ed.a.dI));return 32}static lUk(){return new ns(l.AFrameworkApplication.pa,Uj.a.instance,Xv.a.instance,vg.PageReader.instance,xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Ag(){return jn.PageNavigator.instance}static get uf(){return ns.Ey||
(ns.Ey=Nm.ContextSetEditor.instance)}static get instance(){return ns.fj||(ns.fj=ns.lUk())}}ns.t6a=null;ns.Ey=null;ns.fj=null;Object(w.a)(ns,"CellShadingActor",null,[]);class Tu{constructor(){this.W=null}get name(){return"Box4.CellShading"}yb(a){this.W=a}init(){const a=this.W.ra("Box4.IFeatureHelper");a?a.pk.continueWith(()=>{this.El()}):this.El()}El(){const a=this.W.ra("Box4.IFeatureHelper");if(a?a.isFeatureEnabled(21):Eb.App.Dod)ns.instance.eb(),Eb.App.oa.updateCommandUI()}dispose(){}}Object(w.a)(Tu,
"CellShadingPackage",null,[1,2]);var Im;(function(a){a[a.none=0]="none";a[a.style1=1]="style1";a[a.style2=2]="style2";a[a.style3=3]="style3";a[a.style4=4]="style4";a[a.style5=5]="style5";a[a.bullet=6]="bullet";a[a.invalid=42]="invalid"})(Im||(Im={}));Object(w.b)("ListStyle",Im);const dz={[Im.style1]:{[1]:"disc",[0]:"decimal"},[Im.style2]:{[1]:"circle",[0]:"lower-alpha"},[Im.style3]:{[1]:"square",[0]:"lower-roman"},[Im.style4]:{[0]:"upper-alpha"},[Im.style5]:{[0]:"upper-roman"},[Im.bullet]:{[1]:"bullet"}};
var Zv;(function(a){a[a.number=0]="number";a[a.bullet=1]="bullet";a[a.lim=13]="lim";a[a.nil=14]="nil";a[a.any=15]="any";a[a.noList=16]="noList";a[a.invalid=42]="invalid"})(Zv||(Zv={}));Object(w.b)("ListType",Zv);var ez=b(863);class Mp{constructor(a,c){this.iz=this.JLc=null;this.levelText=a;this.font=c}get YUd(){return this.levelText}get listStyle(){return 6}get Dr(){return"left"}}Object(w.a)(Mp,"ListMarkerBullet",null,[600]);class ih{static get Oo(){return ih.Un||(ih.Un=xa.a.instance.resolve("Box4.List.IListEditor"))}static get Yb(){return ih.zc||
(ih.zc=xa.a.instance.resolve("Box4.List.IListReader"))}static set Yb(a){ih.zc=a}static get Ei(){return ih.Xm||(ih.Xm=xa.a.instance.resolve("Box4.IInsertionPointFormatting"))}static gv(){return ih.vl||(ih.vl=xa.a.instance.za("Box4.IExternalSelectionManager"))}static get uf(){return Nm.ContextSetEditor.instance}static get Sf(){return li.a.instance}static get Kb(){return Ee.a.instance}static get Dc(){return As.a.getInstance()}static get Hhb(){return ih.X6a||(ih.X6a=xa.a.instance.ra("Box4.List.ISingleLevelListEditor"))}static eb(){const a=
l.AFrameworkApplication.pa;a.ka(zb.a.Ay,ic.a.view,ih.wuc);a.ka(zb.a.Ay,ic.a.outlineElement,ih.Loa);a.Qb(zb.a.Ay,1036);a.ka(zb.a.RF,ic.a.view,ih.wuc);a.ka(zb.a.RF,ic.a.outlineElement,ih.Loa);a.Qb(zb.a.RF,1036);ih.Yb.qq&&(a.ka(zb.a.q9,ic.a.view,ih.wuc),a.ka(zb.a.q9,ic.a.outlineElement,ih.Loa),a.Qb(zb.a.q9,1036));a.ka(zb.a.wKe,ic.a.view,Le.ActionManager.De);a.ka(zb.a.u2g,ic.a.view,Le.ActionManager.De);a.ka(zb.a.joinList,ic.a.view,ih.F1m);a.ka(zb.a.iKe,ic.a.view,Le.ActionManager.De);a.ka(zb.a.xKe,ic.a.view,
Le.ActionManager.De);a.ka(zb.a.sWf,ic.a.view,Le.ActionManager.De);a.ka(zb.a.DMi,ic.a.view,Le.ActionManager.De);a.ka(zb.a.A6d,ic.a.view,Le.ActionManager.De)}static F1m(){ez.a.nui();return 32}static wuc(a,c,h,v,B){var X,ma;if(!c.view.Cd)return 2;const Pa=ih.Kb.Tm(zb.a.wuc);v.dr=42;v.GD=42;const mb={[Ln.a.gDa]:5796,[Ln.a.fDa]:5797};var Tb=c.view;if(ih.uf.dxa(ih.fxl,Tb.Ma.If))return ih.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.dSe}),Pa.end(),8;if(ih.uf.dxa(ih.HJe,Tb.Ma.If))return ih.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.uxc}),
Pa.end(),8;if(ih.uf.J$(sd.ParagraphReader.EO,Tb.Ma.If))return ih.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.$L}),Pa.end(),8;if(ih.Sf.f2b(Tb.Ma.If))return ih.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.dC}),Pa.end(),8;if(null===(ma=null===(X=ih.gv())||void 0===X?void 0:X.instance)||void 0===ma?0:ma.JR(c))return ih.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.externalSelection}),Pa.end(),8;if(1===h)return Pa.end(),32;B||(B=new uh.DictionaryPropertySet);X=null;if(2===h){X=new gf.GraphTransaction(15);X.Oa(c.view.sc);ih.AKc=!1;ma=zm.OutlineElementGeneralizer.xia(Tb.Ma.Ca,
!1);if(!ma)return X.dispose(),ih.Kb.ib(Kf.a.ria,{["Reason"]:Ef.a.cwd}),Pa.end(),8;1<ma.length&&B.setValue(Uc.a.fvf,null);const Tc=B.ia(Uc.a.XG,-1),vd=B.ia(Uc.a.$t,-1);ih.Dc.vAb&&ih.Hhb&&ih.Hhb.a5j(ma);var rc=ih.rmn(Tc,vd,ma);rc&&(B.setValue(Uc.a.$t,16),B.setValue(Uc.a.zra,0));if(!Gc.SelectionEditor.ke(Tb.Ma.If)&&!rc&&0<ma.length&&Tc){Tb=new Kd.GraphIterator;rc=Array(ma.length);for(let ee=0;ee<ma.length;ee++)Tb.set(ma.getContext(ee).node),rc[ee]=ih.Yb.Op(Tb);ih.qmn(rc,B)&&(Tb=new uh.DictionaryPropertySet,
Tb.setValue(Uc.a.$t,16),Tb.setValue(Uc.a.zra,0),As.a.cV&&(Tb.setValue(ii.a.Uja,"clean-list-before-apply-new-list-style"),Tb.setValue(ii.a.fda,B.ia(ii.a.Uja,"unknown")+"@"+B.ia(ii.a.fda,"undefined"))),Ln.a.Bka(a,c,h,v,Tb,mb,11),l.AFrameworkApplication.pa.processAction(zb.a.DMi,2),r.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),ih.AKc=!0)}Tb=new Kd.GraphIterator;Tb.set(ma.getContext(0).node);Tb=ih.Yb.Op(Tb);ih.Q4l(Tc,vd,Tb,ma.length)}a=Ln.a.Bka(a,c,h,v,B,mb,11);
32===a&&B.ia(Uc.a.uVg,!1)&&(a=Ln.a.Bka(zb.a.gM,c,h,v,B,mb,11));X&&X.dispose();Pa.end();return a}static qmn(a,c){let h=null;var v=!1;for(let B=a.length-1;0<=B&&(h?(v=a[B],v=-1!==c.ia(Uc.a.XG,-3)?v?h.listType!==v.listType||h.listStyle!==v.listStyle:!0:v?h.listType!==v.listType:!0):h=a[B],!v);B--);return h&&(a=!1,v||(a=c.ia(Uc.a.$t,42),c=c.ia(Uc.a.XG,-3),a=a!==h.listType||0<c),v||a)?!0:!1}static Q4l(a,c,h,v){0>=v||ih.AKc||(a?h?(h=h.listType,-1===a&&c===h?(l.AFrameworkApplication.pa.processAction(zb.a.A6d,
2),r.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<a&&(!c||1===c)&&(l.AFrameworkApplication.pa.processAction(c?zb.a.iKe:zb.a.xKe,2),r.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",c?"Bullet":"Numbering"))):(l.AFrameworkApplication.pa.processAction(c?zb.a.iKe:zb.a.xKe,2),ih.EGn(),r.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",c?"Bullet":"Numbering")):(l.AFrameworkApplication.pa.processAction(zb.a.A6d,2),r.ULS.sendTraceTag(39715533,
393,50,"List Actions: Clean List Style - None list style")))}static rmn(a,c,h){if(-1!==a&&a||!h.length)return!1;a=new Kd.GraphIterator;let v=null;for(let B=h.length-1;0<=B&&!(a.set(h.getContext(B).node),v=ih.Yb.Op(a));B--);return v&&c===v.listType?!0:!1}static Loa(a,c,h,v,B){if(c.contextId!==ic.a.outlineElement)return 2;var X=c.clone().xUf();if(ih.Sf.SXa(X))return ih.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.dC}),2;const ma=new Kd.GraphIterator;ma.set(c.node);Gc.SelectionEditor.vs(ma);if(!Ta.OutlineElementReader.Gg(ma))return 2;
if(1===h)switch(a){case zb.a.Ay:return 32;case zb.a.RF:return 32;case zb.a.q9:return 32;default:return 2}if(Ta.OutlineElementReader.WN(ma))return ih.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.$L}),2;c=ih.Yb.Op(ma);var Pa;As.a.cV&&(Pa=Object.freeze(null===c||void 0===c?void 0:c.clone()));let mb=B;if(!mb)return 8;!ab.ListReader.mq&&a===zb.a.RF&&ma.RD()&&(ma.pp(4)||mb.setValue(Uc.a.RKa,1),ma.ni());ih.Yb.qq?(a===zb.a.RF||a===zb.a.Ay||a===zb.a.q9?(mb=ih.Oo.fYb(a,mb),X=ot.a.$N(mb.getValue(Uc.a.$t),mb.getValue(Uc.a.zra))):
X=null,ih.XX(a,mb),ih.dgn(X,mb)):(mb=ih.Oo.fYb(a,mb),X=ot.a.$N(mb.getValue(Uc.a.$t),mb.getValue(Uc.a.zra)));ab.ListReader.mq||(X.vy=mb.ia(Ed.a.kV,ai.a.Ih));let Tb=!1;a===zb.a.Ay&&mb&&(mb.hasProperty(Yb.a.Fq)&&(X.levelText=mb.ia(Yb.a.Fq,"")),mb.hasProperty(Ed.a.font)&&(X.font=mb.ia(Ed.a.font,"")),mb.hasProperty(Uc.a.u3e)&&(Tb=mb.ia(Uc.a.u3e,!1)));ih.Nhn(mb,ma);X=ih.Oo.Loa(mb,ma,X,Tb);if(!X.returnValue)return ih.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.Uof}),2;X=X.pza;As.a.cV&&ih.WOm(B,Pa,X);2===h&&(h=B.ia(Uc.a.$t,
-1),X&&-1!==h&&((Pa=B.ia(Yb.a.pq,"Invalid MultiLevel Type"),a===zb.a.RF&&r.ULS.sendTraceTag(540313232,393,50,"toggleNumberedList Info - {0}",JSON.stringify({["commandSource"]:(null===B||void 0===B?void 0:B.CommandSource)||"ribbon/keyboard",["autonumberedListsEnabled"]:!0,["listStyle"]:Im[null==(null===c||void 0===c?void 0:c.listStyle)?null===X||void 0===X?void 0:X.listStyle:null===c||void 0===c?void 0:c.listStyle],["listType"]:Zv[null==(null===c||void 0===c?void 0:c.listType)?null===X||void 0===X?
void 0:X.listType:null===c||void 0===c?void 0:c.listType],["cleared"]:16===(null===X||void 0===X?void 0:X.listType)})),c)?X.listType&&1!==X.listType||ih.AKc||(l.AFrameworkApplication.pa.processAction(zb.a.sWf,2),r.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",h?"Bullet":"Numbering",Pa)):16===X.listType?(l.AFrameworkApplication.pa.processAction(zb.a.u2g,2),r.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",h?"Bullet":"Numbering",Pa)):
X.listType&&1!==X.listType||ih.AKc||(l.AFrameworkApplication.pa.processAction(zb.a.wKe,2),r.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",h?"Bullet":"Numbering",Pa))),(a=nc.FocusManager.instance())&&a.nf&&a.nf.name===If.AppFrame.Wka&&a.rA(Fc.AFrame.Mp));v.dr=X.listType;v.GD=X.listStyle;return 32}static WOm(a,c,h){var v,B,X,ma,Pa,mb,Tb,rc;const Tc=new Map;Tc.set("actionCallSource",a.ia(ii.a.Uja,"unknown"));Tc.set("actionCallSourceTrigger",a.ia(ii.a.fda,"undefined"));Tc.set("fromListType",
Zv[null!==(v=null===c||void 0===c?void 0:c.listType)&&void 0!==v?v:16]);Tc.set("fromListStyle",Im[null!==(B=null===c||void 0===c?void 0:c.listStyle)&&void 0!==B?B:0]);Tc.set("fromListMarkerType",null!==(Pa=x(null!==(X=null===c||void 0===c?void 0:c.listStyle)&&void 0!==X?X:0,null!==(ma=null===c||void 0===c?void 0:c.listType)&&void 0!==ma?ma:16))&&void 0!==Pa?Pa:"undefined");Tc.set("fromLevelText",(null===c||void 0===c?0:c.Eca)?c.levelText:"undefined");Tc.set("toListType",null!==(mb=Zv[null===h||void 0===
h?void 0:h.listType])&&void 0!==mb?mb:"undefined");Tc.set("toListStyle",null!==(Tb=Im[null===h||void 0===h?void 0:h.listStyle])&&void 0!==Tb?Tb:"undefined");Tc.set("toListMarkerType",null!==(rc=x(null===h||void 0===h?void 0:h.listStyle,null===h||void 0===h?void 0:h.listType))&&void 0!==rc?rc:"undefined");Tc.set("toLevelText",(null===h||void 0===h?0:h.Eca)?h.levelText:"undefined");Fa.Health.instance.recordKpiUsage(ai.a.Enf.PZl,0,ai.a.pF,Tc)}static Nhn(a,c){var h=new Kd.GraphIterator;h.Wb(c);(c=h.Za(2))&&
sd.ParagraphReader.tb(c)&&(h=$c.a.instance.Ca.Fa)&&h.sa&&h.sa.node===c&&Gc.SelectionEditor.cKd(h)&&(ih.ven(a),ih.sen(a))}static dgn(a,c){c.hasProperty(Yb.a.pq)&&a.y0d(c.getValue(Yb.a.pq));c.hasProperty(ii.a.JN)&&(a.JN=c.getValue(ii.a.JN));c.hasProperty(Yb.a.Fq)&&(a.levelText=c.getValue(Yb.a.Fq));a.XG=c.ia(Uc.a.XG,-1);let h=null;a.Jja&&(h=ih.N5k(a,c));a.Jja&&h?ih.Ihn(a,h):(a.Jja?r.ULS.sendTraceTag(589091597,393,15,"List marker is null, falling back to default list info.List Style {0}, List multi level type {1}, List Ordered : {2}",
a.XG,a.pq,a.nq):r.ULS.sendTraceTag(589091596,393,50,"User has not selected a style choosing default properties"),ih.idn(a))}static idn(a){if(a.nq)a.NEd&&-1===a.XG||(a.levelText="%1.",a.propertySet.hasProperty(Ed.a.V0)||a.r5(0,1));else if(1===a.listType)a.NEd&&-1===a.XG||(a.font=ai.a.bzc,a.levelText=ai.a.Nsd,a.propertySet.hasProperty(Ed.a.V0)||a.r5(1,6));else return;a.Dr="left"}static Ihn(a,c){1===a.pq?ih.ygn(a,c):ih.Yen(a,c)}static ygn(a,c){(a.iz=c.iz)?a.K1=c.iz.K1:c.iz||r.ULS.sendTraceTag(588022422,
393,15,"Multi level def info is null for list markerList Style {0}, List multi level type {1}, List Ordered : {2}",a.XG,a.pq,a.nq)}static Yen(a,c){a.levelText=c.levelText;a.nq?a.r5(0,c.listStyle):(a.font=c.font,a.r5(1,1));a.Dr=c.Dr}static N5k(a,c){let h=null;2===a.pq?h=a.nq?xa.a.instance.ra("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):xa.a.instance.ra("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===a.pq&&(h=xa.a.instance.ra("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let v=h.rBb.value;
const B=a.XG+"";B in v||(v=h.B4,r.ULS.sendTraceTag(588391454,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in default list marker dictionary",B,a.pq,a.nq));if(!(B in v)){r.ULS.sendTraceTag(588391455,393,50,"List styleId {0} List Multi level type {1} and List Ordered : {2} is not present in document list marker dictionary",B,a.pq,a.nq);if(c.hasProperty(Ed.a.font))return r.ULS.sendTraceTag(588391456,393,50,"User creating new list marker for List styleId {0} List Multi level type {1} and List Ordered : {2}",
B,a.pq,a.nq),a=c.ia(Ed.a.font,""),new Mp(F.a.fromCharCode(parseInt(B)),a);r.ULS.sendTraceTag(588391457,393,15,"List styleId {0} List Multi level type {1} and List Ordered : {2} not found in any dictionary",B,a.pq,a.nq)}return v[B]}static sen(a){ih.Ei.hasProperty(Ed.a.fontColor)&&a.setValue(Ed.a.fontColor,ih.Ei.fontColor())}static ven(a){ih.Ei.hasProperty(Ed.a.fontSize)&&a.setValue(Ed.a.fontSize,ih.Ei.fontSize())}static XX(a,c){a=a===zb.a.Ay?0:a===zb.a.RF?1:a===zb.a.q9?2:-1;c=c.ia(Uc.a.XG,-1);r.ULS.sendTraceTag(22923024,
324,50,"ListType: {0}, ListStyleId: {1}",a,c)}static EGn(){const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");if(a){var c=l.AFrameworkApplication.K.vb("WordDefaultToEditFloodgateDelayInMilliseconds",6E4);a.execute(h=>{window.setTimeout(()=>{h.logActivity("WordListsExperience","WordListsExperienceFloodgateIsEnabled")},c)})}else r.ULS.sendTraceTag(554796489,301,15,"Word lists floodgate instance SystemInitiatedFeedback was null")}}ih.fxl=dd.ImageReader.nJc;ih.HJe=dd.ImageReader.nXa;ih.Un=null;
ih.zc=null;ih.Xm=null;ih.vl=null;ih.X6a=null;ih.AKc=!1;Object(w.a)(ih,"ListActor",null,[]);class Uu{constructor(){this.rBb=new qf.a(Object(m.a)(this,this.mUe,"createListMarkerDictionary"));this.B4={}}tph(a){return a}}Object(w.a)(Uu,"AListMarkerGalleryLoader",null,[656]);var wr=b(1195);class gp extends Uu{constructor(){super();this.Qnb=new Zc.a(oa.a.yi())}tph(a){gp.MN||this.ecn();a in gp.MN&&(a=gp.MN[a]);return a}mUe(){const a={};a["0"]=new Mp(Box4Intl.Box4Strings.L_ListStyleNone,wr.a.IOh);a["1"]=
new Mp(String.fromCharCode(61623),"Symbol");a["2"]=new Mp(String.fromCharCode(111),"Courier New");a["3"]=new Mp(String.fromCharCode(61607),"Wingdings");a["4"]=new Mp(String.fromCharCode(9643),"Courier New");a["5"]=new Mp(String.fromCharCode(61611),"Wingdings");a["6"]=new Mp(String.fromCharCode(61614),"Symbol");a["7"]=new Mp(String.fromCharCode(61483),"Symbol");a["8"]=new Mp(String.fromCharCode(61485),"Symbol");a["9"]=new Mp(String.fromCharCode(9830),"Courier New");a["10"]=new Mp(String.fromCharCode(61664),
"Symbol");a["11"]=new Mp(String.fromCharCode(61558),"Wingdings");a["12"]=new Mp(String.fromCharCode(61656),"Wingdings");a["13"]=new Mp(String.fromCharCode(61514),"Wingdings");a["14"]=new Mp(String.fromCharCode(61516),"Wingdings");a["15"]=new Mp(String.fromCharCode(61692),"Wingdings");a["16"]=new Mp(String.fromCharCode(61691),"Wingdings");a["17"]=new Mp(String.fromCharCode(61553),"Wingdings");return a}l7d(a){a&&a.length&&this.ANe(a)}JEf(){if(this.B4){var a=qt.a(this.B4),c=a.length;for(let h=0;h<c;h++){const v=
this.B4[a[h]];this.Qnb.add(v.levelText+"_"+v.font)}}}ANe(a){this.JEf();for(const c of a)if(c&&!c.nq&&c.Eca&&c.s0b&&(a=c.levelText+"_"+c.font,!this.Qnb.contains(a))){const h=qt.a(this.B4).length+qt.a(this.rBb.value).length+"";this.B4[h]=new Mp(c.levelText,c.font);this.Qnb.add(a)}}ecn(){gp.MN={};gp.MN["Symbol 0x00b7"]=Box4Intl.Box4Strings.L_SolidBullet;gp.MN["Courier New 0x006f"]=Box4Intl.Box4Strings.L_HollowBullet;gp.MN["Wingdings 0x00a7"]=Box4Intl.Box4Strings.L_SmallBlackSquare;gp.MN["Courier New 0x25ab"]=
Box4Intl.Box4Strings.L_SmallWhiteSquare;gp.MN["Wingdings 0x00ab"]=Box4Intl.Box4Strings.L_Star;gp.MN["Symbol 0x00ae"]=Box4Intl.Box4Strings.L_RightArrow;gp.MN["Symbol 0x002b"]=Box4Intl.Box4Strings.L_PlusSign;gp.MN["Symbol 0x002d"]=Box4Intl.Box4Strings.L_Hyphen;gp.MN["Courier New 0x2666"]=Box4Intl.Box4Strings.L_BlackDiamond;gp.MN["Symbol 0x00e0"]=Box4Intl.Box4Strings.L_WhiteDiamond;gp.MN["Wingdings 0x0076"]=Box4Intl.Box4Strings.L_BlackDiamondWithMinusX;gp.MN["Wingdings 0x00d8"]=Box4Intl.Box4Strings.L_3DRightwards;
gp.MN["Wingdings 0x004a"]=Box4Intl.Box4Strings.L_SmilingFace;gp.MN["Wingdings 0x004c"]=Box4Intl.Box4Strings.L_frowningFace;gp.MN["Wingdings 0x00fc"]=Box4Intl.Box4Strings.L_CheckMark;gp.MN["Wingdings 0x00fb"]=Box4Intl.Box4Strings.L_BallotScriptX;gp.MN["Wingdings 0x0071"]=Box4Intl.Box4Strings.L_ShadowedWhiteSquare}}gp.MN=null;Object(w.a)(gp,"ListMarkerBulletLoader",Uu,[]);class Zp{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(w.a)(Zp,"InfoAtLevel",null,[]);class Vu{constructor(a){this.iz=
a}get font(){return"Calibri"}get listStyle(){return 42}get Dr(){return"left"}get YUd(){return this.iz?this.KEm():this.MEm()}get JLc(){return this.iz?this.LEm():null}get levelText(){return""}D0k(a){switch(a){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}KEm(){let a="";for(let c=0;3>c;c++)a+=this.yEc(c);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Vu.H6e(),a)}LEm(){const a=[];for(let c=0;3>c;c++)a.push(Object.assign(new Zp,
{textAtLevel:this.LAh(c),styleAtLevel:this.Xgl(c)}));return a}MEm(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',Vu.I6e(),Box4Intl.Box4Strings.L_ListStyleNone)}LAh(a){a=this.iz.KLc[a];for(let c=0;9>c;c++)a=F.a.replaceAll(a,"%"+(c+1),this.D0k(this.iz.tBb[c]));return a}Xgl(a){const c={};c.fontFamily=6===this.iz.tBb[a]?this.iz.oya[a]:this.font;return c}yEc(a){const c=this.LAh(a),h=new Sys.StringBuilder;6===this.iz.tBb[a]&&h.append(String.format("font-family:{0};",this.iz.oya[a]));
return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',a,h.toString(),c)}static H6e(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static I6e(){const a=new Sys.StringBuilder;a.append("text-align: center; ");
a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(w.a)(Vu,"ListMarkerMultilevel",null,[600]);var hy=b(1E3);class fz extends Uu{constructor(){super()}mUe(){const a=new hy.a,c={};c["0"]=new Vu(null);c["1"]=new Vu(a.DTe());c["2"]=new Vu(a.xUe("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3]));c["3"]=new Vu(a.p8g([61558,61656,61607,61623,9830,61656,61607,61623,9830],"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";")));
return c}l7d(){}}Object(w.a)(fz,"ListMarkerMultilevelLoader",Uu,[]);var Rn=b(139);class Dq{constructor(a,c){this.iz=null;this.levelText=a;this.cad=c}get font(){return"Calibri"}get listStyle(){return this.cad}get Dr(){switch(this.cad){case 3:case 5:return"right";default:return"left"}}get YUd(){switch(this.cad){case 1:return this.V7b("1","2","3");case 2:return this.V7b("a","b","c");case 3:return this.V7b("i","ii","iii");case 4:return this.V7b("A","B","C");case 5:return this.V7b("I","II","III");case 0:return this.NEm();
default:return this.V7b("1","2","3")}}get JLc(){const a=[],c={};c.fontFamily=Rn.FontUtils.fxa(this.font);switch(this.cad){case 1:return a.push(Object.assign(new Zp,{textAtLevel:this.PU("1"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("2"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("3"),styleAtLevel:c})),a;case 2:return a.push(Object.assign(new Zp,{textAtLevel:this.PU("a"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("b"),styleAtLevel:c})),
a.push(Object.assign(new Zp,{textAtLevel:this.PU("c"),styleAtLevel:c})),a;case 3:return a.push(Object.assign(new Zp,{textAtLevel:this.PU("i"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("ii"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("iii"),styleAtLevel:c})),a;case 4:return a.push(Object.assign(new Zp,{textAtLevel:this.PU("A"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("B"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("C"),
styleAtLevel:c})),a;case 5:return a.push(Object.assign(new Zp,{textAtLevel:this.PU("I"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("II"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("III"),styleAtLevel:c})),a;case 0:return null;default:return a.push(Object.assign(new Zp,{textAtLevel:this.PU("1"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("2"),styleAtLevel:c})),a.push(Object.assign(new Zp,{textAtLevel:this.PU("3"),styleAtLevel:c})),
a}}V7b(a,c,h){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',Dq.H6e(),this.yEc(a),this.yEc(c),this.yEc(h))}NEm(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Dq.I6e(),Box4Intl.Box4Strings.L_ListStyleNone)}yEc(a){a=this.PU(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}PU(a){return F.a.replaceAll(this.levelText,"%1",a)}static H6e(){const a=new Sys.StringBuilder;
a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static I6e(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(w.a)(Dq,"ListMarkerNumbering",null,[600]);class DB extends Uu{constructor(){super();this.Qnb=new Zc.a(oa.a.yi())}sSl(a){a=a.match(RegExp("%[1-9]","g"));return!!a&&1===a.length}mUe(){const a={};a["0"]=new Dq(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new Dq("%1.",5);a["2"]=new Dq("%1.",
4);a["3"]=new Dq("%1.",1);a["4"]=new Dq("%1.",2);a["5"]=new Dq("%1.",3);a["6"]=new Dq("%1)",5);a["7"]=new Dq("%1)",4);a["8"]=new Dq("%1)",1);a["9"]=new Dq("%1)",2);a["10"]=new Dq("%1)",3);a["11"]=new Dq("(%1)",5);a["12"]=new Dq("(%1)",4);a["13"]=new Dq("(%1)",1);a["14"]=new Dq("(%1)",2);a["15"]=new Dq("(%1)",3);return a}l7d(a){a&&a.length&&this.ANe(a)}JEf(){if(this.B4){var a=qt.a(this.B4),c=a.length;for(let h=0;h<c;h++){const v=this.B4[a[h]];this.Qnb.add(v.levelText+"_"+v.listStyle)}}}ANe(a){this.JEf();
for(const c of a)if(c&&c.nq&&c.Eca&&this.sSl(c.levelText)&&c.listStyle&&(a=wr.a.j4e(c.levelText))){const h=a+"_"+c.listStyle;if(!this.Qnb.contains(h)){const v=qt.a(this.B4).length+qt.a(this.rBb.value).length+"";this.B4[v]=new Dq(a,c.listStyle)}this.Qnb.add(h)}}}Object(w.a)(DB,"ListMarkerNumberingLoader",Uu,[]);class lu{constructor(){this.W=null}get name(){return"Box4.ListMarker"}init(){ih.eb()}dispose(){}yb(a){this.W=a;this.W.ha("Box4.ListMarkerGallery.ListMarkerBulletLoader",()=>new gp).singleInstance();
this.W.ha("Box4.ListMarkerGallery.ListMarkerNumberingLoader",()=>new DB).singleInstance();this.W.ha("Box4.ListMarkerGallery.ListMarkerMultilevelLoader",()=>new fz).singleInstance()}static main(){M.a.instance.Lb(new lu)}}Object(w.a)(lu,"Box4ListMarkerPackage",null,[1,2]);class Vz{static get vf(){return gg.a.fy(Vz.ll,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")}}Vz.ll="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>";
Object(w.a)(Vz,"DefineNewBulletDialogHtml",null,[]);class xr extends gg.a{constructor(a,c,h,v){super();this.qmc=this.ore=this.DOb=this.yOb=null;this.yob=0;this.Muc=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];this.CMh=!0;this.Es=a;this.wf=c;this.ga=h;this.YP=!1;v&&(a=v.indexOf(","),-1!==a&&(v=v.substring(0,a)));this.fontName=v;this.jf="DefineNewBulletDialog";this.vf=Vz.vf;this.Nd(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Nd(0,CommonUIStrings.l_DialogClose);this.Tg(Box4Intl.Box4Strings.L_SymbolSingle,
Object(m.a)(this,this.jqk,"defineNewBulletHandler"),null);this.q6=!1;this.sBa();document.getElementById(xr.txd).focus()}sBa(){this.wf.gk().scope.Bp(nc.FocusManager.instance().BN);this.wf.gk().scope.Bp(nc.FocusManager.instance().DN);this.wf.gk().scope.bindAction(nc.FocusManager.instance().BN,zb.a.Xsd);this.wf.gk().scope.bindAction(nc.FocusManager.instance().DN,zb.a.Wsd)}cS(){this.Fnd(xr.txd,"DefineNewBulletFontPlaceholder",zb.a.Vsd.toString(),zb.a.gEb.toString(),zb.a.ZPc.toString(),Box4Intl.Box4Strings.L_FontName,
"100px");this.pWj()}wS(){super.wS();document.getElementById(this.hi("WACDialogPanel")).style.width="auto"}Fnd(a,c,h,v,B,X,ma){h=jf.c(a,h,!0,!0,v,B,F.a.Wd(X),!0,ma);this.Ard(a,c,h,"Medium")}pWj(){const a=document.getElementById(xr.eXb);a&&(a.innerHTML=this.zth(),this.Toi(a))}Toi(a){if(a=a.getElementsByClassName("DefineNewBulletTableCell"))for(let c=0;c<a.length;c++)Ld.a.addHandler(a[c],Jb.a.focus,Object(m.a)(this,this.kqk,"defineNewBulletListMarkerTableFocusHandler"))}PNn(){var a=document.getElementById(xr.eXb);
if(a){let c=this.fontName;const h=wr.a.xhf(this.fontName);h&&61472!==this.yob||!h&&32!==this.yob?(a.innerHTML=this.zth(),this.Toi(a)):(a=a.getElementsByTagName("table"))&&1===a.length&&c&&(c=this.xOg(c),a[0].style.fontFamily=c)}}kqk(a){if(this.yOb&&a.target!==this.yOb){const c=this.wf.gk();c&&c.Sh&&(c.Sh.ov(a.target),this.yOb=a.target)}this.Dsm(a.target.id)}Dsm(a){this.lCi(this.DOb,!1);this.DOb=a;this.lCi(a,!0);if((a=document.getElementById("CharacterCodeValueLabel"))&&this.DOb){let c=parseInt(this.DOb.substr(this.DOb.lastIndexOf("_")+
1));-1!==c&&(c-=61472===this.yob?61440:0,a.innerText=F.a.zG(c,4))}}lCi(a,c){(a=this.Ixh(a))&&(c?a.setAttribute("selected","true"):a.removeAttribute("selected"))}Ixh(a){const c=document.getElementById(xr.eXb);return c?c.querySelector("#"+a):null}kha(){const a=document.getElementById(xr.eXb);a&&(this.ore||(this.ore=Object(m.a)(this,this.wZl,"listMarkerTableClickHandler"),this.Uo.Ea(Jb.a.click,a,this.ore)),this.qmc||(this.qmc=Object(m.a)(this,this.xZl,"listMarkerTableKeyHandler"),this.jd.Ea(Jb.a.ah,
a,this.qmc),this.jd.Ea(Jb.a.hs,a,this.qmc),this.jd.Ea(Jb.a.Hg,a,this.qmc)));super.kha()}bYh(a){return Object(bo.a)(a,"DefineNewBulletTableCell")}wZl(a){a=a.Ud;if(!this.bYh(a))return!1;this.wf.gk().Sh.ov(a);a.focus();return!0}xZl(a){var c=a.Ud;if(!this.bYh(c))return!1;var h=c.id;h=parseInt(h.substr(h.lastIndexOf("_")+1))-this.yob;if(a.Sa.ctrlKey||a.Sa.altKey||a.Sa.keyCode>=vb.a.pec&&a.Sa.keyCode<=vb.a.LJb)return!1;const v=a.Sa.keyCode;if(a.eventName===Jb.a.ah){a=-1;if(v===Sys.UI.Key.enter)return this.wf.gk().Sh.ov(c),
c.focus(),this.Tai(c.id),this.hide(),!0;v===Sys.UI.Key.up?a=h-17:v===Sys.UI.Key.down?a=h+17:v===Sys.UI.Key.left?a=l.AFrameworkApplication.isRtl?h+1:h-1:v===Sys.UI.Key.right&&(a=l.AFrameworkApplication.isRtl?h-1:h+1);0<=a&&(c=this.Ixh(xr.eXb+"_"+(a+this.yob)))&&c.focus()}return!0}Tai(a){if(a){a=a.split("_");const c=new uh.DictionaryPropertySet;c.setValue(Uc.a.XG,parseInt(a[1]));c.setValue(Ed.a.font,this.fontName);c.setValue(Uc.a.$t,1);As.a.cV&&(c.setValue(ii.a.Uja,"command-ui"),c.setValue(ii.a.fda,
"define-new-bullet-dialog"));this.ga.hb(zb.a.Ay,2,c)}this.wf.NI(this.lI,!0)}zth(){const a=new Sys.StringBuilder,c=wr.a.xhf(this.fontName);let h=this.fontName;h=this.xOg(h);a.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',h));c?(this.yob=61472,a.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):
(this.yob=32,a.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\u007f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\u0080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\u0081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\u0082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\u0083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\u0084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\u0086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\u0087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\u0088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\u0089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\u008a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\u008b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\u008c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\u008d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\u008e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\u008f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\u0090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\u0091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\u0092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\u0093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\u0094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\u0095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\u0096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\u0097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\u0098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\u0099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\u009a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\u009b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\u009c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\u009d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\u009e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\u009f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\u00a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\u00a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\u00a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\u00a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\u00a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\u00a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\u00a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\u00a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\u00a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\u00aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\u00ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\u00ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\u00ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\u00ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\u00af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\u00b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\u00b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\u00b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\u00b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\u00b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\u00b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\u00b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\u00b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\u00b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\u00b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\u00ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\u00bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\u00bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\u00bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\u00be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\u00bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\u00c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\u00c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\u00c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\u00c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\u00c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\u00c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\u00c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\u00c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\u00c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\u00c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\u00ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\u00cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\u00cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\u00cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\u00ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\u00cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\u00d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\u00d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\u00d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\u00d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\u00d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\u00d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\u00d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\u00d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\u00d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\u00d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\u00da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\u00db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\u00dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\u00dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\u00de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\u00df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\u00e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\u00e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\u00e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\u00e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\u00e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\u00e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\u00e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\u00e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\u00e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\u00e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\u00ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\u00eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\u00ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\u00ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\u00ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\u00ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\u00f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\u00f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\u00f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\u00f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\u00f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\u00f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\u00f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\u00f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\u00f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\u00f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\u00fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\u00fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\u00fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\u00fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\u00fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\u00ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>'));
a.append("</table>");return a.toString()}xOg(a){a&&-1!==a.indexOf(" ")&&(a="'"+a+"'");return a}Ard(a,c,h,v){c=document.getElementById(c);this.Es.KGa(a,h);h=this.Es.yab(a,v);c.appendChild(h);this.Es.lS(a)}jqk(a){1===a&&this.Tai(this.DOb);this.hide()}dispose(){this.YP||(this.Es.DC(xr.txd),this.YP=!0);super.dispose()}}xr.txd="DefineNewBulletFontStyleComboBox";xr.eXb="DefineNewBulletTableContainer";Object(w.a)(xr,"DefineNewBulletDialog",gg.a,[]);class Wz{WDc(){return zb.a.rZl}xEc(){return zb.a.aEf}}Object(w.a)(Wz,
"ListMarkerGalleryBulletCommands",null,[598]);class MA{WDc(){return zb.a.tZl}xEc(){return zb.a.hCm}}Object(w.a)(MA,"ListMarkerGalleryMultilevelCommands",null,[598]);class NA{WDc(){return zb.a.uZl}xEc(){return zb.a.bEf}}Object(w.a)(NA,"ListMarkerGalleryNumberingCommands",null,[598]);class gz{constructor(a,c,h,v,B){this.uua=this.fFa=null;this.ga=a;this.zc=v.resolve("Box4.List.IListReader");this.J2=c;this.Uvj=h;switch(this.J2){case 0:a=v.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader");this.fFa=
new Wz;break;case 1:a=v.resolve("Box4.ListMarkerGallery.ListMarkerNumberingLoader");this.fFa=new NA;break;case 2:a=v.resolve("Box4.ListMarkerGallery.ListMarkerMultilevelLoader");this.fFa=new MA;break;default:a=v.resolve("Box4.ListMarkerGallery.ListMarkerBulletLoader"),this.fFa=new Wz}B=this.zc?this.zc.D5k(B):null;a.l7d(B);this.Alj=new wr.a(c,a,B,!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.uAb)}eb(){this.ga.ka(this.fFa.xEc(),ic.a.view,Eb.App.P0a.E8g(11));this.ga.ka(this.fFa.xEc(),ic.a.outlineElement,
Object(m.a)(this,this.gCm,"populateListMarkerGalleryDropDown"));this.ga.Qb(this.fFa.xEc(),1124);this.J2||(this.ga.Aa(zb.a.aof,ic.a.view,Object(m.a)(this,this.DXl,"launchDefineNewBulletDialogHandler"),1028),this.ga.Aa(zb.a.ZPc,ic.a.view,Object(m.a)(this,this.ZPc,"populateDefineNewBulletFontDropdown"),1124),this.ga.Aa(zb.a.Vsd,ic.a.view,Object(m.a)(this,this.iqk,"defineNewBulletFontNameHandler"),1028),this.ga.Aa(zb.a.Xsd,Kc.a.frame,Object(m.a)(this,this.Sbh,"defineNewBulletMoveFocusForTabsHandler"),
64),this.ga.Aa(zb.a.Wsd,Kc.a.frame,Object(m.a)(this,this.Sbh,"defineNewBulletMoveFocusForTabsHandler"),64));this.ga.ka(this.fFa.WDc(),ic.a.view,Object(m.a)(this,this.x_h,"listMarkerGalleryMenuOpen"));this.ga.ka(this.fFa.WDc(),ic.a.outlineElement,Object(m.a)(this,this.x_h,"listMarkerGalleryMenuOpen"));this.ga.Qb(this.fFa.WDc(),1124)}Sbh(a){if(!this.uua)return 2;if(this.uua.wf.gk().Sh.dO.id.startsWith(xr.eXb)){let c=null;a===zb.a.Xsd?c=this.uua.oTa:a===zb.a.Wsd&&(c=document.getElementById(xr.txd));
if(!c)return 2;this.uua.wf.gk().Sh.ov(c);c.focus()}else if(a===zb.a.Xsd)this.uua.wf.gk().RYa();else if(a===zb.a.Wsd)this.uua.wf.gk().QYa();else return 2;return 32}x_h(a,c){a=null;c.view.Cd&&(a=c.view);return a&&a.Ma?32:(Sd.b(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",c.toString()),8)}DXl(a,c,h){return 1===h?32:2===h?(a=this.J_b(c),a=ua.FormattingReader.zr(a).cache.qF,this.uua=new xr(this.Uvj,nc.FocusManager.instance(),
l.AFrameworkApplication.pa,a),32):8}J_b(a){return this.Cyd(a).sa}Cyd(a){let c=null;a=a.view;return a?c=Gc.SelectionEditor.Ri(a.Ma.Ca.J(0),!1,!1):c}ZPc(a,c,h,v,B){if(1===h)return 32;if(2===h&&!B)return 8;if(this.uua.CMh){for(a=0;a<wr.a.Muc.length;a++)Rn.FontUtils.PRi(wr.a.Muc[a]);this.uua.CMh=!1}fm.a.oGd(c);B.PopulationXML=Rn.FontUtils.cph(fm.a.L1d,fm.a.N3e,zb.a.Vsd);return 32}gCm(a,c,h,v,B){a=c.contextId===ic.a.outlineElement;if(1===h||!a)return a?32:8;if(2===h&&!B)return 8;B.MenuItems=this.Alj.R5k();
return 32}iqk(a,c,h,v,B){if(1===h)return 32;if(2===h){a=Object(ha.a)(29,B);if(!a||!a.Ac)return 8;this.uua.fontName=a.Ac.fontName;this.uua.PNn();return 32}return 8}}Object(w.a)(gz,"ListMarkerGalleryActor",null,[568]);class Xz{constructor(){this.Jd=this.W=null}get name(){return"Box4.ListMarkerGallery"}init(){if(ec.InteractiveViewManager.instance){var a=ec.InteractiveViewManager.instance;a.editingView&&(this.Jd=a.editingView.sc,this.MSm())}}dispose(){}yb(a){this.W=a}MSm(){(new gz(l.AFrameworkApplication.pa,
1,this.W.resolve("Common.IStandaloneRootController").w5,this.W,this.Jd)).eb();(new gz(l.AFrameworkApplication.pa,0,this.W.resolve("Common.IStandaloneRootController").w5,this.W,this.Jd)).eb();(new gz(l.AFrameworkApplication.pa,2,this.W.resolve("Common.IStandaloneRootController").w5,this.W,this.Jd)).eb()}static main(){M.a.instance.Lb(new Xz)}}Object(w.a)(Xz,"Box4ListMarkerGalleryPackage",null,[1,2]);var EB=b(343),$v=b(464),Ow=b(396),rp=b(112);const Yz=a=>{a.element.style.top=""};var aw=b(924);class vx{constructor(a,
c,h){this.NL=!1;this.r3a=0;this.nua=this.Cyg=null;this.Gk=a;this.Ywj=c;this.Pq=h;this.yW=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.Pw=!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.a9)&&!this.Pq.wYe&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";H.a.Qh&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.yW}get visible(){return this.NL}set_visible(a){if(this.NL!==
a)return(this.NL=a)?this.uLe():this.uzc(),a}dispose(){this.visible&&this.uzc();ye.a.I_(this.htmlElement);this.Gk=this.yW=null}yHi(a,c){const h=a.htmlElement||a.createElement();c===this.htmlElement.childNodes.length?this.htmlElement.appendChild(h):this.htmlElement.insertBefore(h,this.htmlElement.childNodes[c]);a.Fui();this.r3a+=a.htmlElement.clientHeight;var v=this.htmlElement.childNodes,B=a.FRg,X=Object(m.a)(this,this.pkm,"onAfterShowEntry");rp.WacAirSpace.qS(h,"Shared_BasicClass");var ma=new Ow.a(h);
ma.Hoa(0,1);const Pa=new $v.a(h);Pa.twa(h.clientTop-30,h.clientTop);B?(rp.WacAirSpace.leb(ma,null,null),rp.WacAirSpace.leb(Pa,null,X)):(rp.WacAirSpace.animate(ma,null,null),rp.WacAirSpace.animate(Pa,null,X));for(c+=1;c<v.length;c++)X=v[c],rp.WacAirSpace.qS(X,"Shared_BasicClass"),ma=new $v.a(X),ma.twa(X.clientTop-h.clientHeight,X.clientTop),B?rp.WacAirSpace.leb(ma,null,null):rp.WacAirSpace.animate(ma,null,null);a.Sqn();this.set_visible(!0)}LJh(a){const c=a.htmlElement;if(ye.a.Uzb(c)){this.r3a-=a.htmlElement.clientHeight;
var h=c.parentNode.children;a=a.FRg;var v=Object(m.a)(this,this.gkm,"onAfterHideEntry");rp.WacAirSpace.qS(c,"Shared_BasicClass");var B=new EB.a(c);B.Hoa(1,0);a?rp.WacAirSpace.leb(B,null,v):rp.WacAirSpace.animate(B,null,v);v=!1;for(B=0;B<h.length;B++){if(v){const X=h[B];rp.WacAirSpace.qS(X,"Shared_BasicClass");const ma=new $v.a(X);ma.twa(X.clientTop,-c.clientHeight);a?rp.WacAirSpace.leb(ma,null,Yz):rp.WacAirSpace.animate(ma,null,Yz)}v||h[B]!==c||(v=!0)}}}pkm(a){a.element.style.top="";l.AFrameworkApplication.na.QNc()}gkm(a){a.element.parentNode.removeChild(a.element);
this.htmlElement.hasChildNodes()||this.set_visible(!1);l.AFrameworkApplication.na.QNc()}uLe(){""===this.Gk.style.top.trim()&&(this.Gk.style.top=this.Gk.offsetTop+"px");this.htmlElement.style.left=this.Gk.style.left;this.htmlElement.style.top=this.Gk.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.Cyg=this.Gk.style.top;this.r3a=a.height;this.v7d();l.AFrameworkApplication.na.r_(Object(m.a)(this,this.onResize,
"onResize"));Ld.a.addHandler(this.htmlElement,Jb.a.a$b,Ld.a.H8a);this.nua=Object(m.a)(this,this.exa,"contextMenuHandler");l.AFrameworkApplication.na.nta.Ea(this.htmlElement,this.nua,null);if(nc.FocusManager.rH()){var c=nc.FocusManager.instance();a=c.fd(aw.a.hHa);a.parent=Fc.AFrame.uo;const h=new He.DOMFocusListing(()=>this.htmlElement);h.vn(1);h.vn(2);h.vn(8);c.qha(()=>this.htmlElement,a,h);c=c.getRegion(aw.a.hHa);c.rMa();c.mV=!0;c.MTa=!0;const v=l.AFrameworkApplication.na.gu;a.Krb(()=>{v.Bv(aw.a.hHa)});
v.KQ(aw.a.hHa);(h.ica||l.AFrameworkApplication.K.$("ReactBusinessBarIsEnabled"))&&v.YB(aw.a.hHa)}}uzc(){this.bHi()&&(this.Gk.style.top=this.Cyg);this.htmlElement.style.visibility="hidden";l.AFrameworkApplication.na&&(nc.FocusManager.rH()&&nc.FocusManager.instance().REb(aw.a.hHa),this.nua&&(l.AFrameworkApplication.na.nta.xb(this.htmlElement,this.nua),this.nua=null));Ld.a.removeHandler(this.htmlElement,Jb.a.a$b,Ld.a.H8a)}v7d(){if(this.bHi()&&this.visible){var a=this.Gk,c=this.r3a+this.Ywj;const h=ye.a.FK(a.style.top);
rp.WacAirSpace.qS(a,"Shared_BasicClass");a=new $v.a(a);a.twa(h,c);rp.WacAirSpace.animate(a,null,null)}}bHi(){return!this.Pw&&!this.Pq.wYe}onResize(){const a=this.Pq.entries.length,c=Sys.UI.DomElement.getBounds(this.htmlElement).height;let h;for(let v=0;v<a;++v)h=this.Pq.entries[v],h.htmlElement&&h.Fui();this.r3a=Sys.UI.DomElement.getBounds(this.htmlElement).height;c!==this.r3a&&this.v7d()}exa(){return!0}}Object(w.a)(vx,"BusinessBarDom",null,[1027,14]);var mu;(function(a){a[a.none=0]="none";a[a.corruptPage=
1]="corruptPage";a[a.currentPageStatus=2]="currentPageStatus";a[a.documentMarkedAsFinal=3]="documentMarkedAsFinal";a[a.documentSigned=4]="documentSigned";a[a.fileAccess=5]="fileAccess";a[a.kickoutWithDataLoss=6]="kickoutWithDataLoss";a[a.lostSession=7]="lostSession";a[a.malformedHyperlinkUris=8]="malformedHyperlinkUris";a[a.odt=9]="odt";a[a.readonlyRecommended=10]="readonlyRecommended";a[a.saveReplaySuccess=11]="saveReplaySuccess";a[a.saveReplayFailed=12]="saveReplayFailed";a[a.unsupportedObjects=
13]="unsupportedObjects";a[a.word11Compat=14]="word11Compat";a[a.unsupportedBrowser=15]="unsupportedBrowser";a[a.applicationNotification=16]="applicationNotification";a[a.skypeDocChatFailed=17]="skypeDocChatFailed";a[a.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";a[a.sessionExpired=19]="sessionExpired";a[a.irmPolicyDescription=20]="irmPolicyDescription";a[a.policyWarningMessage=21]="policyWarningMessage";a[a.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";a[a.gdprPrivacyNotice=
23]="gdprPrivacyNotice";a[a.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";a[a.graphMergePrompt=25]="graphMergePrompt";a[a.readOnlyDocument=26]="readOnlyDocument";a[a.dictationSilence=27]="dictationSilence";a[a.autoSensitivityLabel=28]="autoSensitivityLabel";a[a.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";a[a.dictationDebugInfo=30]="dictationDebugInfo";a[a.oneNoteCovid19Message=31]="oneNoteCovid19Message";a[a.citationStylePrompt=32]="citationStylePrompt";a[a.oneNoteViewModeMessage=
33]="oneNoteViewModeMessage";a[a.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";a[a.oneNotePagePrintReady=35]="oneNotePagePrintReady";a[a.irmPolicyCausedFeatureDisabled=36]="irmPolicyCausedFeatureDisabled";a[a.mandatoryLabel=37]="mandatoryLabel";a[a.policyTip=38]="policyTip";a[a.minorVersionLimit=39]="minorVersionLimit";a[a.testEntry1=40]="testEntry1";a[a.testEntry2=41]="testEntry2";a[a.testEntry3=42]="testEntry3";a[a.testEntry4=43]="testEntry4";a[a.testEntry5=44]="testEntry5";
a[a.testEntry6=45]="testEntry6";a[a.testEntry7=46]="testEntry7"})(mu||(mu={}));Object(w.b)("BusinessBarId",mu);class nu{constructor(a,c=0,h=null,v=null){this.kqg=this.Mfg=!1;this.cQb=null;this.Fy=[];this.DOa=v||new vx(a,c,this);this.jBl(h)}jBl(a){if(a){this.cQb={};a=a.ranking;for(let c=0;c<a.length;c++)this.cQb[mu[a[c]]]=c}}dispose(){this.DOa.dispose();kb.a.xNf(this.Fy);this.Fy=null}get htmlElement(){return this.DOa.htmlElement}get visible(){return this.DOa.visible}get wYe(){return this.Mfg}set wYe(a){this.Mfg=
a}get plf(){return this.kqg}set plf(a){this.kqg=a}get entries(){return this.Fy}set entries(a){this.Fy=a}Sca(a){for(let c=0;c<this.Fy.length;c++)if(this.Fy[c].id===a)return!0;return!1}Jz(a,c=!1,h=null,v=null,B=null){a.NN=this;let X=this.K3k(a.id);c&&!this.cQb&&(X=0);X<nu.VBb&&(this.DOa.yHi(a,X),this.Fy.length>=nu.VBb&&this.DOa.LJh(this.Fy[nu.VBb-1]),this.DOa.v7d());Array.insert(this.Fy,X,a);r.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",mu[a.id],void 0===a.NTa||
null===a.NTa?"":a.NTa);a.errorCode&&l.AFrameworkApplication.kP(a.errorCode,h,v,B)}removeEntry(a){const c=Array.indexOf(this.Fy,a);-1!==c&&c<nu.VBb&&(this.Fy.length>nu.VBb&&this.DOa.yHi(this.Fy[nu.VBb],nu.VBb),this.DOa.LJh(a),this.DOa.v7d());Array.remove(this.Fy,a);a.NN=null;a.dispose()}K3k(a){if(!this.cQb||0===a)return this.Fy.length;a=this.cQb[mu[a]];if(void 0===a||null===a)return this.Fy.length;for(let c=0;c<this.Fy.length;c++)if(a<this.cQb[mu[this.Fy[c].id]])return c;return this.Fy.length}}nu.VBb=
2;Object(w.a)(nu,"BusinessBar",null,[998,14,999]);class OA{create(a,c,h){return new oh.a(a,c,h)}}Object(w.a)(OA,"Factory",null,[1028]);class PA{static hbk(a,c){a.register(nu,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").singleInstance().Pc(()=>new nu(c.value,0,a.ra("CommonUI.IBusinessBarRankProvider")));a.register(OA,"CommonUI.BusinessBarEntry.Factory").as("CommonUI.IBusinessBarEntryFactory").singleInstance()}}Object(w.a)(PA,"CommonUIComponentConfiguration",null,[]);var QA=b(1490);class ek extends QA.a{constructor(){super()}static get instance(){return ek._instance||
ek.Qff()}static Qff(){ek._instance=new ek;return ek._instance}}ek._instance=null;Object(w.a)(ek,"ReactRootManager",QA.a,[533,534]);class rv extends qh.a{constructor(){super()}get ControlType(){return 3}}Object(w.a)(rv,"CompoundButtonProps",qh.a,[]);class os{constructor(a,c,h,v,B,X,ma){this.tQ=c;this.Ypc=a;this.zog=c.OJl;this.cOb=c.$Jc;this.Ine=X;this.c8c=v;this.d8c=B;this.Kmb=h;this.lu=ma;this.H4a=new gd.a;this.H4a.Z(1,"SpellingIssue_16x16x32");this.H4a.Z(2,"GrammarIssue_16x16x32");this.H4a.Z(3,"WritingIssue_16x16x32");
this.H4a.Z(4,null);this.H4a.Z(0,null)}create(a,c,h){c=Object(ha.a)(En.a,c);if(!c)return r.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const v=new Sys.StringBuilder;a=this.dxh(a);this.Ayc(v,c,h,a);this.fUe(v,c);this.Ukk(v,c,a);return v.toString()}dub(a,c,h){const v=Object(ha.a)(En.a,c);if(!v)return r.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];c=[];a=this.dxh(a);this.LUe(c,v,h,a);this.gUe(c,v);this.Vkk(c,v,a);for(h=0;h<c.length;h++)c[h].Id=
`${Dr.ogh}_${h}`;return c}Ayc(a,c,h,v=null){c.errorType?1===c.errorType&&(this.hYb(c)||a.append(this.wNe(c,h,v))):a.append(this.Ypc.build())}LUe(a,c,h,v=null){c.errorType?1===c.errorType&&(this.hYb(c)||a.push(this.kWj(c,h,v))):a.push(this.Ypc.dYg())}fUe(a,c){const h=new Sys.StringBuilder;this.oIi(c)?h.append(jf.a("btnIgnoreAllSpellingError",(2===c.errorType?zb.a.QCa:zb.a.ija).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.hYb(c)||h.append(jf.a("btnIgrnoreSpellingError",this.fwh(c.errorType).toString(),
Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.vIi(c)&&(this.tQ.sRh&&h.append(jf.a("btnDoNotCheckForThisIssue",zb.a.gvb.toString(),Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),h.append(jf.a("btnGrammarOptions",zb.a.SAa.toString(),F.a.Wd(Box4Intl.Box4Strings.l_GrammarOptions),null)));h.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(h.toString()),a.append("</Controls></MenuSection>"))}gUe(a,c){const h=Object.assign(new Hg.a,
{ControlList:[]});if(this.oIi(c)){var v=Js.a.hx()?Object.assign(new qh.a,{ExternalId:"btnIgnoreAllSpellingErrorForAL",Command:zb.a.ija,LabelText:Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors}):Object.assign(new qh.a,{ExternalId:2===c.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});h.ControlList.push(v)}else this.hYb(c)||(v=Object.assign(new qh.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.fwh(c.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),
h.ControlList.push(v));this.vIi(c)&&(this.tQ.sRh&&(c=Object.assign(new qh.a,{ExternalId:"DoNotCheckForThisIssue"}),h.ControlList.push(c)),c=Object.assign(new qh.a,{ExternalId:"GrammerSettingsContext"}),h.ControlList.push(c));a.push(h)}dxh(a){if(!this.lu)return null;a=this.lu.language(this.lu.zr(a.sa));return vi.a.af(a)?vi.a.af(a).name:null}fwh(a){return 2===a?zb.a.QCa:this.tQ.wMl?zb.a.Rwl:zb.a.Eqa}Ukk(a,c,h=null){if(this.YRf(c)){var v=F.a.Wd(c.Js.CategoryTitle);v=jf.r(Dr.d8b,Sa.a.dha,this.H4a.J(c.proofingType),
""!==v?v:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.c8c,this.d8c);v=jf.e("cgProofingOuter",[v]);a.clear();a.append(jf.j("msProofingOuter",v,"Menu16",void 0,void 0,h,"ariaLabelledById"));r.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",c.proofingType,c.typeId)}}Vkk(a,c,h=null){if(this.YRf(c)){var v=F.a.Wd(c.Js.CategoryTitle);h=Object.assign(new ph.a,{ExternalId:String.format("{0}_{1}",Dr.d8b,c.proofingType),Command:Sa.a.dha.toString(),
Image16by16Class:this.H4a.J(c.proofingType),LabelText:""!==v?v:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:h,Menu:Object.assign(new Ah.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.kSk(c),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});h.Menu.MenuSectionList.push(...a);Array.clear(a);v=Object.assign(new Hg.a,{ControlList:[]});v.ControlList.push(h);a.push(v);r.ULS.sendTraceTag(39188234,375,
50,"Show 2-level context menu of type {0}, critique id {1}",c.proofingType,c.typeId)}}wNe(a,c,h=null){const v=this.f_k(a);var B=[];let X=!1;var ma=a.Js.Suggestions;if(ma)if(ma=ma.slice(0,Math.min(3,ma.length)),this.zog&&(X=!bj.a.any(ma,Pa=>!Pa||!Pa.Description)),1!==ma.length||ma[0].Action){let Pa=0,mb=null;X&&(mb="font-weight: bold;");for(const Tb of ma){if(!Tb)continue;ma=null;let rc="";const Tc=F.a.Wd(Tb.Text);X&&(ma=this.$qh(Tb.Description),rc=this.Zqh(Tb.Description));B.push(jf.a("btnCorrectWord"+
Pa,c[Pa].toString(),Tc,null,null,null,null,null,mb,null,ma,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,v,Tc),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.f7g(a.token)),"ariaDescribedById",rc));Pa++}}else c=F.a.Wd(ma[0].Text),B.push(jf.a("btnCorrectWord0",zb.a.QCa.toString(),c,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,
v,c)));c="Menu16";0<B.length?X&&(c="Menu16DescriptionEnabled"):B=[jf.a("btnNoSuggestions",zb.a.QCa.toString(),Box4Intl.Box4Strings.l_NoSuggestions,null)];return jf.j("msUnknownWord",jf.e(null,B),c,v,this.P6k(a),h,"ariaLabelledById")}kWj(a,c,h=null){var v=1!==a.proofingType&&0!==a.proofingType?a.Js.ExplanationTitle:"";v=Object.assign(new Hg.a,{Title:v,Lang:h,ControlList:[]});let B=!1;var X=a.Js.Suggestions;if(X)if(X=X.slice(0,Math.min(3,X.length)),this.zog&&(B=!bj.a.any(X,ma=>!ma||!ma.Description)),
1!==X.length||X[0].Action){let ma=0;for(const Pa of X){if(!Pa)continue;X=null;let mb="";B&&(X=this.$qh(Pa.Description),mb=this.Zqh(Pa.Description));if(ma>=c.length)break;X?(X=Object.assign(new rv,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",ma,a.proofingType),Command:c[ma].toString(),LabelText:Pa.Text,Description:X,Lang:h,AriaDescription:mb}),v.ControlList.push(X)):(X=Object.assign(new qh.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",ma,a.proofingType),
Command:c[ma].toString(),LabelText:Pa.Text,Lang:h,RoleInMenu:"menuitem"}),v.ControlList.push(X));ma++}}else a=X[0],a=Object.assign(new qh.a,{ExternalId:"NoSuggestion",Command:zb.a.QCa.toString(),LabelText:a.Text}),v.ControlList.push(a);0>=v.ControlList.length&&Array.add(v.ControlList,Object.assign(new qh.a,{ExternalId:"btnNoSuggestions",Command:zb.a.QCa.toString(),LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));return v}f_k(a){return F.a.Wd(0!==a.proofingType?a.Js.ExplanationTitle:"")}P6k(a){return this.YRf(a)?
null:this.H4a.J(a.proofingType)}YRf(a){return this.cOb&&2!==a.errorType&&(1!==a.errorType||!this.hYb(a))}oIi(a){return this.Ine&&!!a.errorType&&1===a.proofingType&&!this.hYb(a)}kSk(a){return 1===a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.f7g(a.token)):""}vIi(a){return this.tQ.KJd&&this.cOb&&1===a.errorType&&(2===a.proofingType||3===a.proofingType)}hYb(a){return!!a.errorType&&!!this.Kmb&&this.Kmb.contains(a.token,a.lcid)}$qh(a){return""===
a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}Zqh(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,a):""}f7g(a){let c="";if(a){let h;for(h=0;h<a.length-1;h++)c=c+a.charAt(h)+",";c+=a.charAt(h)}return c}}Object(w.a)(os,"EditorServiceProofingContextMenuCreator",null,[]);class ou{get ranking(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,36,25,26,27,28,29,30,31,32,33,34,35,37,40,41,42,43,44,45,46]}}Object(w.a)(ou,
"BusinessBarRankProvider",null,[567]);class bw{constructor(){this.W=null}get name(){return"Wonca.UI"}yb(a){this.W=a;a.ha("CommonUI.IBusinessBarRankProvider",()=>new ou).singleInstance();PA.hbk(a,new qf.a(()=>Eb.App.oa.bia));a.ha("Box4.UI.EditorServiceProofingContextMenuCreator",()=>new os(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),l.AFrameworkApplication.zO,l.AFrameworkApplication.qp,
l.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),a.resolve("Box4.IFormattingReader"))).singleInstance();a.ha("CommandUI.ReactRootManager",()=>ek.instance).as("Common.IReactRootManager").singleInstance()}init(){this.W.resolve("Wonca.IRibbonUserFactory");this.W.resolve("CommonUI.IBusinessBar")}dispose(){}static main(){M.a.instance.Lb(new bw)}}Object(w.a)(bw,"WoncaUIPackage",null,[1,2]);class hz{constructor(a){this.mL=this.Xnc=null;this.tl=a}get key(){return"BOOKMARK"}get $u(){return WordEditorIntl.WordEditorStrings.L_Bookmark}get ypa(){return this.mL}reset(a){this.mL=
a.node}ICa(a){let c=null;l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.BookmarksIsEnabled");if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)){if(this.Xnc&&this.tl.Uwb(this.ypa,a)==this.Xnc)return c=Object.assign(new Bu.a,{mE:this.key,contentObject:this.Xnc}),{returnValue:!0,bF:c};this.Xnc=null;const h=new Kd.GraphIterator;h.set(this.ypa.Eh());this.tl.G5b(h);if(this.tl.ZPh(h)){let v=h.Xc();for(;v;){if(this.tl.Uwb(this.ypa,
a)==v)return this.Xnc=v,c=Object.assign(new Bu.a,{mE:this.key,contentObject:v,description:this.wab()}),{returnValue:!0,bF:c};v=h.ni()}}}return{returnValue:!1,bF:c}}wab(){return null}}Object(w.a)(hz,"BookmarkDetailsProvider",null,[430,431]);var Us=b(479);class ut{constructor(a,c,h,v,B=null){this.Wng=this.rg=!1;this.bbd=this.LPb=null;this.dw=h;this.Me=v;this.Mu=c;this.$$f=a;this.Cz=B}get wC(){return this.Mu.value}initialize(){this.fJf();this.rg=!0}Vud(a=!1){if(!this.rg)return r.ULS.sendTraceTag(24262273,
324,10,"BookmarkGraphManager not initialized"),!1;if(!a&&this.Wng)return!0;let c=!1;this.Me.$c(()=>{this.LPb={};this.bbd={};if(this.wC){const h=new Kd.GraphIterator;h.set(this.wC);if(this.nfm(h)){if(h.Za(1)){do this.qEj(h.currentNode);while(h.ue(1))}c=this.Wng=!0}}},"BGM:EBGL");return c}Qqh(a){var c,h,v,B;if(!this.Vud())return null;const X=new Ua.a;if(a.toString()in this.LPb){const ma=this.LPb[a.toString()];for(let Pa of ma)(Us.a.isEnabled?this.Cz.mha.has(null===(c=Pa.id)||void 0===c?void 0:c.toString())&&
this.Cz.mha.get(null===(h=Pa.id)||void 0===h?void 0:h.toString()).equals(a)&&this.Cz.jTa.has(null===(v=Pa.id)||void 0===v?void 0:v.toString())&&this.Cz.jTa.get(null===(B=Pa.id)||void 0===B?void 0:B.toString()).equals(a):Pa.hasProperty(Yb.a.z5)&&Pa.properties.getValue(Yb.a.z5).equals(a)&&Pa.hasProperty(Yb.a.Zxa)&&Pa.properties.getValue(Yb.a.Zxa).equals(a))?X.add(Pa):r.ULS.sendTraceTag(24155015,324,100,"GetBookmarksInParagraph: bookmarkNode does not have same paragraph for start and end value (shouldn't happen for TOC)")}return X}mca(a){return this.Vud()?
a in this.bbd?this.bbd[a]:null:null}dispose(){this.rg?this.xKn():r.ULS.sendTraceTag(24262275,324,50,"BookmarkGraphManager not initialized")}nfm(a){if(this.dw.aS(a))return(a=a.Za(30))||r.ULS.sendTraceTag(24691921,324,10,"Graph does not contain BookmarkContainer"),a;r.ULS.sendTraceTag(24691922,324,15,"Unable to move to Page Manifest");return null}fJf(){r.ULS.sendTraceTag(24691923,324,50,"Registering OnBookmarkContainerNodeLoaded");this.$$f.eQg(Object(m.a)(this,this.h$h,"onBookmarkContainerNodeLoaded"))}xKn(){r.ULS.sendTraceTag(24691924,
324,50,"Unregistering OnBookmarkContainerNodeLoaded");this.$$f.Tri(Object(m.a)(this,this.h$h,"onBookmarkContainerNodeLoaded"))}h$h(a,c){a=c.node;1074135152!==a.Gb?r.ULS.sendTraceTag(24155018,324,10,"node.RuntimeClassId = {0}",a.Gb):(r.ULS.sendTraceTag(24155019,324,50,"OnBookmarkContainerNodeLoaded: Refreshing out of date bookmarks"),this.Vud(!0))}qEj(a){var c,h,v,B;a?(this.hOg(Us.a.isEnabled?null!==(h=this.Cz.mha.get(null===(c=a.id)||void 0===c?void 0:c.toString()))&&void 0!==h?h:N.a.nil:a.properties.ia(Yb.a.z5,
N.a.nil),a),this.hOg(Us.a.isEnabled?null!==(B=this.Cz.jTa.get(null===(v=a.id)||void 0===v?void 0:v.toString()))&&void 0!==B?B:N.a.nil:a.properties.ia(Yb.a.Zxa,N.a.nil),a),(c=a.properties.ia(Yb.a.Vr,null))&&(this.bbd[c]=a)):r.ULS.sendTraceTag(24155022,324,50,"Node is null")}hOg(a,c){a===N.a.nil?r.ULS.sendTraceTag(24155023,324,50,"paraNodeId is null"):(a=a.toString(),a in this.LPb||(this.LPb[a]=new Ua.a),a=this.LPb[a],a.contains(c)||a.add(c))}}Object(w.a)(ut,"BookmarkGraphManager",null,[667]);class Pw{constructor(a,
c){this.uba=a;this.h9i=c}get yEb(){return this.h9i}}Object(w.a)(Pw,"FoundBookmarkRangeObject",null,[597]);class Eq{constructor(a,c=null){this.BOa=a;this.$qd={};this.VWb={};this.Cz=c}mZa(a,c){if(a=this.BOa.Qqh(c.node.id)){r.ULS.sendTraceTag(24462027,3029,50,String.format("Removing {0} bookmarks from paraId {1}",a.count,c.node.id));for(let h of a)h.id.toString()in this.$qd&&(c=this.$qd[h.id.toString()],c.id.toString()in this.VWb?a=this.VWb[c.id.toString()]:(a=new Ua.a,this.VWb[c.id.toString()]=a),a.add(h),
delete this.$qd[h.id.toString()])}else r.ULS.sendTraceTag(24691925,3029,50,"Failed to get bookmarks on paragraph deletion")}Nzf(a,c){if(a=this.BOa.Qqh(c.original.id))for(let h of a)this.$qd[h.id.toString()]=c.clone;else r.ULS.sendTraceTag(24691926,3029,50,"Failed to get bookmarks on paragraph copy")}Pzf(a,c){var h,v;if(c.original.id.toString()in this.VWb){a=this.VWb[c.original.id.toString()];if(Us.a.isEnabled)for(let B of a)this.Cz.mha.set(null===(h=B.id)||void 0===h?void 0:h.toString(),c.clone.id),
this.Cz.jTa.set(null===(v=B.id)||void 0===v?void 0:v.toString(),c.clone.id);else for(let B of a)B.Uh(Yb.a.z5,c.clone.id),B.Uh(Yb.a.Zxa,c.clone.id);delete this.VWb[c.original.id.toString()];r.ULS.sendTraceTag(24691927,3029,50,"OnParagraphPaste: Refreshing out of date bookmarks");this.BOa.Vud(!0)}}Qbi(){r.ULS.sendTraceTag(36820239,3029,10,"New Interface Not Implemented!")}Ckd(){r.ULS.sendTraceTag(36471763,3029,10,"New Interface Not Implemented!");return!1}$Sb(){r.ULS.sendTraceTag(591730835,3029,10,
"New Interface Not Implemented!");return!1}jQd(){r.ULS.sendTraceTag(36209185,3029,10,"New Interface Not Implemented!")}mca(){r.ULS.sendTraceTag(34936480,3029,10,"New interface not implemented");return null}mab(){r.ULS.sendTraceTag(34936481,3029,10,"New interface not implemented");return null}Aia(){r.ULS.sendTraceTag(35992273,3029,10,"New Interface Not Implemented!");return new Pw(null,2)}Ozf(){r.ULS.sendTraceTag(35992274,3029,10,"New interface not implemented")}P8b(){r.ULS.sendTraceTag(573673489,
3029,10,"New interface not implemented")}yCc(){r.ULS.sendTraceTag(559228954,3029,10,"getAllBookmarks not implemented");return null}$5g(){r.ULS.sendTraceTag(524321507,3029,10,"containsBookmark not implemented");return!1}NJf(){r.ULS.sendTraceTag(559228956,3029,10,"removeBookmark not implemented");return!1}R9e(){r.ULS.sendTraceTag(553951760,3029,10,"getParaNodesFromBookmarkName not implemented");return null}Pqh(){r.ULS.sendTraceTag(544814809,3029,10,"getBookmarkNameForHeading not implemented");return null}wGh(){r.ULS.sendTraceTag(544777299,
3029,10,"goToBookmark not implemented")}Uwb(){r.ULS.sendTraceTag(545118154,3029,10,"getEnclosingBookmark not implemented");return null}G5b(){r.ULS.sendTraceTag(540382879,3029,10,"moveToBookmarkContainer not implemented");return null}ZPh(){r.ULS.sendTraceTag(540382880,3029,10,"isBookmarkContainer not implemented");return null}tTi(){r.ULS.sendTraceTag(525133728,3029,10,"updateBookmarkNameOnly not implemented");return!1}}Object(w.a)(Eq,"BookmarkManager",null,[563]);var Qw=b(726),EC=b(989);class lq{create(){return new EC.a}}
Object(w.a)(lq,"BookmarkContainerNodeFactory",null,[472]);class iz{constructor(a,c,h,v=null){this.ak=c;this.tl=h;this.Y8i=v||new lq}init(){Qw.a.MQm(Object(m.a)(this.tl,this.tl.jQd,"onAfterFullBookmarkRangeDeleted"));this.ak.FIe(Object(m.a)(this,this.Qbi,"onParagraphDeleteForTables"));dk.EIe(Object(m.a)(this,this.Nzf,"onParagraphCopy"));dk.tld(Object(m.a)(this,this.Pzf,"onParagraphPaste"))}Qbi(a,c){this.tl.Ozf(c)}Nzf(a,c){var h=this.olh(c.clone);a=c.original.Mb;const v=new od.a;for(let B of h)h=B.zm.toString(),
v.Ja(h)||(v.add(h,!0),(h=a.Ra(B.zm))&&!h.anchor&&(h=this.tl.mab(B.zm)),h?h.anchor?this.Iek(h,c.clone):r.ULS.sendTraceTag(573673488,324,15,String.format("BookmarkNode ObjId:{0} Id:{1} as no anchor",h.id,h.ia(Yb.a.Gsb,-1))):r.ULS.sendTraceTag(573673487,324,15,"BookmarkNode null"))}Pzf(a,c){a=c.clone;c=this.olh(a);this.tl.P8b(a,c)}olh(a){const c=new Ua.a;for(let h=0;h<a.la.length;h++){const v=a.la.J(h);if(v.Nh)for(let B=0;B<v.Nh.length;B++)c.add(v.Nh.J(B))}return c}Iek(a,c){var h=c.Eh().Lc;h=Nr.a(a,
h,!0);c=Kd.GraphIterator.va(c);this.kBk(c);c.Za(30);c.h3(h,1,a.id);c.qh(h)}kBk(a){if(a.La(25)&&a.mc(25)&&!a.pp(30)){const c=this.Y8i.create(1074135152);a.Je(c,30)}}}Object(w.a)(iz,"BookmarksEventHandler",null,[]);var yr=b(274),FB=b(442),GB=b(1025),wx=b(138),FC=b(927);class cw{create(){return new FC.a}}Object(w.a)(cw,"BookmarkNodeFactory",null,[472]);class kj{constructor(a,c,h,v,B,X,ma,Pa=null,mb,Tb=null){this.naa="_";this.dag=40;this.Qvj=" ";this.Mu=a;this.dw=c;this.Tb=h;this.Zqe=v;this.Fb=B;this.Ba=
X;this.ya=ma;this.g9i=Pa||new cw;this.Cz=Tb}eBd(a,c){return a?this.Cz.mha.get(null===c||void 0===c?void 0:c.toString()):this.Cz.jTa.get(null===c||void 0===c?void 0:c.toString())}get wC(){return this.Mu.value}get iDa(){return this.Zqe.value}Ckd(a,c){if(!c||!c.sa||!c.Pb)return r.ULS.sendTraceTag(36471765,3029,15,"There is no selection"),!1;const h=c.sa.node,v=c.Pb.node,B=yr.a.xab(c,!0);c=yr.a.xab(c,!1);return this.$Sb(a,B,c,h,v)}$Sb(a,c,h,v,B,X=!1){r.ULS.sendTraceTag(545642374,3029,50,String.format("removeExisting value is: {0}",
X));const ma=this.mca(a);if(ma)if(X)this.Ppi(ma);else return r.ULS.sendTraceTag(36471764,3029,50,"Unable to add bookmark because name already exists"),!1;if(!v||!B)return r.ULS.sendTraceTag(591730833,3029,50,"Missing Paragraph info while adding bookmark"),!1;X=this.Fb.Ob(15);X.Oa(this.iDa);a=this.YBj(a);if(!a)return!1;this.UBj(v,c,a,B,h);X.dispose();return!0}mca(a){r.ULS.shipAssertTag(34936482,3029,!!a);return this.slh(c=>a===c.properties.ia(Yb.a.Vr,null))}mab(a){return a&&a!==N.a.nil?this.slh(c=>
a.equals(c.id)):(r.ULS.sendTraceTag(543424735,3029,10,"Unable to find BookmarkNode when node id is null"),null)}jQd(a){const c=this.mab(a);c?(r.ULS.sendTraceTag(36844636,3029,50,String.format("Removing bookmark {0}",a.toString())),this.Opi(c),this.zSc(c)):r.ULS.sendTraceTag(36569436,3029,15,"Unable to find BookmarkNode for full bookmark range deletion")}Aia(a,c){var h;const v=Us.a.isEnabled?null!==(h=this.eBd(c,a.id))&&void 0!==h?h:N.a.nil:a.ia(c?Yb.a.z5:Yb.a.Zxa,N.a.nil);if(v===N.a.nil)return r.ULS.sendTraceTag(36218377,
3029,10,"ParaId not on Bookmark"),new Pw(null,2);h=this.wC.Lc.Ra(v);return h?h.isConnected?this.getBookmarkRange(h,a,c):(r.ULS.sendTraceTag(36766421,3029,50,"Paragraph not loaded"),new Pw(null,3)):(r.ULS.sendTraceTag(36766420,3029,10,"Unable to get paragraph from object space"),new Pw(null,2))}Ozf(a){const c=this.oJk(a);c[Symbol.iterator]().next().done||this.kfm(a,c)}P8b(a,c){const h=new Ua.a;let v=0,B=!1;for(let X of c)X&&X.Xa.Nh?(v++,X.Xa.Nh.remove(X),0<=X.zd&&X.zd<a.wordRunProperties.length&&(X.Xa.cp||
(B=!0),h.add(X.zd))):r.ULS.sendTraceTag(36569441,3029,15,"BookmarkRangeObject to remove is null");a.Rka(!0,h);r.ULS.sendTraceTag(36844637,3029,50,String.format("Removed {0} bookmark anchors | idsToRemove: {1}",v,h.count));B&&!a.wordRunProperties.length&&a.wordRunProperties.append(kq.CharacterPropertiesEditor.ZO,1024)}yCc(a=!1){r.ULS.sendTraceTag(559228943,3029,50,"Fetching bookmarks with includeHidden: {0}",a);const c=new Ua.a,h=Kd.GraphIterator.va(this.wC);if(null!==this.G5b(h)){var v=h.ro();r.ULS.sendTraceTag(559228944,
3029,50,"Bookmarks count: {0}",v);if(0<v)for(v=h.Xc();null!==v;){let B=v.ia(Yb.a.Vr,"");F.a.ve(B)||(a?c.add(v):B.startsWith(this.naa)||c.add(v));v=h.ni()}}!a&&0<c.count&&r.ULS.sendTraceTag(556889755,3029,50,"User Bookmarks count: {0}",c.count);return c}$5g(a=!1){r.ULS.sendTraceTag(524321506,3029,50,"Finding bookmarks with includeHidden: {0}",a);const c=Kd.GraphIterator.va(this.wC);if(null!==this.G5b(c)&&0<c.ro()){var h=c.Xc();if(a&&h)return!0;for(;null!==h;){h=h.ia(Yb.a.Vr,"");if(!F.a.ve(h)&&(a||
!h.startsWith(this.naa)))return!0;h=c.ni()}}return!1}R9e(a){var c=this.mca(a);let h=new Ua.a;if(c){a=Us.a.isEnabled?this.eBd(!0,c.id):c.properties.getValue(Yb.a.z5);c=Us.a.isEnabled?this.eBd(!1,c.id):c.properties.getValue(Yb.a.Zxa);var v=this.wC.Lc.Ra(a);v&&h.add(v);if(a.equals(c))return h;a=v;do(a=v=this.Ba.jg(a,!1,!1,!0))&&h.add(v);while(v&&!v.id.equals(c))}else r.ULS.sendTraceTag(553927448,3029,10,"bookmark not exist with the {0}",a);return h}NJf(a){if(null===a)return r.ULS.sendTraceTag(559228951,
3029,50,"Cannot remove bookmark as id is null"),!1;a=this.mab(a);return this.Ppi(a)}Pqh(a){let c="",h=a.id;a=a.characterData.split(this.Qvj);for(let v=0;3>v&&v<a.length;v++)c+=this.naa+a[v];c.length>this.dag&&(c=c.substring(0,this.dag));return this.i0i(c,h)}i0i(a,c){const h=this.yCc(!0);let v=[],B;for(let ma=0;ma<h.count;ma++){var X=h.J(ma);B=X.ia(Yb.a.Vr,"");X=Us.a.isEnabled?this.eBd(!0,X.id):X.getValue(Yb.a.z5);B.startsWith(a)&&!c.equals(X)&&v.push(B)}return 0<v.length?(v.sort((ma,Pa)=>ma.localeCompare(Pa,
void 0,{numeric:!0})),(c=v[v.length-1].substring(a.length+1))?a+this.naa+(parseInt(c)+1):a+this.naa+1):a}wGh(a){F.a.ve(a)?r.ULS.sendTraceTag(544777296,3029,10,"Cannot navigate to bookmark as name is null"):(a=this.mca(a),null===a?r.ULS.sendTraceTag(544777297,3029,10,"No bookmark with given name exists"):(a=this.Aia(a,!0))?(a=ne.SelectionFactory.vd(a.uba.paragraph,a.uba.Xa.cp))&&this.ya.setSelection(a):r.ULS.sendTraceTag(544777298,3029,10,"No start found for bookmark. Document is corrupted"))}Ppi(a){if(!a)return r.ULS.sendTraceTag(559228888,
3029,15,"Could not find bookmark node with given id"),!1;r.ULS.sendTraceTag(559228889,3029,50,String.format("Removing bookmark {0}",a.id));const c=this.Fb.Ob(15);c.Oa(this.iDa);this.Opi(a);this.zSc(a);c.dispose();return!0}Uwb(a,c){if(!a||0>c)return r.ULS.sendTraceTag(545118153,3029,10,String.format("Got null paragraph or negative cp value")),null;let h=null,v=new Ua.a,B=new Ua.a;var X=a.la;for(var ma=0;ma<X.length;ma++){var Pa=X.J(ma);if(Pa.cp>c||Pa.cp===c&&0<v.count)break;if(Pa.Nh){var mb=Pa.Nh;
if(2===mb.length&&mb.J(0).zm.equals(mb.J(1).zm)&&Pa.cp===c){v.add(mb.J(0).zm.toString());break}for(let Tb=0,rc=mb.length;Tb<rc;Tb++){Pa=mb.J(Tb);const Tc=a.Mb.Ra(Pa.zm).ia(Yb.a.Vr,"");F.a.ve(Tc)||Tc.startsWith(this.naa)||(Pa.Nb?v.add(Pa.zm.toString()):v.contains(Pa.zm.toString())?v.remove(Pa.zm.toString()):B.add(Pa.zm.toString()))}}}0<v.count&&(h=a.Mb.Ra(N.a.Ee(v.J(v.count-1))));if(!h)for(c=sd.ParagraphReader.jg(a,!0);c&&!h;){for(X=0;X<c.la.length;X++)if(ma=c.la.J(X),ma.Nh){ma=ma.Nh;for(let Tb=0,
rc=ma.length;Tb<rc;Tb++)mb=ma.J(Tb),Pa=a.Mb.Ra(mb.zm).ia(Yb.a.Vr,""),F.a.ve(Pa)||Pa.startsWith(this.naa)||(mb.Nb?B.contains(mb.zm.toString())?B.remove(mb.zm.toString()):v.add(mb.zm.toString()):v.contains(mb.zm.toString())?v.remove(mb.zm.toString()):B.add(mb.zm.toString()))}0<v.count?h=c.Mb.Ra(N.a.Ee(v.J(v.count-1))):c=sd.ParagraphReader.jg(c,!0)}return h}tTi(a,c){if(null===a)return r.ULS.sendTraceTag(525111647,3029,10,"Bookmark node is null"),!1;if(this.kHl(c)||this.Rxk(c))return!1;const h=this.Fb.Ob(15);
h.Oa(this.iDa);this.YLn(a,c);h.dispose();return!0}slh(a){if(!this.wC)return r.ULS.sendTraceTag(34936483,3029,10,"PageNode is null"),null;const c=new Kd.GraphIterator;c.set(this.wC);if(!this.G5b(c))return r.ULS.sendTraceTag(34936512,3029,10,"Unable to move to BookmarkContainer"),null;if(!c.Za(1))return null;do{const h=c.currentNode;if(a(h))return h}while(c.ue(1));return null}getBookmarkRange(a,c,h){for(let v=0;v<a.la.length;v++){const B=a.la.J(v);if(B.Nh)for(let X=0;X<B.Nh.length;X++){const ma=B.Nh.J(X);
if(ma.zm.equals(c.id)&&h===ma.Nb)return new Pw(ma,0)}}r.ULS.sendTraceTag(36729310,3029,15,"paragraph {0} did not contain bookmarkNode id:{1}, isStart: {2} ({3}), had {4} chps | Path: {5}",a.id,c.ia(Yb.a.Gsb,-1),h,c.id,a.la.length,this.wI(a));return new Pw(null,1)}G5b(a){if(this.dw.aS(a))return a=a.Za(30),r.ULS.shipAssertTag(34936513,3029,!!a,"Graph does not contain BookmarkContainer"),a;r.ULS.sendTraceTag(34936514,3029,15,"Unable to move to Page Manifest");return null}oJk(a){const c=new od.a;for(let h=
0;h<a.la.length;h++){const v=a.la.J(h);if(v.Nh)for(let B=0;B<v.Nh.length;B++){const X=v.Nh.J(B),ma=X.zm.toString();c.Ja(ma)?(r.ULS.shipAssertTag(36218379,3029,X.Nb!==c.J(ma).Nb),c.remove(ma)):c.add(ma,X)}}return c.values}kfm(a,c){this.P8b(a,c);this.Rem(a,c)}Rem(a,c){let h=sd.ParagraphReader.jg(a,!1,!0);a=sd.ParagraphReader.jg(a,!0,!0);h||a?(h||this.BWg(c,!0)&&r.ULS.sendTraceTag(36320843,3029,15,"No next paragraph but have start bookmarks to move, falling back to prev paragraph."),a||this.BWg(c,!1)&&
r.ULS.sendTraceTag(36320844,3029,15,"No prev paragraph but have end bookmarks to move, falling back to next paragraph."),h=h||a,a=a||h,this.b6h(h,c,0,!0),this.b6h(a,c,a.la.last.cp,!1)):r.ULS.sendTraceTag(36218381,3029,15,"Both paragraphs are null.")}BWg(a,c){for(let h of a)if(c===h.Nb)return!0;return!1}b6h(a,c,h,v){const B=new Ua.a;h=this.WCc(a,h);for(let X of c)X.Nb===v&&(h?(c=this.$Bj(a,v,h,X.zm))&&B.add(c):r.ULS.shipAssertTag(36218382,3029,!0,"Null chp. isStart={0}",v));B.count&&(a.rl(),this.hdc(a,
B),r.ULS.sendTraceTag(36844638,3029,50,String.format("Added {0} bookmark anchors | isStart: {1}",B.count,v)))}$Bj(a,c,h,v){const B=this.mab(v);return B?this.Jtc(a,c,h,B):(r.ULS.sendTraceTag(40445218,3029,15,String.format("BookmarkNode {0} null while trying to add range",v)),null)}Jtc(a,c,h,v){var B;if(!v)return r.ULS.sendTraceTag(591730834,3029,10,String.format("BookmarkNode null while trying to add range")),null;if(!h)return r.ULS.sendTraceTag(543424736,3029,10,String.format("Chp null while trying to add range")),
null;h.Nh||(h.Nh=new FB.a(h));const X=new GB.a(h,null,v.id,c);h.Nh.add(X);Us.a.isEnabled?(c?this.Cz.mha:this.Cz.jTa).set(null===(B=v.id)||void 0===B?void 0:B.toString(),a.id):v.setValue(c?Yb.a.z5:Yb.a.Zxa,a.id);return X}hdc(a,c){if(c){r.ULS.sendTraceTag(36218384,3029,50,"BookmarksToUpdate.Count:{0}",c.count);c.Sc((h,v)=>h.zd-v.zd);for(let h=0;h<c.count;h++){const v=c.J(h);v.zd?a.wordRunProperties.DX(v.zd-1,1024):a.wordRunProperties.Lqa(v.zd,1024);a.wordRunProperties.yp.Z(v.zd,kq.CharacterPropertiesEditor.ZO);
a.wordRunProperties.Jr.Z(v.zd,kq.CharacterPropertiesEditor.bS)}}else r.ULS.shipAssertTag(36218383,3029,!1,"Null BookmarksToUpdate.")}WCc(a,c){r.ULS.shipAssertTag(36471766,3029,c<=a.la.last.cp,"Cp to split at greater than last Chp.Cp in paragraph");if(a.la.last.cp===c){var h=a.la.length-1;if(!a.la.J(h).formatting)for(var v=h-1;0<=v;v--){var B=a.la.J(v);if(B.formatting){this.Tb.KV(a,h,c,B.formatting);break}}return a.la.last}h=null;for(v=0;v<a.la.length;v++){B=a.la.J(v);if(B.cp>=c){if(B.cp>c||!B.formatting)this.Tb.KV(a,
v,c,h),B=a.la.J(v);B.Nh||(B.Nh=new FB.a(B));r.ULS.shipAssertTag(36471768,3029,B!==a.la.last);return B}B.formatting&&(h=B.formatting)}return null}YBj(a){const c=new Kd.GraphIterator;c.set(this.wC);if(!this.G5b(c))return r.ULS.sendTraceTag(36471769,3029,10,"Unable to move to BookmarkContainer"),null;a=this.mgk(a);c.h3(a,1,null);c.qh(a);return a}mgk(a){const c=this.g9i.create(1074135153);c.setValue(Yb.a.Vr,a);c.setValue(Yb.a.Gsb,uf.a.nE());return c}zSc(a){if(a&&a.anchor){r.ULS.sendTraceTag(36729311,
3029,100,"Removed bookmark with id:{0}, ({1})",a.ia(Yb.a.Gsb,-1),a.id);var c=new Kd.GraphIterator;c.set(a);c.La(64);c.xf()}}wI(a){const c=[];let h=0;for(;a.anchor.gr&&7!==a.type;)c[h]=wx.a[a.type],a=a.anchor.gr.Iq.node,h++;c[h]=wx.a[a.type];return c.join(" ")}YLn(a,c){a.setValue(Yb.a.Vr,c)}Opi(a){const c=this.Aia(a,!0).uba;a=this.Aia(a,!1).uba;if(c&&a&&c.paragraph===a.paragraph){let h;this.P8b(c.paragraph,(h=new Ua.a,h.add(c),h.add(a),h))}else{if(c){let h;this.P8b(c.paragraph,(h=new Ua.a,h.add(c),
h))}if(a){let h;this.P8b(a.paragraph,(h=new Ua.a,h.add(a),h))}}}UBj(a,c,h,v,B){l.AFrameworkApplication.Mg("4iaia520;85458494");if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkCrashFixEnabled",!1)){var X=this.Jtc(a,!0,this.WCc(a,c),h);a.rl();var ma;this.hdc(a,(ma=new Ua.a,ma.add(X),ma));h=this.Jtc(v,!1,this.WCc(v,B),h);v.rl();this.hdc(a,(ma=new Ua.a,ma.add(h),ma))}else if(ma=this.Jtc(a,!0,this.WCc(a,c),h),h=this.Jtc(v,!1,this.WCc(v,B),h),a.rl(),a.equals(v))this.hdc(a,
(X=new Ua.a,X.add(ma),X.add(h),X));else{let Pa;this.hdc(a,(Pa=new Ua.a,Pa.add(ma),Pa));v.rl();let mb;this.hdc(v,(mb=new Ua.a,mb.add(h),mb))}}ZPh(a){return!!a&&64===a.Md}kHl(a){return F.a.ve(a)?(r.ULS.sendTraceTag(559228948,3029,50,"bookmark name is null or empty"),!0):!1}Rxk(a){return null!==this.mca(a)?(r.ULS.sendTraceTag(559228949,3029,50,"Not updating bookmark name as a bookmark node with same name exists."),!0):!1}}Object(w.a)(kj,"FullBookmarkManager",null,[563]);class Dt{constructor(){this.BOa=
this.Wm=this.W=null}get name(){return"WordEditor.Bookmark"}yb(a){this.W=a;this.Wm=this.W.resolve("Box4.INotebookManager").Pk;const c=new kj(new qf.a(()=>Eb.App.oa.Da.Zb),jn.PageNavigator.instance,this.W.resolve("Box4.ICharacterPropertiesEditor"),new qf.a(()=>Eb.App.oa.Da.Jb.sc),Fk.a.instance,this.W.resolve("Box4.IParagraphReader"),this.W.resolve("Box4.SelectionManager"),null,null,this.W.resolve("Box4.BookmarkParagraphMapping"));this.W.ha("WordEditor.Bookmark.FullBookmarkManager",()=>c).as("WordEditor.Bookmark.IBookmarkManager").singleInstance();
this.W.ha("WordEditor.Bookmark.BookmarksEventHandler",()=>new iz(this.Wm.Yd(12),this.W.resolve("WordEditor.ITableEditor"),this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).singleInstance();S.App.z8d&&(this.BOa=new ut(this.Wm.Yd(64),new qf.a(()=>Eb.App.oa.Da.Zb),jn.PageNavigator.instance,Fo.a.instance,this.W.resolve("Box4.BookmarkParagraphMapping")),this.W.ha("WordEditor.Bookmark.BookmarkGraphManager",()=>this.BOa).as("WordEditor.Bookmark.IBookmarkGraphManager").singleInstance())}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>
{this.El()})}dispose(){this.BOa.dispose()}El(){r.ULS.sendTraceTag(36209186,324,50,"Registering paragraph events");if(S.App.v8d)this.W.resolve("WordEditor.Bookmark.BookmarksEventHandler").init();else if(S.App.z8d){this.BOa.initialize();const a=new Eq(this.BOa,this.W.resolve("Box4.BookmarkParagraphMapping"));this.Wm.Yd(12).Mt(Object(m.a)(a,a.mZa,"onParagraphDelete"));dk.EIe(Object(m.a)(a,a.Nzf,"onParagraphCopy"));dk.tld(Object(m.a)(a,a.Pzf,"onParagraphPaste"))}r.ULS.sendTraceTag(24691930,324,50,"Finish registering paragraph events");
this.TQm(this.W.za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("WordEditor.Bookmark.FullBookmarkManager"))}TQm(a,c){a&&a.execute(h=>{h.j1(new hz(c))})}static main(){M.a.instance.Lb(new Dt)}}Object(w.a)(Dt,"BookmarkPackage",null,[1,2]);var Rw=b(783),RA=b(922),Zz=b(1359),zr=b(1219);class ps extends zr.a{constructor(a){super();this.Lyj=a}get index(){return 3}run(){this.Lyj()}YI(){this.gY()}}Object(w.a)(ps,"FootnoteEndnoteGraphUpdateTracker",zr.a,[]);class xx{constructor(){this.d7c=
null}get name(){return"WordEditor.FootnoteEndnoteInteractive"}yb(){}init(){xx.Ua.pk.continueWith(()=>{this.El()})}El(){Rw.a.X$a=Zz.a.instance;this.Rdf()}dispose(){}Rdf(){this.d7c=new ps(()=>{Zz.a.instance.ht()});RA.a.CXd(Object(m.a)(this.d7c,this.d7c.YI,"setUpdateNeeded"));Wo.GraphTransactionManager.instance.Usa(this.d7c,3)}static get Ua(){return xa.a.instance.resolve("Box4.IFeatureHelper")}}Object(w.a)(xx,"PackageManager",null,[1,2]);var HB=b(698),iy=b(507),$z=b(461),jy=b(1465);class ky extends as{constructor(){super()}get $u(){return null}getTitle(a){a=
a.MVa();if(!a||!iy.a.instance.vja(a))return"";const c=new Sys.StringBuilder,h=iy.a.instance.X3(a);c.append(1===h?WordEditorIntl.WordEditorStrings.l_FootnoteContentTitle:WordEditorIntl.WordEditorStrings.l_EndnoteContentTitle);c.append(" ");c.append(iy.a.instance.xDc(a));return c.toString()}}Object(w.a)(ky,"FootnoteEndnoteBaseDetailsProvider",as,[]);class SA extends ky{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE"}get nh(){return 7}}Object(w.a)(SA,"FootnoteEndnoteDetailsProvider",ky,[]);
var Fq=b(1411),GC=b(1440),ly=b(1525);class IB extends ky{constructor(){super()}get key(){return"FOOTNOTE_ENDNOTE_REFMARK"}get nh(){return 10}}Object(w.a)(IB,"FootnoteEndnoteRefMarkDetailsProvider",ky,[]);class Ot{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh){this.ga=a;this.Fs=c;this.Q3c=h;this.Rb=v;this.aD=B;this.Hej=X;this.yEa=ma;this.bna=Pa;this.GA=mb;this.uj=Tb;this.TMb=rc;this.Fb=Tc;this.Gm=vd;this.Ta=ee;this.ZT=Ie;this.Bb=Xe;this.y6i=Yf;this.$cg=Hh;this.ojg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.footnoteApiIsEnabled",
!1)}wNh(a,c,h,v,B){v=c.view;if(!v.features.S3d||this.GA.WQh)return 8;const X=v.Ma.If;if(!X)return 2;if(this.Gm.Kba(X))return 8;v=a===ba.a.insertFootnote?1:0;var ma=this.Cyd(c);if(!ma)return r.ULS.sendTraceTag(3683158,308,10,"We expected a selection here."),8;c=!0;let Pa=ma.sa;ma=null;this.ojg&&(ma=B)&&ma.m3b&&ma.Jza&&(Pa=ma.Jza,l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DismissFootnoteEndnoteIsEnabled",!1)&&(c=!ma.keepCurrentFocus));if(l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisableRibbonItemsOnIframeSelection",!1)&&Ot.uf.J$(sd.ParagraphReader.EO,X)&&1===h)return 32;if(!Pa||!Gc.SelectionEditor.ke(Pa)||this.$cg.instance&&this.$cg.instance.lNl(Pa)||ch.HyperlinkReader.yja(Pa,!0))return 8;if(1===h)return 32;2===h&&(h=this.ZT.Pe("UserAction","InsertFootnoteEndnote"),a=this.Hej.mDl(Pa,v,a),this.ojg&&ma&&ma.m3b&&(ma.p8h=a),c&&this.FSd(a,!0,!0),h.stop(),this.Bb.Xq(6));return 32}S5b(a,c,h){const v=c.view;
if(a===ba.a.Bhb||a===ba.a.SGb){if(!v.features.S3d)return 8}else if(!v.features.gWf)return 8;if(!v.Ma.If)return 2;c=this.J_b(c);return c?a!==ba.a.Bhb&&a!==ba.a.SGb||this.yEa.Dsl(c.node,a===ba.a.Bhb?1:0)?1===h?32:2===h&&32===this.ga.hb(ba.a.Vba,2,!0)?(this.ga.hb(ba.a.X6h,2,a),32):8:8:2}KMk(a,c,h,v,B){if(1===h)return 32;if(2===h){a=this.qfl(c);if(!a)return 8;h=c=null;switch(B){case ba.a.ivf:h=a.Pb;c=this.TMb.gDd(h,1);break;case ba.a.hvf:h=a.Pb;c=this.TMb.gDd(h,0);break;case ba.a.kvf:h=a.sa;c=this.TMb.LGh(h,
1);break;case ba.a.jvf:h=a.sa;c=this.TMb.LGh(h,0);break;case ba.a.Bhb:h=a.sa;(c=this.TMb.gDd(h,1,!0))||(c=this.yEa.Kuh(h.node,1));break;case ba.a.SGb:h=a.sa,(c=this.TMb.gDd(h,0,!0))||(c=this.yEa.Kuh(h.node,0))}if(c)this.FSd(c);else{if(!this.Fs.Jb)return 8;(B=ac.d(h.node,h.cpBegin))&&7===B.nh&&this.yEa.yyi(B)}}return 32}hrn(a,c,h,v,B){return 1===h?32:2===h?(r.ULS.shipAssertTag(4520066,308,!!B),r.ULS.shipAssertTag(4520067,308,!!B.STa),a=B.STa,r.ULS.shipAssertTag(4520068,308,this.aD.vja(a)),this.FSd(a,
B.y1d)?32:8):32}irn(a,c,h,v,B){if(1===h)return 32;2===h&&(a=B.footnoteEndnoteNode,B=B.NMk)&&(this.bna.dYb(),c=this.aD.Icb(a),B.title=this.aD.r1k(a)+(c?WordEditorIntl.WordEditorStrings.l_FootnoteTooltipInstruction:WordEditorIntl.WordEditorStrings.l_EndnoteTooltipInstruction));return 32}hfb(a,c,h,v,B){return 2===h?(r.ULS.shipAssertTag(4520069,308,!!B),r.ULS.shipAssertTag(4520070,308,!!B.STa),r.ULS.shipAssertTag(4520071,308,sd.ParagraphReader.tb(B.STa)),a=this.aD.OZb(B.STa),this.FSd(a,B.y1d)?32:8):32}cen(a,
c,h){2===h&&this.GA.IV();return 32}qvk(a,c,h,v,B){if(1===h)return 32;if(2===h)return void 0!==B&&null!==B?this.GA.iYe(B,B):this.GA.iYe(),32;r.ULS.sendTraceTag(4520072,308,10,"{0}",{["Error"]:"FootnoteEndnoteControl not dismissed"});return 8}RXl(a,c,h){a=this.J_b(c);return a&&Gc.SelectionEditor.ke(a)?1===h?32:2===h?(h=0<this.uj.n0(a.node).jt,this.GA.OTe(),this.GA.dialog.wbb=h,32):8:(r.ULS.sendTraceTag(4743179,308,10,"Expected an IP context here."),8)}IMk(a,c,h){return 1===h?32:2===h?(this.GA.dialog.wbb=
!1,32):8}RIm(a,c,h,v,B){return this.Rnh(a,h,B)}PIm(a,c,h,v,B){return 1===h?32:this.GA.dialog&&this.GA.dialog.fontName?(B[Rc.a.Value]=this.GA.dialog.fontName,32):this.Q3c.pIa(zb.a.gEb.toString(),B,null)?32:8}HMk(a,c,h){return 1===h?32:2===h?(this.GA.dialog.wbb=!0,32):8}QIm(a,c,h,v,B){return this.Rnh(a,h,B)}FMk(a,c,h){if(1===h)return 32;if(2===h){a=this.J_b(c);if(!a)return r.ULS.sendTraceTag(51512524,308,10,"Selected graph node context is null"),8;c=this.aD.OZb(a.node);this.aD.vja(c)&&(h=this.Fb.Ob(15),
h.Oa(c),this.sUi(a),this.yEa.eTg(c,this.GA.dialog),h.dispose());this.GA.DTc();return 32}return 8}EMk(a,c,h){if(1===h)return 32;if(2===h){a=this.J_b(c);if(!a)return r.ULS.sendTraceTag(51512525,308,10,"Selected graph node context is null"),8;c=this.aD.OZb(a.node);this.aD.vja(c)&&(h=this.Fb.Ob(15),h.Oa(c),this.sUi(a),this.yEa.yOj(c,this.GA.dialog),h.dispose());this.GA.DTc();return 32}return 8}GMk(a,c,h){return 1===h?32:2===h?(this.GA.DTc(),32):8}CMk(a,c,h,v,B){if(1===h)return 32;if(2===h){a=Object(ha.a)(29,
B);if(!a||!a.Ac)return 8;this.GA.dialog.fontName=a.Ac.fontName;return 32}return 8}DMk(a,c,h,v,B){if(1===h)return 32;if(2===h){a=Object(ha.a)(29,B);if(!a||!a.Ac)return 8;this.GA.dialog.SMb=a.Ac;return 32}return 8}sUi(a){(a=ua.FormattingReader.zr(a))?(this.GA.dialog.fontName||(this.GA.dialog.fontName=a.cache.qF),-1===this.GA.dialog.fontSize&&(this.GA.dialog.SMb=a.cache.fontSize)):r.ULS.sendTraceTag(587790277,308,10,"UpdateFontAndFontSize: Received null formatting object.")}Rnh(a,c,h){return 1===c&&
this.GA.dialog?32:2===c&&this.GA.dialog?(h[Pf.a.On]=a===ba.a.GGf?this.GA.dialog.wbb:!this.GA.dialog.wbb,32):8}eb(){this.ga.Aa(ba.a.insertFootnote,ic.a.view,Object(m.a)(this,this.wNh,"insertFootnoteEndnoteViewHandler"),4);this.ga.Aa(ba.a.insertEndnote,ic.a.view,Object(m.a)(this,this.wNh,"insertFootnoteEndnoteViewHandler"),4);this.ga.ka(ba.a.ivf,ic.a.view,Object(m.a)(this,this.S5b,"nextPreviousFootnoteEndnoteHandler"));this.ga.ka(ba.a.X6h,ic.a.view,Object(m.a)(this,this.KMk,"footnoteEndnoteNavigationHandler"));
this.ga.ka(ba.a.hvf,ic.a.view,Object(m.a)(this,this.S5b,"nextPreviousFootnoteEndnoteHandler"));this.ga.ka(ba.a.kvf,ic.a.view,Object(m.a)(this,this.S5b,"nextPreviousFootnoteEndnoteHandler"));this.ga.ka(ba.a.jvf,ic.a.view,Object(m.a)(this,this.S5b,"nextPreviousFootnoteEndnoteHandler"));this.ga.ka(ba.a.Bhb,ic.a.view,Object(m.a)(this,this.S5b,"nextPreviousFootnoteEndnoteHandler"));this.ga.ka(ba.a.SGb,ic.a.view,Object(m.a)(this,this.S5b,"nextPreviousFootnoteEndnoteHandler"));this.ga.ka(ba.a.FHi,ic.a.view,
Object(m.a)(this,this.hrn,"showFootnoteEndnoteControlHandler"));this.ga.Aa(ba.a.Pnh,ic.a.view,Object(m.a)(this,this.HMk,"footnoteEndnoteFormatFirstIndentStyleHandler"),4);this.ga.Aa(ba.a.GGf,ic.a.view,Object(m.a)(this,this.QIm,"queryFootnoteEndnoteFormatFirstIndentStyleHandler"),100);this.ga.Aa(ba.a.Qnh,ic.a.view,Object(m.a)(this,this.IMk,"footnoteEndnoteFormatNoStyleHandler"),4);this.ga.Aa(ba.a.eli,ic.a.view,Object(m.a)(this,this.RIm,"queryFootnoteEndnoteFormatNoStyleHandler"),100);this.ga.ka(ba.a.GHi,
ic.a.view,Object(m.a)(this,this.irn,"showFootnoteEndnoteTooltipHandler"));this.ga.Aa(ba.a.hfb,ic.a.view,Object(m.a)(this,this.hfb,"openFootnoteEndnoteControl"),96);this.ga.Aa(ba.a.i3e,ic.a.view,Object(m.a)(this,this.cen,"setFocusOnFootnoteEndnoteControl"),96);this.ga.ka(ba.a.Vba,ic.a.view,Object(m.a)(this,this.qvk,"dismissFootnoteEndnoteControlHandler"));this.ga.Aa(ba.a.HZh,ic.a.view,Object(m.a)(this,this.RXl,"launchFootnoteEndnoteFormattingOptionsDialogHandler"),4);this.ga.Aa(ba.a.Mnh,ic.a.view,
Object(m.a)(this,this.FMk,"footnoteEndnoteFormatApplyHandler"),4);this.ga.Aa(ba.a.Nnh,ic.a.view,Object(m.a)(this,this.EMk,"footnoteEndnoteFormatApplyAllHandler"),4);this.ga.Aa(ba.a.Onh,ic.a.view,Object(m.a)(this,this.GMk,"footnoteEndnoteFormatCancelHandler"),4);this.ga.Aa(ba.a.wxd,ic.a.view,Object(m.a)(this,this.CMk,"footnoteEndnoteFontNameHandler"),4);this.ga.Aa(ba.a.dli,ic.a.view,Object(m.a)(this,this.PIm,"queryFootnoteEndnoteFontNameHandler"),100);this.ga.Aa(ba.a.xxd,ic.a.view,Object(m.a)(this,
this.DMk,"footnoteEndnoteFontSizeHandler"),4);this.ga.Aa(ba.a.bQc,ic.a.view,Ot.bQc,100);this.ga.Aa(ba.a.cQc,ic.a.view,Ot.cQc,100)}$If(){this.y6i.execute(a=>{a.j1(new SA);a.j1(new IB)})}J_b(a){a=this.Cyd(a);return a?a.sa:(r.ULS.sendTraceTag(51512526,308,10,"GetCollapsedSelectionFromContext is null"),null)}Cyd(a){let c=null;a=a.view;if(!a)return r.ULS.sendTraceTag(3486740,308,10,"We expected a view here."),c;a=a.Ma;if(!a)return r.ULS.sendTraceTag(51512527,308,10,"We expected that we have a selection manager here."),
c;a=a.Ca;if(!a||!a.length)return r.ULS.sendTraceTag(51512528,308,10,"We expected that we have a selection collection here."),c;a=a.J(0);if(!a)return r.ULS.sendTraceTag(51512529,308,10,"We expected that we have a current selection here."),c;(c=Gc.SelectionEditor.Ri(a,!1,!1))||r.ULS.sendTraceTag(3486741,308,10,"We expected a selection here.");return c}qfl(a){return(a=a.view)?a.Ma.Ca.J(0):null}FSd(a,c=!0,h=!1){if(a){this.bna.dYb();var v=a.uia;if(v){var B=v.Xa;const X=ne.SelectionFactory.bO(B.paragraph,
B.cp,B.cp+1);B=this.Fs.Jb;if(!B)return!1;this.Rb.$Ba(B,X);B.Igb=150;B.oea();a=new $z.a(a,c);v=v.dWa(B);if(!v)return r.ULS.sendTraceTag(570529814,308,15,"FootnoteEndnote presenter is null"),!1;h||v.element?this.GA.ZSf(a):(this.GA.ZSf(new $z.a(a.STa,!1)),c&&(c=new Se.a(2,1,10,()=>{this.GA.IV()}),this.Ta.ub(c)));return!0}}return!1}static i1k(){return new Ot(l.AFrameworkApplication.pa,Eb.App.oa.Da,xa.a.instance.resolve("Box4.IGeneralCuiUser"),ec.InteractiveViewManager.instance,iy.a.instance,GC.a.instance,
Fq.a.instance,Zz.a.instance,jy.FootnoteEndnoteControlManager.instance,xa.a.instance.resolve("Box4.IParagraphIndentationReader"),ly.a.instance,new Fk.a,li.a.instance,ag.a.instance,l.AFrameworkApplication.na.Qo,xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,xa.a.instance.za("Box4.Accessibility.IAccessibilityContextManager"),xa.a.instance.za("Box4.IContentControlReader"))}static h1k(){return Ot.i1k()}static bQc(a,c,h,v,B){if(1===h)return 32;if(2===h&&!B)return 8;fm.a.oGd(c);
B.PopulationXML=Rn.FontUtils.cph(fm.a.L1d,fm.a.N3e,ba.a.wxd);return 32}static cQc(a,c,h,v,B){if(1===h)return 32;if(2===h&&!B)return 8;B.PopulationXML=Rn.FontUtils.dph(ba.a.xxd);return 32}static get uf(){return Nm.ContextSetEditor.instance}}Object(w.a)(Ot,"FootnoteEndnoteActor",null,[659]);class my extends zr.a{constructor(a){super();this.ZEe=a}get index(){return 1}run(){this.ZEe()}YI(){this.gY()}}Object(w.a)(my,"FootnoteEndnoteControlUpdateTracker",zr.a,[]);var ny=b(346);class Wu extends ny.a{constructor(a,
c,h,v,B,X,ma){super(a,c,h);this.hg=null;this.ZF=a.container;this.ku=document.createElement("div");a.container.appendChild(this.ku);this.rz(this.ku);this.zsj=v;this.gm.execute(Pa=>{Pa.Z4(Object(m.a)(this,this.Gq,"onZoomChanged"))});this.CEa=B;this.QE=X;this.AW=ma;this.CEa.execute(Pa=>{Pa.BRf(this.kb,this.ZF)});this.AW&&(this.ZF.style.backgroundColor=this.QE.o_b())}dispose(){super.dispose();this.gm.instance&&this.gm.instance.ngb(Object(m.a)(this,this.Gq,"onZoomChanged"))}get gm(){return this.hg||(this.hg=
xa.a.instance.za("Common.IZoomManager"))}Az(a){this.ZF.classList.add("FootnoteEndnoteViewElement");this.xZc(a.currentNode)}Gq(){this.xZc(this.Ia)}xZc(a){this.gm.instance&&(this.gm.instance.d0c(this.ku),this.ku.style.width=Math.round(100/this.gm.instance.ei)+"%");this.zsj(a)}}Object(w.a)(Wu,"FootnoteEndnoteViewElement",ny.a,[]);class oy{constructor(){this._initialized=!1;this.B3c=this.oje=this.W=null}get name(){return"WordEditor.FootnoteEndnote"}yb(a){this.W=a}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>
{this.El()})}El(){$t.WordSectionNavigator.instance.pvf=Object(m.a)(Fq.a.instance,Fq.a.instance.egm,"navigateToWordSectionNodeWithFootnoteEndnote");HB.a.rRf(Object(m.a)(this,this.PMk,"footnoteEndnoteViewElementFactory"));jy.FootnoteEndnoteControlManager.instance.bind(Eb.App.oa.vA);this.oje=Ot.h1k();this.oje.eb();this.oje.$If();Eb.App.oa.updateCommandUI();this.Rdf();this._initialized=!0}dispose(){this._initialized&&(this._initialized=!1,jy.FootnoteEndnoteControlManager.instance.dispose())}PMk(a,c,h){return a.fKa?
new Wu(a,c,h,v=>{jy.FootnoteEndnoteControlManager.instance.P0m(v)},this.W.za("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),this.W.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Eb.App.instance&&Eb.App.instance.BM):null}Rdf(){this.B3c=new my(()=>{jy.FootnoteEndnoteControlManager.instance.yZc()});RA.a.CXd(Object(m.a)(this.B3c,this.B3c.YI,"setUpdateNeeded"));Wo.GraphTransactionManager.instance.Usa(this.B3c,3)}}Object(w.a)(oy,"PackageManager",null,[1,2]);class JB{constructor(a,
c,h,v,B=null){this.Xkj=a;this.ya=c;this.zaa=v;this.Cz=B}get zWg(){return this.Xkj.value}get bookmarkManager(){return this.zaa.value}dNl(a){return S.App.z8d||S.App.v8d?a.startsWith(F.a.s8a):!1}Rpl(a){var c,h;try{if(S.App.v8d)this.Spl(a);else if(S.App.z8d&&this.zWg){var v=a.split("/"),B=this.zWg.mca(v[v.length-1]);if(B&&B.anchor)if(Us.a.isEnabled?this.Cz.mha.has(null===(c=B.id)||void 0===c?void 0:c.toString()):B.hasProperty(Yb.a.z5)){var X=Us.a.isEnabled?this.Cz.mha.get(null===(h=B.id)||void 0===h?
void 0:h.toString()):B.getValue(Yb.a.z5);if(void 0===X||null===X)r.ULS.sendTraceTag(24691933,324,50,"Empty StartBookmarkParaId in the bookmark node"),this.XKd();else{var ma=Eb.App.oa.Da.Zb.Lc.Ra(X);if(ma&&ma.anchor){var Pa=ne.SelectionFactory.vd(ma,0);this.ya.setSelection(Pa)}else r.ULS.sendTraceTag(24691934,324,50,"Paragraph node is invalid for bookmark"),this.XKd()}}else r.ULS.sendTraceTag(24691932,324,50,"Missing StartBookmarkParaId in the bookmark node"),this.XKd();else r.ULS.sendTraceTag(24691931,
324,15,"Cannot find bookmark node"),this.XKd()}}catch(mb){r.ULS.sendTraceTag(24691935,324,10,String.format("Error parsing bookmark url. Error: {0}",mb.message))}}qZf(a){return{returnValue:!1,yJf:a,Coh:""}}Spl(a){if(this.bookmarkManager){a=a.split("/");var c=this.bookmarkManager.mca(a[a.length-1]);c&&c.anchor?(a=this.bookmarkManager.Aia(c,!0).uba,c=this.bookmarkManager.Aia(c,!1).uba,a||c?a?this.hDi(a):(r.ULS.sendTraceTag(35992277,324,50,"Start Anchor is missing for Bookmark"),this.hDi(c)):(r.ULS.sendTraceTag(35992276,
324,50,"Bookmark has no anchors, jumping to end"),this.dnf(!1))):(r.ULS.sendTraceTag(35992275,324,15,"Cannot find bookmark node"),this.dnf(!0))}}XKd(){this.dnf(!0)}dnf(a){a=ne.SelectionFactory.en(Eb.App.oa.Da.Zb.u6e(),a);this.ya.setSelection(a)}hDi(a){a.paragraph&&a.Xa?(a=ne.SelectionFactory.vd(a.paragraph,a.Xa.cp),a.$Ph=!0,this.ya.setSelection(a)):r.ULS.shipAssertTag(35992279,324,!0,"bookmark's Paragraph or Containing Properties are missing")}}Object(w.a)(JB,"InternalLinkManager",null,[566]);class TA{get name(){return"WordEditor.InternalLinks"}init(){}dispose(){}yb(a){a.ha("WordEditor.InternalLinks.InternalLinkManager",
()=>new JB(new qf.a(()=>a.ra("WordEditor.Bookmark.IBookmarkGraphManager")),a.resolve("Box4.ISelectionManager"),a.resolve("Box4.IFeatureHelper"),new qf.a(()=>a.ra("WordEditor.Bookmark.IBookmarkManager")),a.resolve("Box4.BookmarkParagraphMapping"))).as("Box4.IInternalLinkManager").singleInstance()}static main(){M.a.instance.Lb(new TA)}}Object(w.a)(TA,"WordEditorInternalLinksPackage",null,[1,2]);class dw{constructor(a){this.cFa=null;dw.Do=a}Nrd(a){if(!dw.Kd.AJd(a))return null;a.Za(1)&&(a.currentNode.lj(8,
!0),a.ob());const c=dw.Do.qkk();dw.Kd.isRtl(a.currentNode)?c.setValue(Ed.a.iV,11):c.setValue(Ed.a.iV,9);a.Je(c,1);a.qh(c);return c}Gfn(a){if(this.cFa&&a!==this.cFa){const c=new Se.a(2,1,0,Object(m.a)(this,this.checkAndDeleteEphemeralOutline,"checkAndDeleteEphemeralOutline"),120);c.customData=this.cFa;l.AFrameworkApplication.Cb.ub(c)}this.cFa=a}sch(a){this.cFa===a.currentNode&&(this.cFa=null);const c=new gf.GraphTransaction(7);c.Lr(a);a.xf();c.dispose()}R1g(){if(this.cFa&&this.cFa.anchor){const a=
Kd.GraphIterator.va(this.cFa);a.fn()&&zj.OutlineReader.SIc(a)&&this.sch(a);this.cFa=null}}checkAndDeleteEphemeralOutline(a){a=a.customData;if(a.anchor){bh.a.mark(4763);var c=Kd.GraphIterator.va(a);if(c.La(8)&&c.mc(8)&&c.oRi(a)===a){if(zj.OutlineReader.isEmpty(c)){let h=!1;for(let v=0;v<$c.a.instance.Ca.length;v++){const B=$c.a.instance.Ca.J(v);for(let X=0;X<B.length;X++)if(B.J(X).node===a){h=!0;break}}h||this.sch(c)}bh.a.mark(4764)}}}static get Kd(){return vg.PageReader.instance}}dw.Do=null;Object(w.a)(dw,
"PageContentEditor",null,[1140]);var UA=b(1021),kl=b(598);class vt extends sj{constructor(){super()}jGi(a,c,h,v,B){let X=!1,ma=!0;Gc.SelectionEditor.ke(B)&&(c=ab.ListReader.Pg(a)&&c,B=Ta.OutlineElementReader.gz(a,B,!1)&&!Ta.OutlineElementReader.gz(a,B,!0),c&&h.tOe(a,v)&&(X=!0),Eb.App.lc.$n&&(B||c&&!X)&&(ma=!1));return{iGi:ma,aZi:X}}}Object(w.a)(vt,"CursorMoveValidator",sj,[]);class Yn{constructor(a,c,h,v){this.$b=this.rf=this.Bb=null;this.Cve=a;this.oT=v;this.LB=c;this.Vd=h;this.Qhj=!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("QoEIndentLeftForListImprovementIsEnabled")}get hd(){return this.Bb||(this.Bb=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get Xj(){return this.rf||(this.rf=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get qb(){return this.$b||(this.$b=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Dq(){return this.oT.value}get Wf(){return this.Vd.value}get nl(){return this.LB}Tnl(a,c,h){const v=window.performance.now(),
B=new br.ScriptSharpLegacyMap;c=new dm.a;h=new br.ScriptSharpLegacyMap;if(a&&a.Iv){var X=null;for(let ma=0;ma<a.length;ma++){const Pa=a.getContext(ma);X=X||Yn.Ag.Xs(Pa.node);let mb;if(!({groupId:mb}=this.EHn(Pa.node,X)).returnValue)continue;let Tb;B.Ja(mb)||(Tb=[],B.add(mb,Tb));Tb=B.J(mb);Tb.push(Pa)}for(let ma of Xj.toArray(B.keys))a=B.J(ma),X=new Kd.GraphIterator,X.set(a[0].node),({Zui:a,Er:X}=this.LB.bHn(X)).returnValue?(B.Z(ma,a),h.add(ma,X)):c.add(ma)}r.ULS.sendTraceTag(589592455,338,50,String.format("GroupGraphNodeContextForIndenationDuration: {0} ms;",
window.performance.now()-v));return{returnValue:B,Wnl:c,Vnl:h}}Xsb(a){return this.w1j(a)}bVb(a){return this.X0j(a)}hod(a,c,h=!0){return Kd.GraphIterator.oia(()=>{var v=!1;if(ab.ListReader.Pg(a))return this.tOe(a,c,h);v||(ie.OutlineElementNavigator.Fd(a),v=sd.ParagraphReader.eg(a)||Wf.TableReader.isTable(a),ie.OutlineElementNavigator.Wc(a),v=v&&this.u1j(a,c));return v})}tOe(a,c,h=!0){return Kd.GraphIterator.oia(()=>{const v=Ta.OutlineElementReader.Bya(a),B=zj.OutlineReader.XJ(a.currentNode);if(h?!this.yOl(a,
c):!this.zOl(a,c))return!1;var X=Kd.GraphIterator.va(a.currentNode);if(0<c&&X.La(14)){X.mc(16);var ma=X.currentNode;const Pa=Tf.TableCellReader.vaf(X);X.mc(14);const mb=X.currentNode;X=tr.a.tO(ma,mb,Yb.a.VK,Yb.a.Ela,0);ma=tr.a.tO(ma,mb,Yb.a.UM,Yb.a.jta,0);X=Be.a.ry(X,0);ma=Be.a.ry(ma,0);return v+B<Pa-X-ma}return!0})}u1j(a,c){const h=Ta.OutlineElementReader.Bya(a);var v=Ta.OutlineElementReader.sI(a);if(0<c){c=zj.OutlineReader.XJ(a.currentNode);v=0;({Po:B,marginLeft:ma,marginRight:X}=Yn.ZAd(a.currentNode,
B,ma,X));const Pa=Kd.GraphIterator.va(a.currentNode);ie.OutlineElementNavigator.Fd(a);if(Wf.TableReader.isTable(a)){v=Wf.TableReader.Fia(a);let mb=0;for(let Tb of v)mb+=Tb;v=Be.a.ry(Be.a.Re(mb,0),0)}ie.OutlineElementNavigator.Wc(a);if(Pa.La(14)){Pa.mc(16);var B=Pa.currentNode;a=Tf.TableCellReader.vaf(Pa);Pa.mc(14);var X=Pa.currentNode;var ma=tr.a.tO(B,X,Yb.a.VK,Yb.a.Ela,0);B=tr.a.tO(B,X,Yb.a.UM,Yb.a.jta,0);ma=Be.a.ry(ma,0);B=Be.a.ry(B,0);return h+c<a-ma-B-v}return h+c<B-ma-X-v}return 0<h-v}$La(a,
c){this.$ei(a,-1*Math.abs(c))}ozc(a,c){this.$ei(a,Math.abs(c))}ztk(a,c,h,v,B){let X=Yn.w5h;if(c>=Yn.w5h){X=c-=h;const ma=v*B,Pa=Math.abs(ma),mb=Math.abs(c)%Pa;mb&&(X=0>X?0>v?X+mb:X-(Pa-mb):0<v?X-mb:X+(Pa-mb));X+=ma;X+=h;Yn.CTd&&(h=Ta.OutlineElementReader.n0(a),X=Yn.CTd.Yrh(a.currentNode,c+h,X+h,B,X<c)-h)}return X}s1j(a,c,h){if(!a||!a.length)return!1;c=h?c?-1:1:this.Cth(a[0].node,c);return this.t1j(a,c,h)}qwm(a,c,h){if(!a)return r.ULS.shipAssertTag(589345600,338,!1,"The group of listOEs are null which are sent for indentation."),
8;if(!a.length)return r.ULS.shipAssertTag(589345601,338,!!a.length,"The group of listOEs are empty which are sent for indentation."),8;if(!h)return r.ULS.shipAssertTag(589592458,338,!1,"The listIds are null which are sent for indentation."),8;if(!h.length)return r.ULS.shipAssertTag(589592459,338,!1,"The listIds are empty which are sent for indentation."),8;const v=a[0].node;c=this.Cth(v,c);if(!this.Cem(v,h[0],c)||!this.zem(a,c))return 8;this.Dq.S5();return 32}zem(a,c){for(let h=0;h<a.length;h++){const v=
new Kd.GraphIterator;v.set(a[h].node);let B=null;ie.OutlineElementNavigator.Fd(v);if(sd.ParagraphReader.eg(v)){if(B=v.currentNode,!B)return r.ULS.shipAssertTag(589592461,338,!B,"The paraNode is null for the list OE node"),!1}else if(!sd.ParagraphReader.eg(v)&&!Wf.TableReader.isTable(v))return r.ULS.shipAssertTag(589592460,338,!1,"The content of the listOE is neither a paragraph nor a table node"),!1;v.ob();if(B){if(this.Nsl(B)){const X=B.Yz(),ma=Ta.OutlineElementReader.Bya(v);this.Wf.Xsa(v,1,ma+c);
X&&this.Xj.sS(B,X,this.hd.Bf)}B.setValue(Ed.a.z4,new Date)}}return!0}Cem(a,c,h){for(let v=0;v<ai.a.qda;v++){const B=this.LB.Ev(a,c,v);if(!B)return r.ULS.shipAssertTag(589345602,338,!1,"The list defs returned is null for listId : {0}",c),!1;const X=B.getValue(Yb.a.sk);l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled");l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled",!1)?X&&B.setValue(Yb.a.sk,
X+h):B.setValue(Yb.a.sk,X+h)}return!0}Nsl(a){return a.hasProperty(Yb.a.sk)||a.hasProperty(Yb.a.qx)||a.hasProperty(Yb.a.jE)}X0j(a){return this.hod(a,1,!0)}w1j(a){return this.hod(a,-1,!0)}Cth(a,c){var h=new Kd.GraphIterator;h.set(a);const v=Ta.OutlineElementReader.Bya(h),B=Ta.OutlineElementReader.sI(h),X=Ta.OutlineElementReader.n0(h);h=zj.OutlineReader.XJ(a);let ma,Pa,mb;({Po:ma,marginLeft:Pa,marginRight:mb}=Yn.ZAd(a,ma,Pa,mb));a=(B?v-B:X)%h;return c?-1*(a?a:h):h-a>Yn.Bbh?Yn.Bbh:h-a}EHn(a,c){let h;
const v=new Kd.GraphIterator;v.set(a);a=v.Za(4).getValue(Yb.a.listID);return({id:h}=this.LB.tIb(a,c)).returnValue?{returnValue:!0,groupId:h}:{returnValue:!1,groupId:h}}t1j(a,c,h){var v=!1;for(let B=0;B<a.length;B++){v=a[B];const X=new Kd.GraphIterator;X.set(v.node);Gc.SelectionEditor.vs(X);if(!Ta.OutlineElementReader.Gg(X))return Yn.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.KUa}),!1;if(this.hod(X,c,h))v=!0;else return Yn.Kb.ib(Kf.a.zXb,{["Reason"]:Ef.a.JOe}),!1}return v}$ei(a,c){if(this.hod(a,c,!0)){var h=!1;
if(ab.ListReader.Pg(a)){var v=new Kd.GraphIterator;v.Wb(a);this.nl.lB(v);var B=v.currentNode;v.ob();const ma=B.getValue(Yb.a.qe);h=!0;var X=B.getValue(Yb.a.listID);if(X=this.Sgl(X,ma+c))ie.OutlineElementNavigator.Fd(v),sd.ParagraphReader.eg(v)&&Yn.BB.MK(X,v.currentNode,!1),v.ob();else{X=null;let Pa;ie.OutlineElementNavigator.Fd(v);sd.ParagraphReader.eg(v)&&(X=v.currentNode);v.ob();Pa=X?X.Yz():null;this.Qhj&&(X||(ie.OutlineElementNavigator.Fd(v),sd.ParagraphReader.eg(v)&&(X=v.currentNode),v.ob()),
X&&(X.hasProperty(Yb.a.sk)&&X.removeProperty(Yb.a.sk),X.hasProperty(Yb.a.qx)&&X.removeProperty(Yb.a.qx)));this.Dq.eLf(v,ma,c);B.setValue(Yb.a.qe,ma+c);B.removeProperty(Yb.a.Xja);X&&Pa&&(this.Xj.sS(X,Pa,this.hd.Bf),this.Dq.S5());this.Pzn(a,B)}}h||(h=Ta.OutlineElementReader.Bya(a),v=Ta.OutlineElementReader.sI(a),B=zj.OutlineReader.XJ(a.currentNode),c=this.ztk(a,h,v,c,B),this.Wf.Xsa(a,1,c))}}zOl(a,c){const h=Ta.OutlineElementReader.Bya(a),v=Ta.OutlineElementReader.sI(a),B=Ta.OutlineElementReader.n0(a);
let X,ma,Pa;({Po:X,marginLeft:ma,marginRight:Pa}=Yn.ZAd(a.currentNode,X,ma,Pa));if(0<c){if(a=X-ma-Pa,B&&B+c+Eb.App.Jta>a||h+c+Eb.App.Jta>a)return!1}else if(B&&0>h+c||0>h-v+c)return!1;return!0}yOl(a,c){var h=this.Dq.Fv(a);const v=h.level,B=zj.OutlineReader.XJ(a.currentNode),X=v+c;if(pp.a.rLd<X||X<pp.a.A2e)return!1;const ma=a.currentNode;if(!ab.ListReader.mq){var Pa=ie.OutlineElementNavigator.Fd(a);ie.OutlineElementNavigator.Wc(a);if(Pa.hasProperty(Yb.a.sk)&&(Pa=Pa.getValue(Yb.a.sk),B*(v+1)!==Pa))return!1}h=
this.nl.Ev(ma,h.listID,X);if(!h)return r.ULS.shipAssertTag(590700875,338,!!h),!1;if(0<c&&h.hasProperty(Yb.a.sk)){c=h.getValue(Yb.a.sk);let mb,Tb,rc;({Po:mb,marginLeft:Tb,marginRight:rc}=Yn.ZAd(a.currentNode,mb,Tb,rc));if(c+Eb.App.Jta>mb-Tb-rc)return!1}return!0}Sgl(a,c){const h=this.qb.lp();for(let v=0;v<h.cM;v++){const B=h.Uia(v);if(this.nl.mvb(B)&&B.ia(Yb.a.listID,this.Dq.y4+1)===a&&B.ia(Yb.a.qe,-1)===c)return B}return null}Pzn(a,c){ie.OutlineElementNavigator.Fd(a);if(sd.ParagraphReader.eg(a)&&a.currentNode.hasProperty(Yb.a.sk)&&
(c=this.nl.XDc(c))){const v=ab.ListReader.mq;if(v&&c.hasProperty(Yb.a.qx)){var h=c.getValue(Yb.a.qx);this.Cve.Zgb(a.currentNode,h)}c.hasProperty(Yb.a.sk)&&(h=c.getValue(Yb.a.sk),this.Cve.Xsa(a,1,h));v&&c.hasProperty(Yb.a.jE)&&(c=c.getValue(Yb.a.jE),this.Cve.Y9(a.currentNode,c))}ie.OutlineElementNavigator.Wc(a)}static get BB(){return Yn.XB||(Yn.XB=xa.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get CTd(){return Yn.Ooc||(Yn.Ooc=xa.a.instance.ra("WordEditor.ParagraphIndentationUtility"))}static get paragraphEditor(){return Yn.kh||
(Yn.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){Yn.kh=a}static get Kb(){return Ee.a.instance}static get vh(){return iq.a.instance}static get Ag(){return jn.PageNavigator.instance}static ZAd(a,c,h,v){a=$t.WordSectionNavigator.instance.WO(a);c=Yn.vh.fv(a);h=Yn.vh.sM(a);v=Yn.vh.tM(a);return{Po:c,marginLeft:h,marginRight:v}}}Yn.Bbh=Of.a.YD(.25);Yn.XB=null;Yn.Ooc=null;Yn.kh=null;Yn.w5h=Of.a.YD(-11);Object(w.a)(Yn,"OutlineElementIndentationEditor",null,[662,663]);var aA=
b(285),Wi=b(839),nh=b(200),py;(function(a){a[a.none=0]="none";a[a.character=1]="character";a[a.paragraph=2]="paragraph";a[a.table=3]="table"})(py||(py={}));Object(w.b)("StyleTargetType",py);var sg=b(154);class qy{constructor(a,c){this.Pu=this.uL=this.rf=this.Bb=this.Tb=this.Xm=this.Na=this.MA=this.Tk=this.nd=this.kh=null;this.Un=c;this.zc=a}get paragraphEditor(){return this.kh||(this.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}get KD(){return this.uL||(this.uL=xa.a.instance.resolve("Box4.IFontStylesGalleryCache"))}get ti(){return this.Pu||
(this.Pu=xa.a.instance.ra("Box4.Styles.StyleSettings"))}get hh(){return this.nd||(this.nd=xa.a.instance.resolve("Box4.IFormattingEditor"))}get qb(){return this.Tk||(this.Tk=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get L$(){return this.MA||(this.MA=new kl.WACStyleSet)}set L$(a){this.MA=a}get Ua(){return this.Na||(this.Na=xa.a.instance.ra("Box4.IFeatureHelper"))}get Oo(){return this.Un.value}get Ei(){return this.Xm||(this.Xm=xa.a.instance.ra("Box4.IInsertionPointFormatting"))}get VLd(){return this.zc||
(this.zc=xa.a.instance.resolve("Box4.List.IListReader"))}get characterPropertiesEditor(){return this.Tb||(this.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get hd(){return this.Bb||(this.Bb=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get Xj(){return this.rf||(this.rf=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}$gl(a){const c=a.node;var h=this.Ei?this.Ei.Drh():null;if(h&&!h.equals(N.a.nil)){a=c.Mb;if(!a)return null;
h=a.Ra(h);if(!h||(h=new sg.a(h),1!==this.qb.Gv(h)))return null}else h=ua.FormattingReader.zr(a),h=ua.FormattingReader.vqa(h);return h}jjn(a,c){const h=this.qb.tw(c);h&&h.zg(this.qb.oe(a))&&(this.I0f(c,h),this.Ei&&(this.Ei.k_a(),this.Ei.qhb(a,c)))}YNj(a,c){if(c)if(c.qwb&&0<c.qwb.length){let B=new va.a;for(var h of c.qwb)B.add(h);if(c.pnf){c=ua.FormattingReader.cRk(a);h=[];for(var v of c)v.formatting&&v.formatting.fm&&h.push(v.formatting.fm);if(0<h.length){v=aA.APropertySet.Rwh(h);c=new va.a;for(const X of B)v.hasProperty(X)||
c.add(X);B=c}}this.paragraphEditor.wVb(a,!0,B)}else this.paragraphEditor.wVb(a,!0);else Sd.b(576582787,3018,15,"Cannot apply alternate formatting strategy as ClearSpecificFormattingProperties is null")}MK(a,c,h,v=!1,B=!1,X=!1,ma=null){var Pa;if(sd.ParagraphReader.tb(c))if(a)if(this.qb.HI(a.Fg()))if(2!==this.qb.Gv(a))r.ULS.shipAssertTag(593506381,324,!1);else{var mb=this.qb.tw(c);if(mb){var Tb=this.qb.oe(a);if(!Tb)r.ULS.shipAssertTag(593506377,324,!1);else if(mb.zg(Tb)){var rc=null,Tc=kg.a.instance.J(3)&&
!v?c.Yz():null;h||(ma&&ma.O0j&&this.Ua&&this.Ua.isFeatureEnabled(163)?(this.YNj(c,ma),this.lPn(c,a,ma)):(rc=this.Oo.cIf(rc,c),this.paragraphEditor.wVb(c,!0)));this.I0f(c,mb);kg.a.instance.J(8)||(a=mb.zg(this.qb.oe(a)));B&&Tc&&Tc.hasProperty(zi.a.paragraphStyle)&&Tc.removeProperty(zi.a.paragraphStyle);(null===(Pa=l.AFrameworkApplication.K)||void 0===Pa?0:Pa.$("WACStyleCallStackLoggingIsEnabled"))&&1073872969!==a.Gb&&Sd.b(525091600,3017,10,`Invalid propertySet of ClassId : ${a.Gb} .`+` Call Stack: ${ks.a.eqa(0,
Xf.a.cZa)}`);c.properties.setValue(zi.a.paragraphStyle,a.id);null!=Wi.a.Dc&&!Wi.a.Dc.JO&&this.Ua&&this.Ua.isFeatureEnabled(163)&&this.hUi(c,a,ma);c.bL=a;c.w1=null;for(h=0;h<c.la.length;h++)c.la.J(h).formatting&&c.la.J(h).formatting.D1b();this.VLd.mvb(a)&&(rc||(rc=new Kd.GraphIterator,rc.set(c),rc.nc(),ie.OutlineElementNavigator.Wc(rc)),ab.ListReader.Pg(rc)||(c.Ig(Yb.a.sk,Yb.a.gS,Yb.a.jE,Yb.a.R4,Yb.a.OLa,Yb.a.CK),this.pmd(rc,a)));this.ti&&this.ti.isProgressiveStyleEnabled&&null!=this.KD&&this.KD.Fac(Tb);
v||!Tc||X||this.Xj.sS(c,Tc,this.hd.Bf)}}else r.ULS.shipAssertTag(593506379,324,!1)}else r.ULS.shipAssertTag(593506382,324,!1);else r.ULS.shipAssertTag(593506383,324,!1);else r.ULS.shipAssertTag(593506384,324,!1)}lPn(a,c,h){const v=this.VLd.OG(a),B=this.VLd.mvb(c);if(v){if(null!=Wi.a.Dc&&Wi.a.Dc.JO)this.hUi(a,c,h);else{h=h&&!h.pnf&&h.qwb?h.qwb:null;var X=this.VLd.qO(v);X&&this.Oo.kPn(v,c,h,X.nq)}B||a.setValue(Yb.a.Xja,!1)}else B&&a.setValue(Yb.a.Xja,!0)}hUi(a,c,h){const v=a.Mb;if(a=this.characterPropertiesEditor.jIa(a)){var B=
null==a.fm?new nh.a:a.fm.clone();dl.a.nQn(B,c,h&&!h.pnf&&h.qwb?h.qwb:null);B.Gja?c=v.iP(B,!0):(v.At(B,null),c=B);a.mi=c.id}else r.ULS.sendTraceTag(574660761,3018,15,"EOP formatting is null, skipping application on EOP.")}pmd(){}EVc(a,c){if(c){r.ULS.shipAssertTag(593506371,324,c.isConnected,"paragraphNode not connected");var h=this.qb.tw(c);h?(a=h.tqa(a))?this.qb.HI(a.Fg())?this.MK(a,c,!1,void 0,void 0,void 0,null):r.ULS.shipAssertTag(593506368,324,this.qb.HI(a.Fg())):r.ULS.shipAssertTag(593506369,
324,!!a):r.ULS.shipAssertTag(593506370,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else r.ULS.shipAssertTag(593506372,324,!1)}YPe(a,c=!1,h=!1){const v=this.qb.tw(a).zg(kg.a.instance.J(8)?gj.StyleReader.wordStyleIdNormal:gj.StyleReader.styleIdNormal);this.MK(v,a,c,void 0,h)}I0f(a,c){(a=qy.Ag.Xs(a))&&c.FVc(a,!1)}frk(a){var c=null;if(this.Ua&&this.Ua.isFeatureEnabled(51)){if(!a||!a.count)return r.ULS.sendTraceTag(592221652,3018,10,"No style IDs provided for delete."),!1;if(!c&&(c=dl.a.Vy(),
!c))return r.ULS.sendTraceTag(592221653,3018,15,"Couldn't retreive PageContentNode."),!1;var h=this.L$.vM(c);if(!h)return r.ULS.sendTraceTag(592221654,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;var v=new Map;v.set("NumberOfStyles",a.count.toString());v.set("Source","DeleteStyleAPI");Fa.Health.instance.recordKpiUsage(Xf.a.t8d,0,Xf.a.pF,v);v=0;const ma=(new Date).getTime();var B=null;let Pa=null,mb=null,Tb=null;const rc=this.Ua.isFeatureEnabled(50)&&!0;rc&&(B=new Ua.a,Pa=new Ua.a,
mb=new Ua.a,Tb=new Ua.a);for(var X of a){if(!X)return r.ULS.sendTraceTag(592221655,3018,50,"Style ID is null."),!1;const Tc=h.zg(X);if(!Tc||!this.qb.ny(Tc,h))return r.ULS.sendTraceTag(592221656,3018,50,"Provided style is null[{0}] or not a custom style [{1}].",!Tc,!!Tc&&this.qb.ny(Tc,h)),!1;const vd=this.qb.Gv(Tc);if(2!==vd&&1!==vd)return r.ULS.sendTraceTag(592221657,3018,50,"Provided style has style type: {0}.",vd),!1;const ee=this.qb.r0(Tc,h);let Ie=0;if(ee){if(!this.qb.ny(ee,h))return r.ULS.sendTraceTag(571074068,
3018,15,"Provided custom style's linked style is not a custom style."),!1;Ie=this.qb.Gv(ee);if(2!==Ie&&1!==Ie)return r.ULS.sendTraceTag(592221659,3018,15,"Provided style's target type: {0}, linked style's target type: {1}. ",vd,Ie),!1}else r.ULS.sendTraceTag(592221658,3018,50,"Provided style's linked style is null.");let Xe=this.Uub(Tc,h);if(!Xe)return!1;v++;rc&&(1===vd?(Pa.add(X),Tb.add(Tc.id)):(B.add(X),mb.add(Tc.id)));if(ee){Xe=this.Uub(ee,h);if(!Xe)return!1;v++;rc&&(1===Ie?(Pa.add(this.qb.oe(ee)),
Tb.add(ee.id)):(B.add(this.qb.oe(ee)),mb.add(ee.id)))}}hu.a.wzb();h=dl.a.iaf(h);X=new gf.GraphTransaction(15);X.Oa(c);rc&&this.xXm(B,Pa,mb,Tb,c);c.setValue(zi.a.E5,h);Sd.b(572302817,3018,50,String.format("Style Object Ids - {0}",h));X.U_d();X.dispose();c=(new Date).getTime();B=new Map;B.set("Source","DeleteStyleAPI");B.set("NumberOfStyles",a.count.toString());B.set("TrueStyleCount",v.toString());B.set("ShouldRemoveReferences",(!0).toString());a=Object.assign(new fi.a,{extendedProperties:B,durationMs:c-
ma});Fa.Health.instance.recordKpiSuccess(Xf.a.t8d,a);return!0}return!1}xXm(a,c,h,v,B){if(a&&a.count||c&&c.count)if(B){var X=(new Date).getTime();if(B=this.CZk(B)){for(;B.moveNext();){if(!sd.ParagraphReader.eg(B.iterator))continue;const ma=B.currentNode;this.hXm(ma,a,h);this.iXm(ma,c,v)}h=(new Date).getTime();r.ULS.sendTraceTag(591148963,3018,50,String.format("RemoveStyleReferences Duration: {0} ms;",h-X));v=new Map;v.set("Source","DeleteStyleRemoveStylesReferences");v.set("NumberOfStyles",(a.count+
c.count).toString());a=Object.assign(new fi.a,{extendedProperties:v,durationMs:h-X});Fa.Health.instance.recordKpiSuccess(Xf.a.t8d,a)}}else Sd.b(577520338,3018,50,"PageContentNode not provided.");else Sd.b(577520337,3018,50,"No style IDs provided")}hXm(a,c,h){if(c&&c.count&&a){var v=a.lz;v&&v.hasProperty(zi.a.paragraphStyle)&&h.contains(v.getValue(zi.a.paragraphStyle))&&(v.removeProperty(zi.a.paragraphStyle),a.lz=v,a.Yz()&&this.Xj.sS(a,a.Yz(),this.hd.Bf));(h=this.qb.um(a))&&(h=this.qb.oe(h))&&c.contains(h)&&
this.YPe(a,!0,!0)}}iXm(a,c,h){if(a&&a.la&&a.la.length&&c&&c.count)for(let ma=0;ma<a.la.length;ma++){var v=a.la.J(ma);if(v&&v.formatting&&(v=v.formatting)&&v.Xa){var B=ua.FormattingReader.vqa(v);B&&(B=this.qb.oe(B))&&c.contains(B)&&this.hh.OPe(v);if(B=v.Xa.wm){var X=B.fm;X&&(X=X.clone(),X.hasProperty(zi.a.Oz)&&h.contains(X.getValue(zi.a.Oz))&&this.AVm(a,X,B,v));kg.a.instance.J(3)&&(X=ma===a.la.length-1?a.characterData.length:a.la.J(ma+1).cp,this.Xj.VFb(a,v.Xa,v.Xa.cp,X,B,v,this.hd.Bf))}}}}AVm(a,c,
h,v){a&&c&&h&&v&&(a=a.Mb)&&(c.removeProperty(zi.a.Oz),c.Gja?c=a.iP(c,!0):a.At(c,null),h.mi=c.id,v.Xa.wm=h)}CZk(a){if(!a)return null;a=Kd.GraphIterator.va(a);return a.fn()?Tl.a.eq(a,a.origin):null}Uub(a,c){if(!a)return r.ULS.sendTraceTag(592221660,3018,10,"WACStyle for given style ID is null."),!1;var h=a.Fg();return this.qb.HI(h)?c.wXm(a)?!0:(h=new Map,h.set("Source","DeleteStyle"),h.set("StyleType",py[this.qb.Gv(a)]),h.set("IsCustomStyle",this.qb.ny(a,c).toString()),h.set("IsLinkedStyle",(!!this.qb.r0(a,
c)).toString()),a=Object.assign(new fi.a,{extendedProperties:h}),Fa.Health.instance.recordKpiFailure(Xf.a.t8d,"UnableToDeleteStyle",!1,!0,a),r.ULS.sendTraceTag(592221662,3018,50,"Couldn't remove style from style set."),!1):(r.ULS.sendTraceTag(592221661,3018,50,"Invalid property set inside WACStyle."),!1)}D5b(a,c,h,v){if(this.Ua&&this.Ua.isFeatureEnabled(130)){if(!a)return r.ULS.sendTraceTag(591138959,3018,15,"No style IDs provided for delete."),!1;if(!h&&(h=dl.a.Vy(),!h))return r.ULS.sendTraceTag(591138960,
3018,15,"Couldn't retreive PageContentNode."),!1;const X=this.L$.vM(h);if(!X)return r.ULS.sendTraceTag(591138961,3018,50,"Couldn't retreive WACStyleSet from PageContentNode."),!1;a=X.zg(a);if(!a)return r.ULS.sendTraceTag(591138962,3018,50,"Provided style is null[{0}].",!a),!1;var B=this.qb.Gv(a);if(2!==B&&1!==B)return r.ULS.sendTraceTag(591138963,3018,50,"Provided style has style type: {0}.",B),!1;Fa.Health.instance.recordKpiUsage(Xf.a.M2f,0,Xf.a.pF,new Map([["Source","ModifyStyleAPI"]]));B=Date.now();
const ma=new gf.GraphTransaction(15);try{ma.Oa(h);if(!(v&&0!=v.length||c&&0!=c.count))return!1;if(v&&0!=v.length&&!X.Prk(a,v))return this.Dra("ModifyStyleAPI",a,X,B,"UnableToDeleteStyleProperties"),!1;if(c&&0!=c.count&&!X.tRn(a,c))return this.Dra("ModifyStyleAPI",a,X,B,"UnableToModifyStyle"),!1;hu.a.wzb();const Pa=dl.a.iaf(X);h.setValue(zi.a.E5,Pa);Sd.b(572302818,3018,50,String.format("Style Object Ids - {0}",Pa));const mb=Date.now(),Tb=new Map([["Source","ModifyStyleAPI"]]),rc=Object.assign(new fi.a,
{extendedProperties:Tb,durationMs:mb-B});Fa.Health.instance.recordKpiSuccess(Xf.a.M2f,rc);return!0}finally{ma&&ma.dispose()}}return!1}Dra(a,c,h,v,B){const X=Date.now();a=new Map([["Source",a],["StyleType",py[this.qb.Gv(c)]],["IsCustomStyle",this.qb.ny(c,h).toString()],["IsLinkedStyle",(!!this.qb.r0(c,h)).toString()]]);v=Object.assign(new fi.a,{extendedProperties:a,durationMs:X-v});Fa.Health.instance.recordKpiFailure(Xf.a.M2f,B,!1,!0,v)}static get Ag(){return jn.PageNavigator.instance}}Object(w.a)(qy,
"WACStyleEditor",null,[27]);class Sw extends qy{constructor(a,c,h){super(a,h);this.oT=c}get Dq(){return this.oT.value}pmd(a,c){this.Dq.pmd(a,c)}}Object(w.a)(Sw,"WACStyleEditor",qy,[]);var Vq=b(155);class KB{V_a(a,c){a.properties.setValue(Yb.a.marginTop,c)}T_a(a,c){a.properties.setValue(Yb.a.marginBottom,c)}wea(a,c){a.properties.setValue(Yb.a.marginLeft,c)}U_a(a,c){a.properties.setValue(Yb.a.marginRight,c)}BQf(a,c){a.properties.setValue(Yb.a.Po,c)}AQf(a,c){a.properties.setValue(Yb.a.lA,c)}VBi(a,c){a.properties.setValue(Yb.a.WYh,
c)}z$b(a,c){a.properties.setValue(Vq.a.I7,c)}XUc(a){a.properties.setValue(Vq.a.tU,void 0)}}Object(w.a)(KB,"WordSectionEditor",null,[565]);class VA{get name(){return"WordEditor.OutlineLevelEditors"}yb(a){a.ha("WordEditor.OutlineLevelEditors.WordSectionEditor",()=>new KB).as("Box4.IWordSectionEditor").singleInstance();l.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(a.ha("Box4.OutlineLevelEditors.PageContentEditor",()=>new dw(a.resolve("Box4.IOutlineEditor"))).as("Box4.Pages.IPageContentEditor").singleInstance(),
a.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Yn(Vn.a.gJa,a.resolve("WordEditor.List.IFlatListReader"),a.te("Box4.IOutlineElementEditor"),a.te("WordEditor.IFlatListEditor"))).as("Box4.IOutlineElementIndentationEditor"),a.ha("WordEditor.OutlineLevelEditors.OutlineElementIndentationEditor",()=>new Yn(Vn.a.gJa,a.resolve("WordEditor.List.IFlatListReader"),a.te("Box4.IOutlineElementEditor"),a.te("WordEditor.IFlatListEditor"))).as("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"),
a.ha("WordEditor.OutlineLevelEditors.CursorMoveValidator",()=>new vt).as("Box4.List.ICursorMovementValidator").singleInstance(),a.ha("Box4.Styles.WACStyleReader",()=>new UA.a(a.resolve("WordEditor.ClientPagination.IClientPaginationSettings"),new kl.WACStyleSet)).as("Box4.Styles.IWACStyleReader").singleInstance(),a.ha("WordEditor.OutlineLevelEditors.WACStyleEditor",()=>new Sw(a.resolve("Box4.List.IListReader"),a.te("WordEditor.IFlatListEditor"),a.te("Box4.List.IListEditor"))).as("Box4.Styles.IWACStyleEditor").singleInstance())}init(){}dispose(){}static main(){M.a.instance.Lb(new VA)}}
Object(w.a)(VA,"WordEditorOutlineLevelEditorsPackage",null,[1,2]);var ry=b(1053),jz=b(533),sv=b(735),tv=b(301);class qs{constructor(a,c,h,v,B,X){this.zc=B;this._pageContent=h;this.sob=Array(qs.qda);this.uRb=Array(qs.qda);this.OGg=Array(qs.qda);this.Eye=Array(qs.qda);this.WCg=Array(qs.qda);this.W2=v;this.Ssc=X;for(v=0;v<qs.qda;v++){var ma=this.vxh(a,v,h,B);ma?(X=ma.ia(Ed.a.kV,ai.a.Ih),ma=ma.ia(Yb.a.LTc,ai.a.Ih)):ma=X=ai.a.Ih;this.uRb[v]=X!==ai.a.Ih?X:ai.a.ezc;this.Eye[v]=ma===ai.a.Ih?v-1:ma-1;qs.C4(c)&&
(this.OGg[v]=ai.a.Ih,this.WCg[v]=ai.a.Ih);this.sob[v]=this.uRb[v]}}vxh(a,c,h,v){v.$_(h);return As.a.getInstance().W1b&&this.Ssc?this.zc.R8e(a,c,this.W2,h):this.zc.d_b(a,c,h.Mb,h)}restart(a){this.sob[a]=this.uRb[a]}K7h(a){for(var c=0;c<a;c++)this.sob[c]===this.uRb[c]&&this.sob[c]++;for(c=a+1;c<qs.qda;c++)this.Eye[c]>=a&&this.restart(c);return this.sob[a]++}static C4(a){return!!a&&a.isFeatureEnabled(116)}}qs.qda=9;Object(w.a)(qs,"AWordList",null,[32]);class yx{constructor(a,c,h,v){this.n5a=new br.ScriptSharpLegacyMap;
this.zc=a;this.nu=c;this.W2=h;this.Ssc=v}Op(a,c){this.n5a.Ja(a)||this.n5a.Z(a,new qs(a,c,this.nu,this.W2,this.zc,this.Ssc));return this.n5a.J(a)}Wvf(a,c,h){return this.Op(a,h).K7h(c)}}Object(w.a)(yx,"AListNumberingMap",null,[1200]);class kz extends qs{constructor(a,c,h,v,B,X){super(a,c,h,v,B,X)}Z9k(a,c,h,v){v.$_(h);return As.a.getInstance().W1b&&this.Ssc?this.zc.$5k(a,c,this.W2):this.zc.Z5k(a,c,this._pageContent.Mb)}cUi(a,c,h){var v=this.Z9k(a,c,this._pageContent,this.zc);v?(a=v.ia(Ed.a.kV,ai.a.ezc),
v=v.ia(Yb.a.LTc,ai.a.Ih),this.sob[c]=this.OGg[c]=this.uRb[c]=a,v!==ai.a.Ih&&(this.WCg[c]=this.Eye[c]=v-1)):h&&(v=this.vxh(a,c,this._pageContent,this.zc),a=ai.a.ezc,v&&(a=v.ia(Ed.a.kV,ai.a.ezc)),this.sob[c]=this.uRb[c]=a)}}Object(w.a)(kz,"WordList",qs,[]);class lz extends yx{constructor(a){super(a.Yb,a.pageContentNode,a.nFb,a.WWi);this.hBg=new Ua.a}B5k(a,c,h){let v;As.a.getInstance().TR?{value:v}=this.zc.PO.Ab(a,v):{value:v}=this.zc.NO.Ab(a,v);this.n5a.Ja(v)||this.n5a.Z(v,new kz(a,h,this.nu,this.W2,
this.zc,this.Ssc));if(!this.hBg.contains(a))for(this.hBg.add(a);c<ai.a.qda;c++)this.n5a.J(v).cUi(a,c,!1);else if(!c)for(c+=1;c<ai.a.qda;c++)this.n5a.J(v).cUi(a,c,!0);return this.n5a.J(v)}Wvf(a,c,h){return qs.C4(h)?this.B5k(a,c,h).K7h(c):super.Wvf(a,c,h)}}Object(w.a)(lz,"ListNumberingMap",yx,[]);class bA{constructor(){this.vda=0;this.FYi=!1}}Object(w.a)(bA,"LastNumber",null,[]);var WA=b(534),XA=b(651),wt=b(794);class cA{constructor(){this.startAt=this.xY=0}}Object(w.a)(cA,"WordListRestartInfo",null,
[]);class Gn{constructor(a,c,h,v){this.LPd=!1;this.Dq=a;this.uTh=h;this.K1b=v;this.Jq=this.Dq.Fv(c);this.outlineElement=new Kd.GraphIterator;this.outlineElement.Wb(c)}static get Yb(){return Gn.zc||(Gn.zc=xa.a.instance.resolve("Box4.List.IListReader"))}static set Yb(a){Gn.zc=a}static get Dc(){return As.a.getInstance()}static BIk(a,c,h,v=!1,B=!1){var X=c.currentNode;let ma=null;new Kd.GraphIterator;let Pa=!1,mb=!1;c=c.ffa();const Tb=Tl.a.zn(c);Tb.moveNext();for(c=Tb.iterator;c.currentNode!==X;){let Tc=
mb=Pa=!1;var rc=!1;ab.ListReader.mq&&(rc=Gn.Xxk(c));if(Ta.OutlineElementReader.Gg(c)&&!rc){rc=!1;if(c.pp(4))if(Gn.a9h(c,h,!0,v,B))if(ab.ListReader.oX){if(Tc=!0,ma=new Gn(a,c,!1,!1),Tb.moveNext(),Tb.iterator===X&&(Pa=!0),v)break}else ma=new Gn(a,c,!1,!1),Pa=!0;else Ta.OutlineElementReader.isEmpty(c,!1)||(rc=!0),mb=!0;else!Ta.OutlineElementReader.isEmpty(c,!1)&&c.uJa(12)&&(Ta.OutlineElementReader.WN(c)||(rc=!0));!v&&rc&&ma&&(!h.propertySet.hasProperty(Yb.a.qe)&&ab.ListReader.mq?ma=null:ma.Jq.level=
0)}Tc||Tb.moveNext();c=Tb.iterator}ma&&(ma.K1b=Pa);if(!ma&&c.ue(1))for(X=!0;c.currentNode;){if(Ta.OutlineElementReader.Gg(c)){if(c.pp(4)&&Gn.a9h(c,h,!1,v,B)){ma=new Gn(a,c,!0,X);break}if(!Ta.OutlineElementReader.isEmpty(c,!1))break}if(!c.ue(1))break;X=!1}ma&&(ma.LPd=mb);return ma}static Xxk(a){var c=a.Za(2);if(!c)return!1;c=sd.ParagraphReader.eg(a)&&Gn.CPl(c);a.ob();return c}static CPl(a){return ac.a(a,8)}static a9h(a,c,h,v=!1,B=!1){Gn.Yb.lB(a);var X=a.currentNode;a.ob();if(X.ia(Yb.a.Xja,!1)&&!Gn.Dc.vAb)return!1;
const ma=Gn.Yb.qO(X);(a=c.nq===ma.nq)&&c.listStyle&&1!==c.pq&&(a=c.listStyle===ma.listStyle);Gn.Yb.qq&&a&&(c.Jja&&1!==c.pq||c.$Yb||B)&&(a=Gn.INl(c,ma),c.nq||(a=a&&c.font===ma.font));if(1===c.pq)if(1===ma.pq&&ma.propertySet.hasProperty(ii.a.Ndb))a=c.K1===ma.K1;else return!1;a&&c.nq&&c.vy!==ai.a.Ih&&(a=ma.Lo,h&&(v&&1===c.vy&&1===a||a++),a=c.vy===a);a&&(v||c.$Yb)&&(c=c.propertySet.ia(Yb.a.listID,0),X=X.ia(Yb.a.listID,0),0<c&&0<X&&(a=c===X));return a}static INl(a,c){c=c.FLd;a.Jja&&(c=c.replace(RegExp("%\\d"),
"%1"));return c.toLocaleLowerCase()===a.FLd.toLocaleLowerCase()}static CIk(a,c,h){var v=c.currentNode;let B=null;const X=new Kd.GraphIterator,ma=a.fK(v,h);var Pa=!1;let mb=!1;X.Wb(c);X.ob();for(X.Za(1);X.currentNode!==v;)mb=Pa=!1,Ta.OutlineElementReader.Gg(X)&&X.pp(4)&&(c=a.Fv(X),Gn.b9h(c,h,!0)?(B=new Gn(a,X,!1,!1),Pa=!0):(mb=!0,c.listID===h.listID&&c.level<=ma.xY&&(B=null))),X.ue(1);B&&(B.K1b=Pa);if(!B&&X.ue(1))for(v=!0;X.currentNode;){if(Ta.OutlineElementReader.Gg(X)&&X.pp(4)){Pa=a.Fv(X);if(Pa.listID===
h.listID&&Pa.level<=ma.xY)break;if(Gn.b9h(Pa,h,!1)){B=new Gn(a,X,!0,v);break}}if(!X.ue(1))break;v=!1}B&&(B.LPd=mb);return B}static b9h(a,c,h){let v=a.listID===c.listID&&a.level===c.level;v&&c.Lo!==ai.a.Ih&&(a=a.Lo,h&&a++,v=c.Lo===a);return v}}Gn.zc=null;Object(w.a)(Gn,"JoinTargetInfo",null,[]);class Np{constructor(){this.action=0;this.Jq=null}}Object(w.a)(Np,"ApplyListInfoWordResult",null,[]);class sy{constructor(a,c,h){this.YFn=a;this.$ac=h;this.Rvm=c;this.caa=h-c.Lo;this.fPc=c.listID}get delta(){-1!==
this.caa&&(this.caa=this.$ac-this.Rvm.Lo);return this.caa}set delta(a){this.caa=a}}Object(w.a)(sy,"ListTransferInfo",null,[]);class Mn extends Wi.a{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd){super(a,h,mb);this.YRa=!1;this.X6a=this.xhc=this.t4c=this.NLb=null;this.uj=B;this.LB=a;this.BNb=c;this.Fb=v;this.YCf={};this.lre=X;this.Bb=ma;this.rf=Pa;this.Na=Tb;this.Tk=Tc;this.yv=vd}get C4(){return this.LB.W8}get nl(){return this.LB}get D5(){return this.yv}get qb(){return this.Tk}get Er(){return this.nl.Er}get ao(){return this.nl.ao}get p7(){return this.nl.p7}get qq(){return this.Yb.qq}get y4(){return this.nl.y4}set y4(a){this.nl.y4=
a}get KKa(){return this.nl.KKa}set KKa(a){this.nl.KKa=a}get Hhb(){return this.X6a||(this.X6a=xa.a.instance.ra("Box4.List.ISingleLevelListEditor"))}tKj(a,c,h,v){r.ULS.sendTraceTag(17622210,324,50,"AdjustAndSetLevel is called in WordEditor.");const B=h.ia(Uc.a.MHd,!1);let X=!1,ma=-1;!B||c.listStyle&&1!==c.pq||(X=!h.ia(Uc.a.CYh,!1),ma=h.ia(Uc.a.Eof,-1));a=this.XTb(a,c,!0,X,ma,v,h);B||h.setValue(Uc.a.CYh,2===a.action);3===a.action&&!h.hasProperty(Uc.a.Eof)&&a.Jq&&h.setValue(Uc.a.Eof,a.Jq.level)}merge(a,
c,h,v=null){a=super.merge(a,c,h,v);this.S5();return a}gki(a,c){this.e2j(a,c)}e2j(a,c){a=this.Yb.M8e(a);const h=this.Yb.M8e(c);-1!==a&&-1!==h&&(a-=h,0<a?this.BNb.value.ozc(c,a):0>a&&this.BNb.value.$La(c,a,0))}Kqi(a){this.Yb.lB(a);this.leaveList(a);a.xf();kg.a.instance.J(3)&&this.S5()}VFn(a,c,h,v){var B=Kd.GraphIterator.va(h);B=this.Fv(B);this.WFn(B,a,c,h,v);Eb.App.Ldb&&!Wi.a.Dc.JO&&this.XFn(h,v)}Fv(a){this.Yb.lB(a);const c=this.vca(a.currentNode);a.ob();return c}Dgn(a,c){this.Yb.lB(a);a.currentNode.setValue(Yb.a.listID,
c);c=this.vca(a.currentNode);a.ob();return c}vca(a){const c=new sv.a;if(kg.a.instance.J(3)){var h=this.Yb.bK(a,!1,!0);c.listID=h.listId;c.level=h.qe}else c.listID=a.ia(Yb.a.listID,0),c.level=a.ia(Yb.a.qe,-1);c.Xja=a.ia(Yb.a.Xja,!1);this.qq&&(h=this.AAd(a),c.qen(h));c.Lo=a.ia(Wi.a.Dc.Jw,ai.a.Ih);c.bAc=a.ia(Wi.a.Dc.uH,ai.a.Ih);return c}YTb(a,c){a||Ee.a.instance.ib("CrashWhenApplyingList",{["Reason"]:"ListNodeIsNull"});c||Ee.a.instance.ib("CrashWhenApplyingList",{["Reason"]:"RefInfoIsNull"});a.setValue(Yb.a.listID,
c.listID);a.setValue(Yb.a.qe,c.level);c.Xja&&a.setValue(Yb.a.Xja,!0)}bVi(a){this.nl.$_(a);a=Mn.Ag.Xs(a);let c=a.ia(Yb.a.ao,null);c=c?Array.clone(c):[];a.setValue(Yb.a.ao,c);this.nl.vzb()}MLi(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}K5k(a){a=a.view;if(!a.Ma||!a.Ma.Ca)return null;a=zm.OutlineElementGeneralizer.xia(a.Ma.Ca,!1);if(1!==a.length)return null;a=Kd.GraphIterator.va(a.getContext(0).node);if(!ab.ListReader.Pg(a))if(14===
a.Xc().type){const c=this.nl.dnl(a.currentNode);c&&a.set(c)}else Sd.b(589177753,393,15,"Encountered an OE of non list type."),a.ob();a.nc();return a}Njk(a,c,h,v){const B=a.sF(),X=new sv.a;X.listID=this.L9g(a);this.C4?(X.NLd=Wi.a.Dc.TR?this.M9g(a):this.D9g(a),this.Hni(a,X.listID,X.NLd)):this.Jni(a,X.listID);X.bCi(c.propertySet,this.ILc(h));this.Zud(a);h=this.Bxh(a,c);for(let Pa=0;9>Pa;Pa++){const mb=new Pn.a;B.Lc.At(mb);this.Ini(a,this.C4?N.a.nil:mb.id,this.C4?mb.id:N.a.nil);this.YCj(mb,c.nq,Pa);this.rOg(mb,
h,Pa);var ma=v.tBb[Pa];ma=6===ma?ot.a.$N(1,1):ot.a.$N(0,ma);ma.Vja&&mb.setValue(Ed.a.V0,ma.Vja);c.vy!==ai.a.Ih&&Pa===X.level&&mb.setValue(Ed.a.kV,c.vy);v.oya&&v.oya[Pa]&&mb.setValue(Ed.a.font,v.oya[Pa]);ma=v.KLc[Pa];r.ULS.shipAssertTag(22127636,338,!!ma);mb.setValue(Yb.a.Fq,ma);mb.setValue(Yb.a.k9,v.YKd[Pa]);tv.a.h1d(v.K1,mb)}return X}Mjk(a,c,h){const v=a.sF(),B=new sv.a;B.listID=this.L9g(a);this.C4?(B.NLd=Wi.a.Dc.TR?this.M9g(a):this.D9g(a),this.Hni(a,B.listID,B.NLd)):this.Jni(a,B.listID);B.bCi(c.propertySet,
this.ILc(h));if(!c.listStyle)switch(B.level%3){case 0:c.r5(c.listType,1);break;case 1:c.r5(c.listType,2);break;case 2:c.r5(c.listType,3)}this.Zud(a);h=this.Bxh(a,c);for(let X=0;9>X;X++){const ma=new Pn.a;v.Lc.At(ma);this.Ini(a,this.C4?N.a.nil:ma.id,this.C4?ma.id:N.a.nil);this.XCj(ma,c.nq,X);this.rOg(ma,h,X);this.qq&&(2===X%3&&c.nq?ma.setValue(Yb.a.k9,"right"):ma.setValue(Yb.a.k9,"left"));X===B.level&&(c.Vja&&ma.setValue(Ed.a.V0,c.Vja),c.vy!==ai.a.Ih&&ma.setValue(Ed.a.kV,c.vy),this.qq&&(c.nq?this.hCi(c,
ma,X):(Mn.eCi(c,ma),Mn.gCi(c,ma)),Mn.fCi(c,ma)),Yt.a.zJc&&c.$Yb&&ma.AG(c.propertySet,Yb.a.listID,Yb.a.qe))}return B}hCi(a,c,h){a.Jja?(a=a.levelText,a=F.a.replaceAll(a,"%1","%"+(h+1))):a=a.kIc||a.Eca?a.levelText:"%"+(h+1)+".";r.ULS.shipAssertTag(22127638,338,!!a);c.setValue(Yb.a.Fq,a)}UGi(a,c,h,v){if(a.kIc)return!1;if(1===a.pq)return v;if(v)return!0;if(c){v=a.listType===c.listType;const B=!a.listStyle&&a.vy===ai.a.Ih;let X=a.listStyle===c.listStyle&&a.vy===c.vy;this.qq&&(a=(!a.Jja||this.ANf(c,a))&&
!h,X=X&&a);return v&&(B||X)}return!1}Zud(a){this.NLb||(this.NLb=a.ia(Yb.a.Ipk,null));this.t4c||(this.t4c=a.ia(Yb.a.Hpk,null));this.xhc||(this.xhc=a.ia(Yb.a.Jpk,null))}ILc(a){720>a&&(a=0);a=Math.floor(a/720);0>a&&(a=0);8<a&&(a=8);return a}Jni(a,c){const h=a.ia(Yb.a.Er,null),v=h?h.length:0,B=Array(v+1);let X=0;for(;X<v;X++)B[X]=h[X];B[X]=c;a.setValue(Yb.a.Er,B);this.nl.vzb()}Hni(a,c,h){this.EHe(Yb.a.Er,a,c);if(Wi.a.Dc.TR){this.EHe(Vq.a.Z5b,a,h);var v=this.nl.wAd(a);v.add(c,h);a.setValue(Vq.a.PO,XA.b(ry.a.icc(v)))}else this.EHe(Yb.a.p7,
a,h),v=this.nl.vAd(a),v.add(c,h),a.setValue(Yb.a.NO,XA.b(ry.a.icc(v)))}Ini(a,c,h){this.C4?(this.eOg(Yb.a.ao,a,h),this.eOg(Yb.a.e1,a,c)):(h=(h=a.ia(Yb.a.ao,null))?Array.clone(h):[],h.push(c),a.setValue(Yb.a.ao,h),this.nl.vzb())}EHe(a,c,h){const v=c.ia(a,null),B=v?v.length:0,X=Array(B+1);let ma=0;for(;ma<B;ma++)X[ma]=v[ma];X[ma]=h;c.setValue(a,X)}eOg(a,c,h){let v=c.ia(a,null);v=v?Array.clone(v):[];v.push(h);c.setValue(a,v)}XCj(a,c,h){var v=h%3+1;if(ab.ListReader.mq){const B=c?this.xhc:this.t4c;B&&h<
B.length?a.setValue(Yb.a.qx,B[h]):a.setValue(Yb.a.qx,360)}v=ab.ListReader.oX?ot.a.$N(c?0:1,this.MLi(v),null,0,h):ot.a.$N(c?0:1,this.MLi(v));a.Zq(v.propertySet);a.setValue(Yb.a.ULe,c?-1:-2);this.qq&&(c?a.setValue(Yb.a.Fq,"%"+(h+1)+"."):(a.setValue(Ed.a.font,this.JYk(h)),a.setValue(Yb.a.Fq,String.fromCharCode(this.xYk(h)))),tv.a.I$b(2,a))}YCj(a,c,h){if(ab.ListReader.mq){const v=c?this.xhc:this.t4c;v&&h<v.length?a.setValue(Yb.a.qx,v[h]):a.setValue(Yb.a.qx,360)}a.setValue(Yb.a.ULe,c?-1:-2);tv.a.I$b(1,
a)}xYk(a){switch(a%3){case 0:return 61623;case 1:return 111;case 2:return 61607;default:return 61623}}JYk(a){switch(a%3){case 0:return"Symbol";case 1:return"Courier New";case 2:return"Wingdings";default:return"Symbol"}}L9g(a){if(this.C4)this.y4<ai.a.XLc&&this.nl.$_(a),this.y4=this.yyh(this.Er,this.y4,ai.a.XLc);else{if(this.y4<ai.a.XLc&&(this.nl.$_(a),this.Er&&this.ao)){a=this.Er.length;for(let c=0;c<a;c++)this.Er[c]>=this.y4&&(this.y4=this.Er[c])}this.y4+=1}return this.y4}D9g(a){this.KKa<ai.a.bkd&&
this.nl.$_(a);return this.KKa=this.yyh(this.p7,this.KKa,ai.a.bkd)}M9g(a){var c;this.nl.$_(a);do a=Math.floor(Math.random()*(Mn.tbm-Mn.D5h))+Mn.D5h;while(null===(c=this.nl.vCb)||void 0===c?0:c.includes(a));return a}yyh(a,c,h){if(c<h&&a){h=a.length;for(let v=0;v<h;v++)a[v]>c&&(c=a[v])}c++;return c}fLf(a,c,h){Mn.eKc||this.n3e(a,c,h,Object(m.a)(this,this.FWc,"siblingMatchesListAndLevel"),Object(m.a)(this,this.gtn,"siblingRenumberSimple"))}w_m(a,c,h,v=!1){this.n3e(a,c,h,Object(m.a)(this,this.FWc,"siblingMatchesListAndLevel"),
Object(m.a)(this,this.OIi,"siblingRenumberAndUpdateSublistsDelta"),null,v)}v_m(a,c,h){this.UMk(a,c,h,Object(m.a)(this,this.FWc,"siblingMatchesListAndLevel"),Object(m.a)(this,this.NIi,"siblingRenumberAndUpdateSublists"))}eLf(a,c,h){const v=Ee.a.instance.Tm(zb.a.eLf);1>Math.abs(h)&&Ee.a.instance.ib("PossiblyIncorrectListPromoteDemote",{["Reason"]:"DepthIsIncorrect"});(c<pp.a.A2e||c>pp.a.rLd)&&Ee.a.instance.ib("PossiblyIncorrectListPromoteDemote",{["Reason"]:"LevelHasInvalidRange"});(c+h<pp.a.A2e||c+
h>pp.a.rLd)&&Ee.a.instance.ib("PossiblyIncorrectListPromoteDemote",{["Reason"]:"Level+DepthHasInvalidRange"});const B={};let X=null;const ma=this.Fv(a);const Pa=a.currentNode,mb=ma.listID,Tb=c+h;let rc,Tc=ai.a.Ih,vd=!0,ee=!0,Ie=!1;const Xe=Array(9);let Yf=!1,Hh=!1;var Fi=new sv.a;Fi.listID=ma.listID;Fi.level=ma.level+h;Fi=this.nl.uca(a.currentNode,Fi);var wk=this.Yb.Op(a);Fi=Fi.nq;const Gk=wk.nq,Kl=this.qq&&(Fi||Gk);if(Gk||Fi){var Yj=new sv.a;Yj.listID=ma.listID;Yj.level=c;B[c.toString()]=this.fK(Pa,
Yj);wk=B[c.toString()].xY;Yj.level=Tb;B[Tb.toString()]=this.fK(Pa,Yj);rc=B[Tb.toString()].xY;for(var ao=0;9>ao;ao++)Xe[ao]=!1;ao=new Kd.GraphIterator;ao.Wb(a);Yj=ao.ffa();var oq=Tl.a.eq(ao,Yj);for(oq.moveNext();oq.moveNext();){ao=oq.iterator;var to=void 0;let Ys;if(ao.pp(4)&&(Yj=this.Fv(ao),Yj.listID===mb)){var zt=this.Yb.Op(ao);var Wq=zt.nq;Yj.level<=wk&&(vd=!1);Yj.level<=rc&&(ee=!1);if(!vd&&!ee)break;Ys=Yj.level.toString();B[Ys]||(B[Ys]=this.fK(Pa,Yj));zt=B[Ys];this.CZn(zt,Xe)||(zt.xY>=c?(X||(X=
this.uRe(ma,a,B)),to=ai.a.Ih,X[Ys]?to=!this.qq||Wq?X[Ys]+1:ai.a.Ih:Yj.level===Tb&&(to=!this.qq||Wq?zt.startAt:ai.a.Ih),to!==ai.a.Ih?(Yj.level!==Tb||Ie||(Tc=to,Ie=!0,this.Yb.lB(ao),ao.ob(),to++),this.itb(ao,to),X[Ys]=to):Kl&&this.S_f(ao,Yj)):zt.xY>=Tb?(X||(X=this.uRe(ma,a,B)),to=Xe[Yj.level]?!this.qq||Wq?X[Ys]+1:ai.a.Ih:!this.qq||Wq?zt.startAt:ai.a.Ih,this.qq&&to===ai.a.Ih?Kl&&this.S_f(ao,Yj):this.itb(ao,to),X[Ys]=to):Yj.level===c&&Gk||Yj.level===Tb&&Fi?(this.Yb.lB(ao),to=ao.currentNode,ao.ob(),to=
to.getValue(Wi.a.Dc.Jw),Wq=to===(zt.startAt===ai.a.Ih?1:zt.startAt)+1,Yj.level===c?!(0>h)&&Wq||Yf?Yf=!0:to--:(Hh?to--:0>h&&Wq&&this.Ajf(ao,zt,null)&&(to--,Hh=!0),Ie||(Tc=to,Ie=!0),to++),this.itb(ao,to)):Yj.level!==c&&Yj.level!==Tb||!Kl||this.S_f(ao,Yj),Xe[Yj.level]=!0)}}Fi&&!Ie&&(c=B[Tb.toString()],ma.level=Tb,Tc=this.kLc(ma,a,c).vda,Tc===ai.a.Ih?Tc=c.startAt:Tc++);Fi&&this.itb(a,Tc)}v.end()}tVg(){this.S5()}S5(){var a=null,c,h;if(kg.a.instance.J(3)){var v=new Kd.GraphIterator;if(a)if(8===a.type)v.set(a);
else{r.ULS.sendTraceTag(592535635,393,15,"Unable to update lists number as cannot navigate to page content node.");return}else v.set(Eb.App.oa.Da.Zb),Mn.Ag.EZf(v),a=Mn.Ag.Xs(v.currentNode);if(v.La(7)||v.mc(7)){v=Tl.a.eq(v,v.origin);var B=new lz({Yb:this.nl,pageContentNode:a,nFb:null,WWi:!1});for(a=new lz({Yb:this.nl,pageContentNode:a,nFb:null,WWi:!1});v.moveNext();){var X=v.iterator;if(!X.pp(4)&&!X.pp(31))continue;this.Yb.hCb(X);const Pa=X.currentNode;X.ob();if(!Pa){r.ULS.sendTraceTag(575813713,393,
15,"List Node comes out to be null while updating numbering. Iterator Valid {0}",X.Nc);continue}if(!this.C4&&63!==Pa.type&&this.Yb.qO(Pa).listType)continue;var ma=this.Yb.bK(Pa,!1,!1);if(this.C4&&ma&&this.Yb.ZId(ma.listId)){r.ULS.sendTraceTag(592535636,393,50,"Skipping updating list numbers for this list id {0}",ma.listId);continue}const mb=Object(ha.a)(Fb.AParagraphNode,ie.OutlineElementNavigator.Fd(X,!0));mb&&(mb.la?(null==mb.la.last&&r.ULS.sendTraceTag(540374985,393,15,"Unexpected : Encountered last of para character properties null."),
X.ob(),this.C4&&this.nl.$_(X.currentNode),12===mb.type&&(mb.Ai&&mb.lz.hasProperty(Yb.a.listID)||null===(c=mb.la.last)||void 0===c||!c.Xh)&&((X=this.Yb.bK(Pa,!0,!0))?this.jCi(Pa,a,Wi.a.Dc.hec,X):r.ULS.shipAssertTag(24475424,376,!0,"The previous number list ID is not found! List Node Type={0}",Pa.type)),!ma||null!==(h=mb.la.last)&&void 0!==h&&h.eh||!this.jCi(Pa,B,Wi.a.Dc.Jw,ma)||(ma=Pa.getValue(Wi.a.Dc.Jw),this.C4&&this.Yb.qO(Pa).listType||Pa.setValue(Wi.a.Dc.uH,ma))):r.ULS.shipAssertTag(24975004,376,
!0,"The paragraph node has null CharacterProperties! Skipping."))}}else r.ULS.shipAssertTag(593234060,376,7===v.Md,"Couldnt reach to page manifest node")}}jCi(a,c,h,v){h||r.ULS.shipAssertTag(571757918,393,!!h,"Prop definition is null");c=c.Wvf(v.listId,v.qe,this.Na);v=-1;a.hasProperty(h)&&(v=a.getValue(h));return c===v||this.C4&&63!==a.type&&this.Yb.qO(a).listType&&(!Wi.a.Dc.$ca||h!==Wi.a.Dc.hec||1!==this.Yb.qO(a).listType)?!1:(a.setValue(h,c),!0)}S_f(a,c){this.Yb.lB(a);const h=a.currentNode;a.ob();
h&&this.Yb.V8(h)&&this.p3e(a,c,Object(m.a)(this,this.orf,"matchesListId"),Object(m.a)(this,this.MVf,"sublistsUpdateListItem"))}Ajf(a,c,h){let v=!1,B=!0,X=0;const ma=this.Fv(a),Pa=a.currentNode;let mb=null;a=a.ffa();a=Tl.a.zn(a);for(a.Fl(wt.a.tYa,null);a.moveNext();){const Tb=a.iterator.currentNode;if(Tb===Pa)break;if(!ab.ListReader.F0(Tb))continue;const rc=this.Fv(a.iterator);rc.listID===ma.listID&&(rc.level>ma.level?(v=!0,mb=Tb,X++):rc.level===ma.level?(B=!1,mb=null,X=0):rc.level<=c.xY&&(B=!0,mb=
null,X=0))}return v&&B&&(!h||1===X&&mb===h)}CZn(a,c){for(a=a.xY;0<=a;a--)if(c[a])return!0;return!1}itb(a,c){this.Yb.lB(a);const h=a.currentNode;a.ob();const v=this.Fv(a);v&&this.nl.K4b(h,v.listID,v.level)?this.v_m(a.currentNode,v,c):Mn.eKc||(h.setValue(Wi.a.Dc.Jw,c),h.setValue(Wi.a.Dc.uH,c))}x_m(a,c,h){const v={};let B=null;const X=new Kd.GraphIterator;const ma=a.Lo===c.startAt;let Pa=!1;var mb=new Kd.GraphIterator;mb.Wb(h);var Tb=h.ffa();Tb=Tl.a.eq(mb,Tb);Tb.Fl(wt.a.tYa,null);Tb.moveNext();let rc=
!1;for(;Tb.moveNext();)if(X.Wb(Tb.iterator),X.pp(4)){var Tc=this.Fv(X);if(Tc.listID===a.listID)if(Tc.level>a.level)Pa=!0,mb=Tc.level.toString(),v[mb]||(v[mb]=this.fK(h.currentNode,Tc)),Tc=v[mb].xY,Tc===a.level&&(B||(B=this.uRe(a,h,v)),B[mb]&&(Tc=B[mb]+1,this.itb(X,Tc),B[mb]=Tc));else if(Tc.level===a.level||Tc.level<=c.xY){rc=!0;break}}return!rc||ma&&Pa?null:X}u_m(a){ab.ListReader.Pg(a)||Ee.a.instance.ib("PossiblyIncorrectListRenumber",{["Reason"]:jz.a.lvb});const c=this.Fv(a);var h=this.fK(a.currentNode,
c);const v=a.Za(4);v.removeProperty(Wi.a.Dc.hec);a.ob();const B=this.gCc(a,c,Object(m.a)(this,this.LVf,"sublistsEnsureSameList"),Object(m.a)(this,this.XLi,"sublistsUpdateLevel"));if(this.Yb.Op(a).nq){var X=null;B&&(X=this.Fv(B));X&&X.listID===c.listID&&X.level===c.level?h=this.Yb.Op(B).Lo:(X=this.kLc(c,a,h),h=X.vda===ai.a.Ih?h.startAt:X.vda+1);h!==ai.a.Ih&&(v.setValue(Wi.a.Dc.Jw,h),v.setValue(Wi.a.Dc.uH,h));B&&this.fLf(B.currentNode,c,1)}a.g0b()&&ab.ListReader.Pg(a)&&(a=this.Yb.Op(a),a.nq&&(a.Xba=
a.Lo))}get xGi(){return this.qq}Fxh(a){const c=this.Yb.Op(a);if(this.qq){c.$Yb=!0;this.Yb.lB(a);const h=a.currentNode.ia(Yb.a.listID,0);c.propertySet.setValue(Yb.a.listID,h);a.mc(11)}return c}uRe(a,c,h){const v={},B=new Kd.GraphIterator,X=c.currentNode;var ma=c.ffa();const Pa=Tl.a.zn(ma);for(Pa.Fl(wt.a.tYa,null);Pa.moveNext();){B.Wb(Pa.iterator);if(B.currentNode===X)break;if(B.pp(4)&&(ma=this.Fv(B),ma.listID===a.listID)){if(ma.level>a.level){this.Yb.lB(B);var mb=B.currentNode;B.ob();v[ma.level.toString()]=
mb.ia(Wi.a.Dc.Jw,ai.a.Ih)}for(mb=ma.level;mb<=pp.a.rLd;mb++){const Tb=mb.toString();v[Tb]&&(h[Tb]||(h[Tb]=this.fK(c.currentNode,ma)),h[Tb].xY>=ma.level&&delete v[Tb])}}}return v}kLc(a,c,h){const v=new Kd.GraphIterator,B=c.currentNode;let X;var ma=ai.a.Ih;let Pa=!1,mb=!1,Tb=!1,rc=null;var Tc=c.ffa();Tc=Tl.a.zn(Tc);for(Tc.Fl(wt.a.tYa,null);Tc.moveNext();){v.Wb(Tc.iterator);if(v.currentNode===B)break;Pa=!1;v.pp(4)&&(X=this.Fv(v),X.listID===a.listID&&(X.level===a.level?(this.Yb.lB(v),ma=v.currentNode,
v.ob(),ma=ma.ia(Wi.a.Dc.Jw,ai.a.Ih),Pa=!0,rc=v.kdc(1),mb=!0):X.level>a.level?Tb=!0:X.level<=h.xY&&(ma=ai.a.Ih,Tb=mb=!1)))}!mb&&Tb&&(ma=h.startAt);Pa&&(Pa=c.kdc(1)===rc);a=new bA;a.vda=ma;a.FYi=Pa;return a}Msi(a,c=!1,h=0){const v=this.vca(a),B=this.fK(a,v),X=this.nl.uca(a,v);var ma=new Kd.GraphIterator;const Pa=X.nq;let mb=B.startAt,Tb=!1,rc=!1;r.ULS.shipAssertTag(22127639,338,X.Eca,"Info does not have a level Text. ListNode.LevelText = {0}",a.ia(Yb.a.Fq,null));const Tc=X.listStyle;ma.set(a);if(ma.nc()&&
(a=ma.IMa()))for(a=Tl.a.zn(a),a.Fl(wt.a.tYa,v);a.moveNext();){ma=a.iterator.currentNode;if(!ab.ListReader.F0(ma))continue;var vd=this.Fv(a.iterator);c&&vd.listID===h&&(vd=this.Dgn(a.iterator,v.listID));if(vd.listID!==v.listID)continue;const ee=a.iterator.Za(4);ee&&a.iterator.ob();vd.level>v.level?(this.nl.K4b(ee,v.listID,vd.level)&&this.Zgf(ma,ee),rc=!0):(vd.level<=B.xY?(mb=B.startAt,rc=Tb=!1):(vd=this.y6h(a,Tc),this.qq&&vd.currentNode.setValue(Yb.a.Fq,X.FLd),{myi:Tb,vda:mb}=this.Osi(Pa,rc,Tb,vd,
mb,ma)),Mn.OOh(a))}}Zgf(a,c){r.ULS.shipAssertTag(22819227,338,!!a&&!!c);ab.ListReader.wda?c.setValue($f.a.Rof,N.a.create().toString()):a.setValue($f.a.Rof,N.a.create().toString())}s_m(a){if(!Wi.a.Dc.Zcb){var c=this.vca(a),h;this.fK(a,c);var v=this.nl.uca(a,c),B=v.nq,X=Array(10),ma=Array(10),Pa=null;r.ULS.shipAssertTag(22127640,338,v.Eca,"Info does not have a level Text. ListNode.LevelText = {0}",a.ia(Yb.a.Fq,null));var mb=v.listStyle;var Tb=new Kd.GraphIterator;Tb.set(a);if(Tb.nc()&&(Tb=Tb.IMa()))for(Tb=
Tl.a.zn(Tb),Tb.Fl(wt.a.tYa,c);Tb.moveNext();){var rc=Tb.iterator.currentNode;if(!ab.ListReader.F0(rc))continue;const Tc=this.Fv(Tb.iterator);if(Tc.listID!==c.listID)continue;(h=Tb.iterator.Za(4))&&Tb.iterator.ob();const vd=Tc.level;Pa=Pa?Pa.level:-1;c=this.vca(h);h=this.fK(h,c);this.Zgf(rc,a);if(Pa<vd||void 0===X[vd]||null===X[vd])X[vd]=h.startAt,ma[vd]=!1;h=this.y6h(Tb,mb);h.currentNode.setValue(Yb.a.Fq,v.FLd);({myi:ma[void 0],vda:X[void 0]}=this.Osi(B,Pa>vd,ma[vd],h,X[vd],rc));Pa=Tc;Mn.OOh(Tb)}}}y6h(a,
c){a=a.iterator;this.Yb.lB(a);Wi.a.Dc.Zcb||this.hgn(a.currentNode,c);return a}Osi(a,c,h,v,B,X){a?(c&&!h&&B++,ie.OutlineElementNavigator.Wc(v),this.itb(v,B),B++,h=!0,ab.ListReader.mq&&(v.Za(2),WA.a.O2b(v.currentNode)&&v.currentNode.lj(4,!0))):(v.currentNode.removeProperty(Wi.a.Dc.Jw),ie.OutlineElementNavigator.Wc(v));X.lj(4,!0);(a=v.yo(16))&&a.lj(8,!0);return{myi:h,vda:B}}hgn(a,c){a.setValue(Yb.a.listStyle,c)}fK(a,c){const h=Ee.a.instance.Tm(zb.a.fK),v=new cA;(a=this.nl.Ev(a,c.listID,c.level))?(v.xY=
a.ia(Yb.a.LTc,c.level-1),v.startAt=a.ia(Ed.a.kV,1)):Ee.a.instance.ib("PossiblyIncorrectListRestartValue",{["Reason"]:"listPropsIsNull"});h.end();return v}Olk(a){const c=zp.a.instance.createInstance(1074135151);a.Je(c,31)}WFn(a,c,h,v,B){const X=this.createList(c);c.ob();this.YTb(X,a);c=this.nl.uca(c.currentNode,a);c.listType||(X.setValue(Wi.a.Dc.Jw,a.Lo),X.setValue(Wi.a.Dc.uH,a.bAc),this.AYd(X,a,h?v:B,1));switch(c.listType){case 0:h="Numbering";break;case 1:h="Bullet";break;default:h="Invalid List Type"}l.AFrameworkApplication.pa.processAction(zb.a.joinList,
2);r.ULS.sendTraceTag(38544079,393,50,"List Actions : Join List - {0}",h);ab.ListReader.oX&&(X.setValue(Yb.a.listID,a.listID),X.setValue(Yb.a.qe,a.level))}XFn(a,c){a=Kd.GraphIterator.va(a).Za(4);c=Kd.GraphIterator.va(c).Za(4);a.hasProperty(Ed.a.fontColor)&&c.setValue(Ed.a.fontColor,a.getValue(Ed.a.fontColor));a.hasProperty(Ed.a.fontSize)&&c.setValue(Ed.a.fontSize,a.getValue(Ed.a.fontSize));a.hasProperty(Ed.a.font)&&c.setValue(Ed.a.font,a.getValue(Ed.a.font));a.hasProperty(Yb.a.D1)&&c.setValue(Yb.a.D1,
a.getValue(Yb.a.D1));a.hasProperty(Ed.a.bold)&&c.setValue(Ed.a.bold,a.getValue(Ed.a.bold));a.hasProperty(Ed.a.italic)&&c.setValue(Ed.a.italic,a.getValue(Ed.a.italic));a.hasProperty(Ed.a.superscript)&&c.setValue(Ed.a.superscript,a.getValue(Ed.a.superscript));a.hasProperty(Ed.a.subscript)&&c.setValue(Ed.a.subscript,a.getValue(Ed.a.subscript));a.hasProperty(Ed.a.strikethrough)&&c.setValue(Ed.a.strikethrough,a.getValue(Ed.a.strikethrough))}Dqi(a){if(kg.a.instance.J(10)){var c=this.qb.um(a);c?this.qb.oe(c)===
gj.StyleReader.wordStyleIdListParagraph&&(c=this.qb.tw(a),this.D5.MK(c.zg(gj.StyleReader.wordStyleIdNormal),a,!0,!1,!1,this.YRa&&l.AFrameworkApplication.K.$("WordEditorSkipTrackingChangeForList"))):r.ULS.shipAssertTag(8271188,315,!1)}}bgn(a){if(kg.a.instance.J(10)){if(this.qb.oe(this.qb.um(a))===gj.StyleReader.wordStyleIdNormal){const c=this.qb.tw(a);this.D5.MK(c.zg(gj.StyleReader.wordStyleIdListParagraph),a,!0,!0)}a.Ig(Yb.a.sk,Yb.a.gS,Yb.a.jE,Yb.a.R4,Yb.a.qx,Yb.a.gsa);a.setValue(Yb.a.OLa,0)}}X2j(a,
c){const h=a.getValue(Yb.a.listID),v=a.getValue(Yb.a.qe);for(let X=0;9>X;X++){const ma=this.nl.Ev(a,h,X);if(!ma)return Ee.a.instance.ib("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),null;var B=c.tBb[X];B=6===B?ot.a.$N(1,1):ot.a.$N(0,B);B.Vja&&ma.setValue(Ed.a.V0,B.Vja);ma.hasProperty(Ed.a.font)&&ma.removeProperty(Ed.a.font);c.oya&&c.oya[X]&&ma.setValue(Ed.a.font,c.oya[X]);B=c.KLc[X];r.ULS.shipAssertTag(22127641,338,!!B);ma.setValue(Yb.a.Fq,B);ma.setValue(Yb.a.pq,tv.a.J5b);tv.a.h1d(c.K1,
ma);ma.setValue(Yb.a.k9,c.YKd[X]);ma.Ig(Yb.a.LTc,Ed.a.kV);this.bVi(a)}this.s_m(a);a=new sv.a;a.listID=h;a.level=v;return a}D0g(a,c,h,v=null){if(this.qq&&v)return this.X2j(a,v);v=a.getValue(Yb.a.listID);const B=a.getValue(Yb.a.qe),X=this.nl.Ev(a,v,B);if(!X)return Ee.a.instance.ib("PossiblyIncorrectListStyle",{["Reason"]:"ListDefIsNull"}),c&&r.ULS.sendTraceTag(588022420,393,15,"List def is null for List Style {0}, List type {1}, ListId {2} and level {3}",c.listStyle,c.listType,v,B),null;Yt.a.zJc&&c.$Yb&&
(X instanceof aA.APropertySet?X.AG(c.propertySet,Yb.a.listID,Yb.a.qe):r.ULS.sendTraceTag(527991759,393,15,"ListDefintion was not an instance of APropertySet, it is an instance of {0}",null===X||void 0===X?void 0:X.constructor.name));var ma=X.ia(Yb.a.pq,null);ma&&ma===tv.a.J5b&&this.W2j(a,v);if(!c.listStyle){ma=0;if(-1!==h){for(ma+=B-h;0>ma;)ma+=3;ma%=3}switch(ma){default:h=1;break;case 1:h=2;break;case 2:h=3}c.r5(c.listType,h)}c.Vja&&X.setValue(Ed.a.V0,c.Vja);this.qq&&(c.nq?(this.hCi(c,X,B),X.hasProperty(Ed.a.font)&&
X.removeProperty(Ed.a.font)):(Mn.eCi(c,X),Mn.gCi(c,X)),Mn.fCi(c,X));X.Ig(Yb.a.LTc,Ed.a.kV,Yb.a.VJc);this.bVi(a);Wi.a.Dc.Zcb||this.Msi(a);a=new sv.a;a.listID=v;a.level=B;return a}W2j(a,c){let h;for(let v=0;9>v;v++){h=this.nl.Ev(a,c,v);if(!h){r.ULS.sendTraceTag(588022421,393,15,"List def is null for List id {0}, List level {1}",c,v);break}h.setValue(Yb.a.pq,tv.a.zFd);h.removeProperty(ii.a.Ndb)}}x0d(a,c){const h=Ee.a.instance.Tm(zb.a.x0d);this.BNb.value||Ee.a.instance.ib("PossibleIncorrectListIndentation",
{["Reason"]:"IOutlineElementIndentationEditorIsNull"});this.dRa?(h.properties.Z("PendingListInfo","true"),ab.ListReader.Pg(a)&&(h.properties.Z("RemoveCurrentListInfo","true"),this.YRa=!0,this.aHa(a,null,!0,!1,-1),this.BNb.value.$La(a,-1,0),this.YRa=!1),this.XTb(a,this.dRa,!1,!0,-1,!1,null,ab.ListReader.oX),this.dRa=null):c||(h.properties.Z("CurrentlyUnderPastedList","true"),this.aHa(a,null,!1,!1,-1));h.end()}jQf(a,c,h,v){const B=Ee.a.instance.Tm(zb.a.jQf);if(ab.ListReader.Pg(a)&&Ta.OutlineElementReader.isEmpty(a,
!1))this.BNb.value.tOe(a,-1)?this.BNb.value.$La(a,-1,0):this.aHa(a,null,!1,!1,-1);else{const X=!h.cpBegin,ma=h.cpBegin===sd.ParagraphReader.textLength(v),Pa=kg.a.instance.J(4)&&Eb.App.lc.$n;let mb=!0;Pa&&X&&!ma?(mb=!1,v=new Kd.GraphIterator,v.Wb(a),v.nc(),this.Vd.bA(v,!0,!1)):v=this.Vd.Mqa(a);this.Vd.o$(a,v,h,!1,!0,mb,!1,c);!Pa||X||ma||(c=Mn.uf.i6e(h),Eb.App.lc.zp.aF(c));this.YRa||(ie.OutlineElementNavigator.Fd(a),c=a.currentNode,ie.OutlineElementNavigator.Wc(a),ab.ListReader.Pg(a)&&c.Ai&&!c.lz.hasProperty(Yb.a.listID)&&
(ie.OutlineElementNavigator.Fd(v),a=v.currentNode,v=new Pn.a,a.Mb.At(v),this.rf.sS(a,v,this.Bb.Bf)),this.S5())}B.end()}u1d(a,c){var h;if(ab.ListReader.Pg(a))return!1;a.Za(2);var v=cg.a.jSj;const B=[!0,!1].map(X=>sd.ParagraphReader.jg(a.currentNode,X,void 0,!1));a.ob();for(let X=0;X<B.length;X++){const ma=B[X];if(ma&&!ab.ListReader.Yza(ma))for(const Pa of v)if(Pa.test(ma.characterData))return v=null===(h=Pa.exec(ma.characterData))||void 0===h?void 0:h[0],this.kPm(c,X?"nextPara":"prevPara",v),!1}return!0}kPm(a,
c,h){const v=new Map;v.set("CurrentAutoListPreventedAutoListText",a);v.set("UndoAutoListPreferenceFoundIn",c);v.set("UndoAutoListPreferenceAutoListText",h);Fa.Health.instance.recordKpiUsage(ai.a.Enf.$Um,0,ai.a.pF,v)}spn(a,c){return a&&c}cKf(a){for(let c=0;c<a.count;c++){const h=Kd.GraphIterator.va(a.J(c));h.fn();this.Ska(h)}a.clear()}Nsi(a){if(ab.ListReader.F0(a)){if(!Mn.eKc){const c=new Kd.GraphIterator;c.set(a);c.nc();this.u_m(c)}this.S5()}}cIf(a,c){a=new Kd.GraphIterator;a.set(c);a.nc();ie.OutlineElementNavigator.Wc(a);
a.tbb(c)||Ee.a.instance.ib("PossibleLossOfDirectFormatting",{["Reason"]:"OeDoesNotContainParagraph"});this.aHa(a,null,!0,!1,-1);return super.cIf(a,c)}$Bi(a,c,h){this.Vd.Xsa(a,c,h,!0)}dCi(a){a.r5(1,1)}pmd(a,c){const h=Ee.a.instance.Tm(zb.a.SOj);if(this.qb.HI(c.Fg())){if(ab.ListReader.Pg(a)&&this.XTb(a,null,!0,!1,-1),c=this.nl.Oxh(c)){h.properties.Z("EarlyReturn","False");this.nl.uca(a.currentNode,c);var v=Gn.CIk(this,a,c),B=this.createList(a);a.ob();if(v)this.joinList(B,v,!0);else{if(v=this.gCc(a,
c,Object(m.a)(this,this.LVf,"sublistsEnsureSameList"),Object(m.a)(this,this.XLi,"sublistsUpdateLevel"))){const X=this.Fv(v);if(X.listID===c.listID&&X.level<c.level&&this.Yb.Op(v).nq){const ma=this.fK(v.currentNode,X);X.Lo===(ma.startAt===ai.a.Ih?1:ma.startAt)&&(X.bAc=X.Lo,this.AYd(B,X,v.currentNode,1))}}v=this.fK(B,c);a=this.kLc(c,a,v);a=a.vda!==ai.a.Ih?a.vda+1:v.startAt===ai.a.Ih?1:v.startAt;this.YTb(B,c);B.setValue(Wi.a.Dc.Jw,a);B.setValue(Wi.a.Dc.uH,a)}B.setValue(Yb.a.Xja,!0);h.end()}}else Ee.a.instance.ib("PossiblyIncorrectListStyle",
{["Reason"]:"StyleContainerNotValid"})}AYd(a,c,h,v,B=!1){this.nl.K4b(a,c.listID,c.level)?this.w_m(h,c,v,B):this.fLf(h,c,v)}vTg(a,c,h,v,B=null){a=this.qq&&B?this.Njk(a,h,v,B):this.Mjk(a,h,v);this.YTb(c,a);h.listType||(v=h.vy,v===ai.a.Ih&&(v=1),c.setValue(Wi.a.Dc.Jw,v),c.setValue(Wi.a.Dc.uH,v));this.qq&&(h.Eca?(h=h.levelText,B||(h=h.replace("%1","%"+(a.level+1))),c.setValue(Yb.a.Fq,h)):(r.ULS.sendTraceTag(22127642,338,15,"desiredInfo does not have a levelText. Replacing with an emtpy string."),c.setValue(Yb.a.Fq,
"")));return a}leaveList(a){const c=this.vca(a.currentNode);var h=this.nl.uca(a.currentNode,c);const v=new Kd.GraphIterator;v.Wb(a);v.ob();ab.ListReader.Pg(v)||Ee.a.instance.ib("PossibleErrorInLeaveList",{["Reason"]:jz.a.lvb});var B=this.fK(v.currentNode,c),X=c.Lo===B.startAt;ab.ListReader.wda&&Mn.gFl(v);if(B=this.x_m(c,B,v)){const ma=this.Yb.Op(B);ma.Xba=ma.nq?ma.Lo:ai.a.Ih}h.nq&&B&&this.AYd(a.currentNode,c,B.currentNode,-1);X&&B&&(h=this.Fv(B),this.nl.uca(B.currentNode,h).nq&&(X=this.fK(B.currentNode,
h),h.Lo===(X.startAt===ai.a.Ih?1:X.startAt)+1&&this.Ajf(B,X,v.currentNode)&&this.AYd(a.currentNode,c,B.currentNode,-1,!0)));!B&&this.nl.K4b(a.currentNode,c.listID,c.level)&&this.p3e(v,c,Object(m.a)(this,this.orf,"matchesListId"),Object(m.a)(this,this.MVf,"sublistsUpdateListItem"))}joinList(a,c,h,v=null){let B=null,X=null;if(a)if(22!==a.type&&63!==a.type)r.ULS.sendTraceTag(587851670,393,15,"Graph node {0} received is not list node : skipping join list action.",a.type);else{kg.a.instance.J(3)&&(B=this.nl.VVa(a),
X=B.Yz());(kg.a.instance.J(3)||Wi.a.Dc.lAb)&&this.YTb(a,c.Jq);if(this.nl.uca(a,c.Jq).nq){var ma=new Kd.GraphIterator;ma.set(a);ma.nc();ma.ob();let Pa=null;Wi.a.Dc.FQl&&v&&!v.YFn&&(Pa=this.nl.Oyh(ma.currentNode,c.Jq));const mb=this.hLk(ma,c,v);ma=this.ZKk(ma,a,c,h,v,mb);this.dLk(c,h,v,mb,ma);Pa&&mb&&this.fLf(Pa,c.Jq,this.bWl(mb,Pa)-(c.Jq.Lo-1))}kg.a.instance.J(3)||Wi.a.Dc.lAb||this.YTb(a,c.Jq);kg.a.instance.J(3)&&B&&X&&!this.YRa&&(this.rf.sS(B,X,this.Bb.Bf),this.S5())}else r.ULS.sendTraceTag(587747659,
393,15,"List node received is null : skipping join list action.")}bWl(a,c){let h=0;const v=this.Fv(a),B=new Kd.GraphIterator;B.set(a.currentNode);B.nc();a=hq.a.eq(B,B.ffa());for(a.Fl(wt.a.tYa,null);a.moveNext();){if(!ab.ListReader.Pg(B))continue;this.Yb.lB(B);const X=this.vca(B.currentNode);B.ob();if(B.currentNode.id===c.id)break;X.listID===v.listID&&X.level===v.level&&h++}return h}hLk(a,c,h){if(c.uTh)c=c.outlineElement;else{let v,B;h?(v=Object(m.a)(this,this.WLi,"sublistsEnsureSameListAsOriginal"),
B=Object(m.a)(this,this.G3d,"sublistsUpdateId")):c.K1b?(v=Object(m.a)(this,this.LVf,"sublistsEnsureSameList"),B=Object(m.a)(this,this.G3d,"sublistsUpdateId")):(v=Object(m.a)(this,this.yyn,"sublistsEnsureLevelHigherThanOrEqualTo"),B=Object(m.a)(this,this.zyn,"sublistsUpdateLevelAndId"));c=this.gCc(a,c.Jq,v,B,h)}!c&&h&&(h=new Kd.GraphIterator,h.Wb(a),h.g0b()&&ab.ListReader.Pg(h)&&(c=h));return c}ZKk(a,c,h,v,B,X){v?(B?a=B.$ac:(X=this.fK(c,h.Jq),h=this.kLc(h.Jq,a,X),a=h.vda!==ai.a.Ih?h.vda+1:X.startAt===
ai.a.Ih?1:X.startAt),c.setValue(Wi.a.Dc.Jw,a),c.setValue(Wi.a.Dc.uH,a)):(a=ai.a.Ih,this.Ign(c,X,h));return a}dLk(a,c,h,v,B){if(v){var X=!1,ma=this.Fv(v),Pa=ma.level===a.Jq.level,mb=!!h&&ma.listID===h.fPc;(ma.listID===a.Jq.listID||mb)&&Pa&&(Pa=this.fK(v.currentNode,ma),mb=Pa.startAt===ai.a.Ih?1:Pa.startAt,ma.Lo===mb+1&&(X=c?B===mb:this.Ajf(v,Pa,null)));if(!X||h)h?(c=h.delta,B=Object(m.a)(this,this.etn,"siblingMatchesLevel"),X=Object(m.a)(this,this.ftn,"siblingRenumberAndUpdateListID")):(c=1,B=Object(m.a)(this,
this.FWc,"siblingMatchesListAndLevel"),X=Object(m.a)(this,this.OIi,"siblingRenumberAndUpdateSublistsDelta")),ma=new Kd.GraphIterator,ma.set(v.currentNode),ma.nc(),this.Yb.lB(ma),ma.ob(),this.n3e(v.currentNode,a.Jq,c,B,X,h)}}Ign(a,c,h){let v=null;c&&(v=this.Fv(c));if(v&&v.listID===h.Jq.listID&&v.level===h.Jq.level){const B=this.Yb.Op(c);let X=B.Lo;a.setValue(Wi.a.Dc.Jw,X);a.setValue(Wi.a.Dc.uH,X);ab.ListReader.oX&&(B.propertySet.setValue(Yb.a.listID,v.listID),B.propertySet.setValue(Yb.a.qe,v.level));
if(!h.K1b||h.LPd)h.uTh&&!h.LPd&&(this.Yb.lB(c),a=c.currentNode,ie.OutlineElementNavigator.Wc(c)),a.setValue(Wi.a.Dc.uH,a.getValue(Wi.a.Dc.Jw))}else c=h.Jq.Lo+1,a.setValue(Wi.a.Dc.Jw,c),a.setValue(Wi.a.Dc.uH,c)}aHa(a,c,h=!0,v=!1,B=-1){this.XTb(a,c,h,v,B)}XTb(a,c,h=!0,v=!1,B=-1,X=!1,ma=null,Pa=!1){const mb=Ee.a.instance.Tm(zb.a.XTb),Tb=new Np;Tb.Jq=null;Tb.action=0;if(!Ta.OutlineElementReader.Gg(a))return Ee.a.instance.ib("PossibleListStateNotUpdated",{["Reason"]:jz.a.KUa}),mb.end(),r.ULS.sendTraceTag(578331469,
393,15,"Iterator not pointing to OE in apply list info word."),Tb;let rc=-1,Tc;Tc=Ta.OutlineElementReader.n0(a);var vd=Mn.Ag.Xs(a.currentNode);const ee=a.Za(2);let Ie=!1,Xe=null;if(ee&&sd.ParagraphReader.tb(ee)&&(Ie=!0,Xe=ee,rc=this.uj.q0(a.currentNode).jt-this.uj.sI(ee).jt,ac.a(ee,8)))return mb.end(),r.ULS.sendTraceTag(578331470,393,15,"Returning from apply list info word as its a page break."),Tb;let Yf=null;if(kg.a.instance.J(3)&&12===ee.type){if(Xe.la.last.eh)return r.ULS.sendTraceTag(578331471,
393,15,"User applied list to para with deleted EOP."),Tb;Yf=Xe.Yz()}ie.OutlineElementNavigator.Wc(a);var Hh=Ta.OutlineElementReader.Bya(a);const Fi=Ta.OutlineElementReader.sI(a),wk=Ta.OutlineElementReader.n0(a);let Gk=null,Kl=null;c&&(Gk=c.iz,Kl=this.infoAtLevel(a,c));let Yj=a.Za(4);Yj?c&&16!==c.listType?(this.D0g(Yj,Kl,B,Gk,!!ma&&ma.hasProperty(Uc.a.fvf)),a.ob(),Tb.action=3,Tb.Jq=this.Fv(a)):(Ie&&(this.Dqi(Xe),this.AWm(Xe),Xe.kpa=null),v=this.Yb.ZId(Yj.ia(Yb.a.listID,0)),!Wi.a.Dc.$ca||v?(Yj.N1d=
!1,this.leaveList(a),a.xf()):a.ob(),h&&Ie&&(this.Zud(vd),vd=Hh+(wk?wk:-1*Fi)-this.xhc[0],vd=0>vd?0:vd,this.Vd.Xsa(a,1,vd)),Wi.a.Dc.$ca&&a.Za(4)&&(Yj.N1d=!1,this.leaveList(a),a.xf()),Tb.action=1,Tb.Jq=null,Xe&&(this.Bb.Bf&&!this.YRa||Wi.a.Dc.$ca&&!this.Bb.Bf&&Xe.Ai)&&(!Xe.Ai||Xe.lz&&Xe.lz.hasProperty(Yb.a.listID))&&this.Olk(a)):c&&16!==c.listType&&(h=-1,Hh=c.propertySet.ia(Yb.a.listID,-1),ab.ListReader.oX&&Pa&&0<Hh&&Hh+""in this.YCf&&(h=this.YCf[Hh+""]),c=c.Geb?new Gn(this,Kd.GraphIterator.va(c.Geb),
!1,!0):Gn.BIk(this,a,Kl,Pa,X),this.Fyl(a,Kl,v,Pa,c),Yj=this.ljk(a),this.qq&&this.ren(c,Kl),Ie&&!Wi.a.Dc.JO&&this.v0d(Yj,ee,ma),void 0===c||null===c||X||Kl.nq!==this.Yb.uca(Yj,c.Jq).nq?this.lJl(Kl,h,c,Yj)?(this.jPn(Kl,Yj,h,rc),Tb.action=3,Tb.Jq=this.D0g(Yj,Kl,-1,Gk)):(Tb.action=4,0<Tc&&(rc+=Tc),Tb.Jq=this.vTg(vd,Yj,Kl,rc,Gk),this.bPn(h,Hh,Tb.Jq,Yj)):(Tb.action=2,Tb.Jq=c.Jq,Kl.listStyle||(c.K1b=!0),this.aWl(h,Tb.Jq,Yj,c)),Ie&&this.bgn(ee),a.ob());kg.a.instance.J(3)&&!this.YRa&&(Xe&&Yf&&this.rf.sS(Xe,
Yf,this.Bb.Bf),this.S5());mb.end();return Tb}ljk(a){Wi.a.Dc.$ca&&a.Za(31)&&a.xf();return this.createList(a)}AWm(a){a.hasProperty(Yb.a.sk)&&a.removeProperty(Yb.a.sk);a.hasProperty(Yb.a.jE)&&a.removeProperty(Yb.a.jE);a.hasProperty(Yb.a.qx)&&a.removeProperty(Yb.a.qx)}infoAtLevel(a,c){if(!c)return null;const h=c.iz;if(this.qq)if(1===c.pq){if(c.Jja&&!c.XG||!c.CPe(!1))return c;let v;a=Ta.OutlineElementReader.Bya(a);v=this.ILc(a);const B=h.tBb[v];a=ot.a.fX(c.propertySet,c.propertySet);6===B?a.r5(1,1):a.r5(0,
B);a.y0d("multilevel");a.levelText=h.KLc[v];h.oya&&h.oya[v]&&(a.font=h.oya[v]);a.Dr=h.YKd[v];a.K1=h.K1;a.OLd=c.OLd}else a=c;else a=c;return a}ren(a,c){a&&a.Jq&&(c.levelText=a.Jq.levelText,c.nq||(c.font=a.Jq.font))}Fyl(a,c,h,v,B){if(h&&B){h=Ta.OutlineElementReader.Bya(a);if(this.qq){var X=Ta.OutlineElementReader.n0(a);0<X?h+=X:(X=Ta.OutlineElementReader.sI(a),0<X&&(h-=X))}c=c.propertySet.ia(Yb.a.qe,-1);B.Jq.level=v&&0<=c?c:this.ILc(h);this.nl.uca(a.currentNode,B.Jq).listType||(v=this.fK(a.currentNode,
B.Jq),a=this.kLc(B.Jq,a,v),B.Jq.bAc=B.Jq.Lo=a.vda===ai.a.Ih?v.startAt-1:a.vda,B.K1b=a.FYi)}else B&&B.Jq&&c.propertySet&&c.propertySet.hasProperty(Yb.a.qe)&&(B.Jq.level=c.propertySet.getValue(Yb.a.qe))}bPn(a,c,h,v){ab.ListReader.oX&&(0>=a?this.YCf[c+""]=h.listID:(v.properties.setValue(Yb.a.listID,a),h.listID=a))}jPn(a,c,h,v){c.properties.setValue(Yb.a.listID,h);c.properties.hasProperty(Yb.a.qe)||(h=a.propertySet&&a.propertySet.hasProperty(Yb.a.qe)?a.propertySet.pg(Yb.a.qe):this.ILc(v),c.properties.setValue(Yb.a.qe,
h),this.qq&&(a.propertySet&&a.Eca&&(h=a.levelText.replace("%1","%"+(h+1)),c.setValue(Yb.a.Fq,h)),a.propertySet&&a.s0b&&!Wi.a.Dc.JO&&c.setValue(Ed.a.font,a.font)))}aWl(a,c,h,v){if(ab.ListReader.oX){let B=null;0<a&&(B=new sy(0,c,-1),B.fPc=a,B.delta=-1);this.joinList(h,v,!1,B)}else this.joinList(h,v,!1)}lJl(a,c,h,v){return!ab.ListReader.oX||0>=c?!1:void 0===h||null===h?(h=a.propertySet.ia(Yb.a.qe,-1),0<=h&&(c=this.nl.Ev(v,c,h))&&(c=c.ia(Ed.a.V0,null))?a.Vja!==c:!1):a.nq!==this.Yb.uca(v,h.Jq).nq||a.Vja!==
this.Yb.uca(v,h.Jq).Vja}zWm(a,c){const h=!!c&&sd.ParagraphReader.tb(c);let v=0,B=0;h&&(v=this.uj.q0(a.currentNode).jt,B=this.uj.sI(c).jt);h&&this.Dqi(c);a.xf();h&&this.Vd.Xsa(a,1,v-B)}O7(a,c,h,v=-1,B=!1,X=null,ma=!1){r.ULS.sendTraceTag(17622211,324,50,"'Continue Existing List' is selected from Context Menu.");const Pa=Ee.a.instance.Tm(zb.a.O7),mb=this.Fb.Ob(15);mb.Lr(a);let Tb=null,rc=0;({$Vl:Tb,Pim:rc,returnValue:v}=this.aJk(a,c,v,Tb,rc,B,X));if(!Tb||ma&&(1===h||0>h-Tb.Jq.Lo||2<h-Tb.Jq.Lo))return mb.dispose(),
Pa.end(),!1;for(;0<rc;)a.g0b(),rc--;this.cPn(a,c,v,Tb);mb.dispose();Pa.end();return!0}cPn(a,c,h,v){for(;a.g0b();)if(a.Za(4)){if(this.vca(a.currentNode).listID===c.listID){c=new sy(0,c,h);this.joinList(a.currentNode,v,!0,c);break}a.ob()}}aJk(a,c,h,v,B,X=!1,ma=null){for(;a.fDd();){if(a.pp(4)){const Pa=this.Fv(a),mb=this.Yb.Op(a);if(mb.listType!==ma.listType){B++;continue}if(X&&mb.listStyle!==ma.listStyle||!X&&c.level<Pa.level){B++;continue}-1===h&&(h=Pa.Lo+1);v=null;if(c.level===Pa.level||X)Wi.a.Dc.vAb&&
this.Hhb&&this.Hhb.mff(a),v=new Gn(this,a,!1,!1);X&&Pa.level!==c.level&&a.pp(4)&&(a.Za(4).setValue(Yb.a.qe,Pa.level),a.ob());break}B++}return{returnValue:h,$Vl:v,Pim:B}}AAd(a){let c=0;var h=0;kg.a.instance.J(3)&&(h=this.Yb.bK(a,!1,!0),c=h.listId,h=h.qe);return this.Yb.Ev(a,c,h)}startNewList(a,c,h){r.ULS.sendTraceTag(17622212,324,50,"'Start New List' is selected from Context Menu.");if(c){var v=Ee.a.instance.Tm(zb.a.startNewList),B=this.Fb.Ob(15);B.Lr(a);var X=ot.a.$N(0,c.listStyle,null,0,c.propertySet.ia(Yb.a.qe,
-1));a.Za(4);var ma=a.currentNode.ia(Yb.a.listID,0),Pa=a.currentNode.ia(Yb.a.qe,-1);a.ob();X.OLd=ma;var mb=c.propertySet.ia(Yb.a.sk,0);0<mb&&X.propertySet.setValue(Yb.a.sk,mb);-1===X.propertySet.ia(Yb.a.qe,-1)&&X.propertySet.setValue(Yb.a.qe,Pa);1===c.pq&&((Pa=new hy.a,ma=c.lFh(a.currentNode,ma),ma)?1===ma&&(X.y0d(tv.a.J5b),X.iz=Pa.xUe(Pa.Lwf,Pa.Mwf),X.K1=X.iz.K1):(X.y0d(tv.a.J5b),X.iz=Pa.DTe(),X.K1=X.iz.K1));c.xca()&&1>h&&(h=1);X.vy=h;ma=new uh.DictionaryPropertySet;ma=this.fYb(zb.a.RF,ma);Pa=a.Za(2);
a.ob();a.Za(4);c=this.vca(a.currentNode);this.qq&&(mb=this.AAd(a.currentNode))&&(X.levelText=mb.ia(Yb.a.Fq,""),X.XG=42,X.Dr=mb.ia(Yb.a.k9,"left"));this.zWm(a,Pa);({pza:X}=this.Loa(ma,a,X,!0));a.Za(4);22!==a.currentNode.type&&63!==a.currentNode.type&&r.ULS.sendTraceTag(587851671,393,15,"Graph node {0} is not list node.",a.currentNode.type);a.currentNode.setValue(Yb.a.qe,c.level);a.ob();X=new Gn(this,a,!1,!1);this.Yb.lB(a);h=new sy(1,c,h);this.joinList(a.currentNode,X,!0,h);B.dispose();v.end()}else r.ULS.sendTraceTag(51242764,
324,50,"'Start New List' has no current ListInfo")}Okf(a){if(!a)return!1;const c=a.Za(2);c&&a.ob();return kg.a.instance.J(3)&&c&&12===c.type&&c.la&&c.la.last&&c.la.last.eh?!0:!1}eUd(a,c,h,v){return this.lre.eUd(a,c,h,v)}ANf(a,c){if(!a||!c)return!1;const h=a.propertySet.ia(Yb.a.Fq,null);c=c.propertySet.ia(Yb.a.Fq,null);if(!h||!c)return!1;const v=a.propertySet.ia(Ed.a.font,null);a=a.propertySet.ia(Ed.a.font,null);return h===c&&v===a}SCi(a,c,h){h||c.listType||(c.vy=a.ia(Ed.a.kV,ai.a.Ih))}Bxh(a,c){if(!c)return null;
const h=Array(9),v=c.OLd;if(!this.QNl(c,a)||1>v)return null;for(c=0;9>c;c++){const B=this.Yb.Ev(a,v,c);if(null===B||void 0===B?0:B.hasProperty(Yb.a.sk))h[c]=B.getValue(Yb.a.sk);else return null}return h}QNl(a,c){if(!a)return!1;const h=a.propertySet.ia(Yb.a.qe,-1);a=a.propertySet.ia(Yb.a.sk,-1);if(0>h||0>a)return!1;this.Zud(c);return a!==this.NLb[h]?!0:!1}rOg(a,c,h){a&&a.setValue(Yb.a.sk,c?c[h]:this.NLb&&h<this.NLb.length?this.NLb[h]:720*(h+1))}n3e(a,c,h,v,B,X=null,ma=!1){const Pa=new Kd.GraphIterator,
mb=this.fK(a,c);Pa.set(a);Pa.nc();a=hq.a.eq(Pa,Pa.ffa());a.Fl(wt.a.tYa,null);let Tb=-1;for(;a.moveNext();){if(!ab.ListReader.Pg(Pa))continue;this.Yb.lB(Pa);const rc=Pa.currentNode,Tc=this.vca(rc);Pa.ob();if(v!==Object(m.a)(this,this.FWc,"siblingMatchesListAndLevel")||Tc.listID===c.listID){if(ma){if(-1!==Tb&&Tb>Tc.level)break;if(-1===Tb)Tb=Tc.level;else if(Tc.level!==Tb)continue}else{if(Tc.level<=mb.xY)break;if(!v(c,Tc,X))continue}B(rc,h,c.listID,X)}}}UMk(a,c,h,v,B){const X=new Kd.GraphIterator,ma=
this.fK(a,c);X.set(a);X.nc();if(ab.ListReader.Pg(X)){this.Yb.lB(X);a=X.currentNode;var Pa=this.vca(a);X.ob();Pa.level<=ma.xY||v(c,Pa,null)&&B(a,h,c.listID,null)}}p3e(a,c,h,v,B=null){const X=new Kd.GraphIterator;X.Wb(a);v(a,c,this.Fv(X),X,0);this.gCc(a,c,h,v,B)}gCc(a,c,h,v,B=null){let X=new Kd.GraphIterator;const ma=this.fK(a.currentNode,c);let Pa=null,mb=0;var Tb=new Kd.GraphIterator;Tb.Wb(a);Tb.La(10);const rc=Tl.a.eq(Tb,Tb.origin);for(rc.moveNext();rc.moveNext();)if(Pa=null,X=rc.iterator,1===X.role&&
(Pa=rc.currentNode,X.pp(4)&&(Tb=this.Fv(X),h(c,Tb,B))))if(Tb.level>c.level)v(a,c,Tb,X,mb),mb++;else if(Tb.level===c.level||Tb.level<=ma.xY)break;return Pa?X:null}FWc(a,c){return c.listID!==a.listID||c.level!==a.level?!1:!0}etn(a,c,h){return c.listID!==a.listID&&c.listID!==h.fPc||c.level!==a.level?!1:!0}orf(a,c,h){return c.listID===a.listID||h&&c.listID===h.fPc?!0:!1}OIi(a,c,h,v){const B=a.ia(Wi.a.Dc.Jw,-1);this.NIi(a,B+c,h,v)}NIi(a,c,h,v){if(!Mn.eKc){const B=a.ia(Wi.a.Dc.Jw,-1);a.hasProperty(Wi.a.Dc.Jw)&&
-1===B&&Ee.a.instance.ib("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});a.setValue(Wi.a.Dc.Jw,c);a.setValue(Wi.a.Dc.uH,c)}a.setValue(Yb.a.listID,h);c=this.vca(a);a=Kd.GraphIterator.va(a);a.nc();a.ob();this.p3e(a,c,Object(m.a)(this,this.orf,"matchesListId"),Object(m.a)(this,this.MVf,"sublistsUpdateListItem"),v)}gtn(a,c){const h=a.getValue(Wi.a.Dc.Jw);a.setValue(Wi.a.Dc.Jw,h+c);a.hasProperty(Wi.a.Dc.uH);a.setValue(Wi.a.Dc.uH,h+c)}ftn(a,c,h,v){let B,X;B=this.nl.VVa(a);X=B.Yz();if(!Mn.eKc){a.hasProperty(Wi.a.Dc.Jw)||
Ee.a.instance.ib("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});const ma=a.getValue(Wi.a.Dc.Jw);a.setValue(Wi.a.Dc.Jw,ma+c);a.hasProperty(Wi.a.Dc.uH)&&a.getValue(Wi.a.Dc.uH)!==ma&&Ee.a.instance.ib("PossibleIncorrectListRenumbering",{["Reason"]:"PropertyNotExist"});a.setValue(Wi.a.Dc.uH,ma+c)}a.setValue(Yb.a.listID,h);c=this.vca(a);a=Kd.GraphIterator.va(a);a.nc();a.ob();B&&X&&!this.YRa&&(this.rf.sS(B,X,this.Bb.Bf),this.S5());this.gCc(a,c,Object(m.a)(this,this.WLi,"sublistsEnsureSameListAsOriginal"),
Object(m.a)(this,this.G3d,"sublistsUpdateId"),v)}Lmi(a,c,h,v,B){a=this.fK(a.currentNode,h);a.xY>=c.level&&this.itb(v,a.startAt+B)}XLi(a,c,h,v,B){this.Lmi(a,c,h,v,B)}G3d(a,c,h,v){h.listID=c.listID;v.Za(4);a=this.nl.VVa(v.currentNode);c=a.Yz();this.YTb(v.currentNode,h);v.ob();a&&c&&!this.YRa&&(this.rf.sS(a,c,this.Bb.Bf),this.S5())}MVf(a,c,h,v){ab.ListReader.Pg(v)&&(a=new Kd.GraphIterator,a.Wb(v),a.nc(),this.Yb.lB(a),this.Zgf(v.currentNode,a.currentNode))}zyn(a,c,h,v,B){h.listID=c.listID;this.Lmi(a,
c,h,v,B);this.G3d(a,c,h,v,B)}LVf(a,c){return c.listID!==a.listID?!1:!0}yyn(a,c){return c.level>a.level?!1:!0}WLi(a,c,h){return c.listID!==h.fPc?!1:!0}static get eKc(){null==Mn.Zxe&&(Mn.Zxe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("RemoveRedundantRenumberingForListActionsIsEnabled"):!1);return Mn.Zxe}static get uf(){return Nm.ContextSetEditor.instance}static get Ag(){return jn.PageNavigator.instance}static eCi(a,c){c.setValue(Ed.a.font,a.Jja||a.kIc||a.s0b?a.font:"Symbol")}static gCi(a,
c){a=a.Jja||a.kIc||a.Eca?a.levelText:ai.a.Nsd;r.ULS.shipAssertTag(22127637,338,!!a);c.setValue(Yb.a.Fq,a)}static fCi(a,c){a=a.propertySet.ia(Yb.a.k9,"left");c.setValue(Yb.a.k9,a)}static OOh(a){a=a.iterator.parentNode;const c=Kd.GraphIterator.va(a);a&&Ta.OutlineElementReader.Jkf(c,null)&&a.lj(8,!0)}static gFl(a){const c=new Kd.GraphIterator;c.set(a.currentNode);ie.OutlineElementNavigator.Wc(a);for(a=c.Xc();a&&!WA.a.O2b(a);)a=c.ni();a&&a.lj(4,!0)}}Mn.tbm=2147450879;Mn.D5h=1;Mn.Zxe=null;Object(w.a)(Mn,
"FlatListEditorCssVersion",Wi.a,[691,692,278]);class YA{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd){this.LB=a;this.Vd=h;this.Mob=c;this.Fb=v;this.uj=B;this.lre=X;this.Bb=ma;this.rf=Pa;this.$ua=mb;this.Na=Tb;this.Me=rc;this.$b=Tc;this.XB=vd}create(){return new Mn(this.LB,this.Mob,this.Vd,this.Fb,this.uj,this.lre,this.Bb,this.rf,this.$ua,this.Na,this.Me,this.$b,this.XB)}}Object(w.a)(YA,"FlatListEditorFactory",null,[]);class ty{constructor(){this.startAt=this.qe=this.listId=0;this.Geb=null}}Object(w.a)(ty,
"ListAutoCorrectionRefInfo",null,[]);class uy{constructor(a,c){this.$kj=a;this.zc=c}eUd(a,c,h,v){if(!a.hasProperty(Uc.a.RKa))return!0;c=Kd.GraphIterator.va(c.currentNode);Gc.SelectionEditor.vs(c);let B=!0;if(!h.listType&&!v){23===c.Md&&c.qC(1);v=a.ia(Uc.a.RKa,1);if(1!==v){var X=new Kd.GraphIterator;X.Wb(c);X.La(10);X=Tl.a.zn(X.origin);v=this.$Ik(X,v,h,c.currentNode);h.Geb||(B=!1)}a.setValue(Uc.a.RKa,v)}return B}$Ik(a,c,h,v){const B=new Ua.a;for(;a.moveNext()&&a.iterator.currentNode!==v;){const X=
a.iterator;if(!X.pp(4))continue;const ma=this.$kj.value.Fv(X),Pa=this.zc.Op(X);this.xIm(B,ma);Pa.listType===h.listType&&Pa.listStyle===h.listStyle&&(0>c-ma.Lo||2<c-ma.Lo||B.add(Object.assign(new ty,{listId:ma.listID,qe:ma.level,Geb:X.currentNode,startAt:ma.Lo+1})))}0<B.count&&(c=B.J(B.count-1).startAt,h.Geb=B.J(B.count-1).Geb);return c}xIm(a,c){let h=0;for(;h<a.count;){const v=a.J(h);v.listId===c.listID&&v.qe>=c.level?a.removeAt(h):h++}}}Object(w.a)(uy,"ListAutoCorrector",null,[666]);class dA{constructor(a,
c,h,v,B){this.Eb=a;this.Yb=h;this.Dq=v;this.xXe=B}get rKl(){return ab.ListReader.mq}tJc(a){return 0>a?!0:this.rKl?!1:!!a}eb(){this.Eb.ka(zb.a.t0a,ic.a.outlineElement,Object(m.a)(this,this.t0a,"startListAtOne"));this.Eb.ka(zb.a.t0a,ic.a.Ub,Object(m.a)(this,this.t0a,"startListAtOne"));this.Eb.ka(zb.a.t0a,ic.a.view,Object(m.a)(this,this.t0a,"startListAtOne"));this.Eb.Qb(zb.a.t0a,12);this.Eb.ka(zb.a.s0a,ic.a.outlineElement,Object(m.a)(this,this.s0a,"startListAtInputtedValue"));this.Eb.ka(zb.a.s0a,ic.a.Ub,
Object(m.a)(this,this.s0a,"startListAtInputtedValue"));this.Eb.ka(zb.a.s0a,ic.a.view,Object(m.a)(this,this.s0a,"startListAtInputtedValue"));this.Eb.Qb(zb.a.s0a,12);this.Eb.ka(zb.a.O7,ic.a.outlineElement,Object(m.a)(this,this.O7,"continueExistingList"));this.Eb.ka(zb.a.O7,ic.a.Ub,Object(m.a)(this,this.O7,"continueExistingList"));this.Eb.ka(zb.a.O7,ic.a.view,Object(m.a)(this,this.O7,"continueExistingList"));this.Eb.Qb(zb.a.O7,12);this.Eb.ka(zb.a.Rhb,ic.a.outlineElement,Object(m.a)(this,this.Rhb,"startListAtValue"));
this.Eb.ka(zb.a.Rhb,ic.a.Ub,Object(m.a)(this,this.Rhb,"startListAtValue"));this.Eb.ka(zb.a.Rhb,ic.a.view,Object(m.a)(this,this.Rhb,"startListAtValue"));this.Eb.Qb(zb.a.Rhb,12);this.Eb.ka(zb.a.n9a,ic.a.outlineElement,Object(m.a)(this,this.n9a,"continueExistingListAtValue"));this.Eb.ka(zb.a.n9a,ic.a.Ub,Object(m.a)(this,this.n9a,"continueExistingListAtValue"));this.Eb.ka(zb.a.n9a,ic.a.view,Object(m.a)(this,this.n9a,"continueExistingListAtValue"));this.Eb.Qb(zb.a.n9a,12)}t0a(a,c,h){var v;a=this.qyc(c);
if(!a||this.Dq.Okf(a))return 8;c=this.Dq.Fv(a);if(1===c.Lo||this.tJc(c.level))return 8;if(null===(v=l.AFrameworkApplication.K)||void 0===v?0:v.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListActionsFixForACM",!1))if(v=this.Yb.Op(a),!v||this.LTh(v))return 8;if(1===h)return 32;h=this.Yb.Op(a);this.Dq.startNewList(a,h,1);return 32}s0a(a,c,h){var v;a=this.qyc(c);if(!a||this.Dq.Okf(a))return 8;c=this.Dq.Fv(a);if(this.tJc(c.level))return 8;if(null===(v=l.AFrameworkApplication.K)||void 0===v?0:v.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListActionsFixForACM",
!1))if(v=this.Yb.Op(a),!v||this.LTh(v))return 8;if(1===h)return 32;this.xXe.c8k(a.currentNode,c.Lo,this.Yb,this.Dq,this.NNa);return 32}get NNa(){return xa.a.instance.resolve("Common.IStandaloneRootController").w5}O7(a,c,h){a=this.qyc(c);if(!a||this.Dq.Okf(a))return 8;c=this.Dq.Fv(a);if(1!==c.Lo||this.tJc(c.level))return 8;if(1===h)return 32;h=this.Yb.Op(a);return this.Dq.O7(a,c,h.vy,-1,!1,h)?32:8}qyc(a){return this.Dq.K5k(a)}Rhb(a,c,h,v,B){a=this.qyc(c);if(!a)return 8;c=this.Dq.Fv(a);if(this.tJc(c.level))return 8;
if(1===h)return 32;h=this.Yb.Op(a);this.Dq.startNewList(a,h,B);return 32}n9a(a,c,h,v,B){a=this.qyc(c);if(!a)return 8;c=this.Dq.Fv(a);return this.tJc(c.level)?8:1===h?32:this.Dq.O7(a,c,c.Lo,B)?32:8}LTh(a){return 1===(null===a||void 0===a?void 0:a.listType)}}Object(w.a)(dA,"ListContextMenuSectionActor",null,[]);class zx{static get iZl(){return gg.a.fy(zx.ll,Box4Intl.Box4Strings.l_StartNewListDialog,Box4Intl.Box4Strings.l_ContinueFromPreviousList,Box4Intl.Box4Strings.l_SetValueTo)}}zx.ll="<div class='WACDialogRow' id='StartNewList'> <input type='radio' id='ListRadioStartNew' name='ListRadioBox' class='WACDialogRadio' alt='{0}' title='{0}'></input> <label id='StartNewList' class='WACDialogLabel' for='ListRadioStartNew' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='ContinuePreviousList'> <input type='radio' id='ListRadioContinue' name='ListRadioBox' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ContinueFromPreviousList' class='WACDialogLabel' for='ListRadioContinue' >{1}</label> </div> <div class='WACDialogRow' id='SpinnerRow'> <div class='WACDialogGroupBox' id='ListStartAtSpinnerBox'> <label id='ListStartAtNumber' class='DialogSpinnerLabel' >{2}</label> <br/> <div id='SetListStartSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(w.a)(zx,"ListSetStartValueDialogHtml",null,[]);class uv extends gg.a{constructor(a,c,h,v,B){super();this.Ibd=this.Fee=this.bcd=this.FBe=null;this.Bge=!0;this.YP=!1;this.lFa=0;this.iCa=[zb.a.kQf,zb.a.EUf,zb.a.OGf];this.jf="ListSetStartValueDialog";this.vf=zx.iZl;this.Jd=a;this.zZ=c;this.zc=h;this.Rue=c;this.oT=v;ab.ListReader.mq&&(c=new Kd.GraphIterator,a?(c.set(a),c.nc(),Ta.OutlineElementReader.Gg(c)||ie.OutlineElementNavigator.Wc(c),ab.ListReader.Pg(c)&&(c.Za(4),a=c.currentNode,22===a.type&&
(this.zc.qO(a).xca()?this.lFa=1:this.lFa=0))):this.lFa=1);this.wc=B;this.Tg(Box4Intl.Box4Strings.l_SetNumberingValueList,Object(m.a)(this,this.egn,"setListStartValueHandler"),{["ListRadioStartNew"]:!0,["ListRadioContinue"]:!1});this.Bge&&(this.FBe=document.getElementById("ListRadioStartNew"),this.bcd=Object(m.a)(this,this.jtm,"onStartNewRadioSelected"),this.Fee=document.getElementById("ListRadioContinue"),this.Ibd=Object(m.a)(this,this.umm,"onContinueRadioSelected"),Ld.a.addHandler(this.FBe,"click",
this.bcd),Ld.a.addHandler(this.Fee,"click",this.Ibd));for(let X of this.iCa)ug.a.Poa(X,Object(m.a)(this,this.bjn,"setSpinnerControlValue"),Object(m.a)(this,this.ugl,"getSpinnerControlValue"));this.wc.yk()}get Dq(){return this.oT}bjn(a,c){ab.ListReader.mq?(a=c[pg.a.Number],l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EOPNoFormattingFixEnabled",!1)?this.zZ=Number.isInteger(c[pg.a.Number])&&
a>=this.lFa?a:this.lFa:this.zZ=a>=this.lFa?a:this.lFa):this.zZ=c[pg.a.Number]}ugl(a,c){ab.ListReader.mq&&(this.zZ=this.zZ>=this.lFa?this.zZ:this.lFa);c[pg.a.Number]=this.zZ;c[pg.a.UnitType]=0}egn(a,c){if(1===a){var h=c.ListRadioStartNew,v=c.ListRadioContinue,B=Kd.GraphIterator.va(this.Jd);B.nc();c=this.Dq.Fv(B);a=this.zc.Op(B);if(h)this.Dq.startNewList(B,a,this.zZ);else if(v)if(this.Bge)this.Dq.O7(B,c,this.Rue,-1,!1,a);else{h=!0;for(v=null;B.RD();)if(B.pp(4)){v=new Gn(this.Dq,B,!1,!1);break}if(!v||
this.Dq.Fv(B).Lo>=this.zZ)h=!1;h?(B=Kd.GraphIterator.va(this.Jd),B.nc(),this.Dq.O7(B,c,this.Rue,this.zZ,!1,a)):(this.dispose(),this.VBa(CommonUIStrings.l_ErrorDialogMessage,Object(m.a)(this,this.hZl,"listDialogCreator")))}}}hZl(){new uv(this.Jd,this.Rue,this.zc,this.Dq,this.wc)}dispose(){this.YP||(this.Bge&&(this.bcd&&Ld.a.removeHandler(this.FBe,"click",this.bcd),this.Ibd&&Ld.a.removeHandler(this.Fee,"click",this.Ibd)),this.wc.DC("ListStartSpinner"),super.dispose(),this.YP=!0)}jXj(){const a=jf.q("none",
ab.ListReader.mq?this.lFa+"":"0","100","1");return jf.o(uv.z_h,zb.a.kQf,zb.a.OGf,Box4Intl.Box4Strings.l_SetValueTo,[a],null,zb.a.EUf)}usb(a){const c=document.getElementById(uv.z_h);this.wc.KGa("ListStartSpinner",a);a=this.wc.yab("ListStartSpinner","Medium");c.appendChild(a)}cS(){const a=this.jXj();this.usb(a)}jtm(){document.getElementById(uv.y_h).style.visibility="visible"}umm(){document.getElementById(uv.y_h).style.visibility="hidden"}}uv.z_h="SetListStartSpinnerContainer";uv.y_h="ListStartAtSpinnerBox";
Object(w.a)(uv,"ListSetStartValueDialog",gg.a,[]);class vv{c8k(a,c,h,v,B){new uv(a,c,h,v,B)}static get instance(){return vv._instance||(vv._instance=new vv)}}vv._instance=null;Object(w.a)(vv,"ListDialogFactory",null,[664]);class Zn{constructor(a,c,h){this.oT=a;this.zc=c;this.Fb=h}mff(a){r.ULS.shipAssertTag(40420184,393,Ta.OutlineElementReader.Gg(a));const c=a.Za(4);a.ob();if(c){const h=this.zc.qO(c);h.pq||this.Gyl(a,c,h)}}a5j(a){for(let c=0;c<a.length;c++){const h=new Kd.GraphIterator;h.set(a.getContext(c).node);
this.mff(h)}}Gyl(a,c,h){const v=jn.PageNavigator.instance.Xs(c),B=this.oT.vca(c),X=this.Fb.Ob(15);X.Lr(a);a=this.oT.vTg(v,c,h,0,null);this.oT.Msi(c,!0,B.listID);X.dispose();this.zc.uca(c,a)}}Object(w.a)(Zn,"SingleLevelListEditor",null,[564]);var ZA=b(351);class Pt extends yi{constructor(a){super();Pt.Ekc=a}Pji(a,c,h,v,B,X){if(!a||!a.length)return 8;let ma,Pa;a=({Wnl:ma,Vnl:Pa}=Pt.Zn.Tnl(a,ma,Pa)).returnValue;let mb=1;for(let rc of a.keys){var Tb=ma.contains(rc);const Tc=a.J(rc);Pt.Zn.s1j(a.J(rc),
this.kwc(c),Tb)?Tb?(r.ULS.sendTraceTag(575213851,393,50,"List Actions: {0} lists, with change in level",this.kwc(c)?"Promote":"Demote"),Tb=l.AFrameworkApplication.pa.Le(ZA.a.mxa(Tc),c,h,v,B,X)):(r.ULS.sendTraceTag(575213852,393,50,"List Actions: {0} lists, without change in level",this.kwc(c)?"Promote":"Demote"),Tb=Pt.Zn.qwm(a.J(rc),this.kwc(c),Pa.J(rc))):(r.ULS.sendTraceTag(575213850,393,50,"List Actions: Tried to {0} lists, but unable to indent",this.kwc(c)?"Promote":"Demote"),Tb=8);mb=Le.ActionManager.aNc(mb,
Tb)}return mb}kwc(a){return a===zb.a.lE?!0:!1}static get Zn(){return Pt.Ekc||(Pt.Ekc=xa.a.instance.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))}}Pt.Ekc=null;Object(w.a)(Pt,"WordEditorListContextManager",yi,[]);class Ds{get name(){return"WordEditor.ListEditors"}yb(a){l.AFrameworkApplication.K.$("OutlineLevelEditorsDelayInitializationEnabled")&&(a.ha("WordEditor.ListEditors.IListAutoCorrector",()=>new uy(a.te("WordEditor.IFlatListEditor"),a.resolve("Box4.List.IListReader"))).singleInstance(),
a.ha("WordEditor.IFlatListEditor",()=>(new YA(a.resolve("WordEditor.List.IFlatListReader"),a.te("Box4.IOutlineElementIndentationEditor"),a.resolve("Box4.IOutlineElementEditor"),new Fk.a,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("WordEditor.ListEditors.IListAutoCorrector"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.List.IListFormattingEditor"),a.resolve("Box4.IFeatureHelper"),a.resolve("Common.ICpuMeter"),
a.resolve("Box4.Styles.IWACStyleReader"),a.resolve("Box4.Styles.IWACStyleEditor"))).create()).singleInstance(),a.ha("Box4.List.IListEditor",()=>a.resolve("WordEditor.IFlatListEditor")).singleInstance(),a.ha("Box4.List.ISingleLevelListEditor",()=>new Zn(a.resolve("WordEditor.IFlatListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.Graph.IGraphTransactionFactory"))).singleInstance(),a.ha("Box4.ListEditors.WordEditorListContextManager",()=>new Pt(a.resolve("WordEditor.OutlineLevelEditors.IWordOutlineElementIndentationEditor"))).as("Box4.ListEditors.IListContextManager"))}init(){(new dA(l.AFrameworkApplication.pa,
new gl.a,Ds.Yb,Ds.Dq,vv.instance)).eb();const a=l.AFrameworkApplication.pa;a.Aa(zb.a.OGf,ic.a.view,ug.a.rY,96);a.Aa(zb.a.EUf,ic.a.view,ug.a.yI,96);a.Aa(zb.a.kQf,ic.a.view,ug.a.yI,96)}dispose(){}static get Yb(){return Ds.zc||(Ds.zc=xa.a.instance.resolve("Box4.List.IListReader"))}static get Dq(){return Ds.oT||(Ds.oT=xa.a.instance.resolve("WordEditor.IFlatListEditor"))}static main(){M.a.instance.Lb(new Ds)}}Ds.zc=null;Ds.oT=null;Object(w.a)(Ds,"WordEditorListEditorsPackage",null,[1,2]);var LB=b(1526),
pu=b(488),ew=b(77),MB=b(1796);class Go extends Oa.a{constructor(a,c,h,v,B,X){super(a,c);this.styleId=null;this.ii=0;this.SKa=null;this.characterData=h;this.paragraphNode=v;this.listMarker=B;this.AJa=X}}Object(w.a)(Go,"HeadingText",Oa.a,[]);class NB{constructor(a,c,h,v,B,X,ma){this.Wmg=!0;this.fug=0;this.jKg=8;this.Pda=null;this.Tkj=a;this.dw=c;this.$b=h;this.zc=v;this.Fz=B;this.T$=X;this.Yqe=ma}get wC(){return this.Tkj.value}get eff(){return this.Wmg}set eff(a){this.Wmg=a}get IBb(){return this.fug}set IBb(a){this.fug=
a}get QIb(){return this.jKg}set QIb(a){this.jKg=a}t2k(){return Object(ew.__awaiter)(this,void 0,void 0,function*(){var a=this.Yqe.value;if(!isNullOrUndefined(a)&&a.lr)return a=yield this.k$k(),this.IEf(a,!0);a=this.Pda;return isNullOrUndefined(a)?null:Promise.resolve(this.IEf(a,!0))})}Mvh(){return this.IEf([],!1)}IEf(a,c){const h=window.performance.now(),v=this.Nvh();if(!v)return null;const B=new Ua.a;let X=0;for(;v.moveNext();){var ma=v.iterator;if(11===ma.Md){const Pa=this.zc.nxb(ma),mb=ie.OutlineElementNavigator.Fd(ma,
!0);c&&a[X]&&a[X].ParaId===sd.ParagraphReader.vR(mb)&&X++;ie.OutlineElementNavigator.Wc(ma);if(!mb||!sd.ParagraphReader.tb(mb)||mb.kr||""===mb.characterData||"\ufffc"===mb.characterData)continue;const Tb=this.Uzd(mb);Tb&&(Pa&&(Tb.listMarker=this.Fz.uYa(Pa,!1).N0,ma=this.zc.Op(ma),1===ma.listType&&ma.s0b&&(Tb.SKa=ma.font)),c&&(a[X-1]&&a[X-1].ParaId===sd.ParagraphReader.vR(mb)?Tb.ii=X:Tb.ii=X+1),B.add(Tb))}}r.ULS.sendTraceTag(591963592,3019,50,String.format("GetHeadingsDataForToc Duration: {0} ms;",
window.performance.now()-h));return B}k$k(){let a=new oj.a;var c=MB.a.L7(l.AFrameworkApplication.rootQuerySignature,null);let h=new Kp.a;h.Kq=c;h.status=1;this.npj=window.performance.now();c=this.T$.zia(0,()=>{if(2!=h.statusCode||null==h.Vi||0==h.Vi.length||null==h.Vi[0]){const v=String.format("GetPageEndsOperation Failed with status code: {0};",h.statusCode);a.setException(Error.create(v));r.ULS.sendTraceTag(543802465,3019,10,v)}else a.Jf(h.Vi[0].PageEnds),r.ULS.sendTraceTag(543802466,3019,50,String.format("GetPageEndsDuration Duration: {0} ms;",
window.performance.now()-this.npj))});c.WH(h);c.DU();return je.b(a.task)}r2k(){const a=this.Nvh();if(!a)return-1;let c=0;for(;a.moveNext();){const h=a.iterator;if(11===h.Md){const v=ie.OutlineElementNavigator.Fd(h,!0);ie.OutlineElementNavigator.Wc(h);v&&sd.ParagraphReader.tb(v)&&!v.kr&&""!==v.characterData&&"\ufffc"!==v.characterData&&this.Uzd(v)&&c++}}return c}nul(a){if(a.jq)return!0;a=a.role;return 1===a||2===a||4===a}Nvh(){if(!this.wC)return r.ULS.sendTraceTag(591000526,3019,10,"PageNode is null"),
null;var a=this.dw.s0(this.wC);if(!a)return r.ULS.sendTraceTag(591963593,3019,10,"pageContentNode is null."),null;a=Kd.GraphIterator.va(a);if(!a.fn())return r.ULS.sendTraceTag(591963594,3019,10,"Failed to root at PageContent."),null;a=Tl.a.eq(a,a.origin);a.Fl(Object(m.a)(this,this.nul,"headingFilter"),null);return a}Uzd(a){return this.Sll(a)||this.q2k(a)}q2k(a){var c;let h=c=null,v=-1;var B=-1,X=this.$b.tw(a);for(let Pa=0;Pa<a.la.length;Pa++)if(c=a.la.J(Pa),c.formatting){var ma=ua.FormattingReader.vqa(c.formatting);
const mb=this.$b.oe(ma);if(!h&&(h=mb,B=(B=dl.a.HDc(h))?Number.parseInvariant(B):0,!this.Kkf(B-1)))break;ma=(ma=this.$b.r0(ma,X))?ma.ia(Yb.a.nDb,9):9;v=-1===v?ma:v;if(!(this.Lmf(ma)&&v===ma||dl.a.Gmf(mb)&&h===mb))break}c=c.cp;X=a.characterData.substring(0,c);return this.Lmf(v)?new Go(0,c,X,a,null,v+1):dl.a.Gmf(h)?new Go(0,c,X,a,null,B):null}Lmf(a){return this.eff&&this.Kkf(a)}Kkf(a){return a<=this.QIb&&a>=this.IBb}Sll(a){const c=sd.ParagraphReader.bWa(a);if(this.Lmf(c))return new Go(0,a.characterData.length,
a.characterData,a,null,c+1);if(this.Kkf(c)){var h=this.$b.um(a);h=this.$b.oe(h);if(dl.a.Q3b(h))return new Go(0,a.characterData.length,a.characterData,a,null,c+1)}return null}}Object(w.a)(NB,"StyleBasedDocumentHeadings",null,[459]);class eA{constructor(){this.startTime=0}}Object(w.a)(eA,"TocCallbackData",null,[]);class Ar{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.ga=a;this.W1c=c;this.Vb=v;this.Fb=B;this.Gm=X;this.pid=ma;this.Bb=Pa;this.Na=mb;this.Ojg=Tb;this.fD=rc}eb(){this.ga.ka(zb.a.edc,ic.a.paragraph,
Object(m.a)(this,this.K0f,"updateTableOfContentsHandler"));this.ga.ka(zb.a.edc,ic.a.xc,Object(m.a)(this,this.K0f,"updateTableOfContentsHandler"));this.ga.ka(zb.a.edc,ic.a.Ub,Object(m.a)(this,this.K0f,"updateTableOfContentsHandler"));this.ga.Qb(zb.a.edc,1028);this.ga.ka(ba.a.Egf,ic.a.Ub,Object(m.a)(this,this.dEl,"insertTableOfContentsHandler"));this.ga.Qb(ba.a.Egf,1028);this.ga.ka(ba.a.PSc,ic.a.paragraph,Object(m.a)(this,this.uKf,"removeTableOfContentsHandler"));this.ga.ka(ba.a.PSc,ic.a.xc,Object(m.a)(this,
this.uKf,"removeTableOfContentsHandler"));this.ga.ka(ba.a.PSc,ic.a.Ub,Object(m.a)(this,this.uKf,"removeTableOfContentsHandler"));this.ga.Qb(ba.a.PSc,1028)}K0f(a,c,h){const v=c.node;if(!v)return r.ULS.sendTraceTag(36705296,324,10,"Context node is null in UpdateTableOfContentsHandler."),2;if(12!==v.type)return r.ULS.sendTraceTag(36705297,324,10,"Context node is not a paragraph in UpdateTableOfContentsHandler."),2;if(!v.kr)return 2;if(1===h)return ya.SessionStatusManager.instance.gi?8:32;this.Na&&this.Na.isFeatureEnabled(206)?
this.pid.HNn(v).then(B=>{B||this.tWi(v)}):this.tWi(v);return 32}tWi(a){Fa.Health.instance.recordKpiUsage(Ar.VZi,1,Ar.pF,null);const c=this.uSk(a),h=new eA;h.startTime=window.performance.now();this.W1c.uzi(c,Yb.a.Z_f,this.Akl(this.y$k(a)),Object(m.a)(this,this.$Rn,"updateTocSuccessCallback"),null,h);this.pid.J3j()}$Rn(a){a=window.performance.now()-a.startTime;r.ULS.sendTraceTag(574408796,3019,50,String.format("UpdateTOC Duration: {0} ms;",a));a=Object.assign(new fi.a,{durationMs:a});Fa.Health.instance.recordKpiSuccess(Ar.VZi,
a);Ar.tta()}dEl(a,c,h){if(sd.ParagraphReader.tb(c.node)&&c.node.kr)return 2;if(1===h)return ya.SessionStatusManager.instance.gi?8:32;if(c.contextId!==ic.a.Ub||this.Gm.T8(c)||!sd.ParagraphReader.tb(c.node))return 32;this.Bb.Xq(17);this.pid.Lgk(c);return 32}uKf(a,c,h){a=c.node;if(!a)return r.ULS.sendTraceTag(39358978,324,10,"Context node is null in RemoveTableOfContentsHandler."),2;if(12!==a.type)return r.ULS.sendTraceTag(39358979,324,10,"Context node is not a paragraph in RemoveTableOfContentsHandler."),
2;if(!a.kr)return 2;if(1===h)return ya.SessionStatusManager.instance.gi?8:32;h=new Kd.GraphIterator;h.set(a);h.La(8);h.mc(8);c=this.Fb.Ob(15);c.Lr(h);this.pid.cWm(a)?(c.dispose(),Ar.tta()):(c.dispose(),r.ULS.sendTraceTag(556565975,3019,10,"Failed to remove TOC."));return 32}E2i(a){if(null!=a&&a.kr)if(null==this.Ojg.instance)r.ULS.sendTraceTag(539628835,3019,10,"Page Number Finder instance is null.");else{var c=this.Ojg.instance.Nzh();a=this.UIk(a);var h=!1;1===this.fD.XA&&(h=!0);0!=a&&c!=a&&(c=[Object.assign(new aa.a,
{name:"TOCPageNo",string:a}),Object.assign(new aa.a,{name:"HeadingPageNo",string:c}),Object.assign(new aa.a,{name:"isPageView",string:h})],re.a("TOCPageNoMismatch",!0,void 0,c))}}UIk(a){for(let c=0;c<a.la.length;c++){const h=a.la.J(c);if(null!=h.je)for(let v=0;v<h.je.length;v++){const B=h.je.J(v);if(1===B.Mk&&B.instruction.trim().startsWith("PAGEREF"))return parseInt(a.characterData.substr(h.cp,a.characterData.length-h.cp))}}return 0}y$k(a){return a?a.ia(Yb.a.ZK,null):(r.ULS.sendTraceTag(38638673,
324,10,"Node is null in GetParaIdForUpdate."),null)}uSk(a){return this.Vb.xya(a,7,7).Za(35)}Akl(a){const c=[];c.push(a+",TOC,0");return c}static tta(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorTOCFloodgateIsEnabled")&&window.setTimeout(()=>{const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");a&&a.execute(c=>{c.logActivity("InsertTOCInWordWeb","WordEditorTOCFloodgateIsEnabled")})},Ar.Dxa)}}Ar.Dxa=5E3;Ar.VZi="WordUpdateTOC";Ar.pF="wwaengidc";Object(w.a)(Ar,"TableOfContentsActor",
null,[458]);class fA{}Object(w.a)(fA,"FieldData",null,[]);class Tw extends fA{constructor(){super();this.Cib=null}}Object(w.a)(Tw,"TOCFieldData",fA,[]);class $A{constructor(a,c,h,v,B,X=null){this.pul=a;this.Vr=c;this.ii=h;this.NLi=v;this.listMarker=B;this.SKa=X}}Object(w.a)($A,"TOCHeadingData",null,[]);class OB{constructor(a,c){this.Mma=a;this.tl=c}HDh(a){return Object(ew.__awaiter)(this,void 0,void 0,function*(){const c=yield this.y2k(a);if(!c||!c.count)return new Tw;r.ULS.sendTraceTag(591963591,
3019,50,String.format("Headings Count in TOC: {0};",c.count));return this.$Dm(c,a.Rzb)})}y2k(a){this.Mma.eff=a.fff;this.Mma.IBb=a.IBb;this.Mma.QIb=a.QIb;return this.Mma.t2k()}cTk(a){if(a=this.bTk(a))return this.tl.mca(a)}bTk(a){const c=a.la.length;for(let h=0;h<c;h++){const v=a.la.J(h);if(v.hyperlink&&v.hyperlink.Nza&&v.hyperlink.url.startsWith(F.a.s8a))return v.hyperlink.url.substr(v.hyperlink.url.indexOf("_Toc"))}return null}RXd(a){(a=this.cTk(a))&&this.tl.jQd(a.id)}Dhl(){return this.Mma.r2k()}$Dm(a,
c){const h=new Tw,v=new Ua.a;for(let B of a){a=this.Chl(B,c);if(!a)return null;v.add(a)}h.Cib=v;return h}Chl(a,c){let h;if(c&&(h=this.kgk(a),!h))return r.ULS.sendTraceTag(591184344,3019,10,"Unable to create bookmark for Table of Contents"),null;c=Fb.AParagraphNode.l1(a.characterData.trim());const v=this.jjl(a.AJa);return new $A(c,h,a.ii,v,a.listMarker,a.SKa)}kgk(a){const c=String.format("{0}{1}","_Toc",uf.a.nE());return this.tl.$Sb(c,a.begin,a.end,a.paragraphNode,a.paragraphNode)?c:null}jjl(a){return String.format("toc {0}",
a)}}Object(w.a)(OB,"TOCDataManager",null,[457]);class qu{yTf(){const a=Object.assign(new oe.StandardDialog,{Zr:l.AFrameworkApplication.L8,yc:0,dCa:!1});a.yY(1);a.Dea(WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogTitle,WordEditorIntl.WordEditorStrings.L_EmptyTOCDialogMessage,()=>{})}static get instance(){return qu.fj||(qu.fj=new qu)}}qu.fj=null;Object(w.a)(qu,"TOCDialogHelper",null,[]);var wn=b(194),Ax=b(186),Xu=b(758),aB=b(319),Bp=b(157);class Bx{constructor(a,c,h,v,B,X,ma){this.zTf=a;this.Rzb=
c;this.fff=h;this.IBb=v;this.QIb=B;this.Jrb=X;this.CIb=[];this.instruction=ma}toString(){return"showPageNumber:"+this.zTf+"  isHyperlink:"+this.Rzb+" includeOutlineLevels:"+this.fff+" lowerOutlineLevel:"+this.IBb+" upperOutlineLevel:"+this.QIb+" addContentControl:"+this.Jrb+" unsupportedSwitches:"+this.CIb.toString()}}Object(w.a)(Bx,"TOCSettings",null,[]);class Ch{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh){this.yng="TOC";this.vfe=this.MDe=null;this.eIb=a;this.Vd=c;this.Oi=h;this.yv=
v;this.Tk=B;this.Gm=X;this.ya=ma;this.Tb=Pa;this.YIg=mb;this.nd=Tb;this.KDe=rc;this.io=vd;this.kG=ee;this.rn=Ie;this.Fb=Xe;this.Ta=Yf;this.mf=Hh}get UHc(){return this.yng}set UHc(a){this.yng=a}get fIb(){this.MDe||(this.MDe=this.yth());return this.MDe}yth(){return new Bx(!0,!0,!0,0,8,!0,this.GDm())}Lgk(a){Object(ew.__awaiter)(this,void 0,void 0,function*(){re.a(Ch.Kmk);const c=window.performance.now();if(sd.ParagraphReader.tb(a.node))if(this.Gm.T8(a))r.ULS.shipAssertTag(592233794,3019,!1,"We can't insert table of contents, current insertion point is in locked range"),
Ch.BYa("IP is in locked range");else{var h=yield this.eIb.HDh(this.fIb);if(h){var v=new Se.a(2,1,0,()=>{this.Mmk(a,h,c)});this.Ta.ub(v)}else r.ULS.sendTraceTag(592233795,3019,10,"Failed to create table of contents."),Ch.BYa("Failed to get TOC data")}else r.ULS.shipAssertTag(592233793,3019,!1,"We can't insert table of contents, current context is not paragraph context"),Ch.BYa("Context should be paragraph")})}Mmk(a,c,h=0){let v;try{if(0==h&&(h=window.performance.now()),this.Nkh(a.node)){var B=new Kd.GraphIterator;
B.set(a.node);B.La(8);B.mc(8);v=this.Fb.Ob(15);v.Lr(B);var X=c.Cib?c.Cib.count:0;if(X){B=null;var ma;for(var Pa=0;Pa<X;Pa++){const Tc=c.Cib.J(Pa);if(!({zub:ma}=this.NNh(a,B,Pa,X,Tc,Tb?Tb.toString():void 0)).returnValue){Ch.BYa("Failed to populate new TOC paragraph");v.dispose();return}if(0==Pa){var mb=ma.currentNode;var Tb=sd.ParagraphReader.vR(mb)}B=ma}if(this.fIb.Jrb&&!this.yTe(mb.id,B.rm.id))Ch.BYa("Failed to add content control block"),v.dispose();else{var rc=window.performance.now()-h;re.a(Ch.VUe,
!0,rc)}}else this.KDe.yTf(),this.Ehk(a)&&(Pa=window.performance.now()-h,re.a(Ch.VUe,!0,Pa)),v.dispose()}else Ch.BYa("Failed to fetch style set")}catch(Tc){Ch.BYa(String.format("{0} {1}",Tc.message,Tc.stack))}finally{v&&v.dispose()}}Nkh(a){this.vfe=this.Tk.tw(a);return this.vfe?!0:(r.ULS.sendTraceTag(592233796,3019,15,"Failed to fetch style set"),!1)}static Era(a){a=[Object.assign(new aa.a,{name:Ch.YRn,string:a})];re.a(Ch.L0f,!1,void 0,a)}static jqf(a){a=[Object.assign(new aa.a,{name:Ch.CXm,string:a})];
re.a(Ch.lri,!1,void 0,a)}static BYa(a){a=[Object.assign(new aa.a,{name:Ch.Lmk,string:a})];re.a(Ch.VUe,!1,void 0,a)}HNn(a){return Object(ew.__awaiter)(this,void 0,void 0,function*(){const c=this.GDh(a);if(null==c)Ch.Era("Cannot update TOC when firstTocPara = null");else{var h=this.IDh(c);if(0<h.CIb.length)return this.c2h(h.CIb),!1;re.a(Ch.XRn);var v=window.performance.now(),B=yield this.eIb.HDh(h);if(!B)return r.ULS.sendTraceTag(559248668,3019,10,"Failed to get data for TOC update."),Ch.Era("Failed to fetch TOC data"),
!1;var X=new Se.a(1,1,0,()=>{this.ZRn(c,B,h,v)});this.Ta.ub(X);return!0}})}ZRn(a,c,h=null,v=0){let B;try{if(null==a)Ch.Era("Attempt to update TOC when firstTocPara = null");else if(null==c)Ch.Era("Attempt to update TOC when tocFieldData = null");else{0==v&&(v=window.performance.now());if(null==h&&(h=this.IDh(a),0<h.CIb.length)){this.c2h(h.CIb);return}var X=new Kd.GraphIterator;X.set(a);X.La(8);X.mc(8);B=this.Fb.Ob(15);B.Lr(X);var ma;if(({OOe:ma}=this.Lqi(a,h)).response){r.ULS.sendTraceTag(559018207,
3019,50,String.format("Attempting to update TOC with settings: {0}",h.toString()));var Pa=c.Cib?c.Cib.count:0;if(this.Nkh(a)){var mb;this.YUh(a)&&(this.kri(a),(a=sd.ParagraphReader.jg(a,!1,!0))&&(mb=a.ia(Yb.a.Ib,null).toString()));var Tb=a.ia(Yb.a.ZK,null);X=Tb;mb=null!==mb&&void 0!==mb?mb:Tb;if(Pa){for(var rc=0,Tc;a.kr&&X==Tb&&rc<Pa;){let Ie=c.Cib.J(rc);h.Rzb&&this.eIb.RXd(a);if(!this.CRn(a,rc,Pa,Ie,h)){r.ULS.sendTraceTag(559248669,3019,10,"Failed to Update TOC Paragraph.");Ch.Era("Failed to update TOC paragraph");
B.dispose();return}a.setValue(Yb.a.ZK,mb);rc++;Tc=a;a=sd.ParagraphReader.jg(Tc,!1,!0);if(!a){X=null;break}this.dVh(a)&&this.jri(a);X=a.ia(Yb.a.ZK,null)}X==Tb&&this.mKf(a);var vd;if(({kZh:vd}=this.gFj(c,rc,Pa,Tc,mb)).response)if(h.Jrb&&!this.yTe(ma,vd.id))Ch.Era("Failed to add content control block"),B.dispose();else{var ee=window.performance.now()-v;re.a(Ch.L0f,!0,ee)}else Ch.Era("Failed to add new paragraph"),B.dispose()}else this.KDe.yTf(),this.URn(a,h.Jrb,ma,h.instruction,mb)?(rc=window.performance.now()-
v,re.a(Ch.L0f,!0,rc)):Ch.Era("Failed to update to empty TOC"),B.dispose()}else Ch.Era("Failed to fetch style set")}else Ch.Era("Failed to remove Content Control"),B.dispose()}}catch(Ie){Ch.Era(String.format("{0} {1}",Ie.message,Ie.stack))}finally{B&&B.dispose()}}gFj(a,c,h,v,B){let X=new Kd.GraphIterator;for(X.set(v);c<h;){v=a.Cib.J(c);if(!({zub:v}=this.NNh(null,X,c,h,v,B)).returnValue)return{kZh:X.currentNode,response:!1};X=v;c++}return{kZh:X.currentNode,response:!0}}Lqi(a,c){var h,v,B;let X,ma;const Pa=
null===(h=null===a||void 0===a?void 0:a.la)||void 0===h?void 0:h.first.Wa;if(Pa&&0<Pa.length)if(a=a.la.first.Wa.J(0),a.Oe){h=a.contentControlNode.getValue(Yb.a.Xx);X=wn.a.kk?this.mf.Aq.get(null===(v=a.contentControlNode.id)||void 0===v?void 0:v.toString()):a.contentControlNode.getValue(Yb.a.yh);ma=wn.a.kk?this.mf.vr.get(null===(B=a.contentControlNode.id)||void 0===B?void 0:B.toString()):a.contentControlNode.getValue(Yb.a.Ti);if(0!=this.io.O8b(h))return r.ULS.sendTraceTag(558952907,3019,10,"Failed to release content control"),
{response:!1,OOe:X,p0g:ma};c.Jrb=!0}else r.ULS.sendTraceTag(528537613,3019,15,"Content control is not block type"),c.Jrb=!1;else c.Jrb=!1;return{response:!0,OOe:X,p0g:ma}}URn(a,c,h,v,B){r.ULS.sendTraceTag(559018209,3019,50,"Updating old TOC to empty TOC");this.eIb.RXd(a);let X=this.Qyd(a);if(!this.iii(X,c,h,v))return Ch.Era("Failed to populate empty TOC."),!1;if(c=sd.ParagraphReader.jg(a,!1,!0))h=a.ia(Yb.a.ZK,null),v=c.ia(Yb.a.ZK,null),h==v&&this.mKf(c);a.setValue(Yb.a.ZK,B);return!0}iii(a,c,h,v){this.Tb.replaceTextRange(a,
WordEditorIntl.WordEditorStrings.L_EmptyTOCText);a=a.node;this.q6h(a);this.nd.jH(a.la.first.formatting,!0);this.KTe(a,0,1,v);return c&&h&&!this.yTe(h,a.id)?!1:!0}Qyd(a){a.la.reset();a.DTa();const c=new Ax.a(a,0);c.formatting=new Bp.a(c,N.a.nil);c.Vg=!0;a.la.add(c);return Oe.a.createTextRange(a,0,a.characterData.length)}YUh(a){if(sd.ParagraphReader.yR(a)){var c=a.la.last.je;if(!c||!c.length)return!1;if(4<=c.length){a=0===c.J(c.length-4).Mk;const h=1===c.J(c.length-3).Mk&&c.J(c.length-3).instruction.trim().startsWith(this.UHc),
v=2===c.J(c.length-2).Mk;c=5===c.J(c.length-1).Mk;return a&&h&&v&&c}}return!1}dVh(a){if(sd.ParagraphReader.yR(a)){var c=a.la.first.je;if(!c||!c.length)return!1;if(2<=c.length)return a=4===c.J(0).Mk,c=3===c.J(1).Mk,a&&c}return!1}kri(a){const c=a.la.last.je,h=c.J(c.length-4),v=c.J(c.length-3),B=c.J(c.length-2),X=c.J(c.length-1);c.remove(h);c.remove(v);c.remove(B);c.remove(X);a.removeProperty(Yb.a.ZK)}jri(a){const c=a.la.first.je,h=c.J(0),v=c.J(1);c.remove(h);c.remove(v);a.removeProperty(Yb.a.ZK)}mKf(a){if(a){var c=
a.ia(Yb.a.ZK,null),h=a.ia(Yb.a.Ib,null).toString(),v=c;h==c&&this.YUh(a)&&(this.kri(a),(a=sd.ParagraphReader.jg(a,!1,!0))&&(v=a.ia(Yb.a.ZK,null)));h=new Kd.GraphIterator;h.set(a);h.La(8);r.ULS.sendTraceTag(559018210,3019,50,"Attempting to remove TOC paragraphs");for(var B;a&&a.kr&&v==c&&B!=a;){if(this.dVh(a)){this.jri(a);break}this.eIb.RXd(a);this.rn.Wc(h);v=this.rn.Ir(h,!1,!0);this.Vd.b_a(a);if(!v)return null;B=a;h.Za(2);v=(a=h.currentNode)?a.ia(Yb.a.ZK,null):null}return a}}IDh(a){var c=a.la,h=c?
c.length:0,v=null;a=new Bx(!0,!1,!1,0,8,!0,void 0);for(let B=0;B<h&&(v=this.Ehl(c.J(B)),a.instruction=v,v=this.Qel(v),v[0]!==this.UHc);B++);c=v?v.length:0;for(h=1;h<c;h++)switch(v[h]){case "\\h":a.Rzb=!0;break;case "\\u":a.fff=!0;break;case "\\o":this.bhn(v[h+1],a)&&h++;break;case "\\z":break;case "\\n":a.zTf=!1;a.CIb.push(v[h]);break;default:a.CIb.push(v[h])}return a}bhn(a,c){return a&&(a=a.match(RegExp('^"([0-9])-([0-9])"$')))&&3===a.length?(c.IBb=Number.parseInvariant(a[1])-1,c.QIb=Number.parseInvariant(a[2])-
1,!0):!1}cWm(a){try{re.a(Ch.BXm);const c=window.performance.now(),h=this.GDh(a);if(null==h){Ch.jqf("Attempt to remove TOC when firstTocPara = null");return}let v,B,X;const ma=this.yth();if(!({OOe:v,p0g:B}=this.Lqi(h,ma)).response)return Ch.jqf("Failed to remove content control"),!1;if(void 0==v&&void 0==B)X=this.mKf(h);else{X=h.Mb.Ra(v);let mb=new Kd.GraphIterator;mb.set(X);mb.La(8);a=!1;let Tb;for(;!a&&X&&Tb!=X;){X.id.equals(B)&&(a=!0);X&&X.kr&&this.eIb.RXd(X);this.rn.Wc(mb);const rc=this.rn.Ir(mb,
!1,!0);this.Vd.b_a(X);if(!rc){X=null;break}mb.Za(2);Tb=X;X=mb.currentNode}}X&&this.nNc(X);const Pa=window.performance.now()-c;re.a(Ch.lri,!0,Pa)}catch(c){Ch.jqf(String.format("{0} {1}",c.message,c.stack))}return!0}nNc(a){a=Oe.a.Sb(a,0);a=new xm.Selection([a],!0);this.ya.setSelection(a)}yTe(a,c){return this.io.Zga(a,c,null,Ch.pxk,!0).returnValue?(r.ULS.sendTraceTag(573653840,3019,10,"Failed to create content control block for table of contents."),!1):!0}J3j(){this.eIb.Dhl()||this.KDe.yTf()}GDh(a){if(!a.kr)return r.ULS.sendTraceTag(528320659,
3019,15,"Cannot get TOC Begin Paragraph. Para is not in TOC"),null;a=a.ia(Yb.a.ZK,null);return this.kG.H$k(a)}c2h(a){a.length&&(a=[Object.assign(new aa.a,{name:"UnsupportedSwitches",string:a.toString()})],re.a("UnsupportedTocInstruction",void 0,void 0,a))}Ehl(a){const c=(a=a.je)?a.length:0;for(let h=0;h<c;h++)if(1===a.J(h).Mk&&a.J(h).instruction.trim().startsWith(this.UHc))return a.J(h).instruction.trim();return null}Qel(a){const c=[];if(!a)return c;a=a.split(" ");return a.length?a:c}Ehk(a){a=this.N9g(a,
null,!0,void 0).returnValue;if(!a)return Ch.BYa("Failed to create paragraph"),!1;const c=Oe.a.Sb(a,0);if(!this.iii(c,!0,a.id,this.fIb.instruction))return Ch.BYa("Failed to populate empty TOC"),!1;r.ULS.sendTraceTag(575447938,3019,50,"Created an empty table of contents.");return!0}N9g(a,c,h,v){let B,X;h&&a?(B=this.Thk(a),X=B.currentNode,v=sd.ParagraphReader.vR(X).toString()):c&&(B=this.e8k(c),X=this.Vd.eM(B));if(!X)return r.ULS.sendTraceTag(592233798,3019,15,"Failed to insert paragraph for table of contents"),
{returnValue:null,zub:B};X.setValue(Yb.a.ZK,v);return{returnValue:X,zub:B}}GDm(){const a=new Sys.StringBuilder(this.UHc);a.append(" \\o \\z \\u");a.append(" \\h");return a.toString()}TDm(a){const c=new Sys.StringBuilder("PAGEREF ");c.append(a);this.fIb.Rzb&&c.append(" \\h");return c.toString()}e8k(a){a.nc();this.rn.Wc(a);return this.Vd.Mqa(a,!1)}Thk(a){const c=new Kd.GraphIterator;c.set(a.node);c.nc();this.rn.Wc(c);let h=this.zyh(c);const v=!a.cpBegin;if(Ta.OutlineElementReader.isEmpty(c,!0))return this.DNh(h);
if(v)return this.Vd.bA(h,!0,!1),this.Vd.o$(c,h,a,!1,!1,!1),a=this.zyh(h),this.DNh(a);h=this.Vd.Mqa(c);this.Vd.o$(c,h,a,!1,!1,!0);a=this.Vd.Mqa(c);this.Vd.gGb(a.currentNode,!1);this.Vd.eM(a);this.rn.Fd(a);return a}zyh(a){const c=new Kd.GraphIterator;c.Wb(a);c.nc();return c}DNh(a){this.Vd.bA(a,!0,!0);this.Vd.gGb(a.currentNode,!1);this.rn.Fd(a);return a}q6h(a){const c=a.la;1===c.length&&(c.first.Vg=!1,a.Xud().Vg=!0)}CRn(a,c,h,v,B){let X=this.Qyd(a);this.Tb.replaceTextRange(X,"");this.mii(a,v,B);this.KTe(a,
c,h,B.instruction);return B.Rzb&&!this.BG(a,v.Vr)?!1:!0}NNh(a,c,h,v,B,X){c=({zub:a}=this.N9g(a,c,0==h,X)).returnValue;if(!c)return{returnValue:!1,zub:a};this.mii(c,B,this.fIb);this.KTe(c,h,v,this.fIb.instruction);return this.fIb.Rzb&&!this.BG(c,B.Vr)?{returnValue:!1,zub:a}:{returnValue:!0,zub:a}}mii(a,c,h){this.TCl(a,c.pul,c.listMarker,c.NLi,c.SKa);this.YIg.mEl(a,a.characterData.length);h.zTf&&this.JDl(a,c);this.q6h(a);this.pjn(a,c.NLi)}S5k(a,c){if(!a)return 0;const h=Ch.kjl();return 4<a.length?h.J(c)+
.5*Math.floor(a.length/3):h.J(c)}TCl(a,c,h,v,B){h&&this.gDl(a,h,v);h=Oe.a.Sb(a,a.characterData.length);this.Tb.replaceTextRange(h,c);B&&(a=a.la.$g(0),this.nd.CY(a.formatting,B))}gDl(a,c,h){h=this.S5k(c,h);const v=Oe.a.Sb(a,0);this.Tb.replaceTextRange(v,c);this.YIg.hDl(a,c.length,h)}JDl(a,c){var h=Oe.a.Sb(a,a.characterData.length);this.Tb.replaceTextRange(h,c.ii.toString());h=a.la.$g(a.characterData.length-c.ii.toString().length);c=this.TDm(c.Vr);this.LJa(a,h,0,2,c);this.LJa(a,h,1,2,c);this.LJa(a,
h,2,2,c);h=a.la.$g(a.characterData.length);this.LJa(a,h,3,2,c)}pjn(a,c){c=this.vfe.zg(c);this.yv.MK(c,a,!0)}KTe(a,c,h,v){const B=a.la.first,X=a.la.last;c?this.LJa(a,B,4,1,v):(this.LJa(a,B,0,1,v),this.LJa(a,B,1,1,v),this.LJa(a,B,2,1,v));c===h-1?this.LJa(a,X,3,1,v):this.LJa(a,X,5,1,v)}LJa(a,c,h,v,B=null){h=new Xu.a(c,null,h,v,!0,!1,!1,B);c.je||(c.je=new aB.a(c));c.je.add(h);a.rl();this.onk(h,a)}onk(a,c){kg.a.instance.J(6)&&(a.zd?c.wordRunProperties.DX(a.zd-1,2):c.wordRunProperties.Lqa(a.zd,2),c.wordRunProperties.yp.Z(a.zd,
kq.CharacterPropertiesEditor.ZO),c.wordRunProperties.Jr.Z(a.zd,kq.CharacterPropertiesEditor.bS))}BG(a,c){a=Oe.a.createTextRange(a,0,a.characterData.length);return this.Oi.BG(a,c,!1,!1,!1,!0)?!0:(r.ULS.sendTraceTag(592233799,3019,50,"Failed to create hyperlink for table of contents entries"),!1)}static kjl(){Ch.noa||(Ch.noa=new od.a,Ch.noa.Z("toc 1",1),Ch.noa.Z("toc 2",1.5),Ch.noa.Z("toc 3",2),Ch.noa.Z("toc 4",2.5),Ch.noa.Z("toc 5",3),Ch.noa.Z("toc 6",3.5),Ch.noa.Z("toc 7",4),Ch.noa.Z("toc 8",4.5),
Ch.noa.Z("toc 9",5));return Ch.noa}}Ch.noa=null;Ch.pxk="Table of Contents";Ch.Kmk="CreateTocClient";Ch.VUe="CreateTocSuccess";Ch.Lmk="CreateTocFailureCause";Ch.XRn="UpdateTocClient";Ch.L0f="UpdateTocSuccess";Ch.YRn="UpdateTocFailureCause";Ch.BXm="RemoveTocClient";Ch.lri="RemoveTocSuccess";Ch.CXm="RemoveTocFailureCause";Object(w.a)(Ch,"TOCField",null,[455,456]);var Zk=b(597);class vy{constructor(a,c){this.rua=a;this.vDa=c}mEl(a,c){if(sd.ParagraphReader.tb(a)&&!(0>c)){var h=iq.a.Gvc(a);h=new Zk.a(h,
4,1,1);this.rua.CGd(a,h);a=Oe.a.Sb(a,c);this.vDa.PGd(a)}}hDl(a,c,h){var v=fm.a.jI/2;const B=a.la.KZb(c);v=ua.FormattingReader.Mm(B.formatting,Ed.a.fontSize,2*v)/2;h=new Zk.a(Of.a.YD(v/36)*h,1,0,1);this.rua.CGd(a,h);a=Oe.a.Sb(a,c);this.vDa.PGd(a)}}Object(w.a)(vy,"TOCTabUtility",null,[370]);class PB{constructor(){this.W=null}get name(){return"WordEditor.TableOfContents"}yb(a){this.W=a;this.W.ha("WordEditor.AutoSaveParamsUpdateService",()=>new LB.a(this.W.resolve("Box4.Graph.IGraphIteratorFactory"),
pu.a.jO)).singleInstance();this.W.ha("WordEditor.TableOfContents.StyleBasedDocumentHeadings",()=>new NB(new qf.a(()=>Eb.App.oa.Da.Zb),jn.PageNavigator.instance,this.W.resolve("Box4.Styles.IWACStyleReader"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IListMarkerUtility"),new Iu.a,new qf.a(()=>Eb.App.oa.Da.Jb))).as("WordEditor.TableOfContents.IDocumentHeadings").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCDataManager",()=>new OB(this.W.resolve("WordEditor.TableOfContents.IDocumentHeadings"),
this.W.resolve("WordEditor.Bookmark.IBookmarkManager"))).as("Box4.ITOCDataManager").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCTabUtility",()=>new vy(this.W.resolve("WordEditor.ICustomTabStopUtility"),this.W.resolve("Box4.IBlobEditor"))).as("WordEditor.TableOfContents.ITOCTabUtility").singleInstance();this.W.ha("WordEditor.TableOfContents.TOCField",()=>new Ch(this.W.resolve("Box4.ITOCDataManager"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.IHyperlinkEditor"),
this.W.resolve("Box4.Styles.IWACStyleEditor"),this.W.resolve("Box4.Styles.IWACStyleReader"),li.a.instance,this.W.resolve("Box4.ISelectionManager"),this.W.resolve("Box4.ICharacterPropertiesEditor"),this.W.resolve("WordEditor.TableOfContents.ITOCTabUtility"),this.W.resolve("Box4.IFormattingEditor"),qu.instance,this.W.resolve("Box4.IFeatureHelper"),this.W.resolve("WordEditor.ContentControl.IContentControlManager"),this.W.ra("WordEditor.ParagraphWordIdMapping"),this.W.resolve("Box4.IOutlineElementNavigator"),
Fk.a.instance,l.AFrameworkApplication.Cb,this.W.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.TableOfContents.ITOCField").singleInstance();this.W.ha("WordEditor.TableOfContents.TableOfContentsActor",()=>new Ar(l.AFrameworkApplication.pa,this.W.resolve("WordEditor.AutoSaveParamsUpdateService"),this.W.resolve("Box4.IOutlineElementEditor"),this.W.resolve("Box4.Graph.IGraphIteratorFactory"),Fk.a.instance,li.a.instance,this.W.resolve("WordEditor.TableOfContents.ITOCField"),this.W.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
this.W.resolve("Box4.IFeatureHelper"),this.W.za("WordEditor.IPageNumberFinder"),a.resolve("WordEditor.IMainViewModeManager"))).as("WordEditor.TableOfContents.ITableOfContentsActor").singleInstance()}init(){this.W.resolve("WordEditor.TableOfContents.ITableOfContentsActor").eb()}dispose(){}}Object(w.a)(PB,"PackageManager",null,[1,2]);class Mg{constructor(a,c,h,v,B,X,ma,Pa){this.gj=a;this.Ehd=c;this.ga=h;this.Kjd=v;this.Fb=B;this.Xm=X;this.mkj=Pa}eb(){this.I8b(Eb.App.P0a.F8g())}I8b(a){this.ga.ka(zb.a.eMa,
ic.a.view,a);this.ga.ka(zb.a.eMa,ic.a.table,Object(m.a)(this,this.eMa,"queryTableStyle"));this.ga.Qb(zb.a.eMa,1127);this.ga.ka(zb.a.hha,ic.a.view,Object(m.a)(this,this.D4d,"tableStyleGenericViewActionHandler"));this.ga.ka(zb.a.hha,ic.a.table,Object(m.a)(this,this.hha,"applyTableStyle"));this.ga.Qb(zb.a.hha,1030);this.ga.ka(zb.a.applyStyle,ic.a.table,Object(m.a)(this,this.hha,"applyTableStyle"));this.ga.ka(zb.a.Moa,ic.a.view,Object(m.a)(this,this.D4d,"tableStyleGenericViewActionHandler"));this.ga.ka(zb.a.Moa,
ic.a.table,Object(m.a)(this,this.Moa,"applyTableStyleOption"));this.ga.Qb(zb.a.Moa,1038);this.ga.ka(zb.a.usa,ic.a.view,a);this.ga.ka(zb.a.usa,ic.a.table,Object(m.a)(this,this.usa,"queryTableStyleOption"));this.ga.Qb(zb.a.usa,1127);this.ga.ka(zb.a.IDb,ic.a.view,a);this.ga.ka(zb.a.IDb,ic.a.table,Object(m.a)(this,this.IDb,"populateMenuMoreTableStyles"));this.ga.Qb(zb.a.IDb,1126);this.ga.ka(zb.a.rtb,ic.a.view,Object(m.a)(this,this.D4d,"tableStyleGenericViewActionHandler"));this.ga.ka(zb.a.rtb,ic.a.table,
Object(m.a)(this,this.rtb,"clearTableFormatting"));this.ga.Qb(zb.a.rtb,1028)}bN(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("WordEditorTablesSupportFloodgateIsEnabled")&&window.setTimeout(()=>{const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");a&&a.execute(c=>{c.logActivity("WordEditorTablesUsageSupport","WordEditorTablesSupportFloodgateIsEnabled")})},5E3)}eMa(a,c,h,v,B){if(!({jw:a}=this.whb(c,h,B,!0,!0)).returnValue)return a;this.Ehd.b9g(B,c.node);return 32}usa(a,c,h,v,B){return this.dIh(c,
h,v,B,!0)}IDb(a,c,h,v,B){if(!({jw:a}=this.whb(c,h,B,!1,!0)).returnValue)return a;this.Ehd.zjk(B,c.node);r.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32}hha(a,c,h,v,B){if(!({jw:v}=this.whb(c,h,B,!1,!0)).returnValue)return 2==h&&8==v&&Rr.a.recordQosError("TableStyleButtonClickNoResponse",["TableInteractionFailed"],Ef.a.Tvb),v;const X=c.node;let ma=null;(ma=a===zb.a.hha?this.Ehd.gJb(B[Uf.a.SourceControlId],X):this.gj.Oxb(X,B))?(this.dUd(X,()=>{this.Kjd.bNa(ma,X)}),this.bN(),v=32):(Rr.a.recordQosError("TableStyleButtonClickNoResponse",
["TableInteractionFailed"],Ef.a.Tvb),v=8);a===zb.a.hha&&32===v&&r.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");r.ULS.shipAssertTag(0,324,32===v);return v}Moa(a,c,h,v,B){return this.dIh(c,h,v,B,!1)}dIh(a,c,h,v,B){if(!({jw:X}=this.whb(a,c,v,B,!0)).returnValue)return 2==c&&8==X&&Rr.a.recordQosError("TableStyleOptionButtonClickNoResponse",["TableInteractionFailed"],Ef.a.KFk),X;a=a.node;c=this.gj.uR(a);var X=v[Uf.a.On];const ma=Mg.Whl(v.MenuItemId);B?v[Uf.a.On]=Mg.Con(c,ma):(this.BPj(c,
ma,X,a),h.dr=ma,h.GD=X?0:1,r.ULS.shipAssertTag(0,324,!!ma));return 32}D4d(a,c,h,v,B){return Ln.a.Bka(a,c,h,v,B,{},14)}dUd(a,c){const h=this.Fb.Ob(15);try{h.Oa(a),this.Xm.k_a(),c()}finally{h&&h.dispose()}}whb(a,c,h,v,B){return this.xTl(a,c,h,v,B)?{returnValue:v||2===c,jw:32}:{returnValue:!1,jw:8}}xTl(a,c,h,v,B){if(a.contextId!==ic.a.table)return!1;if(v||2===c)if(B&&!h||!Object(Ub.a)(jq.TableNode,a.node)||this.mkj(a.node))return!1;return!0}BPj(a,c,h,v){const B=(512===c||1024===c?!h:h)?a|c:a&~c;B!==
a&&this.dUd(v,()=>{this.Kjd.ola(B,v)})}rtb(a,c,h,v,B){if(!({jw:a}=this.whb(c,h,B,!1,!1)).returnValue)return a;const X=c.node;this.dUd(X,()=>{this.Kjd.I2g(X)});return 32}static pv(){Mg.d7a[Mg.ZJk]=32;Mg.d7a[Mg.RJk]=128;Mg.d7a[Mg.kXl]=64;Mg.d7a[Mg.bXl]=256;Mg.d7a[Mg.GSj]=512;Mg.d7a[Mg.FSj]=1024}static Con(a,c){a=!!(a&c);if(512===c||1024===c)a=!a;return a}static Whl(a){let c=0;a in Mg.d7a&&(c=Mg.d7a[a]);return c}}Mg.ZJk="buttonFirstRow";Mg.RJk="buttonFirstColumn";Mg.kXl="buttonLastRow";Mg.bXl="buttonLastColumn";
Mg.GSj="buttonBandedRow";Mg.FSj="buttonBandedColumn";Mg.d7a={};Object(w.a)(Mg,"TableStyleActor",null,[]);Mg.pv();var fk=b(702);class Tr extends Nh.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(w.a)(Tr,"TableGalleryButtonProps",Nh.a,[]);class fw extends Tr{constructor(){super()}get Type(){return 6}}Object(w.a)(fw,"TableStyleGalleryButtonProps",Tr,[]);class Yu{}Yu.Mhm=2147483647;Object(w.a)(Yu,"TableStyleUtil",null,[]);class Es{constructor(a,c,h){this.aQe=
"Clear";this.Rvb=null;this.Vwj=a;this.$b=c;this.gj=h;this.zO=l.AFrameworkApplication.zO;this.qp=l.AFrameworkApplication.qp}UUa(){}BDj(a,c){this.UUa(a);const h=this.Yph(a),v=h.length;if(!(0>=v)){var B=Yu.Mhm,X=null;for(let mb=0;mb<v;mb++){var ma=h[mb],Pa=this.gj.hil(ma);B!==Pa&&(B=Object.assign(new Hg.a,{Id:"msMoreTableStyles"+Pa,Title:this.iil(Pa),ControlList:[]}),X=Object.assign(new Ce.a,{Type:6,Id:"galleryMoreTableStyles"+Pa,ExternalGalleryId:"TableStylesGallery",Width:Es.HVf,ElementDimensions:"Size64by48",
GalleryItems:[]}),this.Rvb&&(X.ExternalId=this.Rvb[Pa.toString()]),B.ControlList.push(X),c.MenuSectionList.push(B),B=Pa);Pa=this.$b.pC(ma);ma=Es.TWf+mb;Pa=Object.assign(new fw,{Id:ma,ExternalId:ma,Command:zb.a.hha.toString(),QueryCommand:zb.a.eMa.toString(),LabelText:Pa?F.a.Wd(Pa):"",Alt:Pa,VerticalCenterAlign:"true"});Pa.TableCellStyles=this.rCd(ma,a);Pa.TableStyles=this.VEc(ma,a);X&&X.GalleryItems.push(Pa)}}}ADj(a){const c=Object.assign(new Hg.a,{Id:"msMoreTableStyleCommands",DisplayMode:"Menu16",
ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),h=Object.assign(new qh.a,{Id:"fseaClearTableFormatting",Command:zb.a.rtb.toString(),LabelText:F.a.Wd(this.aQe),Alt:F.a.Wd(this.aQe),Image16by16:this.qp,Image16by16Class:Fd.getImageClassWithCluster(this.zO,Es.i7j),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});c.ControlList.push(h);a.MenuSectionList.push(c)}b9g(a,c){this.UUa(c);const h=a[Uf.a.SourceControlId];var v=this.gJb(h,c);if(v){var B=this.gj.jy(c);B=B?this.$b.oe(B):null;var X=this.$b.pC(v);
v=this.$b.oe(v);a[Pf.a.Alt]=X;a[Pf.a.On]=v===B;c=Object.assign(new fw,{Id:h,ExternalId:h,Command:zb.a.hha.toString(),QueryCommand:zb.a.eMa.toString(),TableCellStyles:this.rCd(h,c),TableStyles:this.VEc(h,c),Alt:X});a[Pf.a.GalleryButtonProps]=c}else a[Pf.a.InnerHTML]=null,a[Pf.a.Alt]=null,a[Pf.a.On]=!1,a[Pf.a.GalleryButtonProps]=null}rCd(a,c){this.UUa(c);return(a=this.gJb(a,c))?this.Vwj.urh(a,c):null}VEc(a,c){this.UUa(c);return this.gJb(a,c),null}zjk(a,c){a.MenuItems=this.F7k(c)}F7k(a){const c=Object.assign(new Ah.a,
{Id:"menuMoreTableStyles",MenuSectionList:[]});this.BDj(a,c);this.ADj(c);return c}gJb(a,c){return a?a.startsWith(Es.TWf)?this.ybf(parseInt(a.substr(Es.TWf.length)),c):this.V2m(parseInt(a.substr(Es.XAn.length)),c):null}}Es.TWf="buttonTableStyleMenu";Es.XAn="buttonTableStyleRibbon";Es.HVf=7;Es.i7j="ClearTableStyle_16x16x32";Object(w.a)(Es,"ATableStyleRibbonControl",null,[462]);class QB extends Es{constructor(a,c,h){super(null,c,h);this.$Hg=a}b9g(a,c){this.UUa(c);const h=a[Uf.a.SourceControlId];var v=
this.gJb(h,c);if(v){var B=this.gj.jy(c);B=B?this.$b.oe(B):null;var X=this.$b.pC(v);v=this.$b.oe(v);a[Pf.a.Alt]=X;a[Pf.a.On]=v===B;c=Object.assign(new fw,{Id:h,ExternalId:h,Command:zb.a.hha.toString(),QueryCommand:zb.a.eMa.toString(),TableCellStyles:this.rCd(h,c),TableStyles:this.VEc(h,c),Alt:X});a[Pf.a.GalleryButtonProps]=c}else a[Pf.a.InnerHTML]=null,a[Pf.a.Alt]=null,a[Pf.a.On]=!1,a[Pf.a.GalleryButtonProps]=null}rCd(a,c){this.UUa(c);return(a=this.gJb(a,c))?this.$Hg.urh(a,c,5,5):null}VEc(a,c){this.UUa(c);
return this.gJb(a,c),null}}Object(w.a)(QB,"ATableStyleRibbonControlVariableSizePreviews",Es,[]);var wy=b(1266),mz=b(977);class wv{constructor(a,c,h,v){this.Tk=a;this.Hp=c;this.dSa=h;this.fN=v;this.k9i=new qf.a(()=>this.qTk());this.I2a=new qf.a(()=>this.pTk())}qTk(){const a={},c=l.AFrameworkApplication.isRtl;a.top="border-top";a.left=c?"border-right":"border-left";a.bottom="border-bottom";a.right=c?"border-left":"border-right";a.insideHorizontal="border-bottom";a.insideVertical=c?"border-left":"border-right";
return a}pTk(){const a={};a[Og.a.Iwa]=Og.a.x8a;a[Og.a.x8a]=Og.a.x8a;a[Og.a.lTa]=Og.a.lTa;return a}Ngk(a,c,h,v){const B=new mz.a;B.rowCount=h;B.U8a=v;B.BNa=this.dSa.xhl(a);B.tFb=a.ia(Yb.a.tFb,1);B.vtb=a.ia(Yb.a.vtb,1);B.tableLook=c;B.v4d=1;return B}urh(a,c,h,v){if(!this.Tk.oe(a)||!Object(Ub.a)(28,a)||!Object(Ub.a)(kt.a,c))return null;const B=this.Hp.uR(c);h=this.Ngk(a,B,h,v);v=[];for(h.rowIndex=0;h.rowIndex<h.rowCount;h.rowIndex++)this.zFj(a,c,h,v);return v}VEc(){return null}J8(){}zFj(a,c,h,v){h.g1b=
!h.rowIndex;for(h.cellIndex=0;h.cellIndex<h.U8a;h.cellIndex++)this.hCj(a,c,h,v)}hCj(a,c,h,v){c=this.dSa.vak(h,this.dSa.e6e(h),c,a);const B={};var X=this.Hp.Eyd(a,c,Ed.a.fontColor,!0,Aj.a.pX(),!1);B.color=X?X:"inherit";X=this.Hp.Eyd(a,c,Ed.a.dI,!0,Aj.a.pX(),!1);B["background-color"]=X?X:"inherit";this.Hp.Bzb()&&this.$Fj(h,a,c,B);v.push(B)}$Fj(a,c,h,v){a=this.dSa.NIa(a);this.Kkd(5,a,c,h,v);this.Kkd(3,a,c,h,v);this.Kkd(0,a,c,h,v);this.Kkd(4,a,c,h,v)}Kkd(a,c,h,v,B){c=this.QZk(a,c,h,v);c!==Og.a.tD&&(B[this.k9i.value[wy.a[a]]]=
c)}QZk(a,c,h,v){let B=Og.a.tD;if(({oha:B}=this.KCa(v,a,1,c,Object(m.a)(this,this.rTk,"getBorderPropertyValueFromConditionalStyle"),B)).returnValue)return B;({oha:B}=this.KCa(h,a,3,c,Object(m.a)(this,this.sTk,"getBorderPropertyValueFromTableStyle"),B));return B}KCa(a,c,h,v,B,X){return this.fN.OFi(h,c,v)&&(X=B(a,c))!==Og.a.tD||!c&&({oha:X}=this.KCa(a,1,h,v,B,X)).returnValue||4===c&&({oha:X}=this.KCa(a,2,h,v,B,X)).returnValue?{returnValue:!0,oha:X}:{returnValue:X!==Og.a.tD,oha:X}}sTk(a,c){return this.getBorder(a,
this.fN.gK(c))}rTk(a,c){return this.getBorder(a,this.fN.pM(c))}getBorder(a,c){let h="",v,B;({borderStyle:v,borderWidth:B}=this.uTk(a,c,v,B));if(v===Og.a.lTa)return h;h=String.format(Og.a.lnd,B,v,this.jTk(a,c));return h.trim()}jTk(a,c){if(!c)return Og.a.WW;a=this.Hp.Yvb(a,c.color,kn.a.auto);return a!==kn.a.auto?kn.a.SA(a):Og.a.WW}uTk(a,c,h,v){h=Og.a.Toa;v=Og.a.uD+Og.a.JUb;if(!c)return{borderStyle:h,borderWidth:v};h=this.Hp.Yvb(a,c.style,Og.a.lTa);a=this.Hp.Yvb(a,c.size,Og.a.uD);v=this.tTk(h,a)+Og.a.JUb;
h=this.kTk(h);return{borderStyle:h,borderWidth:v}}tTk(a,c){let h=2;a===Og.a.GUb&&c<Og.a.nha&&(h=1);return h}kTk(a){return this.I2a.value[a]||Og.a.HUb}static jil(){return new wv(xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),xa.a.instance.resolve("WordEditor.IWACTableStyleReader"),yw.a.instance,Og.a.instance)}static get instance(){return wv.fj||(wv.fj=wv.jil())}}wv.fj=null;Object(w.a)(wv,"TableStylePreviewGenerator",null,[463]);var gw;(function(a){a[a.j4n=0]="background1";a[a.Ddo=1]="text1";
a[a.k4n=2]="background2";a[a.Edo=3]="text2";a[a.accent1=4]="accent1";a[a.accent2=5]="accent2";a[a.accent3=6]="accent3";a[a.accent4=7]="accent4";a[a.accent5=8]="accent5";a[a.accent6=9]="accent6";a[a.hyperlink=10]="hyperlink";a[a.s7n=11]="followedHyperlink";a[a.u5n=12]="dark1";a[a.p9n=13]="light1";a[a.v5n=14]="dark2";a[a.q9n=15]="light2";a[a.none=16]="none";a[a.max=17]="max"})(gw||(gw={}));Object(w.b)("ThemeColor",gw);class mq{constructor(a){this.gva=a}yRk(a,c,h){let v;({Hmi:c,MVg:v}=this.Hcl(c));a=
[];const B=[];for(let ma=0;16>ma;ma++){if(!(gw[ma]in h.Qqb))continue;const Pa=ma,mb=String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,WoncaIntl.WoncaStrings[v[Pa]],this.M4k(ma));var X=c[Pa];X=X&4278190080|(X&255)<<16|X&65280|(X&16711680)>>>16;B.push(Object.assign(new zo.a,{Color:Pa.toString(),DisplayColor:"#"+F.a.zG(X,6),Alt:F.a.Wd(mb)}));a[a.length]=ma}return{returnValue:B,RCn:a}}M4k(a){switch(a){case 0:return Box4Intl.Box4Strings.l_ThemeLabel1;case 1:return Box4Intl.Box4Strings.l_ThemeLabel2;
case 2:return Box4Intl.Box4Strings.l_ThemeLabel3;case 3:return Box4Intl.Box4Strings.l_ThemeLabel4;case 4:return Box4Intl.Box4Strings.l_ThemeLabel5;case 5:return Box4Intl.Box4Strings.l_ThemeLabel6;case 6:return Box4Intl.Box4Strings.l_ThemeLabel7;case 7:return Box4Intl.Box4Strings.l_ThemeLabel8;case 8:return Box4Intl.Box4Strings.l_ThemeLabel9;case 9:return Box4Intl.Box4Strings.l_ThemeLabel10;default:return""}}Hcl(a){let c=null,h=null;a=this.gva(a);if(!a)return{Hmi:c,MVg:h};c=a.properties.ia(Yb.a.themeColors,
null);h=a.properties.getValue(Yb.a.d5d).split(" ");return{Hmi:c,MVg:h}}static lil(){return new mq(Object(m.a)(mq.Ag,mq.Ag.Xs,"navigateToPageContentNode"))}static get Ag(){return jn.PageNavigator.instance}static get instance(){return mq.fj||(mq.fj=mq.lil())}}mq.fj=null;Object(w.a)(mq,"TableStyleThemeHelper",null,[482]);var hw=b(771);class Vs{constructor(a,c){this.SCe={};this.Qqb={};this.$b=a;this.gj=c}g0e(a,c){const h=this.SCe[gw[c]];return h&&h.length?h:this.APk(a,c)}wwh(a,c,h){if(c=this.g0e(c,h))for(a=
this.$b.oe(a),h=0;h<c.length;h++)if(this.$b.oe(c[h])===a)return h;return-1}J8(){this.SCe={};this.Qqb={}}APk(a,c){const h=[];this.Qqb={};a=this.gj.kJa(a);this.hmd(h,this.Qqb,0,c,a);this.hmd(h,this.Qqb,1,c,a);this.hmd(h,this.Qqb,2,c,a);this.hmd(h,this.Qqb,3,c,a);return this.SCe[gw[c]]=h}hmd(a,c,h,v,B){const X=B.cM;for(let ma=0;ma<X;ma++){const Pa=B.Uia(ma);if(3!==this.$b.Gv(Pa))continue;const mb=this.gj.gil(Pa),Tb=this.gj.UEc(Pa);c[gw[Tb]]=!0;mb!==h||Tb!==v&&16!==Tb||this.$b.oe(Pa)===hw.a.W_c||(a[a.length]=
Pa)}}static Gll(){return new Vs(xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),xa.a.instance.resolve("WordEditor.IWACTableStyleReader"))}static hnk(){return Vs.Gll()}}Object(w.a)(Vs,"WACTableStyleRibbonList",null,[481]);class Ws extends QB{constructor(a,c,h,v,B){super(a,c,h);this.zLb=4;this.Zhd=[];this.Wwj=B;this.ISb=v;this.aQe=WordEditorIntl.WordEditorStrings.L_BtnClearTableFormatting;this.aCm()}Ggk(a,c){a.MenuItems=this.IOk(c)}aCm(){this.Rvb={};this.Rvb["0"]="CustomTableStyles";this.Rvb["1"]=
"PlainTableStyles";this.Rvb["2"]="GridTableStyles";this.Rvb["3"]="ListTableStyles"}IOk(a){const c=Object.assign(new Ah.a,{Id:"menuTableTheme"});c.MenuSectionList=[];if(this.OSl(a))return c;const h=Object.assign(new Hg.a,{Id:"msTableStyleTheme",ControlsId:"ctrlTableStyleThemeColors",ControlList:[]}),v=Object.assign(new fk.a,{Id:"clrTableStyleTheme",ExternalId:"TableStyleThemeColorPicker",Command:ba.a.c8a.toString(),QueryCommand:ba.a.tEb.toString(),Width:Ws.SCn});v.Colors=({RCn:this.Zhd}=this.Wwj.yRk(this.Zhd,
a,this.ISb)).returnValue;h.ControlList.push(v);c.MenuSectionList.push(h);return c}UUa(a){if(a=this.gj.jy(a))a=this.gj.UEc(a),16!==a&&(this.zLb=a)}Yph(a){return this.ISb.g0e(a,this.zLb)}ybf(a,c){c=this.ISb.g0e(c,this.zLb);return 0>a||a>=c.length?null:c[a]}V2m(a,c){var h=this.gj.jy(c);h=this.ISb.wwh(h,c,this.zLb);h=-1!==h?Math.floor(h/Es.HVf)*Es.HVf:0;return this.ybf(h+a,c)}iil(a){switch(a){case 0:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesCustom;case 2:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesGrid;
case 3:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesList;case 1:return WordEditorIntl.WordEditorStrings.L_LabelTableStylesPlain;default:return""}}OSl(a){this.UUa(a);return 0>=this.Yph(a).length}SRn(a,c){if(!a||!c)return null;a=parseInt(a[Ql.Color]);var h=this.gj.jy(c);const v=this.gj.UEc(h);if(v===a)return null;if(16===v)return this.zLb=a,null;h=this.ISb.wwh(h,c,v);this.zLb=a;return this.ybf(h,c)}Etk(a){a=this.gj.jy(a);a=this.gj.UEc(a);if(16!==a)for(let c=0;c<this.Zhd.length;c++)if(this.Zhd[c]===
a)return c;return-1}rTb(a){a.bHe(Object(m.a)(this,this.tFl,"invalidateStyles"),2)}tFl(){this.ISb.J8();this.$Hg.J8()}static kil(){return new Ws(wv.instance,xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),xa.a.instance.resolve("WordEditor.IWACTableStyleReader"),Vs.hnk(),mq.instance)}static get instance(){return Ws.fj||(Ws.fj=Ws.kil())}}Ws.SCn=4;Ws.fj=null;Object(w.a)(Ws,"TableStyleRibbonControls",QB,[461,462]);var gA=b(1373);class Uw extends Mg{constructor(a,c,h,v,B,X,ma,Pa){super(a,c,h,v,B,X,
ma,Pa)}I8b(a){super.I8b(a);this.ga.ka(ba.a.c8a,ic.a.view,Object(m.a)(this,this.D4d,"tableStyleGenericViewActionHandler"));this.ga.ka(ba.a.c8a,ic.a.table,Object(m.a)(this,this.c8a,"applyTableTheme"));this.ga.Qb(ba.a.c8a,1030);this.ga.ka(ba.a.P7b,ic.a.view,a);this.ga.ka(ba.a.P7b,ic.a.table,Object(m.a)(this,this.P7b,"populateMenuTableTheme"));this.ga.Qb(ba.a.P7b,1126);this.ga.ka(ba.a.tEb,ic.a.view,a);this.ga.ka(ba.a.tEb,ic.a.table,Object(m.a)(this,this.tEb,"queryTableTheme"));this.ga.Qb(ba.a.tEb,1127)}P7b(a,
c,h,v,B){if(!({jw:a}=this.whb(c,h,B,!1,!0)).returnValue)return a;this.VWf.Ggk(B,c.node);return 32}c8a(a,c,h,v,B){if(!({jw:a}=this.whb(c,h,B,!1,!0)).returnValue)return 2==h&&8==a&&Rr.a.recordQosError("TableStyleColorButtonClickNoResponse",["TableInteractionFailed"],Ef.a.LFk),a;const X=c.node,ma=this.VWf.SRn(B,X);ma&&this.dUd(X,()=>{this.Kjd.bNa(ma,X)});return 32}tEb(a,c,h,v,B){if(!({jw:a}=this.whb(c,h,B,!0,!0)).returnValue)return a;B[Ql.IndexColorSelected]=this.VWf.Etk(c.node);return 32}get VWf(){return this.Ehd}static fil(){return new Uw(xa.a.instance.resolve("WordEditor.IWACTableStyleReader"),
Ws.instance,l.AFrameworkApplication.pa,gA.a.instance,new Fk.a,xa.a.instance.resolve("Box4.IInsertionPointFormatting"),xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(m.a)(li.a.instance,li.a.instance.kdb,"isTableNodeInLockedRange"))}static get instance(){return Uw.fj||(Uw.fj=Uw.fil())}}Uw.fj=null;Object(w.a)(Uw,"TableStyleActor",Mg,[]);var ru=b(1441);class RB{constructor(){this.W=null}get name(){return"WordEditor.TableStyle"}yb(a){this.W=a;this.W.ha("Box4.TableEditors.ITableStylePreviewGeneratorVariableSize",
()=>wv.instance).singleInstance();this.W.ha("Box4.TableEditors.ITableStyleEditor",()=>ru.a.instance).singleInstance();this.W.ha("Box4.TableEditors.IWACTableStyleEditor",()=>gA.a.instance).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{this.El()})}El(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(185)&&(Uw.instance.eb(),Ws.instance.rTb(Xv.a.instance),gj.StyleReader.E4d=ru.a.instance,Eb.App.oa.updateCommandUI())}dispose(){}}Object(w.a)(RB,"TableStylePackage",
null,[1,2]);var bB=window.WordEditorHeaderToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordEditorHeaderToolbar",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",ImageUpArrow:"IMGMAP@we@RibbonUpArrow_5x3x32",ImageUpArrow8by8:"IMGMAP@we@RibbonUpArrow_8x8x32",ImageSideArrow:"IMGMAP@we@SubmenuFlyoutArrow_13x13x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",
Title:"STR@L_HeaderToolbarLabel",LabelText:"STR@L_HeaderToolbarLabel"},children:[{name:"Docks",attrs:{Id:"HeaderToolbarButtonDocks"},children:[{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsLeft"},children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarSectionsFlyout",Command:"0x2F9A3D80",QueryCommand:"0x978B3323",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0xF9833D60",Visible:"false"}},
{name:"ToggleButton",attrs:{Id:"HeaderToolbarFirstPageButton",LabelText:"STR@L_HeaderToolbarFirstPageButton",Command:"0xC95FE689",QueryCommand:"0xA99F5B15",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarEvenPagesButton",LabelText:"STR@L_HeaderToolbarEvenPagesButton",Command:"0xD9BEF8F8",QueryCommand:"0xF04337C4",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOddPagesButton",
LabelText:"STR@L_HeaderToolbarOddPagesButton",Command:"0xE58D2847",QueryCommand:"0x732475F7",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarOtherPagesButton",LabelText:"STR@L_HeaderToolbarOtherPagesButton",Command:"0x91C2D5C5",QueryCommand:"0x4B388351",TogglesWhenExecuted:"false",DisplayMode:"Medium",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"HeaderToolbarButtonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"HeaderToolbarControlsRight"},
children:[{name:"FlyoutAnchor",attrs:{Id:"HeaderToolbarOptions",Command:"0x568463EB",LabelText:"STR@L_HeaderToolbarOptions"},children:[{name:"Menu",attrs:{Id:"HeaderFooterToolbarMenu"},children:[{name:"MenuSection",attrs:{Id:"HeaderToolbarOptionsSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarOptionsControl"},children:[{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonAllPages",MenuItemId:"HeaderToolbarButtonAllPages",Image32by32:"IMGMAP@box42@HeaderAndFooter_32x32x32",
Command:"0xF56DFAEA",QueryCommand:"0x7B6FA1F6",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarAllPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstPage",MenuItemId:"HeaderToolbarButtonFirstPage",Image32by32:"IMGMAP@we@DifferentFirstPage_32x32x32",Command:"0x3284B693",QueryCommand:"0x51527973",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstPage"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonEvenOddPages",MenuItemId:"HeaderToolbarButtonEvenOddPages",
Image32by32:"IMGMAP@we@DifferentEvenOddPages_32x32x32",Command:"0x3DB867BD",QueryCommand:"0xE8BBEA49",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarEvenOddPages"}},{name:"ToggleButton",attrs:{Id:"HeaderToolbarButtonFirstEvenOddPages",MenuItemId:"HeaderToolbarButtonFirstEvenOddPages",Image32by32:"IMGMAP@we@DifferentFirstEvenOddPages_32x32x32",Command:"0x8FF03DBF",QueryCommand:"0x2799C44F",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarFirstEvenOddPages"}}]}]},{name:"MenuSection",
attrs:{Id:"HeaderToolbarDeleteSection",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"HeaderToolbarDeleteControl"},children:[{name:"Button",attrs:{Id:"HeaderToolbarButtonRemovePageNumbers",MenuItemId:"HeaderToolbarButtonRemovePageNumbers",Image32by32:"IMGMAP@we@WordRemovePageNumbers_32x32x32",Command:"0xF3612A1B",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_RemovePageNumbers"}},{name:"Button",attrs:{Id:"HeaderToolbarButtonDelete",MenuItemId:"HeaderToolbarButtonDelete",
Image32by32:"IMGMAP@we@RemoveHeadersAndFooters_32x32x32",Command:"0x3CD9B935",QueryCommand:"0xA609D50C",TogglesWhenExecuted:"false",LabelText:"STR@L_HeaderToolbarRemoveHeadersAndFooters"}}]}]}]}]}]}]}]}]}]},HC=b(1262);class cB{constructor(a,c){this.JEa=a;this.mua=c}dTm(a){this.JEa.rld(a)}Zwa(a){this.mua.Zwa(a)}zGb(a,c){return this.mua.zGb(a,c)}yGb(a,c){return this.mua.yGb(a,c)}gZf(a,c,h){this.mua.gZf(a,c,h)}}Object(w.a)(cB,"ClientPaginationHeaderFooterBridge",null,[454]);class dB{constructor(a,c){this.Bk=
a;this.ga=c;this.I6=new em.a;this.J6=new em.a}Zwa(a){a=Kd.GraphIterator.va(a);if(a.fn()&&a.ro()){a.Xc();do 10===a.Md&&this.YDf(a.currentNode),a.Ns();while(8!==a.Md)}}zGb(a,c){var h=this.Jxb(c);if(!this.I6.Ja(h))return r.ULS.sendTraceTag(573400388,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+h),!1;c=this.I6.J(h);r.ULS.shipAssertTag(573400389,336,this.J6.Ja(h),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowHeaderForPage().");
h=this.J6.J(h);return this.pdf(c,a,h)}yGb(a,c){var h=this.Jxb(c);if(!this.I6.Ja(h))return r.ULS.sendTraceTag(573400390,3009,15,"OutlineToHeaderFooterKindToContentMap does not contain a value for the section "+h),!1;c=this.I6.J(h);r.ULS.shipAssertTag(573400391,336,this.J6.Ja(h),"Outline to template mode map doesn't contain the section key in PageAdornmentContentManager.ShouldShowFooterForPage().");h=this.J6.J(h);return this.f3e(c,a,h)}gZf(a,c,h){c=this.Eaf(c,h);this.ga.hb(a?ba.a.c8d:ba.a.C_c,2,c)}Eaf(a,
c){c=this.Bk.$wb(c);if(!c)return r.ULS.sendTraceTag(573400392,3009,15,"Header footer container node expected not to be null."),0;c=this.Bk.Wia(c);const h=1===a;a=!(a%2);return 1===c?1:2===c?h?2:1:3===c?a?3:4:h?2:a?3:4}YDf(a){if(10===a.type){var c=new em.a,h=this.Bk.$wb(a);r.ULS.shipAssertTag(573400393,336,!!h,"Header footer container node expected to not be null in PageAdornmentContentManager.PopulateHeaderFooterKindToContentMap().");var v=this.Bk.Wia(h);a=this.Jxb(a);this.E0f(a,v);this.D0f(a,c);
h=Kd.GraphIterator.va(h);if(h.ro()){h.Xc();do a=h.currentNode,v=this.Bk.Tzd(a),a=this.Bk.vJh(a),c.add(v,a),h.Ns();while(36===h.Md)}}}E0f(a,c){this.J6.Ja(a)?this.J6.Z(a,c):this.J6.add(a,c)}D0f(a,c){this.I6.Ja(a)?this.I6.Z(a,c):this.I6.add(a,c)}Jxb(a){r.ULS.shipAssertTag(573400395,336,10===a.type,"Expected node of type Outline but received node of type "+a.type);return a.ia(Yb.a.pea,0)}pdf(a,c,h){const v=1===c;c=!(c%2);switch(h){case 2:if(v){if(a.Ja(2))return a.J(2)}else if(a.Ja(0))return a.J(0);break;
case 3:if(c){if(a.Ja(1))return a.J(1)}else if(a.Ja(0))return a.J(0);break;case 4:if(v){if(a.Ja(2))return a.J(2)}else if(c){if(a.Ja(1))return a.J(1)}else if(a.Ja(0))return a.J(0);break;case 1:if(a.Ja(0))return a.J(0)}return!1}f3e(a,c,h){const v=1===c;c=!(c%2);switch(h){case 2:if(v){if(a.Ja(5))return a.J(5)}else if(a.Ja(3))return a.J(3);break;case 3:if(c){if(a.Ja(4))return a.J(4)}else if(a.Ja(3))return a.J(3);break;case 4:if(v){if(a.Ja(5))return a.J(5)}else if(c){if(a.Ja(4))return a.J(4)}else if(a.Ja(3))return a.J(3);
break;case 1:if(a.Ja(3))return a.J(3)}return!1}}Object(w.a)(dB,"ClientPaginationPageAdornmentContentManager",null,[453]);class hA{constructor(a,c,h,v,B,X){this.IB=a;this.Bk=c;this.Vb=h;this.Fb=v;this.Ujc=B;this.ga=X}Dqn(){const a=new oe.StandardDialog;a.yc=1;a.Nd(1,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogRemoveAllButton);a.yY(0);a.mv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarDeleteDialogMessage,0,Object(m.a)(this,this.obk,"confirmDialogClickActionHandler"))}obk(a){1===
a&&this.IB.OB&&(a=this.Vb.xya(this.IB.OB,8,8),this.Bk.T0j(a)?this.srk(a):this.sqn())}srk(a){a.mc(8);const c=this.Fb.Ob(15);c.set(a.rm.Oh);this.Ujc.hVm(a);this.IB.dismiss();c.dispose();r.ULS.sendTraceTag(4214792,317,50,"{0}",{["RemovedHeadersAndFooters"]:!0})}sqn(){const a=new oe.StandardDialog;a.yc=1;a.Nd(1,Box4Intl.Box4Strings.L_OpenInWord);a.Nd(0,CommonUIStrings.l_Close);a.yY(0);a.mv(CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.L_HeaderToolbarCantDeleteContent,0,Object(m.a)(this,
this.wJn,"unableToDeleteActionHandler"));r.ULS.sendTraceTag(4214793,317,50,"{0}",{["CouldntRemoveHeadersAndFooters"]:!0})}wJn(a){1===a&&this.ga.hb(zb.a.openInClient,2,!1)}}Object(w.a)(hA,"DeleteHeaderFooterDialog",null,[]);class nz{constructor(a,c,h,v,B){this.Bk=a;this.Vb=c;this.Fb=h;this.Ujc=v;this.ga=B}create(a){return new hA(a,this.Bk,this.Vb,this.Fb,this.Ujc,this.ga)}}Object(w.a)(nz,"DeleteHeaderFooterDialogFactory",null,[452]);class xy{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){this.p6=null;this.ga=
a;this.Bk=c;this.Ujc=h;this.KEa=v;this.Kj=B;this.Vb=X;this.Fb=ma;this.Wxj=Pa;this.hgj=mb;this.Obj=Tb}get control(){return this.p6}set control(a){this.p6=a}eb(){this.ga.ka(ba.a.FGd,ic.a.view,Object(m.a)(this,this.xYf,"toggleHeaderFooter"));this.ga.Aa(ba.a.LGf,ic.a.application,Object(m.a)(this,this.bJm,"queryInsertHeaderFooterToggleButton"),96);this.ga.ka(ba.a.c8d,ic.a.view,Object(m.a)(this,this.xYf,"toggleHeaderFooter"));this.ga.ka(ba.a.C_c,ic.a.view,Object(m.a)(this,this.xYf,"toggleHeaderFooter"));
this.ga.Aa(ba.a.aFd,ic.a.view,Object(m.a)(this,this.aFd,"headerFooterContentDirtied"),64);this.ga.ka(ba.a.Rtd,ic.a.view,Object(m.a)(this,this.Rtd,"displayHeaderFooter"));this.ga.Aa(ba.a.jX,ic.a.application,Object(m.a)(this,this.jX,"dismissHeaderFooter"),96);this.ga.Aa(ba.a.hBb,ic.a.application,Object(m.a)(this,this.hBb,"launchHeaderFooterForNode"),96);this.ga.Aa(ba.a.sbn,ic.a.view,Object(m.a)(this,this.Tsa,"setActiveTemplate"),96);this.ga.ka(ba.a.Szi,ic.a.view,Object(m.a)(this,this.Tsa,"setActiveTemplate"));
this.ga.ka(ba.a.Uzi,ic.a.view,Object(m.a)(this,this.Tsa,"setActiveTemplate"));this.ga.ka(ba.a.Tzi,ic.a.view,Object(m.a)(this,this.Tsa,"setActiveTemplate"));this.ga.ka(ba.a.Vzi,ic.a.view,Object(m.a)(this,this.Tsa,"setActiveTemplate"));this.ga.Aa(ba.a.Oen,ic.a.view,Object(m.a)(this,this.mhb,"setTemplateMode"),100);this.ga.Aa(ba.a.xBi,ic.a.view,Object(m.a)(this,this.mhb,"setTemplateMode"),4);this.ga.Aa(ba.a.wBi,ic.a.view,Object(m.a)(this,this.mhb,"setTemplateMode"),4);this.ga.Aa(ba.a.uBi,ic.a.view,Object(m.a)(this,
this.mhb,"setTemplateMode"),4);this.ga.Aa(ba.a.vBi,ic.a.view,Object(m.a)(this,this.mhb,"setTemplateMode"),4);this.ga.ka(ba.a.G_d,ic.a.view,Object(m.a)(this,this.G_d,"setActiveHeaderFooterSection"));this.ga.ka(ba.a.bPf,ic.a.view,Object(m.a)(this,this.G_d,"setActiveHeaderFooterSection"));this.ga.Aa(ba.a.ZDf,ic.a.view,Object(m.a)(this,this.ZDf,"populateHeaderToolbarSectionFlyout"),96);this.ga.Aa(ba.a.RWe,ic.a.view,Object(m.a)(this,this.RWe,"deleteAllHeadersAndFooters"),4);this.ga.Aa(ba.a.Pki,ic.a.view,
Object(m.a)(this,this.CVd,"queryActiveTemplate"),97);this.ga.Aa(ba.a.Rki,ic.a.view,Object(m.a)(this,this.CVd,"queryActiveTemplate"),97);this.ga.Aa(ba.a.Qki,ic.a.view,Object(m.a)(this,this.CVd,"queryActiveTemplate"),97);this.ga.Aa(ba.a.Ski,ic.a.view,Object(m.a)(this,this.CVd,"queryActiveTemplate"),97);this.ga.Aa(ba.a.lli,ic.a.view,Object(m.a)(this,this.xWd,"queryTemplateMode"),97);this.ga.Aa(ba.a.kli,ic.a.view,Object(m.a)(this,this.xWd,"queryTemplateMode"),97);this.ga.Aa(ba.a.ili,ic.a.view,Object(m.a)(this,
this.xWd,"queryTemplateMode"),97);this.ga.Aa(ba.a.jli,ic.a.view,Object(m.a)(this,this.xWd,"queryTemplateMode"),97);this.ga.Aa(ba.a.WIm,ic.a.view,Object(m.a)(this,this.mJm,"querySectionLabel"),97);this.ga.Aa(ba.a.qGf,ic.a.view,Object(m.a)(this,this.BIm,"queryActiveSection"),97)}xYf(a,c,h,v,B){var X=this.Cbf(c);return X?1===h?32:(h=this.control)?(c=this.Fb.Ob(15),c.Oa(X),c.ql=a,h.Y7?this.ga.processAction(ba.a.jX,2):(X=this.pih(X),v.dr=X?1:0,v=a!==ba.a.C_c,(a=this.Y7e(a,B))&&h.Tsa(a),this.ga.hb(ba.a.Rtd,
2,v)),c.dispose(),32):8:8}RWe(a,c,h){if(1===h)return 32;this.Obj.create(this.control).Dqn();return 32}pih(a){const c=this.Bk.$wb(a),h=this.Bk.Wia(c);a=this.KEa.e0e(a,h);this.control.dca(c);return a}bJm(a,c,h,v,B){return 1===h?32:(a=this.control)?(B[Uf.a.On]=a.Y7,32):8}mhb(a,c,h,v,B){if(1===h||!this.control.Y7)return 32;c=this.Lvh(a,B);h=xy.PFh(this.control.OB);v=this.Fb.Ob(15);v.Oa(h);v.ql=a;a=this.Vb.Dj();a.set(h);this.KEa.e0e(a.currentNode,c);this.Bk.fCb(a);this.Ujc.DDi(a,c);v.dispose();return 32}Lvh(a,
c){switch(a){case ba.a.xBi:case ba.a.lli:a=1;break;case ba.a.wBi:case ba.a.kli:a=2;break;case ba.a.uBi:case ba.a.ili:a=3;break;case ba.a.vBi:case ba.a.jli:a=4;break;default:a=c}return a}Tsa(a,c,h,v,B){if(1===h)return 32;a=this.Y7e(a,B);this.control.Y7&&this.control.Tsa(a);return 32}Y7e(a,c){switch(a){case ba.a.Szi:case ba.a.Pki:a=1;break;case ba.a.Uzi:case ba.a.Rki:a=2;break;case ba.a.Tzi:case ba.a.Qki:a=3;break;case ba.a.Vzi:case ba.a.Ski:a=4;break;case ba.a.c8d:case ba.a.C_c:a=c;break;case ba.a.FGd:a=
0;break;default:a=c}return a}G_d(a,c,h,v,B){if(1===h)return 32;a=this.nCh(a,B);v.dr=a;c=this.Cbf(c);if(!c)return 8;v=this.Vb.Dj();v.set(c);v.La(8);v.Kr(8);if(!this.Kj.vfm(v,a))return 8;this.Bk.fCb(v);this.control.dca(v.currentNode);return 32}nCh(a,c){return a===ba.a.bPf||a===ba.a.qGf?parseInt(c.MenuItemId):c}Cbf(a){return this.Kj.Pya(a.lm)}ZDf(a,c,h,v,B){if(1===h)return 32;a=this.Wxj.Glk(this.Cbf(c));B.PopulationXML=a;return 32}xWd(a,c,h,v,B){a=this.Lvh(a,B);c=this.control.OB;h=this.Bk.Wia(c);B[Uf.a.On]=
a===h;1===a&&(B[Uf.a.LabelText]=this.SGh(c)?WordEditorIntl.WordEditorStrings.L_HeaderToolbarEntireSection:WordEditorIntl.WordEditorStrings.L_HeaderToolbarAllPages);return 32}bCn(a,c){switch(c){case 1:return!1;case 2:return 1===a||2===a;case 4:return 4===a||2===a||3===a;case 3:return 4===a||3===a}return!0}CVd(a,c,h,v,B){if(1===h||!this.control.Y7)return 32;c=this.control.OB;void 0!==c&&null!==c&&(c=this.Bk.Wia(c),a=this.Y7e(a,B),h=this.control.BLb,B[Uf.a.Visible]=this.bCn(a,c),B[Uf.a.On]=a===h);return 32}mJm(a,
c,h,v,B){if(1===h||!this.control.Y7)return 32;a=this.control.OB;void 0!==a&&null!==a&&this.qCm(a,B);return 32}qCm(a,c){const h=this.SGh(a);if(c[Qg.a.Visible]=h)a=this.Kj.QFh(this.hgj(a)),a=String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,a),c[Qg.a.LabelText]=a}SGh(a){const c=this.Vb.Dj();c.set(a);c.La(8);c.Kr(8);return 1<this.Kj.WEh(c)}BIm(a,c,h,v,B){if(1===h||!this.control.Y7)return 32;a=this.nCh(a,B);c=this.control.OB;h=0;void 0!==c&&null!==c&&(h=c.getValue(Yb.a.pea));
B[Uf.a.On]=a===h;return 32}jX(a,c,h){if(1===h)return 32;this.control.dismiss();return 32}aFd(){return 32}Rtd(a,c,h,v,B){if(1===h)return 32;this.control.show(B);return 32}hBb(a,c,h,v,B){if(1===h)return 32;if(!B)return 8;c=B.STa;if(!c||!c.isConnected)return 8;a=this.Bk.lvf(c);if(!({isHeader:h,DXf:c}=this.Bk.sEh(c)).returnValue)return 8;this.control.dca(a);this.control.Tsa(c);this.control.show(h,B.y1d);return 32}static PFh(a){const c=new Kd.GraphIterator;c.set(a);c.La(10);return $t.WordSectionNavigator.z4m(c)}}
Object(w.a)(xy,"HeaderFooterActor",null,[]);var SB=b(567),Cx=b(684);class iA{constructor(a,c,h,v,B){this.wnj=a;this.Bk=c;this.Kj=h;this.Vb=v;this.ga=B}bih(a,c){this.Bk.fCb(a);c=this.PBk(a,c);a.ob();return c}e0e(a,c){a=this.Vb.xya(a,8,8);let h=!1;this.Kj.AIa(a,v=>{const B=this.Vb.Dj();B.set(v);h=(v=this.bih(B,c))||h;return v});return h}PBk(a,c){if(3!==this.ga.mode)return!1;let h=!1;c=Cx.a.uXe(c);for(let v=0;v<c.length;++v)h=this.wnj.OBk(a,c[v])||h;return h}}iA.aqk=1;Object(w.a)(iA,"HeaderFooterInserter",
null,[444]);class Qt{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.hFg=this.Nfg=!1;this.OB=null;this.Dne=!1;this.BLb=0;this.i2=a;a.bind(this);this.XEe=v;this.jcj=mb;this.wxg=B;this.ioj=X;this.s4a=ma;this.header=c;this.footer=h;this.header.Omk();this.i2.nz();this.dDe=iA.aqk;this.KEa=Pa;Qt.ga=Tb;this.jL=rc}get Y7(){return this.Nfg}show(a=!0,c=!0){this.Y7||(this.pWi(),this.WAi(!0),this.header.BQm(),this.jcj(),this.Awn(),l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.Hja&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new SB.a,
{state:0,disablePopover:!0}))));(this.hFg=c)&&this.wxg(a)}dismiss(a=!1){this.Y7&&(this.ioj(a),this.WAi(!1),this.Yub(),this.BLb=0,this.Jxn(),l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.Hja&&appChrome.api.dispatch(appChrome.actions.setShyState(Object.assign(new SB.a,{disablePopover:!1}))))}WAi(a){this.Nfg=a;Qt.ga.processAction(zb.a.H3e,2);this.i2.zY(a);this.header.zY(a);this.footer.zY(a);this.XEe()}dca(a){this.OB!==a&&(this.OB=a,this.header.dca(a),this.footer.dca(a),this.BLb=0,this.mhb(this.s4a.Wia(a)))}Yub(){this.OB&&
(this.header.T9a(),this.footer.T9a(),this.OB=null)}update(){this.Y7&&this.j7d()}j7d(){this.OB&&(this.s4a.Uxk(this.OB)&&this.s4a.aul(this.OB)?this.pWi():this.dismiss())}pWi(){const a=this.s4a.Wia(this.OB);a!==this.dDe&&this.mhb(a)}mhb(a){this.dDe=a;this.Tsa(this.Fil(a))}Fil(a){switch(a){case 2:return 2;case 3:return 3;case 4:return 2}return 1}Tsa(a,c=!0){this.BLb!==a&&(this.KEa.e0e(this.OB,this.dDe),this.header.Rzi(a),this.header.TUg(If.AppFrame.D8),this.footer.Rzi(a),this.footer.TUg(If.AppFrame.h8),
this.BLb=a,this.Y7&&this.hFg&&this.tCk(c))}tCk(a){this.wxg(a);a?this.header.setInitialSelection():this.footer.setInitialSelection()}dispose(){this.i2.O5();this.header.dispose();this.footer.dispose()}Awn(){this.jL.pld(Object(m.a)(this,this.JCb,"onContentDirtied"));this.Dne=!1}Jxn(){this.jL.FKf(Object(m.a)(this,this.JCb,"onContentDirtied"));this.Dne&&Qt.ga.processAction(ba.a.aFd,2)}JCb(){this.Dne=!0}static vvk(){Qt.ga.hb(Sa.a.Gbb,2,!0);Qt.ga.processAction(ba.a.Vba,2)}}Qt.ga=null;Object(w.a)(Qt,"HeaderFooterControl",
null,[480,14]);class eB{constructor(a,c,h,v,B){this.XEe=a;this.s4a=c;this.KEa=h;this.ga=v;this.jL=B}create(a,c,h,v,B){return new Qt(a,c,h,this.XEe,v,B,this.s4a,this.KEa,Qt.vvk,this.ga,this.jL)}}Object(w.a)(eB,"Factory",null,[451]);class fB{constructor(){this.p6=null}get control(){return this.p6}set control(a){this.p6=a}q4e(a){return this.r4e(this.control.OB,this.control.BLb,a.isHeader,a)}r4e(a,c,h,v){return()=>{if(!a.isConnected)return null;this.control.dca(a);this.control.Tsa(c);this.control.show(h);
return v}}dismiss(){this.p6.Y7&&this.p6.dismiss()}}Object(w.a)(fB,"HeaderFooterControlLauncher",null,[]);var oz=b(559),TB=b(1006),ln=b(332),Zu=b(732);class iw{constructor(a,c,h){this.mcc=null;const v=c?"Header":"Footer";this.Wp=a.ownerDocument.createElement("div");this.Wp.id=c?"HeaderPane":"FooterPane";this.Wp.classList.add(iw.dul,v);this.qrb=(new Zu.a(this.Wp,"WACViewPanel_"+v)).QC;this.Wp.appendChild(this.qrb);a.appendChild(this.Wp);c&&(this.mcc=a.ownerDocument.createElement("div"),this.mcc.classList.add(iw.jul),
this.Wp.appendChild(this.mcc));this.D9f=h.u$k(this.Wp)}bind(){}zY(a){a?this.D9f.ZLj():this.D9f.aMj()}CTj(a){a.q8a(this.qrb)}}iw.jul="HeaderToolbarContainer";iw.dul="HeaderFooterPane";Object(w.a)(iw,"PaneControlDom",null,[508]);class xv{constructor(a,c,h,v,B){this.IB=this.Vo=null;this.Wp=a.ownerDocument.createElement("div");this.Wp.id=xv.J6g;this.Wp.className=xv.J6g;this.pu=v;this.uW=B;this.tJh=new iw(this.Wp,!0,c);this.skk(this.Wp);this.Lnh=new iw(this.Wp,!1,c);this.zY(!1);a.appendChild(this.Wp)}skk(a){this.Vo=
a.ownerDocument.createElement("div");this.Vo.id=xv.Fwm;this.Vo.className=xv.Dwm;this.Vo.tabIndex=0;this.Vo.setAttribute(we.a.tg,we.a.v_);this.Vo.setAttribute(we.a.oba,WordEditorIntl.WordEditorStrings.L_HeaderFooterOverlayAccessibleText);a.appendChild(this.Vo)}bind(a){this.IB=a}zY(a){if(!a&&this.pu){var c=new Pg.a(!0);this.pu.qBa(c)}!a&&this.uW&&(c=new Pg.a(!0),this.uW.qBa(c));this.Wp.style.display=a?"":"none";this.tJh.zY(a);this.Lnh.zY(a)}den(){this.Vo.focus()}nz(){oi.a.instance.Ea(Jb.a.click,this.Vo,
Object(m.a)(this,this.Mbi,"onOverlayClick"));ah.a.instance.Ea(Jb.a.Lv,this.Wp,Object(m.a)(this,this.gE,"onMouseDown"))}O5(){oi.a.instance.xb(Jb.a.click,this.Vo,Object(m.a)(this,this.Mbi,"onOverlayClick"));ah.a.instance.xb(Jb.a.Lv,this.Wp,Object(m.a)(this,this.gE,"onMouseDown"))}Mbi(){this.IB.dismiss(!0);if(this.uW){let a=new Pg.a(!0);this.uW.qBa(a)}return!0}gE(a){a.Sa.preventDefault();return!1}}xv.J6g="HeaderFooterControl";xv.Fwm="HeaderFooterOverlay";xv.Dwm="EditingSurfaceOverlay HeaderFooterOverlay";
Object(w.a)(xv,"HeaderFooterControlDom",null,[479]);class pz{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){this.i2=null;this.ma=new Rd.a;this.IB=this.vfd=null;this.fb=a;this.Dn=c;this.tzg=h;this.Jgj=v;this.aqj=B;this.ga=X;this.odg=oz.a.create();this.hhg=qc.KeyInputManager.mb(vb.a.Nq,0);this.tW=qc.KeyInputManager.mb(vb.a.V5,0);this.Rvj=qc.KeyInputManager.mb(vb.a.gOa,0);this.hG=ma;this.qa=Pa;this.pu=mb;this.uW=Tb;this.ee&&this.ee.aha(Object(m.a)(this,this.pTd,"pageViewOnScrolledEvent"))}lQg(a){this.ma.addHandler("OnShowEventKey",
a)}wYm(a){this.ma.removeHandler("OnShowEventKey",a)}rld(a){this.ma.addHandler("OnDismissEventKey",a)}Mri(a){this.ma.removeHandler("OnDismissEventKey",a)}get ee(){const a=this.hG.value;return a?a.Rh?a:(r.ULS.sendTraceTag(25474004,317,10,"_lazyPageView.Value is not a page view in HeaderFooterControlOwner."),null):(r.ULS.sendTraceTag(25474003,317,10,"_lazyPageView.Value is null in HeaderFooterControlOwner."),null)}get control(){return this.IB}get pdk(){return this.odg}bind(a){this.IB=this.Rbk(a);this.odg.instance=
this.IB}Rbk(a){this.i2=new xv(a,this.aqj.value,this.qa,this.pu,this.uW);a=this.tzg.value.create(this.ga,this.i2.tJh,!0,If.AppFrame.D8);const c=this.tzg.value.create(this.ga,this.i2.Lnh,!1,If.AppFrame.h8);this.IB=this.Jgj.value.create(this.i2,a,c,Object(m.a)(this,this.Oyf,"onHeaderFooterShow"),Object(m.a)(this,this.Nyf,"onHeaderFooterDismiss"));this.Lff();this.KQ();return this.control}Lff(){var a=3===this.ga.mode?If.AppFrame.iC:If.AppFrame.TRc;const c=this.fb.fd(If.AppFrame.D8);c.parent=a;this.fb.pHe(If.AppFrame.D8);
const h=this.fb.fd(If.AppFrame.h8);h.parent=a;this.fb.pHe(If.AppFrame.h8);a=this.fb.fd(ln.a.tyb);a.parent=Fc.AFrame.uo;a.iba(()=>{this.i2.den()});a.bindAction(this.hhg,ba.a.jX);a.bindAction(this.tW,ba.a.jX);a.bindAction(this.Rvj,ba.a.jX);c.bindAction(this.tW,ba.a.jX);h.bindAction(this.tW,ba.a.jX)}KQ(){this.Dn.KQ(If.AppFrame.D8);this.Dn.KQ(ln.a.IWa);this.Dn.KQ(If.AppFrame.h8);this.Dn.KQ(ln.a.tyb)}Oyf(a){this.o5(a);this.ma.raiseEvent("OnShowEventKey")}o5(a){this.Dn.YB(If.AppFrame.D8);this.Dn.YB(ln.a.IWa);
this.Dn.YB(If.AppFrame.h8);this.Dn.YB(ln.a.tyb);this.Dn.Bv(Fc.AFrame.Mp);this.fb.Atc(If.AppFrame.D8);this.fb.Atc(If.AppFrame.h8);a?this.fb.Kf(If.AppFrame.D8):this.fb.Kf(If.AppFrame.h8)}Nyf(a){this.ee&&(this.vfd=new TB.a(this.ee));this.fb.Yyc(If.AppFrame.D8);this.fb.Yyc(If.AppFrame.h8);this.Z9(a);this.ma.raiseEvent("OnDismissEventKey")}Z9(a){this.Dn.Bv(If.AppFrame.D8);this.Dn.Bv(ln.a.IWa);this.Dn.Bv(If.AppFrame.h8);this.Dn.Bv(ln.a.tyb);this.Dn.YB(Fc.AFrame.Mp);(a||this.fb.nf&&(this.fb.nf.name===If.AppFrame.D8||
this.fb.nf.name===ln.a.IWa||this.fb.nf.name===If.AppFrame.h8||this.fb.nf.name===ln.a.tyb))&&this.fb.Kf(Fc.AFrame.Mp)}pTd(){this.vfd&&(this.vfd.dispose(),this.vfd=null)}dispose(){const a=this.fb.fd(ln.a.tyb);a.Bp(this.hhg);a.Bp(this.tW);this.fb.fd(If.AppFrame.D8).Bp(this.tW);this.fb.fd(If.AppFrame.h8).Bp(this.tW);this.ee&&this.ee.nYd(Object(m.a)(this,this.pTd,"pageViewOnScrolledEvent"));this.control.dispose()}}Object(w.a)(pz,"HeaderFooterControlOwner",null,[449,450]);var jA=b(978);class gB{constructor(a,
c,h,v,B,X){this.Bk=a;this.Vb=c;this.zpj=h;this.Ck=v;this.Cpj=B;this.Lgj=X}JCl(a,c){const h=this.Vb.Dj();h.set(a);this.Bk.gCb(h,c);this.zpj(h);this.Cpj(h.currentNode,this.Ck);this.Lgj.KCl(h,jA.a(c))}}Object(w.a)(gB,"HeaderFooterDefaultContentInserter",null,[448]);class $o{constructor(a,c,h,v,B,X,ma,Pa){this.CQ=a;this.Pwj=c;this.Uce=h;this.Ck=v;this.Bpj=B;this.ovj=X;this.zgj=ma;$o.Vd=Pa}KCl(a,c){this.Pwj(a,1,3,null,!1);this.CQ.DVc(hw.a.W_c,1696,a.currentNode);this.Uce(a,0,this.Ck?3:1,c);this.Uce(a,
1,2,c);this.Uce(a,2,this.Ck?1:3,c);this.Bpj(a);this.ovj(a,!1,!0,null);this.zgj(a,c)}static get BB(){return $o.XB||($o.XB=xa.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get paragraphEditor(){return $o.kh||($o.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}static ocn(a,c,h){Fe.moveToCellContent(a,0,c);ie.OutlineElementNavigator.Fd(a);$o.BB.EVc(Box4Intl.Box4Strings.L_StyleWordHeader,a.currentNode);$o.paragraphEditor.vB(a.currentNode,h);c||$o.paragraphEditor.Zn.Xsa(a,1,-115);2===c&&
$o.paragraphEditor.Zn.XFb(a.currentNode,1,-115);Fe.returnToContainingTable(a)}static Men(a,c){ie.OutlineElementNavigator.Fd(a);$o.BB.EVc(c?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,a.currentNode);ie.OutlineElementNavigator.Wc(a)}static kUk(){return(a,c,h)=>{$o.ocn(a,c,h)}}static Z1k(){return(a,c)=>{$o.Men(a,c)}}static Uhl(a){return(c,h,v,B,X)=>a.nxa(c,h,v,B,X)}static cgl(){return(a,c,h,v,B)=>$o.Vd.bA(a,c,h,v,B)}}$o.XB=null;$o.kh=null;$o.Vd=null;Object(w.a)($o,"HeaderFooterDefaultTableInserter",
null,[447]);class yy{constructor(a,c,h,v){this.Bk=a;this.BPb=c;this.Vb=h;this.Kj=v}DDi(a,c){a.rm.properties.setValue(Yb.a.Ucf,2===c||4===c);a.La(8);a.b_c(8).properties.setValue(Yb.a.MEd,3===c||4===c)}hVm(a){this.Kj.AIa(a,c=>{const h=this.Vb.Dj();h.set(c);this.Bk.fCb(h);this.DDi(h,1);this.iVm(h);return!0})}iVm(a){for(;a.Xc();)a.xf()}}Object(w.a)(yy,"HeaderFooterEditor",null,[445]);var qz=b(981);class rz extends zr.a{constructor(a){super();this.ZEe=a}get index(){return 0}run(){this.ZEe()}$tl(a,c){c.property===
Yb.a.Ucf&&this.YI()}bxm(a,c){c.property===Yb.a.MEd&&this.YI()}YI(){this.gY()}}Object(w.a)(rz,"ControlUpdateNeededTracker",zr.a,[]);class Dx{constructor(a,c,h,v,B,X){this.e3a=null;this.Kgj=h;this.q7c=c;this.mNb=a;this.Ppj=v;this.CFa=X}start(){this.mNb.bind(Eb.App.oa.vA);this.q7c.control=this.mNb.control;this.q7c.eb();this.Kgj.control=this.mNb.control;this.Ppj.value.create(this.mNb.control,Object(m.a)(this.q7c,this.q7c.pih,"ensureSectionHeaderFooterAttachedToControl")).eb();this.xvl()}xvl(){this.e3a=
new rz(()=>{this.mNb.control.update()});const a=Eb.App.aj.Pk;a.Yd(35).Yl(Object(m.a)(this.e3a,this.e3a.$tl,"headerFooterContainerNodePropertyChanged"));a.Yd(8).Yl(Object(m.a)(this.e3a,this.e3a.bxm,"pageContentNodePropertyChanged"));qz.a.CXd(Object(m.a)(this.e3a,this.e3a.YI,"setUpdateNeeded"));Wo.GraphTransactionManager.instance.Usa(this.e3a,3)}dispose(){this.mNb.dispose();this.CFa.eeh()}}Object(w.a)(Dx,"HeaderFooterManager",null,[]);class Ex{constructor(a,c,h,v){this.Kj=a;this.Bk=c;this.vnj=h;this.Pfe=
v}OBk(a,c){let h=!1;const v=Cx.a.u9e(c);a.pp(v)||(this.SCl(a,c),this.Pfe.JCl(a.currentNode,c),h=!0);return h}SCl(a,c){const h=this.vnj.create(1074135123),v=a.currentNode.ia(Yb.a.pea,0);h.properties.setValue(Yb.a.pea,v);h.properties.setValue(Yb.a.B0b,c);c=Cx.a.u9e(c);a.Je(h,c)}}Object(w.a)(Ex,"HeaderFooterNodeLevelInserter",null,[442]);var zy=b(1312),hB=b(1335);class Xs extends zy.a{constructor(a,c,h){super(a,c,"","");this.Nob=null;this.EJh=Xs.ybh;this.kGc=[];this.ale=h}get By(){return!0}get cssClass(){return"cui-herodock"}Yk(){this.vQm();
super.Yk()}iIa(){for(const a of this.kGc)a.Uud();super.iIa()}Avn(){let a,c,h;a=[];c=[];h=[];for(let v=0;v<this.kGc.length;v++){const B=this.kGc[v];B.visible?a.length<this.EJh?a.push(B):Object(Ub.a)(hB.FlyoutAnchor,B)?Array.addRange(c,B.VWk()):c.push(B):h.push(B)}return{NEn:a,Bwm:c,AFl:h}}rkk(a){if(!a||!a.length)return null;const c=new na.Menu(this.root,this.id+"OverflowMenu",null,null,null),h=new Nn.a(this.root,this.id+"OverflowMenuSection",null,null,{DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},
c);for(const v of a)h.Je(v.ZN("Menu20"));c.Je(h);return c}vQm(){this.VXd();this.Hb=Zd.a.vMa(this.Hb);this.Xz();var a;({NEn:h,Bwm:a,AFl:v}=this.Avn());for(var c of h){var h=c.ZN("Medium20");h.enabled=!0;this.aTb(h,this.children.count);this.Hb.appendChild(h.Hb);h.jia()}if(a=this.rkk(a))this.Nob?this.Nob.menu=a:(c=this.id+"OverflowMenuLauncher",h={},h.Image20by20=this.ale.OverflowMenuImage20by20,h.Image20by20Class=this.ale.OverflowMenuImage20by20Class,h.PopulateDynamically="false",h.HideDefaultArrow=
"true",h.Alt=this.ale.OverflowMenuTooltip,h.Command="798637440",h.Id=c,this.Nob=new hB.FlyoutAnchor(this.root,c,h,a)),a=this.Nob.ZN("Small20"),a.enabled=!0,this.aTb(a,this.children.count),this.Hb.appendChild(a.Hb),a.jia();if(l.AFrameworkApplication.K.$("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(const B of v){var v=B.ZN("Medium20");this.Je(v);v.jia()}}dispose(){this.Nob&&(this.Nob.dispose(),this.Nob=null);for(const a of this.kGc)a.dispose();this.VXd();super.dispose()}set By(a){super.By=
a}}Xs.ybh=4;Object(w.a)(Xs,"HeroDock",zy.a,[]);var Ay=b(1368);class Fx extends Ay.a{constructor(){super();this.R3d=this.YOl=this.lxn=!1;this.ebm=l.AFrameworkApplication.pkf?1:Xs.ybh}}Object(w.a)(Fx,"ToolbarBuildOptions",Ay.a,[]);var Ii=b(1328),UB=b(1389),By=b(1408);class Vw extends zy.a{constructor(a,c,h){super(a,c,"","");this.Uec=h.Alignment;this.qgg=h.ScalingDirection===Ii.a.w1i}Yk(){this.Qpa();this.mU(this.Hb);super.Yk()}mU(a){for(let c of this.children){c.Xz();switch(this.Uec){case Ii.a.y9d:Zd.a.ze(c.Hb,
"cui-toolbar-button-left");break;case Ii.a.R1a:Zd.a.ze(c.Hb,"cui-toolbar-button-center");break;case Ii.a.EJb:Zd.a.ze(c.Hb,"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this.Uec);}c.visible&&a.appendChild(c.Hb);c.jia()}}mM(a){if(!Object(Ub.a)(Kj.a,a))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.");}get cssClass(){switch(this.Uec){case Ii.a.y9d:return"cui-toolbar-buttondock alignleft";case Ii.a.R1a:return"cui-toolbar-buttondock aligncenter";
case Ii.a.EJb:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this.Uec);}}get By(){return!0}get alignment(){return this.Uec}d0b(){let a=0;if(this.alignment===Ii.a.R1a)for(let c of this.children){const h=c;h.visible&&(a+=h.Hb.offsetWidth)}else a=this.Hb.offsetWidth;return a}kCd(){let a=null;if(this.alignment===Ii.a.R1a)for(let c of this.children){if(c.visible){a=Sys.UI.DomElement.getBounds(c.Hb);break}}else a=Sys.UI.DomElement.getBounds(this.Hb);return a?0===this.root.NY?
a.x:a.x+a.width:0}tzd(){let a=null;if(this.alignment===Ii.a.R1a){if(0<this.children.count){const c=this.children.uzd(this.children.count-1);for(;c.SYa();){const h=c.get_current();if(h.visible){a=Sys.UI.DomElement.getBounds(h.Hb);break}}}}else a=Sys.UI.DomElement.getBounds(this.Hb);return a?0===this.root.NY?a.x+a.width:a.x:0}Z_e(){for(let a of this.children){const c=a;if(!Object(Ub.a)(Kj.a,c)||c.control.visible)c.visible=!0}}I7m(a){const c=this.children.toArray(),h=new By.a;let v=this.qgg?0:c.length-
1;const B=this.children.count,X=this.root.CNa;for(;this.d0b()>=a&&!(v>=B||0>v);){const ma=c[v];X&&Object(Ub.a)(Kj.a,ma)&&ma.control.visible&&(h.add(ma),ma.hTg());v+=this.qgg?1:-1}for(let ma of h)ma.uqi(),ma.visible=!1}set By(a){super.By=a}}Object(w.a)(Vw,"ButtonDock",zy.a,[]);class Cy extends zf.a{constructor(a,c,h,v,B,X,ma=!1){super(a,c,X);this.Sma=this.cW=this.Hga=null;this.Yse=!1;this.VXa=v;this.R3d=B;this.wid=0;De.c(c.Size)||(c.Size===Ii.a.c6f||h.options.YOl?this.wid=0:c.Size===Ii.a.X3i&&(this.wid=
1));this.Xxj=ma}get CNa(){return!0}Je(a){super.Je(a);Object(Ub.a)(Vw,a)&&!this.Yse&&(a.alignment===Ii.a.y9d?(this.Hga&&this.tQf(),this.Hga=a):a.alignment===Ii.a.R1a?(this.cW&&this.tQf(),this.cW=a):a.alignment===Ii.a.EJb&&(this.Sma&&this.tQf(),this.Sma=a))}tQf(){this.Yse=!0;this.Sma=this.cW=this.Hga=null}Ugb(a,c){a=this.eDc(a);De.c(a)||a.visible===c||(a.visible=c,this.refresh())}Yk(){super.Yk();this.poi(!0)}poi(a){const c=this.root.Ntb;De.c(this.Hb)&&this.Pmk();this.Hb=Zd.a.vMa(this.Hb);this.lGc&&
this.Hb.appendChild(this.lGc);for(let h of this.children)h.visible&&(h.Xz(),this.Hb.appendChild(h.Hb),h.jia());this.cW&&a&&this.pBk();c&&c.IV();this.dirty=!1}pBk(){if(this.cW.visible&&this.cW.children.count&&(this.tTg(0,0),this.Sxk(this.Hga,this.cW,this.Sma))){let a=0,c=0;const h=this.Hga?this.Hga.d0b():0,v=this.Sma?this.Sma.d0b():0;if(0<v||0<h)v>h?(a=0,c=v-h):(a=h-v,c=0);this.tTg(a,c)}}Sxk(a,c,h){let v=!1;0===this.root.NY?(a&&(v=a.tzd()>c.kCd()),!v&&h&&(v=c.tzd()>h.kCd())):(a&&(v=a.tzd()<c.kCd()),
!v&&h&&(v=c.tzd()<h.kCd()));return v}tTg(a,c){0===this.NY?(this.cW.Hb.style.marginLeft=a+"px",this.cW.Hb.style.marginRight=c+"px"):(this.cW.Hb.style.marginRight=a+"px",this.cW.Hb.style.marginLeft=c+"px")}Pmk(){this.Xz()}ps(){this.Seh(()=>{Xo.a.prototype.ps.call(this)})}lS(a){a=this.eDc(a);De.c(a)||this.Seh(Object(m.a)(a,a.yk,"pollForStateAndUpdate"))}Seh(a){this.L5b=this.UYa=!1;a();if(this.UYa||this.L5b)this.Xxj||this.refresh(),this.scale()}mM(a){if(!Object(Ub.a)(Xs,a)&&!Object(Ub.a)(Vw,a))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");
if(Object(Ub.a)(Vw,a)&&a.alignment===Ii.a.R1a)for(let c of this.children)if(c.alignment===Ii.a.R1a)throw Error.create("Can't add a centered buttondock because one is already present.");}get cssClass(){let a="cui-toolbar-toolbar ";0===this.wid?(a+="cui-toolbar-onerow ",l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.s4||(a+="UITextTranformUpperCase ")):1===this.wid&&(a+="cui-toolbar-singledock ");return a+super.cssClass}get Kpa(){return"div"}get g5(){return 26}get cPi(){return this.WL}set cPi(a){this.WL=
a}rgk(a){a=a[Ii.a.Eu];return new Vw(this.root,a.Id,a)}Xz(){super.Xz();this.Hb.setAttribute("role","toolbar");this.properties.Title&&this.Hb.setAttribute("title",this.properties.Title)}UCa(a){return this.root&&this.root.H8b(a)?!0:!1}gen(){this.XMa()}scale(){super.scale();if(!Zd.a.oq(this.properties.Scale)||this.Yse)return!1;De.c(this.Hga)||(this.Hga.visible=!0,this.Hga.Z_e());De.c(this.cW)||(this.cW.visible=!0,this.cW.Z_e());De.c(this.Sma)||(this.Sma.visible=!0,this.Sma.Z_e());this.poi(!1);const a=
this.Hb.offsetWidth,c=De.c(this.Hga)?0:this.Hga.d0b(),h=De.c(this.cW)?0:this.cW.d0b(),v=De.c(this.Sma)?0:this.Sma.d0b();v+h+c>=a&&(v+c>=a?(this.IJh(this.cW),v>=a?(this.IJh(this.Hga),this.NNf(this.Sma,a)):this.NNf(this.Hga,a-v)):this.NNf(this.cW,a-v-c));this.UYa=!1;this.Yk();return!1}IJh(a){a&&(a.visible=!1)}NNf(a,c){a&&a.I7m(c)}}Object(w.a)(Cy,"Toolbar",zf.a,[828]);class $u extends Cy{constructor(a,c,h,v,B=!1){super(a,c,h,!1,!1,v,B);this.Osg=!0}get g5(){return 7}get cssClass(){return $u.mxn+" "+super.cssClass}static get mxn(){let a=
"cui-statusbar";l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.s4||(a+=" UISmallFont UITextTranformUpperCase");return a}}Object(w.a)($u,"StatusBar",Cy,[]);var kA=b(1341);class Gx extends kA.a{constructor(){super();this.toolbar=null;this.mKd=!1}}Object(w.a)(Gx,"ToolbarBuildContext",kA.a,[]);class lA extends dc.Builder{constructor(a,c,h,v){super(a,c,nl.Task.T3(h),v);if(De.c(c))throw Error.create("Toolbar placeholder DOM element is null or undefined.");}get toolbar(){return this.root}yRf(a){this.root=
a}get EYf(){return this.options}LYj(){const a=new Gx,c=new UB.a;c.id="toolbar";c.zRc=1;c.handler=Object(m.a)(this,this.Xrm,"onReturnToolbarData");c.data=a;this.Cpa.LZd(c)}Xrm(a){this.yRf(this.NYj(a.RQc,a.Kxc));this.toolbar.cPi=this;this.toolbar.Yk();this.placeholder.appendChild(this.toolbar.Hb);Zd.a.ze(this.placeholder,"loaded");this.Voa.continueWith(()=>{this.Voa.result.ICb(this.toolbar)},11)}NYj(a,c){var h=Ii.a.m0(a,Ii.a.E4i);De.c(h)&&(h=Ii.a.m0(a,Ii.a.d4i),c.mKd=!0);if(De.c(h))throw Error.create("No toolbar element was present in the data");
a=new Ii.a(h);h=l.AFrameworkApplication.K.$("ToolbarScalingRedundancyEliminationIsEnabled");c.mKd?this.yRf(new $u(a.attributes[Ii.a.id],a.attributes,this,this.V6,h)):this.yRf(new Cy(a.attributes[Ii.a.id],a.attributes,this,this.EYf.lxn,this.EYf.R3d,this.V6,h));this.toolbar.$oa=this.options.$oa;this.toolbar.H7d=!0;this.toolbar.Yk();a=Ii.a.Ls(Ii.a.m0(a.node,Ii.a.h1i));c=this.JVj(a,c);for(const v of c)this.toolbar.Je(v);return this.toolbar}JVj(a,c){const h=[];for(let v=0;v<a.length;v++)this.mKa(a[v])||
Array.add(h,this.sWj(a[v],c));return h}sWj(a,c){const h=Ii.a.iEc(a);let v=null;h===Ii.a.W_i?v=this.VVj(a,c):h===Ii.a.K1i&&(v=this.RWj(a,c));return v}RWj(a,c){var h=new Ii.a(a);h=new Xs(this.root,h.attributes[Ii.a.id],a[Ii.a.Eu]);h.EJh=this.EYf.ebm;a=Ii.a.m0(a,Ii.a.S1a);a=Ii.a.Ls(a);const v=[];for(let X=0;X<a.length;X++){var B=a[X];this.mKa(B)||(B=this.G_(B,c),Array.add(v,B))}h.kGc=v;return h}VVj(a,c){new Ii.a(a);const h=this.toolbar.rgk(a);a=Ii.a.m0(a,Ii.a.S1a);a=Ii.a.Ls(a);for(let v=0;v<a.length;v++){if(this.mKa(a[v]))continue;
const B=this.MYj(a[v],c);h.Je(B)}return h}MYj(a,c){var h=new Ii.a(a);const v=h.name;h=h.attributes[Ii.a.$dc];let B;B=c.mKd?"Small14":"Small";switch(v){case Ii.a.button:return a=this.G_(a,c),a.ZN(De.b(h)?B:h);case Ii.a.bqa:return B=c.mKd?"Medium14":"Medium",a=this.G_(a,c),a.ZN(De.b(h)?B:h);case Ii.a.label:return a=this.G_(a,c),a.ZN(De.b(h)?B:h);case Ii.a.separator:return a=this.G_(a,c),a.ZN("Small");case Ii.a.toggleButton:return a=this.G_(a,c),a.ZN(De.b(h)?B:h);default:throw Error.create("Invalid control type.");
}}}Object(w.a)(lA,"ToolbarBuilder",dc.Builder,[]);var mA=b(1794);class Dy{constructor(a,c,h,v,B,X){this.ZF=a;a=new bk.CuiHelper(uk.a.z8a,WordEditorIntl.WordEditorStrings,null,null,[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings]);v=new Fx;v.vE={};X=3!==X.mode;v.vE.HeaderToolbarControlsRight=X;v.vE.HeaderToolbarButtonDockRight=X;v.vE.HeaderToolbarButtonRemovePageNumbers=X;B=new lA(v,this.ZF,this,B);B.Cpa=new mA.a(Dy.kul,a);B.LYj();this.Rga=B.toolbar;h.execute(ma=>{this.toolbar.GC=ma});this.toolbar.refresh();
this.toolbar.yk();this.xg=c;c.RSa(Object(m.a)(this,this.Neb,"onCommandUiUpdateHandler"))}get toolbar(){return this.Rga}Neb(){this.toolbar.yk()}dispose(){this.xg.W8b(Object(m.a)(this,this.Neb,"onCommandUiUpdateHandler"));this.toolbar&&(this.toolbar.dispose(),this.Rga=null)}refresh(){this.toolbar.refresh()}setFocus(){this.toolbar.gen()}uvk(){this.toolbar.U_()}ICb(){}}Dy.kul="WordEditorHeaderToolbarData";Object(w.a)(Dy,"HeaderFooterToolbar",null,[140,476]);class sz{constructor(a,c,h,v,B){this.xg=a;this.efe=
c;this.Na=h;this.V6=v;this.ga=B}create(a){return new Dy(a,this.xg,this.efe,this.Na,this.V6,this.ga)}}Object(w.a)(sz,"Factory",null,[443]);class Gh{constructor(a,c){this.Vb=a;this.Kj=c}Glk(a){return'<Menu Id="HeaderToolbarSectionMenu"><MenuSection Id="HeaderToolbarSectionSection" DisplayMode="Menu16"><Controls Id="HeaderToolbarSectionControls">'+this.Flk(a)+"</Controls></MenuSection></Menu>"}I1k(a){const c=this.Vb.Dj();c.set(a);c.La(8);c.mc(8);return c}Flk(a){if(!a)return"";let c="";a=this.I1k(a);
this.Kj.AIa(a,h=>{const v=this.Kj.QFh(h);h=h.getValue(Yb.a.pea);c+=jf.p(h.toString(),h.toString(),ba.a.bPf.toString(),ba.a.qGf.toString(),String.format(WordEditorIntl.WordEditorStrings.L_HeaderToolbarSectionButtonLabel,v));return!0});return c}}Object(w.a)(Gh,"HeaderFooterToolbarGenerator",null,[441]);var iB=b(108);class Ey extends ny.a{constructor(a,c,h,v,B,X,ma){super(a,c,h);this.hg=null;this.ZF=a.container;this.ku=document.createElement("div");this.rz(this.ku);this.uva=v;this.CEa=B;this.gm.execute(Pa=>
{Pa.Z4(Object(m.a)(this,this.Gq,"onZoomChanged"))});this.QE=X;if(this.AW=ma)this.ZF.style.backgroundColor=this.QE.o_b()}dispose(){super.dispose();this.gm.instance&&this.gm.instance.ngb(Object(m.a)(this,this.Gq,"onZoomChanged"))}get gm(){return this.hg||(this.hg=xa.a.instance.za("Common.IZoomManager"))}Az(a){this.ZF.classList.add("HeaderFooterViewElement");this.ku.classList.add("HeaderFooterViewContent");this.xZc(a.currentNode)}R5(a){this.ku.parentNode&&this.ku.parentNode===this.ZF||(this.ZF.appendChild(this.ku),
this.CEa.instance&&this.CEa.instance.BRf(this.kb,this.ZF));super.R5(a)}gjb(a){iB.a.$c(()=>{iB.a.prototype.gjb.call(this,a);this.STi();this.CEa.instance&&this.CEa.instance.bTi(this.kb,this.ku.style.paddingLeft,this.ku.style.paddingTop)},"HFVE:UFO")}Gq(){this.xZc(this.Ia)}xZc(a){this.gm.instance&&this.gm.instance.d0c(this.ku);this.STi();a=this.uva.M_b(a);this.ku.style.paddingLeft=a.eWb+"px";this.ku.style.width=a.Jxc+"px";this.CEa.instance&&this.CEa.instance.bTi(this.kb,this.ku.style.paddingLeft,this.ku.style.paddingTop)}STi(){if(this.gm.instance){this.ku.style.paddingTop=
"";var a=al.a.Zz(this.ku);a.paddingTop&&(a=ye.a.FK(a.paddingTop),this.ku.style.paddingTop=Math.round(a/this.gm.instance.ei)+"px")}}}Object(w.a)(Ey,"HeaderFooterViewElement",ny.a,[]);class Fy{constructor(a,c,h,v){this.uva=a;this.CEa=c;this.QE=h;this.AW=v}create(a,c,h){return new Ey(a,c,h,this.uva,this.CEa,this.QE,this.AW)}}Object(w.a)(Fy,"Factory",null,[446]);var Ho=b(383),VB=b(177),WB=b(859),XB=b(539);class jB extends Ho.a{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh){super(c,X,ma,
Pa,mb,VB.a.ief,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh);this.isHeader=this.isHeader=a;this.yRa=B;this.yRa.VXc=this;v(this);this.v3c=h;this.Bua=document.createElement("div");this.Bua.setAttribute("Unselectable","on");this.Bua.setAttribute("hideselection","hideselection");this.Bua.setAttribute("style","outline:none;");this.Bua.innerText=WordEditorIntl.WordEditorStrings.l_HeaderFooterNoContentAvailableMessage;this.Bua.tabIndex=0;this.features.LGi=!0;this.features.xOe=!0}get qjf(){return!0}tbf(){const a=this.v3c.q4e(this);
return WB.ViewReference.MD(a)}lYe(a){Object(Ub.a)(jB,a)||this.v3c.dismiss()}get sdf(){return"WordEditor"+(this.isHeader?"Header":"Footer")+"HiddenLabel"}JEc(){return XB.a.O5h}onResize(){super.onResize();this.yRa.oih()}NA(a,c=null){this.Bua.parentNode&&this.Bua.parentNode.removeChild(this.Bua);super.NA(a,c);this.yRa.aih(this.sc.Oh)}detach(){this.yRa.nih();super.detach();this.Bua.parentNode||this.container.insertBefore(this.Bua,this.container.firstChild)}zVc(){this.jr?super.zVc():this.Bua.focus()}Fxd(){this.onResize()}}
Object(w.a)(jB,"HeaderFooterView",Ho.a,[474,182,183,70,14,111,184,185,186]);class YB{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe){this.v3c=a;this.Mzj=c;this.Lzj=h;this.Fs=v;this.Rb=B;this.Tga=X;this.ga=ma;this.fQa=Pa;this.koa=mb;this.X2=Tb;this.qAj=rc;this.Ft=Tc;this.iu=vd;this.$d=ee;this.Rf=Ie;this.o3c=Xe}create(a,c){return new jB(a,c,this.v3c,this.Mzj,this.Lzj(),this.Fs,this.Rb,this.Tga,this.ga,this.fQa,this.koa,this.X2,this.qAj,this.Ft,this.iu,this.$d,this.Rf,this.o3c)}}Object(w.a)(YB,
"Factory",null,[440]);class nA{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh){this.gzg=!1;this.CGg="SourceControlId";this.hDn=1;this.iDn=1E3;this.ga=a;this.Fb=c;this.Ta=h;this.Q5a=v;this.p6=B;this.Bk=X;this.sve=ma;this.rve=Pa;this.IPb=mb;this.CFa=Tb;this.ya=rc;this.RAe=Tc;this.Zc=vd;this.Bb=ee;this.W6c=Ie;this.jdj=Hh;this.Rpj=new qf.a(()=>this.Q5a.o$k())}eb(){this.ga.Aa(ba.a.dQc,ic.a.view,Object(m.a)(this,this.dQc,"populatePageNumbersDropDown"),100);this.ga.Aa(ba.a.Mfi,ic.a.view,Object(m.a)(this,
this.oxm,"pageNumbersDropDownOpenHandler"),68);this.ga.Aa(ba.a.HNh,ic.a.view,Object(m.a)(this,this.KDl,"insertPageNumbersActionHandler"),4);this.ga.Aa(ba.a.Oyb,ic.a.view,Object(m.a)(this,this.cyl,"includePageCountActionHandler"),4);this.ga.Aa(ba.a.JSc,ic.a.view,Object(m.a)(this,this.Oqi,"removePageNumbersActionHandler"),4);this.ga.Aa(ba.a.WWm,ic.a.view,Object(m.a)(this,this.Oqi,"removePageNumbersActionHandler"),4);this.ga.Aa(ba.a.JGf,ic.a.application,Object(m.a)(this,this.aJm,"queryIncludePageCountToggleButton"),
97);this.ga.Aa(ba.a.$Vd,ic.a.application,Object(m.a)(this,this.$Vd,"queryPageNumbersPosition"),97);this.ga.Aa(ba.a.iIi,ic.a.view,Object(m.a)(this,this.Urn,"showPageNumbersCalloutHandler"),4);this.ga.JQ(ba.a.jIi,ic.a.view,Object(m.a)(this,this.Trn,"showPageNumbersCalloutForBlobHandler"),100);this.ga.Aa(ba.a.wvk,ic.a.view,Object(m.a)(this,this.xvk,"dismissPageNumbersCalloutHandler"),4)}$Vd(a,c,h,v,B){if(1===h)return 32;this.W6c(B[this.CGg]);B[Pf.a.Text]=this.sve.pxm(this.Q5a.Oyb);return 32}aJm(a,c,
h,v,B){if(1===h)return 32;B[Uf.a.On]=this.Q5a.Oyb;return 32}cyl(a,c,h,v,B){if(1===h)return 32;this.Q5a.EOn(B[Uf.a.On]);return 32}Oqi(a,c,h){if(1===h)return 32;if(this.p6){c=nA.Ag.Xs(c.view.sc);h=Kd.GraphIterator.va(c);const v=this.Bb.iTa();try{const B=this.Fb.Ob(15);try{B.Oa(c),B.ql=a,iq.a.instance.AIa(h,X=>{this.IPb.JSc(X,Object(m.a)(this,this.SXk,"getCurrentSelectionCpInParagraph"),Object(m.a)(this,this.yfn,"setIpSelectionInParagraph"));return!0})}finally{B&&B.dispose()}}finally{v&&v.dispose()}}return 32}dQc(a,
c,h,v,B){if(1===h)return 32;B.MenuItems=this.Rpj.value;this.gzg?this.Q5a.U1m():this.gzg=!0;return 32}KDl(a,c,h,v,B){if(1===h)return 32;const X=this.W6c(B[this.CGg]);if(this.p6){c=nA.Ag.Xs(c.view.sc);h=Kd.GraphIterator.va(c);v=this.Fb.Ob(15);try{v.Oa(c);v.ql=a;let ma=null;const Pa=this.Zc.Pe("UserAction","InsertPageNumber");iq.a.instance.AIa(h,mb=>{this.p6.Y7||this.jdj(mb);ma=this.rve.IDl(mb,X,this.Q5a.Oyb)||ma;return!0});Pa.stop();if(!ma)return 8;this.orn(ma,X)}finally{v&&v.dispose()}this.Bb.Xq(12)}return 32}oxm(){return 32}Urn(a,
c,h,v,B){if(1===h)return 32;2===h&&this.CFa.showCallout(B);return 32}Trn(a,c,h,v,B,X){return this.RAe.create(a,c,h,v,B,X)}xvk(a,c,h){if(1===h)return 32;this.CFa.eeh();return 32}orn(a,c){const h=a.Xa.paragraph;if(h){var v=this.Bk.lvf(h);v&&this.p6.dca(v)}v=this.p6.Y7;this.p6.show(4>c);h&&this.Nen(h)&&(this.Nin(a,h),this.jGj(a,v))}Nen(a){let c;if(!({isHeader:c,DXf:a}=this.Bk.sEh(a)).returnValue)return!1;this.p6.Tsa(a,c);return!0}Nin(a,c){a=ne.SelectionFactory.vd(c,a.Xa.cp);this.ya.setSelection(a)}jGj(a,
c){c=new Se.a(2,1,c?this.hDn:this.iDn,Object(m.a)(this,this.mqn,"showCalloutForAPageNumbersBlobTask"));c.customData=a;this.Ta.ub(c)}mqn(a){l.AFrameworkApplication.pa.Jka(null,ba.a.jIi,a.customData,null)}SXk(a){const c=$c.a.instance.Ca.Fa;let h=-1;for(let v of c)if(v.node===a){h=v.cpBegin;break}return{returnValue:h,cJd:Gc.SelectionEditor.Cl(c)}}yfn(a,c){a=ne.SelectionFactory.vd(a,c);$c.a.instance.setSelection(a)}static get Ag(){return jn.PageNavigator.instance}}Object(w.a)(nA,"PageNumbersActor",null,
[475]);class su{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd){this.ga=a;this.Ta=c;this.Q5a=h;this.sve=v;this.rve=B;this.IPb=X;this.CFa=ma;this.RAe=Pa;this.Bk=mb;this.Bb=Tb;this.W6c=rc;this.Vyj=Tc;this.aba=vd}create(a,c){return new nA(this.ga,new Fk.a,this.Ta,this.Q5a,a,this.Bk,this.sve,this.rve,this.IPb,this.CFa,$c.a.instance,this.RAe,Eb.App.oa.Qo,this.Bb,this.W6c,this.Vyj,this.aba,c)}}Object(w.a)(su,"Factory",null,[439]);var Hx=b(1731),Rt;(function(a){a[a.small=0]="small";a[a.mediumSmall=1]="mediumSmall";
a[a.medium=2]="medium";a[a.large=3]="large"})(Rt||(Rt={}));Object(w.b)("ModalCalloutSize",Rt);var Gy;(function(a){a[a.topCenter=0]="topCenter";a[a.topJustified=1]="topJustified";a[a.topLeft=2]="topLeft";a[a.topRight=3]="topRight";a[a.bottomCenter=4]="bottomCenter";a[a.bottomLeft=5]="bottomLeft";a[a.bottomRight=6]="bottomRight"})(Gy||(Gy={}));Object(w.b)("BeakLocation",Gy);class Hy{constructor(a,c,h){this.gDn=1;this.Uxe=!1;this.WQb=null;this.Ta=a;this.ya=c;this.icj=h}nz(){this.iGj()}O5(){this.Uxe?
(this.ya.fea(Object(m.a)(this,this.Kka,"processSetSelectionFinished")),this.Uxe=!1):this.WQb&&(this.Ta.me(this.WQb),this.WQb=null)}iGj(){this.WQb=new Se.a(2,1,this.gDn,Object(m.a)(this,this.WRm,"registerForProcessSetSelectionFinished"));this.Ta.ub(this.WQb)}WRm(){this.ya.aC(Object(m.a)(this,this.Kka,"processSetSelectionFinished"));this.Uxe=!0;this.WQb=null}Kka(a,c){if(a=c.rk.Fa)1<a.length||!a.length?a=!0:(a=a.sa,a=a.cpEnd-a.cpBegin,a=1<a||!a),a&&this.icj()}}Object(w.a)(Hy,"CalloutDismissManager",
null,[]);class Fs{constructor(a,c,h,v){this.gNc=a;this.yj=v;this.Vhc=new Hy(c,h,Object(m.a)(this,this.dismiss,"dismiss"))}get zF(){return this.gNc.zF}show(){if(!this.zF){const a=document.createElement("div");a.classList.add(Fs.nxm);a.innerText=WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText;this.gNc.content=a;this.gNc.show();this.yj&&this.yj.sendNotification(WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText,!0);this.Vhc.nz()}}dismiss(){this.zF&&(this.Vhc.O5(),this.gNc.dismiss())}dispose(){this.dismiss();
this.gNc.dispose()}static Fjk(a,c){c=Hx.a.B9g(Ve.a.getElementBounds(a.targetElement),c,Eb.App.oa.vA,Rt.small);c.rba=Fs.G5e(a);c.Zr=!1;return c}static G5e(a){let c=Gy.bottomCenter;Object(Ub.a)(474,a.view)&&a.view.isHeader&&(c=Gy.topCenter);return c}}Fs.nxm="PageNumbersCalloutControl";Object(w.a)(Fs,"PageNumbersCallOutControl",null,[473]);class Iy{constructor(a,c,h){this.pQ=null;this.hQ=!1;this.Gk=a;this.Vhc=new Hy(c,h,Object(m.a)(this,this.dismiss,"dismiss"))}get zF(){return this.hQ}show(){this.zF||
Hi.UISurfaces.dK().then(a=>{const c=a.callout(Object.assign(new eo.a,{target:this.Gk,content:WordEditorIntl.WordEditorStrings.L_PageNumbersCalloutText})),h=Object.assign(new hc.a,{telemetryId:"PageNumbersCallout",onShow:()=>{this.hQ=!0},expirationOptions:Object.assign(new Hc.a,{displayTimeoutSeconds:7,onExpire:()=>{this.dismiss()}})});this.pQ=a.addNotification(c,h);this.Vhc.nz();return null},a=>{r.ULS.sendTraceTag(593352340,383,15,"Failed to GetNotificationsAPIAsync: {0}",a);return null})}dismiss(){this.zF&&
this.pQ&&Hi.UISurfaces.dK().then(a=>{this.Vhc.O5();a.removeNotification(this.pQ);this.hQ=!1;return null},a=>{r.ULS.sendTraceTag(593352339,383,15,"Failed to GetNotificationsAPIAsync: {0}",a);return null})}}Object(w.a)(Iy,"ReactPageNumbersCallOutControl",null,[473]);class Jy{constructor(a,c,h){this.ya=c;this.Ta=a;this.yj=h}create(a,c){if(l.AFrameworkApplication.na.Ya&&l.AFrameworkApplication.na.Ya.sKa)return new Iy(c.targetElement,this.Ta,this.ya);a=Fs.Fjk(c,a);return new Fs(a,this.Ta,this.ya,this.yj,
l.AFrameworkApplication.na.WK)}}Object(w.a)(Jy,"Factory",null,[438]);class oA{constructor(a,c){this.IB=null;this.Qpj=a;this.gh=c}get control(){return this.IB}showCallout(a){this.control&&this.control.zF&&this.control.dismiss();this.IB=this.UDm(a);this.control.show()}eeh(){this.control&&(this.control.dismiss(),this.IB=null)}UDm(a){const c=this.gh.Iia();this.IB=this.Qpj.value.create(c,a);return this.control}}Object(w.a)(oA,"PageNumbersCalloutControlManager",null,[437]);var pA=b(695);class kB extends Nh.a{constructor(){super();
this.Text=null}get Type(){return 7}}Object(w.a)(kB,"PageNumberGalleryButtonProps",Nh.a,[]);const Ww=(a,c,h)=>{a=a.Dj();a.set(h);c.fCb(a);return a};class av{constructor(a,c,h){this.lme=!1;this.aba=c;this.Ck=h}get Oyb(){return this.lme}o$k(){const a=Object.assign(new Ah.a,{Id:"menuPageNumbersDropDown",MenuSectionList:[]});a.MenuSectionList.push(this.UDj());a.MenuSectionList.push(this.FEj());a.MenuSectionList.push(this.hFj());return a}EOn(a){this.lme=a;this.noi()}U1m(){this.lme=!1;const a={};a[av.SLh]=
"CheckboxModel";this.aba(a);this.noi()}UDj(){const a=Object.assign(new Hg.a,{Id:"msIncludePageCount",ControlsId:"ctrlIncludePageCount",Title:F.a.Wd(WordEditorIntl.WordEditorStrings.L_PageNumbersSectionHeaderForAdd),ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),c=Object.assign(new pA.a,{Id:av.dyl,Command:ba.a.Oyb.toString(),QueryCommand:ba.a.JGf.toString(),LabelText:F.a.Wd(WordEditorIntl.WordEditorStrings.L_IncludePageCount),Alt:F.a.Wd(WordEditorIntl.WordEditorStrings.L_IncludePageCountAlt),
KeyTip:CommonUIStrings.l_IncludePageCountKeytip,UseUncheckedImage:!0,CloseMenuWhenExecuted:!1});a.ControlList.push(c);return a}FEj(){const a=Object.assign(new Hg.a,{Id:"msPageNumbersPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),c=Object.assign(new Ce.a,{Id:"galleryPageNumbersPosition",ExternalId:"PageNumbers",ExternalGalleryId:"InsertPageNumberGallery",Type:7,Width:3,ElementDimensions:"Size61by75",GalleryItems:[]});if(this.Ck){for(var h=3;1<=h;h--)c.GalleryItems.push(this.Q7e(h));for(h=6;4<=
h;h--)c.GalleryItems.push(this.Q7e(h))}else for(h=1;6>=h;h++)c.GalleryItems.push(this.Q7e(h));a.ControlList.push(c);return a}hFj(){const a=Object.assign(new Hg.a,{Id:"msRemovePageNumbers",ControlsId:"ctrlRemovePageNumbers",DisplayMode:"Menu16",ControlList:[]}),c=Object.assign(new qh.a,{Id:"btnRemovePageNumber",Command:ba.a.JSc.toString(),LabelText:F.a.Wd(WordEditorIntl.WordEditorStrings.L_RemovePageNumbers),Alt:F.a.Wd(WordEditorIntl.WordEditorStrings.L_RemovePageNumbersAlt),Image16by16:l.AFrameworkApplication.qp,
Image16by16Class:Fd.getImageClass("WordRemovePageNumbers_16x16x32"),KeyTip:CommonUIStrings.l_RemovePageNumbersKeytip});a.ControlList.push(c);return a}Q7e(a){const c=av.XBf+a.toString();var h=Object,v=h.assign,B=new kB,X=ba.a.HNh.toString(),ma=ba.a.$Vd.toString(),Pa=F.a,mb=Pa.Wd;let Tb="";switch(a){case 1:Tb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopLeftAlt;break;case 2:Tb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopCenterAlt;break;case 3:Tb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnTopRightAlt;
break;case 4:Tb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomLeftAlt;break;case 5:Tb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomCenterAlt;break;case 6:Tb=WordEditorIntl.WordEditorStrings.L_PageNumbersOnBottomRightAlt}return v.call(h,B,{Id:c,Command:X,QueryCommand:ma,Alt:mb.call(Pa,Tb)})}noi(){const a={};for(let c=1;6>=c;c++)a[av.XBf+c.toString()]="PageNumberGalleryButtonModel";a[av.SLh]="CheckboxModel";this.aba(a)}static p$k(a){return a?parseInt(a.substr(av.XBf.length)):1}}av.dyl=
"btnIncludePageCount";av.SLh="IncludePageCount";av.XBf="btnPageNumbersPosition";Object(w.a)(av,"PageNumbersControl",null,[436]);class bv{constructor(a,c,h,v,B=null,X=null,ma=null,Pa=null){this.Do=null;this.Vb=a;this.Spj=c;this.IPb=h;this.Bk=v;this.Vjc=B||Object(m.a)(this,this.k2k,"getHeaderFooterKinds");this.Haj=X||Object(m.a)(this,this.yWk,"getContentNode");this.Gaj=ma||Object(m.a)(this,this.zWk,"getContentNodeForValidTable");this.qjj=Pa||Object(m.a)(this,this.cMl,"isHeaderFooterNodeOfCurrentSection")}get vC(){return this.Do||
(this.Do=xa.a.instance.resolve("Box4.IOutlineEditor"))}IDl(a,c,h){var v=Ww(this.Vb,this.Bk,a).rm;v=this.Bk.Wia(v);v=this.Vjc(c,v);let B=null;for(let ma=0;ma<v.length;ma++){var X=v.Ye(ma);this.qjj(a,X)&&(X=this.Haj(a,c,X),B=this.Spj.EEj(X,h)||B)}return B}k2k(a,c){const h=new Kh.a;a=4>a;switch(c){case 1:case 2:h.add(a?0:3);break;case 3:case 4:h.add(a?0:3),h.add(a?1:4)}return h}yWk(a,c,h){var v=Ww(this.Vb,this.Bk,a);this.Bk.gCb(v,h);let B=this.Gaj(v,c);if(B)this.IPb.nri(B);else{v=Ww(this.Vb,this.Bk,
a);this.Bk.gCb(v,h);v.Xc();if(Ta.OutlineElementReader.Gg(v)&&(ie.OutlineElementNavigator.Fd(v),sd.ParagraphReader.eg(v))){v=v.currentNode;const X=this.xEh(c);sd.ParagraphReader.zu(v)===X&&this.IPb.nri(v)&&(B=v)}B||(v=Ww(this.Vb,this.Bk,a),this.Bk.gCb(v,h),this.vC.ecb(v,null,!0),B=ie.OutlineElementNavigator.Fd(v),this.vB(c,B))}return B}zWk(a,c){let h=null;a.Za(1);if(Ta.OutlineElementReader.Gg(a)&&(a.Za(2),Wf.TableReader.isTable(a))){var v=a.currentNode;if(3===Wf.TableReader.Eg(v)){let B=0;v=Wf.TableReader.hk(v);
switch(c){case 1:case 4:B=v?2:0;break;case 2:case 5:B=1;break;case 3:case 6:B=v?0:2}Fe.moveToCellContent(a,0,B);a.currentNode&&Ta.OutlineElementReader.Gg(a)&&(a=ie.OutlineElementNavigator.Fd(a),sd.ParagraphReader.tb(a)&&(h=a))}}return h}vB(a,c){bv.D5.EVc(4>a?Box4Intl.Box4Strings.L_StyleWordHeader:Box4Intl.Box4Strings.L_StyleWordFooter,c);bv.paragraphEditor.vB(c,this.xEh(a))}xEh(a){let c=1;switch(a){case 1:case 4:c=1;break;case 2:case 5:c=2;break;case 3:case 6:c=3}return c}cMl(a,c){const h=Ww(this.Vb,
this.Bk,a);a=h.currentNode.ia(Yb.a.pea,0);this.Bk.gCb(h,c);c=h.currentNode.ia(Yb.a.pea,0);return a===c}static get paragraphEditor(){return bv.kh||(bv.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}static get D5(){return bv.yv||(bv.yv=xa.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}}bv.kh=null;bv.yv=null;Object(w.a)(bv,"PageNumbersInserter",null,[378]);var Ky=b(789),ZB=b(795);class d{constructor(a,c,h=null,v=null,B=null){this.Fb=a;this.wcd=h||WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;
this.Zee=v||Object(m.a)(this,this.Qfk,"createAndInsertPageNumberBlob");this.sIg=B||Object(m.a)(this,this.iEl,"insertTextRange")}EEj(a,c){const h=this.Fb.Ob(15);h.Oa(a);var v=sd.ParagraphReader.text(a),B=!1;0<v.length&&" "!==v.charAt(v.length-1)&&(B=!0);if(c){c=String.format(this.wcd,"#","$");B&&(c=" "+c);B=c.indexOf("#");v=c.indexOf("$");r.ULS.shipAssertTag(4256717,309,-1!==B,"{0}",{["PageNumberIndex"]:B});r.ULS.shipAssertTag(4256718,309,-1!==v,"{0}",{["PageCountIndex"]:v});r.ULS.shipAssertTag(4256719,
309,B!==v,"{0}",{["PageNumberIndex"]:B,["PageCountIndex"]:v});let Pa;let mb;if(B<v){var X=B;Pa=v;var ma=Ky.a.rDc(0);mb=Ky.a.rDc(1)}else X=v,Pa=B,ma=Ky.a.rDc(1),mb=Ky.a.rDc(0);this.Ggf(a,c,0,X);ma=this.Zee(a,ma);this.Ggf(a,c,X+1,Pa);X=this.Zee(a,mb);this.Ggf(a,c,Pa+1,c.length);a=B<v?ma:X}else B&&this.sIg(a," "),a=this.Zee(a,Ky.a.rDc(0));h.dispose();return a}Qfk(a,c){a=Oe.a.Sb(a,sd.ParagraphReader.textLength(a));const h=a.node.Mb;return h?d.characterPropertiesEditor.Lca(a,v=>{v=ZB.a.getInstance(v);
this.srd(v,15,h,c);this.srd(v,47,h,c);this.srd(v,16,h);this.srd(v,17,h);return v}):null}srd(a,c,h,v=null){const B=new Pn.a;B.setValue(Ed.a.I5,!0);B.setValue(Yb.a.Zvb,1);B.setValue(Yb.a.Qp,c);switch(c){case 15:B.setValue(Yb.a.yKa,!0);B.setValue(Yb.a.fieldInstruction,v);break;case 47:B.setValue(Yb.a.fieldInstruction,v);break;case 17:B.setValue(Yb.a.BAb,!0)}c=h.At(B,N.a.create());this.CFj(a,c)}CFj(a,c){a.Coa(c,N.a.nil,Fb.AParagraphNode.Vz,null)}Ggf(a,c,h,v){c=c.substring(h,v);0<c.length&&this.sIg(a,
c)}iEl(a,c){a=Oe.a.Sb(a,sd.ParagraphReader.textLength(a));d.characterPropertiesEditor.replaceTextRange(a,c)}static get characterPropertiesEditor(){return d.Tb||(d.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(a){d.Tb=a}}d.Tb=null;Object(w.a)(d,"PageNumbersNodeLevelInserter",null,[377]);class n{pxm(a){return n.Ebl(a)}static Ebl(a){return String.format(a?WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount:WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewText,
n.wfi,n.wfi)}}n.wfi="1";Object(w.a)(n,"PageNumbersPositionPreviewGenerator",null,[376]);class C{constructor(){this.Pcg=String.format(WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount,"\ufffc","\ufffc");this.faj=this.Pcg.length}Atl(a){let c=a.characterData.lastIndexOf("\ufffc");return-1!==c&&c+1===sd.ParagraphReader.textLength(a)?{returnValue:!0,gQc:c}:{returnValue:!1,gQc:-1}}ksl(a){let c=a.characterData.lastIndexOf(this.Pcg);return-1!==c&&c+this.faj===sd.ParagraphReader.textLength(a)?
{returnValue:!0,gQc:c}:{returnValue:!1,gQc:-1}}ftl(a){return ac.a(a,9)?!0:!1}}Object(w.a)(C,"PageNumbersReader",null,[375]);class T{constructor(a,c,h,v,B,X=null,ma=null){this.Vb=a;this.Bk=c;this.tve=h;this.Bb=v;this.$pc=B;this.Vjc=X||Cx.a.uXe;this.csj=ma||Object(m.a)(this,this.VWm,"removePageNumbersFromSection");this.wcd=WordEditorIntl.WordEditorStrings.L_PageNumbersPreviewTextForIncludeCount;this.Cjg=String.format(this.wcd,"#","$");this.Thj=this.Cjg.indexOf("#");this.Shj=this.Cjg.indexOf("$");this.xje=
String.format(this.wcd,"\ufffc","\ufffc");this.vjg=this.xje.length}JSc(a,c,h){var v=Ww(this.Vb,this.Bk,a).rm;v=this.Bk.Wia(v);v=this.Vjc(v);for(let B of v)this.csj(a,B,c,h)}nri(a){if(this.tve.ftl(a)){let c=-1;if(({gQc:c}=this.tve.ksl(a)).returnValue&&this.Y0g(a,c)||({gQc:c}=this.tve.Atl(a)).returnValue&&this.q3j(a,c))return!0}return!1}VWm(a,c,h,v){a=Ww(this.Vb,this.Bk,a);this.Bk.gCb(a,c);c=hq.a.gq(a);for(a=!1;c.moveNext();){const B=c.currentNode;if(sd.ParagraphReader.tb(c.currentNode)&&ac.a(c.currentNode,
9)){a=!0;let X;const ma=({cJd:X}=h(B,X)).returnValue;let Pa=ma;Pa=this.GVm(B,Pa);Pa=this.oXm(B,Pa);-1<ma&&(Pa===ma&&X||v(B,Pa))}}a&&this.Bb.Xq(12)}oXm(a,c){var h=a.la.length;for(let B=0;B<h;B++){var v=a.la.J(B);v.blob&&9===v.blob.nh&&(v=v.cp,h=Oe.a.createTextRange(a,v,v+1),this.$pc(h,""),h=a.la.length,B--,c=this.XQg(c,v,1))}return c}GVm(a,c){let h=a.characterData.indexOf(this.xje);for(;-1!==h;)this.Y0g(a,h)&&(c=this.XQg(c,h,this.vjg)),h=a.characterData.indexOf(this.xje);return c}q3j(a,c){const h=
a.la.$g(c);return h&&h.blob&&9===h.blob.nh?(a=Oe.a.createTextRange(a,c,c+1),this.$pc(a,""),!0):!1}Y0g(a,c){const h=a.la.$g(c+this.Thj),v=a.la.$g(c+this.Shj);return h&&h.blob&&9===h.blob.nh&&v&&v.blob&&9===v.blob.nh?(a=Oe.a.createTextRange(a,c,c+this.vjg),this.$pc(a,""),!0):!1}XQg(a,c,h){-1<a&&a>c&&(c=a-c,a=c>h?a-h:a-c);return a}}Object(w.a)(T,"PageNumbersRemover",null,[374]);class ea{constructor(a,c){this.gkb=this.fkb=null;this.Wp=a;this.Ta=c}ZLj(){this.Wp.style.display="";this.fkb||(this.gkb&&(this.Ta.me(this.gkb),
this.gkb=null),this.fkb=new Se.a(0,1,10,()=>{this.Wp.classList.add("Displayed");this.fkb=null}),this.Ta.ub(this.fkb))}aMj(){this.Wp.classList.remove("Displayed");this.gkb||(this.fkb&&(this.Ta.me(this.fkb),this.fkb=null),this.gkb=new Se.a(0,1,200,()=>{this.Wp.style.display="none";this.gkb=null}),this.Ta.ub(this.gkb))}}Object(w.a)(ea,"PaneControlAnimationHelper",null,[393]);class Ra{constructor(a){this.Ta=a}u$k(a){return new ea(a,this.Ta)}}Object(w.a)(Ra,"PaneControlAnimationHelperFactory",null,[373]);
class ob{constructor(a,c,h,v,B,X,ma,Pa,mb=!1){this.yj=this.N8f=this.Rga=this.r7c=null;this.ga=a;this.i2=c;this.i2.bind(this);this.Cne=h;this.wva=B;this.QDe=ma;this.fb=Pa;this.R8c=mb;this.jaa=X.value.create(h,v);this.i2.CTj(this.jaa);this.tW=qc.KeyInputManager.mb(vb.a.V5,0)}get Xu(){return this.yj||(this.yj=xa.a.instance.resolve("Common.Utils.IAriaNotifier"))}zY(a){this.i2.zY(a);this.Rga&&!a&&this.Rga.uvk()}dca(a){this.r7c!==a&&(this.T9a(),this.r7c=a)}Rzi(a){if(this.r7c){var c=this.wva.Hab(this.r7c,
Cx.a.j2k(a,this.Cne));this.R8c?(this.N8f=this.Fph(a,this.Cne),this.jaa.UFb(we.a.Bmd)):this.DLn(a);c&&this.vLe(c)}}TUg(a){this.R8c&&this.fb&&(a=this.fb.fd(a))&&a.hba(Object(m.a)(this,this.cul,"headerFooterOnFocus"))}cul(){this.Xu.sendNotification(this.N8f+" "+WordEditorIntl.WordEditorStrings.l_EditingSurfaceAccessibilityDescribedByText,!0)}Fph(a,c){let h="";switch(a){case 1:h=3!==this.ga.mode?c?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessageForReadOnly:
c?WordEditorIntl.WordEditorStrings.l_DefaultHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_DefaultFooterScreenReaderMessage;break;case 2:h=3!==this.ga.mode?c?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessageForReadOnly:c?WordEditorIntl.WordEditorStrings.l_FirstPageHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_FirstPageFooterScreenReaderMessage;break;case 3:h=3!==this.ga.mode?
c?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessageForReadOnly:c?WordEditorIntl.WordEditorStrings.l_EvenPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_EvenPagesFooterScreenReaderMessage;break;case 4:h=3!==this.ga.mode?c?WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessageForReadOnly:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessageForReadOnly:c?
WordEditorIntl.WordEditorStrings.l_OddPagesHeaderScreenReaderMessage:WordEditorIntl.WordEditorStrings.l_OddPagesFooterScreenReaderMessage}return h}DLn(a){this.jaa.ZAi(this.Fph(a,this.Cne),we.a.Bmd)}setInitialSelection(){this.jaa.zVc()}vLe(a){this.T9a();this.jaa.NA(a,a.Oh)}T9a(){this.jaa.detach()}Omk(){this.Rga=this.QDe.value.create(this.i2.mcc);this.tln(this.Rga)}tln(a){if(this.fb){const c=this.fb.fd(ln.a.IWa);c.parent=Fc.AFrame.uo;c.iba(()=>{a.setFocus();this.Njn()});c.bindAction(this.tW,ba.a.jX)}}Njn(){if(this.fb){var a=
this.fb.fd(ln.a.IWa);const c=new He.DOMFocusListing(()=>this.i2.mcc);c.zBa=!0;c.vn(1);this.fb.DNe(this.i2.mcc,a,c);a=this.fb.getRegion(ln.a.IWa);a.rMa();a.mV=!0;c.ica&&c.ov(c.ica)}}dispose(){void 0!==this.Rga&&null!==this.Rga&&(this.fb.fd(ln.a.IWa).Bp(this.tW),this.Rga.dispose())}BQm(){void 0!==this.Rga&&null!==this.Rga&&this.Rga.refresh()}}Object(w.a)(ob,"PaneControl",null,[392]);class Ob{constructor(a,c,h,v){this.Bk=a;this.Mgj=c;this.QDe=h;this.fb=v}create(a,c,h,v){return new ob(a,c,h,v,this.Bk,
this.Mgj,this.QDe,this.fb,l.AFrameworkApplication.K.$("AccessibilityNotificationEnabledViaAriaLiveRegion"))}}Object(w.a)(Ob,"Factory",null,[372]);var jc=b(969);class zc extends ls.a{constructor(a,c,h,v,B,X,ma,Pa,mb){super();this.init(a);this.jk("ShowCalloutForPageNumberOperation");this.H6i=Pa;this.$bb(this.H6i,c,v,B,X);this.Ix=0;this.Foc=X;this.CFa=ma;this.xg=mb;1===this.behavior&&(this.Xp=32,this.lla())}run(){var a=this.xg.Da.Su;!this.Ix&&this.Foc.UEd(a)&&this.Foc.dWa(a).element&&(this.Ix=1);if(1===
this.Ix){const c=this.Foc.dWa(a);a=new jc.a(c.element,a);this.CFa.showCallout(a);this.Ix=2}2===this.Ix&&(this.Xp=32,this.lla())}}Object(w.a)(zc,"ShowCalloutForPageNumberOperation",ls.a,[]);class nd{constructor(a,c,h){this.CFa=a;this.ga=c;this.UJb=h}create(a,c,h,v,B,X){return new zc(a,c,h,v,B,X,this.CFa,this.ga,this.UJb)}}Object(w.a)(nd,"Factory",null,[371]);class td{constructor(){this.Do=null}get vC(){return this.Do||(this.Do=xa.a.instance.resolve("Box4.IOutlineEditor"))}yb(a){a.ha("WordEditor.HeaderFooter.HeaderFooterManager",
()=>new Dx(a.resolve("WordEditor.HeaderFooter.HeaderFooterControlOwner"),a.resolve("WordEditor.HeaderFooter.HeaderFooterActor"),a.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),a.te("WordEditor.HeaderFooter.IPageNumbersActorFactory"),a.resolve("WordEditor.IHeaderFooterViewElementFactory"),a.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),a.resolve("Box4.IFeatureHelper"))).singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterView.Factory",()=>new YB(a.resolve("WordEditor.HeaderFooter.HeaderFooterControlLauncher"),
HC.a.KRe,()=>a.resolve("WordEditor.SectionAlignedViewRepositioner"),Eb.App.oa.Da,ec.InteractiveViewManager.instance,()=>a.resolve("Box4.IUndoManager"),l.AFrameworkApplication.pa,a.resolve("Box4.IInteractiveEventNotifier"),a.za("Box4.ITextMetricsAdapter"),a.resolve("Box4.IRotatingCoordinateConverter"),a.za("Common.IZoomManager"),a.ra("Box4.IContentControlViewElementManager"),a.ra("Box4.CpConversionManagerImpl"),a.ra("Box4.ContentControlConfigSettings"),a.ra("Box4.IContentControlReader"),a.ra("Box4.IContentControlBoundaryNavigator"))).as("WordEditor.HeaderFooter.IHeaderFooterViewFactory").singleInstance();
a.ha("WordEditor.HeaderFooter.HeaderFooterViewElement.Factory",()=>new Fy(a.resolve("Box4.SectionAlignedViewPositionProvider"),a.za("Box4.ContentControl.Acetate.IContentControlAcetateDomManager"),a.resolve("WordEditor.PageBackground.PageBackgroundColorHandler"),!!Eb.App.instance&&Eb.App.instance.BM)).as("WordEditor.IHeaderFooterViewElementFactory").singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterToolbar.Factory",()=>new sz(S.App.Hk,a.za("Box4.IGeneralCuiUser"),a.resolve("Box4.IFeatureHelper"),
S.App.Hk,l.AFrameworkApplication.pa)).as("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory").singleInstance();a.ha("WordEditor.HeaderFooter.PaneControl.Factory",()=>new Ob(a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.te("WordEditor.HeaderFooter.IHeaderFooterViewFactory"),a.te("WordEditor.HeaderFooter.IHeaderFooterToolbarFactory"),nc.FocusManager.instance())).as("WordEditor.HeaderFooter.IPaneControlFactory").singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterControl.Factory",
()=>new eB(()=>{Eb.App.oa.updateCommandUI()},a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),l.AFrameworkApplication.pa,a.resolve("Box4.ContentEditableViewEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlFactory").singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersActor.Factory",()=>new su(l.AFrameworkApplication.pa,ag.a.instance,a.resolve("WordEditor.HeaderFooter.PageNumbersControl"),a.resolve("WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator"),
a.resolve("WordEditor.HeaderFooter.PageNumbersInserter"),a.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),a.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),a.resolve("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory"),a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,av.p$k,Object(m.a)(Eb.App.oa,Eb.App.oa.NZc,"updateRibbonControl"),Object(m.a)(Eb.App.oa,Eb.App.oa.xE,"updateRibbonControls"))).as("WordEditor.HeaderFooter.IPageNumbersActorFactory").singleInstance();
a.ha("WordEditor.HeaderFooter.HeaderFooterControlLauncher",()=>new fB).singleInstance();a.ha("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory",()=>new Ra(ag.a.instance)).singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterControlOwner",()=>new pz(nc.FocusManager.instance(),Eb.App.oa.gu,a.te("WordEditor.HeaderFooter.IPaneControlFactory"),a.te("WordEditor.HeaderFooter.IHeaderFooterControlFactory"),a.te("WordEditor.HeaderFooter.IPaneControlAnimationHelperFactory"),l.AFrameworkApplication.pa,
new qf.a(()=>Eb.App.oa.Da.Jb),l.AFrameworkApplication.K,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.IExternalContentFloatieEventSource"))).as("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent").singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterEditor",()=>new yy(a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),vg.PageReader.instance,new gl.a,iq.a.instance)).singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator",()=>new Gh(new gl.a,iq.a.instance));
a.ha("WordEditor.HeaderFooter.HeaderFooterActor",()=>new xy(l.AFrameworkApplication.pa,a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),a.resolve("WordEditor.HeaderFooter.HeaderFooterInserter"),iq.a.instance,new gl.a,new Fk.a,a.resolve("WordEditor.HeaderFooter.HeaderFooterToolbarGenerator"),xy.PFh,a.resolve("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory"))).singleInstance();a.ha("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter",
()=>new $o(gA.a.instance,$o.Uhl(a.resolve("Box4.ITableEditor")),$o.kUk(),l.AFrameworkApplication.isRtl,ie.OutlineElementNavigator.Wc,$o.cgl(),$o.Z1k(),a.resolve("Box4.IOutlineElementEditor")));a.ha("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter",()=>new gB(a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new gl.a,c=>this.vC.ecb(c),l.AFrameworkApplication.isRtl,Object(m.a)(a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementEditor").gGb,"setRtlSimple"),a.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultTableInserter")));
a.ha("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter",()=>new Ex(iq.a.instance,a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.resolve("WordEditor.HeaderFooterNodeFactory"),a.resolve("WordEditor.HeaderFooter.HeaderFooterDefaultContentInserter"))).singleInstance();a.ha("WordEditor.HeaderFooter.DeleteHeaderFooterDialogFactory",()=>new nz(a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),new gl.a,new Fk.a,a.resolve("WordEditor.HeaderFooter.HeaderFooterEditor"),l.AFrameworkApplication.pa)).singleInstance();
a.ha("WordEditor.HeaderFooter.HeaderFooterInserter",()=>new iA(a.resolve("WordEditor.HeaderFooter.HeaderFooterNodeLevelInserter"),a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),iq.a.instance,new gl.a,l.AFrameworkApplication.pa)).singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersControl",()=>new av(Object(m.a)(Eb.App.oa,Eb.App.oa.NZc,"updateRibbonControl"),Object(m.a)(Eb.App.oa,Eb.App.oa.xE,"updateRibbonControls"),l.AFrameworkApplication.isRtl)).singleInstance();a.register(n,"WordEditor.HeaderFooter.PageNumbersPositionPreviewGenerator").singleInstance();
a.ha("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter",()=>new d(new Fk.a,a.resolve("Box4.IFeatureHelper"))).singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersInserter",()=>new bv(new gl.a,a.resolve("WordEditor.HeaderFooter.PageNumbersNodeLevelInserter"),a.resolve("WordEditor.HeaderFooter.PageNumbersRemover"),a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"))).singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersReader",()=>new C).singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersRemover",
()=>new T(new gl.a,a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),a.resolve("WordEditor.HeaderFooter.PageNumbersReader"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,Object(m.a)(td.characterPropertiesEditor,td.characterPropertiesEditor.replaceTextRange,"replaceTextRange"))).singleInstance();a.ha("WordEditor.HeaderFooter.PageNumbersCalloutControlManager",()=>new oA(a.te("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory"),Eb.App.oa)).as("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager").singleInstance();
a.ha("WordEditor.HeaderFooter.PageNumbersCallOutControl.Factory",()=>new Jy(ag.a.instance,$c.a.instance,a.resolve("Common.Utils.IAriaNotifier"))).as("WordEditor.HeaderFooter.IPageNumbersCallOutControlFactory").singleInstance();a.ha("WordEditor.HeaderFooter.ShowCalloutForPageNumberOperation.Factory",()=>new nd(a.resolve("WordEditor.HeaderFooter.IPageNumbersCalloutControlManager"),l.AFrameworkApplication.pa,Eb.App.oa)).as("WordEditor.HeaderFooter.IShowCalloutForPageNumberOperationFactory").singleInstance();
a.ha("WordEditor.HeaderFooter.ClientPaginationPageAdornmentContentManager",()=>new dB(a.resolve("WordEditor.HeaderFooter.HeaderFooterReader"),l.AFrameworkApplication.pa)).as("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager").singleInstance();a.ha("WordEditor.HeaderFooter.ClientPaginationHeaderFooterBridge",()=>new cB(a.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),a.resolve("WordEditor.HeaderFooter.IClientPaginationPageAdornmentContentManager"))).as("WordEditor.IClientPaginationHeaderFooterBridge").singleInstance()}static get characterPropertiesEditor(){return td.Tb||
(td.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}td.Tb=null;Object(w.a)(td,"HeaderFooterComponentConfiguration",null,[2]);class Od{constructor(){this.t7c=this.W=null}get name(){return"WordEditor.HeaderFooter"}yb(a){this.W=a;(new td).yb(a)}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{this.El()})}El(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(185)&&(this.t7c=this.W.resolve("WordEditor.HeaderFooter.HeaderFooterManager"),this.t7c.start(),this.W.resolve("WordEditor.IClientPaginationHeaderFooterBridge"))}dispose(){this.t7c&&
this.t7c.dispose()}static main(){M.a.instance.Lb(new Od)}}Object(w.a)(Od,"PackageManager",null,[1,2]);var fe=b(362),e=b(988);class t{constructor(a,c){this.$d=a;this.Hl=c}create(){return new e.a(this.$d.instance,this.Hl.instance)}}Object(w.a)(t,"ContentControlNodeFactory",null,[472]);var D=b(180),Y=b(653);class ka{constructor(a,c,h,v){this.Tb=a;this.$d=c;this.Ba=h;this.mf=v}get $U(){return!!this.$d.instance&&this.$d.instance.$U}get Hzb(){return!!this.$d.instance&&this.$d.instance.Hzb}Boa(a,c,h,v,B,
X=D.a.Pub,ma=D.a.ZWb,Pa=null,mb=D.a.xWe,Tb=-1){(a=this.XAd(a,h))?(a.Wa||(a.Wa=new fe.a(a)),this.MCj(c,a.Wa,v,B,X,ma,Pa,mb,Tb)):r.ULS.sendTraceTag(17585366,368,15,"Unable to get a ChP at expected cp, which should not happen")}crk(a,c){if(a){new Ua.a;for(let v=0;v<a.count;v++){var h=this.q6e(a.J(v),c,!1);for(let B of h)this.HVm(B)}}}replaceTextRange(a,c){this.Tb.replaceTextRange(a,c)}XAd(a,c){var h=Oe.a.Sb(a,c);this.Tb.fHb(h);for(h=0;h<a.la.length;h++){const v=a.la.J(h);if(v.cp>c)break;if(v.cp===c)return v}return null}MCj(a,
c,h,v,B=D.a.Pub,X=D.a.ZWb,ma=null,Pa=D.a.xWe,mb=-1){const Tb=c.Xa.paragraph;a=new Y.a(c.Xa,!0,!0,!0,null,a,v,h,B,X,ma,Pa,null,this.mf);if(!this.$U||-1>=mb||mb>c.length)mb=c.length;c.insert(a,mb);Tb.rl();kg.a.instance.J(6)&&(a.zd?Tb.wordRunProperties.DX(a.zd-1,512):Tb.wordRunProperties.Lqa(a.zd,512),Tb.wordRunProperties.yp.Z(a.zd,kq.CharacterPropertiesEditor.ZO),Tb.wordRunProperties.Jr.Z(a.zd,kq.CharacterPropertiesEditor.bS))}q6e(a,c,h){const v=new Ua.a;for(let B=0;B<a.la.length;B++){const X=a.la.J(B);
if(X.Wa)for(let ma=0;ma<X.Wa.length;ma++)if(X.Wa.J(ma).ud.equals(c)&&(v.add(X.Wa.J(ma)),h))return v}return v}uZc(a,c,h){if(this.Hzb&&a){var v=a.node,B=a.Xl,X=a.Tu,ma=this.Fsh(v,B,c,!0);c=this.Fsh(v,X,c,!1);h?-1!==ma&&ma++:-1!==c&&c++;B||-1===ma||(ma=Math.max(ma,this.Ba.St(v)));X===this.Ba.textLength(v)&&-1!==c&&(c=Math.min(c,this.Ba.ut(v)));a.Qa=ma;a.$a=c}}Fsh(a,c,h,v){return(a=(a=a.la.$g(c))?a.Wa:null)&&a.length?a.aK(h,v):-1}HVm(a){if(a&&a.Xa.Wa){a.Xa.Wa.remove(a);const c=a.Xa.paragraph;0<=a.zd&&
a.zd<c.wordRunProperties.length&&(a.Xa.cp||1!==c.wordRunProperties.length||(c.wordRunProperties.DX(0,512),c.wordRunProperties.yp.Z(1,kq.CharacterPropertiesEditor.ZO),c.wordRunProperties.Jr.Z(1,kq.CharacterPropertiesEditor.bS)),c.wordRunProperties.removeAt(a.zd,512));c.rl()}}}Object(w.a)(ka,"ContentControlChpManager",null,[510]);class Ja{constructor(a,c,h,v,B){this.Ba=a;this.mn=c;this.Rf=h;this.Na=v;this.mf=B}s5e(a){if(!a||!Gc.SelectionEditor.ke(a))return null;if(!a.cpBegin){const c=this.Lqh(a.node,
a.Qa,!0);if(c)return c}return a.cpBegin===this.Ba.textLength(a.node)?this.Lqh(a.node,a.Qa-1,!1):null}VSk(a,c){a=this.q9g(a,c);return this.s5e(a)}Lqh(a,c,h){return a.la&&a.la.length?(a=h?a.la.first.Wa:a.la.last.Wa)&&0<=c&&c<a.length&&a.J(c).Oe&&a.J(c).Nb===h&&this.Vhf(a.J(c))?a.J(c):null:null}r8e(a){if(!a||!Gc.SelectionEditor.Rs(a))return null;var c=this.mn.t6e(a,a);a=0<c.count?c.J(c.count-1):null;return a&&!a.Oe&&this.Vhf(a)?(c=1<c.count?c.J(c.count-2):null)&&!c.Oe&&this.Vhf(c)?null:a:null}Vhf(a){if(!a)return!1;
var c=this.Rzh(a);if(!c)return!1;if(a.Nb)var h=a;else h=c,c=a;var v=this.Ba.textLength(a.Xa.paragraph);if(h.Xa.cp||c.Xa.cp!==v||!h.Eq||h.sra||!c.Eq||c.sra)return!1;h=h.Xa.Wa;c=c.Xa.Wa;for(v=0;v<h.length&&!h.J(v).ud.equals(a.ud);v++)if(!h.J(v).Nb)return!1;for(h=c.length-1;0<=h&&!c.J(h).ud.equals(a.ud);h--)if(c.J(h).Nb)return!1;return!0}eZc(a){a=this.s5e(a);this.Pqd(a,!1)}TRi(a,c){a=this.q9g(a,c);this.eZc(a)}LCa(a){a=this.r8e(a);return this.Pqd(a,!0)?a:null}iHl(a,c){a=this.s5e(a);return!!a&&a.ud.equals(c)}T1b(a,
c,h){a=this.VSk(a,c);return!!a&&a.ud.equals(h)}Ejf(a,c){a=this.r8e(a);return!!a&&a.ud.equals(c)}Pqd(a,c){if(!a)return!1;const h=this.Rzh(a);return this.S6g(a,c)&&(!h||this.S6g(h,c))}S6g(a,c){if(!a||a.Oe===c)return!1;var h=this.mn.s6d(a.Xa.paragraph,a.Nb);const v=a.Xa.Wa;-1!==h||a.Nb||(h=v.length);const B=c===a.Nb?1:-1;h+=c?B:0;a=v.aK(a.ud,a.Nb)+B;if(h===a||0<B!==a>h)return r.ULS.shipAssertTag(24933847,368,h!==a,"Stopping content control inline block conversion since we can't find a correct range to convert. begin: {0}, end: {1}, step: {2}",
h,a,B),r.ULS.shipAssertTag(24933848,368,0<B===a>h,"Stopping content control inline block conversion or we'll trap in infinite loop. begin: {0}, end: {1}, step: {2}",h,a,B),!1;for(var X=h;X!==a;X+=B){var ma=v.J(X);v.Dsa(ma);ma.Oe=c;v.oEl(ma,X);this.IOn(v.J(X))}if(this.N8)for(v.Xa.paragraph.rl(),X=h;X!==a;X+=B)ma=v.J(X),ma.paragraph.wordRunProperties.yp.Z(ma.zd,kq.CharacterPropertiesEditor.ZO),ma.paragraph.wordRunProperties.Jr.Z(ma.zd,kq.CharacterPropertiesEditor.bS);c?this.lRn(v,h,a,B):this.mRn(v,
h,a,B);r.ULS.sendTraceTag(24933849,368,50,"Converted {0} content control(s) to {1}",Math.abs(a-h),c?"block":"inline");return!0}c$e(a){var c,h;if(wn.a.kk){if(a.Nb&&this.mf.Aq.get(null===(c=a.contentControlNode.id)||void 0===c?void 0:c.toString()).equals(a.Xa.paragraph.id))return 38;if(!a.Nb&&this.mf.vr.get(null===(h=a.contentControlNode.id)||void 0===h?void 0:h.toString()).equals(a.Xa.paragraph.id))return 39}return a.Oe&&a.Nb?40:a.Oe&&!a.Nb?41:!a.Oe&&a.Nb?38:39}IOn(a){const c=a.Xa.paragraph.Mb;if(c){var h=
c.Ra(a.Rt),v=a.contentControlNode;if(h&&v){h=h.clone();h.setValue(Yb.a.lmf,a.Oe);var B=this.c$e(a);h.setValue(Yb.a.Qp,B);c.At(h,null);a.Rt=h.id;v.setValue(Yb.a.k4,a.Oe)}}}Rzh(a){if(a.Xa.cp&&a.Xa.cp!==this.Ba.textLength(a.Xa.paragraph)||!a.Xa.paragraph.la||!a.Xa.paragraph.la.length)return null;const c=a.Nb?a.Xa.paragraph.la.last:a.Xa.paragraph.la.first;if(!c.Wa)return null;a=c.Wa.aK(a.ud,!a.Nb);return-1===a?null:c.Wa.J(a)}mRn(a,c,h,v){var B,X;const ma=a.J(c).contentControlNode;if(ma){var Pa=a.J(c).Nb,
mb=Pa?Yb.a.yh:Yb.a.Ti;Pa=wn.a.kk?Pa?this.mf.Aq:this.mf.vr:null;Pa=wn.a.kk?null!==(X=Pa.get(null===(B=ma.id)||void 0===B?void 0:B.toString()))&&void 0!==X?X:N.a.nil:ma.ia(mb,N.a.nil);if(!Pa.equals(N.a.nil))if(a.Xa&&a.Xa.paragraph&&a.Xa.paragraph.id.equals(Pa)){for(c+=v;c!==h;c+=v){B=a.J(c).contentControlNode;if(!B)return;B.setValue(mb,Pa)}0<=h&&h<a.length&&a.J(h).Oe&&this.B3b(a.J(h))&&(a=a.J(h).contentControlNode)&&a.setValue(mb,Pa)}else r.ULS.shipAssertTag(24933851,368,!1,"Start/End object of innermost content control is not the paragraph which holds the content control.")}}lRn(a,
c,h,v){var B;let X=null;var ma=c-v;0<=ma&&ma<a.length&&a.J(ma).Oe&&this.B3b(a.J(ma))&&(X=a.J(ma).contentControlNode);for(ma=a.J(c).Nb;c!==h;c+=v){const Pa=a.J(c).contentControlNode;if(!Pa)break;X&&(wn.a.kk?(ma?this.mf.Aq:this.mf.vr).set(null===(B=X.id)||void 0===B?void 0:B.toString(),Pa.id):X.setValue(ma?Yb.a.yh:Yb.a.Ti,Pa.id));X=Pa}}B3b(a){return a.Eq&&!a.sra}q9g(a,c){if(!a||!this.Rf)return null;const h=c?Oe.a.Sb(a,0):Oe.a.av(a);a=this.Rf.np(a,c);h.$a=h.Qa=a;return h}get N8(){return this.Na.isFeatureEnabled(41)}}
Object(w.a)(Ja,"ContentControlConverter",null,[347]);var db;(function(a){a[a.N_n=0]="BoundingBox";a[a.q2n=1]="Tags";a[a.C0n=2]="Hidden";a[a.k1n=3]="NumberOfContentControlAppearance"})(db||(db={}));Object(w.b)("ContentControlAppearance",db);var rb;(function(a){a[a.Unknown=-1]="Unknown";a[a.X1n=0]="RichText";a[a.x1n=1]="PlainText";a[a.w1n=2]="Picture";a[a.W_n=3]="ComboBox";a[a.l0n=4]="DropDownList";a[a.O_n=5]="BuildingBlockGallery";a[a.Date=6]="Date";a[a.U1n=7]="RepeatSectionItem";a[a.S_n=8]="CheckBox";
a[a.T1n=9]="RepeatSection";a[a.Bibliography=10]="Bibliography";a[a.l1n=11]="NumberOfContentControlKinds"})(rb||(rb={}));Object(w.b)("ContentControlKind",rb);class Gb{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.U3a=this.Drc=this.Fic=this.Hrc=this.Abd=null;this.sfa=this.vk=this.Roc=this._id=0;this.eMb=this.VPb=this.Fhd=this._title=this.fua=null;this.O9c=this.N9c=this.Qqg=this.ted=this.clc=this.Zkc=this.L4c=!1;this.isg=null;this.Oe=!1;this.vee=null;this.zh=h;this.Mu=c;this.Tf=v;this.Sq=B;this.Hl=X;
this.uZ=ma;this.fna=Pa;this.dba=mb;this.wrb=Tb;this.mf=rc;a?(this.Abd=a.id,this.vee=a,this.kR(!1)):this._id=uf.a.nE()}get jh(){return this.zh.value}get id(){this.kR();return this._id}set id(a){this._id=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.Xx,this._id),this.aZ())}get parentId(){this.kR();return this.Roc}set parentId(a){this.Roc=a}get title(){this.kR();return this._title}set title(a){this._title=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.i9a,this._title),this.aZ(),this.wZc(c=>
{c.title=this._title?this._title:D.a.Pub}))}get tag(){this.kR();return this.Fhd}set tag(a){this.Fhd=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.Dxc,this.Fhd),this.aZ())}get type(){this.kR();return this.vk}set type(a){this.vk=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.Exc,rb[this.vk]),this.aZ())}get appearance(){this.kR();return this.sfa}set appearance(a){if(a&&1!==a&&2!==a)throw Error.argumentUndefined("The appearance value is undefined enum.");this.sfa=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.j9a,
db[this.sfa].toLowerCase()),this.aZ(),this.wZc(c=>{c.appearance=db[this.sfa].toLowerCase()}))}get color(){this.kR();return this.fua}set color(a){if(a&&16777215>=a)this.fua=a,this.Nc()&&(this.contentControlNode.setValue(Yb.a.yxc,this.fua),this.aZ(),this.wZc(c=>{c.color=this.fua}));else throw Error.argumentOutOfRange("The color value is out of range.");}get lUd(){this.kR();return this.VPb}set lUd(a){this.VPb=a}get Ytd(){this.kR();return this.eMb}set Ytd(a){this.eMb=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.Axc,
this.eMb),this.aZ())}get OYe(){this.kR();return this.L4c}set OYe(a){a&&(this.L4c=a,this.Nc()&&(this.contentControlNode.setValue(Yb.a.Hqd,this.L4c),this.aZ()))}get removeWhenEdited(){this.kR();return this.ted}set removeWhenEdited(a){if(a&&!this.tja)throw Error.invalidOperation("Cannot set RemoveWhenEdited to true property if the content control is undeletable.");this.ted=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.r6g,this.ted),this.aZ())}get tja(){this.kR();return this.Zkc}set tja(a){if(!a&&
this.removeWhenEdited)throw Error.invalidOperation("Cannot set IsDeletable property to false if the content control RemoveWhenEdited property is true.");this.Zkc=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.Bxc,this.Zkc),this.wZc(c=>{c.AU=this.Zkc}),this.aZ())}get isEditable(){this.kR();return this.clc}set isEditable(a){this.clc=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.Jtb,this.clc),this.wZc(c=>{c.editable=this.clc}),this.aZ())}get isSupported(){this.kR();return this.Qqg}get WTl(){this.kR();
return this.eMb&&"table of contents"===this.eMb.toLowerCase()?!0:!1}get xJd(){this.kR();return this.N9c}set xJd(a){this.N9c=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.t6g,this.N9c),this.aZ())}get W2b(){this.kR();return this.O9c}set W2b(a){this.O9c=a;this.Nc()&&(this.contentControlNode.setValue(Yb.a.u6g,this.O9c),this.aZ())}get DM(){return this.contentControlNode.ia(Yb.a.F3,!1)}set DM(a){this.Nc()&&this.contentControlNode.setValue(Yb.a.F3,a)}get yh(){this.kR();return this.Hrc}set yh(a){this.Hrc=
a}get Ti(){this.kR();return this.Fic}set Ti(a){this.Fic=a}get objectId(){return this.Abd}set objectId(a){this.Abd=a;this.vee=this.jh.Ra(this.Abd)}get start(){this.cWi();return this.Drc}set start(a){this.Drc=a}get end(){this.cWi();return this.U3a}set end(a){this.U3a=a}get contentControlNode(){return this.vee}Uym(a){for(let c=0;3>c;++c)if(db[c].toLowerCase()===a)return c;return 0}Vym(a){for(let c=0;11>c;++c)if(rb[c]===a)return c;return-1}aZ(){const a=this.start.node;a&&a.setValue(Ed.a.z4,new Date)}adc(){var a,
c,h,v;this._id=this.contentControlNode.ia(Yb.a.Xx,0);this.sfa=this.Uym(this.contentControlNode.ia(Yb.a.j9a,null));this.fua=this.contentControlNode.ia(Yb.a.yxc,null);this._title=this.contentControlNode.ia(Yb.a.i9a,null);this.Fhd=this.contentControlNode.ia(Yb.a.Dxc,null);this.Oe=this.contentControlNode.ia(Yb.a.k4,!1);this.Zkc=this.contentControlNode.ia(Yb.a.Bxc,!1);this.clc=this.contentControlNode.ia(Yb.a.Jtb,!1);this.Qqg=this.contentControlNode.ia(Yb.a.Iba,!1);this.eMb=this.contentControlNode.ia(Yb.a.Axc,
null);this.L4c=this.contentControlNode.ia(Yb.a.Hqd,!1);wn.a.kk?(this.Hrc=null!==(c=this.mf.Aq.get(null===(a=this.contentControlNode.id)||void 0===a?void 0:a.toString()))&&void 0!==c?c:N.a.nil,this.Fic=null!==(v=this.mf.vr.get(null===(h=this.contentControlNode.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:N.a.nil):(this.Hrc=this.contentControlNode.ia(Yb.a.yh,N.a.nil),this.Fic=this.contentControlNode.ia(Yb.a.Ti,N.a.nil));this.O9c=this.contentControlNode.ia(Yb.a.u6g,!1);this.N9c=this.contentControlNode.ia(Yb.a.t6g,
!1);this.ted=this.contentControlNode.ia(Yb.a.r6g,!1);this.vk=this.Vym(this.contentControlNode.ia(Yb.a.Exc,"RichText"));a=null;try{const B=this.contentControlNode.ia(Yb.a.Iha,N.a.nil);if(N.a.Go(B,N.a.nil))this.Roc=0;else if(a=this.jh.Ra(B))this.Roc=a.ia(Yb.a.Xx,0)}catch(B){this.Roc=0}this.eQn()}eQn(){if(this.wrb){var a=this.contentControlNode.ia(Yb.a.lSe,"");if((a=this.fna.FFh(a))&&0<a.length){this.VPb=this.Wph(a.sa,a.Pb);return}}this.VPb=(a=this.Tf.vya())&&a.currentNode?a.currentNode.ia(Yb.a.zxc,
null):null}kR(a=!0){if(!a||this.Nc())a=this.contentControlNode.ia(Ed.a.lastModifiedTime,new Date(0)),this.isg!==a&&(this.adc(),this.isg=a)}kRn(a,c){var h,v;this.Hrc=a;this.Fic=c;wn.a.kk?(this.mf.Aq.set(null===(h=this.contentControlNode.id)||void 0===h?void 0:h.toString(),a),this.mf.vr.set(null===(v=this.contentControlNode.id)||void 0===v?void 0:v.toString(),c)):(this.contentControlNode.setValue(Yb.a.yh,a),this.contentControlNode.setValue(Yb.a.Ti,c))}cWi(){if(this.contentControlNode){var a=this.yh,
c=this.Ti;if(!a||!c||a.equals(N.a.nil)||c.equals(N.a.nil))r.ULS.sendTraceTag(17330978,368,10,"StartObjectId/EndObjectId are not initialized before trying to update Start/End contexts.");else if(a=this.Tf.yia(a,!0),c=this.Tf.yia(c,!1),a&&c)if(a.isConnected&&c.isConnected||r.ULS.sendTraceTag(37777626,368,10,"StartParaNode/EndParaNode are not connected."),this.Oe)a=Oe.a.create(a),this.Sq.uZc(a,this.objectId,!0),this.start=a,a=Oe.a.create(c),this.Sq.uZc(a,this.objectId,!0),this.end=a;else{let h=c=-1;
if(a.la){for(let v=0;v<a.la.length&&(-1===c||-1===h);v++){const B=a.la.J(v);if(B.Wa)for(let X=0;X<B.Wa.length&&(-1===c||-1===h);X++){const ma=B.Wa.J(X);N.a.Go(ma.ud,this.objectId)&&(ma.Nb?c=B.cp:h=B.cp)}}0<=c&&0<=h&&(a=Oe.a.dM(c,h,!1,a),this.Sq.uZc(a,this.objectId,!0),this.start=this.end=a)}}}}getText(){let a="";var c=this.start;const h=this.end;if(!c||!h)return a;this.Oe?a=this.Wph(c,h):(c=sd.ParagraphReader.text(c.node).substring(c.cpBegin,h.cpEnd),a+=Fb.AParagraphNode.l1(c));return a}Nc(){return!!this.contentControlNode&&
this.contentControlNode.isConnected}setText(a){return this.dba?this.Hl.FDi(this,a)?0:2:2}clear(){return this.dba?this.Hl.FDi(this,"")?0:2:2}Qrh(){const a=new Ua.a;var c=this.contentControlNode.ia(Yb.a.contentControlNode,[]);for(let h of c)if(!N.a.Go(h,N.a.nil)){c=this.zh.value.Ra(h);try{a.add(this.uZ.Ytb(c,this.Mu,this.zh,this.Tf,this.Sq,this.Hl,this.fna,this.dba,this.wrb))}catch(v){}}return a}Q4e(){const a=new Ua.a;this.Oph(this,a);return a}Oph(a,c){a=a.Qrh();if(a.count)for(let h of a)c.add(h),this.Oph(h,
c)}LD(a=!1){const c=new Ua.a;if(this.Oe){var h=this.Hl.rR(this.start,this.end);for(var v of h)h=Oe.a.create(v),this.Sq.uZc(h,this.objectId,a),c.add(h)}else v=this.start.clone(),this.Sq.uZc(v,this.objectId,a),c.add(v);return c}wZc(a){const c=this.Hl.rR(this.start,this.end);for(let h=0;h<c.count;h++){const v=this.Sq.q6e(c.J(h),this.objectId,!1);if(v){for(let B=0;B<v.count;B++)a(v.J(B));c.J(h).Ui()}}}Wph(a,c){const h=new Sys.StringBuilder;c=this.Hl.rR(a,c);for(let v of c)v.id.equals(a.node.id)||h.append("\r"),
h.append(sd.ParagraphReader.plainText(v));return h.toString()}}Object(w.a)(Gb,"ContentControl",null,[379]);class bc{constructor(a){this.mf=a}Ytb(a,c,h,v,B,X,ma,Pa,mb){return new Gb(a,c,h,v,B,X,this,ma,Pa,mb,this.mf)}}Object(w.a)(bc,"ContentControlFactory",null,[346]);var Ic=b(826);class ed{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.Mu=a;this.zh=c;this.Vb=h;this.HPb=v;this.xaj=B;this.Do=X;this.Vd=ma;this.Ba=Pa;this.Gcd=mb;this.N6c=Tb;this.mf=rc}get Aq(){return this.mf.Aq}get vr(){return this.mf.vr}get wC(){return this.Mu.value}vya(){const a=
this.Vb.Dj();a.set(this.wC);this.HPb.aS(a);if(a.Za(25))return a;this.N6c.instance&&this.N6c.instance.sja&&r.ULS.sendTraceTag(17040640,368,10,"Content Control root node doesn't exist");r.ULS.sendTraceTag(528537619,368,15,"getContentControlRootIterator() returning null");return null}DDc(a,c,h=!1){this.cYb();const v=new Ua.a;let B;if(a){B=a.Za(26);if(!B)return v;for(;B&&(!c(B)||(v.add(B),!h));){v.addRange(this.DDc(a,c));if(h&&0<v.count)break;B=a.ue(26)}a.ob()}return v}m$k(){const a=this.Vb.Dj();a.set(this.Mu.value);
this.HPb.aS(a);return a.currentNode}qKa(a,c,h){let v;v=a.equals(c);v||(v=(a=this.yia(a,h))?a.id.equals(c):!1);return v}FIa(a,c){var h,v,B,X;a=this.hr(a);if(!a)return null;let ma=null;for(;55===a.type;){let Pa;Pa=wn.a.kk?c?null!==(v=this.mf.Aq.get(null===(h=a.id)||void 0===h?void 0:h.toString()))&&void 0!==v?v:N.a.nil:null!==(X=this.mf.vr.get(null===(B=a.id)||void 0===B?void 0:B.toString()))&&void 0!==X?X:N.a.nil:c?a.ia(Yb.a.yh,N.a.nil):a.ia(Yb.a.Ti,N.a.nil);if(Pa.equals(ma)){a=null;break}else a=this.hr(Pa);
ma=Pa}return a}yia(a,c){return(a=this.FIa(a,c))?sd.ParagraphReader.tb(a)?a:c?this.Ba.Bl(a):this.Ba.uI(a):null}kch(a,c=!1){this.dMn(a);this.lch(a,c)}dMn(a){var c,h,v,B,X,ma,Pa,mb,Tb=this.uya(a);Tb=this.uya(Tb.parentNode);Tb=55===Tb.currentNode.type?Tb.currentNode.id:null;let rc;if(wn.a.kk){rc=this.hr(null!==(h=this.mf.Aq.get(null===(c=a.id)||void 0===c?void 0:c.toString()))&&void 0!==h?h:N.a.nil);for(c=this.hr(null!==(B=this.mf.vr.get(null===(v=a.id)||void 0===v?void 0:v.toString()))&&void 0!==B?B:
N.a.nil);rc&&55===rc.type;)rc=this.hr(null!==(ma=this.mf.Aq.get(null===(X=rc.id)||void 0===X?void 0:X.toString()))&&void 0!==ma?ma:N.a.nil);for(;c&&55===c.type;)c=this.hr(null!==(mb=this.mf.vr.get(null===(Pa=c.id)||void 0===Pa?void 0:Pa.toString()))&&void 0!==mb?mb:N.a.nil)}else{rc=this.hr(a.getValue(Yb.a.yh));for(c=this.hr(a.getValue(Yb.a.Ti));rc&&55===rc.type;)rc=this.hr(rc.getValue(Yb.a.yh));for(;c&&55===c.type;)c=this.hr(c.getValue(Yb.a.Ti))}rc&&c&&this.RTi(rc.id,c.id,Tb,Tc=>{Tc=Tc.ia(Yb.a.vU,
N.a.nil);return!Tc||Tc.equals(N.a.nil)||a.id.equals(Tc)})}lch(a,c=!1){var h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee;r.ULS.sendTraceTag(528537620,368,50,"Attempting to delete content control node");const Ie=this.uya(a),Xe=this.uya(Ie.parentNode);let Yf=N.a.nil,Hh=N.a.nil;var Fi=Xe.currentNode.ia(Yb.a.contentControlNode,[]);const wk=new Ua.a;for(let Kl=0;Kl<Fi.length;Kl++)wk.add(Fi[Kl]);if(c){if(54!==Xe.currentNode.type){wn.a.kk?(Yf=this.mf.Aq.get(null===(h=Xe.currentNode.id)||void 0===h?void 0:h.toString()),
Hh=this.mf.vr.get(null===(v=Xe.currentNode.id)||void 0===v?void 0:v.toString())):(Yf=Xe.currentNode.getValue(Yb.a.yh),Hh=Xe.currentNode.getValue(Yb.a.Ti));Fi=this.hr(Yf);for(h=this.hr(Hh);Fi&&55===Fi.type;)Yf=wn.a.kk?this.mf.Aq.get(null===(B=Fi.id)||void 0===B?void 0:B.toString()):Fi.getValue(Yb.a.yh),Fi=this.hr(Yf);for(;h&&55===h.type;)Hh=wn.a.kk?this.mf.vr.get(null===(X=h.id)||void 0===X?void 0:X.toString()):h.getValue(Yb.a.Ti),h=this.hr(Hh)}B=this.uya(a);if(B.Za(26)){X=new Ua.a;for(X.add(B.currentNode);B.ue(26);)X.add(B.currentNode);
for(var Gk of X)this.lch(Gk,c)}}else if(wn.a.kk?(Yf=this.mf.Aq.get(null===(ma=a.id)||void 0===ma?void 0:ma.toString()),Hh=this.mf.vr.get(null===(Pa=a.id)||void 0===Pa?void 0:Pa.toString())):(Yf=a.getValue(Yb.a.yh),Hh=a.getValue(Yb.a.Ti)),c=this.O3k(wk,a.id),Gk=this.uya(a),Gk.Za(26))for(B=this.uya(Gk.currentNode),X=B.currentNode,Fi=a;X;)h=Gk.currentNode,wk.insert(c++,h.id),X=B.ue(26),v=this.uya(h),54!==Xe.currentNode.type?h.setValue(Yb.a.Iha,Xe.currentNode.id):h.removeProperty(Yb.a.Iha),Nr.g(v,Xe,
Fi,26),Fi=v.currentNode,X&&(Gk.set(X),Gk.WY(this.vya().currentNode));54!==Xe.currentNode.type&&(c=wn.a.kk?null!==(Tb=this.mf.Aq.get(null===(mb=Xe.currentNode.id)||void 0===mb?void 0:mb.toString()))&&void 0!==Tb?Tb:N.a.nil:Xe.currentNode.ia(Yb.a.yh,N.a.nil),mb=wn.a.kk?null!==(Tc=this.mf.vr.get(null===(rc=Xe.currentNode.id)||void 0===rc?void 0:rc.toString()))&&void 0!==Tc?Tc:N.a.nil:Xe.currentNode.ia(Yb.a.Ti,N.a.nil),c.equals(a.id)&&(wn.a.kk?this.mf.Aq.set(null===(vd=Xe.currentNode.id)||void 0===vd?
void 0:vd.toString(),Yf):Xe.currentNode.setValue(Yb.a.yh,Yf)),mb.equals(a.id)&&(wn.a.kk?this.mf.vr.set(null===(ee=Xe.currentNode.id)||void 0===ee?void 0:ee.toString(),Hh):Xe.currentNode.setValue(Yb.a.Ti,Hh)));Ie.xf();r.ULS.sendTraceTag(528537621,368,50,"Disconnected nodeToDelete");this.remove(wk,a.id);Fi=Array(wk.count);for(rc=0;rc<wk.count;rc++)Fi[rc]=wk.J(rc);Xe.currentNode.setValue(Yb.a.contentControlNode,Fi);Ic.a.pAa(a.id)}LCj(a,c,h,v,B,X,ma=null){var Pa,mb,Tb,rc,Tc,vd,ee,Ie;let Xe,Yf;c?(Xe=this.hr(c.objectId),
Yf=this.uya(Xe)):(Yf=this.vya(),Xe=Yf.currentNode);const Hh=this.xaj.create(1074135145);ma&&Hh.properties.Zq(ma.properties);wn.a.kk||(Hh.setValue(Yb.a.yh,B),Hh.setValue(Yb.a.Ti,X));54!==Xe.type&&Hh.setValue(Yb.a.Iha,Xe.id);ma?Yf.bzb(Hh,h,26,ma.id):Yf.TG(Hh,h,26);wn.a.kk&&(this.mf.Aq.set(null===(Pa=Hh.id)||void 0===Pa?void 0:Pa.toString(),B),this.mf.vr.set(null===(mb=Hh.id)||void 0===mb?void 0:mb.toString(),X));a.Oe&&(c&&(h=wn.a.kk?null!==(rc=this.mf.Aq.get(null===(Tb=Xe.id)||void 0===Tb?void 0:Tb.toString()))&&
void 0!==rc?rc:N.a.nil:Xe.ia(Yb.a.yh,N.a.nil),Tb=wn.a.kk?null!==(vd=this.mf.vr.get(null===(Tc=Xe.id)||void 0===Tc?void 0:Tc.toString()))&&void 0!==vd?vd:N.a.nil:Xe.ia(Yb.a.Ti,N.a.nil),h.equals(B)&&(wn.a.kk?this.mf.Aq.set(null===(ee=Xe.id)||void 0===ee?void 0:ee.toString(),Hh.id):Xe.setValue(Yb.a.yh,Hh.id)),Tb.equals(X)&&(wn.a.kk?this.mf.vr.set(null===(Ie=Xe.id)||void 0===Ie?void 0:Ie.toString(),Hh.id):Xe.setValue(Yb.a.Ti,Hh.id))),this.RTi(B,X,Hh.id,Fi=>{Fi=Fi.ia(Yb.a.vU,N.a.nil);const wk=c?c.objectId:
null;return!Fi||Fi.equals(N.a.nil)||Fi.equals(wk)}));B=this.uya(Hh);X=Array(v.count);for(Tc=v.count-1;0<=Tc;Tc--)X[Tc]=v.J(Tc).objectId,vd=this.hr(v.J(Tc).objectId),vd=this.uya(vd),vd.currentNode.setValue(Yb.a.Iha,Hh.id),Nr.g(vd,B,null,26);0<X.length&&Hh.setValue(Yb.a.contentControlNode,X);ed.Ua.isFeatureEnabled(54)&&(a.Ytd&&Hh.setValue(Yb.a.Axc,a.Ytd),a.OYe&&Hh.setValue(Yb.a.Hqd,!0));return Hh}jdn(a,c,h,v){a.setValue(Yb.a.k4,c);a.setValue(Yb.a.Bxc,!0);a.setValue(Yb.a.Jtb,!0);a.setValue(Yb.a.Xx,h);
a.setValue(Yb.a.j9a,db[0]);a.setValue(Yb.a.Iba,!0);a.setValue(Yb.a.Exc,"RichText");v&&a.setValue(Yb.a.jIb,v);a.setValue(Yb.a.cWb,0)}vch(a){if(!a||!a.count||!a.J(0))return null;const c=this.m$e(a);for(let h=0;h<a.count;h++)this.Vd.b_a(a.J(h));return c}m$e(a){if(!a||!a.J(0))return null;const c=this.Vb.Dj();c.set(a.J(0));c.nc();c.ob();return c.RD()?c.currentNode:null}sal(a){const c=this.Vb.Dj();c.set(a);c.nc();c.ob();c.ob();return c}sOg(a,c,h){const v=new Ua.a;for(let B=0;B<h;B++){c=this.Do.ecb(a,c,
!0,null);if(!c||!a.Xc())return null;const X=a.currentNode;a.ob();a.ob();v.add(X)}return v}$_b(a){const c=this.Vb.Dj();c.set(a);for(c.La(7);c.ob();)switch(c.currentNode.type){case 8:case 16:case 36:case 40:return c.currentNode.id}return null}Czh(a){const c=this.Vb.Dj();c.set(a);c.nc();return(a=c.IMa())?a.id:null}z8e(a){const c=this.Vb.Dj();c.set(a);return c.La(7)?c:null}hr(a){return this.zh.value.Ra(a)}cYb(){if(!ed.oog){var a=this.vya();a&&this.eZf(a);ed.oog=!0}}rNa(a){return this.Gcd.rNa(a)}yKj(a,
c){const h=this.Vb.Dj();h.set(a.node);const v=this.Vb.Dj();v.set(c.node);h.nc();v.nc();const B=this.Vb.Dj();B.set(h.currentNode);const X=this.Vb.Dj();X.set(v.currentNode);const ma=Fe.returnToLowestCommonTableCell(h,v);return ma?(B.nc(),X.nc(),{returnValue:({ly:a}=this.Yod(B,!0,ma,a)).returnValue&&({ly:c}=this.Yod(X,!1,ma,c)).returnValue,HKi:a,thh:c}):{returnValue:({ly:a}=this.Yod(h,!0,null,a)).returnValue&&({ly:c}=this.Yod(v,!1,null,c)).returnValue,HKi:a,thh:c}}Yod(a,c,h,v){let B=null,X=a.mc(16);
for(;X!==h;){if(c&&Tf.TableCellReader.$Kl(a)||!c&&Tf.TableCellReader.zTh(a))B=a.mc(14);else return{returnValue:!1,ly:v};X=a.mc(16)}B&&(v=Oe.a.create(B));return{returnValue:!0,ly:v}}eZf(a){if(a.Za(26)){for(this.eZf(a);a.ue(26);)this.eZf(a);a.ob()}}remove(a,c){for(let h=0;h<a.count;h++)if(a.J(h).toString()===c.toString()){a.removeAt(h);break}}uya(a){const c=this.Vb.Dj();c.set(a);c.WY(this.vya().currentNode);return c}O3k(a,c){for(let h=0;h<a.count;h++)if(a.J(h).equals(c))return h;return-1}RTi(a,c,h,
v){a=this.aWk(a,c);for(c=0;c<a.count;c++)v(a.J(c))&&(h?a.J(c).setValue(Yb.a.vU,h):a.J(c).removeProperty(Yb.a.vU),this.N6c.instance&&this.N6c.instance.MQh&&a.J(c).lj(16,!0))}aWk(a,c){const h=new Ua.a;var v=this.hr(a);const B=this.hr(c);if(!v||!B)return h;const X=({FLc:ma}=this.eyd(v,B)).returnValue;v=ma[X];if(14===v.type)h.add(v);else if(15===v.type&&1<=X){const Pa=ma[X-1];1===Wf.TableReader.kf(Pa)&&h.add(Pa)}var ma=Kd.GraphIterator.va(X>=ma.length-1?v:ma[X+1]);ma.La(7);for(v=Tl.a.eq(ma,v);v.moveNext()&&
v.currentNode!==B;)14===v.currentNode.type&&h.add(v.currentNode);if(!N.a.Go(c,a)&&14===B.type)for(ma=Kd.GraphIterator.va(B),v=Tl.a.eq(ma,B);v.moveNext();)14===v.currentNode.type&&h.add(v.currentNode);return h}eyd(a,c){a=this.hab(a);c=this.hab(c);let h=0;for(;h<a.length&&h<c.length&&a[h]===c[h];++h);return{returnValue:0<h?h-1:h,FLc:a,aNf:c}}hab(a){const c=[];c.push(a);a=Kd.GraphIterator.va(a);for(a.La(7);a.ob();)c.push(a.currentNode);c.reverse();return c}static get Ua(){return ed.Na||(ed.Na=xa.a.instance.ra("Box4.IFeatureHelper"))}}
ed.oog=!1;ed.Na=null;Object(w.a)(ed,"ContentControlGraphManager",null,[345]);class Gd{constructor(a,c,h,v,B,X,ma,Pa,mb){this.oma=null;Gd.Mu=a;Gd.zh=c;this.Tf=h;this.Sq=v;this.Hl=B;this.uZ=X;this.fna=ma;this.$d=Pa;this.mn=mb}get WJa(){return!!this.$d.instance&&this.$d.instance.WJa}get sja(){return!!this.$d.instance&&this.$d.instance.sja}get UHd(){return!!this.$d.instance&&this.$d.instance.UHd}get $U(){return!!this.$d.instance&&this.$d.instance.$U}get WHd(){return!!this.$d.instance&&this.$d.instance.WHd}Hzb(){return!!this.$d.instance&&
this.$d.instance.Hzb}Zga(a,c,h=null,v=null,B=!1){if(!this.WJa)return{returnValue:2,id:0};a=this.Tf.yia(a,!0);c=this.Tf.yia(c,!1);if(!a||!c)return{returnValue:2,id:0};a=Oe.a.create(a);c=Oe.a.create(c);return this.dNg(a,c,h,v,B)}TBj(a,c){return this.WJa&&a&&c?this.dNg(a,c,null):{returnValue:2,id:0}}Orb(a,c=null,h=!1){let v=0;if(!this.WJa)return{returnValue:2,id:v};const B=this.uZ.Ytb(c,Gd.Mu,Gd.zh,this.Tf,this.Sq,this.Hl,this.fna,this.WJa,this.UHd);B.start=a;B.end=a;B.yh=a.node.id;B.Ti=a.node.id;B.Oe=
!1;return this.Hl.dOg(B,c,h)?(v=B.id,{returnValue:0,id:v}):{returnValue:2,id:v}}KCj(a,c,h=null){c=0;if(!this.WJa||!this.VLl(a))return{returnValue:2,id:c};var v=a.J(0).contextId===ic.a.endOfParagraph?a.J(1):a.J(0);const B=a.J(a.count-1);if(this.WRe(a,ic.a.paragraph)||this.WRe(a,ic.a.endOfParagraph)){a=v.node.id;c=B.node.id;const X=a.equals(c);v=this.Hl.jKi(v,!0);void 0!==v&&null!==v&&(a=v,c=X?a:c);this.Hl.jKi(B,!1);h.setValue(Yb.a.k4,!0);return this.Zga(a,c,h)}return v!==B||v.contextId!==ic.a.xc&&
v.contextId!==ic.a.Ub?{returnValue:2,id:c}:(h.setValue(Yb.a.k4,!1),this.Orb(v,h))}getById(a){if(!this.sja)return null;const c=this.Tf.DDc(this.Tf.vya(),h=>h.getValue(Yb.a.Xx)===a,!0);return 0<c.count?this.Hl.rX(c.J(0)):null}getByTitle(a){if(!this.sja)return null;const c=this.Tf.DDc(this.Tf.vya(),v=>v.ia(Yb.a.i9a,null)===a,!1),h=new Ua.a;for(let v of c)h.add(this.Hl.rX(v));return h}getByTag(a){if(!this.sja)return null;const c=this.Tf.DDc(this.Tf.vya(),v=>v.ia(Yb.a.Dxc,null)===a,!1),h=new Ua.a;for(let v of c)h.add(this.Hl.rX(v));
return h}nO(a,c,h,v=!1){return this.sja?this.$U?this.Hl.JIa(a,c,h):this.Hl.nO(a,c,h,v):null}rR(a,c){return this.Hl.rR(a,c)}aRk(){if(!this.sja)return null;const a=this.Tf.DDc(this.Tf.vya(),()=>!0,!1),c=new Ua.a;for(let h of a)c.add(this.Hl.rX(h));return c}O8b(a){if(!this.WJa)return r.ULS.sendTraceTag(528537618,368,15,"Cannot release content control, isContentControlWriteEnabled = false"),2;a=this.getById(a);return this.Hl.yBa(a)?0:2}Sqk(a){if(!this.WJa)return 2;a=this.getById(a);return this.Hl.deleteContentControl(a)?
0:2}aDj(a){this.Hl.qRm(a)}rTj(a){this.oma=a;this.oma.hTm(Object(m.a)(this,this.ePl,"isOperationAllowed"))}qWk(a){if(!this.Hzb())return null;let c;var h=a.LD();c=this.jAd(h.J(h.count-1),!1);h=this.Sq.XAd(h.J(h.count-1).node,c.cpBegin).Wa;a=this.ril(h,a);if(-1===a)return null;c.Qa=a;c.$a=c.Qa;return c}ePl(a,c){if(this.$U)return this.fPl(a,c);if(!a||!a.count)return r.ULS.sendTraceTag(17356048,368,15,"The GNC list should not be null or empty"),!1;let h=!0;switch(c){case 0:c=this.nO(a.J(0),a.J(a.count-
1),1);if((a=this.nO(a.J(0),a.J(a.count-1),3))&&0<a.count){if(!a.J(0).isSupported||!a.J(0).isEditable){h=!1;break}for(a=a.J(0);a;)this.CSc(c,a.id),a=this.getById(a.parentId)}if(c)for(var v of c)if(!v.isSupported||!v.isEditable){h=!1;break}break;case 1:if(a.J(0).contextId!==ic.a.Ub){r.ULS.sendTraceTag(17356049,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.Inserting");h=!1;break}(c=this.nO(a.J(0),a.J(0),1))&&0<c.count&&(h=!1);break;case 2:if(a.J(0).contextId!==ic.a.Ub){r.ULS.sendTraceTag(17424994,
368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary");h=!1;break}(c=this.nO(a.J(0),a.J(0),3))&&0<c.count&&(h=!1);break;case 3:case 4:c=this.jAd(a.J(0),!0);v=this.jAd(a.J(a.count-1),!1);if(!c||!v){r.ULS.sendTraceTag(17356050,368,15,"The GNC list is not supported for ApiOperation.Clearing or ApiOperation.Replacing");h=!1;break}if((c=this.nO(c,c,3))&&0<c.count){h=!1;break}if((c=this.nO(v,v,3))&&0<c.count){h=!1;break}if(c=this.Hl.nO(a.J(0),a.J(a.count-
1),1))for(let B of c)if(!B.tja){h=!1;break}break;default:h=!1}return h}fPl(a,c){if(!a||!a.count)return r.ULS.sendTraceTag(21031131,368,15,"The GNC list should not be null or empty"),!1;switch(c){case 0:return this.fKl(a);case 3:case 4:case 6:return this.eRl(a,6===c);case 1:case 2:case 5:return 1!==a.count||a.J(0).contextId!==ic.a.Ub?(r.ULS.sendTraceTag(21031132,368,15,"The only GNC in the GNC list should always be an IpContext for ApiOperation.InsertingIgnoringBoundary"),!1):this.eTh(a.J(0),5===c,
!1);default:return!1}}fKl(a){const c=this.Hl.JIa(a.J(0),a.J(a.count-1),3);if(c&&0<c.count){var h=c.J(0);if(!h.isSupported||!h.isEditable)return!1}a=this.Hl.JIa(a.J(0),a.J(a.count-1),1);for(h=0;c&&h<c.count;h++)this.CSc(a,c.J(h).id);if(a)for(let v of a)if(!v.isSupported||!v.isEditable)return!1;return!0}eRl(a,c){var h=a.J(0),v=a.J(a.count-1),B=h.Xl,X=v.Tu;if(-1===B||-1===X)return!1;B=this.mn.m8(h.node,B,h.Qa);X=this.mn.m8(v.node,X,v.$a);var ma=-1,Pa=Math.min(B.count,X.count);for(--Pa;0<=Pa;Pa--){const mb=
B.J(Pa).ud,Tb=X.J(Pa).ud;if(mb.equals(Tb)){ma=Pa;break}}if(-1<ma&&(Pa=this.Hl.rX(B.J(ma).contentControlNode),!Pa.isEditable||!Pa.isSupported||Pa.DM&&!this.LJl(Pa,a)))return!1;h=this.Hl.JIa(h,v,1);for(v=0;v<=ma;v++)this.CSc(h,this.Hl.rX(B.J(v).contentControlNode).id);for(v=ma+1;v<B.count;v++){Pa=this.Hl.rX(B.J(v).contentControlNode);if(!Pa.isEditable||!Pa.tja||!Pa.isSupported||Pa.DM)return!1;this.CSc(h,Pa.id)}for(B=ma+1;B<X.count;B++){ma=this.Hl.rX(X.J(B).contentControlNode);if(!ma.isEditable||!ma.tja||
!ma.isSupported||ma.DM)return!1;this.CSc(h,ma.id)}if(h)for(let mb of h)if(!mb.isSupported||!mb.tja)return!1;return c&&(a=this.jAd(a.J(0),!0))?this.eTh(a,!0,!0):!0}LJl(a,c){c=this.mn.oal(c.J(0),c.J(c.count-1));return!!a&&!!c&&a.objectId.equals(c.ud)}eTh(a,c,h){return(a=this.Hl.JIa(a,a,3))&&0<a.count&&(a=a.J(0),!a.isSupported||!a.isEditable||!this.WHd&&c&&!a.Oe||!h&&a.DM)?!1:!0}jAd(a,c){if(!a)return null;let h=null;switch(a.contextId){case ic.a.paragraph:h=c?Oe.a.Sb(a.node,0):Oe.a.av(a.node);break;
case ic.a.endOfParagraph:h=Oe.a.av(a.node);break;case ic.a.xc:h=c?Oe.a.Sb(a.node,a.cpBegin):Oe.a.Sb(a.node,a.cpEnd);break;case ic.a.Ub:h=a}h&&(h.$a=h.Qa=c?a.Qa:a.$a);return h}CSc(a,c){if(a)for(let h of a)if(h.id===c){a.remove(h);break}}ril(a,c){if(!a)return-1;let h=-1;for(let v=0;v<a.length;v++)if(a.J(v).ud.equals(c.objectId)&&!1===a.J(v).Nb){h=v;if(c.Oe&&0<v&&a.J(v-1).Oe&&!a.J(v-1).Nb)return-1;break}return h}VLl(a){if(void 0===a||null===a)return!1;for(let c=0;c<a.count;c++){const h=a.J(c).contextId;
if(h!==ic.a.paragraph&&h!==ic.a.endOfParagraph&&h!==ic.a.xc&&h!==ic.a.Ub||0<c&&c<a.count-1&&h===ic.a.xc&&(a.J(c).cpBegin||a.J(c).cpEnd!==a.J(c).node.characterData.length))return!1}return a.J(0).contextId===ic.a.endOfParagraph&&1===a.count||this.WRe(a,ic.a.Ub)&&1<a.count?!1:!0}WRe(a,c){for(let h of a)if(h.contextId===c)return!0;return!1}dNg(a,c,h=null,v=null,B=!1){let X=0;var ma=c.node;let Pa=Oe.a.create(a.node);ma=Oe.a.create(ma);if(!({HKi:Pa,thh:ma}=this.Tf.yKj(Pa,ma)).returnValue)return{returnValue:2,
id:X};const mb=this.uZ.Ytb(h,Gd.Mu,Gd.zh,this.Tf,this.Sq,this.Hl,this.fna,this.WJa,this.UHd);mb.start=a;mb.end=c;mb.yh=Pa.node.id;mb.Ti=ma.node.id;mb.Oe=!0;mb.Ytd=v;mb.OYe=B;return this.Hl.dOg(mb,h)?(X=mb.id,{returnValue:0,id:X}):{returnValue:2,id:X}}}Gd.Mu=null;Gd.zh=null;Object(w.a)(Gd,"ContentControlManager",null,[344]);var pe=b(640),ue=b(148),ff=b(181);class Lf extends Sys.EventArgs{constructor(a){super();this.Wok=a}}Object(w.a)(Lf,"ContentControlChangeEventArgs",Sys.EventArgs,[]);class Ug{constructor(){this.d8h=
0;this.vgi=null}}Object(w.a)(Ug,"BypassIfNodeOfTypeAndParentMatchingConditionFilterData",null,[]);class fd{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh,Fi,wk,Gk,Kl,Yj){this.zBg=[];this.txe=[];this.Mu=a;this.zh=c;this.Tf=h;this.Sq=v;this.uZ=B;this.nd=mb;this.Tk=Tb;this.ya=X;this.LA=ma;this.qva=Pa;this.fna=ee;this.wrb=Ie;this.dba=rc;this.$F=Tc;this.ga=vd;this.mn=Xe;this.$d=Yf;this.Rf=Hh;this.Ba=Fi;this.Fb=wk;this.WKg=Gk;this.Na=Kl;this.mf=Yj;this.$F&&(this.$F.addHandler(pe.a.KEb,Object(m.a)(this,
this.gdi,"onShowingPlaceholder")),this.$F.addHandler(pe.a.iYd,Object(m.a)(this,this.sci,"onRemoveWhenEdited")))}get wC(){return this.Mu.value}get jh(){return this.zh.value}get $U(){return!!this.$d.instance&&this.$d.instance.$U}get N8(){return!!this.Na&&this.Na.isFeatureEnabled(41)}get tIl(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContentControlGetActualParagraphNodeCrashFixIsEnabled",!1)}dispose(){this.$F&&(this.$F.removeHandler(pe.a.KEb,Object(m.a)(this,
this.gdi,"onShowingPlaceholder")),this.$F.removeHandler(pe.a.iYd,Object(m.a)(this,this.sci,"onRemoveWhenEdited")))}nO(a,c,h,v=!1){if(this.$U)return this.JIa(a,c,h);if(!a||!c)return null;const B=this.Tf.yia(a.node.id,!0);var X=this.Tf.yia(c.node.id,!1);if(!B||!X)return null;a=a.contextId===ic.a.endOfParagraph?a:Oe.a.Sb(B,-1===a.cpBegin?0:a.cpBegin);c=c.contextId===ic.a.endOfParagraph?c:Oe.a.Sb(X,-1===c.cpEnd?X.characterData.length:c.cpEnd);X=null;switch(h){case 0:X=this.x_k(a,c);break;case 1:X=this.Aal(a,
c);break;case 3:X=this.fAh(a,c,v);break;case 2:X=this.sjl(a,c);break;case 4:X=this.Lsh(a,c,!1)}return X}JIa(a,c,h){if(!a||!c||a.contextId!==ic.a.endOfParagraph&&(a=this.T6g(a,!0),!a)||c.contextId!==ic.a.endOfParagraph&&(c=this.T6g(c,!1),!c))return null;let v=null;switch(h){case 0:v=this.y_k(a,c);break;case 1:v=this.Bal(a,c);break;case 3:v=this.gAh(a,c);break;case 2:v=this.tjl(a,c);break;case 4:v=this.Lsh(a,c,!0)}return v}T6g(a,c){var h=this.Tf.yia(a.node.id,c);if(!h)return null;c?(c=-1===a.cpBegin?
0:a.cpBegin,a=a.Qa):(c=-1===a.cpEnd?h.characterData.length:a.cpEnd,a=a.$a);h=Oe.a.Sb(h,c);h.Qa=a;h.$a=a;return h}x_k(a,c){const h=new Ua.a;if(a.contextId===ic.a.endOfParagraph||c.contextId===ic.a.endOfParagraph||a.equals(c))return h;const v=new dm.a,B=this.Cwb(a,a),X=this.Cwb(c,c);for(let ma=0;ma<B.count;ma++)if(B.J(ma).Nb)for(let Pa=0;Pa<X.count;Pa++)X.J(Pa).Nb||B.J(ma).ud.equals(X.J(Pa).ud)&&(!B.J(ma).Oe||this.Tf.qKa(B.J(ma).ud,a.node.id,!0)&&this.Tf.qKa(X.J(Pa).ud,c.node.id,!1))&&this.Hkd(h,v,
B.J(ma).ud);return h}y_k(a,c){const h=new Ua.a;if(a.contextId===ic.a.endOfParagraph||c.contextId===ic.a.endOfParagraph||a.equals(c)&&a.Qa===a.$a||-1===a.Qa||-1===c.$a)return h;var v=a.node.la.$g(a.cpBegin),B=c.node.la.$g(c.cpEnd);v&&v.Wa&&0<v.Wa.length&&a.Qa<=v.Wa.length&&B&&B.Wa&&0<B.Wa.length&&c.$a<=B.Wa.length&&(a=a.Qa,c=c.$a,a===v.Wa.length&&a--,0<c&&c--,v=v.Wa.J(a),B=B.Wa.J(c),v.Nb&&!B.Nb&&N.a.Go(v.ud,B.ud)&&v.Eq&&B.Eq&&(B=v.contentControlNode)&&h.add(this.rX(B)));return h}Aal(a,c){const h=new Ua.a,
v=new dm.a,B=this.Cwb(a,c);for(let X=0;X<B.count;X++)this.Hkd(h,v,B.J(X).ud);a=this.fAh(a,c,!1,!1);for(let X of a)v.contains(X.objectId)||(h.add(X),v.add(X.objectId));return h}Bal(a,c){const h=new Ua.a,v=new dm.a,B=this.D5e(a,c);for(let X=0;X<B.count;X++)this.eHe(h,v,B.J(X));a=this.gAh(a,c);for(let X of a)v.contains(X.objectId)||(h.add(X),v.add(X.objectId));return h}fAh(a,c,h,v=!0){const B=new Ua.a;a.equals(c)&&(h=!1);const X=new dm.a;let ma=!1;a=this.Cwb(null,a,!0,h);c=this.Cwb(c,null,h,!0);for(h=
a.count-1;0<=h;h--){for(let Pa=0;Pa<c.count&&!(a.J(h).ud.equals(c.J(Pa).ud)&&(a.J(h),this.Hkd(B,X,a.J(h).ud)&&(ma=!this.Tf.hr(a.J(h).ud).ia(Yb.a.Iha,null),v||ma)));Pa++);if(0<B.count&&(v||ma))break}return B}gAh(a,c){const h=new Ua.a,v=new dm.a,B=a.node;var X=c.node;const ma=c.contextId===ic.a.endOfParagraph?X.characterData.length:c.cpEnd;a=this.mn.m8(B,a.contextId===ic.a.endOfParagraph?B.characterData.length:a.cpBegin,a.Qa);c=this.mn.m8(X,ma,c.$a);X=a.count>c.count?c.count:a.count;for(--X;0<=X;X--)a.J(X).ud.equals(c.J(X).ud)&&
this.eHe(h,v,a.J(X));return h}sjl(a,c){const h=new Ua.a;let v=new dm.a;const B=this.Cwb(a,c);let X=0,ma=null;if(a.equals(c))return h;for(a=0;a<B.count;a++)!B.J(a).Nb||B.J(a).Oe&&!this.Tf.qKa(B.J(a).ud,B.J(a).Xa.paragraph.id,!0)?B.J(a).Nb||B.J(a).Oe&&!this.Tf.qKa(B.J(a).ud,B.J(a).Xa.paragraph.id,!1)||(X--,0>X?(X=0,v=new dm.a):!X&&ma&&B.J(a).ud.equals(ma)&&this.Hkd(h,v,ma)):(X||(ma=B.J(a).ud),X++);return h}tjl(a,c){const h=new Ua.a;if(a.equals(c)&&a.Qa===c.$a)return h;let v=new dm.a;a=this.D5e(a,c);
c=0;let B=null;for(let X=0;X<a.count;X++){const ma=a.J(X);!ma.Nb||ma.Oe&&!this.Tf.qKa(ma.ud,ma.Xa.paragraph.id,!0)?ma.Nb||ma.Oe&&!this.Tf.qKa(ma.ud,ma.Xa.paragraph.id,!1)||(c--,0>c?(c=0,v=new dm.a):!c&&B&&ma.ud.equals(B.ud)&&this.eHe(h,v,B)):(c||(B=ma),c++)}return h}Lsh(a,c,h){const v=new Ua.a;a=h?this.D5e(a,c):this.Cwb(a,c);c=0;for(h=0;h<a.count;h++){var B=a.J(h);B.Eq&&(B.Nb?c++:(c--,0>c?c=0:(B=this.rX(B.contentControlNode))&&v.add(B)))}return v}Cwb(a,c,h=!0,v=!0){const B=new Ua.a,X=this.rR(a,c);
if(!X.count)return B;let ma,Pa,mb,Tb;for(let rc=0;rc<X.count;rc++){ma=0;Pa=X.J(rc).characterData.length;mb=Tb=!0;if(a&&X.J(rc).id.equals(a.node.id)){if(a.contextId===ic.a.endOfParagraph)continue;0<=a.cpBegin&&(ma=a.cpBegin)}c&&X.J(rc).id.equals(c.node.id)&&0<=c.cpEnd&&(Pa=c.cpEnd);rc||(mb=h);rc!==X.count-1||c&&c.contextId===ic.a.endOfParagraph||(Tb=v);B.addRange(this.NTk(X.J(rc),ma,Pa,mb,Tb))}return B}D5e(a,c){const h=new Ua.a,v=this.rR(a,c);let B,X,ma;for(let mb=0;mb<v.count;mb++){const Tb=v.J(mb);
var Pa=Tb.la.J(Tb.la.length-1);B=0;X=Tb.characterData.length;ma=0;Pa=Pa&&Pa.Wa?Pa.Wa.length:0;a&&Tb.id.equals(a.node.id)&&(B=a.Xl,ma=a.Qa);c&&Tb.id.equals(c.node.id)&&(X=c.Tu,Pa=c.$a);h.addRange(this.OTk(Tb,B,X,ma,Pa))}return h}NTk(a,c,h,v=!0,B=!0){const X=new Ua.a;a=a.la;for(let ma=0;ma<a.length;ma++){if(a.J(ma).cp<c)continue;if(a.J(ma).cp>h)break;const Pa=a.J(ma);if(Pa.Wa&&0<Pa.Wa.length&&(Pa.cp!==c||v)&&(Pa.cp!==h||B))for(let mb=0;mb<Pa.Wa.length;mb++)X.add(Pa.Wa.J(mb))}return X}OTk(a,c,h,v,B){const X=
new Ua.a;a=a.la;for(let ma=0;ma<a.length;ma++){if(a.J(ma).cp<c)continue;if(a.J(ma).cp>h)break;const Pa=a.J(ma);if(Pa.Wa&&0<Pa.Wa.length){let mb=0,Tb=Pa.Wa.length;Pa.cp===c&&(mb=v);for(Pa.cp===h&&(Tb=B);mb<Tb&&mb<Pa.Wa.length;mb++)X.add(Pa.Wa.J(mb))}}return X}Hkd(a,c,h){let v=null;if(c.contains(h)||!(v=this.jh.Ra(h)))return!1;a.add(this.rX(v));c.add(h);return!0}eHe(a,c,h){let v=null;!c.contains(h.ud)&&(v=h.contentControlNode)&&(a.add(this.rX(v)),c.add(h.ud))}VQi(a,c,h,v){let B=!1;a=({JLa:h,ILa:v,cWc:B}=
this.WQi(a,c,h,v,!1,B)).returnValue||B;B&&(a=a||({JLa:h,ILa:v,cWc:B}=this.WQi(h,v,h,v,!0,B)).returnValue);return{returnValue:a,JLa:h,ILa:v}}WQi(a,c,h,v,B,X){var ma,Pa,mb,Tb;if(B)return v=h=null,{returnValue:!1,JLa:h,ILa:v,cWc:!1};let rc=!1;h=a;v=c;const Tc=a.cpBegin,vd=c.cpEnd;X=!1;var ee=B?this.Tph(c):this.mRk(a);let Ie=!1,Xe=!1,Yf=0,Hh=0;for(let Fi of ee)for(ee=0;ee<Fi.la.length;ee++){const wk=Fi.la.J(ee);!Xe&&Fi.id.equals(c.node.id)&&(Xe=!0);if(!Ie&&(Fi.id.equals(c.node.id)&&-1!==vd&&wk.cp>vd||
Xe&&!Fi.id.equals(c.node.id)))if(Ie=!0,Yf!==Hh)rc=!0;else return{returnValue:!1,JLa:h,ILa:v,cWc:X};if((!Fi.id.equals(a.node.id)||wk.cp>=Tc||-1===Tc)&&wk.Wa)for(let Gk=0;Gk<wk.Wa.length;Gk++){const Kl=wk.Wa.J(Gk),Yj=this.jh.Ra(Kl.ud);if(!Yj.getValue(Yb.a.k4)||(!Kl.Nb||this.Tf.qKa(wn.a.kk?null!==(Pa=this.mf.Aq.get(null===(ma=Yj.id)||void 0===ma?void 0:ma.toString()))&&void 0!==Pa?Pa:N.a.nil:Yj.ia(Yb.a.yh,N.a.nil),Fi.id,!0))&&(Kl.Nb||this.Tf.qKa(wn.a.kk?null!==(Tb=this.mf.vr.get(null===(mb=Yj.id)||void 0===
mb?void 0:mb.toString()))&&void 0!==Tb?Tb:N.a.nil:Yj.ia(Yb.a.Ti,N.a.nil),Fi.id,!1))){Kl.Nb?Yf++:Yf--;if(rc&&Yf===Hh)return{JLa:h,ILa:v}=this.Wgk(a.node,Fi,a.cpBegin,wk.cp),{returnValue:!0,JLa:h,ILa:v,cWc:X};!B&&Yf<Hh&&(X=!0,Hh--)}}}return{returnValue:rc,JLa:h,ILa:v,cWc:X}}Wgk(a,c,h,v){let B;c.id.equals(a.id)?a=0<h||v<sd.ParagraphReader.textLength(c)?B=Oe.a.createTextRange(c,h,v):B=Oe.a.create(c):(B=0<h?Oe.a.createTextRange(a,h,sd.ParagraphReader.textLength(a)):Oe.a.create(a),a=v<sd.ParagraphReader.textLength(c)?
Oe.a.createTextRange(c,0,v):Oe.a.create(c));return{JLa:B,ILa:a}}T7k(a){var c,h,v,B;const X=a.cpBegin,ma=this.Tph(a);for(let mb=ma.count-1;0<=mb;mb--){const Tb=ma.J(mb);for(let rc=Tb.la.length-1;0<=rc;rc--){const Tc=Tb.la.J(rc);if((!Tb.id.equals(a.node.id)||Tc.cp<=X||-1===X&&!Tc.cp)&&Tc.Wa){var Pa=Tc.Wa.length-1;for((Tc.cp===X||-1===X&&!Tc.cp)&&this.$U&&Tb.id.equals(a.node.id)&&(Pa=a.Qa-1);0<=Pa;Pa--){const vd=Tc.Wa.J(Pa),ee=this.jh.Ra(vd.ud);if(vd.Nb){if(ee.getValue(Yb.a.k4)&&!this.Tf.qKa(wn.a.kk?
null!==(B=this.mf.Aq.get(null===(v=ee.id)||void 0===v?void 0:v.toString()))&&void 0!==B?B:N.a.nil:ee.ia(Yb.a.yh,N.a.nil),Tb.id,!0))continue;return null}if(!ee.getValue(Yb.a.k4)||this.Tf.qKa(wn.a.kk?null!==(h=this.mf.vr.get(null===(c=ee.id)||void 0===c?void 0:c.toString()))&&void 0!==h?h:N.a.nil:ee.ia(Yb.a.Ti,N.a.nil),Tb.id,!1))return this.rX(ee)}}}}return null}rX(a){if(!a)return null;this.Tf.cYb();return this.uZ.Ytb(a,this.Mu,this.zh,this.Tf,this.Sq,this,this.fna,this.dba,this.wrb)}rR(a,c){a=this.Sph(a,
c,fd.kxb(12));if(!a)return null;c=new Ua.a;for(let h of a)c.add(h);return c}kRk(a,c){const h=fd.v4k();return this.Sph(Oe.a.create(a.node),Oe.a.create(c.node),h)}Sph(a,c,h){if(!h||!a&&!c)return null;if(a&&c&&(a.equals(c)||a.node.id.equals(c.node.id))){var v=a.node;if(v&&h(v)){var B;return B=new Ua.a,B.add(v),B}}v=Object.assign(new Ug,{d8h:35,vgi:h});a=a?a.node:null;c=c?c.node:null;B=this.xel(a,c);if(!B)return null;c=this.BKj(c,h,fd.KYg,v);return this.hRk(a,c,B,h,fd.KYg,v)}xel(a,c){return(a=a?this.Zwh(a):
this.Zwh(c))?a.mc(35):this.Tf.m$k()}BKj(a,c,h,v){if(!a)return null;c(a)||(c=this.iRk(a,c,h,v),c.count&&(a=c.J(c.count-1)));return a}hRk(a,c,h,v,B,X){a?(a=Kd.GraphIterator.va(a),a.La(7),h=Tl.a.eq(a,h)):h=Tl.a.zn(h);B&&h.Fl(B,X);for(B=new Ua.a;h.moveNext()&&(v(h.currentNode)&&B.add(h.currentNode),!c||!h.currentNode.id.equals(c.id)););return B}iRk(a,c,h,v){a=Tl.a.zn(a);h&&a.Fl(h,v);for(h=new Ua.a;a.moveNext();)c(a.currentNode)&&h.add(a.currentNode);return h}Zwh(a){a=Kd.GraphIterator.va(a);return a.La(35)?
a:null}PIh(a,c){a=this.rR(a,c);for(let h of a)if((a=this.Tf.z8e(h))&&a.d4(4))return!0;return!1}dOg(a,c=null,h=!1){if(!a)return!1;var v=a.start,B=a.end;if(!Gc.SelectionEditor.Rs(v)&&v.contextId!==ic.a.paragraph||!Gc.SelectionEditor.Rs(B)&&B.contextId!==ic.a.paragraph||!this.$U&&({JLa:v,ILa:B}=this.VQi(a.start,a.end,v,B)).returnValue||this.$U&&!({start:v,end:B}=this.g1j(v,B)).returnValue)return!1;a.start=v;a.end=B;const X=this.nKl(v,B);if(this.$U){var ma=this.JIa(a.start,a.end,3);var Pa=this.JIa(a.start,
a.end,2)}else ma=this.nO(a.start,a.end,3),Pa=this.nO(a.start,a.end,2);const mb=ma&&0<ma.count?ma.J(0):null,Tb=Pa&&0<Pa.count?Pa.J(0):null;if(h)return this.EIc(a,0,ma)?!0:!1;if(this.EIc(a,0,ma)){h=(h=Object(ha.a)(Gb,this.T7k(a.start)))?this.Tf.hr(h.objectId):null;Pa=this.Tf.LCj(a,mb,h,Pa,a.yh,a.Ti,c);if(a.Oe)for(v=this.rR(a.start,a.end),B=0;B<v.count;B++)this.$U?(h=mb?mb.objectId:null,ma=this.Hwh(h,v.J(B),!0),this.Sq.Boa(v.J(B),Pa.id,0,!0,!0,void 0,void 0,void 0,void 0,ma),h=this.Hwh(h,v.J(B),!1),
this.Sq.Boa(v.J(B),Pa.id,v.J(B).characterData.length,!0,!1,void 0,void 0,void 0,void 0,h)):(this.Sq.Boa(v.J(B),Pa.id,0,!0,!0),this.Sq.Boa(v.J(B),Pa.id,v.J(B).characterData.length,!0,!1));else this.$U?(h=-1===v.Qa?0:v.Qa,this.Sq.Boa(a.start.node,Pa.id,v.cpBegin,!1,!0,void 0,void 0,void 0,void 0,h),this.Sq.Boa(a.end.node,Pa.id,B.cpEnd,!1,!1,void 0,void 0,void 0,void 0,X?h+1:B.$a)):(this.Sq.Boa(a.start.node,Pa.id,a.start.cpBegin,!1,!0),this.Sq.Boa(a.start.node,Pa.id,a.start.cpEnd,!1,!1));c||this.Tf.jdn(Pa,
a.Oe,a.id,this.Tf.$_b(this.Tf.hr(a.yh)));a.objectId=Pa.id;c=this.Tf.vya().currentNode;c.hasProperty(Yb.a.zxc)||c.setValue(Yb.a.zxc,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder);mb&&this.yVi(mb.contentControlNode,a);Tb&&this.yVi(Pa,Tb);X&&this.ga.hb(zb.a.YSf,2,a.id);return!0}return!1}deleteContentControl(a){if(this.EIc(a,3)){a.DM&&(a.DM=!1);const c=this.ya.Ca.Fa;a=a.LD();const h=new xm.Selection(a.toArray(),!0);let v=!1;this.ya.wFb(()=>{this.ya.setSelection(h);if(32===this.ga.processAction(zb.a.lF,
2)){if(this.WKg.instance){const B=this.WKg.instance.oyh(c,h,this.ya.Ca.Fa);this.ya.HLn(new ue.SelectionCollection([B],0))}v=!0}});return v}r.ULS.sendTraceTag(528537614,368,15,"Invalid content control to delete");return!1}yBa(a,c=!1){if(this.EIc(a,2)){if(a.DM)return r.ULS.sendTraceTag(528537615,368,15,"Attempting to delete content control showing placeholder"),this.deleteContentControl(a);const h=this.Tf.hr(a.objectId);let v=new Ua.a;c&&(v=a.Q4e());v.add(a);h&&h.anchor&&this.Tf.kch(h,c);for(let B of v)a=
this.rR(B.start,B.end),this.Sq.crk(a,B.objectId);this.Yli(v);r.ULS.sendTraceTag(528537616,368,50,"Successfully released content control.");return!0}r.ULS.sendTraceTag(528537617,368,15,"Invalid content control to release.");return!1}FDi(a,c){if(this.EIc(a,1)){let Pa=!1;c||(Pa=!0,{Tnn:h,returnValue:c}=this.vEc(a),h&&this.Tf.vya().currentNode.setValue(Yb.a.zxc,c));var h=a.Qrh().toArray();for(var v=0;v<h.length;v++)this.yBa(h[v],!0);c=this.wvn(c);if(a.Oe){v=this.rR(a.start,a.end);if(!v.count)return!1;
if(1===v.count&&l.AFrameworkApplication.V_)c=c.join(" "),this.Sq.replaceTextRange(Oe.a.createTextRange(v.J(0),0,v.J(0).characterData.length),c);else{var B=this.Tf.sal(v.J(0));h=v.J(0).iZb();v=this.Tf.vch(v);v=this.Tf.sOg(B,v,c.length);for(B=0;B<v.count;B++){this.Sq.replaceTextRange(Oe.a.createTextRange(v.J(B),0,0),c[B]);for(var X=0;X<h.count;X++)this.Sq.Boa(v.J(B),h.J(X),0,!0,!0),this.Sq.Boa(v.J(B),h.J(h.count-X-1),v.J(B).characterData.length,!0,!1)}a.kRn(v.J(0).id,v.J(v.count-1).id);c=this.LA.vd(v.J(0),
0);this.ya.setSelection(c)}}else{B=0;1<c.length&&r.ULS.sendTraceTag(17585367,368,15,"New text being set to an inline content control should not contain multiple paragraphs");h=a.start;v=h.node;for(var ma=0;ma<v.la.length&&h.contextId===ic.a.xc;ma++)if(X=v.la.J(ma),X.cp===h.cpBegin&&X.blob){B++;for(ma+=1;ma<v.la.length;ma++)if(X=v.la.J(ma),X.cp>h.cpBegin&&X.cp<=h.cpEnd)if(X.blob)B++;else break;else if(X.cp>h.cpEnd)break;break}if(0<B&&B+h.cpBegin<h.cpEnd)v=Oe.a.createTextRange(h.node,h.cpBegin,h.cpBegin+
B),h=Oe.a.createTextRange(h.node,h.cpBegin+B,h.cpEnd),this.Sq.replaceTextRange(h,c[0]),this.Sq.replaceTextRange(v,"");else if(0<B&&B+h.cpBegin===h.cpEnd)for(this.Sq.replaceTextRange(a.start,c[0]),c=0;c<v.la.length;c++){if(B=v.la.J(c),B.cp===h.cpBegin){B.blob=null;break}}else l.AFrameworkApplication.V_?(c=c.join(" "),this.Sq.replaceTextRange(a.start,c)):this.Sq.replaceTextRange(a.start,c[0])}this.vmd(a,Pa);let mb;this.RKm((mb=new Ua.a,mb.add(a),mb));return!0}return!1}vmd(a,c){const h=this.Sq.XAd(a.start.node,
0<=a.start.cpBegin?a.start.cpBegin:0);if(!h)r.ULS.sendTraceTag(17585368,368,15,"Unable to get a ChP at starting Ip of Content Control");else if(kg.a.instance.J(10)){const v=this.Tf.hr(a.objectId);if(c){c=this.Tk.tw(a.start.node);let B=c.zg(fd.oBm);B||(B=c.tqa(fd.nBm));B&&(this.nd.yha(h.formatting),this.nd.qhb(h.formatting,B));v&&(a.DM=!0)}else v&&a.DM&&(this.x3m(a,h),a.DM=!1)}}x3m(a,c){a=this.Tf.hr(a.objectId);let h=null;a&&(h=a.ia(Yb.a.Cxc,N.a.nil));this.nd.yha(c.formatting);h&&!h.equals(N.a.nil)&&
(a=this.zh.value.Ra(h),c.formatting=a)}vEc(a){let c=!1;a=a.lUd;this.MSl(a)&&(a=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder,c=!0);return{returnValue:a,Tnn:c}}QUm(a,c=!0){this.dba&&(c&&this.MUm(a),this.UUm(a))}RUm(a){if(this.dba&&(a=this.nO(a,a,4)))for(let c of a)this.yBa(c,!1)}qmm(a,c){if(c&&!a.Nb&&(this.Tf.cYb(),(a=a.Xa.paragraph.Mb.Ra(a.ud))&&a.anchor)){this.Tf.kch(a);a=this.uZ.Ytb(a,this.Mu,this.zh,this.Tf,this.Sq,this,this.fna,this.dba,this.wrb);let h;this.Yli((h=new Ua.a,h.add(a),
h))}}sci(a,c){this.Tf.cYb();a=this.Tf.hr(c.ud);const h=this.rX(a);if(h&&h.Nc()&&h.removeWhenEdited){const v=this.Fb.Ob(7);v.Oa(a);this.yBa(h,!1);c.state=2;v.dispose()}}gdi(a,c){this.Tf.cYb();a=this.Tf.hr(c.ud);this.uIl(a)&&(a=a.ia(Yb.a.Xx,0),this.ga&&(this.ga.hb(zb.a.YSf,2,a),fd.hd.nJe()))}uIl(a){return a&&a.isConnected&&!a.ia(Yb.a.F3,!1)?this.rIl(a):!1}rIl(a){a=this.uZ.Ytb(a,this.Mu,this.zh,this.Tf,this.Sq,this,this.fna,this.dba,this.wrb);if(!a.Nc())return!1;if(a.Oe){if(a.yh.toString()===a.Ti.toString()){var c=
this.Tf.hr(a.yh);if(!c)return r.ULS.shipAssertTag(22828291,368,!1,"Block content control is connected but its start node is null"),!1;if(12===c.type&&1===c.la.length)return this.NQh(c.la.J(0),a.objectId)}}else{c=a.start;if(!c)return r.ULS.shipAssertTag(22828292,368,!1,"Inline content control is connected but its start context is null"),!1;if(c.cpBegin===c.cpEnd)return c=this.Tf.hr(a.yh).la.$g(c.cpBegin),this.NQh(c,a.objectId)}return!1}NQh(a,c){a=a?a.Wa:null;if(!a)return!1;const h=a.aK(c,!0);return-1<
h&&h+1<a.length&&a.J(h+1).ud.toString()===c.toString()}qRm(a){this.txe.push(a)}jKi(a,c){if(void 0===a||null===a||a.contextId!==ic.a.xc)return null;a=Oe.a.Sb(a.node,c?a.cpBegin:a.cpEnd);return 0<a.cpBegin&&a.cpBegin<sd.ParagraphReader.textLength(a.node)?this.Tf.rNa(a):null}select(a,c){if(a&&!a.equals(N.a.nil)){var h=this.Tf.hr(a);if(h&&55===h.type){h=this.rX(h);if(h.Oe)h=this.WSk(h);else{h=h.start;if(!h)return;h=this.LA.yn(h)}h&&h.length&&(this.GAi(h.sa,a,c,!0,!0),this.GAi(h.Pb,a,c,!1,!1),this.ya.setSelection(h))}}}W8m(a,
c){if(!Gc.SelectionEditor.ke(a)||a.Qa!==a.$a)return!1;const h=a.Qa;return-1===h?!1:(a=this.mn.Kwb(a.node,a.cpBegin,h,!c))&&c===a.Nb?(c=this.rX(a.contentControlNode),this.select(a.ud,!c.isEditable),!0):!1}WSk(a){var c=this.Tf.FIa(a.yh,!0);a=this.Tf.FIa(a.Ti,!1);if(!c||!a)return null;c=this.kRk(Oe.a.create(c),Oe.a.create(a));if(!c||!c.count)return null;a=new Ua.a;for(let h=0;h<c.count;h++){let v;if(12===c.J(h).type)v=h===c.count-1?Oe.a.createTextRange(c.J(h),0,sd.ParagraphReader.textLength(c.J(h))):
Oe.a.create(c.J(h)),this.Rf&&(v.Qa=this.Rf.np(v.node,!0),v.$a=this.Rf.np(v.node,!1));else if(15===c.J(h).type)v=ff.TableNodeContext.create(c.J(h));else continue;a.add(v)}return new xm.Selection(a.toArray(),!0)}Hcn(a){if(a&&!a.equals(N.a.nil)&&(this.Tf.cYb(),(a=this.Tf.hr(a))&&55===a.type&&a.isConnected)){var c=a.ia(Yb.a.F3,!1);a.setValue(Yb.a.F3,!1);c&&this.iQm(a)}}iQm(a){var c,h;const v=wn.a.kk?null!==(h=this.mf.Aq.get(null===(c=a.id)||void 0===c?void 0:c.toString()))&&void 0!==h?h:N.a.nil:a.ia(Yb.a.yh,
N.a.nil);v.equals(N.a.nil)||(c=this.Tf.yia(v,!0))&&(a=this.Sq.q6e(c,a.id,!0))&&0<a.count&&(a=a.J(0),c=a.Xa,c.formatting=a.kO?a.kO.Ge(c):new Bp.a(c,N.a.nil))}vpi(a){if(a=this.Ksh(a))for(let c of a)c.DM=!1,this.yBa(c,!1)}lWk(a){const c=new Ua.a;if(a=this.Ksh(a))for(let h of a)c.add(h.contentControlNode);return c}SUm(a){if(a&&(11===a.type||14===a.type||15===a.type||16===a.type)){var c=this.Ba.Bl(a),h=this.Ba.uI(a);if(this.Rf&&c&&h){a=this.Rf.np(c,!0);const v=this.Rf.np(h,!1);c=Oe.a.create(c);h=Oe.a.create(h);
c.Qa=a;h.$a=v;if(a=this.JIa(c,h,4))for(let B of a)this.yBa(B,!1)}}}nRk(a){var c,h,v,B;const X=wn.a.kk?null!==(h=this.mf.Aq.get(null===(c=a.id)||void 0===c?void 0:c.toString()))&&void 0!==h?h:N.a.nil:a.ia(Yb.a.yh,N.a.nil);c=wn.a.kk?null!==(B=this.mf.vr.get(null===(v=a.id)||void 0===v?void 0:v.toString()))&&void 0!==B?B:N.a.nil:a.ia(Yb.a.Ti,N.a.nil);if(X.equals(N.a.nil)||c.equals(N.a.nil))return new Ua.a;a=this.Tf.yia(X,!0);v=this.Tf.yia(c,!1);return!this.tIl||a&&v?this.rR(Oe.a.create(a),Oe.a.create(v))||
new Ua.a:new Ua.a}FIa(a,c){return this.Tf.FIa(a,c)}h8e(a,c){if(a&&55===a.type&&(a=this.rX(a),a=c?a.start:a.end)){const h=Oe.a.Sb(a.node,c?a.Xl:a.Tu);h.Qa=h.$a=(c?a.Qa:a.$a)+(c?-1:1);return h}return null}GAi(a,c,h,v,B){if((a.contextId===ic.a.xc||a.contextId===ic.a.Ub||a.contextId===ic.a.paragraph)&&(B=a.node.la.$g(B?a.Xl:a.Tu))&&B.Wa)for(let X=0;X<B.Wa.length;X++){const ma=B.Wa.J(X);if(ma.ud.equals(c)&&ma.Eq)if(v&&ma.Nb){a.Qa=h?X:X+1;break}else if(!v&&!ma.Nb){a.$a=h?X+1:X;break}}}RKm(a){for(let c=
0;c<this.zBg.length;++c)(0,this.zBg[c])(this,new Lf(a))}Yli(a){for(let c=0;c<this.txe.length;++c)(0,this.txe[c])(this,new Lf(a))}UUm(a){a=Oe.a.create(a);if(a=this.nO(a,a,4))for(let c of a)c.Oe||this.yBa(c,!1)}MUm(a){if(a=a.iZb())for(let h=0;h<a.count;h++){var c=this.Tf.hr(a.J(0));c=this.uZ.Ytb(c,this.Mu,this.zh,this.Tf,this.Sq,this,this.fna,this.dba,this.wrb);this.yBa(c)}}mRk(a){return this.rR(a,null)}EIc(a,c,h=null){let v=!0;try{if(!a)return r.ULS.sendTraceTag(529106507,368,50,"Content Control is null"),
!1;r.ULS.sendTraceTag(529106508,368,50,String.format("Content control change type: {0}, isSupported: {1}, isDeletable: {2}",c,a.isSupported,a.tja));if(this.qva&&kg.a.instance.J(3)&&this.qva.hV(this.Mu.value))return r.ULS.sendTraceTag(529106509,368,50,"Content Control Change Invalid because track changes is enabled"),!1;if(this.gPl(c)&&!this.vIl(a))return!1;if(!h){const ma=this.nal(a);ma&&(h=new Ua.a,h.add(ma))}var B=this.Tf.Czh(a.start.node);const X=this.Tf.Czh(a.end.node);if(B&&X&&!B.equals(X)||
!B&&X||B&&!X)return!1;B=!0;if(h&&0<h.count){if(!h.J(0).isSupported)return!1;B=h.J(0).isEditable}switch(c){case 0:v=this.nGl(a,B);break;case 1:v=(this.N8||!this.Djf(a))&&a.isSupported&&a.isEditable&&this.ZTg(a)&&this.PQh(a);l.AFrameworkApplication.V_||(v=v&&!this.PIh(a.start,a.end));break;case 2:const ma=a.WTl?!0:a.isSupported;v=(this.N8||!this.Djf(a))&&ma&&a.tja&&B;r.ULS.sendTraceTag(529106510,368,50,"True");break;case 3:v=a.isSupported&&a.tja&&B&&this.ZTg(a)&&this.PQh(a)&&!this.PIh(a.start,a.end)}}catch(X){r.ULS.sendTraceTag(17413646,
368,15,"Exception was caught in IsContentControlValid. OperationType: "+c+", Exception: "+X),v=!1}return v}gPl(a){return!(this.$U&&(!a||2===a||3===a))}nGl(a,c){let h=!0;if(!this.N8&&this.Djf(a))h=!1;else if(this.$U)this.$U?a.Oe||Gc.SelectionEditor.Rs(a.start)||a.start.contextId===ic.a.endOfParagraph?a.Oe&&(a.start.contextId!==ic.a.paragraph&&a.start.contextId!==ic.a.endOfParagraph||a.end.contextId!==ic.a.paragraph&&a.end.contextId!==ic.a.endOfParagraph)&&(h=!1):h=!1:h=c?this.hHl(a):!1;else if(!(a.Oe||
-1!==a.start.cpBegin&&-1!==a.end.cpEnd&&a.start.equals(a.end)))h=!1;else if(a.Oe&&(a.start.contextId!==ic.a.paragraph||a.end.contextId!==ic.a.paragraph||a.start.equals(a.end)&&!sd.ParagraphReader.textLength(a.start.node)))h=!1;else if(a.start.contextId===ic.a.Ub||a.end.contextId===ic.a.Ub||a.start.contextId===ic.a.endOfParagraph||a.end.contextId===ic.a.endOfParagraph)h=!1;return h}Ksh(a){if(!a||!a.length)return null;const c=a[0];a=a[a.length-1];this.Rf&&(this.Ba.Wk(c)&&12===c.node.type&&(c.Qa=this.Rf.np(c.node,
!0)),this.Ba.Wk(a)&&12===a.node.type&&(a.$a=this.Rf.np(a.node,!1)));return this.JIa(c,a,4)}ZTg(a){a=a.Q4e();for(let c of a)if(!c.isSupported||!c.tja)return!1;return!0}vIl(a){let c;if(({JLa:h,ILa:c}=this.VQi(a.start,a.end,h,c)).returnValue)return!1;var h=this.nO(a.start,a.end,2);if(!h)return!0;for(let v of h)if(!v.objectId.equals(a.objectId)&&(v.Oe&&(v.start.node.id.equals(a.start.node.id)&&(-1===a.start.cpBegin||!a.start.cpBegin)||v.end.node.id.equals(a.end.node.id)&&(-1===a.end.cpEnd||a.end.cpEnd===
sd.ParagraphReader.textLength(v.end.node)))||!v.Oe&&(a.start.node.id.equals(v.start.node.id)&&(-1!==a.start.cpBegin?v.start.cpBegin===a.start.cpBegin:!v.start.cpBegin)||a.end.node.id.equals(v.end.node.id)&&(-1!==a.end.cpEnd?v.end.cpEnd===a.end.cpEnd:v.end.cpEnd===sd.ParagraphReader.textLength(a.end.node)))))return!1;return!0}PQh(a){if(a.Oe){var c=this.Tf.hr(a.yh),h=this.Tf.hr(a.Ti);let v=null;if(12===c.type&&12===h.type){c=this.Tf.$_b(c);c=this.Tf.hr(c);h=this.Tf.$_b(h);h=this.Tf.hr(h);if(!c||!h)return!1;
16===c.type&&16===h.type&&c.id.equals(h.id)&&(v=c)}a=this.rR(a.start,a.end);if(!a.count)return!1;for(let B of a)if(a=this.Tf.$_b(B),a=this.Tf.hr(a),!a||!(16!==a.type||v&&a.id.equals(v.id)))return!1}return!0}Djf(a){return a.Oe?!1:(a=a.start.node)?!a.ia(Yb.a.w2b,!0):!0}hHl(a){if(a.Oe){var c=this.Tf.hr(a.yh);a=this.Tf.hr(a.Ti);if(Tf.TableCellReader.tra(c)||Tf.TableCellReader.tra(a)||$m.a.Lja(c)||$m.a.Lja(a))return!1;c=this.Tf.$_b(c);c=this.Tf.hr(c);a=this.Tf.$_b(a);a=this.Tf.hr(a);if(!c||!a||(16===c.type||
16===a.type)&&!c.id.equals(a.id))return!1}return!0}nal(a){if(!a)return null;a=this.Tf.hr(a.objectId);if(!a)return null;a=a.ia(Yb.a.Iha,N.a.nil);return a.equals(N.a.nil)?null:(a=this.Tf.hr(a))?this.rX(a):null}Tph(a){return this.rR(null,a)}wvn(a){return(a||"").split(RegExp("\r\n|\r|\n"))}MSl(a){return a&&""!==a?!1:!0}Hwh(a,c,h){c=c.la.$g(h?0:c.characterData.length);if(!c)return r.ULS.sendTraceTag(21018849,368,15,"Unable to get a ChP at expected cp, which should not happen"),0;if(!c.Wa||!c.Wa.length)return 0;
if(!a)return h?0:c.Wa.length;for(let v=0;v<c.Wa.length;v++){const B=c.Wa.J(v);if(N.a.Go(B.ud,a)&&B.Nb===h)return h?v+1:v}return h?0:c.Wa.length}g1j(a,c){var h=a.node,v=c.node,B=a.contextId===ic.a.paragraph?0:a.cpBegin,X=c.contextId===ic.a.paragraph?sd.ParagraphReader.textLength(v):c.cpEnd;h=this.mn.m8(h,B,a.Qa);v=this.mn.m8(v,X,c.$a);X=!h||!h.count;B=!v||!v.count;if(X&&B)return{returnValue:!0,start:a,end:c};if(X)return{returnValue:this.r6d(a,v.J(v.count-1).ud,!0),start:a,end:c};if(B)return{returnValue:this.r6d(c,
h.J(h.count-1).ud,!1),start:a,end:c};if(h.count===v.count)return h=h.J(h.count-1),v=v.J(v.count-1),{returnValue:h.ud.equals(v.ud),start:a,end:c};h=(X=h.count<v.count)?v.J(v.count-1):h.J(h.count-1);return{returnValue:X?this.r6d(a,h.ud,!0):this.r6d(c,h.ud,!1),start:a,end:c}}r6d(a,c,h){var v=a.node;let B;if(h){B=a.contextId===ic.a.paragraph?0:a.cpBegin;var X=a.Qa}else B=a.contextId===ic.a.paragraph?sd.ParagraphReader.textLength(v):a.cpEnd,X=a.$a;v=v.la.$g(B);if(-1===X||!v||!v.Wa||!v.Wa.length)return!1;
v=v.Wa;if(h)for(h=X;h<v.length;h++){X=v.J(h);if(!X.Nb)break;if(X.ud.equals(c))return a.Qa=h+1,!0}else for(h=X-1;0<=h;h--){X=v.J(h);if(X.Nb)break;if(X.ud.equals(c))return a.$a=h,!0}return!1}nKl(a,c){return this.cQj(a,c)&&a.Qa===a.$a&&(a.contextId===ic.a.Ub||a.contextId===ic.a.paragraph&&!a.node.characterData.length)}cQj(a,c){return a.equals(c)&&a.Qa===c.Qa&&a.$a===c.$a}yVi(a,c){var h,v,B,X,ma,Pa;if(a&&c.Oe){var mb=wn.a.kk?null!==(v=this.mf.Aq.get(null===(h=a.id)||void 0===h?void 0:h.toString()))&&
void 0!==v?v:N.a.nil:a.ia(Yb.a.yh,N.a.nil);h=this.Tf.yia(c.yh,!0);mb.equals(h?h.id:null)&&(wn.a.kk?this.mf.Aq.set(null===(B=a.id)||void 0===B?void 0:B.toString(),c.objectId):a.setValue(Yb.a.yh,c.objectId));B=wn.a.kk?null!==(ma=this.mf.vr.get(null===(X=a.id)||void 0===X?void 0:X.toString()))&&void 0!==ma?ma:N.a.nil:a.ia(Yb.a.Ti,N.a.nil);X=this.Tf.yia(c.Ti,!1);B.equals(X?X.id:null)&&(wn.a.kk?this.mf.vr.set(null===(Pa=a.id)||void 0===Pa?void 0:Pa.toString(),c.objectId):a.setValue(Yb.a.Ti,c.objectId))}}static get hd(){return fd.Bb||
(fd.Bb=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static kxb(a){return c=>c.type===a}static v4k(){return a=>12===a.type||15===a.type}static KYg(a,c){return a.Md===c.d8h||a.parentNode&&c.vgi(a.parentNode)?!1:!0}}fd.oBm="Placeholder Text";fd.nBm="Placeholder Text";fd.Bb=null;Object(w.a)(fd,"ContentControlOperator",null,[342,14,343]);class ze{constructor(a,c,h){this.Vb=a;this.Mu=c;this.HPb=h}FFh(a){const c=this.z4k();return c&&a&&this.cnl(c,a)?this.Cll(c):null}cnl(a,
c){if(!a)return!1;do{const h=a.currentNode;if(!h)break;if(h.ia(Yb.a.$ml,null)===c)return!0}while(a.ue(29));return!1}Cll(a){var c=a.Za(1);a.ob();a=a.qC(1);if(!c||!a)return null;c=ne.SelectionFactory.r$g(c,a);a=Gc.SelectionEditor.Ri(c,!1,!1);return ne.SelectionFactory.jC(c,a.Pb)}z4k(){const a=this.Vb.Dj();a.set(this.Mu.value);this.HPb.aS(a);return a.Za(28)&&a.Za(29)?a:null}}Object(w.a)(ze,"GlossaryNavigator",null,[341]);class Wh{constructor(a,c,h,v,B,X){this.Sq=a;this.Tf=c;this.Hl=h;this.Ba=v;this.Dg=
B;this.dba=X}cVc(a,c,h){if(!this.dba)return 1;if(!({tableNode:B}=this.nmf(a)).returnValue||!this.Dg.dXh(B,c)||this.tpi(a,c))return 2;var v=this.Dg.Uph(c);var B=v.J(0).iZb();B&&B.count||(B=new Ua.a,B.add(a.objectId));a=this.Tf.vch(v);h=h.split("\n");c=Object(ha.a)(Kd.GraphIterator,this.Tf.z8e(c));c=this.Tf.sOg(c,a,h.length);for(a=0;a<c.count;++a){v=c.J(a);this.Sq.replaceTextRange(Oe.a.createTextRange(v,0,0),h[a]);for(let X=0;X<B.count;++X)this.Sq.Boa(v,B.J(X),0,!0,!0),this.Sq.Boa(v,B.J(B.count-X-1),
v.characterData.length,!0,!1)}return 0}tpi(a,c){if(!this.dba)return 1;let h;if(!({tableNode:h}=this.nmf(a)).returnValue||!this.Dg.dXh(h,c))return 2;c=this.Dg.Uph(c);if(0<c.count&&(c=this.Hl.nO(Oe.a.create(c.J(0)),Oe.a.create(c.J(c.count-1)),2)))for(let v of c)if(v.id!==a.id&&!this.Hl.yBa(v,!0))return 2;return 0}G3b(a){if(!this.dba||!({tableNode:h}=this.nmf(a)).returnValue)return!1;a=a.Q4e();for(var c of a)if(!c.tja||!c.isSupported)return!1;if(this.Dg.kIl(h))return!1;var h=Object(ha.a)(Kd.GraphIterator,
this.Tf.z8e(h));c=new Ua.a;this.Ba.Yab(h,!0,!1,c);for(let v of c)if(0<v.ia(Yb.a.Zvb,0)||this.Ba.cWa(v).lv)return!1;return!0}nmf(a){let c=null;return a&&a.yh.toString()===a.Ti.toString()&&a.Nc()&&a.isEditable&&a.isSupported?(c=this.Tf.hr(a.yh))&&14===c.type?{returnValue:!0,tableNode:c}:{returnValue:!1,tableNode:null}:{returnValue:!1,tableNode:c}}}Object(w.a)(Wh,"TableContentControlEditor",null,[330]);class Xh{kIl(a){let c=!1;const h=new Kd.GraphIterator;h.set(a);Fe.forEachCellInTable(h,v=>{if(!Tf.TableCellReader.lf(v)){let B=
Rm.OutlineNavigator.I4(v);for(;B;){if(Ta.OutlineElementReader.VEd(v))return c=!0,!1;B=v.Fh(1)}}return!0});return c}dXh(a,c){const h=new Kd.GraphIterator;h.set(c);return Tf.TableCellReader.tra(c)&&h.La(14)&&h.mc(14).id===a.id?!0:!1}Uph(a){const c=new Ua.a,h=new Kd.GraphIterator;h.set(a);a=new Ua.a;sd.ParagraphReader.Yab(h,!0,!1,a);for(let v of a)c.add(v);return c}}Object(w.a)(Xh,"TableReader",null,[328]);class Bg{constructor(){this.Hl=null}get name(){return"WordEditor.ContentControl"}init(){l.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled")&&
(fe.a.pMa(Object(m.a)(xa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator"),xa.a.instance.resolve("WordEditor.ContentControl.ContentControlOperator").qmm,"onContentControlRangeChanged")),this.Hl=xa.a.instance.ra("WordEditor.ContentControl.IContentControlOperator"))}dispose(){this.Hl&&(this.Hl.dispose(),this.Hl=null)}yb(a){a.ha("WordEditor.ContentControl.ContentControlFactory",()=>new bc(xa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlFactory").singleInstance();
a.ha("WordEditor.ContentControlNodeFactory",()=>new t(xa.a.instance.za("Box4.ContentControlConfigSettings"),xa.a.instance.za("Box4.ContentControl.IContentControlOperator"))).singleInstance();a.ha("WordEditor.ContentControl.ContentControlGraphManager",()=>new ed(new qf.a(()=>Eb.App.oa.Da.Zb),new qf.a(()=>Eb.App.oa.Da.Zb.Lc),new gl.a,jn.PageNavigator.instance,xa.a.instance.resolve("WordEditor.ContentControlNodeFactory"),xa.a.instance.resolve("Box4.IOutlineEditor"),xa.a.instance.resolve("Box4.IOutlineElementEditor"),
xa.a.instance.resolve("Box4.IParagraphReader"),xa.a.instance.resolve("WordEditor.IParagraphSplitHelper"),xa.a.instance.za("Box4.ContentControlConfigSettings"),xa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlGraphManager").singleInstance();a.ha("WordEditor.ContentControl.GlossaryNavigator",()=>new ze(new gl.a,new qf.a(()=>Eb.App.oa.Da.Zb),jn.PageNavigator.instance)).as("WordEditor.ContentControl.IGlossaryNavigator").singleInstance();a.ha("WordEditor.ContentControl.ContentControlOperator",
()=>new fd(new qf.a(()=>Eb.App.oa.Da.Zb),new qf.a(()=>Eb.App.oa.Da.Zb.Lc),xa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),xa.a.instance.resolve("WordEditor.ContentControl.ContentControlChpManager"),xa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),$c.a.instance,xa.a.instance.resolve("Box4.ISelectionFactory"),vg.PageReader.instance,xa.a.instance.resolve("Box4.IFormattingEditor"),xa.a.instance.resolve("Box4.Styles.IWACStyleReader"),l.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"),
xa.a.instance.ra("Box4.IContentControlDataChangedManager"),l.AFrameworkApplication.pa,xa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),l.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),xa.a.instance.resolve("Box4.IContentControlChpHelper"),xa.a.instance.za("Box4.ContentControlConfigSettings"),xa.a.instance.ra("Box4.IContentControlReader"),xa.a.instance.resolve("Box4.IParagraphReader"),xa.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),
xa.a.instance.za("Box4.Actors.IVirtualSelectionMerger"),xa.a.instance.resolve("Box4.IFeatureHelper"),xa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.ContentControl.IContentControlOperator").as("WordEditor.ContentControl.IContentControlOperator").singleInstance();a.ha("WordEditor.ContentControl.ContentControlManager",()=>new Gd(new qf.a(()=>Eb.App.oa.Da.Zb),new qf.a(()=>Eb.App.oa.Da.Zb.Lc),xa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),xa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),
xa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),xa.a.instance.resolve("WordEditor.ContentControl.IContentControlFactory"),xa.a.instance.resolve("WordEditor.ContentControl.IGlossaryNavigator"),xa.a.instance.za("Box4.ContentControlConfigSettings"),xa.a.instance.resolve("Box4.IContentControlChpHelper"))).as("WordEditor.ContentControl.IContentControlManager").singleInstance();a.ha("WordEditor.ContentControl.ContentControlChpManager",()=>new ka(xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),
xa.a.instance.za("Box4.ContentControlConfigSettings"),xa.a.instance.resolve("Box4.IParagraphReader"),xa.a.instance.resolve("Box4.ContentControlParagraphMapping"))).as("WordEditor.ContentControl.IContentControlChpManager").singleInstance();a.ha("WordEditor.ContentControl.TableContentControlEditor",()=>new Wh(xa.a.instance.resolve("WordEditor.ContentControl.IContentControlChpManager"),xa.a.instance.resolve("WordEditor.ContentControl.IContentControlGraphManager"),xa.a.instance.resolve("WordEditor.ContentControl.IContentControlOperator"),
xa.a.instance.resolve("Box4.IParagraphReader"),new Xh,l.AFrameworkApplication.K.$("WordEditorContentControlWriteIsEnabled"))).as("WordEditor.ContentControl.ITableContentControlEditor").singleInstance();l.AFrameworkApplication.K.$("WordEditorContentControlInlineBlockConversionIsEnabled")&&a.ha("Box4.ContentControlConverter",()=>new Ja(a.resolve("Box4.IParagraphReader"),a.resolve("Box4.IContentControlChpHelper"),a.resolve("Box4.IContentControlReader"),a.resolve("Box4.IFeatureHelper"),a.resolve("Box4.ContentControlParagraphMapping"))).as("Box4.IContentControlConverter").singleInstance()}static main(){M.a.instance.Lb(new Bg)}}
Object(w.a)(Bg,"ContentControlPackage",null,[1,2]);var Zj=b(1580);class Cn extends Sys.EventArgs{constructor(a){super();this.definition=a}}Object(w.a)(Cn,"MenuDidCloseEventArgs",Sys.EventArgs,[]);class Dk extends Sys.EventArgs{constructor(a){super();this.definition=a}}Object(w.a)(Dk,"MenuDidOpenEventArgs",Sys.EventArgs,[]);class Em{constructor(a,c,h,v,B,X,ma=!1,Pa=null,mb=null,Tb=null,rc=!1,Tc=null,vd=!1,ee=!0,Ie=null,Xe=!1){this.target=this.container=this.menu=null;this.isDismissed=!1;this.zOc=this.lOc=
this.Ujh=this.onScroll=this.onResize=this.M4=this.Tra=this.PAa=this.documentElement=this.ela=this.editingElement=null;this.isFocused=!1;this.Ltd=null;this.eDf=this.Nif=!1;this.w7d=null;this.KUd=0;this.paragraphNode=a;this.cpBegin=c;this.cpEnd=h;this.definition=v;this.eBj=B;this.HKa=X;this.U9a=ma;this.iHi=Pa;this.Xha=mb;this.hostServices=Tb;this.Gqn=rc;this.ifi=Tc;this.vHi=vd;this.tvk=ee;this.Ujh=Ie;this.showDictationCommandUx=Xe}}Object(w.a)(Em,"UxManagerState",null,[]);var Hn=b(1442);class Wj{constructor(a,
c,h,v,B,X,ma,Pa,mb,Tb){this.fb=a;this.ya=c;this.Ax=h;this.Rb=v;this.jd=B;this.Ta=X;this.gh=ma;this.Bi=Pa;this.a_=mb;this.GKb=Tb;this.SAe=!1;this._state=null;this.shouldIgnoreFocusEvent=rc=>{var Tc;return this.Rb.rc.lr&&!this.Rb.rc.FI&&rc===(null===(Tc=this.Rb.editingView)||void 0===Tc?void 0:Tc.editingElement)};this.ma=new Rd.a;this.orc=new od.a;this.uIe((rc,Tc)=>{Wj.g5l(h,Tc.definition)});this.APg((rc,Tc)=>{Wj.f5l(h,Tc.definition)});this.fb.fd(Wj.pxd).rK=!0}uIe(a){this.ma.addHandler(Wj.Qrf,a)}Eri(a){this.ma.removeHandler(Wj.Qrf,
a)}mLm(a){this.ma.raiseEvent(Wj.Qrf,new Dk(a))}APg(a){this.ma.addHandler(Wj.Prf,a)}ZXm(a){this.ma.removeHandler(Wj.Prf,a)}lLm(a){this.ma.raiseEvent(Wj.Prf,new Cn(a))}LRn(a){if(!a.isDismissed&&a.ela){var c=Hn.c(a.paragraphNode,a.cpBegin,a.cpEnd);if(c&&c.length){c=Hn.b(c);var h=Ve.a.getElementBounds(a.ela);c.width||c.height?c.x+c.width<h.x||c.x>h.x+h.width||c.y+c.height<h.y||c.y>h.y+h.height?this.dismiss():(h=a.target,h.style.left=c.x+"px",h.style.top=c.y+"px",h.style.width=c.width+"px",h.style.height=
c.height+"px",a.menu.updatePosition()):(r.ULS.sendTraceTag(50968328,341,15,"Unable to obtain valid updated anchor for UX"),this.dismiss())}else r.ULS.sendTraceTag(50968327,341,15,"Unable to obtain updated anchor for UX"),this.dismiss()}}Oli(a){a.isDismissed||a.w7d||(a.w7d=new Se.a(2,1,1,()=>{a.w7d=null;this.LRn(a)},147),this.Ta.ub(a.w7d))}PAa(a,c){!a.isDismissed&&a.tvk&&0<c.pS.length&&(this.dismiss(),r.ULS.sendTraceTag(594363728,341,50,"Menu dismissed from selection change (possibly typing)"))}CLj(a){return!!a&&
a.id===Wj.iBj}Tra(a,c){if(a.isDismissed||!c||!c.Sa)return!1;c=c.Sa;const h=c.keyCode,v=!a.isFocused&&!!a.menu,B=c.altKey||c.ctrlKey||c.shiftKey;let X=!1;h===vb.a.V5?(this.dismiss(),r.ULS.sendTraceTag(594363727,341,50,"Dismiss menu from keyboard"),X=!0):h!==vb.a.Nq&&h!==vb.a.Sv||!v||B||!this.CLj(a.definition)?h!==vb.a.ZIb&&h!==vb.a.t_c||!v||B||(this.nGf(a),a.menu?(a.menu.focus(),X=!0,r.ULS.sendTraceTag(594363725,341,50,"Focus menu from keyboard")):r.ULS.sendTraceTag(576582676,341,50,"Began focus menu from keyboard but dismissed before completion")):
(a.menu.executeDefaultAction(),r.ULS.sendTraceTag(594363726,341,50,"Default action from keyboard"),X=!0);X&&(c.preventDefault(),c.stopPropagation());return X}lOc(a,c){if(a.isDismissed)return!1;a.menu.invokeBadgeId(c);r.ULS.sendTraceTag(526463882,341,50,"Badge ID action from dictation correction voice command");return!0}zOc(a,c){if(a.isDismissed)return!1;a.menu.executeActionFromString(c);r.ULS.sendTraceTag(526463883,341,50,"Execute action from dictation correction voice command as string");return!0}M4(a,
c){if(a.isDismissed||!c||!c.Sa)return!1;const h=a.target;a=a.menu.getElementBounds();var v=c.Sa;c=v.clientX;v=v.clientY;h&&Wj.Shi(c,v,Ve.a.getElementBounds(h),16)||a&&Wj.Shi(c,v,Wj.YUj(a),4)||this.dismiss();return!1}dln(a){var c=Hn.c(a.paragraphNode,a.cpBegin,a.cpEnd);if(!c||!c.length)return!1;c=Hn.a(c,"OfficeContextualTarget");if(!c)return!1;a.container=Wj.gyc();a.target=c;a.editingElement=this.Rb.editingView.editingElement;a.ela=this.Rb.rc.container;a.documentElement=document.documentElement;a.PAa=
(h,v)=>{this.PAa(a,v)};a.Tra=h=>this.Tra(a,h);a.M4=h=>this.M4(a,h);a.onScroll=()=>{this.Oli(a)};a.onResize=()=>{this.Oli(a)};a.showDictationCommandUx&&(a.lOc=h=>this.lOc(a,h),a.zOc=h=>this.zOc(a,h),this.GKb&&this.GKb.execute(h=>{h.Ogn(a.lOc);h.Qgn(a.zOc)}));document.body.appendChild(a.container);document.body.appendChild(a.target);this.ya.aC(a.PAa);this.gh.r_(a.onResize);this.jd.Ea(Jb.a.tG,a.editingElement,a.Tra);a.U9a&&this.Bi.Ea(Jb.a.sda,a.documentElement,a.M4);Ld.a.addHandler(a.ela,"scroll",a.onScroll);
a.HKa||this.nGf(a);return!0}hyb(a){const c=!!a.menu;this.lLm(a.definition);a.container&&document.body.removeChild(a.container);a.target&&document.body.removeChild(a.target);a.isFocused&&this.fb.nf.name===Wj.pxd&&this.fb.gP(Wj.pxd);a.PAa&&this.ya.fea(a.PAa);a.Tra&&a.editingElement&&this.jd.xb(Jb.a.tG,a.editingElement,a.Tra);a.showDictationCommandUx&&this.GKb&&this.GKb.execute(h=>{h.d2m();h.e2m();h.RBi(!1)});a.M4&&a.documentElement&&a.U9a&&this.Bi.xb(Jb.a.sda,a.documentElement,a.M4);a.onScroll&&a.ela&&
Ld.a.removeHandler(a.ela,"scroll",a.onScroll);a.onResize&&this.gh.eea(a.onResize);a.menu=null;a.container=null;a.target=null;a.isDismissed=!0;a.editingElement=null;a.documentElement=null;a.ela=null;a.PAa=null;a.Tra=null;a.M4=null;a.onScroll=null;a.onResize=null;a.lOc=null;a.zOc=null;c&&a.Xha&&(a.Nif?a.eDf=!0:a.Xha(a.Ltd))}vWa(a,c){var h;if(!c)return!1;switch(c.actionType){case Fn.b.Toggle:if(c.objectFulfillment===Wj.kEn)return this.SAe=!this.SAe,this.o0f(),!0;if(c.objectFulfillment===Wj.oEn)return{value:a}=
this.orc.Ab(c.suggestionGroup.type,!1),this.orc.Z(c.suggestionGroup.type,!a),!0;break;case Fn.b.GiveFeedback:if(!Zj.a.yJl(null===(h=c.suggestionGroup)||void 0===h?void 0:h.type))return this.focus(),this.o0f(),!0}a.Nif=!0;c=a.eBj.executeAction(c,a.paragraphNode,a.cpBegin,a.cpEnd);a.Nif=!1;a.eDf&&(a.eDf=!1,a.Xha(a.Ltd),a.Ltd=null);return c}Fon(a,c){return!(0<=a.positionInSet&&0<a.setSize)&&!c}MRi(a){var c;if(this.dln(a)){var h=1;l.AFrameworkApplication.K.$("RenderMultipleSuggestionGroupsInBranfordIsEnabled")&&
(h=3);var v=!1;0<(null===(c=a.definition.suggestionGroups)||void 0===c?void 0:c.length)&&(v=a.definition.suggestionGroups[0].type,v=this.orc.Ja(v)?this.orc.J(v):a.Gqn);c=!1;l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.FooterIconsInContextualCardIsEnabled",!1)&&(c=!0);const B=l.AFrameworkApplication.pa;h={containerElement:a.container,targetElement:a.target,definition:a.definition,onAction:X=>this.vWa(a,X),onDismiss:()=>{this.hyb(a)},openCustomDictionaryDialog:()=>B.processAction(ba.a.UVe,
2),keepCurrentFocus:a.HKa,preventDismissOnScroll:!0,preventDismissOnResize:!0,showSnippet:this.SAe,showDescription:v,showEditorButton:a.vHi,showEditorBranding:this.Fon(a.definition,a.vHi),hostServices:a.hostServices,maxSuggestionGroupNumber:h,renderFooterIcons:c,shouldIgnoreFocusEvent:this.shouldIgnoreFocusEvent,keyboardHandlerTarget:a.Ujh,showDictationCommandUx:a.showDictationCommandUx,editingElement:a.editingElement};a.ifi&&a.ifi(h);this.Ax.createContextualUi(h).then(X=>{this.mLm(a.definition);
a.menu=X;a.iHi&&a.iHi();a.showDictationCommandUx&&this.GKb&&this.GKb.execute(ma=>ma.RBi(!0))}).catch(X=>{this.hyb(a);r.ULS.sendTraceTag(50631187,341,10,"Failed to show menu. Error: {0}",X)});0<a.KUd&&r.ULS.sendTraceTag(50968329,341,50,"Needed {0} tries to obtain updated anchor for UX",a.KUd)}else 5<++a.KUd?(r.ULS.sendTraceTag(50968330,341,15,"Unable to obtain initial anchor for UX after maximum tries -- giving up"),this.dismiss()):this.Ta.ub(new Se.a(2,1,Math.pow(3,a.KUd),()=>{a.isDismissed||this.MRi(a)},
146))}get PX(){return!!this._state&&!this._state.isDismissed}EWh(a){let c=!1;({value:c}=this.orc.Ab(a,!1));return c}M_f(a,c){this.PX&&(this._state.cpBegin=a,this._state.cpEnd=c)}get definition(){return this.PX?this._state.definition:null}set definition(a){this.PX&&(this._state.definition=a,this._state.menu&&this._state.menu.setDefinition(a))}focus(){this.PX&&this._state.menu&&(this._state.isFocused||this.nGf(this._state),this._state.menu.focus())}o0f(){this.PX&&this._state.menu&&this._state.menu.updatePosition()}nGf(a){this.fb.NI(Wj.pxd,
!1);a.isFocused=!0}j0a(a,c,h,v,B,X=null,ma=null,Pa=null,mb=!1,Tb=null,rc=!1,Tc=!0,vd=null,ee=!1){if(!c||this._state&&!this._state.isDismissed)return!1;let Ie,Xe,Yf;if(!({paragraphNode:Yf,start:Ie,end:Xe}=Wj.dHn(a,Yf,Ie,Xe)).returnValue)return!1;this._state=new Em(Yf,Ie,Xe,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee);this.MRi(this._state);return!0}V_d(){this._state&&(this._state.Ltd=!0)}dismiss(){var a;this._state&&(this._state.isDismissed=!0,null===(a=this._state.menu)||void 0===a?void 0:a.dismiss())}static g5l(a,
c){a.logAction({actionType:Fn.b.SessionStart,engagement:Fn.a.Try,objectName:Wj.FNi,objectId:c.id});if(c.suggestionGroups)for(let h of c.suggestionGroups)a.logAction({actionType:Fn.b.Presented,engagement:Fn.a.See,objectName:h.type,objectId:h.id})}static f5l(a,c){a.logAction({actionType:Fn.b.SessionEnd,engagement:Fn.a.None,objectName:Wj.FNi,objectId:c.id})}static gyc(){const a=document.createElement("div");a.id="OfficeContextualContainer";return a}static YUj(a){return new Sys.UI.Bounds(a.left,a.top,
a.width,a.height)}static Shi(a,c,h,v){const B=h.y-v,X=h.x+h.width+v,ma=h.y+h.height+v;return h.x-v<=a&&a<=X&&B<=c&&c<=ma}static dHn(a,c,h,v){if(!a||!sd.ParagraphReader.tb(a.node)||a.contextId!==ic.a.Ub&&a.contextId!==ic.a.xc&&a.contextId!==ic.a.paragraph)return{returnValue:!1,paragraphNode:null,start:-1,end:-1};c=a.node;a.contextId!==ic.a.paragraph?(h=a.cpBegin,v=a.cpEnd):(h=0,v=c.characterData.length);return{returnValue:!0,paragraphNode:c,start:h,end:v}}jMc(){this.a_&&this.a_.execute(a=>{a.logActivity("WordWebEditorSeen",
null)})}}Wj.iBj="ActionSet";Wj.FNi="IntentGroup";Wj.pxd="CanvasContextualUxReact";Wj.kEn="Context";Wj.oEn="Description";Wj.Qrf="MenuDidOpen";Wj.Prf="MenuDidClose";Object(w.a)(Wj,"UxManager",null,[]);class Ep{constructor(){this.W=null}get name(){return"WordEditor.CanvasContextualProvider"}yb(a){this.W=a}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{this.El()})}El(){l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");const a=l.AFrameworkApplication.K.$("EditorGoalsEnabled");
(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(104)||l.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled")||l.AFrameworkApplication.K.$("RewriteIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))&&(l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("canvasContextual"):this.W.resolve("Common.IDynamicScriptLoaderProvider").$C.loadScript("canvasContextual")).then(()=>{this.W.ha("CanvasContextual.ICanvasContextualController",
()=>canvasContextual.FactoryGlobal.getWordContextualControllerInstance({uiCulture:l.AFrameworkApplication.uiCulture,dataCulture:l.AFrameworkApplication.dataCulture,isRightToLeft:l.AFrameworkApplication.isRtl,ulsLogger:new lo.a})).singleInstance();this.W.ha("WordEditor.CanvasContextualProvider.UxManager",()=>new Wj(nc.FocusManager.instance(),this.W.resolve("Box4.ISelectionManager"),this.W.resolve("CanvasContextual.ICanvasContextualController"),ec.InteractiveViewManager.instance,qc.KeyInputManager.instance,
l.AFrameworkApplication.Cb,l.AFrameworkApplication.na,l.AFrameworkApplication.na.RY,this.W.za("Common.ISystemInitiatedFeedback"),this.W.za("WordEditor.DictationCommands.CorrectionCommandUxStateManager"))).singleInstance();this.W.resolve("CanvasContextual.ICanvasContextualController");this.W.resolve("WordEditor.CanvasContextualProvider.UxManager");a&&(this.W.ha("CanvasContextual.IEditorInitializer",()=>canvasContextual.FactoryGlobal.getEditorInitializerInstance({uiCulture:l.AFrameworkApplication.uiCulture,
ulsLogger:new lo.a})).singleInstance(),this.W.resolve("CanvasContextual.IEditorInitializer").init(),this.W.ha("CanvasContextual.ISkittleControllerV2",()=>canvasContextual.FactoryGlobal.getSkittleControllerV2Instance({ulsLogger:new lo.a})).singleInstance(),this.W.resolve("CanvasContextual.ISkittleControllerV2"))}).catch(c=>{r.ULS.sendTraceTag(50422751,341,10,"CanvasContextualProvider - Failed to load Canvas Contextual script. Error: {0}",c)})}dispose(){}static main(){M.a.instance.Lb(new Ep)}}Object(w.a)(Ep,
"PackageManager",null,[1,2]);class Iq{constructor(a,c,h,v){this.ga=a;this.ya=c;this.NE=h;this.uqj=v}eb(){this.ga.ka(ba.a.HGd,ic.a.view,Object(m.a)(this,this.dDl,"insertIntelligentPlaceholderHandler"));this.ga.ka(ba.a.lrf,ic.a.view,Object(m.a)(this,this.T3h,"markCompleteIntelligentPlaceholderHandler"));this.ga.ka(ba.a.U3h,ic.a.view,Object(m.a)(this,this.T3h,"markCompleteIntelligentPlaceholderHandler"))}dDl(a,c,h){a=null;c.view.Cd&&(a=c.view);if(!a||!a.Ma)return 8;if(!this.NE.Ljf())return 2;if(1===
h)return 32;this.uqj.ohk();return 32}T3h(a,c,h){let v=null;c.view.Cd&&(v=c.view);if(!v||!v.Ma)return 8;if(!this.NE.Ljf())return 2;if(1===h)return 32;if(1!==this.NE.L_b(this.ya.Ca,!0).count)return 2;c=new gf.GraphTransaction(15);try{if(c.Oa(v.sc),!this.NE.eIn(a===ba.a.lrf))return 8}finally{c&&c.dispose()}return 32}}Object(w.a)(Iq,"IntelligentPlaceholderActor",null,[]);class bs{constructor(){this.xfc=new od.a;this.V2c=new od.a}XBj(a,c){let h;({value:h}=this.xfc.Ab(a,h)).returnValue||this.xfc.Z(a,h=
new va.a);h.add(c)}BCj(a,c){this.V2c.Ja(a)&&r.ULS.sendTraceTag(50954435,323,15,"Comment ID already exists for bookmark");this.V2c.Z(a,c)}VBj(a,c,h){this.XBj(a,c);this.BCj(c,h)}dTk(a){let c;return({value:c}=this.xfc.Ab(a,c)).returnValue?c:null}AVk(a){let c;return({value:c}=this.V2c.Ab(a,c)).returnValue?c:null}HXm(a){let c;if(({value:c}=this.xfc.Ab(a,c)).returnValue){for(let h of c)this.V2c.remove(h);this.xfc.remove(a)}else r.ULS.sendTraceTag(50954436,323,15,"No bookmarks found for user ID")}}Object(w.a)(bs,
"IntelligentPlaceholderAtMentionManager",null,[511]);class Ms{constructor(a,c){this.mL=this.Ync=null;this.Ba=a;this.Y2a=c}get key(){return"COMMENT"}get $u(){return WordEditorIntl.WordEditorStrings.L_Comment}get ypa(){return this.mL}reset(a){this.mL=a.node}ICa(a){let c=null;if(this.Ync&&this.aRh(a,this.ypa,this.Ync))return c=Object.assign(new Bu.a,{mE:this.key,contentObject:this.Ync}),{returnValue:!0,bF:c};this.Ync=null;const h=this.Y2a.jUe(this.ypa);if(this.Y2a.Qhf(h)){let v=h.Xc();for(;v;){if(this.aRh(a,
this.ypa,v))return this.Ync=v,c=Object.assign(new Bu.a,{mE:this.key,contentObject:v,description:this.wab()}),{returnValue:!0,bF:c};v=h.ni()}}return{returnValue:!1,bF:c}}aRh(a,c,h){if(this.MGi(h))return!1;const v=this.Y2a.P_b(h,!0),B=this.Y2a.P_b(h,!1);return v&&B&&this.Ba.CJd(c,v,B)&&(c=this.Y2a.tya(v,h.id,!0))&&(v!==this.ypa||c.Xa.cp<=a)&&(h=this.Y2a.tya(B,h.id,!1))&&(B!==this.ypa||h.Xa.cp>a||h.Xa.cp>=a)?!0:!1}MGi(a){return a.ia(Yb.a.BF,!1)}wab(){return null}}Object(w.a)(Ms,"CommentDetailsProvider",
null,[430,431]);class ct extends Ms{constructor(a,c){super(a,c)}get key(){return"FOLLOW UP"}get $u(){return WordEditorIntl.WordEditorStrings.L_IntelligentPlaceholder}MGi(a){return!a.ia(Yb.a.BF,!1)}wab(){return Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress}}Object(w.a)(ct,"IntelligentPlaceholderDetailsProvider",Ms,[]);var ud=b(1641),Cd=b(1791),ak=b(1645);class dt{constructor(){this.ROa=""}Nqa(a){this.ROa+=a}JNh(a){this.ROa+=a}ggf(a){this.ROa+=a}yNh(a){this.ROa+=a}}Object(w.a)(dt,"PlainTextFormatCreator",
null,[856]);var $q=b(1422),nn;(function(a){a[a.normal=0]="normal";a[a.beingCreated=1]="beingCreated";a[a.beingEdited=2]="beingEdited"})(nn||(nn={}));Object(w.b)("CommentType",nn);var Hv=b(361),fx=b(1489),Oi=b(1321);class up{constructor(){this.Ohc=new od.a}contains(a){return this.Ohc.Ja(up.snf(a))}add(a){this.Ohc.Z(up.snf(a),a)}remove(a){this.Ohc.remove(up.snf(a))}VJn(a){for(let c of a.Ohc)this.add(c.value)}Ojh(){const a=new Ua.a;for(let c of this.Ohc)a.add(c.value.Oj);return a}static snf(a){return a.Oj.toString()}}
Object(w.a)(up,"CommentRangeSet",null,[]);class ar extends Sys.EventArgs{constructor(a){super();this.commentNode=a}}Object(w.a)(ar,"OnFollowUpEventArgs",Sys.EventArgs,[]);class gx extends ar{constructor(a,c){super(a);this.mBm=c}}Object(w.a)(gx,"OnCreateEventArgs",ar,[]);class Ns extends ar{constructor(a,c){super(a);this.XQl=c}}Object(w.a)(Ns,"OnResolveEventArgs",ar,[]);var gn=b(210);class Uy{}Uy.D9d="MentionExperienceDegraded";Object(w.a)(Uy,"AtMentionsConstants",null,[]);class AB{constructor(a,c,
h,v,B,X,ma,Pa,mb,Tb){this.sOd=a;this.eRj=c;this.hYc=h;this.rod=v;this.Ma=B;this.xF=X;this.$Gd=ma;this.kOh=Pa;this.Xu=mb;this.Ouc=Tb;this.TLa=null;(a=xa.a.instance.ra("Box4.IEditStateEventManager"))&&a.addHandler(gn.a.rwa,this.A3m.bind(this))}Vkf(){return!!this.TLa}A3m(){this.Vkf()&&this.V_g&&(this.TLa.updateInputText(this.Knf,!1),this.V_g=!1)}eUb(a,c){this.Xu.sendNotification(a,c)}LEj(){const a=this.xF.editingView.editingElement;if(a){var c=a.getAttribute(we.a.Fuc);a.setAttribute(we.a.Fuc,c?c.toString()+
" PeoplePickerAutomationID":"PeoplePickerAutomationID")}else r.ULS.sendTraceTag(51218125,323,15,"Cannot find editing element")}ZWm(){const a=this.xF.editingView.editingElement;if(a){var c=a.getAttribute(we.a.Fuc);c?(c=c.toString().split(" "),Array.remove(c,"PeoplePickerAutomationID"),c.length?a.setAttribute(we.a.Fuc,c.join(" ")):a.removeAttribute(we.a.Fuc)):r.ULS.sendTraceTag(51218127,323,50,"No aria-controls when dismissing picker?")}else r.ULS.sendTraceTag(51218126,323,15,"Cannot find editing element")}H5j(){this.ZWm();
this.TLa&&this.TLa.updateInputText("a",!0);const a=document.getElementById("PeoplePicker");a&&document.body.removeChild(a);this.TLa=null;this.kOh.aBi(!0)}Mrm(a,c,h){r.ULS.sendTraceTag(41178053,323,50,"@ mention selected, callback to replace text");a=this.$Gd.gXa(a,h.displayName,h.email,h.id);this.eUb(String.format(WordEditorIntl.WordEditorStrings.L_AtMentionsSuggestionSelected,c),!0);a?r.ULS.sendTraceTag(558113739,323,50,"Successfully inserted at mentions"):this.Ouc.pi("LPPWordEditorKPI","FailedToInsertAtMention",
{isInternal:!0},{name:Uy.D9d,isInternal:!0})}Rqm(a,c){r.ULS.sendTraceTag(50954434,323,50,"Permissions received for entity");c&&this.Ouc.jB(ba.a.Y1j);this.$Gd.tql(a.id,c)}cnm(){this.xF.rc.lr&&!this.xF.rc.FI&&this.xF.editingView.AZe?this.V_g=!0:(this.sOd.reset(),r.ULS.sendTraceTag(41178054,323,50,"People picker dismissed off canvas"))}Ysm(){r.ULS.sendTraceTag(41178055,323,50,"People picker shown on canvas");this.LEj()}Qqm(a,c,h,v=new Map){v=Object.assign(new fi.a,{extendedProperties:v});this.Ouc.pi("LPPWordEditorKPI",
a,{isIntentional:c,isInternal:h,Uu:v},{name:Uy.D9d,Lm:"LPPFailedToInsertAtMention",isIntentional:c,isInternal:h,Uu:v})}cpi(){this.sOd.ipi(()=>{this.H5j()});this.sOd.Xoi((a,c)=>{this.Knf=a;if(this.TLa)this.TLa.updateInputText(this.Knf,!1);else if(this.Ouc.Pm("LPPWordEditorKPI",0),this.Ouc.jB(ba.a.avm),(a=this.$2k(c))&&a.height){c=a.y;const h=a.height,v=document.createElement("div");v.id="PeoplePicker";v.style.position="absolute";v.style.top=c-5+"px";v.style.left=a.x+"px";v.style.height=h+10+"px";document.body.appendChild(v);
a={editingElementId:this.xF.editingView.editingElement.id,containerElement:v,automationID:"PeoplePickerAutomationID",onReplaceTextCallback:Object(m.a)(this,this.Mrm,"onReplaceTextFromPicker"),onPermissionsReceivedCallback:Object(m.a)(this,this.Rqm,"onPermissionsReceivedFromPicker"),onDismiss:Object(m.a)(this,this.cnm,"onDismissPicker"),onShow:Object(m.a)(this,this.Ysm,"onShowPicker"),onFailure:Object(m.a)(this,this.Qqm,"onPeoplePickerServiceFailure")};this.eRj.createPeoplePicker(a).then(B=>{B.updateInputText(this.Knf,
!1);this.TLa=B;this.kOh.aBi(!1)})}});this.sOd.Yoi(a=>{if(this.TLa)this.TLa.onKeyDown(a.Sa.rawEvent)})}$2k(a){var c=this.Ma.Ca;if(!c)return null;c=c.Fa;if(!c)return null;c=c.sa;if(!c)return null;c=c.node;if(!c)return null;c=Object(ha.a)(150,c);if(!c)return null;c=Object(ha.a)(169,c.kj(this.xF.rc.gb));if(!c)return null;c=Object(ha.a)(102,c);if(!c)return null;let h=null;try{h=this.hYc.XW(this.rod.mZb(2,a),c,!1,!1,!1,!1)}catch(v){r.ULS.sendTraceTag(41178056,323,15,"Failed to get ip bounds due to exception {0}, will use fallback value.",
v)}return h}}Object(w.a)(AB,"WordEditorAtMentionsHandler",null,[484]);var Yh=b(1306);class Mq{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie){this.ga=a;this.Vb=c;this.S5a=h;this.ya=v;this.mo=B;this.Tb=X;this.Oi=ma;this.G8c=Pa;this.Bb=mb;this.rf=Tb;this.f8i=Tc;this.zh=vd;this.Fb=rc;this.ma=new Rd.a;this.Ld=ee;this.g8i=Ie;Oi.a.BIe((Xe,Yf)=>{this.BF(Yf.commentNode,!0)&&this.ma.raiseEvent(Mq.tOc)})}OPg(a){this.ma.addHandler(Mq.E$h,a)}GIj(a){this.ma.addHandler(Mq.zci,a)}pIj(a){this.ma.addHandler(Mq.Kpm,
a)}BIe(a){this.ma.addHandler(Mq.tOc,a)}BF(a,c){let h=a.ia(Yb.a.BF,!1);c&&(h=h&&!a.ia(Yb.a.J7,!1));return h}AJc(a){return this.mo.AJc(a)}c9k(a){for(let c of a)for(let h of c)if(Mq.Hmf(h.contextId))return h.node.Mb;return null}Zel(a,c,h){const v=new up,B=a.Mb;for(let X=0;X<a.la.length;X++){const ma=a.la.J(X);if(ma.cp>=c)break;if(ma.Ke&&ma.Ke.length)for(let Pa=0;Pa<ma.Ke.length;Pa++){const mb=ma.Ke.J(Pa);this.BF(B.Ra(mb.Oj),h)&&(mb.Nb?v.add(mb):v.remove(mb))}}return v}$el(a,c,h,v){const B=new up,X=a.Mb;
for(let ma=0;ma<a.la.length;ma++){const Pa=a.la.J(ma);if(Pa.cp>h)break;if(Pa.Ke&&Pa.Ke.length)for(let mb=0;mb<Pa.Ke.length;mb++){const Tb=Pa.Ke.J(mb);this.BF(X.Ra(Tb.Oj),v)&&(Tb.Nb?Pa.cp<h&&B.add(Tb):Pa.cp<=c&&B.remove(Tb))}}return B}pCh(a,c){let h;const v=a.node;a.contextId!==ic.a.paragraph?(h=a.cpBegin,a=a.cpEnd):(h=0,a=v.characterData.length);return h===a?this.Zel(v,h,c):this.$el(v,h,a,c)}KEc(a,c){return Mq.Hmf(a.contextId)?this.pCh(a,c).Ojh():new Ua.a}L_b(a,c){const h=new up;for(let v of a)for(let B of v)Mq.Hmf(B.contextId)&&
h.VJn(this.pCh(B,c));return h.Ojh()}Ljf(){var a=this.ya.Ca;if(!a||1!==a.length||1!==a.J(0).length)return!1;a=a.J(0).sa.node;return sd.ParagraphReader.tb(a)&&!sd.ParagraphReader.axa(a)&&this.mo.Z1b(this.ga,!0)?!0:!1}ANh(a,c){if(!this.Ljf())return null;if(this.mo.ssl())return r.ULS.sendTraceTag(592761861,323,15,"Placeholder insertion failed because of draft comment"),null;let h=!1;var v=this.ya.Ca.J(0).sa;v.contextId===ic.a.Ub?(a=a?Gc.SelectionEditor.a0(v,!1):null)&&a.eC&&a.sa.contextId===ic.a.xc?this.ya.setSelection(a):
(this.Tb.replaceTextRange(v,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText+" ",!0),this.ya.setSelection(ne.SelectionFactory.bO(v.node,v.cpBegin,v.cpBegin+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText.length))):h=!0;this.Ld.Tub||ud.a.instance.yHc();a=this.mo.tyc(this.ya.Ca.Fa);if(!a)return null;var B=this.Vb.ff(a);const X=B.Za(1);if(!X||393229!==X.Gb)return null;B=B.Za(2);if(!B||393230!==B.Gb)return null;this.I_f(a.Mb,a.id);this.ma.raiseEvent(Mq.E$h,
new gx(a,c));h&&(c=v.node,v=v.contextId!==ic.a.paragraph?v.cpEnd:c.characterData.length,this.ya.setSelection(ne.SelectionFactory.bO(c,v,v)));return a}HGd(a){return!!this.ANh(!0,a)}rgf(a,c,h,v,B,X){if(0>c)return!1;v="@"+v;const ma=v+" ",Pa=new gf.GraphTransaction(15);try{Pa.Oa(a);this.Tb.replaceTextRange(Oe.a.createTextRange(a,c,h),ma);this.Bb.Bf&&(this.rf.dQe(a,c,c+v.length),this.rf.rla(a,c+v.length,c+ma.length,1));const mb=this.Oi.BG(Oe.a.createTextRange(a,c,c+v.length),"mailto:"+B,!1,!0,!1);if(!mb)return!1;
const Tb=mb.Tx;if(!Tb)return r.ULS.sendTraceTag(51217483,323,15,"Insertion of IntelligentPlaceholderWithMention failed"),!1;this.ya.setSelection(ne.SelectionFactory.bO(a,c,c+v.length));let rc=this.ANh(!1,2);if(!rc)return!1;X&&this.G8c.VBj(X,Tb,rc.id);this.ya.setSelection(ne.SelectionFactory.vd(a,c+ma.length))}finally{Pa&&Pa.dispose()}return!0}gXa(a,c,h,v){const B=this.ya.If;return Gc.SelectionEditor.ke(B)?this.rgf(B.node,B.cpBegin-a,B.cpBegin,c,h,v):!1}bbl(a){if(1===a.length&&a.J(0).eC&&(a=a.J(0).sa,
a.contextId===ic.a.Ub&&sd.ParagraphReader.tb(a.node))){const c=a.node;for(let h=0;h<c.la.length;h++){const v=c.la.J(h);if(v.cp===a.cpBegin){a=v.vBd(!0,!0);if(0<a.length)return a[0].Oj;break}}}return null}Utb(a,c,h){return this.mo.byc(a,c,h).returnValue}gyd(a,c,h,v,B){let X=!1;const ma=a.characterData;if(c>=ma.length||h>ma.length||h<c)return{returnValue:!1,dqa:X};let Pa=c,mb=null;for(let rc=0;rc<a.la.length;rc++){const Tc=a.la.J(rc),vd=Tc.cp;if(!(vd<c)){if(Tc.Lk&&mb)try{const ee=ma.substring(Pa,vd),
Ie=new Cd.a;Ie.fullName=ee.startsWith("@")?ee.substr(1):ee;fx.a(mb,Ie);const Xe=new ak.a;fx.b(mb,Xe);B&&(Xe.contentId=this.f8i.l4e());v.ggf(ee,Ie,Xe);X=!0;mb=null;Pa=vd}catch(ee){var Tb=Object.assign(new fi.a,{extendedProperties:new Map});Tb.extendedProperties.set("exception",ee.message);this.g8i.pi("LPPWordEditorKPI","FailedToRenderAtMention",{isInternal:!0,Uu:Tb},{name:Uy.D9d,isInternal:!0,Uu:Tb})}vd<=h&&!mb&&(Tb=Math.min(vd,h),Tb>Pa&&v.Nqa(ma.substring(Pa,Tb)),Pa=vd);Tc.hyperlink&&Tc.hyperlink.aE&&
(mb=Tc.hyperlink);if(vd>=h)break}}return{returnValue:!0,dqa:X}}bqh(a,c,h,v,B,X=-1){B=!1;var ma=a.Ra(c),Pa=a.Ra(Yh.j(ma));ma=a.Ra(Yh.g(ma));X=0<X?X:Number.MAX_VALUE;a=this.Utb(Pa,c,!0);c=this.Utb(ma,c,!1);if(-1===a||-1===c)return{returnValue:!1,dqa:B};if(Pa===ma)return this.gyd(Pa,a,c,h,v);const mb=this.S5a.u9a(Pa,!1,!1);if(!mb)return{returnValue:!1,dqa:B};Pa=new Ua.a;let Tb=0;do Pa.add(mb.Sy),Tb+=mb.Sy.characterData.length;while(mb.Sy!==ma&&mb.xqa()&&Tb<X);for(X=0;X<Pa.count;X++)if(B=Pa.J(X),ma=B.characterData,
X)if(X===Pa.count-1){if(!({dqa:B}=this.gyd(B,0,c,h,v)).returnValue)return{returnValue:!1,dqa:B}}else{if(!({dqa:B}=this.gyd(B,0,ma.length,h,v)).returnValue)return{returnValue:!1,dqa:B};h.Nqa("\n")}else{if(!({dqa:B}=this.gyd(B,a,ma.length,h,v)).returnValue)return{returnValue:!1,dqa:B};h.Nqa("\n")}return{returnValue:!0,dqa:B}}fyd(a,c){let h;const v=new dt;return({dqa:h}=this.bqh(a,c,v,!1,h,-1)).returnValue?v.ROa:null}Lvd(a,c){var h=a.Ra(c);if(!h)return null;a=a.Ra(Yh.g(h));if(!a)return null;c=this.Utb(a,
c,!1);if(-1===c)return null;h=a.characterData;if(c>=h.length||!F.a.d9(h.charAt(c))){h=this.Fb.Ob(15);try{h.Oa(a),this.Tb.replaceTextRange(Oe.a.Sb(a,c)," ")}finally{h&&h.dispose()}}return ne.SelectionFactory.vd(a,c+1)}I_f(a,c){const h=a.Ra(c),v=new $q.a;let B=!1;({dqa:B}=this.bqh(a,c,v,!0,B)).returnValue&&(v.Nqa("\n"),this.mo.LTi(h,v.caa),this.ma.raiseEvent(Mq.ium))}L9m(a,c){for(let h of a){if(h.contains(c))return!0;for(let v of h)for(let B of c)if(v.node===B.node&&v.Xl>=B.Xl)return!0}return!1}jch(a,
c,h,v,B){const X=this.ya.Ca.clone(),ma=new Fv.a(Eb.App.oa.Da.Jb);a=ne.SelectionFactory.vd(a,c);h=Oe.a.Sb(h,v);a=ne.SelectionFactory.jC(a,h);this.ya.setSelection(a);h=!this.L9m(X,a);return 32===this.ga.Le(ma,zb.a.lF,2,!0,null,null)?(h?this.ya.mP(X):B!==N.a.nil&&(B=this.Lvd(this.zh.value,B),this.ya.setSelection(B)),!0):!1}OVm(a,c){var h=a.Ra(c);const v=a.Ra(Yh.j(h));a=a.Ra(Yh.g(h));if(v===a){h=" "+WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText;var B=v.characterData.indexOf(h);
-1!==B&&this.jch(v,B,a,B+h.length,c)}}pch(a,c,h){var v=a.Ra(c);if(!v)return!1;const B=a.Ra(Yh.j(v));a=a.Ra(Yh.g(v));v=this.Utb(B,c,!0);const X=this.Utb(a,c,!1);if(-1===v||-1===X||!this.jch(B,v,a,X,N.a.nil))return!1;h&&this.xch(c);return!0}xch(a){this.mo.iKf(a,!0)}eIn(a){var c=this.c9k(this.ya.Ca);if(!c)return!1;const h=this.L_b(this.ya.Ca,!0);if(1!==h.count)return!1;const v=c.Ra(h.J(0));if(a)c=this.pch(c,h.J(0),!1);else{const B=Yh.j(v),X=Yh.g(v);N.a.Go(B,X)||r.ULS.sendTraceTag(592487139,323,15,"User attempted to resolve comment that spans more than 1 paragraph");
this.Ydk(h.J(0));c.Ra(B).lj(16,!0);c=!0}c&&(v.setValue(Yb.a.J7,!0),this.ma.raiseEvent(Mq.zci,new Ns(v,a)));return c}RVg(a,c){a=this.L_b(this.ya.Ca,!1);c.yr[Mq.Udh]=!!a.count}Vai(a,c){if(c.yr[Mq.Udh]&&sd.ParagraphReader.tb(c.clone)&&(c=c.clone,a=c.Mb)&&(c=Oe.a.createTextRange(c,0,c.characterData.length),c=this.KEc(c,!1),c.count))for(let h of c)(c=a.Ra(h))&&c.setValue(Yb.a.BF,!1)}nXk(a,c,h){let v;const B=({rwc:mb}=this.mo.byc(c,h,!0)).returnValue;h=({rwc:v}=this.mo.byc(c,h,!1)).returnValue;let X=null,
ma=-1,Pa=-1;for(;mb<v;mb++){let Tb=c.la.J(mb);if(Tb.hyperlink&&Tb.hyperlink.aE&&Tb.hyperlink.Tx===a){X=Tb.hyperlink;ma=Tb.cp;break}}if(!X||ma<B)return{returnValue:!1,W7g:ma,V7g:Pa};for(a=mb;a<c.la.length;a++){var mb=c.la.J(a);if(mb.cp>h)break;if(mb.zX){Pa=mb.cp;break}}return{returnValue:-1!==Pa,W7g:ma,V7g:Pa}}HWm(a){var c=this.G8c.AVk(a);if(c){var h=null;Eb.App.oa&&(h=Eb.App.oa.Da.Zb.Lc);if(h){var v=h.Ra(c);c=h.Ra(Yh.j(v));var B=h.Ra(Yh.g(v));if(c!==B)r.ULS.sendTraceTag(50954439,323,10,"Mention bookmark has no associated comments");
else if(({W7g:a,V7g:B}=this.nXk(a,c,v.id)).returnValue){var X=new gf.GraphTransaction(7);try{X.Oa(c);let ma=Oe.a.createTextRange(c,a,B);this.Tb.replaceTextRange(ma,"");this.I_f(h,v.id)}finally{X&&X.dispose()}this.ya.Ca&&0<this.ya.Ca.length?(h=this.ya.Ca.J(0).sa,h.node===c?r.ULS.sendTraceTag(50954441,323,50,"Moving from cp {0} to {1}",h.cpBegin,a):r.ULS.sendTraceTag(50954442,323,50,"Moving selection to a different node")):r.ULS.sendTraceTag(50954443,323,50,"Unable to find selection start after deleting mention");
this.ya.setSelection(ne.SelectionFactory.vd(c,a))}else r.ULS.sendTraceTag(50954440,323,15,"Unable to compute hyperlink CPs for bookmark")}else r.ULS.sendTraceTag(50954438,323,15,"Unable to find object space for removing mention")}else r.ULS.sendTraceTag(50954437,323,15,"Mention bookmark has no associated comments")}tql(a,c){if(!c){c=this.G8c.dTk(a);if(!c){r.ULS.sendTraceTag(50954444,323,15,"No bookmarks found for userId");return}for(let h of c)this.HWm(h)}this.G8c.HXm(a)}dRk(){ud.a.instance.yHc();
const a=new Ua.a;for(let h of this.mo.vJe)if(h.Xr!==nn.beingCreated){var c=N.a.Ee(h.objectId);c=this.zh.value.Ra(c);this.BF(c,!0)&&a.add(c)}return a}m9m(a){a=this.mo.N$e(a);this.ya.setSelection(a)}Ydk(a){a?this.zh.value.Ra(a).setValue(Yb.a.BF,!1):r.ULS.sendTraceTag(594043491,323,10,"The given intelligent placeholder guid is null")}static Hmf(a){return a===ic.a.xc||a===ic.a.Ub||a===ic.a.paragraph}}Mq.Udh="DisableNestedIntelligentPlaceholder";Mq.E$h="CreateIntelligentPlaceholder";Mq.zci="ResolveIntelligentPlaceholder";
Mq.ium="UpdateIntelligentPlaceholder";Mq.tOc="DeleteIntelligentPlaceholder";Mq.Kpm="MentionAddedToFollowUpEventKey";Object(w.a)(Mq,"IntelligentPlaceholderEditor",null,[512,513,514]);class BB{constructor(a,c,h,v){this.tna=!1;this.Sj=!0;this.jd=null;this.Rb=a;this.zh=c;this.ya=h;this.G2=v}Wuc(a,c){this.tna||(a.Qqa?(this.n8a(c),this.tna=!0):a.lba(()=>{this.tna||(this.n8a(c),this.tna=!0)}))}dispose(){this.jd&&this.jd.xb(Jb.a.tG,this.Rb.editingView.editingElement,Object(m.a)(this,this.m8a,"beforeKeyDownHandler"))}n8a(a){this.jd=
a;this.Rb.rc.Rh&&this.jd.Ea(Jb.a.tG,this.Rb.editingView.editingElement,Object(m.a)(this,this.m8a,"beforeKeyDownHandler"))}m8a(a){if(!this.Sj||!this.a1j(a,this.ya.Ca))return!1;a.Sa.preventDefault();a.Sa.stopPropagation();this.Rb.rc&&this.Rb.rc.QAc(!1);a=this.Lvd(this.ya.Ca);if(!a)return!1;this.ya.setSelection(a);return!0}a1j(a,c){if(a.Sa.keyCode!==vb.a.Sv&&a.Sa.keyCode!==vb.a.Nq||1!==c.length||!c.J(0).eC)return!1;var h=this.G2.L_b(c,!0);if(1!==h.count)return!1;const v=c.J(0).sa.node;if(!sd.ParagraphReader.tb(v))return!1;
a=this.G2.Utb(v,h.J(0),!0);h=this.G2.Utb(v,h.J(0),!1);return c.J(0).sa.cpBegin<a||c.J(0).sa.cpEnd>h?!1:!0}Lvd(a){a=this.G2.L_b(a,!0);if(1!==a.count)return null;a=a.J(0);return this.G2.Lvd(this.zh.value,a)}aBi(a){this.Sj=a}}Object(w.a)(BB,"IntelligentPlaceholderKeyboardListener",null,[515,14]);class CB{constructor(a,c){this.ga=a;this.zqc=c}EEl(a){1===a&&this.ga.processAction(Sa.a.newComment,2);2===a&&(this.zqc.instance?this.zqc.instance.Lcc("https://go.microsoft.com/fwlink/?linkid=2154656")&&F.a.OX("https://go.microsoft.com/fwlink/?linkid=2154656")&&
window.open("https://go.microsoft.com/fwlink/?linkid=2154656","_blank"):r.ULS.sendTraceTag(556794450,323,15,"IntelligentPlaceholderPhaseOut Dialog's SafeLinkManager was not ready"));a=[Object.assign(new aa.a,{name:"DialogResult",int64:a})];re.d(ba.a.ynh,void 0,void 0,void 0,void 0,void 0,a)}ohk(){const a=new oe.StandardDialog;a.yc=11;a.Nd(1,WordEditorIntl.WordEditorStrings.L_TryIt);a.Nd(2,WordEditorIntl.WordEditorStrings.L_LearnMore);a.mv(WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsHeader,
WordEditorIntl.WordEditorStrings.L_PhaseOutFollowUpsContent,0,Object(m.a)(this,this.EEl,"intelligentPlaceholderPhaseOutHandler"));re.a("FollowUpsPhaseOutDialogShown")}}Object(w.a)(CB,"IntelligentPlaceholderPhaseOutDialogManager",null,[]);var Pz=b(1283);class xw{constructor(a,c,h,v,B,X){this.U2=this.mwe=null;this.Fb=a;this.NE=c;this.ya=h;this.Ta=v;this.JEe=B;this.zh=X;this.mT=new xe.a;this.Qq=new Pz.a;this.Izg=new Zc.a(this.mT);this.NE.OPg((ma,Pa)=>{this.SEj(Pa.commentNode)})}SEj(a){a=a.id;const c=
this.yAh(this.zh.value,a);c&&this.Qq.Z(a,c)}yAh(a,c){const h=a.Ra(c);return!h||this.NE.AJc(h)?null:this.NE.fyd(a,c)}WVj(a){const c=new Pz.a;var h=this.NE.L_b(a,!0);if(!h)return c;a=this.zh.value;for(let v of h)(h=this.yAh(a,v))&&c.Z(v,h);return c}iKf(a){if(this.mwe){const c=this.Fb.Ob(15);try{c.Oa(this.JEe()),this.NE.xch(this.mwe)}finally{c&&c.dispose()}}this.mwe=a?this.NE.bbl(a):null}Rql(a){const c=this.zh.value;if(a=a?this.WVj(a):new Pz.a){var h=new Zc.a(this.mT),v=new Zc.a(this.mT);xw.l_k(this.Qq,
a,h,v);for(var B of h)this.Qq.Z(B,a.J(B));for(let X of v)if(h=this.Qq.J(X),v=this.NE.fyd(c,X),this.Qq.remove(X),v&&(a=B=!1,oa.a.WCd().equals(v,WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?(a=!0,h=!1):h=-1<v.indexOf(WordEditorIntl.WordEditorStrings.L_InsertIntelligentPlaceholderAnchorText)?B=!0:!oa.a.WCd().equals(h,v),h||B||a)){v=this.Fb.Ob(15);try{v.Oa(this.JEe()),a?this.NE.pch(c,X,!0):(B&&this.NE.OVm(c,X),h&&this.NE.I_f(c,X))}finally{v&&v.dispose()}}}}eal(a){const c=
new Zc.a(this.mT);for(let h of a)for(let v of h)a=v.node,sd.ParagraphReader.tb(a)&&c.add(a.id);return c}tpl(a){var c=this.zh.value;const h=a?this.eal(a):new Zc.a(this.mT);if(h){a=new Ua.a;for(let X of this.Izg)if(!h.contains(X)){var v=c.Ra(X);if(v){v=v.la;for(let ma=0;ma<v.length;ma++){const Pa=v.J(ma).Ke;if(Pa)for(let mb=0;mb<Pa.length;mb++){var B=Pa.J(mb);B.Nb&&(B=c.Ra(B.Oj))&&B.ia(Yb.a.OXh,!1)&&N.a.Go(X,Yh.g(B))&&this.NE.AJc(B)&&a.add(B)}}}}this.Izg=h;if(a.count){c=this.Fb.Ob(7);try{c.Oa(this.JEe());
for(let X of a)X.Ig(Yb.a.OXh)}finally{c&&c.dispose()}}}}CEd(a){this.iKf(a);this.Rql(a);this.tpl(a)}K_g(){this.U2&&(this.Ta.me(this.U2),this.U2=null)}mOc(){if(this.U2||this.zh.hJh)this.K_g(),this.CEd(null)}b1(){this.U2||(this.U2=new Se.a(3,1,0,()=>{this.U2=null;this.CEd(this.ya.Ca)},130),this.Ta.ub(this.U2))}IF(){this.ya.aC(Object(m.a)(this,this.b1,"onSetSelectionFinished"));l.AFrameworkApplication.UK(()=>{this.mOc()})}dispose(){this.ya.fea(Object(m.a)(this,this.b1,"onSetSelectionFinished"));this.K_g()}static l_k(a,
c,h,v){for(let B of c){let X=B.key;a.Ja(X)||h.add(X)}for(let B of a)a=B.key,c.Ja(a)||v.add(a)}}Object(w.a)(xw,"IntelligentPlaceholderSelectionCache",null,[14]);var Nq;(function(a){a[a.unknown=0]="unknown";a[a.contextMenu=1]="contextMenu";a[a.atMention=2]="atMention";a[a.Hdo=3]="textGesture";a[a.paste=4]="paste";a[a.yZn=5]="workItemIntent";a[a.T4n=6]="characterTrigger"})(Nq||(Nq={}));Object(w.b)("IntelligentPlaceholderCreation",Nq);class Fu{constructor(a,c,h,v){this.yua=a;this.Xi=c;this.DKb=h;this.Mu=
v}D1d(a){return a&&a.Mb&&a.Mb.id.equals(this.Mu.value.Lc.id)?!0:!1}fGi(a){return this.D1d(a)&&a.ia(Yb.a.BF,!1)?!0:!1}k6l(){this.DKb.execute(a=>{a.logAction({actionType:Fn.b.SessionStart,engagement:Fn.a.Offer,objectName:Fu.Qbc})})}fNd(a,c){let h=!1;l.AFrameworkApplication.K.$("FixInCanvasMentionLogging")&&(h=2==c&&this.D1d(a));if(this.fGi(a)||h){var v=a.getValue(Yb.a.JD);this.DKb.execute(B=>{B.logAction({actionType:Fn.b.Created,engagement:Fn.a.None,objectName:Fu.Qbc,objectId:v.toString(),objectFulfillment:Nq[c]})})}}b3l(a){if(this.fGi(a)){var c=
a.getValue(Yb.a.JD);this.DKb.execute(h=>{h.logAction({actionType:Fn.b.Deleted,engagement:Fn.a.None,objectName:Fu.Qbc,objectId:c.toString()})})}}e7l(a,c){if(this.D1d(a)){var h=a.getValue(Yb.a.JD);this.DKb.execute(v=>{v.logAction({actionType:Fn.b.Resolved,engagement:Fn.a.None,objectName:Fu.Qbc,objectId:h.toString(),objectFulfillment:c?"RemoveText":"KeepText"})})}}l8l(a){a===ba.a.HGd&&this.DKb.execute(c=>{c.logAction({actionType:Fn.b.Deleted,engagement:Fn.a.None,objectName:Fu.Qbc,objectFulfillment:Fu.WBn})})}e5l(a){if(this.D1d(a)){var c=
a.getValue(Yb.a.JD);this.DKb.execute(h=>{h.logAction({actionType:Fn.b.Modified,engagement:Fn.a.None,objectName:Fu.Qbc,objectId:c.toString(),objectFulfillment:"MentionInserted"})})}}bTj(){this.k6l();this.yua.OPg((a,c)=>{this.fNd(c.commentNode,c.mBm)});this.yua.GIj((a,c)=>{this.e7l(c.commentNode,c.XQl)});this.yua.pIj((a,c)=>{this.e5l(c.commentNode)});this.Xi.IIe((a,c)=>{this.l8l(c.actionId)});Oi.a.BIe((a,c)=>{this.b3l(c.commentNode)})}}Fu.Qbc="IntelligentPlaceholder";Fu.WBn="Undo";Object(w.a)(Fu,"IntelligentPlaceholderTelemetry",
null,[]);class IC{constructor(){this.G2=this.r$c=this.Kfd=this.W=null}get name(){return"WordEditor.IntelligentPlaceholder"}yb(a){this.W=a;a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager",()=>new CB(l.AFrameworkApplication.pa,a.za("Common.App.SafeLinks.ISafeLinksManager"))).singleInstance();a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderAtMentionManager",()=>new bs).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager").singleInstance();
a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderEditor",()=>new Mq(l.AFrameworkApplication.pa,new gl.a,a.resolve("Box4.IParagraphIteratorFactory"),a.resolve("Box4.ISelectionManager"),a.resolve("WordEditor.Comments.IWordEditorCommentModel"),a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.IHyperlinkEditor"),a.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderAtMentionManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.IAtMentionHyperlinkConfigurator"),new qf.a(()=>Eb.App.oa.Da.Zb.Lc),a.resolve("WordEditor.Comments.CommentsSettings"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor").as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEventSource").singleInstance();a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor",
()=>new Iq(l.AFrameworkApplication.pa,a.resolve("Box4.ISelectionManager"),a.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),a.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderPhaseOutDialogManager"))).singleInstance();a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache",()=>new xw(a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),a.resolve("Box4.ISelectionManager"),
l.AFrameworkApplication.Cb,()=>Eb.App.oa.Da.Jb.sc,new qf.a(()=>Eb.App.oa.Da.Zb.Lc))).singleInstance();a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener",()=>new BB(ec.InteractiveViewManager.instance,new qf.a(()=>Eb.App.oa.Da.Zb.Lc),a.resolve("Box4.ISelectionManager"),a.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"))).as("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener").singleInstance();a.ha("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry",
()=>new Fu(a.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),a.resolve("Box4.IUndoManager"),a.za("CanvasContextual.ICanvasContextualController"),new qf.a(()=>Eb.App.oa.Da.Zb))).singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{this.El()})}El(){const a=this.W.resolve("Box4.IFeatureHelper");a.isFeatureEnabled(29)&&(this.W.za("WordEditor.CanvasContextualProvider.UxManager"),this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderActor").eb(),
this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderTelemetry").bTj(),this.G2=this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderInternalEditor"),dk.hHj(Object(m.a)(this.G2,this.G2.RVg,"beforeIntelligentPlaceholderPaste")),dk.tld(Object(m.a)(this.G2,this.G2.Vai,"onIntelligentPlaceholderPaste")),this.Kfd=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderSelectionCache"),a.isFeatureEnabled(156)||this.Kfd.IF(),this.r$c=this.W.resolve("WordEditor.IntelligentPlaceholder.IntelligentPlaceholderKeyboardListener"),
this.r$c.Wuc(Eb.App.oa.Da,qc.KeyInputManager.instance),this.GSm(this.W.za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor")))}dispose(){this.Kfd&&this.Kfd.dispose();this.r$c&&this.r$c.dispose();this.G2&&(dk.QXm(Object(m.a)(this.G2,this.G2.RVg,"beforeIntelligentPlaceholderPaste")),dk.sYm(Object(m.a)(this.G2,this.G2.Vai,"onIntelligentPlaceholderPaste")))}GSm(a,c,h){a&&a.execute(v=>{v.j1(new ct(c,
h))})}static main(){M.a.instance.Lb(new IC)}}Object(w.a)(IC,"PackageManager",null,[1,2]);var QE=window.FindReplaceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"FindReplaceTaskPane",Title:"STR@L_NavigationPaneTitle",Width:"300"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"GroupNavControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"NavControls",
DisplayMode:"Medium",TextAlign:"Left"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnHeadings",Command:"0xD0FBCB6A",LabelText:"STR@L_NavigationPaneHeadingsSubtitle"}},{name:"Button",attrs:{Id:"btnFind",Command:"0x7EC3CC8E",LabelText:"STR@L_Find"}},{name:"Button",attrs:{Id:"btnReplace",Command:"0x8358F6C1",LabelText:"STR@L_Replace"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"TwoRow"},children:[{name:"Row",
attrs:{Id:"SearchBoxPlaceholder",DisplayMode:"Medium"}},{name:"Row",attrs:{Id:"RowFindFilters",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelFilters",Command:"0x2F9A3D80",QueryCommand:"0x5E7080C7"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupReplaceInput",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"ReplacePlaceholder",DisplayMode:"Medium"}}]}]},{name:"Group",attrs:{Id:"GroupReplaceControls",
IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{Id:"RowReplaceButtons",DisplayMode:"Medium",TextAlign:"Right"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonReplace",Command:"0x3F2E19EE",LabelText:"STR@L_Replace"}},{name:"Button",attrs:{Id:"ButtonReplaceAll",Command:"0x69D75659",LabelText:"STR@L_ReplaceAll"}}]}]}]}]},{name:"Group",attrs:{Id:"GroupFindControls",IsStretched:"false"},children:[{name:"Section",attrs:{Type:"OneRow"},
children:[{name:"Row",attrs:{DisplayMode:"Medium"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"LabelSummary",Command:"0x2F9A3D80",QueryCommand:"0x7F7A1460"}}]}]}]},{name:"Section",attrs:{Type:"OneRow",HorizontalAlignment:"Right"},children:[{name:"Row",attrs:{Id:"RowFindButtons",DisplayMode:"Small"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"ButtonFindPrevious",Alt:"STR@L_FindPrevious",Command:"0x4457C7F4",QueryCommand:"0x89A9BD2C",Image16by16:"IMGMAP@we@UpArrow_16x16x32",
LabelText:"STR@L_FindPrevious"}},{name:"Button",attrs:{Id:"ButtonFindNext",Alt:"STR@L_FindNext",Command:"0xB28AED00",Image16by16:"IMGMAP@we@DownArrow_16x16x32",QueryCommand:"0x8CA2CFB8",LabelText:"STR@L_FindNext"}}]}]}]}]},{name:"Group",attrs:{Id:"FindResultsPlaceholder",IsStretched:"true"}},{name:"Group",attrs:{Id:"GroupOutOfSyncResultsNotification",IsStretched:"false"}}]}]}]},$B=b(1817),aC=b(1727),tu=b(1797),CD=b(1800),qA=b(1801);class yv{}yv.rvn="Search_16x16x32";yv.jvn="ClosePaneGlyph_16x16x32";
Object(w.a)(yv,"SearchBoxIcons",null,[]);var uu=b(1799);class Xw{constructor(){this.zig=null}get key(){return"FIND_HIT"}get $u(){return WordEditorIntl.WordEditorStrings.l_FindHitContentTitle}reset(a){this.zig=a.node.$Ia()}ICa(a){let c=null;for(let h of this.zig)if(h.begin<=a&&a<h.end)return c=Object.assign(new Bu.a,{mE:this.key,contentObject:h}),{returnValue:!0,bF:c};return{returnValue:!1,bF:c}}}Object(w.a)(Xw,"FindHitDetailsProvider",null,[430,431]);var tz=b(1464),dj=b(1394),DD=b(1445);class Ly{constructor(a,
c,h,v,B,X,ma,Pa=null,mb=null){this.Ek=null;this.ga=a;this.Fm=c;this.Gy=h;this.Mpb=v;this.tqg=B;this.Zc=ma;mb&&mb(1,Object(m.a)(this,this.dZa,"onBeforeAppClose"),null);this.BEa=Pa}k1(){}eb(){this.ga.Aa(ba.a.tHf,ic.a.view,Object(m.a)(this,this.eJm,"queryNavigationPaneToggleButton"),96);this.ga.ka(ba.a.QNa,ic.a.view,Object(m.a)(this,this.QNa,"toggleNavigationPane"));this.ga.ka(ba.a.zac,ic.a.view,Object(m.a)(this,this.yac,"showFindReplacePane"));this.ga.ka(ba.a.Ahb,ic.a.view,Object(m.a)(this,this.yac,
"showFindReplacePane"));this.ga.ka(zb.a.Kwd,ic.a.view,Object(m.a)(this,this.find,"find"));this.ga.ka(Sa.a.findInDocument,ic.a.view,Object(m.a)(this,this.findInDocument,"findInDocument"));this.ga.ka(zb.a.findOnPage,ic.a.view,Object(m.a)(this,this.Ylh,"findSearchBoxQuery"));this.ga.Aa(Sa.a.HIm,ic.a.view,Object(m.a)(this,this.TQc,"queryFindState"),97);this.ga.ka(zb.a.DPd,ic.a.view,Object(m.a)(this,this.NIk,"findNext"));this.ga.ka(zb.a.cVd,ic.a.view,Object(m.a)(this,this.XIk,"findPrevious"));this.ga.Aa(zb.a.RGf,
ic.a.view,Object(m.a)(this,this.RGf,"queryNextHit"),97);this.ga.Aa(zb.a.cHf,ic.a.view,Object(m.a)(this,this.cHf,"queryPreviousHit"),97);this.ga.ka(ba.a.aDd,ic.a.view,Object(m.a)(this,this.aDd,"goToFindHit"));this.ga.ka(zb.a.Zsb,ic.a.view,Object(m.a)(this,this.cancelSearch,"cancelSearch"));this.ga.ka(Sa.a.clearSearch,ic.a.view,Object(m.a)(this,this.clearSearch,"clearSearch"));this.ga.ka(Sa.a.E2g,ic.a.application,Object(m.a)(this,this.clearSearch,"clearSearch"));this.ga.ka(ba.a.Lwc,ic.a.view,Object(m.a)(this,
this.Lwc,"closeFindReplacePane"));this.ga.ka(Sa.a.a2e,ic.a.view,Object(m.a)(this,this.f7d,"updateFilters"));this.ga.ka(Sa.a.p2e,ic.a.view,Object(m.a)(this,this.f7d,"updateFilters"));this.ga.Aa(Sa.a.IVd,ic.a.view,Object(m.a)(this,this.IVd,"queryFindMatchCase"),97);this.ga.Aa(Sa.a.KVd,ic.a.view,Object(m.a)(this,this.KVd,"queryFindWholeWord"),97);this.ga.Aa(ba.a.CGf,ic.a.view,Object(m.a)(this,this.CGf,"queryFiltersLabel"),97);this.ga.Aa(ba.a.t8b,ic.a.view,Object(m.a)(this,this.t8b,"querySummaryLabel"),
97);this.ga.Aa(ba.a.DGf,ic.a.view,Object(m.a)(this,this.DGf,"queryFindComplete"),97);this.ga.Aa(ba.a.FGf,ic.a.view,Object(m.a)(this,this.FGf,"queryFindReplaceViewType"),97);this.ga.Aa(ba.a.EGf,ic.a.view,Object(m.a)(this,this.cli,"queryFindReplacePane"),97);Object(dj.b)()&&this.ga.Aa(ba.a.JVd,ic.a.view,Object(m.a)(this,this.JVd,"queryFindText"),96);this.tqg&&(this.ga.Aa(ba.a.Chb,ic.a.view,Object(m.a)(this,this.yac,"showFindReplacePane"),1028),this.ga.Aa(ba.a.nRc,ic.a.view,Object(m.a)(this,this.cli,
"queryFindReplacePane"),97),this.ga.Aa(ba.a.replace,ic.a.view,Object(m.a)(this,this.replace,"replace"),1028),this.ga.Aa(ba.a.replaceAll,ic.a.view,Object(m.a)(this,this.replaceAll,"replaceAll"),1028),l.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)&&this.ga.Aa(Sa.a.j2e,ic.a.view,Object(m.a)(this,this.MHk,"findAndReplaceInDocument"),1028));this.ga.ka(ba.a.Dac,ic.a.view,Object(m.a)(this,
this.yac,"showFindReplacePane"))}$If(){this.BEa&&this.BEa.execute(a=>{a.j1(new Xw)})}find(a,c,h,v,B){return 1===h?32:void 0===B||null===B?8:B.length?this.aVf(B):(this.DOe(tu.a.initial),32)}findInDocument(a,c,h,v,B){return this.kIi(ba.a.Ahb,a,c,h,v,B)}MHk(a,c,h,v,B){return this.kIi(ba.a.Chb,a,c,h,v,B)}kIi(a,c,h,v,B,X){if(1===v)return ya.SessionStatusManager.instance.pK?32:8;if(void 0===X||null===X)return 8;this.yac(a,h,2,B,X);a=this.Fm;a.MPf(X.CommandValueId);Object(dj.b)()&&("MatchCase"in X&&(a.matchCase=
X.MatchCase),"MatchWholeWord"in X&&(a.matchWholeWord=X.MatchWholeWord));return this.Ylh(c,h,v,B,X)}aVf(a){if(void 0===a||null===a||!a.length)return 32;a=CD.a.createQuery(a,this.NIm);if(void 0===a||null===a)return r.ULS.sendTraceTag(4069067,312,10,"InvalidQuery"),8;this.Gy.find(a);return 32}get NIm(){let a=qA.a.none;this.Fm.matchCase&&(a|=qA.a.matchCase);this.Fm.matchWholeWord&&(a|=qA.a.wholeWordOnly);return a}Ylh(a,c,h){return 1===h?32:this.aVf(this.Fm.XIa())}TQc(a,c,h,v,B){a=!this.Fm.FD;B[lp.a.Image16by16Class]=
a?Fd.getImageClass(yv.rvn):Fd.getImageClass(yv.jvn);B[lp.a.LabelText]=a?WordEditorIntl.WordEditorStrings.L_SearchFilterTooltip:WordEditorIntl.WordEditorStrings.l_SearchFilterCancelTooltip;B[lp.a.ApplyLabelTextToControlOnly]=!0;B[lp.a.EnsureControlRoleIsButton]=!0;B[lp.a.On]=!1;return 32}NIk(a,c,h){if(1===h)return 32;this.DGh(!1);return 32}XIk(a,c,h){if(1===h)return 32;this.DGh(!0);return 32}DGh(a){this.Fm.F9a!==uu.a.headings&&this.Fm.MZ&&(a?this.Gy.NTc.fnl():this.Gy.NTc.FGh())}RGf(a,c,h,v,B){B[Jj.a.Visible]=
this.Fm.sIi;return 32}cHf(a,c,h,v,B){B[Jj.a.Visible]=this.Fm.sIi;return 32}aDd(a,c,h,v,B){if(1===h)return 32;this.Gy.NTc.JGh(B);return 32}cancelSearch(a,c,h){if(1===h)return 32;this.DOe(tu.a.initial);return 32}Lwc(a,c,h){if(1===h)return 32;this.DOe(tu.a.initial);this.Fm.uz(!1);return 32}DOe(a){this.Fm.FD&&(this.Fm.Rza||r.ULS.sendTraceTag(5007321,312,50,"User action resulting in cancelling find operation in progress."),this.Gy.wTa(),this.Fm.v3(a))}clearSearch(a,c,h){if(1===h)return this.MHl(a===Sa.a.E2g);
this.Fm.clearSearch();return 32}MHl(a){return this.Fm.FD===tu.a.replaceAllInProgress||a&&!this.Fm.FD?8:32}f7d(a,c,h){if(1===h)return 32;switch(a){case Sa.a.a2e:this.Fm.matchCase=!this.Fm.matchCase;break;case Sa.a.p2e:this.Fm.matchWholeWord=!this.Fm.matchWholeWord}return this.aVf(this.Fm.XIa())}IVd(a,c,h,v,B){B[Uf.a.On]=this.Fm.matchCase;return 32}KVd(a,c,h,v,B){B[Uf.a.On]=this.Fm.matchWholeWord;return 32}CGf(a,c,h,v,B){a=this.Fm.matchCase;c=this.Fm.matchWholeWord;h="";a&&c?h=String.format(WordEditorIntl.WordEditorStrings.l_FindMultipleFiltersLabelText,
WordEditorIntl.WordEditorStrings.l_MatchCase,WordEditorIntl.WordEditorStrings.l_MatchWholeWord):a?h=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchCase):c&&(h=String.format(WordEditorIntl.WordEditorStrings.l_FindFilterLabelText,WordEditorIntl.WordEditorStrings.l_MatchWholeWord));B[Qp.a.Value]=h;B[Qp.a.Visible]=a||c;return 32}t8b(a,c,h,v,B){a=this.Fm.MZ;c="";switch(this.Fm.FD){case tu.a.startSearch:c=WordEditorIntl.WordEditorStrings.l_SummarySearching;
break;case tu.a.searching:c=a?this.y$e(WordEditorIntl.WordEditorStrings.l_SummarySomeResults):WordEditorIntl.WordEditorStrings.l_SummarySearching;break;case tu.a.searchComplete:c=this.y$e(WordEditorIntl.WordEditorStrings.l_SummaryAllResults);break;case tu.a.tooManyResults:c=this.y$e(this.Fm.Rza?WordEditorIntl.WordEditorStrings.l_SummaryAllResults:WordEditorIntl.WordEditorStrings.l_SummarySomeResults);break;case tu.a.noMatchesFound:c=WordEditorIntl.WordEditorStrings.l_SummaryNoMatches;break;case tu.a.replaceAllInProgress:c=
WordEditorIntl.WordEditorStrings.l_ReplaceAllInProgress;break;case tu.a.replaceAllComplete:c=WordEditorIntl.WordEditorStrings.l_ReplaceAllComplete}B[Qp.a.Value]=c;return 32}JVd(a,c,h,v,B){B&&(B.CommandValueId=this.Fm.XIa());return 32}y$e(a){return String.format(a,this.Fm.X3c,this.Fm.MZ)}replace(a,c,h,v,B){if(1===h)return this.ulf()?32:8;if(!this.ulf())return 8;a=this.Fm.Exb();"string"===typeof B&&B&&(a=B);r.ULS.sendTraceTag(6033813,312,50,"Replace Called");re.a("NavigationPaneReplace");B=this.Mpb.replace(a);
this.Fm.Mbn(B);return 32}ulf(){return this.Fm.IEc()&&0<this.Fm.MZ}replaceAll(a,c,h,v,B){if(1===h)return this.dRl()?32:8;a=this.Fm.Exb();"string"===typeof B&&B&&(a=B);re.a("NavigationPaneReplace");this.Ek=this.Zc.Pe("UserAction","ReplaceAll");this.Fm.v3(tu.a.replaceAllInProgress);r.ULS.sendTraceTag(4065348,312,50,"Replace All started feedback indicated to user.");DD.a.D_m(this.Fm.XIa(),this.Fm.Exb());this.Mpb.replaceAll(a,Object(m.a)(this,this.Krm,"onReplaceAllComplete"));return 32}Krm(a,c){this.Ek&&
(this.Ek.stop(),this.Ek=null);r.ULS.sendTraceTag(4065349,312,50,"{0}",{["ReplaceAll Complete.ReplaceCount"]:a,["TotalCount"]:c});DD.a.A_m(a,c);this.Fm.v3(tu.a.replaceAllComplete)}dRl(){return this.ulf()&&this.Fm.Rza}cli(a,c,h,v,B){c=!1;if(!B)return 8;this.Fm.Zf.isVisible&&(c=a===ba.a.nRc===this.Fm.IEc());a!==ba.a.nRc||this.tqg||(c=!1);B[Uf.a.On]=c;return 32}DGf(a,c,h,v,B){if(!B||!this.Fm.Zf.isVisible)return 32;B[Uf.a.On]=this.Fm.Rza;return 32}FGf(a,c,h,v,B){if(!B)return 32;B.currentFindReplaceViewType=
this.Fm.FD;return 32}eJm(a,c,h,v,B){if(1===h)return 32;a=B[Uf.a.On];B&&(B[Uf.a.On]=this.Fm.Zf.isVisible);a&&!B[Uf.a.On]&&(Ly.oQi(),re.a("NavigationPaneCrossClick"));return 32}static oQi(){null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("NavPaneFloodgateIsEnabled")&&window.setTimeout(()=>{const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");a&&a.execute(c=>{c.logActivity("NavPaneUsed","NavPaneFloodgateIsEnabled")})},Ly.Dxa)}QNa(a,c,h,v,B){const X=this.Fm.Zf.isVisible;r.ULS.sendTraceTag(42501021,
367,50,"Visibility: {0}",X);return X?this.Lwc(a,c,h,v,B):this.yac(a,c,h,v,B)}yac(a,c,h,v,B){if(1===h)return!ya.SessionStatusManager.instance.pK||Eb.App.mtb(c)?8:32;if(2===h){l.AFrameworkApplication.m9("AutoDetectedHeadingsIsEnabled");Ly.oQi();this.k1();tz.FindReplaceUIManager.OZj(a,B,this.Fm.Zf.isVisible);c=!0;a===ba.a.Dac&&void 0!==B&&null!==B&&(c=B);this.Fm.uz(!0,c);B=uu.a.initial;switch(a){case ba.a.zac:r.ULS.sendTraceTag(42501022,367,50,"");B=uu.a.headings;break;case ba.a.Ahb:B=uu.a.find;break;
case ba.a.Chb:B=uu.a.replace;break;case ba.a.Dac:B=uu.a.intelligentPlaceholder;break;case ba.a.QNa:B=this.Fm.F9a,B||(r.ULS.sendTraceTag(42501023,367,50,""),B=uu.a.headings)}this.Fm.Agn(B,c);return 32}return 8}dZa(){this.Fm.FD&&!this.Fm.Rza&&r.ULS.sendTraceTag(5007322,312,50,"App closed when find is in progress.")}static j0k(a,c,h,v){return new Ly(l.AFrameworkApplication.pa,a,c,h,v,nc.FocusManager.instance(),Eb.App.oa.Qo,xa.a.instance.za("Box4.Accessibility.IAccessibilityContextManager"),Object(m.a)(l.AFrameworkApplication.na.WK,
l.AFrameworkApplication.na.WK.Ea,"registerHandler"))}static i0k(a,c,h,v){return Ly.j0k(a,c,h,v)}}Ly.Dxa=5E3;Object(w.a)(Ly,"FindReplaceActor",null,[]);var JC=b(1395);class rA{constructor(){this.Mpb=this.Gy=this.fjc=this.d6c=null}get name(){return"WordEditor.FindReplace"}yb(){}init(){rA.Ua.pk.continueWith(()=>{this.El()})}El(){if(Eb.App.F2f){const a=Eb.App.y8d;this.fjc=tz.FindReplaceUIManager.getInstance(a);this.Gy=aC.FindManager.createInstance(this.fjc,$B.a.instance,JC.a.instance,!0);this.Mpb=this.Gy.VEb;
this.d6c=Ly.i0k(this.fjc,this.Gy,this.Mpb,a);this.d6c.eb();this.d6c.k1();this.d6c.$If();Eb.App.oa.updateCommandUI()}}dispose(){this.fjc&&this.fjc.dispose()}static get Ua(){return rA.Na||(rA.Na=xa.a.instance.resolve("Box4.IFeatureHelper"))}}rA.Na=null;Object(w.a)(rA,"FindReplacePackageManager",null,[1,2]);class bC{constructor(){}l4e(){return"_@_"+Ya.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+"Z"}kOn(a,c,h,v){c.Nbn(a,v);c.Zk(a,Ed.a.I5,!0);c.Zk(a,Yb.a.yKa,!0);c.Zk(a,Yb.a.fieldInstruction,
bC.Rkh(h));c.Zk(a,Yb.a.Qp,15)}nKj(a,c,h,v){const B=a.rrd(v);c.Zk(B,Ed.a.I5,!0);c.Zk(B,Yb.a.Qp,47);c.Zk(B,Yb.a.fieldInstruction,bC.Rkh(h));a=a.rrd(v);c.Zk(a,Ed.a.I5,!0);c.Zk(a,Yb.a.Qp,16);return[B.mi,a.mi]}ZOk(a,c,h){a=a.rrd(h);c.Zk(a,Ed.a.I5,!0);c.Zk(a,Yb.a.BAb,!0);return a.mi}static Rkh(a){return String.format(' HYPERLINK "{0}"',a)}}Object(w.a)(bC,"AtMentionHyperlinkConfigurator",null,[485]);class ED{constructor(a,c,h){this.enc=a;this.ya=c;this.Lne=!1;this.Xyf=this.Xyf.bind(this);this.mzf=this.mzf.bind(this);
this.kAf=this.kAf.bind(this);h&&h.execute(v=>{this.b3a=v})}cpi(){this.enc.Xoi(this.Xyf);this.enc.Yoi(this.mzf);this.enc.ipi(this.kAf)}Vkf(){return!1}Xyf(a,c,h){var v,B;c=Date.now();if(this.b3a){var X=null===(B=null===(v=this.ya.Ca)||void 0===v?void 0:v.Fa)||void 0===B?void 0:B.Pb;X?(v=X.node,sd.ParagraphReader.tb(v)?(B=sd.ParagraphReader.text(v),0>h||h>B.length?r.ULS.sendTraceTag(540340298,3034,50,"ContextIQUserInitHandler::onInputCallback - Position of the @ was not within the bounds of the paragraph."):
(this.Lne||(this.Lne=!0,this.b3a.Xsn(X)),this.b3a.M_f(h,h+a.length),a=B.substring(0,h)+a,this.b3a.x4e(v,a,h,c))):r.ULS.sendTraceTag(540541835,3034,10,"ContextIQUserInitHandler::onInputCallback - Current node is not a paragraph.")):r.ULS.sendTraceTag(540541834,3034,10,"ContextIQUserInitHandler::onInputCallback - Failed to get the current selection context.")}else r.ULS.sendTraceTag(537776153,3034,10,"ContextIQUserInitHandler::onInputCallback - ContextIQIntentProvider is not available yet.")}mzf(a){if(this.b3a)this.b3a.onKeyDown(a)}kAf(){this.Lne=
!1;this.b3a&&this.b3a.k3g()}}Object(w.a)(ED,"ContextIQUserInitHandler",null,[484]);var RE=b(1589);class zv{constructor(){this.Ax=this.W=null}get name(){return"WordEditor.AtMentions"}yb(a){this.W=a;a.ha("Box4.IAtMentionHyperlinkConfigurator",()=>new bC(a.resolve("Box4.IFeatureHelper"))).singleInstance();const c={jUa:zv.d0i,featureName:zv.v1i,occ:zv.F4i,cJb:7};a.ha("WordEditor.AtMentions.IFeatureUsageAndHealthLogger",()=>new Kn.a(Fa.Health.instance,new gt.a,c)).as("WordEditor.AtMentions.IFeatureUsageAndHealthLogger").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>
{this.El()})}dispose(){}El(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(29)&&(l.AFrameworkApplication.K.$("CanvasAtMentionDetectionIsEnabled")&&this.W.za("Common.App.People.IExternalPeopleAPI").execute(a=>{a.atMentionsEnabledAsync().then(c=>{l.AFrameworkApplication.K.$("ConsumerMentionsHostIsEnabled")&&(c=c&&l.AFrameworkApplication.K.$("WordEditorConsumerCanvasMentionsIsEnabled"));c&&this.WZl()})}),this.W.resolve("Box4.IAtMentionHyperlinkConfigurator"))}WZl(){(l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?
appResourceLoader.loadChunk("canvasAtMentions"):this.W.resolve("Common.IDynamicScriptLoaderProvider").$C.loadScript("canvasAtMentions")).then(()=>{l.AFrameworkApplication.K.Io(()=>{this.hRm()})})}hRm(){const a={peopleAPI:this.W.resolve("Common.App.People.IExternalPeopleAPI"),localizationDetails:{isRightToLeft:l.AFrameworkApplication.isRtl,appLocale:Sys.CultureInfo.CurrentCulture.name},useLPP:!0,isTestEnv:this.JTl()};this.Ax=canvasAtMentions.FactoryGlobal.getWordAtMentionsControllerInstance(a);RE.a.f9d()?
this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new ED(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.W.resolve("Box4.ISelectionManager"),this.W.za("WordEditor.CanvasContextual.ContextIQIntentProvider"))).singleInstance():this.W.ha("WordEditor.AtMentions.IWordEditorAtMentionsHandler",()=>new AB(this.W.resolve("Box4.AtMentions.IAtMentionsListener"),this.Ax,this.W.resolve("Box4.ITextMetricsAdapter"),this.W.resolve("Box4.ICaretPositionManager"),this.W.resolve("Box4.ISelectionManager"),
ec.InteractiveViewManager.instance,this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderEditor"),this.W.resolve("WordEditor.IntelligentPlaceholder.IIntelligentPlaceholderKeyboardListener"),this.W.resolve("Common.Utils.IAriaNotifier"),this.W.resolve("WordEditor.AtMentions.IFeatureUsageAndHealthLogger"))).singleInstance();this.W.resolve("WordEditor.AtMentions.IWordEditorAtMentionsHandler").cpi()}JTl(){var a,c;const h=null!==(a=l.AFrameworkApplication.sessionStartInfoSettings.Ring)&&
void 0!==a?a:"-1";a=null!==(c=l.AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)&&void 0!==c?c:"";return h===zv.V_i&&a===zv.U_i}}zv.V_i="-4";zv.U_i="DC2";zv.d0i="webasynccollabeng";zv.v1i="AtMentions";zv.F4i="AtMentionsFeatureUsage";Object(w.a)(zv,"PackageManager",null,[1,2]);var cv=b(1675);class jw{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(w.a)(jw,"CommonOptionalButtonProperties",
null,[]);class uz extends jw{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(w.a)(uz,"OptionalButtonProperties",jw,[]);var Th=b(1209);class FD{constructor(a,c,h,v,B){this.$e=a;this.Qye=c;this.WS=h;this.s3c=v;this.Oaj=B;this.sye=0;this.akd=!1;this.a3a=null;this.Fpg=this.hpg=!1;this.Hcj=new Map([["ReferencesSmartLookUp",!0],["SmartLookupSynonyms",!0],["SmartLookupContextMenu",!0],["SmartLookupDictionary",!0],["ChangePicture",!0]]);
this.vbj=[{id:`${Dr.d8b}_${1}`},{id:`${Dr.d8b}_${2}`},{id:`${Dr.d8b}_${3}`},{id:Th.a.Csd},{id:Th.a.crd},{id:Th.a.VTd},{id:Th.a.TTd}];this.g7i=[{id:"NewComment",count:2},{id:"CreatePullQuote"},{id:"DeleteBookmarkContextMenu"},{id:"EditBookmarkNameContextMenu"},{id:"EditIllustration"},{id:"CreateHeadingLink"},{id:"ReviewDesignerSuggestion"}];this.Wde=new Map;this.zqg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.SearchSuggestionInContextMenuIsEnabled",!1);this.Aij=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdaptiveContextMenuIsEnabled",
!1);this.dqg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.PersonalizerInContextMenuIsEnabled",!1);this.Kjj=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.OpenHyperlinkInlineViewIsEnabled",!1);this.wmj=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.WordOnline.AcmMaximumSuggestions",5);this.hpg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.GenericSignalSchemaIsEnabled",!1);this.Fpg=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.LoggingIntentIsEnabled",
!1);this.yPb=new Map;this.$e.Ea(this,cv.SearchSuggestionAnnotation.getTypeName());l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&this.Wde.set("InsertLink","InsertLinkFlyout");this.oTi()}WFm(a,c){const h=Date.now();this.sye&&1250>h-this.sye||0<this.yPb.size||(this.sye=h,this.a3a=a,this.Kgd=this.zgl(c),this.D2m(),this.hpg?this.W0m():this.V0m())}hK(a,c){if(a.annotationType===cv.SearchSuggestionAnnotation.getTypeName()&&a.content&&c===Jp.a.getTypeName()){c=
Date.now();a=a.content;var h=this.yPb.get(a.correlationId);if(h){window.clearTimeout(h.l5d);this.yPb.delete(a.correlationId);h.Ehi&&(this.s3c.R4m=h.Ehi);var v=a.menuSuggestions&&0<a.menuSuggestions.length,B=a.searchSuggestions&&0<a.searchSuggestions.length,X=!0;v&&(this.tPn(a.menuSuggestions,a.searchSuggestions),this.akd&&(X=!1));X&&this.Gsi();r.ULS.sendTraceTag(572057625,1303,50,JSON.stringify({["description"]:"[Zero term context menu] augloop response latency",["correlationId"]:a.correlationId,
["networkTime"]:a.networkTime,["executionTime"]:a.executionTime,["updateTime"]:Date.now()-c,["latencyMs"]:c-h.timestamp,["containsZTM"]:v,["expectedZTM"]:h.Rvd,["containsSearchSuggestions"]:B,["expectedSearchSuggestions"]:h.Y0e,["fallBack"]:X}))}}}zgl(a){const c=[],h=new Map,v=Date.now();for(const B of a){if(!B)continue;a=[];const X={itemsMetadata:new od.a};for(let ma=0;ma<B.ControlList.length;ma++){const Pa=B.ControlList[ma];if(Pa&&!Pa.ExternalId)continue;a.push(Pa.ExternalId);const mb={timeStamp:v,
source:"FallbackZeroTermMenu",confidenceScore:-1};X.itemsMetadata[Pa.ExternalId]=mb;h.set(Pa.ExternalId,mb)}c.push(appChrome.api.menuSection(a,B.Title,B.Lang,B.Id,X))}return{sections:c,commands:h}}jGn(a){return this.Wde.has(a)?this.Wde.get(a):a}bIl(a){return!appChrome.selectors.isControlDefined(a)||appChrome.selectors.isControlDisabled(a)?!1:this.Hcj.has(a)?this.Kgd.commands.has(a):!0}Z$g(a){return appChrome.actions.updateMenu("ZeroTermContextMenu",a,null,null,null,null,{menuTargetType:this.a3a})}twb(){const a=
Ti.a.instance.twb(),c=[],h=Date.now();for(let v of a)v.commandId&&c.push({Id:v.commandId,TimeElapsedSinceClick:(h-v.timeStamp)/1E3});return c}vZb(){const a=Ti.a.instance.vZb(),c=[],h=Date.now();for(let v of a)v.controlId&&c.push({Id:v.controlId,TimeElapsedSinceClick:(h-v.timeStamp)/1E3});return c}HWk(){const a=this.vZb(),c=this.twb(),h=this.a3a,v=this.u8e(),B=[];a&&a.length&&B.push({semantic:cv.ObjectSemantic.CommandIdHistory,type:cv.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:cv.SequenceType.CommandId,
Sequence:a}});c&&c.length&&B.push({semantic:cv.ObjectSemantic.ControlIdHistory,type:cv.ObjectSchemaType.CommandExecutionSequence,value:{SequenceType:cv.SequenceType.ControlId,Sequence:c}});(h&&h.length||v)&&B.push({semantic:"CanvasContext",type:"WordCanvasContext",value:{context:v.neighborhood,length:v.mentionLength,start:v.mentionStart,contentType:h}});return B.length?B:null}pAh(){if(!this.dqg)return null;const a={RankRequestData:{EventId:Ya.a.create().toString()},RewardRequestData:this.s3c.Q4m};
this.s3c.yui();return a}oTi(){this.WS.getSession().then(a=>this.R1c=a).catch(()=>{this.R1c=void 0})}W0m(){const a=this.HWk(),c=[cv.IntentIds.ZeroTermMenu];this.Fpg&&c.push(cv.IntentIds.Logging);this.zqg&&c.push(cv.IntentIds.KeyPhrases);const h=this.pAh();this.$Li(null,null,h,c,a)}V0m(){const a={CommandClickedEvents:this.vZb(),CommandActionEvents:this.twb(),ContentType:this.a3a},c=this.zqg?this.u8e():null,h=this.pAh();this.$Li(a,c,h)}$Li(a,c,h,v,B){var X,ma,Pa,mb;if(a||B){var Tb=new cv.SearchSuggestionSignal({correlationId:this.cXk(),
intents:v,personalizerData:h,contextObjects:B,context:null===c||void 0===c?void 0:c.neighborhood,start:null!==(X=null===c||void 0===c?void 0:c.mentionStart)&&void 0!==X?X:0,length:null!==(ma=null===c||void 0===c?void 0:c.mentionLength)&&void 0!==ma?ma:0,zeroTermMenuRequest:a});h=window.setTimeout(()=>{this.Prm(Tb.correlationId)},750);a={Rvd:!!a,Y0e:!!c,timestamp:Date.now(),l5d:h,Ehi:null===(mb=null===(Pa=Tb.personalizerData)||void 0===Pa?void 0:Pa.RankRequestData)||void 0===mb?void 0:mb.EventId};
this.yPb.set(Tb.correlationId,a);Pa=new Jp.l({parentPath:["Signal",cv.SearchSuggestionSignal.getTypeName()],items:[{id:Ya.a.create().toString(),body:Tb}]});this.R1c&&!this.R1c.xIc?this.R1c.submitOperation(Pa):(this.WS.submitOperation({operation:Pa}),this.oTi());r.ULS.sendTraceTag(574441286,1303,50,JSON.stringify({["description"]:"[Zero term context menu] search suggestion al workflow invocation",["correlationId"]:Tb.correlationId,["containsZTM"]:a.Rvd,["containsSearchSuggestions"]:a.Y0e,["intents"]:v}))}else r.ULS.sendTraceTag(556892510,
1303,15,"No search suggestion al workflow will be activated")}cXk(){const a=Ya.a.create().toString();appChrome.api.setOfeCorrelationId("ACM",a);return a}Prm(a){const c=this.yPb.get(a);c&&(this.yPb.delete(a),c.Rvd&&this.Gsi(),r.ULS.sendTraceTag(572057624,1303,15,JSON.stringify({["description"]:"[Zero term context menu] augloop request timeout",["correlationId"]:a,["containsZTM"]:c.Rvd,["containsSearchSuggestions"]:c.Y0e})))}Gsi(){const a=this.Z$g(this.Kgd.sections);appChrome.api.dispatch(a);this.S4g()}S4g(){this.akd=
!0}WVm(a){var c,h;const v=[],B=new Map;if(!a||0===a.length)return v;for(const X of a){if(!X||!X.controlIds||0===X.controlIds.length)continue;a={controlIds:[],id:X.id,title:X.title,lang:X.lang,data:{itemsMetadata:new od.a}};const ma="CommandsZTM"===X.id;for(const Pa of X.controlIds){if(B.has(Pa))continue;if(ma&&a.controlIds.length>=this.wmj)break;const mb=null===(h=null===(c=X.data)||void 0===c?void 0:c.itemsMetadata)||void 0===h?void 0:h[Pa];B.set(Pa,mb);a.controlIds.push(Pa);mb&&(a.data.itemsMetadata[Pa]=
mb)}0<a.controlIds.length&&v.push(a)}return v}D2m(){this.akd=!1;if(this.Aij){const a=[appChrome.actions.updateControlHiddenState("ContextMenu",!0),appChrome.actions.updateControlEnabledDisabledState("ZeroTermContextMenu",!1)];appChrome.api.dispatch(a)}}tPn(a,c){this.akd||(a=this.SPk(a,c),0<a.length&&appChrome.api.dispatch(a))}SPk(a,c){const h=[];let v=[];if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DisablePassThroughSections",!1)){var B=this.Cal();B&&0<B.length&&
v.push(...B)}(B=this.QOk())&&v.push(B);(B=this.rPk(h))&&v.push(B);Array.isArray(a)&&0<a.length&&(this.Kjj&&(B=this.Oaj.SBm(h))&&a.unshift({suggestion:B,rankingScore:-1,suggestionSource:"RichCommandZeroTermMenu"}),a=this.upa(a))&&(a.id="CommandsZTM",v.push(a));Array.isArray(c)&&0<c.length&&(c=this.tPk(c,h))&&v.push(c);(c=this.FOk())&&v.push(c);v=this.WVm(v);if(0===v.length)return[];this.dqg&&(this.s3c.o_n=this.Zdk(v));h.push(this.Z$g(v));this.S4g();return h}rPk(a){const c=[],h={itemsMetadata:new od.a};
if(this.Qye){var v=this.Qye.ENm();const B=Date.now();for(const X of v)v=X.Jvi.actionId,h.itemsMetadata[v]={timeStamp:B,source:this.Qye.source,confidenceScore:X.score},appChrome.selectors.isControlDefined(v)||a.push(X.Jvi.MOk()),c.push(v)}return 0<c.length?appChrome.api.menuSection(c,null,null,null,h):null}Cal(){var a,c;const h=null===(a=this.Kgd)||void 0===a?void 0:a.sections.filter(v=>{var B;return null===(B=v.id)||void 0===B?void 0:B.startsWith(Dr.ogh)});for(const v of h)if(null===(c=v.data)||void 0===
c?0:c.itemsMetadata)for(const B in v.data.itemsMetadata)v.data.itemsMetadata[B].source="PassThroughZeroTermMenu";return h}QOk(){const a=this.bph(this.vbj,"DefaultZeroTermMenu");return this.upa(a)}FOk(){const a=this.bph(this.g7i,"AdvertizedZeroTermMenu");return this.upa(a)}bph(a,c){const h=[];for(const v of a)v&&this.Jon(v)&&this.Kgd.commands.has(v.id)&&h.push({suggestion:v.id,rankingScore:-1,suggestionSource:c});return h}Jon(a){if("number"!==typeof(null===a||void 0===a?void 0:a.count))return!0;if(0===
a.count)return!1;a.count--;return!0}Zdk(a){const c=[];for(let v of a)for(let B of v.controlIds){var h=v.data;a=-1;let X=null;h&&h.itemsMetadata&&(h=h.itemsMetadata[B],a=h.confidenceScore,X=h.source);c.push({suggestion:B,rankingScore:a,suggestionSource:X})}return c}tPk(a,c){const h=[],v=[],B={itemsMetadata:new od.a};this.iAd();let X=0;for(let Pa of a){a=Pa.suggestion;var ma={neighborhood:a,mentionStart:0,mentionLength:a.length};ma=(new Bo.a).n$g(ma,23,null);a=Object.assign(new qh.a,{ExternalId:"ZeroTermContextMenuSearchSuggestion"+
X,LabelText:this.kUe(a,WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookupSubmenu_SearchMore),CommandValueId:ma});if(appChrome.selectors.isControlDefined(a.ExternalId))c.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),c.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,ma));else{ma={};const mb=Object.assign(new uz,{commandValueId:a.CommandValueId});ma["default"]="Insights_20";mb.iconSet=ma;v.push(appChrome.api.createButtonModel(a.ExternalId,
a.LabelText,mb))}h.push(a.ExternalId);B.itemsMetadata[a.ExternalId]={timeStamp:Date.now(),source:Pa.suggestionSource?Pa.suggestionSource:"SearchSuggestion",confidenceScore:Pa.rankingScore};X++;if(3<=X)break}0<v.length&&c.push(appChrome.actions.addControls(v));return h&&0<h.length?appChrome.api.menuSection(h,null,null,null,B):null}upa(a){const c=[],h={itemsMetadata:new od.a},v=Date.now();for(let B of a)a=this.jGn(B.suggestion),this.bIl(a)&&(c.push(a),h.itemsMetadata[a]={timeStamp:v,source:B.suggestionSource,
confidenceScore:B.rankingScore});return 0<c.length?appChrome.api.menuSection(c,null,null,null,h):null}u8e(){return(new Bo.a).getSelectedText()}iAd(){const a=this.u8e();return a.neighborhood.substr(a.mentionStart,a.mentionLength)}GBd(a){a=a?a.trim():null;let c=20;a&&0<a.length&&(a.length>c&&(c=F.a.jx(a,c)?c-1:c),a=a.length>c?a.substr(0,c).trim()+"...":a);return a}kUe(a,c,h){(a=this.GBd(a))&&0<a.length&&(h=String.format(c,a));return h}}Object(w.a)(FD,"AugLoopSearchSuggestionManager",null,[337,516]);
var GD=b(463),HD=b(302);b(1673);class Ix{constructor(a){this.Xlb=a;this.utc=[];GD.a.instance.wIe(this.gol.bind(this))}gol(a,c){a={commandId:c.actionName,timestamp:c.timeStamp};(new ID).YMn(a)&&(Array.insert(this.utc,0,a),this.utc.length>this.Xlb.g4h&&Array.removeAt(this.utc,this.Xlb.g4h))}}Object(w.a)(Ix,"ActionContextCache",null,[]);class uj{constructor(a){this.Cs=a}get paragraphId(){return this.Cs&&this.Cs.sa&&this.Cs.sa.node&&this.Cs.sa.node.id&&this.Cs.sa.node.id.guid?this.Cs.sa.node.id.guid.toString():
null}}Object(w.a)(uj,"SelectionDetailFetcher",null,[]);class ID{YMn(a){return"BrowserPasted"===a.commandId||"ImageResize"===a.commandId?(a.paragraphId=(new uj(this.k0())).paragraphId,!0):!1}k0(){var a=Eb.App.oa.Da.Jb;return a?(a=a.Ma)&&a.Ca&&a.Ca.length?a.Ca.Fa:null:null}}Object(w.a)(ID,"ActionContextFetcher",null,[]);class JD{constructor(a,c,h){this.Xlb=a;this.ga=c;this.dCg=h;this.source="RichAction";this.RTm()}ENm(){const a=[];for(const c of this.dCg){const h=c.Qih();h>=this.Xlb.threshold&&a.push({score:h,
Jvi:c})}a.sort((c,h)=>h.score-c.score);return a.slice(0,Math.min(this.Xlb.topN,a.length))}RTm(){for(const a of this.dCg){const c=a.jEk;this.ga.Aa(c.R9j,c.contextId,c.handler,c.flags)}}}Object(w.a)(JD,"ActionRecommender",null,[]);var lB;(function(a){a.O1n="WordEditor.ContextualSearch.RichAction.PreviousParagraphFormatApplier";a.N1n="WordEditor.ContextualSearch.RichAction.NextParagraphFormatApplier";a.M1n="WordEditor.ContextualSearch.RichAction.AdjacentImageAligner"})(lB||(lB={}));Object(w.b)("RichActionRegisterNames",
lB);class KD{constructor(){this.topN=2;this.threshold=.5;this.g4h=50;this.lbm=3}}Object(w.a)(KD,"FeatureSetting",null,[]);class mB{constructor(a,c,h,v,B){this.Ma=a;this.iconName=c;this.actionId=h;this.jBj=v;this.G8j=B;this.jF=void 0}get jEk(){return{R9j:this.G8j,contextId:Kc.a.frame,handler:this.Aba.bind(this),flags:1028}}MOk(){const a=new uz;var c={};c["default"]=this.iconName;a.iconSet=c;c=[];c.push(appChrome.api.createButtonModel(this.actionId,this.jBj,a));return appChrome.actions.addControls(c)}Aba(a,
c,h){if(1===h)return 32;c=new gf.GraphTransaction(15);c.Oa(this.jF.sa.node);c.ql=a;a=this.execute();c.dispose();return a}}Object(w.a)(mB,"RichAction",null,[]);class nB extends mB{constructor(a,c,h,v){super(a,"FormatPainter_20","previous"===v?"RaNeighborPreviousParagraphFormatApplier":"RaNeighborNextParagraphFormatApplier",`Format as ${v} paragraph`,"previous"===v?ba.a.Rli:ba.a.Qli);this.mt=c;this.W$d=h;this.P7i=v;this.dPb=void 0}Qih(){var a,c,h;this.jF=null===(c=null===(a=this.Ma)||void 0===a?void 0:
a.Ca)||void 0===c?void 0:c.Fa;this.dPb=void 0;if(1!==(null===(h=this.jF)||void 0===h?void 0:h.length)||!sd.ParagraphReader.eg(this.jF.sa.iterator)||this.jF.zM||!this.UIl)return 0;a=sd.ParagraphReader.jg(this.jF.sa.node,"previous"===this.P7i,!1,!1);if(!a||!sd.ParagraphReader.tb(a)||!this.tUh&&!this.QLl)return 0;this.dPb=a;return.9}execute(){if(!this.jF||!this.dPb)return 16;var a=Oe.a.createTextRange(this.dPb,0,sd.ParagraphReader.textLength(this.dPb));a=new xm.Selection([a],!1);this.mt.yDf(a);this.tUh?
(a=Oe.a.createTextRange(this.jF.sa.node,0,sd.ParagraphReader.textLength(this.jF.sa.node)),a=new xm.Selection([a],!1),this.mt.nmd(a)):this.mt.nmd(this.jF);this.dPb=this.jF=void 0;return 32}get tUh(){return this.jF.sa.cpBegin===this.jF.sa.cpEnd}get QLl(){return 0===this.jF.sa.cpBegin&&this.jF.sa.cpEnd===sd.ParagraphReader.textLength(this.jF.sa.node)}get UIl(){for(const a of this.W$d.utc)if("BrowserPasted"===a.commandId){const c=a.paragraphId;if(c){const h=(new uj(this.jF)).paragraphId;if(c===h)return!0}}return!1}}
Object(w.a)(nB,"NeighborParagraphFormatApplier",mB,[]);class LD extends nB{constructor(a,c,h){super(a,c,h,"previous")}}Object(w.a)(LD,"PreviousParagraphFormatApplier",nB,[]);class MD extends nB{constructor(a,c,h){super(a,c,h,"next")}}Object(w.a)(MD,"NextParagraphFormatApplier",nB,[]);class ND extends mB{constructor(a,c,h,v){super(a,"FormatPainter_20","RaAdjacentImageAligner","Align images",ba.a.Pli);this.Og=c;this.W$d=h;this.Xlb=v;this.dKb=void 0}Qih(){var a,c,h;this.jF=null===(c=null===(a=this.Ma)||
void 0===a?void 0:a.Ca)||void 0===c?void 0:c.Fa;if(1!==(null===(h=this.jF)||void 0===h?void 0:h.length)||!this.jF.zM)return 0;var v=dd.ImageReader.Jk(this.jF.sa);a=this.Kph(this.jF.sa.node,!0);c=this.pPh(v,a.FTb);h=this.Kph(this.jF.sa.node,!1);v=this.pPh(v,h.FTb);if(c&&!v)return this.dKb=a.FTb,.9;if(v&&!c)return this.dKb=h.FTb,.9;if(!c&&!v)return 0;this.dKb=this.rGl(h.pKj)?h.FTb:a.FTb;return.9}execute(){if(!this.jF||!this.dKb)return 16;const a=dd.ImageReader.Jk(this.jF.sa),c=dd.ImageReader.PD(this.dKb),
h=dd.ImageReader.oC(this.dKb);this.Og.mDi(a,this.jF.sa,h,c);return 32}Kph(a,c){let h=void 0,v=void 0;try{for(let B=-1;B<this.Xlb.lbm;++B){h=sd.ParagraphReader.jg(a,c,!1,!1);if(!h)break;if(v=dd.ImageReader.Jk(Oe.a.createTextRange(h,0,sd.ParagraphReader.textLength(h))))break;if(0<sd.ParagraphReader.textLength(h))break;a=h}}catch(B){r.ULS.sendTraceTag(545861641,1303,10,"Exception as getting adjacent image. Error: {0}",B),v=h=void 0}return{pKj:h,FTb:v}}pPh(a,c){if(!c)return!1;const h=dd.ImageReader.PD(a);
a=dd.ImageReader.oC(a);const v=dd.ImageReader.PD(c);c=dd.ImageReader.oC(c);return h===v&&a===c?!1:!0}rGl(a){a=a.id.guid.toString();for(const c of this.W$d.utc)if("ImageResize"===c.commandId)return c.paragraphId===a;return!1}}Object(w.a)(ND,"AdjacentImageAligner",mB,[]);class cC{constructor(a){this.Eb=a;this.ptc=null;this.D6a={EventId:null};this.eb()}eb(){this.Eb.Aa(ba.a.T8d,Kc.a.frame,Object(m.a)(this,this.T8d,"zeroTermContextMenuClose"),1124)}yui(){this.D6a={EventId:null};this.ptc=null}set R4m(a){this.D6a.EventId=
a}set o_n(a){this.ptc=a}get Q4m(){return this.D6a&&this.D6a.EventId&&this.D6a.OfferedSuggestions?this.D6a:null}T8d(a,c,h,v,B){var X;if(1===h)return 32;if(!this.ptc||0===this.ptc.filter(ma=>ma.suggestionSource===cC.source).length)return this.yui(),32;B&&B.iEk&&(this.D6a.ExecutedSuggestion={suggestion:null!==(X=B.Eao)&&void 0!==X?X:B.iEk,suggestionSource:B.source,rankingScore:B.confidenceScore});this.D6a.OfferedSuggestions=this.ptc;return 32}}cC.source="Personalizer";Object(w.a)(cC,"ContextualSearchPersonalizerActor",
null,[327]);class dC{}Object(w.a)(dC,"DocumentItem",null,[]);var OD=b(1674);class PD{constructor(a){this.Ma=a;this.xzj=RegExp("^(docx|pptx|ppsx|xlsx|pdf)$");this.yzj=["sharepoint.com","sharepoint-df.com"]}Wel(){var a,c;let h=null;const v=null===(c=null===(a=this.Ma)||void 0===a?void 0:a.Ca)||void 0===c?void 0:c.Fa;if(!v)return null;a=v.sa;if(32!==l.AFrameworkApplication.pa.Le(a,zb.a.ELa,1,!0,null,null))return h;(a=ch.HyperlinkReader.K_b(a))&&1===a.length&&(h=decodeURIComponent(a[0].hyperlink.url));
return h}DZk(a){const c=a.lastIndexOf(".");if(0>c)return null;a=a.substring(c+1).toLowerCase();return this.xzj.test(a)?a:null}UUl(a){const c=new URL(a);return c&&c.hostname&&this.yzj.find(h=>c.hostname.toLowerCase().includes(h))?!0:!1}SBm(a){const c=[];var h=new Bo.a,v=this.Wel();if(!v||!this.UUl(v))return null;const B=this.DZk(v);if(!B)return null;v={landingTab:"Files",data:{type:3,l2Document:Object.assign(new dC,{Id:Ya.a.create().toString(),Path:v,FileType:B,LastModifiedTime:null})}};h=h.n$g({neighborhood:"",
mentionStart:0,mentionLength:0},10,v);appChrome.selectors.isControlDefined("OpenHyperlinkInlineView")||(v=Object.assign(new uz,{commandValueId:h}),c.push(appChrome.api.createButtonModel("OpenHyperlinkInlineView",OD.WordRibbonStrings.m1n,v)));v=Object.assign(new qh.a,{ExternalId:"OpenHyperlinkInlineView",CommandValueId:h});a.push(appChrome.actions.setButtonCommandValueId(v.ExternalId,h));0<c.length&&a.push(appChrome.actions.addControls(c));return v.ExternalId}}Object(w.a)(PD,"ContextualSearchHyperlinkProcessor",
null,[326]);class KC{constructor(){this.W=null}get name(){return"WordEditor.ContextualSearch"}yb(a){this.W=a;l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RichActionInContextMenuIsEnabled",!1)&&(this.W.ha("WordEditor.ContextualSearch.RichAction.FeatureSetting",()=>new KD).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.ActionContextCache",()=>new Ix(this.W.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.PreviousParagraphFormatApplier",
()=>new LD(S.App.Hk.Da.Jb.Ma,this.W.resolve("Box4.IFormatPainter"),this.W.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.NextParagraphFormatApplier",()=>new MD(S.App.Hk.Da.Jb.Ma,this.W.resolve("Box4.IFormatPainter"),this.W.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.AdjacentImageAligner",()=>new ND(S.App.Hk.Da.Jb.Ma,
this.W.resolve("WordEditor.IImageEditor"),this.W.resolve("WordEditor.ContextualSearch.RichAction.ActionContextCache"),this.W.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"))).singleInstance(),this.W.ha("WordEditor.ContextualSearch.RichAction.ActionRecommender",()=>new JD(this.W.resolve("WordEditor.ContextualSearch.RichAction.FeatureSetting"),l.AFrameworkApplication.pa,Object.keys(lB).filter(c=>c.startsWith("Ra",0)).map(c=>this.W.resolve(lB[c])))).singleInstance());this.W.ha("WordEditor.ContextualSearch.ContextualSearchPersonalizerActor",
()=>new cC(l.AFrameworkApplication.pa)).as("WordEditor.ContextualSearch.IContextualSearchPersonalizerActor").singleInstance();this.W.ha("WordEditor.ContextualSearch.ContextualSearchHyperlinkProcessor",()=>new PD(S.App.Hk.Da.Jb.Ma)).as("WordEditor.ContextualSearch.IContextualSearchHyperlinkProcessor").singleInstance();this.W.ha("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager",()=>new FD(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.ra("WordEditor.ContextualSearch.RichAction.ActionRecommender"),
augLoop.ALFactoryGlobal.getAugLoopRuntimeManager(),this.W.resolve("WordEditor.ContextualSearch.IContextualSearchPersonalizerActor"),this.W.resolve("WordEditor.ContextualSearch.IContextualSearchHyperlinkProcessor"))).as("WordEditor.ContextualSearch.ISearchSuggestionManager").singleInstance()}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{Yg.a.Yn().then(()=>{this.start()})})}start(){this.W.resolve("WordEditor.ContextualSearch.AugLoopSearchSuggestionManager")}dispose(){}static main(){M.a.instance.Lb(new KC)}}
Object(w.a)(KC,"PackageManager",null,[1,2]);var eC=b(316),St=b(847);class vz extends St.a{constructor(){super();this.documentUrl=this.scripts=null}}Object(w.a)(vz,"BootMessage",St.a,[]);var wz=b(923);class Jx{constructor(){this.UH=null;this.D1c=new gd.a}Ymf(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}create(a,c){let h=!1;try{this.UH=new Worker(a);this.UH.onmessage=Object(m.a)(this,this.Qpm,"onMessageHandler");
const v=Object.assign(new vz,{api:0,method:0,scripts:c,documentUrl:document.URL});this.postMessage(v);this.Ymf()&&wz.a.X5i(this.UH);h=!0}catch(v){r.ULS.sendTraceTag(50442775,3007,10,"WebWorker: Error creating worker. Exception: {0}",v)}return h}postMessage(a){try{const c=z.c(a);this.UH.postMessage(c)}catch(c){r.ULS.sendTraceTag(50442776,3007,10,"WebWorker: Error sending a message to worker thread. Exception: {0}",c)}}Qpm(a){if(a.target===this.UH)if(void 0===a.data||null===a.data)r.ULS.sendTraceTag(50739143,
3007,10,"WebWorker: The received message did not have any data.");else try{if("string"===typeof a.data){const c=z.a(a.data);this.O3d(c.api)?this.D1c.J(c.api).y5b(c.method,c):r.ULS.sendTraceTag(50739144,3007,10,"WebWorker: The received message contained an unsupported API.")}}catch(c){r.ULS.sendTraceTag(50739145,3007,10,"WebWorker: Error routing a message received from a worker thread. Exception: {0}",c)}}O3d(a){return this.D1c.Ja(a)}BBj(a,c){this.O3d(a)&&r.ULS.sendTraceTag(50442777,3007,10,"WebWorker: We're overwriting an existing API in the collection.  ApiId: {0}",
a);this.D1c.Z(a,c)}VRk(a){return this.O3d(a)?this.D1c.J(a):null}}Object(w.a)(Jx,"WebWorker",null,[64]);class xz{constructor(){this.$2f=[]}knk(a,c){if(c){var h=l.AFrameworkApplication.vx(a.Mxi,7),v=[];for(let B=0;B<a.pHb.length;B++){let X;switch(a.pHb[B].format){case 5:case 6:X=eC.a.cbb(a.pHb[B].name);break;default:X=a.pHb[B].name}v.push(l.AFrameworkApplication.vx(X,a.pHb[B].format))}try{const B=URL.createObjectURL(new Blob(["importScripts('"+h+"');"],{type:"application/javascript"})),X=new Jx;if(X.create(B,
v))for(this.$2f.push(X),h=0;h<a.N3d.length;h++){const ma=c.Zfk(X,a.N3d[h]);ma&&X.BBj(a.N3d[h],ma)}}catch(B){r.ULS.sendTraceTag(50442778,3007,10,"Exception caught when creating a new worker. Exception: {0}",B.message)}}else r.ULS.sendTraceTag(42824902,3007,10,"CreateWebWorker: ApiFactory parameter was null.")}}Object(w.a)(xz,"WebWorkerCollection",null,[]);class yz{constructor(a,c){this.mGe=new xz;if(a){a=a.create();for(let h=0;h<a.length;h++)this.mGe.knk(a[h],c)}else r.ULS.sendTraceTag(50442779,3007,
10,"WebWorkerRouter: configFactory parameter was null.")}Qg(a,c,...h){let v=!1;for(let X=0;X<this.mGe.$2f.length;X++){var B=this.mGe.$2f[X];B.O3d(a)&&((B=B.VRk(a))?v=B.$Ub(c,h)||v:r.ULS.sendTraceTag(50442780,3007,10,"WebWorkerRouter: Failed to get an Api that is supported by the web worker. ApiId: {0}",a))}v||r.ULS.sendTraceTag(50442781,3007,10,"WebWorkerRouter: A SendMessage did not find a worker to succesfully send the message to. ApiId: {0}, MethodId: {1}",a,c)}}Object(w.a)(yz,"WebWorkerRouter",
null,[23]);class kw{constructor(){this.D=this.ST=0}}Object(w.a)(kw,"LongTaskInfo",null,[]);class QD{constructor(a,c){this.aGe=null;a.P9(Object(m.a)(this,this.g9l,"longTaskListener"));this.HN=c}get fXn(){null==this.aGe&&(this.aGe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.vb("WordHangDetectionHangThresholdTime",2E3):2E3);return this.aGe}g9l(a){if(a){var c=[];for(let h of a.getEntries())h.duration>=this.fXn&&(a=new kw,a.ST=h.startTime,a.D=Math.round(h.duration),c.push(a));if(0<c.length){let h;
(h=this.HN).Qg.apply(h,[1,3].concat(c))}}}}Object(w.a)(QD,"HangDetector",null,[]);class Oj{constructor(){this.fAg=null;this.zL=[];this.lPb=0}P9(a){this.lPb||this.kjm();1===this.lPb&&this.zL.push(a)}f9l(){return!!window.PerformanceObserver&&!!window.PerformanceLongTaskTiming&&!!PerformanceObserver.supportedEntryTypes&&-1!==Array.indexOf(PerformanceObserver.supportedEntryTypes,"longtask")}LEl(a){for(let c of this.zL)c(a)}kjm(){if(!this.lPb)if(this.f9l())try{this.fAg=new PerformanceObserver(Object(m.a)(this,
this.LEl,"internalListener")),this.fAg.observe({type:"longtask"}),this.lPb=1}catch(a){this.lPb=2,r.ULS.sendTraceTag(592479427,3008,10,"Failed to create PerformanceObserver with message {0}",a.message)}else this.lPb=2}}Object(w.a)(Oj,"LongTaskListeners",null,[324]);class LC extends St.a{constructor(){super();this.LocalCobaltClusterId=this.LocalCobaltMachineId=this.LocalCobaltSessionId=this.sessionID=this.sessionStartInfoSettings=this.appSettings=null;this.LocalCobaltSessionHasBackup=!1;this.SettingsRoutedToServer=
this.WaciiEnabledRequests=0;this.WacClusterId=null}}Object(w.a)(LC,"SettingsMessage",St.a,[]);class vu{constructor(a){this.UH=a}}Object(w.a)(vu,"WebWorkerApiMain",null,[]);class RD extends vu{constructor(a){super(a)}Ymf(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsWorkerUtilsEnabled",!1)}$Ub(a,c){if(!c)return r.ULS.sendTraceTag(591972375,3007,10,"InitializeWorkerApiMain: InitializeSettings called with a null methodParams value."),
!1;if(1===a)return this.s0j(c);r.ULS.sendTraceTag(591972376,3007,10,"InitializeWorkerApiMain: Unknown method called.  MethodId: {0}",a);return!1}y5b(a,c){switch(a){case 14:this.Lpl(c);break;default:r.ULS.sendTraceTag(591972377,3007,10,"InitializeWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",a)}}s0j(a){if(2!==a.length)return r.ULS.sendTraceTag(591972378,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters.  Param Count: {0}",a.length),
!1;if("object"!==typeof a[0]||"object"!==typeof a[1])return r.ULS.sendTraceTag(587343010,3007,10,"InitializeWorkerApiMain: InitializeSettings called with incorrect parameters. Param[0] is Dictionary: {0}, Param[1] is Dictionary: {1}","object"===typeof a[0],"object"===typeof a[1]),!1;a=Object.assign(new LC,{api:0,method:1,appSettings:a[0],sessionStartInfoSettings:a[1],sessionID:l.AFrameworkApplication.userSessionId,LocalCobaltSessionId:Um.a.instance.QO,LocalCobaltMachineId:Um.a.instance.xBb,LocalCobaltClusterId:Um.a.instance.Q4b,
LocalCobaltSessionHasBackup:Um.a.instance.Bra,WaciiEnabledRequests:Um.a.instance.ama,SettingsRoutedToServer:Um.a.instance.ARf,WacClusterId:l.AFrameworkApplication.fe.R1});this.UH.postMessage(a);return!0}Lpl(a){this.Ymf()&&a&&a.result&&(r.ULS.sendTraceTag(555877916,3007,15,"Receive initialize finished message"),this.ZSn())}ZSn(){Object(ew.__awaiter)(this,void 0,void 0,function*(){try{const a=yield new wz.a.Y5i.WorkerUtilsTestClass(10);yield a.wg(5);15==(yield a.counter)?r.ULS.sendTraceTag(555877917,
3007,50,"WorkerUtils testing successfully"):r.ULS.sendTraceTag(555877918,3007,15,"WorkerUtils testing failed")}catch(a){r.ULS.sendTraceTag(555877919,3007,10,"WorkerUtils failed with exception: {0}",a.message)}})}}Object(w.a)(RD,"InitializeWorkerApiMain",vu,[]);class SD extends St.a{constructor(){super();this.mockDataEnabled=!1;this.requestEndpoint=this.rootQuerySignature=null;this.appMode=0;this.activityFeedIsEnabled=!1;this.api=2;this.method=4}}Object(w.a)(SD,"CatchUpNetworkRequestWorkerRequestMessage",
St.a,[]);class TD extends vu{constructor(a,c){super(a);this.Uvc=c}$Ub(a,c){if(4===a)return a=Object.assign(new SD,{rootQuerySignature:c[0],requestEndpoint:c[1],appMode:c[2],activityFeedIsEnabled:c[3]}),this.UH.postMessage(a),!0;r.ULS.sendTraceTag(592189584,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unknown method called.  MethodId: {0}",a);return!1}y5b(a,c){switch(a){case 5:r.ULS.sendTraceTag(592189585,3012,50,"CatchUpNetworkRequestWorkerExternalApi: Message received for method: {0}",a);this.Uvc.icn(c);
break;default:r.ULS.sendTraceTag(592189586,3012,10,"CatchUpNetworkRequestWorkerExternalApi: Unsupported Method sent to the Api.  MethodId: {0}",a)}}}Object(w.a)(TD,"CatchUpNetworkRequestWorkerExternalApi",vu,[]);class UD extends St.a{constructor(){super();this.taskInfo=null}}Object(w.a)(UD,"HangDetectionMessage",St.a,[]);class VD extends St.a{constructor(){super();this.taskInfo=null}}Object(w.a)(VD,"ReportLongTasksMessage",St.a,[]);class fC extends vu{constructor(a){super(a)}$Ub(a,c){if(!c)return r.ULS.sendTraceTag(591972370,
3008,10,"HangDetectionWorkerApiMain: HangDetection called with a null methodParams value."),!1;switch(a){case 2:return this.r0j(c);case 3:return this.C0m(c);default:return r.ULS.sendTraceTag(591972371,3008,10,"HangDetectionWorkerApiMain: Unknown method called.  MethodId: {0}",a),!1}}y5b(a){r.ULS.sendTraceTag(591972372,3007,10,"HangDetectionWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",a)}r0j(a){if(1!==a.length||"object"!==typeof a[0])return r.ULS.sendTraceTag(591972373,
3008,10,"HangDetectionWorkerApiMain: HangDetection called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===typeof a[0]),!1;a=Object.assign(new UD,{api:1,method:2,taskInfo:a[0]});this.UH.postMessage(a);return!0}C0m(a){if(!a.length||!Object(Ub.a)(kw,a[0]))return r.ULS.sendTraceTag(591972374,3008,10,"HangDetectionWorkerApiMain: ReportLongTasks called with incorrect parameters. Params length is {0}, Param[0] is LongTaskInfo is {1}",a.length,0<a.length?Object(Ub.a)(kw,
a[0]):!1),!1;a=Object.assign(new VD,{api:1,method:3,taskInfo:a});this.UH.postMessage(a);return!0}}Object(w.a)(fC,"HangDetectionWorkerApiMain",vu,[]);class Kx extends St.a{constructor(){super();this.context=this.textPredictionConfig=this.prediction=this.paragraphContent=null}}Object(w.a)(Kx,"LocalInferenceMessage",St.a,[]);class WD{constructor(){this.prediction=this.context=null}}Object(w.a)(WD,"LocalInferenceOutput",null,[]);class MC{constructor(){this.modelFilesUrl=this.settings=this.scriptDirectory=
null}}Object(w.a)(MC,"TextPredictionConfig",null,[]);class NC{constructor(){this.extendedRankLimit=0;this.dynamicTemporaryInDocModelNGramToken=3}}Object(w.a)(NC,"TextPredictionSettings",null,[]);class sA{constructor(){this.nGramOrder=0;this.modelFilesUrl=null}}Object(w.a)(sA,"TextPredictionDynamicPayload",null,[]);class ap extends vu{constructor(a,c){super(a);this.iAj=c}$Ub(a,c){if(!c)return r.ULS.sendTraceTag(575959325,3008,10,"LocalInferenceWorkerApiMain: LocalInference called with a null methodParams value."),
!1;switch(a){case 8:return this.y0j(c);case 7:return this.t0j(c);case 9:return this.x0j(c);case 10:return this.u0j(c);case 13:return this.v0j(c);case 14:return this.w0j(c);default:return r.ULS.sendTraceTag(575959326,3008,10,"LocalInferenceWorkerApiMain: Unknown method called.  MethodId: {0}",a),!1}}y5b(a,c){switch(a){case 9:this.Iql(c);break;default:r.ULS.sendTraceTag(575959822,3007,10,"LocalInferenceWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",a)}}Iql(a){a&&a.prediction&&
(a=Object.assign(new WD,{prediction:a.prediction,context:a.context}),this.iAj.gVg().eGm(a))}t0j(a){if(1>a.length)return r.ULS.sendTraceTag(575959823,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceAddContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===typeof a[0]),!1;a=a[0];a=Object.assign(new Kx,{api:4,method:7,paragraphContent:a,textPredictionConfig:this.getConfig()});this.UH.postMessage(a);return!0}y0j(a){if(1>a.length)return r.ULS.sendTraceTag(575959824,
3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceRemoveContext called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===typeof a[0]),!1;a=a[0];a=Object.assign(new Kx,{api:4,method:8,paragraphContent:a});this.UH.postMessage(a);return!0}x0j(a){if(2>a.length)return r.ULS.sendTraceTag(575959825,3008,10,"LocalInferenceWorkerApiMain: callLocalInferencePredict called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===
typeof a[0]),!1;var c=a[0];a=a[1];c=Object.assign(new Kx,{api:4,method:9,paragraphContent:a,context:c});this.UH.postMessage(c);return!0}u0j(a){if(1>a.length)return r.ULS.sendTraceTag(570782293,3008,10,"LocalInferenceWorkerApiMain: callLocalInferenceInit called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===typeof a[0]),!1;a=a[0];a=Object.assign(new Kx,{api:4,method:10,textPredictionConfig:this.getConfig(a)});this.UH.postMessage(a);return!0}v0j(a){if(1>a.length)return r.ULS.sendTraceTag(556827920,
3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,"object"===typeof a[0]),!1;a=a[0];a=Object.assign(new Kx,{api:4,method:13,textPredictionConfig:this.Wth(a)});this.UH.postMessage(a);return!0}w0j(a){if(1>a.length)return r.ULS.sendTraceTag(541733787,3008,10,"LocalInferenceWorkerApiMain: LocalInferenceWorker called with incorrect parameters. Param Count: {0}, Param is Dictionary: {1}",a.length,Object(Ub.a)(Object,
a[0])),!1;a=a[0];a=Object.assign(new Kx,{api:4,method:14,textPredictionConfig:this.Wth(a)});this.UH.postMessage(a);return!0}getConfig(a=null){return Object.assign(new MC,{scriptDirectory:l.AFrameworkApplication.LV+"/intelligence/",settings:Object.assign(new NC,{extendedRankLimit:0}),modelFilesUrl:a})}Wth(a=null){return Object.assign(new MC,{scriptDirectory:l.AFrameworkApplication.LV+"/intelligence/",settings:Object.assign(new NC,{dynamicTemporaryInDocModelNGramToken:a.nGramOrder}),modelFilesUrl:a.modelFilesUrl})}}
Object(w.a)(ap,"LocalInferenceWorkerApiMain",vu,[]);class OC extends vu{constructor(a){super(a);l.AFrameworkApplication.UK(()=>{this.mOc()})}$Ub(a){r.ULS.sendTraceTag(591689869,3008,10,"ShutdownWorkerApiMain: CallMethod not supported on this API.  MethodId: {0}",a);return!1}y5b(a){r.ULS.sendTraceTag(591689870,3007,10,"ShutdownWorkerApiMain: MethodCallReceived is not supported on this API.  MethodId: {0}",a)}mOc(){const a=Object.assign(new St.a,{api:3,method:6});this.UH.postMessage(a)}}Object(w.a)(OC,
"ShutdownWorkerApiMain",vu,[]);var SE=b(779),XD=b(562);class YD extends St.a{constructor(){super();this.args=null;this.numLogs=0}}Object(w.a)(YD,"UlsWorkerMessage",St.a,[]);var My=b(773),nq=b(886),PC=b(936);class QC extends nq.a{constructor(a,c,h,v,B){super(a,c,h,v,B);this.Ase=null;this.AAe=!1;if(this.brg=this.zmf())if(a=v.Ga("ContentBaseUrl")?6:5,v=v.Ga("AppScriptBaseName"))v=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerScriptName",v+".{0}ulsworker.js"),
v=eC.a.cbb(v),v=l.AFrameworkApplication.vx(v,a),My.createWorker({createMode:"Thread"},{local:My.paramInsideDef(PC.ulsWorkerInsideInit),aDn:My.paramInsideDef(Object(PC.ulsWorkerInsideScript)(v))}).then(X=>{X.onClose=()=>{this.FEe=void 0};this.FEe=X},X=>{var ma=new Date;X=`UlsWorkerDefererHost threw an error: ${this.Bdm(X)}`;console.error(X);ma=new XD.a(ma.getTime(),3007,545653664,10,X,0,!1,null,null);super.RU(ma);this.AAe=!0})}zmf(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",
!1)}get Kdm(){this.Ase||(this.Ase=xa.a.instance.resolve("Box4.Workers.IWebWorkerRouter"));return this.Ase}sIa(a){this.AAe=a}RU(a){if(this.AAe)super.RU(a);else if(this.brg)null!=this.FEe&&this.FEe.call.RU(a);else{let c;(c=this.Kdm).Qg.apply(c,[5,11].concat([a]))}}Bdm(a){if(null==a||"object"!==typeof a)return"unknown";const c=String(a.name),h=String(a.message);return null!=a.stack?(a=String(a.stack),0<=a.indexOf(h)&&0<=a.indexOf(c)?a:`${c}: ${h}\n${a}`):0<=h.indexOf(c)?h:`${c}: ${h}`}}Object(w.a)(QC,
"UlsWorkerDefererHost",nq.a,[]);class ZD extends vu{constructor(a){super(a);this.Cwg=0;a=xa.a.instance.ra("Common.IRefreshableAppSettings");this.qSb=new QC(SE.a.Qsd,!0,l.AFrameworkApplication.fe,null!==a&&void 0!==a?a:l.AFrameworkApplication.K,a);a=r.ULS.host;null!=a&&a.m0b(this.qSb);r.ULS.phb(this.qSb);this.Mrg=Ve.a.ie();this.hwj=2*l.AFrameworkApplication.K.vb("UlsWorkerStayAliveIntervalMS",6E4);this.qSb.sIa(!0)}$Ub(a,c){if(11!==a||!c||1!==c.length||!Object(Ub.a)(XD.a,c[0]))return!1;if(Ve.a.ie()-
this.Mrg>this.hwj)return this.qSb.sIa(!0),this.qSb.RU(c[0]),r.ULS.sendTraceTag(570770058,3008,15,"UlsWorkerApiMain: Haven't heard from UlsWorkerApi recently"),!1;a=Object.assign(new YD,{api:5,method:a,args:c[0],numLogs:this.Cwg});this.Cwg++;this.UH.postMessage(a);return!0}y5b(a,c){void 0!==c&&null!==c&&12===a&&(this.Mrg=Ve.a.ie(),this.qSb.sIa(!1))}}Object(w.a)(ZD,"UlsWorkerApiMain",vu,[]);class $D{constructor(a){this.container=a}Zfk(a,c){var h=null;switch(c){case 0:h=new RD(a);break;case 1:h=new fC(a);
break;case 2:h=new TD(a,this.container.resolve("WordEditor.CatchUpActivity.Worker.CatchUpNetworkRequestWorkerCache"));break;case 3:h=new OC(a);break;case 4:h=new ap(a,this.container.resolve("Box4.WordPrediction.IWordPredictionAugLoop"));break;case 5:c=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsWorkerIsEnabled",!1);h=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",!1);h=(c||h)&&l.AFrameworkApplication.Cnd?new ZD(a):
null;break;default:r.ULS.sendTraceTag(50442782,3008,10,"WordWebWorkerApiFactory: CreateApi was passed an unsupported ApiId. ApiId: {0}",c)}return h}}Object(w.a)($D,"WordWebWorkerApiFactory",null,[323]);var tA=b(245);class Lx{constructor(a,c){this.name=a;this.format=c}}Object(w.a)(Lx,"ImportedScript",null,[]);class zz{constructor(){this.N3d=this.pHb=this.Mxi=null}}Object(w.a)(zz,"WebWorkerConfig",null,[]);var xt=b(952);class RC{constructor(a){this.rCe=[];this.Bjj=a;if(l.AFrameworkApplication.K){var c=
l.AFrameworkApplication.K.$("AppChromeOverrideIsCombinedBundle");a=l.AFrameworkApplication.K.Ga("ContentBaseUrl")?6:5;const h=l.AFrameworkApplication.K.Ga("AppScriptBaseName");if(h){c=c?"":"{0}";const v=h+`.${c}worker.js`;this.rCe.push(new Lx(`MicrosoftAjaxDS.${c}js`,a),new Lx(v,a));this.zmf()&&this.rCe.push(new Lx(h+`.${c}ulsworker.js`,a))}else r.ULS.sendTraceTag(558465106,3008,10,"WordWebWorkerConfigFactory: Failed to get AppScriptBaseName. Worker JS is not loaded")}else r.ULS.sendTraceTag(558465107,
3008,10,"WordWebWorkerConfigFactory: AFrameworkApplication.appSettingsManager do not exist. Worker JS is not loaded")}create(){const a=[],c=Object.assign(new zz,{Mxi:"workerboot",pHb:this.rCe,N3d:[0,1,2,3,4,5]});this.Bjj&&this.ZJl()&&Array.add(c.pHb,new Lx("intelligence/edge-inference-web.js",5));a.push(c);return a}ZJl(){return(new tA.a("arrowFunction",()=>{try{Object(xt.a)("const sum = (a, b) => a + b")}catch(a){return!1}return!0},!1)).isSupported()}zmf(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.UlsTypedWorkerIsEnabled",
!1)}}Object(w.a)(RC,"WordWebWorkerConfigFactory",null,[322]);class jr{constructor(){this.qa=this.W=null}get name(){return"WordEditor.Workers"}init(){const a=this.W.resolve("Box4.Workers.IWebWorkerRouter");a.Qg.apply(a,[0,1].concat([this.qa.appSettings,l.AFrameworkApplication.sessionStartInfoSettings]))}dispose(){}yb(a){this.W=a;this.qa=this.W.resolve("Common.IAppSettingsManager");const c=this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextPredictionEdge",!1);a.ha("Box4.Workers.WebWorkerRouter",
()=>new yz(new RC(c),new $D(a))).as("Box4.Workers.IWebWorkerRouter").singleInstance();a.ha("WordEditor.Workers.LongTaskListeners",()=>new Oj).as("WordEditor.Workers.ILongTaskListeners").singleInstance();a.ha("WordEditor.Workers.HangDetector",()=>new QD(a.resolve("WordEditor.Workers.ILongTaskListeners"),a.resolve("Box4.Workers.IWebWorkerRouter"))).singleInstance()}static main(){M.a.instance.Lb(new jr)}}Object(w.a)(jr,"WordEditorWorkersPackage",null,[1,2]);class Az{constructor(){this.Med=[]}OBh(a,c){let h=
-1,v=null;v=B=>{B?c(this.Med[h]):(++h,h<this.Med.length?this.Med[h].dVb(a,v):c(null))};v(!1)}dVb(a,c){this.OBh(a,h=>{c(!!h)})}n9b(a,c,h){this.OBh(a,v=>{if(!v)throw Error.invalidOperation("ResolveUrl called without checking CanResolveUrl");v.n9b(a,c,h)})}COg(a){this.Med.push(a)}}Object(w.a)(Az,"CompositeExternalContentURLResolver",null,[517,227]);var oB=b(1254);class Mx extends oB.a{constructor(){super();this.Thumbnail=this.Author=this.Title=this.MediaType=null;this.Height=this.Width=0;this.IFrameHtml=
null}}Object(w.a)(Mx,"ExternalContentEmbedResponse",oB.a,[]);var SC=b(1271),Nx=b(1669),TC=b(1668),wu=b(1180),uA=b(647),rs=b(669),xu=b(197),vA=b(774),so;(function(a){a[a.autoCorrect=0]="autoCorrect";a[a.externalComponentPaste=1]="externalComponentPaste";a[a.externalHyperlinkPaste=2]="externalHyperlinkPaste";a[a.G6n=3]="externalContentFloatieConversion"})(so||(so={}));Object(w.b)("ExternalContentConversionContext",so);class Gg{constructor(){this.eBb=this.dBb=null;this.e1e=new wu.ExternalContentEmbedRetriever;
this.grc=!0;this.Ric=this.xm=this.bLh=this.aLh=this.Sk=this.Vn=null;null!=Gg.pia&&Gg.pia.Qsh()}get tGb(){return this.grc}set tGb(a){this.grc=a}sOe(a,c){let h=!1;if(a){switch(a.contextId){case ic.a.Ub:h=!c;break;case ic.a.xc:h=!0}h&&!vA.a(a.node)&&(h=!1)}return h}$Ul(a){const c=a.startsWith(ch.HyperlinkReader.f8b),h=a.startsWith(ch.HyperlinkReader.IQc),v=a.startsWith(ch.HyperlinkReader.AVd);return(c||h||v)&&ch.HyperlinkReader.CKa(a)}Kmi(){this.xm=N.a.create();Gg.he.fub(this.xm,4);Gg.he.i1(this.xm,
0,Gg.he.Nm());this.fzb(this.dBb,3,this.eBb,!0)}KJa(a,c,h){this.xm=N.a.create();Gg.he.fub(this.xm,h?0:2);Gg.he.i1(this.xm,0,Gg.he.Nm());this.Ric();this.fzb(a,h?0:2,c)}UTd(a,c){this.xm=N.a.create();Gg.he.fub(this.xm,1);Gg.he.i1(this.xm,0,Gg.he.Nm());this.fzb(a,1,c)}GGd(a,c,h){if(!a||!a.isConnected||!dd.ImageReader.ix(a))return null;const v=new uA.a;v.setValue(zi.a.eza,h);v.setValue(zi.a.fza,c);v.RTa=this.aLh;v.$u=this.bLh;v.dYa=1===h;Kd.GraphIterator.va(a).Je(v,2);this.GMc(v);return v}Doi(a){this.Ric=
a}n$d(a,c){c=Gg.pNa.Zub(c)||0;const h=a.Width/a.Height;1<=h?(a.Width=c,a.Height=c/h):(a.Height=600,a.Width=600/h)}P4f(a,c,h){if(null!=a&&null!=c&&!F.a.ve(h)){var v=Gg.WNc.n_b(h);v.eCa=!0;v.hideFloatie=!0;this.n$d(a,c.node);this.t1b(a,c,!1,!1,v,h)}}bbb(a){return a?a.we:0}H1f(a,c,h,v){v=null;const B=a.node;if(!sd.ParagraphReader.tb(B)||!B.isConnected)return{returnValue:!1,Xla:v};if(h)return{returnValue:!0,Xla:a};h=a.cpBegin;const X=a.cpEnd,ma=sd.ParagraphReader.text(B);if(0<=h&&X<=ma.length&&ma.substring(h,
X)===c)return{returnValue:!0,Xla:a};const Pa=ma.indexOf(c);return 0<=Pa?(v=Oe.a.createTextRange(B,Pa,Pa+c.length),{returnValue:!0,Xla:v}):0<=h&&X<=ma.length&&this.y0b(a)?{returnValue:!0,Xla:a}:{returnValue:!1,Xla:v}}y0b(a){if(!a||a.cpBegin>=a.cpEnd)return!1;var c=Oe.a.createTextRange(a.node,a.cpBegin,a.cpEnd);c=ch.HyperlinkReader.aB(c,!1);if(1===c.length){c=c[0];const h=sd.ParagraphReader.text(a.node).substring(c.cpBegin,c.cpEnd).trim();if(a.cpEnd===c.cpEnd&&c.hyperlink.url!==h)return!0}return!1}Mmf(a){return null==
a.width&&null==a.height||null!=a.width&&null!=a.height&&0<a.width&&0<a.height?!0:!1}tta(a,c){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$(c)&&window.setTimeout(()=>{const h=xa.a.instance.za("Common.ISystemInitiatedFeedback");h&&h.execute(v=>{v.logActivity(a,c)})},Gg.Dxa)}q7e(a,c){const h=!F.a.aX(c);switch(a){case 1:a=h?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,c):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;
break;default:a=h?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,c):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return a}fzb(a,c,h,v=!1){if(this.$Ul(h)){var B=Gg.WNc.n_b(h);if(B)if(this.Mmf(B)){r.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent");a=Object(ha.a)(Oe.a,a);var X=!c;this.sOe(a,X)?this.XIc(h)?(c=1===c,v=this.S0k(a),B.hideFloatie=!0,this.t1b(v,
a,X,c,B,h)):this.FEf(a,c,B,h,v):Gg.he.iO(this.xm,2,"URL inserted in Non-Embedable context",Gg.he.Nm())}else r.ULS.sendTraceTag(577521882,324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),Gg.he.iO(this.xm,2,"Size provided is not valid for OEmbed",Gg.he.Nm())}else r.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Gg.he.iO(this.xm,2,"URL inserted is not valid for ExternalContent",Gg.he.Nm())}S0k(a){let c=new Mx;c.Width=Gg.pNa.Zub(a.node)||
0;c.Height=600;c.Title="Fluid Component";c.MediaType="fluid";return c}XIc(a){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=Gg.O0&&Gg.O0.YWh(a)}FEf(a,c,h,v,B){const X=!c,ma=1===c,Pa=Gg.pNa.Zub(a.node)||0,mb=SC.a.SRe(h.X0f,!0,Pa,600);this.oMc(a,v,c,!0);this.e1e.X0g(mb,Tb=>{Gg.he.i1(this.xm,4,Gg.he.Nm());Gg.he.iVc(this.xm,this.bbb(Tb.data));if(Tb=this.MEf(Tb)){r.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");
var rc=xu.m(Tb.MediaType);Gg.he.pXd(this.xm,7,rc);rc=a;({Xla:rc}=this.H1f(a,v,ma,rc)).returnValue?(this.oMc(rc,v,c,!1),null==h.width?0<Pa&&Tb.Width>Pa&&(r.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Tb.Width=Pa):(r.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Tb.Width=this.v_c(h.width,Tb.Width,Pa)),null==h.height?600<Tb.Height&&(r.ULS.sendTraceTag(591681427,
324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),Tb.Height=600):(r.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Tb.Height=this.v_c(h.height,Tb.Height,600)),Gg.pia.f3a||B?this.t1b(Tb,rc,X,ma,h,v):(this.dBb=a,this.eBb=v,this.iyc(v))):(r.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),
Gg.he.iO(this.xm,2,"No conversion as the context is no longer valid for the external content conversion",Gg.he.Nm()));ma&&this.ETa(rc.node)}else ma&&this.ETa(a.node),Gg.he.iO(this.xm,1,"URL not oEmbedable",Gg.he.Nm())},Tb=>{Gg.he.i1(this.xm,4,Gg.he.Nm());Gg.he.iVc(this.xm,this.bbb(Tb.data));ma&&this.ETa(a.node);r.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Tb.data.qd);Gg.he.iO(this.xm,2,"ExternalContentEmbedRequest failed",Gg.he.Nm())},Tb=>{ma&&this.ETa(a.node);
r.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Tb)},this.xm)}v_c(a,c,h){!a&&0<h&&c>h||a>h?(r.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),c=h):a>h?c=h:a&&a<h&&(c=a);return c}t1b(a,c,h,v,B,X){this.Sk=Ya.a.create();a.Width=a.Width/a.Height*(a.Height-(rs.a.eFd+rs.a.pha))+2*rs.a.pha;const ma=new gf.GraphTransaction(15);ma.Oa(c.node);ma.ql=ba.a.KJa;const Pa=this.y0b(c);null!=B.eCa&&
!B.eCa||v||Pa||(a.Title=""===B.title||B.title?B.title:a.Title,!a.Title&&""!==a.Title)||(c=this.Hgf(c,ma,a.Title,X,h));if(c){v&&(c=this.WWe(c));var mb=this.Ird(c,v);if(mb){h=xu.m(a.MediaType);var Tb=this.DBd(a,h);this.aLh=a.IFrameHtml;this.bLh=a.Title;if(mb=this.mgf(mb,Tb,ma,v,X,h))ma.tAa(this.Sk,1),ma.dispose(),this.dBb=c,this.eBb=X,this.KBf(B,a,mb),this.pEf(X,v||B.hideFloatie,Pa,h,a.Title)}else ma.dispose(),r.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),
Gg.he.iO(this.xm,2,"Could not create IP context on splitting the paragraph",Gg.he.Nm())}else Gg.he.iO(this.xm,2,"GraphNodeContext is null",Gg.he.Nm())}DBd(a,c){const h=new uh.DictionaryPropertySet;Gg.gx.SUd(h,a.Width,a.Height);a=this.p7e(c,a.Title);h.setValue(Ed.a.imageAltText,a);h.setValue(Yb.a.DR,uf.a.nE());h.setValue(Yb.a.imageType,0);return h}mgf(a,c,h,v,B,X){if(!a)return null;a=Gg.gx.MGd(a,c);if(!a)return h.dispose(),r.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),
Gg.he.iO(this.xm,2,"The anchored image could not be inserted",Gg.he.Nm()),null;h=a.node;B=this.GGd(h,B,X);Gg.he.g0f(this.xm,B.id);v||this.BPf(h);return h}KBf(a,c,h){F.a.aX(a.thumbnailUrl)||(c.Thumbnail=a.thumbnailUrl);c.Thumbnail&&c.Thumbnail.length&&(Gg.he.i1(this.xm,8,Gg.he.Nm()),r.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.Xtd(h,c.Thumbnail))}pEf(a,c,h,v,B){c||this.iyc(a);this.tta("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");
this.YSd("IsHyperlinkWithNonURLDisplayText",h);this.eUb(v,B);Gg.he.i1(this.xm,5,Gg.he.Nm())}YSd(a,c){r.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");Z.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.ExternalContent.OEmbedInsertions",dataFields:[Object.assign(new aa.a,{name:a,bool:c})]}))}eUb(a,c){this.tGb&&Gg.Xu&&(a=this.q7e(a,c),Gg.Xu.sendNotification(a,!0))}Hgf(a,c,h,v,B){if(B){if((B=ch.HyperlinkReader.aB(a,!1))&&1!==B.length)return c.dispose(),
r.ULS.sendTraceTag(590455040,324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Gg.hyperlinkEditor.jP(B[0].paragraph,B[0].hyperlink)}return this.kLf(a,h,v)}WWe(a){const c=a.node,h=sd.ParagraphReader.text(c);return 0<h.length&&!h.trim().length?(a=Oe.a.createTextRange(c,0,h.length),Gg.characterPropertiesEditor.replaceTextRange(a,""),Oe.a.Sb(c,0)):a}Ird(a,c){return c?a:this.g8e(a)}g8e(a){const c=sd.ParagraphReader.text(a.node),h=Kd.GraphIterator.va(a.node);
if(h.nc()){a=Oe.a.Sb(a.node,a.cpEnd);ie.OutlineElementNavigator.Wc(h);const v=Gg.Wf.Mqa(h);Gg.Vd.o$(h,v,a,!0,!0,!0,!0);""!=c&&Gg.Vd.bA(h,!1,!0);h.Xc();return Oe.a.Sb(h.currentNode,0)}return null}MEf(a){let c;if(!({group:c}=Dm.a.D$(a.data.qd,c)).returnValue)return null;a=c.Responses[0];return a.StatusCode?null:a}kLf(a,c,h){const v=a.cpBegin+c.length;Gg.characterPropertiesEditor.replaceTextRange(a,c);a=Oe.a.createTextRange(a.node,a.cpBegin,v);Gg.hyperlinkEditor.BG(a,h,!1);return a}p7e(a,c){const h=
!F.a.aX(c);switch(a){case 1:return h?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,c):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return h?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,c):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}Xtd(a,c){a.Eh().contentReplicator.forceOutbound(()=>{this.KEf(c,a)},()=>{r.ULS.sendTraceTag(592996173,
324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}GMc(a){a=Kd.GraphIterator.va(a);a.La(12);a.mc(12);a.rm.WN=!0}ETa(a){a.A7b=null}BPf(a){a=Kd.GraphIterator.va(a);a.La(11)&&(a.mc(11),a.nc()&&a.ni()&&a.Xc()&&sd.ParagraphReader.tb(a.currentNode)&&(a=ne.SelectionFactory.vd(a.currentNode,0),$c.a.instance.setSelection(a)))}oMc(a,c,h,v){const B=a.cpBegin,X=a.cpEnd;a=sd.ParagraphReader.text(a.node).trim();B||a!==c&&""!==a?B?X===a.length?r.ULS.sendTraceTag(590958601,324,
50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",so[h],v):0<B&&X<a.length&&r.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",so[h],v):r.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
so[h],v):r.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",so[h],v)}iyc(a){this.rXb();const c=new y.a(1,l.AFrameworkApplication.isRtl);c.KPc=a;Gg.D$a.LRc(c)}rXb(){const a=new Pg.a(!0);Gg.UCf.qBa(a)}KEf(a,c){if(a=this.a$e(a,c))c=Array(1),c[0]=a,a=Nx.a.construct(c,!1,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Vn.fr:null),c=this.WUe(),
this.Qgb(c,a)}a$e(a,c){if(!c)return r.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Vn=c.Eh();(new Kd.GraphIterator).set(c);if(!c.anchor||!c.anchor.gr||!c.anchor.gr.Iq)return r.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var h=c.anchor.gr.Iq.node;if(!h)return r.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),
null;let v=Vm.a.vp;kg.a.instance.J(4)&&(v=h.ia(ii.a.JI,Vm.a.vp));h=c.getValue(Ed.a.LJ);const B=Be.a.Re(dd.ImageReader.LG(c.properties),0),X=Be.a.Re(dd.ImageReader.$J(c.properties),1);return TC.a.construct(c.id.toString(),a,c.ia(Ed.a.imageAltText,""),B,X,c.ia(Yb.a.BX,""),v,c.ia(Yb.a.DR,0),c.ia(Yb.a.Wca,!1),c.ia(ii.a.Yba,-1),c.ia(Yb.a.Pdb,Box4Intl.Box4Strings.l_Picture),c.ia(Ed.a.Zca,!1),h,c.ia(Yb.a.runId,1),c.ia(Yb.a.Ib,0))}Qgb(a,c){l.AFrameworkApplication.fe.ai(a,2,z.c(c),{},!1,2,Object(m.a)(this,
this.picturePasteRequestSucceeded,"picturePasteRequestSucceeded"),Object(m.a)(this,this.E7b,"picturePasteRequestFailed"),null,void 0,void 0,void 0,void 0,"26");r.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){r.ULS.sendTraceTag(592996169,324,100,"Picture paste request for External Content succeeded")}E7b(){r.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}WUe(){let a=Af.a.ayd("PicturePaste.ashx");
l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(a=Af.a.qm(a,of.a.fileId,this.Vn.fr));a=Af.a.qm(a,of.a.cellId,this.Vn.Nk.toString());this.Sk||(this.Sk=Ya.a.create(),r.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));a=Af.a.qm(a,of.a.S_,this.Sk.toString());a=Af.a.qm(a,of.a.classId,(393233).toString());this.Vn.FG&&(a=Af.a.qm(a,of.a.FG,this.Vn.FG));a=Af.a.qm(a,of.a.Bjb,"1");a=Af.a.qm(a,dh.a.imageType,
"0");a=Um.a.instance.gIe(a);this.Vn.contentReplicator&&this.Vn.contentReplicator.MAb&&(a=Af.a.qm(a,of.a.qMe,"1"));a=Af.a.qm(a,of.a.Soa,this.Vn.contentReplicator.Ss.toString());a=Af.a.qm(a,of.a.x7b,"0");return a=Af.a.qm(a,of.a.VIb,"1")}static get D$a(){return Gg.uW||(Gg.uW=xa.a.instance.resolve("Box4.IExternalContentFloatieEventSource"))}static get pia(){Gg.Cua||(Gg.Cua=xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Gg.Cua}static get UCf(){return Gg.pu||(Gg.pu=
xa.a.instance.resolve("Box4.IPasteFloatieEventSource"))}static get Xu(){return Gg.yj||(Gg.yj=xa.a.instance.resolve("Common.Utils.IAriaNotifier"))}static get pNa(){return Gg.nGa||(Gg.nGa=xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior"))}static get gx(){return Gg.Og||(Gg.Og=xa.a.instance.resolve("WordEditor.IImageEditor"))}static get Wf(){return Gg.Vd||(Gg.Vd=xa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hyperlinkEditor(){return Gg.Oi||(Gg.Oi=xa.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return Gg.Tb||
(Gg.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get he(){return Gg.cQ||(Gg.cQ=xa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler"))}static get WNc(){return Gg.Qnc||(Gg.Qnc=xa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}static get O0(){return Gg.Znb||(Gg.Znb=xa.a.instance.resolve("Fluid.Host.LoopComponentManager"))}}Gg.uW=null;Gg.yj=null;Gg.nGa=null;Gg.Og=null;Gg.Vd=null;Gg.Oi=null;Gg.Tb=null;Gg.cQ=null;Gg.Qnc=null;Gg.Dxa=5E3;Gg.pu=
null;Gg.Cua=null;Gg.Znb=null;Object(w.a)(Gg,"ExternalContentEditor",null,[216]);var Bz=b(283),Cz=b(1071);class wA{constructor(a,c){this.f3a=!0;this.fw=a;this.ZZ=c}Qsh(){const a=new oj.a;this.dWh()&&this.ZZ?this.ZZ.JEb(Bz.a.Pxc).CWRCo(Object(m.a)(this,this.$Cb,"onRegisterCallback"),0).CWRCo(Object(m.a)(this,this.gZa,"onGetRequestFinished"),8):a.Jf(this.f3a)}$Cb(a){if(null!=a.result)return a.result.Value;r.ULS.sendTraceTag(556376794,324,15,"onRegister get convertExternalContentIsEnabled settings options from Roaming Service failed.");
return this.f3a}gZa(a){a.Hn||a.Gh?r.ULS.sendTraceTag(559153884,324,15,"Load to get convertExternalContentIsEnabled settings options from Roaming Service failed."):(this.VYg(a.result),r.ULS.sendTraceTag(559437389,324,50,"Load to get convertExternalContentIsEnabled settings options from Roaming Service successfully"));return this.f3a}cfa(a){this.ZZ&&this.ZZ.cfa(Bz.a.Pxc,new Cz.a(Bz.a.Pxc,a))}a7m(a){this.dWh()&&(this.fw.Ysa("saveConvertExternalContentIsEnabled",a.toString()),r.ULS.sendTraceTag(559437386,
324,50,"Try to save convertExternalContentIsEnabled settings value to Roaming Service."),this.VYg(a),this.cfa(a))}dWh(){const a=l.AFrameworkApplication.K.$("IsAnonymousUser");if(l.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(a)r.ULS.sendTraceTag(559437387,324,50,"User is anonymous ");else return!0;return!1}VYg(a){this.f3a=a}}Object(w.a)(wA,"ExternalContentSettingInfo",null,[521]);class sf{constructor(a,c){sf.Kj=a;sf.RW=c}Zub(a){if(!a)return null;var c=sf.RW.WO(a);if(sf.Kj.Xmf(c)){a=sf.Kj.sM(c);
const h=sf.Kj.tM(c);c=sf.Kj.fv(c);if(a+h<=c)return Be.a.Vh(c-a-h,0)}return null}}sf.Kj=null;sf.RW=null;Object(w.a)(sf,"ExternalContentSizeBehavior",null,[520]);var UC=b(999);class Dz{constructor(){this.thumbnail=this.author=this.title=this.mediaType=this.url=null;this.height=this.width=0;this.type=null;this.showFloatie=!1}}Object(w.a)(Dz,"FluidComponentProperties",null,[]);class aE{constructor(){this.loopType=this.$u=this.RTa=this.url=null;this.mediaType=0;this.r2h=null}}Object(w.a)(aE,"IFrameProps",
null,[]);class Jl{static get pNa(){return Jl.nGa||(Jl.nGa=xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior"))}static get gx(){return Jl.Og||(Jl.Og=xa.a.instance.resolve("WordEditor.IImageEditor"))}static get Xu(){return Jl.yj||(Jl.yj=xa.a.instance.resolve("Common.Utils.IAriaNotifier"))}static get hyperlinkEditor(){return Jl.Oi||(Jl.Oi=xa.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Wf(){return Jl.Vd||(Jl.Vd=xa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get characterPropertiesEditor(){return Jl.Tb||
(Jl.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static CKa(a){const c=a.startsWith(ch.HyperlinkReader.f8b),h=a.startsWith(ch.HyperlinkReader.IQc),v=a.startsWith(ch.HyperlinkReader.AVd);return(c||h||v)&&ch.HyperlinkReader.CKa(a)}static sOe(a,c){let h=!1;if(a){switch(a.contextId){case ic.a.Ub:h=!c;break;case ic.a.xc:h=!0}h&&!vA.a(a.node)&&(h=!1)}return h}static y0b(a){if(!a||a.cpBegin>=a.cpEnd)return!1;var c=Oe.a.createTextRange(a.node,a.cpBegin,a.cpEnd);c=ch.HyperlinkReader.aB(c,!1);
if(1===c.length){c=c[0];const h=sd.ParagraphReader.text(a.node).substring(c.cpBegin,c.cpEnd).trim();if(a.cpEnd===c.cpEnd&&c.hyperlink.url!==h)return!0}return!1}static p7e(a,c){const h=!F.a.aX(c);switch(a){case 1:return h?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_VideoWithTitle,c):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_Video;default:return h?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContentWithTitle,
c):WordEditorIntl.WordEditorStrings.L_ExternalContentThumbnailAltText_WebContent}}static GMc(a){a=Kd.GraphIterator.va(a);a.La(12);a.mc(12);a.rm.WN=!0}static DBd(a,c,h,v){const B=new uh.DictionaryPropertySet;Jl.gx.SUd(B,c,a);a=Jl.p7e(v,h);B.setValue(Ed.a.imageAltText,a);B.setValue(Yb.a.DR,uf.a.nE());B.setValue(Yb.a.imageType,0);return B}static GGd(a,c){if(!a||!a.isConnected||!dd.ImageReader.ix(a))return null;const h=new uA.a;h.setValue(zi.a.eza,c.mediaType);h.setValue(zi.a.fza,c.url);h.setValue(Uc.a.loopComponentType,
c.loopType);h.RTa=c.RTa;h.$u=c.$u;h.dYa=1===c.mediaType;h.createMode=c.r2h;Kd.GraphIterator.va(a).Je(h,2);Jl.GMc(h);return h}static Ird(a,c){return c?a:Jl.g8e(a)}static g8e(a){const c=sd.ParagraphReader.text(a.node),h=Kd.GraphIterator.va(a.node);if(h.nc()){a=Oe.a.Sb(a.node,a.cpEnd);ie.OutlineElementNavigator.Wc(h);const v=Jl.Wf.Mqa(h);Jl.Wf.o$(h,v,a,!0,!0,!0,!0);""!=c&&Jl.Wf.bA(h,!1,!0);h.Xc();return Oe.a.Sb(h.currentNode,0)}return null}static BPf(a){a=Kd.GraphIterator.va(a);a.La(11)&&(a.mc(11),a.nc()&&
a.ni()&&a.Xc()&&sd.ParagraphReader.tb(a.currentNode)&&(a=ne.SelectionFactory.vd(a.currentNode,0),$c.a.instance.setSelection(a)))}static q7e(a,c){const h=!F.a.aX(c);switch(a){case 1:a=h?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideoWithTitle,c):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedVideo;break;default:a=h?String.format(WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContentWithTitle,
c):WordEditorIntl.WordEditorStrings.L_ExternalContentAriaNotifyMessage_InsertedWebContent}return a}static eUb(a,c){Jl.Xu&&(a=Jl.q7e(a,c),Jl.Xu.sendNotification(a,!0))}static YSd(a,c,h){r.ULS.sendTraceTag(591267585,324,50,"OtelLogging: ExternalContent transaction successfully completed");Z.a.sendTelemetryEvent(Object.assign(new ja.a,{name:h,dataFields:[Object.assign(new aa.a,{name:a,bool:c})]}))}}Object(w.a)(Jl,"ExternalContentHelper",null,[]);class Ox{constructor(){this.Sk=this.Vn=null}Xtd(a,c){a.Eh().contentReplicator.forceOutbound(()=>
{this.KEf(c,a)},()=>{r.ULS.sendTraceTag(592996173,324,15,"ForceOutbound for DoServerRequestToDownloadThumbnailImageBlob failed")},null)}KEf(a,c){if(a=this.a$e(a,c))c=Array(1),c[0]=a,a=Nx.a.construct(c,!1,l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")?this.Vn.fr:null),c=this.WUe(),this.Qgb(c,a)}a$e(a,c){if(!c)return r.ULS.sendTraceTag(592996172,324,10,"GetPastedPictureForPicturePasteRequest: image node cannot be null"),null;this.Vn=c.Eh();(new Kd.GraphIterator).set(c);
if(!c.anchor||!c.anchor.gr||!c.anchor.gr.Iq)return r.ULS.sendTraceTag(592996171,324,10,"GetPastedPictureForPicturePasteRequest: image node not properly connected to parent paragraph"),null;var h=c.anchor.gr.Iq.node;if(!h)return r.ULS.sendTraceTag(592996170,324,10,"GetPastedPictureForPicturePasteRequest: paragraph node cannot be null"),null;let v=Vm.a.vp;kg.a.instance.J(4)&&(v=h.ia(ii.a.JI,Vm.a.vp));h=c.getValue(Ed.a.LJ);const B=Be.a.Re(dd.ImageReader.LG(c.properties),0),X=Be.a.Re(dd.ImageReader.$J(c.properties),
1);return TC.a.construct(c.id.toString(),a,c.ia(Ed.a.imageAltText,""),B,X,c.ia(Yb.a.BX,""),v,c.ia(Yb.a.DR,0),c.ia(Yb.a.Wca,!1),c.ia(ii.a.Yba,-1),c.ia(Yb.a.Pdb,Box4Intl.Box4Strings.l_Picture),c.ia(Ed.a.Zca,!1),h,c.ia(Yb.a.runId,1),c.ia(Yb.a.Ib,0))}Qgb(a,c){l.AFrameworkApplication.fe.ai(a,2,z.c(c),{},!1,2,this.picturePasteRequestSucceeded.bind(this),this.E7b.bind(this),null,void 0,void 0,void 0,void 0,"26");r.ULS.sendTraceTag(590874565,324,50,"Picture paste request for External Content")}picturePasteRequestSucceeded(){r.ULS.sendTraceTag(592996169,
324,100,"Picture paste request for External Content succeeded")}E7b(){r.ULS.sendTraceTag(592996168,324,10,"Picture paste request for External Content failed.")}WUe(){let a=Af.a.ayd("PicturePaste.ashx");l.AFrameworkApplication.K&&!l.AFrameworkApplication.K.$("SendFileIdInPicturePasteRequestBodyIsEnabled")&&(a=Af.a.qm(a,of.a.fileId,this.Vn.fr));a=Af.a.qm(a,of.a.cellId,this.Vn.Nk.toString());this.Sk||(this.Sk=Ya.a.create(),r.ULS.sendTraceTag(591683677,324,15,"CreateUrlForPicturePaste: desiredRevisionId should not be null"));
a=Af.a.qm(a,of.a.S_,this.Sk.toString());a=Af.a.qm(a,of.a.classId,(393233).toString());this.Vn.FG&&(a=Af.a.qm(a,of.a.FG,this.Vn.FG));a=Af.a.qm(a,of.a.Bjb,"1");a=Af.a.qm(a,dh.a.imageType,"0");a=Um.a.instance.gIe(a);this.Vn.contentReplicator&&this.Vn.contentReplicator.MAb&&(a=Af.a.qm(a,of.a.qMe,"1"));a=Af.a.qm(a,of.a.Soa,this.Vn.contentReplicator.Ss.toString());a=Af.a.qm(a,of.a.x7b,"0");return a=Af.a.qm(a,of.a.VIb,"1")}}Object(w.a)(Ox,"ExternalContentThumbnailHelper",null,[]);class Av extends Ox{constructor(){super(...arguments);
this.xm=null}static get he(){return Av.cQ||(Av.cQ=xa.a.instance.resolve("Wonca.IExternalContentPerfMetricsHandler"))}$Xi(a,c,h){return Jl.CKa(c)?Jl.sOe(a,h)?!0:(Av.he.iO(this.xm,2,"URL inserted in Non-Embedable context",Av.he.Nm()),!1):(r.ULS.sendTraceTag(591267584,324,50,"insertExternalContentImpl: URL inserted is not valid for ExternalContent"),Av.he.iO(this.xm,2,"URL inserted is not valid for ExternalContent",Av.he.Nm()),!1)}}Av.cQ=null;Object(w.a)(Av,"AbstractExternalContentEditor",Ox,[216]);
class yt extends Av{static get O0(){return yt.Znb||(yt.Znb=xa.a.instance.resolve("Fluid.Host.LoopComponentManager"))}static get paragraphEditor(){return yt.kh||(yt.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}Vhk(a,c){c=this.ayh(a,c);this.vNh(c,a,5)}KJa(a,c,h){this.$Xi(a,c,h)&&(h=this.ayh(a,null),h.url=c,this.vNh(h,a,2))}UTd(a,c){this.KJa(a,c,!1)}vNh(a,c,h){this.Sk=Ya.a.create();const v=new gf.GraphTransaction(15);v.Oa(c.node);v.ql=ba.a.QCl;const B=Jl.y0b(c),X=xu.m(a.mediaType),ma=Jl.DBd(a.height,
a.width,a.title,X);c=this.cOn(c,1==h);(c=Jl.Og.MGd(c,ma))?(c=c.node,Jl.GGd(c,{url:a.url,mediaType:X,$u:a.title,loopType:a.type,r2h:h})||r.ULS.sendTraceTag(538817433,324,50,"insertFluidComponentCore: Iframe node is null"),v.tAa(this.Sk,1),v.dispose(),this.Xtd(c,a.thumbnail),this.SCm(B,X)):r.ULS.sendTraceTag(538817432,324,50,"insertFluidComponentCore: insertPictureResult is null")}cOn(a,c){Jl.characterPropertiesEditor.replaceTextRange(a,"");return Jl.Ird(a,c)}SCm(a,c){Jl.YSd("IsHyperlinkWithNonURLDisplayText",
a,"Office.Word.Online.ExternalContent.FluidComponent");Jl.eUb(c,"Fluid Component")}ayh(a,c){let h=new Dz;h.width=Jl.pNa.Zub(a.node)||0;h.height=null!=yt.O0&&yt.O0.AYk(c)+2*rs.a.pha||600;h.title="Fluid Component";h.mediaType="fluid";h.type=c;h.thumbnail=null!=yt.O0&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2202.14002/en-us_web/assets/fallback.jpg";h.url=null!=yt.O0&&"https://fa000000096.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2202.14002/en-us_web/assets/fallback.jpg";
return h}static XIc(a){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&null!=yt.O0&&yt.O0.YWh(a)}}Object(w.a)(yt,"FluidComponentEditor",Av,[]);class bE{constructor(){this.emb=this.Vlb=null}get VEk(){return this.Vlb||(this.Vlb=xa.a.instance.resolve("Wonca.ExternalContent.IExternalContentEditor"))}get lxd(){return this.emb||(this.emb=xa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor"))}PCm(a,c){a&&(yt.XIc(c)?this.lxd.KJa(a,
c,!0):this.VEk.KJa(a,c,!0))}}Object(w.a)(bE,"PostHyperlinkAutoCorrectStrategy",null,[519]);class xA{dVb(a,c){c(xA.WCm.test(a))}n9b(a,c){a.startsWith("https")||(a=a.replace("http","https"));a=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen='' sandbox='allow-scripts allow-same-origin'></iframe>",960,960,a);a=Object.assign(new Mx,{OperationId:0,StatusCode:0,MediaType:"rich",
Height:960,Width:960,Thumbnail:xA.thumbnailUrl,Title:"Power BI",IFrameHtml:a});c(a)}}xA.WCm=RegExp("^https?:\\/\\/(app|msit).powerbi.com\\/view\\?r=[^\\/]+$","i");xA.thumbnailUrl="https://www.onenote.com/Images/oembed_powerbi_defaultthumbnail.png";Object(w.a)(xA,"PowerBIURLResolver",null,[517,227]);class Ez{constructor(a){this.nKg=a}dVb(a,c){let h=!1;try{if(Ez.cTl(a)){const v=this.nKg.n_b(a);h=null!=v.width&&null!=v.height&&!!v.thumbnailUrl&&!!v.title&&null!=v.eCa}}catch(v){}c(h)}n9b(a,c){var h=this.nKg.n_b(a);
a=String.format("<iframe width='{0}' height='{1}' src='{2}' frameborder='0' style='border:none' allowfullscreen='true' allow='accelerometer; autoplay; battery; camera; clipboard-write; encrypted-media; fullscreen; gyroscope; picture-in-picture; sync-xhr; wake-lock; screen-wake-lock; web-share' sandbox='allow-downloads allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-scripts allow-same-origin'></iframe>",h.width,h.height,a);h=Object.assign(new Mx,{Height:h.height,IFrameHtml:a,
MediaType:"rich",OperationId:0,StatusCode:0,Thumbnail:h.thumbnailUrl,Title:h.title,Width:h.width});c(h)}static cTl(a){for(let c of Ez.$yn)if(a.startsWith(c))return!0;return!1}static Oba(){return new Ez(xa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}Ez.$yn=["https://wedge.wedge:9090/","https://wedgecomponents.azurewebsites.net/"];Object(w.a)(Ez,"WedgeComponentExperimentsURLResolver",null,[517,227]);var VC=b(831),cE=b(929);class WC{constructor(a,c){this.ga=a;this.emb=
c}eb(){this.ga.Aa(ba.a.BNh,ic.a.Ub,this.jDl.bind(this),1028);this.ga.Aa(ba.a.RGd,ic.a.Ub,this.qgf.bind(this),1028);this.ga.Aa(ba.a.yGd,ic.a.Ub,this.qgf.bind(this),1028);this.ga.Aa(ba.a.Bgf,ic.a.Ub,this.qgf.bind(this),1028);this.ga.Aa(ba.a.UZh,ic.a.Ub,this.p2i.bind(this),1028)}jDl(){return 32}qgf(a,c,h){if(!cE.a.pSh())return 2;if(1===h){if(!c.Kk||!Gc.SelectionEditor.ke(c))return 2;if(c&&c.node&&vA.a(c.node))return 32}else if(2===h)return this.emb.Vhk(c,WC.R0k(a)),32;return 2}p2i(a,c,h){2===h&&F.a.OX("https://go.microsoft.com/fwlink/?linkid=2194838")&&
Eb.App.yNf.Lcc("https://go.microsoft.com/fwlink/?linkid=2194838");return 32}static R0k(a){switch(a){case ba.a.RGd:return VC.a.TaskAssignment;case ba.a.yGd:return VC.a.CheckList;case ba.a.Bgf:return VC.a.Poll;default:return null}}}Object(w.a)(WC,"FluidComponentsActor",null,[]);class ej extends Av{constructor(){super();this.eBb=this.dBb=null;this.e1e=new wu.ExternalContentEmbedRetriever;this.Ric=null;null!=ej.pia&&ej.pia.Qsh()}Kmi(){this.xm=N.a.create();ej.he.fub(this.xm,4);ej.he.i1(this.xm,0,ej.he.Nm());
this.fzb(this.dBb,3,this.eBb,!0)}KJa(a,c,h){this.xm=N.a.create();ej.he.fub(this.xm,h?0:2);ej.he.i1(this.xm,0,ej.he.Nm());this.Ric();this.fzb(a,h?0:2,c)}UTd(a,c){this.xm=N.a.create();ej.he.fub(this.xm,1);ej.he.i1(this.xm,0,ej.he.Nm());this.fzb(a,1,c)}Doi(a){this.Ric=a}n$d(a,c){c=ej.pNa.Zub(c)||0;const h=a.Width/a.Height;1<=h?(a.Width=c,a.Height=c/h):(a.Height=600,a.Width=600/h)}P4f(a,c,h){if(null!=a&&null!=c&&!F.a.ve(h)){var v=ej.WNc.n_b(h);v.eCa=!0;v.hideFloatie=!0;this.n$d(a,c.node);this.t1b(a,c,
!1,!1,v,h)}}bbb(a){return a?a.we:0}H1f(a,c,h,v){v=null;const B=a.node;if(!sd.ParagraphReader.tb(B)||!B.isConnected)return{returnValue:!1,Xla:v};if(h)return{returnValue:!0,Xla:a};h=a.cpBegin;const X=a.cpEnd,ma=sd.ParagraphReader.text(B);if(0<=h&&X<=ma.length&&ma.substring(h,X)===c)return{returnValue:!0,Xla:a};const Pa=ma.indexOf(c);return 0<=Pa?(v=Oe.a.createTextRange(B,Pa,Pa+c.length),{returnValue:!0,Xla:v}):0<=h&&X<=ma.length&&Jl.y0b(a)?{returnValue:!0,Xla:a}:{returnValue:!1,Xla:v}}Mmf(a){return null==
a.width&&null==a.height||null!=a.width&&null!=a.height&&0<a.width&&0<a.height?!0:!1}tta(a,c){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$(c)&&window.setTimeout(()=>{const h=xa.a.instance.za("Common.ISystemInitiatedFeedback");h&&h.execute(v=>{v.logActivity(a,c)})},ej.Dxa)}fzb(a,c,h,v=!1){if(this.$Xi(a,h,!c)){var B=ej.WNc.n_b(h);B&&(this.Mmf(B)?(r.ULS.sendTraceTag(591681428,324,50,"insertExternalContentImpl: URL Processed by ExternalContent"),this.FEf(a,c,B,h,v)):(r.ULS.sendTraceTag(577521882,
324,50,"insertExternalContentImpl: Size is not valid for OEmbed"),ej.he.iO(this.xm,2,"Size provided is not valid for OEmbed",ej.he.Nm())))}}FEf(a,c,h,v,B){const X=!c,ma=1===c,Pa=ej.pNa.Zub(a.node)||0,mb=SC.a.SRe(h.X0f,!0,Pa,600);this.oMc(a,v,c,!0);this.e1e.X0g(mb,Tb=>{ej.he.i1(this.xm,4,ej.he.Nm());ej.he.iVc(this.xm,this.bbb(Tb.data));if(Tb=this.MEf(Tb)){r.ULS.sendTraceTag(592307859,324,50,"PrepareAndQueueRequest: received a successful ExternalContent response for the url pasted");var rc=xu.m(Tb.MediaType);
ej.he.pXd(this.xm,7,rc);rc=a;({Xla:rc}=this.H1f(a,v,ma,rc)).returnValue?(this.oMc(rc,v,c,!1),null==h.width?0<Pa&&Tb.Width>Pa&&(r.ULS.sendTraceTag(591681426,324,50,"PrepareAndQueueRequest: received Width of ExternalContent more than the maxWidth in response"),Tb.Width=Pa):(r.ULS.sendTraceTag(572618198,324,50,"PrepareAndQueueRequest: Width of ExternalContent is provided for override"),Tb.Width=this.v_c(h.width,Tb.Width,Pa)),null==h.height?600<Tb.Height&&(r.ULS.sendTraceTag(591681427,324,50,"PrepareAndQueueRequest: received height of ExternalContent more than the maxHeight in response"),
Tb.Height=600):(r.ULS.sendTraceTag(572618199,324,50,"PrepareAndQueueRequest: Height of ExternalContent is provided for override"),Tb.Height=this.v_c(h.height,Tb.Height,600)),ej.pia.f3a||B?this.t1b(Tb,rc,X,ma,h,v):(this.dBb=a,this.eBb=v,this.iyc(v))):(r.ULS.sendTraceTag(590955994,324,50,"PrepareAndQueueRequest: No conversion as the context is no longer valid for the external content conversion."),ej.he.iO(this.xm,2,"No conversion as the context is no longer valid for the external content conversion",
ej.he.Nm()));ma&&this.ETa(rc.node)}else ma&&this.ETa(a.node),ej.he.iO(this.xm,1,"URL not oEmbedable",ej.he.Nm())},Tb=>{ej.he.i1(this.xm,4,ej.he.Nm());ej.he.iVc(this.xm,this.bbb(Tb.data));ma&&this.ETa(a.node);r.ULS.sendTraceTag(588834834,324,50,"Request failed in in InsertExternalContentImpl: "+Tb.data.qd);ej.he.iO(this.xm,2,"ExternalContentEmbedRequest failed",ej.he.Nm())},Tb=>{ma&&this.ETa(a.node);r.ULS.sendTraceTag(588834835,324,50,"Request not allowed in InsertExternalContentImpl: "+Tb)},this.xm)}v_c(a,
c,h){!a&&0<h&&c>h||a>h?(r.ULS.sendTraceTag(577521885,324,50,"ValidateAndFinalizeDimension: received Param of ExternalContent more than the maxParam"),c=h):a>h?c=h:a&&a<h&&(c=a);return c}t1b(a,c,h,v,B,X){this.Sk=Ya.a.create();a.Width=a.Width/a.Height*(a.Height-(rs.a.eFd+rs.a.pha))+2*rs.a.pha;const ma=new gf.GraphTransaction(15);ma.Oa(c.node);ma.ql=ba.a.KJa;const Pa=Jl.y0b(c);null!=B.eCa&&!B.eCa||v||Pa||(a.Title=""===B.title||B.title?B.title:a.Title,!a.Title&&""!==a.Title)||(c=this.Hgf(c,ma,a.Title,
X,h));if(c){v&&(c=this.WWe(c));var mb=Jl.Ird(c,v);if(mb){h=xu.m(a.MediaType);var Tb=Jl.DBd(a.Height,a.Width,a.Title,h);(mb=this.mgf(mb,Tb,v,{url:X,RTa:a.IFrameHtml,$u:a.Title,mediaType:h}))?(ma.tAa(this.Sk,1),ma.dispose(),this.dBb=c,this.eBb=X,this.KBf(B,a,mb),this.pEf(X,v||B.hideFloatie,Pa,h,a.Title)):ma.dispose()}else ma.dispose(),r.ULS.sendTraceTag(590455041,324,10,"Unable to insert external content. Could not create IP context on splitting the paragraph."),ej.he.iO(this.xm,2,"Could not create IP context on splitting the paragraph",
ej.he.Nm())}else ej.he.iO(this.xm,2,"GraphNodeContext is null",ej.he.Nm())}mgf(a,c,h,v){if(!a)return null;a=ej.gx.MGd(a,c);if(!a)return r.ULS.sendTraceTag(590455042,324,10,"Unable to insert external content. The anchored image could not be inserted."),ej.he.iO(this.xm,2,"The anchored image could not be inserted",ej.he.Nm()),null;a=a.node;v=Jl.GGd(a,v);ej.he.g0f(this.xm,v.id);h||Jl.BPf(a);return a}KBf(a,c,h){F.a.aX(a.thumbnailUrl)||(c.Thumbnail=a.thumbnailUrl);c.Thumbnail&&c.Thumbnail.length&&(ej.he.i1(this.xm,
8,ej.he.Nm()),r.ULS.sendTraceTag(591681431,324,50,"OverrideAndDownloadThumbnailImage: ExternalContent contains a Thumbnail image url"),this.Xtd(h,c.Thumbnail))}pEf(a,c,h,v,B){c||this.iyc(a);this.tta("OEmbedInserted","ExternalContentFloodGateSurveyIsEnabled");Jl.YSd("IsHyperlinkWithNonURLDisplayText",h,"Office.Word.Online.ExternalContent.OEmbedInsertions");Jl.eUb(v,B);ej.he.i1(this.xm,5,ej.he.Nm())}Hgf(a,c,h,v,B){if(B){if((B=ch.HyperlinkReader.aB(a,!1))&&1!==B.length)return c.dispose(),r.ULS.sendTraceTag(590455040,
324,10,"Insertion of ExternalContent due to autoCorrect was canceled due to source Hyperlink not found."),null;Jl.hyperlinkEditor.jP(B[0].paragraph,B[0].hyperlink)}return this.kLf(a,h,v)}WWe(a){const c=a.node,h=sd.ParagraphReader.text(c);return 0<h.length&&!h.trim().length?(a=Oe.a.createTextRange(c,0,h.length),Jl.characterPropertiesEditor.replaceTextRange(a,""),Oe.a.Sb(c,0)):a}MEf(a){let c;if(!({group:c}=Dm.a.D$(a.data.qd,c)).returnValue)return null;a=c.Responses[0];return a.StatusCode?null:a}kLf(a,
c,h){const v=a.cpBegin+c.length;Jl.characterPropertiesEditor.replaceTextRange(a,c);a=Oe.a.createTextRange(a.node,a.cpBegin,v);Jl.hyperlinkEditor.BG(a,h,!1);return a}ETa(a){a.A7b=null}oMc(a,c,h,v){const B=a.cpBegin,X=a.cpEnd;a=sd.ParagraphReader.text(a.node).trim();B||a!==c&&""!==a?B?X===a.length?r.ULS.sendTraceTag(590958601,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the end of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",so[h],v):0<B&&X<
a.length&&r.ULS.sendTraceTag(590958602,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in between of a paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",so[h],v):r.ULS.sendTraceTag(590958600,324,50,"LogPastePositionTelemetry: OEmbed conversion happended at the start of the paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",so[h],v):r.ULS.sendTraceTag(590958599,324,50,"LogPastePositionTelemetry: OEmbed conversion happended in a blank paragraph ExternalContentConversionContext = {0}, BeforeRequestCallback = {1}",
so[h],v)}iyc(a){this.rXb();const c=new y.a(1,l.AFrameworkApplication.isRtl);c.KPc=a;ej.D$a.LRc(c)}rXb(){const a=new Pg.a(!0);ej.UCf.qBa(a)}static get D$a(){return ej.uW||(ej.uW=xa.a.instance.resolve("Box4.IExternalContentFloatieEventSource"))}static get pia(){ej.Cua||(ej.Cua=xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return ej.Cua}static get UCf(){return ej.pu||(ej.pu=xa.a.instance.resolve("Box4.IPasteFloatieEventSource"))}static get pNa(){return ej.nGa||(ej.nGa=
xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior"))}static get gx(){return ej.Og||(ej.Og=xa.a.instance.resolve("WordEditor.IImageEditor"))}static get WNc(){return ej.Qnc||(ej.Qnc=xa.a.instance.resolve("WordEditor.ExternalContent.IOEmbedOverridesURLParser"))}}ej.uW=null;ej.nGa=null;ej.Og=null;ej.Qnc=null;ej.Dxa=5E3;ej.pu=null;ej.Cua=null;Object(w.a)(ej,"ExternalContentEditorV2",Av,[]);class Ny{static get pNa(){return Ny.nGa||(Ny.nGa=xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSizeBehavior"))}AOn(a,
c){c=c.property;if(c===Yb.a.Po||c===Yb.a.marginLeft||c===Yb.a.marginRight)c=Ny.pNa.Zub(a)||0,c=Be.a.ym(c,0),a&&a.properties.setValue(Ed.a.A4,c)}Df(a,c,h){this.AOn(a,h)}}Ny.nGa=null;Object(w.a)(Ny,"ExternalContentImageEventHandler",null,[325]);class Fz{constructor(){this.Na=this.W=null}get name(){return"WordEditor.ExternalContent"}get Ua(){return this.Na?this.Na:this.Na=this.W.resolve("Box4.IFeatureHelper")}yb(a){this.W=a;a.ha("WordEditor.ExternalContent.ExternalContentSizeBehavior",()=>new sf(iq.a.instance,
$t.WordSectionNavigator.instance)).as("WordEditor.ExternalContent.IExternalContentSizeBehavior").singleInstance();a.ha("WordEditor.ExternalContent.ExternalContentImageEventHandler",()=>new Ny).as("WordEditor.ExternalContent.IExternalContentImageEventHandler").singleInstance();a.ha("WordEditor.ExternalContent.PostHyperlinkAutoCorrectStrategy",()=>new bE).as("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy").singleInstance();a.ha("WordEditor.ExternalContent.ExternalContentSettingInfo",()=>new wA(a.resolve("Box4.IRoamingServiceRequestManager"),
a.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.ExternalContent.IExternalContentSettingInfo").singleInstance();l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)?(a.ha("WordEditor.ExternalContent.ExternalContentEditorV2",()=>new ej).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance(),a.ha("WordEditor.ExternalContent.FluidComponentEditor",()=>new yt).singleInstance(),a.ha("WordEditor.ExternalContent.FluidComponentsActor",
()=>new WC(l.AFrameworkApplication.pa,a.resolve("WordEditor.ExternalContent.FluidComponentEditor"))).singleInstance()):a.ha("WordEditor.ExternalContent.ExternalContentEditor",()=>new Gg).as("Wonca.ExternalContent.IExternalContentEditor").singleInstance()}init(){this.Ua.pk.continueWith(()=>{this.El()});l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1)&&this.W.resolve("WordEditor.ExternalContent.FluidComponentsActor").eb()}dispose(){}Nhk(){const a=
new Az;this.ehh()&&a.COg(Ez.Oba());a.COg(new xA);return a}El(){null==l.AFrameworkApplication.K||l.AFrameworkApplication.K.$("IOEmbedOverridesURLParserCrashFixIsEnabled")||this.W.ha("WordEditor.ExternalContent.OEmbedQueryParamsOverridesURLParser",()=>new UC.a).as("WordEditor.ExternalContent.IOEmbedOverridesURLParser").singleInstance();this.ehh()&&(this.W.ha("WordEditor.ExternalContent.IWordExternalContentURLResolver",()=>this.Nhk()).as("WordEditor.ExternalContent.IWordExternalContentURLResolver").singleInstance(),
this.W.resolve("WordEditor.ExternalContent.IWordExternalContentURLResolver"))}ehh(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableInnerRingWEdgeExperimentsOEmbedURLResolver",!1)}static main(){M.a.instance.Lb(new Fz)}}Object(w.a)(Fz,"ExternalContentPackage",null,[1,2]);var Yw;(function(a){a[a.invalid=-1]="invalid";a[a.clear=0]="clear";a[a.left=1]="left";a[a.start=2]="start";a[a.center=3]="center";a[a.right=4]="right";a[a.end=5]="end";a[a.decimal=6]="decimal";
a[a.l4n=7]="bar";a[a.vda=8]="num"})(Yw||(Yw={}));Object(w.b)("TabStopValues",Yw);class $n{}$n.Kbh=8;$n.fqk=1;$n.d0="wwaengidc";$n.kpiName="WordRuler";$n.precision=.0625;$n.DAn=1;$n.sTn="ShowHideRuler";Object(w.a)($n,"Constants",null,[]);var XC=b(373),gC=b(693);class ss{static H_b(a,c){if(!ss.iKc)return null;switch(a){case "Left":return h=>{const v=h.rulerCanvasProps;h=h.indents;return{mBb:0,qFb:v.scale-(v.margins[1].value+h[2].value+Math.max(h[0].value,h[1].value)+8*v.precision)}};case "Right":return h=>
{const v=h.rulerCanvasProps;h=h.indents;return{mBb:0,qFb:v.scale-(h[2].value+(v.margins[0].value+Math.max(h[0].value,h[1].value))+8*v.precision)}};case "MoveTableColumn":return()=>{let h=0,v=0;if(0===c){var B={};32===ss.Eb.hb(zb.a.v8b,2,B)&&(h=Of.a.uA(B.MinIndent),v=Of.a.uA(B.MaxIndent))}else B={Km:c-1},32===ss.Eb.hb(zb.a.u8b,2,B)&&(h=Of.a.uA(B.MinResize),v=Of.a.uA(B.MaxResize));return{mBb:h,qFb:v}};case "Top":return h=>{h=h.rulerCanvasProps;return{mBb:0,qFb:h.scale-(h.margins[1].value+8*h.precision)}};
case "Bottom":return h=>{h=h.rulerCanvasProps;return{mBb:0,qFb:h.scale-(h.margins[0].value+8*h.precision)}}}return null}static XBd(a){if(!ss.iKc)return null;switch(a){case "FirstLineIndent":case "HangingIndent":case "LeftIndent":return c=>{var h=c.rulerCanvasProps,v=c.indents,B=c.ipContextIndex;c=h.margins;var X=h.scale;h=h.precision;if("MoveTableColumn"!==c[0].type){B=c[0].value;c=c[1].value+v[2].value;var ma=B;"LeftIndent"===a&&(ma+=Math.max(v[0].value,v[1].value));v=-1*B;h=X-(ma+c+8*h)}else{X=
0;for(ma=0;ma<=B;ma++)X+=c[ma].value;ma=0;if("LeftIndent"===a){ma=v[0].value;const Pa=v[1].value;X+=Math.max(ma,Pa);ma=Math.max(ma,Pa)}c=c[B+1].value;ma+=v[2].value;v=-1*X;h=c-ma-h}return{mBb:v,qFb:h}};case "RightIndent":return c=>{var h=c.rulerCanvasProps,v=c.indents,B=c.ipContextIndex,X=h.margins;c=h.scale;h=h.precision;if("MoveTableColumn"!==X[0].type){var ma=X[0].value;X=X[1].value;B=v[0].value;var Pa=v[1].value;v=-1*X;c-=ma+X+Math.max(B,Pa)+8*h}else{ma=0;for(Pa=0;Pa<=B;Pa++)ma+=X[Pa].value;X=
X[B+1].value;B=v[0].value;Pa=v[1].value;v=-1*(c-ma-X);c=X-Math.max(B,Pa)-h}return{mBb:v,qFb:c}}}return null}static nel(){return a=>{var c=a.rulerCanvasProps,h=a.indents,v=a.ipContextIndex,B=c.margins;a=c.precision;c=c.scale;"MoveTableColumn"!==B[0].type?(v=B[0].value,B=B[1].value+h[2].value,h=Math.min(h[0].value,h[1].value)+a,a=c-(v+B+a)):(c=h[2].value,B=B[v+1].value,h=Math.min(h[0].value,h[1].value)+a,a=B-(c+a));return{mBb:h,qFb:a}}}static get Eb(){return ss.ga||(ss.ga=l.AFrameworkApplication.pa)}static get iKc(){null==
this.Z4a&&(l.AFrameworkApplication.kda("WoRul910;WoRul910cf"),this.Z4a=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RulerPropertyBoundaryIsEnabled",!1):!1);return this.Z4a}}ss.Z4a=null;Object(w.a)(ss,"RulerPropertyBoundaryHelper",null,[]);var dE=b(820),Px;(function(a){a[a.appChromeReady=0]="appChromeReady";a[a.appChromeLazyReady=1]="appChromeLazyReady"})(Px||(Px={}));Object(w.b)("WoncaAppChromeState",Px);const eE=a=>{yh.c()?a():r.ULS.sendTraceTag(51393038,
340,10,"appChrome is not defined.")},pB=(a,c)=>{const h=xa.a.instance.ra("Wonca.IWoncaAppChromeStateManager");h?h.Vk(a,()=>{eE(c)}):eE(c)};var TE=b(1088),fE=b(1089);class yA{constructor(a,c,h,v,B,X){this.kwm="OutlineContainer";this.Pyj="UpdateCustomTabFailed";this.Epb="ReadRulerPropertiesFailed";this.Tyj="UpdateIndentFailed";this.cKg="UpdateMarginFailed";this.Lj=a;this.hPb=c;this.ga=h;this.ize=v;this.jD=B;this.BW=X;this.sMb=null;this.Pw=!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.a9}IF(){this.WHe();
this.FOg();this.hPb.Pk.Yd(10).Yl(Object(m.a)(this,this.KOc,"onOutlinePropertyChanged"));Ld.a.addHandler(this.LFe,Jb.a.scroll,Object(m.a)(this,this.SVi,"updateRulerLocationOnScroll"));this.Lj.execute(c=>{c.Z4(Object(m.a)(this,this.Gq,"onZoomChanged"))});const a=[this.P9e(),document.getElementById(If.AppFrame.E_c),document.getElementById("PageContentContainer")];this.sMb?this.sMb.register(a,Object(m.a)(this,this.VCa,"updateRulerLocation")):pB(Px.appChromeLazyReady,()=>{appChrome.getResizeObserver().then(c=>
{this.sMb=c.createResizeObserver();this.sMb.register(a,Object(m.a)(this,this.VCa,"updateRulerLocation"));return null})});Eb.App.oa.Vw.registerBoundingWindowRectsChanged("documentPanel",(c,h)=>{"undefined"!==h&&this.p1a([1,0])})}P9e(){return 1===this.BW.XA?this.Ypj:this.vpj}get LFe(){return document.getElementById(If.AppFrame.hDa)}get vpj(){const a=document.getElementsByClassName(this.kwm);return a&&0<a.length?a[0]:null}get Ypj(){var a=this.jD.EYb;if(!a)return null;a=this.J8m(sd.ParagraphReader.vR(a));
return dE.a.Ozh(a)}J8m(a){return 0<a?document.querySelector("div.PagesContainer p[paraid='"+a+"']"):null}SRd(a){a.button===Sys.UI.MouseButton.rightButton&&this.ize.show(new Sys.UI.Point(a.clientX,a.clientY),2)}SVi(){this.VCa()}get nL(){return this.Lj&&this.Lj.instance?this.Lj.instance.ei:$n.fqk}b_b(){const a={};return 32!==this.ga.hb(zb.a.nBa,2,a)?(r.ULS.sendTraceTag(529065947,TE.a.msoulscat_Wac_WordRuler,fE.a.warning,"Unable to read page properties for Ruler"),rm.recordQosError(this.Epb,[rm.Raa],
"Unable to read page properties for Ruler"),null):a}dispose(){this.GJh();this.hPb.Pk.Yd(10).WI(Object(m.a)(this,this.KOc,"onOutlinePropertyChanged"));Ld.a.removeHandler(this.LFe,Jb.a.scroll,Object(m.a)(this,this.SVi,"updateRulerLocationOnScroll"));this.Lj.execute(a=>{a.ngb(Object(m.a)(this,this.Gq,"onZoomChanged"))});this.sMb&&this.sMb.dispose();Eb.App.oa.Vw.unregisterBoundingWindowRectsChanged("documentPanel",(a,c)=>{"undefined"!==c&&this.p1a([1,0])})}get hUh(){null==yA.eoe&&(yA.eoe=l.AFrameworkApplication.K?
l.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&l.AFrameworkApplication.K.$("RulerThemingIsEnabled"):!1);return yA.eoe}}yA.eoe=null;Object(w.a)(yA,"ARuler",null,[388]);var qG=b(298);class Tt extends yA{constructor(a,c,h,v,B,X,ma){super(a,c,h,B,X,ma);this.M0="HorizontalRuler";this.F0i="CustomTabModificationFromRuler";this.X1i="IndentModificationFromRuler";this.C9d="MarginModificationFromRuler";
this.Ylg=this.Xlg=this._tabStops=null;if(XC.a.isSharedUxGateEnabled("WordOnline.ChangeGate.DelayLoadUISlice20InRuler"))this.Wna=v;else{const Pa=v();this.Wna=()=>Pa}this.xv={}}get UU(){return this.Xlg}get aza(){return this.Ylg}renderRuler(){this.UU.classList.remove("HideWACHorizontalRulerContainer");this.UU.classList.add("ShowWACHorizontalRulerContainer");var a=this.b_b();if(a){var c=Object(m.a)(this,this.uzf,"onMarginChange"),h=Object(m.a)(this,this.Qom,"onIndentChange"),v=Object(m.a)(this,this.Dmm,
"onCustomTabChange"),B=this.ZYc(),X=this.NQi(),ma=this.MQi();B&&X&&ma||(this.xv.disabled=!0);this.xv.onIndentChange=h;this.xv.onMarginChange=c;this.xv.onTabChange=v;this.VCa();a=Be.a.Vh(a.Po,0);this.aza.style.width=(a*this.nL).toString()+"px";return this.Wna().then(Pa=>{Pa.renderRuler(this.aza,this.xv)})}}Dmm(a,c,h){if(!(a>=this._tabStops.length)){a=this._tabStops[a];var v="Modify"===h?this.ga.hb(ba.a.C5b,2,{["tabStop"]:a,["value"]:Of.a.YD(c)}):this.ga.hb(ba.a.c_a,2,a);if(32===v){c=1;var B=String.format("Custom tab modified using ruler. Operation: {0}. CustomTab: {1}",
h,Yw[a.s$]);r.ULS.sendTraceTag(591213271,3014,50,B)}else c=0,B=String.format("Unable to modify custom tab using ruler. Operation: {0}. CustomTab: {1}",h,Yw[a.s$]),r.ULS.sendTraceTag(591213272,3014,15,B),rm.recordQosError(this.Pyj,[rm.Raa],"Unable to modify custom tab using ruler");re.a(this.F0i,32===v,void 0,[Object.assign(new aa.a,{name:"Operation",string:h}),Object.assign(new aa.a,{name:"TabType",int64:Yw[a.s$]})]);h=new Map;h.set("Command","OnCustomTabChange");h.set("Source",this.M0);h.set("Response",
B);Fa.Health.instance.recordKpiUsage($n.kpiName,c,$n.d0,h)}}MQi(){const a=[];var c={};if(32!==this.ga.hb(ba.a.eEb,2,c))return r.ULS.sendTraceTag(589651997,3014,15,"Unable to read paragraph tabs for Ruler"),rm.recordQosError(this.Epb,[rm.Raa],"Unable to read paragraph tabs for Ruler"),!1;var h=c.customTabs;if(!h||0>=h.length)return this.xv.tabs=a,!0;this._tabStops=h;c="";for(let v of h){switch(v.s$){case 1:c="LeftTab";break;case 4:c="RightTab";break;case 3:c="CenterTab";break;case 6:c="DecimalTab";
break;case 7:c="BarTab"}h=Be.a.Hfb(v.pCa,0);a.push({["type"]:c,["value"]:h,["getRulerPropertyBoundary"]:ss.nel()})}this.xv.tabs=a;return!0}p1a(a){if(this.UU){this.UU.classList.add("ShowWACHorizontalRulerContainer");"disabled"in this.xv&&delete this.xv.disabled;for(let c of a)switch(c){case 0:a=this.NQi();const h=this.MQi();a&&h||(this.xv.disabled=!0);break;case 1:this.ZYc()||(this.xv.disabled=!0)}this.Wna().then(c=>{c.renderRuler(this.aza,this.xv);return null})}}ZYc(){const a={};var c=this.b_b();
if(!c)return!1;a.scale=Of.a.uA(c.Po);a.precision=$n.precision;a.rulerType="Horizontal";if(!this.Qum())return this.xv.ipContextIndex=0,this.xv.permittedUnits=$n.Kbh,c=[{["type"]:"Left",["value"]:Of.a.uA(c.marginLeft),["getRulerPropertyBoundary"]:ss.H_b("Left",0)},{["type"]:"Right",["value"]:Of.a.uA(c.marginRight),["getRulerPropertyBoundary"]:ss.H_b("Right",1)}],a.margins=c,this.xv.rulerCanvasProps=a,!0;var h={};c={};var v=this.ga.hb(zb.a.tRc,2,h);const B=this.ga.hb(zb.a.rEb,2,c);if(32!==v||32!==B)return r.ULS.sendTraceTag(589651998,
3014,15,"Unable to read table properties for Ruler"),rm.recordQosError(this.Epb,[rm.Raa],"Unable to read table properties for Ruler"),!1;h=h.ColumnWidths;v=c.TablePosition;if(!v||!h||0>=h.length)return r.ULS.sendTraceTag(589632533,3014,15,"Cannot show table properties on the ruler as they are null"),rm.recordQosError(this.Epb,[rm.Raa],"Cannot show table properties on the ruler as they are null"),!1;c=Array(h.length+1);c[0]={["type"]:"MoveTableColumn",["value"]:Of.a.uA(v.x/this.nL),["getRulerPropertyBoundary"]:ss.H_b("MoveTableColumn",
0)};for(v=0;v<h.length;v+=1)c[v+1]={["type"]:"MoveTableColumn",["value"]:Of.a.uA(h[v]),["getRulerPropertyBoundary"]:ss.H_b("MoveTableColumn",v+1)};this.xv.ipContextIndex=this.Rhl();this.xv.permittedUnits=$n.DAn;a.margins=c;this.xv.rulerCanvasProps=a;return!0}NQi(){var a={};if(32!==this.ga.hb(zb.a.TZa,2,a))return r.ULS.sendTraceTag(592496522,3014,15,"Unable to read paragraph indentation for Ruler"),rm.recordQosError(this.Epb,[rm.Raa],"Unable to read paragraph indentation for Ruler"),!1;const c={type:"FirstLineIndent"};
c.getRulerPropertyBoundary=ss.XBd("FirstLineIndent");const h={type:"HangingIndent"};h.getRulerPropertyBoundary=ss.XBd("HangingIndent");const v={type:"RightIndent"};v.getRulerPropertyBoundary=ss.XBd("RightIndent");const B={type:"LeftIndent"};B.getRulerPropertyBoundary=ss.XBd("LeftIndent");this.xv.rtl=a.isRtl;a=a.Ar;c.value=1===a.specialIndentType?Of.a.uA(a.m$+a.az):2===a.specialIndentType?Of.a.uA(a.az-a.m$):Of.a.uA(a.az);h.value=Of.a.uA(a.az);B.value=Of.a.uA(a.az);v.value=Of.a.uA(a.mja);this.xv.indents=
[c,h,v,B];return!0}Qom(a,c){var h=new gC.a;h.unit=1;h.value=Of.a.YD(c);c=8;switch(a){case "FirstLineIndent":c=this.ga.hb(zb.a.BVc,2,h);break;case "HangingIndent":c=this.ga.hb(zb.a.CVc,2,h);break;case "LeftIndent":c=this.ga.hb(zb.a.WWa,2,h);break;case "RightIndent":c=this.ga.hb(zb.a.VWa,2,h)}let v;32===c?(h=1,v=String.format("Indents set using Ruler. Indent: {0}",a),r.ULS.sendTraceTag(592517017,3014,50,v)):(h=0,v=String.format("Unable to set indent using Ruler. Indent: {0}",a),r.ULS.sendTraceTag(592496523,
3014,15,v,a),rm.recordQosError(this.Tyj,[rm.Raa],"Unable to set indent using Ruler."));re.a(this.X1i,32===c,void 0,[Object.assign(new aa.a,{name:"Type",string:a})]);a=new Map;a.set("Command","OnIndentChange");a.set("Source",this.M0);a.set("Response",v);Fa.Health.instance.recordKpiUsage($n.kpiName,h,$n.d0,a)}FOg(){Ld.a.addHandler(this.UU,Jb.a.Lv,Object(m.a)(this,this.SRd,"onRulerMouseDown"))}GJh(){this.UU.classList.remove("ShowWACHorizontalRulerContainer");this.UU.classList.add("HideWACHorizontalRulerContainer");
Ld.a.removeHandler(this.UU,Jb.a.Lv,Object(m.a)(this,this.SRd,"onRulerMouseDown"));this.Wna().then(a=>{a.dispose(this.aza);return null})}uzf(a,c,h){let v;v="Left"===a?this.ga.hb(zb.a.wea,2,Of.a.YD(c)):"Right"===a?this.ga.hb(zb.a.U_a,2,Of.a.YD(c)):h?this.ga.hb(zb.a.s4d,2,{["columnIndex"]:h-1,["width"]:Of.a.YD(c)}):this.ga.hb(zb.a.V$b,2,Of.a.YD(c));32===v?(c=1,h=String.format("Margins set using Ruler. Margin: {0}",a),r.ULS.sendTraceTag(592517018,3014,50,h)):(c=0,h=String.format("Unable to set margins using Ruler. Margin: {0}",
a),r.ULS.sendTraceTag(592496524,3014,15,h),rm.recordQosError(this.cKg,[rm.Raa],"Unable to set margins using Ruler."));re.a(this.C9d,32===v,void 0,[Object.assign(new aa.a,{name:"Type",string:a})]);a=new Map;a.set("Command","OnMarginChange");a.set("Source",this.M0);a.set("Response",h);Fa.Health.instance.recordKpiUsage($n.kpiName,c,$n.d0,a)}Gq(){this.UVi();this.VCa();this.p1a([1,0])}KOc(a,c){a=c.property;if(a===Yb.a.Po||a===Yb.a.marginLeft||a===Yb.a.marginRight)this.UVi(),this.VCa(),this.p1a([1])}UVi(){var a=
this.b_b();a&&(a=Be.a.Vh(a.Po,0),this.aza.style.width=Math.round(a*this.nL).toString()+"px")}VCa(){window.requestAnimationFrame(()=>{var a=this.P9e();a&&(a=Ve.a.getElementBounds(a),l.AFrameworkApplication.isRtl?this.aza.style.marginRight=(window.document.documentElement.clientWidth-a.x-a.width).toString()+"px":this.aza.style.marginLeft=a.x.toString()+"px")})}Rhl(){const a=Kd.GraphIterator.va(this.jD.EYb);if(a.La(14))return a.mc(16),Or.a(a,!0);r.ULS.sendTraceTag(557110540,3014,15,"Unable to read table column index for Ruler");
rm.recordQosError(this.Epb,[rm.Raa],"Unable to read table column index for Ruler");return 0}Qum(){let a=!0;const c=this.jD.Fa.aO();if(null===c)return r.ULS.sendTraceTag(557065614,3014,15,"Unable to get Context Iterator for the Ruler"),rm.recordQosError(this.Epb,[rm.Raa],"Unable to get Context Iterator for the Ruler"),!1;for(;c.moveNext()&&a;){const h=Kd.GraphIterator.va(c.current.node);h.nc();a=a&&Wf.TableReader.Jv(h)}return a}WHe(){if(!this.aza&&!this.UU){this.Xlg=document.createElement("div");this.UU.id=
Tt.Ygj;this.UU.className=Tt.Xgj;this.UU.setAttribute(we.a.oba,WordEditorIntl.WordEditorStrings.L_Ruler);this.UU.setAttribute(we.a.tg,we.a.yUg);this.UU.classList.add("HideWACHorizontalRulerContainer");if(this.hUh){var a=l.AFrameworkApplication.K.Ga("ModernUxExperimentPreferenceCookieName");const c=l.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");cb.a.Bia(a,!c)&&this.UU.classList.add(Tt.Pmj)}this.Ylg=document.createElement("div");this.aza.className=Tt.Wgj;this.aza.id=Tt.Zgj;this.UU.appendChild(this.aza);
a=null;this.Pw&&((a=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedLayout",!1)?Object(qG.a)("EditorBars"):Eb.App.oa.Vw.getRegion(Eb.App.oa.Vw.iSc.J("Ruler")))&&a.appendChild(this.UU),this.UU.classList.add("regionComposer"));a||(a=document.getElementById(If.AppFrame.E_c),a.insertBefore(this.UU,a.firstChild))}}static gC(){return new Tt(xa.a.instance.za("Common.IZoomManager"),Eb.App.aj,l.AFrameworkApplication.pa,Hi.UISurfaces.gCh,xa.a.instance.resolve("WordEditor.IRulerContextMenu"),
yr.a.instance,xa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return Tt._instance||(Tt._instance=Tt.gC())}}Tt.Ygj="WACHorizontalRulerContainer";Tt.Xgj="WACHorizontalRulerContainer";Tt.Zgj="WACHorizontalRuler";Tt.Wgj="WACHorizontalRuler";Tt.Pmj="ModernUxWACHorizontalRulerContainer";Tt._instance=null;Object(w.a)(Tt,"HorizontalRuler",yA,[]);var rG=b(848);class Ut extends yA{constructor(a,c,h,v,B,X,ma){super(a,c,h,B,X,ma);this.M0="VerticalRuler";this.C9d="MarginModificationFromRuler";
this.SKg=this.RKg=null;if(XC.a.isSharedUxGateEnabled("WordOnline.ChangeGate.DelayLoadUISlice20InRuler"))this.Wna=v;else{const Pa=v();this.Wna=()=>Pa}this.xv={}}get P1(){return this.RKg}get eDa(){return this.SKg}renderRuler(){ye.a.rs(this.P1,"HideWACVerticalRulerContainer");ye.a.ze(this.P1,"ShowWACVerticalRulerContainer");var a=this.b_b();if(a){var c=Object(m.a)(this,this.uzf,"onMarginChange");this.ZYc()||(this.xv.disabled=!0);this.xv.onMarginChange=c;this.VCa();a=Be.a.Vh(a.lA,1);this.eDa.style.height=
(a*this.nL).toString()+"px";this.Wna().then(h=>{h.renderRuler(this.eDa,this.xv);return null})}}p1a(a){if(this.P1){ye.a.ze(this.P1,"ShowWACVerticalRulerContainer");"disabled"in this.xv&&delete this.xv.disabled;for(let c of a)switch(c){case 1:this.ZYc()?this.VCa():this.xv.disabled=!0}this.Wna().then(c=>{c.renderRuler(this.eDa,this.xv);return null})}}ZYc(){const a={},c=this.b_b();if(!c)return!1;a.scale=Of.a.uA(c.lA);a.precision=$n.precision;a.rulerType="Vertical";this.xv.ipContextIndex=0;this.xv.permittedUnits=
$n.Kbh;a.margins=[{["type"]:"Top",["value"]:Of.a.uA(c.marginTop),["getRulerPropertyBoundary"]:ss.H_b("Top",0)},{["type"]:"Bottom",["value"]:Of.a.uA(c.marginBottom),["getRulerPropertyBoundary"]:ss.H_b("Bottom",1)}];this.xv.rulerCanvasProps=a;return!0}FOg(){this.WHe();Ld.a.addHandler(this.P1,Jb.a.Lv,Object(m.a)(this,this.SRd,"onRulerMouseDown"))}GJh(){ye.a.rs(this.P1,"ShowWACVerticalRulerContainer");ye.a.ze(this.P1,"HideWACVerticalRulerContainer");Ld.a.removeHandler(this.P1,Jb.a.Lv,Object(m.a)(this,
this.SRd,"onRulerMouseDown"));this.Wna().then(a=>{a.dispose(this.eDa);return null})}uzf(a,c){let h=8;"Top"===a?h=this.ga.hb(zb.a.V_a,2,Of.a.YD(c)):"Bottom"===a&&(h=this.ga.hb(zb.a.T_a,2,Of.a.YD(c)));let v;32===h?(c=1,v=String.format("Margins set using Ruler. Margin: {0}",a),r.ULS.sendTraceTag(529065945,3014,50,v)):(c=0,v=String.format("Unable to set margins using Ruler. Margin: {0}",a),r.ULS.sendTraceTag(529065946,3014,15,v),rm.recordQosError(this.cKg,[rm.Raa],"Unable to set margins using Ruler."));
re.a(this.C9d,32===h,void 0,[Object.assign(new aa.a,{name:"Type",string:a})]);a=new Map;a.set("Command","OnMarginChange");a.set("Source",this.M0);a.set("Response",v);Fa.Health.instance.recordKpiUsage($n.kpiName,c,$n.d0,a)}Gq(){this.RVi();this.VCa();this.p1a([1])}KOc(a,c){a=c.property;if(a===Yb.a.lA||a===Yb.a.marginTop||a===Yb.a.marginBottom)this.RVi(),this.VCa(),this.p1a([1])}RVi(){var a=this.b_b();a&&(a=Be.a.Vh(a.lA,1),this.eDa.style.height=Math.round(a*this.nL).toString()+"px")}VCa(){window.requestAnimationFrame(()=>
{var a=this.P9e();if(a){const c=Ve.a.getElementBounds(a);this.eDa.style.height=c.height.toString()+"px";a=this.wjl(a);this.eDa.style.marginTop=a+"px"}})}wjl(a){a=a.getBoundingClientRect().y;let c=this.LFe.getBoundingClientRect().y;return a-c}WHe(){if(!this.eDa&&!this.P1){this.RKg=document.createElement("div");this.P1.id=Ut.Hzj;this.P1.className=Ut.Gzj;this.P1.setAttribute(we.a.oba,WordEditorIntl.WordEditorStrings.L_Ruler);this.P1.setAttribute(we.a.tg,we.a.yUg);Sys.UI.DomElement.addCssClass(this.P1,
"HideWACVerticalRulerContainer");if(this.hUh){var a=l.AFrameworkApplication.K.Ga("ModernUxExperimentPreferenceCookieName");const c=l.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");cb.a.Bia(a,!c)&&Sys.UI.DomElement.addCssClass(this.P1,Ut.Qmj)}this.SKg=document.createElement("div");this.eDa.className=Ut.Fzj;this.eDa.id=Ut.Izj;this.P1.appendChild(this.eDa);a=document.getElementById(If.AppFrame.E_c);a.insertBefore(this.P1,a.firstChild)}}static gC(){return new Ut(xa.a.instance.za("Common.IZoomManager"),
Eb.App.aj,l.AFrameworkApplication.pa,Hi.UISurfaces.gCh,xa.a.instance.resolve("WordEditor.IRulerContextMenu"),yr.a.instance,xa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return Ut._instance||(Ut._instance=Ut.gC())}}Ut.Hzj="WACVerticalRulerContainer";Ut.Gzj="WACVerticalRulerContainer";Ut.Izj="WACVerticalRuler";Ut.Fzj="WACVerticalRuler";Ut.Qmj="ModernUxWACVerticalRulerContainer";Ut._instance=null;Object(w.a)(Ut,"VerticalRuler",yA,[]);class rm{constructor(a,c,h,v,B,X,
ma,Pa,mb){this.ele=this.Ene=!1;this.M0="RulerActor";this.QDg=null;this.Eja=!1;this.r$i="ClearAllTabStopsFailed";this.eGg="ShowHideRulerFailed";this.ype=null;this.ga=a;this.B4a=c;this.zFe=h;this.UJb=v;this.ize=B;this.jze=X;rm.Kj=Pa;this.JEa=ma;this.BW=mb;this.JEa.lQg(Object(m.a)(this,this.wJh,"headerFooterOpenedEvent"));this.JEa.rld(Object(m.a)(this,this.syb,"headerFooterDismissedEvent"))}initialize(){this.eb();this.QDg=Object(m.a)(this,this.Y5m,"rulerOn");window.addEventListener("TurnRulerOnAction",
this.QDg,!0);return this.jze.mel().continueWith(Object(m.a)(this,this.nzl,"initRulerRoamingSettingOptions"),8)}eb(){this.ga.ka(zb.a.VGb,ic.a.view,Object(m.a)(this,this.VGb,"showHideRuler"));this.ga.Aa(zb.a.mWd,ic.a.view,Object(m.a)(this,this.mWd,"queryRulerToggle"),96);this.ga.ka(ba.a.SLe,ic.a.view,Object(m.a)(this,this.JHc,"insertCustomTabStopRuler"));this.ga.ka(ba.a.WOe,ic.a.view,Object(m.a)(this,this.JHc,"insertCustomTabStopRuler"));this.ga.ka(ba.a.lpd,ic.a.view,Object(m.a)(this,this.lpd,"clearAllTabStops"));
this.ga.ka(ba.a.oWe,ic.a.view,Object(m.a)(this,this.JHc,"insertCustomTabStopRuler"));this.ga.ka(ba.a.nGc,ic.a.view,Object(m.a)(this,this.nGc,"hideRuler"));this.ga.ka(ba.a.Bof,ic.a.view,Object(m.a)(this,this.JHc,"insertCustomTabStopRuler"));this.ga.ka(ba.a.bNf,ic.a.view,Object(m.a)(this,this.JHc,"insertCustomTabStopRuler"));rG.a.Bd.addHandler(rG.a.yRd,this.ZOc.bind(this));this.BW.xTb(this.dBf)}VMh(){this.Eja&&(this.B4a.IF(),this.B4a.renderRuler(),this.NKd()&&this.Dsi())}Dsi(){this.zFe.IF();this.zFe.renderRuler()}CYe(){this.zFe.dispose()}NKd(){return this.lYh()&&
this.isPaginatedView()}lYh(){null==this.ype&&null!=l.AFrameworkApplication.K&&(this.ype=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.VerticalRulerEnabled",!1));return this.ype}W5d(){this.Eja||xa.a.instance.za("Common.ISystemInitiatedFeedback").execute(a=>{a.logActivity("TurnRulerOnActivity",null)})}SQ(){this.JEa.wYm(Object(m.a)(this,this.wJh,"headerFooterOpenedEvent"));this.JEa.Mri(Object(m.a)(this,this.syb,"headerFooterDismissedEvent"));this.Eja&&(this.B4a.dispose(),
this.NKd()&&this.CYe())}lpd(a,c,h){if(1===h)return 32;a=this.ga.processAction(ba.a.MEb,2,null);32===a?(h=1,c=String.format("Clear all tab stops from ruler"),r.ULS.sendTraceTag(591213266,3014,50,c)):(h=0,c=String.format("Unable to clear all tab stop from ruler"),r.ULS.sendTraceTag(591213267,3014,15,c),rm.recordQosError(this.r$i,[rm.Raa],c));const v=new Map;v.set("Command","ClearAllTabStops");v.set("Source",this.M0);v.set("Response",c);Fa.Health.instance.recordKpiUsage($n.kpiName,h,$n.d0,v);return a}JHc(a,
c,h){if(1===h)switch(a){case ba.a.SLe:case ba.a.oWe:return 2;default:return 32}c=this.ize.$cl();switch(a){case ba.a.Bof:var v=1;break;case ba.a.bNf:v=4;break;case ba.a.WOe:v=3;break;default:return r.ULS.sendTraceTag(591213268,3014,15,"Tried to insert bar or decimal tab stop."),2}a=new Zk.a(c,v,0,1);a=this.ga.hb(ba.a.bVc,2,a);32===a?(h=1,c=String.format("Insert Custom Tab Stop from Ruler. Tab: {0}. Value: {1}",Yw[v],c.toString()),r.ULS.sendTraceTag(591213269,3014,50,c)):(h=0,c=String.format("Unable to set custom tab stop from ruler. Tab: {0}. Value: {1}",
Yw[v],c.toString()),r.ULS.sendTraceTag(591213270,3014,15,c));v=new Map;v.set("Command","InsertCustomTabStopRuler");v.set("Source",this.M0);v.set("Response",c);Fa.Health.instance.recordKpiUsage($n.kpiName,h,$n.d0,v);return a}VGb(a,c,h,v,B){return this.Ene?8:this.Eja?this.nGc(a,c,h,v,B):this.rsn(c,h)}Y5m(){this.Eja?r.ULS.sendTraceTag(574128526,3014,50,"Ruler was already enabled"):(appChrome.api.dispatch(appChrome.actions.setCurrentTab("View")),32!==this.ga.processAction(zb.a.VGb,2)?(r.ULS.sendTraceTag(574128527,
3014,50,"Ruler could not be enabled"),rm.recordQosError(this.eGg,[rm.Raa],"Ruler could not be enabled")):r.ULS.sendTraceTag(573190796,3014,50,"Ruler was enabled from teaching callout"))}TVi(){if(this.UJb){const a={};a[$n.sTn]="ToggleButtonModel";this.UJb.xE(a)}}rsn(a,c){if(!rm.Kj.Pya(a.lm))return r.ULS.sendTraceTag(574375060,3014,15,"Cannot show ruler. Word Section Node not found."),rm.recordQosError(this.eGg,[rm.Raa],"Cannot show ruler. Word Section Node not found."),8;if(1===c)return 32;this.Eja=
!0;this.jze.axi(!0);this.VMh();this.TVi();r.ULS.sendTraceTag(593351624,3014,50,"Ruler is enabled");a=new Map;a.set("Command","ShowRuler");a.set("Source",this.M0);a.set("Response","");Fa.Health.instance.recordKpiUsage($n.kpiName,1,$n.d0,a);return 32}nGc(a,c,h){if(1===h||!this.Eja)return 32;this.Eja=!1;this.jze.axi(!1);this.B4a.dispose();this.NKd()&&this.CYe();this.TVi();r.ULS.sendTraceTag(593351623,3014,50,"Ruler is disabled");a=new Map;a.set("Command","HideRuler");a.set("Source",this.M0);a.set("Response",
"");Fa.Health.instance.recordKpiUsage($n.kpiName,1,$n.d0,a);return 32}isPaginatedView(){return 1===this.BW.XA}ZOc(a,c){switch(c.documentMode){case "View":this.Eja&&(this.ga.processAction(zb.a.VGb,2),this.ele=!0);break;case "Edit":this.ele&&(this.ga.processAction(zb.a.VGb,2),this.ele=!1)}}dBf(a,c){if(rm.instance.Eja&&rm.instance.lYh())switch(c.Q5b){case 1:rm.instance.Dsi();break;case 0:rm.instance.CYe()}}mWd(a,c,h,v,B){if(1===h)return 32;B&&(B[Uf.a.On]=this.Eja);return 32}nzl(a){this.Eja=a.result}syb(){this.Ene=
!1}wJh(){this.Ene=!0}static recordQosError(a,c,h){const v=Object.assign(new fi.a,{extendedProperties:new Map});h&&v.extendedProperties.set("exception",h);Fa.Health.instance.recordQosError(a,c,!1,!0,!1,!1,v)}static gC(){return new rm(l.AFrameworkApplication.pa,Tt.instance,Ut.instance,Eb.App.oa,xa.a.instance.resolve("WordEditor.IRulerContextMenu"),xa.a.instance.ra("WordEditor.Ruler.IRulerSettingInfo"),xa.a.instance.resolve("WordEditor.HeaderFooter.IHeaderFooterControlOwnerEvent"),iq.a.instance,xa.a.instance.resolve("WordEditor.IMainViewModeManager"))}static get instance(){return rm._instance||
(rm._instance=rm.gC())}}rm._instance=null;rm.Kj=null;rm.Raa="RulerInteractionFailed";Object(w.a)(rm,"RulerActor",null,[]);class sI{constructor(a,c){this.uqc=null;this.fw=a;this.ZZ=c}mel(){const a=new oj.a;if(null==this.uqc){if(this.hWh())return this.ZZ.JEb(Bz.a.jUc).CWRCo(Object(m.a)(this,this.$Cb,"onRegisterCallback"),0).CWRCo(Object(m.a)(this,this.gZa,"onGetRequestFinished"),8);a.Jf(!1)}else a.Jf(this.uqc);return a.task}$Cb(a){return a.result?a.result.Value.toString():""}cfa(a){this.ZZ.cfa(Bz.a.jUc,
new Cz.a(Bz.a.jUc,a))}axi(a){this.hWh()&&(this.fw.Ysa("saveRulerIsEnabled",a.toString()),r.ULS.sendTraceTag(591541276,3014,50,"Try to save ruler settings value to Roaming Service."));this.cfa(a)}hWh(){const a=l.AFrameworkApplication.K.$("IsAnonymousUser");if(l.AFrameworkApplication.K.$("IsRoamingServiceEnabled"))if(a)r.ULS.sendTraceTag(591541277,3014,50,"User is anonymous ");else return!0;return!1}gZa(a){a.Hn||a.Gh?(r.ULS.sendTraceTag(591541278,3014,15,"Failed to get ruler is enabled settings options from Roaming Service."),
this.uqc=!1):(a=a.result,""===a&&l.AFrameworkApplication.K&&(a=l.AFrameworkApplication.K.Ga("RulerDefaultOn")),this.uqc="true"===a.toLowerCase(),r.ULS.sendTraceTag(591541279,3014,50,"Load to get ruler is enabled settings options from Roaming Service successfully."));return this.uqc}}Object(w.a)(sI,"RulerSettingInfo",null,[364]);class tI{constructor(){this.kng=this.W=null}get name(){return"WordEditor.Ruler"}yb(a){this.W=a;r.ULS.sendTraceTag(578110851,3014,50,"Word ruler package is configured.")}init(){this.W.ha("WordEditor.Ruler.RulerSettingInfo",
()=>new sI(this.W.resolve("Box4.IRoamingServiceRequestManager"),this.W.resolve("Box4.RoamingSetting.IRoamingSettingCache"))).as("WordEditor.Ruler.IRulerSettingInfo").singleInstance();this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{this.El()});this.kng=rm.instance.initialize();r.ULS.sendTraceTag(578110852,3014,50,"Word ruler package is initialized")}El(){this.kng.continueWith(()=>{rm.instance.VMh();rm.instance.W5d()});r.ULS.sendTraceTag(578110853,3014,50,"InitializeRuler is called")}dispose(){rm.instance.SQ();
r.ULS.sendTraceTag(578110854,3014,50,"Word ruler package is disposed")}}Object(w.a)(tI,"PackageManager",null,[1,2]);class sG{constructor(){this.j1b=this.ITb=null}}Object(w.a)(sG,"CreatePickerCustomizationDictionaryOptions",null,[898]);class tG{}tG.vf="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(w.a)(tG,"InsertMediaM365DialogHtml",
null,[]);class gE{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe){this.i3a=null;this.Sif=this.j$c=!1;this.loc=v;this.ecd=B;this.B8c=ma;this.ung=Pa;this.QZ=mb;this.ga=a;this.Bkc=X;this.Zpg=vd;this.B7c=Ie;this.O4a=h;this.P4a=Tb;this.vng=rc;this.wng=Xe;(this.EP=Tc)&&this.EP.isFeatureEnabled("MsoPremiumStockImages",!1).catch(Yf=>r.ULS.sendTraceTag(577249666,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",Yf)).then(Yf=>{(this.j$c=Yf)||
this.EP.vBa("MsoPremiumStockImages",()=>{this.j$c=!0;r.ULS.sendTraceTag(577249667,352,50,"InsertMediaActor::Constructor - License state changed to premium")});return null})}eb(){(this.O4a.Hjf||this.O4a.dTh)&&this.O4a.VMl&&this.RDm();this.FSm();this.ESm();this.ga.Aa(zb.a.J0g,ic.a.view,Object(m.a)(this,this.UHi,"showInsertPictureFromHostDialog"),1284);this.ga.Aa(zb.a.Wki,ic.a.view,Object(m.a)(this,this.BNn,"updateEntryPointsForChangePictureHostButton"),1124);this.ga.Aa(zb.a.ugf,ic.a.view,Object(m.a)(this,
this.UHi,"showInsertPictureFromHostDialog"),1284);this.ga.Aa(zb.a.MGf,ic.a.view,Object(m.a)(this,this.yNn,"updateEntryPoints"),1124);this.ga.Aa(zb.a.rDl,ic.a.view,Object(m.a)(this,this.Arn,"showInsertOneDriveFileDialog"),1284)}FSm(){this.ga.Aa(zb.a.insertOnlinePicture,ic.a.view,Object(m.a)(this,this.i2d,"showInsertPictureFromSearchDialog"),1284);this.ga.Aa(zb.a.KGd,ic.a.view,Object(m.a)(this,this.e2d,"showInsertM365PictureFromSearchDialog"),1284);this.ga.Q9("word_insertOnlinePictures",zb.a.insertOnlinePicture,
ic.a.view,Object(m.a)(this,this.i2d,"showInsertPictureFromSearchDialog"),a=>{Eb.App.oa.LIb(a,Object(m.a)(new Th.a,(new Th.a).rab,"getCommandById"))});this.ga.Q9("word_insertOnlinePictures",zb.a.KGd,ic.a.view,Object(m.a)(this,this.e2d,"showInsertM365PictureFromSearchDialog"),a=>{Eb.App.oa.LIb(a,Object(m.a)(new Th.a,(new Th.a).rab,"getCommandById"))});this.ga.Aa(zb.a.dPe,ic.a.view,Object(m.a)(this,this.i2d,"showInsertPictureFromSearchDialog"),1284);this.ga.Aa(zb.a.fPe,ic.a.view,Object(m.a)(this,this.j2d,
"showInsertPictureFromSharedPicker"),1284);this.ga.Q9("word_insertOnlinePictures",zb.a.fPe,ic.a.view,Object(m.a)(this,this.j2d,"showInsertPictureFromSharedPicker"));this.ga.Aa(zb.a.gPe,ic.a.view,Object(m.a)(this,this.e2d,"showInsertM365PictureFromSearchDialog"),1284);this.ga.Aa(zb.a.Uki,ic.a.view,Object(m.a)(this,this.zNn,"updateEntryPointsForChangePictureFromBingPicture"),1284);this.ga.Aa(zb.a.Vki,ic.a.view,Object(m.a)(this,this.ANn,"updateEntryPointsForChangePictureFromOnlineM365Picture"),1284);
this.ga.Q9("word_insertOnlinePictures",zb.a.dPe,ic.a.view,Object(m.a)(this,this.i2d,"showInsertPictureFromSearchDialog"));this.ga.Q9("word_insertOnlinePictures",zb.a.gPe,ic.a.view,Object(m.a)(this,this.e2d,"showInsertM365PictureFromSearchDialog"));this.ga.Aa(zb.a.wgf,ic.a.view,Object(m.a)(this,this.j2d,"showInsertPictureFromSharedPicker"),1284);this.ga.Q9("word_insertOnlinePictures",zb.a.wgf,ic.a.view,Object(m.a)(this,this.j2d,"showInsertPictureFromSharedPicker"),a=>{Eb.App.oa.LIb(a,Object(m.a)(new Th.a,
(new Th.a).rab,"getCommandById"))})}ESm(){l.AFrameworkApplication.Jjf()&&(this.ga.Aa(zb.a.zgf,ic.a.view,Object(m.a)(this,this.h2d,"showInsertPictureFromMobileDevice"),1284),this.ga.Aa(zb.a.ePe,ic.a.view,Object(m.a)(this,this.h2d,"showInsertPictureFromMobileDevice"),1284),this.ga.Q9("mso_insertMobileDevicePictures",zb.a.zgf,ic.a.view,Object(m.a)(this,this.h2d,"showInsertPictureFromMobileDevice"),a=>{Eb.App.oa.LIb(a,Object(m.a)(new Th.a,(new Th.a).rab,"getCommandById"))}),this.ga.Q9("mso_insertMobileDevicePictures",
zb.a.ePe,ic.a.view,Object(m.a)(this,this.h2d,"showInsertPictureFromMobileDevice"),a=>{Eb.App.oa.LIb(a,Object(m.a)(new Th.a,(new Th.a).rab,"getCommandById"))}))}RDm(){l.AFrameworkApplication.na.get_element().appendChild(this.ecd.aVa);Ld.a.addHandler(this.ecd.aVa.contentWindow,"message",Object(m.a)(this,this.gIi,"showOneDriveFilePickerDialog"));this.Sif=!0}gIi(a){if(a.rawEvent&&(a=a.rawEvent.data))try{const c=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0),h=c.MessageId?c.MessageId.toString():
null;c&&h&&(h===E.a.insertImage||h===E.a.igf)&&this.loc.start(h===E.a.insertImage?this.P4a:this.vng)}catch(c){}}yNn(a,c,h,v,B){if(1===h)return 32;this.Zpg?a=CommonUIStrings.l_OneDriveName:""!==this.B7c?a=this.B7c:(a=CommonUIStrings.l_HostGeneric,r.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));B[Jj.a.LabelText]=a;return 32}BNn(a,c,h,v,B){if(1===h)return 32;if(!l.AFrameworkApplication.Ijf())return B[Jj.a.Visible]=!1,32;this.Zpg?
a=String.format(CommonUIStrings.l_ChangePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.B7c?a=String.format(CommonUIStrings.l_ChangePictureFromHost,this.B7c):(a=CommonUIStrings.l_ChangePictureFromHostGeneric,r.ULS.sendTraceTag(577835747,352,15,"InsertMediaActor::UpdateEntryPointsForChangePictureHostButton : Do not have host name, use generic name instead."));B[Jj.a.LabelText]=a;return 32}zNn(a,c,h,v,B){if(1===h)return 32;l.AFrameworkApplication.K.$("InsertOnlinePictureEnabled")||(B[Jj.a.Visible]=
!1);return 32}ANn(a,c,h,v,B){if(1===h)return 32;l.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled")||(B[Jj.a.Visible]=!1);return 32}i2d(a,c,h){c=this.Bkc.value.tha(c);if(1===h)return c&&this.O4a.UMl?32:8;if(2!==h||!c)return 8;this.i3a=Ya.a.create();r.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");a=this.f4k(a,this.i3a);a=this.B8c.RDc(a);a.correlationId=this.i3a;a.w1b=this.wng;a.rda=1;return this.g2d(a,CommonUIStrings.L_PictureInsertTitle,
this.P4a)}f4k(a,c){let h=0;l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya&&5===l.AFrameworkApplication.na.Ya.Rm&&(h=12);const v=vi.a.af(l.AFrameworkApplication.lcid);return String.format(l.AFrameworkApplication.K.appSettings.WordInsertPictureServiceEndpoint,a===zb.a.insertOnlinePicture?1:0,l.AFrameworkApplication.lcid,v?v.name:"en-us",l.AFrameworkApplication.buildVersion,c,h,l.AFrameworkApplication.K.Ga("UserId"))}Arn(a,c,h){a=32===this.ga.Le(c,zb.a.insertHyperlink,1,!1,null,null);if(1===
h)return a&&this.O4a.dTh?32:8;if(2!==h||!a)return 8;r.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");return this.g2d(this.ung.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.vng)}UHi(a,c,h){a=this.Bkc.value.tha(c);if(1===h)return a&&this.O4a.Hjf?32:8;if(2!==h||!a)return 8;r.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog.");return this.g2d(this.ung.getInstance(),
CommonUIStrings.L_PictureInsertTitle,this.P4a)}g2d(a,c,h){try{return a.f2d(c,h),r.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(v){return r.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",v.toString()),this.fo(Qk.a.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}}e2d(a,c,h){c=this.Bkc.value.tha(c);if(1===h)return c&&
this.O4a.WMl?32:8;if(2!==h||!c)return 8;r.ULS.sendTraceTag(587532180,352,50,"InsertMediaActor::ShowInsertM365PictureFromSearchDialog : Show dialog.");this.i3a=Ya.a.create();h=l.AFrameworkApplication.K.$("StockImagesFreemiumExperienceIsEnabled")&&this.EP.isFreemiumUpsellEnabled();h=this.j$c?1:h?0:-1;a=this.z6k(a,this.i3a,h);a=this.B8c.RDc(a);a.vf=tG.vf;a.correlationId=this.i3a;a.rda=2;a.w1b=this.wng;a.ZGa=this.EP;a.mXi=h;return this.g2d(a,CommonUIStrings.L_PictureInsertTitle,this.P4a)}z6k(a,c,h){return zb.a.KGd===
a?this.QZ.TXg(l.AFrameworkApplication.K.Ga("InsertOnlineM365PictureEndpoint"),c.toString(),1,h):this.QZ.TXg(l.AFrameworkApplication.K.Ga("InsertOnlineM365PictureEndpoint"),c.toString(),0,h)}fo(a,c,h){const v=new oe.StandardDialog(!0);v.Zr=l.AFrameworkApplication.L8;v.yc=0;v.Nd(1,CommonUIStrings.l_DialogClose);v.Fw(a,c,h,()=>{})}j2d(a,c,h){c=this.Bkc.value.tha(c);a=xa.a.instance.ra("Common.App.SharedFilePicker.ISharedFilePicker");if(1===h)return c&&!this.O4a.Hjf&&a&&a.Slf()?32:8;if(2!==h||!c||!a)return 8;
r.ULS.sendTraceTag(553734720,352,50,"InsertMediaActor::showInsertPictureFromSharedPicker : Show dialog.");this.i3a=Ya.a.create();h=gE.NKg;c=!1;l.AFrameworkApplication.Jjf()&&(c=this.eQk());const v=new sG;v.ITb=c;v.j1b=!0;h=a.STe(CommonUIStrings.L_ImageUploadButtonText,"Select Images",!0,!1,!0,h,"Insert Media",1,v);a.z7e(h).then(B=>{if(null!=B&&0<B.length){const X=[];for(let ma=0;ma<B.length;ma++){const Pa=B[ma][L.a.Ihi],mb=B[ma][L.a.Hhi],Tb={};Tb.Extension=Pa;Tb.OriginalUrl=mb;Tb.caption=Pa;X.push(Tb)}this.P4a.MJa=
zb.a.F_;this.P4a.fXa(X)}});return 32}eQk(){const a=xa.a.instance.ra("Common.App.PhoneLink.IPhoneLinkManager");return null!=a?a.TTk():!1}h2d(a,c,h){c=this.Bkc.value.tha(c);a=xa.a.instance.ra("Common.App.SharedFilePicker.ISharedFilePicker");if(1===h)return c&&a&&a.Slf()?32:8;if(2!==h||!c||!a)return 8;h=xa.a.instance.ra("Common.App.PhoneLink.IPhoneLinkManager");null!=h&&h.yGk(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));
r.ULS.sendTraceTag(526951881,352,50,"InsertMediaActor::showInsertPictureFromMobileDevice : Show dialog.");this.i3a=Ya.a.create();h=gE.NKg;c=new sG;c.ITb=!0;c.j1b=!0;h=a.STe(CommonUIStrings.L_ImageUploadButtonText,CommonUIStrings.L_ImageUploadingTitle,!0,!1,!0,h,"InsertPictureFromMobile",3,c);a.z7e(h).then(v=>{if(null!=v&&0<v.length){const B=[];for(let X=0;X<v.length;X++){const ma=v[X][L.a.Ihi],Pa=v[X][L.a.Hhi],mb={};mb.Extension=ma;mb.OriginalUrl=Pa;mb.caption=ma;B.push(mb)}this.P4a.MJa=zb.a.F_;this.P4a.fXa(B)}});
return 32}dispose(){this.Sif&&this.ecd.aVa.contentWindow&&(Ld.a.removeHandler(this.ecd.aVa.contentWindow,"message",Object(m.a)(this,this.gIi,"showOneDriveFilePickerDialog")),this.Sif=!1)}}gE.NKg=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(w.a)(gE,"InsertMediaActor",null,[14]);var YC=b(849);class uI extends YC.a{constructor(a,c){super(a,Af.a.u8(c))}rq(a,c){this.isEnabled()&&this.JSa(this.L0a)&&(this.uu(a),this.pA(a,c))}}Object(w.a)(uI,"InsertMediaCrossDocumentMessenger",YC.a,[522,59,14]);
class vI{getInstance(a,c){return new uI(a,c)}}Object(w.a)(vI,"InsertMediaCrossDocumentMessengerFactory",null,[491]);var oP=b(926);class UE{}UE.vf="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(w.a)(UE,"InsertMediaDialogHtml",null,[]);var ZC;(function(a){a[a.OK=0]="OK";a[a.cancel=1]="cancel";a[a.error=2]="error";a[a.open=3]="open"})(ZC||
(ZC={}));Object(w.b)("HubbleAction",ZC);var qB;(function(a){a[a.unknown=0]="unknown";a[a.bing=1]="bing";a[a.M365=2]="M365";a[a.icons=3]="icons";a[a.oneDrive=4]="oneDrive";a[a.hubble=5]="hubble"})(qB||(qB={}));Object(w.b)("InsertMediaProviders",qB);class VE extends gg.a{constructor(a,c,h,v=null,B=!1){super(!1,!1,B);this.UE=null;this.Tic=!1;this.AMc=this.ZX=null;this.YNe="KeepFocusDiv";this.Snd="KeepFocusStartDiv";this.correlationId=null;this.rda=0;this.ZGa=this.w1b=null;this.mXi=0;this.fre=null;if(!a)throw Error.argumentNull("insertMediaSeviceEndpoint",
"insertMediaSeviceEndpoint cannot be null.");this.C8c=a;this.YLb="";this.QZ=h;this.Saa=[];this.pdd=c;this.vf=v||UE.vf;this.jf="InsertMediaDialog"}get telemetryEventName(){return"InsertM365Images"}f2d(a,c){this.YLb=a;this.Tic=!1;this.showDialog(this.YLb,null);this.ZX=this.EZb(this.hi("insertmediaframe"));if(!this.ZX)throw this.Mvb(this.oTa),Error.invalidOperation("Couldn't get InsertMediaIframe.");a=document.createElement("div");a.setAttribute("Id",this.Snd);a.setAttribute("tabindex","0");a.setAttribute("position",
"absolute");a.setAttribute("width","-1000px");a.setAttribute("top","-1000px");this.ZX.parentNode.insertBefore(a,this.ZX.parentNode.firstChild);a=document.createElement("div");a.setAttribute("Id",this.YNe);a.setAttribute("tabindex","0");this.ZX.parentNode.appendChild(a);a.setAttribute("position","absolute");a.setAttribute("width","-1000px");a.setAttribute("top","10000px");$addHandler(this.wXe,"keydown",Object(m.a)(this,this.f9,"keyDownHandler"));this.ZX.src=this.C8c;this.ZX.style.width="100%";this.ZX.style.height=
"100%";this.ZX.frameBorder="0";l.AFrameworkApplication.K.$("ShowInsertMediaIframeWhenIframeIsReady")&&H.a.Qh?(this.ZX.style.visibility="hidden",this.AMc=Object(m.a)(this,this.Zom,"onInsertMediaIframeLoaded"),Ld.a.addHandler(this.ZX,"load",this.AMc)):this.ZX.style.visibility="visible";this.EZb(this.hi("WACDialogButtonPanel")).style.display="none";this.EZb(this.hi("WACDialogTitleText")).style.display="none";2===this.rda&&(this.EZb(this.hi("WACDialogTitlePanel")).style.display="none",this.EZb(this.hi("WACDialogBodyPanel")).style.padding=
"0");nc.FocusManager.instance().gk().scope.rK=!0;this.UE=this.pdd.getInstance(this.ZX.contentWindow,this.C8c);this.UE.rq(E.a.TNg,h=>{this.D9h(h,Object(m.a)(c,c.fXa,"insertMediaCallback"))});this.UE.rq(E.a.insert,h=>{this.kRd(h,Object(m.a)(c,c.fXa,"insertMediaCallback"))});this.UE.rq(E.a.BEj,h=>{this.pqm(h)});this.UE.rq(E.a.qth,Object(m.a)(this,this.yai,"onGetCustomHeaders"));this.UE.rq(E.a.getSessionId,Object(m.a)(this,this.Bai,"onGetSessionId"));this.UE.rq(E.a.drh,Object(m.a)(this,this.xai,"onGetCID"));
this.UE.rq(E.a.kod,Object(m.a)(this,this.l$h,"onCancelDialog"));2!==this.rda||this.mXi||(this.UE.rq(E.a.YXl,Object(m.a)(this,this.tpm,"onLaunchM365Upsell")),this.fre=this.ZGa.vBa("MsoPremiumStockImages",h=>{r.ULS.sendTraceTag(577249664,352,50,"OnCompleteM365Upsell: upsell completed from stock images");this.UE.Qg(E.a.xSn,{["LicenseTier"]:h.toString()})}));this.Rgb(3)}Zom(){this.ZX&&(this.ZX.style.visibility="visible",window.setTimeout(()=>{if(this.zj){const a=this.zj.getElementById(this.Snd);a&&a.focus()}},
0))}f9(a){a.keyCode===Sys.UI.Key.tab&&(a.target.id!==this.YNe||a.shiftKey?a.target.id===this.Snd&&a.shiftKey&&(a.preventDefault(),this.zj.getElementById(this.YNe).focus()):(a.preventDefault(),this.zj.getElementById(this.Snd).focus()))}dispose(){this.ZGa&&this.fre&&this.ZGa.R8b("MsoPremiumStockImages",this.fre);this.UE&&(this.UE.dispose(),this.UE=null);this.AMc&&(Ld.a.removeHandler(this.ZX,"load",this.AMc),this.AMc=null);super.dispose()}D9h(a,c){r.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");
if(a=this.QZ.kzm(a))this.Saa.push(a),this.Tic&&(c(this.Saa),this.Tic=!1)}fo(){const a=new oe.StandardDialog(!0);a.Zr=l.AFrameworkApplication.L8;a.yc=0;a.Nd(1,CommonUIStrings.l_DialogOk);a.mv(CommonUIStrings.l_ImageUploadFailedTitle,CommonUIStrings.l_InsertPictureMaxLimitExceeded,2,()=>{})}l$h(){r.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.Mvb(this.oTa);this.Rgb(1)}Rgb(a){var c=RegExp("hubble","gi");if(this.w1b&&0<this.w1b.search(c)&&this.correlationId){c=l.AFrameworkApplication.sessionStartInfoSettings;
var h={};h.InsertedFiles=this.Saa.length;h.MediaDetails=this.Saa;h.DialogResult=ZC[a];h.DialogMode=this.Z8e();h.CorrelationId="{"+this.correlationId.toString()+"}";h.Platform="Wac";h.Provider=qB[this.rda]||"Unknown";h.AudienceGroup=c&&"AudienceGroup"in c?c.AudienceGroup.toString():"Unknown";h.Ring=c&&"Ring"in c?c.Ring.toString():"Unknown";h.AppId=2;h.Build=l.AFrameworkApplication.buildVersion;h.Locale=vi.a.af(l.AFrameworkApplication.lcid).name;this.WDm().send(JSON.stringify(h))}2===this.rda&&(h=l.AFrameworkApplication.K.Ga("InsertMediaDialogAriaTenantNameSpace"))&&
""!==h&&(c=[],Array.add(c,Object.assign(new aa.a,{name:"InsertedFiles",int64:this.Saa.length})),Array.add(c,Object.assign(new aa.a,{name:"MediaDetails",string:JSON.stringify(this.Saa)})),Array.add(c,Object.assign(new aa.a,{name:"DialogResult",string:ZC[a]})),Array.add(c,Object.assign(new aa.a,{name:"DialogMode",string:this.Z8e()})),Array.add(c,Object.assign(new aa.a,{name:"CorrelationId",string:this.correlationId.toString()})),Array.add(c,Object.assign(new aa.a,{name:"Provider",string:qB[this.rda]||
"Unknown"})),Z.a.sendTelemetryEvent(Object.assign(new ja.a,{name:String.format("{0}.{1}",h,this.telemetryEventName),dataFields:c})))}Z8e(){return 3===this.rda?"Icons":5===this.rda?"ExternalContent":"Images"}EZb(a){const c=document.getElementById(a);if(!c)throw Error.invalidOperation(String.format("Couldn't get {0}.",a));return c}WDm(){const a=new XMLHttpRequest;a.open("POST",this.w1b,!0);a.setRequestHeader("Content-Type","");return a}kRd(a,c){r.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");
this.Mvb(this.oTa);c?this.Saa&&50<this.Saa.length?(this.fo(),this.Rgb(0),r.ULS.sendTraceTag(578140104,352,10,"InsertMediaDialog: User tried to insert {0} images using {1}",this.Saa.length,qB[this.rda])):this.Saa&&0<this.Saa.length?(c(this.Saa),this.Rgb(0),r.ULS.sendTraceTag(578140105,352,50,"InsertMediaDialog: User inserted {0} images using {1}",this.Saa.length,qB[this.rda])):(r.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.Tic=!0,c(this.Saa),this.Rgb(2)):this.Rgb(2)}yai(){this.UE&&
(r.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.UE.Qg(E.a.adn,{["CustomHeaders"]:""}))}Bai(){this.UE&&(r.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.UE.Qg(E.a.Tin,{["SessionId"]:l.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}xai(){this.UE&&(r.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.UE.Qg(E.a.gcn,{["CID"]:""}))}pqm(a){a&&a.Values&&(a=a.Values,delete a.m_Origin,delete a.m_Source,delete a.m_ReceivedTime,
r.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+a.eventName||!1),Z.a.sendOtelEvent(Object.assign(new oP.a,{otelEvent:a})))}tpm(){this.ZGa&&(r.ULS.sendTraceTag(577249665,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.ZGa.launchUpsellExperience("stockimages"))}}Object(w.a)(VE,"InsertMediaDialog",gg.a,[490,14]);class wI{constructor(a,c){this.zme=a;this.QZ=c}RDc(a,c=!1){return new VE(a,this.zme,this.QZ,UE.vf,c)}getInstance(){throw Error.notImplemented();
}}Object(w.a)(wI,"InsertMediaDialogFactory",null,[489]);class xI{constructor(a,c,h){this.iQh=!1;this.correlationId=null;this.rda=0;this.w1b=null;this.chj=a;this.Isc=[];this.C7c=c;this.yHg=h.split(";")}f2d(a,c){Array.clear(this.Isc);a=this.chj.value;a.JSa(this.C7c);a.uu(c.wGc);this.iQh||(a.pA(c.wGc,h=>{this.kRd(h,c)}),this.iQh=!0);r.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");a.Qg(c.cah,{["FileExtensionFilterList"]:this.yHg})}EGj(a){Array.contains(this.Isc,
a)||this.Isc.push(a)}kRd(a,c){r.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");a=c.Cgi(a);const h=[];for(let v=0;v<a.length;v++){const B=a[v];c.rId(B,this.yHg)?h.push(B):this.EGj(c.PBh(B))}h&&h.length?c.fXa(h):r.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.Isc.length&&(c=this.Isc.join(", "),r.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",
c),this.Vsn(c))}Vsn(a){const c=new oe.StandardDialog;c.yc=0;c.vS(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,a),null)}dispose(){}}Object(w.a)(xI,"InsertMediaFromHostManager",null,[490,14]);class yI{constructor(a){this.eij=a}RDc(){throw Error.notImplemented();}getInstance(){return this.eij}}Object(w.a)(yI,"InsertMediaFromHostManagerFactory",null,[488,489]);class zI{constructor(){this.aVa=document.createElement("iframe");this.aVa.src="about:blank";
this.aVa.style.visibility="hidden";this.aVa.style.position="absolute";this.aVa.style.zIndex="-100"}}Object(w.a)(zI,"InsertMediaFromHostOneDriveHostFrame",null,[487]);class AI extends YC.a{constructor(a,c){super(a,"*"===c?c:Af.a.u8(c));this.XMg(E.a.insertImage);this.XMg(E.a.igf)}LYd(){}}Object(w.a)(AI,"InsertMediaFromOneDriveCrossDocumentMessenger",YC.a,[58,59,14]);class WE{}Object(w.a)(WE,"OnlineMediaSearchResult",null,[]);class $C{TXg(a,c,h,v){const B=vi.a.af(l.AFrameworkApplication.lcid).name,X=
l.AFrameworkApplication.buildVersion,ma=F.a.oU(l.AFrameworkApplication.K.Ga("UserId")).toString();if(-1!==a.indexOf("exp=")){const Pa=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertOnlineM365ExperimentEnabled",!1)?1:0;l.AFrameworkApplication.Mg("ShIns226;ShIns226cf");return String.format(a,l.AFrameworkApplication.lcid,B,X,c,$C.z$d,ma,v,h,Pa)}return String.format(a,l.AFrameworkApplication.lcid,B,X,c,$C.z$d,ma,v,h)}kzm(a){if(!a||!a.Values)return null;a=a.Values;
if(!a)return null;let c="";"sourceProvider"in a&&(c=a.sourceProvider||"");return Object.assign(new WE,{Action:a.action||"",Caption:a.caption||"",ContentType:a.contenttype||"",Type:a.extension||"",PageUrl:a.pageUrl||"",OriginalUrl:a.sourceUrl||"",ContentProvider:c,ThumbnailUrl:a.thumbnailUrl||"",LicenseUrl:a.licenseUrl||"",LicenseDisplayName:a.licenseDisplayName||"",Height:a.height||0,Width:a.width||0,SvgContent:a.svgContent||"",Html:a.html||""})}lzm(a){const c=[];if(!a||!a.Values||!a.Values.Items)return c;
a=a.Values.Items;for(let v=0;v<a.length;v++){var h=a[v];h&&(h=Object.assign(new WE,{Type:h.Extension||"",OriginalUrl:h.SourceUrl||"",Caption:h.caption,Height:h.Height||0,Width:h.Width||0}),c.push(h))}return c}OCf(a){const c=[];for(let v=0;v<a.data.files.length;v++){var h=a.data.files[v];h&&(h=Object.assign(new WE,{ContentType:h.itemType||"",Type:h.extension||"",OriginalUrl:h.urls&&h.urls.open?h.urls.open:"",Height:h.photo?h.photo.height:0,Width:h.photo?h.photo.width:0}),c.push(h))}return c}rId(a,
c){if(!a)return!1;for(let h=0;h<c.length;h++)if(0<=a.toLowerCase().indexOf(c[h]))return!0;return!1}NDm(a){let c="";if(a)for(let h=0;h<a.length;h++){const v=a[h];v&&(c+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',v.OriginalUrl,v.Width,v.Height))}return c}}$C.z$d=0;Object(w.a)($C,"InsertMediaHelper",null,[486]);class BI{constructor(a,c,h,v,B){this.UMl=a;this.Hjf=c;this.dTh=h;this.VMl=v;this.WMl=B}}Object(w.a)(BI,"InsertMediaSettingsManager",null,[]);class uG{constructor(a){this.Lkc=
zb.a.insertHyperlink;this.ga=a}get MJa(){return this.Lkc}set MJa(a){this.Lkc=a}fXa(a){try{r.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",a.length);for(let c=0;c<a.length;c++)this.ga.hb(this.MJa,2,a[c]);r.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",a.length)}catch(c){r.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",c.toString())}}}
Object(w.a)(uG,"InsertOneDriveFileHandler",null,[363]);class CI extends uG{constructor(a){super(a)}get cah(){return E.a.igf}get wGc(){return E.a.NCl}Cgi(a){return a&&a.Values&&"Items"in a.Values?a.Values.Items:null}PBh(){Sd.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""}rId(){return!0}jki(a,c,h){a=h(a);a.length&&(h={},h.Items=a,c.Qg(this.wGc,h))}Egi(a){const c=[];for(let h=0;h<a.data.files.length;h++){const v=a.data.files[h];
if(v){const B={};B.DisplayText=String.format("{0}{1}",v.name,v.extension);B.Url=this.jKk([v.urls.viewInBrowser,v.urls.open,v.urls.download]);c.push(B)}}return c}jKk(a){for(let c=0;c<a.length;c++)if(a[c]&&""!==a[c])return a[c];r.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid");return""}}Object(w.a)(CI,"InsertOneDriveFileHelper",uG,[362,363]);class vG{constructor(a,c,h){this.Lkc=zb.a.F_;this.yj=null;this.ga=a;this.QZ=c;this.i_=h}get Eb(){return this.ga}get Xu(){return this.yj||
(this.yj=xa.a.instance.resolve("Common.Utils.IAriaNotifier"))}get MJa(){return this.Lkc}set MJa(a){this.Lkc=a}fXa(a){try{r.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",a.length);const c=this.QZ.NDm(a);let h=2;if(c&&0<c.length){const v=new uh.DictionaryPropertySet;v.setValue(Uc.a.jS,c);v.setValue(Uc.a.Q8,!0);if(this.i_){const B=this.i_.gXc();B.UTb("insertOnlineImage");v.setValue(Uc.a.bpa,B)}h=this.ga.hb(this.MJa,2,v)}r.ULS.sendTraceTag(21612224,
352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",a.length,32===h,""===c)}catch(c){r.ULS.o1(21612225,352,10,c,"InsertImageFromHostHelper::InsertMediaCallback : Exception")}}}Object(w.a)(vG,"InsertOnlineImageHandler",null,[363]);class XE extends vG{constructor(a,c,h=null){super(a,c,h)}get cah(){return E.a.insertImage}get wGc(){return E.a.aDl}Cgi(a){return this.QZ.lzm(a)}PBh(a){return a.Type}rId(a,c){return this.QZ.rId(a.Type,c)}Egi(a){return this.QZ.OCf(a)}jki(a,
c,h){h=h(a);if(h.length){a=[];for(let v=0;v<h.length;v++){const B=h[v],X={};X.Extension=B.Type;X.SourceUrl=B.OriginalUrl;X.caption=B.Type;X.SourceUrl=B.OriginalUrl;X.Width=B.Width;X.Height=B.Height;a.push(X)}h={};h.Items=a;c.Qg(this.wGc,h)}}}Object(w.a)(XE,"InsertOnlineImageHelper",vG,[362,363]);class DI{constructor(a,c){this.$lb=a;this.pdd=c}start(a){this.$lb.start({mode:"open",select:"multi",lightbox:"white"},(c,h)=>{this.IFf(c,h,a)})}IFf(a,c,h){r.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",
a);a&&c&&c.data&&c.data.files&&0<c.data.files.length?(a=this.pdd.getInstance(window.frames[0].parent,window.document.URL),h.jki(c,a,Object(m.a)(h,h.Egi,"parseOneDriveV5Response"))):r.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}}Object(w.a)(DI,"OneDriveFilePickerHelperV5",null,[361]);class EI{constructor(){this.A8c=this.W=null}get name(){return"Box4.Media"}yb(a){this.W=a;a.ha("Box4.Media.InsertMediaFromHostOneDriveHostFrame",
()=>new zI).as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").singleInstance();const c=new BI(Boolean.parse(l.AFrameworkApplication.K.appSettings.InsertOnlinePictureEnabled||"false"),l.AFrameworkApplication.Ijf(),!1,l.AFrameworkApplication.LSf(),l.AFrameworkApplication.K.$("InsertPictureUsingStockImagesIsEnabled"));a.ha("Box4.Media.OneDriveFilePickerHelperV5",()=>new DI(a.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5"),a.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"))).as("Box4.Media.IOneDriveFilePickerHelper").singleInstance();
a.ha("Box4.Media.InsertMediaActor",()=>new gE(l.AFrameworkApplication.pa,l.AFrameworkApplication.K,c,a.resolve("Box4.Media.IOneDriveFilePickerHelper"),a.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),new qf.a(()=>xa.a.instance.resolve("Box4.Images.IImageEditor")),a.resolve("Box4.Media.IInsertMediaDialogFactory"),a.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),a.resolve("Box4.Media.InsertMediaHelper"),a.resolve("Box4.Media.InsertOnlineImageHelper"),a.resolve("Box4.Media.InsertOneDriveFileHelper"),
a.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),l.AFrameworkApplication.y3b,l.AFrameworkApplication.yra,l.AFrameworkApplication.Jvl,l.AFrameworkApplication.K.appSettings.InsertPictureTelemetryEndpoint)).singleInstance();a.ha("Box4.Media.InsertMediaDialogFactory",()=>new wI(a.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),a.resolve("Box4.Media.InsertMediaHelper"))).as("Box4.Media.IInsertMediaDialogFactory").singleInstance();a.ha("Box4.Media.InsertMediaFromHostManagerFactory",
()=>new yI(a.resolve("Box4.Media.InsertMediaFromHostManager"))).as("Box4.Media.IInsertMediaFromHostManagerFactory").singleInstance();a.ha("Box4.Media.InsertMediaFromHostManager",()=>new xI(new qf.a(()=>{if(l.AFrameworkApplication.LSf()){var h=xa.a.instance.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").aVa;h=new AI(h.contentWindow,"*")}else h=l.AFrameworkApplication.VU;return h}),l.AFrameworkApplication.LSf()?Af.a.u8(window.document.URL):Af.a.u8(l.AFrameworkApplication.MDb),l.AFrameworkApplication.K.appSettings.ImageFetcherSupportedExtensions)).singleInstance();
a.register(vI,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").singleInstance();a.register($C,"Box4.Media.InsertMediaHelper").singleInstance();a.ha("Box4.Media.InsertOnlineImageHelper",()=>new XE(l.AFrameworkApplication.pa,a.resolve("Box4.Media.InsertMediaHelper"),a.resolve("Common.Utils.Telemetry.ITelemetry"))).singleInstance();a.ha("Box4.Media.InsertOneDriveFileHelper",()=>new CI(l.AFrameworkApplication.pa)).singleInstance()}init(){this.A8c=
this.W.resolve("Box4.Media.InsertMediaActor");this.A8c.eb()}dispose(){this.A8c&&this.A8c.dispose()}}Object(w.a)(EI,"MediaPackage",null,[1,2]);var wG=b(265);class dv{constructor(){this.o5m="getAddinShortcutsPreference";this.p5m="saveAddinShortcutsPreference";this.q5m="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.GQk=6E4;this.APd=this.Tha=this.x5=null}Z_a(){dv.uFi||"undefined"===typeof OSF||(dv.Z_a=OSF.OUtil.checkFlight(23),dv.uFi=!0);return dv.Z_a}UBh(a){return String.format(this.q5m,l.AFrameworkApplication.K.appSettings.RoamingServiceHandlerWebServiceBase||
"",a,l.AFrameworkApplication.kl)}executeRequest(a,c,h,v,B=null){return dv.Aha.Ttc(a,c,B,null,h,v,!1,null,this.GQk)}saveSetting(a,c,h,v,B){if(this.Z_a())return this.bxi(a,c,h,null,v,B);const X=this.qac(),ma={};ma.action=h;ma.addinId=c;ma.ownerType=a;ma.timestamp=(new Date).toUTCString();a={};a[v.toString()]=ma;v=new wG.a(B.toString(),a);return X?this.cxi(v):this.dxi(v)}startBatchUpdateScope(){this.APd=[]}saveShortcutInfoArrayBatch(a,c,h){this.r7m(h,a,c)}r7m(a,c,h){const v={action:"",addinId:"",ownerType:0};
v.timestamp=(new Date).toUTCString();const B=this.getShortcutInfoArray(c.toString(),h.toString());a?(v.shortcutInfoArray=a,this.hHe(c,h,a)):B&&(v.shortcutInfoArray=B);a={};a[c.toString()]=v;c=new wG.a(h.toString(),a);this.APd.push(c)}commitBatchUpdateScope(){return this.qac()?this.s7m().then(()=>{this.PUb();return Promise.resolve(!0)}):this.t7m().then(()=>{this.PUb();return Promise.resolve(!0)})}s7m(){return this.getSetting().then(a=>{let c=null;if(a&&!({dv:c}=z.d(a)).returnValue)return r.ULS.sendTraceTag(0,
0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);c||(c={});for(const h of this.APd){(a=c[h.key])||(a={});const v=h.value;for(const B of Za.a.rM(v))a[B]=v[B];c[h.key]=a}this.x5=c;try{return localStorage.setItem("AddinShortcutPreferenceData",z.c(c)),Promise.resolve(!0)}catch(h){return r.ULS.sendTraceTag(0,0,10,"SaveSettingToLocalStorageBatch failed",h),Promise.resolve(!1)}})}t7m(){return this.Xan().then(a=>this.VZd(a))}Xan(){return this.U$e().then(a=>
{let c=null;a&&(({dv:c}=z.d(a)).returnValue||r.ULS.sendTraceTag(0,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));c||(c={});for(const h of this.APd){(a=c[h.key])||(a={});const v=h.value;for(const B of Za.a.rM(v))a[B]=v[B];c[h.key]=a}this.x5=c;return z.c(c)})}saveShortcutInfoArray(a,c,h){return this.bxi(0,"","",h,a,c)}bxi(a,c,h,v,B,X){const ma=this.qac(),Pa={};Pa.action=h;Pa.addinId=c;Pa.ownerType=a;Pa.timestamp=(new Date).toUTCString();c=
this.getShortcutInfoArray(B.toString(),X.toString());0===a&&v?(Pa.shortcutInfoArray=v,this.hHe(B,X,v)):c&&(Pa.shortcutInfoArray=c);a={};a[B.toString()]=Pa;B=new wG.a(X.toString(),a);return ma?this.cxi(B):this.dxi(B)}cxi(a){return this.getSetting().then(c=>{let h=null;if(c&&!({dv:h}=z.d(c)).returnValue)return r.ULS.sendTraceTag(0,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);h||(h={});h[a.key]=a.value;this.x5=h;try{return localStorage.setItem("AddinShortcutPreferenceData",
z.c(h)),Promise.resolve(!0)}catch(v){return r.ULS.sendTraceTag(0,0,10,"SaveSettingToLocalStorage failed",v),Promise.resolve(!1)}})}dxi(a){return this.Wan(a).then(c=>this.VZd(c))}Wan(a){return this.U$e().then(c=>{let h=null;c&&(({dv:h}=z.d(c)).returnValue||r.ULS.sendTraceTag(0,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));h||(h={});h[a.key]=a.value;this.x5=h;return z.c(h)})}saveSettings(a){this.x5=z.a(a);this.Z_a()&&this.PUb();return this.qac()?
this.gxi(a):this.VZd(a)}gxi(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(c){return r.ULS.sendTraceTag(0,0,10,"SaveSettingToLocalStorage failed",c),Promise.resolve(!1)}}VZd(a){const c={};c.Wac=a;const h=z.c(c);return new Promise(v=>{try{if(void 0===h||null===h||!h.length||1E6<=h.length)v(!1);else{var B=this.executeRequest(this.UBh(this.p5m),2,"SaveAddinShortcutsPreferenceRequest","38",h);B.continueWith(()=>{if(B.Hn||B.Gh)r.ULS.sendTraceTag(0,0,10,"SaveAddinShortcutsPreference: Request failure"),
v(!1);else{var X=B.result;void 0!==X.args&&null!==X.args&&void 0!==X.args.data&&null!==X.args.data&&X.args.data.we===Ga.a.wA?v(!0):v(!1)}})}}catch(X){r.ULS.sendTraceTag(0,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",X.toString()),v(!1)}})}getSetting(){const a=this.qac();return this.x5?Promise.resolve(z.c(this.x5)):a?this.Jfl():this.U$e()}qac(){const a=l.AFrameworkApplication.K.$("IsAnonymousUser"),c=l.AFrameworkApplication.K.$("IsRoamingServiceEnabled");return a||this.Z_a()&&!c}Jfl(){try{const a=
localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return r.ULS.sendTraceTag(0,0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}U$e(){return new Promise((a,c)=>{try{const h=this.executeRequest(this.UBh(this.o5m),1,"GetSettingRequest","37");h.continueWith(()=>{if(h.Hn||h.Gh)r.ULS.sendTraceTag(0,0,10,"GetSettingFromRoaming : Request failure");else{let B="";var v=h.result;v&&v.args&&v.args.data?v.args.data.we!==Ga.a.wA?r.ULS.sendTraceTag(0,0,10,"GetSettingFromRoaming : Received error response {0}",
v.args.data.we):v.args.data.qd?(v=z.a(v.args.data.qd),v.Wac&&(B=v.Wac)):r.ULS.sendTraceTag(0,0,10,"GetSettingFromRoaming : ResponseData is null"):r.ULS.sendTraceTag(0,0,10,"GetSettingFromRoaming : Data is null");a(B)}})}catch(h){r.ULS.sendTraceTag(0,0,10,"GetSettingFromRoaming Exception handling request {0}",h.toString()),c("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const c=this.qac(),h=this;return this.getSetting().then(v=>{let B=null;v&&(B=z.a(v));if(!B)return r.ULS.sendTraceTag(0,
0,50,"savedRoamingSetting is empty and nothing to clear "),Promise.resolve(!0);for(const X of Za.a.rM(B)){v=B[X.toString()];for(const ma of Za.a.rM(v)){const Pa=v[ma];if(Pa.addinId===a)delete v[ma.toString()];else if(h.Z_a()&&0===Pa.ownerType&&Pa.shortcutInfoArray){const mb=Pa.shortcutInfoArray,Tb=new Ua.a;for(let rc=0;rc<mb.length;++rc)mb[rc].addinId!==a&&Tb.add(mb[rc]);Pa.shortcutInfoArray=Tb.toArray()}}Za.a.count(v)||delete v[X]}h.x5=B;h.Z_a()&&h.LVm(a);return c?h.gxi(z.c(B)):h.VZd(z.c(B))})}PUb(){if(this.x5){this.Tha=
null;const h=this.x5;for(let v in h){var a=v;const B=h[v];for(let X in B){var c=X;const ma=B[X];ma.shortcutInfoArray&&this.hHe(parseInt(c),parseInt(a),ma.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.Z_a()?this.getSetting().then(a=>{let c=null;if(a&&!({dv:c}=z.d(a)).returnValue)return r.ULS.sendTraceTag(0,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.x5=c;this.PUb();return Promise.resolve(!0)}):
Promise.resolve(!0)}getShortcutsPreferenceInfoByAddinId(a,c,h){return this.x5&&(h=this.x5[h])&&(c=h[c])&&c.addinId===a?c:null}getShortcutInfoArray(a,c){return this.x5&&(c=this.x5[c])&&(a=c[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,c,h){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(c),h)}setShortcutInfoArray(a,c,h){return this.saveShortcutInfoArray(parseInt(a),parseInt(c),h).then(()=>{this.PUb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,
c){if(!this.Tha)return Promise.resolve(!0);var h=this.Tha[a];if(!h)return Promise.resolve(!0);var v=h[c];h=v.modifiers;v=v.keyCode;const B=this.getShortcutInfoArray(h.toString(),v.toString());if(!B||!B.length)return Promise.resolve(!0);let X=0;for(const ma of B){if(ma.addinId===a&&ma.action===c)break;++X}if(X>=B.length)return Promise.resolve(!0);B.splice(X,1);return this.saveShortcutInfoArray(h,v,B).then(()=>{this.PUb();return Promise.resolve(!0)})}hHe(a,c,h){this.Tha||(this.Tha={});for(const v of h){h=
v.addinId;const B=v.action;let X=this.Tha[h];X||(X={});const ma={};ma.modifiers=a;ma.keyCode=c;X[B]=ma;this.Tha[h]=X}}LVm(a){a in this.Tha&&delete this.Tha[a]}isActionCustomized(a,c){return this.Tha&&(a=this.Tha[a])&&a[c]?!!a[c]:!1}getShortcutByCustomizedAction(a,c){return this.Tha&&(a=this.Tha[a])?a[c]:null}getShortcutsPreferenceMappingTable(){return this.x5}static instance(){dv.VIe||(r.ULS.sendTraceTag(0,0,50,"AddinShortcutsPreferenceSettingHelper"),dv.VIe=new dv,dv.Aha=l.AFrameworkApplication.fe);
return dv.VIe}}dv.VIe=null;dv.Aha=null;dv.uFi=!1;dv.Z_a=!1;Object(w.a)(dv,"AddinShortcutsPreferenceSettingHelper",null,[]);class FI{constructor(a,c){this.N3c=null;new Ua.a;this.kpg=!0;this.Z6c=a;this.Bkg=c}qIe(a){this.Bkg.addHandler("GoalChangedEvent",a)}rim(){this.Bkg.raiseEvent("GoalChangedEvent")}fif(a,c){return this.N3c&&this.kpg?a in this.N3c?this.N3c[a]:"Formality"===c&&this.Z6c.K$e().formality?!1:!0:!0}Rcn(a,c){c===this.Z6c.K$e().formality&&(this.N3c=a,this.rim())}aOn(a){this.kpg=a}}Object(w.a)(FI,
"GoalChangeSource",null,[338,339,340]);var YE=b(868),xG=b(818),aD=b(641);class GI{constructor(a,c,h,v,B,X){this.GEa=c;this.Jua=h;this.$e=a;this.b3=v;this.Of=B;this.ogj=X;this.Jua.Ozb()&&this.initialize()}initialize(){return this.b3.Yn().then(()=>{this.$e.Ea(this,YE.a.getTypeName());this.$e.addHandler(this,xG.a.getTypeName())}).catch(a=>{this.Of.sendTraceTag(528274563,2252,10,"EnsureAugLoopRuntimeManager threw exception when registering to GoalsAnnotation.",a)})}hK(a,c){if(c===fo.a.getTypeName()||
c===aD.a.getTypeName())if(!a||!a.content)this.Of.sendTraceTag(528274564,2252,10,"Handled annotation is invalid");else if(Un.a.getTypeNameFor(a.content)===YE.a.getTypeName()||Un.a.getTypeNameFor(a.content)===xG.a.getTypeName())if(Un.a.getTypeNameFor(a.content)===YE.a.getTypeName()){var h=a.content;this.Of.sendTraceTag(528274565,2252,50,"Goal annotation received with formality goal: {0}",h.critiqueConfiguration.formalityGoal);this.GEa.Rcn(h.critiqueConfiguration.mapping,h.critiqueConfiguration.formalityGoal)}else if(Un.a.getTypeNameFor(a.content)===
xG.a.getTypeName())if(a=a.content,a.features){for(h of a.features)if("Goals"===h.featureName){this.ogj.aOn(!!h.supportType);return}this.Of.sendTraceTag(528274567,2252,10,"No goals feature in multilingualFeaturesAnnotation")}else this.Of.sendTraceTag(528274566,2252,10,"MultilingualFeaturesAnnotation.Features is null")}}Object(w.a)(GI,"GoalsAnnotationHandler",null,[337]);class HI{constructor(a){this.qa=a}Ozb(){return this.qa.$("EditorGoalsEnabled")}}Object(w.a)(HI,"GoalsGate",null,[335]);var pP=b(1031),
qP=b(1032),II=b(782);class lw{}lw.Osd=0;lw.Ssd="1.0";lw.fNa="Goals";Object(w.a)(lw,"GoalsConstants",null,[]);var yG=b(932);class JI{constructor(a,c,h,v,B){this.UPb=null;this.ESh=!1;this.jAg=a;this.a7c=c;this.Of=h;this.Jua=v;this.hke=B;this.Jua.Ozb()?this.ZMm():this.Jua.Ozb()&&this.JOf(lw.Osd,lw.Ssd)}ZMm(){new Promise(a=>{this.jAg.Lal(lw.fNa,c=>{this.$Mm(c)?(this.JOf(this.UPb.formality,this.UPb.version),a(this.UPb)):(this.JOf(lw.Osd,lw.Ssd),a(null))})})}$Mm(a){this.ESh=!0;if(!a||!a.RVc)return this.Of.sendTraceTag(528274529,
2252,50,"No persisted goal is registered."),!1;a=a.RVc.properties;var c=a.getValue(Yb.a.WNh);c=parseInt(c);a=a.getValue(Yb.a.XNh);if(!this.a7c.P1f(a))return this.Of.sendTraceTag(528274530,2252,10,"Trying to read unsupported persisted formality goal version. Goal version {0}",a),!1;this.UPb=a=Object.assign(new yG.a,{formality:c,version:a});this.Of.sendTraceTag(528274531,2252,50,"Persisted goal received with formality goal: {0} and version: {1}",a.formality,a.version);return!0}JOf(a,c){a=Object.assign(new II.a,
{formality:a,version:c});this.hke.wzi(a)}PZn(a){if(this.a7c.P1f(a.version)){var c=pP.a.oik(a.version,a.formality.toString());this.jAg.OEj(Object.assign(new qP.a,{RVc:c,fNa:lw.fNa}))?this.UPb=a:this.Of.sendTraceTag(528274561,2252,10,"Write persisted goal failed.")}else this.Of.sendTraceTag(528274560,2252,10,"Trying to write unsupported formality goal version. Goal version {0}",a.version)}lxh(){this.ESh||this.Of.sendTraceTag(528274562,2252,10,"Trying to get persisted goal that is not read yet.");return this.UPb}}
Object(w.a)(JI,"GoalsPersistenceHandler",null,[336]);class KI{constructor(a,c,h,v){this.Of=a;this.ike=c;this.a7c=h;this.Jua=v;this.$6c=Object.assign(new yG.a,{formality:lw.Osd,version:lw.Ssd});this.HAe=this.Jua.Ozb()}K$e(){this.HAe&&(this.HAe=!1,this.ike.lxh()&&(this.$6c=this.ike.lxh()));return this.$6c}Ein(a){this.HAe=!1;this.a7c.P1f(a.version)?(this.Jua.Ozb()&&this.ike.PZn(a),this.$6c=a):(this.Of.sendTraceTag(528274528,2252,10,"Unsupported formality goal version. Goal version {0}",a.version),this.$6c=
Object.assign(new yG.a,{formality:lw.Osd,version:lw.Ssd}))}}Object(w.a)(KI,"GoalsProvider",null,[333,334]);class ZE{constructor(a,c,h,v){this.$e=a;this.b3=c;this.q2a=h;this.Of=v}wzi(a){a=Object.assign(new fo.a,{parentPath:["Signal",II.a.getTypeName()],items:[Object.assign(new Eo.a,{body:a})]});this.jBk(a)}jBk(a){this.b3.Yn().then(()=>{this.mBj(a)}).catch(c=>{this.Of.sendTraceTag(528274526,2250,10,"EnsureAugLoopRuntimeManager threw exception.",c)})}mBj(a){this.$e.activateAnnotation(YE.a.getTypeName(),
ZE.NTb).then(()=>{this.q2a.getAugLoopRuntimeManager().submitOperation(Object.assign(new mp.a,{operation:a}))}).catch(c=>{this.Of.sendTraceTag(528274527,2250,10,"Activating GoalsAnnotation threw exception.",c)})}}ZE.NTb="GoalSelected";Object(w.a)(ZE,"GoalsSignalSender",null,[332]);class rB{constructor(){rB.yFe=new RegExp(rB.Czj)}P1f(a){return!!a.match(rB.yFe)&&1===a.match(rB.yFe).length}}rB.Czj="[0-9]+[.]?[0-9]*";rB.yFe=null;Object(w.a)(rB,"GoalsValidator",null,[331]);class zG{constructor(){this.W=
null}get name(){return"WordEditor.Goals"}init(){this.W.resolve("WordEditor.Goals.GoalsAnnotationHandler")}dispose(){}yb(a){this.W=a;this.W.ha("WordEditor.Goals.GoalsValidator",()=>new rB).as("WordEditor.Goals.IGoalsValidator").singleInstance();this.W.ha("WordEditor.Goals.IGoalsGate",()=>new HI(this.W.resolve("Common.IAppSettingsManager"))).singleInstance();this.W.ha("WordEditor.Goals.GoalsProvider",()=>new KI(this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.GoalsPersistenceHandler"),
this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("WordEditor.Goals.IGoalsGate"))).as("WordEditor.Goals.IGoalReader").as("WordEditor.Goals.IGoalUpdater").singleInstance();this.W.ha("WordEditor.Goals.GoalChangeSource",()=>new FI(this.W.resolve("WordEditor.Goals.IGoalReader"),new Rd.a)).as("WordEditor.Goals.IGoalChangeSource").as("WordEditor.Goals.IGoalCritiqueConfiguration").as("WordEditor.Goals.IGoalsFeatureSupport").singleInstance();this.W.ha("WordEditor.Goals.GoalsPersistenceHandler",
()=>new JI(this.W.resolve("Box4.PersistenceSettingsManager"),this.W.resolve("WordEditor.Goals.IGoalsValidator"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("WordEditor.Goals.IGoalSelectedSignalSender"))).as("WordEditor.Goals.IGoalsPersistenceHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsAnnotationHandler",()=>new GI(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("WordEditor.Goals.IGoalCritiqueConfiguration"),
this.W.resolve("WordEditor.Goals.IGoalsGate"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Common.IUlsWrapper"),this.W.resolve("WordEditor.Goals.IGoalsFeatureSupport"))).as("WordEditor.Goals.GoalsAnnotationHandler").singleInstance();this.W.ha("WordEditor.Goals.GoalsSignalSender",()=>new ZE(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"),this.W.resolve("Common.IUlsWrapper"))).as("WordEditor.Goals.IGoalSelectedSignalSender").singleInstance()}static main(){M.a.instance.Lb(new zG)}}
Object(w.a)(zG,"WordEditorGoalsPackage",null,[1,2]);var hC=b(679),hE=b(413);class AG{constructor(){this.annotation=null;this.languages=new Zc.a(oa.a.yi())}}Object(w.a)(AG,"CritiqueCountWrapper",null,[]);class zA{constructor(){this.Bma=new od.a}Uyd(){return this.Bma}XLh(a,c,h,v){if(this.Bma.Ja(h)){this.Bma.J(h).annotation.count+=c;h=this.Bma.J(h).languages;for(var B of v)h.add(B)}else B=N.a.create().toString(),a=Object.assign(new hE.a,{id:B,categoryName:a,count:c}),this.Bma.add(h,Object.assign(new AG,
{annotation:a,languages:v}))}}zA.oh=389;Object(w.a)(zA,"BaseCritiquesByTypeCounter",null,[317]);class LI extends zA{constructor(a){super();this.Jpb=new va.a;this.Uee=new va.a;this.Jjd=a}tol(a){const c=a.annotation;if(c&&hC.a(Un.a.getTypeNameFor(c.content))){const h=c.content;if(a.opType===fo.a.getTypeName()){this.Jjd.JXm(c.parentPath,h);a=h.M_.state;if(60!==a&&70!==a)return this.Jpb.contains(c.id)&&this.Jpb.remove(c.id),this.myl(c.id,h),!0;this.Jpb.add(c.id)}else if(a.opType===Hf.a.getTypeName())if(this.Jpb.contains(c.id))this.Jpb.remove(c.id);
else return this.bbh(h.typeId,c.id)}return!1}sol(a){if((a=a.annotation)&&hC.a(Un.a.getTypeNameFor(a.content))){const c=a.content,h=c.M_.state;if((60===h||70===h)&&!this.Jpb.contains(a.id))return this.Jpb.add(a.id),this.bbh(c.typeId,a.id)}return!1}myl(a,c){this.Uee.add(a);a=new Zc.a(oa.a.yi());c.language&&a.add(c.language);this.XLh(c.categoryName,1,c.typeId,a)}bbh(a,c){if(!this.Uee.contains(c))return!1;if(!this.Bma.Ja(a))return r.ULS.sendTraceTag(589866503,zA.oh,15,"Unable to decrement the count for critique category {0}. Reason : {1}",
a,"Category not found in CritiqueCountsByCategory dictionary"),!1;if(0>=this.Bma.J(a).annotation.count)return r.ULS.sendTraceTag(589866504,zA.oh,15,"Unable to decrement the count for critique category {0}. Reason : {1}",a,"Current count is less than or equal to 0"),!1;this.Uee.remove(c);this.Bma.J(a).annotation.count--;return!0}}Object(w.a)(LI,"AlCritiquesByTypeCounter",zA,[321,317]);var MI=b(882);class NI extends zr.a{constructor(a,c,h,v,B,X,ma,Pa,mb){var Tb;super();this.$e=a;this.Jjd=c;this.Hae=
h;this.wfg=v;this.GEa=B;this.Mna=X;this.Me=ma;this.A6=this.Sdg=!1;this.Ste=new od.a;this.RIl=(rc,Tc,vd)=>{const ee=!this.GEa||this.GEa.fif(rc,vd);rc=this.Mna&&this.Mna.instance?this.Mna.instance.eif(rc,vd,Tc.substr(1,Tc.length-2)):!0;return ee&&rc};null===Pa||void 0===Pa?void 0:Pa.qIe(Object(m.a)(this,this.Qeb,"onGoalChange"));mb.Usa(this,7);null===(Tb=this.Mna)||void 0===Tb?void 0:Tb.execute(rc=>{rc.KIe(Object(m.a)(this,this.JFb,"sendAnnotationsToHandlers"))})}get index(){return 3}ynm(a,c){this.Jjd.opl(c)&&
(this.A6=!0,this.gY())}run(){this.A6&&(this.JFb(),this.A6=!1)}Akm(a,c){this.Hae.tol(c)&&this.JFb()}Q$h(){this.JFb()}qxf(a,c){this.Hae.sol(c)&&this.JFb()}Qeb(){this.JFb()}hci(){this.JFb()}JFb(){let a=!1;this.Me.$c(()=>{var c=this.sXk();const h=new Ua.a;for(let v of c)c=Object.assign(new MI.a,{id:v.id,parentPath:Yg.a.ivb,content:v,annotationType:Un.a.getTypeNameFor(v)}),h.add(c),a||(a=0<v.count);this.$e.Qcn(h)},"CC:SATH");!this.Sdg&&a&&(Z.a.sendTelemetryEvent(Object.assign(Object.assign({},new ja.a),
{name:"Office.Word.Online.Editor.CritiquesAvailable"})),this.Sdg=!0)}kfk(a){let c=0;if(({value:c}=this.Ste.Ab(a.categoryName,0)).returnValue)if(c!==a.count)this.Ste.Z(a.categoryName,a.count);else return!1;else this.Ste.add(a.categoryName,a.count);return!0}sXk(){const a=new od.a;var c=this.Jjd.Uyd();const h=this.Hae.Uyd();this.N_f(a,c);this.N_f(a,h);this.wfg&&(c=this.wfg.Uyd(),this.N_f(a,c));c=new Ua.a;for(let v of a.values)this.kfk(v)&&c.add(v);return c}N_f(a,c){for(let B of c){c=B.value.annotation;
const X=B.key;var h=this.Van(B.value.languages);if(!a.Ja(c.categoryName)){var v=N.a.create().toString();v=Object.assign(new hE.a,{id:v,categoryName:c.categoryName,count:0,countsByTypeId:{}});a.add(c.categoryName,v)}this.RIl(X,h,c.categoryName)&&(h=a.J(c.categoryName),h.count+=c.count,h.countsByTypeId[X]=(h.countsByTypeId[X]?h.countsByTypeId[X]:0)+c.count)}}Van(a){const c=[];let h=0;for(let v of a)c[h++]=v;return z.c(c)}}Object(w.a)(NI,"CritiquesCounter",zr.a,[319,320]);class OI{constructor(a){this.GE=
a}Uyd(){const a=new od.a,c=new Zc.a(oa.a.yi()),h=Object.assign(new hE.a,{id:"a8f8d183-1cc4-4f3c-8483-23ae2e6d092b",categoryName:"Did you say?",count:this.GE.Rgc.count});a.add("33ab9b0e-2399-4300-a09f-ec2dbfcbf96e",Object.assign(new AG,{annotation:h,languages:c}));return a}}Object(w.a)(OI,"DictationCritiquesByTypeCounter",null,[318,317]);class PI extends zA{constructor(a){super();this.P2a=new od.a;this.$e=a}opl(a){const c=Yg.a.nBd(a.kc);if(!Yg.a.ve(c)){if(a.v$a&&a.v$a.length){let h=null;for(let v of a.v$a)v.errorDetails.FXa()||
(a=this.ath(v),Yg.a.ve(a)||(h||(h=new od.a),h.Ja(a)||h.add(a,new Ua.a),h.J(a).add(v)));this.cbh(c);h?this.Fgn(c,h):this.P2a.remove(c)}else{if(!this.P2a.Ja(c))return!1;this.cbh(c);this.P2a.remove(c)}return!0}return!1}JXm(a,c){var h;if(({value:h}=this.P2a.Ab(a,h)).returnValue)for(let B of h)if(a=B.value,0<a.count&&this.E6e(a.J(0))===c.categoryName)for(h=a.count-1;0<=h;h--){var v=a.J(h).end-a.J(h).begin;a.J(h).begin===c.range.start&&v===c.range.length&&(v=this.ath(a.J(h)),this.Bma.Ja(v)&&(v=this.Bma.J(v).annotation,
v.count=Math.max(0,v.count-1)),a.removeAt(h))}}cbh(a){if(this.P2a.Ja(a))for(let h of this.P2a.J(a)){var c=h.key;a=h.value;this.Bma.Ja(c)&&(c=this.Bma.J(c).annotation,c.count=Math.max(0,c.count-a.count))}}Fgn(a,c){const h=new od.a,v=new od.a;for(let B of c){c=B.key;v.add(c,new Zc.a(oa.a.yi()));for(let X of B.value){const ma=X.end-X.begin,Pa=this.E6e(X);this.U3j(a,Pa,X.begin,ma)?r.ULS.sendTraceTag(589866513,zA.oh,50,"Canvas annotation category {0} for parent path {1} in range (start {2},length {3}) already received from AL. Skipping this",
c,a,X.begin,ma):(h.Ja(c)||h.add(c,new Ua.a),h.J(c).add(X),v.J(c).add(this.uXk(X)))}}this.P2a.Z(a,h);for(let B of this.P2a.J(a))0<B.value.count&&(a=this.E6e(B.value.J(0)),this.XLh(a,B.value.count,B.key,v.J(B.key)))}ath(a){let c=null;a&&(a=Object(ha.a)(315,a.errorDetails))&&a.Js&&(c=a.Js.TypeId);return c}E6e(a){let c=null;a&&(a=Object(ha.a)(315,a.errorDetails))&&a.Js&&(c=a.Js.CategoryTitle);return c}uXk(a){let c="";a&&a.errorDetails&&(c=vi.a.af(a.errorDetails.lcid).name);return c}U3j(a,c,h,v){if((a=
this.$e.fqh(a))&&0<a.count)for(let B of a)if(a=Un.a.getTypeNameFor(B.content),B&&hC.a(a)&&(a=B.content,a.categoryName===c&&a.range.start===h&&a.range.length===v))return!0;return!1}}Object(w.a)(PI,"WacCritiquesByTypeCounter",zA,[316,317]);class BG{constructor(){this.W=null}get name(){return"WordEditor.CritiqueCounts"}yb(a){this.W=a}init(){var a=this.W.resolve("Common.IAppSettingsManager");if(a.$("AugLoopOperationsAreEnabled")){this.W.ha("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter",()=>new PI(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"))).singleInstance();
this.W.ha("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter",()=>new LI(this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("Common.IAppSettingsManager"))).singleInstance();(a=a.$("DictationCorrectionsInEditorPaneIsEnabled"))&&this.W.ha("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter",()=>new OI(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionManager"))).singleInstance();this.W.ha("WordEditor.CritiqueCounts.ICritiquesCounter",()=>new NI(this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("WordEditor.CritiqueCounts.IWacCritiquesByTypeCounter"),this.W.resolve("WordEditor.CritiqueCounts.IAlCritiquesByTypeCounter"),this.W.ra("WordEditor.CritiqueCounts.IDictationCritiquesByTypeCounter"),this.W.ra("WordEditor.Goals.IGoalCritiqueConfiguration"),this.W.za("WordEditor.EditorUpsell.IPremiumPreviewCritiquesFilter"),Fo.a.instance,this.W.ra("WordEditor.Goals.IGoalChangeSource"),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();const c=this.W.resolve("WordEditor.CritiqueCounts.ICritiquesCounter");
this.W.resolve("Box4.Proofing.IErrorRangeEditor").UPg(Object(m.a)(c,c.ynm,"onErrorRangesChangedEventHandler"));this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").IHj(Object(m.a)(c,c.Akm,"onAnnotationOperationEventHandler"));this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage").IPg(Object(m.a)(c,c.qxf,"onAnnotationLocalStateChangedEventHandler"));a&&(this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor").qPg(Object(m.a)(c,c.Q$h,"onDictationCorrectionChangedHandler")),
this.W.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor").rPg(Object(m.a)(c,c.Q$h,"onDictationCorrectionChangedHandler")))}}dispose(){}static main(){M.a.instance.Lb(new BG)}}Object(w.a)(BG,"WordEditorCritiqueCountsPackage",null,[1,2]);class CG{get name(){return"WordEditor.GraphicsEditor"}yb(){}init(){}dispose(){}static main(){M.a.instance.Lb(new CG)}}Object(w.a)(CG,"PackageManager",null,[1,2]);var rP=window.PasteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},
children:[{name:"Floatie",attrs:{Id:"WordEditor.PasteFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"PasteOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PasteFloatie.FlyoutAnchor",LabelText:"(Ctrl)",Image16by16:"IMGMAP@we@Paste_16x16x32",
Alt:"STR@L_PasteOptionsWithCtrl",DisplayMode:"Medium",TemplateAlias:"Paste"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},children:[{name:"MenuSection",attrs:{Id:"floatie.msPasteOptionsButtons",Title:"STR@L_PasteOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0x5FA36C32",QueryCommand:"0x57455F86",Image16by16:"IMGMAP@we@PasteSourceFormatting_16x16x32",
Alt:"STR@L_PasteWithSourceTheme",LabelText:"STR@L_PasteWithSourceTheme"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0x8E28DB06",QueryCommand:"0x8A0031FF",Image16by16:"IMGMAP@we@PasteTextOnly_16x16x32",Alt:"STR@L_PasteTextOnly",LabelText:"STR@L_PasteTextOnly"}},{name:"ToggleButton",attrs:{Id:"floatie.gbFormatWithDesignerButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteFormatWithDesignerTooltipUnavailable",
LabelText:"STR@L_PasteFormatWithDesigner"}},{name:"ToggleButton",attrs:{Id:"floatie.gbMatchDocumentFormattingButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteMatchDocumentFormattingTooltipUnavailable",LabelText:"STR@L_PasteMatchDocumentFormatting"}},{name:"ToggleButton",attrs:{Id:"floatie.gbUseSmartPasteButton",Command:"0x7a781ebb",QueryCommand:"0x56951cf6",Image16by16:"IMGMAP@we@StyleApplyPane_16x16x32",Alt:"STR@L_PasteUseSmartPasteTooltipUnavailable",
LabelText:"STR@L_PasteUseSmartPaste"}}]}]}]}]}]}]}]}]}]}]}]};class QI{constructor(a){this.adj={};this.fb=a;this.Tpb=new Yc.a}pIa(a,c){const h=this.fb.W7b,v=parseInt(a);return a&&v!==Le.ActionManager.c_e?this.Tpb.Ja(h)?(a=this.Tpb.J(h).GFc(v,c,2),32===a||1===a):!1:!1}$za(a){const c=parseInt(a),h=this.fb.W7b;return a&&c!==Le.ActionManager.c_e?this.Tpb.Ja(h)?32===this.Tpb.J(h).GFc(c,this.adj,1):!1:!0}jpi(a,c){this.Tpb.Z(a,c)}XFi(a){a=parseInt(a);const c=this.fb.W7b;return!!c&&!!this.Tpb.J(c)&&this.Tpb.J(c).aIl(a)}}
Object(w.a)(QI,"NonCanvasCuiUser",null,[861,311]);var Gz=b(1057),iC=b(56),iE;(function(a){a[a.UnspecifiedGallery=0]="UnspecifiedGallery";a[a.CharacterCodeGallery=1]="CharacterCodeGallery";a[a.FontStyleGallery=2]="FontStyleGallery";a[a.InkThicknessGallery=3]="InkThicknessGallery";a[a.IconGallery=4]="IconGallery";a[a.ListGallery=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.PageNumberGallery=7]="PageNumberGallery";a[a.ChangeColorsGallery=8]="ChangeColorsGallery"})(iE||(iE={}));Object(w.b)("GalleryType",
iE);class Bv{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(w.a)(Bv,"CommonGalleryButtonProps",null,[]);class $E extends Bv{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(w.a)($E,"AdditionalTableStyleGalleryButtonProps",Bv,[]);class RI extends $E{constructor(){super()}}Object(w.a)(RI,"AdditionalChangeColorsGalleryButtonProps",$E,[]);class SI extends Bv{constructor(){super();this.character=null}}Object(w.a)(SI,"AdditionalCharacterCodeGalleryButtonProps",
Bv,[]);class TI extends Bv{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(w.a)(TI,"AdditionalFontStyleGalleryButtonProps",Bv,[]);class UI{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(w.a)(UI,"AdditionalGalleryProperties",null,[]);class VI extends Bv{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=
this.fullIconStyle=this.label=this.icon=null}}Object(w.a)(VI,"AdditionalIconButtonProperties",Bv,[]);class WI extends Bv{constructor(){super();this.styleDisplayName=null}}Object(w.a)(WI,"AdditionalInkThicknessGalleryButtonProps",Bv,[]);class XI extends Bv{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(w.a)(XI,"AdditionalListGallerButtonProps",Bv,[]);class YI extends Bv{constructor(){super();this.text=null}}Object(w.a)(YI,"AdditionalPageNumberGalleryButtonProps",Bv,[]);var bD=b(993);
const sP=(a,c)=>{var h=appChrome.selectors.getActiveControlStates();if(h=Object(ha.a)(Object,h[a])){if((a=Object(ha.a)(String,h.value))&&a===c)return!1;a=Object(ha.a)(String,h.selectedKey);if(!c&&!a)return!1;if(a){h=Array.isArray(h.options)?h.options:null;let v=null;for(let B=0;B<h.length;B++){const X=Object(ha.a)(Object,h[B]);if(Object(ha.a)(String,X.key)===a){v=X;break}}if(v&&Object(ha.a)(String,v.text)===c)return!1}}return!0},$I=(a,c,h,v)=>{if(0<(v&2)){v=[];switch(c){case "ToggleButtonModel":case "InkButtonModel":v.push(aF(a,
h[Uf.a.On]));break;case "CheckboxModel":v.push(appChrome.actions.toggleCheckbox(a,h[Uf.a.On]));break;case "ComboBoxModel":if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter")&&!sP(a,h[Rc.a.Value]))break;(c=h[Rc.a.Key])?v.push(appChrome.actions.updateComboBoxKey(a,c,h[Rc.a.Value])):v.push(appChrome.actions.updateComboBoxValue(a,h[Rc.a.Value]));break;case "FontPickerModel":v.push(appChrome.actions.updateFontPickerSelectedFont(a,h[bD.a.SelectedFont]));break;case "SplitButtonModel":v.push(aF(a,
h[lp.a.On]));break;case "SpinButtonModel":v.push(appChrome.actions.updateSpinButton(a,h[pg.a.Number],Of.a.lWb(h[pg.a.UnitType]),h[pg.a.Text],h[pg.a.MaxValue],h[pg.a.Alt]));break;case "ColorPickerModel":v.push(appChrome.actions.updateColorPickerSelectedColor(a,h[Ql.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":v.push(appChrome.actions.updatePageNumberGalleryButtonText(a,h[Pf.a.Text]));break;case "CompoundButtonModel":h[Uf.a.Description]&&v.push(appChrome.actions.updateCompoundButtonDescription(a,
h[Uf.a.Description]));Uf.a.On in h&&v.push(aF(a,h[Uf.a.On]));break;case "SliderModel":h.snapToStep?v.push(appChrome.actions.updateSliderSelectedValue(a,h[vm.Value])):v.push(appChrome.actions.updateSliderValue(a,h[vm.Value],h[vm.MinValue]||0,h[vm.MaxValue],h[vm.Text]));break;case "FlyoutAnchorModel":Qg.a.ImageIsVisible in h&&v.push(appChrome.actions.hideFlyoutAnchorIcon(a,!h[Qg.a.ImageIsVisible]));Uf.a.On in h&&v.push(aF(a,h[Uf.a.On]));break;case "InputBoxModel":v.push(appChrome.actions.updateInputBoxValue(a,
h[fn.a.Text]))}c=v;var B=Object(ha.a)(String,h[bl.a.iconColor]);void 0!==B&&null!==B&&c.push(appChrome.actions.updateIconColor(a,B));ZI(a,h,v);c=v;(B=Object(ha.a)(Object,h[bl.a.IconSet]))&&c.push(appChrome.actions.setControlIconSet(a,B));c=v;B=Object(ha.a)(String,h[bl.a.customTooltip]);void 0!==B&&null!==B&&c.push(appChrome.actions.setControlCustomTooltip(a,B));a=v;(h=Array.isArray(h[bl.a.JIf])?h[bl.a.JIf]:null)&&a.push.apply(a,h);return v}return null},jC=(a,c)=>appChrome.actions.updateControlEnabledDisabledState(a,
c),aF=(a,c)=>appChrome.actions.toggleButton(a,c),ZI=(a,c,h)=>{c=Object(ha.a)(String,c[bl.a.Icon]);void 0!==c&&null!==c&&h.push(appChrome.actions.setControlIcon(a,c))};class aJ{constructor(a,c,h,v){this.Il=v;this.Vna=a;this.Kx=c;this.HQb=h;this.Glc={}}fCm(a,c,h,v,B=null){const X=a.ExternalGalleryId||a.ExternalId;var ma=a.ExternalId;v.push(X);if(appChrome.selectors.isControlDefined(X))a.GalleryStyle&&yh.d("setGalleryStyles")&&c.push(appChrome.actions.setGalleryStyles(X,a.GalleryStyle));else{if(4!==
a.Type)return;h.push(appChrome.api.createGalleryModel(X,Object.assign(new UI,{columns:a.Width,sections:[appChrome.api.gallerySection([],ma)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}h=0;if(yh.d("setGallerySections")&&a.GallerySections&&0<a.GallerySections.length){ma=[];v=[];const Pa=[];for(const mb of a.GallerySections){ma.push(appChrome.api.gallerySection([],mb.SectionId,mb.Title));0===h&&mb.GalleryButtons&&0<mb.GalleryButtons.length&&(h=mb.GalleryButtons[0].Type);const Tb=this.tHe(v,
mb.GalleryButtons);v.push.apply(v,this.f$e(Tb,X,mb.SectionId,!1,h,B,!0));Pa.push.apply(Pa,Tb)}c.push(appChrome.actions.setGallerySections(X,ma));c.push.apply(c,v);c.push.apply(c,this.R7e(X,iE[h],Pa,null,5===a.Type))}else a.GalleryItems&&0<a.GalleryItems.length&&(h=a.GalleryItems[0].Type),c.push.apply(c,this.f$e(this.tHe(c,a.GalleryItems),X,ma,!1,h,B))}Dbl(a,c){const h=[];let v=null,B=!1;if(!a)return null;const X=this.Vna.WPc(this.Kx,a.commandId,c);h.push(jC(a.externalUxCommand,!X));if(a.previewControlIds){const mb=
[];for(let Tb=0;Tb<a.previewControlIds.length;Tb++){var ma={},Pa=a.previewControlIds[Tb];ma.SourceControlId=Pa;const rc=this.Il.getCommandByExternalUxId(Pa);this.wBd(rc||a,ma);ma[Pf.a.On]&&(v=ma.SourceControlId,ma[Pf.a.HighlightOn]&&(B=!0));ZI(Pa,ma,h);if(ma=Object(ha.a)(Nh.a,ma[Pf.a.GalleryButtonProps]))mb.push(ma),X&&(Pa=this.Vna.WPc(this.Kx,ma.Command,c),ma.IsDisabled=!Pa)}0<mb.length&&h.push.apply(h,this.f$e(this.tHe(h,mb),a.externalUxCommand,a.externalUxCommand,!0,mb[0].Type));h.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,
v));B&&(r.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",v),h.push(appChrome.actions.highlightSelectedFontStyle(v)))}return h}tHe(a,c){const h=[],v=[];for(let X=0;X<c.length;X++){const ma=c[X],Pa=De.b(ma.ExternalId)?ma.Id:ma.ExternalId;h.push(Pa);switch(ma.Type){case 1:var B=ma;v.push(appChrome.api.createCharacterCodeGalleryButtonModel(Pa,Object.assign(new SI,{disabled:B.IsDisabled,character:B.Character,style:B.Style,title:B.Alt})));break;case 2:B=ma;v.push(appChrome.api.createFontStylesGalleryButtonModel(Pa,
Object.assign(new TI,{disabled:B.IsDisabled,styleDisplayName:B.LabelText,style:B.Style,title:B.Alt,previewStyleLabel:B.PreviewStyleLabel})));break;case 3:B=ma;v.push(appChrome.api.createInkThicknessGalleryButtonModel(Pa,Object.assign(new WI,{disabled:B.IsDisabled,styleDisplayName:B.LabelText,style:B.Style,title:B.Alt})));break;case 4:B=ma;v.push(appChrome.api.createIconGalleryButtonModel(Pa,Object.assign(new VI,{disabled:B.IsDisabled,icon:[B.Icon],fullIconStyle:B.FullIconStyle,previewIconStyle:B.PreviewIconStyle,
largePreviewIconStyle:B.LargePreviewIconStyle,label:B.LabelText,title:B.Alt})));break;case 5:B=ma;v.push(appChrome.api.createListGalleryButtonModel(Pa,Object.assign(new XI,{disabled:B.IsDisabled,infoAtLevel:B.LevelInfo,ariaLabel:B.Alt})));break;case 6:B=ma;v.push(appChrome.api.createTableStyleGalleryButtonModel(Pa,Object.assign(new $E,{disabled:B.IsDisabled,tableCellStyles:B.TableCellStyles,tableStyles:B.TableStyles,title:B.Alt,columns:B.columns})));break;case 8:B=ma;v.push(appChrome.api.createChangeColorsGalleryButtonModel(Pa,
Object.assign(new RI,{disabled:B.IsDisabled,tableCellStyles:B.TableCellStyles,tableStyles:B.TableStyles,title:B.Alt})));break;case 7:B=ma,v.push(appChrome.api.createPageNumberGalleryButtonModel(Pa,Object.assign(new YI,{disabled:B.IsDisabled,text:B.Text,title:B.Alt})))}this.Il.addCommandToMaps(Object.assign(new iC.a(Pa,ma.Command),{queryCommandId:ma.QueryCommand,menuItemId:ma.MenuItemId}))}a.push(appChrome.actions.addControls(v));return h}f$e(a,c,h,v,B,X=null,ma=!1){const Pa=[];v?Pa.push(appChrome.actions.populateGalleryItems(c,
a)):(this.Glc[c]=!1,ma||(v=!0,appChrome.selectors.isControlDefined(c)&&(v=appChrome.selectors.getGalleryState(c),v=v.disableIndividualButtons?v.disableIndividualButtons:!0),Pa.push.apply(Pa,this.R7e(c,iE[B],a,null,5===B,v,X))),Pa.push(appChrome.actions.updateGallerySectionItems(c,h,a)));return Pa}E1k(a){return this.R7e(a.ExternalUxId,a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}R7e(a,c,h,v,B,X=!0,ma=null){const Pa=[];if(a in this.Glc){if(this.Glc[a])return delete this.Glc[a],
Pa;this.Glc[a]=!0}let mb=null,Tb=-1;if(h)({Qoh:Tb,returnValue:mb}=this.MNg(c,h,Pa,X,ma));else if(v)for(const rc of v)(h=({Qoh:Tb}=this.MNg(c,rc.galleryButtons,Pa,X)).returnValue)&&(mb=h);Pa.push(appChrome.actions.updateGallerySelectedId(a,mb));X&&Pa.push(jC(a,!1));B&&0<Tb&&Pa.push(appChrome.actions.updateListGalleryTextDirection(a,2===Tb));return Pa}MNg(a,c,h,v,B=null){let X,ma=null;X=-1;let Pa=!1;for(const Tb of c){var mb=this.B1k(a);c={};c.SourceControlId=Tb;c.Location=B;const rc=this.Il.getCommandByExternalUxId(Tb);
if(!rc)continue;const Tc=this.wBd(rc,c);v&&h.push(jC(Tb,1>(Tc&1)));(mb=$I(Tb,mb,c,Tc))&&h.push.apply(h,mb);c[Pf.a.On]&&(ma=Tb,c[Pf.a.HighlightOn]&&c[Pf.a.HighlightOn]&&(Pa=!0));void 0!==c[bl.a.labelText]&&null!==c[bl.a.labelText]&&h.push(appChrome.actions.setControlLabel(rc.externalUxCommand,c[bl.a.labelText]));c[Pf.a.IsRtl]&&0>X&&(X=c[Pf.a.IsRtl])}Pa&&(r.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",ma),h.push(appChrome.actions.highlightSelectedFontStyle(ma)));
return{returnValue:ma,Qoh:X}}B1k(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}wBd(a,
c){c.MenuItemId=a.menuItemId;return this.Vna.Fka(this.Kx,this.HQb,a.commandId,a.queryCommandId,c)}}Object(w.a)(aJ,"ReactGalleryPoller",null,[]);var tP=b(759),bJ=b(604);class cJ{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(w.a)(cJ,"PopulateFontPickerDataProps",null,[]);var dJ=b(286),Hz=b(1679);class eJ extends jw{constructor(){super();this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=
null}}Object(w.a)(eJ,"OptionalCompoundButtonProperties",jw,[]);class fJ extends jw{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(w.a)(fJ,"OptionalFlyoutAnchorProperties",jw,[]);class gJ extends uz{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(w.a)(gJ,"OptionalPersonaButtonProperties",uz,[]);class bF extends jw{constructor(){super();
this.toggled=!1;this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(w.a)(bF,"OptionalToggleButtonProperties",jw,[]);var uP=b(1531),vP=b(1530),wP=b(467);class hJ{constructor(){this.c4g=this.actions=null;this.JYi=!1}}Object(w.a)(hJ,"PopulateActions",null,[]);class DG{iDh(a,c){switch(c){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);case "ToggleButtonModel":return this.rcl(a);case "InkButtonModel":return this.qcl(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);
case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}rcl(a){const c={};c[Uf.a.On]=appChrome.selectors.getButtonToggleState(a);return c}qcl(a){const c={};c[Uf.a.On]=yh.i("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);return c}}Object(w.a)(DG,"ReactStatePropsSelector",null,[]);class cF{constructor(a,c,h,v,B){this.Vna=a;this.Kx=c;this.HQb=
h;this.Il=v;this.iCe={};this.Mrj=new DG;this.Dpb=B}mJi(a){const c=a.populationProps.populateQueryCommandId;return a.populationProps.populateOnlyOnce&&c in this.iCe}Pcl(a,c,h=null){const v=[],B={};if(!this.mJi(a)){const X=a.populationProps.populateQueryCommandId,ma={};ma.MenuId=a.externalUxCommand;ma.IsShadowMenuOpen=this.isShadowMenuOpen(h);if(0<(this.Vna.Fka(this.Kx,this.HQb,X,X,ma,this.e4k(h))&1))if("FontPickerModel"===c)this.iCe[X]=!0,v.push(cF.hbl(a,ma)),B[a.externalUxCommand]="FontPickerModel";
else if(ma.MenuItems)switch(this.iCe[X]=!0,c){case "ComboBoxModel":v.push(cF.fbl(a,ma));B[a.externalUxCommand]="ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":v.push.apply(v,this.oFh(a.externalUxCommand,c,ma.MenuItems,B,h&&"location"in h?h.location:null))}}return Object.assign(new hJ,{actions:v,c4g:B,JYi:this.isShadowMenuOpen(h)})}oFh(a,c,h,v,B=null){const X=[],ma=[],Pa=[],mb=[];for(let Tb=
0;Tb<h.MenuSectionList.length;Tb++){const rc=Object(ha.a)(Hg.a,h.MenuSectionList[Tb]);if(!rc)continue;let Tc=null;const vd=[];De.c(rc.Title)||(Tc=rc.Title);for(let ee=0;ee<rc.ControlList.length;ee++){const Ie=Object(ha.a)(mk.a,rc.ControlList[ee]);if(!Ie||Ie.ExternalId)v&&this.tVk(Ie,v),X.push.apply(X,this.gbl(Ie,ma,vd,mb,a,c,B))}h.UpdateDynamically&&Pa.push(appChrome.api.menuSection(vd,Tc,rc.Lang))}h.UpdateDynamically&&X.push(appChrome.actions.updateMenu(a,Pa,h.Title,h.AriaLabel,h.ShouldAutoOpen,
h.AriaRoleDescription,h.MenuTargetDescriptor));0<ma.length&&X.splice(0,0,appChrome.actions.addControls(ma));0<mb.length&&yh.d("setStatefulSplitButtonMruBypassControls")&&X.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,mb));return X}tVk(a,c){switch(a.ControlType){case 1:case 3:c[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:c[a.ExternalId]="ToggleButtonModel";break;case 6:c[a.ExternalId]="CheckboxModel";break;case 7:c[a.ExternalId]="ColorPickerModel";
a=Object(ha.a)(fk.a,a);a.McuLayout&&(c[a.McuExternalId]="ColorPickerModel");break;case 9:c[a.ExternalId]="FlyoutAnchorModel"}}gbl(a,c,h,v,B,X,ma=null){const Pa=[];switch(a.ControlType){case 1:case 3:v=Object(ha.a)(qh.a,a);this.RBm(v,Pa,c,h);v.MenuItemsStatefulData&&yh.d("setStatefulSplitButtonMenuItemsStatefulData")&&Pa.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(B,v.MenuItemsStatefulData));break;case 2:this.wCm(Object(ha.a)(wP.a,a),Pa,c,h);break;case 6:this.TBm(Object(ha.a)(pA.a,
a),Pa,c,h);break;case 4:this.oCm(Object(ha.a)(xi,a),Pa,c,h);break;case 7:this.VBm(Object(ha.a)(fk.a,a),Pa,c,h);break;case 9:B=Object(ha.a)(ph.a,a);this.bCm(B,Pa,c,h);"StatefulSplitButtonModel"===X&&v.push(B.ExternalId);break;case 8:this.Dpb.fCm(Object(ha.a)(Ce.a,a),Pa,c,h,ma)}return Pa}RBm(a,c,h,v){v.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&c.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),a.Description&&c.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,
a.Description)),a.CommandValueId&&c.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,a.CommandValueId)),this.Nld()&&((h=this.aJa(a))&&0<h.length&&c.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Hz.a(h)).iconSet)),a.LabelText!==a.Alt&&c.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(a.Description||Object(Ub.a)(rv,a)?h.push(appChrome.api.createCompoundButtonModel(a.ExternalId,a.LabelText,a.Description,Object.assign(new eJ,{iconSet:(new Hz.a(this.aJa(a))).iconSet,
keytip:a.KeyTip,roleInMenu:a.RoleInMenu,ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):h.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new uz,{iconSet:(new Hz.a(this.aJa(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId,shouldTakeFocus:a.ShouldTakeFocus}))),this.Il.addCommandToMaps(Object.assign(new iC.a(a.ExternalId,a.Command),
{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));a.Lang&&yh.d("setControlLanguage")&&c.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}TBm(a,c,h,v){v.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&c.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.Nld()&&((h=this.aJa(a))&&0<h.length&&c.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Hz.a(h)).iconSet)),
a.IsChecked&&c.push(appChrome.actions.toggleButton(a.ExternalId,a.IsChecked)),a.LabelText!==a.Alt&&c.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(h.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new bF,{iconSet:(new Hz.a(this.aJa(a))).iconSet,keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),this.Il.addCommandToMaps(Object.assign(new iC.a(a.ExternalId,
a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}wCm(a,c,h,v){v.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&c.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.Nld()&&((h=this.aJa(a))&&0<h.length&&c.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Hz.a(h)).iconSet)),l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&a.LabelText!==a.Alt&&c.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,
a.Alt)))):(l.AFrameworkApplication.K.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?h.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new bF,{iconSet:(new Hz.a(this.aJa(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):h.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new bF,{iconSet:(new Hz.a(this.aJa(a))).iconSet,
iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel}))),this.Il.addCommandToMaps(Object.assign(new iC.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}oCm(a,c,h,v){v.push(a.ExternalId);v=this.Nal(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&c.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,v,a.LabelText)):yh.a("createPersonaButtonModel")&&h.push(appChrome.api.createPersonaButtonModel(a.ExternalId,
v,a.LabelText,Object.assign(new gJ,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}bCm(a,c,h,v){v.push(a.ExternalId);if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&c.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.Nld()&&((h=this.aJa(a))&&0<h.length&&c.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Hz.a(h)).iconSet)),void 0!==a.ImageIsVisible&&null!==a.ImageIsVisible&&c.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,
!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&c.push(appChrome.actions.toggleButton(a.ExternalId,a.Toggled)));else{v=!(void 0===a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;const B=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;h.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new fJ,{iconSet:(new Hz.a(this.aJa(a))).iconSet,keytip:a.KeyTip,hideIcon:v,toggled:B,roleInMenu:a.AriaLabel})));this.Il.addCommandToMaps(Object.assign(new iC.a(a.ExternalId,
a.Command),{queryCommandId:a.QueryCommand,populationProps:new tP.a(a.PopulateQueryCommand,a.PopulateOnlyOnce)}))}a.Menu&&c.push.apply(c,this.oFh(a.ExternalId,"FlyoutAnchorModel",a.Menu,null));a.Lang&&c.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}VBm(a,c,h,v){a.McuLayout&&v.push(a.McuExternalId);v.push(a.ExternalId);v=0;appChrome.selectors.isControlDefined(a.ExternalId)?a.McuLayout&&(v=this.Mrj.iDh(a.ExternalId,"ColorPickerModel").columnCount):(a.McuLayout&&(h.push(appChrome.api.createColorPickerModel(a.McuExternalId,
a.Width)),this.Il.addCommandToMaps(Object.assign(new iC.a(a.McuExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})),v=a.Width),h.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.Il.addCommandToMaps(Object.assign(new iC.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));h=[];const B=[];for(let X=0;X<a.Colors.length;X++){const ma=a.Colors[X];X<v?h.push(appChrome.api.colorPickerCell(ma.Color,
ma.DisplayColor,ma.Alt)):B.push(appChrome.api.colorPickerCell(ma.Color,ma.DisplayColor,ma.Alt))}0<h.length&&c.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,h));c.push(appChrome.actions.populateColorPickerCells(a.ExternalId,B));a.SelectedColorId&&(0<h.length&&c.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),c.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,a.SelectedColorId)))}aJa(a){return a.Image32by32Class?this.Il.ruh(a.Image32by32Class):
a.Image16by16Class?this.Il.ruh(a.Image16by16Class):a.ExternalImageId}Nal(a){return a?Object.assign(new vP.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new uP.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}e4k(a){let c=2;a&&"inputMethod"in a&&a.inputMethod&&(c=a.inputMethod);return c}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}Nld(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static hbl(a,c){return appChrome.actions.populateFontPickerDataAsync(new Promise((h,v)=>{xa.a.instance.za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(B=>{B.isFeatureEnabled(dJ.a.nBb,!1).then(X=>{let ma=c.fonts;X||B.isFreemiumUpsellEnabled()||(ma=bj.a.VYi(ma,Pa=>Pa.fontType!==dJ.a.BEf));X=Object.assign(new cJ,{commandId:a.externalUxCommand,fonts:ma,isSubscriber:X,mruList:c.mruList,initialPinnedFontKeys:c.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
h(X)}).catch(v)})}))}static fbl(a,c){const h=[];for(let v=0;v<c.MenuItems.MenuSectionList.length;v++){const B=c.MenuItems.MenuSectionList[v];B.Title&&h.push(appChrome.api.comboBoxHeader("Header-"+v.toString(),B.Title));for(let X=0;X<B.ControlList.length;X++){const ma=Object(ha.a)(bJ.a,B.ControlList[X]);ma&&h.push(appChrome.api.comboBoxItem(ma.MenuItemId,ma.LabelText,ma.Styles,ma.CommandValueId,ma.AriaLabel,ma.Data,ma.Disabled))}v<c.MenuItems.MenuSectionList.length-1&&h.push(appChrome.api.comboBoxDivider("Divider-"+
v.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,h)}}Object(w.a)(cF,"ReactPopulateQueryCommandPoller",null,[]);class iJ{constructor(a,c,h,v,B){this.Il=h;this.Vna=a;this.Kx=c;this.HQb=v;this.Dpb=B}Ocl(a,c,h){const v=[];if(this.mIl(c))a=this.Egl(a,c,h),void 0!==a&&null!==a&&v.push.apply(v,a);else if(a){var B=this.wBd(a,h);bl.a.visible in h&&v.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!h[bl.a.visible]));v.push(jC(a.externalUxCommand,1>(B&1)));
void 0!==h[bl.a.labelText]&&null!==h[bl.a.labelText]&&v.push(appChrome.actions.setControlLabel(a.externalUxCommand,h[bl.a.labelText]));void 0!==c&&null!==c&&(B=$I(a.externalUxCommand,c,h,B),void 0!==B&&null!==B&&v.push.apply(v,B),"PeopleWell"===c&&this.MEj(a.externalUxCommand,h,v))}return v}d_k(a,c,h){const v=[];switch(c){case "FlyoutAnchorModel":var B=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var X=appChrome.selectors.getSplitButtonState(a);if(X=this.Il.getCommandByExternalUxId(X.command))h=
this.Vna.WPc(this.Kx,X.commandId,h),v.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,!h)),v.push(jC(a,!1));return v;default:return null}c=!1;for(X in B)if(B=this.Il.getCommandByExternalUxId(X),De.c(B))c=!0;else if(h.SourceControlId=B.externalUxCommand,this.Vna.WPc(this.Kx,B.commandId,h))return v.push(jC(a,!1)),v;v.push(jC(a,!c));return v}Egl(a,c,h){switch(c){case "PreviewGalleryModel":return this.Dpb.Dbl(a,h);case "GalleryModel":return this.Dpb.E1k(h)}return null}mIl(a){return"GalleryModel"===
a||"PreviewGalleryModel"===a}wBd(a,c){c.MenuItemId=a.menuItemId;return this.Vna.Fka(this.Kx,this.HQb,a.commandId,a.queryCommandId,c)}MEj(a,c,h){const v=c[Qg.a.LabelTextUserGeneratedPlaceholderReplacements];c=c[Qg.a.LabelText];v&&0<v.length&&(c=String.format.apply(null,[c].concat(v)));h.push(this.zkl(a,c))}zkl(a,c){return appChrome.actions.updatePeopleWell(this.gVk(a),c)}gVk(a){const c=[];var h={};a=this.Il.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.Vna.Fka(this.Kx,this.HQb,
"1285265560",a,h);h=h.MenuItems;if(!h)return c;h=h.MenuSectionList[0];for(a=0;a<h.ControlList.length;a++){const v=h.ControlList[a],B={};B.name=v.Alt;B.id=v.MenuItemId;B.description=v.Description;B.color=v.ImageBackColor;B.joinTime=v.JoinTimeInMS;B.imageUrl=v.ImageUrl;B.activeStatus=v.ActiveStatus;B.isAnonymous=v.IsAnonymous;B.canJump=v.CanJump;B.upn=v.Upn;c.push(B)}return c}}Object(w.a)(iJ,"ReactQueryCommandPoller",null,[]);var xP=b(1500);class jJ{constructor(a,c,h){this.Il=a;this.Kx=c;a=new xP.a;
this.$vj=new DG;this.Dpb=new aJ(a,this.Kx,h,this.Il);this.FBg=new cF(a,this.Kx,h,this.Il,this.Dpb);this.vBg=new iJ(a,this.Kx,this.Il,h,this.Dpb)}Jya(){const a=[];if(!yh.c())return a;a.push.apply(a,this.xkl());var c=this.jZk();if(0<c.length)a.push.apply(a,c);else if(c=appChrome.selectors.getActiveControlIds(),Object.keys(c).length){const h=this.kZk();for(const v of h)a.push(appChrome.actions.updateControlEnabledDisabledState(v,!0)),delete c[v];a.push.apply(a,this.OCd(c))}return a}XPc(a,c){yh.c()&&
(a=this.OCd(a,c),appChrome.api.dispatch(a))}UDf(a,c,h=null){if(!De.c(a)&&a.populationProps&&!this.FBg.mJi(a)){a=this.FBg.Pcl(a,c,h);if(!a.JYi){let v;(v=a.actions).push.apply(v,this.OCd(a.c4g,yh.g(h)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),!0}return!1}OCd(a,c=0){const h=[],v={};if(yh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var B of appChrome.selectors.getActiveGroupIds())for(var X of appChrome.selectors.getVisibleControlsInGroup(B))v[X]=
!0;for(let ma in a)B=ma,X=a[ma],0===c&&v[B]&&(c=2),h.push.apply(h,this.wkl(B,X,c));return h}wkl(a,c,h=0){const v=[],B=this.Il.getCommandByExternalUxId(a);let X={};appChrome.selectors.isControlDefined(a)&&(X=this.$vj.iDh(a,c));X[Gz.a.Qcc]=h;De.c(B)?(X.ExternalUxId=a,(a=this.vBg.d_k(a,c,X))&&0<a.length&&v.push.apply(v,a)):(X.MenuItemId=B.menuItemId,X.SourceControlId=a);v.push.apply(v,this.vBg.Ocl(B,c,X));return v}xkl(){const a=[],c=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("ReactRibbonDispatchActionFilter"),
h=appChrome.selectors.getContextualTabIds();let v=[];c&&(v=appChrome.selectors.getActiveContextualTabIds());for(let X=0;X<h.length;X++){var B=this.Il.raf(h[X]);if(B){B=this.Kx.$za(B);let ma=!0;c&&(ma=0<=Array.indexOf(v,h[X]));c&&ma===B||a.push(appChrome.actions.activateDeactivateContextualTab(h[X],B))}}return a}jZk(){var a=appChrome.selectors.getSelectedTabId();const c=[],h=this.Il.raf(a);h&&(this.Kx.$za(h)||c.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return c}kZk(){var a=
appChrome.selectors.getActiveGroupIds();const c=[];for(const h of a)if(a=this.Il.W1k(h))for(const v of a)this.Kx.$za(v.commandId)||((a=v.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(v.externalUxGroupId)),c.push.apply(c,a));return c}}Object(w.a)(jJ,"ReactRibbonRootPoller",null,[847]);class dF{constructor(a,c,h=null){this.Kx=this.Yua=this.r6a=null;this.mQb=c;a.OGa(this);this.GC=h}get Oja(){this.Yua||(this.Yua=new Date,this.Yua.setTime(0));return this.Yua}set Oja(a){this.Yua=
a}get g5(){return 2}get GC(){return this.Kx}set GC(a){this.Kx=a}get E8b(){this.r6a||(this.r6a=new jJ(this.mQb,this.GC,this.g5));return this.r6a}a9a(){const a=document.activeElement;ye.a.isEditable(a)&&a.blur()}executeCommand(a,c,h,v,B,X,ma,Pa=2){De.c(this.GC)||(B=new Lm.a,B.CommandLocation=Pa,B.InvocationMethod=v,B.CommandTabName=h,this.Uod(),c[Gz.a.Qcc]=Pa,this.GC.pIa(a,c,B,X,ma),this.K2l(a,c))}Jya(){return De.c(this.GC)?[]:this.E8b.Jya()}yk(){const a=this.Jya();0<a.length&&(this.Oja=new Date,appChrome.api.dispatch(a))}JZc(){yh.c()&&
this.E8b.XPc({PeopleWell:"PeopleWell"},18)}yZc(){}Uod(){const a=xa.a.instance.ra("Common.ISystemInitiatedFeedback");a?a.logActivity("SLRCommandUsed","FGSLRUsageEnabled"):r.ULS.sendTraceTag(561394446,340,50,"ISystemInitiatedFeedback was null")}K2l(a,c){try{const h=xa.a.instance.ra("Common.ISystemInitiatedFeedback");if(h&&c){const v=c.SourceControlId||c.launcherId||c.LegacyId||c.NewContextId;let B=(v?"_"+v:"")+(c.SqmControlId?"_"+c.SqmControlId:"");B=B.length?B:"_"+a;h.vpf("Ribbon"+B)}}catch(h){r.ULS.sendTraceTag(527247309,
356,10,"LogCommandActivity failed: "+(h?h.toString():""))}}}Object(w.a)(dF,"ReactRibbonRoot",null,[629,848]);var eF=b(1446);class kJ{constructor(a){this.MFe=this.Jke=!1;this.d3a=null;this.waa=this.abg=!1;this.Axe=a;ah.a.instance.Ea(Jb.a.Lv,this.dDc(),Object(m.a)(this,this.tmm,"onContextualUIMouseDown"));l.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&l.AFrameworkApplication.na.Ya.WG?ck.a.get_instance().Vk(16,()=>{this.nra?this.initializeContextualUI(this.dDc()):
ck.a.get_instance().Vk(7,()=>{this.initializeContextualUI(this.dDc())})}):ck.a.get_instance().Vk(7,()=>{this.initializeContextualUI(this.dDc())})}get Yqa(){return this.waa}get nra(){return l.AFrameworkApplication.K.$("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&l.AFrameworkApplication.na.Ya.WG?ck.a.get_instance().isCompleted(16)&&ck.a.get_instance().isCompleted(7):ck.a.get_instance().isCompleted(7)}e1j(){if(this.abg)return!0;try{return Promise.resolve(null),this.abg=!0}catch(a){return!1}}c_f(a){if(!this.nra||
this.MFe)return this.kqf("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.e1j())return this.kqf("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(l.AFrameworkApplication.V_)return this.kqf("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.MFe=!0;let c=Sa.a.pf;switch(a){case 1:c=Sa.a.showContextMenu;break;case 0:c=Sa.a.showFloatie;break;case 2:c=Sa.a.uac}window.requestAnimationFrame(()=>{window.setTimeout(()=>
{this.MFe=!1;re.c(c)},0)});return!1}GFh(a){return Hi.UISurfaces.BVa().then(c=>{if(appChrome.api.isSmallDevice()&&c.getBlockedSmallScreenFloatieGroupList){c=c.getBlockedSmallScreenFloatieGroupList();const h=[];for(const v of a)Array.contains(c,v)||h.push(v);return h}return a})}showFloatie(a,c,h){this.c_f(0)||this.GFh(c).then(v=>{if(0>=v.length)return null;this.DRf(v).then(()=>{const B={};B.target=a;Hi.UISurfaces.BVa().then(X=>{appChrome.api.dispatch(X.showFloatie(B,h));this.waa=!0;return null})});
return null})}showContextMenu(a,c,h=null,v=null){this.c_f(1)||this.rHi(a,c,h,v)}rHi(a,c,h=null,v=null){this.DRf(null).then(()=>{const B={};B.target=a;v&&(B.directionalHint=v);Hi.UISurfaces.BVa().then(X=>{appChrome.api.dispatch(X.showContextMenu(B,c,h));return null})})}tac(a,c,h,v=null){this.c_f(2)||this.GFh(c).then(B=>{0>=B.length?this.rHi(a,h,v):this.DRf(B).then(()=>{const X={};X.target=a;const ma={};ma.target=a;Hi.UISurfaces.BVa().then(Pa=>{appChrome.api.dispatch(Pa.showContextualUI(X,ma,h,void 0,
v));this.waa=!0;return null})});return null})}kqf(a){r.ULS.sendTraceTag(561394519,340,15,a)}hYe(){this.nra&&Hi.UISurfaces.isLoaded()&&Hi.UISurfaces.BVa().then(a=>{appChrome.api.dispatch(a.hideContextMenu());return null})}Ty(){this.nra&&Hi.UISurfaces.isLoaded()&&Hi.UISurfaces.BVa().then(a=>{this.waa=!1;appChrome.api.dispatch(a.hideFloatie());return null})}Mzc(){this.nra&&Hi.UISurfaces.isLoaded()&&Hi.UISurfaces.BVa().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.waa=!1;return null})}initializeContextualUI(a){return Hi.UISurfaces.BVa().then(c=>
{this.Jke||(c.initializeContextualUI(a),this.Jke=!0);return null})}DRf(a){if(!this.Jke)return this.initializeContextualUI(this.dDc()).then(()=>{this.setActiveFloatieGroups(a);return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var c=[];c.push(appChrome.actions.setActiveFloatieGroups(a));appChrome.api.dispatch(c);var h=[];Hi.UISurfaces.BVa().then(v=>{h.push.apply(h,this.Axe.E8b.OCd(v.selectors.getFloatieOnlyControlsMap(),9));0<h.length&&
appChrome.api.dispatch(h);return null})}}dDc(){if(this.d3a)return this.d3a;this.d3a=eF.a("div");this.d3a.id="ReactContextualUIDiv";this.d3a.style.position="absolute";this.d3a.style.zIndex="1001";document.body.insertBefore(this.d3a,document.body.firstChild);return this.d3a}tmm(a){a.Sa&&a.Sa.target&&"input"===a.Sa.target.tagName.toLowerCase()&&nc.FocusManager.instance().rA("ribbon");return!1}}Object(w.a)(kJ,"ReactContextualUILauncher",null,[849]);class lJ extends Ay.a{constructor(){super()}}Object(w.a)(lJ,
"FloatieBuildOptions",Ay.a,[]);class mJ extends kA.a{constructor(){super()}}Object(w.a)(mJ,"FloatieBuildContext",kA.a,[]);var yP=b(1367);class nJ extends dc.Builder{constructor(a,c,h){super(a,c,h,null);if(De.c(c))throw Error.create("Floatie placeholder DOM element is null or undefined.");}get floatie(){return this.root}Bkn(a){this.root=a}BWj(){const a=new mJ,c=new UB.a;c.zRc=1;c.handler=Object(m.a)(this,this.Urm,"onReturnFloatieData");c.data=a;this.Cpa.LZd(c)}Urm(a){this.CWj(a.RQc,a.Kxc);this.floatie.Umh=
this;this.floatie.Yk();this.floatie.Hb.style.display="none";this.placeholder.appendChild(this.floatie.Hb);this.Voa.continueWith(()=>{this.Voa.result.ICb(this.floatie)},11);Rh.a.instance.Ea(Jb.a.pointerDown,this.floatie.Hb,Object(m.a)(this.floatie,this.floatie.uC,"onPointerDown"))}CWj(a,c){a=Ii.a.m0(a,Ii.a.x1i);if(De.c(a))throw Error.create("No floatie element was present in the data");a=new Ii.a(a);this.Bkn(new Er(a.attributes[Ii.a.id],a.attributes));a=Ii.a.m0(a.node,Ii.a.zJb);this.tNe(a,c)}tNe(a,
c){a=Ii.a.Ls(a);for(let h=0;h<a.length;h++){if(this.mKa(a[h]))continue;const v=this.yNe(a[h],c);this.floatie.Je(v)}}yNe(a,c){var h=new Ii.a(a);a=new yP.Group(this.floatie,h.attributes[Ii.a.id],h.attributes[Ii.a.gma],h.attributes[Ii.a.Zdc],h.attributes[Ii.a.nOa],!1,h.name===Ii.a.G4i,!1,h.attributes);h=Ii.a.Ls(h.node);for(let v=0;v<h.length;v++)a.Je(this.Jnd(h[v],c));return a}Jnd(a,c){a=new Ii.a(a);var h=a.attributes[Ii.a.id];a=Ii.a.Ls(a.node);var v=2;2===a.length&&(v=3);h=new tf.a(this.floatie,h,v,
2,1);for(v=0;v<a.length;v++){const X=new Ii.a(a[v]);var B=Ii.a.m0(X.node,Ii.a.S1a);B=Ii.a.Ls(B);this.ENe(h.RBd(v+1),B,X.attributes[Ii.a.id],c)}return h}ENe(a,c,h,v){for(h=0;h<c.length;h++){if(this.mKa(c[h]))continue;const B=new Ii.a(c[h]),X=this.G_(c[h],v);X&&a.Je(X.ZN(B.attributes[Ii.a.$dc]))}}}Object(w.a)(nJ,"FloatieBuilder",dc.Builder,[]);class jE{constructor(a,c){this.It=null;this.Z9j=a;this.efe=c}get floatie(){return this.It}d9a(a,c,h){c=new bk.CuiHelper(uk.a.z8a,Box4Intl.Box4Strings,null,null,
c);const v=new lJ;v.vE=h||{};h=(h=xa.a.instance.ra("Box4.IFeatureHelper"))?h.Xt(21):Eb.App.Dod;v.vE.floatieshadingColor=!h;const B=new nJ(v,document.body,this.Z9j.Uvi);B.Cpa=new mA.a(a,c);B.BWj();this.efe.execute(X=>{B.floatie.GC=X});B.floatie.cTm(Object(m.a)(this,this.VQd,"onFloatieDismissed"));B.floatie.rSm(Object(m.a)(this,this.E2k,"getHiddenFloatieGroups"));this.It=B.floatie;return this.floatie}E2k(){return[]}}Object(w.a)(jE,"AFloatieInitializer",null,[]);class oJ extends jE{constructor(a,c,h,
v){super(c,h);this.xg=a;this.MB=v}d9a(a,c,h){if(a=super.d9a(a,c,h))a.U7b=!0,a.XUd=!0,a.preventDismissOnScroll=!0;this.xg.RSa(Object(m.a)(this,this.NDf,"pollForStateAndUpdateFloatie"));return a}tHc(a,c,h=null){this.MB.ZVg(()=>this.d9a(a,c,h))}VQd(){this.floatie.U7b=!0}NDf(){this.floatie.yk()}}Object(w.a)(oJ,"PasteFloatieInitializer",jE,[]);var EG=b(728);class Qx{Zsa(a,c){this.C1j&&this.zqn(a,c,Qx.Trf,Qx.Fa)}zqn(a,c,h,v){switch(h){case 1:case 6:case 2:case 3:case 4:Qx.GZe.show(v,a,c)}}S4h(){switch(Qx.Trf){case 5:case 1:return!0;
default:return!1}}iok(){return Qx.Trf}get C1j(){return 1!==Eb.App.oa.state}static get GZe(){return Qx.qic||(Qx.qic=xa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static Q6k(a){if(!a)return 0;if(2===Eb.App.oa.mode){const c=a.sa.node,h=Kd.GraphIterator.va(c);h.fn();return Bi.e(h.currentNode)?2:l.AFrameworkApplication.m_c||!Ou.isEmbeddedFileNode(c)||Ou.isInvalid(c)?Sg.a.qMl(a.sa)||Sg.a.ajf(a.sa)?6:1:3}return 4}static get Fa(){return $c.a.instance.Ca.Fa}static get Trf(){return Qx.Q6k(Qx.Fa)}}
Qx.qic=null;Object(w.a)(Qx,"SelectionContextMenuProvider",null,[1094]);var fF=b(1678);class gF{constructor(a,c){this.XUd=this.U7b=!1;this.dGc=!0;this.kL=a;this.Il=c}get isVisible(){return this.kL.Yqa}get controls(){return null}Ty(){this.kL.Ty();return!0}M_e(){}h0a(a,c,h){this.kL.showFloatie(Object.assign(new fF.a,{x:a.x,y:a.y}),this.J4e(h),h)}Ywb(){return new Sys.UI.Bounds(0,0,0,0)}U_(){return this.Ty()}J4e(){return[]}}Object(w.a)(gF,"ReactFloatie",null,[358,359]);class pJ{constructor(a){this.W3c=
null;this.kL=a}dispose(){}U_(){this.kL.Mzc();return!0}showContextMenu(a,c){this.PGb(a,c.clientPoint,c.He)}PGb(a,c,h){this.f0a(a,new Sys.UI.Bounds(c.x,c.y,0,0),h);r.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}f0a(a,c,h,v=null){this.W3c?this.kL.tac(Object.assign(new fF.a,{x:c.x,y:c.y}),this.W3c.J4e(h),h,a):this.kL.showContextMenu(Object.assign(new fF.a,{x:c.x,y:c.y}),h,a,v);this.W3c=null}uac(a,c,h,v){this.W3c=Object(ha.a)(gF,h);v.Zsa(a,c);return!0}oWb(){}}Object(w.a)(pJ,
"ReactContextMenuController",null,[721,14]);var zP=b(331);class qJ{constructor(){this.mea=this.text=this.oja=null}}Object(w.a)(qJ,"BusinessBarButtonData",null,[]);class FG{constructor(){this.text=this.oja=null}}Object(w.a)(FG,"BusinessBarLinkData",null,[]);var rJ=b(170);class GG{constructor(a,c,h,v){this.jig=this.mPb=this.xfg=this.G3a=this.ydg=null;this.Pq=a;this.tma=c;this.ga=h;this.qa=v}uDf(){this.sVb();this.Sod();this.gwc();this.c5j()}Sod(){}sVb(){const a=Eb.App.oa.Da.Zb;a&&(this.ydg=this.r1a(this.ydg,
1,2===Eb.App.oa.mode&&a.cId,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get lUl(){return Eb.App.YSi?H.a.Gi:!1}cVl(){return l.AFrameworkApplication.na&&1===l.AFrameworkApplication.na.mode}c5j(){this.lUl&&!this.mPb&&(this.mPb=this.tma.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.mPb.id=15,this.mPb.closeable=!0,this.mPb.addButton(Box4Intl.Box4Strings.L_DownloadNow,If.AppFrame.rLn,""),re.a("NewBrowserSuggestionShown"),this.Pq.Jz(this.mPb,!1))}gwc(){let a=null;const c=
Eb.App.oa.Da.s7;if(c){const h=c.gPc;rJ.a.GHd(h)?22===h?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===h||20===h?a=H.a.sh?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===h?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===h?a=H.a.sh?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===h&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):rJ.a.lJh(c.ESa)||Eb.App.Bn||this.cVl()||
(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.jig=this.r1a(this.jig,5,!!a,a)}HHi(a,c,h,v){a=this.tma.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.Vkd(c,()=>{Ve.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+h)});v&&(a.Cha=v);this.Pq.Jz(a,!0)}krn(a,c,h){this.HHi(a,c,h,null)}vrn(a){a=this.tma.create(null,a,null);a.closeable=!0;a.id=20;this.Pq.Jz(a)}Iqn(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,c=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;
this.G3a||(this.G3a=this.tma.create(a,c,null),this.G3a.closeable=!0,this.G3a.id=27,this.Pq.Jz(this.G3a))}HJh(){this.G3a&&(this.G3a=this.r1a(this.G3a,27,!1,""))}dTf(a){this.xfg=this.r1a(this.xfg,30,!0,a)}r1a(a,c,h,v,B=!1,X="",ma=null,Pa=null,mb=null){h?a?a.message=v:(a=this.tma.create(X,v,null),a.id=c,a.closeable=B,ma&&a.addButton(ma.text,ma.oja,ma.mea),Pa&&a.Vkd(Pa.text,Pa.oja),mb&&(a.Cha=mb),this.Pq.Jz(a,!1)):a&&(this.Pq.removeEntry(a),a=null);return a}aHe(a){this.Pq.Jz(a,void 0)}}Object(w.a)(GG,
"BusinessBarController",null,[225]);class kC extends GG{constructor(a,c,h,v){super(a,c,h,v);this.Xua=null}cxh(a,c,h=null,v=null,B=null,X=2){this.Xua||(this.Xua=this.tma.create(c,h||"",null),this.Xua.id=6,this.Xua.image=X,this.Xua.qJd=!1,a&&(this.Xua.errorCode=a),this.Xua.closeable=!1,c=l.AFrameworkApplication.pE&&this.qa.$("ShowFeedbackButtonOnKickoutBusinessBar"),v?(this.Xua.addButton(v,B,""),c&&this.Xua.JOg(WoncaIntl.WoncaStrings.L_GiveFeedback,()=>{this.qGh(a)})):c&&this.Xua.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,
()=>{this.qGh(a)},""),this.Pq.Jz(this.Xua,void 0,null,null,null))}qGh(a){r.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{["ErrorCode"]:a});this.ga.hb(Sa.a.giveFeedback,2,{["ErrorCode"]:a})}static get Kd(){return vg.PageReader.instance}}Object(w.a)(kC,"BusinessBarController",GG,[224,225]);class HG{static get $8h(){const a=F.a.ui(vi.a.af(l.AFrameworkApplication.lcid).name);return String.format("https://r.office.microsoft.com/r/rlidWebOpenDocumentDetails?clid={0}",a)}}Object(w.a)(HG,
"OdtUtils",null,[]);class sJ extends kC{constructor(a,c,h,v){super(a,c,h,v);this.Ekb=this.Ljc=this.nug=this.GGa=this.sug=this.qGg=null;this.ulj="https://go.microsoft.com/fwlink/?linkid=2134357"}uDf(){super.uDf();this.H4j()}Sod(){const a=Eb.App.oa.Da.Zb;if(a){var c=Eb.App.QX;if(Eb.App.Wr||Eb.App.Bn||c&&l.AFrameworkApplication.zt)this.qGg=this.r1a(this.qGg,4,kC.Kd.rKc(a),Box4Intl.Box4Strings.l_BusinessBarSigned,!0),this.sug=this.r1a(this.sug,3,kC.Kd.Q2b(a),Box4Intl.Box4Strings.l_BusinessBarMarkedAsFinal,
!0),this.nug=this.r1a(this.nug,8,kC.Kd.wck(a),Box4Intl.Box4Strings.l_BusinessBarContainsMalformedHyperlinkUris,!0),kC.Kd.XKc(a)?this.GGa||(this.GGa=this.tma.create(Box4Intl.Box4Strings.l_BusinessBarCompatTitle,Box4Intl.Box4Strings.l_BusinessBarCompatMessage,null),this.GGa.id=14,this.GGa.closeable=!0,this.GGa.image=3,this.GGa.addButton(Box4Intl.Box4Strings.L_LearnMore,If.AppFrame.tYl,""),this.Pq.Jz(this.GGa,!1)):this.GGa&&(this.Pq.removeEntry(this.GGa),this.GGa=null)}}H4j(){if(S.App.KJc){const a=HG.$8h,
c=this.tma.create(Box4Intl.Box4Strings.l_BusinessBarODTDocumentTitle,Box4Intl.Box4Strings.l_BusinessBarODTDocument,null);c.id=9;c.closeable=!0;c.ZDj(a);this.Pq.Jz(c,!0)}}lrn(a,c){if(Eb.App.oa.Da.Zb){const h=new qJ;h.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptSendButton;h.oja=()=>{a()};const v=new FG;v.text=WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptPrivacyLinkText;v.oja=()=>{Ve.a.openWindow(4,l.AFrameworkApplication.Pfb)};this.Ljc=this.r1a(this.Ljc,25,!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptMessage,
!0,WordEditorIntl.WordEditorStrings.l_BusinessBarMergePromptTitle,h,v,()=>{c()})}}Hul(){this.Ljc&&(this.Ljc=this.r1a(this.Ljc,25,!1,""))}tqn(){if(Eb.App.oa.Da.Zb){const a=new FG;a.text=WordEditorIntl.WordEditorStrings.L_CitationStyleLearnMore;a.oja=()=>{Ve.a.openWindow(4,this.ulj)};this.Ekb||(this.Ekb=this.tma.create(WordEditorIntl.WordEditorStrings.L_CitationStylePromptTitle,WordEditorIntl.WordEditorStrings.L_CitationStylePromptText,null),this.Ekb.id=32,this.Ekb.closeable=!0,this.Ekb.image=3,this.Ekb.Vkd(a.text,
a.oja),this.Pq.Jz(this.Ekb,!1))}}Sca(a){return this.Pq.Sca(a)}Jz(a,c){this.Pq.Jz(a,c)}}Object(w.a)(sJ,"BusinessBarController",kC,[530,224,225]);class tJ{constructor(){this.menuTargetType=null}}Object(w.a)(tJ,"MenuTargetDescriptor",null,[]);class Zs{static get O_(){return Zs.VP||(Zs.VP=xa.a.instance.resolve("Box4.IContextMenuController"))}static Tgk(a){Zs.O_.oWb(a,"mnuNavPaneWordEditor","","","Menu16")}static showContextMenu(a,c){Zs.O_.showContextMenu(a,c)}static PGb(a,c,h){Zs.O_.PGb(a,c,h)}static f0a(a,
c,h,v=null){Zs.O_.f0a(a,c,h,v)}static oCc(a,c,h,v){return jf.a(a,c.toString(),v,h)}}Zs.VP=null;Object(w.a)(Zs,"BaseContextMenu",null,[]);class Bj extends Zs{constructor(a,c,h,v=!1,B,X=null,ma){super();this.zHm=c;this.Fj=h;this.Pi=X;this.ooe=v;this.eb(a);this.z2a=ma;Bj.QRa[1]=zb.a.Y2d;Bj.QRa[2]=zb.a.hDd;Bj.QRa[3]=zb.a.D3d}get Yyk(){return Th.a.Csd}get Xyk(){return Th.a.crd}get Zyk(){return Th.a.VTd}get EZe(){return Th.a.Kgi}eb(a){a.Aa(zb.a.XDf,ic.a.application,Object(m.a)(this,this.xUd,"populateContextMenu"),
96);a.Aa(zb.a.gii,ic.a.application,Object(m.a)(this,this.xUd,"populateContextMenu"),96)}show(a,c,h){let v=null,B=new Sys.UI.Bounds(0,0,0,0);const X=this.ecl(a);if(X&&(a=a.sa.node)&&(a=a.Sd(ec.InteractiveViewManager.instance.rc.gb))){B=fu.a.Zo(a,X.end);if(l.AFrameworkApplication.isRtl&&B.x>c.x||!l.AFrameworkApplication.isRtl&&B.x+B.width<c.x||B.y+B.height<c.y)B=fu.a.Zo(a,X.end-1);c.x=B.x+(l.AFrameworkApplication.isRtl?0:B.width);c.y=B.y+B.height;v=6}Zs.f0a("ContextMenu",new Sys.UI.Bounds(c.x,c.y,B.width,
B.height),h,v)}xUd(a,c,h,v,B){if(1===h)return 32;a=B.wF;B=B.Ac;c=Object.assign(new Ah.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.Ajk(c,a,B.IsShadowMenuOpen);B.MenuItems=c;return 32}B8(a,c){let h=!1,v=!1;return this.BWc(a)||Bj.ewc(zb.a.mergeCells)||Bj.ewc(zb.a.Ohb)||this.MTf(a)||this.lHi(a,c)||Bj.ZHi()||({CWa:h,W0b:v}=Bj.NHi(a,h,v)).returnValue}BWc(a){return 2===Eb.App.oa.mode&&this.EJc(a)}Ayc(a,c,h=null){if(Js.a.hx()&&2===Eb.App.oa.mode){c=this.z2a.Y6g(a.sa);if(!c||
!this.oRl()&&!this.ESl(c.errorDetails))return;c=c.errorDetails}else{if(!this.BWc(a))return;c=this.$Ah(a)}var v=vi.a.af(c.lcid);const B=v?v.name:"UNKNOWN";v=Object(Ub.a)(En.a,c)?c.typeId:"";r.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",c.errorType,c.proofingType,v,B);if(a=this.zHm.AWb(a,c))h.push.apply(h,a),this.R7l(c,v)}ESl(a){return a&&(1===a.proofingType||2===a.proofingType)}oRl(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RightClickALV2Refinement",
!1)}R7l(a,c){const h=Bj.QRa[a.proofingType];h&&(l.AFrameworkApplication.pa.processAction(h,2),r.ULS.sendTraceTag(527799885,375,50,"AEditSurfaceContextMenu: Logging command {0}, typeId {1}, proofingType {2}, ALV2 flight {3}.",h,c,a.proofingType,Js.a.hx()))}$Ah(a){return this.Fj.Lia(a.sa).errorDetails}EJc(a){return this.Fj.o_d(a)}FZb(){return null}yrd(){}ecl(a){return this.EJc(a)?this.Fj.Lia(a.sa):(a=this.FZb(a))?new Oa.a(a.$q,a.cpEnd):null}MTf(a){if(2!==Eb.App.oa.mode||!a)return!1;a=ZA.a.mxa(a.toArray());
return!!Bj.uf.RQ(a,14)}zIi(a,c){return 2===c||3===c&&!this.EJc(a)}lHi(a,c){return 3!==c||this.EJc(a)}vgk(){const a=[];a.push(Object.assign(new qh.a,{ExternalId:this.Yyk}));a.push(Object.assign(new qh.a,{ExternalId:this.Xyk}));a.push(Object.assign(new qh.a,{ExternalId:this.Zyk}));return a}Dkk(){const a=[];this.ooe&&a.push(Object.assign(new qh.a,{ExternalId:this.EZe}));return a}static get Yb(){return Bj.zc||(Bj.zc=xa.a.instance.resolve("Box4.List.IListReader"))}static get uf(){return Nm.ContextSetEditor.instance}static get pMl(){null==
Bj.Fne&&(Bj.Fne=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("HyperlinkContextMenuOnEOPFixIsEnabled"):!1);return Bj.Fne}static get qNc(){null==Bj.Sjb&&(Bj.Sjb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("MultiParagraphHyperlinkEditEnabled"):!1);return Bj.Sjb}static get p_(){null==Bj.KS&&(Bj.KS=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Bj.KS}static ewc(a){return 32===l.AFrameworkApplication.pa.processAction(a,1)}static ZHi(){return 2===
Eb.App.oa.mode&&!!Eb.App.wu.wG&&Eb.App.wu.wG.hKc(zb.a.GSd.toString())}static aIi(a){if(1!==a.length||!a.sa.Kk)return!1;a=Kd.GraphIterator.va(a.sa.node);a.La(11);a.ob();return a.pp(4)&&!Bj.Yb.Op(a).listType?!0:!1}static NHi(a,c,h){c=h=!1;if(!a)return{returnValue:!1,CWa:c,W0b:h};if(Bj.qNc)return Bj.urn(a,c,h);if(!(a.eC||Bj.pMl&&2===a.length&&a.Pb.contextId===ic.a.endOfParagraph))return{returnValue:!1,CWa:c,W0b:h};a=a.sa.clone();c=32===l.AFrameworkApplication.pa.Le(a,zb.a.ELa,1,!0,null,null);h=32===
l.AFrameworkApplication.pa.Le(a,zb.a.insertHyperlink,1,!0,null,null);return{returnValue:c||h,CWa:c,W0b:h}}static urn(a,c,h){let v;h=a.sa.clone();v=Bj.p_&&ac.l(h);c=!v&&32===l.AFrameworkApplication.pa.Le(h,zb.a.ELa,1,!0,null,null);if(a.eC||2===a.length&&a.Pb.contextId===ic.a.endOfParagraph)h=!v&&32===l.AFrameworkApplication.pa.Le(h,zb.a.insertHyperlink,1,!0,null,null);else{h=!0;const B=a.length;for(let X=0;X<B;X++){const ma=a.J(X).clone();if(ma.contextId===ic.a.paragraph||ma.contextId===ic.a.xc)(v=
Bj.p_&&ac.l(ma))||(h=32===l.AFrameworkApplication.pa.Le(ma,zb.a.insertHyperlink,1,!0,null,null)&&h);else if(ma.contextId!==ic.a.endOfParagraph)return h=c=!1,{returnValue:!1,CWa:c,W0b:h}}}return{returnValue:c||h,CWa:c,W0b:h}}static iyh(a){const c=Object.assign(new Hg.a,{ControlList:[]});for(const h of a)Array.add(c.ControlList,Object.assign(new qh.a,{ExternalId:h}));return c}static rF(a){let c=[];for(const h of a)Array.add(c,Object.assign(new qh.a,{ExternalId:h}));return c}}Bj.Fne=null;Bj.zc=null;
Bj.Sjb=null;Bj.KS=null;Bj.QRa=[];Object(w.a)(Bj,"AEditSurfaceContextMenu",Zs,[]);var AP=b(554),BP=b(772);class pq{static QYk(a,c,h){return h.ltk(a)?Bj.rF(["ReviewDesignerSuggestion"]):[]}static $6k(){return Bj.ewc(zb.a.mergeCells)?Bj.rF(["MergeCells"]):Bj.ewc(zb.a.g3d)?Bj.rF(["SplitCells"]):[]}static Gjl(a,c,h){c=[];if(!h.Wg.V5g(a))return c;a=h.Wg.ZEh(a);c.push(Object.assign(new qh.a,{ExternalId:"AcceptChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,
WordEditorIntl.WordEditorStrings.L_AcceptChange,a)}));c.push(Object.assign(new qh.a,{ExternalId:"RejectChangeContext",LabelText:String.format(WordEditorIntl.WordEditorStrings.L_TrackChangeContextMenuTextFormat,WordEditorIntl.WordEditorStrings.L_RejectChange,a)}));return c}static bUk(a,c,h){return l.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&a&&a.sa&&a.sa.node&&h.Kb&&h.Kb.a8h(a.sa.node)?Bj.rF(["ShowCatchUpActivitiesForParagraph"]):[]}static JZk(a){return mn.RHi(a)?Bj.rF(["EditIllustration"]):
[]}static lml(a,c,h){return h.K.$("WordEditorWrapTextIsEnabled")&&mn.$sn(a)?[Object.assign(new ph.a,{ExternalId:"WrapTextMenu"})]:[]}static FBd(a,c,h){return h.Ctk(a)?Bj.rF(["CreatePullQuote"]):[]}static yVk(){return mn.oHi()?Bj.rF(["NewComment"]):[]}static tUk(a){let c=[];!mn.LTf(a)&&mn.rTf(a)&&ya.SessionStatusManager.instance.pK&&a.zM&&Array.add(c,Object.assign(new ph.a,{ExternalId:"ChangePictureMenu",QueryCommand:"QueryChangePictureHostButton"}));return c}static j4k(a,c,h){c=[];!mn.LTf(a)&&mn.rTf(a)&&
ya.SessionStatusManager.instance.pK&&(r.ULS.sendTraceTag(39188235,1303,50,"Showing Insights context menu option"),a.zM&&!l.AFrameworkApplication.K.$("ChangePicturesIsEnabled")?c.push(...Bj.rF(["ChangePicture"])):c.push(...h.Oik().ControlList),(a=mn.iAd())&&0<a.length&&(h=h.nmk(a),null!=h&&c.push(...h.ControlList)));return c}static bcl(){return Bj.ZHi()?Bj.rF(["SetProofingLanguage"]):[]}static Fdl(a,c,h){return h.nRl&&h.psn(a)?Bj.rF(["Rewrite"]):[]}static J5k(a){return Bj.aIi(a)?Bj.rF(["StartNewList",
"ContinueNumbering","SetNumberingValue"]):[]}static Y$k(){return mn.mIi()?Bj.rF(["ParagraphOptions"]):[]}static g3k(a){return mn.RHi(a)?Bj.rF(["EditIllustration"]):[]}static mgl(a){return mn.LTf(a)?Bj.rF(["ShowSmartLookupPane"]):[]}static Njl(a){return mn.dIi(a)?Bj.rF(["ModernTranslatorSplitButton"]):[]}static s2k(a,c,h){c=[];if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled",!1)&&a.eC){const v=a.sa;if(v.contextId===ic.a.paragraph||v.contextId===
ic.a.Ub||v.contextId===ic.a.xc){a=a.sa.node;if(!h.eo.tb(a)||a.kr||""===a.characterData)return c;h.BXb.Uzd(a)&&c.push(...Bj.rF(["CreateHeadingLink"]))}}return c}static getBookmark(a,c,h){c=[];if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)&&a.eC){const v=a.sa;(Gc.SelectionEditor.ke(v)||Gc.SelectionEditor.qXa(v))&&h.oUj.Uwb(a.sa.node,a.sa.cpBegin)&&(c.push(...Bj.rF(["DeleteBookmarkContextMenu"])),c.push(...Bj.rF(["EditBookmarkNameContextMenu"])))}return c}static q8(a){let c=
!1,h=!1,v=[];({CWa:c,W0b:h}=Bj.NHi(a,c,h)).returnValue&&(c?h?v.push(...Bj.rF(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):v.push(...Bj.rF(["OpenHyperlink"])):h&&(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)?v.push(...Bj.rF(["InsertLinkFlyout"])):v.push(...Bj.rF(["InsertLink"]))));return v}static aVk(a,c,h){let v=[];if(!h.lHi(a,c))return v;2===Eb.App.oa.mode?(v.push(...h.vgk()),v.push(...h.Dkk()),3===
c&&h.EJc(a)&&Array.add(v,Object.assign(new qh.a,{ExternalId:"Delete"}))):l.AFrameworkApplication.protectFile||Array.add(v,Object.assign(new qh.a,{ExternalId:"Copy"}));return v}static X4e(a,c,h){return h.MTf(a)&&h.zIi(a,c)?Bj.rF(["EditTableAltText"]):[]}static Owh(a,c,h){return h.vtk(a)?Bj.rF(["ShowIntentSuggestion"]):[]}static Vhl(a,c,h){const v=[];h.MTf(a)&&!h.zIi(a,c)&&(Array.add(v,Object.assign(new ph.a,{ExternalId:"InsertTableMenu"})),Array.add(v,Object.assign(new ph.a,{ExternalId:"DeleteTableMenu"})),
Array.add(v,Object.assign(new ph.a,{ExternalId:"SelectTableMenu"})));return v}static $hl(a,c,h){return mn.Ua.isFeatureEnabled(182)&&h.Fsn(a)?Bj.rF(["UpdateTableOfContents"]):[]}static p_k(a){return mn.Tqn(a)?Bj.rF(["ShowHideEquationToolsPane"]):[]}}Object(w.a)(pq,"ContextMenuSectionItemHelper",null,[]);class cD{static DQk(a,c,h){return h.K.$("AddInCommandsIsEnabled")?(c=[],cD.Dfk(a,S.App.Hk.Da.Jb.Ma.TY,c),c):[]}static Dfk(a,c,h){2===S.App.Hk.mode&&mn.TPj&&(c=Kd.GraphIterator.va(c),mn.QDj(h,a,c))}static qbl(a,
c,h){c=[];h.hEm.AWb(h.oRk(a),c);return c}static dZk(a,c,h){const v=[];if(h.BWc(a))return v;h.K.$("WordEditorIdeasCardsIsEnabled")&&!H.a.Gi||h.BXe.yrd(a,null,c,v);return v}static tgl(a,c,h){const v=[];h.Ayc(a,c,v);return v}}Object(w.a)(cD,"ContextMenuSectionHelper",null,[]);class mn extends Bj{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh,Fi=!1,wk=null,Gk=null,Kl,Yj,ao){super(a,c,h,Fi,void 0,wk,Kl);this.Ewe=this.VV=null;this.ylg=!1;this.tUc=new Map;this.JC={};this.r5b={};this.K=v;this.Wg=
B;this.Bb=X;this.tQ=Pa;this.gG=mb;this.sr=Tb;this.hzj=!!wk;this.BXe=rc;this.hEm=Tc;this.VLb=Xe;this.oW=Yf;this.oUj=Hh;this.Mma=ao;this.Ba=Yj;Ie&&Ie.execute(oq=>{this.lEg=oq});vd&&vd.execute(oq=>{this.Ewe=oq});this.Kb=ma;this.Fu=ee;Gk&&Gk.execute(oq=>{this.VV=oq});this.hzl();this.sCm();this.BGk();this.rCm()}static get TPj(){return mn.a$f}get eo(){return this.Ba}get BXb(){return this.Mma}static get QDj(){return mn.g9f}get EZe(){return this.hzj?Th.a.TTd:super.EZe}PQm(a){mn.a$f=a}KQm(a){mn.g9f=a}Von(){const a=
S.App.Hk.Da.Jb.Ma.Ca.Fa;return this.BWc(a)&&2!==this.$Ah(a).errorType}B8(a,c){return super.B8(a,c)||mn.mIi()||Bj.aIi(a)||mn.oHi()||mn.rTf(a)||mn.dIi(a)}Ajk(a,c,h){const v=[];let B=null;try{B=S.App.Hk.Da.Jb.Ma.Ca.Fa}catch(X){r.ULS.sendTraceTag(576481226,341,15,"Selection was not initialized in time for ContextMenu Population");return}this.iCm(B,c,v,this.MWk(B));a.MenuSectionList.push(...v);this.qgn(a);!h&&this.lEg&&this.lEg.WFm(a.MenuTargetDescriptor.menuTargetType,v)}MWk(a){return Bj.ewc(zb.a.mergeCells)?
Rx.q7f:a.zM?Rx.j6f:a.t3b()?Rx.W3f:Rx.s4f}Pik(a){a=mn.kUe(a);return Object.assign(new qh.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}omk(a){return(a=mn.C0i(a))?Object.assign(new qh.a,{ExternalId:"SmartLookupSynonyms",LabelText:a}):null}Oik(){const a=Object.assign(new Hg.a,{ControlList:[]}),c=mn.iAd();Array.add(a.ControlList,this.Pik(c));return a}nmk(a){const c=Object.assign(new Hg.a,{ControlList:[]});if(a&&0<a.length){a=this.omk(a);if(null==a)return null;c.ControlList.push(a)}return c}R3b(a){return a.zM||
2<a.length||!a.length||2===a.length&&!Gc.SelectionEditor.mj(a.Pb)||1===a.length&&Gc.SelectionEditor.mj(a.Pb)?!1:this.Kmf(a.sa)}Kmf(a){return sd.ParagraphReader.tb(a.node)?""!==sd.ParagraphReader.text(a.node).trim():!1}Fsn(a){var c=Kd.GraphIterator.va(a.sa.node);c=Object(ha.a)(AP.a,c.currentNode);return kg.a.instance.J(5)&&a.zM?!1:!!c&&c.kr}BGk(){l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",
!1)?this.Fu.execute(a=>{a.isFeatureEnabled(BP.a.m7h,!1).then(c=>{c||r.ULS.sendTraceTag(592995265,341,50,"Rewrite license missing, skip creating context menu item");this.ylg=c;return null})}):r.ULS.sendTraceTag(592995266,341,50,"Rewrite flight not enabled, skip creating context menu item")}get nRl(){l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordRewriteSettings");return this.K.$("RewriteIsEnabled")||this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",
!1)?this.ylg:!1}psn(a){if(!this.R3b(a)||a.n2b||a.t3b())return!1;a=a.sa;if(sd.ParagraphReader.Wk(a)||Gc.SelectionEditor.ke(a)||Gc.SelectionEditor.tj(a)){a=this.gG.UVa(a);a||(a=l.AFrameworkApplication.lcid);switch(a&1023){case 9:return!0;case 10:if(this.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RewriteIsEnabledFromControlTower",!1))return!0}return!1}}vtk(a){if(1!==a.length||H.a.Gi)return!1;const c=l.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled");if(c&&this.Von()||Js.a.hx()&&this.z2a.Y6g(a.sa))return!1;
const h=mn.Ua.isFeatureEnabled(104);return a.J(0).contextId===ic.a.Ub&&(c||h)&&0<this.sr.SDc(a.J(0),0).count||c&&this.FZb(a)?!0:!1}ltk(a){return 1===a.length&&this.VLb.QD(a.sa.node).wja}get mw(){return mn.z4c||(mn.z4c=xa.a.instance.ra("WordEditor.Designer.IDesignerTaskPane"))}Ctk(a){if(!this.oW.nRh()||!this.mw||this.mw.isVisible||!(1===a.length||2===a.length&&Gc.SelectionEditor.mj(a.Pb))||a.pdb||!Gc.SelectionEditor.tj(a.sa)&&a.sa.contextId!==ic.a.paragraph||a.TRl()||this.VLb.QD(a.sa.node).wja)return!1;
const c=sd.ParagraphReader.text(a.sa.node),h=a.sa.contextId===ic.a.paragraph?0:a.sa.cpBegin,v=a.sa.contextId===ic.a.paragraph?c.length:a.sa.cpEnd-h;return 1>v||1500<v||F.a.ve(F.a.Csa(c.substr(h,v)))||1!=vr.a.uab(a.sa.node)?!1:!0}FZb(a){return this.BXe.FZb(a)}yrd(a,c,h,v=null){this.BWc(a)||this.BXe.yrd(a,c,h,v)}oRk(a){return this.Ewe?this.Ewe.pRk(a):[]}qgn(a){const c=this.VV?this.VV.contentType:"Unknown";a.MenuTargetDescriptor=Object.assign(new tJ,{menuTargetType:c})}static get Ua(){return mn.Na||
(mn.Na=xa.a.instance.resolve("Box4.IFeatureHelper"))}static rTf(a){return l.AFrameworkApplication.EX&&!a.n2b&&xa.a.instance.resolve("Box4.Insights.IBox4InsightsSelection").HUl()}static GBd(a){a=a?a.trim():null;let c=20;a&&0<a.length&&(a.length>c&&(c=F.a.jx(a,c)?c-1:c),a=a.length>c?a.substr(0,c).trim()+"...":a);return a}static kUe(a){let c=WordEditorIntl.WordEditorStrings.L_ContextMenuSmartLookup;(a=mn.GBd(a))&&0<a.length&&(c=String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSmartLookup,
a));return c}static C0i(a){a=mn.GBd(a);return null!=a&&0<a.length?String.format(WordEditorIntl.WordEditorStrings.L_ContextMenuTextSynonyms,a):null}static iAd(){const a=(new Bo.a).getSelectedText();return a.neighborhood.substr(a.mentionStart,a.mentionLength)}static RHi(a){const c=mn.Ua.isFeatureEnabled(81);return!a.Dqd&&c&&!H.a.Gi&&(a.n2b||c&&a.zM)}static LTf(a){return l.AFrameworkApplication.K.$("WordEditorSmartLookupIsEnabled")&&!a.t3b()}static dIi(a){return l.AFrameworkApplication.K.$("LanguageTranslationIsEnabled")&&
!a.n2b&&!a.t3b()}static oHi(){return mn.Ua.Xt(28)}static Tqn(a){return a.sWh()&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EquationToolsIsEnabled",!1)}static mIi(){return 2===S.App.Hk.mode}static $sn(a){return a.zM&&mn.Ua.isFeatureEnabled(220)}iCm(a,c,h,v){this.r5b[v].forEach(B=>{const X=Object.assign(new Hg.a,{ControlList:[]}),ma=X.ControlList;B.forEach(Pa=>{Pa instanceof kr?h.push(...this.tUc.get(Pa)(a,c,this)):ma.push(...this.JC[Pa](a,c,this))});(null===ma||void 0===
ma?0:ma.length)&&h.push(X)})}rCm(){this.tUc.set(kr.W8d,cD.DQk);this.tUc.set(kr.BJb,cD.qbl);this.tUc.set(kr.i9d,cD.dZk);this.tUc.set(kr.$9d,cD.tgl)}sCm(){this.JC[Ph.bec]=pq.aVk;this.JC[Ph.b$d]=pq.Vhl;this.JC[Ph.c$d]=pq.$hl;this.JC[Ph.h9d]=pq.QYk;this.JC[Ph.B9d]=pq.$6k;this.JC[Ph.X8d]=pq.X4e;this.JC[Ph.u9d]=pq.j4k;this.JC[Ph.y0c]=pq.Owh;this.JC[Ph.G4f]=pq.g3k;this.JC[Ph.Z9d]=pq.mgl;this.JC[Ph.e$d]=pq.Njl;this.JC[Ph.I9d]=pq.bcl;this.JC[Ph.M9d]=pq.Fdl;this.JC[Ph.z0c]=pq.J5k;this.JC[Ph.D0c]=pq.Y$k;this.JC[Ph.J9d]=
pq.FBd;this.JC[Ph.y$d]=pq.lml;this.JC[Ph.j9d]=pq.JZk;this.JC[Ph.b9d]=pq.tUk;this.JC[Ph.d$d]=pq.Gjl;this.JC[Ph.a9d]=pq.bUk;this.JC[Ph.n0c]=pq.getBookmark;this.JC[Ph.r9d]=pq.s2k;this.JC[Ph.t9d]=pq.q8;this.JC[Ph.wJb]=pq.yVk;this.JC[Ph.y0c]=pq.Owh;this.JC[Ph.l9d]=pq.p_k}hzl(){const a=[Ph.B9d,Ph.X8d,Ph.b$d];this.r5b[Rx.q7f]=[[Ph.bec],a,[Ph.wJb],[kr.BJb]];this.r5b[Rx.j6f]=[[Ph.bec],[Ph.b9d,Ph.j9d,Ph.y$d],a,[Ph.wJb],[kr.BJb]];this.r5b[Rx.W3f]=[[Ph.l9d],[Ph.z0c,Ph.D0c],[Ph.n0c,Ph.wJb],[kr.BJb]];this.r5b[Rx.s4f]=
[[Ph.y0c],[Ph.h9d],[kr.$9d],[kr.i9d],[Ph.bec],[Ph.u9d,Ph.G4f,Ph.Z9d,Ph.e$d],[Ph.I9d,Ph.M9d,Ph.D0c],[Ph.z0c],a,[Ph.t9d,Ph.n0c,Ph.r9d,Ph.wJb],[Ph.J9d],[Ph.d$d],[Ph.a9d],[kr.W8d],[Ph.c$d],[kr.BJb]];this.r5b[Rx.n2i]=[[Ph.y0c],[Ph.h9d],[kr.$9d],[kr.i9d],[Ph.bec],[Ph.b9d],[Ph.j9d],[Ph.y$d],[Ph.u9d],[Ph.Z9d],[Ph.e$d],[Ph.I9d],[Ph.M9d],[Ph.l9d],[Ph.z0c],[Ph.D0c],[Ph.t9d],[Ph.B9d],[Ph.X8d],[Ph.b$d],[Ph.n0c],[Ph.r9d],[Ph.wJb],[Ph.J9d],[Ph.d$d],[Ph.a9d],[kr.W8d],[Ph.c$d],[kr.BJb]]}}mn.a$f=null;mn.g9f=null;mn.Na=
null;mn.z4c=null;Object(w.a)(mn,"EditSurfaceContextMenu",Bj,[]);var Rx;(function(a){a[a.q7f=1]="TABLE_MULTI_CELL";a[a.s4f=2]="GENERIC";a[a.j6f=3]="PICTURE";a[a.W3f=4]="EQUATION";a[a.n2i=5]="LEGACY"})(Rx||(Rx={}));Object(w.b)("Scenarios",Rx);class kr{}kr.W8d=new kr;kr.BJb=new kr;kr.i9d=new kr;kr.$9d=new kr;Object(w.a)(kr,"Sections",null,[]);var Ph;(function(a){a[a.y0c=1]="INTENT_SUGGESTION";a[a.bec=2]="ESSENTIALS";a[a.u9d=3]="INSIGHT";a[a.G4f=4]="ILLUSTRATION";a[a.Z9d=5]="SMART_LOOKUP";a[a.e$d=6]=
"TRANSLATE";a[a.I9d=7]="PROOFING";a[a.M9d=8]="REWRITE_SUGGESTIONS";a[a.z0c=9]="LISTS";a[a.D0c=10]="PARAGRAPH_OPTIONS";a[a.B9d=11]="MERGE_SPLIT_CELLS";a[a.X8d=12]="ALT_TEXT";a[a.t9d=13]="HYPERLINK";a[a.n0c=14]="BOOKMARK";a[a.r9d=15]="HEADING_LINK";a[a.wJb=16]="COMMENT";a[a.J9d=17]="PULL_QUOTE";a[a.y$d=18]="WRAP_TEXT";a[a.j9d=19]="DRAW_ANNOTATE";a[a.d$d=20]="TRACK_CHANGE";a[a.a9d=21]="CATCHUP_ACTIVITIES";a[a.c$d=22]="TABLE_OF_CONTENTS";a[a.h9d=23]="DESIGNER_REVIEW";a[a.b$d=24]="TABLE_ITEMS";a[a.b9d=
25]="CHANGE_PICTURE";a[a.l9d=26]="EQUATION_TOOLS"})(Ph||(Ph={}));Object(w.b)("SectionItem",Ph);class AA extends Zs{constructor(a,c,h){super();this.Gk=null;this.ga=a;this.Lj=c;this.jD=h;this.eb()}get B4a(){return document.getElementById("WACHorizontalRuler")}get nL(){return this.Lj&&this.Lj.instance?this.Lj.instance.ei:1}get target(){return this.Gk}show(a,c){this.Gk=a;Zs.PGb("RulerContextMenu",a,c);r.ULS.sendTraceTag(592307397,3014,50,"Ruler Context menu invoked.");a=new Map;a.set("Command","Show");
a.set("Source",AA.M0);a.set("Response","Ruler Context menu invoked.");Fa.Health.instance.recordKpiUsage(AA.kpiName,1,AA.d0,a)}$cl(){var a=0,c=(this.target.x-Ve.a.z5e(this.B4a))/this.nL;c=Be.a.ry(c,0);var h={},v=this.jD.EYb,B=Kd.GraphIterator.va(v);B.nc();if(!Wf.TableReader.Jv(B))return 32===this.ga.hb(zb.a.nBa,2,h)&&(a=h.marginLeft),c-a;a={};B={};h=this.ga.hb(zb.a.tRc,2,a);var X=this.ga.hb(zb.a.rEb,2,B);if(32!==h||32!==X)return r.ULS.sendTraceTag(559252943,3014,15,"Unable to read table properties for Ruler Context Menu"),
c;a=a.ColumnWidths;X=B.TablePosition;if(!X||!a||0>=a.length)return r.ULS.sendTraceTag(559252944,3014,15,"Queried table properties are null or do not exist"),c;h=0;B=Kd.GraphIterator.va(v);B.La(14)&&(B.mc(16),h=Or.a(B,!0));v=X.x/this.nL;for(B=0;B<h;B++)v+=a[B];return c-v}eb(){this.ga.Aa(ba.a.EUd,ic.a.application,Object(m.a)(this,this.EUd,"populateRulerContextMenu"),96)}EUd(a,c,h,v,B){if(1===h)return 32;a=[];c=[];this.Xon()&&c.push("InsertTabStopMenuSplitButton");this.Hon()&&c.push("ClearAllTabStops");
c.push("HideRuler");a.push(AA.iyh(c));c=Object.assign(new Ah.a,{ExternalId:"RulerContextMenu",UpdateDynamically:!0,MenuSectionList:[]});c.MenuSectionList.push(...a);B.MenuItems=c;return 32}Xon(){var a={},c={},h=this.ga.hb(zb.a.nBa,2,a),v=this.ga.hb(zb.a.TZa,2,c);if(32===h&&32===v){v=c.Ar;h=Be.a.Vh(v.mja,0);v=1===v.specialIndentType?Be.a.Vh(v.az,0):Be.a.Vh(v.az-v.m$,0);const B=Be.a.Vh(a.marginLeft,0);a=Be.a.Vh(a.marginRight,0);const X=Ve.a.z5e(this.B4a),ma=Ve.a.Uqh(this.B4a);c.isRtl?(c=X+this.nL*Math.max(a,
a+h),h=ma-this.nL*Math.max(B,B+v)):(c=X+this.nL*Math.max(B,B+v),h=ma-this.nL*Math.max(a,a+h));if(this.target.x>=c&&this.target.x<=h)return!0}return!1}Hon(){var a={};if(32!==this.ga.hb(ba.a.eEb,2,a)||!a)return!1;a=a.customTabs;return!a||0>=a.length?!1:!0}static iyh(a){const c=Object.assign(new Hg.a,{ControlList:[]});for(let h of a)Array.add(c.ControlList,Object.assign(new qh.a,{ExternalId:h}));return c}}AA.d0="wwaengidc";AA.kpiName="WordRuler";AA.M0="RulerContextMenu";Object(w.a)(AA,"RulerContextMenu",
Zs,[531]);let Oy;class Op{static get qb(){return Op.$b||(Op.$b=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}static get BB(){return Op.XB||(Op.XB=xa.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}static get Ei(){return Op.Xm||(Op.Xm=xa.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Bki(a,c,h){if(1===c)return(a?Op.v1j(h):Op.W0j(h))?32:8;(a=Op.dhl(a,h))&&Op.$Oj(a,h);return 32}static $Oj(a,c){const h=new gf.GraphTransaction(15);h.Oa(c);Op.Ei.k_a();Op.BB.MK(a,c,!1);h.dispose()}static v1j(a){a=
Op.qb.um(a);return!!a&&Op.qb.oe(a)!==gj.StyleReader.wordStyleIdHeading1}static W0j(a){a=Op.qb.um(a);return!!a&&Op.qb.oe(a)!==gj.StyleReader.I1a}static dhl(a,c){const h=Op.qb.um(c);return h?Op.qb.tw(c).zg(Op.bhl(a,Op.qb.oe(h))):null}static bhl(a,c){c=Op.headingsList.indexOf(c);a=a?c-1:c+1;return 0<=a&&a<Op.headingsList.count?Op.headingsList.J(a):null}}Op.$b=null;Op.XB=null;Op.Xm=null;Op.headingsList=(Oy=new Ua.a,Oy.add(gj.StyleReader.wordStyleIdHeading1),Oy.add(gj.StyleReader.wordStyleIdHeading2),
Oy.add(gj.StyleReader.wordStyleIdHeading3),Oy.add(gj.StyleReader.F1a),Oy.add(gj.StyleReader.G1a),Oy.add(gj.StyleReader.H1a),Oy.add(gj.StyleReader.Cjb),Oy.add(gj.StyleReader.Djb),Oy.add(gj.StyleReader.I1a),Oy);Object(w.a)(Op,"NavigationPaneEditor",null,[]);class kE extends Zs{constructor(){super();this.dO=null}show(a){kE.rg||(this.oWb(),kE.rg=!0);Zs.showContextMenu("mnuNavPaneWordEditor",a)}oWb(){const a={PopulateDynamically:"true",PopulateOnlyOnce:"false"};a.PopulateQueryCommand=""+ba.a.oii;a.Command=
""+Sa.a.dha;Zs.Tgk(a);l.AFrameworkApplication.pa.ka(ba.a.oii,ic.a.application,Object(m.a)(this,this.xUd,"populateContextMenu"));l.AFrameworkApplication.pa.ka(ba.a.rVd,ic.a.view,Object(m.a)(this,this.rVd,"promoteHeading"));l.AFrameworkApplication.pa.ka(ba.a.mtd,ic.a.view,Object(m.a)(this,this.mtd,"demoteHeading"))}xUd(a,c,h,v,B){if(1===h)return 32;a=new Sys.StringBuilder;a.append(String.format('<Menu Id="{0}">',"mnuNavPaneWordEditor"));a.append('<MenuSection Id="msWordEditorHeadings" DisplayMode="Menu16"><Controls>');
a.append(Zs.oCc("promoteHeading",ba.a.rVd,"LeftArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_PromoteHeadingText));a.append(Zs.oCc("demoteHeading",ba.a.mtd,"RightArrow_16x16x32",WordEditorIntl.WordEditorStrings.L_DemoteHeadingText));a.append("</Controls></MenuSection></Menu>");B.PopulationXML=a.toString();return 32}rVd(a,c,h){return Op.Bki(!0,h,this.dO.Ia)}mtd(a,c,h){return Op.Bki(!1,h,this.dO.Ia)}}kE.rg=!1;Object(w.a)(kE,"WordEditorNavigationPaneContextMenu",Zs,[532]);var BA=b(1273),mw=b(278),
CP=b(443),DP=b(675),hF=b(1046),IG=b(1528),JG=b(1529);class iF{constructor(){this.Azb=this.WSh=!1;this.ZHb=2;this.Dr=0;this.M1a=1}}Object(w.a)(iF,"WrapTextPropertiesData",null,[]);class ll extends hF.a{constructor(a=null){super(a);this.rEg=new IG.a;this.KLg=new iF;this.QHg=new JG.a;this.Eke=!1}initialize(){super.initialize();this.jc.Z(ba.a.cof,BA.a.azb);this.jc.Z(ba.a.eof,BA.a.azb);this.jc.Z(ba.a.LGf,ll.cMa);this.jc.Z(ba.a.nRc,ll.cMa);this.jc.Z(ba.a.EGf,ll.cMa);this.jc.Z(Sa.a.uEb,ll.cMa);this.jc.Z(zb.a.XVd,
Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.WVd,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.VVd,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.ZVd,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.YVd,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.UVd,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.fWd,Object(m.a)(this,this.qea,
"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.eWd,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.dWd,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.aWd,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.bWd,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.cWd,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.YGf,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));
this.jc.Z(zb.a.XGf,Object(m.a)(this,this.qea,"sectionPropertiesExecuteBridge"));this.jc.Z(zb.a.$Fb,ll.U$l);this.jc.Z(zb.a.ZMa,ll.vxm);this.jc.Z(zb.a.hha,ll.cMa);this.jc.Z(zb.a.IDb,ll.cMa);this.jc.Z(zb.a.eMa,ll.cMa);this.jc.Z(zb.a.Moa,ll.cMa);this.jc.Z(zb.a.usa,ll.cMa);this.jc.Z(ba.a.dQc,ll.cMa);this.jc.Z(ba.a.wxd,BA.a.c3e);this.jc.Z(ba.a.xxd,Object(m.a)(this,this.zph,"genericFontSizeExecuteBridge"));this.yl.Z(ba.a.bQc,BA.a.DUa);this.yl.Z(ba.a.cQc,BA.a.DUa);this.jc.Z(zb.a.jGb,BA.a.YUa);this.jc.Z(zb.a.iGb,
BA.a.YUa);this.jc.Z(zb.a.ihb,BA.a.YUa);this.jc.Z(zb.a.lHf,Object(m.a)(this,this.zC,"queryParaFormattingExecuteBridge"));this.jc.Z(zb.a.jHf,Object(m.a)(this,this.zC,"queryParaFormattingExecuteBridge"));this.jc.Z(zb.a.kHf,Object(m.a)(this,this.zC,"queryParaFormattingExecuteBridge"));this.jc.Z(zb.a.PK,ll.rHm);this.yl.Z(ba.a.GWd,ll.xSc);this.yl.Z(ba.a.HWd,ll.xSc);this.yl.Z(ba.a.IWd,ll.xSc);this.yl.Z(ba.a.EWd,ll.xSc);this.yl.Z(ba.a.FWd,ll.xSc);this.jc.Z(ba.a.GWd,Object(m.a)(this,this.Y_c,"wrapTextPropertiesExecuteBridge"));
this.jc.Z(ba.a.HWd,Object(m.a)(this,this.Y_c,"wrapTextPropertiesExecuteBridge"));this.jc.Z(ba.a.IWd,Object(m.a)(this,this.Y_c,"wrapTextPropertiesExecuteBridge"));this.jc.Z(ba.a.EWd,Object(m.a)(this,this.Y_c,"wrapTextPropertiesExecuteBridge"));this.jc.Z(ba.a.FWd,Object(m.a)(this,this.Y_c,"wrapTextPropertiesExecuteBridge"));this.jc.Z(ba.a.wrapText,ll.Sdc);this.jc.Z(ba.a.L8d,ll.Sdc);this.jc.Z(ba.a.M8d,ll.Sdc);this.jc.Z(ba.a.N8d,ll.Sdc);this.jc.Z(ba.a.O8d,ll.Sdc);this.jc.Z(ba.a.P8d,ll.Sdc);this.jc.Z(ba.a.tla,
ll.UYb);this.jc.Z(ba.a.jTf,ll.UYb);this.jc.Z(ba.a.kTf,ll.UYb);this.jc.Z(ba.a.a2d,ll.UYb);this.jc.Z(ba.a.b2d,ll.UYb);this.jc.Z(ba.a.c2d,ll.UYb);this.jc.Z(ba.a.Yfb,Object(m.a)(this,this.YIm,"queryImageCropExecuteBridge"));this.jc.Z(ba.a.XQc,ll.Zxd);this.jc.Z(ba.a.MVd,ll.Zxd);this.jc.Z(ba.a.NVd,ll.Zxd);this.jc.Z(ba.a.OVd,ll.Zxd);this.jc.Z(ba.a.UGc,Object(m.a)(this,this.LFd,"imageCropFromSpinnersExecuteBridge"));this.jc.Z(ba.a.NGc,Object(m.a)(this,this.LFd,"imageCropFromSpinnersExecuteBridge"));this.jc.Z(ba.a.OGc,
Object(m.a)(this,this.LFd,"imageCropFromSpinnersExecuteBridge"));this.jc.Z(ba.a.PGc,Object(m.a)(this,this.LFd,"imageCropFromSpinnersExecuteBridge"));this.jc.Z(zb.a.ija,Object(m.a)(this,this.nLh,"ignoreAllExecuteBridge"));this.jc.Z(zb.a.gvb,Object(m.a)(this,this.nLh,"ignoreAllExecuteBridge"));this.jc.Z(ba.a.Vfb,ll.Vfb);this.jc.Z(ba.a.k2d,BA.a.YUa);this.jc.Z(zb.a.qHf,Object(m.a)(this,this.yli,"queryTableBorderFormattingExecuteBridge"));this.jc.Z(zb.a.rHf,Object(m.a)(this,this.yli,"queryTableBorderFormattingExecuteBridge"))}clearCache(){super.clearCache();
this.Eke=!1;this.rEg=new IG.a;this.KLg=new iF;this.QHg=new JG.a}K6e(){const a=super.K6e();a.xwa=ll.xwa;a.ZSa=ll.ZSa;return a}nLh(a){const c=new mw.a;c.fya=!0;c.EJ=a;return c}qea(){const a=new mw.a;a.qyb=!1;a.EJ=zb.a.nBa;a.Ac=this.rEg;a.g3b=!0;a.ada=!0;return a}yli(){const a=new mw.a;a.qyb=this.Eke;this.Eke=!0;a.EJ=zb.a.VZa;a.Ac=this.QHg;a.g3b=!0;a.ada=!0;return a}Y_c(){const a=new mw.a;a.qyb=!1;a.EJ=ba.a.z8b;a.Ac=this.KLg;a.g3b=!0;a.ada=!0;return a}LFd(a,c){const h=new mw.a;h.Ac=new uh.DictionaryPropertySet;
switch(a){case ba.a.UGc:h.Ac.setValue(Uc.a.Ubb,c[pg.a.Number]);break;case ba.a.NGc:h.Ac.setValue(Uc.a.Rbb,c[pg.a.Number]);break;case ba.a.OGc:h.Ac.setValue(Uc.a.Sbb,c[pg.a.Number]);break;case ba.a.PGc:h.Ac.setValue(Uc.a.Tbb,c[pg.a.Number])}return h}YIm(){const a=new mw.a;a.Ac=new uh.DictionaryPropertySet;a.ada=!0;return a}static get Xwm(){return ll.Xyg||(ll.Xyg=xa.a.instance.ra("WordEditor.IPageCommandStringBuilder"))}static get wx(){ll.ioa||(ll.ioa=xa.a.instance.ra("WordEditor.ITableBorderManager"));
return ll.ioa}static cMa(a,c){a=new mw.a;a.Ac=c;return a}static nVc(a,c,h){c[Uf.a.Description]=a?a.R$l(h):null}static xwa(a,c){const h=Object(ha.a)(IG.a,a.Ac),v=Object(ha.a)(CP.a,a.Ac),B=Object(ha.a)(iF,a.Ac),X=Object(ha.a)(JG.a,a.Ac);let ma=!0;const Pa=ll.Xwm;switch(a.jfb){default:ma=hF.a.xwa(a,c);break;case zb.a.XVd:c[bl.a.Icon]=h.cra?"PageMarginsLandscapeNormal_48":"PageMarginsPortraitNormal_48";c[Uf.a.On]=!h.RBb;ll.nVc(Pa,c,0);break;case zb.a.WVd:c[bl.a.Icon]=h.cra?"PageMarginsLandscapeNarrow_48":
"PageMarginsPortraitNarrow_48";c[Uf.a.On]=1===h.RBb;ll.nVc(Pa,c,1);break;case zb.a.VVd:c[bl.a.Icon]=h.cra?"PageMarginsLandscapeModerate_48":"PageMarginsPortraitModerate_48";c[Uf.a.On]=2===h.RBb;ll.nVc(Pa,c,2);break;case zb.a.ZVd:c[bl.a.Icon]=h.cra?"PageMarginsLandscapeWide_48":"PageMarginsPortraitWide_48";c[Uf.a.On]=3===h.RBb;ll.nVc(Pa,c,3);break;case zb.a.YVd:c[bl.a.Icon]=h.cra?"PageMarginsLandscapeOffice2003_48":"PageMarginsPortraitOffice2003_48";c[Uf.a.On]=4===h.RBb;ll.nVc(Pa,c,4);break;case zb.a.UVd:c[bl.a.Icon]=
h.cra?"PageMarginsLandscapeCustom_48":"PageMarginsPortraitCustom_48";c[Uf.a.On]=5===h.RBb;break;case zb.a.fWd:c[Uf.a.On]=!h.mDb;c[Uf.a.Description]=Pa?Pa.tPc(0):null;break;case zb.a.eWd:c[Uf.a.On]=1===h.mDb;c[Uf.a.Description]=Pa?Pa.tPc(1):null;break;case zb.a.dWd:c[Uf.a.On]=2===h.mDb;c[Uf.a.Description]=Pa?Pa.tPc(2):null;break;case zb.a.aWd:c[Uf.a.On]=3===h.mDb;c[Uf.a.Description]=Pa?Pa.tPc(3):null;break;case zb.a.bWd:c[Uf.a.On]=4===h.mDb;c[Uf.a.Description]=Pa?Pa.tPc(4):null;break;case zb.a.cWd:c[Uf.a.On]=
5===h.mDb;break;case zb.a.YGf:c[Uf.a.On]=!h.cra;break;case zb.a.XGf:c[Uf.a.On]=h.cra;break;case zb.a.lHf:c[Uf.a.On]=v.Ar?!v.Ar.specialIndentType:!1;break;case zb.a.jHf:c[Uf.a.On]=v.Ar?1===v.Ar.specialIndentType:!1;c[Jj.a.Image16by16Class]=v.isRtl?Fd.getImageClass("IndentSpecialFirstLineRTL_Server_16x16x32"):Fd.getImageClass("IndentSpecialFirstLine_Server_16x16x32");break;case zb.a.kHf:c[Uf.a.On]=v.Ar?2===v.Ar.specialIndentType:!1;c[Jj.a.Image16by16Class]=v.isRtl?Fd.getImageClass("IndentSpecialHangingRTL_Server_16x16x32"):
Fd.getImageClass("IndentSpecialHanging_Server_16x16x32");break;case ba.a.GWd:c[Uf.a.On]=1===B.M1a;break;case ba.a.HWd:c[Uf.a.On]=8===B.M1a;break;case ba.a.IWd:c[Uf.a.On]=9===B.M1a;break;case ba.a.EWd:c[Uf.a.On]=3===B.M1a;break;case ba.a.FWd:c[Uf.a.On]=4===B.M1a;break;case ba.a.Yfb:c[Uf.a.On]=a.Ac.ia(Uc.a.$qa,!1);break;case ba.a.Vfb:c[Rc.a.IsFreeForm]=!0;c[Rc.a.Value]=a.Ac[Qp.a.Value];break;case zb.a.qHf:c[Pf.a.On]=ll.wx.Sqh(c.MenuItemId)===X.lineStyle;break;case zb.a.rHf:c[Pf.a.On]=ll.wx.Tqh(c.MenuItemId)===
X.QLc}return ma}static U$l(a,c){a=5;switch(c.MenuItemId){case "buttonMarginsNormal":a=0;break;case "buttonMarginsNarrow":a=1;break;case "buttonMarginsModerate":a=2;break;case "buttonMarginsWide":a=3;break;case "buttonMarginsOffice2003":a=4}c=new mw.a;c.Ac=a;return c}static vxm(a,c){a=5;switch(c.MenuItemId){case "buttonSizeLetter":a=0;break;case "buttonSizeLegal":a=1;break;case "buttonSizeExecutive":a=2;break;case "buttonSizeA4":a=3;break;case "buttonSizeA5":a=4}c=new mw.a;c.Ac=a;return c}static Vfb(){const a=
new mw.a;a.EJ=ba.a.Vfb;a.Ac={};a.ada=!0;a.g3b=!0;return a}static Sdc(a,c){const h=new mw.a;h.Ac=new uh.DictionaryPropertySet;let v=1;switch(a){case ba.a.N8d:v=1;break;case ba.a.O8d:v=8;break;case ba.a.P8d:v=9;break;case ba.a.L8d:v=3;break;case ba.a.M8d:v=4}h.Ac.setValue(Uc.a.M1a,v);h.Ac.setValue(Uc.a.hCa,c[Uf.a.SourceControlId]);return h}static UYb(a,c,h){a=new mw.a;a.Ac=h.InvocationMethod;return a}static rHm(a,c){a=new mw.a;a.Ac=c;return a}static xSc(){const a=new DP.a;a.EJ=ba.a.z8b;return a}static Zxd(){const a=
new mw.a;a.Ac=new uh.DictionaryPropertySet;a.bKc=!0;return a}static ZSa(a,c){let h=!0;switch(a.jfb){case ba.a.XQc:a=a.Ac.ia(Uc.a.Ubb,0);c[pg.a.Number]=a;c[pg.a.UnitType]=7;break;case ba.a.MVd:a=a.Ac.ia(Uc.a.Rbb,0);c[pg.a.Number]=a;c[pg.a.UnitType]=7;break;case ba.a.NVd:a=a.Ac.ia(Uc.a.Sbb,0);c[pg.a.Number]=a;c[pg.a.UnitType]=7;break;case ba.a.OVd:a=a.Ac.ia(Uc.a.Tbb,0);c[pg.a.Number]=a;c[pg.a.UnitType]=7;break;default:h=hF.a.ZSa(a,c)}return h}}ll.Xyg=null;ll.ioa=null;Object(w.a)(ll,"CuiActionBridge",
hF.a,[]);class KG extends gg.a{constructor(a){super();this.b$j=CommonUIStrings.l_AccHelpDialogCommandsHeaderText;this.bmn=CommonUIStrings.l_AccHelpDialogShortcutHeaderText;this.vtd=this.dqb=this.m2=this.GQa=this.wAe=null;this.fb=a;this.vf="<div id='AccessibilityHelpDialogBody'></div>";this.jf="AAccessibilityHelpDialog";this.yc=6;this.Nd(0,CommonUIStrings.l_DialogClose)}get AXe(){return null}get s1d(){this.wAe||(this.wAe=this.nAl());return this.wAe}get sAn(){return 300}get $5h(){return"https://go.microsoft.com/fwlink/p/?LinkId=325036"}get Z5h(){return CommonUIStrings.l_AccHelpDialogMoreHelpLinkText}get mUa(){return this.fb.gk()}WMa(a){super.WMa(a);
this.ZBm()}mNa(){this.showDialog(this.XHa,Object(m.a)(this,this.FAj,"accHelpDialogResultHandler"));this.sBa();this.setFocus()}setFocus(){this.m2?(this.dqb=this.m2.tBodies[0].firstChild,this.AY(this.dqb)):this.ZC&&"none"!==this.ZC.style.display?this.AY(this.ZC):this.AY(this.Hu)}kha(){this.jd.Ea(Jb.a.ah,this.vtd,Object(m.a)(this,this.$Lg,"accHelpDialogKeydownHandler"));if(this.m2){this.jd.Ea(Jb.a.Hg,this.m2,Object(m.a)(this,this.kNi,"tableOnKeyUpHandler"));const a=this.m2.tBodies[0].children;for(let c=
0;c<a.length;c++)if(Ld.a.addHandler(a[c],Jb.a.focus,Object(m.a)(this,this.fwi,"rowOnFocusHandler")),Ld.a.addHandler(a[c],Jb.a.blur,Object(m.a)(this,this.ewi,"rowOnBlurHandler")),H.a.Gi){const h=a[c].children;for(let v=0;v<h.length;v++)Ld.a.addHandler(h[v],Jb.a.focus,Object(m.a)(this,this.v0g,"cellOnFocusHandler"))}}super.kha()}S9a(){this.jd&&(this.jd.xb(Jb.a.ah,this.vtd,Object(m.a)(this,this.$Lg,"accHelpDialogKeydownHandler")),this.m2&&this.jd.xb(Jb.a.Hg,this.m2,Object(m.a)(this,this.kNi,"tableOnKeyUpHandler")));
if(this.m2){const a=this.m2.tBodies[0].children;for(let c=0;c<a.length;c++)if(Ld.a.removeHandler(a[c],Jb.a.focus,Object(m.a)(this,this.fwi,"rowOnFocusHandler")),Ld.a.removeHandler(a[c],Jb.a.blur,Object(m.a)(this,this.ewi,"rowOnBlurHandler")),H.a.Gi){const h=a[c].children;for(let v=0;v<h.length;v++)Ld.a.removeHandler(h[v],Jb.a.focus,Object(m.a)(this,this.v0g,"cellOnFocusHandler"))}}super.S9a()}sBa(){this.mUa.scope.Bp(this.fb.BN);this.mUa.scope.Bp(this.fb.DN);this.mUa.scope.bindAction(this.fb.BN,Sa.a.stc);
this.mUa.scope.bindAction(this.fb.DN,Sa.a.rtc)}frl(a){if(!this.mUa.Sh||!this.mUa.Sh.dO)return 2;var c=this.mUa.Sh.dO;if(this.m2&&(c===this.Hu&&a===Sa.a.stc||c===this.GQa&&a===Sa.a.rtc))this.AY(this.dqb);else if(c.id.startsWith("SelectableTableRow"))c=null,a===Sa.a.stc?c=this.GQa:a===Sa.a.rtc&&(c=this.Hu),c&&this.AY(c);else if(a===Sa.a.stc)this.mUa.RYa();else if(a===Sa.a.rtc)this.mUa.QYa();else return 2;return 32}fwi(a){a.target.setAttribute(we.a.g8a,we.a.$m);Sys.UI.DomElement.removeCssClass(this.dqb,
"inactiveRowSelection");this.dqb=a.target}ewi(a){a.target.removeAttribute(we.a.g8a);Sys.UI.DomElement.addCssClass(a.target,"inactiveRowSelection")}v0g(a){(a=a.target.parentNode)&&a!==this.dqb&&this.AY(a)}kNi(a){return a.Sa.keyCode===vb.a.Nq?(a.Sa.stopPropagation(),!0):!1}$Lg(a){if(!a.Sa)return!1;const c=a.Sa.keyCode;if(a.eventName===Jb.a.ah){a=this.R3k(this.dqb);let h=-1;const v=Za.a.count(this.s1d)-1;c===Sys.UI.Key.down?h=a<v?a+1:0:c===Sys.UI.Key.up?h=0<a?a-1:v:c===Sys.UI.Key.home?h=0:c===Sys.UI.Key.end&&
(h=v);-1!==h&&this.AY(this.m2.tBodies[0].children[h])}return!0}FAj(){}ZBm(){this.vtd=document.getElementById("AccessibilityHelpDialogBody")||this.XC;this.kmk();this.Rlk();this.Gjk()}kmk(){if(this.AXe){var a=document.createElement("div");a.className="WACDialogSubtitle";var c=document.createElement("span");c.innerText=this.AXe;a.appendChild(c);this.Jfa.appendChild(a)}}Rlk(){if(this.s1d&&!Za.a.isEmpty(this.s1d)){this.m2=document.createElement("table");this.m2.className="SelectableDialogTable";var a=
document.createElement("thead"),c=document.createElement("tr");c.setAttribute(we.a.tg,we.a.Juc);a.appendChild(c);var h=ye.a.hyc(14,this.b$j);c.appendChild(h);h=ye.a.hyc(14,this.bmn);c.appendChild(h);this.m2.appendChild(a);a=document.createElement("tbody");c=0;h=this.s1d;for(let X in h){var v=X,B=h[X];const ma=document.createElement("tr");ma.tabIndex=0;ma.setAttribute(we.a.tg,we.a.Juc);ma.id="SelectableTableRow"+c++;v=ye.a.hyc(15,v);ma.appendChild(v);B=ye.a.hyc(15,B);ma.appendChild(B);a.appendChild(ma)}a.style.maxHeight=
this.sAn+"px";this.m2.appendChild(a);this.vtd.appendChild(this.m2)}}Gjk(){if(this.Z5h&&this.$5h){var a=document.createElement("div");a.className="WACDialogLearnMoreLinkContainer";this.GQa=document.createElement("a");this.GQa.innerText=this.Z5h;this.GQa.href=this.$5h;this.GQa.target="_blank";this.GQa.id=this.hi("AccessibilityHelpDialogLink");this.GQa.className=Fc.AFrame.xJe;a.appendChild(this.GQa);this.pc.insertBefore(a,this.pc.lastChild)}}R3k(a){return Number.parseInvariant(a.id.substr(18))}n_(a,
c,h,v=null){a&&c&&h&&(h=v?String.format(h,v):h,a[c]=h)}bDh(a,c){return H.a.qk?c:a}}Object(w.a)(KG,"AAccessibilityHelpDialog",gg.a,[941]);class lC extends KG{constructor(a){super(a)}get XHa(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWETitle}get AXe(){return WordEditorIntl.WordEditorStrings.L_AccHelpDialogWESubtitle}nAl(){const a=this.bDh(CommonUIStrings.l_AccHelpDialogCtrlKey,CommonUIStrings.l_AccHelpDialogCommandKey),c=this.bDh(CommonUIStrings.l_AccHelpDialogWindowsKey,CommonUIStrings.l_AccHelpDialogCtrlKey),
h={};this.n_(h,CommonUIStrings.l_AccHelpDialogAccHelpCommand,CommonUIStrings.l_AccHelpDialogAccHelpShortcut);this.n_(h,CommonUIStrings.l_AccHelpDialogLandmarkRegionsCommand,CommonUIStrings.l_AccHelpDialogLandmarkRegionsShortcut,a);this.n_(h,CommonUIStrings.l_AccHelpDialogTellMeCommand,CommonUIStrings.l_AccHelpDialogTellMeShortcut);this.n_(h,CommonUIStrings.l_AccHelpDialogAccessKeysCommand,CommonUIStrings.l_AccHelpDialogAccessKeysShortcut,c);this.n_(h,CommonUIStrings.l_AccHelpDialogTooltipToggle,CommonUIStrings.l_AccHelpDialogTooltipToggleShortcut,
a);this.n_(h,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextFootnoteShortcut,a);this.n_(h,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextEndnoteShortcut,a);this.n_(h,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogShowNextCommentShortcut);S.App.r8d&&this.n_(h,WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerCommand,
WordEditorIntl.WordEditorStrings.L_AccHelpDialogAccCheckerShortcut,a);this.n_(h,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesToggleShortcut,a);this.n_(h,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesAcceptShortcut,a);this.n_(h,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesRejectShortcut,
a);this.n_(h,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesPreviousShortcut,a);this.n_(h,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogTrackChangesNextShortcut,a);l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("AccessibleMovingDialogsEnabled")&&this.n_(h,CommonUIStrings.l_AccHelpDialogOpenDialogMenuCommand,CommonUIStrings.l_AccHelpDialogOpenDialogMenuShortcut);
l.AFrameworkApplication.K.$("CatchUpActivityIsEnabled")&&this.n_(h,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsCommand,WordEditorIntl.WordEditorStrings.L_AccHelpDialogActivityAnnouncementsShortcut);(lC.Ua&&lC.Ua.isFeatureEnabled(104)||l.AFrameworkApplication.K.$("WordEditorIdeasCardsIsEnabled"))&&this.n_(h,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestion,WordEditorIntl.WordEditorStrings.L_ShowIntentSuggestionShortcut);return h}static get Ua(){return lC.Na||(lC.Na=xa.a.instance.ra("Box4.IFeatureHelper"))}}
lC.Na=null;Object(w.a)(lC,"AccessibilityHelpDialog",KG,[]);class jF{static get vf(){return gg.a.fy(jF.ll,WordEditorIntl.WordEditorStrings.l_StyleName,WordEditorIntl.WordEditorStrings.l_BadStyleName)}}jF.ll="<div class='normal' id='text'> <label id='IntroLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleError' role='alert'>{1}</div> </div>";
Object(w.a)(jF,"ApplyStylesDialogHtml",null,[]);class dD extends gg.a{constructor(a,c){super();this.ZE=this.$b=null;this.Prc=!1;this.nrb=this.A2a=this.goc=this.joc=this.fsc=null;this._context=a;this.Na=c;this.jf="ApplyStylesDialog";this.Od=this._context.view;this.haf();a=this.syn();c="";this.ZE.length>a&&(c=this.ZE[a]);c={["styleText"]:c,["styleList"]:a};this.vf=jF.vf;this.Tg(WordEditorIntl.WordEditorStrings.l_ApplyStyles,Object(m.a)(this,this.yPj,"applyStylesDialogHandler"),c);this.Lga=document.getElementById("styleList");
this.iEf();this.Lga.selectedIndex=a;this.IL=document.getElementById("styleText");this.IL.focus();this.IL.select();this.Tbd=Object(m.a)(this,this.zpm,"onListSelectionChange");Ld.a.addHandler(this.Lga,"change",this.Tbd);this.Sbd=Object(m.a)(this,this.onKeyDown,"onKeyDown");Ld.a.addHandler(this.IL,"keydown",this.Sbd);H.a.eA?(this.joc=Object(m.a)(this,this.Dtm,"onTextPropChange"),Ld.a.addHandler(this.IL,"propertychange",this.joc),this.fsc=this.ZE[a]):(this.goc=Object(m.a)(this,this.fE,"onKeyPress"),Ld.a.addHandler(this.IL,
"keypress",this.goc))}get qb(){return this.$b||(this.$b=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}syn(){var a=this.Od.Ma;if(!a||!a.Ca)return Sd.b(579216408,3018,15,"Unable to retrieve valid SelectionCollection"),0;a=a.Ca.Fa;if(!a)return Sd.b(579216409,3018,15,"CurrentSelection is null"),0;sd.ParagraphReader.Wk(a.sa)&&(a=Gc.SelectionEditor.Ri(a,!0,!1));a=a.sa;if(!a||!Gc.SelectionEditor.Rs(a))return Sd.b(579216410,3018,15,"Received invalid nodeContext, null={0}",!a),0;var c=ua.FormattingReader.zr(a);
(c=ua.FormattingReader.vqa(c))||(c=this.qb.um(a.node));if(!c)return 0;a=this.qb.pC(c);a=Array.indexOf(this.ZE,a);0>a&&(a=0);return a}yPj(a,c){if(this.Od.jr){if(a){a=c.styleList;c=c.styleText;if(-1===a||F.a.kg(c)!==F.a.kg(this.ZE[a]))a=this.tDh(c);c=this.ZE[a];a=this.qb.lp();c=this.qb.oe(a.tqa(c));l.AFrameworkApplication.pa.Le(this._context,zb.a.applyStyle,2,!1,new HD.a,c)}this.Od.BS()}}iEf(){const a=this.ZE.length;for(let c=0;c<a;c++){const h=document.createElement("OPTION");h.value=c.toString();
h.text=this.ZE[c];this.Lga.add(h,null)}}haf(){var a=dl.a.Vy();if(a){a=(new kl.WACStyleSet).vM(a);var c=a.cM,h=this.Na.isFeatureEnabled(185)&&!!this.qb.Ff;this.ZE=[];for(let v=0;v<c;v++){const B=a.Uia(v);if(this.qb.isHidden(B))continue;const X=this.qb.Gv(B);if(!h){if(3===X)continue}else if(3===X&&this.qb.oe(B)===hw.a.W_c)continue;Array.add(this.ZE,this.qb.pC(B))}this.ZE.sort(dD.pak)}else Sd.b(577644352,3018,15,"Couldn't find PageContentNode")}dispose(){this.joc&&Ld.a.removeHandler(this.IL,"propertychange",
this.joc);this.Sbd&&Ld.a.removeHandler(this.IL,"keydown",this.Sbd);this.Tbd&&Ld.a.removeHandler(this.Lga,"change",this.Tbd);this.goc&&Ld.a.removeHandler(this.IL,"keypress",this.goc);this.A2a&&l.AFrameworkApplication.Cb.me(this.A2a);this.A2a=this.goc=this.Lga=this.IL=this.Sbd=this.joc=this.Tbd=null;super.dispose()}Dtm(a){this.Prc?(this.Prc=!1,this.validate()):"value"===a.rawEvent.propertyName&&(this.Prc=!0,this.IL.value!==this.fsc&&(this.fsc=this.IL.value,this.rVg()))}rVg(){var a=this.IL.value,c=this.tyl(a);
const h=-1===c?a:this.ZE[c];a=a.length;const v=h.length;this.fsc=h;this.IL.value=h;this.Lga.selectedIndex=c;v>a&&(H.a.lH?this.IL.setSelectionRange(a,v):H.a.eA&&(c=this.IL.createTextRange(),c.collapse(!0),c.moveStart("character",a),c.moveEnd("character",v-a),c.select()));this.validate();this.IL.focus()}zpm(){-1!==this.Lga.selectedIndex&&(H.a.eA&&(this.Prc=!0),this.fsc=this.ZE[this.Lga.selectedIndex],this.IL.value=this.ZE[this.Lga.selectedIndex],this.validate())}onKeyDown(a){H.a.lH?a.keyCode!==vb.a.PC&&
a.keyCode!==vb.a.U5||this.A2a||this.nrb||(this.nrb=new Se.a(0,1,1,Object(m.a)(this,this.lUn,"validateInputTaskCallback")),l.AFrameworkApplication.Cb.ub(this.nrb)):H.a.eA&&a.keyCode===vb.a.PC&&(this.Prc=!0)}fE(){this.A2a||(this.A2a=new Se.a(0,1,1,Object(m.a)(this,this.HRj,"autoCompleteTaskCallback")),l.AFrameworkApplication.Cb.ub(this.A2a));this.nrb&&(l.AFrameworkApplication.Cb.me(this.nrb),this.nrb=null)}HRj(){this.A2a=null;this.rVg()}lUn(){this.nrb=null;this.validate()}tyl(a){let c=0,h=this.ZE.length,
v=-1;for(a=F.a.kg(a);c<h;){const B=Math.floor((c+h)/2),X=dD.kRe(a,this.ZE[B]);if(!X){v=B;break}0<X?c=B+1:h=B}if(v>c)for(;!dD.kRe(a,this.ZE[v-1])&&(v--,v!==c););return v}validate(){const a=-1===this.tDh(this.IL.value),c=document.getElementById("badStyleError");a?(c.style.display="inline-block",c.innerText=WordEditorIntl.WordEditorStrings.l_BadStyleName):(c.style.display="none",c.innerText="");return!a}tDh(a){a=F.a.kg(a);const c=this.ZE.length;for(let h=0;h<c;h++)if(a===F.a.kg(this.ZE[h]))return h;
return-1}static kRe(a,c){const h=Math.min(a.length,c.length);a=F.a.kg(a);c=F.a.kg(c);for(let v=0;v<h;v++){const B=F.a.charCodeAt(a,v),X=F.a.charCodeAt(c,v);if(B!==X)return B-X}return a.length<=c.length?0:1}static pak(a,c){return dD.kRe(a,c)}}Object(w.a)(dD,"ApplyStylesDialog",gg.a,[]);class kF{static get vf(){return gg.a.fy(kF.ll,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName,WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview,WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists)}}
kF.ll="<div class='normal' id='text'> <label id='NameLabel' class='WACDialogLabel' for='styleText' >{0}</label> <input type='text' id='styleText' class='WACDialogInput' autocomplete=\"off\"/> </div> <br/> <div class='normal' id='text'> <label id='ParagraphLabel' class='WACDialogLabel' >{1}</label> <div id='previewContainer' class='previewContainer' style='height: 40px; border: solid 1px #c3cbd0; position: relative; overflow: hidden;'></div> </div> <div class='normal' id='text'> <div class='WACDialogError' id='badStyleNameError' role='alert'>{2}</div> </div>";
Object(w.a)(kF,"CreateNewStyleDialogHtml",null,[]);class Gs extends gg.a{constructor(a,c,h=!1){super(!1,!1,h);this.$b=this.lu=null;this._context=a;this.ga=c;h=c=null;this.jf=Gs.id;if(this.Od=a.view)h=this.Od.Ma;h&&h.Ca&&h.Ca.Fa&&(c=h.Ca.Fa.sa);c?(a=c.node)?(this.nu=Gs.Ag.Xs(a))?(this.MA=(new kl.WACStyleSet).vM(this.nu),(this.oQ=this.R3e.owd(c))?(a=this.oQ.ia(Ed.a.fontSize,22),16>a?Sd.b(593078050,3018,50,"Font size less than 8pt in create new style dialog preview"):52>=a?Sd.b(593078049,3018,50,"Font size between 8pt and 26pt in create new style dialog preview"):
90>=a?Sd.b(593078048,3018,50,"Font size between 26pt and 45 pt in create new style dialog preview"):Sd.b(593078047,3018,50,"Font size more than 45pt in create new style dialog preview"),this.vKf(this.oQ)):Sd.b(592737758,3018,10,"_newStyleProperties is null.")):Sd.b(592737757,3018,10,"_pageContenNode is null."):Sd.b(592725466,3018,10,"node is null."):Sd.b(556917206,3018,10,"nodeContext is null.")}vKf(a){a.Ig(zi.a.paragraphStyle,zi.a.Oz,...Xf.a.xI())}get R3e(){return this.lu||(this.lu=xa.a.instance.resolve("Box4.IFormattingReader"))}get qb(){return this.$b||
(this.$b=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}n9e(a){if(!a)return"";const c=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogDefaultStyle,h=a.cM;let v;for(v=1;v<=h;v++){const B=c+v;let X=a.zg(B)||a.R_b(B);X||(X=a.zg(B+"Char")||a.R_b(B+"Char"));if(!X)break}return c+v}Ptc(a,c){const h=new gf.GraphTransaction(15);h.Oa(this.nu);h.ql=zb.a.createNewStyle;if(c=dl.a.Ptc(a,dl.a.cBh(c),null,this.nu))Sd.b(593078046,3018,50,"User created linked style"),this.MA=(new kl.WACStyleSet).vM(this.nu),
a=F.a.Csa(F.a.yX(a)),a=this.MA.R_b(a),this.ga.Le(this._context,zb.a.applyStyle,2,!1,new HD.a,this.qb.oe(a));h.dispose();return c}XXi(a){var c=F.a.Csa(a);const h=""===F.a.Csa(a),v=a.length>Gs.Zam,B=RegExp("[{|}|;|\\\\]").test(a);a=!!this.MA.tqa(a)||!!this.MA.R_b(c);c=null;if(h||v||B||a)c=h?WordEditorIntl.WordEditorStrings.l_StyleNameEmpty:v?WordEditorIntl.WordEditorStrings.l_StyleNameOverMaxLength:B?WordEditorIntl.WordEditorStrings.l_StyleNameRestrictedCharacters:WordEditorIntl.WordEditorStrings.l_StyleNameAlreadyExists;
return c}static get Ag(){return jn.PageNavigator.instance}}Gs.id="CreateNewStyleDialog";Gs.hOd=26;Gs.Zam=253;Gs.QLi=5;Gs.PLi=40;Object(w.a)(Gs,"ACreateNewStyleDialog",gg.a,[]);class uJ extends Gs{constructor(a,c){super(a,c);this.nu&&this.oQ&&(a=this.n9e(this.MA),c={["styleText"]:a},this.vf=kF.vf,this.Tg(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,Object(m.a)(this,this.Rjk,"createNewStyleDialogHandler"),c),this.IL=document.getElementById("styleText"),this.AY(this.IL),c=document.getElementById("previewContainer"),
this.ljn(this.oQ,a,c),this.C5c=document.getElementById("badStyleNameError"))}AXk(a){const c=a.ia(Ed.a.fontSize,fm.a.jI)>=2*Gs.hOd;a=hu.a.hth(a,"97%",Gs.hOd,!1,!0,c)+" padding-left: "+Gs.QLi+"px;";c||(a=a+" line-height: "+Gs.PLi+"px;");return a}ljn(a,c,h){const v=document.createElement("div");v.innerText=c;a=this.AXk(a);v.setAttribute("style",a);h.appendChild(v)}Rjk(a){this.Od.jr&&(a&&(a=new Map,a.set("Source","CreateNewStyleDialog"),a.set("Action","CreateStyle"),Fa.Health.instance.recordKpiUsage(Xf.a.Fjb,
0,Xf.a.pF,a),this.Ptc(this.IL.value,this.oQ)||(a=new Map,a.set("Source","CreateNewStyleDialog"),a.set("Action","CreateStyle"),a=Object.assign(new fi.a,{extendedProperties:a}),Fa.Health.instance.recordKpiFailure(Xf.a.Fjb,"CreateStyleFailed",!1,!0,a))),this.Od.BS())}validate(){const a=this.XXi(this.IL.value),c=!!a;c?(this.C5c.style.display="inline-block",this.C5c.innerText=a):(this.C5c.style.display="none",this.C5c.innerText="");return!c}}Object(w.a)(uJ,"CreateNewStyleDialog",Gs,[]);var lE=b(300);class vJ extends oe.StandardDialog{constructor(a){super();
this.fw=a;this.Eqn()}Eqn(){this.yc=1;this.yY(1);this.Nd(1,"Delete Saved Styles");this.mv("Are you sure?",String.format("Future document will be reset to Word Default Styles. Also any custom styles will not be available for future documents. There will be no changes in current document."),1,this.cXe.bind(this))}cXe(a){1===a&&this.fw.Ysa("saveWordUserPreferenceSaveStyleSetting","{}").continueWith(c=>{c.Gh?Sd.b(524834400,3018,10,"DeleteSavedSytles: Task Faulted.Exception:{0} Stack:{1}",c.exception,c.exception.stack):
(this.B2m(),Sd.b(524834399,3018,50,"User deleted saved styles via UI."))},8)}B2m(){lE.a.XIb="{}"}}Object(w.a)(vJ,"DeleteSavedStylesConfirmationDialog",oe.StandardDialog,[]);class wJ extends oe.StandardDialog{constructor(a,c){super();this.dw=this.$b=this.XB=null;c||Sd.b(590128417,3018,10,"styleId is null");let h=null,v=null;if(this.Od=a.view)v=this.Od.Ma;v&&(h=v.Ca.Fa.sa);h?(a=h.node)?(this.nu=this.Ag.Xs(a))?(this.kHg=new Ua.a,this.kHg.add(c),this.Fqn(c)):Sd.b(590128448,3018,10,"_pageContenNode is null."):
Sd.b(590128419,3018,10,"node is null."):Sd.b(590128418,3018,10,"nodeContext is null.")}get BB(){return this.XB||(this.XB=xa.a.instance.resolve("Box4.Styles.IWACStyleEditor"))}get qb(){return this.$b||(this.$b=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get Ag(){return this.dw||(this.dw=jn.PageNavigator.instance)}Fqn(a){const c=(new kl.WACStyleSet).vM(this.nu);c?((a=c.zg(a))||Sd.b(590128450,3018,10,"Style set doesn't contain style with given ID"),a=this.qb.pC(a),this.yc=4,this.yY(2),this.mv(CommonUIStrings.l_DefaultDialogTitle,
String.format(WordEditorIntl.WordEditorStrings.l_DeleteStyleConfirmationDialogMessage,a),0,Object(m.a)(this,this.cXe,"deleteStyleConfirmationDialogHandler"))):Sd.b(590128449,3018,10,"Can't retrieve style set from page content node")}cXe(a){if(1===a){a=new Map;a.set("Source","DeleteStyleConfirmationDialog");a.set("Action","DeleteStyle");Fa.Health.instance.recordKpiUsage(Xf.a.Fjb,0,Xf.a.pF,a);var c=dl.a.Vy();a=new gf.GraphTransaction(15);a.Oa(c);a.ql=zb.a.Uub;this.BB.frk(this.kHg)?Sd.b(578359694,3018,
50,"User deleted a style via UI."):(c=new Map,c.set("Source","DeleteStyleConfirmationDialog"),c.set("Action","DeleteStyle"),c=Object.assign(new fi.a,{extendedProperties:c}),Fa.Health.instance.recordKpiFailure(Xf.a.Fjb,"DeleteStyleFailed",!1,!0,c),Sd.b(578359695,3018,50,"User tried to delete a style via UI, but we were unable to delete it."));a.dispose()}}}Object(w.a)(wJ,"DeleteStyleConfirmationDialog",oe.StandardDialog,[]);class lF{static get vf(){return gg.a.fy(lF.ll)}}lF.ll="<div class='normal' id='list'> <select class='UIFont WACDialogList' id='styleList' size='9'> </select> </div>";
Object(w.a)(lF,"DeleteStyleDialogHtml",null,[]);class xJ extends gg.a{constructor(a){super();this.nu=this.ZE=this.C3a=this.$b=null;this._context=a;this.jf="DeleteStyleDialog";this.yc=1;this.Nd(1,WordEditorIntl.WordEditorStrings.l_DeleteStyleDialogButton);this.Od=this._context.view;this.haf();this.vf=lF.vf;this.Tg(WordEditorIntl.WordEditorStrings.l_DeleteStyle,Object(m.a)(this,this.Mrk,"deleteStyleDialogHandler"),{["styleList"]:0});this.Lga=document.getElementById("styleList");this.iEf();this.Lga.selectedIndex=
0;this.Lga.focus()}get qb(){return this.$b||(this.$b=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get xXe(){return this.C3a||(this.C3a=xa.a.instance.resolve("WordEditor.UI.IDialogFactory"))}Mrk(a,c){this.Od.jr&&(a?(a=c.styleList,-1!==a&&(a=this.ZE[a],c=this.qb.lp(),a=this.qb.oe(c.tqa(a)),this.xXe.Lrk(this._context,a),this.Od.BS())):this.Od.BS())}iEf(){const a=this.ZE.length;for(let c=0;c<a;c++){const h=document.createElement("OPTION");h.value=c.toString();h.text=this.ZE[c];this.Lga.add(h,
null)}}haf(){if(this.nu=dl.a.Vy()){var a=(new kl.WACStyleSet).vM(this.nu),c=a.cM;this.ZE=[];for(let v=0;v<c;v++){const B=a.Uia(v);if(!this.qb.isHidden(B)&&this.qb.ny(B,a)){var h=this.qb.Gv(B);if(2===h||1===h)B.hasProperty(Yb.a.j9)&&2!==h||(h=B.ia(Yb.a.zD,null))&&0<h.length||this.ZE.push(this.qb.pC(B))}}this.ZE.sort()}else Sd.b(578650370,3018,15,"PageContentNode is null")}}Object(w.a)(xJ,"DeleteStyleDialog",gg.a,[]);var EP=b(701);class yJ{constructor(a){this.customData=null;this.nM=a}}Object(w.a)(yJ,
"PropertySetChangedState",null,[]);class zJ{static IFm(a,c,h){if(a&&c){var v=new yJ(c),B=(X,ma,Pa)=>{h.HFm(X,ma,Pa,v)};a=new EP.a(c,a);a.yld=B;a.Lod=B;a.qYd=B;a.Y7b()}}}Object(w.a)(zJ,"PropertySetChangedManager",null,[]);class AJ{constructor(a){this.S6=a}HFm(a,c,h,v){const B=this.S6[a.id.toString()];B&&B(a,c,h,v)}}Object(w.a)(AJ,"PropertyChangedProcessor",null,[]);const mE=(a,c,h)=>{const v=yr.a.instance.EYb;if(v){const B=new gf.GraphTransaction(15);B.Oa(v);zJ.IFm(a,c,new AJ(h));B.dispose()}};class mF{static get vf(){return gg.a.fy(mF.ll,
WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTop,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeft,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottom,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRight)}}mF.ll="<div class='WACDialogRow' id='RowMargins'> <div class='WACDialogGroupBox' id='MarginsDialogTopLeftBox'> <div class='WacDialogLabels' id='MarginsDialogTopLeftLabels'> <label id='MarginsDialogMarginTop' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='MarginsDialogMarginLeft' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogTopLeftSpinners'> <div id='MarginsDialogMarginTopSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginLeftSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> <div class='WACDialogGroupBox MarginsDialogRightChunk' id='MarginsDialogBottomRightBox'> <div class='WacDialogLabels' id='MarginsDialogBottomRightLabels'> <label id='MarginsDialogMarginBottom' class='DialogSpinnerLabel' >{2}</label> <br/> <label id='MarginsDialogMarginRight' class='DialogSpinnerLabel' >{3}</label> <br/> </div> <div class='WacSpinnerBoxes' id='MarginsDialogBottomRightSpinners'> <div id='MarginsDialogMarginBottomSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='MarginsDialogMarginRightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div> </div>";
Object(w.a)(mF,"MarginsDialogHtml",null,[]);class ts{static get fsa(){return ts.Yyg||(ts.Yyg=xa.a.instance.ra("WordEditor.IPageCommands"))}static Q$l(a,c,h){ts.fsa&&null!==h&&ts.fsa.z0d(0,h)}static M$l(a,c,h){ts.fsa&&null!==h&&ts.fsa.z0d(3,h)}static O$l(a,c,h){ts.fsa&&null!==h&&ts.fsa.z0d(1,h)}static P$l(a,c,h){ts.fsa&&null!==h&&ts.fsa.z0d(2,h)}static Exm(a,c,h){ts.fsa&&null!==h&&ts.fsa.ZMa(0,h)}static gxm(a,c,h){ts.fsa&&null!==h&&ts.fsa.ZMa(1,h)}}ts.Yyg=null;Object(w.a)(ts,"PageLevelPropertyChangedHandlers",
null,[]);class yu extends gg.a{constructor(a,c,h,v,B){super();this.jf="MarginsDialog";this.l7=c.clone();this.vT=a.clone();this.Be=a.clone();this.xT=h;this.jT=!1;this.Es=B;this.vf=mF.vf;h&&(this.HLb=qk.a.Hib);this.Tg(WordEditorIntl.WordEditorStrings.L_PageMargins,Object(m.a)(this,this.S$l,"marginsDialogResultHandler"),null);this.xHc()}cS(){this.Hnd("MarginsDialogMarginTopSpinnerContainer","DialogMarginTopSpinner",ba.a.bPc,ba.a.TVd,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginTopAlt);this.Hnd("MarginsDialogMarginBottomSpinnerContainer",
"DialogMarginBottomSpinner",ba.a.aPc,ba.a.QVd,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginBottomAlt);this.Hnd("MarginsDialogMarginLeftSpinnerContainer","DialogMarginLeftSpinner",ba.a.ISd,ba.a.RVd,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginLeftAlt);this.Hnd("MarginsDialogMarginRightSpinnerContainer","DialogMarginRightSpinner",ba.a.JSd,ba.a.SVd,WordEditorIntl.WordEditorStrings.l_MarginsDialogMarginRightAlt)}xHc(){for(let a=0;a<yu.iCa.length;a++)ug.a.Poa(yu.iCa[a],Object(m.a)(this,
this.UMa,"setAdvancedControlValue"),Object(m.a)(this,this.GIa,"getAdvancedControlValue"));this.Es.lS("DialogMarginTopSpinner");this.Es.lS("DialogMarginBottomSpinner");this.Es.lS("DialogMarginLeftSpinner");this.Es.lS("DialogMarginRightSpinner")}dispose(){for(let a=0;a<yu.iCa.length;a++)ug.a.Nxa(yu.iCa[a]);this.Es.DC("DialogMarginTopSpinner");this.Es.DC("DialogMarginBottomSpinner");this.Es.DC("DialogMarginLeftSpinner");this.Es.DC("DialogMarginRightSpinner");super.dispose()}GIa(a,c){var h=yu.FQc(a);
a=Eb.App.nAa;this.Be.hasProperty(h)?(h=this.Be.getValue(h),c[pg.a.Number]=Of.a.A1a(h,a)):c[pg.a.Number]=0;c[pg.a.UnitType]=a}UMa(a,c){this.Be.setValue(yu.FQc(a),Of.a.Rib(c[pg.a.Number],c[pg.a.UnitType]));this.Es.yk()}S$l(a){let c=!1;1===a&&(Math.abs(this.Be.getValue(Yb.a.marginTop))+Math.abs(this.Be.getValue(Yb.a.marginBottom))+Eb.App.Jta<=this.l7.getValue(Yb.a.lA)&&this.Be.getValue(Yb.a.marginLeft)+this.Be.getValue(Yb.a.marginRight)+Eb.App.Jta<=this.l7.getValue(Yb.a.Po)?mE(this.vT,this.Be,yu.Bxb()):
c=!0);this.dispose();c&&this.VBa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage,Object(m.a)(this,this.N$l,"marginDialogCreator"))}N$l(){xa.a.instance.resolve("WordEditor.UI.IDialogFactory").y9g(this.vT,this.l7,this.xT)}Hnd(a,c,h,v,B){h=yu.kXj(c,h,v,B);this.usb(h,a,c)}usb(a,c,h){c=document.getElementById(c);this.Es.KGa(h,a);a=this.Es.yab(h,"Medium");c.appendChild(a)}static Bxb(){return yu.S6||(yu.S6=yu.v9a())}static v9a(){const a={};a[Yb.a.marginTop.id.toString()]=ts.Q$l;a[Yb.a.marginBottom.id.toString()]=
ts.M$l;a[Yb.a.marginLeft.id.toString()]=ts.O$l;a[Yb.a.marginRight.id.toString()]=ts.P$l;return a}static kXj(a,c,h,v){let B=!0;if(c===ba.a.bPc||c===ba.a.aPc)B=!1;return jf.o(a,c,h,v,[yu.mXj(B),yu.lXj(B)])}static mXj(a){return jf.q("inch",a?"0":"-22","22",".1")}static lXj(a){return jf.q("centimeter",a?"0":"-55.8","55.8","1")}static FQc(a){let c=null;switch(a){case ba.a.bPc:case ba.a.TVd:c=Yb.a.marginTop;break;case ba.a.aPc:case ba.a.QVd:c=Yb.a.marginBottom;break;case ba.a.ISd:case ba.a.RVd:c=Yb.a.marginLeft;
break;case ba.a.JSd:case ba.a.SVd:c=Yb.a.marginRight}return c}}yu.iCa=[ba.a.bPc,ba.a.aPc,ba.a.ISd,ba.a.JSd,ba.a.TVd,ba.a.QVd,ba.a.RVd,ba.a.SVd];yu.S6=null;Object(w.a)(yu,"MarginsDialog",gg.a,[]);class nF{static get vf(){return gg.a.fy(nF.ll,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidth,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeight)}}nF.ll="<div class='WACDialogRow' id='RowPapeSize'> <div class='WacDialogLabels' id='PaperSizeDialogLabels'> <label id='PaperSizeDialogWidth' class='DialogSpinnerLabel' >{0}</label> <br/> <label id='PaperSizeDialogHeight' class='DialogSpinnerLabel' >{1}</label> <br/> </div> <div class='WacSpinnerBoxes' id='PaperSizeDialogSpinners'> <div id='PaperSizeDialogWidthSpinnerContainer' class='WacSpinnerBox'></div> <br/> <div id='PaperSizeDialogHeightSpinnerContainer' class='WacSpinnerBox'></div> <br/> </div> </div>";
Object(w.a)(nF,"PaperSizeDialogHtml",null,[]);class Xq extends gg.a{constructor(a,c,h,v,B){super();this.jf="PaperSizeDialog";this.l7=c.clone();this.vT=a.clone();this.Be=a.clone();this.xT=h;this.jT=!1;this.Es=B;this.vf=nF.vf;h&&(this.HLb=qk.a.Hib);this.Tg(WordEditorIntl.WordEditorStrings.l_PaperSizeDialogTitle,Object(m.a)(this,this.Nxm,"paperSizeDialogResultHandler"),null);this.xHc()}cS(){this.$Xg("PaperSizeDialogWidthSpinnerContainer","DialogWidthSpinner",ba.a.MSd,ba.a.hWd,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogWidthAlt);
this.$Xg("PaperSizeDialogHeightSpinnerContainer","DialogHeightSpinner",ba.a.LSd,ba.a.gWd,WordEditorIntl.WordEditorStrings.l_PaperSizeDialogHeightAlt)}xHc(){for(let a=0;a<Xq.iCa.length;a++)ug.a.Poa(Xq.iCa[a],Object(m.a)(this,this.UMa,"setAdvancedControlValue"),Object(m.a)(this,this.GIa,"getAdvancedControlValue"));this.Es.lS("DialogWidthSpinner");this.Es.lS("DialogHeightSpinner")}dispose(){for(let a=0;a<Xq.iCa.length;a++)ug.a.Nxa(Xq.iCa[a]);this.Es.DC("DialogWidthSpinner");this.Es.DC("DialogHeightSpinner");
super.dispose()}GIa(a,c){var h=this.FQc(a);a=Eb.App.nAa;this.Be.hasProperty(h)?(h=this.Be.getValue(h),c[pg.a.Number]=Of.a.A1a(h,a)):c[pg.a.Number]=0;c[pg.a.UnitType]=a}UMa(a,c){this.Be.setValue(this.FQc(a),Of.a.Rib(c[pg.a.Number],c[pg.a.UnitType]));this.Es.yk()}Nxm(a){let c=!1;1===a&&(this.Be.getValue(Yb.a.lA)>=Eb.App.Jta+this.l7.getValue(Yb.a.marginTop)+this.l7.getValue(Yb.a.marginBottom)&&this.Be.getValue(Yb.a.Po)>=Eb.App.Jta+this.l7.getValue(Yb.a.marginLeft)+this.l7.getValue(Yb.a.marginRight)?
mE(this.vT,this.Be,Xq.Bxb()):c=!0);this.dispose();c&&this.VBa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage,Object(m.a)(this,this.Mxm,"paperSizeDialogCreator"))}Mxm(){xa.a.instance.resolve("WordEditor.UI.IDialogFactory").$9g(this.vT,this.l7,this.xT)}$Xg(a,c,h,v,B){h=Xq.EXj(c,h,v,B);this.usb(h,a,c)}usb(a,c,h){c=document.getElementById(c);this.Es.KGa(h,a);a=this.Es.yab(h,"Medium");c.appendChild(a)}FQc(a){let c=null;switch(a){case ba.a.LSd:case ba.a.gWd:c=Yb.a.lA;break;case ba.a.MSd:case ba.a.hWd:c=
Yb.a.Po}return c}static Bxb(){return Xq.S6||(Xq.S6=Xq.v9a())}static v9a(){const a={};a[Yb.a.Po.id.toString()]=ts.Exm;a[Yb.a.lA.id.toString()]=ts.gxm;return a}static EXj(a,c,h,v){return jf.o(a,c,h,v,[Xq.GXj(),Xq.FXj()])}static GXj(){return jf.q("inch",Xq.vJi,Xq.ZWl,Xq.cun)}static FXj(){return jf.q("centimeter",Xq.vJi,Xq.YWl,Xq.bun)}}Xq.iCa=[ba.a.MSd,ba.a.LSd,ba.a.hWd,ba.a.gWd];Xq.vJi="0";Xq.ZWl="22";Xq.cun=".1";Xq.bun="1";Xq.YWl="55.8";Xq.S6=null;Object(w.a)(Xq,"PaperSizeDialog",gg.a,[]);class BJ{constructor(){this.OJi=
this.Zfi=this.Yfi=this.Uxm=this.lCf=!1}}Object(w.a)(BJ,"Box4PropertySetChangedState",null,[]);class gk{static get n1b(){return gk.Zmg||(gk.Zmg=xa.a.instance.ra("Box4.IIndentationCommands"))}static get HYh(){return gk.qrg||(gk.qrg=xa.a.instance.ra("Box4.IJustificationCommands"))}static get HY(){return gk.Z6a||(gk.Z6a=xa.a.instance.ra("Box4.ISpacingCommands"))}static GYh(a,c,h){gk.HYh&&h&&(null===c||11!==h||10!==c&&9!==c)&&gk.HYh.vB(h)}static m_h(a,c,h){gk.HY&&h&&gk.HY.sA(h)}static jdk(a,c,h){c!=h&&
gk.HY.B$b(h)}static pWl(a,c,h){c!=h&&gk.HY.mVc(h)}static jWn(a,c,h){c!=h&&gk.HY.MVc(h)}static wTd(a,c,h,v){gk.HY&&void 0!==h&&null!==h&&(a=gk.OCc(v),!a.lCf&&v.nM.hasProperty(Uc.a.$Aa)&&v.nM.hasProperty(Uc.a.aBa)&&(c=v.nM.getValue(Uc.a.aBa),v=v.nM.getValue(Uc.a.$Aa),a.lCf=!0,gk.HY.xea(1,c,v)))}static vTd(a,c,h,v){gk.HY&&void 0!==h&&null!==h&&(a=gk.OCc(v),!a.Uxm&&v.nM.hasProperty(Uc.a.YAa)&&v.nM.hasProperty(Uc.a.ZAa)&&(c=v.nM.getValue(Uc.a.ZAa),v=v.nM.getValue(Uc.a.YAa),a.lCf=!0,gk.HY.xea(0,c,v)))}static sTd(a,
c,h,v){gk.n1b&&void 0!==h&&null!==h&&(a=gk.OCc(v),!a.Yfi&&v.nM.hasProperty(Uc.a.G9)&&v.nM.hasProperty(Uc.a.H9)&&(c=v.nM.getValue(Uc.a.H9),v=v.nM.getValue(Uc.a.G9),a.Yfi=!0,gk.n1b.DCi(1,c,v)))}static tTd(a,c,h,v){gk.n1b&&void 0!==h&&null!==h&&(a=gk.OCc(v),!a.Zfi&&v.nM.hasProperty(Uc.a.hsa)&&v.nM.hasProperty(Uc.a.isa)&&(c=v.nM.getValue(Uc.a.isa),v=v.nM.getValue(Uc.a.hsa),a.Zfi=!0,gk.n1b.DCi(0,c,v)))}static Sac(a,c,h,v){gk.n1b&&void 0!==h&&null!==h&&(a=gk.OCc(v),!a.OJi&&v.nM.hasProperty(Uc.a.l$)&&v.nM.hasProperty(Uc.a.IY)&&
(c=0,v.nM.hasProperty(Uc.a.kH)&&(c=v.nM.getValue(Uc.a.kH)),h=v.nM.getValue(Uc.a.IY),v=v.nM.getValue(Uc.a.l$),a.OJi=!0,gk.n1b.P0d(c,h,v)))}static OCc(a){a.customData||(a.customData=new BJ);return a.customData}}gk.Zmg=null;gk.qrg=null;gk.Z6a=null;Object(w.a)(gk,"ParagraphLevelPropertyChangedHandlers",null,[]);class ki extends gg.a{constructor(a,c,h,v,B,X){super();this.YP=this.B6c=!1;this.jf="ParagraphDialog";ki.HY=h;this.Ou=X;this.vT=a.clone();this.Be=a.clone();if(this.xT=c)this.HLb=qk.a.Hib}cS(){ki.aYg(ki.evn,
ki.VJi,zb.a.Y6b,zb.a.q8b,zb.a.p0a,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,this.Ou);ki.aYg(ki.dvn,ki.UJi,zb.a.NSd,zb.a.qWd,zb.a.XWc,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,this.Ou);ki.eXj(ki.cvn,ki.GUf,this.Ou);ki.hXj(ki.UYl,ki.KLd,this.Ou)}Eff(){for(let a=0;a<ki.T2d.length;a++)ug.a.Poa(ki.T2d[a],Object(m.a)(this,this.UMa,"setAdvancedControlValue"),Object(m.a)(this,this.GIa,"getAdvancedControlValue"));ug.a.Poa(zb.a.qZa,Object(m.a)(this,this.Wgb,"setDropDownValue"),Object(m.a)(this,
this.Tfb,"provideDropDownValue"));ug.a.Poa(zb.a.jRc,Object(m.a)(this,this.Wgb,"setDropDownValue"),Object(m.a)(this,this.Tfb,"provideDropDownValue"));this.Ou.yk()}dispose(){if(!this.YP){for(let a=0;a<ki.T2d.length;a++)ug.a.Nxa(ki.T2d[a]);ug.a.Nxa(zb.a.qZa);ug.a.Nxa(zb.a.jRc);this.Ou.DC(ki.VJi);this.Ou.DC(ki.UJi);this.Ou.DC(ki.GUf);this.Ou.DC(ki.KLd);super.dispose();this.YP=!0}}GIa(a,c){switch(a){case zb.a.q8b:case zb.a.qWd:var h=a===zb.a.q8b?Uc.a.aBa:Uc.a.ZAa;a=a===zb.a.q8b?Uc.a.$Aa:Uc.a.YAa;this.Be.hasProperty(h)&&
this.Be.hasProperty(a)?(a=this.Be.getValue(a),1===a?(c[pg.a.Text]=Box4Intl.Box4Strings.L_SpinnerAuto,c[pg.a.Number]=Number.NaN,c[pg.a.UnitType]=5):(h=this.Be.getValue(h),a=2===a?4:5,c[pg.a.Number]=h,c[pg.a.UnitType]=a)):(c[pg.a.Text]="",c[pg.a.Number]=Number.NaN,c[pg.a.UnitType]=Eb.App.n4?4:5);break;case zb.a.PVd:h=!1,this.Be.hasProperty(Uc.a.Zt)&&this.Be.hasProperty(Uc.a.WX)&&2===this.Be.getValue(Uc.a.WX)&&(this.FTh()||this.B6c)&&(a=ki.WR.cJa(this.Be),a>=ki.qsf&&(c[pg.a.Number]=a,h=!0)),h||(c[pg.a.Text]=
"",c[pg.a.Number]=Number.NaN),c[pg.a.UnitType]=0}}UMa(a,c){var h=c[pg.a.Text],v=c[pg.a.Number],B=c[pg.a.UnitType];switch(a){case zb.a.Y6b:case zb.a.NSd:h===Box4Intl.Box4Strings.L_SpinnerAuto?(h=0,v=1):(h=v,v=4===B?2:4);c=a===zb.a.Y6b?Uc.a.$Aa:Uc.a.YAa;this.Be.setValue(a===zb.a.Y6b?Uc.a.aBa:Uc.a.ZAa,h);this.Be.setValue(c,v);break;case zb.a.p0a:case zb.a.XWc:B=a===zb.a.p0a?Uc.a.aBa:Uc.a.ZAa;a=a===zb.a.p0a?Uc.a.$Aa:Uc.a.YAa;c=c.Increment;""===h||c&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Be.setValue(B,
0),this.Be.setValue(a,4)):v||c||(this.Be.setValue(B,0),this.Be.setValue(a,1));break;case zb.a.HSd:this.cCi(v);break;case zb.a.b3d:""===h&&this.cCi(ki.qsf)}this.Ou.yk()}cCi(a){this.Be.setValue(Uc.a.WX,2);this.Be.setValue(Uc.a.Zt,ki.WR.H8e(a));this.B6c=!0;this.Ou.lS(ki.KLd)}Tfb(a,c){switch(a){case zb.a.jRc:this.mIm(c)}}mIm(a){let c=0;var h=!1;this.Be.hasProperty(Uc.a.Zt)&&this.Be.hasProperty(Uc.a.WX)||(h=!0);h||(2!==this.Be.getValue(Uc.a.WX)&&(h=!0),c=ki.WR.cJa(this.Be),c<ki.qsf&&(h=!0));h||(h=ki.Jof,
this.B6c||this.FTh()||(uf.a.KX(c,1)?h="1.00":uf.a.KX(c,1.5)?h="1.50":uf.a.KX(c,2)&&(h="2.00")),a[cc.a.SelectedItemId]=h)}Wgb(a,c){switch(a){case zb.a.qZa:this.mdn(c)}}mdn(a){a=a.MenuItemId;a===ki.Jof?(this.Be.setValue(Uc.a.WX,2),this.Be.setValue(Uc.a.Zt,ki.WR.H8e(3))):(a=parseFloat(a),this.Be.setValue(Uc.a.WX,2),this.Be.setValue(Uc.a.Zt,ki.WR.H8e(a)));this.B6c=!1;this.Ou.lS(ki.KLd);this.Ou.lS(ki.GUf)}BTd(a){1===a&&mE(this.vT,this.Be,ki.Bxb());this.dispose()}ATd(){const a=xa.a.instance.resolve("Box4.UI.IBox4DialogFactory"),
c=xa.a.instance.resolve("WordEditor.ClientPagination.IClientPaginationSettings");a.xWb(this.vT,null,this.xT,c)}FTh(){if(!this.Be.hasProperty(Uc.a.Zt)||!this.Be.hasProperty(Uc.a.WX)||2!==this.Be.getValue(Uc.a.WX))return!1;const a=ki.WR.cJa(this.Be);return!uf.a.KX(a,1)&&!uf.a.KX(a,1.5)&&!uf.a.KX(a,2)}static get WR(){return ki.Gx||(ki.Gx=xa.a.instance.resolve("Box4.ILineSpacingHelper"))}static Bxb(){return ki.S6||(ki.S6=ki.v9a())}static v9a(){const a={};a[Uc.a.Zt.id.toString()]=gk.m_h;a[Uc.a.ZAa.id.toString()]=
gk.vTd;a[Uc.a.YAa.id.toString()]=gk.vTd;a[Uc.a.aBa.id.toString()]=gk.wTd;a[Uc.a.$Aa.id.toString()]=gk.wTd;return a}static aYg(a,c,h,v,B,X,ma){h=ki.IXj(c,h,v,B,X);ki.tsb(h,a,c,ma)}static eXj(a,c,h){const v=ki.fXj(c);ki.tsb(v,a,c,h)}static hXj(a,c,h){const v=ki.iXj(c);ki.tsb(v,a,c,h)}static tsb(a,c,h,v){c=document.getElementById(c);v.KGa(h,a);a=v.yab(h,"Medium");c.appendChild(a)}static IXj(a,c,h,v,B){return jf.o(a,c,h,B,[ki.dYj(),ki.cYj()],[Box4Intl.Box4Strings.L_SpinnerAuto],v,ki.f3d)}static fXj(a){return jf.o(a,
zb.a.HSd,zb.a.PVd,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,[ki.gXj()],null,zb.a.b3d,ki.f3d)}static gXj(){return jf.q("none","1","132",".5")}static dYj(){return jf.q("point","0","1584","1")}static cYj(){return jf.q("line","0","327","1")}static iXj(a){const c=jf.f("DdlLineSpacing_Single","1.00",zb.a.qZa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle),h=jf.f("DdlLineSpacing_1.5","1.50",zb.a.qZa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf),
v=jf.f("DdlLineSpacing_Double","2.00",zb.a.qZa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble),B=jf.f("DdlLineSpacing_Multiple",ki.Jof,zb.a.qZa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple);return jf.n(a,zb.a.qZa,zb.a.jRc,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,ki.VYl,[c,h,v,B])}}ki.VYl=150;ki.f3d=70;ki.qsf=1;ki.VJi="DialogSpacingBeforeSpinner";ki.UJi="DialogSpacingAfterSpinner";ki.GUf="DialogLineSpacingAtSpinner";ki.evn="ParagraphDialogSpacingBeforeSpinnerContainer";
ki.dvn="ParagraphDialogSpacingAfterSpinnerContainer";ki.cvn="ParagraphDialogLineSpacingAtSpinnerContainer";ki.UYl="ParagraphDialogLineSpacingContainer";ki.KLd="ParagraphDialogLineSpacingSelect";ki.Jof="multiple";ki.T2d=[zb.a.Y6b,zb.a.NSd,zb.a.HSd,zb.a.q8b,zb.a.qWd,zb.a.PVd,zb.a.b3d,zb.a.XWc,zb.a.p0a];ki.HY=null;ki.Gx=null;ki.S6=null;Object(w.a)(ki,"ParagraphDialog",gg.a,[]);class oF{static get vf(){return gg.a.fy(oF.ll,Box4Intl.Box4Strings.l_ParagraphDialogGeneral,Box4Intl.Box4Strings.l_ParagraphDialogAlignment,
Box4Intl.Box4Strings.l_ParagraphDialogIndentation,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,Box4Intl.Box4Strings.l_ParagraphDialogSpacing,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy)}}
oF.ll="<div class='WACDialogGroupBox ParagraphDialogLeftChunk' id='LeftChunk'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> <div class='ParagraphDialogContentArea' id='ParagraphDialogGeneralRow'> <div class='WACDialogGroupBox' id='GeneralLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='Alignment' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogAlignmentContainer' >{1}</label> </td> <td> <div id='ParagraphDialogAlignmentContainer' class='WacSpinnerBox' aria-labelledby='Alignment' role='presentation'></div> </td> </tr> </table> <div class='WACDialogRow' id='ParagraphDialogIndentationRow'> <div class='WACDialogSectionTitle UIFontBold'>{2}</div> </div> <div class='WACDialogGroupBox ParagraphDialogContentArea' id='InnerRowIndentationLabels'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr role='presentation'> <td> <label id='ParagraphDialogIndentationLeft' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentLeftSpinnerContainer' >{3}</label> </td> <td> <div id='ParagraphDialogIndentLeftSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationLeft' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogIndentationRight' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogIndentRightSpinnerContainer' >{4}</label> </td> <td> <div id='ParagraphDialogIndentRightSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogIndentationRight' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndent' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentContainer' >{10}</label> </td> <td> <div id='ParagraphDialogSpecialIndentContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndent' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpecialIndentBy' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpecialIndentBySpinnerContainer' >{11}</label> </td> <td> <div id='ParagraphDialogSpecialIndentBySpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpecialIndentBy' role='presentation'></div> </td> </tr> </table> </div> </div> </div> </div> <div class='WACDialogGroupBox ParagraphDialogRightChunk' id='RightChunk'> <div class='WACDialogSectionTitle UIFontBold'>{5}</div> <div class='ParagraphDialogContentArea' id='InnerRowSpacing'> <div class='WACDialogGroupBox' id='SpacingLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr> <td> <label id='ParagraphDialogSpacingBefore' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingBeforeSpinnerContainer' >{6}</label> </td> <td> <div id='ParagraphDialogSpacingBeforeSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingBefore' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpacingAfter' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingAfterSpinnerContainer' >{7}</label> </td> <td> <div id='ParagraphDialogSpacingAfterSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingAfter' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacing' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingContainer' >{8}</label> </td> <td> <div id='ParagraphDialogLineSpacingContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacing' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacingAt' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingAtSpinnerContainer' >{9}</label> </td> <td> <div id='ParagraphDialogLineSpacingAtSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacingAt' role='presentation'></div> </td> </tr> </table> </div> </div> </div>";
Object(w.a)(oF,"ParagraphDialogHtml",null,[]);const LG=a=>1===a||2===a||3===a||6===a||10===a||11===a||9===a||7===a||13===a,MG=(a,c,h,v)=>{let B=Eb.App.nAa;a.hasProperty(c)&&a.hasProperty(h)&&!v?(c=a.getValue(c),a=a.getValue(h),c?2===a?B=2:c=Of.a.A1a(c,B):Eb.App.n4&&(B=2)):(c=Number.NaN,Eb.App.n4&&(B=2));return{Rac:c,g1a:B}},FP=a=>{let c="0";a.hasProperty(Uc.a.kH)&&(a=a.getValue(Uc.a.kH),(1===a||2===a||!a)&&(1===a?c="1":2===a?c="2":a||(c="0")));return c},pF=(a,c)=>{if(c.hasProperty(Uc.a.kH)&&2===c.getValue(Uc.a.kH)&&
c.hasProperty(Uc.a.IY)&&c.hasProperty(Uc.a.l$)&&a.hasProperty(Uc.a.H9)&&a.hasProperty(Uc.a.G9)){var h=a.getValue(Uc.a.H9),v=a.getValue(Uc.a.G9);h=(new Vl.a(v,h)).jt;v=c.getValue(Uc.a.IY);c=c.getValue(Uc.a.l$);c=(new Vl.a(c,v)).jt;a.setValue(Uc.a.H9,h+c);a.setValue(Uc.a.G9,1)}},FJ=(a,c)=>{var h;if(h=CJ(a,c))h=c.hasProperty(Uc.a.IY)&&c.hasProperty(Uc.a.l$);if(h){h=c.getValue(Uc.a.IY);const v=c.getValue(Uc.a.l$);h=(new Vl.a(v,h)).jt;return DJ(c)+EJ(c)+a.getValue(Yb.a.marginRight)+a.getValue(Yb.a.marginLeft)+
h+Eb.App.Jta<=a.getValue(Yb.a.Po)}return CJ(a,c)?DJ(c)+EJ(c)+a.getValue(Yb.a.marginRight)+a.getValue(Yb.a.marginLeft)+Eb.App.Jta<=a.getValue(Yb.a.Po):!0},DJ=a=>{const c=a.getValue(Uc.a.H9);a=a.getValue(Uc.a.G9);return(new Vl.a(a,c)).jt},EJ=a=>{const c=a.getValue(Uc.a.isa);a=a.getValue(Uc.a.hsa);return(new Vl.a(a,c)).jt},CJ=(a,c)=>c.hasProperty(Uc.a.H9)&&c.hasProperty(Uc.a.G9)&&c.hasProperty(Uc.a.isa)&&c.hasProperty(Uc.a.hsa)&&a.hasProperty(Yb.a.marginLeft)&&a.hasProperty(Yb.a.marginRight)&&a.hasProperty(Yb.a.Po),
GP=a=>a.hasProperty(Uc.a.CPc)?a.getValue(Uc.a.CPc):!1,HP=a=>a.hasProperty(Vq.a.LO)?a.getValue(Vq.a.LO):!1,IP=a=>a.hasProperty(Vq.a.kOa)?a.getValue(Vq.a.kOa):!1;class lr extends ki{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){super(a,h,X,ma,Pa,Tb);this.BE=rc;this.vf=oF.vf;this.l7=c.clone();this.Tg(Box4Intl.Box4Strings.l_ParagraphDialogTitle,Object(m.a)(this,this.BTd,"paragraphDialogResultHandler"),null);this.Eff();a=document.getElementById("ParagraphDialogAlignmentControl-Medium");this.AY(a)}cS(){lr.RXg("ParagraphDialogIndentLeftSpinnerContainer",
"DialogIndentLeftSpinner",zb.a.m1b,zb.a.mEb,zb.a.Uac,Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,this.Ou);lr.RXg("ParagraphDialogIndentRightSpinnerContainer","DialogIndentRightSpinner",zb.a.aGd,zb.a.YQc,zb.a.a3d,Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,this.Ou);lr.hYj(this.Ou);const a=this.Be.getValue(Uc.a.Dr);lr.HVj(a,this.Ou);lr.jYj(this.Ou);super.cS()}Eff(){for(let a=0;a<lr.cGd.length;a++)ug.a.Poa(lr.cGd[a],Object(m.a)(this,this.UMa,"setAdvancedControlValue"),Object(m.a)(this,
this.GIa,"getAdvancedControlValue"));ug.a.Poa(zb.a.tka,Object(m.a)(this,this.Wgb,"setDropDownValue"),Object(m.a)(this,this.Tfb,"provideDropDownValue"));ug.a.Poa(zb.a.o8b,Object(m.a)(this,this.Wgb,"setDropDownValue"),Object(m.a)(this,this.Tfb,"provideDropDownValue"));ug.a.Poa(zb.a.rZa,Object(m.a)(this,this.Wgb,"setDropDownValue"),Object(m.a)(this,this.Tfb,"provideDropDownValue"));ug.a.Poa(zb.a.r8b,Object(m.a)(this,this.Wgb,"setDropDownValue"),Object(m.a)(this,this.Tfb,"provideDropDownValue"));super.Eff()}dispose(){if(!this.uk){for(let a=
0;a<lr.cGd.length;a++)ug.a.Nxa(lr.cGd[a]);ug.a.Nxa(zb.a.tka);ug.a.Nxa(zb.a.o8b);ug.a.Nxa(zb.a.rZa);ug.a.Nxa(zb.a.r8b);this.Ou.DC("DialogIndentLeftSpinner");this.Ou.DC("DialogIndentRightSpinner");this.Ou.DC("ParagraphDialogAlignmentControl");this.Ou.DC("ParagraphDialogSpecialIndentSelect");this.Ou.DC("ParagraphDialogSpecialIndentBySpinner");super.dispose()}}GIa(a,c){var h=!1;switch(a){case zb.a.mEb:case zb.a.YQc:var v=a===zb.a.mEb?Uc.a.H9:Uc.a.isa,B=a===zb.a.mEb?Uc.a.G9:Uc.a.hsa;h=Eb.App.nAa;this.Be.hasProperty(v)&&
this.Be.hasProperty(B)?(v=this.Be.getValue(v),B=this.Be.getValue(B),v?2===B?h=2:v=Of.a.A1a(v,h):Eb.App.n4&&(h=2),c[pg.a.Number]=v):(c[pg.a.Text]="",c[pg.a.Number]=Number.NaN,Eb.App.n4&&(h=2));c[pg.a.UnitType]=h;h=!0;break;case zb.a.rWd:v=Uc.a.IY;B=Uc.a.l$;let X=!1;h=Eb.App.nAa;this.Be.hasProperty(Uc.a.kH)&&(X=!this.Be.getValue(Uc.a.kH));this.Be.hasProperty(v)&&this.Be.hasProperty(B)&&!X?(v=this.Be.getValue(v),B=this.Be.getValue(B),v?2===B?h=2:v=Of.a.A1a(v,h):Eb.App.n4&&(h=2),c[pg.a.Number]=v):(c[pg.a.Text]=
"",c[pg.a.Number]=Number.NaN,Eb.App.n4&&(h=2));c[pg.a.UnitType]=h;h=!0}h||super.GIa(a,c)}UMa(a,c){var h=c[pg.a.Text],v=c[pg.a.Number],B=c[pg.a.UnitType],X=!1;switch(a){case zb.a.m1b:case zb.a.aGd:h=v;2===B?X=2:(X=1,h=Of.a.Rib(v,B));v=a===zb.a.m1b?Uc.a.G9:Uc.a.hsa;this.Be.setValue(a===zb.a.m1b?Uc.a.H9:Uc.a.isa,h);this.Be.setValue(v,X);X=!0;break;case zb.a.Uac:case zb.a.a3d:""===h&&(v=2===B?2:1,h=a===zb.a.Uac?Uc.a.G9:Uc.a.hsa,this.Be.setValue(a===zb.a.Uac?Uc.a.H9:Uc.a.isa,0),this.Be.setValue(h,v));
X=!0;break;case zb.a.p0a:case zb.a.XWc:B=a===zb.a.p0a?Uc.a.aBa:Uc.a.ZAa;X=a===zb.a.p0a?Uc.a.$Aa:Uc.a.YAa;const ma=c.Increment;""===h||ma&&h===Box4Intl.Box4Strings.L_SpinnerAuto?(this.Be.setValue(B,0),this.Be.setValue(X,4)):v||ma||(this.Be.setValue(B,0),this.Be.setValue(X,1));X=!0;break;case zb.a.OSd:""===h&&this.Be.setValue(Uc.a.kH,1);this.oDi(v,B);X=!0;break;case zb.a.e3d:""===h&&(this.Be.setValue(Uc.a.kH,1),this.oDi(.1,B)),X=!0}X||super.UMa(a,c)}oDi(a,c){let h=a,v;2===c?v=2:(v=1,h=Of.a.Rib(a,c));
this.Be.setValue(Uc.a.IY,h);this.Be.setValue(Uc.a.l$,v);this.Ou.lS("ParagraphDialogSpecialIndentBySpinner")}Tfb(a,c){let h=!1;switch(a){case zb.a.o8b:this.lIm(c);h=!0;break;case zb.a.r8b:this.nIm(c),h=!0}h||super.Tfb(a,c)}nIm(a){let c="0";if(this.Be.hasProperty(Uc.a.kH)){const h=this.Be.getValue(Uc.a.kH);(1===h||2===h||!h)&&(1===h?c="1":2===h?c="2":h||(c="0"))}a[cc.a.SelectedItemId]=c}lIm(a){if(this.Be.hasProperty(Uc.a.Dr)){let c=this.Be.getValue(Uc.a.Dr);if(10===c||9===c)c=11;LG(c)&&(a[cc.a.SelectedItemId]=
c.toString())}}Wgb(a,c){let h=!1;switch(a){case zb.a.tka:this.fhn(c);h=!0;break;case zb.a.rZa:this.ajn(c),h=!0}h||super.Wgb(a,c)}ajn(a){a=parseInt(a.MenuItemId);this.Be.setValue(Uc.a.kH,a);this.Ou.lS("ParagraphDialogSpecialIndentSelect");a?(this.Be.setValue(Uc.a.l$,1),this.Be.hasProperty(Uc.a.IY)?this.Be.getValue(Uc.a.IY)||this.Be.setValue(Uc.a.IY,720):this.Be.setValue(Uc.a.IY,720)):(this.Be.setValue(Uc.a.l$,1),this.Be.setValue(Uc.a.IY,0));this.Ou.lS("ParagraphDialogSpecialIndentBySpinner")}fhn(a){this.Be.setValue(Uc.a.Dr,
parseInt(a.MenuItemId));this.Ou.lS("ParagraphDialogAlignmentControl")}BTd(a){let c="";1===a&&(pF(this.vT,this.vT),pF(this.Be,this.vT),FJ(this.l7,this.Be)?mE(this.vT,this.Be,lr.Bbf()):c=""!==c?c:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage);this.dispose();""!==c&&this.VBa(c,Object(m.a)(this,this.ATd,"paragraphDialogCreator"))}ATd(){xa.a.instance.resolve("Box4.UI.IBox4DialogFactory").xWb(this.vT,this.l7,this.xT,this.BE)}static Bbf(){return ki.S6||(ki.S6=lr.$Ue())}static $Ue(){const a=ki.Bxb();
a[Uc.a.Dr.id.toString()]=gk.GYh;a[Uc.a.G9.id.toString()]=gk.sTd;a[Uc.a.H9.id.toString()]=gk.sTd;a[Uc.a.hsa.id.toString()]=gk.tTd;a[Uc.a.isa.id.toString()]=gk.tTd;a[Uc.a.kH.id.toString()]=gk.Sac;a[Uc.a.l$.id.toString()]=gk.Sac;a[Uc.a.IY.id.toString()]=gk.Sac;return a}static RXg(a,c,h,v,B,X,ma){h=lr.UWj(c,h,v,B,X);ki.tsb(h,a,c,ma)}static hYj(a){const c=lr.iYj();ki.tsb(c,"ParagraphDialogSpecialIndentBySpinnerContainer","ParagraphDialogSpecialIndentBySpinner",a)}static HVj(a,c){a=lr.IVj(a);ki.tsb(a,"ParagraphDialogAlignmentContainer",
"ParagraphDialogAlignmentControl",c)}static jYj(a){const c=lr.kYj();ki.tsb(c,"ParagraphDialogSpecialIndentContainer","ParagraphDialogSpecialIndentSelect",a)}static UWj(a,c,h,v,B){return jf.o(a,c,h,B,[lr.XWj(),lr.WWj(),lr.VWj()],null,v,ki.f3d)}static iYj(){return jf.o("ParagraphDialogSpecialIndentBySpinner",zb.a.OSd,zb.a.rWd,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,[lr.gYj(),lr.fYj(),lr.eYj()],null,zb.a.e3d,ki.f3d)}static gYj(){return jf.q("inch","0","22",".1")}static fYj(){return jf.q("centimeter",
"0","55.88","1")}static eYj(){return jf.q("character","0","316.8",".5")}static XWj(){return jf.q("inch","-11","22",".1")}static WWj(){return jf.q("centimeter","-27.94","55.88","1")}static VWj(){return jf.q("character","-316.8","316.8",".5")}static IVj(a){return jf.n("ParagraphDialogAlignmentControl",zb.a.tka,zb.a.o8b,Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,150,lr.kkk(a))}static kkk(a){var c=jf.f("DdlAlignment_Left","1",zb.a.tka.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft),
h=jf.f("DdlAlignment_Center","2",zb.a.tka.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter);const v=jf.f("DdlAlignment_Right","3",zb.a.tka.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignRight),B=jf.f("DdlAlignment_Justified","6",zb.a.tka.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified),X=jf.f("DdlAlignment_Kashida","11",zb.a.tka.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida),ma=jf.f("DdlAlignment_Distribued","7",zb.a.tka.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed),
Pa=jf.f("DdlAlignment_ThaiDistribued","13",zb.a.tka.toString(),Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed);c=[c,h,v,B,ma];h=5;if(l.AFrameworkApplication.lcid===vi.a.af("AR-SA").LCID||11===a)c[h]=X,h=6;if(l.AFrameworkApplication.lcid===vi.a.af("TH-TH").LCID||13===a)c[h]=Pa;return c}static kYj(){const a=jf.f("DdlSpecialIndent_None","0",zb.a.rZa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent),c=jf.f("DdlSpecialIndent_FirstLine","1",zb.a.rZa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent),
h=jf.f("DdlSpecialIndent_Hanging","2",zb.a.rZa.toString(),Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent);return jf.n("ParagraphDialogSpecialIndentSelect",zb.a.rZa,zb.a.r8b,Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,150,[a,c,h])}}lr.cGd=[zb.a.m1b,zb.a.aGd,zb.a.rZa,zb.a.OSd,zb.a.tka,zb.a.mEb,zb.a.YQc,zb.a.r8b,zb.a.rWd,zb.a.o8b,zb.a.Uac,zb.a.a3d,zb.a.e3d];Object(w.a)(lr,"ParagraphDialog",ki,[]);class GJ extends Gs{constructor(a,c){super(a,c,!0);this.W3a=null;this.nu&&this.oQ&&
(this.q6=!1,a=this.n9e(this.MA),a=this.Nwb(a,a),this.Tg(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,Object(m.a)(this,this.Omi,"reactCreateNewStyleDialogHandler"),a))}Omi(a,c){this.Od.jr&&(a?(a="string"===typeof c.styleText?c.styleText:null,(c=this.XXi(a))?(this.W3a=c,c=this.n9e(this.MA),a=this.Nwb(a,c),this.W3a=null,this.jT=!1,this.hide(),this.Tg(WordEditorIntl.WordEditorStrings.l_CreateNewStyle,Object(m.a)(this,this.Omi,"reactCreateNewStyleDialogHandler"),a),this.jT=!0):(this.hide(),c=new Map,
c.set("Source","ReactCreateNewStyleDialog"),c.set("Action","CreateStyle"),Fa.Health.instance.recordKpiUsage(Xf.a.Fjb,0,Xf.a.pF,c),this.Ptc(a,this.oQ)||(a=new Map,a.set("Source","ReactCreateNewStyleDialog"),a.set("Action","CreateStyle"),a=Object.assign(new fi.a,{extendedProperties:a}),Fa.Health.instance.recordKpiFailure(Xf.a.Fjb,"CreateStyleFailed",!1,!0,a)))):this.hide(),this.Od.BS())}Nwb(a,c){var h=this.oQ.ia(Ed.a.fontSize,fm.a.jI)>=2*Gs.hOd;const v=hu.a.J6e(this.oQ,"97%",Gs.hOd,!1,!0,h);v["padding-left"]=
Gs.QLi+"px";h||(v["line-height"]=Gs.PLi+"px");h={};h.styleNameLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogName;h.previewWindowLabel=WordEditorIntl.WordEditorStrings.l_CreateNewStyleDialogParagraphPreview;h.styleName=a;h.previewContainerText=c;h.getPreviewStyle=()=>v;this.W3a&&(h.errorMessage=this.W3a);return{["id"]:this.jf,["bodyControls"]:h}}}Object(w.a)(GJ,"ReactCreateNewStyleDialog",Gs,[]);class sB extends gg.a{constructor(a,c=!1,h){super(!1,!1,c);let v=c=this.lu=null;this.jf=
sB.id;this.Od=a.view;this.tl=h;this.Od&&(v=this.Od.Ma);v&&v.Ca&&v.Ca.Fa&&(c=v.Ca.Fa.sa);c?(a=c.node)?(this.nu=sB.Ag.Xs(a))||r.ULS.sendTraceTag(539762890,3029,10,"_pageContenNode is null"):r.ULS.sendTraceTag(539762889,3029,10,"node is null"):r.ULS.sendTraceTag(539762888,3029,10,"nodeContext is null")}ZTn(a){var c=RegExp("^(?!\\p{N})[\\p{L}\\p{N}\\p{Mc}\\p{Mn}_]{1,40}$","gu"),h=this.XQk();const v=""===F.a.Csa(a),B=a.length>sB.Xam;h=h.includes(a);c=c.test(a);a=a.startsWith("_");let X=null;if(v||B||h||
a||!c)X=v?WordEditorIntl.WordEditorStrings.l_BookmarkNameEmpty:B?WordEditorIntl.WordEditorStrings.l_BookmarkNameOverMaxLength:a?WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters:c?WordEditorIntl.WordEditorStrings.l_BookmarkNameAlreadyExists:WordEditorIntl.WordEditorStrings.l_BookmarkNameRestrictedCharacters;return X}lHl(a,c){return a?a===c:!1}static get Ag(){return jn.PageNavigator.instance}XQk(){const a=this.tl.yCc(!1);let c=[];for(let h=0;h<a.count;h++){let v=a.J(h).ia(Yb.a.Vr,
"");c.push(v)}return c}}sB.id="BookmarkEditDialog";sB.Xam=40;Object(w.a)(sB,"AEditBookmarkDialog",gg.a,[]);class HJ extends sB{constructor(a,c,h){super(a,!0,h);this.W3a=null;this.LPa="wwaengidc";this.Llc="ReactCreateEditBookmarkNameDialog";this.Brg="EditBookmarkName";this.u$c="EditBookmarkNameDialog";this.Wbe=c;this.tl=h;this.nu&&(this.q6=!1,a=this.Nwb(c.properties.ia(Yb.a.Vr,null)),this.Tg(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.Qmi.bind(this),a))}Qmi(a,c){if(this.Od.jr){if(a){a="string"===
typeof c.BookmarkText?c.BookmarkText:null;var h;this.Wbe.hasProperty(Yb.a.Vr)?h=this.Wbe.getValue(Yb.a.Vr):r.ULS.sendTraceTag(528880847,3029,10,"Bookmark name not found");c=this.ZTn(a);this.lHl(a,h)?(r.ULS.sendTraceTag(528880848,3029,50,"User did not update existing bookmark's name, dismissing edit bookmark dialog"),this.hide()):c?(this.W3a=c,h=this.Nwb(a),this.W3a=null,this.jT=!1,this.hide(),this.Tg(WordEditorIntl.WordEditorStrings.l_EditBookmark,this.Qmi.bind(this),h),this.jT=!0):(this.hide(),h=
new Map,h.set("Source",this.Llc),h.set("Action",this.Brg),Fa.Health.instance.recordKpiUsage(this.u$c,0,this.LPa,h),this.O2j(a)||(h=new Map,h.set("Source",this.Llc),h.set("Action",this.Brg),h=Object.assign(new fi.a,{extendedProperties:h}),Fa.Health.instance.recordKpiFailure(this.u$c,"Unable to edit bookmark",!1,!0,h)))}else this.hide();this.Od.BS()}}O2j(a){a=F.a.Csa(F.a.yX(a));try{const c=this.tl.tTi(this.Wbe,a);if(c)r.ULS.sendTraceTag(539762886,3029,50,"Updated bookmark name to name specified by user");
else return r.ULS.sendTraceTag(525111646,3029,10,"Error updating bookmark name to name specified by user"),c}catch(c){return r.ULS.sendTraceTag(539762887,3029,10,"Error updating bookmark name to name specified by user",c.Message),!1}}Nwb(a){const c={};c.bookmarkValue=a;c.errorMessage=this.W3a;c.bookmarkTextLabel=WordEditorIntl.WordEditorStrings.l_EditBookmarkDialogLabelName;return{["id"]:this.jf,["bodyControls"]:c}}}Object(w.a)(HJ,"ReactEditBookmarkNameDialog",sB,[]);const qF=(a,c)=>{const h=[];if(a.length!==
c.length)return h;for(let v=0;v<a.length;v++){const B={};B.key=c[v];B.text=a[v];B.type="AppComboBoxItem";h[v]=B}return h},Iz=(a,c,h,v,B)=>({["unitType"]:a,["unitPlaceholder"]:F.a.EDf(c),["minValue"]:h,["maxValue"]:v,["step"]:B}),NG=()=>({["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}),IJ=(a,c,h)=>{let v=!1;a.hasProperty(c)&&a.hasProperty(h)?(h=a.getValue(h),1===h?(a=Number.NaN,c=5,v=!0):
(a=a.getValue(c),c=2===h?4:5)):(a=Number.NaN,c=Eb.App.n4?4:5);return{Rac:a,g1a:c,N1b:v}};class tB{constructor(){this.S6=null}J$k(a){const c={};c.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"};var h=Iz("Point",5,0,1584,1),v=Iz("Line",4,0,327,1),B=[h,v];v=NG();var X=[Box4Intl.Box4Strings.L_SpinnerAuto];h=[""];({Rac:Pa,g1a:ma,N1b:mb}=IJ(a,Uc.a.aBa,Uc.a.$Aa));var ma={["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Of.a.lWb(ma),["validUnits"]:B,["numberFormatInfo"]:v,["validReservedValues"]:X};mb?ma.reservedValue=X[0]:ma.value=isNaN(Pa)?"":Pa;c.beforeSpacingSpinButtonProps=ma;({Rac:Pa,g1a:ma,N1b:mb}=IJ(a,Uc.a.ZAa,Uc.a.YAa));B={["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,
["unitType"]:Of.a.lWb(ma),["validUnits"]:B,["numberFormatInfo"]:v,["validReservedValues"]:X};mb?B.reservedValue=X[0]:B.value=isNaN(Pa)?"":Pa;c.afterSpacingSpinButtonProps=B;if(X=B=a.hasProperty(Uc.a.Zt))X=tB.WR.cJa(a),X=a.hasProperty(Uc.a.Zt)&&a.hasProperty(Uc.a.WX)&&2===a.getValue(Uc.a.WX)?!uf.a.KX(X,1)&&!uf.a.KX(X,1.5)&&!uf.a.KX(X,2):!1;if(B){var Pa=tB.WR.cJa(a);B=0;var mb=!1;a.hasProperty(Uc.a.Zt)&&a.hasProperty(Uc.a.WX)||(mb=!0);mb||(2!==a.getValue(Uc.a.WX)&&(mb=!0),B=Pa,1>B&&(mb=!0));mb?B="":
(Pa="multiple",X||(uf.a.KX(B,1)?Pa="1.00":uf.a.KX(B,1.5)?Pa="1.50":uf.a.KX(B,2)&&(Pa="2.00")),B=Pa)}else B=null;Pa={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,["options"]:qF([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,
Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["allowFreeForm"]:!1};B?Pa.selectedKey=B:Pa.defaultSelectedKey="";c.lineSpacingComboBoxProps=Pa;B=0;Pa=!1;a.hasProperty(Uc.a.Zt)&&a.hasProperty(Uc.a.WX)&&2===a.getValue(Uc.a.WX)&&X&&(B=tB.WR.cJa(a),Pa=!0,1>B&&(B=Number.NaN));a=[Iz("none",0,1,132,.5)];a={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,
["unitType"]:"none",["validUnits"]:a,["numberFormatInfo"]:v,["validReservedValues"]:h};Pa?a.value=B:a.reservedValue=h[0];c.atSpinButtonProps=a;return c}Bxb(){return this.S6||(this.S6=this.v9a())}v9a(){const a={};a[Uc.a.Zt.id.toString()]=gk.m_h;a[Uc.a.ZAa.id.toString()]=gk.vTd;a[Uc.a.YAa.id.toString()]=gk.vTd;a[Uc.a.aBa.id.toString()]=gk.wTd;a[Uc.a.$Aa.id.toString()]=gk.wTd;return a}static get WR(){return tB.Gx||(tB.Gx=xa.a.instance.resolve("Box4.ILineSpacingHelper"))}}tB.Gx=null;Object(w.a)(tB,"ReactParagraphDialog",
null,[]);class JJ extends gg.a{constructor(a,c,h,v,B,X=xa.a.instance.za("Box4.Settings.SpacingSettings")){var ma,Pa;super(!1,!1,!0);this.QM=this.JLg=null;X.execute(rc=>this.QM=rc);this.vT=a.clone();this.Be=a.clone();this.l7=c.clone();this.xT=h;this.ga=v;this.sAe=new tB;this.BE=B;a=this.sAe.J$k(this.Be);c=Iz("Inch",3,-11,22,.1);h=Iz("Inch",3,0,22,.1);X=Iz("Centimeter",1,-27.94,55.88,1);v=Iz("Centimeter",1,0,55.88,1);var mb=Iz("Character",2,-316.8,316.8,.5);B=Iz("Character",2,0,316.8,.5);c=[c,X,mb];
v=[h,v,B];h=NG();a.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,["forId"]:"GeneralGroup"};X=[Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified,Box4Intl.Box4Strings.l_ParagraphDialogAlignDistributed];mb=["1","2","3","6","7"];let Tb=5;B=this.Be.hasProperty(Uc.a.Dr)?this.Be.getValue(Uc.a.Dr):
0;if(10===B||9===B)B=11;if(l.AFrameworkApplication.lcid===vi.a.af("AR-SA").LCID||11===B)a.isKashidaSupported=!0,X[Tb]=Box4Intl.Box4Strings.l_ParagraphDialogAlignKashida,mb[Tb]="11",Tb=6;if(l.AFrameworkApplication.lcid===vi.a.af("TH-TH").LCID||13===B)a.isThaiSupported=!0,X[Tb]=Box4Intl.Box4Strings.l_ParagraphDialogAlignThaiDistributed,mb[Tb]="13";X={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,
["showLabel"]:!0,["options"]:qF(X,mb),["allowFreeForm"]:!1};LG(B)?X.selectedKey=B.toString():X.defaultSelectedKey="";a.alignmentComboBoxProps=X;(null===(ma=this.BE)||void 0===ma?0:ma.Adf)||(a.paginationLabelProps={["type"]:"AppLabelProps",["id"]:"PaginationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogPagination,["forId"]:"PaginationGroup"});this.BE.iYa&&(ma={["type"]:"AppCheckboxInternalProps",["id"]:"KeepWithNextCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogKeepWithNext,["checked"]:HP(this.Be)},
a.keepWithNextCheckboxProps=ma);this.BE.yjb&&(ma={["type"]:"AppCheckboxInternalProps",["id"]:"WidowOrphanCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogWidowOrphan,["checked"]:IP(this.Be)},a.widowOrphanCheckboxProps=ma);a.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};B=FP(this.Be);ma="0"===B;a.specialIndentationComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:qF([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["selectedKey"]:B,["allowFreeForm"]:!1};X=Eb.App.nAa;B=0;({Rac:B,g1a:X}=MG(this.Be,Uc.a.IY,Uc.a.l$,ma));ma={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",
["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Of.a.lWb(X),["validUnits"]:v,["numberFormatInfo"]:h};ma=this.nRf(B,ma);a.bySpinButtonProps=ma;v=Eb.App.nAa;ma=0;({Rac:ma,g1a:v}=MG(this.Be,Uc.a.H9,Uc.a.G9,!1));v={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,
["unitType"]:Of.a.lWb(v),["validUnits"]:c,["numberFormatInfo"]:h};v=this.nRf(ma,v);a.beforeTextSpinButtonProps=v;v=Eb.App.nAa;ma=0;({Rac:ma,g1a:v}=MG(this.Be,Uc.a.isa,Uc.a.hsa,!1));c={["type"]:"AppSpinButtonProps",["id"]:"AfterTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRight,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentRightAlt,["unitType"]:Of.a.lWb(v),["validUnits"]:c,["numberFormatInfo"]:h};c=this.nRf(ma,c);a.afterTextSpinButtonProps=c;c={["id"]:"ParagraphDialog",
["bodyControls"]:a};if(null===(Pa=this.QM)||void 0===Pa?0:Pa.ira)Pa={["type"]:"AppCheckboxInternalProps",["id"]:"ContextualSpacingCheckbox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogContextualSpacing,["checked"]:GP(this.Be)},a.contextualSpacingCheckboxProps=Pa;c.dialogButtonsOption=9;c.secondaryActionButtonProps={["id"]:"tabStopOptionsButton",["type"]:"AppButtonProps",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogTabStopOptions};c.styles={["root"]:{["#tabStopOptionsButton"]:{["float"]:"left",
["margin-left"]:"0"}}};this.Tg(Box4Intl.Box4Strings.l_ParagraphDialogTitle,Object(m.a)(this,this.BTd,"paragraphDialogResultHandler"),c)}Bbf(a){return this.JLg||(this.JLg=this.$Ue(a))}$Ue(a){var c,h,v;a[Uc.a.Dr.id.toString()]=gk.GYh;a[Uc.a.G9.id.toString()]=gk.sTd;a[Uc.a.H9.id.toString()]=gk.sTd;a[Uc.a.hsa.id.toString()]=gk.tTd;a[Uc.a.isa.id.toString()]=gk.tTd;a[Uc.a.kH.id.toString()]=gk.Sac;a[Uc.a.l$.id.toString()]=gk.Sac;a[Uc.a.IY.id.toString()]=gk.Sac;if(null===(c=this.QM)||void 0===c?0:c.ira)a[Uc.a.CPc.id.toString()]=
gk.jdk;if(null===(h=this.BE)||void 0===h?0:h.iYa)a[Vq.a.LO.id.toString()]=gk.pWl;if(null===(v=this.BE)||void 0===v?0:v.yjb)a[Vq.a.kOa.id.toString()]=gk.jWn;return a}ATd(){xa.a.instance.resolve("Box4.UI.IBox4DialogFactory").xWb(this.vT,this.l7,this.xT,this.BE)}BTd(a,c){var h,v,B;if(c&&(1===a||2===a)){if(c.alignmentComboBoxProps){var X=parseInt(c.alignmentComboBoxProps.selectedKey);isNaN(X)||LG(X)&&this.Be.setValue(Uc.a.Dr,X)}var ma=c.bySpinButtonProps;X=!!ma&&""!==ma.value;var Pa=c.didChangeSpecialIndentationComboBoxValue;
if(c.specialIndentationComboBoxProps){var mb=parseInt(c.specialIndentationComboBoxProps.selectedKey);1!==mb&&2!==mb&&mb||!(mb||Pa||X)||this.Be.setValue(Uc.a.kH,mb)}if(ma){mb=ma.value;ma=Of.a.Rtb(ma.unitType.toLowerCase());let Tb;0<=mb||(mb=0);2===ma?Tb=2:(Tb=1,mb=Of.a.Rib(mb,ma));if(X||Pa)this.Be.setValue(Uc.a.IY,mb),this.Be.setValue(Uc.a.l$,Tb)}c.beforeTextSpinButtonProps&&(Pa=c.beforeTextSpinButtonProps,X=Of.a.Rtb(Pa.unitType.toLowerCase()),Pa=""===Pa.value?Number.NaN:Pa.value,isNaN(Pa)||(mb=Pa,
2===X?ma=2:(ma=1,mb=Of.a.Rib(Pa,X)),this.Be.setValue(Uc.a.H9,mb),this.Be.setValue(Uc.a.G9,ma)));c.afterTextSpinButtonProps&&(Pa=c.afterTextSpinButtonProps,X=Of.a.Rtb(Pa.unitType.toLowerCase()),Pa=""===Pa.value?Number.NaN:Pa.value,isNaN(Pa)||(mb=Pa,2===X?ma=2:(ma=1,mb=Of.a.Rib(Pa,X)),this.Be.setValue(Uc.a.isa,mb),this.Be.setValue(Uc.a.hsa,ma)));c.beforeSpacingSpinButtonProps&&(X=c.beforeSpacingSpinButtonProps,Pa=Of.a.Rtb(X.unitType.toLowerCase()),mb=X.reservedValue,""!==X.value&&(mb===Box4Intl.Box4Strings.L_SpinnerAuto?
(Pa=1,X=0):(Pa=4===Pa?2:4,X=X.value),this.Be.setValue(Uc.a.aBa,X),this.Be.setValue(Uc.a.$Aa,Pa)));c.afterSpacingSpinButtonProps&&(X=c.afterSpacingSpinButtonProps,Pa=Of.a.Rtb(X.unitType.toLowerCase()),mb=X.reservedValue,""!==X.value&&(mb===Box4Intl.Box4Strings.L_SpinnerAuto?(Pa=1,X=0):(Pa=4===Pa?2:4,X=X.value),this.Be.setValue(Uc.a.ZAa,X),this.Be.setValue(Uc.a.YAa,Pa)));if(c.atSpinButtonProps||c.lineSpacingComboBoxProps)if(X=c.atSpinButtonProps.value,1<X)this.Be.setValue(Uc.a.Zt,X),this.Be.setValue(Uc.a.WX,
2);else if(X=c.lineSpacingComboBoxProps.selectedKey)X="1.00"===X?1:"1.50"===X?1.5:"2.00"===X?2:0,X=1<=X?X:1,this.Be.setValue(Uc.a.Zt,X),this.Be.setValue(Uc.a.WX,2);(null===(h=this.QM)||void 0===h?0:h.ira)&&c.contextualSpacingCheckboxProps&&this.Be.setValue(Uc.a.CPc,c.contextualSpacingCheckboxProps.checked);(null===(v=this.BE)||void 0===v?0:v.iYa)&&c.keepWithNextCheckboxProps&&this.Be.setValue(Vq.a.LO,c.keepWithNextCheckboxProps.checked);(null===(B=this.BE)||void 0===B?0:B.yjb)&&c.widowOrphanCheckboxProps&&
this.Be.setValue(Vq.a.kOa,c.widowOrphanCheckboxProps.checked);pF(this.vT,this.vT);pF(this.Be,this.vT);c="";FJ(this.l7,this.Be)?mE(this.vT,this.Be,this.Bbf(this.sAe?this.sAe.v9a():{})):c=""!==c?c:Box4Intl.Box4Strings.l_ParaIndentSetFailedMessage;this.dispose();""!==c?this.VBa(c,Object(m.a)(this,this.ATd,"paragraphDialogCreator")):2===a&&(re.c(ba.a.vac,!0,"Custom Tab Stop Dialog was opened via Paragraph Dialog"),this.ga.hb(ba.a.vac,2,null))}}nRf(a,c){c.value=isNaN(a)?"":a;return c}}Object(w.a)(JJ,"WordReactParagraphDialog",
gg.a,[]);class KJ{dgk(a){new dD(a,xa.a.instance.resolve("Box4.IFeatureHelper"))}Qjk(a,c){l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.fA?new GJ(a,c):new uJ(a,c)}Uyk(a,c,h){new HJ(a,c,h)}y9g(a,c,h){new yu(a,c,h,xa.a.instance.resolve("WordEditor.IPageCommands"),xa.a.instance.resolve("Common.IStandaloneRootController").w5)}$9g(a,c,h){new Xq(a,c,h,xa.a.instance.resolve("WordEditor.IPageCommands"),xa.a.instance.resolve("Common.IStandaloneRootController").w5)}xfk(a){return new lC(a)}xWb(a,
c,h,v){l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.fA&&l.AFrameworkApplication.K.$("ReactParagraphDialogIsEnabled")?new JJ(a,c,h,l.AFrameworkApplication.pa,v):new lr(a,c,h,xa.a.instance.resolve("Box4.IIndentationCommands"),xa.a.instance.resolve("Box4.IJustificationCommands"),xa.a.instance.resolve("Box4.ISpacingCommands"),xa.a.instance.te("Box4.IFeatureHelper"),l.AFrameworkApplication.K,xa.a.instance.resolve("Box4.IParagraphIndentationReader"),xa.a.instance.resolve("Common.IStandaloneRootController").w5,
v)}Irk(){const a=xa.a.instance.ra("Box4.IRoamingServiceRequestManager");null==a?Sd.b(524834398,3018,10,"Roaming service not resolved."):new vJ(a)}Lrk(a,c){new wJ(a,c)}dXe(a){return new xJ(a)}}Object(w.a)(KJ,"DialogFactory",null,[528,529]);class nE extends gg.a{constructor(a,c){super(!1,!1,!0);this.Leh="DoNotCheckSpellingCheckbox";this.$eh="DocumentChoiceGroup";this.Y3c=0;this.XYh="LanguageList";this.documentContext="DocumentContext";this.Rp="RangeContext";this.Erg=c;this.x$c=a}tTf(){var a=Array(2);
a[0]={["key"]:this.Rp,["text"]:WordEditorIntl.WordEditorStrings.l_SelectedText};a[1]={["key"]:this.documentContext,["text"]:WordEditorIntl.WordEditorStrings.l_CurrentDocument};const c={showDocumentChoiceGroup:!0};c.markSelectedText=Box4Intl.Box4Strings.l_MarkSelectedText;c.documentChoiceGroupProps={["id"]:this.$eh,["defaultSelectedKey"]:this.DYk(),["label"]:WordEditorIntl.WordEditorStrings.l_ChangeProofingLanguage,["options"]:a};this.Y3c=({DHm:this.eeg}=this.x$c.Uel(this.eeg)).returnValue;c.languageListPropsProvider=
this.Q4k();c.spellingCheckboxProps={["id"]:this.Leh,["checked"]:!this.eeg,["label"]:WordEditorIntl.WordEditorStrings.l_DoNotCheckSpellingOrGrammar};a={["id"]:"LanguageDialog",["bodyControls"]:c};this.Tg(Box4Intl.Box4Strings.l_Language,Object(m.a)(this,this.Efn,"setLanguageHandler"),a)}DYk(){return this.x$c.ke()?this.documentContext:this.Rp}Q4k(){return()=>{let a,c;const h=({selectedIndex:a,kKi:c}=this.Erg.P4k(this.Y3c,a,c)).returnValue;for(let v=0;v<h.length&&v<c;v++)h[v].value=nE.O6f+h[v].value;
return{["id"]:this.XYh,["items"]:h,["selectedLanguageIndex"]:a,["applyBorderIndex"]:c}}}Efn(a,c){if(kg.a.instance.J(9)){var h=Ee.a.instance.Tm(zb.a.WBi);if(1!==a)h.properties.Z("canceled","true");else{a=c[this.XYh].replace(nE.O6f,"");var v=parseInt(a),B=Boolean.parse(c[this.Leh]);c=c[this.$eh];c===this.documentContext?this.x$c.rdn(v,B):this.x$c.Din(v,B);h.properties.Z("PreviousLCID",this.Y3c.toString());h.properties.Z("ChangedLCID",v.toString());h.properties.Z("NoProof",B.toString());this.Erg.Cfn(v,
this.Y3c);re.d(zb.a.WBi,!0,void 0,void 0,void 0,void 0,[Object.assign(new aa.a,{name:"SelectedLcid",string:a}),Object.assign(new aa.a,{name:"NoProof",string:B.toString()}),Object.assign(new aa.a,{name:"Context",string:c})]);Eb.App.oa.updateCommandUI(!0)}h.end()}}}nE.O6f="recent-";Object(w.a)(nE,"ReactLanguageDialog",gg.a,[527]);class LJ extends jE{constructor(a,c,h,v){super(c,h);this.xg=a;this.MB=v}d9a(a,c,h){if(a=super.d9a(a,c,h))a.U7b=!0,a.XUd=!0,a.preventDismissOnScroll=!0;this.xg.RSa(Object(m.a)(this,
this.NDf,"pollForStateAndUpdateFloatie"));return a}tHc(a,c,h=null){this.MB.ZVg(()=>this.d9a(a,c,h))}VQd(){this.floatie.U7b=!0}NDf(){this.floatie.yk()}}Object(w.a)(LJ,"ExternalContentFloatieInitializer",jE,[]);class MJ{DDb(){rm.instance.Eja&&(Tt.instance.p1a([1,0]),rm.instance.NKd()&&Ut.instance.p1a([1]))}}Object(w.a)(MJ,"RulerUser",null,[314]);class NJ{constructor(){this.whitelistedControlIds=null}}Object(w.a)(NJ,"StatusBarProps",null,[]);class oE{constructor(a,c){this.bed=!1;this.Cxe=null;this.aba=
c.xE;this.PBe=c.dLi;ck.a.get_instance().Vk(7,()=>{window.setTimeout(()=>{Fo.a.instance.$c(()=>{Hi.UISurfaces.Hgl().then(h=>{const v=Object.assign(new NJ,{whitelistedControlIds:c.whitelistedControlIds});h.initializeNewStatusBar(a,v,this.PBe);this.Cxe=h;this.bed=!0;window.setTimeout(()=>{Fo.a.instance.$c(()=>{const B=[];if(c.vE){const X=c.vE;for(let ma in X)B.push(appChrome.actions.updateControlHiddenState(ma,X[ma]));appChrome.api.dispatch(B)}this.DDb()},"RSB:I2")},0);return null}).catch(()=>{r.ULS.sendTraceTag(51656736,
324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(c.zla&&a){oE.jlg||(l.AFrameworkApplication.pa.ka(Sa.a.fLi,Kc.a.frame,Object(m.a)(this,this.gLi,"statusBarTabAction")),l.AFrameworkApplication.pa.ka(Sa.a.eLi,Kc.a.frame,Object(m.a)(this,this.gLi,"statusBarTabAction")),oE.jlg=!0);const h=qk.a.Fff(c.zla,c.hBi,a,!1);h.rK=!0;this.F8b(h,Sa.a.fLi,Sa.a.eLi)}},0)})}DDb(){this.bed&&this.aba&&window.setTimeout(()=>{this.aba(this.Cxe.selectors.getStatusBarControlsMap(this.PBe),7)},0)}Ugb(a,
c){this.bed&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(a,c))},0)}JM(a){this.bed&&this.aba&&window.setTimeout(()=>{const c=this.Cxe.selectors.getStatusBarControlsMap(this.PBe);if(c[a]){const h={};h[a]=c[a];this.aba(h,7)}},0)}F8b(a,c,h){const v=qc.KeyInputManager.mb(vb.a.Sv,0),B=qc.KeyInputManager.mb(vb.a.Sv,4);a.Bp(v);a.Bp(B);a.bindAction(v,c);a.bindAction(B,h)}gLi(){return 4}}oE.jlg=!1;Object(w.a)(oE,"ReactStatusBar",null,[]);class OJ{constructor(){this.whitelistedControlIds=
this.vE=this.xE=null;this.bVl=!1;this.hBi=this.zla=this.dLi=null}}Object(w.a)(OJ,"ReactStatusBarInitOptions",null,[]);var uB=b(355);class PJ{constructor(a,c,h,v,B){this.mQb=this.MFa=this.qa=null;this.Erl=(X,ma,Pa,mb,Tb)=>{if(!Tb)return r.ULS.sendTraceTag(572135558,306,10,String.format("{0}","actionData is null for visibility toggle")),8;if(1===Pa)return 32;Tb&&2===Tb.length&&this.MFa&&this.MFa.Ugb(Tb[0],Tb[0]);return 32};this.ga=v;Fo.a.instance.$c(()=>{this.qa=B;this.mQb=this.MFa=null;let X={};l.AFrameworkApplication.uIi||
(X[uB.a.Q5m]=!0);X.GiveFeedback=!l.AFrameworkApplication.pE;this.qa.$("OfficeOnlineInGallatinTextVisible")||(X.CenterStatusLabel=!0);X[uB.a.vfi]=!0;this.qa.$("WPMPackageIsEnabled")&&this.qa.$("WPMStatusBarLabelIsEnabled")||(X[uB.a.c3f]=!0);this.qa.$("AddInCommandsIsEnabled")||(X[uB.a.RDj]=!0);this.qa.$("WordEditorShowOcsConnectionStatus")||(X[uB.a.Swf]=!0);X[uB.a.MWn]=!0;this.qa.$("ReadingTimeIsEnabled")||(X[uB.a.ani]=!0);this.qa.$("EditorGoalsEnabled")&&(X[uB.a.uud]=!0);window.setTimeout(()=>{this.qBl(a,
X)},0)},"SBU:I")}eb(){this.ga.Aa(zb.a.u3d,ic.a.application,this.Erl,96)}qBl(a,c){this.mQb=xa.a.instance.ra("WordEditor.WordEditorReactCommandDefinitionMapping");const h={};for(let B in c){var v=c[B];h[this.p$e(B)]=v}this.MFa=new oE(a,Object.assign(new OJ,{vE:h,xE:Object(m.a)(this,this.PZc,"updateStatusBarControls"),bVl:!1,dLi:"WordEditorStatusBar",zla:If.AppFrame.zla,hBi:Object(m.a)(this,this.txn,"statusBarScopeSetFocus")}))}txn(){const a=Eb.App.oa.Pn.getRegion(If.AppFrame.zla);a&&a.ROd()}PZc(a){Eb.App.oa.xE(a)}p$e(a){let c=
"";if(this.mQb){const h=this.mQb.r7e(a);h&&0<h.count&&(c=h.J(0))}return c&&""!==c?c:a}DDb(){this.MFa&&this.MFa.DDb()}Ugb(a,c){this.MFa&&this.MFa.Ugb(this.p$e(a),c)}JM(a){this.MFa&&this.MFa.JM(this.p$e(a))}dispose(){}}Object(w.a)(PJ,"StatusBarUser",null,[313,14]);var QJ=b(1430);class OG{constructor(a){this.ga=a;this.ga.ka(Sa.a.uTc,Kc.a.frame,Object(m.a)(this,this.uTc,"reportFileMenuPageSwitch"));this.ga.ka(Sa.a.iti,Kc.a.frame,Le.ActionManager.De)}uTc(a,c,h,v,B){this.ga.processAction(this.a0k(B[QJ.a.pageId]),
2);return 32}}Object(w.a)(OG,"FileMenuSQMInformation",null,[888]);class RJ extends OG{constructor(a){super(a);this.IRm()}IRm(){this.ga.ka(Sa.a.wLf,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.cti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.xLf,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.dti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.eti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.yLf,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.fti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.gti,
Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.hti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.Kti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.Lti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.nti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.oti,Kc.a.frame,Le.ActionManager.De)}a0k(a){switch(a){case "menuJewelAbout":case "FileAboutPage":return Sa.a.wLf;case "tabHome":case "FileHomePage":return Sa.a.cti;case "menuJewelInfo":case "FileInfoPage":return Sa.a.xLf;case "menuJewelNew":case "FileNewPage":return Sa.a.dti;
case "menuJewelOpen":case "FileOpenPage":return Sa.a.eti;case "menuJewelPrint":case "FilePrintPage":return Sa.a.yLf;case "menuJewelSaveAs":case "FileSaveAsPage":return Sa.a.fti;case "menuJewelShare":case "FileSharePage":return Sa.a.gti;case "menuJewelTransform":case "FileTransformPage":return Sa.a.hti}return Sa.a.iti}}Object(w.a)(RJ,"WordEditorFileMenuSQMInformation",OG,[]);var SJ=b(1427);class PG{constructor(a){this.ga=a;this.ga.ka(Sa.a.vTc,Kc.a.frame,Object(m.a)(this,this.vTc,"reportTabSwitch"));
this.ga.ka(Sa.a.Fti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.Hti,Kc.a.frame,Le.ActionManager.De)}vTc(a,c,h,v,B){this.ga.processAction(this.Idl(B[SJ.a.tHb]),2);return 32}}Object(w.a)(PG,"RibbonSQMInformation",null,[843]);class TJ extends PG{constructor(a){super(a);this.QTm()}QTm(){this.ga.ka(Sa.a.xti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.yti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(ba.a.ALf,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.zti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.Ati,
Kc.a.frame,Le.ActionManager.De);this.ga.ka(ba.a.Bti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(ba.a.Cti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(ba.a.Dti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(ba.a.Eti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(ba.a.BLf,Kc.a.frame,Le.ActionManager.De);this.ga.ka(ba.a.Gti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(Sa.a.Iti,Kc.a.frame,Le.ActionManager.De);this.ga.ka(ba.a.Jti,Kc.a.frame,Le.ActionManager.De)}Idl(a){switch(a){case "tabAddins":case "Addins":return Sa.a.xti;
case "tabHome":case "Home":return Sa.a.zti;case "tabInsert":case "Insert":return Sa.a.Ati;case "tabDeveloper":case "Developer":return Sa.a.yti;case "tabPageLayout":case "Layout":return ba.a.Bti;case "tabReferences":case "References":return ba.a.Eti;case "tabReview":case "Review":return ba.a.BLf;case "tabView":case "View":return Sa.a.Iti;case "Table":case "TableLayout":case "ContextualTabs.Tables.Design":case "ContextualTabs.Tables.Layout":return ba.a.Gti;case "tabMailings":case "Mailings":return ba.a.Cti;
case "tabWordDesign":case "Design":return ba.a.Jti;case "tabHelp":case "Help":return ba.a.ALf;case "ctabPictureTools":case "Picture":return ba.a.Dti}return Sa.a.Hti}}Object(w.a)(TJ,"WordEditorRibbonSQMInformation",PG,[]);class UJ{constructor(a=null,c=null,h=null){this.vE=a||{};this.EQi=c||[];this.GQi=h||{}}}Object(w.a)(UJ,"RibbonTrimmingProperties",null,[]);class VJ{constructor(a,c,h){this.Cpa=a;this.vE=c;this.cnf=h}}Object(w.a)(VJ,"ReactRibbonJewelProperties",null,[]);class WJ{constructor(){l.AFrameworkApplication.pa.ka(Sa.a.QKa,
Kc.a.frame,Object(m.a)(this,this.AMm,"reactFileMenuOpenFromTellMe"))}AMm(a,c,h,v,B){if(1===h||!B)return 32;a=B.SourceControlId;17!==B.UILocation||"New"!==a&&"Open"!==a||(B=[],yh.d("setFileMenuSelectedPage")&&("New"===a&&l.AFrameworkApplication.na?2===l.AFrameworkApplication.na.Ya.Rm?B.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):B.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===a&&l.AFrameworkApplication.na&&(2===l.AFrameworkApplication.na.Ya.Rm?B.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):
B.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),B.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(B));return 32}GZh(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}nMa(){return!1}$hi(){}weh(){}}Object(w.a)(WJ,"ReactFileMenu",null,[389]);class XJ{LTe(){const a=new WJ,c=[];c.push(appChrome.actions.updateFileMenuExpandedValue(!1));c.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(c);return a}}
Object(w.a)(XJ,"ReactFileMenuFactory",null,[360]);class eD{constructor(a,c,h,v=!1){this.$Hb=a;this.fpg=this.$Hb.BXa;this.fQd=xa.a.instance.ra("Common.IOfficeTrialExperience");this.NBb=xa.a.instance.ra("Common.IMacOfficeOffer");eD.Ece=!1;this.KPl=v;this.ga=c;this.fb=h}get Eb(){return this.ga}get wf(){return this.fb}WKe(){return this.fpg&&!!this.fQd&&!!this.NBb}iOa(a,c){this.$Hb.Io(()=>{r.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready");this.fpg=!0;this.J0e(a,c)});xa.a.instance.za("Common.IOfficeTrialExperience").execute(h=>
{r.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready");this.fQd=h;this.J0e(a,c)});xa.a.instance.za("Common.IMacOfficeOffer").execute(h=>{r.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready");this.NBb=h;this.J0e(a,c)})}J0e(a,c){eD.Ece||(this.WKe()?(r.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),a(this,c),eD.Ece=!0):r.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))}}eD.Ece=!1;Object(w.a)(eD,"RibbonDependencies",
null,[256]);class QG{constructor(a,c,h){this.omb=a;this.ga=c;this.fb=h}}Object(w.a)(QG,"WoncaRibbonUserFactory",null,[116]);class YJ{constructor(a,c){this.Xde=a;this.OSb=c}ohb(a){this.Xde.ohb(a);this.OSb&&this.OSb.ohb(a)}lVc(a){this.Xde.lVc(a);this.OSb&&this.OSb.lVc(a)}RZc(a){this.Xde.RZc(a);this.OSb&&this.OSb.RZc(a)}}Object(w.a)(YJ,"RibbonCommandTrimmer",null,[113]);var JP=b(1086);class ZJ{constructor(a,c){this.qa=a;this.DQb=c}ohb(a){H.a.sh&&6>H.a.OWa&&(a.fseaInsertPicture=!0);this.qa.$("InsertSymbolIsEnabled")||
(a.grpInsertSymbols=!0);this.qa.$("ClipartInsertEnabled")||(a.fseaInsertClipart=!0);this.qa.$("UIDiscoverabilityEnabled")||(a.jbtnAccessibilityHelp=!0);cE.a.BUh()||(a.InsertLoopComponentsForConsumers=!0);const c=this.qa.$("InsertOnlinePictureEnabled"),h=l.AFrameworkApplication.Ijf();c||(a.fseaInsertOnlinePicture=!0,a.fseaFlyInsertOnlinePictureFromSearch=!0);h?a.fseaInsertPictureFromOneDrive=!0:(a.fseaFlyInsertOnlinePictureFromHost=!0,a.fseaInsertOnlinePictureFromHost=!0);h&&c?(a.fseaInsertOnlinePicture=
!0,a.fseaInsertOnlinePictureFromHost=!0):a.flyOnlinePicture=!0;l.AFrameworkApplication.Jjf()||(a.InsertPictureFromMobileDevice=!0,a.ChangePictureFromMobileDevice=!0);l.AFrameworkApplication.$5d&&(a.btnOpenInClient=!0)}lVc(a){a.menuJewel=!0;l.AFrameworkApplication.pE||(a.jbtnGiveFeedback=!0)}RZc(a){delete a.menuJewel;l.AFrameworkApplication.Pfb||(a.jbtnPrivacy=!0);l.AFrameworkApplication.rTc||(a.jbtnReportAbuse=!0);l.AFrameworkApplication.T4d||(a.jbtnTermsOfUse=!0);l.AFrameworkApplication.xwd||(a.jbtnFileSharing=
!0);kg.a.instance.J(4)&&l.AFrameworkApplication.qgb||(a.jbtnShareRWC=!0);l.AFrameworkApplication.L1e||l.AFrameworkApplication.e1f||(a.jbtnVersion=!0);this.DQb.fQd&&this.DQb.fQd.rjm||(a.btnjTryOffice=!0,a.btnjTryOfficeForWordEditor=!0);this.DQb.NBb&&this.DQb.NBb.Nnn||(a.btnjTryMacOffice=!0,a.btnjTryMacOfficeForWordEditor=!0);l.AFrameworkApplication.$5d?(a.btnjOpenInClient=!0,a.btnjEditInClient=!0):a[Eb.App.Wr?"btnjOpenInClient":"btnjEditInClient"]=!0;l.AFrameworkApplication.KGn&&(a.jbtnDownloadACopy=
!0,a.jbtnDownloadAsPdf=!0,a.jbtnDownloadAsOdt=!0);if(l.AFrameworkApplication.protectFile||H.a.AKa||!l.AFrameworkApplication.xGc&&!l.AFrameworkApplication.C1e&&!l.AFrameworkApplication.c1f)a.jbtnFileEmbed=!0;JP.a.ayl()||(a.btnjClose=!0);l.AFrameworkApplication.y3b?(a.jbtnVersion=!0,r.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):l.AFrameworkApplication.Omf()||(a.btnjVersionHistory=!0);a.jbtnVersion&&a.btnjVersionHistory&&a.btnjOpenInClient&&
a.btnjEditInClient&&(a.faInfo=!0);l.AFrameworkApplication.XHf||(a.faOpen=!0);a.jbtnFileSharing&&a.jbtnFileEmbed&&a.jbtnShareRWC&&(a.faShare=!0);a.AboutInformationMenuSectionDiagnostics=!this.qa.$("DiagnosticsInfoInJewelAboutMenuIsEnabled");a.btnjTryOffice&&a.btnjTryMacOffice&&a.jbtnTermsOfUse&&a.jbtnPrivacy&&a.AboutInformationMenuSectionDiagnostics&&(a.faAbout=!0);a.jbtnHelp&&a.jbtnGiveFeedback&&a.jbtnReportAbuse&&(a.faHelp=!0);a.btnjClose&&(a.msJewelSecondary=!0);const c=!!l.AFrameworkApplication.na&&
l.AFrameworkApplication.na.Ya.JVh;if(a.faOpen&&a.faNew||!c)a.faHome=!0}}Object(w.a)(ZJ,"WoncaCommandTrimmer",null,[113]);var KP=b(992);b(657);var LP=b(1429),MP=b(1597);class $J{constructor(a,c){this.EZ=this.IH=null;this._clientId=a;this.V6=c}JCk(){if(!De.c(this.EZ))return this.EZ;this.W_e();this.EZ.style.display="block";this.V6&&this.V6.r_(Object(m.a)(this,this.onResize,"onResize"));return this.EZ}onResize(){this.$ka()}$ka(){this.B_e()?(document.getElementById("application").style.minWidth="0px",
(new MP.a(this.EZ,null,l.AFrameworkApplication.isRtl)).L7m(this.EZ)):l.AFrameworkApplication.na.Ya.WG||LP.a.M7m(this.EZ,l.AFrameworkApplication.isRtl)}B_e(){return l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("EnhancedMobileViewIsEnabled"):!1}W_e(){if(De.c(this.IH)){var a;({D0b:a}=qk.a.Fcc(!l.AFrameworkApplication.BR)).returnValue&&(this.IH=eF.a("div"),this.IH.className=qk.a.XEk,this.IH.id=bk.CuiHelper.Uvd,a.appendChild(this.IH),this.O_e(),l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.r4&&
!l.AFrameworkApplication.BR&&this.P_e(),this.ICk())}}ICk(){De.c(this.EZ)&&(this.EZ=eF.a("div"),this.EZ.className=qk.a.HYf,this.EZ.style.display="none",this.IH.appendChild(this.EZ))}O_e(){Sys.UI.DomElement.addCssClass(this.IH,qk.a.YEk);l.AFrameworkApplication.isRtl&&eF.b(this.IH,"cui-rtl")}P_e(){Sys.UI.DomElement.addCssClass(this.IH,"FlexBoxLayout")}}Object(w.a)($J,"HeaderSkeleton",null,[]);var fD=b(584);class RG{constructor(){this.yec=null}CIn(){this.yec||(this.yec=xa.a.instance.ra("Common.App.AccountSwitching.IAccountSwitching"))||
r.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}fQk(){this.CIn();return this.yec?this.yec.getCustomAuthConfig():null}static YIl(){return l.AFrameworkApplication.K.$("UiHostSupportsCustomAuthConfig")}}Object(w.a)(RG,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class SG{constructor(){this.m4b=this.cultureName=null}}Object(w.a)(SG,"HeaderCultureInfo",null,[]);var rF=b(1447);class aK{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=null}}
Object(w.a)(aK,"SearchInitializationSettings",null,[]);var gD=b(270);class bK{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(w.a)(bK,"DocumentTitleAppProps",null,[]);class cK{constructor(){this.documentExtension=
this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(w.a)(cK,"DocumentTitleCalloutAppProps",null,[]);class dK{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showMeControl=
this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=this.showRibbonToggle=
this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(w.a)(dK,"HeaderAppProps",null,[]);class eK{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(w.a)(eK,"HeaderControls",null,[]);class fK{constructor(){this.command=this.label=null}}Object(w.a)(fK,"WorkflowButtonAppProps",null,[]);var sF;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.insufficientPermission=2]="insufficientPermission";
a[a.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";a[a.editorsPresent=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(sF||(sF={}));Object(w.b)("RenameDisableReason",sF);class gK{constructor(a=""){this.$Nf=this.documentTitleAppProps=this.a3f=null;this.awj=""!==a?a:Ki.a.B5}Icl(a){const c=xa.a.instance.ra("Common.IExternalUICommandDefinitionMapping").rab(a);if(c&&0<c.length)return c[0].externalUxCommand;r.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",
a));return null}Dbf(){if(!this.a3f){const a=fD.a();if(a){const c=this.Icl(a.command);c&&(this.a3f=Object.assign(new fK,{command:c,label:a.label}))}}return this.a3f}UWk(){return Object.assign(new eK,{workflowButton:this.Dbf()})}hnm(){ck.a.get_instance().iH(17)}onMove(){const a={};a.MoveButtonClickedTime=new Date;l.AFrameworkApplication.pa.hb(Sa.a.eCb,2,a)}cdl(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;
case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}tZk(){let a=null,c=null;var h=xa.a.instance.ra("Common.IRenameProps");h?(h=h.EBh(),0!==h&&(a=this.cdl(h),c=sF[h])):r.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new cK,{breadcrumbBrandName:l.AFrameworkApplication.Yr.breadcrumbBrandName,breadcrumbBrandUrl:l.AFrameworkApplication.Yr.breadcrumbBrandUrl,breadcrumbFolderName:l.AFrameworkApplication.Yr.breadcrumbFolderName,breadcrumbFolderUrl:l.AFrameworkApplication.Yr.breadcrumbFolderUrl,
hideDocumentTitleInput:l.AFrameworkApplication.na.Ya.Dul,isVersionHistoryEnabled:this.$on(),documentExtension:F.a.WIa(l.AFrameworkApplication.fileName),isMoveEnabled:32===l.AFrameworkApplication.pa.processAction(Sa.a.eCb,1),onMove:Object(m.a)(this,this.onMove,"onMove"),message:a,renameDisableReason:c,openBreadcrumbsInNewTab:l.AFrameworkApplication.K.$("OpenLinksInNewWindow")})}Rth(){if(!this.documentTitleAppProps){const a=l.AFrameworkApplication.Yr.Ry;this.documentTitleAppProps=Object.assign(new bK,
{documentTitle:l.AFrameworkApplication.$zc?a:F.a.rI(a),onFirstRender:Object(m.a)(this,this.hnm,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(m.a)(this,this.tZk,"getDocumentFlyoutProperties"),isShared:!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabUpdateSharingStatusReduxAction",!1)&&2===l.AFrameworkApplication.Yr.NRf})}return this.documentTitleAppProps}$on(){return!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.DWh}Umn(){return!!l.AFrameworkApplication.na&&
l.AFrameworkApplication.na.Ya.CWh}Gon(){const a=!fD.b()&&!l.AFrameworkApplication.hideHeader&&!l.AFrameworkApplication.wdf&&(l.AFrameworkApplication.K.$("SkypeWebControlIsEnabled")||l.AFrameworkApplication.K.$("TeamsChatIsEnabled"));r.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",a);return a}mdk(a){appChrome.getHeaderApi().then(c=>{c.setNavBarData(a.result);return null});r.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}XQm(a=!1){appChrome.getHeaderApi().then(c=>
{const h=xa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");c.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});c.setHeaderCommandHandler("OnFullyLoaded",()=>{this.onFullyLoaded()});c.setHeaderCommandHandler("OnFlexPaneOpen",v=>{h.onFlexPaneOpen(v)});c.setHeaderCommandHandler("OnFlexPaneClose",v=>{h.onFlexPaneClose(v)});c.setHeaderCommandHandler("SetCookie",v=>cb.a.set(v.cookieName,v.value));c.setHeaderCommandHandler("GetCookie",v=>this.WWk(v));c.setHeaderCommandHandler("QueryWorkflowButtonSettings",
Object(m.a)(this,this.Dbf,"getWorkflowButtonAppProps"));a||(c.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(m.a)(this,this.Rth,"getDocumentTitleAppProps")),c.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.inm();return null}));rF.a.ZJd()&&c.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(m.a)(this,this.lCh,"getSearchInitializationSettings"))})}inm(){xa.a.instance.za("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>{a.ijb(!1,l.AFrameworkApplication.pa.mode)})}WWk(a){a=
cb.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}shl(){return gD.AppChromeOverrideUtilities.isEnabled?gD.AppChromeOverrideUtilities.pBd("suiteux-shell",!1):this.awj+l.AFrameworkApplication.nea+"suiteux-shell"}onFirstRender(){xa.a.instance.za("Common.App.O365Shell.IO365ShellActor").execute(a=>{a.Tln.continueWith(Object(m.a)(this,this.mdk,"continueShellServiceDataAsync"),3)});ck.a.get_instance().iH(15)}onFullyLoaded(){ck.a.get_instance().iH(16)}Kya(a=!1){a:{try{var c=
vi.a.af(l.AFrameworkApplication.lcid);if(c){var h=Object.assign(new SG,{cultureName:c.name,m4b:c.m4b});break a}}catch(v){r.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+l.AFrameworkApplication.lcid.toString())}h=Object.assign(new SG,{cultureName:"en-us",m4b:"en"})}c=xa.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");h=Object.assign(new dK,{appName:CommonUIStrings.l_AppNameShort,culture:h.cultureName,language:h.m4b,isConsumer:!l.AFrameworkApplication.h1f,
showAppLauncher:fD.g(),showMeControl:fD.f(),hideUserName:l.AFrameworkApplication.hFd,defaultDocumentTitleToLeft:l.AFrameworkApplication.ubh,assetsContainerOverride:this.shl(),controls:this.UWk(),documentTitleAppProps:a?null:this.Rth(),showDocumentTitleControl:!a,showWorkflowButton:!!this.Dbf(),showChatControl:this.Gon(),showGoPremiumControl:fD.h(),enableSearchControl:rF.a.IRl(),onFlexPaneOpen:Object(m.a)(c,c.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(m.a)(c,c.onFlexPaneClose,"onFlexPaneClose"),
enableTheming:this.Umn(),testTraffic:l.AFrameworkApplication.K.$("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(m.a)(this,this.onFirstRender,"onFirstRender"),onFullyLoaded:Object(m.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:fD.d()});!l.AFrameworkApplication.m_c||l.AFrameworkApplication.YTf?(h.userDisplayName=l.AFrameworkApplication.userName,h.emailAddress=l.AFrameworkApplication.K.Ga("UserPrincipalName"),h.userID=l.AFrameworkApplication.K.Ga("Puid")||"",h.signOutLink=
l.AFrameworkApplication.YTf):l.AFrameworkApplication.signInUrl&&(h.signInLink=l.AFrameworkApplication.signInUrl);rF.a.ZJd()&&(c=this.lCh(),h.loadTellMeResources=c.loadTellMeResources,h.getTokenRequestDictionary=c.getTokenRequestDictionary,h.enableVanillaSearchBox=l.AFrameworkApplication.K.$("VanillaSearchUxInHeaderIsEnabled"),h.userRing=c.userRing);RG.YIl()&&(c=new RG,h.shellAuthProviderConfigPromise=Object(m.a)(c,c.fQk,"getAccountSwitchingConfig"));this.XQm(a);return h}lCh(){if(!this.$Nf){const a=
new rF.a;let c=l.AFrameworkApplication.K.Ga("Microsoft365Ring");c&&c.length||(c="generalAudience");this.$Nf=Object.assign(new aK,{loadTellMeResources:a.N_l(),getTokenRequestDictionary:Object(m.a)(a,a.njl,"getTokenRequestDict"),userRing:c})}return this.$Nf}}Object(w.a)(gK,"ReactSharedHeaderPropsHelper",null,[1008]);class TG{constructor(){this.label=this.value=null}}Object(w.a)(TG,"TextInfoSectionField",null,[]);var pE=b(678);class UG{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(w.a)(UG,
"CommandDefinition",null,[]);class hK{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(w.a)(hK,"CommandDefinitionMapping",null,[]);const NP=a=>Object.assign(new hK,{getCommandByExternalUxId:c=>{const h=a.getCommandByExternalUxId(c);return h?Object.assign(new UG,{commandId:parseInt(h.commandId),externalUxCommand:h.externalUxCommand}):Object.assign(new UG,{externalUxCommand:c})},getDoNothingCommand:()=>parseInt(Sa.a.pf),
addCommandToMaps:Object(m.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(m.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(m.a)(a,a.addTabToMap,"addTabToMap")});var OP=b(1203);class iK{}Object(w.a)(iK,"RibbonInitState",null,[]);var jK=b(466),PP=b(1158);class kK{constructor(){}flatten(a){const c=[];for(const h of a)c.push.apply(c,h);return c}}Object(w.a)(kK,"ReactAsyncDispatcher",null,[]);class tF{constructor(a,c){this.zs=null;this.med=!1;this.x5a=0;this.Jse=a;this.fb=c;this.Dxg=
Object(m.a)(this,this.yzf,"onModalMouseWheel")}onMenuOpen(){0<this.x5a?this.x5a++:(this.x5a++,l.AFrameworkApplication.K.$("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame")?window.requestAnimationFrame(()=>{window.setTimeout(Object(m.a)(this,this.Lki,"pushTransientFocusScope"),0)}):this.Lki(),this.showModal())}Lki(){this.fb&&this.fb.NI(Fc.AFrame.Nka,!0)}showModal(){this.zs||(this.zs=this.createElement("div"),this.zs.setAttribute("id","ReactModalDiv"),this.zs.style.position="absolute",
this.zs.style.bottom="0px",this.zs.style.left="0px",this.zs.style.right="0px",this.zs.style.backgroundColor="white",this.zs.style.opacity="0.0",this.Jse.appendChild(this.zs));const a=appChrome.selectors.getShyState();l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.Hja&&a.isActive&&1===a.state&&yh.a("getRibbonHeight")?this.zs.style.top=appChrome.api.getRibbonHeight(yh.f()).toString()+"px":this.zs.style.top="0px";this.zs.style.display="block";this.zs.style.visibility="visible";this.zs.style.zIndex=
"1000";this.med||(window.addEventListener("wheel",this.Dxg,!0),this.lJd()?Rh.a.instance.Ea(Jb.a.GK,this.zs,Object(m.a)(this,this.xRd,"onModalPointerUp")):Rh.a.instance.Ea(Jb.a.pointerDown,this.zs,Object(m.a)(this,this.wRd,"onModalPointerDown")),this.med=!0)}onMenuClose(){this.x5a--;0<this.x5a||(0>this.x5a?this.x5a=0:this.QJh())}Wxf(){this.x5a=0;this.hYe();this.QJh()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}PJh(){this.fb&&this.fb.nf&&this.fb.nf.name===
Fc.AFrame.Nka&&!l.AFrameworkApplication.Cb.Kv&&this.fb.gP(Fc.AFrame.Nka,!1);this.zs&&(this.zs.style.zIndex="-1",this.zs.style.visibility="hidden",this.zs.style.display="none");this.med&&(window.removeEventListener("wheel",this.Dxg,!0),this.lJd()?Rh.a.instance.xb(Jb.a.GK,this.zs,Object(m.a)(this,this.xRd,"onModalPointerUp")):Rh.a.instance.xb(Jb.a.pointerDown,this.zs,Object(m.a)(this,this.wRd,"onModalPointerDown")),this.med=!1)}QJh(){this.lJd()?window.requestAnimationFrame(()=>{window.setTimeout(()=>
{this.PJh()},0)}):this.PJh()}wRd(){this.Mzc();this.feh();this.Wxf();this.Ygb();return!0}xRd(){this.Mzc();this.feh();this.Wxf();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.Ygb()},0)});return!0}Ygb(){4===l.AFrameworkApplication.na.Ya.Rm&&l.AFrameworkApplication.K.$("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?l.AFrameworkApplication.na.Ygb():this.fb.Kf(Fc.AFrame.Mp)}yzf(a){a.stopPropagation()}Mzc(){const a=xa.a.instance.ra("Common.IReactContextualUILauncher");a&&a.Mzc()}hYe(){const a=
xa.a.instance.ra("Common.IReactContextualUILauncher");a&&a.hYe()}feh(){l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.rKa&&(this.lJd()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}lJd(){return l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",!1)}}Object(w.a)(tF,"ReactModalDiv",null,[]);class lK{constructor(a,c){this.zvj=a;this.P$i=c}}Object(w.a)(lK,"ReactExecuteCommandContext",
null,[]);class nw{}nw.Trigger="FontTrigger";nw.Name="FontName";nw.Action="FontAction";nw.Level="FontLevel";nw.IsPinned="FontIsPinned";Object(w.a)(nw,"FontPickerLogProperties",null,[]);class mK{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb=null,rc=null){this.DW=null;this.CFg=!1;this.Rhe=[];this.U3c=-1;this.Qhd=!1;this.Jwj=0;this.Paa=a;this.r6a=c;this.BDg=Object(ha.a)(848,a);this.Il=h;this.fb=v;B&&(this.DW=new tF(B,v));this.atj=X;this.Tdj=ma;this.tu=Tb;this.ga=Pa;this.Fnb={};this.qa=mb;this.x8f=rc;mb&&mb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",
!1)&&Bm.a.instance.suc.CWR(()=>this.CFg=!0)}get bzi(){return!!window.appChrome&&!!appChrome.selectors}Ixi(){-1!==this.U3c&&window.clearTimeout(this.U3c);this.U3c=window.setTimeout(()=>{for(this.U3c=-1;0<this.Rhe.length;){if(ag.a.instance.Kv){this.Ixi();break}const a=this.Rhe.shift();a&&this.executeCommand(a.zvj,a.P$i)}},0)}executeCommand(a,c){if(ag.a.instance.Kv){if(this.CFg){this.Rhe.push(new lK(a,c));this.Ixi();return}r.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
a,c.modelType,Za.a.toJSON(c.payload));if(this.qa.$("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(c){const h=this.Il.getCommandByExternalUxId(a),v=c.modelType;this.x8f&&this.x8f.M2l(a,c);h?this.NDk(a,h,v,c):this.ODk(a,v,c);this.A$l(a,c)}}ODk(a,c,h){switch(c){case "GalleryModel":case "PreviewGalleryModel":this.qjh(h,a)}}aQn(a,c,h,v,B){if(h.payload)switch(h.payload.type){case "CoauthorMenuPayload":a.MenuItemId=h.payload.coauthorId;break;case "ButtonPayload":a.MenuItemId=c.menuItemId;a.CommandValueId=
h.payload.commandValueId;this.Cba();break;case "ButtonPreviewPayload":a.MenuItemId=c.menuItemId;a.CommandValueId=h.payload.commandValueId;B=c.commandPreviewId;break;case "ButtonRevertPreviewPayload":a.MenuItemId=c.menuItemId;a.CommandValueId=h.payload.commandValueId;B=c.commandRevertId;break;default:a.MenuItemId=c.menuItemId}else a.MenuItemId=c.menuItemId;a.SourceControlId=v;return B}bQn(a,c,h){if(c.payload)switch(c.payload.type){case "MenuOpenPayload":a=this.Il.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;
break;case "MenuClosePayload":a=this.Il.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":h.CommandId=c.payload.executedControl;h.ControlId=c.payload.executedControl;h.ParentControlId=c.payload.parentControl;h.CloseAllMenus=!0;this.Cba();break;case "TellMeSearchResultChangePayload":h.Value=c.payload.searchText;break;case "SmartLookupPayload":h.CommandValueId=c.payload.selectionContextJson}return a}NDk(a,c,h,v){var B=this.YBm(v,h),X=c.commandId;const ma={},
Pa={};switch(h){case "SplitButtonModel":if(this.MFc(v.payload,Object(m.a)(this,this.gRn,"updateSplitButtonMenuState"),B))return;ma.MenuItemId=c.menuItemId;this.eRf(v,ma);break;case "StatefulSplitButtonModel":if(this.MFc(v.payload,Object(m.a)(this,this.pRn,"updateStatefulSplitButtonMenuState"),B))return;h=v.payload.statefulData;B=v.payload.statefulMode;"color"===B?ma.Color=h:"icon"===B&&(h=this.Il.getCommandByExternalUxId(h))&&(ma.MenuItemId=h.menuItemId);break;case "FileMenu":ma.MenuItemId=c.menuItemId;
ma.SourceControlId=a;v.payload&&"FileMenuPageSwitchPayload"===v.payload.type&&this.xpl(X,v.payload,a);break;case "TellMe":X=this.bQn(X,v,ma);ma.SourceControlId=a;ma.Location=v.payload.location;break;case "ButtonModel":v.payload&&"TabSwitchPayload"===v.payload.type?this.irl(ma,v):X=this.aQn(ma,c,v,a,X);break;case "CompoundButtonModel":ma.MenuItemId=c.menuItemId;ma.CommandValueId=v.payload.commandValueId;ma.SourceControlId=a;this.eRf(v,ma);this.Cba();break;case "ToggleButtonModel":case "InkButtonModel":ma.MenuItemId=
c.menuItemId;ma.SourceControlId=a;this.eRf(v,ma);this.Cba();break;case "FontPickerModel":switch(v.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":X=this.Il.getCommandByExternalUxId("FontPickerMenuClose").commandId;ma[bD.a.FontPickerId]=v.payload.launcherId;break;case "FontPickerFontSelectedPayload":h=v.payload.font;B=null;"string"===typeof h?(B=Rn.FontUtils.qLa(h),ma.CommandValueId=B,B=Rn.FontUtils.Mrd(B)):(h.data?(ma.CommandValueId=h.data.fontToApply,ma.MenuItemId=h.data.themeIndex,
ma[bD.a.Formatting]=h.data):ma.CommandValueId=h.name,B=h);ma.SourceControlId=a;ma[bD.a.RequestUpdateMru]=B;Pa[nw.Name]=v.payload.nameToLog?v.payload.nameToLog:"string"===typeof h?Rn.FontUtils.SHd(h)?"*"+h:Rn.FontUtils.Eif(h)?"[EF]":"[MF]":"";Pa[nw.IsPinned]=v.payload.isPinned;Pa[nw.Level]=v.payload.level;this.Jpf();break;case "FontPickerFontInfoRequestedPayload":ma.CommandValueId=v.payload.font.name;ma[bD.a.Trigger]=v.payload.trigger;Pa[nw.Trigger]=v.payload.trigger;Pa[nw.Name]=v.payload.nameToLog;
this.Jpf();break;case "FontPickerFontPinningPayload":h=v.payload.isPinned;ma.CommandValueId=v.payload.fontKey;ma[bD.a.IsPinned]=h;Pa[nw.Name]=v.payload.nameToLog;Pa[nw.Action]=h?"pin":"unpin";Pa[nw.Level]=v.payload.level;this.Jpf();break;default:return}break;case "ComboBoxModel":var mb=v.payload.type;switch(mb){case "MenuOpenPayload":case "MenuPopulatePayload":this.jac(v.payload.launcherId,B)&&(X={},X[v.payload.launcherId]=h,this.r6a.XPc(X,yh.g(v.payload)),this.Fnb[a]=new Date);return;case "MenuClosePayload":return;
case "ComboBoxPayload":case "ComboBoxPreviewPayload":h=v.payload.newValue;if(!h)return;h.value?(ma[Rc.a.Value]=h.value,ma[Rc.a.IsFreeForm]=!0):(ma[Rc.a.Value]=h.text,ma.MenuItemId=h.key,ma.CommandValueId=h.commandValueId);"ComboBoxPreviewPayload"===mb&&(X=c.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":X=c.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(v.payload.type){case "ZeroTermContextMenuClosePayload":h=Za.a.rM(v.payload);for(mb of h)ma[mb]=v.payload[mb];
break;default:this.MFc(v.payload,Object(m.a)(this,this.MNn,"updateFlyoutAnchorMenuState"),B),ma.launcherId=v.payload.launcherId}break;case "InkFlyoutAnchorModel":this.MFc(v.payload,Object(m.a)(this,this.HOn,"updateInkFlyoutAnchorMenuState"),B);ma.launcherId=v.payload.launcherId;break;case "ColorPickerModel":switch(v.payload.type){case "ColorPickerPayload":ma[Ql.Color]=v.payload.selectedColorId;break;case "ColorPickerPreviewPayload":X=c.commandPreviewId;ma[Ql.Color]=v.payload.selectedColorId;break;
case "ColorPickerRevertPreviewPayload":X=c.commandRevertId;break;default:return}break;case "SpinButtonModel":ma[pg.a.Number]=v.payload.value;ma[pg.a.UnitType]=Of.a.Rtb(v.payload.unitType.toLowerCase());ma[pg.a.Text]=v.payload.reservedValue;break;case "SliderModel":ma[vm.Value]=v.payload.value;break;case "InsertTableModel":ma[Zh.a.Rows]=v.payload.rows;ma[Zh.a.Columns]=v.payload.columns;break;case "CheckboxModel":ma[Uf.a.On]=v.payload.checked;ma.MenuItemId=c.menuItemId;break;case "PreviewGalleryModel":if(this.MFc(v.payload,
Object(m.a)(this,this.lQn,"updatePreviewGalleryMenuState"),B)){ma.launcherId=v.payload.launcherId;break}this.qjh(v,a);return;case "DocumentTitleModel":switch(v.payload.type){case "DocumentTitleRenamePayload":ma.getNewDocumentTitle=v.payload.getNewDocumentTitle;break;case "MenuOpenPayload":X={};X[v.payload.launcherId]=h;this.r6a.XPc(X,yh.g(v.payload));this.Fnb[a]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":ma.MenuItemId=v.payload.url;this.E3l(v.payload.pageId);
break;case "NewBlankDocumentModel":case "CustomTemplateModel":ma.MenuItemId=v.payload.assetId;ma.SourceControlId=a;this.F3l(v.payload.pageId);break;case "CoauthorGallery":ma.RenderTime=v.triggerTime;break;case "PeopleWell":ma.RenderTime=v.triggerTime;break;case "SyncStatus":ma.SourceControlId=a;break;case "InputBoxModel":ma.Text=v.payload.newValue;break;case "PersonaButtonModel":ma.CommandValueId=v.payload.commandValueId;this.vql(v.payload);break;default:return}X&&!this.isShadowMenuOpen(v.payload)&&
(ma.CommandValueId||(ma.CommandValueId=ma.MenuItemId),c.legacyControlId&&(ma.LegacyId=c.legacyControlId),ma.SourceControlId||(ma.SqmControlId=a),this.qa&&this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&ma.launcherId&&(c=this.Il.getCommandByExternalUxId(ma.launcherId))&&(ma.launcherCommandId=parseInt(c.commandId)),v.payload&&!De.c(v.payload.shouldTakeFocus)&&(ma[Gz.a.b0a]=v.payload.shouldTakeFocus),c=this.RNg(v,ma),De.c(v.triggerTime)||(Pa.TriggerTime=v.triggerTime),
v.payload&&!De.c(v.payload.userActionKey)&&(Pa.userActionKey=v.payload.userActionKey),this.BDg.executeCommand(X,ma,this.getSelectedTabId(),c,!0,()=>{this.j6h(ma,a)},Pa,yh.g(v.payload)))}Jpf(){this.tu&&this.tu.execute(a=>{a.vpf("ModernFontPickerExperience")})}RNg(a,c){let h=2;a.payload&&"inputMethod"in a.payload&&a.payload.inputMethod&&(h=a.payload.inputMethod,c[Gz.a.wF]=h);return h}j6h(a,c){const h=Object(ha.a)(Fc.AFrame,l.AFrameworkApplication.na);if(this.fb&&this.kGi(a)){if(!this.fb.nf&&h){let v=
"null";if(a){const B=a.Value;delete a.Value;v=Za.a.toJSON(a);De.c(B)||(a.Value=B)}r.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",c,v,h.s_a)}this.fb.onh()}(this.fb&&this.fb.nf&&this.fb.nf.name!==Fc.AFrame.Nka&&h&&this.fb.nf.name!==h.s_a||this.kGi(a))&&this.Z8j(a)}kGi(a){return!!a&&!De.c(a[Gz.a.b0a])&&a[Gz.a.b0a]}Z8j(a){Gz.a.wF in a&&1===a[Gz.a.wF]&&pE.ShyRibbon.M8a(1,
0)}irl(a,c){this.Paa.yk();if(this.atj&&this.ga){const h={};h[SJ.a.tHb]=c.payload.tabId;this.ga.hb(Sa.a.vTc,2,h,this.Cca(c));De.c(c.payload.inputMethod)||(this.ga.processAction(Sa.a.Fti,2),this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.CoachMarkEnabled",!1)&&!this.Qhd&&this.Hsn(c.payload.tabId))}c=c.payload.tabId;a.NewContextId=c;a.NewContextCommand=this.Il.raf(c);r.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+c);if(this.tu&&c){const h=c+"TabSwitchActivity";this.tu.execute(v=>
{v.vpf(h)})}}MFc(a,c,h){const v=a.type;return"MenuClosePayload"===v?!0:"MenuOpenPayload"===v?(c(a,h),!0):!1}vql(a){a=a.type;"MenuOpenPayload"===a?l.AFrameworkApplication.sbc=!0:"MenuClosePayload"===a&&(l.AFrameworkApplication.sbc=!1)}YBm(a,c){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&"MenuPopulatePayload"!==a.payload.type)return!1;const h=a.payload.launcherId,v=this.Il.getCommandByExternalUxId(h);return v&&v.populationProps?((a=this.r6a.UDf(v,c,a.payload))&&h in this.Fnb&&
delete this.Fnb[h],a):!1}MNn(a,c){const h=a.launcherId;this.jac(h,c)&&(c=appChrome.selectors.getFlyoutAnchorMenuItems(h),this.$cc(c,h,yh.g(a)))}HOn(a,c){const h=a.launcherId;this.jac(h,c)&&(c=yh.i("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(h):appChrome.selectors.getFlyoutAnchorMenuItems(h),this.$cc(c,h,yh.g(a)))}lQn(a,c){const h=a.launcherId;this.jac(h,c)&&(c=appChrome.selectors.getPreviewGalleryMenuItems(h),this.$cc(c,h,yh.g(a)))}gRn(a,c){const h=a.launcherId;
this.jac(h,c)&&(c=appChrome.selectors.getSplitButtonMenuItems(h),this.$cc(c,h,yh.g(a)))}pRn(a,c){const h=a.launcherId;this.jac(h,c)&&(c=appChrome.selectors.getStatefulSplitButtonMenuItems(h),this.$cc(c,h,yh.g(a)))}getSelectedTabId(){return this.bzi?appChrome.selectors.getSelectedTabId():null}$cc(a,c,h){this.r6a.XPc(a,h);this.Fnb[c]=new Date}jac(a,c){let h=!0;a in this.Fnb&&(h=this.Fnb[a].getTime()<this.Paa.Oja.getTime());return h&&!c&&this.bzi}qjh(a,c){const h={};var v=a.payload.selectedGalleryId;
const B=this.Il.getCommandByExternalUxId(v);B&&(h.SourceControlId=v,h.MenuItemId=B.menuItemId,h.SqmControlId=c,B.legacyControlId&&(h.LegacyId=B.legacyControlId),a.payload&&!De.c(a.payload.shouldTakeFocus)&&(h[Gz.a.b0a]=a.payload.shouldTakeFocus),this.ial(a.payload,h),v=this.RNg(a,h),this.BDg.executeCommand(B.commandId,h,this.getSelectedTabId(),v,!0,()=>{this.j6h(h,c)},this.Cca(a),yh.g(a.payload)))}ial(a,c){"CharacterGalleryPayload"===a.type&&(c.MenuItemId=a.character)}eRf(a,c){a.payload&&"toggled"in
a.payload&&(c[Uf.a.On]=a.payload.toggled)}A$l(a,c){if("MenuOpen"===a){if(this.DW&&!("isShadowRendering"in c.payload&&c.payload.isShadowRendering))this.DW.onMenuOpen()}else if("MenuClose"===a&&this.DW)this.DW.onMenuClose()}Cba(){this.DW&&this.DW.Wxf()}Cca(a){let c=null;De.c(a.triggerTime)||(c={},c.TriggerTime=a.triggerTime);return c}xpl(a,c,h){if(this.Tdj&&this.ga){const v={};v[QJ.a.pageId]=h;this.ga.hb(Sa.a.uTc,2,v)}this.$cc(c.pageControlIdMap,a,yh.g(c))}F3l(a){if(this.ga)switch(a){case "FileHomePage":this.ga.processAction(Sa.a.Kti,
2);break;case "FileNewPage":this.ga.processAction(Sa.a.Lti,2)}}E3l(a){if(this.ga)switch(a){case "FileHomePage":this.ga.processAction(Sa.a.nti,2);break;case "FileOpenPage":this.ga.processAction(Sa.a.oti,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}Hsn(a){if(l.AFrameworkApplication.K.$("TellMeHelpCoachMarkActivityEnabled")&&"Help"===a)this.tu.execute(c=>{c.logActivity("TellMeHelpCoachMarkActivity",null)}),this.Qhd=!0;else{if(l.AFrameworkApplication.K.$("TellMe3TabSwitchCoachMarkActivityEnabled")&&
(this.tu.execute(c=>{c.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.Jwj)){this.Qhd=!0;return}l.AFrameworkApplication.K.$("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.ga.processAction(Sa.a.ZGb,2)&&(this.Qhd=!0)}}}Object(w.a)(mK,"ReactExecuteCommandHandler",null,[]);class nK{constructor(){this.fileMenu=null}get jjb(){return 0}get CYa(){return 0}get xAa(){return!1}$ka(){}SOi(){}kX(){return!1}jBi(){}kOf(){return!1}U_(){return!1}UCa(a){return this.fileMenu&&this.fileMenu.nMa(a)?
!0:!1}get Jea(){return!1}get Nyi(){return null}Ugb(){}bId(){return!1}get Nqd(){return null}set Nqd(a){}sba(){}b8(){}nbf(){return null}iIa(){}refresh(){}get controls(){return null}H8b(){return!1}a9a(){}yk(){}get GC(){return null}set GC(a){}yZc(){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}Object(w.a)(nK,"ReactRibbonExternal",null,[628,583,629]);class oK{constructor(a,c,h,v){this.fb=a;this.ga=c;this.dLg=h;this.EQb=v}initialize(){this.ga.ka(Sa.a.tZd,Kc.a.frame,Object(m.a)(this,
this.Hvi,"ribbonMoveForwardAction"));this.ga.ka(Sa.a.sZd,Kc.a.frame,Object(m.a)(this,this.Gvi,"ribbonMoveBackwardAction"));this.ga.ka(Sa.a.rZd,Kc.a.frame,Object(m.a)(this,this.Dvi,"ribbonEscAction"));var a=qk.a.Fff(this.EQb,null,this.dLg,!1);a.rK=!0;this.F8b(a,Sa.a.tZd,Sa.a.sZd);a.bindAction(qc.KeyInputManager.mb(vb.a.ZCa,0),Sa.a.rZd);a=this.fb.fd(Fc.AFrame.Nka);a.rK=!0;this.F8b(a,Sa.a.HUa,Sa.a.HUa);ah.a.instance.Ea(Jb.a.Lv,this.dLg,Object(m.a)(this,this.$rm,"onRibbonMouseDown"));a=pj.a.instance;
yh.a("enterKeytipMode")&&a.Ugn(this.EQb,()=>{appChrome.api.enterKeytipMode(!1)});yh.a("exitKeytipMode")&&a.Pgn(this.EQb,()=>{appChrome.api.exitKeytipMode();pE.ShyRibbon.M8a(1,0)});l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.Hja&&(a=Object(ha.a)(nc.FocusManager,this.fb))&&a.fIj(Object(m.a)(this,this.Rnm,"onFocusScopeChanged"))}Rnm(a,c){if((a=Object(ha.a)(Fc.AFrame,l.AFrameworkApplication.na))&&c.L7h&&l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.Hja){const h=appChrome.selectors.getShyState();
h.isActive&&c.L7h.name===a.s_a&&pE.ShyRibbon.M8a(h.state,1)}}Hvi(){return 4}Gvi(){return 4}Dvi(){yh.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.Hja&&appChrome.selectors.getShyState().isActive&&pE.ShyRibbon.M8a(1,0),this.fb.Kf(Fc.AFrame.Mp));return 4}F8b(a,c,h){const v=qc.KeyInputManager.mb(vb.a.Sv,0),B=qc.KeyInputManager.mb(vb.a.Sv,4);a.Bp(v);a.Bp(B);a.bindAction(v,c);a.bindAction(B,h)}$rm(a){a.Sa&&a.Sa.target&&"input"!==a.Sa.target.tagName.toLowerCase()&&
a.Sa.preventDefault();return!1}dispose(){this.ga.uy(Sa.a.tZd,Kc.a.frame,Object(m.a)(this,this.Hvi,"ribbonMoveForwardAction"));this.ga.uy(Sa.a.sZd,Kc.a.frame,Object(m.a)(this,this.Gvi,"ribbonMoveBackwardAction"));this.ga.uy(Sa.a.rZd,Kc.a.frame,Object(m.a)(this,this.Dvi,"ribbonEscAction"))}}Object(w.a)(oK,"ReactRibbonFocusManager",null,[14]);class mC{constructor(a,c,h,v,B,X,ma,Pa=null,mb=!0,Tb=null,rc=null){this.e4a=this.Wid=this.ucg=this.Paa=null;this.dFg=[];this.Zed=null;this.VFa=a;this.Jse=c;this.EQb=
h;this.fb=v;this.ga=B;this.Il=X;this.Paa=Tb?Tb:new dF(ek.instance,this.Il);this.Elc=ma;this.sDg=new nK;this.WFa=Pa;this.IAe=mb;new kK;this.oig=rc;ck.a.get_instance().Vk(7,Object(m.a)(this,this.fin,"setRibbonPostInteractiveReady"));ck.a.get_instance().Vk(7,Object(m.a)(this,this.o7l,"logRibbonLoadedActivity"));l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&ck.a.get_instance().Vk(7,Object(m.a)(this,this.dUm,"registerSubComponentReporting"));
ck.a.get_instance().Vk(7,Object(m.a)(this,this.sKm,"queueSettingsDependentActions"))}initialize(a,c,h=null){this.IAe||this.iH(5);h?h.then(()=>{this.wsi()}).catch(()=>r.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):jK.a.e5d(jK.a.e5d(nl.Task.WAA(this.R_h(a),this.Q_h(mC.caj)),()=>this.Q_h(mC.B7i)),()=>this.R_h(c)).continueWith(()=>{this.wsi()},11)}dispose(){this.BJn();this.e4a&&this.e4a.weh();this.Zed&&this.Zed.dispose();for(const a of this.dFg)ck.a.get_instance().c6j(a);
l.AFrameworkApplication.pa.uy(Sa.a.G0m,Kc.a.frame,Le.ActionManager.De)}Q_h(a){return xa.a.instance.resolve("Common.ISharedDependencyLoader").O4b(l.AFrameworkApplication.vx(a,2))}R_h(a){return""===a?nl.Task.T3(!0):xa.a.instance.resolve("Common.ISharedDependencyLoader").O4b(l.AFrameworkApplication.vx(a,3))}uBl(){(this.WFa||this.Elc)&&appChrome.api.dispatch(this.jFh());this.Yjn();yh.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(l.AFrameworkApplication.LV);this.Paa.yk()}wsi(){this.uBl();
this.IAe&&(appChrome.renderAppChrome(this.VFa,yh.e()),this.iH(10));this.aNg();this.uNe();this.IAe&&this.iH(5);this.NMh()}NMh(){this.fb&&this.ga&&this.EQb&&(this.Zed=new oK(this.fb,this.ga,this.VFa,this.EQb),this.Zed.initialize())}get WTc(){return this.sDg}setCommandDefinitionMapping(){if(yh.a("setCommandDefinitionMapping")){const a=NP(this.Il);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.Hja&&yh.a("registerOnShyRibbonStateChange")&&
appChrome.api.registerOnShyRibbonStateChange((a,c)=>{0===c&&this.N7b()})}aNg(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const a=Object(ha.a)(dF,this.Paa);this.ucg=new mK(this.Paa,a.E8b,this.Il,this.fb,this.Jse,xa.a.instance.ra("Common.IRibbonSQMInformation"),xa.a.instance.ra("Common.IFileMenuSQMInformation"),l.AFrameworkApplication.pa,l.AFrameworkApplication.K,xa.a.instance.za("Common.ISystemInitiatedFeedback"),null);this.yTj()}yTj(){this.Wid=appChrome.api.bindCommandHandler((a,
c)=>{this.ucg.executeCommand(a,c)})}BJn(){this.Wid&&(this.Wid(),this.Wid=null)}Yjn(){appChrome.api.initializeLogger(new lo.a)}Jya(){return this.Paa?this.Paa.Jya():[]}N7b(){Fo.a.instance.$c(()=>{let a=null;Fo.a.instance.$c(()=>{a=this.Jya()},"RB:GA");a&&0<a.length&&(this.Paa.Oja=new Date,Fo.a.instance.$c(()=>{appChrome.api.dispatch(a)},"RB:DA"));this.e4a&&Fo.a.instance.$c(()=>{this.e4a.$hi()},"RB:J")},"RB:PFSU")}JZc(){this.Paa.JZc()}ICb(){}lBj(a){a=[appChrome.actions.activateDeactivateContextualTab(a,
!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}jFh(){var a=l.AFrameworkApplication.K;const c=[];a.$("EnableTellMeForOneLineRibbonIsEnabled")?a.$("OcpsIsEnabled")&&xa.a.instance.za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(h=>{h.isFeatureEnabled("ConnectedServices",!0).then(v=>{v&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):
c.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));c.push.apply(c,this.Cuh());a=new OP.a(this.Il);this.WFa.vE&&(PP.a.NGn(this.WFa.vE),c.push.apply(c,a.byd(this.WFa.vE)));if(this.WFa.EQi)for(const h of this.WFa.EQi)c.push(appChrome.actions.updateGallerySectionHiddenState(h.Poh,h.Sbo,h.Wdo));c.push.apply(c,a.Gph(this.WFa.GQi));return c}Cuh(){const a=[];if(this.Elc&&this.Elc.vE){const h=this.Elc.vE;for(let v in h){var c=h[v];const B=this.Il.r7e(v);if(B)for(let X of B)a.push(appChrome.actions.updateControlHiddenState(X,
c))}}return a}ZNa(a){a&&this.Paa.E8b.XPc(a,0)}UDf(a){this.Paa.E8b.UDf(this.Il.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}Ovk(){if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabUpdateSharingStatusReduxAction",!1)){const a=l.AFrameworkApplication.K.$("ShareMenuIsEnabled")?"ShareMenu":"Share",c=l.AFrameworkApplication.K.appSettings;c&&appChrome.api.dispatch(this.cRn(a,"Shared"===(c.SharingStatus||"")))}}sKm(){l.AFrameworkApplication.K.Io(()=>
{this.Ovk()})}cRn(a,c){return appChrome.actions.updateSharingStatusIndicator(a,c)}OCh(a){return appChrome.actions.updateControlHiddenState(a,!1)}PCh(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}iH(a){ck.a.get_instance().iH(a);this.dFg.push(a)}fin(){yh.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new iK,{postRibbonInteractiveReady:!0})))}uNe(){this.Elc&&this.oig&&(this.e4a=this.oig.LTe(),this.sDg.fileMenu=
this.e4a)}WXl(a,c){this.e4a&&this.e4a.GZh(a,c)}YMf(a,c,h){if(1===h)return 32;this.UCi(!0);this.N7b();l.AFrameworkApplication.na.updateCommandUI();return 32}ZMf(a,c,h){if(1===h)return 32;this.UCi(!1);this.tin();this.N7b();l.AFrameworkApplication.na.updateCommandUI();return 32}tin(){cb.a.dNa(l.AFrameworkApplication.K.Ga("IsSimplifiedRibbonOnCookieName"),"true",cb.a.fLa)}UCi(a){cb.a.dNa(l.AFrameworkApplication.K.Ga("ReactRibbonMLRPreferenceCookieName"),a.toString(),cb.a.fLa)}o7l(){if(l.AFrameworkApplication.na&&
l.AFrameworkApplication.na.Ya.Jo){const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(a.execute(c=>{c.logActivity("SingleRibbonModeActivity",null)}),l.AFrameworkApplication.m9("d79fg304;61jba833")):"Multiline"===appChrome.selectors.getRibbonMode()&&(a.execute(c=>{c.logActivity("MultiRibbonModeActivity",null)}),l.AFrameworkApplication.m9("69a7h198;dfd7j584"))}}dUm(){ck.a.get_instance().Vk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",
!1)});const a=appChrome.api.getRibbonSubComponentMappings();for(let h in a){var c=h;const v=a[h];if(v)for(const B of v)l.AFrameworkApplication.pa.j8(B)?appChrome.api.reportRibbonSubComponentBehaviorMapped(c):l.AFrameworkApplication.pa.Mgn(B,this.gkk(c));else appChrome.api.reportRibbonSubComponentBehaviorMapped(c)}}gkk(a){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(a)}}}mC.caj="common";mC.B7i="appChrome";Object(w.a)(mC,"ReactRibbonUser",null,[214,140,14]);class VG extends mC{constructor(a,
c,h,v,B,X,ma,Pa,mb=null,Tb=!0,rc=null,Tc=null){super(a,c,v,B,X,ma,Pa,mb,Tb,rc,Tc);this.Q6c=null;this.omb=h;this.omb.execute(vd=>{this.Q6c=vd});this.omb.execute(vd=>{this.Paa.GC=vd})}Jya(){return this.Q6c?(this.Q6c.clearCache(),super.Jya()):[]}ICb(a){if(!a)throw Error.argumentNull();this.omb.execute(c=>{a.GC=c})}}Object(w.a)(VG,"ReactRibbonUser",mC,[]);var QP=b(879);class qE extends VG{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb=!0,rc=null,Tc=null){super(c,a.Rxa,v,If.AppFrame.Wka,B.wf,B.Eb,ma,Pa,mb,Tb,rc,
Tc);if(void 0===a||null===a)throw Error.argumentNull("hostingAppFrame");this.rle=a;this.V6=X;B.iOa(()=>{this.KQn();l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayUIComponentsUntilAfterRibbon",!1)?ck.a.get_instance().Vk(7,()=>{this.EMh()}):this.EMh()},null)}get mif(){return!!l.AFrameworkApplication.K.appSettings.BootActivityNavigationId}EMh(){this.rik();this.LTe();this.ZQm()}KQn(){this.VFa.classList.add("FlexBoxLayout");this.rle.Iia().classList.add("cui-exth");
this.rle.Iia().classList.add("FlexBoxLayout");this.rle.Iia().classList.add("ScrollableRibbon")}rik(){l.AFrameworkApplication.BR||this.mmk()}mmk(){if(!l.AFrameworkApplication.BR){var a=(new $J(qE.Zsj,this.V6)).JCk(),c=qk.a.Fff(If.AppFrame.zJa,null,a,!0);c.rK=!0;this.F8b(c,Sa.a.tZd,Sa.a.sZd);c.bindAction(qc.KeyInputManager.mb(vb.a.ZCa,0),Sa.a.rZd);pB(1,()=>{this.$Zm(a)})}}$Zm(a){const c=new gK;appChrome.renderSharedHeader(a,c.Kya()).then(Object(m.a)(this,this.jYe,"dismissFastViewHeader"))}rqi(){l.AFrameworkApplication.na.Ya.Tlf?
appChrome.getHeaderApi().then(a=>{document.getElementById(l.AFrameworkApplication.F$a).classList.remove("Placeholder");return a.dismissPlaceholder()}):(new QP.a).jYe()}jYe(){this.mif&&l.AFrameworkApplication.m9("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings");this.mif&&l.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?(ck.a.get_instance().Vk(12,Object(m.a)(this,this.rqi,"removeHeaderPlaceholder"),11),r.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):
this.rqi()}F8b(a,c,h){const v=qc.KeyInputManager.mb(vb.a.Sv,0),B=qc.KeyInputManager.mb(vb.a.Sv,4);a.Bp(v);a.Bp(B);a.bindAction(v,c);a.bindAction(B,h)}LTe(){const a=!!this.WFa&&"FileMenu"in this.WFa.GQi;l.AFrameworkApplication.na.Ya.rKa&&!a&&pB(1,Object(m.a)(this,this.vZm,"renderFileMenu"))}vZm(){const a=[];if(l.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var c=[Object.assign(new TG,{label:CommonUIStrings.L_DiagnosticsSessionId,value:l.AFrameworkApplication.userSessionId}),
Object.assign(new TG,{label:CommonUIStrings.L_DiagnosticsBuild,value:l.AFrameworkApplication.buildVersion})];a.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",c))}a.push.apply(a,this.Cuh());c=document.createElement("div");document.body.appendChild(c);appChrome.renderFileMenu(c,a)}ZQm(){this.ga.ka(Sa.a.FNa,ic.a.view,Object(m.a)(this,this.FNa,"tabSwitch"));this.ga.ka(Sa.a.YMf,ic.a.view,Object(m.a)(this,this.YMf,"ribbonModeToggledToMLR"));this.ga.ka(Sa.a.ZMf,ic.a.view,Object(m.a)(this,
this.ZMf,"ribbonModeToggledToSLR"))}activateRibbonTab(a){this.lBj(a)}N7b(){ck.a.get_instance().isCompleted(7)&&this.Q6c&&(bh.a.mark(4893),hu.a.kQn(),super.N7b(),bh.a.mark(4894))}FNa(a,c,h,v,B){if(2===B[Gz.a.wF]){if(h=Object(ha.a)(Fv.a,c))c=Object(ha.a)(Ho.a,h.view);else return r.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(c),a,Za.a.join(B," ",":")),8;if(c&&""!==c.IG)this.fb.Kf(c.IG),appChrome.selectors.getShyState().isActive&&
pE.ShyRibbon.M8a(0,1);else return r.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(h.view),a,Za.a.join(B," ",":"),this.p4k(h.view)),8}return 32}p4k(a){return a?"is ContentEditableView: "+a.wj+" is Editing View: "+a.Vqa+" is FishbowlView: "+a.aKa+" is HtmlView: "+a.fKa+" is InteractiveView: "+a.Cd+" is NavigationPaneView: "+a.pUh+" is PageView: "+a.Rh+" is WordNavigationPaneHeadingsView "+
a.Vmf:"null view"}}qE.Zsj="WACRibbon";Object(w.a)(qE,"ReactRibbonUser",VG,[213,214,140,14]);class pK{constructor(a){this.Pi=a}Wfl(){return[u(Th.a.xNh,this.Pi.dKh,"Insert Footnote"),u(Th.a.tNh,this.Pi.bKh,"Insert Endnote"),u(Th.a.QTf,this.Pi.lKh,"Show/Hide \u00b6"),u(Th.a.f_f,this.Pi.Mdf,"Undo"),u(Th.a.IIf,this.Pi.kKh,"Redo"),u(Th.a.zMe,this.Pi.YJh,"Bold"),u(Th.a.$mf,this.Pi.hKh,"Italic"),u(Th.a.e_f,this.Pi.qKh,"Underline"),u(Th.a.KJn,this.Pi.Mdf,"Undo"),u(Th.a.ecf,this.Pi.fKh,"Grow Font Size"),u(Th.a.STf,
this.Pi.mKh,"Shrink Font Size"),u(Th.a.eJk,this.Pi.cKh,"Find"),u(Th.a.tYg,this.Pi.ZJh,"Bullets"),u(Th.a.uYg,this.Pi.ZJh,"Bullets"),u(Th.a.U8h,this.Pi.jKh,"Numbering"),u(Th.a.V8h,this.Pi.jKh,"Numbering"),u(Th.a.Edh,this.Pi.aKh,"Dictate"),u(Th.a.t7h,this.Pi.iKh,"New Comment")]}Zfl(){return[u(Th.a.qJe,this.Pi.oFd,"Align Left"),u(Th.a.pJe,this.Pi.nFd,"Align Center"),u(Th.a.rJe,this.Pi.pFd,"Align Right"),u(Th.a.hnf,this.Pi.qFd,"Justify"),u(Th.a.HXf,this.Pi.oFd,"Align Left"),u(Th.a.FXf,this.Pi.nFd,"Align Center"),
u(Th.a.IXf,this.Pi.pFd,"Align Right"),u(Th.a.GXf,this.Pi.qFd,"Justify")]}Sfl(){return[u(Th.a.xNh,this.Pi.dKh),u(Th.a.tNh,this.Pi.bKh),u(Th.a.tFn,this.Pi.qvl),u(Th.a.ecf,this.Pi.fKh),u(Th.a.STf,this.Pi.mKh),u(Th.a.zMe,this.Pi.YJh),u(Th.a.$mf,this.Pi.hKh),u(Th.a.e_f,this.Pi.qKh),u(Th.a.tdh,this.Pi.aKh),u(Th.a.QTf,this.Pi.lKh),u(Th.a.ogf,this.Pi.nvl),u(Th.a.t7h,this.Pi.iKh),u(Th.a.f_f,this.Pi.Mdf),u(Th.a.IIf,this.Pi.kKh),u(Th.a.eIk,this.Pi.cKh)]}Vfl(){return[u(Th.a.qJe,this.Pi.oFd),u(Th.a.pJe,this.Pi.nFd),
u(Th.a.rJe,this.Pi.pFd),u(Th.a.hnf,this.Pi.qFd),u(Th.a.HXf,this.Pi.oFd),u(Th.a.FXf,this.Pi.nFd),u(Th.a.IXf,this.Pi.pFd),u(Th.a.GXf,this.Pi.qFd)]}Ufl(){return[u(Th.a.BVf,this.Pi.nKh),u(Th.a.SVf,this.Pi.oKh),u(Th.a.ZVf,this.Pi.pKh),u(Th.a.I3e,this.Pi.eKh)]}Tfl(){return[u(Th.a.hff,this.Pi.gKh),u(Th.a.qWe,this.Pi.$Jh)]}Yfl(){return[u(Th.a.BVf,this.Pi.nKh,"Strikethrough"),u(Th.a.SVf,this.Pi.oKh,"Subscript"),u(Th.a.ZVf,this.Pi.pKh,"Superscript"),u(Th.a.I3e,this.Pi.eKh,"Format Painter")]}Xfl(){return[u(Th.a.hff,
this.Pi.gKh,"Increase Indent"),u(Th.a.qWe,this.Pi.$Jh,"Decrease Indent")]}}Object(w.a)(pK,"ShortcutDiscoverySettings",null,[]);class qK{constructor(){this.jrg=H.a.eYa;this.Pi=new EG.a(H.a.qk||H.a.sh);this.U6a=new pK(this.Pi)}Hel(){let a=this.Kel();this.jrg&&(a=a.concat(this.Lel()));return a}Jel(){return this.bCd(this.U6a.Ufl())}Iel(){return this.bCd(this.U6a.Tfl())}aYk(){let a=this.dYk();this.jrg&&(a=a.concat(this.eYk()));return a}cYk(){return this.$yd(this.U6a.Yfl())}bYk(){return this.$yd(this.U6a.Xfl())}Lel(){return this.bCd(this.U6a.Vfl())}Kel(){return this.bCd(this.U6a.Sfl())}eYk(){return this.$yd(this.U6a.Zfl())}dYk(){return this.$yd(this.U6a.Wfl())}bCd(a){const c=
[];a.forEach(h=>{c.push(appChrome.actions.setButtonSecondaryText(h.actionId,h.tFi))});return c}$yd(a){const c=[];a.forEach(h=>{c.push(appChrome.actions.setControlCustomTooltip(h.actionId,this.X$e(h.label,h.tFi)))});return c}X$e(a,c){return a+" ("+c+")"}}Object(w.a)(qK,"ShortcutActionHelper",null,[]);class rK extends qE{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie=null){super(a,c,h,v,B,X,ma,Pa,mb,!1,rc,Ie);this.mgd=Tb.BSf();this.$uj=Tb.EGi();this.Pi=Tc;this.TFg=vd;this.UFg=ee;this.tu=xa.a.instance.za("Common.ISystemInitiatedFeedback");
this.Byn()}SBl(){r.ULS.sendTraceTag(587232785,306,50,"InitializeWordRibbon was reached");ck.a.get_instance().iH(5);const a=this.mif&&l.AFrameworkApplication.K.$("ImprovedDeepLinkLoadIsEnabled")?12:10;ck.a.get_instance().Vk(a,Object(m.a)(this,this.JAl,"initializeFullRibbon"),11)}Rfl(){const a=[],c=new qK;a.push(...c.Hel(),...c.aYk());null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableShortcutControl",!1)&&a.push(...c.Jel(),...c.cYk());
null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableHeadingDiscovery",!1)&&a.push(...c.Iel(),...c.bYk());return a}cUk(){const a=[];this.TFg&&(a.push(appChrome.actions.setButtonSecondaryText(Th.a.Csd,this.Pi.mvl)),a.push(appChrome.actions.setButtonSecondaryText(Th.a.crd,this.Pi.kvl)),a.push(appChrome.actions.setButtonSecondaryText(Th.a.VTd,this.Pi.ovl)));this.UFg&&a.push(appChrome.actions.setButtonSecondaryText(Th.a.TTd,this.Pi.pvl));
return a}TLj(){this.tu&&this.tu.execute(a=>{a.logActivity("WordShyRibbon",null)});return 32}nln(){this.tu&&appChrome.api.isSmallDevice()?this.tu.execute(a=>{a.logActivity("ShyRibbonSmallScreenActivity",null)}):this.tu.execute(a=>{a.logActivity("ShyRibbonNormalScreenActivity",null)});l.AFrameworkApplication.pa.Aa(Sa.a.CRg,Kc.a.frame,Object(m.a)(this,this.TLj,"alwaysShowRibbonSurvey"),96)}JAl(){Cj.a.instance.Xe(lg.a.TBl,(new Date).getTime());appChrome.getLazyRibbonInitializationActions().then(a=>{var c=
l.AFrameworkApplication.K.$("ShareMenuIsEnabled"),h=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerCleanupIsEnabled",!1);const v=c?"ShareTopBar":"Share";h&&c?this.mgd&&a.push(this.OCh(v),this.PCh(),appChrome.actions.updateControlHiddenState("ShareMenu",!1)):(this.mgd?a.push(this.OCh(v)):a.push(appChrome.actions.removePeripheralControl(v)),this.$uj?a.push(this.PCh()):a.push(appChrome.actions.removePeripheralControl("CopyLink")),c&&!this.mgd&&a.push(appChrome.actions.updateControlHiddenState("ShareMenu",
!this.mgd)));this.WFa&&a.push.apply(a,this.jFh());(this.TFg||this.UFg)&&this.Pi&&a.push.apply(a,this.cUk());l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableShortcutDiscovery",!1)&&a.push.apply(a,this.Rfl());l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.Hja&&this.nln();appChrome.api.isSmallDevice()&&l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.WG&&!H.a.dA&&!l.AFrameworkApplication.BR&&l.AFrameworkApplication.m9("Microsoft.Office.Web.SessionSettings.IWacWordShyRibbonSettings");
a.push.apply(a,this.Jya());a.push(appChrome.actions.setControlBehaviorAttached(!0));const B=xa.a.instance.resolve("WordEditor.IModeSwitcherControl");c=B.X3k();l.AFrameworkApplication.Mg("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&(h=appChrome.selectors.getModeSwitcherMode())&&h!==c.activeMode&&r.ULS.sendTraceTag(527778651,306,15,`ModeSwitcher was initially rendered in the incorrect mode. Expected: ${c.activeMode}, Actual: ${h}`);
(h="Suggest"===c.activeMode)&&l.AFrameworkApplication.Mg("7aj80981;1e3dc950");l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowReviewTabInReviewMode",!1)&&h||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)&&"View"===c.activeMode?appChrome.getUpdateAppModeAndTabsActions(c).then(X=>{appChrome.api.dispatch(a.concat(X));B.J4h();this.TMh()}):(a.push(appChrome.actions.updateModeSwitcher(c)),appChrome.api.dispatch(a),
B.J4h(),this.TMh())})}TMh(){l.AFrameworkApplication.nDf.AJn();this.aNg();this.uNe();this.NMh();ck.a.get_instance().iH(7);Cj.a.instance.$ga(lg.a.ruc,lg.a.c5m,(new Date).getTime())}Byn(){null!=l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("CollabCornerFloodgateSurveyFileSharedStatusIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FileSharedStatusInSharePeripheralControl",!1)&&2===l.AFrameworkApplication.Yr.NRf&&(this.o2=xa.a.instance.za("Common.App.HostNotification.EditNotificationEventSource"))&&
this.o2.execute(a=>{a.yTb(Object(m.a)(this,this.cQi,"triggerCollabCornerFileSharedStatusSurvey"))})}cQi(){const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");a&&window.setTimeout(()=>a.execute(c=>{c.logActivity("ToggleCollabCornerFileSharedStatusSurvey","CollabCornerFloodgateSurveyFileSharedStatusIsEnabled");this.o2&&this.o2.execute(h=>{h.ZSc(Object(m.a)(this,this.cQi,"triggerCollabCornerFileSharedStatusSurvey"))})}),12E4)}ZNa(a){if(a){const c=this.Dvh();try{super.ZNa(a)}finally{null===c||
void 0===c?void 0:c.dispose()}}}Jya(){const a=this.Dvh();try{return super.Jya()}finally{null===a||void 0===a?void 0:a.dispose()}}Dvh(){var a;let c=void 0;const h=null===(a=Eb.App.aj)||void 0===a?void 0:a.Pk;h&&(c=new gf.GraphTransaction(Eb.App.MRh()&&Eb.App.ujf?0:2),c.set(h));return c}}Object(w.a)(rK,"ReactRibbonUser",qE,[]);var sK=b(900);class RP{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(w.a)(RP,"HeaderToggleButtonInfo",null,[]);class WG{constructor(a){this.Ou=
a}JCd(){return null}hQk(){return this.JCd()}BSf(){return!1}EGi(){return!1}}Object(w.a)(WG,"TopRowPeripheralControlCreator",null,[1007]);class XG extends WG{constructor(a,c=null,h=null){super(a,c,h)}JCd(){let a=null;l.AFrameworkApplication.xwd&&(a=Object.assign(new sK.a,{label:WoncaIntl.WoncaStrings.L_Share,command:Sa.a.M$a.toString(),image:bk.CuiHelper.Bln,id:bk.CuiHelper.GRf}));return a}}Object(w.a)(XG,"TopRowPeripheralControlCreator",WG,[]);class tK extends XG{constructor(a){super(a,"SharingSet_Start_Glyph_Word_16x16x32");
this.isTeamsSession="teams"===(l.AFrameworkApplication.K.Ga(l.AFrameworkApplication.Wea)||"").toLowerCase();this.Fln=l.AFrameworkApplication.K.$("ShareMenuIsEnabled");this.Mfl=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerCleanupIsEnabled",!1)}JCd(){return l.AFrameworkApplication.vlf&&l.AFrameworkApplication.qgb||l.AFrameworkApplication.j_c?Object.assign(new sK.a,{command:Sa.a.XEb.toString(),label:WordEditorIntl.WordEditorStrings.L_ReplyWithChanges,id:bk.CuiHelper.KYd}):
super.JCd()}BSf(){if(this.isTeamsSession&&(!this.Mfl||!this.Fln))return!1;const a=this.hQk();return a&&a.command===Sa.a.M$a.toString()?!0:!1}EGi(){"teams"===(l.AFrameworkApplication.K.Ga(l.AFrameworkApplication.Wea)||"").toLowerCase()&&l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordCopyLinkButtonForTeamsSettings");const a=l.AFrameworkApplication.K.$("CopyLinkButtonIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.CopyLinkButtonEnabled",
!1),c=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShareMenuEnabled",!1);return!this.isTeamsSession&&(a||c)&&this.BSf()||l.AFrameworkApplication.xwd&&l.AFrameworkApplication.y7g&&l.AFrameworkApplication.K.$("CopyLinkButtonForTeamsIsEnabled")}}Object(w.a)(tK,"TopRowPeripheralControlCreator",XG,[]);class uK extends QG{constructor(a,c,h,v,B,X){super(a,c,h);a=!1;l.AFrameworkApplication.K.$("HidePasteTextOnlyInRibbonChrome")||(a=!v.uhb);this.ooe=l.AFrameworkApplication.K.$("PasteWithOptionsFromRibbon")&&
(H.a.MX||H.a.In&&a);this.Il=B;this.Axe=X}wlk(a,c){const h=new eD(l.AFrameworkApplication.K,this.ga,this.fb,this.ooe),v=new KP.a(h);return this.Vlk(a,c,v,h)}Vlk(a,c,h,v){var B=new YJ(new ZJ(l.AFrameworkApplication.K,v),h);h=this.pBl(B);const X={};B.ohb(X);B=!H.a.MX;const ma=H.a.In||H.a.Qh;var Pa=H.a.qk;l.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(Pa=H.a.sh||Pa);Pa=new EG.a(Pa);a=new rK(a,c,WordEditorIntl.WordEditorStrings,this.omb,v,a,this.Il,h,new UJ(X),new tK(null),this.Axe,
Pa,B,ma,new XJ);a.SBl();return a}pBl(a){const c={};a.lVc(c);a.RZc(c);return new VJ(null,c,"jewelWordEditor")}}Object(w.a)(uK,"WordEditorRibbonUserFactory",QG,[]);class YG{constructor(a,c){this.Kx=a;this.pbd=c}pIa(a,c,h,v=null,B=null){return this.pbd.XFi(a)?this.pbd.pIa(a,c,h,v,B):this.Kx.pIa(a,c,h,v,B)}$za(a,c=null){return this.pbd.XFi(a)?this.pbd.$za(a):this.Kx.$za(a,c)}}Object(w.a)(YG,"RootCuiUser",null,[311]);class vK extends YG{constructor(a,c){super(a,c)}clearCache(){this.Kx.clearCache()}}Object(w.a)(vK,
"WordGeneralCuiUser",YG,[310,311]);class Sx extends gF{constructor(a,c,h){super(a,h);this.YF=c}J4e(a){const c=[],h=$c.a.instance.Ca.Fa,v=!!this.YF&&this.YF.hKc(zb.a.ZOe.toString()),B=!!this.YF&&this.YF.hKc(zb.a.sEb.toString()),X=!v&&!h.n2b&&Sx.G_a.S4h(),ma=!!this.YF&&this.YF.hKc(Sa.a.newComment.toString())||!!ud.a.instance&&(3===ud.a.instance.mode||2===ud.a.instance.mode),Pa=h.sWh()&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EquationToolsIsEnabled",!1),mb=3===a||
H.a.sh||l.AFrameworkApplication.A3e;a=mb&&Sx.GZe.B8(h,a);mb&&c.push(this.Il.NVa("ClipboardGroup")[0].externalUxGroupId);X&&(c.push(this.Il.NVa("TextFormattingGroup")[0].externalUxGroupId),c.push(this.Il.NVa("StylesGroup")[0].externalUxGroupId));v&&c.push(this.Il.NVa("PictureToolsGroup")[0].externalUxGroupId);B&&c.push(this.Il.NVa("TableToolsGroup")[0].externalUxGroupId);Pa&&c.push(this.Il.NVa("EquationToolsGroup")[0].externalUxGroupId);ma&&c.push(this.Il.NVa("CommentGroup")[0].externalUxGroupId);
a&&c.push(this.Il.NVa("ContextMenuGroup")[0].externalUxGroupId);return c}static get GZe(){return Sx.qic||(Sx.qic=xa.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static get G_a(){return Sx.jGa||(Sx.jGa=xa.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static tHc(a,c,h,v){a.uTj(()=>Sx.d9a(c,h,v))}static d9a(a,c,h){return new Sx(a,c,h)}}Sx.qic=null;Sx.jGa=null;Object(w.a)(Sx,"WordReactFloatie",gF,[]);class ZG{constructor(){this.VP=this.Jrc=this.W=null}get name(){return"WordEditor.UI"}init(){var a;
this.W.resolve("WordEditor.UI.BusinessBarController").uDf();const c=Eb.App.wu.wG,h=Eb.App.oa;Sx.tHc(h,this.W.resolve("Common.IReactContextualUILauncher"),c,this.W.resolve("Common.IExternalUICommandDefinitionMapping"));this.VP=this.W.ra("Box4.IContextMenuController");const v=new oJ(h,c,this.W.za("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.PasteFloatieManager")),B={"floatie.gbFormatWithDesignerButton":!0,"floatie.gbMatchDocumentFormattingButton":!0,"floatie.gbUseSmartPasteButton":!0};switch(null===
(a=l.AFrameworkApplication.K)||void 0===a?void 0:a.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:B["floatie.gbFormatWithDesignerButton"]=!1;break;case 2:B["floatie.gbMatchDocumentFormattingButton"]=!1;break;case 3:B["floatie.gbUseSmartPasteButton"]=!1}v.tHc("PasteFloatieData",null,B);this.W.resolve("WordEditor.UI.CuiActionBridge").initialize();(new LJ(h,c,this.W.za("Box4.IGeneralCuiUser"),this.W.resolve("Box4.UI.ExternalContentFloatieManager"))).tHc("ExternalContentFloatieData",
[WordEditorIntl.WordEditorStrings],{});this.W.resolve("Box4.IGeneralCuiUser");ck.a.get_instance().Vk(7,()=>{this.Jrc=this.W.resolve("WordEditor.UI.StatusBarUser");this.Jrc.eb()})}dispose(){this.Jrc&&(this.Jrc.dispose(),this.Jrc=null);this.VP&&(this.VP.dispose(),this.VP=null)}yb(a){this.W=a;a.ha("WordEditor.UI.BusinessBarController",()=>new sJ(a.resolve("CommonUI.IBusinessBar"),a.resolve("CommonUI.IBusinessBarEntryFactory"),l.AFrameworkApplication.pa,l.AFrameworkApplication.K)).as("WordEditor.IBusinessBarController").as("Wonca.IBusinessBarController").as("Box4.IBusinessBarController").singleInstance();
let c=H.a.qk;l.AFrameworkApplication.K.$("CcpFixIPadShortcutStringsIsEnabled")&&(c=H.a.sh||c);a.ha("Box4.UI.ShortcutHintMapping",()=>new EG.a(c));const h=H.a.In||H.a.Qh,v=l.AFrameworkApplication.K.$("PasteWithOptionsFromContextMenu")&&(H.a.MX||h),B=l.AFrameworkApplication.K.$("CatchUpActivityIsEnabled");a.ha("Box4.UI.AugLoopProofingErrorDetailHelper",()=>new Js.a(xa.a.instance.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),xa.a.instance.resolve("Box4.Intent.IIntentRangeEditor"))).singleInstance();
a.ha("WordEditor.UI.EditSurfaceContextMenu",()=>new mn(l.AFrameworkApplication.pa,a.resolve("Box4.UI.IProofingContextMenuSectionFactory"),a.resolve("Box4.Proofing.IErrorRangeEditor"),l.AFrameworkApplication.K,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,B?a.za("WordEditor.CatchUpActivity.ActivityAnnouncementManager").instance:null,a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.ILanguageReader"),
a.ra("Box4.Intent.IIntentRangeEditor"),a.resolve("Box4.DictationCorrections.IDictationCorrectionContextMenuManager"),a.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),a.za("Box4.IPresenceDataManager"),a.za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),a.za("WordEditor.ContextualSearch.ISearchSuggestionManager"),a.resolve("WordEditor.DocumentUnderstanding.RLM.IDesignerRoleReader"),a.resolve("WordEditor.Designer.IDesignerControl"),a.resolve("WordEditor.Bookmark.FullBookmarkManager"),
v,h?a.resolve("Box4.UI.ShortcutHintMapping"):null,xa.a.instance.za("Common.IActionContextProvider"),xa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"),a.resolve("Box4.IParagraphReader"),a.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"))).as("Box4.UI.AEditSurfaceContextMenu").singleInstance();a.ha("Box4.ISelectionContextMenuProvider",()=>new Qx).singleInstance();a.ha("WordEditor.UI.CuiActionBridge",()=>new ll(l.AFrameworkApplication.K)).as("Box4.UI.CuiActionBridge").singleInstance();
a.ha("WordEditor.UI.DialogFactory",()=>new KJ).as("WordEditor.UI.IDialogFactory").as("Box4.UI.IBox4DialogFactory").singleInstance();a.ha("Common.NonCanvasCuiUser",()=>new QI(nc.FocusManager.instance())).as("Common.INonCanvasCuiUser").singleInstance();a.ha("WordEditor.UI.WordGeneralCuiUser",()=>new vK(a.resolve("Box4.IGeneralCuiUser"),a.resolve("Common.INonCanvasCuiUser"))).singleInstance();a.resolve("WordEditor.UI.WordGeneralCuiUser");a.ha("WordEditor.UI.StatusBarUser",()=>new PJ(Eb.App.oa.oVf,a.za("Box4.IGeneralCuiUser"),
a.resolve("Box4.IFeatureHelper"),l.AFrameworkApplication.pa,l.AFrameworkApplication.K,Eb.App.oa)).as("WordEditor.IStatusBarUser").singleInstance();a.ha("WordEditor.IWordEditorNavigationPaneContextMenu",()=>new kE).singleInstance();const X=a.resolve("WordEditor.UI.WordGeneralCuiUser");a.ha("CommandUI.ReactRibbonRoot",()=>new dF(ek.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),X)).singleInstance();const ma=a.za("WordEditor.UI.WordGeneralCuiUser");a.ha("WordEditor.UI.WordEditorRibbonUserFactory",
()=>new uK(ma,l.AFrameworkApplication.pa,nc.FocusManager.instance(),a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("CommandUI.ReactRibbonRoot"))).as("Wonca.IRibbonUserFactory").singleInstance();a.ha("WordEditor.UI.ReactLanguageDialog",()=>new nE(a.resolve("Box4.UI.ILanguageEditor"),a.resolve("Box4.UI.ILanguageListHelper"))).as("Box4.UI.ILanguageDialog");a.ha("WordEditor.UI.WordEditorRibbonSQMInformation",()=>new TJ(l.AFrameworkApplication.pa)).as("Common.IRibbonSQMInformation").singleInstance();
a.ha("WordEditor.UI.WordEditorFileMenuSQMInformation",()=>new RJ(l.AFrameworkApplication.pa)).as("Common.IFileMenuSQMInformation").singleInstance();a.ha("WordEditor.UI.RulerUser",()=>new MJ).as("WordEditor.IRulerUser");a.ha("WordEditor.UI.RulerContextMenu",()=>new AA(l.AFrameworkApplication.pa,xa.a.instance.za("Common.IZoomManager"),yr.a.instance)).as("WordEditor.IRulerContextMenu").singleInstance();a.ha("Common.IReactContextualUILauncher",()=>new kJ(a.resolve("CommandUI.ReactRibbonRoot"),a.resolve("Common.IExternalUICommandDefinitionMapping"))).singleInstance();
a.ha("Box4.IContextMenuController",()=>new pJ(a.resolve("Common.IReactContextualUILauncher"))).singleInstance()}static main(){Vg.instance.fhh();Vg.instance.l_e();M.a.instance.Lb(new ZG,6)}}Object(w.a)(ZG,"WordEditorUIPackage",null,[1,2]);var SP=window.ExternalContentFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"WordEditor.ExternalContentFloatie",ImageDownArrow:"IMGMAP@we@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@we@SplitButtonArrow_8x8x32",
TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"ExternalContentOptionsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ExternalContentFloatie.FlyoutAnchor",LabelText:"STR@L_DisplayAs",Image16by16:"IMAGEPATH@DisplayAs.png",Alt:"STR@L_DisplayAs",DisplayMode:"Medium",TemplateAlias:"ExternalContent"},children:[{name:"Menu",attrs:{Id:"menuPasteOptions"},
children:[{name:"MenuSection",attrs:{Id:"floatie.msExternalContentOptionsButtons",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"floatie.galleryPasteOptionsButtons"},children:[{name:"ToggleButton",attrs:{Id:"floatie.gbPasteKeepSourceButton",Command:"0xE188C0F7",QueryCommand:"0xD46B64BD",Image16by16:"IMAGEPATH@EmbeddedContent.png",Alt:"STR@L_EmbeddedContent",LabelText:"STR@L_EmbeddedContent"}},{name:"ToggleButton",attrs:{Id:"floatie.gbPasteTextOnlyButton",Command:"0xE36ACF00",QueryCommand:"0xB5FF507C",
Image16by16:"IMGMAP@we@WebInsertHyperlink_16x16x32",Alt:"STR@L_Hyperlink",LabelText:"STR@L_Hyperlink"}}]}]}]}]}]}]}]}]}]}]}]},vB={};vB.Xdc=function(){function a(){return ma()&&(Ie()||3<=(Tc()?Xe("version/"):0))}function c(){return 0<=window.navigator.userAgent.indexOf("Windows")}function h(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function v(kf){kf=(new RegExp(kf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var kh=-1;null!=kf&&2<=kf.length&&(kh=parseFloat(kf[1]),
isNaN(kh)&&(kh=-1));return kh}function B(){wK||(wK=!0,xK=v("Windows Phone"));return 8<=xK}function X(){return"function"==typeof navigator.msLaunchUri&&!h()&&!ee()&&!Pa()}function ma(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function Pa(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function mb(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Tb(){return mb()?8==window.document.documentMode:!1}function rc(){return 0<=
window.navigator.userAgent.indexOf(" Firefox/")}function Tc(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function vd(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function ee(){var kf=window.navigator.userAgent.toLowerCase();return 0<=kf.indexOf("android")&&0<=kf.indexOf("chrome")}function Ie(){return 3<=(rc()?Xe("firefox/"):0)}function Xe(kf){var kh=window.navigator.userAgent.toLowerCase(),Ok=kh.indexOf(kf);return 0<=Ok?parseInt(kh.substring(Ok+kf.length,
kh.length)):0}function Yf(kf,kh,Ok,hk,sp){if(hk&&null!=kh)kh();else if(X())navigator.msLaunchUri(kf,kh,Ok);else if(!(vd()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&ma())||Pa())Fi(kf,kh,Ok);else if(vd()&&sp)a:{try{window.open(kf,"_self")}catch(Ur){null!=Ok&&Ok();break a}null!=kh&&kh()}else Hh(kf,kh,Ok)}function Hh(kf,kh,Ok){var hk=document.getElementById("OICLinkTag");null==hk&&(hk=document.createElement("a"),hk.id=
"OICLinkTag",hk.style.visibility="hidden",hk.href="",0==($p.Options&ow.SupportsTopTargetNavigation)||$p.NoBrowserModalDialogs?hk.target="_blank":hk.target="_top",document.body.appendChild(hk),null!=hk.addEventListener&&hk.addEventListener("click",function(sp){null!=sp.stopPropagation&&sp.stopPropagation()},!1));try{hk.href=kf,hk.click()}catch(sp){null!=Ok&&Ok();return}null!=kh&&kh()}function Fi(kf,kh,Ok){var hk=document.getElementById("OICFrame");null==hk&&(hk=document.createElement("iframe"),hk.className=
"ObjectInDialog",hk.style.visibility="hidden",hk.src="about:blank",document.body.appendChild(hk),hk.id="OICFrame");try{hk.contentWindow.location.href=kf}catch(sp){null!=Ok&&Ok();return}null!=kh&&kh()}function wk(kf){return 0!=(kf.Options&ow.SkipProtocolHandler)||Tb()}function Gk(kf){return kf===wB.ReadOnly||kf===wB.ReadWrite}function Kl(kf,kh,Ok,hk){var sp;try{var Ur=new ActiveXObject("SharePoint.OpenDocuments.4");return(sp=Ur.ViewDocument3(window.self,kf,kh,hk))?(hD(Jz.O14ActiveX),hp.None):hp.Failed}catch(Vr){}if(ow.O14Only===
(Ok&ow.O14Only))return $p.DescriptiveUnattemptedEnums?hp.O14AttemptFailure:hp.Unattempted;try{return Ur=new ActiveXObject("SharePoint.OpenDocuments.3"),(sp=Ur.ViewDocument3(window.self,kf,kh,hk))?(hD(Jz.O12ActiveX),hp.None):hp.Failed}catch(Vr){}if(ow.O12UpOnly===(Ok&ow.O12UpOnly))return $p.DescriptiveUnattemptedEnums?hp.O12UpOnlyFail:hp.Unattempted;try{return Ur=new ActiveXObject("SharePoint.OpenDocuments.2"),(sp=Gk(kh)?Ur.ViewDocument2(window.self,kf,hk):Ur.EditDocument2(window.self,kf,hk))?(hD(Jz.O11ActiveX),
hp.None):hp.Failed}catch(Vr){}return $p.DescriptiveUnattemptedEnums?hp.ActiveXUnattempted:hp.Unattempted}function Yj(kf,kh,Ok,hk,sp){kf==Yq.Visio&&Ok==wB.ReadWrite&&(Ok=wB.WriteOnly);kf=sp;hk=hk||h()&&!B();hk||(hk="",hk=Gk(Ok)?hk+"ofv|ofc|":hk+"ofe|",kf+=oq(hk+"u|"));kf+=oq(kh);$p.NewTelemetryDataIsEnabled&&(kh=-1!==kf.indexOf("?")?"&":"?",kh+=$p.SessionOrigin?"OR="+$p.SessionOrigin+"&":"",kh+=$p.ClickTime?"CT="+$p.ClickTime+"&":"",kh+=$p.CorrelationId?"CID="+$p.CorrelationId:"",kh="?"!=kh?kh:"",
kh="&"!=kh.slice(-1)?kh:kh.slice(0,-1),kf+=oq(kh));kh=window.location.href;Ok=kh.toLowerCase().indexOf("&wdlor=");-1!=Ok?(Ok+=7,hk=kh.indexOf("&",Ok),kh=-1==hk?kh.substr(Ok):kh.substring(Ok,hk)):kh=void 0;if(null!=kh&&"undefined"!=typeof kh){Ok="";try{Ok=decodeURIComponent(kh)}catch(Ur){}0<Ok.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Ok)&&(kf=kf+"|f|"+Ok)}return kf}function ao(kf,kh,Ok,hk,sp,Ur){var Vr=yK(kf);if(null==Vr)return nC($p.DescriptiveUnattemptedEnums?hp.ProtocolHandlerIsNull:
hp.Unattempted,$p.Application),!1;kf=Yj(kf,kh,Ok,hk,Vr);Yf(kf,to,zt,sp,Ur);return!0}function oq(kf){if(ma()&&vd()){var kh="";try{kh=decodeURI(kf)}catch(Ok){}if(kh==kf)return encodeURI(kf)}return kf}function to(){hD(Jz.ProtocolHandler)}function zt(){$p.Options|=ow.SkipProtocolHandler;zK($p,iD,jD)}function Wq(){null!=$G&&$G(Jz.RoamingProtocolHandler)}function Ys(){null!=aH&&aH(hp.ControlNeeded)}function Wr(){var kf=document.getElementById("npSharePointPlugin");if(null==kf){kf="application/x-sharepoint";
ma()&&3<=(Tc()?Xe("version/"):0)&&pw("application/x-sharepoint-webkit",!0)&&(kf="application/x-sharepoint-webkit");if(!pw(kf,!0))if(ma()&&pw("application/officelive",!0))kf="application/officelive";else return null;var kh=document.createElement("object");kh.id="npSharePointPlugin";kh.type=kf;kh.style.width="0px";kh.style.height="0px";kh.style.setProperty("visibility","hidden","");document.body.appendChild(kh);kf=document.getElementById("npSharePointPlugin")}return kf}function pw(kf,kh){var Ok=window.navigator.mimeTypes;
if(null==Ok)return!1;kf=Ok[kf];return!kf||kh&&!kf.enabledPlugin?!1:!0}function kD(kf){try{if(null!=new ActiveXObject(kf))return!0}catch(kh){}return!1}function bH(kf){switch(kf){case Yq.OneNote:return"OneNote.Notebook";default:return""}}function yK(kf){if(kf!=Yq.OneNote&&h()&&!B())return"office:";switch(kf){case Yq.Excel:return"ms-excel:";case Yq.OneNote:return"onenote:";case Yq.PowerPoint:return"ms-powerpoint:";case Yq.Visio:return"ms-visio:";case Yq.Word:return"ms-word:";case Yq.Project:return"ms-project:";
case Yq.Publisher:return"ms-publisher:";case Yq.Infopath:return"ms-infopath:";case Yq.Access:return"ms-access:";default:return""}}function TP(kf){switch(kf){case Yq.Excel:return"root\\office15\\excel.exe";case Yq.PowerPoint:return"root\\office15\\powerpnt.exe";case Yq.Visio:return"root\\office15\\visio.exe";case Yq.Word:return"root\\office15\\winword.exe";case Yq.Project:return"root\\office15\\winproj.exe";case Yq.Publisher:return"root\\office15\\mspub.exe";case Yq.Infopath:return"root\\office15\\infopath.exe";
case Yq.Access:return"root\\office15\\msaccess.exe";default:return null}}function zK(kf,kh,Ok){$p=kf;iD=kh;jD=Ok;if(kf.DocumentUrl){var hk=Ok=kh=kf.DocumentUrl;try{hk=decodeURIComponent(kf.DocumentUrl)}catch(lD){}try{Ok=encodeURI(kf.DocumentUrl)}catch(lD){}kh=kh+""+kf.CorrelationIdForWinClient;hk+=kf.CorrelationIdForWinClient;Ok+=kf.CorrelationIdForWinClient;kf.Mode===wB.ReadWrite&&ow.CheckoutRequired===(kf.Options&ow.CheckoutRequired)&&(kf.Mode=wB.ForceCheckout);ow.HostIsEditOnly===(kf.Options&ow.HostIsEditOnly)&&
(kf.Mode=wB.WriteOnly);if(wk(kf)?0:ma()&&(kf.Application==Yq.OneNote||pw("application/x-sharepoint-protocolhandler",!1)||pw("application/x-sharepoint-webkit-protocolhandler",!1))||X()||ee()||!(a()||Ie()||"ActiveXObject"in window&&!h()||vd())||15<=uF())ao(kf.Application,kf.EncodeUrl?Ok:kh,kf.Mode,kf.Application==Yq.OneNote,kf.SilentExternalHandler,kf.NavigateUsingWindowOpen);else{var sp;if(sp=Tb())a:{var Ur=kf.EncodeUrl?kh:hk,Vr=kf.Mode,rE=bH(kf.Application);try{sp=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,
Ur,Vr,rE);break a}catch(lD){}sp=!1}if(sp)hD(Jz.O15ActiveX);else{if(a()||Ie()){var Hs=kf.EncodeUrl?kh:hk;hk=kf.Mode;sp=bH(kf.Application);Ur=Wr();if(null==Ur)Hs=$p.DescriptiveUnattemptedEnums?hp.PluginIsNull:hp.Unattempted;else{Vr=!1;try{Vr=Ur.ViewDocument3(window.self,Hs,hk,sp)}catch(lD){}if(!Vr)try{Vr=Gk(hk)?Ur.ViewDocument2(window.self,Hs,sp):Ur.EditDocument2(window.self,Hs,sp)}catch(lD){}Vr?(hD(Jz.NpapiPlugin),Hs=hp.None):Hs=hp.Failed}}else{try{Hs=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=Hs&&
Hs.SaveSSOCreds()}catch(lD){}Hs=Kl(kf.EncodeUrl?kh:hk,kf.Mode,kf.Options,bH(kf.Application))}if(Hs!=hp.None){if(hk=kf.CouldUseRoamingApps)AK||(AK=!0,BK=v("Windows NT")),hk=6.1<=BK&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(mb()||Ie()||vd());if(hk&&kf.Application!=Yq.OneNote){if(!vB.Xdc.Q_n()){nC(hp.ControlNeeded,$p.Application);return}if(kf.RoamingAppsLauncher){"undefined"==typeof kf.RoamingAppsLauncher||null==kf.RoamingAppsLauncher?nC($p.DescriptiveUnattemptedEnums?hp.RoamingLauncherIsNull:
hp.Unattempted,$p.Application):"undefined"==typeof kf.RoamingBitsUrl||null==kf.RoamingBitsUrl?vB.Xdc.S0n(kf.DocumentUrl,kf.RoamingAppsLauncher,kf.Application,kf.ApplicationParameters,iD,jD):vB.Xdc.o2i(kf.DocumentUrl,kf.RoamingAppsLauncher,kf.RoamingApplicationExe,kf.ApplicationParameters,kf.RoamingPlatform,kf.RoamingBitsUrl,iD,jD);return}if(!kf.ContinueIfLauncherIsNull){nC(hp.LauncherNeeded,$p.Application);return}}ow.NoProtocolHandlerFallback==(kf.Options&ow.NoProtocolHandlerFallback)||wk(kf)||mb()||
ma()&&!($p.DescriptiveUnattemptedEnums?Hs>=hp.O14Unattempted&&Hs<=hp.DocumentUrlIsNull:Hs==hp.Unattempted)?nC(Hs,$p.Application):ao(kf.Application,kf.EncodeUrl?Ok:kh,kf.Mode,kf.Application==Yq.OneNote,kf.SilentExternalHandler,kf.NavigateUsingWindowOpen)}}}}else nC($p.DescriptiveUnattemptedEnums?hp.DocumentUrlIsNull:hp.Unattempted,$p.Application)}function hD(kf){null!=iD&&iD(kf)}function nC(kf,kh){"undefined"==typeof kh&&(kh=null);null!=jD&&jD(kf,kh)}function uF(){var kf=0;if(a()||Ie()||vd()){var kh=
Wr();try{null!=kh&&(kf=kh.GetOfficeVersion())}catch(Ok){}}else kD("SharePoint.OpenDocuments.5")?kf=15:kD("SharePoint.OpenDocuments.4")?kf=14:kD("SharePoint.OpenDocuments.3")?kf=12:kD("SharePoint.OpenDocuments.2")&&(kf=11);return kf}function CK(){return ma()&&(pw("application/x-sharepoint",!0)||pw("application/x-sharepoint-webkit",!0))}var DK="",EK="",FK="",iD,jD,$G,aH,$p,AK,BK,wK,xK,wB={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},ow={None:0,CheckoutRequired:1,
O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},hp={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},Jz={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,
RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Yq={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:wB,OpenDocumentOptions:ow,OpenDocumentFailureType:hp,OpenDocumentControl:Jz,OfficeApplication:Yq,EditDocumentInClient:zK,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=Yq.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=
!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:uF,IsO14MacPluginInstalled:CK,OfferOfficeInDialog:function(){return c()&&11>=uF()},OfferOfficeNoIntrusive:function(){return c()&&
15>uF()},OfferMacOffice:function(){return ma()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!CK()},InstallRoamingControl:function(){rc()?window.InstallTrigger.install({Office:{URL:EK}}):Fi(FK,null,null)},CanUseRoamingControl:function(){if(X())return!0;if(vd())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(rc()){var kf=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(kf);
var kh=document.createEvent("Events");kh.initEvent("RoamingOfficeInstalled",!0,!1);kf.dispatchEvent(kh);return!!kf.getAttribute("installed")}if(mb())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Ok){}return!1},InitUrls:function(kf,kh,Ok){DK=kf;EK=Ok;FK=kh},LaunchRoamingApps:function(kf,kh,Ok,hk,sp,Ur){vB.Xdc.o2i(kf,kh,TP(Ok),hk,"x86",DK,sp,Ur)},LaunchRoamingApps2:function(kf,kh,Ok,hk,sp,Ur,Vr,rE){var Hs="";null!=hk&&(Hs+=" "+hk);null!=kf&&(Hs+=' "'+kf+'"');if(X()||
vd())$G=Vr,aH=rE,Vr='office: "'+(Ur+'" "')+(Ok+'" "ROAMING"'),Vr+=' "'+kh+'"',Vr+=' "'+sp+'"',Vr+=" "+Hs,Yf(Vr,Wq,Ys,!1,!1);else if(rc())kf=document.createElement("RoamingExtensionElement"),kf.setAttribute("cabUrl",Ur),kf.setAttribute("app",Ok),kf.setAttribute("licensingEntitlements",kh),kf.setAttribute("platform",sp),kf.setAttribute("args",Hs),document.documentElement.appendChild(kf),kh=document.createEvent("Events"),kh.initEvent("RoamingOfficeLaunch",!0,!1),kf.dispatchEvent(kh),null!=Vr&&Vr(Jz.RoamingFFExtension);
else if(mb()){if(kf=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=kf)try{kf.HrConfigureSingle(Ur,Ok,kh,sp,Hs),null!=Vr&&Vr(Jz.RoamingActiveX)}catch(lD){}}else null!=rE&&rE(hp.Failed)},ShouldShowDialog:function(){return!h()},NavigateToUrlUsingClickingOnATag:Hh,OpenDocumentWithProtocolHandler:ao,OpenDocumentWithProtocolHandlerNoCallBack:function(kf,kh,Ok,hk){var sp=yK(kf);if(null==sp)return nC($p.DescriptiveUnattemptedEnums?hp.ProtocolHandlerNoCallbackIsNull:hp.Unattempted,$p.Application),
!1;kf=Yj(kf,kh,Ok,hk,sp);Yf(kf,null,null,!1,!1);return!0}}}();vB.ClientUtils=vB.Xdc;var UP=b(1285);class vF{constructor(a,c,h){this.ga=a;this.Djj=c;this.I2=h}eb(){this.ga.ka(Sa.a.tryMacOffice,Kc.a.frame,Object(m.a)(this,this.fum,"onTryMacOffice"));this.ga.ka(Sa.a.vRi,Kc.a.frame,Object(m.a)(this,this.Udi,"onTryMacOfficeFromViewer"));this.ga.ka(Sa.a.uRi,Kc.a.frame,Object(m.a)(this,this.Udi,"onTryMacOfficeFromViewer"))}fum(a,c,h,v,B){if(1===h)return 32;B?(a=B.SourceControlId,"btnjTryMacOfficeForWordEditor"===
a?Ve.a.Ql(Af.a.LVa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===a&&Ve.a.Ql(Af.a.LVa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.IZh();return 32}Udi(a,c,h){if(1===h)return 32;switch(a){case Sa.a.vRi:Ve.a.Ql(Af.a.LVa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Sa.a.uRi:Ve.a.Ql(Af.a.LVa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}IZh(){Ve.a.Ql(vF.V9l,"_blank",void 0,"LaunchMacTrialWindow")}get gWc(){return this.Djj&&
H.a.qk&&!H.a.alf&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get Nnn(){const a=this.gWc;a||l.AFrameworkApplication.$k.Zbn();return a}get Mnn(){return this.gWc}static get V9l(){return Af.a.Y3("522401")}}Object(w.a)(vF,"MacOfficeOffer",null,[966]);class wF{constructor(a,c,h){this.ga=a;this.Hjj=c;this.EP=null;(this.ljd=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&xa.a.instance.za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(v=>
{this.EP=v});this.I2=h}eb(){this.ga.ka(Sa.a.tryOffice,Kc.a.frame,Object(m.a)(this,this.gum,"onTryOffice"));this.ga.ka(Sa.a.GZf,Kc.a.frame,Object(m.a)(this,this.GZf,"tryOfficeThroughTellMe"));this.ga.ka(Sa.a.ARi,Kc.a.frame,Object(m.a)(this,this.BRi,"tryOfficeThroughViewer"));this.ga.ka(Sa.a.zRi,Kc.a.frame,Object(m.a)(this,this.BRi,"tryOfficeThroughViewer"))}gum(a,c,h,v,B){if(this.ljd&&1===h)return this.isFreemiumUpsellEnabled&&this.hWc?32:8;2===h&&(B?(a=B.SourceControlId,"btnjTryOfficeForWordEditor"===
a?Ve.a.Ql(Af.a.LVa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===a?Ve.a.Ql(Af.a.LVa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.dof()):this.dof());return 32}GZf(a,c,h,v,B){if(this.ljd&&1===h)return this.isFreemiumUpsellEnabled&&this.hWc?32:8;2===h&&(B?(a=B.SourceControlId,Ve.a.Ql(Af.a.Y3("862405")+this.gal(a),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Ve.a.Ql(Af.a.Y3("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));
return 32}BRi(a,c,h){if(this.ljd&&1===h)return this.isFreemiumUpsellEnabled&&this.hWc?32:8;if(2===h)switch(a){case Sa.a.ARi:Ve.a.Ql(Af.a.LVa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Sa.a.zRi:Ve.a.Ql(Af.a.LVa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get rjm(){return this.hWc}get qjm(){return this.hWc&&MSOJS.ClientUtils.OfferOfficeInDialog()}get hWc(){return this.Hjj&&!H.a.qk}get isFreemiumUpsellEnabled(){let a=!1;this.EP&&(a=this.EP.isFreemiumUpsellEnabled());
return a}dof(a=null){let c=0;a&&(c=a);Ve.a.Ql(wF.x5k(c),"_blank",void 0,"LaunchOfficeOffer")}gal(a){let c=0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":c=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":c=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":c=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":c=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":c=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":c=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":c=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":c=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":c=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":c=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":c=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":c=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":c=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":c=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":c=20;break;
case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":c=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":c=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":c=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":c=29}return 0===c?"":String.format("&pc={0:D}",c)}static x5k(a){if(H.a.sh)switch(a){case 1:return Af.a.Y3("393806");case 2:return Af.a.Y3("393810");case 3:return Af.a.Y3("393809");case 5:return Af.a.Y3("393805")}else if(H.a.mK)switch(a){case 1:return Af.a.Y3("521979");
case 3:return Af.a.Y3("521980");case 5:return Af.a.Y3("521978");case 2:return Af.a.Y3("522490")}else{if(2===a)return Af.a.Y3("517778");if(1===a)return Af.a.LVa(30)}return Af.a.Y3("522402")}}Object(w.a)(wF,"OfficeTrialExperience",null,[965]);class GK{yb(a){a.register(wF,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").singleInstance().Pc(()=>new wF(l.AFrameworkApplication.pa,l.AFrameworkApplication.Ckf,l.AFrameworkApplication.lcid));a.register(vF,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").singleInstance().Pc(()=>
new vF(l.AFrameworkApplication.pa,l.AFrameworkApplication.XTh,l.AFrameworkApplication.lcid))}}Object(w.a)(GK,"OpenInClientConfiguration",null,[2]);var VP=b(1028);class Py{constructor(a,c,h,v,B,X,ma){this.Sf=a;this.characterPropertiesEditor=c;this.z_=h;this.j1e=v;this.Xj=B;this.hd=X;this.oJa=ma}eDl(a,c){var h;a=c.view;c=c.lm;if(!c||!this.Sf.TRh(c,!0)||this.j1e&&this.j1e.instance&&this.j1e.instance.JR(c))return 2;var v=Py.p$?!Py.jK.yja(c):!0;this.z_&&v&&this.z_.Occ(c.node,vb.a.Nq,c.cpBegin);v=c.node;
(null===(h=this.oJa)||void 0===h?0:h.replaceText)&&this.oJa.Vcb(v)?this.oJa.replaceText(v,c.cpBegin,c.cpBegin,Ps.a.NLc):this.characterPropertiesEditor.Lca(c,B=>new Ps.a(B));if(this.hd.Bf){h=new gf.GraphTransaction(15);try{h.Oa(c.node),this.Xj.rla(c.node,c.cpBegin,c.cpBegin+1,1)}finally{h&&h.dispose()}}v=c.node;h=c.cpEnd+1;" "===sd.ParagraphReader.text(v).charAt(h)&&(v=Oe.a.createTextRange(v,h,h+1),this.characterPropertiesEditor.replaceTextRange(v,"\u00a0"));c=Oe.a.Sb(c.node,h);a.Ma.setSelection(ne.SelectionFactory.yn(c));
return 32}static get jK(){return Py.sT||(Py.sT=xa.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get p$(){null==Py.c_&&(Py.c_=l.AFrameworkApplication.K?l.AFrameworkApplication.K.$("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Py.c_}}Py.sT=null;Py.c_=null;Object(w.a)(Py,"InsertLineBreakStrategy",null,[]);class zu{static get Wf(){return zu.Vd||(zu.Vd=xa.a.instance.resolve("Box4.IOutlineElementEditor"))}static get uf(){return Nm.ContextSetEditor.instance}static get Xj(){return zu.rf||(zu.rf=
xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get hd(){return zu.Bb||(zu.Bb=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static BDl(a,c,h,v,B){if(B&&B.hasProperty(Uc.a.targetObject)){var X=c.view.sc.Mb.Ra(B.getValue(Uc.a.targetObject));X=Oe.a.create(X)}else X=zu.uf.RQ(c.lm,11);if(!X)return 8;a=l.AFrameworkApplication.pa.Le(X,a,h,!0,v,B);if(32===a&&2===h){if(!c.view.Cd)return 2;c=c.view;v=c.Ma.If;if(v=zu.uf.RQ(v,11)){h=new Yk.a;
h.set(v.node);h.nc();if(B&&B.hasProperty(Uc.a.targetObject))for(B=B.pg(Uc.a.targetObject);!h.currentNode.id.equals(B)&&h.ob()&&(ie.OutlineElementNavigator.Wc(h),11===h.Md););ie.OutlineElementNavigator.J4(h,!1,!1);B=Gc.SelectionEditor.hya(h,!0);B=sd.ParagraphReader.xu(B)?ne.SelectionFactory.vd(B,0):ne.SelectionFactory.fq(B);c.Ma.setSelection(B)}}return a}static LGd(a,c,h,v,B){a=a===zb.a.NHc;c=c.node;if(B&&B.hasProperty(Uc.a.targetObject)&&!c.id.equals(B.pg(Uc.a.targetObject)))return 2;if(1===h)return 32;
h=new Kd.GraphIterator;h.set(c);h.La(10);zu.Wf.bA(h,a,!0);zu.hd.Bf&&(h=ie.OutlineElementNavigator.Fd(h),zu.Xj.oGb(h,1));return 32}}zu.Vd=null;zu.rf=null;zu.Bb=null;Object(w.a)(zu,"InsertOutlineElementStrategy",null,[]);class Kz{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){this.Bz=c;this.kdj=a;this.Xm=X;this.Un=B;this.Vd=h;this.gbj=v;this.Gm=ma;this.ya=Pa;this.LA=mb;this.Ogc=Tb}Igm(a,c,h,v,B){if(!c.view.Cd)return 2;c=c.view;let X=null;c.Rh&&(X=c);const ma=c.Ma.If;var Pa=!0;let mb=!1,Tb=null;if(!ma)return 2;
const rc=new gf.GraphTransaction(15);rc.Oa(c.sc);let Tc=null;2===h&&(Tc=new Yk.a,Tc.set(ma.node),Tc.nc(),Tb=new Cw.a(Tc),ie.OutlineElementNavigator.Wc(Tc),Pa=Ta.OutlineElementReader.isEmpty(Tc,!1),{iGi:Pa,aZi:mb}=this.gbj.jGi(Tc,Pa,Vn.a.uxb,-1,ma));a=l.AFrameworkApplication.pa.Le(ma,a,h,!1,v,B);Pa&&32===a&&2===h&&(mb||ie.OutlineElementNavigator.yAa(Tc,!1,!Gc.SelectionEditor.ke(ma),!1),mb&&Tb&&Tb.restore(Tc),this.Xm.freeze(),(h=ne.SelectionFactory.en(Tc.currentNode,!0))||r.ULS.sendTraceTag(591958035,
324,15,"could not create selection for NewLineView."),c.Ma.setSelection(h),this.Xm.vCa(),this.kdj.ji.ZD());X&&(Pa||X.oea(),X.editingView&&X.FI&&(X.editingView.NF=!0));bu.GrippersManager.instance.PIb(1);rc.dispose();return a}hA(a,c,h){a=!1;if(dd.ImageReader.S8(c)||dd.ImageReader.nXa(c))c=this.Xdk(c),a=!0;const v=c;if((c=Gc.SelectionEditor.ke(c))&&this.Gm.ag&&!this.Gm.AOl(v))return 2;if(1===h)return 32;const B=v.node,X=new Kd.GraphIterator;X.set(B);X.nc();ie.OutlineElementNavigator.Wc(X);h=new gf.GraphTransaction(15);
h.Lr(X);c?(this.Ogc.instance&&this.Ogc.instance.LCa(v),sd.ParagraphReader.tb(B)&&v.cpBegin===sd.ParagraphReader.textLength(B)&&ac.m(v)&&9===sd.ParagraphReader.bWa(B)&&this.Xm.Qek(v),this.Un.jQf(X,!0,v,B),Kz.Dc&&Kz.Dc.NXa&&ab.ListReader.Pg(X)&&!Ta.OutlineElementReader.isEmpty(X,!1)&&(c=sd.ParagraphReader.Bl(X.currentNode))&&c.la&&!c.la.last.formatting&&Kz.characterPropertiesEditor.jIa(c),this.Bz&&this.Bz.Occ(B,vb.a.Nq,v.cpBegin),a&&(ie.OutlineElementNavigator.Ir(X,!1,!1),a=X.Za(2),(a=this.LA.vd(a,
0))&&this.ya.setSelection(a))):this.Vd.bA(X,!0,!0);h.dispose();Eb.App.oa&&Eb.App.oa.updateCommandUI();return 32}Xdk(a){if(dd.ImageReader.S8(a))var c=Oe.a.Sb(a.node,a.cpBegin);else{c=sd.ParagraphReader.VN(a.node);var h=c.properties.pg(Yb.a.yp);a=a.node.properties.getValue(Yb.a.runId);h=Kz.C6e(a,h,c.la);c=Oe.a.Sb(c,h)}return c}static get characterPropertiesEditor(){return Kz.Tb||(Kz.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Dc(){return As.a.getInstance()}static l2e(a,c){let h=
0;for(;h<c.length&&!(a<c[h]);)h++;return h}static C6e(a,c,h){let v=0;a=Kz.l2e(a,c);let B=0;if(a===c.length)B=h.length-1;else for(;B<h.length;){c=h.J(B);if(c.formatting&&c.formatting.zd===a)break;B++}B<h.length&&(v=h.J(B).cp);return v}}Kz.Tb=null;Object(w.a)(Kz,"NewLineStrategy",null,[]);class oC{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe){this.Xi=null;this.Tga=a;this.v5c=ma;this.hbd=new Kz(this,c,h,v,B,X,Pa,rc,Tc,Ie);this.tng=new Py(Pa,mb,c,Tb,vd,ee,Xe)}get ji(){return this.Xi||(this.Xi=
this.Tga())}eb(){const a=l.AFrameworkApplication.pa,c=Object(m.a)(this.hbd,this.hbd.hA,"newLine");a.Aa(zb.a.enter,ic.a.view,Object(m.a)(this.v5c.value,this.v5c.value.TCk,"enterView"),1124);a.Aa(zb.a.qFi,ic.a.view,Object(m.a)(this.v5c.value,this.v5c.value.Zln,"shiftEnterView"),1124);a.ka(zb.a.hA,ic.a.view,Object(m.a)(this.hbd,this.hbd.Igm,"newLineView"));a.ka(zb.a.hA,ic.a.Ub,c);a.ka(zb.a.hA,ic.a.image,c);a.ka(zb.a.hA,ic.a.xc,c);a.ka(zb.a.hA,ic.a.anchoredObject,c);a.ka(zb.a.hA,ic.a.embeddedFile,c);
a.ka(zb.a.hA,ic.a.ink,c);a.ka(zb.a.hA,ic.a.paragraph,c);a.ka(zb.a.hA,ic.a.iFrame,c);a.ka(zb.a.hA,ic.a.unsupportedObject,c);a.Qb(zb.a.hA,1124);a.Aa(zb.a.IGd,ic.a.view,Object(m.a)(this.tng,this.tng.eDl,"insertLineBreakView"),1028);a.ka(zb.a.NHc,ic.a.view,zu.BDl);a.ka(zb.a.NHc,ic.a.outlineElement,zu.LGd);a.Qb(zb.a.NHc,1092)}static get instance(){return oC._instance||(oC._instance=oC.wk())}static wk(){return new oC(()=>xa.a.instance.resolve("Box4.IUndoManager"),xa.a.instance.ra("Box4.IAutoCorrectScheduler"),
xa.a.instance.resolve("Box4.IOutlineElementEditor"),xa.a.instance.resolve("Box4.List.ICursorMovementValidator"),xa.a.instance.resolve("Box4.List.IListEditor"),xa.a.instance.resolve("Box4.IInsertionPointFormatting"),xa.a.instance.te("Box4.Actors.IEnterViewStrategy"),li.a.instance,xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"),xa.a.instance.za("Box4.IExternalSelectionManager"),$c.a.instance,xa.a.instance.resolve("Box4.ISelectionFactory"),xa.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,
xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,xa.a.instance.za("Box4.IContentControlConverter"),xa.a.instance.resolve("Box4.IBox4GraphWriter"))}}oC._instance=null;Object(w.a)(oC,"EnterActor",null,[]);var cH=b(1206),dH=b(630);class pk{static get paragraphEditor(){return pk.kh||(pk.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}static get HY(){return pk.Z6a||(pk.Z6a=xa.a.instance.ra("Box4.ISpacingCommands"))}static get mHb(){return pk.Tk||(pk.Tk=xa.a.instance.ra("Box4.Styles.IWACStyleReader"))}static get WR(){return pk.Gx||
(pk.Gx=xa.a.instance.ra("Box4.ILineSpacingHelper"))}static get Xj(){return pk.rf||(pk.rf=xa.a.instance.ra("Box4.TrackChange.ITrackChangeEditor"))}static get hd(){return pk.Bb||(pk.Bb=xa.a.instance.ra("Box4.TrackChange.ITrackChangeManager"))}static get QM(){return xa.a.instance.ra("Box4.Settings.SpacingSettings")}static get En(){return xa.a.instance.ra("WordEditor.ClientPagination.IClientPaginationSettings")}static eb(){var a,c,h;const v=l.AFrameworkApplication.pa;v.ka(zb.a.Iof,ic.a.view,qm.a.Wu);
v.Qb(zb.a.Iof,1028);v.ka(zb.a.sA,ic.a.view,qm.a.Wu);v.ka(zb.a.sA,ic.a.paragraph,pk.smd);v.Qb(zb.a.sA,1036);if(null===(a=pk.QM)||void 0===a?0:a.ira)v.ka(zb.a.B$b,ic.a.paragraph,pk.jOj),v.ka(zb.a.B$b,ic.a.view,qm.a.Wu),v.Qb(zb.a.B$b,1036);if(null===(c=pk.En)||void 0===c?0:c.iYa)v.ka(zb.a.mVc,ic.a.paragraph,pk.uKe),v.ka(zb.a.mVc,ic.a.view,qm.a.Wu);if(null===(h=pk.En)||void 0===h?0:h.yjb)v.ka(zb.a.MVc,ic.a.paragraph,pk.NKe),v.ka(zb.a.MVc,ic.a.view,qm.a.Wu);v.ka(zb.a.$He,ic.a.view,pk.iKj);v.Qb(zb.a.$He,
1036);v.ka(zb.a.rKf,ic.a.view,pk.ZYm);v.Qb(zb.a.rKf,1036);v.ka(zb.a.ZHe,ic.a.view,pk.hKj);v.Qb(zb.a.ZHe,1036);v.ka(zb.a.qKf,ic.a.view,pk.YYm);v.Qb(zb.a.qKf,1036);v.ka(zb.a.aNa,ic.a.view,qm.a.Wu);v.ka(zb.a.aNa,ic.a.paragraph,pk.smd);v.Qb(zb.a.aNa,1036);v.ka(zb.a.$Ma,ic.a.view,qm.a.Wu);v.ka(zb.a.$Ma,ic.a.paragraph,pk.smd);v.Qb(zb.a.$Ma,1036);v.ka(zb.a.d3d,ic.a.view,pk.c3d);v.ka(zb.a.d3d,ic.a.paragraph,pk.c3d);v.Qb(zb.a.d3d,1028);v.ka(zb.a.FUf,ic.a.view,pk.c3d);v.ka(zb.a.FUf,ic.a.paragraph,pk.c3d);v.Qb(zb.a.FUf,
1028);v.ka(zb.a.S2d,ic.a.view,qm.a.Wu);v.ka(zb.a.S2d,ic.a.paragraph,pk.HTg);v.Qb(zb.a.S2d,1028);v.ka(zb.a.R2d,ic.a.view,qm.a.Wu);v.ka(zb.a.R2d,ic.a.paragraph,pk.HTg);v.Qb(zb.a.R2d,1028)}static HTg(a,c,h,v,B){if(1===h)return 32;a===zb.a.S2d?a=zb.a.aNa:a===zb.a.R2d&&(a=zb.a.$Ma);return pk.smd(a,c,h,v,pk.tzm(B))}static tzm(a){var c=a.indexOf(",");const h=a.substring(0,c);a=a.substring(c+1,a.length);c=new cH.a;c.value=parseFloat(h);c.unit=parseInt(a);return c}static c3d(a,c,h,v,B){if(2===h){c=B[pg.a.Text];
h=B[pg.a.Number];B=B.Increment;v=new cH.a;let X=!1;""===c||B&&c===Box4Intl.Box4Strings.L_SpinnerAuto?(v.value=0,v.unit=Eb.App.n4?2:4,X=!0):h||B||(v.value=0,v.unit=1,X=!0);X&&(l.AFrameworkApplication.pa.hb(a===zb.a.d3d?zb.a.aNa:zb.a.$Ma,2,v),Eb.App.oa.updateCommandUI())}return 32}static smd(a,c,h,v,B){if(!({jw:h}=qm.a.dSf(h,c)).returnValue)return h;c=c.node;switch(a){case zb.a.sA:pk.paragraphEditor.sA(c,new dH.a(2,B));break;case zb.a.aNa:a=new dH.a(B.unit,B.value);pk.paragraphEditor.SFb(c,a);break;
case zb.a.$Ma:a=new dH.a(B.unit,B.value),pk.paragraphEditor.QFb(c,a)}v&&vr.a.tib&&(v.dr|=vr.a.uab(c));return 32}static iKj(a,c,h){if(1===h)return 32;r.ULS.sendTraceTag(588394561,340,50,"Add Space Before Paragraph option is clicked");a=pk.pDh(c);if(!a)return r.ULS.sendTraceTag(588367186,3018,10,"No style applied on the paragraph"),8;a=(a=a.ia(Yb.a.uV,240)/20)?a:pk.Ypk;pk.HY.xea(1,a,4);return 32}static ZYm(a,c,h){if(1===h)return 32;r.ULS.sendTraceTag(588394562,340,50,"Remove Space Before Paragraph option is clicked");
pk.HY.xea(1,0,4);return 32}static hKj(a,c,h){if(1===h)return 32;r.ULS.sendTraceTag(588394563,340,50,"Add Space After Paragraph option is clicked");a=pk.pDh(c);if(!a)return r.ULS.sendTraceTag(588367187,3018,10,"No style applied on the paragraph"),8;a=a.ia(Yb.a.eP,240)/20;pk.HY.xea(0,a?a:12,4);return 32}static YYm(a,c,h){if(1===h)return 32;r.ULS.sendTraceTag(588394564,340,50,"Remove Space After Paragraph option is clicked");pk.HY.xea(0,0,4);return 32}static uKe(a,c,h,v,B){if(2==h){if("boolean"!==typeof B)return 16;
pk.paragraphEditor.uKe(c.node,B)}return 32}static NKe(a,c,h,v,B){if(2==h){if("boolean"!==typeof B)return 16;pk.paragraphEditor.NKe(c.node,B)}return 32}static jOj(a,c,h,v,B){if(2==h){if("boolean"!==typeof B)return 16;a=new Map;a.set("Value",B.toString());Fa.Health.instance.recordKpiUsage(ai.a.Enf.lEn,0,ai.a.pF,a);c=c.node;a=null;kg.a.instance.J(3)&&(a=c.Yz());c.hasProperty(Yb.a.RA)&&c.removeProperty(Yb.a.RA);pk.WR.Ryd(c)!==B&&c.setValue(Yb.a.RA,B);(B=pk.WR.PAd(c,!0))&&B.lj(4,!0);(B=pk.WR.PAd(c,!1))&&
B.lj(4,!0);a&&pk.Xj.sS(c,a,pk.hd.Bf)}return 32}static pDh(a){a=a.view;return a.Cd&&(a=a.Ma)&&a.Ca.Fa?pk.mHb.um(a.Ca.Fa.sa.node):null}}pk.kh=null;pk.Z6a=null;pk.Tk=null;pk.Gx=null;pk.rf=null;pk.Bb=null;pk.Ypk=12;Object(w.a)(pk,"SpacingActor",null,[]);class HK{process(){}}Object(w.a)(HK,"NoOpFormattingViewOperationFinishedStageProcessor",null,[33]);class IK{constructor(a){this.nd=a}Cen(a,c){this.nd.CY(a,c.cache.qF);this.nd.nv(a,c.cache.fontSize)}cJa(){return null}Fya(){return null}O_b(){return null}q0(){return null}}
Object(w.a)(IK,"FormattingStewardBridge",null,[41]);class JK{yb(a){a.ha("Box4.Actors.IFormattingViewOperationFinishedStageProcessor",()=>new HK).singleInstance();a.ha("Box4.Actors.IFormattingStewardBridge",()=>new IK(a.resolve("Box4.IFormattingEditor"))).singleInstance()}}Object(w.a)(JK,"WoncaActorsConfiguration",null,[2]);class KK{constructor(a,c,h,v,B,X,ma,Pa){this.ga=a;this.u9i=c;this.t9i=h;this.sag=v;this.lqj=B;this.Pcd=X;this.qqj=ma;this.rqj=Pa}get Eb(){return this.ga}nVj(a){this.Eb.Jka(a,this.u9i,
null,null)}lVj(a){this.Eb.Jka(a,this.t9i,null,null)}F_(a,c,h){h?this.Eb.Jka(a,this.sag,c,null):this.Eb.hb(this.sag,2,c)}Szm(a,c){this.Eb.Jka(a,this.Pcd,c,null)}Tda(a,c){this.Eb.Jka(a,this.qqj,c,null)}y7b(a,c){this.Eb.Jka(a,this.rqj,c,null)}ZTd(a,c=!1){const h=new uh.DictionaryPropertySet;h.setValue(Uc.a.jS,a);h.setValue(Uc.a.chi,!0);h.setValue(Uc.a.xXa,c);this.Eb.hb(this.lqj,2,h)}}Object(w.a)(KK,"ClipboardCommands",null,[1269]);class LK{}Object(w.a)(LK,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",
null,[1163]);class MK{constructor(a){this.ga=a}get Eb(){return this.ga}DCi(a,c,h){let v=0;a?1===a&&(v=zb.a.WWa):v=zb.a.VWa;a=new gC.a;a.unit=h;a.value=c;this.Eb.hb(v,2,a)}P0d(a,c,h){let v=0;1===a?v=zb.a.iGb:2===a?v=zb.a.ihb:a||(v=zb.a.jGb);a=new gC.a;a.unit=h;a.value=c;this.Eb.hb(v,2,a)}}Object(w.a)(MK,"IndentationCommands",null,[1206]);var xF;(function(a){a[a.unspecified=-1]="unspecified";a[a.none=0]="none";a[a.left=1]="left";a[a.center=2]="center";a[a.right=3]="right";a[a.inner=4]="inner";a[a.outer=
5]="outer";a[a.both=6]="both";a[a.distribute=7]="distribute";a[a.margin=8]="margin";a[a.highKashida=9]="highKashida";a[a.lowKashida=10]="lowKashida";a[a.mediumKashida=11]="mediumKashida";a[a.numTab=12]="numTab";a[a.thaiDistribute=13]="thaiDistribute";a[a.start=14]="start";a[a.end=15]="end"})(xF||(xF={}));Object(w.b)("Justification",xF);class NK{constructor(a){this.aFa={};this.ga=a;this.czl()}get Eb(){return this.ga}vB(a){a=this.aFa[xF[a]];void 0!==a&&null!==a&&this.Eb.processAction(a,2)}czl(){this.aFa.left=
zb.a.leftJustify;this.aFa.center=zb.a.centerJustify;this.aFa.right=zb.a.rightJustify;this.aFa.both=zb.a.fullJustify;this.aFa.lowKashida=zb.a.VAb;this.aFa.mediumKashida=zb.a.VAb;this.aFa.highKashida=zb.a.VAb;this.aFa.distribute=zb.a.Szc;this.aFa.thaiDistribute=zb.a.IVc}}Object(w.a)(NK,"JustificationCommands",null,[1197]);class OK{constructor(a){this.ga=a}sA(a){this.ga.hb(zb.a.sA,2,a)}B$b(a){this.ga.hb(zb.a.B$b,2,a)}mVc(a){this.ga.hb(zb.a.mVc,2,a)}MVc(a){this.ga.hb(zb.a.MVc,2,a)}xea(a,c,h){this.ga.hb(a?
zb.a.aNa:zb.a.$Ma,2,Object.assign(new cH.a,{value:c,unit:h}))}}Object(w.a)(OK,"SpacingCommands",null,[1088]);class PK{constructor(a,c,h){this.Eb=a;this.pAc=c;this.szk=h;this.gvm=(v,B,X)=>{if(1===X)return this.pAc.aTa?32:8;this.pAc.F_l();this.szk().Oqn(this.pAc.OZk());return 32}}eb(){this.Eb.Aa(zb.a.SAa,ic.a.application,this.gvm,1028)}}Object(w.a)(PK,"EditorSettingsUIActor",null,[]);class QK extends gg.a{constructor(a,c){super(!1,!1,!0);this.BPa=a;this.test=c}Oqn(a){Object(ew.__awaiter)(this,void 0,
void 0,function*(){var c=yield this.test.MLc;c={["id"]:"SettingsDialog",["uiLanguage"]:l.AFrameworkApplication.uiCulture,["selectedLanguage"]:vi.a.af(l.AFrameworkApplication.lcid).name,["isGoalActive"]:!1,["isSubscription"]:c.IKd,["editorSettings"]:a};this.Tg(Box4Intl.Box4Strings.l_EditorSettings,Object(m.a)(this,this.tzk,"editorSettingsHandler"),c);r.ULS.sendTraceTag(578091235,340,50,"Editor settings dialog is opened.")})}tzk(a){1!==a?r.ULS.sendTraceTag(527434075,340,50,"Editor Settings closed without changes"):
(this.BPa.NLn(),r.ULS.sendTraceTag(578869131,340,50,"Editor Settings updated"))}}Object(w.a)(QK,"EditorSettingsDialog",gg.a,[]);var WP=b(1226);class CA{constructor(a,c,h,v,B,X){this.lcid=a;this.id=c;this.Qd=v;this.Ccj=B;this.Dcj=X;this.defaultValue=this.RWb;void 0!==h&&null!==h&&(this.RWb=h)}get RWb(){return(this.Ccj||CA.vgg)(this.Qd)}set RWb(a){(this.Dcj||CA.wgg)(this.Qd,a)}static pv(){CA.vgg=()=>null;CA.wgg=()=>{}}}CA.vgg=null;CA.wgg=null;Object(w.a)(CA,"GrammarSettingOption",null,[1253]);CA.pv();
class eH{constructor(a,c,h){this.v2e=a;this.bOf=c;this.Hgm=h}}Object(w.a)(eH,"TwoLevelCacheKey",null,[]);class Pj extends gg.a{constructor(a,c,h,v){super();this.wye=this.Yga=this.Djg=this.lhc=null;this.wf=v;this.fhc=a;this.jf=Pj.id;this.loj=()=>{this.lhc=h?Za.a.m1d(h):{};this.Djg=h?Za.a.m1d(h):{};const B=this.KVj(),X=Pj.bhk(B,Pj.Azi(Object(m.a)(this,this.ahk,"createCritiqueTypeSettingsTracker"))(Pj.Jak(Pa=>this.lhc=Pa)));X(h||{});var ma=Pj.Azi(Pj.Smk())(Pa=>Pa.cloneNode(!0));Pj.chk(B,Pj.ugk(Pj.jlk(c),
Pj.$gk(ma))(h))(a.toString());this.wye=this.TXj();ma=Pa=>{if("click"===Pa.type||Pa.keyCode===vb.a.Nq||Pa.keyCode===vb.a.s_c)this.lhc[a.toString()]={},B.reset(),Pj.ugb(X)};Ld.a.addHandler(this.vgb,Jb.a.click,ma);Ld.a.addHandler(this.vgb,Jb.a.ah,ma)};this.vf=""}get vgb(){return this.wye}rUl(){var a=Pj.TJf(this.lhc),c=Pj.TJf(this.Djg);if(!a&&!c)return!1;let h;try{h=a?"object"===typeof a[this.fhc.toString()]?a[this.fhc.toString()]:null:{};var v=c?"object"===typeof c[this.fhc.toString()]?c[this.fhc.toString()]:
null:{}}catch(ma){return r.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!h&&!v)return!1;h=h?h:{};v=v?v:{};a=String.format("language: {0}",this.fhc.toString());c=!1;for(const ma in h){var B=ma,X=h[ma];B in v&&v[B]===X||(c=!0,a=String.format("{0}, [{1}, {2}]",a,B,X))}for(const ma in v)v=ma,v in h||(c=!0,a=String.format("{0}, [{1}, default]",a,v));c&&r.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",a);return c}Tg(a,c,h){super.Tg(a,c,h);this.uNm()}CU(a){return a.Ud.id===
Pj.fui?!1:super.CU(a)}j9m(){this.wf.gk().ROd();this.Yga=this.wf.gk().Sh.dO}uNm(){this.wf.gk().scope.Bp(nc.FocusManager.instance().BN);this.wf.gk().scope.Bp(nc.FocusManager.instance().DN);this.wf.gk().scope.bindAction(nc.FocusManager.instance().BN,zb.a.vFc);this.wf.gk().scope.bindAction(nc.FocusManager.instance().DN,zb.a.uFc);this.wf.gk().scope.bindAction(qc.KeyInputManager.mb(vb.a.qjb,0),zb.a.jDd);this.wf.gk().scope.bindAction(qc.KeyInputManager.mb(vb.a.rjb,0),zb.a.iDd);this.wf.gk().scope.bindAction(qc.KeyInputManager.mb(vb.a.O1,
0),zb.a.jDd);this.wf.gk().scope.bindAction(qc.KeyInputManager.mb(vb.a.F$,0),zb.a.iDd)}get settings(){return Pj.TJf(this.lhc)}cS(){super.cS();this.loj()}KVj(){const a=Pj.nWj(),c=Pj.pvc("WACDialogRow",a);this.Av.insertBefore(c,this.Av.firstChild);return a}ahk(a){const c=WP.a.merge(null,a);return h=>{h.RWb===(a&&a[h.lcid]?a[h.lcid][h.id]:null)||h.RWb!==h.defaultValue?Pj.szh(c,h.lcid)[h.id]=h.RWb:delete Pj.szh(c,h.lcid)[h.id];this.Yga=this.U0k(h.Qd);return c}}U0k(a){return a?(a=a.getElementsByTagName(Object(bo.a)(a,
Pj.SWl)?"select":"input"))?a[0]:null:null}dispose(){this.vgb&&(Ld.a.Fpi(this.vgb),this.wye=null);super.dispose()}TXj(){const a=document.createElement("input");a.id=Pj.fui;a.type="reset";a.setAttribute("form",Pj.noh);a.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";a.value=CommonUIStrings.l_ResetAll;const c=Pj.pvc("GrammarSettingsDialogResetButtonContainer",a),h=document.getElementById("WACDialogButtonPanel");h.parentNode.insertBefore(c,h);return a}static get Hyc(){return"CritiqueType"}static Jak(a){return c=>
h=>a(c(h))}static Azi(a){return c=>h=>c(a(h))}static TJf(a){const c={};Za.a.forEach(a,(h,v)=>{0<qt.a(v).length&&(c[h]=v)},null);return c}static nWj(){const a=document.createElement("form");a.id=Pj.noh;a.classList.add("WACDialogList",Pj.vnk);return a}static bhk(a,c){const h=Pj.oMm(a,Jb.a.change);return v=>{const B=c(v);h(X=>{X=X.target.parentNode;Object(bo.a)(X,Pj.Hyc)&&B(X[Pj.UUg])})}}static oMm(a,c){let h=null;return v=>{h&&Ld.a.removeHandler(a,c,h);Ld.a.addHandler(a,c,v);h=v}}static szh(a,c){return a[c]=
a[c]||{}}static ugb(a){r.ULS.sendTraceTag(36489289,375,50,"User click reset all button");a(null)}static jlk(a){let c=null;return h=>{c=h;return a.request(Number.parseInvariant(h)).CWRCo(v=>c===h?v.result:null,Pj.sWe)}}static chk(a,c){const h=Pj.tSk(v=>Pj.QDn(v.children));return v=>{const B=h(v,a);a.innerHTML="";(B?nl.Task.T3(B):c(v)).continueWith(X=>{X=X.result;for(let ma=0;ma<X.length;ma++)a.appendChild(X[ma])},Pj.sWe)}}static ugk(a,c){return h=>v=>a(v).CWRCo(B=>Xj.toArray(Xj.select(Xj.asEnumerable(B.result),
X=>c(h,X,v))),Pj.sWe)}static QDn(a){const c=[];for(let h=0;h<a.length;h++)c.push(a[h]);return c}static tSk(a){const c={};let h=null;return(v,B)=>{h&&!c[h]&&(B=a(B))&&(c[h]=B);h=v;return c[v]}}static Smk(){const a={};return c=>{a[c.v2e]=a[c.v2e]||{};const h=a[c.v2e];h[c.bOf]=h[c.bOf]||c.Hgm();return h[c.bOf]}}static $gk(a){return(c,h,v)=>{const B=a(new eH(v,h.Id,()=>Pj.ZVj(h)));B.setAttribute("role","group");const X=Pj.j0g+h.Name;B.setAttribute("aria-labelledby",X);for(const ma of h.CritiqueTypeInfoList){const Pa=
Pj.NOk(v,ma,c,a);B.appendChild(Pa);Pa.setAttribute("aria-labelledby",X)}return B}}static NOk(a,c,h,v){v=v(new eH(a,c.Id,()=>c.IsBinaryCritiqueType?Pj.RVj(c):Pj.yXj(c)));a=new CA(a,c.Id,h&&h[a]?h[a][c.Id]:null,v,c.IsBinaryCritiqueType?B=>B.children[0].checked:B=>B.children[1].selectedIndex,c.IsBinaryCritiqueType?(B,X)=>{B.children[0].checked=X}:(B,X)=>{B.children[1].selectedIndex=X});v[Pj.UUg]=a;return v}static ZVj(a){a=Pj.aWj(a.Name);a.className="WACWritingStylesDialogCategoryTitle";return Pj.pvc("CritiqueCategory",
a)}static RVj(a){const c=Pj.cWj();c.id=a.Id;0<a.DefaultCritiqueValue&&c.setAttribute("checked","checked");a=Pj.Gnd(a.Name,a.Id);a.className="WACDialogLabel";const h=Pj.pvc(Pj.Hyc,c,a);h.appendChild(c);h.appendChild(a);return h}static yXj(a){a=Pj.cXj(a.Id,a.Name,Pj.DXj(a.CritiqueTypeValues,a.DefaultCritiqueValue),a.DefaultCritiqueValue);a.classList.add(Pj.Hyc);return a}static DXj(a,c){return Xj.toArray(Xj.Si(Xj.asEnumerable(a||[]),(h,v)=>{h=Pj.CXj(h,v.toString());v===c&&h.setAttribute("selected","selected");
return h}))}static cXj(a,c,h,v){c=Pj.Gnd(c,a);const B=document.createElement("select");B.id=a;B.className="WACDialogList";h=h||[];for(a=0;a<h.length;a++)B.appendChild(h[a]),v===a&&(h[a].selected=!0);return Pj.pvc("GrammarSettingsDialogLabeledInlineList",c,B)}static CXj(a,c){const h=document.createElement("option");h.text=a;h.value=c;return h}static cWj(){const a=document.createElement("input");a.type="checkbox";a.className="WACDialogCheckBox";return a}static Gnd(a,c){const h=document.createElement("label");
h.innerText=a;h.setAttribute("for",c);return h}static aWj(a){const c=document.createElement("div");c.innerText=a;c.id=Pj.j0g+a;return c}static pvc(a=null,...c){const h=document.createElement("div");h.className=a;for(const v of c)h.appendChild(v);return h}}Pj.id="GrammarSettingsDialog";Pj.noh="CritiqueTypeSettings";Pj.vnk="CritiquesList";Pj.SWl="GrammarSettingsDialogLabeledInlineList";Pj.fui="ResetButton";Pj.j0g="WritingStylesCategory_";Pj.sWe=11;Pj.UUg="CritiqueType";Object(w.a)(Pj,"GrammarSettingsDialog",
gg.a,[]);class RK{constructor(a,c,h,v){this.Eb=a;this.oub=c;this.mnl=h;this.eGf=v;this.rd=null;this.eGf.init();this.oub.init()}eb(){this.Eb.Aa(zb.a.SAa,ic.a.application,Object(m.a)(this,this.SAa,"openGrammarSettings"),1028);this.Eb.ka(zb.a.vFc,Kc.a.frame,Object(m.a)(this,this.PGh,"grammarDialogTabFocusHandler"));this.Eb.ka(zb.a.uFc,Kc.a.frame,Object(m.a)(this,this.PGh,"grammarDialogTabFocusHandler"));this.Eb.ka(zb.a.jDd,Kc.a.frame,Object(m.a)(this,this.OGh,"grammarDialogOptionFocusHandler"));this.Eb.ka(zb.a.iDd,
Kc.a.frame,Object(m.a)(this,this.OGh,"grammarDialogOptionFocusHandler"))}SAa(a,c,h,v,B){a=this.LXk();if(1===h)return this.eGf.request(a).result&&this.eGf.request(a).result.length?6===this.oub.mAa().status?32:8:8;h=this.oub.mAa().result;this.rd=this.mnl(a,h);this.rd.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,X=>{r.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===X?"OK":X?"":"Cancel");1===X&&(this.rd.rUl()?(r.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),
this.oub.saveSettings(this.rd.settings)):r.ULS.sendTraceTag(36508631,375,50,"User click OK with but not update setting"))});a=h="";B&&(h+=B.SourceControlId,a+=B.Alt);r.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+h+", Alt: "+a);return 32}LXk(){return l.AFrameworkApplication.lcid}PGh(a){if(!this.rd)return 2;var c=this.rd.wf.gk().Sh.dO;if(c===this.rd.Hu&&a===zb.a.vFc||c===this.rd.vgb&&a===zb.a.uFc)this.rd.Yga?this.rd.wf.gk().Sh.ov(this.rd.Yga):this.rd.j9m();else if(Object(bo.a)(c,
Pj.Hyc)||c.parentNode&&Object(bo.a)(c.parentNode,Pj.Hyc))c=null,a===zb.a.vFc?c=this.rd.vgb:a===zb.a.uFc&&(c=this.rd.Hu),this.rd.wf.gk().Sh.ov(c);else if(a===zb.a.vFc)this.rd.wf.gk().RYa();else if(a===zb.a.uFc)this.rd.wf.gk().QYa();else return 2;return 32}OGh(a){if(!this.rd)return 2;let c=this.rd.wf.gk().Sh.dO;if(c===this.rd.Hu||c===this.rd.vgb||c===this.rd.ZC)return 2;a===zb.a.iDd&&this.rd.wf.gk().RYa();a===zb.a.jDd&&this.rd.wf.gk().QYa();c=this.rd.wf.gk().Sh.dO;c===this.rd.vgb?this.rd.wf.gk().QYa():
c===this.rd.Hu?this.rd.wf.gk().RYa():this.rd.Yga=c;return 32}}Object(w.a)(RK,"GrammarSettingsActor",null,[]);class SK{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee){this.Zob=this.Qoc=this.KKb=null;this.oBe=0;this.Tme=!1;this.ma=new Rd.a;this.sjc=null;this.GId=!1;this.mnb=null;this.yv=a;this.Xm=c;this.nd=h;this.kh=v;this.Ba=B;this.Un=X;this.zc=ma;this.Tb=Pa;this.Gm=mb;this.Na=Tb;this.Bb=rc;this.rf=Tc;this.nG=vd;this.Tk=ee}get QAk(){return this.Na?this.Na.isFeatureEnabled(66):!!l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("Box4EndOfParagraphFormattingIsEnabled")}get J3e(){return this.sjc||(this.sjc=xa.a.instance.resolve("Box4.IFormatPainterStrategy"))}get FO(){return this.Tme}set FO(a){this.Tme!==a&&(this.Tme=this.GId=a,this.ma.raiseEvent("FormatPainterBrushActiveStatusChanged"))}jHj(a){this.ma.addHandler("FormatPainterBrushActiveStatusChanged",a)}yDf(a){const c=a.sa;r.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",c.contextId);this.reset();var h=c.node;a=this.mUh(a);
if(this.J3e.Rnn(c.contextId,a))try{this.Zob=this.Ba.cWa(h)}catch(v){throw r.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",v.message),v;}this.Qoc=this.Tk.um(h);h=ua.FormattingReader.zr(c);h.fm&&(this.KKb=Object(ha.a)(nh.a,h.fm.clone()));this.oBe=a?ic.a.paragraph:c.contextId}nmd(a){if(a){const v=this.mUh(a);if(this.DId)if(a=a.aO().rx(),null===a||void 0===a?0:a.Kk)this.YSa(a,v);else if(0==(null===a||void 0===a?void 0:a.length))r.ULS.sendTraceTag(529089953,354,50,"Attempt to apply format to non-graph-node context: {0}",
a);else{if(a)for(var c=0;c<a.length;c++){var h=a.getContext(c);if(null===h||void 0===h?0:h.Iv){if(h)for(let B=0;B<h.length;B++)a.addContext(h.getContext(B))}else(null===h||void 0===h?0:h.Kk)?this.YSa(h,v):r.ULS.sendTraceTag(529089954,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}else for(c=0;c<a.length;c++)h=a.J(c),(null===h||void 0===h?0:h.Kk)?this.YSa(h,v):r.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",h.contextId)}}fTg(a,
c){if(c){var h=a.node,v=h.la.last,B=this.Tb.jIa(h),X=B.Ge(B.Xa);this.gTg(B,c,null);kg.a.instance.J(3)&&this.rf.VFb(h,v,a.cpBegin,a.cpEnd,X,B,this.Bb.Bf)}}zOj(a,c,h){if(c||h)0<ac.g(a).length&&r.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.nG.u_(a,v=>{this.gTg(v,c,h)})}gTg(a,c,h){var v,B,X,ma;this.nd.yha(a);a.fm&&a.fm.removeProperty(Ed.a.highlight);this.nd.OPe(a);if(h){let Pa=h.Fg();if(null===(v=l.AFrameworkApplication.K)||void 0===v?0:v.$("StylesFlatteningCrashFixIsEnabled"))Pa=
dl.a.rra(h)?null===(ma=null===(X=null===(B=this.Tk)||void 0===B?void 0:B.lp())||void 0===X?void 0:X.JU(Pa))||void 0===ma?void 0:ma.clone():Pa.clone(),Pa.Ig(...Xf.a.xI());this.Zq(a,Pa)}this.Zq(a,c)}Zq(a,c){var h;if(c){var v=a.paragraph.Mb;if(v){var B=a.fm;B=B?Object(ha.a)(Pn.a,B.clone()):nh.a.$wa(1179725);for(const ma of c.zi())if(ma!==Yb.a.Tx&&ma!==Yb.a.fieldInstruction&&ma!==Ed.a.hz&&ma!==Ed.a.p4&&ma!==Yb.a.Dcb&&ma!==Ed.a.iB&&ma!==Yb.a.languageHint&&ma!==Yb.a.noProof){if(ma===zi.a.Oz){var X=c.ia(zi.a.Oz,
N.a.nil);if(X!==N.a.nil)if(X=v.Ra(X)){if(X=new sg.a(X),X=this.Tk.pC(X),X===Box4Intl.Box4Strings.L_StyleWordHyperlink)if(X=this.Tk.tw(a.paragraph).tqa(X)){(null===(h=l.AFrameworkApplication.K)||void 0===h?0:h.$("StylesFlatteningCrashFixIsEnabled"))?B.AG(X.Fg(),...Xf.a.xI()):B.Zq(X.Fg());continue}else r.ULS.sendTraceTag(589345875,354,50,"Applied Hyperlink style on formatting is not present in Style Set")}else r.ULS.sendTraceTag(589345876,354,50,"Applied character style on formatting is not present in Object Space")}B.setValue(ma,
c.pg(ma))}B.Gja?c=v.iP(B,!0):(v.At(B),c=B);a.mi=c.id}}}mUh(a){return!a.eC&&a.Pb.contextId!==ic.a.endOfParagraph}reset(){this.Zob=this.Qoc=this.KKb=null;this.oBe=ic.a.none}YSa(a,c){if(a.contextId===ic.a.Ub||a.contextId===ic.a.xc)var h=this.Gm.T8(a);else if(a.contextId===ic.a.paragraph)h=this.Gm.BJd(a);else if(a.contextId===ic.a.endOfParagraph)h=this.Gm.nId(a);else{r.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",a.contextId);return}r.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",
a.contextId);if(h)r.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{h=Object(ha.a)(Fb.AParagraphNode,a.node);var v=!1;h&&(v=a.contextId===ic.a.xc&&!!h&&!a.cpBegin&&a.cpEnd===this.Ba.textLength(h));if(c=this.J3e.imn(this.oBe,a.contextId,c,v))try{sd.ParagraphReader.tb(h)?(this.Qoc&&this.yv.MK(this.Qoc,h,!0),this.kh.yTg(h,this.Zob)):r.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",a.node.type)}catch(B){throw r.ULS.sendTraceTag(22832065,
354,10,"ApplyParagraphProperties error: {0}",B.message),B;}v=a;a.contextId===ic.a.paragraph?v=Oe.a.createTextRange(h,0,sd.ParagraphReader.textLength(h)):a.contextId===ic.a.Ub&&(v=this.Xm.O$e(a),v=$c.a.eub(v));if(v&&v.contextId===ic.a.xc)try{this.zOj(v,this.KKb,c?null:this.Qoc)}catch(B){throw r.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",B.message),B;}if(a.contextId===ic.a.paragraph||a.contextId===ic.a.endOfParagraph){c=new Kd.GraphIterator;c.set(h);c.nc();c.mc(11);v=
ab.ListReader.Pg(c);const B=!sd.ParagraphReader.textLength(h);r.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",v,B);v?(this.zc.lB(c),c=c.currentNode,this.zc.V8(c)&&(Wi.a.Dc.JO?this.fTg(a,this.KKb):this.Un.v0d(c,h,this.KKb))):this.QAk&&this.fTg(a,this.KKb)}}}get DId(){null==this.mnb&&(l.AFrameworkApplication.Mg("0b2ac141;84eff841"),this.mnb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",
!1):!1);return this.mnb}}Object(w.a)(SK,"FormatPainter",null,[1235]);var XP=b(98);class pC{constructor(a,c,h,v,B,X,ma,Pa=!1,mb,Tb,rc){this.X9c=!1;this.wje=new Zq.a;this.mnb=null;this.xg=a;this.fb=c;this.ga=h;this.fc=v;this.jD=B;this.mt=X;this.ya=ma;this.Yij=Pa;this.Uq=mb;this.uv=Tb;this.obj=rc}get ujg(){return H.a.so||H.a.VJd?"url("+this.kvh()+"), pointer":'url("'+this.kvh()+'"), pointer'}kvh(){return this.uv?this.Uq.pca(uk.a.Ah("FormatPainterText.cur"),uk.a.Ah("FormatPainterTextDarkMode.cur"),new XP.a(Aj.a.pX())):
uk.a.Ah("FormatPainterText.cur")}eb(){const a=this.fb.fd(If.AppFrame.iC);a.bindAction(qc.KeyInputManager.mb(vb.a.ZCa,0),zb.a.H3e);a.bindAction(qc.KeyInputManager.mb(vb.a.Pjb,6),zb.a.Jxd);this.Yij||a.bindAction(qc.KeyInputManager.mb(vb.a.$1a,6),zb.a.pVa);this.ga.Aa(zb.a.Jxd,ic.a.view,Object(m.a)(this,this.Bpl,"handleFormatPainterPick"),1028);this.ga.Aa(zb.a.pVa,ic.a.view,Object(m.a)(this,this.zpl,"handleFormatPainterApply"),1028);this.ga.Aa(zb.a.H3e,ic.a.view,Object(m.a)(this,this.Apl,"handleFormatPainterCancel"),
1028);this.mt.jHj(()=>{this.M0f(this.mt.FO)});this.uv&&this.obj.AIe(()=>{this.xSd(this.mt.FO)})}Apl(){this.mt.FO=!1;return 32}Bpl(a,c,h){a=!1;if(c=this.jD.Zpa){switch(c.contextId){case ic.a.xc:case ic.a.paragraph:case ic.a.endOfParagraph:case ic.a.Ub:a=!0}a&&Gc.SelectionEditor.tj(c)&&ac.b(c)&&(this.fc.ib(Kf.a.Nl,{["Reason"]:Ef.a.wxc}),a=!1);a&&sd.ParagraphReader.EO(c)&&(this.fc.ib(Kf.a.Nl,{["Reason"]:Ef.a.$L}),a=!1)}if(1===h||!a)return a?32:8;6!==this.ga.eF?(this.mt.FO?r.ULS.sendTraceTag(22832076,
354,50,"User deactivated the Format Painter button"):(r.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this.mt.yDf(this.jD.Fa),this.X9c||(this.xg.QSa(Object(m.a)(this,this.$Ti,"updateCursorOnModeSwitched")),(h=this.xg.Da.Su)&&h.Rh&&h.tPg(Object(m.a)(this,this.ZTi,"updateCursorOnInitialSelection")),this.X9c=!0)),this.mt.FO=!this.mt.FO):(r.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this.mt.yDf(this.jD.Fa),this.mt.FO=!1);return 32}zpl(a,
c,h,v,B){if(6===this.ga.eF||this.mt.FO){r.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this.ga.eF);a=this.xg.Qo.Pe("UserAction","FormatPainterApply");if(pC.Ua&&pC.Ua.Xt(197)){B=B?B.KeepBrushActive:!1;h=null;this.jD.Fa&&2===this.jD.Fa.trigger&&(B=B||this.mt.GId,this.mt.GId&&Gc.SelectionEditor.Cl(this.jD.Fa)&&(h=Gc.SelectionEditor.a0(this.jD.Fa.sa,!1)))&&(h.trigger=2);this.mt.GId=!1;if(B||2!==this.jD.Fa.trigger)c=new gf.GraphTransaction(15),h&&h.sa?(c.set(h.sa.node.Oh),
this.ya.setSelection(h)):c.set(this.jD.EYb.Oh),h=this.DId?ne.SelectionFactory.yn(this.ya.If):this.jD.Fa,this.mt.nmd(h),c.dispose();this.mt.FO=B}else B=new gf.GraphTransaction(15),B.set(this.jD.EYb.Oh),c=this.DId?ne.SelectionFactory.yn(this.ya.If):this.jD.Fa,this.mt.nmd(c),this.mt.FO=!1,B.dispose();a.stop()}return 32}M0f(a){const c=this.xg.Qo.Pe("UserAction","FormatPainterUpdateCursor");this.xSd(a);this.xg.updateCommandUI();c.stop()}YTi(a,c){for(let h=0;h<a.length;h++)this.XTi(a[h],c);(a=this.xg.Da.Su)&&
a.Cd&&this.XTi(a.Vf.editingElement,c)}XTi(a,c){a.style.cursor=c?this.ujg:""}$Ti(){this.xSd(this.mt.FO)}ZTi(){this.xSd(this.mt.FO)}xSd(a){const c=document.querySelectorAll(".OutlineElement");if(1<c.length){const h=c[c.length-2].style.cursor===this.ujg;if(this.xg.Da.isEditingAllowed||this.xg.Da.jv){if(a&&!h||!a&&h)this.YTi(c,a),this.vUi(a);a||!this.X9c||this.wje.count||(this.xg.Fri(Object(m.a)(this,this.$Ti,"updateCursorOnModeSwitched")),(a=this.xg.Da.Su)&&a.Rh&&a.WXm(Object(m.a)(this,this.ZTi,"updateCursorOnInitialSelection")),
this.X9c=!1)}else h&&(this.YTi(c,!1),this.vUi(!1))}}vUi(a){const c=this.xg.Da.Su;c&&(a?this.wje.add(c.sc.Qn):this.wje.remove(c.sc.Qn))}static get Ua(){return pC.Na||(pC.Na=xa.a.instance.ra("Box4.IFeatureHelper"))}get DId(){null==this.mnb&&(l.AFrameworkApplication.Mg("0b2ac141;84eff841"),this.mnb=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.IsFormatPainterBugFixFlightEnabled",!1):!1);return this.mnb}}pC.Na=null;Object(w.a)(pC,"FormatPainterActor",
null,[]);class Qy{constructor(a,c,h){this.vl=h}TCk(a,c,h,v,B){var X;if(!({kd:h,selected:X,jw:mb}=this.qGi(c,h,!1)).returnValue)return mb;bh.a.mark(5013);var ma=Qy.uf.LN(X);for(var Pa=0;Pa<ma.length;++Pa){if(!ma[Pa].Nc)continue;const Tb=ma[Pa].iterator;Tb.fn();if(zj.OutlineReader.hv(Tb))return this.Aih(h,Tb)}ma=this.k_k();if(X.Iv||Gc.SelectionEditor.tj(X)||sd.ParagraphReader.Wk(X)&&!Gc.SelectionEditor.l4(X)){if(Qy.Ua&&Qy.Ua.isFeatureEnabled(39)&&Nm.ContextSetEditor.instance.RTf(X).returnValue)return 8;
var mb=this.Bih(c,h,a,v,B,ma)}else if(Gc.SelectionEditor.mj(X))mb=this.zih(c,h,a,v,B,ma);else if(Gc.SelectionEditor.ke(X)){mb=new Kd.GraphIterator;mb.set(X.node);mb.La(10);Pa=ch.HyperlinkReader.aB(X,!1);if(0<Pa.length){if(!Pa[0].hyperlink)return r.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",Pa[0].cpBegin,Pa[0].cpEnd),8;Eb.App.MYb(Pa[0].hyperlink.url);return 32}Tf.TableCellReader.LX(mb)&&(Fe.returnToContainingCell(mb),Tf.TableCellReader.Vca(mb)&&(Pa=new Kd.GraphIterator,
Pa.Wb(mb),Fe.returnToContainingRow(Pa),zj.OutlineReader.gz(mb,X,!1)&&$m.a.lSh(Pa)&&0>=X.Qa&&(ma=zb.a.NHc,Fe.returnToContainingTable(mb),ie.OutlineElementNavigator.Wc(mb),B||(B=new uh.DictionaryPropertySet),B.Uh(Uc.a.targetObject,mb.currentNode.id))));mb=this.Cih(c,h,a,v,B,ma)}else Gc.SelectionEditor.l4(X)&&(mb=l.AFrameworkApplication.pa.Le(c,zb.a.hA,2,!1,v,B));bh.a.mark(5014);return mb}qGi(a,c,h){let v=null,B=null;if(1===c)return{returnValue:!1,kd:v,selected:B,jw:32};if(!a.view.Cd)return{returnValue:!1,
kd:v,selected:B,jw:2};v=a.view;return(B=v.Ma.If)&&Qy.Sf.TRh(B,h)?this.vl&&this.vl.instance&&this.vl.instance.JR(B)?{returnValue:!1,kd:v,selected:B,jw:4}:{returnValue:!0,kd:v,selected:B,jw:2}:{returnValue:!1,kd:v,selected:B,jw:2}}Zln(a,c,h,v,B){let X,ma;if(!({kd:h,selected:X,jw:ma}=this.qGi(c,h,!0)).returnValue)return ma;const Pa=Qy.uf.LN(X);for(let mb=0;mb<Pa.length;++mb){if(!Pa[mb].Nc)continue;const Tb=Pa[mb].iterator;Tb.fn();if(zj.OutlineReader.hv(Tb))return this.Aih(h,Tb)}X.Iv||Gc.SelectionEditor.tj(X)?
ma=this.Bih(c,h,a,v,B,zb.a.IGd):Gc.SelectionEditor.mj(X)?ma=this.zih(c,h,a,v,B,zb.a.IGd):Gc.SelectionEditor.ke(X)?ma=this.Cih(c,h,a,v,B,zb.a.IGd):Gc.SelectionEditor.l4(X)&&(ma=l.AFrameworkApplication.pa.Le(c,zb.a.hA,2,!1,v,B));return ma}Aih(a,c){a.Ma.setSelection(ne.SelectionFactory.en(c.currentNode,!1));return 32}Bih(a,c,h,v,B,X){const ma=new gf.GraphTransaction(15);ma.ql=h;ma.Oa(c.sc);c=new uh.DictionaryPropertySet;c.setValue(Uc.a.Wzc,!0);c=l.AFrameworkApplication.pa.Le(a,zb.a.lF,2,!0,v,c);32===
c&&(c=l.AFrameworkApplication.pa.Le(a,X,2,!1,v,B));ma.dispose();return c}zih(a,c,h,v,B,X){const ma=new gf.GraphTransaction(15);ma.ql=h;ma.Oa(c.sc);c.Ma.setSelection(Gc.SelectionEditor.Ri(c.Ma.Ca.J(0),!1,!1));a=l.AFrameworkApplication.pa.Le(a,X,2,!1,v,B);ma.dispose();return a}Cih(a,c,h,v,B,X){const ma=new gf.GraphTransaction(15,h);ma.ql=h;ma.Oa(c.sc);a=l.AFrameworkApplication.pa.Le(a,X,2,!1,v,B);ma.dispose();return a}static get uf(){return Nm.ContextSetEditor.instance}static get Sf(){return li.a.instance}static get Ua(){return Qy.Na||
(Qy.Na=xa.a.instance.ra("Box4.IFeatureHelper"))}}Qy.Na=null;Object(w.a)(Qy,"AEnterViewStrategy",null,[1263]);class TK extends Qy{constructor(a,c,h){super(a,c,h)}k_k(){return zb.a.hA}}Object(w.a)(TK,"EnterViewStrategy",Qy,[]);class fH{constructor(a){this.rk=this.transaction=null;this.kd=a;this.Mxc=this.Bm=0}}Object(w.a)(fH,"SelectAllArguments",null,[]);class DA{constructor(a,c,h,v){this.BPb=a;this.Zua=c;this.Fb=h;this.qne=v}get dxm(){return this.BPb}get ji(){return this.Zua.value}get Y8m(){return this.qne?
Object(m.a)(this,this.xEk,"expandSelectionWord"):Object(m.a)(this,this.oyi,"selectAllInOutline")}eb(){const a=l.AFrameworkApplication.pa;a.ka(zb.a.Zsa,Kc.a.frame,DA.qHi);a.ka(zb.a.QRf,Kc.a.frame,DA.qHi);a.Aa(zb.a.A$a,ic.a.view,this.Y8m,2);a.Aa(zb.a.XGa,ic.a.view,Fc.AFrame.pf,100);a.Aa(zb.a.Ksf,ic.a.view,DA.Ksf,4)}A$a(a,c,h){if(1===c)return 32;if(!a.view.Cd)return 2;c=a.view;if(!c.Ma)return 8;const v=c.Ma.Ca;if(!v||!v.length)return 8;bh.a.mark(5798);Eb.App.oa.Da.isEditingAllowed||Eb.App.oa.Da.jv||
c.Rh?a=Gc.SelectionEditor.s9e(v):(nc.FocusManager.instance().rA(Fc.AFrame.Mp),a=ne.SelectionFactory.pyi(c.sc));if(!a)return 8;this.qne&&!v.lUa&&r.ULS.sendTraceTag(39098305,324,50,"Progress selection start");h&&this.dxm.Ucb(Gc.SelectionEditor.nth(a))?h=h(c):(h=new fH(c),h.rk=a,h=new Cp.a(null,Object(m.a)(this,this.xQc,"processSetSelection"),h),h.jk("ExpandSelection"),h.run());return h.inProgress?1:32}xEk(a,c,h,v,B){return c.view.Rh?this.A$a(c,h,Object(m.a)(this,this.NKi,"startOperationOfSelectAllInOutline")):
this.oyi(a,c,h,v,B)}xQc(a,c){return c.Bm?1===c.Bm?(c.kd.Ma.N0d(c.rk,a),c.Bm=2,!0):2===c.Bm?(c.kd.Ma.Ca.lUa=c.rk.lUa,this.ji.ZD(),c.transaction.SBa(a),c.Bm=3,c.transaction.dispose(),bh.a.mark(5799),!0):!1:(c.transaction=this.Fb.Ob(2),c.transaction.Oa(c.kd.sc),c.Bm=1,!0)}oyi(a,c,h){if(1===h)return 32;if(!c.view.Cd)return 2;a=c.view;return a.Ma&&a.Ma.Ca&&a.Ma.Ca.Fa?this.NKi(a).inProgress?1:32:8}NKi(a){l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.qne&&
a.Rh&&r.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");a=new Cp.a(null,Object(m.a)(this,this.KGm,"processSelectAllInOutline"),new fH(a));a.jk("SelectAllInOutline");a.run();return a}KGm(a,c){if(!c.Bm)return c.rk=ne.SelectionFactory.Z8m(c.kd.Ma.Ca.Fa),c.transaction=this.Fb.Ob(2),c.transaction.Oa(c.kd.sc),c.Bm=1,!0;if(1===c.Bm){if(!c.Mxc)return c.kd.Ma.setSelection(c.rk.J(0),a),++c.Mxc,!0;if(c.Mxc<c.rk.length)return c.kd.Ma.IFj(c.rk.J(c.Mxc),a),++c.Mxc,!0;c.Bm=2}return 2===c.Bm?(c.kd.Ma.Ca.lUa=
c.rk.lUa,this.ji.ZD(),c.transaction.SBa(a),c.Bm=3,c.transaction.dispose(),!0):!1}static get G_a(){return DA.jGa||(DA.jGa=xa.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static Ksf(a,c,h){if(1===h)return 32;if(!c.view.Cd)return 8;a=c.view;c=ne.SelectionFactory.en(a.root.graphNode,!0);if(!c)return 8;a.Ma.setSelection(c);return 32}static qHi(){var a=Eb.App.oa.Da.Su;if(!a.Cd)return 2;if(a.Cd&&1!==Eb.App.oa.state){bh.a.mark(4668);var c=a.Ma.Ca.Fa;if(!c&&l.AFrameworkApplication.K.$("ContextMenuOnSelectionFixIsEnabled"))return 2;
c=Gc.SelectionEditor.Kwa(c);let h=c.x,v=c.y+c.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(c.y<a.y||c.y>a.y+a.height||c.x<a.x||c.x>a.x+a.width)h=a.x,v=a.y;DA.G_a.Zsa(new Sys.UI.Point(h,v),1);bh.a.mark(4669)}return 32}}DA.jGa=null;Object(w.a)(DA,"SelectAllHandlers",null,[1096]);class UK{b0d(){}}Object(w.a)(UK,"FontNameFormattingStrategyNoop",null,[1236]);var yF=b(1682),VK=b(1468);class zF{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){this.Qe=a;this.dw=c;this.Ba=B;this.ZS=X;
this.Og=ma;this.Zc=Pa;this.Na=Tb}BOf(a,c,h,v){const B=a.qMg(c);if(B){var X=Object(Ub.a)(VK.a,a),ma=this.Zc.Pe("WebServiceCall",String.format("SendGraphicsEditorRequest: ClosingDialog = {0} EditingExistingContent = {1}",X,h)),Pa=c.lm.node,mb=()=>{h||this.pWm(c.lm,B.getId())};X=zF.PXg();v=this.nYg(B.getId().toString(),Pa,v,h);try{a.nSg(v,c)}catch(Tb){r.ULS.sendTraceTag(572872463,3001,10,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Exception while trying to AppendUrlParameters. Exception: "+
Tb.message);this.fo(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);return}this.Qe.ai(X,2,v.toString(),{},!0,0,Tb=>{r.ULS.sendTraceTag(575522560,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorRequest: Successfully created GraphicsEditorSession.");a.oZa(Tb,B,()=>{this.fo(a.JBd())},mb,Pa,c,ma)},Tb=>{const rc=415===Tb.data.we;a.pka(`Graphics editor request failed. HttpStatus ${Tb.data.we}, ResponseData ${Tb.data.qd}`,B,Pa,mb,()=>{this.fo(rc?WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError:
a.JBd())},ma,rc)},null)}else this.fo(a.JBd())}E$m(a,c,h){return new Promise((v,B)=>{var X=a.lm.node;X.Eh();const ma=zF.PXg();X=this.nYg(c.toString(),X,h,!1);X.Hd(yF.a.ESe,"2");this.Qe.ai(ma,2,X.toString(),{},!0,0,Pa=>{r.ULS.sendTraceTag(575522563,3001,50,"GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Successfully created.");v(Pa.data.qd)},Pa=>{r.ULS.sendTraceTag(575522564,3001,10,`GraphicsEditorRequestManager::SendGraphicsEditorThemeRequest: Request failed. HttpStatus ${Pa.data.we}, ResponseData ${Pa.data.qd}`);
this.fo(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError);B(null)},null)})}nYg(a,c,h,v){const B=c.Eh(),X=new Wa.QueryStringBuilder("WordGraphicsEditorHandler.ashx");l.AFrameworkApplication.Aoa(X);X.Hd(yF.a.strict,this.KMl(c)?"true":"false");X.Hd(of.a.kc,a);X.Hd(of.a.cellId,B.Nk.toString());X.Hd(of.a.fileId,B.fr);X.Hd(of.a.S_,h.toString());X.Hd(yF.a.lEk,v?"true":"false");if(a=!!this.Na&&this.Na.isFeatureEnabled(81))if(X.Hd(dh.a.Khi,a.toString()),a=this.Na.isFeatureEnabled(145))X.Hd(dh.a.WAm,
a.toString()),X.Hd(dh.a.ignoreMalformedColors,this.Na.isFeatureEnabled(92).toString());X.Hd(dh.a.JVg,"true");Um.a.instance.Yrb(X);return X}KMl(a){if(!this.dw)return!1;a=this.dw.Xs(a);return!!a&&a.pg(Yb.a.cmf)}pWm(a,c){a.cpBegin===a.cpEnd-1&&this.Og.QEb(a.node,c,this.Ba,this.ZS)}fo(a){const c=new oe.StandardDialog;c.yc=0;c.Fw(Qk.a.sZe,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,a,null);Eb.App.oa.updateCommandUI()}static PXg(){const a=new Wa.QueryStringBuilder("WordGraphicsEditorHandler.ashx");
l.AFrameworkApplication.Aoa(a);return a.toString()}}Object(w.a)(zF,"GraphicsEditorRequestManager",null,[548]);class WK extends XE{constructor(a,c){super(a,c);this.MJa=zb.a.insertHyperlink}fXa(a){null!=a&&0<a.length&&this.Eb.hb(this.MJa,2,a[0])}Y_i(a,c,h){const v=vi.a.af(l.AFrameworkApplication.lcid).name;return String.format(a,l.AFrameworkApplication.lcid,v,l.AFrameworkApplication.buildVersion,c,$C.z$d,h)+"&flipgrid=1&ted=1"}}Object(w.a)(WK,"InsertHubbleMediaHelper",XE,[]);class XK{constructor(a,
c,h,v,B){this.ga=a;this.qa=c;this.B8c=h;this.QZ=v;this.Vlb=B}eb(){this.ga.Aa(ba.a.yei,ic.a.Ub,this.zvm.bind(this),1028);this.ga.Aa(ba.a.ENh,ic.a.Ub,this.tDl.bind(this),1028)}tDl(a,c,h,v,B){if(1!==h){if(null==B)return 16;if(!c.Kk||!Gc.SelectionEditor.ke(c))return 2;a=this.$Zk(B);B=B.OriginalUrl;l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.Vlb.P4f(a,c,B)}return 32}W4i(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("OnlineVideoFloodgateIsEnabled")&&
window.setTimeout(()=>{const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");a&&a.execute(c=>{c.logActivity("OnlineVideoInserted","OnlineVideoFloodgateIsEnabled")})},5E3)}$Zk(a){const c=new Mx;c.MediaType=a.ContentType;c.Height=a.Height;c.Width=a.Width;c.IFrameHtml=a.Html;c.Title=a.Caption;c.Thumbnail=a.ThumbnailUrl;return c}zvm(a,c,h){if(1!==h)c=F.a.oU(this.qa.Ga("UserId")).toString(),c=this.QZ.Y_i(this.qa.appSettings.InsertVideoHubbleEndpoint,Ya.a.create().toString(),c),this.QZ.MJa=ba.a.ENh,
c=this.B8c.RDc(c,!0),c.correlationId=Ya.a.create(),c.rda=5,c.f2d(null,this.QZ),Z.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.OnlineMedia",dataFields:[Object.assign(new aa.a,{name:"ActionId",int64:a})]})),this.W4i();else if(!(c&&c.node&&vA.a(c.node)))return 2;return 32}}Object(w.a)(XK,"OnlineMediaActor",null,[]);class YK extends VE{constructor(a,c,h,v=null,B=!1){super(a,c,h,v,B);this.Xjc=null}get telemetryEventName(){return"Office.Word.Online.OnlineMediaDialog"}KCc(){const a=
{};a.insertMediaServiceEndpoint=this.C8c;a.iFrameId="mediaiframe";return a}f2d(a,c){this.YLb=a;this.Xjc=c;this.Tic=!1;a={["id"]:"OnlineMediaDialog",["bodyControls"]:this.KCc(),["componentIsVisibleCallback"]:this.l3i.bind(this)};this.Tg(this.YLb,null,a)}l3i(){this.ZX=this.EZb(this.hi("mediaiframe"));this.UE=this.pdd.getInstance(this.ZX.contentWindow,this.C8c);this.UE.rq(E.a.TNg,a=>{this.D9h(a,this.Xjc.fXa.bind(this.Xjc))});this.UE.rq(E.a.insert,a=>{this.kRd(a,this.Xjc.fXa.bind(this.Xjc))});this.UE.rq(E.a.qth,
this.yai.bind(this));this.UE.rq(E.a.getSessionId,this.Bai.bind(this));this.UE.rq(E.a.drh,this.xai.bind(this));this.UE.rq(E.a.kod,this.l$h.bind(this));this.Rgb(3)}Rgb(a){const c=[];Array.add(c,Object.assign(new aa.a,{name:"DialogResult",string:ZC[a]}));Array.add(c,Object.assign(new aa.a,{name:"DialogMode",string:this.Z8e()}));Array.add(c,Object.assign(new aa.a,{name:"CorrelationId",string:this.correlationId.toString()}));Array.add(c,Object.assign(new aa.a,{name:"Provider",string:qB[this.rda]||"Unknown"}));
Z.a.sendTelemetryEvent(Object.assign(new ja.a,{name:this.telemetryEventName,dataFields:c}))}}Object(w.a)(YK,"OnlineMediaDialog",VE,[]);class ZK{constructor(a,c){this.zme=a;this.QZ=c}RDc(a,c=!1){return new YK(a,this.zme,this.QZ,null,c)}getInstance(){throw Error.notImplemented();}}Object(w.a)(ZK,"OnlineMediaDialogFactory",null,[547]);class $K extends jk{constructor(){super(1,3);this.kL=xa.a.instance.resolve("Common.IReactContextualUILauncher");this.ONi=!1}h0a(){l.AFrameworkApplication.pa.processAction(ba.a.xac,
2)}dvd(){this.Wmh&&!this.It&&(this.It=this.wEa())}Pvd(){if(this.It&&this.It.isVisible){var a=Object(ha.a)(Fm.Control,this.It.controls["ExternalContentFloatie.FlyoutAnchor"]);a.behavior.ev(a.zab(),1,null)}a=document.getElementById("ExternalContentFloatieFlyout");if(null==a)r.ULS.shipAssertTag(555816415,324,!1,"ExternalContentFloatieEventManger.onOnlyKeyPressed: externalContentFloatieUIElement is null.");else{var c=a.getBoundingClientRect();0<c.top&&c.bottom<window.innerHeight&&(c=a.getAttribute(we.a.Dmd)||
"",we.a.$H===c&&a.click())}}Yqa(){return this.kL.Yqa}}Object(w.a)($K,"ExternalContentFloatieManager",jk,[]);class mr{constructor(){this.$b=null;mr.gBl()}get qb(){return this.$b||(this.$b=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}get key(){return"FORMATTING_PARAGRAPH"}get $u(){return null}Icc(a){var c=null;if(!sd.ParagraphReader.eg(a))return{returnValue:!1,Jha:c};if((a=this.qb.um(a.currentNode))&&2===this.qb.Gv(a)){const h=this.qb.oe(a);mr.zN.contains(h)&&(c=this.qb.pC(a),c=Object.assign(new bt.a,
{mE:this.key,contentId:a.id,contentObject:c}))}return{returnValue:!!c,Jha:c}}Lwb(a,c){let h=null;c&&a.contentId.equals(c.contentId)||(h=a.contentObject);return h}static gBl(){mr.zN=new dm.a;mr.zN.add(gj.StyleReader.styleIdHeading1);mr.zN.add(gj.StyleReader.styleIdHeading2);mr.zN.add(gj.StyleReader.styleIdHeading3);mr.zN.add(gj.StyleReader.eta);mr.zN.add(gj.StyleReader.yNa);mr.zN.add(gj.StyleReader.zNa);mr.zN.add(gj.StyleReader.ibc);mr.zN.add(gj.StyleReader.x0a);mr.zN.add(gj.StyleReader.wordStyleIdHeading1);
mr.zN.add(gj.StyleReader.wordStyleIdHeading2);mr.zN.add(gj.StyleReader.wordStyleIdHeading3);mr.zN.add(gj.StyleReader.F1a);mr.zN.add(gj.StyleReader.G1a);mr.zN.add(gj.StyleReader.H1a);mr.zN.add(gj.StyleReader.Cjb);mr.zN.add(gj.StyleReader.Djb);mr.zN.add(gj.StyleReader.I1a);mr.zN.add(gj.StyleReader.rJb);mr.zN.add(gj.StyleReader.Odc)}}mr.zN=null;Object(w.a)(mr,"ParagraphStyleDetailsProvider",null,[745,431]);class aL{constructor(a,c,h,v){this.BEa=a;this.ilj=c;this.qlj=h;this.rlj=v}aJf(){this.BEa.execute(a=>
{a.L8b(this.ilj.value);a.L8b(new mr);a.L8b(this.rlj.value);a.j1(this.qlj.value)})}}Object(w.a)(aL,"AccessibilityActor",null,[]);class bL{constructor(a,c,h){this.rd=null;this.ga=a;this.C3a=c;this.fb=h}eb(){if(l.AFrameworkApplication.K.$("UIDiscoverabilityEnabled")){var a=qc.KeyInputManager.mb(vb.a.Ojb,5);this.fb.fd(Fc.AFrame.Mp).Bp(a);this.fb.fd(Fc.AFrame.uo).bindAction(a,Sa.a.oWc);this.ga.ka(Sa.a.oWc,Kc.a.frame,Object(m.a)(this,this.oWc,"showAccessibilityHelpDialog"));this.ga.ka(Sa.a.stc,Kc.a.frame,
Object(m.a)(this,this.aMg,"accHelpDialogTabFocusHandler"));this.ga.ka(Sa.a.rtc,Kc.a.frame,Object(m.a)(this,this.aMg,"accHelpDialogTabFocusHandler"))}}oWc(a,c,h){if(1===h)return 32;this.rd=this.C3a.value.xfk(this.fb);if(!this.rd)return r.ULS.sendTraceTag(21233673,334,10,"AccessibilityHelpDialog failed to initialize"),8;this.rd.mNa();return 32}aMg(a){return this.rd?this.rd.frl(a):2}}Object(w.a)(bL,"AccessibilityHelpDialogActor",null,[]);var YP=b(914),ZP=b(1217);class cL{constructor(a,c){this.Bgj=a.vb("WordHangForActionManagerThresholdTime",
750);this.ga=c;this.F6i=YP.a.MD(26,5,new ZP.a)}P9(){this.ga.P9(this)}Cda(){}Ada(a){const c=+a.endTime-+a.startTime;if(c>this.Bgj){let h="";switch(a.behavior){case 1:h="E";break;case 2:h="X";break;case 3:h="A"}(a=Le.ActionManager.gwa(a.actionId))&&a.length||(a="UnknownAction");this.F6i.track(c,a+"_"+h)}}}Object(w.a)(cL,"ActionHangDetector",null,[43]);class gH{constructor(a,c){this.qle=this.qaa=null;this.ga=a;this.C4a=c;if(this.Nqf=l.AFrameworkApplication.K.$("HandleRaceConditionInHostManagerInit"))this.qle=
oz.a.create();this.tu=xa.a.instance.za("Common.ISystemInitiatedFeedback")}get VU(){return this.qaa}eb(){this.ga.Aa(Sa.a.close,Kc.a.frame,Object(m.a)(this,this.closeDocument,"closeDocument"),2176);this.ga.Aa(Sa.a.wBc,Kc.a.frame,Object(m.a)(this,this.wBc,"fileProperties"),128);this.ga.ka(Sa.a.M$a,Kc.a.frame,Object(m.a)(this,this.M$a,"fileSharing"));this.ga.Aa(Sa.a.copyAndEdit,Kc.a.frame,Object(m.a)(this,this.copyAndEdit,"copyAndEdit"),128);this.ga.Aa(Sa.a.XEb,Kc.a.frame,Object(m.a)(this,this.XEb,"replyWithChanges"),
128);this.ga.Aa(Sa.a.AHi,Kc.a.frame,Object(m.a)(this,this.elh,"fileVersion"),128);this.ga.ka(Sa.a.downloadACopy,Kc.a.frame,Object(m.a)(this,this.downloadACopy,"downloadACopy"));this.ga.ka(Sa.a.Kfh,Kc.a.frame,Le.ActionManager.De);this.ga.Aa(Sa.a.uLf,Kc.a.frame,Object(m.a)(this,this.uLf,"reportAbuseLink"),128);this.ga.Aa(Sa.a.I2d,Kc.a.frame,Object(m.a)(this,this.XTf,"signInInternal"),128);this.ga.ka(Sa.a.workflow,Kc.a.frame,Object(m.a)(this,this.workflow,"workflow"));l.AFrameworkApplication.K.$("DocumentNameInJewelInfoMenuIsEnabled")&&
this.ga.Aa(Sa.a.rGf,Kc.a.frame,Object(m.a)(this,this.rGf,"queryBreadcrumbDocName"),96);this.ga.Aa(Sa.a.vGf,Kc.a.frame,Object(m.a)(this,this.vGf,"queryCopyAndEditButton"),96);l.AFrameworkApplication.K.$("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.ga.Aa(Sa.a.FVd,Kc.a.frame,Object(m.a)(this,this.FVd,"queryBuildVersion"),2144),this.ga.Aa(Sa.a.oWd,Kc.a.frame,Object(m.a)(this,this.oWd,"querySessionId"),2144));this.ga.ka(Sa.a.iWb,Kc.a.frame,Object(m.a)(this,this.iWb,"conversation"));this.C4a.execute(Object(m.a)(this,
this.Ryf,"onHostPostmessengerCreated"));r.ULS.sendTraceTag(536987588,306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}Ryf(a){this.qaa=a;this.Nqf&&(this.qle.instance=a);r.ULS.sendTraceTag(536987589,306,this.VU?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.VU))}E7l(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateSharingComplexity",!1)&&this.tu&&this.tu.execute(a=>{a.logActivity("CollabCornerSurveyLogSharingCommandActivity",
"CollabCornerFloodgateSurveysIsEnabled")})}closeDocument(a,c,h,v,B){a=2===h;h=pf.h;B&&(h=B);return c&&a&&!this.Zmd(h)?8:this.r8j(a,h)}Zmd(){return!0}r8j(a,c){if(l.AFrameworkApplication.na.Ya.WRf("3033402446"))return r.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),this.Rsa(a,E.a.Skh,!0,{});if(l.AFrameworkApplication.rTc&&c&&c===pf.f)return r.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),
l.AFrameworkApplication.na.T0(a,l.AFrameworkApplication.rTc);if(l.AFrameworkApplication.$Ja)return a&&r.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(l.AFrameworkApplication.l3g){if(!a)return 32;r.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");try{return window.top.close(),32}catch(B){return r.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",B),8}}let h=l.AFrameworkApplication.Mpd;
if(!h)return a&&r.ULS.sendTraceTag(6070361,306,50,"CloseDocumentInternal - no closeUrl found"),8;c||(c=pf.h);if(c===pf.c||c===pf.h)return l.AFrameworkApplication.na.T0(a,h);let v;if(l.AFrameworkApplication.qgb)return a&&r.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),v=c===pf.d||c===pf.b?this.Rsa(a,E.a.XEb,l.AFrameworkApplication.j_c,{["event_source"]:c}):2,32!==v?(h=c?Af.a.oo(l.AFrameworkApplication.qgb,pf.e,c):l.AFrameworkApplication.qgb,l.AFrameworkApplication.na.T0(a,
h)):v;a&&r.ULS.sendTraceTag(6070363,306,50,"CloseDocumentInternal - Using FileClose postmessage");v=c===pf.b?this.Rsa(a,E.a.Skh,l.AFrameworkApplication.a1f,null):2;return 32!==v?l.AFrameworkApplication.na.T0(a,h):v}XTf(a,c,h,v,B){a=this.Rsa(2===h,E.a.I2d,!0,B);8===a&&(window.top.location=l.AFrameworkApplication.signInUrl,a=32);return a}wBc(a,c,h){a=this.Rsa(2===h,E.a.wBc,l.AFrameworkApplication.RWi,null);return 32!==a?l.AFrameworkApplication.na.T0(2===h,l.AFrameworkApplication.alh):a}M$a(a,c,h,v,
B){if(1===h)return ya.SessionStatusManager.instance.gi?8:32;a=Sa.a.Dln;c=Ya.a.create().toString();v={};v.event_source=B;v[L.a.UVc]=c;var X=B?B.nav:null;X&&(v[L.a.Hln]=X);B&&"CopyLink"===B.SourceControlId&&(B.mode="copy",a=Sa.a.Cln);B&&"ManageAccess"===B.SourceControlId&&(B.mode="manageAccess",a=Sa.a.Eln);(X=B?B.mode:null)&&(v[L.a.Gln]=X);if(2===h){const ma={};ma[L.a.UVc]=c;X&&(ma.mode=X);r.ULS.sendTraceTag(38278995,306,50,z.c(ma));this.E7l()}c=this.Rsa(2===h,E.a.Sln,l.AFrameworkApplication.d1f,v);
if(32!==c){if(l.AFrameworkApplication.xBc)return B=B?Af.a.oo(l.AFrameworkApplication.xBc,pf.e,B):l.AFrameworkApplication.xBc,l.AFrameworkApplication.na.T0(2===h,B,!0);r.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{["Result"]:c})}re.c(a);return c}iWb(a,c,h){return this.Rsa(2===h,E.a.iWb,!0,{})}workflow(a,c,h){a=this.Rsa(2===h,E.a.workflow,l.AFrameworkApplication.n1f,{["WorkflowType"]:l.AFrameworkApplication.H8d});if(32!==a){if(l.AFrameworkApplication.I8d)return l.AFrameworkApplication.na.T0(2===
h,l.AFrameworkApplication.I8d,!0);r.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",{["Result"]:a})}return a}uLf(a,c,h){a=2===h;return c&&a&&!this.Zmd(pf.f)?8:l.AFrameworkApplication.na.T0(a,l.AFrameworkApplication.rTc)}copyAndEdit(a,c,h){a={};2===h&&(a=l.AFrameworkApplication.na.Ya.Ssh());a=this.Rsa(2===h,E.a.copyAndEdit,l.AFrameworkApplication.QWi,a);return 32!==a?l.AFrameworkApplication.na.T0(2===h,l.AFrameworkApplication.QSe,l.AFrameworkApplication.hideHeader):a}downloadACopy(a,
c,h){return 1===h?l.AFrameworkApplication.X4||l.AFrameworkApplication.Aja||ya.SessionStatusManager.instance.gi?8:32:l.AFrameworkApplication.na.T0(2===h,l.AFrameworkApplication.pvb,!0)}XEb(a,c,h){a=2===h;if(c&&a&&!this.Zmd(pf.d))return 8;c=this.Rsa(a,E.a.XEb,l.AFrameworkApplication.j_c,{["event_source"]:pf.d});return 32!==c?(c=Af.a.oo(l.AFrameworkApplication.qgb,pf.e,pf.d),l.AFrameworkApplication.na.T0(a,c)):c}elh(a,c,h){a=this.Rsa(2===h,E.a.aHk,l.AFrameworkApplication.e1f,null);return 32!==a?l.AFrameworkApplication.na.T0(2===
h,l.AFrameworkApplication.L1e):a}rGf(a,c,h,v,B){if(2===h){if(!B)return 8;B.Value=F.a.rI(l.AFrameworkApplication.Yr.Ry)}return 32}FVd(a,c,h,v,B){if(2===h){if(!B)return 8;B.Text=l.AFrameworkApplication.instance.Ltk}return 32}oWd(a,c,h,v,B){if(2===h){if(!B)return 8;B.Text=l.AFrameworkApplication.instance.Mtk}return 32}Rsa(a,c,h,v){return this.Nqf?this.X$m(a,c,h,v):h?a?this.VU.Qg(c,v)?32:8:32:2}X$m(a,c,h,v){return h?a?this.VU?this.VU.Qg(c,v)?32:8:(r.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),
this.qle.execute(()=>{r.ULS.sendTraceTag(528234242,306,50,"HostPostmessenger now available. Executing the request.");this.VU.Qg(c,v)}),32):32:2}vGf(a,c,h,v,B){if(2===h){if(!B)return 8;l.AFrameworkApplication.K.$("IsEditAndReplyFlow")&&(B.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}Object(w.a)(gH,"WebAppFrameCommandUIActor",null,[]);var AF;(function(a){a[a.Unknown=0]="Unknown";a[a.Excel=1]="Excel";a[a.OneNote=2]="OneNote";a[a.PowerPoint=3]="PowerPoint";a[a.Visio=4]="Visio";a[a.Word=5]="Word";
a[a.Project=6]="Project";a[a.Publisher=7]="Publisher";a[a.Infopath=8]="Infopath";a[a.Access=9]="Access"})(AF||(AF={}));Object(w.b)("OfficeApplication",AF);var sE;(function(a){a[a.ReadWrite=0]="ReadWrite";a[a.ReadOnly=1]="ReadOnly";a[a.WriteOnly=2]="WriteOnly";a[a.ForceCheckout=3]="ForceCheckout";a[a.WriteLocalCopy=4]="WriteLocalCopy";a[a.OpenInBrowser=5]="OpenInBrowser"})(sE||(sE={}));Object(w.b)("OpenDocumentMode",sE);class dL extends Qf{constructor(a){super(a,void 0,l.AFrameworkApplication.AUa,
new Eg(a,!1))}get NYa(){return CommonUIStrings.l_DownLoadACopyDialogMessageWorkOffline}get I4b(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get TLc(){return"DownloadCopyLink"}get buttonText(){return CommonUIStrings.l_DownloadACopyMin}get Iyc(){return l.AFrameworkApplication.AUa?"UIFontDialogTextLarge":null}Dpf(){r.ULS.sendTraceTag(7690388,324,50,"Download a copy dialog displayed")}Epf(){r.ULS.sendTraceTag(7690389,324,50,"Download a copy dialog clicked")}iMc(){r.ULS.sendTraceTag(19462214,
324,50,"Download a copy dialog button clicked");l.AFrameworkApplication.pa.processAction(Sa.a.Kfh,2)}}Object(w.a)(dL,"DownloadACopyDialog",Qf,[]);var eL=b(1583);const mD=a=>{for(let c=0;c<a.children.length;c++){const h=a.children[c];h.style.position="relative";h.style.top=(h.parentNode.offsetHeight-h.offsetHeight)/2+"px"}},BF=a=>a.Sa.keyCode===vb.a.Nq||a.Sa.keyCode===vb.a.gOa?(a.Ud.click(),!0):!1,tE=(a,c,h,v,B,X,ma)=>{const Pa=document.createElement("a");Pa.className="ProtocolLaunchingDialogButtonAnchor";
Pa.className+=" OICDialog";Pa.id=a;Pa.setAttribute(we.a.tg,we.a.v_);Pa.style.padding="0";Pa.style.margin="0";v&&fL(B,c,h,v,Pa);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=B;Pa.appendChild(a);Pa.tabIndex=0;X&&oi.a.instance.Ea(Jb.a.click,Pa,X);ma&&qc.KeyInputManager.instance.Ea(Jb.a.Hg,Pa,ma);return Pa},fL=(a,c,h,v,B)=>{var X=document.createElement("img");X.alt=a;X.className=Fd.getImageClassWithCluster(h,v);X.src=c;X.setAttribute(we.a.tg,we.a.Sx);a=
document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(X);X=document.createElement("span");X.className="ProtocolLaunchingDialogIconContainer";X.appendChild(a);B.appendChild(X)};class CF{static get vf(){return gg.a.fy(CF.ll,CommonUIStrings.l_OICLaunchDialogTitle)}}CF.ll="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(w.a)(CF,"OICLaunchDialogHtml",null,[]);class gL extends gg.a{constructor(a){super();this.xKb=this.vkb=null;this.YP=!1;this.lo=a;this.vf=CF.vf;this.yc=5;this.jf="OICLaunchDialog";this.showDialog("",Object(m.a)(this,this.Ijm,"oicLaunchDialogResultHandler"));this.UBi();this.n5("ProtocolLaunchingDialogTitle");4!==l.AFrameworkApplication.na.Ya.bIa&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.AY(this.vkb);r.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}cS(){this.vkb=tE("BtnRichClient",this.lo.Tzc,this.lo.bHc,this.lo.Pef,CommonUIStrings.l_OICLaunchRichClient,Object(m.a)(this,this.Hci,"onRichClientButtonClick"),BF);document.getElementById("OICLaunchRichClient").appendChild(this.vkb);mD(this.vkb);this.xKb=tE("BtnReturn",this.lo.Tzc,this.lo.bHc,this.lo.HLh,CommonUIStrings.l_OICReturnToOnlineClient,Object(m.a)(this,this.Dci,"onReturnButtonClick"),
BF);document.getElementById("OICReturnToApp").appendChild(this.xKb);mD(this.xKb)}Dci(){this.hide();this.lo.p9b();return!0}Hci(){r.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();l.AFrameworkApplication.pa.processAction(Sa.a.lFb,2);return!0}Ijm(){this.lo.p9b()}dispose(){this.YP||(this.vkb&&(oi.a.instance.xb(Jb.a.click,this.vkb,Object(m.a)(this,this.Hci,"onRichClientButtonClick")),qc.KeyInputManager.instance.xb(Jb.a.Hg,this.vkb,BF)),this.xKb&&(oi.a.instance.xb(Jb.a.click,
this.xKb,Object(m.a)(this,this.Dci,"onReturnButtonClick")),qc.KeyInputManager.instance.xb(Jb.a.Hg,this.xKb,BF)),super.dispose(),this.YP=!0)}}Object(w.a)(gL,"OICLaunchDialog",gg.a,[]);class DF{static get vf(){return gg.a.fy(DF.ll,CommonUIStrings.l_OICDialogTitle)}}DF.ll="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(w.a)(DF,"ProtocolLaunchingDialogV2Html",null,[]);class hL extends gg.a{constructor(a){super();this.wKb=this.COa=null;this.YP=!1;this.J2a=null;this.lo=a;this.vf=DF.vf;this.yc=5;this.jf="ProtocolLaunchingDialog";this.HLb="OICRetryDialog";l.AFrameworkApplication.Cb.oyb&&l.AFrameworkApplication.Cb.restart();l.AFrameworkApplication.Cb.ub(new Se.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(m.a)(this,this.jGf,"protocolLaunchingDialogResultHandler"));this.UBi();this.n5("Issues");
this.pnh();r.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}cS(){const a=document.getElementById("Issues");if(a){fL("",this.lo.Tzc,this.lo.bHc,this.lo.Pef,a);const c=document.createElement("span");c.className="WACDialogSectionTitle";c.innerText=5===this.lo.mei?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(c);mD(a);a.style.display="none"}l.AFrameworkApplication.na.Ya.Ibf?
(this.wKb=tE("GiveFeedback",this.lo.Tzc,this.lo.bHc,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(m.a)(this,this.YQd,"onGiveFeedbackClick"),Object(m.a)(this,this.Dai,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.wKb),mD(this.wKb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===l.AFrameworkApplication.na.Ya.bIa||l.AFrameworkApplication.Juk?document.getElementById("ButtonEdit").style.display="none":(this.COa=
tE("Edit",this.lo.Tzc,this.lo.bHc,"",2===l.AFrameworkApplication.na.Ya.Rm?4===l.AFrameworkApplication.na.Ya.bIa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===l.AFrameworkApplication.na.Ya.bIa?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(m.a)(this,this.aai,"onEditClick"),Object(m.a)(this,this.eai,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.COa),mD(this.COa));0===l.AFrameworkApplication.na.Ya.bIa&&
!l.AFrameworkApplication.Ckf&&a&&(a.style.display="none")}qnh(){return this.J2a?(this.AY(this.J2a),!0):!1}pnh(){return this.COa?(this.AY(this.COa),!0):!1}eai(a){return this.Nxf(a,0)}Dai(a){return this.Nxf(a,2)}Cci(a){return this.Nxf(a,1)}Nxf(a,c){let h=!1;if(a.Sa.keyCode===vb.a.Nq||a.Sa.keyCode===vb.a.gOa)a.Ud.click(),h=!0;else if(a.Sa.keyCode===Sys.UI.Key.down||a.Sa.keyCode===Sys.UI.Key.up)switch(c){case 1:h=this.pnh();break;case 0:h=this.qnh()}return h}aai(){this.hide();4===l.AFrameworkApplication.na.Ya.bIa?
(r.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.lo.p9b()):(r.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.lo.HFc());return!0}YQd(){r.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}ozf(){zP.Redirect.showHelp("OICFailure");return!0}QRd(){r.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";l.AFrameworkApplication.pa.processAction(Sa.a.lFb,2);return!0}jGf(){this.lo.p9b()}switchToBackupMode(){var a=
document.getElementById("ProtocolLaunchingDialogTitle");if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!a.children.length&&(this.J2a=tE("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(m.a)(this,this.QRd,"onRetryOICClick"),Object(m.a)(this,this.Cci,"onRetryOICKeyUp")),a.appendChild(this.J2a),mD(this.J2a),this.COa||this.qnh())}}dispose(){this.YP||(this.COa&&
(oi.a.instance.xb(Jb.a.click,this.COa,Object(m.a)(this,this.aai,"onEditClick")),qc.KeyInputManager.instance.xb(Jb.a.Hg,this.COa,Object(m.a)(this,this.eai,"onEditKeyUp"))),this.wKb&&(oi.a.instance.xb(Jb.a.click,this.wKb,Object(m.a)(this,this.YQd,"onGiveFeedbackClick")),qc.KeyInputManager.instance.xb(Jb.a.Hg,this.wKb,Object(m.a)(this,this.Dai,"onGiveFeedbackKeyUp"))),this.J2a&&(oi.a.instance.xb(Jb.a.click,this.J2a,Object(m.a)(this,this.QRd,"onRetryOICClick")),qc.KeyInputManager.instance.xb(Jb.a.Hg,
this.J2a,Object(m.a)(this,this.Cci,"onRetryOICKeyUp"))),super.dispose(),this.YP=!0)}}Object(w.a)(hL,"ProtocolLaunchingDialog",gg.a,[]);class EF extends oe.StandardDialog{constructor(a){super();this.lo=a;this.jf="ProtocolLaunchingDialog";l.AFrameworkApplication.Cb.oyb&&l.AFrameworkApplication.Cb.restart();l.AFrameworkApplication.na.Ya.Ibf&&this.tDj(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(m.a)(this,this.YQd,"onGiveFeedbackClick"));EF.nIh?(this.yc=12,this.Nd(1,CommonUIStrings.l_CloseFile),
this.Nd(2,CommonUIStrings.l_OICDialogContinueHere),this.Nd(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.yc=4,this.Nd(1,CommonUIStrings.l_OICDialogContinueHere),this.Nd(2,CommonUIStrings.l_OICDialogLaunchAgain));this.feb(CommonUIStrings.l_OICDialog2ndTitle,5===this.lo.mei?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(m.a)(this,this.jGf,"protocolLaunchingDialogResultHandler"),null)}YQd(a){r.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.lai(a)}QRd(){r.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");l.AFrameworkApplication.pa.processAction(Sa.a.lFb,2)}jGf(a){EF.nIh?3===a?this.lvi():2===a||0===a?this.continueEditing():1===a&&this.closeDocument():2===a?this.lvi():(1===a||0===a)&&this.continueEditing()}closeDocument(){r.ULS.sendTraceTag(577783557,211,50,"Closing the document");l.AFrameworkApplication.pa.hb(Sa.a.close,2,pf.a)}lvi(){r.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(m.a)(this,this.QRd,
"onRetryOICClick"),0)}continueEditing(){4===l.AFrameworkApplication.na.Ya.bIa||l.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&1===l.AFrameworkApplication.na.mode?(r.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.lo.p9b()):(r.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.lo.HFc())}static get nIh(){return l.AFrameworkApplication.K.$("OICDialogThreeActions")&&32===l.AFrameworkApplication.pa.processAction(Sa.a.close,
1)}}Object(w.a)(EF,"StandardProtocolLaunchingDialog",oe.StandardDialog,[]);class iL{}Object(w.a)(iL,"EditDocumentInClientParams",null,[]);class hH{static fgh(a,c,h,v,B,X,ma=!1,Pa=!1,mb="",Tb=!1,rc=!1,Tc=!1,vd="",ee="",Ie="",Xe=!1){const Yf=new iL;Yf.DocumentUrl=a;Yf.Mode=c;Yf.Options=h;Yf.Application=v;Yf.SilentExternalHandler=ma;Yf.EncodeUrl=Pa;Yf.CorrelationIdForWinClient=mb;Yf.NavigateUsingWindowOpen=Tb;Yf.DescriptiveUnattemptedEnums=rc;Yf.NoBrowserModalDialogs=Tc;Yf.SessionOrigin=vd;Yf.CorrelationId=
ee;Yf.ClickTime=Ie;Yf.NewTelemetryDataIsEnabled=Xe;MSOJS.ClientUtils.EditDocumentInClient(Yf,B,X)}}Object(w.a)(hH,"ClientUtils",null,[]);var jL=b(844);class EA{constructor(a){this.fRa=this.iic=this.kgc=null;this.rjc=!1;this.Yre=this.$wg=null;this.D2c=this.wZ=this.Ufd="";this.application=this.eD=0;this.pzn=this.lWf=!1;this.LSn=a&&l.AFrameworkApplication.K.$("OICLaunchDialogIsEnabled");l.AFrameworkApplication.pa.j8(Sa.a.lFb)||l.AFrameworkApplication.pa.ka(Sa.a.lFb,Kc.a.frame,Object(m.a)(this,this.n4m,
"retryOpenInClientAction"));this.SIi=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("SilentExternalHandler")}get mei(){return this.eD}Bhm(){let a,c;if(!l.AFrameworkApplication.K)return 0;switch((l.AFrameworkApplication.K.Ga(l.AFrameworkApplication.Wea)||"").toLowerCase()){case "teams":a=524288;break;case "onedrive":a=131072;break;case "owa":a=262144;break;case "assignments":a=65536;break;default:a=0}switch((l.AFrameworkApplication.K.Ga("FileSource")||"").toLowerCase()){case "exchangeonline":c=
1;break;case "exchangeonlineconsumer":c=2;break;case "onedrivewopi":c=4;break;case "sharepointonline":c=8;break;default:c=0}return c|a}n4m(a,c,h){return c.contextId!==Kc.a.frame?2:1===h?32:this.lFb()}get options(){let a=0;l.AFrameworkApplication.r1m&&(a|=1);l.AFrameworkApplication.rei&&(a|=4);this.izn()&&(a|=64);return a}izn(){return!(2===this.application&&l.AFrameworkApplication.K.$("IsEmbeddedScenario"))}get Tzc(){return l.AFrameworkApplication.qp}get bHc(){return l.AFrameworkApplication.zO}get HLh(){return""}get Pef(){return""}get ozn(){return l.AFrameworkApplication.K.$("OneNoteMobileViewerIsEnabled")}get ICn(){return this.$wg||
(this.$wg=xa.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.lWf||this.KDk()}p9b(){this.pzn||this.Ajh()}cni(a){return this.LSn&&H.a.sh?(new gL(this),32):this.R4g(a)}R4g(a){const c=({Nib:a}=this.BXl(a)).returnValue;r.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===c,a);return c}begin(a,c,h,v,B,X){this.kgc=a;this.iic=c;this.fRa=X;this.application=h;this.eD=v;return l.AFrameworkApplication.Qfh?(this.DZh(),32):l.AFrameworkApplication.yra&&!l.AFrameworkApplication.xKh?
(l.AFrameworkApplication.GTf(),8):this.PVg(B)}get Hjm(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}lFb(){this.Hjm&&this.s2l();return this.R4g(this.rjc)}nzi(){const a=new jL.a(E.a.openInClient);a.Values["ui-language"]=l.AFrameworkApplication.lcid.toString();a.Values[YC.a.wah]=l.AFrameworkApplication.userSessionId;return this.fRa.value.send(a)?32:8}s2l(){Fa.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new pb.a,{inStaging:!0}))}nan(a){const c=new jL.a(E.a.wVn);c.Values["ui-language"]=l.AFrameworkApplication.lcid.toString();c.Values[YC.a.wah]=l.AFrameworkApplication.userSessionId;c.Values[L.a.vVn]=a;this.fRa.value.send(c)}BXl(a){this.rjc=a;this.nan(5===this.eD?EA.lvm:EA.rvm);return 5===this.eD?this.zXl():this.EXl()}zXl(){this.MZh();return{returnValue:32,Nib:"HostEditUrl,"}}EXl(){let a;var c=a="";l.AFrameworkApplication.LOg&&(c="|f|"+l.AFrameworkApplication.userSessionId);
const h=l.AFrameworkApplication.K.$("IsAssignmentMode")&&l.AFrameworkApplication.K.$("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||l.AFrameworkApplication.LKc||H.a.AKa,v=l.AFrameworkApplication.K.$("UnattemptedEnumIsEnabled"),B=l.AFrameworkApplication.K.$("NoBrowserModalDialogs");if(l.AFrameworkApplication.pa.zPd){var X=l.AFrameworkApplication.pa.Cca(3588168074);X&&(this.Ufd=String.format("{0}{1}{2}",EA.jbn.toString(),"_",this.Bhm().toString()),this.wZ=X.correlationId?X.correlationId:
"",this.D2c=X.TriggerTime?X.TriggerTime:"")}if(l.AFrameworkApplication.Nii){a+="NewOrder,";X=8;this.fRa&&this.fRa.value&&this.fRa.value.isEnabled()&&l.AFrameworkApplication.ndc&&(a+="Post,",X=this.nzi());if(32===X)return{returnValue:X,Nib:a};r.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return l.AFrameworkApplication.Yr.ska?(r.ULS.shipAssertTag(5566816,211,!!l.AFrameworkApplication.Yr.ska),a+="HostUrl,",{returnValue:l.AFrameworkApplication.na.T0(!0,
l.AFrameworkApplication.Yr.ska),Nib:a}):this.kgc?(r.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",l.AFrameworkApplication.userSessionId),a+="DocUrl,",hH.fgh(this.kgc,this.eD,this.options,this.application,Object(m.a)(this,this.dai,"onEditInClientSuccess"),Object(m.a)(this,this.cai,"onEditInClientFailure"),this.SIi,l.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),c,h,v,B,this.Ufd,this.wZ,this.D2c,l.AFrameworkApplication.pa.zPd),{returnValue:32,Nib:a}):{returnValue:8,
Nib:a}}a+="OldOrder,";if(!this.kgc&&l.AFrameworkApplication.Yr.ska)return this.fRa&&this.fRa.value&&this.fRa.value.isEnabled()&&l.AFrameworkApplication.ndc?(a+="Post,",c=this.nzi()):(r.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),c=8),32!==c?(r.ULS.shipAssertTag(22595484,211,!!l.AFrameworkApplication.Yr.ska),a+="HostUrl,",{returnValue:l.AFrameworkApplication.na.T0(!0,l.AFrameworkApplication.Yr.ska),Nib:a}):{returnValue:c,Nib:a};r.ULS.sendTraceTag(22595485,
211,15,"Try to open doc in rich client, SessionId {0}",l.AFrameworkApplication.userSessionId);a+="DocUrl,";hH.fgh(this.kgc,this.eD,this.options,this.application,Object(m.a)(this,this.dai,"onEditInClientSuccess"),Object(m.a)(this,this.cai,"onEditInClientFailure"),this.SIi,l.AFrameworkApplication.K.$("OICEncodeUrlIsEnabled"),c,h,v,B,this.Ufd,this.wZ,this.D2c,l.AFrameworkApplication.pa.zPd);return{returnValue:32,Nib:a}}s0m(a){l.AFrameworkApplication.$k.setDw(8981,a)}dai(a){this.s0m(a);r.ULS.sendTraceTag(18715406,
211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?(this.ozn||this.MZh(),this.h6l()):this.lWf||this.closeApplication()}cai(a,c=0){r.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,c);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const h=!!this.iic&&!this.rjc;let v=0;1===a&&(v=2);6<=a&&13>=a&&(v=1,1===c&&(this.lWf=!0));this.ICn.qjm?(r.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",
v),eL.a.instance.fkk(this.rjc?Object(m.a)(this,this.n9h,"oicErrorDialogHandlerCloseForced"):Object(m.a)(this,this.o9h,"oicErrorDialogHandlerNoCloseForced"),h?Object(m.a)(this,this.cbi,"onLaunchDownload"):null,this.Odh(!1)?Object(m.a)(this,this.xwl,"iHaveOfficeButtonHandler"):null,v,c)):(r.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",v),eL.a.instance.dkk(this.rjc?Object(m.a)(this,this.n9h,"oicErrorDialogHandlerCloseForced"):Object(m.a)(this,this.o9h,"oicErrorDialogHandlerNoCloseForced"),
h?Object(m.a)(this,this.cbi,"onLaunchDownload"):null,v))}}h6l(){try{const a=[Object.assign(new aa.a,{name:"CorrelationId",string:this.wZ}),Object.assign(new aa.a,{name:"SessionOrigin",string:this.Ufd}),Object.assign(new aa.a,{name:"ClickTime",string:this.D2c}),Object.assign(new aa.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];re.a("OpenInClientCompleted",!0,0,a)}catch(a){r.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}MZh(){l.AFrameworkApplication.na&&
l.AFrameworkApplication.na.Ya.fA&&l.AFrameworkApplication.K.$("StandardProtocolDialogIsEnabled")?new EF(this):new hL(this)}n9h(){this.closeApplication()}o9h(){this.p9b()}cbi(){this.DZh()}xwl(){return this.Odh(!0)}Odh(a){const c=(H.a.LXa||H.a.so)&&!!l.AFrameworkApplication.Etd;c&&a&&(Ve.a.Ql(l.AFrameworkApplication.Etd,"_blank",void 0,"OpenInClient"),this.closeApplication());return c}}EA.rvm="OpenInDesktop";EA.lvm="OpenInBrowser";EA.jbn=Ya.a.Ee("B5F65EF9-A5B1-4887-A968-C779537C8303");Object(w.a)(EA,
"AOpenInClientOperation",null,[]);class iH extends EA{constructor(a,c,h=!1){super(h);this.Ghj=a;this.Fhj=c}get HLh(){return this.Fhj}get Pef(){return this.Ghj}KDk(){l.AFrameworkApplication.pa.hb(Sa.a.close,2,pf.a)}Ajh(){}PVg(a){return this.cni(a)}DZh(){r.ULS.shipAssertTag(5566817,211,!!this.iic);l.AFrameworkApplication.L8?l.AFrameworkApplication.na.T0(!0,this.iic):Ve.a.Ql(this.iic,void 0,void 0,"LaunchDownload")}HFc(){l.AFrameworkApplication.na.Ya.HFc()}}Object(w.a)(iH,"OpenInClientOperation",EA,
[]);class kL extends iH{constructor(){super("Word_32x32x32","EditInWordWebApp_32x32x32",!0)}kTj(a){Eb.App.aj.rLa.BO||Eb.App.lc.xz.Kn?(r.ULS.sendTraceTag(50857159,211,15,"Saving skipped due to document loading failure"),this.Cei(a)):pu.a.jO(4,!0,Object(m.a)(this,this.VUm,"releaseLockOnSuccess"),null,a)}VUm(a){r.ULS.sendTraceTag(50857160,211,50,"Saving finished. Release lock before open in client");Eb.App.QY.forceOutbound(Object(m.a)(this,this.Cei,"openWordClient"),Object(m.a)(this,this.Y1l,"lockReleaseFailed"),
a)}Y1l(a){r.ULS.sendTraceTag(50857161,211,15,"Lock release failed.");const c=new oe.StandardDialog;c.yc=0;c.Fw(Qk.a.cKn,CommonUIStrings.l_DefaultDialogTitle,WordEditorIntl.WordEditorStrings.l_UnlockFailed,a?Object(m.a)(this,this.W1l,"lockReleaseErrorDismissedCloseForced"):Object(m.a)(this,this.X1l,"lockReleaseErrorDismissedCloseNoForced"))}W1l(){l.AFrameworkApplication.pa.hb(Sa.a.close,2,pf.c)}X1l(){Eb.App.oa.refreshDocument(null)}Cei(a){l.AFrameworkApplication.sbc=!0;r.ULS.sendTraceTag(50857162,
211,50,"Saving finished. Ready to OpenWordClient with forceClose: {0}.",a);this.cni(a)}PVg(a){this.kTj(a);return 32}Ajh(){Eb.App.oa.refreshDocument(null)}}Object(w.a)(kL,"OpenInWordOperation",iH,[]);const lL=(a,c)=>{r.ULS.sendTraceTag(41186076,306,50,"Toggling readonly recommended setting for the document.");a[Uf.a.On]=vg.PageReader.instance.zt(c);vg.PageReader.instance.zt(c)?a[Uf.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOn:a[Uf.a.Description]=WoncaIntl.WoncaStrings.L_ProtectDocumentDescriptionOff},
$P=(a,c,h,v,B)=>{if(!Eb.App.oa||!Eb.App.oa.Da||!l.AFrameworkApplication.qo.iab)return 8;c=Eb.App.oa.Da.Zb;if(!c)return 8;if(a===zb.a.zVd&&2===h){a=new gf.GraphTransaction(15);try{a.Oa(c),vg.PageReader.instance.rEn(c)}finally{a&&a.dispose()}lL(B,c)}return 32},aQ=(a,c,h,v,B)=>{if(!Eb.App.oa||!Eb.App.oa.Da)return 8;a=Eb.App.oa.Da.Zb;if(!a)return 8;B[Uf.a.Alt]=l.AFrameworkApplication.qo.iab?"":CommonUIStrings.l_ProtectDocumentToolTip;lL(B,a);return 32};class mL extends gH{constructor(a,c){super(a,c);
this.Xpg=!1}eb(){super.eb();this.ga.ka(zb.a.openInClient,Kc.a.frame,Object(m.a)(this,this.Ibi,"onOpenExternal"));l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OICExtendedTelemetryIsEnabled",!1)&&this.ga.Qb(zb.a.openInClient,12288);var a=this.ga;a.Aa(zb.a.zVd,ic.a.application,$P,4);a.Aa(zb.a.eHf,ic.a.application,aQ,96);this.ga.ka(Sa.a.rBf,Kc.a.frame,Object(m.a)(this,this.Ibi,"onOpenExternal"))}Ibi(a,c,h,v,B){if(c.contextId!==Kc.a.frame)return 2;
if(!(Eb.App.Hwc||l.AFrameworkApplication.Yr.ska||l.AFrameworkApplication.ndc||this.Xpg))return r.ULS.sendTraceTag(50857163,211,15,"OIC entry is hidden"),this.Xpg=!0,8;if(1===h)return ya.SessionStatusManager.instance.gi?8:32;c=!1;void 0!==B&&null!==B&&(c=B);r.ULS.sendTraceTag(50857164,211,50,"OpenInClient begin. Expect saving starting soon.");return(new kL).begin(Eb.App.Hwc,l.AFrameworkApplication.pvb,AF.Word,a===Sa.a.rBf?sE.OpenInBrowser:sE.WriteOnly,c,new qf.a(()=>this.VU))}Zmd(a){return xj.a.instance.Pwa()?
!0:Eb.App.oa.Swi(1,If.AppFrame.s8j,a)}downloadACopy(a,c,h,v,B){if(2===h){if(!l.AFrameworkApplication.pvb&&!l.AFrameworkApplication.na.Ya.WRf(Sa.a.downloadACopy.toString()))return 8;pu.a.jO(2,!0,Object(m.a)(this,this.Gwk,"doDownloadACopy"),null,B);return 32}return super.downloadACopy(a,c,h,v,B)}Gwk(a){if(!l.AFrameworkApplication.LKc&&l.AFrameworkApplication.na.Ya.WRf(Sa.a.downloadACopy.toString()))this.Rsa(!0,E.a.download,!0,{});else if(l.AFrameworkApplication.K.$("WordEditorDownloadACopyUiIsEnabled")){let c=
l.AFrameworkApplication.pvb;a&&a.FileDownloadUrl&&(c=a.FileDownloadUrl.toString());new dL(c)}else super.downloadACopy(0,null,2,null,null)}workflow(a,c,h,v,B){return 2===h?(pu.a.jO(13,!0,Object(m.a)(this,this.J0j,"callWorkflow"),null,B),32):super.workflow(a,c,h,v,B)}J0j(a){super.workflow(0,null,2,null,a)}}Object(w.a)(mL,"AppFrameCommandUIActor",gH,[]);class nL extends oe.StandardDialog{constructor(){super();this.yc=0;this.feb(CommonUIStrings.l_WheresTheSaveButtonDialogTitle,CommonUIStrings.l_WheresTheSaveButtonDialogMessage,
"WheresTheSaveButtonDialogItem_32x32x32",CommonUIStrings.l_WheresTheSaveButtonDialogTitle,null,null)}}Object(w.a)(nL,"WheresTheSaveButtonDialog",oe.StandardDialog,[]);const bQ=(a,c,h)=>{if(1===h)return 32;new nL;return 32};var jH=b(527),FF=b(1268);class GF{constructor(a,c,h,v,B,X){this.yWg=this.CWg=null;this.zV=a;this.xWg=c;this.gUj=h;this.kUj=v;this.CWg=B;this.yWg=X}}Object(w.a)(GF,"BookmarkHighlightContext",null,[]);class $s extends So.a{constructor(a,c,h,v,B){var X,ma,Pa;super();this.f9i=50;this.qAg=
"px";this.T7i="aria-label";this.yDa="BookmarkIndicator";this.Rlg="HighlightBookmarkedContent";this.Ugj="HighlightBookmark";this.LPa="wwaengidc";this.Ba=a;this.Se=h;this.Bi=c;this.E2=v;this.Cx=B;this.OFg=null===(X=l.AFrameworkApplication.K)||void 0===X?void 0:X.getBooleanFeatureGate("Microsoft.Office.WordOnline.QueryBookmarkIndicatorOnSplit",!1);this.i9i=null===(ma=l.AFrameworkApplication.K)||void 0===ma?void 0:ma.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1);this.b9i=
null===(Pa=l.AFrameworkApplication.K)||void 0===Pa?void 0:Pa.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled",!1);this.Cx&&this.Cx.nld(this.gE.bind(this))}zmn(a){if(a.Fi){for(let c of a.Nf.rh)if(this.XRf(c))return!0;return!1}return this.XRf(a.htmlElement)}vGb(a){let c=!1;l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.BookmarksIsEnabled");this.i9i&&(l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.QueryBookmarkIndicatorOnSplit"),this.OFg?Fo.a.instance.$c(()=>
{c=this.zmn(a)},"BIA:SCIVE"):Fo.a.instance.$c(()=>{c=this.XRf(a.htmlElement)},"BIA:SCI"));return c}XRf(a){return $s.QAe?(a=a.querySelectorAll(".ParaWrappingDiv:not([style*='visibility: hidden;']) .BookmarkStart"))&&0<a.length?!0:!1:!1}aub(a){const c=[];Fo.a.instance.$c(()=>{const h=a.Tsb(0,this.f9i,this.zoom);c.push(this.dUa(a.P4,h,a.B_c[0].y-a.H8[0].y))},"BIA:CIs");return c}dUa(a,c,h){const v=a.Fe.ownerDocument,B=Tm.a.createElement(v,ri.a.div);B.className=$s.bag;B.style.left=c+this.qAg;B.style.top=
h+this.qAg;c=Tm.a.createElement(v,ri.a.SWa);c.src=uk.a.Ah($s.b2c);c.title="Bookmark";c.alt="Bookmark";c.setAttribute(this.T7i,"Bookmark");B.appendChild(c);a={context:new GF([],B,new Set,new Set,null,null),ojm:a,container:B};this.Bi.Ea(Jb.a.yK,c,this.onMouseEnter);this.Bi.Ea(Jb.a.bH,c,this.nka);this.Se.BC(Jb.a.click,B,this.eZa.bind(this),a);return B}p2g(){const a=Object.assign(new wh.a,{action:1,type:5,XD:null,LM:this.T2a});this.T2a=null;this.E2.LF(a)}gE(a,c){this.T2a&&(c.w$a.Ud.classList.contains("BookmarkHighlightSelected")||
this.p2g())}onMouseEnter(a){if(null==a)return!1;a=a.Ud;a.parentElement.classList.add($s.cag);a.src=uk.a.Ah($s.d9i);return!0}nka(a){if(null==a)return!1;a=a.Ud;a.parentElement.classList.remove($s.cag);a.src=uk.a.Ah($s.b2c);return!0}eZa(a){this.YZa(this.Rlg,this.Ugj);if(null==a){var c=new Map;c.set("Source",this.yDa);c=Object.assign(new fi.a,{Uu:c});Fa.Health.instance.recordKpiFailure(this.Rlg,"Unable to highlight bookmarked content",!1,!0,c);return!1}l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.BookmarkHighlightIsEnabled");
if(this.b9i){c=a.ho.context;if($s.sAb(c,this.T2a))return!0;c=this.H2k(a.ho.ojm,c,a.ho.container);a=Object.assign(new wh.a,{action:0,type:5,XD:c,LM:this.T2a});this.T2a=c;this.E2.LF(a);return!0}return!1}H2k(a,c,h){c={AWg:new Set,eCf:new Set,DWg:null,BMe:null};const v=this.Ba.ex(a.Ia,!0,!1);let B=[];if(v)for(let X of v)B.push(X);this.GEj(a,c,B);c=new GF(B,h,c.AWg,c.eCf,c.DWg,c.BMe);this.T2a&&this.T2a.zV===B&&(h.className+=String.format(" {0}",$s.e9i),this.T2a=c);return c}GEj(a,c,h){if(this.OFg&&a.Fi){var v=
new Set;for(let X of a.Nf.rh)X.querySelectorAll("*").forEach(v.add,v);a=Array.from(v.values())}else a=Array.prototype.slice.call(a.htmlElement.querySelectorAll("*"),0);let B=[];c.eCf.add(h[0].id);c.DWg=h[0].id;c.BMe=h[0].id;a.forEach(X=>{let ma=Di.a.Ra(X,lh.a.knd);if(ma)for(let Pa of ma)B.push(Pa),c.AWg.add(Pa);if(!B.length)return!0;X=Di.a.Ra(X,lh.a.Esb);if(!X)return!0;B=FF.a.ZXd(B,X)});for(v=a=this.Ba.jg(h[h.length-1],!1,!0);B.length&&a;){c.eCf.add(a.id);c.BMe=a.id;h.push(a);for(let X of v.aN)X.htmlElement.querySelectorAll("."+
lh.a.AMe).forEach(ma=>{(ma=Di.a.Ra(ma,lh.a.Esb))&&(B=FF.a.ZXd(B,ma))});v=a=this.Ba.jg(a,!1,!0)}}YZa(a,c){const h=new Map;h.set("Source",this.yDa);h.set("Action",c);Fa.Health.instance.recordKpiUsage(a,0,this.LPa,h)}static sAb(a,c){return!!c&&!!a&&a.xWg===c.xWg}}$s.cag="WordBookmarkIndicatorContainerHovered";$s.e9i="WordBookmarkIndicatorContainerSelected";$s.b2c="BookmarkDefault.png";$s.d9i="BookmarkHover.png";$s.QAe=!0;$s.bag="WordBookmarkIndicatorContainer";Object(w.a)($s,"BookmarkIndicatorActor",
So.a,[535]);class oL{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb=null,rc=null,Tc=null,vd=null,ee=null,Ie=null){this.naa="_";this.Abe="Bookmark";this.C8i=/^BOOKMARK\d+$/i;this.yDa="BookmarkRibbonOptions";this.$8i="BookmarkFloatieOptions";this.Jdg="CreateBookmarkOnRange";this.Kdg="CreateBookmarkOnView";this.Idg="CreateBookmarkOnIP";this.$ee="CreateBookmark";this.LPa="wwaengidc";this.dGg="ShowHideBookmarksOnDocument";this.Weg="DeleteBookmark";this.Nbj="DeleteBookmarkAction";this.jvj="ShowHideBookmarks";this.cGg=
"ShowBookmarksFloatie";this.gvj="ShowBookmarksFloatieAction";this.ygg="EditBookmark";this.Kcj="EditBookmarkAction";this.ivc="BookmarksUsage";this.pUj="InsertTabSwitchActivity";this.ZDl="Insert";this.UJb=a;this.ga=c;this.ya=h;this.tl=v;this.Mu=B;this.nN=X;this.Fb=ma;this.kL=Pa;this.tu=rc;this.aag=mb;this.yd=Tb;this.l2=ee;this.rn=Tc;this.Rb=vd;this.Cz=Ie}get wC(){return this.Mu.value}eb(){this.Ehf()&&(this.ga.ka(ba.a.LHa,ic.a.view,this.LHa.bind(this)),this.ga.Aa(Sa.a.FNa,ic.a.application,this.zGn.bind(this),
96),this.ga.ka(ba.a.LHa,ic.a.xc,this.ogk.bind(this)),this.ga.ka(ba.a.LHa,ic.a.Ub,this.ngk.bind(this)),this.ga.ka(ba.a.deleteBookmark,ic.a.view,this.deleteBookmark.bind(this)),this.ga.ka(ba.a.CZe,ic.a.view,this.Tyk.bind(this)),this.ga.Aa(ba.a.hHi,ic.a.view,this.qrn.bind(this),1028),this.ga.Aa(ba.a.EVd,ic.a.application,this.EVd.bind(this),96),this.ga.Aa(ba.a.V1d,ic.a.Ub,this.V1d.bind(this),1028),this.ga.Aa(zb.a.LLd,ic.a.view,this.LLd.bind(this),1028),this.ga.Aa(ba.a.lFd,ic.a.view,this.lFd.bind(this),
1028),this.ga.Qb(ba.a.LHa,1028))}zGn(a,c,h,v,B){return B&&B.NewContextId===this.ZDl?(this.T4b(this.pUj),32):2}LHa(a,c,h,v,B){if(this.ya.If.contextId===ic.a.anchoredObject)return 2;if(1===h)return Eb.App.mtb(c)?8:32;a=this.ya.Ca.Fa;if(this.yd.Cl(a))return 2;this.qMc(B,"User is trying to create bookmark from UILocation : {0}");this.YZa(this.Kdg,this.$ee);if(a&&this.tl.Ckd(this.kZb(),a))return this.T4b(this.ivc),32;B=new Map;B.set("Source",this.yDa);B=Object.assign(new fi.a,{Uu:B});Fa.Health.instance.recordKpiFailure(this.Kdg,
"Unable to create bookmark",!1,!0,B);return 8}ogk(a,c,h,v,B){if(1===h)return 32;if(ic.a.xc!==c.contextId)return 8;this.qMc(B,"User is trying to create bookmark from UILocation : {0}");a=this.ya.Ca.Fa;this.YZa(this.Jdg,this.$ee);if(this.tl.Ckd(this.kZb(),a))return this.T4b(this.ivc),32;a=new Map;a.set("Source",this.yDa);a=Object.assign(new fi.a,{Uu:a});Fa.Health.instance.recordKpiFailure(this.Jdg,"Unable to create bookmark for range",!1,!0,a);return 8}ngk(a,c,h,v,B){if(1===h)return 32;if(ic.a.Ub!==
c.contextId)return 8;this.qMc(B,"User is trying to create bookmark from UILocation : {0}");a=this.ya.Ca.Fa;this.yd.Cl(a)&&(c=a.sa,this.yd.gdb(c)?(a=this.yd.a0(c,!1),a||(r.ULS.sendTraceTag(542921105,3029,50,"User is trying to create bookmark at EOP"),a=this.yd.a0(c,!0))):r.ULS.sendTraceTag(542921106,3029,50,"Selection is not expandable to word. Bookmark will be added on IP"));this.YZa(this.Idg,this.$ee);if(this.tl.Ckd(this.kZb(),a))return this.T4b(this.ivc),32;a=new Map;a.set("Source",this.yDa);a=
Object.assign(new fi.a,{Uu:a});Fa.Health.instance.recordKpiFailure(this.Idg,"Unable to create bookmark for IP",!1,!0,a);return 8}EVd(a,c,h,v,B){1===h&&32;B[Uf.a.On]=$s.QAe;return 32}qrn(a,c,h,v,B){if(1===h)return 32;this.YZa(this.dGg,this.jvj);(a=B[Uf.a.On])||r.ULS.sendTraceTag(556889756,3029,50,"User hides bookmarks annotations on document");$s.QAe=a;a=jn.PageNavigator.instance.s0(this.wC);if(null!==a)return this.PRc(a),this.UJb.xE({ShowBookmarks:"CheckboxModel"}),32;a=new Map;a.set("Source",this.yDa);
a=Object.assign(new fi.a,{Uu:a});Fa.Health.instance.recordKpiFailure(this.dGg,"Unable to show/hide bookmark on document",!1,!0,a);return 8}deleteBookmark(a,c,h,v,B){if(this.Ehf()){a=this.ya.Ca.Fa.sa;a=this.tl.Uwb(a.node,a.cpBegin);if(1===h)return a?32:8;this.qMc(B,"User is trying to delete bookmark from UILocation : {0}");this.kL.Yqa&&(r.ULS.sendTraceTag(545118155,3029,50,"Dismissing the bookmarks floatie"),this.kL.Ty());this.YZa(this.Weg,this.Nbj);a||r.ULS.sendTraceTag(545118156,3029,50,"Delete bookmark called for a context where there were no bookmarks.");
if(a&&this.tl.NJf(a.id))return this.aag&&this.aag.p2g(),this.T4b(this.ivc),32;h=new Map;h.set("Source",this.yDa);h=Object.assign(new fi.a,{Uu:h});Fa.Health.instance.recordKpiFailure(this.Weg,"Unable to delete bookmark",!1,!0,h);return 8}return 2}Tyk(a,c,h,v,B){l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled");if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarkEditNameIsEnabled",!1)){a=this.ya.Ca.Fa.sa;
a=this.tl.Uwb(a.node,a.cpBegin);if(1===h)return a?32:8;this.qMc(B,"User is trying to edit bookmark from UILocation : {0}");this.kL.Yqa&&(r.ULS.sendTraceTag(539762822,3029,50,"Dismissing the bookmarks floatie"),this.kL.Ty());this.YZa(this.ygg,this.Kcj);a||r.ULS.sendTraceTag(539762823,3029,50,"Edit bookmark called for a context where there were no bookmarks.");if(a)return this.l2.value.Uyk(c,a,this.tl),this.T4b(this.ivc),32;c=new Map;c.set("Source",this.yDa);c=Object.assign(new fi.a,{Uu:c});Fa.Health.instance.recordKpiFailure(this.ygg,
"Unable to edit bookmark",!1,!0,c);return 8}return 2}qMc(a,c){a&&a.UILocation&&r.ULS.sendTraceTag(540386525,3029,50,c,a.UILocation)}V1d(a,c,h,v,B){l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.BookmarksFloatie");if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksFloatie",!1)){1===h&&32;this.YZa(this.cGg,this.gvj);if(c.contextId===ic.a.Ub)return a=Array(1),a.push("Bookmarks"),this.kL.showFloatie(B.location,a,1),32;B=new Map;
B.set("Source",this.$8i);B=Object.assign(new fi.a,{Uu:B});Fa.Health.instance.recordKpiFailure(this.cGg,"Unable to show bookmark floatie",!1,!0,B);return 8}return 2}LLd(a,c,h,v,B){let X;return 1===h?(Fo.a.instance.$c(()=>{X=this.ga.Le(c,zb.a.insertHyperlink,h,!0,v,B);32!==X&&(X=this.ga.Le(c,ba.a.LHa,h,!0,v,B))},"BA:LFE"),X):8}lFd(a,c,h){var v;if(1===h)return 32;if(a=this.ya.Ca.Fa){a=a.sa.node;if(c=this.$jh(a))return c.click(),32;r.ULS.sendTraceTag(539523265,3029,50,"No indicator found in current paragraph.");
if(a=this.tl.Uwb(a,0)){c=Us.a.isEnabled?this.Cz.mha.get(null===(v=a.id)||void 0===v?void 0:v.toString()):a.getValue(Yb.a.z5);v=jn.PageNavigator.instance.s0(this.wC).Mb.Ra(c);if(v=this.$jh(v))return v.click(),32;r.ULS.sendTraceTag(539523266,3029,50,"No indicator found for the paragraph in previous paragraphs.")}else r.ULS.sendTraceTag(539523267,3029,50,"No bookmark found enclosing the content.")}return 8}$jh(a){let c;a=this.rn.Al(a).kj(this.Rb.rc.gb);a.Mcb&&(a=a.htmlElement.querySelectorAll("div."+
$s.bag),0<a.length&&(c=a[0]));return c}PRc(a){const c=jH.b(a);if(c){var h=this.Fb.Ob(2);try{for(h.Oa(a);c.moveNext();){if(!sd.ParagraphReader.eg(c.iterator))continue;const v=c.currentNode;this.Yxk(v)&&this.nN.E1b(v,!0)}}finally{h&&h.dispose()}}}Yxk(a){for(let h=0;h<a.la.length;h++){const v=a.la.J(h);if(null!=v.Nh)for(let B=0;B<v.Nh.length;B++){var c=v.Nh.J(B);if(null!=c&&(c=a.Mb.Ra(c.zm).ia(Yb.a.Vr,""),!F.a.ve(c)&&!c.startsWith(this.naa)))return!0}}}kZb(){var a=this.tl.yCc(!1);let c=[];for(let h=
0;h<a.count;h++){let v=a.J(h).ia(Yb.a.Vr,"");this.C8i.test(v)&&c.push(v)}return 0<c.length?(c.sort((h,v)=>h.localeCompare(v,void 0,{numeric:!0})),a=parseInt(c[c.length-1].substring(this.Abe.length)),this.Abe+(a+1)):this.Abe+1}YZa(a,c){const h=new Map;h.set("Source",this.yDa);h.set("Action",c);Fa.Health.instance.recordKpiUsage(a,0,this.LPa,h)}T4b(a){this.Ehf()&&this.tu&&this.tu.execute(c=>{c.logActivity(a,null)})}Ehf(){l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.BookmarksIsEnabled");return l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)}}Object(w.a)(oL,"BookmarkActor",null,[]);class pL{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.io=c;this.fna=h;this.nd=v;this.Sq=B;this.Tb=X;this.Fb=ma;this.$b=Pa;this.ga=mb;this.Zij=Tb;this.ipe=rc}get cJl(){return this.Zij}eb(){this.ga.Aa(zb.a.YSf,ic.a.view,Object(m.a)(this,this.FCl,"insertContentControlPlaceholderTextByContentControlIdHandler"),96)}FCl(a,c,h,v,B){a=this.io.getById(B);if(!a)return 8;
c=a.contentControlNode;if(!c)return 8;if(c.ia(Yb.a.F3,!1))return 2;h=this.io.qWk(a);if(!h)return 8;v=this.Fb.Ob(7);v.Oa(h.node);if(!this.cJl)return(B=a.lUd)||(B=WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),this.Tb.replaceTextRange(h,B),this.vmd(a),c.setValue(Yb.a.F3,!0),v.dispose(),32;B=new uh.DictionaryPropertySet;B.setValue(Uc.a.uGh,h);var X=c.ia(Yb.a.lSe,"");X=this.fna.FFh(X);if(!X)return this.Sq.replaceTextRange(h,WordEditorIntl.WordEditorStrings.l_ContentControlPlaceholder),
this.vmd(a),c.setValue(Yb.a.F3,!0),v.dispose(),32;B.setValue(Uc.a.Jbf,X);if(1<X.length&&!a.Oe)return v.dispose(),8;this.Oek(B);c.setValue(Yb.a.F3,!0);v.dispose();return 32}vmd(a){const c=this.Sq.XAd(a.start.node,0<=a.start.cpBegin?a.start.cpBegin:0);c?this.ipe&&(a=this.$b.tw(a.start.node).zg("Placeholder Text"))&&(this.nd.yha(c.formatting),this.nd.qhb(c.formatting,a)):r.ULS.sendTraceTag(20492441,368,15,"Unable to get a ChP at starting Ip of Content Control")}Oek(a){this.ga.hb(zb.a.showPlaceholderGlossary,
2,a)}}Object(w.a)(pL,"ContentControlActor",null,[]);var xB=b(940);class kH extends gg.a{constructor(a,c,h){super(!1,!1,!0);this.Zsg=[Box4Intl.Box4Strings.l_CustomTabDialogLeaderNone,xB.a.tJe,xB.a.sJe,xB.a.uJe];this.q9f=[Box4Intl.Box4Strings.l_CustomTabDialogAlignLeft,Box4Intl.Box4Strings.l_CustomTabDialogAlignCenter,Box4Intl.Box4Strings.l_CustomTabDialogAlignRight];this.ga=a;this.JCe=c;this._tabStops=[];this.Bhc=h;this.Tma="";a={["id"]:"CustomTabDialog",["bodyControls"]:this.KCc()};this.Tg(Box4Intl.Box4Strings.l_CustomTabDialogTitle,
Object(m.a)(this,this.Aok,"customTabDialogResultHandler"),a)}vac(){new kH(this.ga,this.JCe,this.Bhc)}F1(a){return{["position"]:a.position,["alignment"]:a.alignment,["leader"]:a.leader}}bzh(a){return Math.floor(100*parseFloat(a))/100}YDn(a){return new Zk.a(Of.a.YD(this.bzh(a.position)),xB.a.Ihl(a.alignment),xB.a.Ghl(a.leader),1)}V3k(){const a=[];for(let c of this.JCe)a.push(this.F1(c));return a}nRn(a){const c=new Set;this.Tma="";for(let h of a)if(""!==h.position){const v=this.bzh(h.position);if(0>
v||22<v){this.Tma=Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds;break}if(c.has(v)){this.Tma=Box4Intl.Box4Strings.l_CustomTabDialogMultipleTabStopsSamePosition;break}else this._tabStops.push(this.YDn(h)),c.add(v)}else{this.Tma=Box4Intl.Box4Strings.l_CustomTabDialogEmptyPosition;break}""!==this.Tma&&(this._tabStops=[],this.JCe=a)}dUn(a){if(0>a||22<a)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopBounds);var c={};if(32===this.ga.hb(zb.a.nBa,2,c)){var h=c.marginLeft;
const v=Be.a.Vh(c.marginRight,0);h=Be.a.Vh(h,0);c=Be.a.Vh(c.Po,0);if(Be.a.F8(a,0,!1)>=c-v-h)throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopMarginIndentCheck);}}KCc(){const a=Object(m.a)(this,this.V3k,"getInitState"),c=Object(m.a)(this,this.nRn,"updateState");return{["getInitState"]:a,["updateState"]:c,["validPositions"]:this.cDh(-Infinity,Infinity),["validAlignments"]:this.jsh(this.q9f,this.q9f),["validLeaders"]:this.jsh(this.Zsg,this.Zsg),["defaultTabStopSpinButtonProps"]:this.cDh(.01,
22),["defaultTabStopLength"]:this.Bhc,["DefaultTabStop"]:"DefaultTabStop",["addButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogAddButton,["clearAllButtonText"]:Box4Intl.Box4Strings.l_CustomTabDialogClearAllButton,["positionHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogPosition,["alignmentHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogAlignment,["leaderHeaderText"]:Box4Intl.Box4Strings.l_CustomTabDialogLeader,["defaultTabStopText"]:Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStops,
["addNewTabStopHeader"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopHeader,["addNewTabStopDescription"]:Box4Intl.Box4Strings.l_CustomTabDialogAddNewTabStopDescription,["deleteButtonTooltip"]:Box4Intl.Box4Strings.l_CustomTabDialogDeleteButtonTooltip}}cDh(a,c){return{["type"]:"AppSpinButtonProps",["id"]:"CustomTabDialogSpinButtonPosition",["label"]:"",["unitType"]:"Inch",["validUnits"]:[Iz("Inch",3,a,c,.1)],["numberFormatInfo"]:NG()}}jsh(a,c){return{["type"]:"AppComboBoxProps",["id"]:"CustomTabDialogComboBox",
["label"]:"",["options"]:qF(a,c)}}Aok(a,c){try{if(1===a){if(""!==this.Tma)throw Error.create(this.Tma);c.DefaultTabStop&&(this.Bhc=xB.a.jNf(c.DefaultTabStop),this.dUn(this.Bhc));if(32!==this.ga.hb(ba.a.HIb,2,{["tabStops"]:this._tabStops,["defaultTabStopLength"]:Of.a.YD(this.Bhc)}))throw Error.create(Box4Intl.Box4Strings.l_CustomTabDialogSaveError);}}catch(h){a=Object(m.a)(this,this.vac,"showCustomTabDialog"),this.VBa(h.message,a)}}}Object(w.a)(kH,"CustomTabDialog",gg.a,[]);class qL{constructor(a,
c,h){this.Spc=this.Bb=null;this.ga=a;this.rua=c;this.Do=h}get hd(){return this.Bb||(this.Bb=xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get gTc(){return this.Spc||(this.Spc=xa.a.instance.ra("WordEditor.Actors.RenderParagraphsContainingTabs"))}eb(){const a=Eb.App.P0a.xrd(c=>zm.OutlineElementGeneralizer.xia(c.Ca,!0),!0);this.ga.ka(ba.a.eEb,ic.a.view,a);this.ga.Aa(ba.a.eEb,ic.a.paragraph,Object(m.a)(this,this.eEb,"queryCustomTabStops"),96);this.ga.ka(ba.a.c_a,ic.a.view,
a);this.ga.Aa(ba.a.c_a,ic.a.paragraph,Object(m.a)(this,this.c_a,"removeCustomTabStop"),96);this.ga.ka(ba.a.MEb,ic.a.view,a);this.ga.Aa(ba.a.MEb,ic.a.paragraph,Object(m.a)(this,this.MEb,"removeAllCustomTabStops"),96);this.ga.ka(ba.a.bVc,ic.a.view,a);this.ga.Aa(ba.a.bVc,ic.a.paragraph,Object(m.a)(this,this.bVc,"setCustomTabStop"),96);this.ga.ka(ba.a.C5b,ic.a.view,a);this.ga.Aa(ba.a.C5b,ic.a.paragraph,Object(m.a)(this,this.C5b,"modifyCustomTabStop"),96);this.ga.ka(ba.a.HIb,ic.a.view,a);this.ga.Aa(ba.a.HIb,
ic.a.paragraph,Object(m.a)(this,this.HIb,"updateCustomTabStopsAndDefaultTabStopLength"),96);this.ga.ka(ba.a.N1f,ic.a.view,a);this.ga.Aa(ba.a.N1f,ic.a.paragraph,Object(m.a)(this,this.FPl,"isParagraphValid"),96);this.ga.ka(ba.a.vac,ic.a.view,Object(m.a)(this,this.sHi,"showCustomTabStopDialog"));this.ga.ka(ba.a.ONh,ic.a.view,Object(m.a)(this,this.sHi,"showCustomTabStopDialog"))}C5b(a,c,h,v,B){if(2!==h)return 8;if(!B)return 16;a=B.tabStop;B=B.value;if(!a)return 16;re.c(ba.a.C5b);B=new Zk.a(B,a.s$,a.Sja,
a.BWf);c=c.node;this.rua.c_a(c,a);this.rua.CGd(c,B);return 32}bVc(a,c,h,v,B){if(2===h){if(!B)return 16;this.rua.CGd(c.node,B);return 32}return 8}eEb(a,c,h,v,B){a=this.rua.Xmi(c.node);if(!("customTabs"in B))return B.customTabs=a,32;c=B.customTabs;if(!c||0>=c.length||!a||0>=a.length)return B.customTabs=null,32;h=[];for(let X of c)for(let ma of a)if(ma.pCa===X.pCa&&ma.BWf===X.BWf&&ma.s$===X.s$){h.push(X);break}B.customTabs=h;return 32}c_a(a,c,h,v,B){if(2===h){if(!B)return 16;re.c(ba.a.c_a);this.rua.c_a(c.node,
B);return 32}return 8}MEb(a,c){this.rua.MEb(c.node);return 32}HIb(a,c,h,v,B){if(2===h){if(!B)return 16;a=B.tabStops;h=B.defaultTabStopLength;c=c.node;v=!1;let X=this.rua.B_m(c,a);B.defaultTabStopLengthSaved||(v=this.Do.kdn(c,h),B.defaultTabStopLengthSaved=!0);X&&re.d(ba.a.HIb,!0,void 0,void 0,void 0,void 0,[Object.assign(new aa.a,{name:"Custom Tab Stops Count",string:a.length.toString()})]);if(null==v)return r.ULS.sendTraceTag(571479714,3015,15,"Could not set Default Tab Stop Length."),16;v&&(this.gTc&&
this.gTc.lj(),this.hd.Xq(11,Box4Intl.Box4Strings.l_CustomTabDialogDefaultTabStopTrackingAlert),re.d(ba.a.HIb,!0,void 0,void 0,void 0,void 0,[Object.assign(new aa.a,{name:"Default Tab Stop Length",string:h.toString()})]));return 32}return 8}sHi(a,c,h){if(2!==h)return 8;a={};if(32!==this.ga.hb(ba.a.XJ,2,a))return r.ULS.sendTraceTag(572072071,3015,15,"Could not read Default Tab Stop Length."),16;c={};if(32!==this.ga.hb(zb.a.nBa,2,c))return r.ULS.sendTraceTag(572072072,3015,15,"Could not read Section Properties."),
16;a=xB.a.jNf(Of.a.uA(a.defaultTabStop));h={};h.defaultTabStopLength=a;h.sectionPropertiesData=c;if(32!==this.ga.hb(ba.a.N1f,2,h))return r.ULS.sendTraceTag(572072073,3015,15,"Could not validate Paragraphs against indents and default tab stop."),16;if(!h.isParagraphValid)return r.ULS.sendTraceTag(572072074,3015,15,"Could not open Custom Tab Stop Dialog since all selected paragraphs failed validation."),this.rua.VBa(Box4Intl.Box4Strings.l_CustomTabDialogIndentError),8;c={};if(32!==this.ga.hb(ba.a.eEb,
2,c))return r.ULS.sendTraceTag(572072075,3015,15,"Could not read Custom Tab Stops."),16;(c=c.customTabs)||(c=[]);c=xB.a.Hhl(c);new kH(this.ga,c,a);re.c(ba.a.vac,!0);return 32}FPl(a,c,h,v,B){if(2!==h)return 8;if(!B)return 16;if(B.isParagraphValid)return 32;h={};if(32!==this.ga.Le(c,zb.a.TZa,2,!1,null,h))return 16;a=B.sectionPropertiesData;c=B.defaultTabStopLength;var X=h.Ar;v=X.mja;X=1===X.specialIndentType?X.az:X.az-X.m$;const ma=a.marginLeft,Pa=a.marginRight;h.isRtl?(h=Be.a.Vh(Math.max(Pa,Pa+v),
0),v=Be.a.Vh(Math.max(ma,ma+X),0)):(h=Be.a.Vh(Math.max(ma,ma+X),0),v=Be.a.Vh(Math.max(Pa,Pa+v),0));a=Be.a.Vh(a.Po,0);c=Be.a.F8(c,0,!1);B.isParagraphValid=c<a-h-v;return 32}}Object(w.a)(qL,"CustomTabActor",null,[]);var cQ=b(116),HF=b(586);class rL{constructor(a,c,h,v,B,X,ma,Pa,mb){this.ga=a;this.Bjd=h;this.CDa=(this.eRb=B)&&v;this.Vm=X;this.ZT=ma;this.pbj=Pa;this.uv=mb;this.eRb&&yh.a("isSharedUXDarkModeOn")?(this.Vm.yU=appChrome.api.isSharedUXDarkModeOn(),this.N1h(!0)):this.Vm.yU=!1;this.CDa?this.u0h(!0):
this.Vm.B0a=!1;l.AFrameworkApplication.UK(()=>{this.mOc()});this.CDa&&yh.a("dispatch")&&appChrome.api.dispatch(this.CMi([]))}eb(){this.CDa&&(this.ga.ka(ba.a.mEn,ic.a.view,this.Pok.bind(this)),this.ga.ka(ba.a.XVc,ic.a.view,this.XVc.bind(this)),this.ga.Aa(ba.a.qRc,ic.a.view,this.qRc.bind(this),96));this.eRb&&(this.ga.ka(ba.a.p1d,ic.a.view,this.p1d.bind(this)),this.ga.Aa(ba.a.pWd,ic.a.view,this.pWd.bind(this),96))}vFl(a){if(!this.Bnn(a))return!1;const c=Fk.a.instance.Ob(2);try{c.Oa(a.root);const h=Kd.GraphIterator.va(a.root.graphNode),
v=hq.a.gq(h);for(;v.moveNext();){const B=Object(ha.a)(cQ.a,v.currentNode);B&&B.lK(a.gb,20,!0)}}finally{c&&c.dispose()}return!0}Bnn(a){return a&&a.root&&a.jr?a.Rh||a.qjf||a.uSh||a.wj:!1}u1m(){let a=!1;this.Bjd.forEach(c=>{this.vFl(c)&&(a=!0)});return a}nEn(){r.ULS.sendTraceTag(570566656,3023,50,"Toggle Dark Mode for canvas fishbowl to {0} mode",this.Vm.yU?"dark":"light");return this.Vm.yU?HF.a.Mtc(1):HF.a.Zpi(1)}wYf(){const a=this.Vm.vha;r.ULS.sendTraceTag(571524678,3023,50,"Toggle canvas Dark Mode to {0} mode",
a?"dark":"light");if(!this.u1m()||(a?!HF.a.Mtc(0):!HF.a.Zpi(0)))return!1;this.pbj.rLm(a);return!0}CMi(a){a.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Vm.yU));a.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackgroundStatusBar",this.EDh(!0)));try{WordRibbonStrings?a.push(appChrome.actions.setControlCustomTooltip("DarkModeSwitchBackgroundStatusBar",this.Vm.B0a?WordRibbonStrings.DarkModeSwitchBackgroundTooltipDark:WordRibbonStrings.DarkModeSwitchBackgroundTooltipLight)):
r.ULS.sendTraceTag(527283228,3023,10,"Trying to access WordRibbonStrings when it's undefined")}catch(c){r.ULS.sendTraceTag(527282835,3023,10,c)}return a}Pok(){return this.wYf()?32:8}p1d(a,c,h){if(1===h)return 32;a=this.ZT.Pe("UserAction","sharedUXDarkModeToggle");if(yh.a("toggleSharedUXDarkMode"))r.ULS.sendTraceTag(571524677,3023,50,"Requesting to toggle Dark Mode for the Shared UX."),appChrome.api.toggleSharedUXDarkMode(),yh.a("isSharedUXDarkModeOn")?this.Vm.yU=appChrome.api.isSharedUXDarkModeOn():
this.Vm.yU=!this.Vm.yU,r.ULS.sendTraceTag(529388308,3023,50,"User in new ribbonMode: {0}",this.Vm.yU);else return 8;appChrome.getHeaderApi().then(v=>{v.hasOwnProperty("refreshThemeOverride")&&v.refreshThemeOverride()});this.nEn()||r.ULS.sendTraceTag(561553416,3023,15,"Failed to toggle Dark mode for Fishbowl");this.CDa&&!this.Vm.B0a&&(this.wYf()||r.ULS.sendTraceTag(561553417,3023,15,"Failed to toggle Dark mode for Canvas"));c={};c.DarkModeToggle=appChrome.selectors.getModelType("DarkModeToggle");Eb.App.oa.xE(c);
appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Vm.yU));this.CDa&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackgroundStatusBar",!this.Vm.yU));a.stop();r.ULS.sendTraceTag(555885377,3023,50,"{0}",a.Yg);return 32}XVc(a,c,h){if(1===h)return 32;a=this.ZT.Pe("UserAction","sharedUXDarkModeSwitchBackground");r.ULS.sendTraceTag(561088148,3023,50,"Requesting to toggle Dark Mode for the switch background UX.");this.Vm.B0a=
!this.Vm.B0a;if(!this.wYf())return 8;c={};c.DarkModeSwitchBackground=this.uv?"ButtonModel":"ToggleButtonModel";Eb.App.oa.xE(c);a.stop();r.ULS.sendTraceTag(555885378,3023,50,"{0}",a.Yg);r.ULS.sendTraceTag(529388309,3023,50,"User in new canvasMode: {0}",this.Vm.B0a);return 32}pWd(a,c,h,v,B){if(1===h)return 32;if(!B)return 2;yh.a("isSharedUXDarkModeOn")&&(this.Vm.yU=appChrome.api.isSharedUXDarkModeOn());B&&(B[Uf.a.On]=this.Vm.yU);return 32}qRc(a,c,h,v,B){if(1===h)return 32;if(!B)return 2;!this.uv&&B&&
(B[Uf.a.On]=this.Vm.B0a);a=[];a.push(appChrome.actions.updateControlHiddenState("DarkModeSwitchBackground",!this.Vm.yU));this.CDa&&this.CMi(a);a.push(appChrome.actions.setControlIconSet("DarkModeSwitchBackground",this.EDh(!1)));appChrome.api.dispatch(a);return 32}EDh(a){const c={};this.Vm.B0a?a?c["default"]="MoonMonochromatic_16":(c["default"]="MoonMonochromatic_20",c.icon32="MoonMonochromatic_32"):a?c["default"]="SunMonochromatic_16":(c["default"]="SunMonochromatic_20",c.icon32="SunMonochromatic_32");
return c}mOc(){this.eRb&&this.N1h(!1);this.CDa&&this.u0h(!1)}N1h(a){r.ULS.sendTraceTag(561088149,3023,50,"Shared dark mode state. IsBoot: {0}; State: {1}; DefaultOn: {2}",a,this.Vm.yU?"dark":"light",this.Vm.rUa)}u0h(a){r.ULS.sendTraceTag(561088150,3023,50,"Canvas dark mode state. IsBoot: {0}; State: {1}; DarkCanvasPreferred: {2}",a,this.Vm.vha?"dark":"light",this.Vm.Ook)}}Object(w.a)(rL,"DarkModeActor",null,[]);var sL=b(1403);class IF{constructor(){this.Height=this.Width=0}static construct(a,c){const h=
new IF;h.Width=a;h.Height=c;return h}}Object(w.a)(IF,"ViewportInfo",null,[]);class lH extends Wp.a{constructor(){super();this.ContractVersion=0;this.World=this.EnhancementId=this.DocumentContent=null;this.ScalingFactor=0;this.MobileViewportInfo=this.DesktopViewportInfo=null;this.MinParagraphCount=0;this.ContentCulture=null}ol(){return 85}static construct(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){const Tc=new lH;Tc.ContractVersion=a;Tc.DocumentContent=c;Tc.EnhancementId=h;Tc.World=v;Tc.ScalingFactor=B;Tc.DesktopViewportInfo=
IF.construct(X,ma);Tc.MobileViewportInfo=IF.construct(Pa,mb);Tc.MinParagraphCount=Tb;Tc.ContentCulture=rc;return Tc}}Object(w.a)(lH,"SwayPreviewRequest",Wp.a,[]);var tL=b(558);class nD{static get vf(){return gg.a.fy(nD.ll,WordEditorIntl.WordEditorStrings.L_DigitalPrintLearnMore,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogStyleLabel,WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogPreviewLabel,nD.C6m,WordEditorIntl.WordEditorStrings.l_SavingStatus)}}nD.C6m=uk.a.Ah("progress.gif");nD.ll=
"<div class='WACDialogRow digitalPrintDialogWrapper UIFont' id='homeWrapper'> <div class='swayContentMain' id='swayContentMain'> <span id='mainText' class='swayMainDescription'>''</span> <a id='digitalPrintLearnMoreLink' class='swayHyperlink' href='' target='_blank' >{0}</a> </div> <div class='swayContentWrapper' id='swayContentWrapper'> <div class='swayGalleryWrapper' id='swayGalleryWrapper'> <label id='styleLabel' class='swayStyleContentSubHeader' role='heading' aria-level='1' >{1}</label> <div class='swayGallery' id='swayGallery' aria-labelledby='styleLabel'></div> </div> <div class='swayPreviewWrapper' id='swayPreviewWrapper'> <label id='previewLabel' class='swayPreviewContentSubHeader' role='heading' aria-level='1'>{2}</label> <div class='swayDesktopPreviewWrapper' id='swayDesktopPreviewWrapperDiv'> <div class='digitalPrintStatusMessageWrapper' id='digitalPrintStatusMessageWrapperDiv'> <img id='digitalPrintStatusMessageIconDiv' class='digitalPrintStatusMessageIcon' role='presentation' src={3} /> <label id='digitalPrintStatusMessageDiv' class='digitalPrintStatusMessage' >string.Empty</label> </div> <div class='swayDesktopPreview' id='swayDesktopPreviewHtmlHolder'> </div> </div> <div class='swayMobilePreviewWrapper' id='swayMobilePreviewWrapperDiv'> <div class='swayMobilePreview' id='swayMobilePreviewHtmlHolder'> </div> </div> <div class='swayPreviewContentWrapper' id='swayPreviewContentWrappereDiv'> <div class='swayPreviewFrame swayPreviewFrameBackground' id='swayPreviewFrameDiv'> </div> <div class='digitalPrintSaving' id='digitalPrintSavingDiv'> <img id='digitalPrintSavingIcon' class='digitalPrintSavingIcon' role='presentation' src={3} /> <span id='digitalPrintSaving' class='digitalPrintSavingDescription'>{4}</span> </div> </div> </div> </div> </div>";
Object(w.a)(nD,"DigitalPrintDialogHtml",null,[]);class Cv{constructor(a,c,h,v){this.fontFamily=a;this.HTc=c;this.fontWeight=h;this.fontStyle=v}}Object(w.a)(Cv,"FontInfo",null,[]);class Xr{constructor(a,c,h,v){this.styleName=a;this.title=c;this.IDn=h;this.mul=v}}Object(w.a)(Xr,"StyleVisualInfo",null,[]);class qC extends gg.a{constructor(a,c,h,v,B=!0){super();this.z2=this.Im=this.gga=this.SZ=this.y7c=this.EHg=this.shd=this.yCe=this.zCe=this.RBe=this.zRb=this.hGa=this.f_=this.TQb=null;this.oFe=this.Wxe=
!1;this.u6c=null;this.vf=nD.vf;this.jf="DigitalPrintDialog";r.ULS.sendTraceTag(26005578,382,50,"Print to Web dialog has been opened and we initiated document force save");this.xrj=WordEditorIntl.WordEditorStrings.L_DigitalPrintTransformSlab;this.YLb=WordEditorIntl.WordEditorStrings.L_DigitalPrintButtonTransform;this.Ewj=h;this.ajc=v;this.Nd(1,this.xrj);this.Tg(this.YLb,Object(m.a)(this,this.tuk,"digitalPrintDialogHandler"),null);this.sAl();this.oyn();this.pfg=(new Date).getTime();B&&pu.a.jO(14,!1,
Object(m.a)(this,this.Gxk,"documentSavedSuccessfully"),Object(m.a)(this,this.Fxk,"documentSaveFailed"),null);this.DBl();this.azl();this.o_l();this.ipf();this.f_l();this.g$g()}get cqa(){return this.u6c}Gxk(){this.mxi(0)}Fxk(a,c){this.mxi(c)}mxi(a){if(!this.Wxe){const c=(new Date).getTime()-this.pfg;Cj.a.instance.Xe(lg.a.uuk,c);a?r.ULS.sendTraceTag(25548302,382,15,String.format("We failed to save document with status code {0}",ve.a[a])):r.ULS.sendTraceTag(25548301,382,50,"We saved document successfully");
document.getElementById("digitalPrintSavingDiv").style.display="none";this.oTa.disabled=!1}}sAl(){this.zRb=document.getElementById("digitalPrintStatusMessageDiv");this.RBe=document.getElementById("digitalPrintStatusMessageIconDiv");this.zCe=document.getElementById("swayDesktopPreviewWrapperDiv");this.yCe=document.getElementById("swayDesktopPreviewHtmlHolder");this.shd=document.getElementById("swayMobilePreviewHtmlHolder");this.EHg=document.getElementById("swayMobilePreviewWrapperDiv");this.f_=document.getElementById("swayGallery");
this.f_.setAttribute("tabindex","0");Ld.a.addHandler(this.f_,Jb.a.scroll,Object(m.a)(this,this.Iyf,"onGalleryScroll"));this.f_.setAttribute(we.a.tg,we.a.sUg);this.SZ=document.getElementById("digitalPrintLearnMoreLink");this.SZ.href="https://go.microsoft.com/fwlink/?linkid=871972";Ld.a.addHandler(this.SZ,Jb.a.click,Object(m.a)(this,this.ozf,"onLearnMoreClick"));this.gga=new Ua.a;this.y7c=document.getElementById("homeWrapper");this.n5("mainText");document.getElementById("mainText").innerText="OneDriveWOPI"===
this.ajc?WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionMSA:WordEditorIntl.WordEditorStrings.L_DigitalPrintDialogDescriptionAAD}DBl(){this.Im=new Ua.a;this.Im.add(new Xr("BokehV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBokeh,"swayLightProTitle swayBokehTitle","swayLightProHeading swayBokehHeading"));this.Im.add(new Xr("Regency",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameRegency,"swayVanillaTitle swayRegencyTitle","swayVanillaHeading swayRegencyHeading"));
this.Im.add(new Xr("PilarV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNamePilar,"swayVanillaTitle swayPilarTitle","swayVanillaHeading swayPilarHeading"));this.Im.add(new Xr("Boutique",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameBoutique,"swaySwirlTitle swayBoutiqueTitle","swaySwirlHeading swayBoutiqueHeading"));this.Im.add(new Xr("Studio",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStudio,"swaySimplicityTitle swayStudioTitle","swaySimplicityHeading swayStudioHeading"));
this.Im.add(new Xr("Sierra",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameSierra,"swaySwirlTitle swaySierraTitle","swaySwirlHeading swaySierraHeading"));this.Im.add(new Xr("Fete",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFete,"swaySwirlTitle swayFeteTitle","swaySwirlHeading swayFeteHeading"));this.Im.add(new Xr("CelestialV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCelestial,"swaySwirlTitle swayCelestialTitle","swaySwirlHeading swayCelestialHeading"));this.Im.add(new Xr("TranquilV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameTranquil,"swayVanillaTitle swayTranquilTitle","swayVanillaHeading swayTranquilHeading"));this.Im.add(new Xr("Midtown",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMidtown,"swayLightProTitle swayMidtownTitle","swayLightProHeading swayMidtownHeading"));this.Im.add(new Xr("Lucent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameLucent,"swaySimplicityTitle swayLucentTitle","swaySimplicityHeading swayLucentHeading"));this.Im.add(new Xr("AerialV2",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAerial,"swaySwirlTitle swayAerialTitle","swaySwirlHeading swayAerialHeading"));this.Im.add(new Xr("StructureV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameStructure,"swaySwirlTitle swayStructureTitle","swaySwirlHeading swayStructureHeading"));this.Im.add(new Xr("Muse",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMuse,"swayLightProTitle swayMuseTitle","swayLightProHeading swayMuseHeading"));this.Im.add(new Xr("Cinema",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCinema,"swaySimplicityTitle swayCinemaTitle","swaySimplicityHeading swayCinemaHeading"));this.Im.add(new Xr("MegaV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameMega,"swayVanillaTitle swayMegatitle","swayVanillaHeading swayVanillaHeading"));this.Im.add(new Xr("ConvergenceV2",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameConvergence,"swayVanillaTitle swayConvergenceTitle","swayVanillaHeading swayConvergenceHeading"));this.Im.add(new Xr("Alloy",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAlloy,"swayLightProTitle swayAlloyTitle","swayLightProHeading swayAlloyHeading"));this.Im.add(new Xr("Fluent",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameFluent,"swaySimplicityTitle swayFluentTitle","swaySimplicityHeading swayFluentHeading"));this.Im.add(new Xr("Aurora",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameAurora,"swaySwirlTitle swayAuroraTitle","swaySwirlHeading swayAuroraHeading"));this.Im.add(new Xr("Civic",
WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameCivic,"swayLightProTitle swayCivicTitle","swayLightProHeading swayCivicHeading"));this.Im.add(new Xr("Reflection",WordEditorIntl.WordEditorStrings.L_DigitalPrintStyleNameReflection,"swaySimplicityTitle swayReflectionTitle","swaySimplicityHeading swayReflectionHeading"))}azl(){this.z2=new Ua.a;this.z2.add(new Cv("universc","universc","normal","normal"));this.z2.add(new Cv("Miller-Banner_Roman_WebTT","Miller-Banner_Roman_WebTT","normal","normal"));
this.z2.add(new Cv("Miller-Banner_Italic_WebTT","Miller-Banner_Italic_WebTT","normal","italic"));this.z2.add(new Cv("Miller-Banner_Bold_Italic_WebTT","Miller-Banner_Bold_Italic_WebTT","bold","italic"));this.z2.add(new Cv("QuireSans-Thin","QuireSans-Thin","extrathin","normal"));this.z2.add(new Cv("Posterama-Regular","Posterama-Regular","normal","normal"));this.z2.add(new Cv("Heron_Serif-Regular_WebTT","Heron_Serif-Regular_WebTT","normal","normal"));this.z2.add(new Cv("Benton_Modern-Roman_WebTT","Benton_Modern-Roman_WebTT",
"normal","normal"));this.z2.add(new Cv("ArialNova","ArialNova","normal","normal"));this.z2.add(new Cv("TisaOffcSerifPro-Thin","TisaOffcSerifPro-Thin","normal","normal"));this.z2.add(new Cv("QuireSans-Regular","QuireSans-Regular","normal","normal"));this.z2.add(new Cv("RockwellNova","RockwellNova","normal","normal"));this.z2.add(new Cv("SabonNRegLT","SabonNRegLT","normal","normal"));this.z2.add(new Cv("DaytonaThin","DaytonaThin","100","normal"))}o_l(){const a=document.createElement("style");a.setAttribute("type",
"text/css");let c="";for(let h of this.z2)c+=String.format(this.Ewj,h.fontFamily,h.HTc,h.fontWeight,h.fontStyle);a.innerText=c;this.y7c.appendChild(a)}f_l(){const a=document.createElement("style");a.setAttribute("type","text/css");const c=String.format(".{0} {{ background: url({1}) no-repeat; }}","swayPreviewFrameBackground",uk.a.Ah("SwayPreviewFrame.svg")),h=String.format("@media screen and (-ms-high-contrast: active) {{ .{0} {{ background: url({1}) no-repeat; -ms-high-contrast-adjust: none; }}}}",
"swayPreviewFrameBackground",uk.a.Ah("SwayPreviewFrameHC.svg"));a.innerText=c+h;H.a.In&&(a.innerText+=".AppRtl .swayGallery { margin-right: -15px; }");this.y7c.appendChild(a)}Ndi(a){this.axh(a)===Sys.UI.Key.enter&&(this.DAf(a),a.preventDefault(),a.stopPropagation())}axh(a){return a?a.keyCode:window.event.keyCode}hide(){this.BJf();super.hide()}BJf(){if(this.f_&&!this.Wxe){for(let a=0;a<this.gga.count;a++)Ld.a.removeHandler(this.gga.J(a),Jb.a.click,Object(m.a)(this,this.DAf,"onStyleGalleryItemClick")),
Ld.a.removeHandler(this.gga.J(a),Jb.a.ah,Object(m.a)(this,this.Ndi,"onThumbnailKeyDown"));Ld.a.removeHandler(this.f_,Jb.a.ah,Object(m.a)(this,this.wai,"onGalleryKeyDown"));Ld.a.removeHandler(this.f_,Jb.a.focus,Object(m.a)(this,this.vai,"onGalleryFocus"));Ld.a.removeHandler(this.SZ,Jb.a.click,Object(m.a)(this,this.ozf,"onLearnMoreClick"));this.oFe||Ld.a.removeHandler(this.f_,Jb.a.scroll,Object(m.a)(this,this.Iyf,"onGalleryScroll"));this.Wxe=!0}}ipf(){const a=document.createElement("link");a.setAttribute("rel",
"stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",uk.a.aVj());this.y7c.appendChild(a);for(let c of this.Im)this.jjk(this.f_,c);this.AY(this.f_);this.K0g(this.f_.firstChild);this.f_.firstChild.focus();Ld.a.addHandler(this.f_,Jb.a.ah,Object(m.a)(this,this.wai,"onGalleryKeyDown"));Ld.a.addHandler(this.f_,Jb.a.focus,Object(m.a)(this,this.vai,"onGalleryFocus"))}jjk(a,c){const h=document.createElement("button");h.className="swayGalleryItem swayClip136x90 swayImageBorderButton";h.setAttribute(we.a.g8a,
we.a.$H);h.setAttribute("title",c.title);h.setAttribute(we.a.tg,we.a.vUg);h.id=c.styleName;a.appendChild(h);a=document.createElement("img");a.className=String.format("swayPublish_Sway{0}StyleBlank_136x90x32",c.styleName);a.src=uk.a.Ah("swayPublish.png");a.setAttribute(we.a.tg,we.a.Sx);a.setAttribute("unselectable","on");a.setAttribute(we.a.Rx,we.a.$m);a.id=c.styleName+"img";h.appendChild(a);a=document.createElement("label");a.innerText=c.title;a.className=c.IDn;a.setAttribute(we.a.Rx,we.a.$m);a.setAttribute("unselectable",
"on");a.setAttribute(we.a.tg,we.a.Sx);h.appendChild(a);const v=document.createElement("label");v.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintHeadingText;v.className=c.mul;v.setAttribute(we.a.Rx,we.a.$m);a.setAttribute("unselectable","on");v.setAttribute(we.a.tg,we.a.Sx);h.appendChild(v);Ld.a.addHandler(h,Jb.a.click,Object(m.a)(this,this.DAf,"onStyleGalleryItemClick"));Ld.a.addHandler(h,Jb.a.ah,Object(m.a)(this,this.Ndi,"onThumbnailKeyDown"));this.gga.add(h)}vai(a){((a=a.rawEvent.relatedTarget)&&
("digitalPrintLearnMoreLink"===a.id||a.id===Sj.a.c1c)||H.a.Gi)&&this.hGa&&this.YFb(this.hGa)}wai(a){const c=this.axh(a);c!==Sys.UI.Key.tab&&c!==Sys.UI.Key.left&&c!==Sys.UI.Key.right&&c!==Sys.UI.Key.up&&c!==Sys.UI.Key.down||this.erl(c)||(a.preventDefault(),a.stopPropagation(),this.$nm(c))}$nm(a){const c=this.cqa;this.$Lk(a,c,!l.AFrameworkApplication.isRtl)||this.bMk(a,c,!l.AFrameworkApplication.isRtl)||this.XLk(a,c)||this.YLk(a,c)}erl(a){return a===Sys.UI.Key.tab?(this.cqa&&this.cqa!==this.hGa&&(this.cqa.className=
"swayGalleryItem swayClip136x90 swayImageBorderButton",this.u6c=this.hGa),!0):!1}Iyf(){this.oFe||(this.oFe=!0,r.ULS.sendTraceTag(25798020,382,50,"User has scrolled styles gallery"),Ld.a.removeHandler(this.f_,Jb.a.scroll,Object(m.a)(this,this.Iyf,"onGalleryScroll")))}ozf(){r.ULS.sendTraceTag(26005580,382,50,"Learn more click")}$Lk(a,c,h){return a===Sys.UI.Key.right&&h||a===Sys.UI.Key.left&&!h?(a=(a=c.nextSibling)||this.f_.firstChild,this.YFb(a),!0):!1}bMk(a,c,h){return a===Sys.UI.Key.left&&h||a===
Sys.UI.Key.right&&!h?(a=(a=c.previousSibling)||this.f_.lastChild,this.YFb(a),!0):!1}XLk(a,c){return a===Sys.UI.Key.down?(a=this.gga.indexOf(c),c=a+2,c<this.gga.count?(a=this.gga.J(c))&&this.YFb(a):(c=a%2+1,c=2<=c?0:c,(a=this.gga.J(c))&&this.YFb(a)),!0):!1}YLk(a,c){a===Sys.UI.Key.up&&(a=this.gga.indexOf(c),c=a-2,0<=c?(a=this.gga.J(c))&&this.YFb(a):(c=a?20+a-1:this.gga.count-1,(a=this.gga.J(c))&&this.YFb(a)))}YFb(a){this.cqa&&this.cqa.id!==this.hGa.id&&(this.cqa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");
this.u6c=a;this.cqa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonFocused");this.cqa.focus()}oyn(){this.oTa.className="WACDialogButtonNormal swayPrintToWebButton";this.oTa.setAttribute("tabindex","0");this.Hu.className="WACDialogButtonNormal swayCancelButton";this.Hu.setAttribute("tabindex","0");this.oTa.disabled=!0}DAf(a){a.preventDefault();a.stopPropagation();l.AFrameworkApplication.pa.processAction(zb.a.Mdh,2);a.target?(a="button"===
a.target.tagName.toLowerCase()?a.target:a.target.parentNode)&&a.id!==this.TQb&&(r.ULS.sendTraceTag(25231813,382,50,"DigitalPrintDialog.OnStyleGalleryItemClick style changed from {0} to {1}",this.TQb,a.id),this.K0g(a),this.g$g()):r.ULS.sendTraceTag(24418077,382,10,"DigitalPrintDialog.OnStyleGalleryItemClick e.Target is null!")}K0g(a){this.cqa&&(this.cqa.className="swayGalleryItem swayClip136x90 swayImageBorderButton");this.hGa&&(this.hGa.className="swayGalleryItem swayClip136x90 swayImageBorderButton",
this.hGa.setAttribute(we.a.g8a,we.a.$H));this.TQb=a.id;this.hGa=a;this.hGa.setAttribute(we.a.g8a,we.a.$m);this.u6c=a;this.cqa.className=String.format("{0} {1}","swayGalleryItem swayClip136x90 swayImageBorderButton","swayImageBorderButtonSelected")}tuk(a){const c=(new Date).getTime()-this.pfg;Cj.a.instance.Xe(lg.a.vuk,c);a?this.aan():(r.ULS.sendTraceTag(25231814,382,50,"DigitalPrintDialog.DigitalPrintDialogHandler Dialog has been closed with the cancel button"),l.AFrameworkApplication.pa.processAction(zb.a.Ldh,
2))}g$g(){ag.a.instance.ub(new Se.a(2,1,50,Object(m.a)(this,this.Z$m,"sendPreviewRequest")))}Z$m(){this.Bsn();try{const a=qC.ffh.oFk(),c=lH.construct(2,a,this.TQb,"VerticalWorld",.3,1366,600,330,280,20,qC.ffh.oLb.name);l.AFrameworkApplication.fe.ai(String.format("{0}/we/GetSwayPreview.ashx?{1}",Eb.App.webServiceBase,l.AFrameworkApplication.rootQuerySignature),2,tL.b(c),{"Content-Type":"application/json; charset=utf-8","Content-Encoding":"gzip"},!1,2,Object(m.a)(this,this.OEm,"previewSuccessCallback"),
Object(m.a)(this,this.kji,"previewFailCallback"),c)}catch(a){r.ULS.sendTraceTag(25268375,382,10,"Failed to generate preview request. Exception: {0}",a.message)}}OEm(a){var c=null;({group:c}=Dm.a.D$(a.data.qd,c)).returnValue?(c=c.Responses[0],c.Succeeded?(this.oNd(a.data,lg.a.Azn),this.Q8a(),this.KCi(this.yCe,c.PreviewHtml),this.KCi(this.shd,c.PreviewHtmlMobile)):this.kji(null)):r.ULS.sendTraceTag(25231816,382,10,"DigitalPrintDialog.PreviewSuccessCallback Preview response deserialization failed")}KCi(a,
c){a.innerHTML=c}kji(){this.Csn();this.zCe.style.background="#E6E6E6";this.EHg.style.background="#E6E6E6"}aan(){r.ULS.sendTraceTag(25231818,382,50,String.format("DigitalPrintDialog.SendPublishRequest Sending publish request for style {0}",this.TQb));l.AFrameworkApplication.pa.processAction(zb.a.Ndh,2);const a=String.format("{0}/we/SwayPublish.ashx?{1}&parentSessionId={2}&styleId={3}",Eb.App.webServiceBase,l.AFrameworkApplication.rootQuerySignature,l.AFrameworkApplication.userSessionId,this.TQb);Ve.a.openWindow(4,
a)}oNd(a,c){Cj.a.instance.Xe(c,+a.VQ-+a.yF)}Csn(){var a=WordEditorIntl.WordEditorStrings.L_DigitalPrintPreviewFailureMessage;this.Q8a();this.zRb.innerText=a;this.zRb.style.display="block"}Bsn(){this.Q8a();this.RBe.style.display="block";this.zRb.innerText=WordEditorIntl.WordEditorStrings.L_DigitalPrintGeneratingPreview;this.zRb.style.display="block"}Q8a(){this.zCe.style.background="";this.shd.style.background="";ye.a.I_(this.yCe);ye.a.I_(this.shd);this.zRb.style.display="none";this.RBe.style.display=
"none"}static get ffh(){return qC.Qfg||(qC.Qfg=xa.a.instance.ra("Box4.DocumentContentExtractor.IDocumentContentExtractor"))}}qC.Qfg=null;Object(w.a)(qC,"DigitalPrintDialog",gg.a,[]);class mH{constructor(a,c){this._context=this.Ij=null;this.gde=0;this.z2c=!1;this.BGg=null;this.ga=a;this.l2=c}eb(){l.AFrameworkApplication.protectFile?r.ULS.sendTraceTag(26093080,382,50,"Disabling Digital Print button because document has protection."):l.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&l.AFrameworkApplication.K.$("DisablePrint")?
r.ULS.sendTraceTag(26093081,382,50,"Disabling Digital Print button because print is disabled."):(this.ga.Aa(zb.a.Ctd,ic.a.view,Object(m.a)(this,this.digitalPrint,"digitalPrint"),4),this.ga.Aa(zb.a.Mdh,ic.a.view,Le.ActionManager.lX,4),this.ga.Aa(zb.a.Ndh,ic.a.view,Le.ActionManager.lX,4),this.ga.Aa(zb.a.Ldh,ic.a.view,Le.ActionManager.lX,4),this.ga.Aa(Sa.a.Dtd,ic.a.view,Le.ActionManager.lX,4))}digitalPrint(a,c,h,v,B){if(1===h)return l.AFrameworkApplication.X4?8:32;this.BGg=B.SourceControlId;if(l.AFrameworkApplication.K.$("IsAnonymousUser"))return r.ULS.sendTraceTag(34373826,
382,50,"DigitalPrintActor.DigitalPrint: Anonymous user tried to click on Print to Web feature."),this.Cac(WordEditorIntl.WordEditorStrings.L_DigitalPrintSignInNeeded),32;this._context=c;if(mH.kOl())return r.ULS.sendTraceTag(34373828,382,50,"DigitalPrintActor.DigitalPrint: MSA user clicked on Print to Web feature."),this.HTe(),32;switch(this.gde){case 1:r.ULS.sendTraceTag(34373829,382,50,"DigitalPrintActor.DigitalPrint: AAD user with Sway license clicked again on Print to Web feature.");this.HTe();
break;case 2:r.ULS.sendTraceTag(34373830,382,50,"DigitalPrintActor.DigitalPrint: AAD user without Sway license clicked again on Print to Web feature.");this.Cac(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense);break;case 0:this.z2c=!1,this.Ij=(new tk.a).create(),this.Ij.message=WordEditorIntl.WordEditorStrings.L_DigitalPrintCheckingSwayLicense,this.Ij.PK(CommonUIStrings.l_DefaultDialogTitle,Object(m.a)(this,this.U4j,"checkSwayLicenseCanceled"),null),l.AFrameworkApplication.fe.ai(String.format("{0}/we/CheckSwayLicense.ashx?{1}",
Eb.App.webServiceBase,l.AFrameworkApplication.rootQuerySignature),2,null,null,!1,2,Object(m.a)(this,this.W4j,"checkSwayLicenseSuccessCallback"),Object(m.a)(this,this.V4j,"checkSwayLicenseFailCallback"),null)}return 32}HTe(){r.ULS.sendTraceTag(36824994,382,50,"DigitalPrintActor.CreateDigitalPrintDialog: Opening the DigitalPrintDialog. Button {0} clicked.",this.BGg);new qC(this._context,this.ga,l.AFrameworkApplication.K.Ga("SwayFontDownloadUrlTemplate"),l.AFrameworkApplication.K.Ga("FileSource"))}U4j(){this.z2c=
!0;r.ULS.sendTraceTag(34373831,382,50,"DigitalPrintActor.CheckSwayLicenseCanceled: Canceling license check...")}W4j(a){if(!this.z2c){this.Ij.close();var c=null;this.oNd(a.data,lg.a.zzn);({group:c}=Dm.a.D$(a.data.qd,c)).returnValue?(a=c.Responses[0],r.ULS.sendTraceTag(34373832,382,50,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization succeeded. HasLicense: {0}, Succeeded: {1}",a.HasLicense,a.Succeeded),a.Succeeded?(this.gde=a.HasLicense?1:2,2===this.gde?this.Cac(WordEditorIntl.WordEditorStrings.L_DigitalPrintNoSwayLicense):
this.HTe()):this.Cac(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown)):(r.ULS.sendTraceTag(34373833,382,10,"DigitalPrintActor.CheckSwayLicenseSuccessCallback: CheckSwayLicenseResponse deserialization failed"),this.Cac(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}}Cac(a){const c=new oe.StandardDialog;c.yc=0;c.Dea(CommonUIStrings.l_DefaultDialogTitle,a,null)}V4j(a){this.z2c||(this.Ij.close(),r.ULS.sendTraceTag(34373834,382,15,"DigitalPrintActor.CheckSwayLicenseFailCallback: CheckSwayLicense request failed!"),
this.oNd(a.data,lg.a.yzn),this.Cac(WordEditorIntl.WordEditorStrings.L_DigitalPrintSwayServiceDown))}oNd(a,c){Cj.a.instance.Xe(c,+a.VQ-+a.yF)}static kOl(){return"OneDriveWOPI"===l.AFrameworkApplication.K.Ga("FileSource")}}Object(w.a)(mH,"DigitalPrintActor",null,[]);class uL{constructor(){this.CJg=null}M1h(){r.ULS.sendTraceTag(25007841,375,50,"Do not check for this critique type triggered")}LRi(a){if(!a)return r.ULS.sendTraceTag(25007842,375,15,"Error range is null"),!1;if(!this.cYh(a.errorDetails))return!1;
this.CJg=Object(ha.a)(En.a,a.errorDetails).typeId;return!0}B1d(a){return this.cYh(a)?Object(ha.a)(En.a,a).typeId===this.CJg:!1}cYh(a){if(!a)return r.ULS.sendTraceTag(25007843,375,15,"No ErrorDetails found"),!1;a=Object(ha.a)(En.a,a);return a?a.token&&a.typeId?!0:(r.ULS.sendTraceTag(25007873,375,50,"Token is null: {0}",!a.token),!1):(r.ULS.sendTraceTag(25007872,375,50,"ErrorDetails is null"),!1)}}Object(w.a)(uL,"DoNotCheckThisCritiqueTypeStrategy",null,[543]);class vL extends gg.a{constructor(a,c,
h){super(!1,!1,!0);this.Eb=a;this.pia=h;this.ucj="DocumentChoiceGroup";this.Pgg="EmbededContent";this.tmg="HyperLink";this.qqe=h.f3a;a={["id"]:"ExternalContentDefaultSettingsDialog",["bodyControls"]:this.KCc()};this.o9i=this.TEk.bind(this);this.Nd(1,WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogSave);this.Tg(WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogTitle,this.o9i,a)}KCc(){const a=Array(2);a[0]={["key"]:this.Pgg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryContent};
a[1]={["key"]:this.tmg,["text"]:WordEditorIntl.WordEditorStrings.L_ExternalContentGalleryHyperLink};const c={};c.documentChoiceGroupProps={["id"]:this.ucj,["defaultSelectedKey"]:this.qqe?this.Pgg:this.tmg,["label"]:WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogDescription,["options"]:a};c.learnMoreLinkText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMore;c.learnMoreURL=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogLearnMoreUrl;
c.externalContentDefaultSettingsDialogInformationText=WordEditorIntl.WordEditorStrings.L_ExternalContentDefaultSettingsDialogInformation;return c}TEk(a,c){1===a?(this.qqe!==c.isExternalContentSelected&&(a=c.isExternalContentSelected?ba.a.rIa:ba.a.E$a,this.Eb.processAction(a,2),this.qqe=c.isExternalContentSelected,Z.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.ExternalContent.ExternalContentDefaultSettings",dataFields:[Object.assign(new aa.a,{name:"ActionId",int64:a})]}))),
this.pia.a7m(c.isExternalContentSelected)):0===a&&r.ULS.sendTraceTag(556565635,324,50,"Cancel Clicked in ExternalContentDefaultSettingsDialog")}}Object(w.a)(vL,"ExternalContentDefaultSettingsDialog",gg.a,[]);class Yr{constructor(a,c,h,v){this.kL=xa.a.instance.resolve("Common.IReactContextualUILauncher");this.wkb=Uf.a.On;this.ga=a;this.Xi=c;this.Ghg=v;this.n9i=this.UEk.bind(this);l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1);this.Ghg.Doi(()=>
{this.reset()})}eb(){this.ga.Aa(ba.a.AGf,ic.a.view,Object(m.a)(this,this.bli,"queryExternalContentPasteOptions"),97);this.ga.Aa(ba.a.BGf,ic.a.view,Object(m.a)(this,this.bli,"queryExternalContentPasteOptions"),97);this.ga.Aa(ba.a.Rjh,ic.a.view,this.n9i,1028);this.ga.Aa(ba.a.rIa,ic.a.view,Object(m.a)(this,this.Sjh,"externalContentPasteOptionsAction"),1028);this.ga.Aa(ba.a.E$a,ic.a.view,Object(m.a)(this,this.Sjh,"externalContentPasteOptionsAction"),1028);this.ga.Aa(ba.a.xac,ic.a.view,Object(m.a)(this,
this.xac,"showExternalContentFloatie"),96);this.ga.Aa(ba.a.vyb,ic.a.view,Object(m.a)(this,this.vyb,"hideExternalContentFloatie"),96)}Xqn(a){new vL(this.ga,a,Yr.pia)}UEk(a,c,h){1!==h&&this.Xqn(Yr.rQa);return 32}xac(){const a=Array(1);a.push("ExternalContent");var c=xa.a.instance.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider").Eab();c=Object.assign(new fF.a,{x:c.x,y:c.y});this.kL.showFloatie(c,a,1);return 32}vyb(){this.kL.Yqa&&this.kL.Ty();return 32}bli(a,c,h,v,B){if(c="object"===
typeof B?B:null)a===ba.a.AGf?(a=Yr.rQa!==ba.a.rIa&&Yr.rQa!==ba.a.E$a,c[this.wkb]=Yr.rQa===ba.a.rIa||a):a===ba.a.BGf&&(c[this.wkb]=Yr.rQa===ba.a.E$a);return 32}Sjh(a,c,h){1!==h&&(a===ba.a.E$a&&Yr.rQa!==ba.a.E$a?(r.ULS.sendTraceTag(575813832,324,50,"ExternalContentPasteHyperlinkOption clicked"),this.Xi.undo()&&(c=new y.a(1,l.AFrameworkApplication.isRtl),c.KPc="ExternalContent",Yr.D$a.LRc(c))):a===ba.a.rIa&&Yr.rQa!==ba.a.rIa&&(r.ULS.sendTraceTag(575813833,324,50,"ExternalContentPasteEmbededWebContentOption clicked"),
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.InsertFluidComponent",!1),this.Ghg.Kmi()),Yr.rQa=a);Z.a.sendTelemetryEvent(Object.assign(new ja.a,{name:"Office.Word.Online.ExternalContent.Floatie",dataFields:[Object.assign(new aa.a,{name:"behavior",string:h.toString()}),Object.assign(new aa.a,{name:"ActionId",int64:a})]}));return 32}static get D$a(){return Yr.uW||(Yr.uW=xa.a.instance.resolve("Box4.IExternalContentFloatieEventSource"))}static get pia(){Yr.Cua||(Yr.Cua=
xa.a.instance.resolve("WordEditor.ExternalContent.IExternalContentSettingInfo"));return Yr.Cua}reset(){Yr.rQa=null!=Yr.pia?Yr.pia.f3a?ba.a.rIa:ba.a.E$a:ba.a.rIa}}Yr.rQa=ba.a.rIa;Yr.uW=null;Yr.Cua=null;Object(w.a)(Yr,"ExternalContentActor",null,[]);class rC extends U{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){super(a,c,h,v,B,X,ma,Pa,mb,Tb);this.Fvd=!1;this.epk=100;this.Emf=!1;this.Hng=null;this.kL=xa.a.instance.resolve("Common.IReactContextualUILauncher")}lSc(){this.Fvd||(super.lSc(),this.Fvd=!0)}O6d(){this.Fvd&&
(super.O6d(),rC.jgh&&this.Hng&&rC.jgh.removeHandler(gn.a.rwa,this.Hng),this.Fvd=!1)}Ycc(){this.kL.Yqa&&l.AFrameworkApplication.pa.processAction(ba.a.vyb,2);l.AFrameworkApplication.pa.processAction(ba.a.xac,2);this.Emf=!1}Ty(a){!this.Wne&&(a&&(this.bpb.Tgf(),this.MSi()),this.kL.Yqa||this.YEa)&&(this.YEa=!a,this.O6d(),l.AFrameworkApplication.pa.processAction(ba.a.vyb,2))}showFloatie(a,c){c||(c=new y.a(0,l.AFrameworkApplication.isRtl));c.location||(c.location=this.bpb.Eab());if(!c.location)return!1;
this.YEa&&(this.YEa=!1,this.lSc());l.AFrameworkApplication.pa.processAction(ba.a.xac,2);return!0}Yah(){if(!this.Emf){const a=new Se.a(3,1,this.epk,()=>{this.Ycc()},196);ag.a.instance.ub(a);this.Emf=!0}}gea(){l.AFrameworkApplication.pa.processAction(ba.a.vyb,2);this.Yah()}CFb(){l.AFrameworkApplication.pa.processAction(ba.a.vyb,2);this.Yah()}static get jgh(){return rC.Bo||(rC.Bo=xa.a.instance.resolve("Box4.IEditStateEventManager"))}}rC.Bo=null;Object(w.a)(rC,"ExternalContentFloatieEventManager",U,[]);
class sC extends jb{constructor(a,c,h,v,B){super(a,c,h,v,B)}BZg(){if(!this.ya||!this.ya.Ca||!this.ya.Ca.Fa)return r.ULS.sendTraceTag(575813836,307,15,"Selection is null when we try to calculate external content floatie position"),null;var a=this.ya.Ca.Fa.sa,c=!a.cpBegin&&!a.cpEnd;let h=a.node;if(h&&c&&!h.BI){do h=this.MAh(h);while(h&&!h.BI&&Object(Ub.a)(Fb.AParagraphNode,h)&&!h.characterData.trim().length)}let v="";const B=Object(ha.a)(Fb.AParagraphNode,h);B&&(v=B.characterData.length===a.cpBegin||
c?B.characterData.trimEnd():B.characterData.substring(0,a.cpBegin).trimEnd());c=B?v.length:a.cpBegin;a=Object.assign(new Na,{lsa:Object(ha.a)(150,(B?Object(ha.a)(150,B):Object(ha.a)(150,h))||a.node),z7b:c});return this.E7e(a)}bwh(a,c){let h=null;const v=Object(ha.a)(169,a.lsa.kj(c.gb));if(!v)return null;if(Object(Ub.a)(Fb.AParagraphNode,a.lsa)){const B=Object(ha.a)(Fb.AParagraphNode,a.lsa);if(B.WN){if(a=Object(ha.a)(uw.a,sd.ParagraphReader.Jab(B)))(a=Object(ha.a)(169,a.kj(c.gb)))&&(h=a.getBounds()),
h&&(h.height+=sC.Xmh,h.width-=sC.tLk);return h}c=Object(ha.a)(102,v);if(!c)return null;try{if(h=this.FN.XW(a.z7b,c,0<a.z7b,!1,!1,!1))h.height+=sC.Xmh}catch(X){r.ULS.sendTraceTag(575813837,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",X),h=null}}h||(h=v.getBounds());return h}}sC.Xmh=65;sC.tLk=100;Object(w.a)(sC,"ExternalContentFloatiePositionProvider",jb,[]);class wL{constructor(a,c,h,v,B,X){this.ga=a;this.l2=c;this.HMb=h;this.gcj=v;this.Ffg=B;this.E9i=X}eb(){l.AFrameworkApplication.K.$("DisablePrintBasedOnPolicy")&&
this.gcj?(document.body.classList.add("WACStopPrinting"),""!==this.Ffg&&this.E9i.vrn(this.Ffg)):(this.ga.ka(zb.a.print,ic.a.application,Object(m.a)(this,this.FLf,"requestDownload")),this.ga.ka(ba.a.dAc,ic.a.application,Object(m.a)(this,this.FLf,"requestDownload")),this.ga.ka(ba.a.hud,ic.a.application,Object(m.a)(this,this.FLf,"requestDownload")))}FLf(a,c,h){if(1===h)return l.AFrameworkApplication.protectFile||l.AFrameworkApplication.Aja||ya.SessionStatusManager.instance.gi?8:32;if(a===zb.a.print)a=
1;else if(a===ba.a.dAc)a=0;else if(a===ba.a.hud)a=2;else return 8;return this.M6m(a)}M6m(a){const c=l.AFrameworkApplication.rootQuerySignature;if(!c||""===c||Eb.App.lc&&Eb.App.lc.xz.Kn)return 8;this.HMb.KHd=!1;this.HMb.KYi.start();pu.a.jO(5,!0,Object(m.a)(this.HMb,this.HMb.X0m,"requestFileDownload"),Object(m.a)(this.HMb,this.HMb.SCb,"onForceSaveFailed"),a);return 32}}Object(w.a)(wL,"FileDownloadActor",null,[]);class xL extends jg{constructor(a,c=null){super(a,!0,c,!1)}get mef(){return null}get NYa(){return l.AFrameworkApplication.AUa?
CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get I4b(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get Eld(){return null}}Object(w.a)(xL,"DownloadAsPdfDialog",jg,[]);class Au{constructor(){this._url=this.Ju=null;this.FRa=this.ERa=0;this.C7a=!1}send(a,c,h){this._url=a;this.Ju=c;this.C7a=h;this.makeRequest(null)}makeRequest(){l.AFrameworkApplication.fe.ai(this._url,1,null,null,!0,2,Object(m.a)(this,
this.bDb,"onRequestSucceeded"),Object(m.a)(this,this.pka,"onRequestFailed"),null)}bDb(a){Au.CTc();const c=a.data.T9;let h=null;if(c)try{h=c.selectSingleNode("/docdata/status")}catch(v){}h&&("InProgress"===h.text&&22>this.ERa++||"ServiceBusy"===h.text&&3>this.FRa++)?this.IBa(1E3*(this.ERa+this.FRa)):this.Ju(!0,h?h.text:null,a.data)}pka(a){this.C7a?(Au.Ava||(Au.g5a=new Date,Au.Ava=!0,Au.zQ=1),18E4>(new Date).getTime()-Au.g5a.getTime()?this.retryOnFailure(4<=Au.zQ?2E4:1E3):this.pWa(a.data)):4>Au.zQ?
this.retryOnFailure(2E3):this.pWa(a.data)}IBa(a){a=new Se.a(2,1,a,Object(m.a)(this,this.makeRequest,"makeRequest"));l.AFrameworkApplication.Cb.ub(a)}retryOnFailure(a){this.IBa(a);Au.zQ++}pWa(a){this.Ju(!1,null,a)}static Z7(a,c){(new Au).send(a,c,!1)}static CTc(){Au.Ava=!1;Au.zQ=0}}Au.g5a=null;Au.Ava=!1;Au.zQ=0;Object(w.a)(Au,"ClientRequestWithRetry",null,[]);class yL extends Qf{constructor(a){super(a,void 0,l.AFrameworkApplication.AUa)}get NYa(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogOdtReady}get I4b(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLinkSuggestion}get TLc(){return"DownloadOdtLink"}get buttonText(){return CommonUIStrings.l_Download}get Iyc(){return l.AFrameworkApplication.AUa?
"UIFontDialogTextLarge":null}Dpf(){r.ULS.sendTraceTag(7628378,324,50,"ODT download dialog displayed")}Epf(){r.ULS.sendTraceTag(7628379,324,50,"ODT download dialog link clicked")}iMc(){r.ULS.sendTraceTag(19462216,324,50,"ODT download dialog button clicked")}get BLc(){return HG.$8h}get Ddb(){return WordEditorIntl.WordEditorStrings.l_DownloadAsOdtDialogLearnMoreLinkText}get o5h(){return!l.AFrameworkApplication.AUa}}Object(w.a)(yL,"DownloadAsOdtDialog",Qf,[]);class zL{constructor(a,c){this.d4a=this.ASa=
null;this.KHd=!1;this.vlb=a;this.KYi=c.cLa("UserAction","WordEditorForceSaveAndPrint")}i0a(a){1===Eb.App.oa.state||this.ASa||(this.ASa=(new tk.a).create(),a=a.customData,this.t2l(a),1===a?this.ASa.message=this.vlb.fO.isEnabled?l.AFrameworkApplication.AUa?CommonUIStrings.l_DirectPrintPreparingPDF:WordEditorIntl.WordEditorStrings.L_DirectPrintWait:WordEditorIntl.WordEditorStrings.l_PrintPDFWait:a?2===a&&(this.ASa.message=WordEditorIntl.WordEditorStrings.l_ConversionToODTWait):this.ASa.message=WordEditorIntl.WordEditorStrings.l_PrintPDFWait,
this.ASa.PK(CommonUIStrings.l_DefaultDialogTitle,Object(m.a)(this,this.cancelButton,"cancelButton"),null))}cancelButton(){this.KHd=!0}Yha(a){this.ASa&&(this.G2l(a),this.ASa.close(),this.ASa=null)}t1(a){if(1!==Eb.App.oa.state){this.x3l(a);const c=new oe.StandardDialog;c.yc=0;c.Nd(1,CommonUIStrings.l_DialogClose);c.Fw(0,"",1===a?WordEditorIntl.WordEditorStrings.l_PrintError:WordEditorIntl.WordEditorStrings.l_ConversionError,null,!0)}}mdl(a){switch(a){case 0:return"downloadpdf";case 1:return"printpdf";
case 2:return"odt";default:return r.ULS.sendTraceTag(7628383,324,10,"Unknown request PDF type {0}",a),"printpdf"}}X0m(a){var c=l.AFrameworkApplication.rootQuerySignature;c&&""!==c?(c="WordViewer/request."+this.OEk(a)+"?"+c+"&type="+this.mdl(a)+"&rndm="+Ya.a.create(),1===a&&this.vlb.Wpn()&&(c+="&useNamedAction=1"),l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("CustomFontReadModePDFIsEnabled")&&Rn.FontUtils.t1d()&&(1===a||!a)&&(0<Rn.FontUtils.Kah&&(c+="&cfcVer="+Rn.FontUtils.Kah),Rn.FontUtils.Jah&&
(c+="&cfcUrl="+Rn.FontUtils.Jah),Rn.FontUtils.Lah&&(c+="&cfcEncData="+Rn.FontUtils.Lah)),Au.Z7(c,Object(m.a)(this,this.N4,"onRequestComplete")),this.d4a||(this.d4a=new Se.a(2,1,500,Object(m.a)(this,this.i0a,"showWaitUI")),this.d4a.customData=a,l.AFrameworkApplication.Cb.ub(this.d4a))):(this.tVf("failed. QuerySignature is empty."),this.t1(a))}OEk(a){return 2===a?"odt":"pdf"}SCb(){this.tVf("Failed. force save failed.")}n1m(a){if(0<a.indexOf("&type=downloadpdf"))return 0;if(0<a.indexOf("&type=printpdf"))return 1;
if(0<a.indexOf("&type=odt"))return 2;r.ULS.sendTraceTag(7628384,324,10,"Could not get requestType from uri:{0}",a);return 1}N4(a,c,h){this.tVf("Success. Save and Conversion Complete.");h=new Wa.QueryStringBuilder(h.request.get_url());l.AFrameworkApplication.Aoa(h);h=h.toString();const v=this.n1m(h);this.Yha(v);2!==v&&this.vlb.sFm();!a||c?this.t1(v):this.KHd?(this.KHd=!1,this.d4a=null):(this.d4a&&l.AFrameworkApplication.Cb.me(this.d4a),this.d4a=null,this.Tvk(h,v))}tVf(a){r.ULS.sendTraceTag(7628385,
328,50,"stopping the perf counter for forcesave and print. [StoppingReason:{0}]",a);this.KYi.stop()}Tvk(a,c){const h=new Ua.a;h.add("access_token");h.add("access_token_ttl");1!==Eb.App.oa.state&&(1===c?this.vlb.fsn(a,h):c?2===c&&new yL(a):new xL(a))}dispose(){}t2l(a){switch(a){case 0:r.ULS.sendTraceTag(38114782,203,50,"Download Attempt: Pdf");break;case 2:r.ULS.sendTraceTag(38114783,203,50,"Download Attempt: Odt");break;case 1:r.ULS.sendTraceTag(38114784,203,50,"Download Attempt: PrintPdf");break;
default:r.ULS.sendTraceTag(38114785,203,15,"Download Attempt: {0}",a)}}G2l(a){switch(a){case 0:r.ULS.sendTraceTag(38114786,203,50,"Download Cancelled: Pdf");break;case 2:r.ULS.sendTraceTag(38114787,203,50,"Download Cancelled: Odt");break;case 1:r.ULS.sendTraceTag(38114816,203,50,"Download Cancelled: PrintPdf");break;default:r.ULS.sendTraceTag(38114817,203,15,"Download Cancelled: {0}",a)}}x3l(a){switch(a){case 0:r.ULS.sendTraceTag(38114818,203,15,"Download Failed: Pdf");break;case 2:r.ULS.sendTraceTag(38114819,
203,15,"Download Failed: Odt");break;case 1:r.ULS.sendTraceTag(38114820,203,15,"Download Failed: PrintPdf");break;default:r.ULS.sendTraceTag(38114821,203,15,"Download Failed: {0}",a)}}}Object(w.a)(zL,"FileDownloadManager",null,[]);class tC{get key(){return"LIST"}get $u(){return Box4Intl.Box4Strings.l_ListContentTitle}Icc(a){let c=null;const h=tC.Yb.Op(a);if(!h)return{returnValue:!1,Jha:c};a=this.F5k(a,h);c=Object.assign(new bt.a,{mE:this.key,contentId:a.listId,contentObject:a});return{returnValue:!0,
Jha:c}}Lwb(a,c){a=a.contentObject;const h=this.x4k(a.lv),v=new Kh.a;c?(c=c.contentObject,c.level!==a.level?(v.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),v.add(h)):c.id.equals(a.id)&&c.lv.listType===a.lv.listType||v.add(h)):(v.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),v.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),v.add(h));return v.toArray().join(" ")}x4k(a){let c="";const h=a.listStyle;if(!a.listType)c=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,
a.Lo);else if(1===a.listType)switch(h){case 1:c=this.vYg;break;case 2:c=this.YYj;break;case 3:c=this.ZYj;break;default:c=this.vYg}return c}static get Yb(){return tC.zc||(tC.zc=xa.a.instance.resolve("Box4.List.IListReader"))}}tC.zc=null;Object(w.a)(tC,"ListDetailsProvider",null,[745,431]);class AL{constructor(){this.lv=this.listId=this.id=null;this.level=0}}Object(w.a)(AL,"ListItemInfo",null,[]);class BL extends tC{constructor(a){super();this.oT=a}get vYg(){return WoncaIntl.WoncaStrings.L_BulletStyle1}get YYj(){return WoncaIntl.WoncaStrings.L_BulletStyle2}get ZYj(){return WoncaIntl.WoncaStrings.L_BulletStyle3}F5k(a,
c){const h=this.oT.Fv(a);return Object.assign(new AL,{id:a.currentNode.id,listId:new N.a(Ya.a.nil,h.listID),lv:c,level:h.level+1})}}Object(w.a)(BL,"FlatListDetailsProvider",tC,[]);class CL{constructor(a,c){this.$b=null;this.ga=a;this.zc=c}get qb(){return this.$b||(this.$b=xa.a.instance.ra("Box4.Styles.IWACStyleReader"))}eb(){}}Object(w.a)(CL,"FormattingActor",null,[]);var oD=b(1151),dQ=b(1536);class DL{constructor(a,c,h,v,B,X,ma,Pa){this.Pa=a;this.$tj=c;this.Fb=h;this.zmb=v;this.gl=B;this.qa=X;this.Na=
ma;this.vjj=Pa}oZa(a,c,h,v,B,X,ma){r.ULS.sendTraceTag(574358090,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ma.Yg});this.zmb.then(()=>{this.$tj(a.data.qd);r.ULS.sendTraceTag(574358091,3001,50,"GraphicsEditorDocumentXmlToJsonRequestHelper load success: {0}",{["Method"]:"OnRequestSuccess",["DurationInMilliseconds"]:ma.Yg});ma.stop()})}pka(a,c,h,v,B,X,ma){X.stop();B();ma?(this.GAm(c,h),r.ULS.sendTraceTag(574377989,3001,50,a)):
r.ULS.sendTraceTag(574377990,3001,10,a)}nSg(a,c){a.Hd(yF.a.ESe,"1");if(this.Na&&this.Na.isFeatureEnabled(81)){var h=this.gl.Jk(c.lm);h=this.gl.hm(h);a.Hd(dh.a.Qp,oD.a[h]);5===h&&this.ENj(a,c)}this.vjj&&a.Hd(dh.a.Sef,"true")}qMg(){return new dQ.a(this.Pa.id,this.Pa)}JBd(){return WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError}GAm(a,c){const h=this.Fb.Ob(7,zb.a.Gnl);h.Oa(c);a.Pa.setValue(Yb.a.d6g,!0);h.dispose()}ENj(a,c){var h=c.lm;c=this.gl.Jk(h);var v=h.node;const B=(h=this.gl.Iya(c,
v.Mb,!1))?this.gl.Aya(h):"";if(""===B)throw r.ULS.sendTraceTag(572555911,3001,10,"Could not find original dataBlobId on picture node."),Error.argumentNull("OriginalObjectDataBlobId");v=(v=this.gl.Iya(c,v.Mb,!0))?this.gl.Aya(v):"";a.Hd(dh.a.d7b,B);a.Hd(dh.a.NYi,v);h=h.ia(zi.a.Ukh,"");""!==h&&a.Hd(dh.a.extension,h);a.Hd(dh.a.width,this.gl.oC(c).toString());a.Hd(dh.a.height,this.gl.PD(c).toString());a.Hd(dh.a.TPc,this.gl.$ab(c).toString());h=this.qa.$("WordEditorImageCropIsEnabled");a.Hd(dh.a.bah,h.toString());
h&&(a.Hd(dh.a.top,this.gl.Qia(c).toString()),a.Hd(dh.a.bottom,this.gl.Nia(c).toString()),a.Hd(dh.a.left,this.gl.Oia(c).toString()),a.Hd(dh.a.right,this.gl.Pia(c).toString()));h=this.qa.$("WordEditorImageRotateIsEnabled");a.Hd(dh.a.awi,h.toString());h&&(a.Hd(dh.a.angle,this.gl.a4(c).toString()),a.Hd(dh.a.flipH,this.gl.J1(c,Yb.a.YFc,!1)?"true":"false"),a.Hd(dh.a.flipV,this.gl.J1(c,Yb.a.gGc,!1)?"true":"false"));a.Hd(dh.a.Ogh,"true")}}Object(w.a)(DL,"GraphicsEditorDocumentXmlToJsonRequestHelper",null,
[549]);class EL{constructor(){this.DEa=null}wTj(a){this.DEa=a}teardown(){null!=this.DEa&&(this.DEa.teardown(),this.DEa=null);this.Qwe=null}getGraphicData(){return this.DEa?this.DEa.getGraphicData():null}XUm(){null!=this.Qwe&&this.setGraphicData(this.Qwe)}setGraphicData(a){this.Qwe=a;if(this.DEa)try{this.DEa.setGraphicData(a)}catch(c){r.ULS.sendTraceTag(575522530,3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: Exception {0} thrown from GraphicHost.",c.toString())}else r.ULS.sendTraceTag(575522529,
3001,10,"GraphicsEditorGC2HostUser::SetGraphicData: GraphicHost is null.")}hasEdits(){return this.DEa?this.DEa.hasEdits():!1}}Object(w.a)(EL,"GraphicsEditorGC2HostUser",null,[551]);var eQ=b(1537),fQ=b(1185),gQ=b(565),hQ=b(1269),iQ=b(954);class FL{constructor(a){this.preloadScript=this.loadScript=null;this.loadScript=c=>a.loadScript(c);this.preloadScript=c=>{a.preloadScript(c)}}}Object(w.a)(FL,"GC2ScriptLoader",null,[]);class nH{constructor(a,c,h){this.Kde=a;this._context=c;this.SFa=h}closeEditor(){this.Kde&&
(this.Kde(),this.Kde=null)}logTrace(a,c,h,v){r.ULS.sendTraceTag(575522531,3001,nH.Z8l(c),v)}isEnabled(a){const c=l.AFrameworkApplication.K;switch(a){case "SmartGuides":return c.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsSmartGuides",!1);case "EqualSizingGuide":return c.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsEqualSizingGuide",!1);case "AdjustHandles":return c.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsAdjustHandles",!1);case "SpaceFirstLastPara":return c.getBooleanFeatureGate("Microsoft.Office.WordOnline.TextSpaceFirstLastPara",
!1);case "ModernFontPicker":return c.$("ModernFontPickerIsEnabled");case "CropGridLines":return c.getBooleanFeatureGate("Microsoft.Office.WordOnline.CropGridLines",!1);case "CropResolution":return c.getBooleanFeatureGate("Microsoft.Office.WordOnline.CropResolution",!1);case "SnapToAspectRatio":return c.getBooleanFeatureGate("Microsoft.Office.WordOnline.SnapToAspectRatio",!1);case "SVG":return c.getBooleanFeatureGate("Microsoft.Office.WordOnline.GraphicsUseSVG",!1);default:return!1}}getFontPickerFonts(a){const c=
`${xa.a.instance.resolve("Box4.IFontServiceParser").lVa}/${"hier_officeFontsPreview.ttf"}`;a("msofp_hier",c);a=Rn.FontUtils.p4e(()=>!1,()=>"",!0);return{commandId:"FontPicker",fonts:a.fonts.filter(h=>"premium"!==h.fontType),mruList:a.mruList,previewFontFamily:"msofp_hier_MSFontService"}}getFonts(a){const c=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernFontPicker",!1),h=c?"msofp_hier":"msofp",v=`${xa.a.instance.resolve("Box4.IFontServiceParser").lVa}/${c?"hier_officeFontsPreview.ttf":
"flat_officeFontsPreview.ttf"}`;a(h,v);Rn.FontUtils.VMg();Rn.FontUtils.yNg({});a=Rn.FontUtils.o4e(()=>!1,(B,X)=>X).MenuSectionList;c&&0<a.length&&(a.pop(),a.push(this.Obk()));return a}Obk(){const a=Rn.FontUtils.p4e(()=>!1,()=>"").fonts.map((c,h)=>{const v=c.name;c=c.displayName;const B=Rn.FontUtils.Kja(v);return Object.assign(new bJ.a,{MenuItemId:Rn.FontUtils.kyi+h,CommandValueId:v,LabelText:c||v,Styles:{["optionText"]:{["fontFamily"]:c&&!B?"msofp_hier_MSFontService":"'Segoe UI',Tahoma,Sans-Serif;"}},
AriaLabel:v})});return Object.assign(new Hg.a,{Title:CommonUIStrings.l_FontDropdownMenuSectionAll,Id:"AllFontsDropdown",ControlList:a})}getPictureDataFromId(a){const c=this._context.lm;var h=dd.ImageReader.Jk(c);if(this.sMl(h,c,a)&&(h=dd.ImageReader.J1(h,Uc.a.Lda,""),h.length))return Promise.resolve(h);h=new Wa.QueryStringBuilder("/we/GetImage.ashx?");h.fTb(c.node.Eh().fr);h.Hd(dh.a.Esd,a);l.AFrameworkApplication.Aoa(h);h.Hd(of.a.Bjb,"1");Um.a.instance.Yrb(h);h.Hd(dh.a.Vah,"true");const v=h.toString();
return new Promise((B,X)=>{this.SFa.ai(v,1,null,null,!1,2,ma=>{B(ma.data.qd)},ma=>{X(ma.data.we.toString())},null)})}getPlaceholders(){const a={};a.PictureDownloading=uk.a.Ah("progress.gif");a.PictureInvalid=uk.a.Ah("CancelRequest.32x32x32.png");return a}getTheme(){const a=jn.PageNavigator.instance.Xs(this._context.view.sc).properties.ia(Yb.a.d5d,"");return 0===a.length?[]:a.split(" ").map(c=>Eb.App.HVb[c])}static Z8l(a){switch(a){case 0:return 10;case 1:return 15;case 2:return 50;case 3:return 100;
case 4:return 200;default:return 50}}sMl(a,c,h){const v=c.node.Mb;c=dd.ImageReader.UAd(a,v,!1);a=dd.ImageReader.UAd(a,v,!0);return h===c||h===a}}Object(w.a)(nH,"GraphicsEditorApp",null,[557]);class GL extends gg.a{constructor(a,c,h,v,B){super(!1,!1,!0);this.u4a=a;this.wgj=c;this.Lmg=h;this._context=v;this.SFa=B}mrn(){return new Promise((a,c)=>{const h={["id"]:"GraphicsEditorDialog",["bootstrap"]:(v,B)=>this.wUj(B),["onload"]:v=>{this.onLoad(v,a,c)},["editorDiscardText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogDiscardChanges,
["editorSaveText"]:WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogSave,["onReload"]:()=>{this.u4a.XUm()}};this.Tg(WordEditorIntl.WordEditorStrings.L_GraphicsEditorDialogTitle,Object(m.a)(this,this.Vha,"dialogHandler"),h)})}onLoad(a,c,h){a?(this.u4a.wTj(a),c(a)):(r.ULS.sendTraceTag(573100169,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Null host"),h(null))}wUj(a){const c=l.AFrameworkApplication.K,h=iQ.a();h.loadScriptWithRetryHandler=a;const v=new nH(Object(m.a)(this,this.closeEditor,"closeEditor"),
this._context,this.SFa),B={["bootConfig"]:Object.assign(new fQ.a,{scriptBaseUrl:gD.AppChromeOverrideUtilities.isEnabled?gD.AppChromeOverrideUtilities.FAd(l.AFrameworkApplication.lcid):l.AFrameworkApplication.LV+l.AFrameworkApplication.lcid+"/",isMLRRibbonMode:l.AFrameworkApplication.na.Ya.lac}),["scriptLoader"]:new FL(new dynamicScriptLoader.DynamicScriptLoader(h)),["publicPath"]:l.AFrameworkApplication.LV,["appSettings"]:c.appSettings,["logger"]:new lo.a,["featureGateManager"]:Object.assign(new gQ.a,
{getBooleanFeatureGate:Object(m.a)(c,c.getBooleanFeatureGate,"getBooleanFeatureGate"),getIntFeatureGate:Object(m.a)(c,c.getIntFeatureGate,"getIntFeatureGate"),getStringFeatureGate:Object(m.a)(c,c.getStringFeatureGate,"getStringFeatureGate")}),["app"]:v,["resolveScript"]:(X,ma)=>hQ.a.resolveScript(X,ma)};c.$("DynamicBundlesIsEnabled")&&(B.dynamicBundlesPath=gD.AppChromeOverrideUtilities.isEnabled?gD.AppChromeOverrideUtilities.T9b+"exp/":c.Ga("StaticContentUrl")+"exp/");return new Promise((X,ma)=>{a("gc2",
l.AFrameworkApplication.vx("gc2.js",5),"anonymous",5,!1).then(()=>{X(B)}).catch(()=>{r.ULS.sendTraceTag(572915794,3001,10,"ReactGraphicsEditorDialog::Bootstrap: Failed To Download Scripts");ma(null)})})}x6g(a){a=this.u4a.hasEdits()&&!a;this.wgj(a?this.u4a.getGraphicData():null,!!this.Lmg,this.Lmg,a)}closeEditor(){this.x6g();this.dispose()}Vha(a){this.x6g(2===a)}}Object(w.a)(GL,"ReactGraphicsEditorDialog",gg.a,[]);class HL{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee){this.zmb=this._context=null;
this.$ci=(Ie,Xe=!0)=>{this.u4a.setGraphicData(Ie);performance.mark("LaunchEnd");performance.measure("EditorLaunch","LaunchStart","LaunchEnd");Ie=performance.getEntriesByName("EditorLaunch");r.ULS.sendTraceTag(559424645,3001,50,`Graphics Editor dialog launched with data successfully set. Existing: ${Xe} Duration: ${Ie[Ie.length-1].duration}`);performance.clearMarks("LaunchStart");performance.clearMarks("LaunchEnd");performance.clearMeasures("EditorLaunch")};this.ga=a;this.qa=c;this.oke=h;this.Og=v;
this.Lw=B;this.Xi=X;this.u4a=new EL;this.Fb=Pa;this.Ba=mb;this.ZS=Tb;this.gl=rc;this.Na=vd;this.Qe=Tc;this.VE=ee}eb(){let a=!0;this.qa.$("GraphicsEditorActorRegistrationUpdateIsEnabled")||(a=this.Na&&this.Na.isFeatureEnabled(81));a&&!H.a.Gi&&(this.ga.Aa(ba.a.graphicsEditor,ic.a.view,Object(m.a)(this,this.nrn,"showGraphicsEditorDialogActionHandler"),4),this.ga.Aa(zb.a.DZe,ic.a.view,Object(m.a)(this,this.gpl,"handleEditExistingContent"),4),this.ga.Aa(ba.a.igh,ic.a.view,Object(m.a)(this,this.hpl,"handleEditIllustrationContextMenu"),
4))}nrn(a,c,h,v,B){const X=!!B&&Object(Ub.a)(N.a,B);try{if(1===h){const ma=c.view;return this.Og.tha(c)&&ma.features.T3d?32:8}r.ULS.sendTraceTag(573100171,3001,50,`Launch Graphics Editor dialog. Existing:${X}`);performance.mark("LaunchStart");this._context=c;this.zmb=(new GL(this.u4a,Object(m.a)(this,this.Xxf,"onCloseDialog"),X?B:null,c,this.Qe)).mrn().then(()=>{r.ULS.sendTraceTag(559424644,3001,50,`Graphics Editor dialog display success. Existing:${X}`)}).catch(()=>{this.oeh()});if(!X){const ma=
Tb=>{this.zmb.then(()=>{this.$ci(Tb,!1)})};if(l.AFrameworkApplication.sessionStartInfoSettings&&"Automation"===l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)return ma(JSON.stringify({elements:[]})),32;let Pa=null;Pa=jn.PageNavigator.instance.Xs(c.view.sc);const mb=Pa.properties.ia(Yb.a.Soh,"");if(0<mb.length)return ma(mb),32;this.oke.E$m(c,N.a.create(),Ya.a.create()).then(Tb=>{const rc=this.Fb.Ob(0,zb.a.zFc);rc.Oa(Pa);Pa.setValue(Yb.a.Soh,Tb);rc.dispose();ma(Tb);return null}).catch(()=>
{this.oeh()})}return 32}catch(ma){return r.ULS.sendTraceTag(42328736,3001,10,"Exception = [{0}] when bringing up Graphics Editor Dialog. Existing:${1}",ma.toString(),X),8}}oeh(){const a=new oe.StandardDialog;a.yc=0;a.Fw(Qk.a.sZe,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorDefaultError,null);Eb.App.oa.updateCommandUI()}gpl(a,c,h,v,B){if(!c.view.features.T3d)return 32;r.ULS.sendTraceTag(574232200,3001,50,"Launch Graphics Editor: DoubleClick");this.ggh(B,
c);return 32}hpl(a,c,h){if(1===h)return c.view.features.T3d?32:8;if(2===h){a=dd.ImageReader.Jk(c.lm);if(!a)return 2;r.ULS.sendTraceTag(574232201,3001,50,"Launch Graphics Editor: ContextMenu");this.ggh(a,c);return 32}return 2}ggh(a,c){var h=a.ia(ii.a.Esa,1);const v=a.ia(zi.a.CX,0);h&&1!==v?a.ia(Yb.a.d6g,!1)?(c=new oe.StandardDialog,c.yc=0,c.Fw(Qk.a.sZe,Box4Intl.Box4Strings.l_GraphicsEditorErrorTitle,WordEditorIntl.WordEditorStrings.L_GraphicsEditorUnsupportedContentError,null),Eb.App.oa.updateCommandUI()):
(this.ga.hb(ba.a.graphicsEditor,2,a.id),this.zmb||(r.ULS.sendTraceTag(574997639,3001,10,"GraphicsEditorDialogInitialization promise was null!"),this.zmb=new Promise(B=>{B(null)})),h=Ya.a.create(),a=new DL(a,this.$ci,Fk.a.instance,this.zmb,this.gl,this.qa,this.Na,Eb.App.instance.Bjf(this.gl.hm(a))),this.oke.BOf(a,c,!0,h)):r.ULS.sendTraceTag(573055959,3001,50,"Graphics Editor launch diverted since Box4 model is not ready!")}Xxf(a,c,h,v){var B;this.u4a.teardown();if(c&&this._context){var X=this._context.view.Ma.If,
ma=X.node;X.Kk&&sd.ParagraphReader.tb(ma)&&(X=null===(B=this.VE)||void 0===B?void 0:B.QD(ma),27==(null===X||void 0===X?void 0:X.role)&&r.ULS.sendTraceTag(541446533,3016,50,"Editing Pull Quote using Graphics Editor. Has edits: {0}; {1}",v,v?" Everything deleted: "+(0==(null===a||void 0===a?void 0:a.json.length)):""))}if(v)if(r.ULS.sendTraceTag(541714E3,3001,50,"GraphicsEditorActor: close dialog and save"),this._context)if(a)if(v=a.json,B=a.width,ma=a.height,v.length||c)if(!v.length&&c)if(c=this._context.lm){c=
c.node;if(dd.ImageReader.GX(c)){if(!this.Og.mVm(c,new Kd.GraphIterator,li.a.instance,sL.DeleteActor.RSb)){r.ULS.sendTraceTag(588817116,3001,10,"Failed to remove anchored image.");return}}else if(!this.Og.QEb(c,h,this.Ba,this.ZS)){r.ULS.sendTraceTag(572363225,3001,10,"Failed to remove inline image.");return}r.ULS.sendTraceTag(572363226,3001,50,"Graphic removed thru dialog.")}else r.ULS.sendTraceTag(588886034,3001,10,"Context was in invalid state for removing existing content.");else X=new eQ.a(this._context,
l.AFrameworkApplication.na.BJa,!0,this.Og,this.qa,jn.PageNavigator.instance),a=Ya.a.create(),h=new VK.a(X,v,this.Lw,this.Xi,a,Fk.a.instance,c,h,this.Og,this.gl,B,ma,this.qa,this.ZS,this.Na,Eb.App.instance.RId,Eb.App.instance.PFd),this.oke.BOf(h,this._context,c,a),this.C$();else r.ULS.sendTraceTag(541714001,3001,50,"Empty Json on new content creation when close dialog");else r.ULS.sendTraceTag(577868244,3001,10,"JSON was unexpectedly null and the model did change!");else r.ULS.sendTraceTag(590205069,
3001,10,"GraphicsEditorActor: context cannot be null")}C$(){const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");a?a.execute(c=>{c.logActivity("WordWebDrawing","WordDrawingFloodgateIsEnabled")}):r.ULS.sendTraceTag(572352085,3001,10,"ISystemInitiatedFeedback was null")}}Object(w.a)(HL,"GraphicsEditorActor",null,[]);class IL{zon(a){return sd.ParagraphReader.axa(this.zvh(a))}gVc(a,c,h){if(a=sd.ParagraphReader.Jab(this.zvh(a)))c=a.Sd(c),Object(Ub.a)(544,c)&&(xu.j(a)?c.qjn(h):c.gVc())}zvh(a){return a&&
a.Kk&&a?a.node:null}}Object(w.a)(IL,"IFrameFocusStrategy",null,[545]);class JL{constructor(a){this.Vqb=null;this.Kmb=a}M1h(){r.ULS.sendTraceTag(25007835,375,50,"Ignore all spelling error triggered")}LRi(a){if(!a)return r.ULS.sendTraceTag(25007836,375,15,"Error range is null"),!1;if(!a.errorDetails)return r.ULS.sendTraceTag(25007837,375,15,"No error detail found"),!1;if(!a.errorDetails.token)return r.ULS.sendTraceTag(25007838,375,50,"Ignore-all: Token is null and the ErrorDetails type is {0}",Object.getType(a.errorDetails).toString()),
!1;this.Vqb=F.a.p5d(a.errorDetails.token,a.errorDetails.lcid);this.Kmb.add(this.Vqb,a.errorDetails.lcid);return!0}B1d(a){return a?a.token?F.a.p5d(a.token,a.lcid)===this.Vqb:(r.ULS.sendTraceTag(25007840,375,15,"ErrorDetails Token is null"),!1):(r.ULS.sendTraceTag(25007839,375,15,"ErrorDetails is null during ignore-all operation"),!1)}}Object(w.a)(JL,"IgnoreAllProofingErrorStrategy",null,[543]);var jQ=b(1196),oH=b(508);class KL{constructor(a,c){this.filename=a;this.blob=c}}Object(w.a)(KL,"UploadBlobParameters",
null,[]);class LL extends am{constructor(a,c,h,v,B,X,ma,Pa=null){super(a,c,h,null,B,X,!1);this.Nkj="DragAndDrop";this.mig="FileName";this.pig=0;this.hKg=null;this.K7d=this.mXb=!1;this.rgg=v;this.GAg=Pa}get M0(){return this.Nkj}get fileExtension(){return this.mig}get fileSize(){return this.pig}get KWi(){return this.hKg}tXc(a){const c=new KL(this.rgg.name,this.rgg);a.YLi(c);this.hKg=a.A7a}xIa(a,c){this.GAg&&this.GAg();super.xIa(a,c)}hUn(a){const c=!!a&&this.Eta(a.name,null)&&this.M1f(a,null);a&&(this.mig=
a.name,this.pig=a.size);c||this.gNd();return c}}Object(w.a)(LL,"DragDropInsertImageUploader",am,[]);class At{constructor(a,c,h,v,B){this.iOd=this.jOd=this.DOd=this.EOd=0;this.ga=null;this.Og=a;this.vl=c;this.hd=h;this.ji=v;this.ya=B;this.ulc=l.AFrameworkApplication.K.$("SupportImageDragDropExternalIsEnabled")}get Kd(){return vg.PageReader.instance}get qia(){return this.vl.instance}get Eb(){return this.ga}BBl(){this.EOd=Be.a.ym(1,0);this.DOd=Be.a.ym(1,1);this.jOd=Be.a.ym(1920,0);this.iOd=Be.a.ym(1280,
1)}eb(a){this.ga=a;const c=Object(m.a)(this,this.cBm,"pictureToolsTabViewHandler"),h=Object(m.a)(this,this.MDl,"insertPictureDialogView"),v=Object(m.a)(this,this.gzb,"insertPicture"),B=Object(m.a)(this,this.col,"growShrinkImage");a.Aa(zb.a.DO,ic.a.view,h,1284);a.ka(zb.a.gzb,ic.a.Ub,v);a.ka(zb.a.gzb,ic.a.image,v);a.Qb(zb.a.gzb,1284);a.Aa(zb.a.Iod,ic.a.view,h,1284);a.Aa(zb.a.ZOe,ic.a.view,c,1028);this.Jp(a,zb.a.mEd,B);this.Jp(a,zb.a.UTf,B);this.Jp(a,zb.a.j8b,Object(m.a)(this,this.j8b,"queryImageResize"));
this.Jp(a,zb.a.iEb,Object(m.a)(this,this.iEb,"queryImageAbsoluteHeight"));this.Jp(a,zb.a.jEb,Object(m.a)(this,this.jEb,"queryImageAbsoluteWidth"));this.Jp(a,zb.a.SZa,Object(m.a)(this,this.SZa,"queryImageAltTextTitle"));this.Jp(a,zb.a.RZa,Object(m.a)(this,this.RZa,"queryImageAltTextDescription"));this.Jp(a,zb.a.d1b,Object(m.a)(this,this.d1b,"imageResize"));this.Jp(a,zb.a.h0d,Object(m.a)(this,this.hza,"imageAbsoluteHeight"));this.Jp(a,zb.a.i0d,Object(m.a)(this,this.iza,"imageAbsoluteWidth"));this.Jp(a,
zb.a.jVc,Object(m.a)(this,this.Pbb,"imageAltTextTitle"));this.Jp(a,zb.a.WFb,Object(m.a)(this,this.BX,"imageAltTextDescription"));this.Jp(a,zb.a.lEb,Object(m.a)(this,this.lEb,"queryImageLockAspectRatio"));this.Jp(a,zb.a.WU,Object(m.a)(this,this.WU,"imageLockAspectRatio"));this.Jp(a,zb.a.iZe,Object(m.a)(this,this.iZe,"downloadImage"));this.ulc&&a.Aa(zb.a.Wfh,ic.a.view,Object(m.a)(this,this.Cyk,"dropLocalImagesContent"),4);a.Qb(zb.a.mEd,4);a.Qb(zb.a.UTf,4);a.Qb(zb.a.j8b,69);a.Qb(zb.a.iEb,69);a.Qb(zb.a.jEb,
69);a.Qb(zb.a.lEb,69);a.Qb(zb.a.SZa,69);a.Qb(zb.a.RZa,69);a.Qb(zb.a.WU,4);a.Qb(zb.a.d1b,4);a.Qb(zb.a.h0d,4);a.Qb(zb.a.i0d,4);a.Qb(zb.a.jVc,4);a.Qb(zb.a.WFb,4);this.BBl()}Jp(a,c,h){a.ka(c,ic.a.image,h);a.ka(c,ic.a.gwb,h);a.ka(c,ic.a.xc,h);a.ka(c,ic.a.anchoredObject,h)}iZe(a,c,h){if(Eb.App.Htd)return 8;a=c.node;return 1===h?a?32:2:2===h?(h=dd.ImageReader.Jk(c),c=dd.ImageReader.lEc(h,c.node.Eh().Lc,l.AFrameworkApplication.K,l.AFrameworkApplication.na.BJa),Wv(c),32):2}MDl(a,c,h){const v=this.Og.tha(c);
if(2===h&&v){if(zb.a.DO===a||zb.a.Iod===a)l.AFrameworkApplication.yra?l.AFrameworkApplication.GTf():this.Kkk(c);return 32}return 1!==h||zb.a.DO!==a&&zb.a.Iod!==a?2:v?32:2}Kkk(a){new am(a,ag.a.instance,l.AFrameworkApplication.K,null,this.ji,this.ga)}gzb(a,c,h,v,B){return this.Og.tha(c)?1===h?32:this.Og.Agf(c,B)?32:2:2}pUn(a){return this.Kd.D0?(At.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.compatMode}),!1):this.ga&&3!==this.ga.mode?(At.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.OFk}),!1):At.Sf.Kba(a)?(At.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.dC}),
!1):this.qia&&this.qia.JR(a)?(At.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.externalSelection}),!1):!0}xMl(a){const c=dd.ImageReader.Jk(a);return c&&5===dd.ImageReader.hm(c)&&this.KRh(a,c)}KRh(a,c){(c=!dd.ImageReader.WZb(c)&&!dd.ImageReader.aJd(c))||At.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.l6g});return c&&this.pUn(a)}Pin(){if(this.ya&&this.ya.Ca&&this.ya.Ca.Fa){const a=this.ya.Ca.Fa.sa;a&&this.ya.setSelection(ne.SelectionFactory.vd(a.node,a.cpBegin))}}bDl(a,c){c=new LL(c,ag.a.instance,l.AFrameworkApplication.K,a,this.ji,
this.ga,this.ya,Object(m.a)(this,this.Pin,"setSelectionForUpload"));if(!c.hUn(a))return Fa.Health.instance.recordQosError("PictureDragDropInvalid",["ImageInsertFailed"],!0,!0,!1,!1,null),r.ULS.sendTraceTag(578380439,307,50,"The file is not supported"),!1;new tp.a(document.body,Object(m.a)(c,c.U6b,"onUploadFrameInitialized"),Object(m.a)(c,c.Ata,"uploadResponseReceived"),l.AFrameworkApplication.K,!1,void 0,$l.a(l.AFrameworkApplication.K));return!0}Cyk(a,c,h,v,B){r.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");
if((a=B.DataTransfer)&&a.files&&0<a.files.length){r.ULS.sendTraceTag(578380440,307,50,String.format("{0} files to drop",a.files.length));for(h=0;h<a.files.length;h++)v=a.files[h],0<=F.a.kg(v.type).indexOf("image")&&this.bDl(v,c)&&(v=this.ya.Ca.Fa.sa,this.ya.setSelection(ne.SelectionFactory.vd(v.node,v.cpBegin+1)));this.nDa();return 32}r.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled");return 2}VL(a){return this.xMl(a)}Awa(a){const c=dd.ImageReader.Jk(a);if(!c)return!1;const h=
xa.a.instance.ra("Box4.IFeatureHelper"),v=dd.ImageReader.hm(c);return 5===v||10===v||48===v||11===v||h&&h.isFeatureEnabled(81)&&4===v?this.KRh(a,c):!1}cBm(a,c,h,v,B){if(2===h)return l.AFrameworkApplication.pa.Le(c.lm,a,h,!0,v,B);if(!c.view.Cd)return this.F7b(!1),8;a=c.view;if(!a.Ma)return this.F7b(!1),8;a=At.uf.LN(a.Ma.If);if(1!==a.length)return this.F7b(!1),8;if(this.VL(a[0]))return this.t6l(),this.F7b(!0),32;this.F7b(!1);return 8}col(a,c,h){if(!this.VL(c))return 8;const v=dd.ImageReader.Jk(c),B=
dd.ImageReader.oC(v),X=dd.ImageReader.PD(v);a=a===zb.a.mEd;r.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{["IsGrow"]:a});if(1===h)return this.Kd.D0||dd.ImageReader.IXa(v)?2:a&&B<this.jOd&&X<this.iOd||!a&&B>this.EOd&&X>this.DOd?32:2;h=a?1.1:.9;this.setSize(v,c,B*h,X*h,!0);return 32}setSize(a,c,h,v,B=!1){kg.a.instance.J(4)&&Eb.App.lc.$n&&Eb.App.lc.zp.aF(c.node);const X=dd.ImageReader.GXa(a);let ma=1;h>this.jOd?ma=this.jOd/h:h<this.EOd&&(ma=this.EOd/h);let Pa=1;v>this.iOd?Pa=this.iOd/v:v<
this.DOd&&(Pa=this.DOd/v);if(X||B)ma=Math.min(ma,Pa),Pa=Math.min(ma,Pa);1!==ma&&(h*=ma);1!==Pa&&(v*=Pa);this.LYe(a,c,h,v)}LYe(a,c,h,v){this.Og.mDi(a,c,h,v)}j8b(a,c,h,v,B){if(!this.Awa(c))return 8;a=dd.ImageReader.Jk(c);c=dd.ImageReader.fJa(a);h=dd.ImageReader.eJa(a);if(0>=c||0>=h)return 2;a=dd.ImageReader.oC(a)/c*100;B.setValue(Uc.a.aHc,a);return 32}d1b(a,c,h,v,B){if(!this.Awa(c))return 8;a=dd.ImageReader.Jk(c);if(1===h)return this.Kd.D0||dd.ImageReader.IXa(a)?2:32;r.ULS.sendTraceTag(20459937,322,
50,"Change image scale.");h=B.ia(Uc.a.aHc,-1)/100;v=B.ia(Uc.a.DLh,!1);const X=B.ia(Uc.a.Kef,!0);B=B.ia(Uc.a.Lef,!0);if(0>=h)return At.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.tzb}),2;const ma=dd.ImageReader.fJa(a),Pa=dd.ImageReader.eJa(a),mb=dd.ImageReader.oC(a),Tb=dd.ImageReader.PD(a);if(0>=ma||0>=Pa)return At.Kb.ib(Kf.a.XY,{["Reason"]:Ef.a.tzb}),2;v?(v=X?h*mb:mb,h=B?h*Tb:Tb):(v=X?h*ma:mb,h=B?h*Pa:Tb);this.setSize(a,c,v,h);kg.a.instance.J(4)&&Eb.App.lc.$n&&Eb.App.lc.zp.aF(c.node);this.nDa();return 32}iEb(a,
c,h,v,B){if(!this.VL(c))return 8;a=dd.ImageReader.Jk(c);a=dd.ImageReader.PD(a);if(0>=a)return 2;B.setValue(Uc.a.hza,a);return 32}hza(a,c,h,v,B){if(!this.Awa(c))return 8;a=dd.ImageReader.Jk(c);if(1===h)return this.Kd.D0||dd.ImageReader.IXa(a)?2:32;r.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");h=B.ia(Uc.a.hza,0);B=dd.ImageReader.GXa(a);if(0>=h)return At.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.tzb}),2;v=dd.ImageReader.fJa(a);const X=dd.ImageReader.eJa(a),ma=dd.ImageReader.oC(a);var Pa=dd.ImageReader.PD(a);
Pa=ma/Pa;if(0>=v||0>=X)if(At.Kb.ib(Kf.a.XY,{["Reason"]:Ef.a.tzb}),this.pGi(a))return 2;this.setSize(a,c,B?h*Pa:ma,h);kg.a.instance.J(4)&&Eb.App.lc.$n&&Eb.App.lc.zp.aF(c.node);Eb.App.oa.updateCommandUI();return 32}jEb(a,c,h,v,B){if(!this.VL(c))return 8;a=dd.ImageReader.Jk(c);a=dd.ImageReader.oC(a);if(0>=a)return 2;B.setValue(Uc.a.iza,a);return 32}iza(a,c,h,v,B){if(!this.Awa(c))return 8;a=dd.ImageReader.Jk(c);if(1===h)return this.Kd.D0||dd.ImageReader.IXa(a)?2:32;r.ULS.sendTraceTag(20459939,322,50,
"Change image absolute width.");h=B.ia(Uc.a.iza,0);B=dd.ImageReader.GXa(a);if(0>=h)return At.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.tzb}),2;v=dd.ImageReader.fJa(a);const X=dd.ImageReader.eJa(a);var ma=dd.ImageReader.oC(a);const Pa=dd.ImageReader.PD(a);ma=Pa/ma;if(0>=v||0>=X)if(At.Kb.ib(Kf.a.XY,{["Reason"]:Ef.a.tzb}),this.pGi(a))return 2;this.setSize(a,c,h,B?h*ma:Pa);kg.a.instance.J(4)&&Eb.App.lc.$n&&Eb.App.lc.zp.aF(c.node);Eb.App.oa.updateCommandUI();return 32}lEb(a,c,h,v,B){if(!this.VL(c))return 8;a=dd.ImageReader.Jk(c);
a=dd.ImageReader.GXa(a);B.setValue(Uc.a.WU,a);return 32}WU(a,c,h,v,B){if(!this.VL(c))return 8;a=dd.ImageReader.Jk(c);if(1===h&&this.Kd.D0)return 2;kg.a.instance.J(4)&&Eb.App.lc.$n&&Eb.App.lc.zp.aF(c.node);B&&(c=B.ia(Uc.a.WU,!0),r.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this.Og.GBi(a,c),Eb.App.oa.updateCommandUI());return 32}SZa(a,c,h,v,B){if(!this.VL(c))return 8;a=dd.ImageReader.Jk(c);a=dd.ImageReader.Z3(a);B.setValue(Uc.a.Pbb,a);return 32}Pbb(a,c,h,v,B){if(!this.VL(c))return 8;
if(1===h)return this.Kd.D0?2:32;if(kg.a.instance.J(4)&&Eb.App.lc.$n&&(a=c.node.ia(ii.a.JI,Vm.a.vp),a!==Vm.a.vp&&(a=Eb.App.lc.zp.Pab(a),oH.CoauthLockEditor.getInstance().d0a(a))))return At.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.dC}),2;a=dd.ImageReader.Jk(c);B=B.ia(Uc.a.Pbb,null);this.Og.ffn(a,c,B);r.ULS.sendTraceTag(21297027,322,50,"Change image alt text.");this.hd.Xq(13);return 32}RZa(a,c,h,v,B){if(!this.VL(c))return 8;a=dd.ImageReader.Jk(c);a=dd.ImageReader.PVa(a);B.setValue(Uc.a.BX,a);return 32}BX(a,c,
h,v,B){if(!this.VL(c))return 8;if(1===h)return this.Kd.D0?2:32;if(kg.a.instance.J(4)&&Eb.App.lc.$n&&(a=c.node.ia(ii.a.JI,Vm.a.vp),a!==Vm.a.vp&&(a=Eb.App.lc.zp.Pab(a),oH.CoauthLockEditor.getInstance().d0a(a))))return At.Kb.ib(Kf.a.Nl,{["Reason"]:Ef.a.dC}),2;a=dd.ImageReader.Jk(c);B=B.ia(Uc.a.BX,null);this.Og.efn(a,c,B);r.ULS.sendTraceTag(21297029,322,50,"Change image alt text description.");this.hd.Xq(13);return 32}t6l(){r.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")}nDa(){l.AFrameworkApplication.K&&
l.AFrameworkApplication.K.$("WordEditorInsertImagesFloodgateIsEnabled")&&window.setTimeout(()=>{const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");a&&a.execute(c=>{c.logActivity("WordInsertImageApplied","WordEditorInsertImagesFloodgateIsEnabled")})},5E3)}pGi(a){const c=dd.ImageReader.fJa(a);a=dd.ImageReader.eJa(a);return 0>=c||0>=a}F7b(){}static get uf(){return Nm.ContextSetEditor.instance}static get Sf(){return li.a.instance}static get Kb(){return Ee.a.instance}}Object(w.a)(At,"ImageActor",
null,[]);var ML=b(498),pH=b(1011),qH=b(1012),JF=b(635),kQ=b(448);class Br extends At{constructor(a,c,h,v,B,X,ma,Pa,mb){super(a,c,v,X,Pa);this.Ytg=!1;this.t6a=this.P6=null;this.roe=this.Gob=!1;this.JH=a;this.Wpc=h;this.rfd=B;this.Na=ma;this.xg=mb}get recentColors(){return this.t6a||(this.t6a=xa.a.instance.ra("Box4.UI.RecentColorsSectionHandler"))}get an(){this.P6||(this.P6=new ML.a);return this.P6}eb(a){super.eb(a);this.Jp(a,zb.a.Du,Object(m.a)(this,this.Du,"setPictureStyle"));a.Qb(zb.a.Du,4);this.Jp(a,
zb.a.XYd,Object(m.a)(this,this.XYd,"resetPicture"));this.Jp(a,ba.a.wrapText,Object(m.a)(this,this.l0b,"handleWrapTextAction"));a.Qb(ba.a.wrapText,4);this.Jp(a,ba.a.L8d,Object(m.a)(this,this.l0b,"handleWrapTextAction"));this.Jp(a,ba.a.M8d,Object(m.a)(this,this.l0b,"handleWrapTextAction"));this.Jp(a,ba.a.N8d,Object(m.a)(this,this.l0b,"handleWrapTextAction"));this.Jp(a,ba.a.O8d,Object(m.a)(this,this.l0b,"handleWrapTextAction"));this.Jp(a,ba.a.P8d,Object(m.a)(this,this.l0b,"handleWrapTextAction"));this.Jp(a,
ba.a.z8b,Object(m.a)(this,this.z8b,"queryWrapTextProperties"));a.Qb(ba.a.z8b,101);this.Jp(a,ba.a.imageCrop,Object(m.a)(this,this.Fpl,"handleImageCropAction"));a.Qb(ba.a.imageCrop,4);this.Jp(a,ba.a.Yfb,Object(m.a)(this,this.Yfb,"queryImageCrop"));a.Qb(ba.a.Yfb,101);this.Jp(a,ba.a.wLh,Object(m.a)(this,this.Gpl,"handleImageCropApplyAction"));this.Jp(a,ba.a.UGc,Object(m.a)(this,this.tEd,"handleImageCropFromSpinners"));this.Jp(a,ba.a.NGc,Object(m.a)(this,this.tEd,"handleImageCropFromSpinners"));this.Jp(a,
ba.a.OGc,Object(m.a)(this,this.tEd,"handleImageCropFromSpinners"));this.Jp(a,ba.a.PGc,Object(m.a)(this,this.tEd,"handleImageCropFromSpinners"));this.Jp(a,ba.a.XQc,Object(m.a)(this,this.i8b,"queryImageCropDimensions"));a.Qb(ba.a.XQc,101);this.Jp(a,ba.a.MVd,Object(m.a)(this,this.i8b,"queryImageCropDimensions"));a.Qb(ba.a.MVd,101);this.Jp(a,ba.a.NVd,Object(m.a)(this,this.i8b,"queryImageCropDimensions"));a.Qb(ba.a.NVd,101);this.Jp(a,ba.a.OVd,Object(m.a)(this,this.i8b,"queryImageCropDimensions"));a.Qb(ba.a.OVd,
101);this.Jp(a,zb.a.imageRotate,Object(m.a)(this,this.Jpl,"handleImageRotateAction"));a.Qb(zb.a.imageRotate,4);this.Jp(a,zb.a.kEb,Object(m.a)(this,this.kEb,"queryImageAngle"));a.Qb(zb.a.kEb,101);this.Jp(a,zb.a.eQc,Object(m.a)(this,this.eQc,"populatePictureBorderColor"));a.Qb(zb.a.eQc,4);this.Jp(a,zb.a.s5,Object(m.a)(this,this.s5,"setPictureBorderColor"));a.Qb(zb.a.s5,4);this.Jp(a,zb.a.rVc,Object(m.a)(this,this.s5,"setPictureBorderColor"));a.Qb(zb.a.rVc,4);this.Jp(a,zb.a.tBf,Object(m.a)(this,this.Ida,
"openMoreColorsDialog"));a.Qb(zb.a.tBf,4);this.Jp(a,zb.a.tsa,this.tsa.bind(this));a.Qb(zb.a.tsa,4);this.Jp(a,zb.a.yea,Object(m.a)(this,this.yea,"setPictureBorderWeight"));a.Qb(zb.a.yea,4);this.Jp(a,zb.a.nEb,this.nEb.bind(this));a.Qb(zb.a.nEb,4);this.Jp(a,zb.a.X_a,Object(m.a)(this,this.X_a,"setPictureBorderStyle"));a.Qb(zb.a.X_a,4);this.Jp(a,zb.a.Zvf,Object(m.a)(this,this.cYd,"removePictureBorder"));a.Qb(zb.a.Zvf,4)}LYe(a,c,h,v){r.ULS.sendTraceTag(593372313,322,50,"Applying New Image Resize, isCanvas: "+
dd.ImageReader.LHd(a));this.JH.$qa()&&this.JH.wYc(a,c);if(dd.ImageReader.py(a)){a=Ya.a.create();const B=new gf.GraphTransaction(15);B.Oa(c.node);this.rfd.qKm(c,dd.ImageReader.Jk(c),h,v,a);B.tAa(a,1);B.dispose()}else dd.ImageReader.LGb(a)?(new pH.a(a,new qH.a)).Vhn(h,v,Object(m.a)(this,this.Qrm,"onResizeComplete"),c):(super.LYe(a,c,h,v),this.hd.Xq(13))}VL(a){if(!a.Kk)return!1;const c=Object(ha.a)(pm.a,a.node);return c&&xu.k(c)?(At.Kb.ib(jQ.a.Nl,{["Reason"]:jz.a.$L}),!1):super.VL(a)}Neb(){this.xg.W8b(Object(m.a)(this,
this.Neb,"onCommandUiUpdateHandler"));this.Gob=!1;const a=appChrome.selectors.getActiveContextualTabIds();this.roe=!1;"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(a,"Picture")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Picture"))}F7b(a){a?Br.mVh&&!this.Gob&&this.roe?(this.xg.RSa(Object(m.a)(this,this.Neb,"onCommandUiUpdateHandler")),this.Gob=!0,this.C$("SimplifyRibbonContextualCommandsUsageTreatment","EnableAutoContextualTabSwitch")):this.C$("SimplifyRibbonContextualCommandsUsageControl",
"DefaultContextTabBehaviour"):Br.mVh&&(this.roe=!0)}C$(a,c){const h=xa.a.instance.za("Common.ISystemInitiatedFeedback");h&&h.execute(v=>{v.logActivity(a,c)})}Du(a,c,h,v,B){if(!this.VL(c))return 8;if(1===h)return this.Kd.D0?2:32;a=parseInt(B);r.ULS.sendTraceTag(593372312,322,50,"SetPictureStyle: "+a);this.rfd.vKm(c,dd.ImageReader.Jk(c),a);this.eMc(c);this.nDa();return 32}XYd(a,c,h){if(!this.VL(c))return 8;r.ULS.sendTraceTag(593372311,322,50,"Applying Style Reset");a=dd.ImageReader.Jk(c);if(1===h)return this.Kd.D0?
2:32;h=dd.ImageReader.Lab(a);1===h?(h=new gf.GraphTransaction(15),h.Oa(c.node),dd.ImageReader.U1b()?a.setValue(Yb.a.Gfb,""):this.JH.YVm(a),h.dispose(),this.Wpc.create(a,c).Du(Ig.a.uui),this.eMc(c)):2===h&&this.Wpc.create(a,c).Du(Ig.a.uui);return 32}Fpl(a,c,h,v,B){if(!this.VL(c))return 8;a=dd.ImageReader.Jk(c);if(1===h)return this.Kd.D0||dd.ImageReader.D2b(a)?2:32;B&&(this.JH.wYc(a,c),r.ULS.sendTraceTag(22381021,322,50,"Toggled Image Crop Mode"),Eb.App.oa.updateCommandUI());this.nDa();return 32}Gpl(a,
c,h,v,B){if(!this.VL(c))return 8;if(1===h)return this.Kd.D0?2:32;a=dd.ImageReader.Jk(c);if(B){h=dd.ImageReader.LHd(dd.ImageReader.Jk(c));r.ULS.sendTraceTag(22381022,322,50,"Applying New Image Cropping, isCanvas: "+h);v=B.ia(Uc.a.Ubb,0);const X=B.ia(Uc.a.Rbb,0),ma=B.ia(Uc.a.Sbb,0);B=B.ia(Uc.a.Tbb,0);const Pa=dd.ImageReader.Qia(a),mb=dd.ImageReader.Nia(a),Tb=dd.ImageReader.Oia(a),rc=dd.ImageReader.Pia(a);if(v===Pa&&X===mb&&ma===Tb&&B===rc)return r.ULS.sendTraceTag(23070480,322,50,"Cropping Properties were the same as before, no need to update."),
32;h?(new pH.a(a,new qH.a)).Vcn(v,X,ma,B,Object(m.a)(this,this.Cmm,"onCroppingComplete"),c):this.rfd.kKm(c,dd.ImageReader.Jk(c),v,X,ma,B);this.eMc(c);Eb.App.oa.updateCommandUI()}return 32}tEd(a,c,h,v,B){if(!this.VL(c))return 8;v=dd.ImageReader.Jk(c);if(1===h)return this.Kd.D0||dd.ImageReader.D2b(v)?2:32;if(B){r.ULS.sendTraceTag(22552775,322,50,"Getting New Image Cropping From Spinners on Format Picture Pane");this.JH.$qa()||this.JH.wYc(v,c);switch(a){case ba.a.UGc:a=B.ia(Uc.a.Ubb,-1);h=0;break;case ba.a.NGc:a=
B.ia(Uc.a.Rbb,-1);h=1;break;case ba.a.OGc:a=B.ia(Uc.a.Sbb,-1);h=2;break;case ba.a.PGc:a=B.ia(Uc.a.Tbb,-1);h=3;break;default:return 8}this.JH.yOn(a,h);this.eMc(c);Eb.App.oa.updateCommandUI()}return 32}Yfb(a,c,h,v,B){if(!this.VL(c))return 8;dd.ImageReader.Jk(c);B&&(a=this.JH.$qa(),B.setValue(Uc.a.$qa,a));return 32}i8b(a,c,h,v,B){if(!this.VL(c))return 8;c=dd.ImageReader.Jk(c);if(B){if(this.JH.$qa())({top:ma,bottom:h,left:a,right:c}=this.JH.JXk());else{v=Be.a.Re(dd.ImageReader.oC(c),0);var X=Be.a.Re(dd.ImageReader.PD(c),
1);var ma=Math.max(dd.ImageReader.Qia(c),0);h=Math.max(dd.ImageReader.Nia(c),0);a=Math.max(dd.ImageReader.Oia(c),0);c=Math.max(dd.ImageReader.Pia(c),0);v=1E5*v/(1E5-(a+c));X=1E5*X/(1E5-(ma+h));ma=Math.floor(ma*X/1E5);h=Math.floor(h*X/1E5);a=Math.floor(a*v/1E5);c=Math.floor(c*v/1E5)}B.setValue(Uc.a.Ubb,ma);B.setValue(Uc.a.Rbb,h);B.setValue(Uc.a.Sbb,a);B.setValue(Uc.a.Tbb,c)}return 32}l0b(a,c,h,v,B){if(!this.VL(c))return 8;if(1===h){if(this.Kd.D0||this.Na&&!this.Na.isFeatureEnabled(220))return 2;this.U8l();
return 32}a=dd.ImageReader.Jk(c);this.JH.$qa()&&this.JH.wYc(a,c);a=B.ia(Uc.a.hCa,"");B=B.ia(Uc.a.M1a,0);r.ULS.sendTraceTag(20459970,322,50,"SetWrapTextAction: {0}",{["Type"]:B,["SourceControlId"]:a});switch(B){case 1:this.JH.Ljn(c);break;case 8:this.JH.b1d(c,1,1);break;case 9:this.JH.b1d(c,1,3);break;case 3:this.JH.b1d(c,2,void 0,!0);break;case 4:this.JH.b1d(c,2,void 0,!1)}this.nDa();Eb.App.oa.updateCommandUI();return 32}z8b(a,c,h,v,B){if(!this.VL(c))return 8;a=dd.ImageReader.Jk(c);c=dd.ImageReader.S8(c);
h=dd.ImageReader.Azb(a);v=dd.ImageReader.aFc(a);a=dd.ImageReader.zu(a);return this.iKm(c,h,v,a,B)?32:8}iKm(a,c,h,v,B){return B?(B.WSh=a,B.Azb=c,B.ZHb=h,B.Dr=v,B.M1a=Br.mml(B),!0):!1}Jpl(a,c,h,v,B){if(!this.Awa(c))return 8;v=dd.ImageReader.Jk(c);if(1===h)return ya.SessionStatusManager.instance.gi?8:this.Kd.D0||dd.ImageReader.F2b(v)?2:32;this.JH.$qa()&&this.JH.wYc(v,c);if(B){var X=B.ia(Uc.a.e1b,0);const ma=dd.ImageReader.LHd(v);r.ULS.sendTraceTag(22052889,322,50,"SetImageRotateAction: {0}, isCanvas: {1}",
X,ma);h=dd.ImageReader.a4(v);let Pa=dd.ImageReader.$zd(v),mb=dd.ImageReader.Kab(v);switch(X){case 0:h=B.ia(Uc.a.kK,0);break;case 2:h-=90;h=og.c(h);break;case 1:h+=90;h=og.c(h);break;case 4:Pa=!Pa;break;case 3:mb=!mb;break;case 5:h+=B.ia(Uc.a.kK,0),h=og.c(h)}ma?(new pH.a(v,new qH.a)).kin(h,Pa,mb,Object(m.a)(this,this.esm,"onRotationComplete"),c):X?this.Wpc.create(v,c).xhn(h,Pa,mb):(B=Ya.a.create(),X=new gf.GraphTransaction(15,zb.a.imageRotate),X.Oa(c.node),this.JH.ofn(v,h),this.rfd.rKm(c,dd.ImageReader.Jk(c),
h,B),X.tAa(B,1),X.ql=a,X.dispose());this.nDa();this.eMc(c);Eb.App.oa.updateCommandUI()}return 32}kEb(a,c,h,v,B){if(!this.VL(c))return 8;a=dd.ImageReader.Jk(c);a=dd.ImageReader.a4(a);if(0>a)return 2;B.setValue(Uc.a.kK,a);return 32}eMc(a){kg.a.instance.J(4)&&Eb.App.lc.$n&&Eb.App.lc.zp.aF(a.node)}U8l(){this.Ytg||(r.ULS.sendTraceTag(20459971,322,50,"Wrap Text UI enabled."),this.Ytg=!0)}esm(a,c,h,v){if(a){const B=new gf.GraphTransaction(15,zb.a.imageRotate);B.Oa(v.node);c.setValue(Uc.a.hVb,JSON.stringify(h));
c.setValue(Uc.a.Wt,a);this.JH.l0d(c,h.rotationAngle,h.O0b,h.Bdc);this.swb(c);B.dispose()}}Qrm(a,c,h,v){if(a){const B=new gf.GraphTransaction(15);B.Oa(v.node);c.setValue(Uc.a.hVb,JSON.stringify(h));c.setValue(Uc.a.Wt,a);this.JH.T_d(c,h.D6d,h.nZc);this.swb(c);B.dispose()}}Cmm(a,c,h,v){if(a){const B=new gf.GraphTransaction(15);B.Oa(v.node);c.setValue(Uc.a.hVb,JSON.stringify(h));c.setValue(Uc.a.Wt,a);this.JH.ifn(c,Math.round(h.rxa*JF.a.x9a),Math.round(h.oxa*JF.a.x9a),Math.round(h.pxa*JF.a.x9a),Math.round(h.qxa*
JF.a.x9a));this.swb(c);B.dispose()}}swb(a){const c=kQ.a.instance.vvd(a);this.JH.j0d(a,c[0],c[1],c[2],c[3])}eQc(a,c,h,v,B){if(!this.Awa(c))return 8;if(1===h)return 32;a=c.contextId===ic.a.view?vg.PageReader.instance.aBd(c):jn.PageNavigator.instance.Xs(c.node);if(!a)return 8;h=dd.ImageReader.Jk(c);c=this.an.qAh(Aj.a.tR(c),h);Br.Jhi.c$b=c;c=Br.Jhi.Uxd(a,Eb.App.HVb);if(!c)return 8;B.MenuItems=c;return 32}s5(a,c,h,v,B){if(!this.Awa(c))return 8;if((v=dd.ImageReader.Jk(c))&&dd.ImageReader.py(v))return 2;
if(1===h)return 32;if(2!==h)return 2;if(!B)return r.ULS.sendTraceTag(571287758,322,10,"SetPictureBorderColor: actionData null"),8;h=new gf.GraphTransaction(15);h.Oa(c.node);const X=Br.acc.Twa(c.node,B);this.an.s5(v,B,c,X);this.swb(v);h.dispose();a==zb.a.rVc&&this.recentColors.P7a(B);this.L0c();this.nDa();return 32}Ida(a,c,h){if(!this.Awa(c))return 8;if(1===h)return 32;Eb.App.oa.Ty();Br.W2a=new px.a("PictureBorder",zb.a.rVc);Br.W2a.qWc(0);return 32}yea(a,c,h,v,B){if(!this.Awa(c))return 8;if(1===h)return 32;
if((a=dd.ImageReader.Jk(c))&&dd.ImageReader.py(a))return 2;if(!B)return r.ULS.sendTraceTag(571287759,322,10,"SetPictureBorderWeight: actionData null"),8;h=new gf.GraphTransaction(15);h.Oa(c.node);this.an.yea(a,B,c);this.swb(a);h.dispose();this.L0c();this.nDa();return 32}tsa(a,c,h,v,B){2===h&&(a=dd.ImageReader.Jk(c),this.an.T4i(B,a));return 32}X_a(a,c,h,v,B){if(!this.Awa(c))return 8;if(1===h)return 32;if((a=dd.ImageReader.Jk(c))&&dd.ImageReader.py(a))return 2;if(!B)return r.ULS.sendTraceTag(571287760,
322,10,"SetPictureBorderStyle: actionData null"),8;h=new gf.GraphTransaction(15);h.Oa(c.node);this.an.X_a(a,B,c);this.swb(a);h.dispose();this.L0c();this.nDa();return 32}nEb(a,c,h,v,B){2===h&&(a=dd.ImageReader.Jk(c),this.an.S4i(B,a));return 32}cYd(a,c,h){if(!this.Awa(c))return 8;if(1===h)return 32;a=dd.ImageReader.Jk(c);h=new gf.GraphTransaction(15);h.Oa(c.node);dd.ImageReader.x0b(a)&&(this.an.cYd(a),this.swb(a));h.dispose();this.L0c();this.nDa();return 32}L0c(){l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$("PictureBorderFloodgateSurveyIsEnabled")&&
window.setTimeout(()=>{const a=xa.a.instance.za("Common.ISystemInitiatedFeedback");a&&a.execute(c=>{c.logActivity("PictureBorderApplied","PictureBorderFloodgateSurveyIsEnabled")})},5E3)}static get acc(){return Br.Yhd||(Br.Yhd=Uj.a.instance)}static get mVh(){null==Br.soe&&(Br.soe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAutoContextualTabSwitch",!1):!1);return Br.soe}static get Jhi(){Br.$S||(Br.$S=new Kw.a("PictureBorder"),Br.ZWa(Br.$S));
return Br.$S}static mml(a){if(a.WSh)a=1;else switch(a.ZHb){case 2:a=a.Azb?3:4;break;case 1:a=1===a.Dr?8:3===a.Dr?9:2;break;case 0:a=5;break;case 3:a=6;break;case 4:a=7;break;default:a=0}return a}static ZWa(a){a.gba(3,zb.a.s5);a.gba(4,zb.a.s5);a.gba(5,zb.a.rVc);a.gba(6,zb.a.s5);a.rTb(Xv.a.instance,1)}}Br.$S=null;Br.W2a=null;Br.Yhd=null;Br.soe=null;Object(w.a)(Br,"ImageActor",At,[]);class Am{static get paragraphEditor(){return Am.kh||(Am.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}static get yC(){return Am.uj||
(Am.uj=xa.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get nY(){return Am.paragraphEditor.Zn}static get ji(){return Am.Xi||(Am.Xi=xa.a.instance.resolve("Box4.IUndoManager"))}static eb(){const a=l.AFrameworkApplication.pa;a.ka(zb.a.aEb,ic.a.view,qm.a.Wu);a.ka(zb.a.aEb,ic.a.paragraph,Am.fha);a.Qb(zb.a.aEb,1036);a.ka(zb.a.Vub,ic.a.view,qm.a.Wu);a.ka(zb.a.Vub,ic.a.paragraph,Am.fha);a.Qb(zb.a.Vub,1036);a.ka(zb.a.O9a,ic.a.view,qm.a.Wu);a.ka(zb.a.O9a,ic.a.paragraph,Am.fha);a.Qb(zb.a.O9a,
1036);a.ka(zb.a.S8b,ic.a.view,qm.a.Wu);a.ka(zb.a.S8b,ic.a.paragraph,Am.fha);a.Qb(zb.a.S8b,1036);a.ka(zb.a.GSc,ic.a.view,qm.a.Wu);a.ka(zb.a.GSc,ic.a.paragraph,Am.fha);a.Qb(zb.a.GSc,1036);a.ka(zb.a.WWa,ic.a.view,qm.a.Wu);a.ka(zb.a.WWa,ic.a.paragraph,Am.fha);a.Qb(zb.a.WWa,1036);a.ka(zb.a.Xbb,ic.a.view,qm.a.Wu);a.ka(zb.a.Xbb,ic.a.paragraph,Am.fha);a.Qb(zb.a.Xbb,1036);a.ka(zb.a.VWa,ic.a.view,qm.a.Wu);a.ka(zb.a.VWa,ic.a.paragraph,Am.fha);a.Qb(zb.a.VWa,1036);a.ka(zb.a.n0d,ic.a.view,Am.$2d);a.ka(zb.a.n0d,
ic.a.paragraph,Am.$2d);a.Qb(zb.a.n0d,1028);a.ka(zb.a.bQf,ic.a.view,Am.$2d);a.ka(zb.a.bQf,ic.a.paragraph,Am.$2d);a.Qb(zb.a.bQf,1028);a.ka(zb.a.iGb,ic.a.view,qm.a.Wu);a.ka(zb.a.iGb,ic.a.paragraph,Am.fha);a.Qb(zb.a.iGb,1036);a.ka(zb.a.ihb,ic.a.view,qm.a.Wu);a.ka(zb.a.ihb,ic.a.paragraph,Am.fha);a.Qb(zb.a.ihb,1036);a.ka(zb.a.jGb,ic.a.view,qm.a.Wu);a.ka(zb.a.jGb,ic.a.paragraph,Am.fha);a.Qb(zb.a.jGb,1036);a.ka(zb.a.U2d,ic.a.view,qm.a.Wu);a.Qb(zb.a.U2d,1028);a.ka(zb.a.BVc,ic.a.view,qm.a.Wu);a.ka(zb.a.BVc,
ic.a.paragraph,Am.fha);a.Qb(zb.a.BVc,1036);a.ka(zb.a.CVc,ic.a.view,qm.a.Wu);a.ka(zb.a.CVc,ic.a.paragraph,Am.fha);a.Qb(zb.a.CVc,1036)}static $2d(a,c,h,v,B){2===h&&""===B[pg.a.Text]&&(a=a===zb.a.n0d?zb.a.WWa:zb.a.VWa,c=new gC.a,c.value=0,c.unit=Eb.App.n4?2:1,l.AFrameworkApplication.pa.hb(a,2,c),Eb.App.oa.updateCommandUI());return 32}static fha(a,c,h,v,B){if(!({jw:h}=qm.a.dSf(h,c)).returnValue)return h;c=c.node;switch(a){case zb.a.aEb:Am.nY.aGf(c,!0);break;case zb.a.Vub:Am.nY.aGf(c,!1);break;case zb.a.O9a:Am.nY.O9a(c);
break;case zb.a.S8b:Am.nY.Y9(c,0);break;case zb.a.GSc:Am.nY.Zgb(c,0);break;case zb.a.Xbb:case zb.a.WWa:h=new Kd.GraphIterator;h.set(c);h.La(11);let X=B.value;B=B.unit;a===zb.a.Xbb&&(X=(new Vl.a(B,X)).jt+Am.yC.sI(c).jt,B=1);Am.nY.Xsa(h,B,X);break;case zb.a.VWa:Am.nY.XFb(c,B.unit,B.value);break;case zb.a.iGb:B?(a=(new Vl.a(B.unit,B.value)).jt,Am.nY.Y9(c,a)):Am.yC.Izd(c).jt||Am.nY.Y9(c,zj.OutlineReader.XJ(c));break;case zb.a.ihb:B?(a=(new Vl.a(B.unit,B.value)).jt,Am.nY.Zgb(c,a)):Am.yC.sI(c).jt||Am.nY.Zgb(c,
zj.OutlineReader.XJ(c));break;case zb.a.jGb:Am.nY.Y9(c,0);break;case zb.a.BVc:a=B;a=(new Vl.a(a.unit,a.value)).jt;Am.nY.WQf(c,1,a);break;case zb.a.CVc:a=B,a=(new Vl.a(a.unit,a.value)).jt,Am.nY.WQf(c,2,a)}Am.ji.ZD();v&&vr.a.tib&&(v.dr|=vr.a.uab(c));return 32}}Am.kh=null;Am.uj=null;Am.Xi=null;Object(w.a)(Am,"IndentationActor",null,[]);var NL=b(299),lQ=b(46),KF=b(416),rH=b(1055);class Gq{constructor(a){this.XQa=this.cwa=this.Vnc=null;this.tLg=!1;this._frame=a}Hwn(){if(this.tLg)this.LZh();else{const a=
nb.a.create(l.AFrameworkApplication.K.Ga("WopiBootstrapUrl"));a.MQ((c,h)=>{h.succeeded?(this.tLg=!0,this.LZh()):r.ULS.sendTraceTag(40436806,323,10,"Failed to download word.boot.js")});Sb.a.iR(a)}}LZh(){if(this.Vnc)r.ULS.sendTraceTag(38130908,323,10,"previewPanel: Tried to launch while already running");else{const a=this._frame.$la;this.cwa=document.createElement("div");a.parentNode.insertBefore(this.cwa,a);this.XQa=previewPanel.FactoryGlobal.getWordDocumentPanel(this,{fileName:l.AFrameworkApplication.K.Ga("FileName"),
reactRoot:this.cwa});this.XQa.setWebpackPublicPath(l.AFrameworkApplication.LV);this.XQa.renderDocumentPanel()}}B4k(a){const c={};c.Container=a;c.BootstrapperUrl=l.AFrameworkApplication.K.Ga("WopiBootstrapUrl");c.ApplicationUrl=this._frame.wjb;a={};a.HostName=l.AFrameworkApplication.K.Ga("FileSource");a.HostSessionId=l.AFrameworkApplication.K.Ga("HostSessionId");a.UserId=l.AFrameworkApplication.K.Ga("UserId");a.DocumentClickTime=new Date(this._frame.geb);a.SessionContext="";a.WdParams={};c.SessionInformation=
a;a={};a.FileName=l.AFrameworkApplication.K.Ga("FileName");a.FileGetUrl="";a.ReadOnly=!1;a.BundleInfo={MajorVersion:1,Url:""};c.WopiPrecheckInfo=a;c.ApplicationCustomSettings={WopiFallbackEnabled:!0,appFrameName:"PreviewPanelApplicationFrame",IsCore:!0,InAppDocumentPreview:!0};a={entryPoint:"WordEditorPreviewPanel"};a.userClickTime=this._frame.geb;c.Diagnostics=a;a={};a.WopiSrc=l.AFrameworkApplication.K.Ga("WopiSrc");a.AccessToken=l.AFrameworkApplication.K.Ga("AccessToken");a.AccessTokenTtl=l.AFrameworkApplication.K.Ga("AccessTokenTtl");
c.WopiInfo=a;c.FnOnInitializeSuccess=h=>{Gq.jU=h;this.XQa.setMaxPage(Gq.jU.GetPageCount());this.XQa.setCurrentPage(Gq.jU.GetCurrentPage());this.XQa.setPageControlVisible(!0);Gq.jU.RegisterEventHandler("PageChanged",v=>{this.XQa.setCurrentPage(v.newPage)});Gq.jU.RegisterEventHandler("BrowserEvent",v=>{27===v.keyCode?this.closeViewer():v.button&&1!==v.button||this.cwa.click()});h=this._frame.geb-(new Date).getTime();r.ULS.sendTraceTag(38355488,323,50,"previewPanel: Load finished - {0}",h);this.eb();
nc.FocusManager.instance().NI(Fc.AFrame.IZa,!0);this.buildFocusRegion();this.sBa(nc.FocusManager.instance().fd(Fc.AFrame.IZa));this.cwa.click()};c.FnOnInitializeFailure=(h,v)=>{r.ULS.sendTraceTag(38273185,323,10,"previewPanel: {1}: {0}",h.toString(),v.toString());this.closeViewer()};return c}buildFocusRegion(){const a=nc.FocusManager.instance();var c=a.getRegion(Fc.AFrame.IZa);c=[2,3];const h=a.fd(Fc.AFrame.IZa),v=new He.DOMFocusListing(()=>this.cwa);v.zBa=!0;for(let B of c)v.vn(B);c=a.qha(()=>this.cwa,
h,v);c.rMa();c.mV=!0;c.MTa=!0;v.ov(v.ica)}eb(){l.AFrameworkApplication.pa.ka(Sa.a.$Ud,Kc.a.frame,Object(m.a)(this,this.aVd,"previewPanelTabsHandler"));l.AFrameworkApplication.pa.ka(Sa.a.ZUd,Kc.a.frame,Object(m.a)(this,this.aVd,"previewPanelTabsHandler"))}sBa(a){a.Bp(nc.FocusManager.instance().BN);a.Bp(nc.FocusManager.instance().DN);a.bindAction(nc.FocusManager.instance().BN,Sa.a.$Ud);a.bindAction(nc.FocusManager.instance().DN,Sa.a.ZUd)}aVd(a){if(this.cwa)if(a===Sa.a.$Ud)nc.FocusManager.instance().getRegion(Fc.AFrame.IZa).RYa();
else if(a===Sa.a.ZUd)nc.FocusManager.instance().getRegion(Fc.AFrame.IZa).QYa();else return 2;else return 2;return 32}loadViewer(a){a=this.B4k(a);this.Vnc=Microsoft.Office.Word.Viewer.InitializeWopiPending(a);this.Vnc.Complete(a.WopiInfo)}closeViewer(){nc.FocusManager.instance().gP(Fc.AFrame.IZa);Gq.jU&&(Gq.jU.Dispose(),Gq.jU=null,l.AFrameworkApplication.pa.uy(Sa.a.$Ud,Kc.a.frame,Object(m.a)(this,this.aVd,"previewPanelTabsHandler")),l.AFrameworkApplication.pa.uy(Sa.a.ZUd,Kc.a.frame,Object(m.a)(this,
this.aVd,"previewPanelTabsHandler")));this.Vnc&&(this.cwa.parentNode.removeChild(this.cwa),this.cwa=this.Vnc=null)}printAction(){r.ULS.sendTraceTag(38355489,323,50,"previewPanel: Print Called");l.AFrameworkApplication.pa.processAction(zb.a.print,2)}downloadPdfAction(){r.ULS.sendTraceTag(38355490,323,50,"previewPanel: Download to PDF Called");l.AFrameworkApplication.pa.processAction(ba.a.dAc,2)}downloadCopyAction(){r.ULS.sendTraceTag(38355491,323,50,"previewPanel: Download Copy Called");l.AFrameworkApplication.pa.processAction(Sa.a.downloadACopy,
2)}zoomInAction(){if(Gq.jU){let a=Gq.jU.GetZoomLevel();a+=.2;Gq.jU.SetZoomLevel(a)}}zoomOutAction(){if(Gq.jU){let a=Gq.jU.GetZoomLevel();a-=.2;Gq.jU.SetZoomLevel(a)}}setPage(a){if(Gq.jU){const c=Gq.jU.GetPageCount();1>a?(Gq.jU.SetCurrentPage(1),this.XQa.setCurrentPage(1)):1<=a&&a<=c?Gq.jU.SetCurrentPage(a):(Gq.jU.SetCurrentPage(c),this.XQa.setCurrentPage(c))}}static getInstance(a){Gq.Owe||(Gq.Owe=new Gq(a));return Gq.Owe}}Gq.jU=null;Gq.Owe=null;Object(w.a)(Gq,"PreviewPanelActor",null,[]);class qq{static get oYi(){return qq.UKg||
(qq.UKg=l.AFrameworkApplication.K.Ga("ClassicViewModePreferenceCookieName"))}static eb(a,c){a.Aa(zb.a.AEb,Kc.a.frame,qq.IZi,128);a.ka(zb.a.c4d,Kc.a.frame,qq.IZi);qq.fD=c;a.ka(ba.a.tLc,Kc.a.frame,qq.tLc);a.ka(ba.a.vLc,Kc.a.frame,qq.vLc);a.Aa(ba.a.mRc,Kc.a.frame,qq.mRc,96);a.Aa(ba.a.ARc,Kc.a.frame,qq.ARc,96)}static IZi(a,c,h){if(c.contextId!==Kc.a.frame)return 2;c=S.App.Hk;switch(a){case zb.a.AEb:if(!c.wjb)return 8;if(1===h)return ya.SessionStatusManager.instance.gi?8:32;a=(new Date).getTime();Bm.a.instance.WPm(a);
c.geb=a;l.AFrameworkApplication.K.$("InAppDocumentPreviewIsEnabled")?pu.a.jO(3,!0,qq.nEm,null,c):pu.a.jO(3,!0,qq.d7h,null,c);return 32;case zb.a.c4d:return 32;default:return 2}}static d7h(a){KF.a()?qq.Zkl(a):qq.EMi(a)}static Zkl(a){const c={};c[L.a.Xdf]=qq.oYi;l.AFrameworkApplication.uO().execute(h=>{h.uu(E.a.Ydf);h.pKn(E.a.Ydf);h.pA(E.a.Ydf,v=>{qq.z3j(v,a)});h.Qg(E.a.N2k,c)})}static z3j(a,c){a.Values[L.a.Xdf]===qq.oYi&&("true"===a.Values[L.a.LKh]?qq.EMi(c):(qq.rNn(),qq.Fzn()))}static rNn(){if("View"!==
appChrome.selectors.getModeSwitcherMode()){const a={activeMode:"View"};l.AFrameworkApplication.Mg("RibbonCleanupForUnifiedRead;RibbonCleanupForUnifiedReadcf");l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.RibbonCleanupForUnifiedReadIsEnable",!1)?appChrome.dispatchUpdateAppModeAndTabsAction(a):appChrome.api.dispatch(appChrome.actions.updateModeSwitcher(a))}}static Fzn(){l.AFrameworkApplication.zt=!0;Eb.App.oa.G5(1);Eb.App.oa.Da.Su&&Eb.App.oa.Da.Su.Rh&&Eb.App.oa.Da.Su.Off();
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ClassViewButtonBugFix",!1)&&Eb.App.oa.updateCommandUI();rH.PageView.eQi(l.AFrameworkApplication.K)}static EMi(a){try{const c=new od.a;let h,v;l.AFrameworkApplication.GYi?(h=Eb.App.hostUrl,v=3):(h=a.wjb,v=1);a.geb&&c.add(l.AFrameworkApplication.vsf,a.geb.toString());l.AFrameworkApplication.Zhf&&c.add(l.AFrameworkApplication.CSe,"1");l.AFrameworkApplication.yOe&&c.add(l.AFrameworkApplication.hck,"1");c.add(NL.a.w1f,NL.a.userSessionData);
c.add(l.AFrameworkApplication.dVd,l.AFrameworkApplication.userSessionId);const B=l.AFrameworkApplication.K.Ga(l.AFrameworkApplication.Wea);B&&c.add(l.AFrameworkApplication.kSi,B);r.ULS.sendTraceTag(573095942,324,100,"Navigate to view mode");KF.b(l.AFrameworkApplication.K)?KF.d("view",c,KF.c):(h=Af.a.mOg(h,c),l.AFrameworkApplication.GYi?Ve.a.Ql(h,Ve.a.bma(v),void 0,"AuthenticationLostDuringSession"):Ve.a.openWindow(v,h,!1,void 0,lQ.a.isi))}catch(c){}}static nEm(a){r.ULS.sendTraceTag(38355487,323,50,
"previewPanel: init");(l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("previewPanel"):xa.a.instance.resolve("Common.IDynamicScriptLoaderProvider").$C.loadScript("previewPanel")).catch(()=>{r.ULS.sendTraceTag(38130907,323,10,"previewPanel: Failed to download script");qq.d7h(a)}).then(()=>{Gq.getInstance(a).Hwn()})}static tLc(a,c,h){if(1===h)return 32;qq.fD.OAi(1);Eb.App.oa.updateCommandUI();return 32}static vLc(a,c,h){if(1===h)return 32;qq.fD.OAi(0);Eb.App.oa.updateCommandUI();
return 32}static mRc(a,c,h,v,B){if(1===h)return 32;B[Uf.a.On]=1===qq.fD.XA;return 32}static ARc(a,c,h,v,B){if(1===h)return 32;B[Uf.a.On]=!qq.fD.XA;return 32}}qq.fD=null;qq.UKg=null;Object(w.a)(qq,"MainViewModeActor",null,[]);class OL{constructor(a,c,h){this.ga=a;this.l2=c;this.Kj=h}eb(){this.ga.ka(ba.a.cof,ic.a.view,Object(m.a)(this,this.T$l,"marginsDialogViewHandler"));this.ga.Aa(ba.a.TVd,ic.a.view,ug.a.rY,96);this.ga.Aa(ba.a.QVd,ic.a.view,ug.a.rY,96);this.ga.Aa(ba.a.RVd,ic.a.view,ug.a.rY,96);this.ga.Aa(ba.a.SVd,
ic.a.view,ug.a.rY,96);this.ga.ka(ba.a.bPc,ic.a.view,ug.a.yI);this.ga.ka(ba.a.aPc,ic.a.view,ug.a.yI);this.ga.ka(ba.a.ISd,ic.a.view,ug.a.yI);this.ga.ka(ba.a.JSd,ic.a.view,ug.a.yI)}T$l(a,c,h,v,B){return 1===h?32:(a=this.Kj.Pya(c.lm))?(B=3===B.wF,this.l2.value.y9g(this.hcl(a),this.Wxb(a),B),32):2}hcl(a){const c=new uh.DictionaryPropertySet;c.setValue(Yb.a.marginTop,this.Kj.pqa(a));c.setValue(Yb.a.marginBottom,this.Kj.Dya(a));c.setValue(Yb.a.marginLeft,this.Kj.sM(a));c.setValue(Yb.a.marginRight,this.Kj.tM(a));
return c}Wxb(a){const c=new uh.DictionaryPropertySet;c.setValue(Yb.a.Po,this.Kj.fv(a));c.setValue(Yb.a.lA,this.Kj.$z(a));return c}}Object(w.a)(OL,"MarginsDialogActor",null,[]);class sH{constructor(a){this.ga=a}eb(){this.ga.ka(ba.a.xYc,ic.a.view,Object(m.a)(this,this.xYc,"toggleModernUxExperiment"))}xYc(a,c,h){if(1===h)return 32;a=l.AFrameworkApplication.na;if(!a)return 32;a.Vuc();sH.b7m(a);return 32}static b7m(a){const c=l.AFrameworkApplication.K.Ga("ModernUxExperimentPreferenceCookieName");var h=
l.AFrameworkApplication.K.$("ModernUxExperimentDefaultOffIsEnabled");h=cb.a.Bia(c,!h);cb.a.dNa(c,(!h).toString(),cb.a.fLa);h?r.ULS.sendTraceTag(576075457,340,50,"User is opting out of the modern ux experience"):r.ULS.sendTraceTag(576075458,340,50,"User is opting in to the modern ux experience");re.d(ba.a.xYc,!0,void 0,void 0,void 0,void 0,[Object.assign(new aa.a,{name:"ModernUxExperimentPreference",string:(!h).toString()})]);a.refreshDocument(null)}}Object(w.a)(sH,"ModernUxActor",null,[]);var mQ=
b(930),Zr=b(1533);class PL{constructor(a,c){this.N2d=Of.a.YD(1)/6;this.TH=a;this.Bb=c}get vh(){return iq.a.instance}H6k(a){var c=Eb.App.okf,h=c?1:3,v=l.AFrameworkApplication.numberFormat;let B=Zr.a.qY[a].bob;var X=Zr.a.qY[a].$nb;var ma=Zr.a.qY[a]._marginLeft;a=Zr.a.qY[a].aob;B=c?Of.a.wIb(B):Of.a.uA(B);X=c?Of.a.wIb(X):Of.a.uA(X);ma=c?Of.a.wIb(ma):Of.a.uA(ma);a=c?Of.a.wIb(a):Of.a.uA(a);c=F.a.pya(B,h,v);X=F.a.pya(X,h,v);ma=F.a.pya(ma,h,v);h=F.a.pya(a,h,v);v={};v.top=c;v.bottom=X;v.left=ma;v.right=h;
return v}R$l(a){const c=WordRibbonStrings.PageMarginsTop,h=WordRibbonStrings.PageMarginsBottom,v=WordRibbonStrings.PageMarginsLeft,B=WordRibbonStrings.PageMarginsRight;a=this.H6k(a);return[[c,a.top,h,a.bottom],[v,a.left,B,a.right]]}tPc(a){var c=Eb.App.okf,h=c?1:3;const v=l.AFrameworkApplication.numberFormat;let B=Zr.a.Hka[a].Ina;a=Zr.a.Hka[a].DFa;B=c?Of.a.wIb(B):Of.a.uA(B);a=c?Of.a.wIb(a):Of.a.uA(a);c=F.a.pya(a,h,v);h=F.a.pya(B,h,v);return String.format(WoncaIntl.WoncaStrings.L_PageSizeDescription,
c,h)}eb(){const a=l.AFrameworkApplication.pa;a.Aa(zb.a.$Fb,ic.a.view,Object(m.a)(this,this.Dhn,"setPredefinedMarginsView"),4);a.Aa(zb.a.ZMa,ic.a.view,Object(m.a)(this,this.Ehn,"setPredefinedPageSizeView"),4);a.Aa(zb.a.setOrientation,ic.a.view,Object(m.a)(this,this.Zgn,"setOrientationView"),4);a.Aa(zb.a.nBa,ic.a.view,Object(m.a)(this,this.nBa,"querySectionProperties"),96);a.ka(zb.a.V_a,ic.a.view,Object(m.a)(this,this.A0d,"setMarginView"));a.ka(zb.a.T_a,ic.a.view,Object(m.a)(this,this.A0d,"setMarginView"));
a.ka(zb.a.wea,ic.a.view,Object(m.a)(this,this.A0d,"setMarginView"));a.ka(zb.a.U_a,ic.a.view,Object(m.a)(this,this.A0d,"setMarginView"));a.ka(zb.a.DQf,ic.a.view,Object(m.a)(this,this.CCi,"setPaperSizeView"));a.ka(zb.a.CQf,ic.a.view,Object(m.a)(this,this.CCi,"setPaperSizeView"))}Dhn(a,c,h,v,B){if(1===h)return 32;if(c=this.vh.Pya(c.lm)){if(0<=B&&B<Zr.a.qY.length){h=new gf.GraphTransaction(15);h.Oa(c);h.ql=a;a=Zr.a.qY[B].bob;v=Zr.a.qY[B].$nb;const X=Zr.a.qY[B]._marginLeft;B=Zr.a.qY[B].aob;this.mTd(a,
v,this.vh.$z(c))&&this.mTd(X,B,this.vh.fv(c))?(this.TH.V_a(c,a),this.TH.T_a(c,v),this.TH.wea(c,X),this.TH.U_a(c,B),this.Bb.Xq(11)):this.VBa(WoncaIntl.WoncaStrings.l_MarginSetFailedMessage);h.dispose()}else return 2;return 32}return 2}mTd(a,c,h){return h>=a+c+Eb.App.Jta}Ehn(a,c,h,v,B){if(1===h)return 32;if(c=this.vh.Pya(c.lm)){if(0<=B&&B<Zr.a.Hka.length)h=new gf.GraphTransaction(15),h.Oa(c),h.ql=a,a=(v=this.vh.dJd(c))?Zr.a.Hka[B].Ina:Zr.a.Hka[B].DFa,B=v?Zr.a.Hka[B].DFa:Zr.a.Hka[B].Ina,this.mTd(this.vh.Dya(c),
this.vh.pqa(c),B)&&this.mTd(this.vh.sM(c),this.vh.tM(c),a)?(this.TH.BQf(c,a),this.TH.AQf(c,B),this.Bb.Xq(11)):this.VBa(WoncaIntl.WoncaStrings.l_PaperSizeSetFailedMessage),h.dispose();else return 2;return 32}return 2}Zgn(a,c,h,v,B){if(1===h)return 32;if(c=this.vh.Pya(c.lm)){h=this.vh.dJd(c);v=new gf.GraphTransaction(15);v.Oa(c);v.ql=a;this.TH.VBi(c,B);if(B&&!h||!B&&h){a=this.vh.fv(c);B=this.vh.$z(c);this.TH.BQf(c,B);this.TH.AQf(c,a);a=this.vh.pqa(c);B=this.vh.Dya(c);const X=this.vh.sM(c),ma=this.vh.tM(c);
h?(this.TH.V_a(c,l.AFrameworkApplication.isRtl?X:ma),this.TH.T_a(c,l.AFrameworkApplication.isRtl?ma:X),this.TH.wea(c,l.AFrameworkApplication.isRtl?B:a),this.TH.U_a(c,l.AFrameworkApplication.isRtl?a:B)):(this.TH.V_a(c,l.AFrameworkApplication.isRtl?ma:X),this.TH.T_a(c,l.AFrameworkApplication.isRtl?X:ma),this.TH.wea(c,l.AFrameworkApplication.isRtl?Math.abs(a):B),this.TH.U_a(c,l.AFrameworkApplication.isRtl?B:a));this.Bb.Xq(11)}v.dispose();return 32}return 2}nBa(a,c,h,v,B){return(a=this.vh.Pya(c.lm))?
(B.marginTop=this.vh.pqa(a),B.marginBottom=this.vh.Dya(a),B.marginLeft=this.vh.sM(a),B.marginRight=this.vh.tM(a),B.Po=this.vh.fv(a),B.lA=this.vh.$z(a),B.cra=this.vh.dJd(a),B.RBb=this.G6k(B),B.mDb=this.r$k(B),32):2}G6k(a){let c=5;for(let h=0;h<Zr.a.qY.length;h++)if(Zr.a.qY[h].bob===a.marginTop&&Zr.a.qY[h].$nb===a.marginBottom&&Zr.a.qY[h]._marginLeft===a.marginLeft&&Zr.a.qY[h].aob===a.marginRight){c=h;break}return c}r$k(a){let c=5;a=new mQ.a(Math.min(a.Po,a.lA),Math.max(a.Po,a.lA));for(let h=0;h<Zr.a.Hka.length;h++)if(this.uxm(a,
Zr.a.Hka[h])){c=h;break}return c}uxm(a,c){return uf.a.WPh(a.DFa,Math.max(c.DFa-this.N2d,0),c.DFa+this.N2d)&&uf.a.WPh(a.Ina,Math.max(c.Ina-this.N2d,0),c.Ina+this.N2d)}A0d(a,c,h,v,B){if(1===h)return 32;if(c=this.vh.Pya(c.lm)){h=new gf.GraphTransaction(15);h.Oa(c);switch(a){case zb.a.V_a:this.TH.V_a(c,B);break;case zb.a.T_a:this.TH.T_a(c,B);break;case zb.a.wea:this.TH.wea(c,B);break;case zb.a.U_a:this.TH.U_a(c,B)}this.Bb.Xq(11);h.dispose();return 32}return 2}CCi(a,c,h,v,B){if(1===h)return 32;if(c=this.vh.Pya(c.lm)){h=
new gf.GraphTransaction(15);h.Oa(c);let X=v=0;switch(a){case zb.a.DQf:X=B;this.TH.BQf(c,X);v=this.vh.$z(c);break;case zb.a.CQf:v=B,this.TH.AQf(c,v),X=this.vh.fv(c)}this.TH.VBi(c,v<X);this.Bb.Xq(11);h.dispose();return 32}return 2}VBa(a){if(!Sj.a.MJ){const c=new oe.StandardDialog;c.yc=0;c.vS(CommonUIStrings.l_DefaultDialogTitle,a,null)}}}Object(w.a)(PL,"PageActor",null,[541]);class QL{constructor(a){this.ga=a}get Eb(){return this.ga}z0d(a,c){let h=0;a?1===a?h=zb.a.wea:2===a?h=zb.a.U_a:3===a&&(h=zb.a.T_a):
h=zb.a.V_a;this.Eb.hb(h,2,c)}ZMa(a,c){let h=0;1===a?h=zb.a.CQf:a||(h=zb.a.DQf);this.Eb.hb(h,2,c)}}Object(w.a)(QL,"PageCommands",null,[540]);class RL{constructor(a,c,h){this.ga=a;this.l2=c;this.Kj=h}eb(){this.ga.ka(ba.a.eof,ic.a.view,Object(m.a)(this,this.txm,"pageSizeDialogViewHandler"));this.ga.Aa(ba.a.hWd,ic.a.view,ug.a.rY,96);this.ga.Aa(ba.a.gWd,ic.a.view,ug.a.rY,96);this.ga.ka(ba.a.MSd,ic.a.view,ug.a.yI);this.ga.ka(ba.a.LSd,ic.a.view,ug.a.yI)}txm(a,c,h,v,B){return 1===h?32:(a=this.Kj.Pya(c.lm))?
(B=3===B.wF,this.l2.value.$9g(this.icl(a),this.Wxb(a),B),32):2}icl(a){const c=new uh.DictionaryPropertySet;c.setValue(Yb.a.Po,this.Kj.fv(a));c.setValue(Yb.a.lA,this.Kj.$z(a));return c}Wxb(a){const c=new uh.DictionaryPropertySet;c.setValue(Yb.a.marginTop,Math.abs(this.Kj.pqa(a)));c.setValue(Yb.a.marginBottom,Math.abs(this.Kj.Dya(a)));c.setValue(Yb.a.marginLeft,this.Kj.sM(a));c.setValue(Yb.a.marginRight,this.Kj.tM(a));return c}}Object(w.a)(RL,"PaperSizeDialogActor",null,[]);class pD{constructor(a,c,
h,v,B=xa.a.instance.za("Box4.Settings.SpacingSettings")){this.ga=a;this.l2=c;this.Gx=h;this.BE=v;this.QM=null;B.execute(X=>this.QM=X)}eb(){this.ga.Aa(zb.a.x4b,ic.a.view,Object(m.a)(this,this.fym,"paragraphDialogViewHandler"),1028);this.ga.ka(zb.a.x4b,ic.a.paragraph,Object(m.a)(this,this.eym,"paragraphDialogHandler"));this.ga.Aa(zb.a.qWd,ic.a.view,ug.a.rY,96);this.ga.Aa(zb.a.q8b,ic.a.view,ug.a.rY,96);this.ga.Aa(zb.a.PVd,ic.a.view,ug.a.rY,96);this.ga.Aa(zb.a.jRc,ic.a.view,ug.a.rY,96);this.ga.Aa(zb.a.p0a,
ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.XWc,ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.NSd,ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.Y6b,ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.HSd,ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.b3d,ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.qZa,ic.a.view,ug.a.yI,96)}eym(a,c,h,v,B){if(1===h)return 3===this.ga.mode||2===this.ga.mode?32:8;a=c.node;c=this.kRi(c);B=3===B.wF;this.l2.value.xWb(this.CEc(a),this.Wxb(c),B,this.BE);return 32}fym(a,c,h,v,B){a=c.view.Ma;if(!a||pD.Sf.f2b(a.If))return 8;
if(pD.uf.J$(sd.ParagraphReader.EO,a.If))return pD.Kb.ib(Kf.a.re,{["Reason"]:Ef.a.$L}),8;if(1===h)return 3===this.ga.mode||2===this.ga.mode?32:8;h=a.Ca.Fa;c=this.kRi(c);B=3===B.wF;if(1===h.length&&Gc.SelectionEditor.ke(h.J(0)))return h=h.J(0).node,this.l2.value.xWb(this.CEc(h),this.Wxb(c),B,this.BE),32;a=[];for(v=0;v<h.length;v++){const X=h.J(v);(!v&&Gc.SelectionEditor.mj(X)||sd.ParagraphReader.Wk(X)||Gc.SelectionEditor.tj(X))&&a.push(X.node)}if(!a.length)return 8;h=Array(a.length);for(v=0;v<a.length;v++)h[v]=
this.CEc(a[v]);h=aA.APropertySet.Rwh(h);this.l2.value.xWb(h,this.Wxb(c),B,this.BE);return 32}CEc(a){var c,h,v;const B=new uh.DictionaryPropertySet;B.setValue(Uc.a.Dr,sd.ParagraphReader.zu(a));const X=this.Gx.Fya(a);var ma=X.lineSpacing;B.setValue(Uc.a.WX,ma.unit);B.setValue(Uc.a.Zt,ma.value);ma=X.beforeSpacing;B.setValue(Uc.a.$Aa,ma.unit);B.setValue(Uc.a.aBa,ma.value);ma=X.afterSpacing;B.setValue(Uc.a.YAa,ma.unit);B.setValue(Uc.a.ZAa,ma.value);(null===(c=this.QM)||void 0===c?0:c.ira)&&B.setValue(Uc.a.CPc,
X.RA);(null===(h=this.BE)||void 0===h?0:h.iYa)&&B.setValue(Vq.a.LO,sd.ParagraphReader.LO(a));(null===(v=this.BE)||void 0===v?0:v.yjb)&&B.setValue(Vq.a.kOa,sd.ParagraphReader.Jdc(a));return B}static get Sf(){return li.a.instance}static get uf(){return Nm.ContextSetEditor.instance}static get Kb(){return Ee.a.instance}}Object(w.a)(pD,"AParagraphDialogActor",null,[]);class SL extends pD{constructor(a,c,h,v,B,X){super(a,c,h,X);this.Kj=v;this.uj=B}eb(){super.eb();this.ga.Aa(zb.a.mEb,ic.a.view,ug.a.rY,96);
this.ga.Aa(zb.a.YQc,ic.a.view,ug.a.rY,96);this.ga.Aa(zb.a.o8b,ic.a.view,ug.a.rY,96);this.ga.Aa(zb.a.m1b,ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.aGd,ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.Uac,ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.a3d,ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.tka,ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.rZa,ic.a.view,Object(m.a)(this,this.ZHh,"handleSpecialIndentDialogControl"),96);this.ga.Aa(zb.a.OSd,ic.a.view,Object(m.a)(this,this.ZHh,"handleSpecialIndentDialogControl"),96);this.ga.Aa(zb.a.e3d,
ic.a.view,ug.a.yI,96);this.ga.Aa(zb.a.rWd,ic.a.view,ug.a.rY,96);this.ga.Aa(zb.a.r8b,ic.a.view,ug.a.rY,96)}kRi(a){return this.Kj.Pya(a.lm)}CEc(a){const c=super.CEc(a);var h=this.uj.q0(a);const v=this.uj.sI(a);c.setValue(Uc.a.G9,1);c.setValue(Uc.a.H9,h.jt-v.jt);h=this.uj.G_b(a);c.setValue(Uc.a.hsa,h.unit);c.setValue(Uc.a.isa,h.value);a=this.uj.O_b(a);a.specialIndentType&&(c.setValue(Uc.a.kH,a.specialIndentType),c.setValue(Uc.a.l$,a.unit),c.setValue(Uc.a.IY,a.value));return c}ZHh(a,c,h,v,B){const X=
c.view.Ma,ma=X.Ca.Fa.sa;return 1===h&&X.Ca.Fa.eC&&sd.ParagraphReader.IO(ma.node)&&!ab.ListReader.mq?8:ug.a.yI(a,c,h,v,B)}Wxb(a){const c=new uh.DictionaryPropertySet;c.setValue(Yb.a.Po,this.Kj.fv(a));c.setValue(Yb.a.lA,this.Kj.$z(a));c.setValue(Yb.a.marginTop,Math.abs(this.Kj.pqa(a)));c.setValue(Yb.a.marginBottom,Math.abs(this.Kj.Dya(a)));c.setValue(Yb.a.marginLeft,this.Kj.sM(a));c.setValue(Yb.a.marginRight,this.Kj.tM(a));return c}}Object(w.a)(SL,"ParagraphDialogActor",pD,[]);class TL extends Sys.EventArgs{constructor(a,
c){super();this.node=a;this.Zjf=c}}Object(w.a)(TL,"AfterPasteEventArgs",Sys.EventArgs,[]);class UL{constructor(a){this.emb=this.ane=this.gne=null;this.Vlb=a}get lxd(){return this.emb||(this.emb=xa.a.instance.resolve("WordEditor.ExternalContent.FluidComponentEditor"))}get rJl(){this.gne||(this.gne=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate(Kr.a.Kch,!1));return this.gne}get FIc(){this.ane||(this.ane=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.$(Kr.a.Qch));
return this.ane}yGm(a){if(a&&Ta.OutlineElementReader.Gg(a.$pa)&&Ta.OutlineElementReader.Gg(a.xdb)){this.TGm(a);var c=new Yk.a;for(c.Wb(a.$pa);c&&c.currentNode;){const h=this.oBd(c),v=sd.ParagraphReader.tb(h);v&&sd.ParagraphReader.h9a(h)&&this.wGm(h);const B=c.currentNode.id===a.xdb.currentNode.id;v&&(this.rJl||this.FIc)&&h.Oh.o8(h.type).MWd(new TL(h,B));if(B)break;ie.OutlineElementNavigator.Ir(c,!1,!1)}}}wGm(a){r.ULS.sendTraceTag(590435214,307,50,"ProcessParagraphForExternalContent: Processing the pasted the external content (oEmbed) component via external paste flow.");
const c=a.A7b;a=Oe.a.Sb(a,0);yt.XIc(c)?this.lxd.UTd(a,c):this.Vlb.UTd(a,c)}TGm(a){if(a.$pa.currentNode&&a.xdb.currentNode&&a.$pa.currentNode.id===a.xdb.currentNode.id){const c=this.oBd(a.$pa);sd.ParagraphReader.tb(c)?this.BGm(c,a.Uzm,a.Tzm):r.ULS.sendTraceTag(590955995,307,50,"ProcessSinglePastedHyperlink: No paragraph node pasted.")}}BGm(a,c,h){r.ULS.shipAssertTag(590956771,307,0<=c);r.ULS.shipAssertTag(590958592,307,0<=h);var v=sd.ParagraphReader.text(a);if(""!==v){var B=Oe.a.createTextRange(a,
c,h);B=ch.HyperlinkReader.aB(B,!1);if(1===B.length){const X=B[0];B=v.substring(c,h).trim();v=v.substring(X.cpBegin,X.cpEnd).trim();c=B===v;B=Oe.a.createTextRange(a,X.cpBegin,X.cpEnd);if(X.hyperlink&&c&&!ch.HyperlinkReader.CKa(v))a=X.hyperlink.url;else if(c)a=v;else{r.ULS.sendTraceTag(590958596,307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because the pasted text is not equal to the pasted hyperlink display text");return}yt.XIc(a)?this.lxd.KJa(B,a,!1):this.Vlb.KJa(B,a,!1)}else r.ULS.sendTraceTag(590958597,
307,50,"ProcessPastedHyperlinks: No hyperlink conversion to oEmbed because either no hyperlinks or more than one hyperlink got pasted  Hyperlinks pasted = {0}",B.length)}}oBd(a){const c=ie.OutlineElementNavigator.Fd(a);ie.OutlineElementNavigator.Wc(a);return c}}Object(w.a)(UL,"PastedContentsProcessorPostMergeAfterPaste",null,[539]);class tH extends Bt{constructor(a,c,h,v,B,X,ma,Pa){super(v);this.zze=7;this.Iz=this.Jic=null;this.Kle=0;this.Hle=a;this.Gm=c;this.Fj=h;this.Zc=B;this.J6i=ma;this.oRa=Pa;
this.e_=this.Zc.cLa("UserAction","WordIgnoreAll")}CRf(a){this.Hle.M1h();this.Jic=this.Fj.Lia(a);this.oRa.oLh(this.Jic,null,!1);return this.Hle.LRi(this.Jic)?(this.e_.start(),this.Iz=new gf.GraphTransaction(15),this.Iz.Oa(a.node),!0):!1}iVd(a){this.XDb(a.node);return!0}tQc(a){this.XDb(a);return!0}jVd(a){this.XDb(a.node)}lXf(a){this.Iz.dispose();this.Jic.errorDetails.Iib(a.actionId);this.e_.stop();r.ULS.sendTraceTag(19779652,324,50,String.format("Ignore-all succeeded. Actual ignored errors: {0}. Duration in milliseconds: {1}. Type: {2}",
this.Kle,this.e_.Yg,this.Jic.errorDetails.proofingType));return!0}Tac(a,c){if(super.Tac(a,c))return!0;a=a.role;return 9===a||10===a||13===a||7===a||8===a}bBh(a){if(a&&a.type!==this.zze){const c=Kd.GraphIterator.va(a);return c.La(this.zze)?c.mc(this.zze):a}return a}vMl(a,c){return this.Hle.B1d(c.errorDetails)&&!this.Gm.T8(Oe.a.createTextRange(a,c.begin,c.end))}XDb(a){if(a){var c=this.Fj.l0(a,h=>this.vMl(a,h));this.J6i?this.Fj.mgb(a,c,!0):0<c.length&&(a.lj(4,!0),this.Fj.uCb(a));this.Kle+=c.length}}}
Object(w.a)(tH,"IgnoreAllCallbackSteps",Bt,[]);class VL{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee){this.ga=a;this.Gm=c;this.ya=h;this.yd=v;this.Fj=X;this.gG=ma;this.Zc=Pa;this.whj=mb;this.qcj=Tb;this.cOb=rc.$Jc;this.tQ=rc;this.oRa=Tc;this.Ine=vd;this.z2a=ee}eb(){this.Ine&&(Js.a.hx()?this.ga.Aa(zb.a.ija,ic.a.Ub,this.Swl.bind(this),1028):this.ga.JQ(zb.a.ija,ic.a.view,Object(m.a)(this,this.ija,"ignoreAllSpellingError"),1028));this.cOb&&this.ga.JQ(zb.a.gvb,ic.a.view,Object(m.a)(this,this.gvb,"doNotCheckThisCritiqueType"),
1028);this.ga.Aa(ba.a.hRc,ic.a.view,Object(m.a)(this,this.hRc,"queryLanguage"),96)}hRc(a,c,h,v,B){if(1===h)return 32;a=this.gG.UVa(c.view.Ma.If);if(a=vi.a.af(a))B[Jj.a.LabelText]=a.displayName;return 32}ija(a,c,h,v,B,X){const ma=new tH(this.whj,this.Gm,this.Fj,this.yd,this.Zc,this.tQ,0,this.oRa);return new rt(a,c,h,v,B,X,ma,this.ga,this.ya,this.yd,"IgnoreAllOperation")}gvb(a,c,h,v,B,X){const ma=new tH(this.qcj,this.Gm,this.Fj,this.yd,this.Zc,this.tQ,1,this.oRa);return new rt(a,c,h,v,B,X,ma,this.ga,
this.ya,this.yd,"DoNotCheckThisCritiqueType")}Swl(a,c,h){if(1===h)return 32;r.ULS.sendTraceTag(528023773,324,50,"Ignore All error triggered for AL");this.z2a.ncf(c,null,Fn.b.IgnoreAll);return 32}}Object(w.a)(VL,"ProofingActor",null,[]);var Lz=b(1045),nQ=b(1535);class FA{constructor(a,c,h,v,B,X,ma,Pa,mb){this.lo=this.aGa=this.Xgd=this.Ygd=null;this.xA=this.Vq=this.Xo=0;this.l4a=this.k4a=!1;this.e7=this.mLb=this.lLb=this.kLb=this.nLb=0;this.agd=null;this.U$=this.UT=this.Wo=this.qN=0;this.Sk=null;this.Pmb=
0;this.Og=h;this._image=a;this._context=c;this.e$c=!1;(a=FA.Ag.Xs(c.node))&&a.pg(Yb.a.cmf)&&(this.e$c=!0);this.zkc=v.$("ImageDataURLPresentationIsEnabled");this.Lqj=v.$("WordOartPostRequestIsEnabled");this.qa=v;this.Fp=B;this.Zc=X;this.Bb=ma;this.Xi=Pa;this.Lw=mb;this.SAl();this.aOb=!!v&&v.getBooleanFeatureGate("Microsoft.Office.WordOnline.ImproveApplyStyle",!1)}SAl(){this.lo="";this.Xo=dd.ImageReader.oC(this._image);this.Vq=dd.ImageReader.PD(this._image);this.e7=dd.ImageReader.$ab(this._image);this.xA=
dd.ImageReader.a4(this._image);this.k4a=dd.ImageReader.$zd(this._image);this.l4a=dd.ImageReader.Kab(this._image);this.nLb=Math.max(dd.ImageReader.Qia(this._image),0);this.kLb=Math.max(dd.ImageReader.Nia(this._image),0);this.lLb=Math.max(dd.ImageReader.Oia(this._image),0);this.mLb=Math.max(dd.ImageReader.Pia(this._image),0);this.Sk=Ya.a.nil;this.aGa=null;this.Pmb=dd.ImageReader.hm(this._image)}Ind(a,c){return(new nQ.a(this.Fp,this.Pmb,this.qa,this.Xo,this.Vq,this.xA,this.e7,this.nLb,this.kLb,this.lLb,
this.mLb,this.k4a,this.l4a,this.e$c)).build(this._context.node,this._image,a,c)}resize(a,c){this.lo="Resize";this.o3d();bh.a.mark(this.v_b());this.Xo=a;this.Vq=c;this.Qg(!1,Object(m.a)(this,this.oZa,"onRequestSuccess"))}Du(a){this.lo="Styles";this.o3d();bh.a.mark(this.v_b());this.e7=a;this.Qg(!1,Object(m.a)(this,this.oZa,"onRequestSuccess"))}xhn(a,c,h){this.lo="Rotation";this.o3d();this.xA=a;this.k4a=c;this.l4a=h;this.Qg(!1,Object(m.a)(this,this.oZa,"onRequestSuccess"))}whn(a,c){this.lo="SwordRequestManager";
this.o3d();this.aGa=a;this.xA=c.angle;this.Xo=c.width;this.Vq=c.height;this.e7=c.styleId;this.nLb=c.top;this.kLb=c.bottom;this.lLb=c.left;this.mLb=c.right;this.Sk=c.S_;this.Qg(!1,Object(m.a)(this,this.oZa,"onRequestSuccess"))}Qg(a,c){if(this.qa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")){var h=this.sWb(h);const v=dd.ImageReader.Tia(this._image,this.qa,this.Fp);v?Lz.a.fhb(this._image,v,4):(l.AFrameworkApplication.Mg("picstylefix;picstylefixcf"),this.aOb&&this._image.setValue(ii.a.Gxd,!0));
h.dispose()}this.UKi(a);bh.a.mark(this.v_b());a=new Wa.QueryStringBuilder(this.Ind(a,!0));this.zkc&&a.Hd(dh.a.Vah,"true");this.Lqj?(h=new Wa.QueryStringBuilder("WordOart.ashx"),l.AFrameworkApplication.fe.ai(h.toString(),2,a.toString(),{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},!0,0,c,Object(m.a)(this,this.jAf,"onRequestFail"),null)):l.AFrameworkApplication.fe.ai(a.toString(),1,"",null,!0,0,c,Object(m.a)(this,this.jAf,"onRequestFail"),null)}sWb(a){a=this.Sk&&this.Sk!==Ya.a.nil?
new gf.GraphTransaction(7,zb.a.imageRotate):new gf.GraphTransaction(15);a.Oa(this._context.node);return a}get J1i(){const a=new gf.GraphTransaction(3);a.Oa(this._context.node);return a}TTc(){this.HAc();this.Qud();const a=this.J1i;var c=dd.ImageReader.qya(this._image,this._context.node.Mb,this.qa,this.Fp);this.aOb&&this._image.setValue(ii.a.Gxd,!1);this._image.setValue(Uc.a.VGc,c);this._image.setValue(Uc.a.kK,-1);c=dd.ImageReader.Tia(this._image,this.qa,this.Fp);this.qa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&
(this._image.removeProperty(Uc.a.oUd),this._image.removeProperty(Uc.a.nUd),c&&Lz.a.fhb(this._image,c,3));a.dispose();FA.fo();this.aGa&&this.aGa()}jAf(a){if(5===this.Pmb){const c=Object.assign(new fi.a,{extendedProperties:new Map});c.extendedProperties.set("status",a.data.status.toString());c.extendedProperties.set("httpStatus",a.data.we.toString());Fa.Health.instance.recordQosError("PictureSwordRequestFailed",["ImageEditFailed"],!1,!0,!1,!1,c)}r.ULS.sendTraceTag(25182720,322,15,"Request failed: {0}. PlaceholderKind: {1}",
{["Status"]:a.data.status,["HttpStatus"]:a.data.we,["Id"]:a.data.id,["ResponseData"]:a.data.qd},oD.a[this.Pmb]);this.TTc()}UKi(a){this.Zc&&(a=String.format("Send Single {0} SWORD Request.",a?"PNG":"XML"),this.Ygd=this.Zc.Pe("WebServiceCall",a))}HAc(){this.Ygd&&(this.Ygd.stop(),this.Ygd=null)}o3d(){if(this.Zc){const a=String.format("Send SWORD {0} Request. PlaceholderKind: {1}",this.lo,oD.a[this.Pmb]);this.Xgd=this.Zc.Pe("WebServiceCall",a)}}Qud(){this.Xgd&&(this.Xgd.stop(),this.Xgd=null)}static get Ag(){return jn.PageNavigator.instance}static fo(){const a=
new oe.StandardDialog;a.yc=0;a.Fw(Qk.a.aBm,Box4Intl.Box4Strings.l_PictureStyleErrorTitle,Box4Intl.Box4Strings.l_PictureStyleError,null);Eb.App.oa&&Eb.App.oa.updateCommandUI()}}Object(w.a)(FA,"RenderedImageEditOperation",null,[552]);var LF=b(491);class XL extends FA{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){super(a,c,h,v,B,X,ma,Pa,mb);this.bnj=Tb}Qg(a,c){this.UKi(a);bh.a.mark(this.v_b());const h=new Wa.QueryStringBuilder("WordOart.ashx");a=new LF.a(h.toString(),2,this.ibb(a,!0,0),null,!0,2,null,null,null,
null,null,null,null,null,null,null,null,null,["Content-Type"],null,a?"blob":"text");l.AFrameworkApplication.fe.send(a).uBa(c,v=>{this.jAf(v)})}oZa(a){try{const c=JSON.parse(a.data.GBa);this.vgj=c[dh.a.yFc];this.$zj=c[dh.a.width];this.Ngj=c[dh.a.height];this.z9f=c[dh.a.ouc];this.uic=Array(4);this.uic[0]=c[dh.a.e$a];this.uic[1]=c[dh.a.f$a];this.uic[2]=c[dh.a.g$a];this.uic[3]=c[dh.a.d$a];this.bnj?this.Qg(!0,h=>{this.FOc(h)}):(this.adc(),this.mmh())}catch(c){r.ULS.sendTraceTag(526528851,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
c.message,this.lo,dd.ImageReader.hm(this._image)),this.TTc()}}FOc(a){2!==a.data.status||dd.ImageReader.bV(a.data.qd)||this.Njb(a).then(c=>{this.Gmg=c;a.data.request&&(this.Hmg=Lz.a.sYb("POST"===a.data.request.get_httpVerb()?a.data.request.get_body():a.data.request.get_url()));this.ame=this.ibb(!0,!1,this.xA);this.adc();this.mmh()}).catch(c=>{r.ULS.sendTraceTag(526528852,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",c,this.lo,dd.ImageReader.hm(this._image));
this.TTc()})}adc(){let a;a=this.sWb(a);this._image.setValue(Vq.a.bja,this.vgj);this.z9f&&this._image.setValue(Vq.a.Qld,this.z9f);this._image.setValue(Vq.a.obb,this.$zj);this._image.setValue(Vq.a.pbb,this.Ngj);this._image.setValue(Vq.a.pJa,this.uic);this.Gmg&&this._image.setValue(Uc.a.Wt,this.Gmg);this.Hmg&&this._image.setValue(Uc.a.a1b,this.Hmg);this.ame&&(Lz.a.fhb(this._image,this.ame,3),this._image.setValue(Yb.a.b$a,this.ame));this.Q5j();a.dispose()}Q5j(){this._image.removeProperty(Uc.a.kK);this._image.removeProperty(Uc.a.oUd);
this._image.removeProperty(Uc.a.nUd)}mmh(){this.Lw.TBa(this._context);if(this.Sk&&this.Sk!==Ya.a.nil){const a=this._context.node.Eh(),c=new N.a(this.Sk,1);this.Xi.OVb(a,c)}this.Bb.Xq(13);this.HAc();this.Qud();bh.a.mark(this.u_b());this.aGa&&this.aGa()}ibb(a,c,h){a=new Wa.QueryStringBuilder(this.Ind(a,c));a.Hd(dh.a.Sef,"true");a.Hd(dh.a.Pvm,h.toString());return a.toString()}Njb(a){return new Promise((c,h)=>{if(dd.ImageReader.Mza())try{const v=new Blob([a.data.GBa],{type:a.data.oj["Content-Type"]}),
B=new FileReader;B.addEventListener("loadend",()=>{c(B.result)},!1);B.readAsDataURL(v)}catch(v){r.ULS.sendTraceTag(526528853,322,10,"GetImageDataURLFromRequestSucceededEventArgs exception in dataUrl conversion: {0}",v),h()}else c(a.data.qd)})}v_b(){return 51511}u_b(){return 51512}}Object(w.a)(XL,"RenderedGraphicEditOperation",FA,[]);class YL extends FA{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){super(a,c,h,v,B,X,ma,Pa,mb);this.Ehg=null;this.bye=Tb}v_b(){return 51511}u_b(){return 51512}oZa(a){try{var c=
JSON.parse(a.data.qd);const B=Sys.Net.XMLDOM("string"===typeof c[dh.a.BRg]?c[dh.a.BRg]:null);this.agd="string"===typeof c[dh.a.Sld]?c[dh.a.Sld]:null;const X=xa.a.instance.ra("Box4.IFeatureHelper");X&&X.isFeatureEnabled(81)&&(this.Ehg="string"===typeof c[dh.a.rYb]?c[dh.a.rYb]:null);H.a.Gi&&B.setProperty("SelectionNamespaces","xmlns:mc='"+Ig.a.QLj+"'");const ma=B.selectSingleNode("/mc:AlternateContent");if(!ma)throw oo.a.argument("Alternate content element could not be retrieved!");const Pa=ma.firstChild;
if(!Pa)throw oo.a.argument("Alternate content choice element could not be retrieved!");const mb=Pa.firstChild;if(!mb)throw oo.a.argument("Drawing element could not be retrieved!");var h=mb.firstChild;if(!h)throw oo.a.argument("Inline element could not be retrieved!");c=a=null;const Tb=RegExp("effectExtent"),rc=RegExp("extent");for(let vd of h.childNodes)-1!==vd.nodeName.search(Tb)&&(a=vd),-1!==vd.nodeName.search(rc)&&(c=vd);if(!a||!c)throw oo.a.argument("Effect extent or extent could not be retrieved!");
this.qN=parseInt(a.selectSingleNode("@l").text);this.UT=parseInt(a.selectSingleNode("@r").text);this.Wo=parseInt(a.selectSingleNode("@t").text);this.U$=parseInt(a.selectSingleNode("@b").text);const Tc=og.c(this.xA);if(45<=Tc&&135>=Tc||225<=Tc&&315>=Tc){const vd=parseInt(c.selectSingleNode("@cx").text);var v=parseInt(c.selectSingleNode("@cy").text);h=vd/2;v/=2;this.qN-=h-v;this.UT+=h-v;this.Wo-=v-h;this.U$+=v-h}}catch(B){r.ULS.sendTraceTag(42079129,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",
B.message,this.lo,oD.a[this.bye]);this.TTc();return}this.Qg(!0,Object(m.a)(this,this.FOc,"onImageSuccess"))}FOc(a){const c=this.Ind(!0,!1);let h;h=this.sWb(h);this._image.setValue(Yb.a.Rld,this.agd);var v=xa.a.instance.ra("Box4.IFeatureHelper");v&&v.isFeatureEnabled(81)&&this._image.setValue(Yb.a.Vvd,this.Ehg);this.qa.$("WordEditorImageRotateIsEnabled")&&this.qa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Og.l0d(this._image,this.xA,this.k4a,this.l4a);const B=dd.ImageReader.Tia(this._image,
this.qa,this.Fp),X=()=>{B&&Lz.a.fhb(this._image,B,3);Lz.a.fhb(this._image,c,3);this.Og.j0d(this._image,Of.a.EG(this.qN),Of.a.EG(this.UT),Of.a.EG(this.Wo),Of.a.EG(this.U$));this._image.setValue(Yb.a.b$a,c);dd.ImageReader.py(this._image)||this._image.setValue(Yb.a.jza,1);this.Og.T_d(this._image,this.Xo,this.Vq);this.qa.$("WordEditorImageRotateIsEnabled")&&!this.qa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Og.l0d(this._image,this.xA,this.k4a,this.l4a);2===a.data.status&&dd.ImageReader.bV(a.data.qd)&&
(this._image.setValue(Uc.a.Wt,a.data.qd),a.data.request&&this._image.setValue(Uc.a.a1b,Lz.a.sYb("POST"===a.data.request.get_httpVerb()?a.data.request.get_body():a.data.request.get_url())));this.aGa&&this.aGa();this.Lw.TBa(this._context);if(this.Sk&&this.Sk!==Ya.a.nil){const ma=this._context.node.Eh(),Pa=new N.a(this.Sk,1);this.Xi.OVb(ma,Pa)}this.Bb.Xq(13);this.HAc();this.Qud();bh.a.mark(this.u_b())};if(this.qa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Sk&&this.Sk!==Ya.a.nil&&(v=this._context.node.Eh())&&
v.contentReplicator){h.dispose();v.contentReplicator.forceOutbound(()=>{let ma;ma=this.sWb(ma);X();ma.dispose()},null,null);return}X();h.dispose()}}Object(w.a)(YL,"RenderedDrawingEditOperation",FA,[]);class ZL extends FA{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){super(a,c,h,v,B,X,ma,Pa,mb);this.P6=null;this.bye=Tb;this.Na=rc}v_b(){return 7988}u_b(){return 7989}get an(){this.P6||(this.P6=new ML.a);return this.P6}oZa(a){try{const c=a.data.T9;this.agd=a.data.qd;H.a.Gi&&c.setProperty("SelectionNamespaces",
"xmlns:pic='"+Ig.a.ZAm+"'");const h=c.selectSingleNode("/pic:wordEdit/pic:spPr").nextSibling;this.qN=parseInt(h.selectSingleNode("@l").text);this.UT=parseInt(h.selectSingleNode("@r").text);this.Wo=parseInt(h.selectSingleNode("@t").text);this.U$=parseInt(h.selectSingleNode("@b").text)}catch(c){a=Object.assign(new fi.a,{extendedProperties:new Map});a.extendedProperties.set("exception",c.message);a.extendedProperties.set("operation",this.lo);Fa.Health.instance.recordQosError("PictureSwordResponseInvalid",
["ImageEditFailed"],!1,!0,!1,!1,a);r.ULS.sendTraceTag(25182691,322,15,"Exception parsing WordOart response: {0}, with a {1} operation. PlaceholderKind: {2}",c.message,this.lo,oD.a[this.bye]);this.TTc();return}this.HAc();bh.a.mark(this.u_b());this.Qg(!0,Object(m.a)(this,this.FOc,"onImageSuccess"))}FOc(a){const c=this.Ind(!0,!1);let h;h=this.sWb(h);this._image.setValue(Yb.a.Gfb,this.agd);const v=dd.ImageReader.Tia(this._image,this.qa,this.Fp),B=()=>{v&&Lz.a.fhb(this._image,v,3);Lz.a.fhb(this._image,
c,3);this.Og.j0d(this._image,Of.a.EG(this.qN),Of.a.EG(this.UT),Of.a.EG(this.Wo),Of.a.EG(this.U$));this._image.setValue(Yb.a.b$a,c);dd.ImageReader.py(this._image)||this._image.setValue(Yb.a.jza,1);this._image.setValue(Yb.a.TPc,this.e7);this._image.setValue(Uc.a.Fxl,-1);this.Na.isFeatureEnabled(145)&&dd.ImageReader.x0b(this._image)&&this.an.cYd(this._image);this.aOb&&this._image.setValue(ii.a.Gxd,!1);this.Og.T_d(this._image,this.Xo,this.Vq);this.qa.$("WordEditorImageRotateIsEnabled")&&this.Og.l0d(this._image,
this.xA,this.k4a,this.l4a);this.qa.$("WordEditorImageCropIsEnabled")&&this.Og.$Pf(this._image,this.nLb,this.kLb,this.lLb,this.mLb);2===a.data.status&&dd.ImageReader.bV(a.data.qd)&&(this._image.setValue(Uc.a.Wt,a.data.qd),a.data.request&&this._image.setValue(Uc.a.a1b,Lz.a.sYb("POST"===a.data.request.get_httpVerb()?a.data.request.get_body():a.data.request.get_url())));this.aGa&&this.aGa();this.Lw.TBa(this._context);if(this.Sk&&this.Sk!==Ya.a.nil){const X=this._context.node.Eh(),ma=new N.a(this.Sk,1);
this.Xi.OVb(X,ma)}this.Bb.Xq(13);this.HAc();this.Qud();bh.a.mark(this.u_b())};if(this.qa.$("WordOartForceOutboundAfterImageSuccessIsEnabled")&&this.Sk&&this.Sk!==Ya.a.nil){const X=this._context.node.Eh();if(X&&X.contentReplicator){h.dispose();X.contentReplicator.forceOutbound(()=>{let ma;ma=this.sWb(ma);B();ma.dispose()},null,null);return}}B();h.dispose()}}Object(w.a)(ZL,"RenderedPictureEditOperation",FA,[]);class $L{constructor(a,c,h,v,B,X,ma,Pa){this.Og=a;this.qa=c;this.Fp=h;this.Zc=v;this.Bb=B;
this.Xi=X;this.Lw=ma;this.Na=Pa}create(a,c){const h=dd.ImageReader.hm(a);return S.App.instance.Bjf(h)?new XL(a,c,this.Og,this.qa,this.Fp,this.Zc,this.Bb,this.Xi,this.Lw,!0):10===h||11===h||48===h||4===h?new YL(a,c,this.Og,this.qa,this.Fp,this.Zc,this.Bb,this.Xi,this.Lw,h):5===h?new ZL(a,c,this.Og,this.qa,this.Fp,this.Zc,this.Bb,this.Xi,this.Lw,h,this.Na):null}}Object(w.a)($L,"Factory",null,[538]);class aM{constructor(){this.Opb=null}lj(){const a=dl.a.Vy();this.PRc(a);this.DRc(null)}DRc(a){this.Opb&&
(l.AFrameworkApplication.Cb.me(this.Opb),this.Opb=null);this.Opb=new Se.a(1,1,1,Object(m.a)(this,this.Xzc,"doRerenderDocumentTask"),198);this.Opb.customData=a;l.AFrameworkApplication.Cb.ub(this.Opb)}PRc(a){const c=jH.b(a);if(c){var h=new gf.GraphTransaction(3);try{for(h.Oa(a);c.moveNext();){if(!sd.ParagraphReader.eg(c.iterator))continue;const v=c.currentNode;this.wfh(v)&&v.lj(4,!0)}}finally{h&&h.dispose()}}}wfh(a){a=a.aN;for(let c of a)if(c.Mcb)return 0<c.sHb;return!1}Xzc(a){const c=window.performance.now(),
h=dl.a.Vy();if(h){a=jH.a(a.customData,h);a=Tl.a.eq(a,h);var v=0,B=new gf.GraphTransaction(3);try{for(B.Oa(h);a.moveNext();){if(!sd.ParagraphReader.eg(a.iterator))continue;const X=a.currentNode;this.wfh(X)&&(v++,X.lj(4,!0));const ma=window.performance.now()-c;if(2500<v||100<ma){this.Opb=null;this.DRc(X);break}}}finally{B&&B.dispose()}}else Sd.b(570450380,3018,10,"PageContentNode not found")}}Object(w.a)(aM,"RenderParagraphsContainingTabs",null,[]);class bM{constructor(a,c){this.yge=!0;this.nhc=null;
this.ga=a;this.cGa=c}eb(){this.ga.Aa(Sa.a.q1a,ic.a.application,Object(m.a)(this,this.q1a,"updateSaveStatusForHeader"),1124)}VRn(){this.nhc?l.AFrameworkApplication.Cb.me(this.nhc):this.nhc=new Se.a(4,1,5E3,Object(m.a)(this,this.mxk,"doUpdateToSavedStatus"));l.AFrameworkApplication.Cb.ub(this.nhc)}mxk(){this.nhc=null;this.yge=!0;this.cGa&&this.cGa.cOa(!Eb.App.xM())}q1a(a,c,h){if(1===h)return 32;2===h&&(a=!1,Eb.App.xM()?this.yge=!1:this.yge?a=!0:this.VRn(),this.cGa&&this.cGa.cOa(a));return 32}}Object(w.a)(bM,
"SaveStatusActor",null,[]);class cM{constructor(a,c){this.Pu=this.$b=null;this.ga=a;this.l2=c}get JNf(){return this.F7m||(this.F7m=xa.a.instance.ra("Box4.ISaveStyleManager"))}get D1m(){return this.C1m||(this.C1m=xa.a.instance.ra("Box4.IResetAndDeleteStyleManager"))}get ti(){return this.Pu||(this.Pu=xa.a.instance.ra("Box4.Styles.StyleSettings"))}get qb(){return this.$b||(this.$b=xa.a.instance.resolve("Box4.Styles.IWACStyleReader"))}eb(){this.ga.Aa(zb.a.nsb,ic.a.view,Object(m.a)(this,this.nsb,"applyStyles"),
1028);this.ga.Aa(zb.a.createNewStyle,ic.a.view,Object(m.a)(this,this.createNewStyle,"createNewStyle"),4);this.ga.Aa(zb.a.Uub,ic.a.view,Object(m.a)(this,this.dXe,"deleteStyleDialog"),4);this.ga.Aa(zb.a.INf,ic.a.view,this.x7m.bind(this),4);this.ga.Aa(zb.a.cMf,ic.a.view,this.dMf.bind(this),4);this.ga.Aa(zb.a.bXe,ic.a.view,this.Jrk.bind(this),4)}x7m(a,c,h){a=dl.a.AAb(c)||this.Mmn();if(1===h||a)return a?8:32;this.JNf.w7m();return 32}dMf(a,c,h){a=dl.a.AAb(c)||0==lE.a.eY.size;if(1===h||a)return a?8:32;this.D1m.dMf();
return 32}Jrk(a,c,h){a=dl.a.AAb(c)||this.Hmn();if(1===h||a)return a?8:32;this.l2.value.Irk();return 32}Hmn(){return"{}"===lE.a.XIb?!0:!1}nsb(a,c,h){a=dl.a.AAb(c);if(1===h||a)return a?8:32;this.l2.value.dgk(c);return 32}createNewStyle(a,c,h){a=dl.a.AAb(c);if(1===h||a)return a?8:32;this.l2.value.Qjk(c,this.ga);return 32}dXe(a,c,h){a=dl.a.AAb(c)||this.Imn();if(1===h||a)return a?8:32;this.l2.value.dXe(c);return 32}Mmn(){var a=lE.a.XIb,c=lE.a.eY;const h=this.$b.lp();if("{}"==a&&0==c.size)return!0;if(!({dv:a}=
z.d(a)).returnValue)return r.ULS.sendTraceTag(526979992,3017,15,"Received null string during  deserialization: StylesActor."),!1;if(Object.keys(a).length!=c.size)return!1;for(let B of c.values()){c=h.zg(B);var v=a[B];if(null==v)return!1;if(v=dl.a.nCd(v)){if(this.ti.fV||(c=dl.a.fzd(c,h)),v=this.jcl(v),dl.a.oJd(c,v))return!1}else r.ULS.sendTraceTag(526979993,3017,15,"Received null style during de serialization: StylesActor.")}return!0}jcl(a){if(!a)return null;const c=a.zi(),h=new Map;for(const v of c)h.set(v,
a.PG(v));return h}Imn(){var a=dl.a.Vy();if(!a)return Sd.b(577368330,3018,15,"PageContentNode is null"),!0;a=(new kl.WACStyleSet).vM(a);const c=a.cM;for(let v=0;v<c;v++){var h=a.Uia(v);if(this.qb.isHidden(h)||!this.qb.ny(h,a))continue;const B=this.qb.Gv(h);if(2===B||1===B)if(!h.hasProperty(Yb.a.j9)||2===B)if(h=h.ia(Yb.a.zD,null),!(h&&0<h.length))return!1}return!0}}Object(w.a)(cM,"StylesActor",null,[]);class MF{constructor(a){this.ga=a}eb(){this.ga.ka(ba.a.b4d,ic.a.view,Object(m.a)(this,this.b4d,"switchToClassicViewMode"))}b4d(a,
c,h){a=l.AFrameworkApplication.na;if(1===h)return 1!==a.mode||ya.SessionStatusManager.instance.gi?2:32;Fa.Health.instance.recordKpiUsage("SwitchToClassicViewMode",0,MF.pF,null);const v={};v[L.a.Xdf]=l.AFrameworkApplication.K.Ga("ClassicViewModePreferenceCookieName");v[L.a.LKh]="true";l.AFrameworkApplication.uO().execute(B=>{B.Qg(E.a.Rxn,v)});return l.AFrameworkApplication.pa.processAction(zb.a.AEb,2)}}MF.pF="wwaengidc";Object(w.a)(MF,"SwitchToClassicViewModeActor",null,[]);class dM{constructor(a,
c,h,v,B,X,ma,Pa,mb){this.angle=h;this.styleId=v;this.width=a;this.height=c;this.top=B;this.bottom=X;this.left=ma;this.right=Pa;this.S_=mb}}Object(w.a)(dM,"SWordData",null,[]);class eM{constructor(a,c){this.jo=this.gQ=this.Co=null;this.pye=this.fPb=!1;this.qN=this.UT=this.U$=this.Wo=this.e7=this.Vq=this.Xo=this.xA=0;this.Sk=null;this.gl=a;this.Wpc=c;this.MMh()}MMh(){this.UT=this.qN=this.U$=this.Wo=this.e7=this.Vq=this.Xo=this.xA=-1;this.Sk=Ya.a.nil}LAc(){this.pye||(this.yUn(),this.flk(),this.fPb=!1)}flk(){this.jo=
new dM(this.Xo,this.Vq,this.xA,this.e7,this.Wo,this.U$,this.qN,this.UT,this.Sk);this.Wpc.create(this.gQ,this.Co).whn(Object(m.a)(this,this.N4,"onRequestComplete"),this.jo);this.pye=!0;let a;Object(Ub.a)(3,this.gQ)?a=oD.a[dd.ImageReader.hm(this.gQ)]:(r.ULS.sendTraceTag(42469523,322,50,"Unable to acquire PlaceholderKind because the image property set isn't of the type which contains information about the PlaceholderKind."),a="generic");r.ULS.sendTraceTag(23171277,322,50,"Sending request to SWord with width: {0}, height: {1}, angle: {2}, style: {3}, top: {4}, bottom: {5}, left: {6}, right: {7}, placeholderKind: {8}",
this.Xo,this.Vq,this.xA,this.e7,this.Wo,this.U$,this.qN,this.UT,a);this.MMh()}N4(){this.pye=!1;this.fPb&&this.LAc()}yUn(){this.Xo=-1!==this.Xo?this.Xo:this.gQ.ia(Uc.a.iza,-1);this.Vq=-1!==this.Vq?this.Vq:this.gQ.ia(Uc.a.hza,-1);this.Xo=-1!==this.Xo?this.Xo:this.gl.oC(this.gQ);this.Vq=-1!==this.Vq?this.Vq:this.gl.PD(this.gQ);this.xA=-1!==this.xA?this.xA:this.gl.a4(this.gQ);this.e7=-1!==this.e7?this.e7:this.gl.$ab(this.gQ);this.Wo=-1!==this.Wo?this.Wo:this.gl.Qia(this.gQ);this.U$=-1!==this.U$?this.U$:
this.gl.Nia(this.gQ);this.qN=-1!==this.qN?this.qN:this.gl.Oia(this.gQ);this.UT=-1!==this.UT?this.UT:this.gl.Pia(this.gQ)}rKm(a,c,h,v){this.Co=a;this.xA=h;this.fPb=!0;this.gQ=c;this.Sk=v;this.LAc()}qKm(a,c,h,v,B){this.Co=a;this.fPb=!0;this.gQ=c;this.Sk=B;this.gQ.setValue(Uc.a.iza,h);this.gQ.setValue(Uc.a.hza,v);this.LAc()}vKm(a,c,h){this.Co=a;this.fPb=!0;this.gQ=c;this.e7=h;this.LAc()}kKm(a,c,h,v,B,X){this.Co=a;this.Wo=h;this.U$=v;this.qN=B;this.UT=X;this.fPb=!0;this.gQ=c;c=a=0;({width:a,height:c}=
this.gl.bxb(this.gQ));this.Xo=a-(B+X)/1E5*a;this.Vq=c-(h+v)/1E5*c;this.LAc()}}Object(w.a)(eM,"SWordRequestManager",null,[537]);class uE{constructor(a,c,h,v=null,B=null,X=null,ma=null,Pa=null,mb=null,Tb=null){this.Xi=null;this.GKg=!1;this.Tga=a;this.DCe=c;this.vl=h;this.HP=v;this.Bz=B;this.ICe=X;this.vDa=ma;this.Na=Pa;this.Fb=mb;this.Fle=Tb}get ji(){return this.Xi||(this.Xi=this.Tga())}eb(){const a=l.AFrameworkApplication.pa,c=Object(m.a)(this,this.dAn,"tabView");a.Aa(zb.a.tab,ic.a.view,c,1124);a.Aa(zb.a.RRf,
ic.a.view,c,1124);a.ka(zb.a.eNh,ic.a.view,Le.ActionManager.De)}dAn(a,c,h,v,B){if(1===h)return 32;const X=a===zb.a.RRf;if(!c.view.Cd)return 2;const ma=c.view,Pa=ma.Ma,mb=Pa.If;if(!mb||uE.Sf.Kba(mb))return 2;if(this.vl&&this.vl.instance&&this.vl.instance.JR(mb))return 4;a=null;var Tb=Le.ActionManager.Qra;let rc=!1;var Tc=Gc.SelectionEditor.ke(mb);if(mb.Iv){if(Pa.Ca.VG&&(Tb=mb.getContext(0),a=new Kd.GraphIterator,a.set(Tb.node),a.fn(),Tb=X?zb.a.jOf:zb.a.f_d),Tb=this.DCe.bFm(Tb),Tb===Le.ActionManager.Qra){var vd=
uE.uf.RQ(mb,16);vd?(X&&(Tb=zb.a.lPd),a=new Kd.GraphIterator,a.set(vd.node),a.nc()):Tb=X?zb.a.lE:zb.a.gM}}else if(mb.Kk)if(a=new Kd.GraphIterator,a.set(mb.node),Gc.SelectionEditor.vs(a),zj.OutlineReader.nKa(mb))Tb=X?zb.a.jOf:zb.a.f_d;else{if(this.Fle&&this.Fle.zon(mb))return this.Fle.gVc(mb,ma.gb,X),32;Tb=X?this.DCe.ynl(a,mb,Tb,c):this.DCe.xnl(a,mb,Tb,c);Ta.OutlineElementReader.Gg(a)&&mb.contextId===ic.a.Ub&&(rc=Ta.OutlineElementReader.gz(a,mb,!1));vd=ab.ListReader.Pg(a)&&rc;Tb!==Le.ActionManager.Qra||
Tf.TableCellReader.zKa(a)||vd||(this.GKg||(r.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.GKg=!0),l.AFrameworkApplication.pa.processAction(zb.a.eNh,2),this.zNh(c))}else return 2;if(!X&&Tb===Le.ActionManager.Qra&&Tf.TableCellReader.zKa(a))if(Fe.returnToCell(a),Tf.TableCellReader.jKa(a)||Wf.TableReader.TSh(a)&&Tf.TableCellReader.zTh(a)){if(Tb=this.kBj(),!Tb)return 2}else Tb=zb.a.Y6h;if(Tb===Le.ActionManager.Qra)return 2;switch(Tb){case zb.a.Y6h:case zb.a.lPd:v=Tb===zb.a.lPd;
Tc&&this.HP&&this.Bz&&(Tc=this.HP.W1e(mb,-1,!0,vb.a.Sv))&&this.Bz.Bxi(Tc);h=32;Fe.returnToCell(a);Fe.moveToNextOrPreviousCell(a,v)&&(Tc=!0,v=!1,zj.OutlineReader.edf(a)||(Rm.OutlineNavigator.Psf(a,!1),ie.OutlineElementNavigator.Fd(a),sd.ParagraphReader.xu(a.currentNode)&&(Tc=!1,sd.ParagraphReader.textLength(a.currentNode)||(v=!0)),v||Fe.returnToCell(a)),v?a=ne.SelectionFactory.vd(a.currentNode,0):(a=ne.SelectionFactory.fq(a.currentNode),!Tc&&Gc.SelectionEditor.mj(a.Pb)&&(Tc=a.toArray(),Array.removeAt(Tc,
Tc.length-1),a=new xm.Selection(Tc,a.Ie))),Pa.setSelection(a));break;case zb.a.jOf:case zb.a.f_d:Tb===zb.a.f_d?Rm.OutlineNavigator.z6h(a,!1):Rm.OutlineNavigator.z6h(a,!0);Pa.setSelection(ne.SelectionFactory.fq(a.currentNode));h=32;break;case zb.a.aXc:h=l.AFrameworkApplication.pa.Le(c,Tb,h,!0,v,B);break;default:if(h=l.AFrameworkApplication.pa.Le(c,Tb,h,!0,v,B),!rc&&Tc&&(Tb===zb.a.lE||Tb===zb.a.gM)){const ee=Gc.SelectionEditor.Kwa(Pa.Ca.Fa).y;Eb.App.J8b(()=>{this.hfm(Pa,ma,ee)})}}32===h&&c.view.Cd&&
this.ji.ZD();return h}hfm(a,c,h){if(a&&c){var v=a.Ca.Fa;Gc.SelectionEditor.Kwa(v).y<h?(c=Gc.SelectionEditor.EBc(c,v,!1),c=Gc.SelectionEditor.Ypa(c,{qA:!1,Cr:!1,kC:!1,uE:!0})):c=Gc.SelectionEditor.Jwd(c,v,!1);a.setSelection(c)}}kBj(){return zb.a.iXa}zNh(){}nNc(a,c,h){if(a&&c){var v=a.Ca.Fa;Gc.SelectionEditor.Kwa(v).y<h?(c=Gc.SelectionEditor.EBc(c,v,!1),c=Gc.SelectionEditor.Ypa(c,{qA:!1,Cr:!1,kC:!1,uE:!0})):c=Gc.SelectionEditor.Ypa(v,{qA:!1,Cr:!1,kC:!1,uE:!0});a.setSelection(c)}}static get Sf(){return li.a.instance}static get uf(){return Nm.ContextSetEditor.instance}}
Object(w.a)(uE,"TabActor",null,[]);class uH{constructor(a){this.Ekc=a}get Zn(){return this.Ekc}bFm(a){return a}ynl(a,c,h,v){const B=v.view,X=B.Ma.Ca.Fa;if(Tf.TableCellReader.zKa(a))return this.QSh(a,v)?zb.a.lE:zb.a.lPd;ie.OutlineElementNavigator.Wc(a);if(Gc.SelectionEditor.ke(c))Ta.OutlineElementReader.gz(a,c,!1)&&this.sGi(a)?h=zb.a.aEb:Gc.SelectionEditor.lKc(B,X)&&this.Zn.Xsb(a)?h=zb.a.lE:Gc.SelectionEditor.lKc(B,X)&&(h=zb.a.lE);else if(Gc.SelectionEditor.tj(c)){if(!this.Zn.Xsb(a))return h;Gc.SelectionEditor.Gcb(c)?
h=zb.a.lE:Gc.SelectionEditor.zXh(c)&&(h=this.sGi(a)?zb.a.aEb:zb.a.lE)}else this.Zn.Xsb(a)&&(h=zb.a.lE);return h}xnl(a,c,h,v){if(Tf.TableCellReader.LX(a))return this.QSh(a,v)?zb.a.gM:h;ie.OutlineElementNavigator.Wc(a);if(Gc.SelectionEditor.ke(c))Ta.OutlineElementReader.gz(a,c,!1)&&(!ab.ListReader.Pg(a)&&Ta.OutlineElementReader.isEmpty(a,!1)?h=Le.ActionManager.Qra:this.Gmn(a)?h=zb.a.O9a:this.GFi(a)?h=zb.a.Vub:this.Zn.bVb(a)&&(h=zb.a.gM));else if(Gc.SelectionEditor.tj(c)){if(!this.Zn.bVb(a))return h;
Gc.SelectionEditor.Gcb(c)?h=zb.a.gM:Gc.SelectionEditor.zXh(c)&&(h=this.GFi(a)?zb.a.Vub:zb.a.gM)}else this.Zn.bVb(a)&&(h=zb.a.gM);return h}sGi(a){return ab.ListReader.Pg(a)?!1:0<Ta.OutlineElementReader.n0(a)?!0:!1}GFi(a){if(ab.ListReader.Pg(a))return!1;const c=Ta.OutlineElementReader.n0(a);a=zj.OutlineReader.XJ(a.currentNode);return c<a?!0:!1}Gmn(a){return ab.ListReader.Pg(a)?!1:0<Ta.OutlineElementReader.sI(a)?!0:!1}static hq(){return new uH(Vn.a.uxb)}QSh(a,c){if(this.DQl){c=c.view;const h=c.Ma.Ca.Fa,
v=new Kd.GraphIterator;v.Wb(a);ie.OutlineElementNavigator.Wc(v);if(ab.ListReader.Pg(v)&&Gc.SelectionEditor.lKc(c,h))return!0}return!1}get DQl(){var a;l.AFrameworkApplication.Mg("egdi3422;7g6fa693");return null===(a=l.AFrameworkApplication.K)||void 0===a?void 0:a.getBooleanFeatureGate("Microsoft.Office.WordOnline.QOEForListInTableIsEnabled",!1)}}Object(w.a)(uH,"TabActorPromoteDemoteStrategy",null,[546]);class uC extends uE{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd){super(a,c,h,v,B,X,ma,Pa,mb,Tb);
this.Spc=null;this.hPb=rc;this.ga=vd;this.IF();this.ga.ka(ba.a.XJ,ic.a.view,Object(m.a)(this,this.XJ,"getDefaultTabStop"))}get gTc(){return this.Spc||(this.Spc=xa.a.instance.ra("WordEditor.Actors.RenderParagraphsContainingTabs"))}IF(){this.hPb.Pk.Yd(10).Yl(Object(m.a)(this,this.KOc,"onOutlinePropertyChanged"))}KOc(a,c){a=c.property;!this.gTc||a!==Yb.a.Po&&a!==Yb.a.marginLeft&&a!==Yb.a.marginRight||this.gTc.lj()}zNh(a){const c=a.view,h=c.Ma;a=h.If;if(this.vDa&&this.Fb){var v=this.Fb.Ob(15);v.Oa(a.node);
a.contextId===ic.a.xc&&l.AFrameworkApplication.pa.processAction(zb.a.lF,2);this.vDa.PGd(h.If);v.dispose();var B=Gc.SelectionEditor.Kwa(h.Ca.Fa).y;Eb.App.J8b(()=>{this.nNc(h,c,B)})}}U$k(a){return a.view.Ma.Ca.Fa.sa.node}XJ(a,c,h,v,B){a=zj.OutlineReader.XJ(this.U$k(c));B.defaultTabStop=a;return 32}static get instance(){return uC._instance||(uC._instance=uC.wk())}static wk(){return new uC(()=>xa.a.instance.resolve("Box4.IUndoManager"),uH.hq(),xa.a.instance.za("Box4.IExternalSelectionManager"),xa.a.instance.resolve("Box4.IAutoCorrectRules"),
xa.a.instance.resolve("Box4.IAutoCorrectScheduler"),xa.a.instance.ra("Box4.ITabPresenterFactory"),xa.a.instance.ra("Box4.IBlobEditor"),xa.a.instance.ra("Box4.IFeatureHelper"),xa.a.instance.ra("Box4.Graph.GraphTransactionFactory"),xa.a.instance.ra("Box4.Actors.IIFrameFocusStrategy"),Eb.App.aj,xa.a.instance.ra("Box4.ITabRenderer"),l.AFrameworkApplication.pa)}}uC._instance=null;Object(w.a)(uC,"TabActor",uE,[]);class Hq{static get Yq(){return Hq.xg||(Hq.xg=xa.a.instance.resolve("Box4.IAppFrame"))}static get pXh(){null==
Hq.npe&&(Hq.npe=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAutoContextualTabSwitch",!1):!1);return Hq.npe}static initialize(){Rr.a.n3b=Hq.wRl;Rr.a.K0a=Hq.bXn}static wRl(a){return!Wf.TableReader.HMl(a)}static Neb(){Hq.Yq.W8b(Hq.Neb);Hq.Gob=!1;const a=appChrome.selectors.getActiveContextualTabIds();Hq.mpe=!1;"Home"===appChrome.selectors.getSelectedTabId()&&0<=Array.indexOf(a,"Table")&&appChrome.api.dispatch(appChrome.actions.setCurrentTab("Table"))}static bXn(a){if(a){if(yr.a.instance.Fa.dAa||
yr.a.instance.Fa.kv||yr.a.instance.Fa.HAb)Hq.pXh&&!Hq.Gob&&Hq.mpe?(Hq.Yq.RSa(Hq.Neb),Hq.Gob=!0,Hq.C$("SimplifyRibbonContextualCommandsUsageTreatment","EnableAutoContextualTabSwitch")):Hq.C$("SimplifyRibbonContextualCommandsUsageControl","DefaultContextTabBehaviour")}else Hq.pXh&&(Hq.mpe=!0)}static C$(a,c){const h=xa.a.instance.za("Common.ISystemInitiatedFeedback");h&&h.execute(v=>{v.logActivity(a,c)})}}Hq.Gob=!1;Hq.mpe=!1;Hq.xg=null;Hq.npe=null;Object(w.a)(Hq,"TableActor",null,[]);var oQ=b(1532);
class vH{AJk(a,c,h,v){return a?this.cIk(c,h,v):this.BJk(c,h,v)}Vlh(a,c,h,v,B){return a?this.dJk(c,h,v,B):this.RIk(c,h,v,B)}OIk(a){let c=!1;var h=a.Ie?a.Gd.Pb:a.Gd.sa;a=new Kd.GraphIterator;a.set(h.node);a.La(14);h=null;Tf.TableCellReader.U8(a)?Tf.TableCellReader.Yzb(a)||(c=!0,h=Fe.moveToNextRow(a)):h=Fe.moveToNextColumn(a);return{returnValue:h,Afm:c}}YIk(a){var c=a.Ie?a.Gd.Pb:a.Gd.sa;const h=new Kd.GraphIterator;h.set(c.node);h.La(14);c=null;Tf.TableCellReader.Vca(h)?Tf.TableCellReader.O8(h)||(c=
new Kd.GraphIterator,c.set(a.Mwa.node),c.La(14),a=$m.a.ir(c),$m.a.ir(h)>a?(Fe.moveToPreviousRow(h),Fe.moveToLastColumn(h),c=h.currentNode):c=Fe.moveToPreviousRow(h)):c=Fe.moveToPreviousColumn(h);return c}gmh(a,c){var h=a.Ie?a.Gd.Pb:a.Gd.sa;a=new Kd.GraphIterator;a.set(h.node);a.La(14);h=null;c?Tf.TableCellReader.O8(a)||(h=Fe.moveToPreviousRow(a)):Tf.TableCellReader.Yzb(a)||(h=Fe.moveToNextRow(a));return h}UAb(a,c,h){for(;Tf.TableCellReader.lf(a);)if(c){if(h&&a.Xqa(1)||!h&&a.dra(1))return null;h?Fe.moveToPreviousColumn(a):
Fe.moveToNextColumn(a)}else{if(Tf.TableCellReader.J0(a.currentNode)){const v=new Kd.GraphIterator;v.Wb(a);if(this.UAb(v,!0,!0)||this.UAb(v,!0,!1)){a.Wb(v);break}}else{if(!h&&Fe.moveToControllingCell(a,2))break;if(h&&Fe.moveToControllingCell(a))break}if(h&&Tf.TableCellReader.O8(a)||!h&&Tf.TableCellReader.Yzb(a))return null;h?Fe.moveToPreviousRow(a):Fe.moveToNextRow(a)}return a.currentNode}AYb(a,c){if(!$m.a.isTableRow(a))return null;a=Kd.GraphIterator.va(a.currentNode);a.La(14);let h;const v=Wf.TableReader.fz(a.origin);
do h=c?Fe.moveToPreviousRow(a):Fe.moveToNextRow(a);while(v&&h&&$m.a.cKa(a));return h}neb(a,c,h,v,B){let X=null;ie.OutlineElementNavigator.Wc(a);const ma=Ta.OutlineElementReader.isRtl(a.currentNode);if(h)if(Fe.returnToCell(a),c=Tf.TableCellReader.U8(a),h=Tf.TableCellReader.Vca(a),B||!ma&&h||ma&&v&&c)Fe.returnToContainingRow(a),(v=this.AYb(a,!0))?X=ne.SelectionFactory.en(v,!c):B&&(ie.OutlineElementNavigator.Wc(a),B=new Yk.a,B.Wb(a),(a=ie.OutlineElementNavigator.J4(B,!1,!1))&&(X=ne.SelectionFactory.en(a,
!1)));else{do ma?Fe.moveToNextColumn(a):Fe.moveToPreviousColumn(a);while(Tf.TableCellReader.lf(a)&&!Tf.TableCellReader.O8(a));Tf.TableCellReader.lf(a)||(X=ne.SelectionFactory.en(a.currentNode,!ma))}else Ta.OutlineElementReader.gz(a,c,ma)||Gc.SelectionEditor.ke(c)||Fe.returnToCell(a),X=ne.SelectionFactory.en(a.currentNode,!ma);return X}meb(a,c,h,v,B){let X=null;ie.OutlineElementNavigator.Wc(a);const ma=Ta.OutlineElementReader.isRtl(a.currentNode);if(h)if(Fe.returnToCell(a),h=Tf.TableCellReader.U8(a),
c=Tf.TableCellReader.Vca(a),B||!ma&&v&&h||ma&&!v&&c)Fe.returnToContainingRow(a),(v=this.AYb(a,!1))?X=ne.SelectionFactory.en(v,c):(ie.OutlineElementNavigator.Wc(a),v=new Yk.a,v.Wb(a),(a=ie.OutlineElementNavigator.Ir(v,!1,!1))&&(X=ne.SelectionFactory.en(a,!0)));else{do ma?Fe.moveToPreviousColumn(a):Fe.moveToNextColumn(a);while(Tf.TableCellReader.lf(a)&&!Tf.TableCellReader.U8(a));Tf.TableCellReader.lf(a)||(X=ne.SelectionFactory.en(a.currentNode,ma))}else Ta.OutlineElementReader.gz(a,c,!ma)||Gc.SelectionEditor.ke(c)||
Fe.returnToCell(a),X=ne.SelectionFactory.en(a.currentNode,ma);return X}}Object(w.a)(vH,"ATableCellSelectionStrategy",null,[1285]);class fM extends vH{constructor(){super()}RIk(a,c,h,v){let B=a.Fa,X=null;if(a.kv)if(c)if(2===B.Gd.ika&&!B.Ie&&B.Gd.Pb.equals(B.Mwa))B=ne.SelectionFactory.t$g(B.Mwa.node,!1);else{var ma=({Afm:a}=this.OIk(B)).returnValue;ma&&(Tf.TableCellReader.lq(ma)&&(ma=Kd.GraphIterator.va(ma),ma.La(14),ma=!a&&this.UAb(ma,!0,!1)?ma.currentNode:a||Fe.moveToNextRow(ma)?this.UAb(ma,!1,!1):
null),ma&&(X=ne.SelectionFactory.yn(ff.TableNodeContext.create(ma),B.Ie)))}else B=a.t$,a=Kd.GraphIterator.va(B.Gd.Pb.node),a.La(14),Tf.TableCellReader.Oza(a.currentNode)&&Fe.moveToLastGhostCell(a,2),(ma=Fe.moveToNextColumn(a))?(a=Tf.TableCellReader.J0(ma),Tf.TableCellReader.lq(ma)&&!a&&(ma=Kd.GraphIterator.va(ma),ma.La(14),ma=Fe.moveToControllingCell(ma)),a?B=ne.SelectionFactory.en(B.Gd.Pb.node,!1):X=ne.SelectionFactory.en(ma,!0)):(ma=B.Gd.Pb.node,X=ne.SelectionFactory.en(ma,!1));else a=c&&B.Ie||
!c&&!B.vra?B.Gd.Pb:B.Gd.sa,$m.a.Lja(a.node)&&(a=Kd.GraphIterator.va(a.node),(ma=this.AYb(a,!1))?X=c?ne.SelectionFactory.yn(ff.TableNodeContext.create(ma),B.Ie):ne.SelectionFactory.en(ma,!0):B=Gc.SelectionEditor.Ri(ne.SelectionFactory.fq(a.currentNode),!1,!0));return X?X:v?Gc.SelectionEditor.yYb(B,!1,c,!0):Gc.SelectionEditor.Ypa(B,{qA:!c,Cr:c,kC:h,uE:!0})}dJk(a,c,h,v){let B=a.Fa;var X=null;if(a.kv)c?1===B.Gd.ika&&B.Ie&&B.Gd.sa.equals(B.Mwa)||(X=this.YIk(B),(X=this.Tlh(B,X))||B.Ie&&(B=B.WBc())):(B=
a.t$,X=ne.SelectionFactory.en(B.Gd.sa.node,!0));else if(c){var ma=(B.Ie?B.Gd.Pb:B.Gd.sa).node;a=Kd.GraphIterator.va(ma);Gc.SelectionEditor.vs(a);$m.a.Lja(ma)&&(B.Ie&&1===B.Gd.ika&&B.vra?(X=$m.a.nC(ma).toArray(),(X=this.Tlh(B,0<=X.length-2?X[X.length-2]:null))||B.Ie&&(B=B.WBc())):(ma=this.AYb(a,!0))?X=ne.SelectionFactory.yn(ff.TableNodeContext.create(ma),B.Ie):B=ne.SelectionFactory.en(a.currentNode,!0))}else X=Gc.SelectionEditor.Ri(B,!0,!1);return X?X:v?Gc.SelectionEditor.yYb(B,!0,c,!0):Gc.SelectionEditor.jya(B,
{qA:!c,Cr:c,kC:h,uE:!0})}Tlh(a,c){if(!c)return null;var h=c;Tf.TableCellReader.lq(c)&&(h=Kd.GraphIterator.va(c),h.La(14),h=this.UAb(h,!0,!0)?h.currentNode:Tf.TableCellReader.tia(c));return h?ne.SelectionFactory.yn(ff.TableNodeContext.create(h),a.Ie):null}BJk(a,c,h){let v=c.Fa,B=null;if(c.kv){var X=c.xU>c.rCa;if(h)if(2===c.length&&1===c.t$.Gd.ika&&X)v=Gc.SelectionEditor.Ri(v,!0,!1);else{if(c=this.gmh(v,!0))Tf.TableCellReader.lq(c)&&(c=Kd.GraphIterator.va(c),c.La(14),c=this.UAb(c,!1,!0)),c&&(B=ne.SelectionFactory.yn(ff.TableNodeContext.create(c),
v.Ie));B||v.Ie&&(v=v.WBc())}else X&&(v=c.t$)}else c=h&&v.Ie?v.Gd.Pb:v.Gd.sa,$m.a.Lja(c.node)&&(c=Kd.GraphIterator.va(c.node),(X=this.AYb(c,!0))?B=h?ne.SelectionFactory.yn(ff.TableNodeContext.create(X),v.Ie):ne.SelectionFactory.en(X,!0):h&&(v=ne.SelectionFactory.en(c.currentNode,!0)));return B?B:Gc.SelectionEditor.t9a(a,v,!1,h,h)}cIk(a,c,h){let v=c.Fa,B=null;if(c.kv){const X=c.xU<c.rCa;if(h)if(2===c.length&&1===c.t$.Gd.ika&&X)v=Gc.SelectionEditor.Ri(v,!1,!1);else{if(c=this.gmh(v,!1))Tf.TableCellReader.lq(c)&&
(c=Kd.GraphIterator.va(c),c.La(14),c=this.UAb(c,!1,!1)),c&&(B=ne.SelectionFactory.yn(ff.TableNodeContext.create(c),v.Ie))}else X&&(v=c.t$)}else c=!h||v.Ie?v.Gd.Pb:v.Gd.sa,$m.a.Lja(c.node)&&(c=Kd.GraphIterator.va(c.node),(c=this.AYb(c,!1))&&(B=h?ne.SelectionFactory.yn(ff.TableNodeContext.create(c),v.Ie):ne.SelectionFactory.en(c,v.vra)));return B?B:Gc.SelectionEditor.t9a(a,v,!0,h,h)}}Object(w.a)(fM,"TableCellSelectionStrategy",vH,[]);class gM{constructor(a){this.ga=a}eb(){this.ga.Aa(zb.a.PK,ic.a.view,
Object(m.a)(this,this.PK,"showProgressDialog"),1028)}PK(a,c,h,v,B){if(1===h)return 32;a=(new tk.a).create();c="";switch(B.DialogType){case "DirectPrintPreparingPDF":c=CommonUIStrings.l_DirectPrintPreparingPDF;B=CommonUIStrings.l_DefaultDialogTitle;break;default:B=CommonUIStrings.l_DefaultDialogTitle}a.message=c;a.PK(B,null,null);return 32}}Object(w.a)(gM,"UIAutomationActor",null,[]);class hM{constructor(a,c,h,v){this.Ba=a;this.vDa=c;this.Afc=h;this.A2=v}yZf(a,c,h){return this.Afc.pPl(c)?h?!0:a&&this.Ba.eg(a)?
(a=this.av(a.currentNode),this.vDa.GNh(a),!0):!1:!1}zcf(a,c){return this.Afc.mDk(a,c)}Ecf(a){a&&this.Ba.eg(a)&&(a=this.av(a.currentNode),this.vDa.PGd(a))}av(a){return Oe.a.av(a)}YBa(a,c,h){this.A2.Rgi&&this.Afc.FRh(h)&&(this.A2.YBa(a,c),a.setValue(Uc.a.VRh,!0))}w0d(){}EId(a){return this.Afc.EId(a)}get FJd(){return this.Afc.FJd}sA(){}xea(){}P0d(){}get QGi(){return!1}}Object(w.a)(hM,"WordEditorPasteStewardBridge",null,[536]);class iM{constructor(a){this.ma=new Rd.a;this.Pwi="WordFileSaveAsButtonClicked";
this.ga=a}eb(){l.AFrameworkApplication.K.$("UseNewCommandForWordFileMenuSaveAs")&&this.ga.ka(ba.a.FZi,Kc.a.frame,Object(m.a)(this,this.eXn,"wordFileMenuSaveAsClickHandler"))}eXn(){this.ma.raiseEvent(this.Pwi,null);return 32}dJj(a){this.ma.addHandler(this.Pwi,a)}}Object(w.a)(iM,"WordFileSaveAsActor",null,[]);class jM extends jl{constructor(){super()}yuc(a,c,h,v,B,X,ma){return Ln.a.C7b(c,h,v,B,X,ma)}}Object(w.a)(jM,"WordIndentationActorExtension",jl,[]);class kM extends Xg.a{constructor(){super()}get gja(){return!0}get Ayb(){return 5}get Jbb(){if(null!=
this.r6)return this.r6;this.r6=[];Array.add(this.r6,new hh.a(lh.a.ind,lh.a.ind));Array.add(this.r6,new hh.a(lh.a.DMe,lh.a.DMe));Array.add(this.r6,new hh.a(lh.a.gvc,lh.a.gvc));return this.r6}CLa(a,c){this.gja&&Fo.a.instance.$c(()=>{const h=this.fx.RHa;var v=this.fx.oLd;if(h)if(5===h.type){v=h.XD;if(h.LM&&h.LM.zV.includes(a))for(const B of c.UZa("*"))this.fx.a_a(B);v&&v.zV.includes(a)&&this.pVc(c,h.action,v,a)}else v&&5===v.type&&3===h.action&&v.XD.zV.includes(a)&&this.pVc(c,0,v.XD,a)},"BHA:OPHC")}bYa(a){return Object(Ub.a)(GF,
a)}Xab(a,c){if(a)for(let h of a.zV)c.add(h)}pVc(a,c,h,v){0===c&&a.htmlElement&&Fo.a.instance.$c(()=>{const B=a.UZa("*"),X=B.length,ma=lh.a.ind;var Pa=v.id===h.CWg,mb=v.id===h.yWg;let Tb=!1;var rc=0,Tc=[];let vd=Array(X);for(let Xe=0;Xe<X;Xe++){var ee=B[Xe];const Yf=vk.a(ee);vd[Xe]=Yf;const Hh=ee.classList;if(0!=vd[Xe]){const Fi=!Hh.contains(lh.a.GG);let wk=Di.a.Ra(ee,lh.a.Esb);wk&&Tc.push(...wk);if(Pa){let Gk;if((Gk=Di.a.Ra(ee,lh.a.knd))&&wk&&1===Gk.length&&1===wk.length&&Gk[0].equals(wk[0]))continue;
Gk&&(rc+=Gk.length,1===Yf?Hh.add(lh.a.DMe):Hh.add(ma));if(wk)for(let Kl of wk)this.IHd(h,Kl)&&(rc--,Tb&&Hh.add(lh.a.gvc));0!==rc&&Fi&&Hh.add(ma)}if(!Pa&&!mb&&h.kUj.has(v.id))if((ee=Di.a.Ra(ee,lh.a.Esb))&&Tb){Hh.add(ma);for(let Gk of ee)if(this.IHd(h,Gk)){Hh.add(lh.a.gvc);break}}else Fi&&Hh.add(ma)}Tb=!Hh.contains(lh.a.o$a)}if(mb&&!Pa){Pa=new Set;for(var Ie of Tc)this.IHd(h,Ie)&&Pa.add(Ie);Tb=!1;for(Tc=0;0!==Pa.size&&Tc<X;Tc++){rc=B[Tc];Ie=rc.classList;if(0!=vd[Tc])if(mb=!1,rc=Di.a.Ra(rc,lh.a.Esb)){for(let Xe of rc)this.IHd(h,
Xe)&&(Pa.delete(Xe),mb=!0);0!==Pa.size&&Ie.add(ma);Tb&&mb&&Ie.add(lh.a.gvc)}else Ie.contains(lh.a.GG)||Ie.add(ma);Tb=!Ie.contains(lh.a.o$a)}}},"BHA:SPH")}IHd(a,c){for(let h of a.gUj)if(c.equals(h))return!0;return!1}}Object(w.a)(kM,"BookmarkHighlightActor",Xg.a,[312]);var NF=b(497);class lM{constructor(a,c,h){this.LPa="wwaengidc";this.K3c="CreateLinkForHeading";this.Yaj="CreateLinkForHeadingAction";this.bdj="\ufffc";this.Mma=a;this.ga=c;this.Ba=h}eb(){this.ga.ka(ba.a.lyc,ic.a.paragraph,this.KUe.bind(this));
this.ga.ka(ba.a.lyc,ic.a.xc,this.KUe.bind(this));this.ga.ka(ba.a.lyc,ic.a.Ub,this.KUe.bind(this));this.ga.Qb(ba.a.lyc,1028)}KUe(a,c,h){l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled");if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.HeadingDeeplinkIsEnabled",!1)){a=c.node;if(1===h)return this.HTh(a)?32:8;this.VOm(this.K3c,this.Yaj);if(!this.HTh(a))return r.ULS.sendTraceTag(528815444,3029,50,"User is trying to create sharable link for a non-heading text"),
8;h=a.getValue(Yb.a.Ib);if(!h)return r.ULS.sendTraceTag(528815445,3029,10,"Word id does not exist for the paragraph"),h=new Map,h.set("Source",this.K3c),h=Object.assign(new fi.a,{Uu:h}),Fa.Health.instance.recordKpiFailure(this.K3c,"Unable to create sharable link as paragraph id is missing",!1,!0,h),8;h=String.format('{{"{0}":"{1}"}}',NF.a.heading,h);a={};a.nav=btoa(h);a.mode="copy";this.ga.hb(Sa.a.M$a,2,a);return 32}return 8}HTh(a){return!this.Ba.tb(a)||this.Ba.bJc(a)||this.Ba.JId(a)||a.kr||""===
a.characterData||a.characterData===this.bdj||!this.Mma.Uzd(a)?!1:!0}VOm(a,c){const h=new Map;h.set("Source",this.K3c);h.set("Action",c);Fa.Health.instance.recordKpiUsage(a,0,this.LPa,h)}}Object(w.a)(lM,"HeadingsActor",null,[]);var pQ=b(700);class wH{constructor(){this.Q9c=this.Na=this.tQ=this.W=null}get name(){return"WordEditor.Actors"}init(){ec.InteractiveViewManager.instance.editingView.fXb=!0;l.AFrameworkApplication.pa.ka(ba.a.gWn,Kc.a.frame,bQ);sL.DeleteActor.instance.eb(l.AFrameworkApplication.pa);
oC.instance.eb();Am.eb();qq.eb(l.AFrameworkApplication.pa,this.W.resolve("WordEditor.IMainViewModeManager"));pk.eb();uC.instance.eb();oQ.a.eb();this.W.resolve("WordEditor.Actors.ModeSwitcherControlActor").eb(l.AFrameworkApplication.pa);this.W.resolve("WordEditor.Actors.ExternalContentActor").eb();this.W.resolve("WordEditor.OnlineMedia.OnlineMediaActor").eb();l.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&this.W.resolve("Box4.Actors.FormatPainterActor").eb();l.AFrameworkApplication.K.$("WordEditorAutoSaveImprovementIsEnabled")&&
this.W.resolve("WordEditor.Actors.SaveStatusActor").eb();l.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&l.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&(this.tQ.KJd=!0);l.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",!1)&&this.W.resolve("WordEditor.Actors.ModernUxActor").eb();l.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&this.W.resolve("WordEditor.Actors.SwitchToClassicViewModeActor").eb();
this.W.resolve("WordEditor.Actors.AppFrameCommandUIActor").eb();this.W.resolve("Common.IOfficeTrialExperience").eb();this.W.resolve("Common.IMacOfficeOffer").eb();this.W.resolve("WordEditor.Actors.MarginsDialogActor").eb();this.W.resolve("WordEditor.Actors.PaperSizeDialogActor").eb();this.W.resolve("WordEditor.Actors.FileDownloadActor").eb();this.W.resolve("WordEditor.Actors.StylesActor").eb();this.W.resolve("WordEditor.Actors.ParagraphDialogActor").eb();this.W.resolve("WordEditor.Actors.ProofingActor").eb();
this.W.resolve("WordEditor.Actors.PageActor").eb();this.W.resolve("WordEditor.Actors.DarkModeActor").eb();this.W.resolve("WordEditor.Actors.ImageActor").eb(l.AFrameworkApplication.pa);this.W.resolve("WordEditor.Actors.FormattingActor").eb();this.W.resolve("WordEditor.Actors.UIAutomationActor").eb();this.W.resolve("WordEditor.Actors.ContentControlActor").eb();this.W.resolve("WordEditor.Actors.CustomTabActor").eb();this.W.resolve("WordEditor.Actors.BookmarkActor").eb();this.W.resolve("WordEditor.Actors.HeadingsActor").eb();
this.W.resolve("Box4.Indicator.IIndicatorManager").hgb(this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"));this.W.resolve("WordEditor.Actors.AccessibilityHelpDialogActor").eb();this.W.resolve("WordEditor.Actors.AccessibilityActor").aJf();this.W.resolve("WordEditor.Actors.ISWordRequestManager");this.W.resolve("Box4.Actors.AutoCorrectActor").eb();this.W.resolve("WordEditor.Actors.DigitalPrintActor").eb();this.W.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager");this.W.resolve("Box4.Actors.VisiMarkersActor").eb();
this.W.resolve("WordEditor.Actors.ExternalContentFloatieEventManager");this.W.resolve("WordEditor.Actors.ActionHangDetector").P9();this.W.resolve("WordEditor.Actors.WordFileSaveAsActor").eb();l.AFrameworkApplication.K.$("GraphicsEditorActorRegistrationUpdateIsEnabled")?this.IQm():this.W.resolve("WordEditor.Actors.GraphicsEditorActor").eb();this.E2.ggb(this.a9i);const a=this.W.resolve("WordEditor.Bookmark.FullBookmarkManager");l.AFrameworkApplication.Bh("Microsoft.Office.WordOnline.BookmarksIsEnabled");
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.BookmarksIsEnabled",!1)&&a.$5g(!1)&&Eb.App.oa.Da.Ihh();Eb.App.oa.updateCommandUI();Hq.initialize()}dispose(){}IQm(){this.Na.pk.isCompleted?this.Na&&this.Na.isFeatureEnabled(81)&&this.W.resolve("WordEditor.Actors.GraphicsEditorActor").eb():this.Na.pk.continueWith(()=>{this.Na&&this.Na.isFeatureEnabled(81)&&(this.W.resolve("WordEditor.Actors.GraphicsEditorActor").eb(),Eb.App.oa.updateCommandUI())})}get JPl(){if(null==this.Q9c)if(this.Na)if(this.Na.pk.isCompleted)this.Q9c=
this.Na.isFeatureEnabled(44)&&this.Na.isFeatureEnabled(4);else return!1;else this.Q9c=!1;return this.Q9c}yb(a){this.W=a;this.Na=a.ra("Box4.IFeatureHelper");this.tQ=this.W.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.tQ.$Jc=l.AFrameworkApplication.K.$("WordProofingSecondaryContextualMenuIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordEditorRightClickSecondaryMenuIsEnabled",!1);(new JK).yb(a);a.ha("Box4.IClipboardCommands",()=>new KK(l.AFrameworkApplication.pa,
zb.a.oNe,zb.a.lvc,zb.a.F_,zb.a.VCf,zb.a.paste,zb.a.Tda,zb.a.y7b)).singleInstance();a.ha("HtmlImport.IHtmlNormalizerSettings",()=>{const c=a.resolve("Common.IAppSettingsManager");return new cy(!0,c.$("SplitHyperlinkFixWithEnterIsEnabled"))}).singleInstance();a.ha("HtmlImport.IHtmlTranslatorSettings",()=>{const c=a.resolve("Common.IAppSettingsManager"),h=v=>!v.g2b;return new VP.a(c.$("ExternalPasteImprovementsEnabled"),c.$("PasteComplexTablesIsEnabled"),c.$("PasteTableCellMarginImprovementsIsEnabled"),
c.$("WordWacQoEListBulletsLevelExternalPasteImprovementIsEnabled"),!0,void 0,void 0,void 0,void 0,void 0,void 0,!0,void 0,c.$("SupportCloudFontInExternalPasteIsEnabled"),!0,!0,!0,!0,!0,v=>v.g2b,()=>!1,h,h,h,h,void 0,()=>this.JPl,v=>!v.g2b)}).singleInstance();a.ha("WordEditor.Actors.WordEditorPasteStewardBridge",()=>new hM(a.resolve("Box4.IParagraphReader"),a.resolve("Box4.IBlobEditor"),a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"))).as("Box4.Actors.IBox4PasteStewardBridge").singleInstance();
a.ha("WordEditor.Actors.PastedContentsProcessorPostMergeAfterPaste",()=>new UL(a.resolve("Wonca.ExternalContent.IExternalContentEditor"),a.resolve("Box4.IFeatureHelper"))).as("Box4.Actors.IPastedContentsProcessorPostMergeAfterPaste").singleInstance();a.ha("Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy",()=>new LK).as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").singleInstance();a.ha("Box4.IIndentationCommands",()=>new MK(l.AFrameworkApplication.pa)).singleInstance();
a.ha("Box4.IJustificationCommands",()=>new NK(l.AFrameworkApplication.pa)).singleInstance();a.ha("Box4.ISpacingCommands",()=>new OK(l.AFrameworkApplication.pa)).singleInstance();a.ha("WordEditor.IPageCommands",()=>new QL(l.AFrameworkApplication.pa)).singleInstance();a.ha("WordEditor.Actors.StylesActor",()=>new cM(l.AFrameworkApplication.pa,a.te("WordEditor.UI.IDialogFactory"))).singleInstance();a.ha("WordEditor.Actors.DigitalPrintActor",()=>new mH(l.AFrameworkApplication.pa,a.te("WordEditor.UI.IDialogFactory"))).singleInstance();
a.ha("WordEditor.Actors.FileDownloadManager",()=>new zL(a.resolve("Common.App.DirectPrint.IDirectPrintManager"),new UP.a)).singleInstance();a.ha("WordEditor.Actors.FileDownloadActor",()=>new wL(l.AFrameworkApplication.pa,a.te("WordEditor.UI.IDialogFactory"),a.resolve("WordEditor.Actors.FileDownloadManager"),l.AFrameworkApplication.K.$("DisablePrint"),l.AFrameworkApplication.K.Ga("IrmPolicyDescription"),a.resolve("WordEditor.IBusinessBarController"))).singleInstance();a.ha("WordEditor.Actors.ParagraphDialogActor",
()=>new SL(l.AFrameworkApplication.pa,a.te("Box4.UI.IBox4DialogFactory"),a.resolve("WordEditor.LineSpacingHelper"),iq.a.instance,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("WordEditor.ClientPagination.IClientPaginationSettings"))).singleInstance();a.ha("WordEditor.Actors.MarginsDialogActor",()=>new OL(l.AFrameworkApplication.pa,a.te("WordEditor.UI.IDialogFactory"),iq.a.instance)).singleInstance();a.ha("WordEditor.Actors.ModeSwitcherControlActor",()=>new rG.a(a.za("Common.ISystemInitiatedFeedback"),
pQ.a.CZb())).as("WordEditor.IModeSwitcherControl").singleInstance();a.ha("WordEditor.Actors.PaperSizeDialogActor",()=>new RL(l.AFrameworkApplication.pa,a.te("WordEditor.UI.IDialogFactory"),iq.a.instance)).singleInstance();a.ha("WordEditor.Actors.IgnoreAllProofingErrorStrategy",()=>new JL(a.resolve("Box4.Proofing.IIgnoreAllKeywords"))).singleInstance();a.register(uL,"WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy").singleInstance();a.ha("WordEditor.Actors.ProofingActor",()=>new VL(l.AFrameworkApplication.pa,
li.a.instance,xa.a.instance.resolve("Box4.ISelectionManager"),Lu.a.instance,kg.a.instance,xa.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),xa.a.instance.resolve("Box4.ILanguageReader"),xa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),xa.a.instance.resolve("WordEditor.Actors.IgnoreAllProofingErrorStrategy"),xa.a.instance.resolve("WordEditor.Actors.DoNotCheckThisCritiqueTypeStrategy"),this.tQ,xa.a.instance.resolve("Box4.Proofing.IProofingIgnorePersistenceHelper"),
l.AFrameworkApplication.K.$("WordEditorProofingIgnoreAll"),xa.a.instance.resolve("Box4.UI.AugLoopProofingErrorDetailHelper"))).singleInstance();l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EditorSettingsIsEnabled",!1)?(l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("editorSettingsManager"):a.resolve("Common.IDynamicScriptLoaderProvider").$C.loadScript("EditorSettingsManager")).then(()=>{const c=a.resolve("Box4.Proofing.IEditorSettingsManagerActor");
c.Wyl();c.init();a.ha("Box4.Proofing.EditorSettingsUIActor",()=>new PK(l.AFrameworkApplication.pa,a.resolve("Box4.Proofing.IEditorSettingsManagerActor"),()=>new QK(a.resolve("Box4.Proofing.IEditorSettingsManagerActor"),a.resolve("WordEditor.Ideas.AddInLoader.IAddInLicensingManager")))).singleInstance();l.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&l.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Proofing.EditorSettingsUIActor").eb()}):(a.ha("Box4.Actors.GrammarSettingsActor",
()=>new RK(l.AFrameworkApplication.pa,a.resolve("Box4.Proofing.ICritiqueTypeSettings"),(c,h)=>new Pj(c,a.resolve("Box4.Proofing.IProofingConfigV2Manager"),h,nc.FocusManager.instance()),a.resolve("Box4.Proofing.IProofingConfigV2Manager"))).singleInstance(),l.AFrameworkApplication.K.$("WritingStyleIsEnabled")&&l.AFrameworkApplication.K.$("WordWritingStylesDialogIsEnabled")&&this.W.resolve("Box4.Actors.GrammarSettingsActor").eb());a.ha("WordEditor.Actors.PageActor",()=>new PL(xa.a.instance.resolve("Box4.IWordSectionEditor"),
xa.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)).as("WordEditor.IPageCommandStringBuilder").singleInstance();a.ha("WordEditor.Actors.DarkModeActor",()=>new rL(l.AFrameworkApplication.pa,l.AFrameworkApplication.K,Eb.App.Sea,!!Eb.App.instance&&Eb.App.instance.RJa,!!Eb.App.instance&&Eb.App.instance.pKc,xa.a.instance.resolve("Box4.IDarkModeState"),xa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),xa.a.instance.resolve("Box4.DarkModeEventsManager"),
!!Eb.App.instance&&Eb.App.instance.Cja)).singleInstance();a.ha("WordEditor.FlatListDetailsProvider",()=>new BL(a.resolve("WordEditor.IFlatListEditor")));a.ha("WordEditor.Actors.AccessibilityActor",()=>new aL(a.za("Box4.Accessibility.IAccessibilityContextManager"),a.te("WordEditor.FlatListDetailsProvider"),a.te("WordEditor.TrackChange.TrackChangeCpDetailsProvider"),a.te("WordEditor.TrackChange.TrackChangeStructuralDetailsProvider"))).singleInstance();a.ha("WordEditor.Actors.AppFrameCommandUIActor",
()=>new mL(l.AFrameworkApplication.pa,a.za("Postmessage.IHostPostmessenger"))).singleInstance();a.ha("WordEditor.Actors.ImageActor",()=>new Br(a.resolve("WordEditor.IImageEditor"),a.za("Box4.IExternalSelectionManager"),a.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("WordEditor.Actors.ISWordRequestManager"),a.resolve("Box4.IUndoManager"),a.resolve("Box4.IFeatureHelper"),a.resolve("Box4.ISelectionManager"),
a.resolve("Box4.IAppFrame"),l.AFrameworkApplication.K)).as("Box4.Actors.ImageActor").singleInstance();a.ha("WordEditor.Actors.WordFileSaveAsActor",()=>new iM(l.AFrameworkApplication.pa)).singleInstance();a.ha("WordEditor.Actors.RenderedImageEditOperation.Factory",()=>new $L(a.resolve("WordEditor.IImageEditor"),l.AFrameworkApplication.K,l.AFrameworkApplication.na.BJa,xa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
a.resolve("Box4.IUndoManager"),a.resolve("Box4.CatchUpActivity.IChangeIdEditor"),a.resolve("Box4.IFeatureHelper"))).singleInstance();this.W.ha("WordEditor.Actors.SWordRequestManager",()=>new eM(a.resolve("Box4.Images.IImageReader"),a.resolve("WordEditor.Actors.RenderedImageEditOperation.Factory"),l.AFrameworkApplication.K)).as("WordEditor.Actors.ISWordRequestManager").singleInstance();a.ha("WordEditor.Actors.TableCellSelectionStrategy",()=>new fM).as("Box4.ITableCellSelectionStrategy").singleInstance();
l.AFrameworkApplication.K.$("WordEditorFormatPainterIsEnabled")&&a.ha("Box4.Actors.FormatPainter",()=>new SK(a.resolve("Box4.Styles.IWACStyleEditor"),a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),li.a.instance,a.resolve("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TextFormattingHelper"),a.resolve("Box4.Styles.IWACStyleReader"))).as("Box4.IFormatPainter").singleInstance();a.ha("Box4.Actors.FormatPainterActor",()=>new pC(Eb.App.oa,nc.FocusManager.instance(),l.AFrameworkApplication.pa,Ee.a.instance,yr.a.instance,a.resolve("Box4.IFormatPainter"),a.resolve("Box4.ISelectionManager"),!0,a.resolve("Box4.ICssColorProvider"),!!Eb.App.instance&&Eb.App.instance.Cja,a.resolve("Box4.DarkModeEventsManager"))).singleInstance();
a.ha("WordEditor.Actors.FormattingActor",()=>new CL(l.AFrameworkApplication.pa,a.resolve("Box4.List.IListReader"))).singleInstance();a.ha("WordEditor.Actors.UIAutomationActor",()=>new gM(l.AFrameworkApplication.pa)).singleInstance();a.ha("WordEditor.Actors.SaveStatusActor",()=>new bM(l.AFrameworkApplication.pa,a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"))).singleInstance();a.ha("Box4.Actors.IEnterViewStrategy",()=>new TK(a.ra("Box4.IAutoCorrectScheduler"),a.te("Box4.IUndoManager"),a.za("Box4.IExternalSelectionManager"))).singleInstance();
a.ha("Box4.ISelectAllHandlers",()=>new DA(vg.PageReader.instance,a.te("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),l.AFrameworkApplication.K.$("QoETinyWinsSelectAllEnabled"))).singleInstance();a.ha("WordEditor.Actors.ContentControlActor",()=>new pL(a.resolve("Box4.Actors.InternalClipboard"),a.resolve("WordEditor.ContentControl.IContentControlManager"),a.resolve("WordEditor.ContentControl.IGlossaryNavigator"),a.resolve("Box4.IFormattingEditor"),a.resolve("WordEditor.ContentControl.IContentControlChpManager"),
a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.Styles.IWACStyleReader"),l.AFrameworkApplication.pa,l.AFrameworkApplication.K.$("WordEditorContentControlCustomizedPlaceholderIsEnabled"),kg.a.instance.J(10))).singleInstance();a.ha("WordEditor.Actors.AccessibilityHelpDialogActor",()=>new bL(l.AFrameworkApplication.pa,a.te("WordEditor.UI.IDialogFactory"),nc.FocusManager.instance())).singleInstance();a.ha("Box4.Actors.FontNameFormattingStrategyNoop",
()=>new UK).as("Box4.Actors.IFontNameFormattingStrategy").singleInstance();a.ha("WordEditor.GraphicsEditor.GraphicsEditorRequestManager",()=>new zF(l.AFrameworkApplication.fe,jn.PageNavigator.instance,a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.IBlobReader"),a.resolve("WordEditor.IImageEditor"),xa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),l.AFrameworkApplication.K,a.resolve("Box4.IFeatureHelper"))).as("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager").singleInstance();
a.ha("WordEditor.Actors.GraphicsEditorActor",()=>new HL(l.AFrameworkApplication.pa,l.AFrameworkApplication.K,a.resolve("WordEditor.GraphicsEditor.IGraphicsEditorRequestManager"),a.resolve("WordEditor.IImageEditor"),a.resolve("Box4.CatchUpActivity.IChangeIdEditor"),a.resolve("Box4.IUndoManager"),a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.IBlobReader"),a.resolve("Box4.Images.IImageReader"),l.AFrameworkApplication.fe,
this.Na,a.resolve("WordEditor.DocumentUnderstanding.RLM.IRoleLifecycleManager"))).singleInstance();a.ha("WordEditor.Actors.RenderParagraphsContainingTabs",()=>new aM).singleInstance();a.ha("WordEditor.Actors.CustomTabActor",()=>new qL(l.AFrameworkApplication.pa,a.resolve("WordEditor.ICustomTabStopUtility"),a.resolve("Box4.IOutlineEditor"))).singleInstance();a.ha("WordEditor.Actors.HeadingsActor",()=>new lM(a.resolve("WordEditor.TableOfContents.StyleBasedDocumentHeadings"),l.AFrameworkApplication.pa,
a.resolve("Box4.IParagraphReader"))).singleInstance();a.ha("WordEditor.Actors.BookmarkActor",()=>new oL(Eb.App.oa,l.AFrameworkApplication.pa,$c.a.instance,a.resolve("WordEditor.Bookmark.FullBookmarkManager"),new qf.a(()=>Eb.App.oa.Da.Zb),this.W.resolve("Box4.Indicator.IIndicatorManager"),this.W.resolve("Box4.Graph.IGraphTransactionFactory"),this.W.resolve("Common.IReactContextualUILauncher"),this.W.resolve("WordEditor.Actors.BookmarkIndicatorActor"),Lu.a.instance,this.W.za("Common.ISystemInitiatedFeedback"),
a.resolve("Box4.IOutlineElementNavigator"),ec.InteractiveViewManager.instance,this.W.te("WordEditor.UI.IDialogFactory"),this.W.resolve("Box4.BookmarkParagraphMapping"))).singleInstance();a.ha("WordEditor.Actors.BookmarkIndicatorActor",()=>new $s(a.resolve("Box4.IParagraphReader"),ah.a.instance,oi.a.instance,this.W.resolve("Box4.Highlight.IHighlightManager"),a.resolve("Box4.IInteractiveEventHandler"))).singleInstance();a.ha("Box4.Actors.IIFrameFocusStrategy",()=>new IL).singleInstance();a.ha("WordEditor.Actors.ExternalContentFloatiePositionProvider",
()=>new sC($c.a.instance,a.resolve("Box4.ITextMetricsAdapter"),ec.InteractiveViewManager.instance,Ve.a.getElementBounds,a.resolve("Box4.UI.ExternalContentFloatieManager"))).singleInstance();a.ha("WordEditor.Actors.ExternalContentActor",()=>new Yr(l.AFrameworkApplication.pa,a.resolve("Box4.IUndoManager"),l.AFrameworkApplication.K,a.resolve("Wonca.ExternalContent.IExternalContentEditor"))).as("WordEditor.Actors.ExternalContentActor").singleInstance();a.ha("Box4.UI.ExternalContentFloatieManager",()=>
new $K).as("Box4.UI.IFloatieManager").singleInstance();a.ha("WordEditor.Actors.ActionHangDetector",()=>new cL(l.AFrameworkApplication.K,l.AFrameworkApplication.pa)).as("WordEditor.Actors.ActionHangDetector").singleInstance();a.ha("WordEditor.Actors.ExternalContentFloatieEventManager",()=>new rC(a.resolve("Box4.UI.ExternalContentFloatieManager"),a.resolve("Box4.IExternalContentFloatieEventSource"),ec.InteractiveViewManager.instance,jj.a.instance(),l.AFrameworkApplication.na,a.resolve("WordEditor.Actors.ExternalContentFloatiePositionProvider"),
a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.PasteFloatieFeatureSetBuilder"),Eb.App.aj.Pk.Yd(12),a.resolve("Box4.Graph.IGraphTransactionManager"))).singleInstance();a.ha("Box4.Actors.WordIndentationActorExtension",()=>new jM).as("Box4.Actors.IIndentationActorExtension").singleInstance();l.AFrameworkApplication.K.$("SharedUXThemingIsEnabled")&&(l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordModernUxExperimentOneSettings"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ModernUxExperimentOne",
!1)&&a.ha("WordEditor.Actors.ModernUxActor",()=>new sH(l.AFrameworkApplication.pa)).singleInstance());l.AFrameworkApplication.K.$("WordConsumptionViewToEditRedirectIsEnabled")&&a.ha("WordEditor.Actors.SwitchToClassicViewModeActor",()=>new MF(l.AFrameworkApplication.pa)).singleInstance();(new GK).yb(a);a.ha("WordEditor.OnlineMedia.OnlineMediaDialogFactory",()=>new ZK(a.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),a.resolve("Box4.Media.InsertMediaHelper"))).as("WordEditor.OnlineMedia.OnlineMediaDialogFactory").singleInstance();
a.ha("WordEditor.OnlineMedia.InsertHubbleMediaHelper",()=>new WK(l.AFrameworkApplication.pa,a.resolve("Box4.Media.InsertMediaHelper"))).singleInstance();a.ha("WordEditor.OnlineMedia.OnlineMediaActor",()=>new XK(l.AFrameworkApplication.pa,l.AFrameworkApplication.K,a.resolve("WordEditor.OnlineMedia.OnlineMediaDialogFactory"),a.resolve("WordEditor.OnlineMedia.InsertHubbleMediaHelper"),a.resolve("Wonca.ExternalContent.IExternalContentEditor"))).singleInstance();this.a9i=new kM;this.E2=this.W.resolve("Box4.Highlight.IHighlightManager")}static main(){M.a.instance.Lb(new wH)}}
Object(w.a)(wH,"WordEditorActorsPackage",null,[1,2]);class mM{constructor(a){this.glc=!1;this.Ru=a;this.Ru.BTb(Object(m.a)(this,this.Eai,"onGraphFullyConnected"))}Eai(){this.glc=!0;this.Ru.KKf(Object(m.a)(this,this.Eai,"onGraphFullyConnected"))}}Object(w.a)(mM,"GraphFullyConnectedGetter",null,[555]);class Gf{constructor(){this.Xsg=Object.assign(new em.a,{})}PCj(a,c){let h;const v=a&1023;({value:h}=this.Xsg.Ab(v,0)).returnValue||Gf.Nml().contains(v)||r.ULS.sendTraceTag(50942149,338,15,"Culture is not supported. LCID {0}; Key: {1}",
a,v);h+=c;this.Xsg.Z(v,h);return h}static Nml(){Gf.jhd||(Gf.jhd=new va.a,Gf.rb(0),Gf.rb(1),Gf.rb(2),Gf.rb(3),Gf.rb(4),Gf.rb(5),Gf.rb(6),Gf.rb(7),Gf.rb(8),Gf.rb(9),Gf.rb(10),Gf.rb(11),Gf.rb(12),Gf.rb(13),Gf.rb(14),Gf.rb(15),Gf.rb(16),Gf.rb(17),Gf.rb(18),Gf.rb(19),Gf.rb(20),Gf.rb(21),Gf.rb(22),Gf.rb(23),Gf.rb(24),Gf.rb(25),Gf.rb(26),Gf.rb(27),Gf.rb(28),Gf.rb(29),Gf.rb(30),Gf.rb(31),Gf.rb(32),Gf.rb(33),Gf.rb(34),Gf.rb(35),Gf.rb(36),Gf.rb(37),Gf.rb(38),Gf.rb(39),Gf.rb(40),Gf.rb(41),Gf.rb(42),Gf.rb(43),
Gf.rb(44),Gf.rb(45),Gf.rb(46),Gf.rb(47),Gf.rb(48),Gf.rb(49),Gf.rb(50),Gf.rb(51),Gf.rb(52),Gf.rb(53),Gf.rb(54),Gf.rb(55),Gf.rb(56),Gf.rb(57),Gf.rb(58),Gf.rb(59),Gf.rb(60),Gf.rb(61),Gf.rb(62),Gf.rb(63),Gf.rb(64),Gf.rb(65),Gf.rb(66),Gf.rb(67),Gf.rb(68),Gf.rb(69),Gf.rb(70),Gf.rb(71),Gf.rb(72),Gf.rb(73),Gf.rb(74),Gf.rb(75),Gf.rb(76),Gf.rb(77),Gf.rb(78),Gf.rb(79),Gf.rb(80),Gf.rb(81),Gf.rb(82),Gf.rb(83),Gf.rb(84),Gf.rb(85),Gf.rb(86),Gf.rb(87),Gf.rb(88),Gf.rb(89),Gf.rb(90),Gf.rb(91),Gf.rb(92),Gf.rb(93),Gf.rb(94),
Gf.rb(95),Gf.rb(96),Gf.rb(97),Gf.rb(98),Gf.rb(99),Gf.rb(100),Gf.rb(101),Gf.rb(102),Gf.rb(103),Gf.rb(104),Gf.rb(105),Gf.rb(106),Gf.rb(107),Gf.rb(108),Gf.rb(109),Gf.rb(110),Gf.rb(111),Gf.rb(112),Gf.rb(113),Gf.rb(114),Gf.rb(115),Gf.rb(116),Gf.rb(117),Gf.rb(118),Gf.rb(119),Gf.rb(120),Gf.rb(121),Gf.rb(122),Gf.rb(124),Gf.rb(126),Gf.rb(127),Gf.rb(128),Gf.rb(129),Gf.rb(130),Gf.rb(131),Gf.rb(132),Gf.rb(133),Gf.rb(134),Gf.rb(135),Gf.rb(136),Gf.rb(140),Gf.rb(145),Gf.rb(146),Gf.rb(147));return Gf.jhd}static rb(a){Gf.jhd.add(a&
1023)}}Gf.jhd=null;Object(w.a)(Gf,"LanguagePerParagraphModel",null,[]);class nM{constructor(){this.RSf=!1;this.Pod=this.Ood=this.tJb=0;this.XXh=!0;this.wZn=0}}Object(w.a)(nM,"UpdateWordCountStateResult",null,[]);class oM extends Sys.EventArgs{constructor(a){super();this.isEnabled=a}}Object(w.a)(oM,"WordCountAvailabilityChangedEventArg",Sys.EventArgs,[]);class pM{constructor(){this.N0g=this.M0g=this.wordCount=-1;this.uvb=this.sXg=0;this.tvb=1;this.kgi=1033}}Object(w.a)(pM,"WordCountCache",null,[]);
class qM extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(w.a)(qM,"WordCountChangedEventArg",Sys.EventArgs,[]);class rM{constructor(){this.Idc=this.Owa=0}}Object(w.a)(rM,"CharsCountResult",null,[]);class sM{constructor(){this.cp=0;this.Kdc=null;this.w3=this.x3=0}}Object(w.a)(sM,"TextChunkResult",null,[]);class tM{constructor(){this.tZi=this.x3=this.w3=this.wordCount=0}}Object(w.a)(tM,"WordCountStateForParagraph",null,[]);class xH{constructor(){this.Dla=this.AO=this.x3=this.w3=this.mY=
this.wordCount=0;this.currentNode=null;this.xU=-1;this.cp=0;this.iDf=[];this.tvb=this.uvb=this.nTa=this.cDf=this.dDf=0;this.tH=this.wSh=!1;this.Ijb=new Ua.a;this.kYa=new Ua.a}}Object(w.a)(xH,"WordCountState",null,[]);class aq{constructor(a,c,h,v,B,X){this.jwn=1E3;this.ma=new Rd.a;this.vrb=null;this.fae=0;this.Iej="\ue000";this.bic=!1;this.wfe=this.lfe=this.h4c=0;this.aeg=this.jeg=null;this.hfe=this.gfe=this.qfe=0;this.Fz=c;this.Zcj=new RegExp(Fb.AParagraphNode.Vz,"g");this.Yb=a;this.taskManager=v;
this.im=h;this.DSa=X;this.bQa=B.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.Jtj=B.$("WordEditorWordCountPackageSelectionAdditionalCountsIsEnabled");this.iui()}get uVl(){return!!this.vrb}get ZHa(){return this.bic}set ZHa(a){this.bic=a}get tkd(){return this.fae}set tkd(a){this.fae=a}get FKa(){return!this.fae}get iI(){return this.h4c}get vub(){return this.lfe}get Aub(){return this.wfe}get qok(){return this.jeg}get zVe(){return this.aeg}get HVe(){return this.qfe}get rVe(){return this.gfe}get nsd(){return this.hfe}BTb(a){this.ma.addHandler(aq.s8d,
a)}KKf(a){this.ma.removeHandler(aq.s8d,a)}OIe(a){this.ma.addHandler(aq.B2f,a)}UYm(a){this.ma.removeHandler(aq.B2f,a)}gtd(){this.ftd();this.iui()}iui(){this.qfe=this.hfe=this.gfe=this.wfe=this.lfe=this.h4c=-1}LWe(){this.s3d(this.jwn)}kVf(){const a=new xH;a.wSh=!0;this.ftd();this.NYe(a)}s3d(a,c=null){this.FKa&&(this.uVl&&(c=null,this.ftd()),c||(c=new xH),a=new Se.a(3,1,a,Object(m.a)(this,this.oxk,"doWordCountTask"),this.wNi),a.customData=c,this.TGj(a))}ftd(){this.vrb&&(this.taskManager.me(this.vrb),
this.vrb=null)}DWi(a,c,h,v,B,X=!0,ma=-1,Pa=-1,mb=-1,Tb=1033){const rc=new nM;rc.tJb=h;rc.Ood=B;rc.Pod=v;if(!a.cp&&c.P_c&&X&&!this.zBh(c))return aq.oSn(a,c.P_c),rc.XXh=!0,rc;v=0<=Pa&&0<=mb?{Mc:Pa,endCp:mb}:void 0;h=this.NQk(c,v);v&&(Pa=v.Mc,mb=v.endCp);h=0<=mb?h.substring(0,mb):h;mb=0<=Pa&&0<=mb?h.substring(Pa,mb):h;v=a.cp>=Pa?a.cp:Pa;B=a.iDf||[];X=0<a.dDf?a.dDf:0;let Tc=0<a.cDf?a.cDf:0,vd=[];a.tH=!1;do{this.DSa.update();if(!a.wSh&&(rc.tJb+vd.length/2>aq.LWn||this.DSa.seb())){let Xe;B=(Xe=B).concat.apply(Xe,
vd);a.cp=v;a.iDf=B;a.cDf=Tc;a.dDf=X;a.xU=ma;a.currentNode=c;this.s3d(aq.XZn,a);rc.RSf=!0;a.tH=!0;return rc}if((!v||v===Pa)&&0<h.length&&v<h.length){B.push(Zo.a.instance.Oaf(h,v));var ee=this.zBh(c);if(0<=ma&&!v&&ee){a.wordCount+=1;rc.tJb+=1;const Xe=this.Yb.qO(ee);ee=this.Fz.c6b(Xe,ee);ee=aq.mrd(ee);a.x3+=ee.Owa+1;a.w3+=ee.Owa-ee.Idc}}ee=this.MFh(h,v,aq.z5j);v=ee.cp;let Ie;vd=(Ie=vd).concat.apply(Ie,ee.Kdc);X+=ee.x3;Tc+=ee.w3}while(-1!==v);a=this.VAj(a,B,vd,h,mb,rc.tJb,rc.Ood,rc.Pod,c,-1===ma,Tb);
rc.tJb=a.wordCount;rc.Ood=a.w3;rc.Pod=a.x3;rc.wZn=a.tZi;return rc}Qeh(a,c){const h=sd.ParagraphReader.textLength(c,1);if(h){c=ac.e(c);var v=0;for(let B=0;B<c.length;B++)if(this.Qbb&&5===c[B].nh&&a.AO++,aq.mmn(c[B])){v++;break}c.length!==h?a.mY++:a.mY+=v}}FFi(a){this.tkd=this.Kmn(a.nTa,a.wordCount)?1:0;return!!this.tkd}eei(a){this.h4c=a.wordCount;this.lfe=a.AO;this.wfe=a.Dla;this.hfe=a.x3;this.gfe=a.w3;this.qfe=a.mY;this.jeg=a.Ijb;this.aeg=a.kYa;this.Dmi(a)}Dmi(a){this.ma.raiseEvent(aq.s8d,new qM(a))}Cmi(){this.ma.raiseEvent(aq.B2f,
new oM(!1))}Kmn(a,c){if(H.a.Gi||H.a.so||H.a.CF)return!1;(c/=2)||(c=1);return(c?a/c:0)>aq.Yam?!0:!1}get Qbb(){const a=!this.grf||1===this.grf&&this.Jtj;return this.bQa&&a}tyh(a,c){let h=1033,v=0;a=c.B8e(a);c=new Gf;for(let B=0;B<a.length;B++){const X=c.PCj(a[B].lcid,a[B].end-a[B].begin);v<X&&(v=X,h=a[B].lcid)}return h}oxk(a){this.vrb=null;this.NYe(a.customData)}VAj(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){var Tc;c=(Tc=c).concat.apply(Tc,h);h=Zo.a.instance.NFh(c,v);a.wordCount+=h.wordCount;B=aq.mrd(B);Tc=B.Owa-
B.Idc;const vd=B.Owa;a.w3+=Tc;a.x3+=vd;X+=h.wordCount;ma+=B.Owa-B.Idc;Pa+=B.Owa;a.nTa+=h.nTa;let ee,Ie;({Syk:ee,UEn:Ie}=aq.UAj(c,v,ee,Ie));a.uvb+=ee;a.tvb+=Ie;a.kYa.add(rc);a.Ijb.add(h.wordCount);Tb&&aq.MZj(vd,Tc,mb,h,ee,Ie,rc);a.cp=0;a.iDf=[];a=new tM;a.w3=ma;a.x3=Pa;a.wordCount=X;a.tZi=h.wordCount;return a}NQk(a,c){let h=this.F_m(a);Eb.App.oNa&&(h=sd.ParagraphReader.$vb(a,1,h,c));return this.ZVm(h)}F_m(a){var c=sd.ParagraphReader.text(a);a=ac.e(a);if(0<a.length){c=c.split("");for(let v=0;v<a.length;++v){let B=
!0;var h=!0;const X=a[v];if(1===X.nh)h=X,h=22!==h.kind&&2!==h.kind;else if(5===X.nh)B=!1;else if(7===X.nh||10===X.nh)c[X.Xa.cp]=this.Iej,B=!1;if(B){if(X.Xa.cp>=c.length)return"";c[X.Xa.cp]=h?" ":"C"}}c=c.join("")}return c}ZVm(a){return a.replace(this.Zcj,"")}MFh(a,c,h){const v=a.length-c<=h;var B=v?a.length:c+h;const X=new sM;if(B<c)return X.cp=-1,X;X.Kdc=Zo.a.instance.A5e(a,c,B);B=aq.mrd(a.substr(c,B));X.x3=B.Owa;X.w3=B.Owa-B.Idc;if(!X.Kdc.length&&!v)return h===a.length-c?X:this.MFh(a,c,a.length-
c);X.cp=v||!X.Kdc.length?-1:X.Kdc[X.Kdc.length-1].cp;return X}TGj(a){this.vrb=a;this.taskManager.ub(this.vrb)}zBh(a){if(a=a.kpa){const c=this.Yb.qO(a);if(c&&c.nq)return a}return null}static mmn(a){return 11===a.nh}static oSn(a,c){a.wordCount+=c.wordCount;a.w3+=c.M0g;a.x3+=c.N0g;a.nTa+=c.sXg;a.uvb+=c.uvb;a.tvb+=c.tvb;a.kYa.add(c.kgi);a.Ijb.add(c.wordCount)}static MZj(a,c,h,v,B,X,ma){const Pa=new pM;Pa.wordCount=v.wordCount;Pa.N0g=a;Pa.M0g=c;Pa.sXg=v.nTa;Pa.uvb=B;Pa.tvb=X;Pa.kgi=ma;h.P_c=Pa}static mrd(a){const c=
a.length,h=new rM;for(let B=0;B<c;B++){var v=a.charCodeAt(B);h.Owa++;if(55296<=v&&56319>=v&&(v=B+1<c?a.charCodeAt(B+1):0,56320<=v&&57343>=v)){B++;continue}F.a.d9(a.charAt(B))&&h.Idc++}return h}static UAj(a,c,h,v){h=v=0;for(let B=0;B<a.length;++B){const X=a[B],ma=X.fJ;(3===ma||2===ma)&&X.cp<c.length&&(++v,F.a.o2b(c.charCodeAt(X.cp))&&++h)}return{Syk:h,UEn:v}}}aq.s8d="wctek";aq.B2f="wcac";aq.XZn=1;aq.z5j=400;aq.LWn=90;aq.Yam=.1;Object(w.a)(aq,"WordCountManagerBase",null,[561]);class uM extends aq{constructor(a,
c,h,v,B,X,ma,Pa,mb,Tb,rc){super(a,c,h,B,mb,Tb);this.Snh=this.yhd=this.Dga=null;this.ya=v;this.fc=ma;this.VHg=Pa;this.gG=rc;this.ya.aC(Object(m.a)(this,this.oka,"onProcessSetSelectionFinished"));this.Boe=mb.$("ReadingTimeIsEnabled")}get wNi(){return 66}xBl(){if(this.Dga)return!0;if(!this.ya||!this.ya.Ca)return this.fc&&(Eb.App.OHd||l.AFrameworkApplication.Qj?this.fc.ib("SelectionWordCountSelectionNullWhenAppExiting",{["Reason"]:"SelectionWordCount triggerred when app is exiting"}):this.fc.ib("SelectionWordCountSelectionNullWhenAppAlive")),
!1;const a=this.ya.Ca.clone();this.Dga=a.aO(!0);if(!this.Dga||!this.Dga.rx())return this.ftd(),!1;this.VHg&&(this.yhd=this.VHg.create(c=>a.aO(c),this.im));this.Dga.moveNext();return!0}get grf(){return 1}edk(a){return a===ic.a.xc||a===ic.a.paragraph?!0:this.Qbb&&(a===ic.a.gwb||a===ic.a.image||a===ic.a.anchoredObject)}NYe(a){this.DSa.reset();if(this.xBl()){for(this.Qbb&&this.yhd&&(this.yhd.jxk(a,this.DSa)||this.s3d(1,a));this.Dga.current;){const v=-1===a.xU?0:a.xU;let B=0;var c=this.Dga.current;if(!this.edk(c.contextId)){this.Dga.moveNext();
continue}if(this.Qbb&&dd.ImageReader.wcb(c)){a.AO++;this.Dga.moveNext();continue}if(!sd.ParagraphReader.tb(c.node)){this.Dga.moveNext();continue}const X=c.node;if(this.ZHa&&this.Snh&&this.Snh.OZb(X))this.Dga.moveNext();else{if(this.Qbb&&c.Nc){var h=Kd.GraphIterator.va(X);for(h.Za(6);!h.jq;)dd.ImageReader.ix(h.currentNode)&&a.AO++,h.Fh(6)}h=this.Boe?this.tyh(X,this.gG):1033;c=this.DWi(a,X,0,0,0,this.IId(c),v,c.cpBegin,c.cpEnd,h);if(c.XXh&&(B+=1,100<B)){a.xU=v+1;this.s3d(1,a);return}if(c.RSf)return;
this.Qeh(a,X);this.Dga.moveNext()}}this.yhd=this.Dga=null;this.FFi(a)?(this.h4c=-1,this.Cmi()):this.eei(a)}}oka(){this.LWe()}IId(a){let c=!1;a.contextId===ic.a.paragraph?c=!0:a.contextId===ic.a.xc&&(c=a.cpEnd-a.cpBegin===a.node.characterData.length);return c}}Object(w.a)(uM,"SelectionWordCountManager",aq,[]);class OF{constructor(a,c){this.RNb=!1;this.Kqb=null;a&&c&&(this.NRb=a(!1),this.Vb=c,this.NRb.moveNext())}jxk(a,c){if(!a||!this.NRb||!this.NRb.current)return!0;do{const h=this.NRb.current;if(h.contextId===
ic.a.tableRow||h.contextId===ic.a.tableCell){for(this.Kqb||this.GBl(h.node);this.Kqb.moveNext();)if(14===this.Kqb.currentNode.type&&a.Dla++,c.update(),c.seb())return!1;this.pfk(h,a);this.Kqb=null}this.NRb.moveNext()}while(this.NRb.current);return!0}pfk(a,c){const h=this.Vb.ff(a.node);h.La(14);a.contextId===ic.a.tableRow&&($m.a.lSh(h)&&(this.RNb=!0),$m.a.eJd(h)&&this.RNb&&(this.RNb=!1,c.Dla++));a.contextId===ic.a.tableCell&&(Tf.TableCellReader.TIc(h)&&(this.RNb=!0),Tf.TableCellReader.jKa(h)&&this.RNb&&
(this.RNb=!1,c.Dla++))}GBl(a){this.Kqb=Tl.a.zn(a);14===a.type?this.Kqb.Fl(OF.yBc,a):this.Kqb.Fl(OF.yBc,null)}static yBc(a){return a.parentNode?!0:!1}}Object(w.a)(OF,"TableCountSelectionTraverser",null,[562]);class vM{constructor(a){this.bQa=a.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}create(a,c){return this.bQa?new OF(a,c):null}}Object(w.a)(vM,"TableCountSelectionTraverserFactory",null,[554]);class wM extends aq{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){super(a,c,h,B,mb,Tb);this.ga=
v;this.Kpj=X;this.lyj=ma;this.Ldg=Pa;this.gG=rc;this.ga.Aa(ba.a.rZi,ic.a.application,Le.ActionManager.De,64);this.ga.Aa(ba.a.sZi,ic.a.application,Le.ActionManager.De,64);this.Boe=mb.$("ReadingTimeIsEnabled")}get wNi(){return 63}get grf(){return 0}NYe(a){this.DSa.reset();a.tH=!1;var c=this.Kpj();vg.PageReader.instance.Ucb(c)||(this.gtd(),this.Cmi());c=this.im.xya(c,7,7).currentNode;var h=this.Wik(a.currentNode,c);c=this.lyj(h,c);c.Fl(Object(m.a)(this,this.NWn,"wordCountFilter"),null);let v=h=0;for(var B=
0;c.moveNext();)if(c.currentNode&&this.Yb.V8(c.currentNode)){var X=this.Yb.qO(c.currentNode);if(X.nq){var ma=this.Yb.VVa(c.currentNode);if(ma&&(ma=ma.la.last,S.App.oNa&&ma&&ma.Vg&&ma.eh))continue;a.wordCount+=1;if(X=this.Fz.c6b(X,c.currentNode))X=aq.mrd(X),a.x3+=X.Owa+1,a.w3+=X.Owa-X.Idc;h+=1;v+=a.x3;B+=a.w3}}else if(this.Qbb&&c.currentNode&&dd.ImageReader.ix(c.currentNode))a.AO++;else if(this.Qbb&&c.currentNode&&Wf.TableReader.gV(c.currentNode))a.Dla++;else if(c.currentNode&&sd.ParagraphReader.tb(c.currentNode)){X=
c.currentNode;ma=this.Boe?this.tyh(X,this.gG):1033;B=this.DWi(a,X,h,v,B,!0,-1,-1,-1,ma);if(B.RSf){a.tH=!0;l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorWordCountPackageImageAndTableCountSettings");return}this.Qeh(a,X);h=B.tJb;v=B.Pod;B=B.Ood}this.FFi(a)?(this.gtd(),this.t0m(),this.Dmi(a)):this.eei(a)}Wik(a,c){a?(a=this.Ldg(a),a.La(7)):a=this.Ldg(c);return a}NWn(a){if(a.jq)return!0;a=a.role;return 1===a||2===a||this.Qbb&&6===a||3===a||4===a||5===a||!this.ZHa&&(7===
a||8===a)}t0m(){switch(this.tkd){case 1:this.ga.processAction(ba.a.rZi,2);break;case 2:this.ga.processAction(ba.a.sZi,2)}}}Object(w.a)(wM,"TotalWordCountManager",aq,[]);class xM{constructor(a,c,h,v,B,X,ma,Pa,mb){this.YE=null;this.Sjc=this.bic=this.PNb=this.Hpe=!1;this.dnc=new Map;this.$Nb=!1;this.E$d=-1;this.SPl=()=>!!performance&&!!performance.mark&&!!performance.measure;this.Nee=ma;this.Oee=X;this.Ru=a;this.Z6=c;this.zqb=h;this.ewj=B;this.Z6.OIe(Object(m.a)(this,this.W6b,"onWordCountAvailabilityChanged"));
this.Ru.OIe(Object(m.a)(this,this.W6b,"onWordCountAvailabilityChanged"));this.Z6.BTb(Object(m.a)(this,this.rka,"onWordCountChanged"));this.Ru.BTb(Object(m.a)(this,this.rka,"onWordCountChanged"));this.ZHa=v;this.bQa=mb.$("WordEditorWordCountPackageImageAndTableCountIsEnabled");this.$Nb=mb.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordCountPerfTelemetry",!1)&&this.SPl()}get yWe(){return!H.a.G0}W6b(){this.B7d()}rka(){this.B7d()}eb(){const a=l.AFrameworkApplication.pa;a.ka(ba.a.q5d,ic.a.application,
Object(m.a)(this,this.q5d,"toggleAccurateWordCountEnabled"));a.ka(ba.a.Jac,ic.a.view,Object(m.a)(this,this.Jac,"showWordCountDialog"));a.Aa(ba.a.BRc,ic.a.application,Object(m.a)(this,this.BRc,"queryWordCountFeatureStatus"),96);a.Aa(ba.a.NQc,ic.a.application,Object(m.a)(this,this.NQc,"queryAccurateWordCount"),96);a.Aa(ba.a.uHf,ic.a.application,Object(m.a)(this,this.uHf,"queryWordCountSplitButton"),96)}get ZHa(){return this.bic}set ZHa(a){this.bic=a;this.Ru.ZHa=a;this.Z6.ZHa=a}uHf(){return this.Ru.FKa?
32:8}GAk(){this.Ru.FKa&&(this.uEi(!0),this.B7d(),this.Ru.kVf())}e_k(){return this.Nee("WACWordCountEnabled",this.yWe)}X_d(a){this.Oee("WACWordCountEnabled",a?"true":"false",cb.a.fLa)}get Umf(){this.PNb||(this.Hpe=this.e_k(),this.PNb=!0);return this.Hpe}uEi(a){this.X_d(a);this.Hpe=a;this.PNb=!0}Yuk(){this.Ru.gtd();this.Z6.gtd();this.uEi(!1);this.B7d()}BRc(a,c,h,v,B){if(1===h)return this.Ru.FKa?32:8;B[Uf.a.On]=this.Umf;return 32}q5d(a,c,h){if(1===h)return this.Ru.FKa?32:8;this.Umf?this.Yuk():this.GAk();
Eb.App.oa.xE({ShowWordCount:"CheckboxModel"});return 32}Jac(a,c,h){if(1===h)return Eb.App.mtb(c)?8:this.Ru.FKa?32:8;a=null;this.$Nb&&(a=performance.mark("SWCD_start"));l.AFrameworkApplication.pa.processAction(ba.a.ESd,2);this.$Nb&&(performance.mark("SWCD_end"),this.yVf(a,"SWCD"));return 32}get xB(){return this.YE||(this.YE=this.zqb())}B7d(){this.Sjc||(r.ULS.sendTraceTag(23188304,338,50,"Word count document stats: {0}",this.mnk()),this.Sjc=!0);this.xB&&this.xB.JM(this.ewj)}mnk(){const a={["words"]:this.Ru.iI,
["charsWithSpaces"]:this.Ru.nsd,["charsWithNoSpaces"]:this.Ru.rVe,["paragraphs"]:this.Ru.HVe};this.bQa&&(a.images=this.Ru.vub,a.tables=this.Ru.Aub);return a}NQc(a,c,h,v,B){B||r.ULS.sendTraceTag(23652428,338,10,String.format("{0}","actionData is null"));if(1===h)return 32;if(!this.Ru.FKa)return B[Jj.a.Visible]=!1,32;B[Jj.a.Visible]=!0;this.Umf?(a=null,this.$Nb&&(a=performance.mark("QAWC_start")),c=this.Ru.iI,0>c?c=WordEditorIntl.WordEditorStrings.l_WordCountCalculating:c?(h=this.Z6?this.Z6.iI:-1,c=
0<h?this.vfl(c,h):String.format(1===c?WordEditorIntl.WordEditorStrings.l_WordCountResultSingularAccurate:WordEditorIntl.WordEditorStrings.l_WordCountResultAccurate,this.SZd(c))):c=String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultExact,this.SZd(c)),this.$Nb&&(performance.mark("QAWC_end"),this.yVf(a,"QAWC"))):c=WordEditorIntl.WordEditorStrings.l_WordCountHidden;B[Jj.a.LabelText]=c;return 32}SZd(a){try{if(this.$Nb){const c=performance.mark("STLS_start"),h=a.toLocaleString();performance.mark("STLS_end");
this.yVf(c,"STLS");return h}return a.toLocaleString()}catch(c){r.ULS.sendTraceTag(23652430,338,10,String.format("Error converting count to locale string, error: {1}, stacktrace: {2}",c.toString(),c.stack))}return a.toString()}yVf(a,c){null!==a&&null!==this.dnc&&(a=performance.measure(`${c}_${a.startTime.toFixed(0)}`,c+"_start",c+"_end"),this.dnc.set(a.name,a.duration),50<=this.dnc.size&&-1==this.E$d&&(this.E$d=window.requestAnimationFrame(()=>this.ASn())))}ASn(){let a={};this.dnc.forEach((c,h)=>{h=
h.split("_");2<=h.length&&(h=h[0],a[h]||(a[h]=[]),a[h].push(c.toFixed(2)))});r.ULS.sendTraceTag(523765402,345,50,JSON.stringify(a));this.dnc.clear();this.E$d=-1}vfl(a,c){c>a&&(r.ULS.sendTraceTag(23652432,338,10,String.format("Selection word count is greater than total word count.")),c=a);return String.format(WordEditorIntl.WordEditorStrings.l_WordCountResultOnSelectionAccurate,this.SZd(c),this.SZd(a))}}Object(w.a)(xM,"WordCountActor",null,[]);class yM extends zr.a{constructor(a,c,h,v){super();this.B2=
a;this.Ru=c;this.Ep=h;this.bQa=v.$("WordEditorWordCountPackageImageAndTableCountIsEnabled")}nz(){var a=this.Ep.Yd(12);a.Yl(Object(m.a)(this,this.Z0,"onParagraphPropertyChanged"));a.Yo(Object(m.a)(this,this.Pbi,"onParagraphConnectOrDisconnect"));a.Mt(Object(m.a)(this,this.Pbi,"onParagraphConnectOrDisconnect"));a=this.Ep.Yd(22);a.Yl(Object(m.a)(this,this.lqm,"onNumberListPropertyChanged"));a.Yo(Object(m.a)(this,this.SQd,"onElementConnectedOrDisconnected"));a.Mt(Object(m.a)(this,this.SQd,"onElementConnectedOrDisconnected"));
this.bQa&&this.VSm();this.B2.Usa(this,7)}VSm(){var a=[19,14];for(let c of a)a=this.Ep.Yd(c),a.Yo(Object(m.a)(this,this.SQd,"onElementConnectedOrDisconnected")),a.Mt(Object(m.a)(this,this.SQd,"onElementConnectedOrDisconnected"))}get index(){return 1}run(){this.Ru.LWe()}Z0(a,c){if(c.property===Ed.a.Pl||c.property===Ed.a.mm)a=c.node,c=S.App.Hk.Da.Jb,c.jr&&c.sc&&c.sc.Mb&&a.Mb&&a.Mb.id===c.sc.Mb.id&&this.lih(a)}Pbi(a,c){this.lih(c.node)}lih(a){a.P_c=null;this.gY()}lqm(a,c){c.property!==Uc.a.$t&&c.property!==
Yb.a.Fq||this.gY()}SQd(){this.gY()}}Object(w.a)(yM,"WordCountAppEventCoordinator",zr.a,[]);class yH{}yH.WAj="AccurateWordCountButton";Object(w.a)(yH,"WordCountConstants",null,[]);class zM{constructor(a,c){this.Ru=a;this.Z6=c}getInstance(a){switch(a){case 1:return this.Z6;case 0:return this.Ru;default:return this.Ru}}}Object(w.a)(zM,"WordCountManagerFactory",null,[308]);class zH{constructor(){this.W=null}get name(){return"WordEditor.WordCount"}yb(a){this.W=a;const c=this.W.resolve("Common.IAppSettingsManager");
this.W.ha("WordEditor.WordCount.ITableCountSelectionTraverserFactory",()=>new vM(c)).singleInstance();this.W.ha("WordEditor.WordCount.IWordCountManagerFactory",()=>{var h=new Mj(10,Ve.a.ie);const v=new wM(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IListMarkerUtility"),new gl.a,l.AFrameworkApplication.pa,l.AFrameworkApplication.Cb,()=>S.App.Hk.Da.Jb.sc,Tl.a.eq,Kd.GraphIterator.va,c,h,xa.a.instance.resolve("Box4.ILanguageReader"));h=new uM(xa.a.instance.resolve("Box4.List.IListReader"),xa.a.instance.resolve("Box4.IListMarkerUtility"),
new gl.a,$c.a.instance,l.AFrameworkApplication.Cb,iy.a.instance,Ee.a.instance,xa.a.instance.resolve("WordEditor.WordCount.ITableCountSelectionTraverserFactory"),c,h,xa.a.instance.resolve("Box4.ILanguageReader"));return new zM(v,h)}).singleInstance();this.W.ha("WordEditor.WordCount.GraphFullyConnectedGetter",()=>new mM(this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0))).as("WordEditor.IGraphFullyConnectedGetter").singleInstance()}init(){const a=Eb.App.oa.Da;a.Qqa?this.Eea():
a.lba(()=>{this.Eea()})}Eea(){if(Eb.App.aj){var a=Eb.App.aj.Pk;if(a){this.W.resolve("WordEditor.IGraphFullyConnectedGetter");var c=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(0),h=this.W.resolve("WordEditor.WordCount.IWordCountManagerFactory").getInstance(1),v=xa.a.instance.resolve("Common.IAppSettingsManager");(new xM(c,h,()=>xa.a.instance.ra("WordEditor.IStatusBarUser"),this.mZk(),yH.WAj,cb.a.dNa,cb.a.Bia,xa.a.instance.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),
v)).eb();(new yM(Wo.GraphTransactionManager.instance,c,a,v)).nz();c.LWe()}else r.ULS.sendTraceTag(22425994,306,10,"Graph is null. Word Count will not be available")}else r.ULS.sendTraceTag(23967264,306,15,"TheNotebookManager is null. Word Count will not be available")}mZk(){var a=S.App.Hk.Da;if(!a)return r.ULS.sendTraceTag(22611550,324,10,""),!1;a=a.Jb;if(!a)return r.ULS.sendTraceTag(22611552,324,10,""),!1;a=a.sc;return a?a.ia(Yb.a.ZHa,!1):(r.ULS.sendTraceTag(22611554,324,10,""),!1)}dispose(){}static main(){M.a.instance.Lb(new zH)}}
Object(w.a)(zH,"PackageManager",null,[1,2]);var qQ=b(1798);class AM{constructor(a){this.Fze=null;a.za("Common.App.SearchCommon.SearchHostRuntime").execute(c=>{this.Fze=c})}XAi(a){this.Fze&&this.Fze.c8e().handleDocumentContentAugloopAnnotation(a)}}Object(w.a)(AM,"DocumentContentExtractionManager",null,[501]);class eh{}eh.gun="mso_smartLookup";eh.channelId="SmartLookup";eh.fun="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";eh.xJi="https://uci.edog.cdn.office.net/mirrored/smartlookup/";
eh.yJi="https://uci.cdn.office.net/mirrored/smartlookup/";eh.eun="https://hedwigtestserver.blob.core.windows.net/builds/";eh.dun="http://localhost:8080/";eh.PWc="current";eh.wJi="next";eh.Kxm=2;eh.m7b=1;eh.yfb=CommonUIStrings.L_SmartLookupPaneTitle;eh.Iw="InsightsTaskPane";eh.fXf="InsightsTaskPaneData";eh.kef="InsightsContentFrame";eh.width=400;eh.zdm="ApplicationPropertiesRequest";eh.Mdm="SelectionRequest";eh.Gdm="PageRendered";eh.ydm="ApplicationProperties";eh.Ldm="Selection";eh.Odm="Telemetry";
eh.Ndm="TakeFocus";eh.Fdm="LostFocus";eh.Cdm="Keyboard";eh.Ddm="LegalAgreed";eh.uZn="WordWac";eh.Oum="OneNoteWAC";eh.ICf="yes";eh.DNi="appCorrelationId";eh.TBn="clientCorrelationId";eh.ENi="message";eh.d_h="Microsoft::Office::Insights::LegalAgreed";Object(w.a)(eh,"InsightsConstants",null,[]);var vE=b(1436);class qD{}Object(w.a)(qD,"ActivityContractInfo",null,[]);class Is{}Object(w.a)(Is,"BrowserPaneDataField",null,[]);class rD{}Object(w.a)(rD,"BrowserPaneTelemetryEvent",null,[]);class vl{static qz(a,
c){const h=new rD;h.eventName="Diagnostics";h.isActivity=!1;h.activityContract=Object.assign(new qD,{success:!0});const v=[],B=new Is;B.name="Message";B.dataType=0;B.value=a;a=new Is;a.name="Level";a.dataType=0;a.value=vl.getLevelString(c);Array.add(v,B);Array.add(v,a);h.dataFields=v;vl.sendTelemetryEvent(h)}static izi(a,c){const h=new rD;h.eventName=a;h.isActivity=!1;h.activityContract=Object.assign(new qD,{success:!0});a=[];const v=new Is;v.name="AppCorrelationId";v.dataType=0;v.value=c;Array.add(a,
v);h.dataFields=a;vl.sendTelemetryEvent(h)}static I$m(a,c,h,v,B,X){const ma=new rD;ma.eventName="LaunchPaneWithError";ma.isActivity=!1;ma.activityContract=Object.assign(new qD,{success:!0});const Pa=[],mb=new Is;mb.name="IsNetworkConnected";mb.dataType=0;mb.value=a?"true":"false";a=new Is;a.name="IsHostruntimeAvailable";a.dataType=0;a.value=c?"true":"false";c=new Is;c.name="EntryPoint";c.dataType=0;c.value=h;h=new Is;h.name="RuntimeVersion";h.dataType=0;h.value=v;v=new Is;v.name="IsFirstRelease";
v.dataType=1;v.value=B?"true":"false";B=new Is;B.name="IsZeroTerm";B.dataType=1;B.value=X?"true":"false";X=new Is;X.name="IsClientSideRendering";X.dataType=1;X.value="false";Array.add(Pa,mb);Array.add(Pa,c);Array.add(Pa,a);Array.add(Pa,h);Array.add(Pa,v);Array.add(Pa,B);Array.add(Pa,X);ma.dataFields=Pa;vl.sendTelemetryEvent(ma)}static xOf(a,c,h){const v=new rD;v.eventName="CDNDownloadLatency";v.isActivity=!0;v.activityContract=Object.assign(new qD,{duration:h,success:!0});h=[];const B=new Is;B.name=
"CDNHostname";B.dataType=0;B.value=a;a=new Is;a.name="Filename";a.dataType=0;a.value=c;Array.add(h,B);Array.add(h,a);v.dataFields=h;vl.sendTelemetryEvent(v,1)}static j$b(a,c,h,v,B,X,ma,Pa){const mb=new rD;mb.eventName="LaunchPane";mb.isActivity=!0;mb.activityContract=Object.assign(new qD,{duration:c,success:!0});c=[];const Tb=new Is;Tb.name="AppCorrelationId";Tb.dataType=0;Tb.value=a;a=new Is;a.name="EntryPoint";a.dataType=0;a.value=h;h=new Is;h.name="IsServerSideRendering";h.dataType=1;h.value="true";
const rc=new Is;rc.name="UxVersion";rc.dataType=0;rc.value=v;v=new Is;v.name="FeatureGates";v.dataType=0;v.value=B;B=new Is;B.name="IsFirstRelease";B.dataType=1;B.value=X?"true":"false";X=new Is;X.name="IsZeroTerm";X.dataType=1;X.value=ma?"true":"false";ma=new Is;ma.name="IsClientSideRendering";ma.dataType=1;ma.value=Pa?"true":"false";Array.add(c,Tb);Array.add(c,a);Array.add(c,h);Array.add(c,rc);Array.add(c,v);Array.add(c,B);Array.add(c,X);Array.add(c,ma);mb.dataFields=c;vl.sendTelemetryEvent(mb)}static sendTelemetryEvent(a,
c=2){if(a.isFeedbackActivity)vl.B3l(a.eventName);else{var h=-1<a.eventName.indexOf(vl.CNi)?a.eventName:vl.CNi+a.eventName,v=vl.pYk(a.dataFields);a.isActivity?(a=Object.assign(new wg.a,{name:h,samplingPolicy:c,dataFields:v,succeeded:a.activityContract.success,durationMs:a.activityContract.duration}),Z.a.sendActivityEvent(a)):(a=Object.assign(new ja.a,{name:h,samplingPolicy:c,dataFields:v}),Z.a.sendTelemetryEvent(a))}}static getLevelString(a){switch(a){case 10:return"Error";case 15:return"Warning";
default:return"Info"}}static pYk(a){const c=[];if(a&&0<a.length)for(const h of a)(a=um.a.Jia(h.name,h.value,vl.uek(h.dataType)))&&Array.add(c,a);return c}static uek(a){switch(a){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}static B3l(a){const c=xa.a.instance.ra("Common.ISystemInitiatedFeedback");c?c.logActivity(a,null):r.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}vl.CNi="Office.Insights.SmartLookup.";Object(w.a)(vl,"TelemetryUtils",
null,[]);var sD;(function(a){a[a.other=0]="other";a[a.searchBoxSearch=1]="searchBoxSearch";a[a.searchBoxDictionary=2]="searchBoxDictionary";a[a.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";a[a.smartLookupRibbon=4]="smartLookupRibbon";a[a.smartLookupContextMenu=5]="smartLookupContextMenu";a[a.entity=6]="entity";a[a.dictionary=7]="dictionary";a[a.web=8]="web";a[a.pictures=9]="pictures";a[a.files=10]="files";a[a.bookmarks=11]="bookmarks";a[a.help=12]="help";a[a.chartRecommendation=13]="chartRecommendation";
a[a.linkSkill=14]="linkSkill";a[a.searchBoxFindInDocument=15]="searchBoxFindInDocument";a[a.searchBoxEntity=16]="searchBoxEntity";a[a.searchSkill=17]="searchSkill";a[a.controlF=18]="controlF";a[a.ribbonFindButton=19]="ribbonFindButton";a[a.reuseSlides=20]="reuseSlides";a[a.data=21]="data";a[a.contextMenuDictionary=22]="contextMenuDictionary";a[a.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";a[a.contextMenuSynonyms=24]="contextMenuSynonyms";a[a.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";
a[a.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";a[a.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";a[a.note=28]="note";a[a.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";a[a.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";a[a.dataDisambiguate=31]="dataDisambiguate";a[a.linkFiles=32]="linkFiles";a[a.searchBoxNoteL2=33]="searchBoxNoteL2";a[a.contextMenuLaunchL2Document=34]="contextMenuLaunchL2Document";a[a.prefetch=99]="prefetch"})(sD||(sD={}));Object(w.b)("EntryPoint",
sD);var Vt=b(1358),qw=b(1371);class Wt{static j4(a,c,h,v,B,X){if(1===h)return ya.SessionStatusManager.instance.pK?32:8;if(B.value.qpn())return vl.qz("Skipping Serplet launch",10),32;c=X;if(!c)return 8;a=Wt.zwb();if(h=c.CommandValueId)try{c=z.a(h)}catch(ma){return r.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",h),8}h=c;c.selection||(c.neighborhood?h=Object.assign(new Vt.a,{selection:c}):(c=B.value.ZZb(),h.selection=Object.assign(new qw.a,{neighborhood:c.neighborhood,
mentionStart:c.mentionStart,mentionLength:c.mentionLength})));h.selection.clientDetectedLanguage=B.value.Iwh();return Wt.nYb(X,null,h,a,0,B)}static nYb(a,c,h,v,B,X){const ma={};ma.controlId=a?a.SourceControlId:"shortcut";h&&(ma.entryPoint=sD[h.entryPoint]);r.ULS.sendTraceTag(594044172,1303,50,Wt.pR("Show insights",v,ma));c?X.value.Drn(c,v,B):h&&X.value.Ern(h,v,B);return 32}static pR(a,c,h=null){a={["appCorrelationId"]:c,["message"]:a};if(h)for(let v in h)a[v]=h[v];return z.c(a)}static zwb(){return Ya.a.create().toString()}}
Object(w.a)(Wt,"InvokingPaneUtils",null,[]);class BM{}Object(w.a)(BM,"LaunchDataInDoc",null,[]);var ev=b(1374);class AH{constructor(a,c,h,v,B,X,ma,Pa,mb){this.eic=this.E7c=this.Iu=null;this.IA=a;this.ga=c||l.AFrameworkApplication.pa;this.Dn=h;this.fb=v;this.Aqg=Pa;this.Pnc=B;this.qa=X;this.Ta=ma;this.DAl();this.TPa=new qf.a(()=>new zh.a(mb.value,Object(m.a)(this,this.oxb,"getMoreInfoEventReceived")))}eb(){this.ga.ka(Sa.a.pEl,Kc.a.frame,Object(m.a)(this,this.Brn,"showInsights"));this.ga.ka(Sa.a.qEl,
Kc.a.frame,Object(m.a)(this,this.Crn,"showInsightsForTellMe"));this.ga.ka(Sa.a.definitions,Kc.a.frame,Object(m.a)(this,this.Bqn,"showDefinitions"));this.ga.ka(Sa.a.IWe,Kc.a.frame,Object(m.a)(this,this.Cqn,"showDefinitionsForTellMe"));this.ga.ka(Sa.a.qTf,Kc.a.frame,Object(m.a)(this,this.qTf,"showInsightsForSuggestion"));this.Aqg&&(this.ga.ka(Sa.a.Qca,Kc.a.frame,Object(m.a)(this,this.j4,"invokeSmartLookupPane")),this.ga.ka(Sa.a.iIc,Kc.a.frame,Object(m.a)(this,this.iIc,"invokeInDocSerplet")),this.ga.ka(Sa.a.qHd,
Kc.a.frame,Object(m.a)(this,this.qHd,"invokeSerpletRibbon")),this.ga.ka(Sa.a.jIc,Kc.a.frame,Object(m.a)(this,this.jIc,"invokeSerpletContextMenu")),this.ga.ka(Sa.a.mhf,Kc.a.frame,Object(m.a)(this,this.mhf,"invokeSerpletTellMeZeroTerm")),this.ga.ka(Sa.a.lhf,Kc.a.frame,Object(m.a)(this,this.lhf,"invokeSerpletTellMeNotes")),this.ga.ka(Sa.a.mHd,Kc.a.frame,Object(m.a)(this,this.mHd,"invokeImageSerpletContextMenu")),this.ga.ka(Sa.a.rHd,Kc.a.frame,Object(m.a)(this,this.rHd,"invokeSynonymsSerpletContextMenu")),
this.ga.ka(Sa.a.lHd,Kc.a.frame,Object(m.a)(this,this.lHd,"invokeDictionarySerpletContextMenu")),this.ga.ka(Sa.a.tHd,Kc.a.frame,Object(m.a)(this,this.tHd,"invokeZeroTermSerpletContextMenu")),this.ga.ka(Sa.a.pHd,Kc.a.frame,Object(m.a)(this,this.pHd,"invokeSerpletBrowseFiles")),this.ga.ka(Sa.a.nHd,Kc.a.frame,Object(m.a)(this,this.nHd,"invokeInDocSerpletWithLaunchData")),this.ga.ka(Sa.a.BWd,Kc.a.frame,Object(m.a)(this,this.BWd,"queryToggleSerplet")),this.ga.ka(Sa.a.m0d,Kc.a.frame,Object(m.a)(this,this.m0d,
"setInDocSearchParameter")),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",!1)&&(this.ga.ka(Sa.a.iPh,Kc.a.frame,Object(m.a)(this,this.VFl,"invokeSmartLookupPaneConversations")),this.ga.ka(Sa.a.kHd,Kc.a.frame,Object(m.a)(this,this.kHd,"invokeAutoLaunchSearchRequest"))),this.JRm().continueWith(()=>{l.AFrameworkApplication.na&&l.AFrameworkApplication.na.updateCommandUI(!0)}))}ENg(){this.ga.Aa(Sa.a.Iza,Kc.a.frame,Object(m.a)(this,this.Iza,"invokeFilesSerplet"),
4);this.ga.Aa(Sa.a.hhf,Kc.a.frame,Object(m.a)(this,this.Iza,"invokeFilesSerplet"),4);this.ga.Aa(Sa.a.cPh,Kc.a.frame,Object(m.a)(this,this.JFl,"invokeLinkFilesSerplet"),4);if(this.qa.$("IsTellMeUpSellEnterpriseEnabled")&&this.qa.$("SmartLookupTokenPrefetchIsEnabled")){const a=Se.a.S7(0,Object(m.a)(this,this.Pii,"prefetchToken"),0,177);this.Ta.ub(a)}}hIe(){yh.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.ga.ka(Sa.a.Iza,
Kc.a.frame,Object(m.a)(this,this.ihf,"invokeFilesSerpletUnavailable")),this.ga.ka(Sa.a.hhf,Kc.a.frame,Object(m.a)(this,this.ihf,"invokeFilesSerpletUnavailable")),this.ga.ka(Sa.a.cPh,Kc.a.frame,Object(m.a)(this,this.ihf,"invokeFilesSerpletUnavailable")))}Pii(a){r.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",a.interval,!!a.data);this.Jcc().then(c=>{let h=1;if(c)r.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),
this.MOf("SmartLookupFiles: Token prefetch succeeded",!0),c=6E4*this.qa.vb("SmartLookupTokenRenewalWaitDurationInMinutes",30);else{r.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.MOf("SmartLookupFiles: Token prefetch failed",!1);h=parseInt(a.data||"1");if(h>this.qa.vb("SmartLookupTokenRenewalRetryThreshold",5)){r.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.MOf("SmartLookupFiles: Token prefetch max retry count reached",
!1);return}c=6E4*this.qa.vb("SmartLookupTokenRetryWaitDurationInMinutes",10);h++}c=new Se.a(3,1,c,Object(m.a)(this,this.Pii,"prefetchToken"),177);c.data=h.toString();this.Ta.ub(c)})}MOf(a="",c=!1){this.Pnc.execute(h=>{h&&h.Ogb("PrefetchToken",c,0,"SmartLookup",a)})}Jcc(){return this.Pnc?new Promise(a=>{this.Pnc.execute(c=>{if(c){var h=Date.now();c.getToken("SmartLookup",this.qa.Ga("SmartLookupShredderServiceEndpoint")).then(v=>{a(!!v&&0<v.length);c.Ogb("TryGetTokenInternal",!!v&&0<v.length,Date.now()-
h,"SmartLookup")})}else a(!1)})}):Promise.resolve(!1)}JRm(){const a=new oj.a;if(this.qa.$("BrowserSupportsInsightsPaneSSO"))this.ENg(),a.Jf(!0);else{if(!this.Pnc)return r.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),a.Jf(!1),this.hIe(),a.task;this.Pnc.execute(c=>{c?c.getToken("SmartLookup",this.qa.Ga("SmartLookupShredderServiceEndpoint")).then(h=>{r.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!h&&0<h.length);h&&0<h.length?(this.ENg(),a.Jf(!0)):this.hIe()}):(r.ULS.sendTraceTag(587534912,
1303,10,"Unable to resolve oAuthManager"),a.Jf(!1),this.hIe())})}return a.task}Brn(a,c,h,v,B){if(1===h)return l.AFrameworkApplication.na&&l.AFrameworkApplication.K.$("OneNoteDelayLoadContextActivationManager")&&!l.AFrameworkApplication.Nxc?8:this.IA.value.gTh()?32:8;a=Wt.zwb();c=this.IA.value.ZZb();return this.Aqg?(c=Object.assign(new qw.a,{neighborhood:c.neighborhood,mentionStart:c.mentionStart,mentionLength:c.mentionLength}),c=Object.assign(new Vt.a,{selection:c,userIntent:null,entryPoint:0,launchData:Object.assign(new ev.a,
{landingTab:"All"})}),Wt.nYb(B,null,c,a,0,this.IA)):Wt.nYb(B,c,null,a,0,this.IA)}Bqn(a,c,h,v,B){if(1===h)return this.IA.value.gTh()?32:8;a=Wt.zwb();c=this.IA.value.ZZb();return Wt.nYb(B,c,null,a,1,this.IA)}Crn(a,c,h,v,B){return 1===h?32:this.Bjh(B,0)}Cqn(a,c,h,v,B){return 1===h?32:this.Bjh(B,1)}Bjh(a,c){const h=Wt.zwb(),v=a.CommandValueId;let B;try{B=z.a(v)}catch(X){return r.ULS.sendTraceTag(6295941,1303,15,Wt.pR(String.format("Insights parameters [{0}] is not in proper format.",v),h)),8}return Wt.nYb(a,
B,null,h,c,this.IA)}qTf(a,c,h,v,B){if(1===h)return 32;if(!B)return 8;a=B.query?B.query:"";c=Wt.zwb();h=new vE.a;h.neighborhood=a;h.mentionStart=0;h.mentionLength=a.length;return Wt.nYb(B,h,null,c,0,this.IA)}JFl(a,c,h,v){if(1===h)return ya.SessionStatusManager.instance.pK?32:8;const B=l.AFrameworkApplication.K.$("InsertFileLinkSerpletIsEnabled"),X=this.IA.value.SVa();return this.j4(a,c,h,v,Object.assign(new Vt.a,{selection:Object.assign(new qw.a,{neighborhood:X.neighborhood,mentionStart:0,mentionLength:0}),
launchData:Object.assign(new ev.a,{landingTab:"File"}),entryPoint:B?32:10}))}Iza(a,c,h,v){if(1===h)return ya.SessionStatusManager.instance.pK?32:8;const B=l.AFrameworkApplication.K.$("InvokeReuseSlidesSerpletIsEnabled"),X=this.IA.value.SVa();return this.j4(a,c,h,v,Object.assign(new Vt.a,{selection:Object.assign(new qw.a,{neighborhood:X.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new ev.a,{landingTab:B?"Slide":"File"}),entryPoint:B?20:10}))}ihf(){return 2}iIc(a,c,h,v,B){if(1===
h)return ya.SessionStatusManager.instance.gi?8:32;const X=this.IA.value.SVa();B=void 0===B||null===B?18:19;return this.j4(a,c,h,v,Object.assign(new Vt.a,{selection:Object.assign(new qw.a,{neighborhood:X.neighborhood,mentionStart:X.mentionStart,mentionLength:X.mentionLength}),launchData:Object.assign(new ev.a,{landingTab:"Indoc"}),entryPoint:B}))}nHd(a,c,h,v,B){B=B.CommandValueId;if(!B||B&&this.eic&&B.query===this.eic.query&&B.matchCase===this.eic.matchCase&&B.matchWholeWordOnly===this.eic.matchWholeWordOnly)return 32;
const X=this.IA.value.SVa();return this.j4(a,c,h,v,Object.assign(new Vt.a,{selection:Object.assign(new qw.a,{neighborhood:X.neighborhood,mentionStart:X.mentionStart,mentionLength:X.mentionLength}),launchData:Object.assign(new ev.a,{landingTab:"Indoc",data:Object.assign(new BM,{type:4,query:B.query,matchCase:B.matchCase,matchWholeWord:B.matchWholeWordOnly})}),entryPoint:18}))}BWd(a,c,h,v,B){B&&(B[Uf.a.On]=this.IA.value.dAb);return 32}m0d(a,c,h,v,B){if(a=B.CommandValueId)this.eic=a;return 32}VFl(a,
c,h){if(1===h)return ya.SessionStatusManager.instance.pK?32:8;a=this.IA.value.SVa();a=Object.assign(new Vt.a,{selection:Object.assign(new qw.a,{neighborhood:a.neighborhood,mentionStart:a.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new ev.a,{landingTab:"All"})});this.IA.value.vLd(a);return 32}kHd(a,c,h){if(1===h)return ya.SessionStatusManager.instance.pK?32:8;a=this.IA.value.SVa();a=Object.assign(new Vt.a,{selection:Object.assign(new qw.a,{neighborhood:a.neighborhood,mentionStart:a.mentionStart,
mentionLength:0}),entryPoint:29,launchData:Object.assign(new ev.a,{landingTab:"All",data:l.AFrameworkApplication.pvb})});c=Wt.zwb();this.IA.value.LFb(a,c);return 32}qHd(a,c,h,v){if(1===h)return ya.SessionStatusManager.instance.pK?32:8;const B=this.IA.value.Jwh();return this.j4(a,c,h,v,Object.assign(new Vt.a,{selection:Object.assign(new qw.a,{neighborhood:B.neighborhood,mentionStart:B.mentionStart,mentionLength:B.mentionLength}),entryPoint:4,launchData:Object.assign(new ev.a,{landingTab:"All"})}))}jIc(a,
c,h,v){return this.j4(a,c,h,v,Object.assign(new Vt.a,{entryPoint:5,launchData:Object.assign(new ev.a,{landingTab:"All"})}))}mhf(a,c,h,v){if(1===h)return ya.SessionStatusManager.instance.pK?32:8;const B=this.IA.value.SVa();return this.j4(a,c,h,v,Object.assign(new Vt.a,{selection:Object.assign(new qw.a,{neighborhood:B.neighborhood,mentionStart:B.mentionStart,mentionLength:0}),launchData:Object.assign(new ev.a,{landingTab:"All"}),entryPoint:26}))}lHd(a,c,h,v){return 1===h?(a=this.IA.value.ZZb())&&0<
a.mentionLength?32:8:this.j4(a,c,h,v,Object.assign(new Vt.a,{entryPoint:22,launchData:Object.assign(new ev.a,{landingTab:"All"})}))}mHd(a,c,h,v){return this.j4(a,c,h,v,Object.assign(new Vt.a,{launchData:Object.assign(new ev.a,{landingTab:"Image"}),entryPoint:9}))}rHd(a,c,h,v){return this.j4(a,c,h,v,Object.assign(new Vt.a,{launchData:Object.assign(new ev.a,{landingTab:"All"}),entryPoint:24}))}lhf(a,c,h,v){return this.j4(a,c,h,v,Object.assign(new Vt.a,{launchData:Object.assign(new ev.a,{landingTab:"Notes"}),
entryPoint:33}))}tHd(a,c,h,v){if(1===h)return ya.SessionStatusManager.instance.pK?32:8;const B=this.IA.value.SVa();return this.j4(a,c,h,v,Object.assign(new Vt.a,{selection:Object.assign(new qw.a,{neighborhood:B.neighborhood,mentionStart:B.mentionStart,mentionLength:0}),launchData:Object.assign(new ev.a,{landingTab:"All"}),entryPoint:27}))}j4(a,c,h,v,B){return Wt.j4(a,c,h,v,this.IA,B)}pHd(a,c,h){if(1===h)return 32;this.Iu||this.TPa.value.jj("Browse File from Search pane",!0);if(!this.E7c||""===this.E7c)return r.ULS.sendTraceTag(558409934,
1303,10,"InsightsActor: Failed to get host url to browse files."),8;Ve.a.Ql(this.E7c,"_blank",void 0,"BrowseFilesFromSearchPane");return 32}oxb(a){this.Iu||3!==a.state||(this.Iu=a,this.E7c=this.Iu.K9)}DAl(){const a=this.fb.fd(eh.Iw);a.parent=Fc.AFrame.uo;a.iba(Object(m.a)(this,this.i$b,"sendIFrameTakeFocusMessage"));this.Dn.KQ(eh.Iw)}i$b(){document.activeElement.blur();l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.$cb||(this.IA.value.een(),this.IA.value.G$m())}dispose(){this.IA.value&&
this.IA.value.dispose()}}Object(w.a)(AH,"InsightsActor",null,[14]);const BH=a=>{a=a.split("-");return a[a.length-1]},sQ=()=>{var a=PF();if(a)return Promise.resolve(a);a=wE().replace("SearchWeb","searchweb");a=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?a+eh.wJi+"/":a+eh.PWc+"/";a+="version.json";if(H.a.dA)return rQ(a);try{const c=new Sys.Net.WebRequest;c.set_httpVerb("GET");c.set_url(a);a={};a.method=c.get_httpVerb();return"function"!==
typeof window.fetch?(vl.qz("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(c.getResolvedUrl(),a).then(h=>h.json()).catch(()=>{vl.qz("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(h=>{h=z.b(JSON.stringify(h));return h.version?h.version:""},h=>{vl.qz("InsightsUtils - Failed to deserialize version: "+h.toString(),10);r.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+
h.toString());return""}).then(h=>h)}catch(c){return vl.qz("InsightsUtils - Failed to download version.json: "+c.toString(),10),r.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+c.toString()),Promise.resolve("")}},rQ=a=>{const c=l.AFrameworkApplication.fe;return new Promise(h=>{const v=new LF.a(a,1,null,null,!0,2,null);c.send(v).uBa(B=>{B&&B.data?B.data.qd||(vl.qz("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+
B.data.we,10),h("")):(vl.qz("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),h(""));try{const X=z.b(B.data.qd);X.version&&h(X.version)}catch(X){vl.qz("InsightsUtils - Failed to deserialize version: "+X.toString(),10),h("")}},B=>{B&&B.data?vl.qz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+B.data.we,10):vl.qz("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",10);h("")})})},
QF=()=>l.AFrameworkApplication.K.$("SmartLookupEnableLocalOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),RF=()=>{const a=wE();return QF()||l.AFrameworkApplication.K.Ga("SmartLookupPRClientVersion")?a+PF()+"/":l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?a+eh.wJi:a+eh.PWc},PF=()=>QF()?"dev":l.AFrameworkApplication.K.Ga("SmartLookupPRClientVersion")?l.AFrameworkApplication.K.Ga("SmartLookupPRClientVersion").split("/")[1]:
l.AFrameworkApplication.K.Ga("SmartLookupClientVersion"),CH=a=>{var c=3===l.AFrameworkApplication.na.Ya.Rm?"wordwac":2===l.AFrameworkApplication.na.Ya.Rm?"pptwac":"excelwac";var h=vi.a.af(l.AFrameworkApplication.lcid);const v=h?h.name:"en-us";h=wE();const B=vC();c="main_ssr_wac.html?appName="+c+"&culture="+v;return"LOCAL"===B?h+c:h+((""!==a?a:eh.PWc)+"/")+c},tQ=a=>wE()+(""!==a?a:eh.PWc)+"/scripts/microsoft.office.smartlookup.host.runtime.js",wE=()=>{switch(vC()){case "LOCAL":return eh.dun;case "PR":const a=
l.AFrameworkApplication.K.Ga("SmartLookupPRClientVersion").split("/");return eh.eun+a[0]+"/";case "INT":return eh.fun;case "EDOG":return eh.xJi;default:return eh.yJi}},uQ=()=>{if(!l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(vC()){case "EDOG":return eh.xJi;case "PROD":return eh.yJi;default:return""}},vC=()=>{if(l.AFrameworkApplication.K.$("SmartLookupEnableEdogSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",
!1))return"EDOG";if(l.AFrameworkApplication.K.$("SmartLookupEnableProdSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(l.AFrameworkApplication.K.$("SmartLookupEnableIntSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",!1))return"INT";if(l.AFrameworkApplication.K.Ga("SmartLookupPRClientVersion")&&
l.AFrameworkApplication.K.Ga("SmartLookupPRIntentSvc"))return"PR";if(QF())return"LOCAL";switch(Object(ha.a)(String,l.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case "Dogfood":if(l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let a=l.AFrameworkApplication.K.Ga("UserPrincipalName");a=F.a.kg(a);const c=l.AFrameworkApplication.K.hF("SmartLookupINTEnabledForSKITeam")?l.AFrameworkApplication.K.bB("SmartLookupINTEnabledForSKITeam"):
[];if(0<=Array.indexOf(c,a))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},CM=()=>{let a;a=l.AFrameworkApplication.K.$("IntentSvcEnableEdogSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":l.AFrameworkApplication.K.$("IntentSvcEnableProdSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",
!1)?"PROD":l.AFrameworkApplication.K.$("IntentSvcEnableIntSourceLocationOverride")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":vC();const c=l.AFrameworkApplication.K.Ga("IntentServiceEndpoint"),h=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===a&&""!==c)return c+"searchendpointv2/";switch(a){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";
case "PR":return l.AFrameworkApplication.K.Ga("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(h?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(h?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}};class DM{sendTelemetryEvent(a){vl.sendTelemetryEvent(a)}}
Object(w.a)(DM,"OtelTelemetrySink",null,[526]);class EM{}Object(w.a)(EM,"ApplicationProperties",null,[]);class FM{constructor(){this.filePath=this.docName=null}}Object(w.a)(FM,"CurrentDocumentProperties",null,[]);class GM{}Object(w.a)(GM,"EnterpriseUserInfo",null,[]);class HM{}Object(w.a)(HM,"FeatureGates",null,[]);class DH{constructor(a,c){this.Us=this.ih=null;this.i3h=!0;this.orb=c;this.Fu=a;this.Fu.execute(h=>{h.isFeatureEnabled("mso_sendASmile",!0).then(v=>{this.i3h=v}).catch(v=>{vl.qz("SearchHelper - Failed to check if Feedback feature is enabled: "+
v.toString(),15)})});a=CM();c=l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(l.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")){this.Us={};const h=this.Dfl();if(h&&0<h.length)for(let v=0;v<h.length;v++){const B=h[v],X=this.Pfl(B);switch(X.toLowerCase()){case "true":this.Us[B]=!0;break;case "false":this.Us[B]=!1;break;default:this.Us[B]=X}}this.Us.EnableInDocumentSearch=
c;this.Us.EnableInDocumentSearchReplace=!0;this.Us.EnableInDocumentParamLocalSearch=!0;this.Us.EnableInDocumentQuerySuggest=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.Us.EnableInDocumentQuestionGeneration=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",
!1);this.Us.EnableInDocumentGlobalEncoder=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentGlobalEncoder")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1);this.Us.EnableInDocumentExperiment1=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.Us.EnableInDocumentExperiment2=
c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.Us.EnableInDocumentExperiment3=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1);this.Us.EnableZeroTermAutoRefresh=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",
!1);this.Us.EnableTap3SZeroTerm=l.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.Us.EnableLocalSearch=!0;this.Us.EnableInDocumentStickyFilters=!0;this.Us.IntentServiceEndpoint=a;this.Us.EnablePDFShredding=l.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",
!1);this.Us.FilterNonPPTFilesForReuseSlides=l.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides");this.Us.UXBundleVersion=PF();this.Us.SmartLookupServicePath=RF();this.Us.EnableAcronymSearch=!0;this.Us.UseAltAnswerEndpoint1=l.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1);this.Us.UseAltAnswerEndpoint2=l.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.Us.UseAltAnswerEndpoint3=l.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.Us.UseNextUXVersion=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1);this.Us.IgnoreNeighborhoodContext=l.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled");
this.Us.ShowDebugInfo="INT"===vC();this.Us.DebugCommands=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.Us.ChangeGates=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.Us.QnaInMixSection=!0;this.Us.EnableNoteSearch=l.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",
!1);this.Us.EnableWikiL2=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.Us.EnableFilteringOutRedundantKPE=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.Us.EnableZeroTermEntitySuggestion=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1);this.Us.RankingModels=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",
"");this.Us.EnableClientSideRendering=!0}else this.ih=new HM,this.ih.EnableInDocumentSearch=c,this.ih.EnableInDocumentSearchReplace=!0,this.ih.EnableInDocumentParamLocalSearch=!0,this.ih.EnableInDocumentQuerySuggest=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuerySuggest")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1),this.ih.EnableInDocumentQuestionGeneration=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentQuestionGeneration")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.ih.EnableInDocumentGlobalEncoder=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentGlobalEncoder")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1),this.ih.EnableInDocumentExperiment1=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment1")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",
!1),this.ih.EnableInDocumentExperiment2=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment2")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.ih.EnableInDocumentExperiment3=c&&l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentExperiment3")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.ih.EnableZeroTermAutoRefresh=
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.ih.EnableTap3SZeroTerm=l.AFrameworkApplication.K.$("SmartLookupEnableTap3SZeroTerm")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1),this.ih.EnableLocalSearch=!0,this.ih.EnableInDocumentStickyFilters=!0,this.ih.IntentServiceEndpoint=a,this.ih.EnablePDFShredding=l.AFrameworkApplication.K.$("SmartLookupEnableSharepointPDFIsEnabled")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.ih.FilterNonPPTFilesForReuseSlides=l.AFrameworkApplication.K.$("SmartLookupFilterNonPPTFilesForReuseSlides"),this.ih.UXBundleVersion=PF(),this.ih.SmartLookupServicePath=RF(),this.ih.EnableAcronymSearch=!0,this.ih.UseAltAnswerEndpoint1=l.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint1")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",
!1),this.ih.UseAltAnswerEndpoint2=l.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint2")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.ih.UseAltAnswerEndpoint3=l.AFrameworkApplication.K.$("SmartLookupUseAltAnswerEndpoint3")||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.ih.UseNextUXVersion=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1),this.ih.IgnoreNeighborhoodContext=l.AFrameworkApplication.K.$("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.ih.ShowDebugInfo="INT"===vC(),this.ih.DebugCommands=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",""),this.ih.ChangeGates=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.ih.QnaInMixSection=!0,this.ih.EnableNoteSearch=l.AFrameworkApplication.K.$("SmartLookupNoteSearchIsEnabled")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.ih.EnableWikiL2=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),this.ih.EnableFilteringOutRedundantKPE=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.ih.EnableZeroTermEntitySuggestion=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",
!1),this.ih.RankingModels=l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.ih.EnableClientSideRendering=!0,this.ih.SharedSerpletFeatureGate1=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",!1),this.ih.SharedSerpletFeatureGate2=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.ih.SharedSerpletFeatureGate3=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",
!1),this.ih.SharedSerpletFeatureGate4=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",!1),this.ih.SharedSerpletFeatureGate5=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",!1),this.ih.SharedSerpletFeatureGate6=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.ih.SharedSerpletFeatureGate7=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",
!1),this.ih.SharedSerpletFeatureGate8=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",!1),this.ih.SharedSerpletFeatureGate9=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",!1),this.ih.SharedSerpletFeatureGate10=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.ih.SharedSerpletFeatureGate11=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",
!1),this.ih.SharedSerpletFeatureGate12=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",!1),this.ih.SharedSerpletFeatureGate13=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",!1),this.ih.SharedSerpletFeatureGate14=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.ih.SharedSerpletFeatureGate15=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",
!1),this.ih.SharedSerpletFeatureGate16=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",!1),this.ih.SharedSerpletFeatureGate17=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",!1),this.ih.SharedSerpletFeatureGate18=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.ih.SharedSerpletFeatureGate19=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",
!1),this.ih.SharedSerpletFeatureGate20=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",!1),this.ih.SharedSerpletFeatureGate21=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",!1),this.ih.SharedSerpletFeatureGate22=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.ih.SharedSerpletFeatureGate23=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",
!1),this.ih.SharedSerpletFeatureGate24=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",!1),this.ih.SharedSerpletFeatureGate25=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",!1),this.ih.SharedSerpletFeatureGate26=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.ih.SharedSerpletFeatureGate27=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",
!1),this.ih.SharedSerpletFeatureGate28=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",!1),this.ih.SharedSerpletFeatureGate29=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",!1),this.ih.SharedSerpletFeatureGate30=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.ih.SharedSerpletFeatureGate31=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",
!1),this.ih.SharedSerpletFeatureGate32=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1),this.ih.SharedSerpletFeatureGate33=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",!1),this.ih.SharedSerpletFeatureGate34=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.ih.SharedSerpletFeatureGate35=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",
!1),this.ih.SharedSerpletFeatureGate36=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",!1),this.ih.SharedSerpletFeatureGate37=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",!1),this.ih.SharedSerpletFeatureGate38=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.ih.SharedSerpletFeatureGate39=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",
!1),this.ih.SharedSerpletFeatureGate40=l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",!1);this.Nmc=xa.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");this.MNd=!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.Vdb=DH.isEnterpriseUser();this.aLa=l.AFrameworkApplication.K.Ga("SmartLookupShredderServiceEndpoint");this.Yqf=Af.a.p0(l.AFrameworkApplication.K.Ga("AppCatalogUrl")||
"");this.S9l=l.AFrameworkApplication.K.Ga("UserPrincipalName");this.Vdb&&this.QCh()}Pfl(a){return l.AFrameworkApplication.K.getStringFeatureGate("Microsoft.Office.SharedOnline."+a,"")}Dfl(){const a=l.AFrameworkApplication.K.iVa,c=l.AFrameworkApplication.K.bB("SmartLookupFlightKeywordList"),h=[];if(a&&c&&0<c.length)for(let B in a){var v={key:B,value:a[B]};v=v&&v.key?v.key:"";for(let X=0;X<c.length;X++)if(-1<v.toLowerCase().indexOf(c[X].toLowerCase())){const ma=v.split(".");ma&&4===ma.length&&Array.add(h,
ma[ma.length-1])}}return h}Z$e(a,c,h,v){return new Promise(B=>{this.ySl().then(X=>{const ma=new EM;ma.anid="";ma.applicationName=3===l.AFrameworkApplication.na.Ya.Rm?"WORD":"POWERPNT";ma.applicationVersion=l.AFrameworkApplication.buildVersion;ma.appCorrelationId=a?a:Wt.zwb();ma.themePlatform="web";ma.lcid=l.AFrameworkApplication.lcid;ma.launchUtcTime=(new Date).toUTCString();l.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?ma.featureGates=z.c(this.Us):ma.featureGates=z.c(this.ih);var Pa=vi.a.af(l.AFrameworkApplication.lcid);
Pa=Pa?Pa.name:null;ma.market=BH(Pa);ma.uiLanguage=Pa;ma.sessionId=l.AFrameworkApplication.userSessionId;ma.themeId=h;ma.parentalControl="yes";ma.processorOnlyMode=X;ma.isEditingAllowed=c.isEditingAllowed();ma.isFeedbackEnabled=this.i3h;ma.isClientSideRendering=18===v||19===v||15===v;ma.accessToken=this.Vdb?this.QCh():"";X=new GM;X.CountryCode=BH(Pa);X.ServiceEndpoint=this.aLa;X.IsGoLocal=l.AFrameworkApplication.K.$("IsGoLocalEnvironment");X.IsEnabled=this.Vdb;X.IsEnterpriseEnabled=this.Vdb;X.TenantRoot=
this.Yqf;X.Upn=this.S9l;ma.enterpriseUserInfo=X;X=new FM;X.filePath=l.AFrameworkApplication.K.Ga("EditDocInClientUrl");X.docName=l.AFrameworkApplication.K.Ga("FileName");ma.currentDocument=X;B(ma)})})}ySl(){return new Promise(a=>{this.Fu?this.Fu.execute(c=>{c.isFeatureEnabled(eh.gun,!0).then(h=>{a(!h)}).catch(h=>{vl.qz("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+h.toString(),10);a(!0)})}):a(!0)})}rAm(a){this.Nmc&&this.Vdb&&this.OEh(this.aLa).then(c=>{a(c)})}QCh(){if("Dev Box"===
l.AFrameworkApplication.K.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return window.SearchPaneShredderTokenOverride;const a=this.MNd?"Search":"SmartLookup";return this.Nmc?this.Nmc.mjl(a,this.aLa,this.MNd):""}OEh(a){if("Dev Box"===l.AFrameworkApplication.K.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return new Promise(h=>{h(window.SearchPaneShredderTokenOverride)});
const c=this.MNd?"Search":"SmartLookup";return this.Nmc?this.Nmc.getToken(c,a,this.MNd):Promise.resolve("")}MEc(){return this.orb?this.orb.getVersion():""}Q_k(){return l.AFrameworkApplication.K.$("SmartLookupFeatureGateV2")?z.c(this.Us):z.c(this.ih)}static isEnterpriseUser(){const a=l.AFrameworkApplication.K.Ga("SovereignEnvironmentName"),c=l.AFrameworkApplication.K.$("IsTellMeUpSellEnterpriseEnabled");return(!a||!a.length)&&c}}Object(w.a)(DH,"SearchHelper",null,[502]);class wC{constructor(){wC._instance=
""}getVersion(){return wC._instance}jkn(a){wC._instance=a}}wC._instance=null;Object(w.a)(wC,"SmartLookupVersion",null,[]);class IM{}Object(w.a)(IM,"ConfigurationProvider",null,[]);class tD{constructor(a){tD._instance=a}c8e(){return tD._instance}}tD._instance=null;Object(w.a)(tD,"SearchHostRuntime",null,[]);class EH{constructor(){this.raa=this.$Jb=this.W=null}get name(){return"Common.App.Insights"}yb(a){this.W=a;const c=rg.a.Vp(xa.a.instance.za("Common.IEventEmitter<Common.IGetMoreInfoResult>")),h=
l.AFrameworkApplication.K.$("SmartLookupEnableNativePane")||l.AFrameworkApplication.K.$("SmartLookupIsEnabled");a.register(AH,"Common.App.Insights.InsightsActor").singleInstance().Pc(()=>new AH(a.te("Common.App.Insights.IInsightsManager"),l.AFrameworkApplication.pa,pj.a.instance,nc.FocusManager.instance(),a.za("Common.App.SearchCommon.ISearchOAuthManager"),l.AFrameworkApplication.K,ag.a.instance,h,new qf.a(()=>c.result)));a.register(501,"Common.App.Insights.IDocumentContentExtractionManager").singleInstance().Pc(()=>
new AM(a));h&&(a.register(wC,"Common.App.Insights.SmartLookupVersion").singleInstance().Pc(()=>new wC),a.register(502,"Common.App.SearchCommon.ISearchHelper").singleInstance().Pc(()=>new DH(xa.a.instance.za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),a.ra("Common.App.Insights.SmartLookupVersion"))))}init(){l.AFrameworkApplication.EX&&(this.$Jb=this.W.ra("Common.App.Insights.InsightsActor"),this.$Jb.eb())}nyk(){this.JEl()}JEl(){sQ().then(a=>{if(""!==a){const c=this.W.ra("Common.App.Insights.SmartLookupVersion");
c&&c.jkn(a)}this.iud();this.$Jb=this.W.resolve("Common.App.Insights.InsightsActor");a=tQ(a);a=nb.a.create(a);a.MQ((c,h)=>{h.succeeded?this.eln()&&this.prefetchZeroTerm():vl.qz("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+h.uB,10);this.$Jb.eb()});Sb.a.iR(a)})}eln(){const a=Object.assign(new IM,{channelId:eh.channelId,approvedOriginPattern:QF()?"^(http)?://(localhost:8080)$":l.AFrameworkApplication.K.Ga("SmartLookupApprovedOriginPattern")});var c=this.W.resolve("Common.App.SearchCommon.IDocumentContentExecutor");
const h=this.W.resolve("Common.App.SearchCommon.ISerpletExecutor"),v=this.W.resolve("Common.App.SearchCommon.IInsertContentExecutor"),B=new Ua.a;c&&B.add(c);h&&B.add(h);v&&B.add(v);c=CM();try{const X=new DM,ma=SmartLookupHostRuntime.setup(a,B.toArray(),!0,c,X);this.W.register(tD,"Common.App.SearchCommon.SearchHostRuntime").singleInstance().Pc(()=>new tD(ma));return!0}catch(X){return vl.qz("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+X,10),!1}}prefetchZeroTerm(){if(l.AFrameworkApplication.K.$("SmartLookupEnableInDocumentSearch")||
l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1)){var a=xa.a.instance.ra("Common.App.SearchCommon.SearchHostRuntime");if(a){const c=this.W.resolve("Common.App.SearchCommon.ISearchHelper"),h=this.W.resolve("Common.App.SearchCommon.IDocumentHelper");c.Z$e(null,h,0,99).then(v=>{a.c8e().prefetchZeroTerm(v,l.AFrameworkApplication.userSessionId,RF(),!0,"Indoc",null)})}else vl.qz("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",
15)}}iud(){var a=this.W.resolve("Common.App.SearchCommon.ISearchHelper");const c=CH(a.MEc());a=a.MEc();a=wE()+(""!==a?a:eh.PWc)+"/scripts/microsoft.office.smartlookup.ssr.js";const h=uQ();H.a.dA?this.myk(c,a):(this.kyk(c,h),this.lyk(a,h))}kyk(a,c){const h=new Sys.Net.WebRequest;h.set_httpVerb("GET");const v={};v.method=h.get_httpVerb();h.set_url(a);const B=(new Date).getTime();try{window.fetch(h.getResolvedUrl(),v).then(()=>{""!==c&&vl.xOf(c,a,(new Date).getTime()-B);this.W.ra("Common.App.Insights.SmartLookupVersion")})}catch(X){vl.qz("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
X.toString(),10)}}lyk(a,c){var h=new Sys.Net.WebRequest;h.set_httpVerb("GET");const v={};v.method=h.get_httpVerb();h.set_url(a);let B=-1;if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))h=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),ag.a.instance.ub(new Se.a(5,1,h,()=>{const X=nb.a.create(a);X.tIe(()=>{B=Date.now()});X.MQ((ma,Pa)=>{Pa.succeeded?""!==c&&vl.xOf(c,a,Date.now()-
B):vl.qz("InsightsPackage - Failed to prefetch JS file.",10)});Sb.a.iR(X)}));else{B=Date.now();try{window.fetch(h.getResolvedUrl(),v).then(()=>{""!==c&&vl.xOf(c,a,Date.now()-B)})}catch(X){vl.qz("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+X.toString(),10)}}}myk(a,c){if(H.a.dA){var h=l.AFrameworkApplication.fe;a=new LF.a(a,1,null,null,!0,2,null);h.send(a).uBa(v=>{v&&v.data?v.data.qd?this.W.ra("Common.App.Insights.SmartLookupVersion"):vl.qz("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+
v.data.we,10):vl.qz("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},v=>{v&&v.data?vl.qz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+v.data.we,10):vl.qz("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});l.AFrameworkApplication.K.$("SmartLookupPrefetchJSIsEnabled")&&(c=new LF.a(c,1,null,null,!0,2,null),h.send(c).uBa(v=>{v&&v.data?v.data.qd||vl.qz("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+
v.data.we,10):vl.qz("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},v=>{v&&v.data?vl.qz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+v.data.we,10):vl.qz("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",10)}))}}dispose(){this.$Jb&&this.$Jb.dispose()}}Object(w.a)(EH,"InsightsPackage",null,[1,2]);var JM=b(1409);class KM{constructor(){this.documentContentTableName=this.dataCenterEndpoint=
this.documentContentKey=null}}Object(w.a)(KM,"DocumentContentParams",null,[]);var vQ=b(1683),Mz;(function(a){a.Success="Success";a.b2i="Invoked";a.Error="Error";a.Timeout="Timeout";a.r4i="StaleAnnotation";a.T_i="AugloopLateResponse"})(Mz||(Mz={}));Object(w.b)("LogType",Mz);class xC{constructor(a,c){this.uwa=a;this.efh=c;l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1)&&this.uwa.Ea(this,xC.fyi)}logMessage(a){var c=Date.now();const h=this.zLe?
c-this.zLe:-1;c=[Object.assign(new aa.a,{name:"LogType",string:a.logType}),Object.assign(new aa.a,{name:"CorrelationId",string:a.correlationId}),Object.assign(new aa.a,{name:"Message",string:a.message}),Object.assign(new aa.a,{name:"WorkflowExecutionTime",int64:a.workflowExecutionTime}),Object.assign(new aa.a,{name:"StartTime",int64:this.zLe}),Object.assign(new aa.a,{name:"EndTime",int64:c}),Object.assign(new aa.a,{name:"Duration",int64:h})];Object(re.a)("AugloopSearchProviderData",a.success,h,c)}v_k(a){return`Error: ${a}, Message: ${a.message}, Stack: ${a.stack}`}L8g(a=
"",c="",h=""){return Object.assign(new KM,{documentContentKey:a,dataCenterEndpoint:c,documentContentTableName:h})}hK(a){if(a.annotationType===xC.fyi)if(window.clearTimeout(this.l5d),(a=a.content)&&(a.docContentKey||a.dataCenterEndpoint||a.documentContentTableName))if(void 0===this.wDb)this.logMessage({logType:Mz.T_i,success:!1,correlationId:a.correlationId,message:"Workflow results arrived after timeout",workflowExecutionTime:a.workflowExecutionTime});else if(this.iXl===a.correlationId)this.onError(Mz.r4i,
"Current annotation same as the last");else{this.iXl=a.correlationId;var c=this.L8g(a.docContentKey,a.dataCenterEndpoint,a.documentContentTableName);this.logMessage({logType:Mz.Success,success:!0,correlationId:a.correlationId,message:"Workflow completed successfully",workflowExecutionTime:a.workflowExecutionTime});this.wDb=void 0;this.efh.XAi(c)}else this.onError(Mz.Error,"Augloop annotation is empty or incorrect")}submitDocumentContentExtractionSignal(){if(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",
!1))try{this.zLe=Date.now();this.wDb=Ya.a.create().toString();this.logMessage({logType:Mz.b2i,success:!0,correlationId:this.wDb,message:"Workflow invoked"});const a=vC().toLowerCase(),c=new Jp.l({parentPath:["Signal",xC.K8m],items:[{id:"SearchProvider",body:new vQ.SearchProviderSignal({correlationId:this.wDb,shouldUseIntEndpoint:"int"===a||"local"===a})}]});augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation({operation:c});this.l5d=window.setTimeout(()=>{this.onError(Mz.Timeout,"Request timed out")},
1500)}catch(a){window.clearTimeout(this.l5d),this.onError(Mz.Error,this.v_k(a))}}onError(a,c){this.wDb&&(this.logMessage({logType:a,success:!1,correlationId:this.wDb,message:c}),this.wDb=void 0,this.RFk())}RFk(){this.efh.XAi(this.L8g())}}xC.fyi="AugLoop_SearchProvider_SearchProviderAnnotation";xC.K8m="AugLoop_SearchProvider_SearchProviderSignal";Object(w.a)(xC,"AugloopSearchProviderManager",null,[337]);class SF{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(w.a)(SF,
"DocumentContentSearchResults",null,[]);class FH{getAllParagraphsInDocument(){return null}selectRange(){}search(){}searchV2(a,c){this.search(a,h=>{c(Object.assign(new SF,{results:h,totalResultCount:h.length,hasTooManyResults:100<h.length}))})}searchWithParam(a,c){this.search(a.query,c)}searchWithParamV2(a,c){this.searchWithParam(a,h=>{c(Object.assign(new SF,{results:h,totalResultCount:h.length,hasTooManyResults:h.length>a.totalResultLimit}))})}highlight(){}highlightWithParam(a){this.highlight(a.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}getId(){return"DocumentContentExecutor"}}
Object(w.a)(FH,"BaseDocumentContentExecutor",null,[904,354]);class yB{static get ybm(){return 50}static sBd(a){if(""===a)return"";let c=0,h="";try{const v=$q.a.dzd(a);for(const B of v.ops)if(yB.aE(B))c||(h+=yB.B0k(B.attributes.atmention.fullName)),c+=1;else{const X=B.insert?B.insert:"";" "!==X&&0<X.length&&(c=0,h+=X)}}catch(v){r.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return h}static GVk(a){a=yB.sBd(a);return 0<
a.length&&a.split(" ").length<=yB.ybm?a:null}static B0k(a){let c="";a&&(a=a.split(" "),0<a.length&&(c=a[0]));return c}static aE(a){return!!a.attributes&&!!a.attributes.atmention}}Object(w.a)(yB,"BaseCommentSmartReplyHelpers",null,[]);class xE extends yB{constructor(){super()}static Fwb(a,c,h=!1){if(!a)return null;a=a.text&&0<a.text.length?a.text[0]:"";c=!c||!c.yf||""===c.yf;return 0<a.length&&c&&!h?yB.GVk(a):null}}Object(w.a)(xE,"CommentSmartReplyHelpers",yB,[]);var rw=b(1267);class TF{constructor(){this.query=
null;this.matchWholeWordOnly=this.matchCase=!1;this.totalResultLimit=0}}Object(w.a)(TF,"DocumentContentSearchParams",null,[]);class GH{constructor(){this.subdocumentId=null;this.endParagraphOffset=this.endParagraphIndex=this.startParagraphOffset=this.startParagraphIndex=0}}Object(w.a)(GH,"DocumentSelection",null,[]);var UF=b(627);class LM{constructor(){this.Pwd=this.x4g=0}}Object(w.a)(LM,"CommentFindResultIndexInfo",null,[]);const HH=(a,c)=>{var h=a.Ca.Fa;if(!h||!h.length)return null;h=h.sa;c=c.vd(h.node,
h.Xl);a.setSelection(c)};class MM extends FH{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd){super();this.qa=Tb;this.cqb=null;this.jG=a;this.Ba=c;this.Rb=h;this.ya=v;this.LA=B;this.Zj=Pa;this.fb=mb;this.Wga=X;this.ou=ma;this.yg=rc;this.jij=Tc;this.nDg=N.a.create();this.EXd(Object(m.a)(this,this.Z0,"onParagraphPropertyChanged"),Object(m.a)(this,this.Gda,"onParagraphConnect"),Object(m.a)(this,this.Zeb,"onParagraphDisconnect"));vd.execute(ee=>{this.jEg=ee})}get JV(){return!this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.NoCommentFocusOnFindSelection",
!1)}submitDocumentContentExtractionSignal(){this.jEg&&this.jEg.submitDocumentContentExtractionSignal()}getAllParagraphsInDocument(){var a=Object.assign(new UF.a,{Myb:!1,Nyb:!1,Pyb:!0});const c=this.Ba.Cab(this.jG.value,a);a=new Ua.a;for(var h of c)a.add(this.V9e(h));for(let v of this.yg.h0())h=xE.sBd(v.text[0]).split("\n"),h=1===h.length?h[0]:h.join(" "),a.add(h);return a.toArray()}selectRange(a,c,h,v,B){const X=Date.now(),ma={activityName:"InDocSelectRangeData",success:!0,message:"Select Range Succeeded",
duration:0};try{this.hhb();if(0>a||0>c||0>h||0>v||a>h||a===h&&c>v)throw Error("Provided select range offsets incorrect");const ee=Object.assign(new UF.a,{Myb:!1,Nyb:!1,Pyb:!0}),Ie=this.Ba.Cab(this.jG.value,ee);if(h>=Ie.count){const Xe=xa.a.instance.resolve("Common.Comments.ICommentModel").h0(),Yf=h-Ie.count;if(Yf<Xe.length){B=-1;if(this.Wga.Wwa.Ja(Yf)){const Fi=this.Wga.Wwa.J(Yf).CYb;for(var Pa=0;Pa<Fi.length;Pa++)if(Fi[Pa].begin===c){B=Pa;break}}this.cqb=-1!==B?Object.assign(new LM,{x4g:Yf,Pwd:B}):
null;const Hh=Xe[Yf];l.AFrameworkApplication.pa.processAction(ba.a.jX,2);l.AFrameworkApplication.pa.hb(ba.a.Vba,2,null);l.AFrameworkApplication.pa.hb(ba.a.selectComment,2,Object.assign(new rw.a,{commentId:Hh.id,V9:2,JV:this.JV}))}}else{this.cqb=null;var mb=Ie.J(a),Tb=Ie.J(h);if(!this.iYh(mb,c)||!this.iYh(Tb,v))throw Error("Provided select range offsets incorrect");l.AFrameworkApplication.pa.processAction(ba.a.jX,2);this.pEn(mb);var rc=this.LA.vd(mb,c);Pa=this.LA.jC(rc,Oe.a.Sb(Tb,v+1));if(B){const Xe=
Pa.toArray();c=[];for(const Yf of Xe)c.push(this.V9e(Yf.node));c.join(" ").includes(B)||(ma.success=!1,ma.message="The text in clicked passage does not match the selected hit")}var Tc=this.Zj.value.Su,vd=this.ya.Ca.Fa;vd&&vd.equals(Pa)&&this.Rb.$Ba(Tc,null);this.Rb.$Ba(Tc,Pa);ma.duration=Date.now()-X;this.logMessage(ma)}}catch(ee){ma.success=!1,ma.message=ee.stack,ma.duration=Date.now()-X,this.logMessage(ma)}}search(a,c){this.hhb();this.Wga.search(Object.assign(new TF,{query:a}),c)}searchV2(a,c){this.hhb();
this.Wga.searchV2(Object.assign(new TF,{query:a}),c)}selectNextPrevHighlight(a){this.hhb();return this.Wga.selectNextPrevHighlight(a)}searchWithParam(a,c){this.hhb();this.Wga.search(a,c)}searchWithParamV2(a,c){this.hhb();this.Wga.searchV2(a,c)}highlight(a){this.hhb();this.Wga.highlight(Object.assign(new TF,{query:a}))}highlightWithParam(a){this.hhb();this.Wga.highlight(a)}getRevision(){return this.nDg.toString()}getSelectedText(){const a=this.jij.getSelectedText();return Object.assign(new qw.a,{neighborhood:a.neighborhood,
mentionStart:a.mentionStart,mentionLength:a.mentionLength})}getDocumentSelection(){var a=Object.assign(new UF.a,{Myb:!1,Nyb:!1,Pyb:!0});let c;var h=({zV:c}=this.rfl(a)).returnValue;if(h)return h;var v=this.ya.Ca.Fa;if(!v||!v.length)return null;h=v.sa;v=v.Pb;let B=-1,X=-1;c=c||this.Ba.Cab(this.jG.value,a);for(a=0;a<c.count;a++)h.node.id===c.J(a).id&&(B=a),v.node.id===c.J(a).id&&(X=a);return Object.assign(new GH,{startParagraphIndex:B,startParagraphOffset:h.Xl,endParagraphIndex:X,endParagraphOffset:v.Tu})}clearDocumentSelection(){HH(this.ya,
this.LA)}hhb(){this.fb&&(this.fb.nf&&this.fb.nf.name===eh.Iw||this.fb.Kf(eh.Iw))}IQn(){this.nDg=N.a.create()}V9e(a){if(a.Gzb)return"";a=this.Ba.text(a);return Fb.AParagraphNode.l1(a," ")}iYh(a,c){a=this.V9e(a);return c<a.length}iyb(a,c){switch(c){case 1:case 2:case 3:this.IQn()}}logMessage(a){const c=[Object.assign(new aa.a,{name:"Message",string:a.message})];Object(re.a)(a.activityName,a.success,a.duration,c)}iSf(a){return!a.Gzb&&this.JJc(a)}JJc(a){const c=this.jG.value;return!!c&&!!c.Lc&&!!a.Mb&&
a.Mb.id.equals(c.Lc.id)}pEn(a){this.Ba.bJc(a)?32===l.AFrameworkApplication.pa.hb(ba.a.hfb,2,new $z.a(a))&&l.AFrameworkApplication.pa.processAction(ba.a.i3e,2):l.AFrameworkApplication.pa.hb(ba.a.Vba,2,null)}Z0(a,c){a=c.node;c=c.property;this.iSf(a)&&c===Ed.a.Pl&&this.iyb(a,3)}Gda(a,c){a=c.node;!c.nif&&this.iSf(a)&&this.iyb(a,1)}Zeb(a,c){a=c.node;this.iSf(a)&&this.iyb(a,2)}EXd(a,c,h){this.ou&&(this.ou.Yl(a),this.ou.Yo(c),this.ou.Mt(h))}rfl(a){let c=null;var h=this.fb?this.fb.nf.name:"";if(!this.yg.pr||
h!==Fc.AFrame.aq&&h!==Fc.AFrame.WJ)return{returnValue:null,zV:c};h=Array.indexOf(this.yg.h0(),this.yg.pr);if(0>h)return{returnValue:null,zV:c};c=this.Ba.Cab(this.jG.value,a);var v=xE.sBd(this.yg.pr.text[0]).split("\n");a=0;v=(1===v.length?v[0]:v.join(" ")).length-1;this.cqb&&h===this.cqb.x4g&&this.Wga.Wwa.Ja(h)&&this.Wga.Wwa.J(h).CYb.length>this.cqb.Pwd&&(a=this.Wga.Wwa.J(h).CYb[this.cqb.Pwd].begin,v=this.Wga.Wwa.J(h).CYb[this.cqb.Pwd].end);return{returnValue:Object.assign(new GH,{startParagraphIndex:c.count+
h,startParagraphOffset:a,endParagraphIndex:c.count+h,endParagraphOffset:v,subdocumentId:"Comment"}),zV:c}}}Object(w.a)(MM,"WordDocumentContentExecutor",FH,[]);class VF{isEditingAllowed(){return!0}}Object(w.a)(VF,"BaseDocumentHelper",null,[406]);class NM extends VF{constructor(){super()}isEditingAllowed(){return Eb.App.oa.Da.isEditingAllowed}}Object(w.a)(NM,"WordDocumentHelper",VF,[]);class OM{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=
this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0}}Object(w.a)(OM,"DocumentContentSearchResult",null,[]);var wQ=b(1648);class PM{constructor(){this.CYb=this.ZQe=null}}Object(w.a)(PM,"CommentFindResults",null,[]);class QM{constructor(){this.end=this.begin=0}}Object(w.a)(QM,"FindResultOffset",null,[]);class RM{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.K$j="Comment";this.Gce=this.Ju=this.Jie=this.Gy=null;this.fJg=0;this.Bs=null;this.xgc=new Ua.a;this.Gcg=
null;this.jG=a;this.Ba=c;this.aqb=h;this.Naa=B;this.LMb=X;this.djc=ma;this.yg=Pa;this.ga=mb;this.ya=Tb;this.LA=rc}get Wwa(){return this.Gcg}initialize(){this.Gy=aC.FindManager.createInstance(this,this.Naa,JC.a.instance,!1,!0)}search(a,c){this.Gy.wTa();this.llf(a)?(this.Ju=c,this.Bs=new Ua.a,a=this.CUe(a),this.Gy.find(a)):c(null)}searchV2(a,c){l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordCommentsInFindPaneSettings");this.Gy.wTa();if(this.llf(a)){this.USh()&&this.ga.hb(Sa.a.m0d,
2,{CommandValueId:a});this.Gce=c;this.fJg=a.totalResultLimit;this.Bs=new Ua.a;a=this.CUe(a);this.Gcg=new em.a;this.Gy.find(a);c=this.Naa.iQc(a.text);c=this.Naa.tDb(c);a=this.LMb.C_b(c.join("|"),a);c=this.yg.h0();for(let B=0;B<c.length;B++){const X=c[B];var h=xE.sBd(X.text[0]).split("\n");h=1===h.length?h[0]:h.join(" ");var v=this.djc.AFc(h,a);if(v)for(let ma of v)v=wQ.a.createInstance(ma.begin,ma.end,N.a.Ee(X.objectId),B,32,!1),this.xgc.add(v),this.Wwa.Ja(B)||this.Wwa.add(B,Object.assign(new PM,{ZQe:h,
CYb:[]}));else r.ULS.sendTraceTag(572343620,313,15,"commentTextIsNull: {0}, findRegexIsNull: {1}",!h,!a)}}else c(null)}get Mlh(){null==this.Jie&&(this.Jie=aC.FindManager.createInstance(this,this.Naa,JC.a.instance));return this.Jie}USh(){var a;return null===(a=l.AFrameworkApplication.K)||void 0===a?void 0:a.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",!1)}highlight(a){var c=this.llf(a);a=c?this.CUe(a):null;var h={};this.USh()&&this.ga.hb(ba.a.tHf,2,h);if(h[Uf.a.On]){if(c){c=
{};h={};var v={};this.ga.hb(ba.a.JVd,2,c);this.ga.hb(Sa.a.IVd,2,h);this.ga.hb(Sa.a.KVd,2,v);if(a.text!=c.CommandValueId||a.matchCase!=h[Uf.a.On]||a.matchWholeWord!=v[Uf.a.On])HH(this.ya,this.LA),this.ga.hb(Sa.a.findInDocument,2,{CommandValueId:a.text,MatchCase:a.matchCase,MatchWholeWord:a.matchWholeWord})}}else h=this.Mlh,h.wTa(),c&&h.find(a)}selectNextPrevHighlight(a){const c=this.Mlh;return 0<c.ri.Tea?(a?c.dDd():c.eDd(),c.ri.SGe-1):-1}CUe(a){let c=qA.a.none;a.matchCase&&(c|=qA.a.matchCase);a.matchWholeWordOnly&&
(c|=qA.a.wholeWordOnly);return CD.a.createQuery(a.query,c)}llf(a){return a&&!!a.query&&0<a.query.length}d1d(){}H_d(){}reset(){}n2e(){}vYb(){if(this.Ju){var a=this.M8g(this.Bs);this.Ju(a)}if(this.Gce){a=new SF;const c=this.Bs.count+this.xgc.count>this.fJg;a.totalResultCount=this.Bs.count+this.xgc.count;a.hasTooManyResults=c;c||(this.Bs.ez(this.Bs.count,this.xgc),a.results=this.M8g(this.Bs));this.Gce(a);this.xgc.clear()}}M8g(a){const c=[];var h=Object.assign(new UF.a,{Myb:!1,Nyb:!1,Pyb:!0});h=this.Ba.Cab(this.jG.value,
h);for(let B of a){var v=B.begin;let X=B.end,ma;a=-1;let Pa=null,mb=0;if(32===B.type){Pa=this.K$j;mb=3;a=h.count+B.Kbb;const Tb=({begin:v,end:X}=JM.a.gqi(this.Wwa.J(B.Kbb).ZQe,v,X)).returnValue;ma=this.aqb.IUe(Tb,v,X,dj.a(B.type));this.Wwa.J(B.Kbb).ZQe=Tb;this.Wwa.J(B.Kbb).CYb.push(Object.assign(new QM,{begin:v,end:X}))}else{for(v=0;v<h.count;v++)if(h.J(v).id===B.kc){a=v;break}ma=this.aqb.Wrd(B)}0<=a&&(a=Object.assign(new OM,{snippet:ma.zSe,subdocumentId:Pa,subdocumentType:mb,startOffsetInSnippet:ma.vMf,
endOffsetInSnippet:ma.sMf-1,paragraphIndex:a,startOffsetInParagraph:B.begin-ma.vMf,endOffsetInParagraph:B.end-ma.sMf-1}),c.push(a))}c.sort((B,X)=>B.paragraphIndex===X.paragraphIndex?B.startOffsetInParagraph-X.startOffsetInParagraph:B.paragraphIndex-X.paragraphIndex);return c}update(){}yIa(a,c){switch(a){case 0:c&&0<c.length&&!this.Bs&&(r.ULS.sendTraceTag(570975814,313,15,"Results container list is null"),this.Bs=new Ua.a);for(let h of c)this.Bs.add(h)}}ghb(){}dispose(){}}Object(w.a)(RM,"WordDocumentSearchProcessor",
null,[367,14,500]);class SM{constructor(a){this.G2h=a}insertOnlinePicture(){}insertHtmlText(a){a&&this.jgf(a.htmlText)}getId(){return"InsertContentExecutor"}jgf(a){return this.executeCommand(zb.a.cHa,a)}executeCommand(a,c){const h=new uh.DictionaryPropertySet;h.setValue(Uc.a.jS,c);h.setValue(Uc.a.NBa,!1);c=this.G2h.processAction(a,1);32===c&&(c=this.G2h.hb(a,2,h));return c}}Object(w.a)(SM,"WordInsertContentExecutor",null,[353,354]);class TM{constructor(a,c,h){this.ohc="undefined";this.IA=a;this.ga=
c||l.AFrameworkApplication.pa;this.qa=h;this.Kij=(this.Pw=!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.a9)&&!!this.qa&&this.qa.$("AutoOpenSearchPaneInDoublePortraitIsEnabled")}eb(){this.ga.Aa(ba.a.AVg,Kc.a.frame,Object(m.a)(this,this.WFl,"invokeSmartLookupPaneWrapper"),1028);this.Kij&&(this.ohc=Eb.App.oa.Vw.getWindowMode(),this.Nhh(this.ohc),Eb.App.oa.Vw.registerBoundingWindowRectsChanged("SearchPane",(a,c)=>{c!==this.ohc&&(this.ohc=c,this.Nhh(this.ohc))}))}Nhh(a){"DP"===a&&Hi.UISurfaces.Ms().then(c=>
{c.selectors.getTabbedTaskPaneCount()||this.ga.hb(ba.a.AVg,2,{SourceControlId:"smartlookupAuto"});return null})}WFl(a,c,h,v,B){return Wt.j4(a,c,h,v,this.IA,B)}}Object(w.a)(TM,"WordInsightsActor",null,[]);class uD{constructor(){this.oN=null}SVa(){return this.ZZb()}Jwh(){return this.ZZb()}Iwh(){return null}Drn(a,c,h){this.oN||(this.oN=this.Hrd());this.oN.NM(a,c,h)}Ern(a,c,h){this.oN||(this.oN=this.Hrd());this.oN.lIi(a,c,h)}LFb(a,c){this.oN||(this.oN=this.Hrd());this.oN.LFb(a,c)}vLd(a){this.oN||(this.oN=
this.Hrd());this.oN.vLd(a)}G$m(){this.oN&&this.oN.i$b()}een(){this.oN&&this.oN.a0d()}qpn(){var a=l.AFrameworkApplication.K.vb("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);a=window.performance.now()-uD.uZh<=a;a||(uD.uZh=window.performance.now());return a}dispose(){this.oN&&(this.oN.dispose(),this.oN=null)}get dAb(){return this.oN?this.oN.isVisible:!1}}uD.uZh=0;Object(w.a)(uD,"InsightsManager",null,[933,14]);class yE{constructor(a,c,h,v,B,X=!0,ma=null,Pa=null){this.W1=this.FL=this.WEa=null;
this.Clc=!1;this.raa=null;this.fb=c;this.jOb=X;this.Tfg=Pa?Pa:new VF;this.Fu=ma;this.Dn=a;this.jOb&&(xa.a.instance.ra("Common.App.SearchCommon.SearchHostRuntime")&&(this.raa=xa.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").c8e()),this.N6a=xa.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.orb=this.N6a.MEc())}hZa(a){if(this.jOb){a=a.rawEvent;try{var c=z.a(a.data)}catch(h){r.ULS.sendTraceTag(595161728,1303,15,this.pR("Message data from Serplet [{0}] failed to deserialize.",
a.data));return}switch(c.actionType){case 101:a=0;this.FL&&(a=this.FL.entryPoint);this.N6a.Z$e(this.W1,this.Tfg,this.fbb(),a).then(h=>{c.data=h;this.Jfb(c)});break;case 118:c.data=this.FL?this.FL:Object.assign(new Vt.a,{selection:Object.assign(new qw.a,{neighborhood:this.WEa.neighborhood,mentionStart:this.WEa.mentionStart,mentionLength:this.WEa.mentionLength})});this.Jfb(c);break;case 103:a=z.a(Object(ha.a)(String,c.data));vl.sendTelemetryEvent(a);break;case 206:this.N6a.OEh(c.data).then(h=>{c.data=
h;this.Jfb(c)});break;case 112:c.data.shiftPressed?(H.a.Qh&&document.activeElement.blur(),this.Dn.rEd(0,null,2,null,null),r.ULS.sendTraceTag(592545156,1303,50,this.pR("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.Dn.IFc(0,null,2,null,null),r.ULS.sendTraceTag(592545155,1303,50,this.pR("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.fja()}}}sUc(a){if(this.raa){var c=0;this.FL&&(c=this.FL.entryPoint);this.N6a.Z$e(this.W1,this.Tfg,this.fbb(),c).then(h=>{vl.izi("SearchFromHost",
this.W1);this.FL.launchData||(this.FL.launchData=new ev.a);const v=RF();try{this.raa.search(this.FL,h,l.AFrameworkApplication.userSessionId,v,a),this.N6a.rAm(B=>{vl.izi("SearchFromHostWithToken",this.W1);this.raa.searchAuthenticatedProviders(this.FL,h,l.AFrameworkApplication.userSessionId,v,null,B)})}catch(B){vl.qz("BaseSmartLookupPane - Fail to search from host. Error: "+B,10)}}).catch(h=>{vl.qz("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+h.toString(),10)})}}j$b(a){if(this.jOb){var c=
vl,h=c.j$b,v=this.W1;a=Math.round(window.performance.now()-a);var B=this.FL?sD[this.FL.entryPoint]:"",X=this.N6a.MEc(),ma=this.N6a.Q_k(),Pa=this.FL?this.FL.entryPoint:0;h.call(c,v,a,B,X,ma,l.AFrameworkApplication.AJe,this.Clc,18===Pa||19===Pa||15===Pa)}}}Object(w.a)(yE,"BaseSmartLookupPane",null,[405,14]);class zE{constructor(a){this.messageType=null;this.messageType=a}}Object(w.a)(zE,"InsightsMessage",null,[]);class AE extends zE{constructor(a,c){super(a);this.messageContent=null;this.messageContent=
c}}Object(w.a)(AE,"InsightsMessageWithContent",zE,[]);class UM extends AE{constructor(a){super(eh.ydm,a)}}Object(w.a)(UM,"InsightsMessageAppProperties",AE,[]);class VM extends AE{constructor(a){super(eh.Ldm,a)}}Object(w.a)(VM,"InsightsMessageSelection",AE,[]);class WM extends zE{constructor(){super(eh.Ndm)}}Object(w.a)(WM,"InsightsMessageTakeFocus",zE,[]);class BE extends yE{constructor(a,c,h,v,B=null,X=null,ma=null,Pa=!0,mb=null,Tb=null){super(c,h,B,X,ma,Pa,mb,Tb);this.F2c=this.Iy=this.Zf=null;this.zcd=
!1;this.D8c=a;this.mkc=this.jOb?CH(this.orb):l.AFrameworkApplication.rEl;this.YW();this.jJf();this.yj=v;this.Jeg=0}get isVisible(){return!1}YW(){this.Zf=this.D8c.Cyc();l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.$cb&&this.Zf.fTm(a=>{a===this.Zf&&(this.a0d(),this.i$b())});this.Mff(this.Zf.wNa.lWg);this.Zf.yk()}Mff(a){a.style.overflow="hidden";const c=Zd.a.createElement("iframe");Sys.UI.DomElement.addCssClass(c,"InsightsPaneIFrame");c.setAttribute("Unselectable","off");this.Iy=c;a.appendChild(this.Iy);
this.Iy.id=eh.kef}jJf(){Ld.a.addHandler(this.Iy,"load",Object(m.a)(this,this.v6b,"onIFrameLoad"));Ld.a.addHandler(this.Iy,"error",Object(m.a)(this,this.Teb,"onIFrameError"));$addHandler(window,"message",Object(m.a)(this,this.hZa,"onIFrameMessage"))}p_f(){Ld.a.removeHandler(this.Iy,"load",Object(m.a)(this,this.v6b,"onIFrameLoad"));Ld.a.removeHandler(this.Iy,"error",Object(m.a)(this,this.Teb,"onIFrameError"));$removeHandler(window,"message",Object(m.a)(this,this.hZa,"onIFrameMessage"))}dispose(){this.Iy&&
(this.p_f(),this.Iy.parentNode.removeChild(this.Iy),this.Iy=null);this.Zf&&(this.D8c.evb(this.Zf),this.Zf=null)}NM(a,c,h){this.W1=c;this.F2c=null;this.Jeg=h;this.Clc=!a.mentionLength;this.zcd=!1;r.ULS.sendTraceTag(6295947,1303,50,this.pR("Start to show Insights"));this.WEa=a;this.mkc&&this.mkc.length?this.Iy.src=this.mkc:(this.Iy.src=BE.J8h,r.ULS.sendTraceTag(6295948,1303,15,this.pR("The Insights URL config setting is null or empty")));this.yj.sendNotification(CommonUIStrings.l_InsightsPaneNotification,
!0);this.Zf.UX||this.Zf.pJf(Object(m.a)(this,this.$om,"onInsightsTaskPaneHidden"));this.jOb&&this.sUc(!1);a=window.performance.now();this.D8c.showTaskPane(this.Zf);this.Zf.yk();this.j$b(a)}lIi(a,c,h){this.FL=a;this.NM(Object.assign(new vE.a,{neighborhood:a.selection.neighborhood,mentionStart:a.selection.mentionStart,mentionLength:a.selection.mentionLength}),c,h)}LFb(){}vLd(){}i$b(){this.Iy.src===this.mkc&&this.zcd&&(this.fb.Kf(eh.Iw),this.Jfb(new WM))}a0d(){this.Iy&&nc.FocusManager.ZM(this.Iy.contentWindow)}nWe(){this.Iy.src=
BE.J8h;this.Zf.Yk()}fja(){this.D8c.hideTaskPane(this.Zf);this.nWe()}$om(a){a===this.Zf&&this.fja()}v6b(){r.ULS.sendTraceTag(6295951,1303,50,this.pR("The iframe is successfully loaded in Insights task pane"))}Teb(){r.ULS.sendTraceTag(6295952,1303,15,this.pR("The iframe failed to load in Insights task pane"))}hZa(a){const c=a.rawEvent;if(c.source===this.Iy.contentWindow)if(this.jOb)super.hZa(a);else{let h;try{h=z.a(c.data)}catch(v){r.ULS.sendTraceTag(6295953,1303,15,this.pR("Message data [{0}] failed to deserialize.",
c.data));return}if(De.c(h.messageType))r.ULS.sendTraceTag(6295954,1303,15,this.pR("Message data [{0}] is in wrong format.",c.data));else switch(h.messageType){case eh.zdm:this.Jfb(new UM(this.i4k()));break;case eh.Mdm:this.Jfb(new VM(this.WEa));break;case eh.Gdm:this.zcd=!0;this.a0d();this.i$b();r.ULS.sendTraceTag(6295955,1303,50,this.pR("Insights pane rendering is completed"));break;case eh.Odm:a=h.messageContent;this.F2c=a.clientCorrelationId;this.W1!==a.appCorrelationId&&r.ULS.sendTraceTag(6403778,
1303,15,this.pR("App correlation ID on client {0} does not match one on server {1}",this.W1,a.appCorrelationId));break;case eh.Fdm:h.messageContent?(H.a.Qh&&document.activeElement.blur(),this.Dn.rEd(0,null,2,null,null),r.ULS.sendTraceTag(6604741,1303,50,this.pR("Insights UX lost focus through Ctrl + Shift + F6"))):(this.Dn.IFc(0,null,2,null,null),r.ULS.sendTraceTag(6604742,1303,50,this.pR("Insights UX lost focus through Ctrl + F6")));break;case eh.Cdm:h.messageContent.keyCode===vb.a.ZCa&&this.fja();
break;case eh.Ddm:try{this.zcd=!1,localStorage.setItem(eh.d_h,"true")}catch(v){r.ULS.sendTraceTag(17961859,1303,10,this.pR("Failed to SetItem in LocalStorage for LegalAgreed"))}}}}i4k(){const a={anid:"00000000-0000-0000-0000-000000000000"};a.appCorrelationId=this.W1;3===l.AFrameworkApplication.na.Ya.Rm?a.applicationName=eh.uZn:4===l.AFrameworkApplication.na.Ya.Rm&&(a.applicationName=eh.Oum);a.applicationVersion=l.AFrameworkApplication.buildVersion;var c=vi.a.af(l.AFrameworkApplication.lcid);c=c?c.name:
null;a.market=BH(c);a.uiLanguage=c;a.sessionId=l.AFrameworkApplication.userSessionId;a.parentalControl=eh.ICf;a.clientType="user";a.legalAgreed=this.l5k();a.defaultDefineTab=1===this.Jeg?"true":null;return a}pR(a,...c){const h={};this.W1&&(h[eh.DNi]=this.W1);this.F2c&&(h[eh.TBn]=this.F2c);h[eh.ENi]=String.format.apply(null,[a].concat(c));return z.c(h)}fbb(){return 5}l5k(){try{const a=localStorage.getItem(eh.d_h);return!!a&&"true"===a}catch(a){return r.ULS.sendTraceTag(17961860,1303,10,this.pR("Failed to GetItem in LocalStorage for LegalAgreed")),
!1}}Jfb(a){a=z.c(a);this.Iy.contentWindow.postMessage(a,Af.a.u8(this.mkc))}}BE.J8h="about:blank";Object(w.a)(BE,"InsightsPane",yE,[]);class XM{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(w.a)(XM,"SmartLookupTaskPaneProps",null,[]);class YM{}Object(w.a)(YM,"ActionDescriptor",null,[]);class ZM extends yE{constructor(a,c,h,v=null,B=null,X=null,ma=!0,Pa=null,mb=null){super(c,h,v,B,X,ma,Pa,mb);this.ZCe=!!l.AFrameworkApplication.na&&!!l.AFrameworkApplication.na.Ya&&l.AFrameworkApplication.na.Ya.umf;
this.nt=this.Rxe=!1;this.xmj=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.vmj=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",844);this.Amj=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.zmj=l.AFrameworkApplication.K.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);ma||vl.qz("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",
10);this.WQa=a;this.xmg=CH(this.orb)}get isVisible(){return this.nt}LFb(a,c){this.FL=a;this.WEa=a=Object.assign(new vE.a,{neighborhood:a.selection.neighborhood,mentionStart:a.selection.mentionStart,mentionLength:a.selection.mentionLength});this.Clc=!a.mentionLength;this.W1=c;this.sUc(!1)}vLd(a){this.FL=a;this.Eac(Object.assign(new vE.a,{neighborhood:a.selection.neighborhood,mentionStart:a.selection.mentionStart,mentionLength:a.selection.mentionLength}),!1)}NM(a,c){this.W1=c;this.Eac(a,!0)}lIi(a,c,
h){this.FL=a;this.NM(Object.assign(new vE.a,{neighborhood:a.selection.neighborhood,mentionStart:a.selection.mentionStart,mentionLength:a.selection.mentionLength}),c,h)}fja(){this.Z9();this.WQa.hideTaskPane()}Eac(a,c){ya.SessionStatusManager.instance.pK&&this.raa?(this.WEa=a,this.Clc=!a.mentionLength,a=window.performance.now(),this.initialize(),this.isVisible?l.AFrameworkApplication.K.$("SmartLookupDisableRefreshPaneIsEnabled")?(this.WQa.updateTaskPane(null),c&&this.jan()):(c&&this.sUc(!1),this.Rxe=
!this.Rxe,this.WQa.updateTaskPane(this.Tz())):(c&&this.sUc(this.isVisible),this.WQa.showTaskPane(this.Tz())),this.j$b(a)):(this.WQa.showTaskPane(this.Tz()),vl.I$m(ya.SessionStatusManager.instance.pK,!!this.raa,this.FL?sD[this.FL.entryPoint]:"",this.N6a.MEc(),l.AFrameworkApplication.AJe,this.Clc))}jan(){if(!this.FL){const a=Object.assign(new qw.a,{neighborhood:this.WEa.neighborhood,mentionStart:this.WEa.mentionStart,mentionLength:this.WEa.mentionLength});this.FL=Object.assign(new Vt.a,{selection:a,
userIntent:null,entryPoint:0,launchData:null})}this.sUc(this.isVisible)}P$m(){const a=new YM;a.transactionId=this.W1;a.actionType=15;a.channelId=eh.channelId;this.Jfb(a)}hZa(a){const c=a.rawEvent;document.getElementById(eh.Iw)&&c.source!==document.getElementById(eh.Iw).contentWindow||(l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)?this.JMm(a):super.hZa(a))}JMm(a){const c=a.rawEvent;let h;try{h=z.b(c.data)}catch(v){r.ULS.sendTraceTag(545604257,
1303,15,this.pR("Message data from Serplet [{0}] failed to deserialize.",c.data));return}switch(h.actionType){case 32:ye.a.nWa()>=this.xmj?this.WQa.updateTaskPane(this.SUe(this.vmj)):ye.a.nWa()>=this.Amj&&this.WQa.updateTaskPane(this.SUe(this.zmj));break;case 33:this.WQa.updateTaskPane(this.SUe(h.data));break;default:super.hZa(a)}}dispose(){}initialize(){this.YW();this.Bea()}YW(){this.WQa.Cyc()}Bea(){const a=this.fb.fd(eh.Iw);a.parent=Fc.AFrame.uo;a.rK=!0}men(){this.fb.Kf(eh.Iw)}Z9(){this.YXa()&&
this.fb.Kf(this.fb.$Q)}jJf(){$addHandler(window,"message",Object(m.a)(this,this.hZa,"onIFrameMessage"))}p_f(){$removeHandler(window,"message",Object(m.a)(this,this.hZa,"onIFrameMessage"))}YXa(){return!!this.fb.nf&&this.fb.nf.name===eh.Iw}Jfb(a){a=z.c(a);document.getElementById(eh.Iw)&&document.getElementById(eh.Iw).contentWindow.postMessage(a,Af.a.u8(this.xmg))}pR(a,...c){const h={};this.W1&&(h[eh.DNi]=this.W1);h[eh.ENi]=String.format.apply(null,[a].concat(c));return z.c(h)}fbb(){return yh.a("isSharedUXDarkModeOn")&&
appChrome.api.isSharedUXDarkModeOn()?3:0}Mdi(){if(this.raa)this.raa.onPaneThemeChanged(this.fbb());return yh.a("getTheme")?appChrome.api.getTheme():null}i$b(){}a0d(){document.getElementById(eh.Iw)&&nc.FocusManager.ZM(document.getElementById(eh.Iw).contentWindow)}Teb(){vl.qz("ReactSmartLookupPane - Iframe component failed to load.",10)}v6b(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||vl.qz("ReactSmartLookupPane - Onload detected no network.",
50)}Tz(){var a=new XM;a.src=this.xmg;a.id=eh.Iw;a.refreshPane=this.Rxe;a.onError=Object(m.a)(this,this.Teb,"onIFrameError");a.onLoad=Object(m.a)(this,this.v6b,"onIFrameLoad");a.title=eh.yfb;ya.SessionStatusManager.instance.pK?this.raa||(a.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,a.errorType=1):(a.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,a.errorType=0);a=Object.assign(new qn.a,{title:eh.yfb,hideHeader:!1,width:eh.width,location:eh.Kxm,contentProps:a,
isModernPane:!0,onOpen:()=>{this.men();this.nt=!0;this.jJf();yh.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(m.a)(this,this.Mdi,"onThemeIdChanged"));l.AFrameworkApplication.na.updateCommandUI();if(this.raa)this.raa.onPaneStateChanged(!0)},onClose:()=>{this.P$m();this.Z9();this.nt=!1;this.p_f();yh.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(m.a)(this,this.Mdi,"onThemeIdChanged"));l.AFrameworkApplication.na.updateCommandUI();
if(this.raa)this.raa.onPaneStateChanged(!1)}});this.ZCe&&(a.enableResize=!0,a.minResizeWidth=320,a.maxResizeWidth=920);return a}SUe(a){const c=this.Tz();c.resizeWidth=a;return c}}Object(w.a)(ZM,"ReactSmartLookupPane",yE,[]);class $M{Cyc(){const a=new bk.CuiHelper(uk.a.z8a,WordEditorIntl.WordEditorStrings);return vp.a.instance.UUe(eh.Iw,eh.m7b,eh.width,eh.fXf,a)}showTaskPane(a){vp.a.instance.showTaskPane(a)}hideTaskPane(a){vp.a.instance.hideTaskPane(a)}evb(a){vp.a.instance.evb(eh.Iw,a)}}Object(w.a)($M,
"WordInsightsPaneHandler",null,[386]);class aN{Cyc(){vp.a.instance.OHa()}showTaskPane(a){Hi.UISurfaces.Ms().then(c=>{c.showTaskPane(eh.Iw,a);return null})}updateTaskPane(a=null){Hi.UISurfaces.Ms().then(c=>{c.setSelectedTaskPane(eh.Iw);a&&c.updateTaskPane(eh.Iw,a);return null})}hideTaskPane(){Hi.UISurfaces.Ms().then(a=>{a.hideTaskPane(eh.Iw,2);return null})}}Object(w.a)(aN,"WordReactSmartLookupPaneHandler",null,[385]);class bN extends uD{constructor(a,c){super();this.Cs=a;this.ya=c}Hrd(){const a=!!l.AFrameworkApplication.na&&
!!l.AFrameworkApplication.na.Ya&&l.AFrameworkApplication.K.$("SmartLookupEnableNativePane");return l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya&&l.AFrameworkApplication.na.Ya.qlf?new ZM(new aN,pj.a.instance,nc.FocusManager.instance(),xa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),xa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),xa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),a,xa.a.instance.za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
xa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper")):new BE(new $M,pj.a.instance,nc.FocusManager.instance(),xa.a.instance.resolve("Common.Utils.IAriaNotifier"),xa.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),xa.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),xa.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),a,xa.a.instance.za("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),xa.a.instance.resolve("Common.App.SearchCommon.IDocumentHelper"))}ZZb(){return this.Cs.getSelectedText()}Iwh(){if(!this.ya||
!this.ya.Ca||1>this.ya.Ca.length)return null;var a=this.ya.Ca.Fa.sa;a=null==a?null:ua.FormattingReader.zr(a);return(a=null==a?null:vi.a.af(ua.FormattingReader.language(a)))?a.name:""}SVa(){return this.Cs.tCh()}Jwh(){return this.Cs.tCh()}gTh(){return this.Cs.WIl()}}Object(w.a)(bN,"WordInsightsManager",uD,[]);var xQ=b(156);class cN{}Object(w.a)(cN,"CommandMetadataResponse",null,[]);class yC{constructor(){this.nef=this.getAllIcons()}executeCommand(){}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){xQ.PrivacyDialogManager.W1d()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(a){const c=
new cN;a.iconNames&&(c.svgData=this.getCommandIconSvg(a.iconNames));if(!a.commandId||""===a.commandId)return c;try{c.label=appChrome.selectors.getControlLabel(a.commandId);if(c.svgData&&""!==c.svgData)return c;const h=appChrome.selectors.getControlIconSet(a.commandId),v=Array(2);v[0]=h["default"];v[1]=h.icon32;c.svgData=this.getCommandIconSvg(v)}catch(h){return null}return c}getCommandIconSvg(a){if(!this.nef)return"";for(let c=0;c<a.length;c++){const h=a[c];if(h in this.nef)return this.nef[h]}return""}getAllIcons(){return{}}createFeedbackPropertiesFromData(a){const c=
{SourceControlId:"GiveFeedback"};c.feedbackType="true"===a.IsPosFeedback?0:1;const h={};h.featureArea=yC.fGk;c.telemetryGroup=h;c.appData=a;return c}}yC.CJh="FA000000012";yC.vli="AssetID=";yC.fGk="SearchPane";Object(w.a)(yC,"BaseSerpletExecutor",null,[387,354]);class dN extends yC{constructor(a,c,h){super();this.ga=a;this.ya=c;this.LA=h}executeCommand(a){if(!a)throw Error("Missing commandData argument");switch(a.CommandId){case 0:this.ga.hb(zb.a.iBb,2,null);break;case 1:this.ga.hb(ba.a.XGb,2,null);
break;default:throw Error(`Unknown commandId requested: ${a.CommandId}`);}}browseFiles(){this.ga.hb(Sa.a.pHd,2,null)}openHelpTaskPane(){}openFeedbackPane(a){this.ga.hb(Sa.a.V9b,2,this.createFeedbackPropertiesFromData(a))}openFindReplaceTaskPane(a){const c={};c.CommandValueId=a;c.SourceControlId="Insights";this.ga.hb(Sa.a.j2e,2,c)}openFindReplaceTaskPaneV2(a){a={CommandValueId:a.Query,MatchCase:a.MatchCase,MatchWholeWord:a.MatchWholeWordOnly};HH(this.ya,this.LA);this.ga.hb(Sa.a.j2e,2,a)}openFindTaskPane(a){const c=
{};c.CommandValueId=a;c.SourceControlId="Insights";this.ga.hb(Sa.a.findInDocument,2,c)}openNavigationPane(){this.ga.hb(ba.a.zac,2,null)}openSerpletTaskPane(){this.ga.hb(Sa.a.iPh,2,null)}sendAutoLaunchSearchRequest(){this.ga.hb(Sa.a.kHd,2,null)}getAllIcons(){const a={};for(const h of Object.keys(window))if(h.startsWith("word")){var c=window[h];c&&(c=c.icons,null!==c&&void 0!==c&&c.length&&c.forEach(v=>a[v.id]=JSON.stringify(v)))}return a}}Object(w.a)(dN,"WordSerpletExecutor",yC,[]);class eN extends EH{constructor(){super();
this.fve=null}get name(){return"WordEditor.Insights"}init(){l.AFrameworkApplication.EX&&(this.fve.ra("WordEditor.Insights.WordInsightsActor").eb(),l.AFrameworkApplication.K.$("SmartLookupEnableNativePane")&&l.AFrameworkApplication.K.$("DownloadSmartLookupRuntimeDuringPkgInitIsEnabled")?l.AFrameworkApplication.K.Io(Object(m.a)(this,this.Mv,"onFullAppSettingsReady")):super.init())}Mv(){l.AFrameworkApplication.EX&&(this.nyk(),Yg.a.Yn().then(()=>this.fve.resolve("WordEditor.Insights.IAugloopSearchProviderManager")))}yb(a){super.yb(a);
this.fve=a;a.ha("Box4.Insights.Box4InsightsSelection",()=>new Bo.a).as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").singleInstance();a.ha("WordEditor.Insights.WordInsertContentExecutor",()=>new SM(l.AFrameworkApplication.pa)).as("Common.App.SearchCommon.IInsertContentExecutor").singleInstance();a.ha("WordEditor.Insights.WordSerpletExecutor",()=>new dN(l.AFrameworkApplication.pa,$c.a.instance,a.resolve("Box4.ISelectionFactory"))).as("Common.App.SearchCommon.ISerpletExecutor").singleInstance();
a.ha("WordEditor.Insights.AugloopSearchProviderManager",()=>new xC(a.resolve("Box4.AugmentationLoop.IAnnotationStorage"),a.resolve("Common.App.Insights.IDocumentContentExtractionManager"))).as("WordEditor.Insights.IAugloopSearchProviderManager").singleInstance();a.ha("WordEditor.Insights.WordDocumentContentExecutor",()=>{const c=new RM(new qf.a(()=>Eb.App.oa?Eb.App.oa.Da.Zb:null),a.resolve("Box4.IParagraphReader"),JM.a.instance,l.AFrameworkApplication.K,$B.a.instance,qQ.a.instance,a.resolve("Box4.Search.IFindManagerHelper"),
a.resolve("Common.Comments.ICommentModel"),l.AFrameworkApplication.pa,$c.a.instance,a.resolve("Box4.ISelectionFactory"));c.initialize();return new MM(new qf.a(()=>Eb.App.oa?Eb.App.oa.Da.Zb:null),a.resolve("Box4.IParagraphReader"),ec.InteractiveViewManager.instance,$c.a.instance,a.resolve("Box4.ISelectionFactory"),c,Eb.App.aj.Pk.Yd(12),new qf.a(()=>Eb.App.oa.Da),nc.FocusManager.instance(),l.AFrameworkApplication.K,a.resolve("Common.Comments.ICommentModel"),a.resolve("Common.App.Insights.IInsightsSelection"),
a.za("WordEditor.Insights.IAugloopSearchProviderManager"))}).as("Common.App.SearchCommon.IDocumentContentExecutor").singleInstance();a.ha("WordEditor.Insights.WordInsightsManager",()=>new bN(a.resolve("Common.App.Insights.IInsightsSelection"),a.resolve("Box4.ISelectionManager"))).as("Common.App.Insights.IInsightsManager").singleInstance();a.ha("WordEditor.Insights.WordInsightsActor",()=>new TM(a.te("Common.App.Insights.IInsightsManager"),l.AFrameworkApplication.pa,l.AFrameworkApplication.K)).singleInstance();
a.ha("Common.App.SearchCommon.IDocumentHelper",()=>new NM).singleInstance()}}Object(w.a)(eN,"WordInsightsPackage",EH,[]);class yQ{}Object(w.a)(yQ,"ScalingStep",null,[]);class fN{constructor(a,c,h){this.Rkc=!1;this.VV=null;this.Urc=this.SNb=!1;this.XRa=[];this.UYd=v=>{this.k6&&this.k6!==v&&appChrome.api.dispatch(this.hCh(!1))};c.execute(v=>{this.VV=v});a.aC(Object(m.a)(this,this.Fsm,"onProcessSetSelectionFinished"));this.tu=h}I_b(a,c,h){const v=[];for(const B of a)v.push(appChrome.actions.addScalingStepInTab("Home",
{type:c,controlId:B},h));return v}IAh(a){const c=[];for(let h=0;4>h;h++)c.push(appChrome.actions.addScalingStepInTab("Home",{type:"DropPreviewItemFromGallery",controlId:a},2>h?0:void 0));c.push(appChrome.actions.addScalingStepInTab("Home",{type:"GalleryToFlyout",controlId:a},void 0));return c}hCh(a){const c=[];if(a)switch(this.k6){case "Image":c.push(appChrome.actions.removeControlScalingStepsFromTab("TextAlignmentAnchor","Home"));c.push(...this.IAh("PictureStyles"));c.push(...this.I_b("RotatePictureMenu PictureBorders PictureStyles CropPictureMenu WrapTextMenu EditPictureAltText".split(" "),
"DropLabel"));a=this.XRa.slice().reverse();a.push("TextAlignmentAnchor");c.push(...this.I_b(a,"MoveToOverflow"));break;case "Table":this.Urc||c.push(...this.IAh("TableStyles"));c.push(...this.I_b(this.XRa,"DropLabel",this.Urc?0:void 0));a=this.XRa.slice().reverse();c.push(...this.I_b(a,"MoveToOverflow"));break;case "Hyperlink":c.push(...this.I_b(["EditHyperlink","RemoveHyperlink"],"DropLabel")),a=this.XRa.slice().reverse(),c.push(...this.I_b(a,"MoveToOverflow"))}else for(const h of this.XRa)c.push(appChrome.actions.removeControlScalingStepsFromTab(h,
"Home"));return c}vZc(a){let c={};for(const h of a)try{c[h]=appChrome.selectors.getModelType(h)}catch(v){this.l9("Error","GetModelType failed for "+h)}Eb.App.oa.C3e(c)}GLn(a){if(0!==a.length){var c=[],h={},v=!1;for(const B of a)try{if(appChrome.selectors.isControlDefined(B))h[B]=appChrome.selectors.getModelType(B);else{v=!0;break}}catch(X){this.l9("Error","GetModelType failed for "+B);v=!0;break}if(v)this.k6=void 0,this.W6d(!1);else{if("Image"===this.k6&&!this.SNb)c.push(appChrome.actions.updateGroupHiddenState("Font",
!0)),this.SNb=!0;else if(this.SNb){c.push(appChrome.actions.updateGroupHiddenState("Font",!1));v=appChrome.selectors.getVisibleControlsInGroup("Font");for(const B of v)h[B]=appChrome.selectors.getModelType(B);this.SNb=!1}Eb.App.oa.C3e(h);this.XRa=a;h=[];for(const B of a)appChrome.selectors.isControlDisabled(B)&&h.push(B);0<h.length&&this.l9("Disabled",h.join(","));0<this.XRa.length&&(c.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),c.push(appChrome.actions.updateControlsInGroup("Adaptive",
this.XRa)),c.push(...this.hCh(!0)),this.Rkc=!0);appChrome.api.dispatch(c)}}}W6d(a){if(a||this.Rkc){var c=[];c.push(appChrome.actions.updateGroupHiddenState("Adaptive",!a));this.Rkc=a;if("Image"===this.k6||this.SNb){a=!a;c.push(appChrome.actions.updateGroupHiddenState("Font",!a));if(a){const h=appChrome.selectors.getVisibleControlsInGroup("Font");this.vZc(h)}this.SNb=!a}appChrome.api.dispatch(c)}}W5d(){this.Rkc&&this.tu&&this.tu.execute(a=>{a.logActivity("AdaptiveContextualGroupShown",null)})}Fsm(a,
c){!l.AFrameworkApplication.na.Ya.lac&&"Home"===appChrome.selectors.getSelectedTabId()&&this.VV&&c.rk&&c.rk.Fa&&0!==c.rk.length?(a=()=>{let h=[],v=!1;var B=this.VV.contentType,X=appChrome.selectors.getActiveContextualTabIds();B.includes("Image")?(this.UYd("Image"),this.k6&&"Image"===this.k6?v=!0:(h="PictureStyles PictureBorders WrapTextMenu RotatePictureMenu CropPictureMenu PictureAbsoluteHeight PictureAbsoluteWidth LockAspectRatio EditPictureAltText FormatPictureOptions".split(" "),this.k6="Image")):
B.includes("Table")&&0<=X.indexOf("Table")?(B=!(yr.a.instance.Fa.dAa||yr.a.instance.Fa.kv||yr.a.instance.Fa.HAb),(X="Table"===this.k6&&B!==this.Urc)?this.UYd("TableCellEdit"):this.UYd("Table"),!this.k6||"Table"!==this.k6||X?(B?(h=["SelectTableMenu","DeleteTableMenu","InsertTableMenu","AlignmentTableMenu"],this.Urc=!0):(h="SelectTableMenu DeleteTableMenu InsertTableMenu AlignmentTableMenu MergeCells SplitCells TableDistributeMenu TableStyles ChangeColorsTable StyleOptionsTableMenu CellShading EditTableAltText BorderGallery TableBorderColor".split(" "),
this.Urc=!1),this.k6="Table"):v=!0):B.includes("Hyperlink")&&(this.UYd("Hyperlink"),this.k6&&"Hyperlink"===this.k6?v=!0:(h=["EditHyperlink","RemoveHyperlink","CopyHyperlink","OpenHyperlink"],this.k6="Hyperlink"));v?this.Rkc||(this.vZc(this.XRa),this.W6d(!0),this.W5d()):0<h.length?(this.GLn(h),this.W5d()):this.W6d(!1)},"requestIdleCallback"in window?window.requestIdleCallback(a):window.requestAnimationFrame(a)):this.W6d(!1)}l9(a,c){a={Time:(new Date).getTime(),Event:a,Message:c,Scenario:"AdaptiveTabGroup"};
c=new wg.a;c.name="Events";c.dataFields=um.a.aR(a);c.durationMs=window.performance.now();Z.a.QBa(c,"TellMeWAC.")}}Object(w.a)(fN,"AdaptiveTabGroupUpdater",null,[]);class gN{constructor(){this.W=null}get name(){return"WordEditor.RibbonIntelligence"}yb(a){this.W=a}init(){pB(1,Object(m.a)(this,this.Ckm,"onAppChromeLazyLoad"))}Ckm(){l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableAdaptiveTabGroupUpdater",!1)&&!H.a.dA&&(this.W.ha("WordEditor.UI.AdaptiveTabGroupUpdater",
()=>new fN(this.W.resolve("Box4.ISelectionManager"),this.W.za("Common.IActionContextProvider"),this.W.za("Common.ISystemInitiatedFeedback"))).singleInstance(),this.W.resolve("WordEditor.UI.AdaptiveTabGroupUpdater"))}dispose(){}}Object(w.a)(gN,"PackageManager",null,[1,2]);const zQ=(a,c,h)=>1===h?32:2===h?(b.e(6).then(b.bind(null,1809)).then(v=>{v.createAndShowDevToolsMenu()}),32):2;class IH{constructor(){this.name="WordEditor.DevTools"}init(){if(window.g_wordDevToolsIsEnabled||l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.DevToolsIsEnabled",
!1))l.AFrameworkApplication.pa.ka(ba.a.aTf,Kc.a.frame,zQ),null!==sessionStorage.getItem("devToolsRefresh")&&b.e(6).then(b.bind(null,1809))}dispose(){}yb(){}static main(){M.a.instance.Lb(new IH)}}Object(w.a)(IH,"WordDevToolsPackage",null,[1,2]);var io=b(537);class JH{constructor(){this.underline=this.strikethrough=this.italic=this.highlight=this.fontColor=this.bold=null}}Object(w.a)(JH,"FormattingData",null,[]);class hN extends JH{constructor(){super();this.hyperlinkData=null}}Object(w.a)(hN,"RichContentCommandData",
JH,[]);class hi{constructor(){hi.Hh.add(ba.a.C0a);hi.Hh.add(ba.a.qHb);hi.Hh.add(ba.a.tbc);hi.Hh.add(ba.a.QV);hi.Hh.add(ba.a.Tvf);hi.Hh.add(ba.a.VEf);hi.Hh.add(ba.a.deleteComment);hi.Hh.add(ba.a.hzc);hi.Hh.add(ba.a.SWe);hi.Hh.add(ba.a.m2d);hi.Hh.add(ba.a.QNa);hi.Hh.add(ba.a.aTf);hi.Hh.add(ba.a.XGb);hi.Hh.add(ba.a.hTf);hi.Hh.add(ba.a.dAc);hi.Hh.add(ba.a.hud);hi.Hh.add(zb.a.Ctd);hi.Hh.add(zb.a.openInClient);hi.Hh.add(zb.a.print);hi.Hh.add(zb.a.zVd);hi.Hh.add(zb.a.eHf);hi.Hh.add(zb.a.AEb);hi.Hh.add(zb.a.iBb);
hi.Hh.add(Sa.a.MOi);hi.Hh.add(Sa.a.tellMe);hi.Hh.add(Sa.a.aYc);hi.Hh.add(Sa.a.V9b);hi.Hh.add(Sa.a.giveFeedback);hi.Hh.add(Sa.a.oWc);hi.Hh.add(Sa.a.TSf);hi.Hh.add(Sa.a.v2f);hi.Hh.add(Sa.a.M$a);hi.Hh.add(Sa.a.newComment);hi.Hh.add(Sa.a.CQe);hi.Hh.add(Sa.a.QKa);hi.Hh.add(Sa.a.xLf);hi.Hh.add(Sa.a.wLf);hi.Hh.add(Sa.a.yLf);hi.Hh.add(Sa.a.Dtd);hi.Hh.add(Sa.a.dha);hi.Hh.add(Sa.a.PTf);hi.Hh.add(Sa.a.AHi);hi.Hh.add(Sa.a.close);hi.Hh.add(Sa.a.oWd);hi.Hh.add(Sa.a.FVd);hi.Hh.add(Sa.a.PSd);hi.Hh.add(Sa.a.w2d);
hi.Hh.add(Sa.a.B2d);hi.Hh.add(Sa.a.UDb);hi.Hh.add(Sa.a.renameFile);hi.Hh.add(Sa.a.s1b);hi.Hh.add(Sa.a.qIi);hi.Hh.add(Sa.a.s2d);hi.Hh.add(Sa.a.downloadACopy);hi.Hh.add(Sa.a.R9b);hi.Hh.add(Sa.a.CUd);hi.Hh.add(Sa.a.uEb);hi.Hh.add(Sa.a.Ali);hi.Hh.add(Sa.a.z3g);hi.Hh.add(Sa.a.Ppd);hi.Hh.add(Sa.a.BQe);hi.Hh.add(Sa.a.B3g);hi.Hh.add(Sa.a.A3g);hi.Hh.add(Sa.a.CQe);hi.Hh.add(Sa.a.Qpd);hi.Hh.add(ba.a.U8d);hi.Hh.add(ba.a.k3f);hi.Hh.add(ba.a.zoomToPageWidth);hi.Hh.add(ba.a.mOf);hi.Hh.add(ba.a.Vfb);hi.Hh.add(ba.a.JWd);
hi.Hh.add(ba.a.dfa);hi.Hh.add(Sa.a.Wbb);hi.Hh.add(Sa.a.K9a);hi.Hh.add(Sa.a.Kac);hi.Hh.add(Sa.a.p_i);hi.Hh.add(Sa.a.Hli);hi.Hh.add(zb.a.GDb);hi.Hh.add(zb.a.Ida)}}hi.Hh=new Set;Object(w.a)(hi,"CommentRibbonCommands",null,[]);class iN{constructor(a,c,h,v,B,X){this.g8h=a;this.Zu=c;this.SJ=h;this.Wx=v;this.ee=B;this.ZCn=X;this.FQb=null;this.Yta=new Yc.a(0);this.skb=new Yc.a(0);this.ace=new Yc.a(0);this.WEe=!1;this.Vzl();this.PTm()}aIl(a){return this.FQb&&this.SJ.vF?!hi.Hh.has(a):!1}GFc(a,c,h){if(a===Sa.a.pf)return 32;
if(!this.Yta.Ja(a)&&!this.skb.Ja(a)||!this.FQb)return 2;const v=this.skb.Ja(a);var B=v?this.skb.J(a):this.Yta.J(a);const X=v?2:this.ace.J(h);v||1!==X||(this.wLl(Eb.App.oa.Pn.nf.name)||Eb.App.oa.Pn.Kf(this.Zu.An?Fc.AFrame.aq:Fc.AFrame.WJ),Eb.App.oa.updateCommandUI(!0));h=new hN;if(this.Wx.Qzb)switch(B){case 1:h.highlight={color:this.hBh(c.Color)};break;case 6:h.fontColor={color:this.hBh(c.Color)}}B=this.FQb.executeCommand(B,X,h);2===B&&v&&(a===zb.a.g8b?c[Uf.a.On]=!!h.bold:a===zb.a.m8b?c[Uf.a.On]=!!h.italic:
a===zb.a.y8b?c[Uf.a.On]=!!h.underline:a===zb.a.s8b?c[Uf.a.On]=!!h.strikethrough:a===zb.a.BY?c[Uf.a.On]=!!h.highlight:a===zb.a.at&&(c[Uf.a.On]=!!h.fontColor));return 2===B?32:1===B?2:8}dRm(a){this.FQb=a;this.FQb.registerSelectionChangeHandler(()=>{this.WEe||(this.WEe=!0,Eb.App.oa.updateCommandUI(!0),this.WEe=!1)});this.FQb.registerKeypressHandler(c=>{if(c.shortKey)switch(c.key){case vb.a.JJb:case vb.a.q$d:case vb.a.w$d:case vb.a.vOa:Eb.App.oa.updateCommandUI(!0)}c.key!==vb.a.PC&&c.key!==vb.a.U5||Eb.App.oa.updateCommandUI(!0)})}PTm(){this.g8h.jpi(Fc.AFrame.aq,
this);this.g8h.jpi(Fc.AFrame.WJ,this)}Vzl(){this.Yta.Z(zb.a.bold,0);this.Yta.Z(zb.a.setItalic,3);this.Yta.Z(zb.a.strikethrough,4);this.Yta.Z(zb.a.underline,5);this.Wx.Qzb&&(this.Yta.Z(zb.a.BY,1),this.Yta.Z(zb.a.zha,1),this.Yta.Z(zb.a.at,6),this.Yta.Z(zb.a.A3,6),this.Yta.Z(zb.a.jla,6));this.skb.Z(zb.a.g8b,0);this.skb.Z(zb.a.m8b,3);this.skb.Z(zb.a.s8b,4);this.skb.Z(zb.a.y8b,5);this.ace.Z(1,0);this.ace.Z(2,1)}wLl(a){return a===Fc.AFrame.aq||a===Fc.AFrame.WJ}hBh(a){return a?kn.a.SA(this.ZCn.Twa(this.ee.sc,
a)):""}}Object(w.a)(iN,"CommentRibbonCommandHandler",null,[306,307]);class KH{constructor(){this.W=null}get name(){return"WordEditor.CommentsRibbonHandler"}init(){this.W.resolve("WordEditor.Comments.ICommentRibbonCommandHandler");this.W.resolve("WordEditor.Comments.CommentsState").MHf?this.W.resolve("WordEditor.Comments.CommentRibbonCommands"):this.W.resolve("WordEditor.Comments.WordCommentEventsActor").dgb("OnCommentRenderedOnce",()=>{this.W.resolve("WordEditor.Comments.CommentRibbonCommands")})}dispose(){}yb(a){this.W=
a;this.W.ha("WordEditor.Comments.CommentRibbonCommandHandler",()=>new iN(this.W.ra("Common.INonCanvasCuiUser"),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.CommentsSettings"),S.App.Hk.Da.Jb,Uj.a.instance)).as("WordEditor.Comments.ICommentRibbonCommandHandler").singleInstance();this.W.ha("WordEditor.Comments.CommentRibbonCommands",()=>new hi).singleInstance()}static main(){M.a.instance.Lb(new KH)}}Object(w.a)(KH,
"PackageManager",null,[1,2]);var AQ=b(1404),jN=b(1416);class LH{get name(){return"Common.App.OAuth.OAuthPackage"}yb(a){a.register(350,"Common.App.OAuth.IOAuthManager").singleInstance().Pc(()=>new AQ.OAuthManager)}init(){const a=xa.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.MIn(a)}MIn(a){const c=l.AFrameworkApplication.K.Ga("FileSource");if(l.AFrameworkApplication.K.$("IsO365ConsumerHost")||l.AFrameworkApplication.K.$("IsO365CommercialHost")||"WopiTest"===c){var h=O.a.rOk,v=O.a.authority;
if(void 0!==h&&null!==h&&h.length&&void 0!==v&&null!==v&&v.length){var B=jN.a[a.ufa],X=H.a.wD,ma=a.oI();try{var Pa=new Map;void 0!==Pa&&null!==Pa?(Pa.set("SupportStatus",B),Pa.set("Browser",X),Pa.set("AuthStrategy",ma)):Pa=null}catch(Tb){Pa=null}Fa.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",Pa);var mb=Ve.a.ie();a.Pla("Core",h).then(Tb=>{var rc=Math.floor(Ve.a.ie()-mb);B=jN.a[a.ufa];X=H.a.wD;ma=a.oI();r.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',
rc,Tb.IsSuccess,B,Tb.ErrorCode,c,X,ma);Pa&&(Pa.set("SupportStatus",B),Pa.set("Browser",X),Pa.set("AuthStrategy",ma));rc=Object.assign(new pb.a,{durationMs:rc,extendedProperties:Pa});Tb.IsSuccess?Fa.Health.instance.recordKpiSuccess("WacCorePFT",rc):Fa.Health.instance.recordKpiFailure("WacCorePFT",Tb.ErrorCode,!1,!1,rc)})}}}dispose(){}static main(){M.a.instance.Lb(new LH)}}Object(w.a)(LH,"OAuthPackage",null,[1,2]);class kN{constructor(){this.xfd=new Yc.a}zIn(a,c){if(!a)return r.ULS.sendTraceTag(40478031,
306,10,"SDX AssetId is null."),!1;a=F.a.kg(a);if(this.xfd.Ja(a))return r.ULS.sendTraceTag(40478032,306,10,"ISdxPaneSuppressionHandler already registered for SDX AssetId: {0}.",a),!1;this.xfd.Z(a,c);return!0}Q9e(a){if(!a)return r.ULS.sendTraceTag(40478033,306,10,"SDX AssetId is null."),null;a=F.a.kg(a);return this.xfd.Ja(a)?this.xfd.J(a):(r.ULS.sendTraceTag(40478034,306,10,"ISdxPaneSuppressionHandler does not exist for SDX AssetId: {0}.",a),null)}}Object(w.a)(kN,"SdxPaneSuppressionManager",null,[]);
class lN{constructor(a){this.tte=0;this.znj=a}seb(){return this.tte>=this.znj}reset(){this.tte=0}update(){this.tte++}}Object(w.a)(lN,"NodeCountBasedTaskYieldStrategy",null,[503]);class mN{constructor(){this.UUc=new Set}WSm(a){this.UUc.add(a)}FKn(a){this.UUc.delete(a)}Ksm(){return()=>{this.UUc.forEach(a=>{a.onSessionClose()})}}Lsm(){return()=>{this.UUc.forEach(a=>{a.onSessionConnect()})}}Msm(){return()=>{this.UUc.forEach(a=>{a.onSessionDisconnect()})}}}Object(w.a)(mN,"AlSessionLifeEventNotifier",null,
[309]);var MH=b(1208),nN=b(620),BQ=b(400),CQ=b(495);class oN{constructor(){this.token=null}}Object(w.a)(oN,"ReleaseAnnotationParameters",null,[]);class pN{constructor(){this.value=this.id=this.parentPath=null}}Object(w.a)(pN,"SetAnnotationMetadataParameters",null,[]);class qN{constructor(){this.id=this.parentPath=null;this.value=0}}Object(w.a)(qN,"SetAnnotationStateParameters",null,[]);var vD=b(1417),WF=b(304);class rN extends Sys.EventArgs{constructor(a,c){super();this.annotation=a;this.Y7a=c}}Object(w.a)(rN,
"AnnotationLocalStateChangedEventArgs",Sys.EventArgs,[]);class NH{constructor(a){this.IRg=this.le=null;if(!a)r.ULS.sendTraceTag(41418884,389,10,"Null operation received!"),this.le=null;else if(a.items&&0<a.items.length){const c=NH.nBd(a.parentPath);this.le=Array(a.items.length);let h=0;for(const v of a.items){const B=Object.assign(new MI.a,{id:v.id,parentPath:c,content:v.body,annotationType:Un.a.getTypeNameFor(v.body),parentRevId:a.parentRevId});this.le[h++]=B}this.IRg=Un.a.getTypeNameFor(a)}}static nBd(a){return a?
a.join("\\"):""}}Object(w.a)(NH,"AnnotationOperation",null,[]);class OH extends Sys.EventArgs{constructor(a,c){super();this.annotationType=a;this.activated=c}}Object(w.a)(OH,"AnnotationActivationEventArgs",Sys.EventArgs,[]);class wD extends Sys.EventArgs{constructor(a,c){super();this.annotation=a;this.opType=c}}Object(w.a)(wD,"AnnotationOperationEventArgs",Sys.EventArgs,[]);class PH{constructor(){this.newState=this.oldState=0;this.handlers=new Ua.a}}Object(w.a)(PH,"AnnotationResultStateUpdateData",
null,[]);var DQ=b(880);class sN{constructor(){this.LJe=this.nMj=this.NJe=null}}Object(w.a)(sN,"AnnotationCallbacks",null,[]);class at{constructor(a,c,h,v,B,X,ma){this.eG=ma;this.LSb=null;this.Poc=new Yc.a(0);this.htc=new Yc.a;this.z1c=new Yc.a;this.$cd=new va.a;this.Tzf=null;this.Me=a;this.Rua=c;this.dD=h;this.rr=v;this.yT=B;this.Na=X}VVn(a,c,h,v){this.rr.L1b(a)&&this.Me.$c(()=>{if(!this.LSb){this.LSb=new Yc.a;var B=sd.ParagraphReader.ex(Yg.a.getRootNode(),!0,!0);for(const X of B)X&&(B=X.ia(Yb.a.Ib,
0))&&(this.LSb.add(B,X.id),this.Poc.Z(X.id.toString(),B))}this.Rua.Szf(a,(X,ma)=>{if(X){var Pa=this.rr.S8e(a);X.contentDescriptor.Gr===Pa&&((Pa=this.L1k(X))?X.X7a?(Pa=this.mTe(X,Pa))&&(ma?h(ma,X.contentDescriptor):c(Pa,X.contentDescriptor)):v(X.contentDescriptor):this.oqk(X,Object.assign(new sN,{NJe:c,nMj:h,LJe:v})))}})},"PAS:FEPAOT")}L1k(a){if(3===a.contentDescriptor.Gr){let c;return({value:c}=this.LSb.Ab(a.contentDescriptor.paragraphId)).returnValue?c:null}if(4===a.contentDescriptor.Gr)return N.a.nil;
r.ULS.sendTraceTag(592525442,at.oh,15,"GetGraphNodeIdForAnnotationIfConnected: Unsupported content type");return null}WLl(a,c){if(3===a.contentDescriptor.Gr)return c=this.yT.value.Ra(c).getValue(Yb.a.Wh),a.contentDescriptor.Wh===c;if(4===a.contentDescriptor.Gr&&c===N.a.nil)return!0;r.ULS.sendTraceTag(592525443,at.oh,15,"IsGraphNodeValidForAnnotation: Unsupported content type");return!1}oqk(a,c){if(3===a.contentDescriptor.Gr){const h=a.contentDescriptor.paragraphId;this.htc.Ja(h)||this.htc.add(h,new Ua.a);
this.htc.J(h).add(v=>{12===v.type&&this.LSb.add(h,v.id);a.X7a?(v=this.mTe(a,v.id))&&c.NJe(v,a.contentDescriptor):c.LJe(a.contentDescriptor)})}else if(4===a.contentDescriptor.Gr)if(a.X7a){const h=this.mTe(a,N.a.nil);h&&c.NJe(h,a.contentDescriptor)}else c.LJe(a.contentDescriptor);else r.ULS.sendTraceTag(592525444,at.oh,15,"DelayCallbackForAnnotation: Unsupported content type")}mTe(a,c){if(this.WLl(a,c)){if(c=this.rr.qhm(a.X7a,a.contentDescriptor,c.toString()))return this.z1c.Z(c.id,a.$Za),c}else this.Na.isFeatureEnabled(144)&&
this.dD.Otc(a);return null}BVi(a,c){let h;(h=this.eG?this.rr.Oyd(a):this.rr.ksb(a))&&(c===Hf.a.getTypeName()?this.eHn(a,h):this.UGn(a,h))}eHn(a,c){this.rr.L1b(a.annotationType)&&(this.dD.sMa(this.yT.value,c,a.annotationType),this.z1c.remove(a.id))}UGn(a,c){if(this.rr.L1b(a.annotationType)){c=Object.assign(new DQ.a,{X7a:this.rr.rMj(a),contentDescriptor:c,annotationType:a.annotationType});c=this.dD.addAnnotation(this.yT.value,c);this.z1c.Z(a.id,c);const h=this.rr.TFh(a.annotationType);h&&this.$cd.contains(h)&&
(this.Me.$c(()=>{var v=sd.ParagraphReader.ex(Yg.a.getRootNode(),!0,!0);if(v&&0<v.count){const B=new Ua.a;for(const X of v)(v=at.jBd(X))&&B.add(v);0<B.count&&this.dD.pOg(this.yT.value,h,B.toArray())}},"PAS:TAOCPA"),this.$cd.remove(h))}}$eb(a){if(this.LSb)if(a){var c=a.ia(Yb.a.Ib,0);if(c&&(this.Poc.Z(a.id.toString(),c),({value:c}=this.htc.Ab(c)).returnValue))for(const h of c)h(a)}else r.ULS.sendTraceTag(592525445,at.oh,10,"OnParagraphNodeConnected: Invalid node")}Rbi(a,c){if(a){var h=a.id.toString();
a=a.ia(Yb.a.Ib,0);var v=0;({value:v}=this.Poc.Ab(h)).returnValue&&(3===c?(this.htc.remove(v),this.Poc.remove(h)):2===c?this.Poc.Z(h,a):r.ULS.sendTraceTag(592525447,at.oh,15,"OnParagraphNodeModified: Updating persisted annotation not supported for event"))}else r.ULS.sendTraceTag(592525446,at.oh,10,"UpdatePersistedAnnotations: Invalid node")}adl(a){let c;return({value:c}=this.z1c.Ab(a)).returnValue?c:N.a.nil}qSn(a,c,h){a?c?this.Rua.nAh(a,v=>{if(v){const ma=at.jBd(c,h);if(ma){var B=Array(v.length),
X=!1;for(let Pa=0;Pa<v.length;Pa++)if(X||ma!==v[Pa])B[Pa]=v[Pa];else{const mb=at.jBd(c);if(!mb)return;X=!0;B[Pa]=mb;v[Pa]=mb}X&&this.dD.pOg(this.yT.value,a,B)}}}):r.ULS.sendTraceTag(588863697,at.oh,10,"UpdateWorkflowParagraphVersion: Invalid node"):r.ULS.sendTraceTag(588863696,at.oh,10,"UpdateWorkflowParagraphVersion: null workflowType")}thn(a){a?this.$cd.add(a):r.ULS.sendTraceTag(588863698,at.oh,10,"SetPendingWorkflow: null workflowType")}V6j(a){a?this.$cd.remove(a):r.ULS.sendTraceTag(588105731,
at.oh,10,"ClearPendingWorkflow: null workflowType")}static jBd(a,c=0){if(!a)return null;c||(c=a.ia(Yb.a.Wh,0));a=sd.ParagraphReader.vR(a);if(c&&a)return String.format("{0}{1}{2}",a,at.Bym,c);r.ULS.sendTraceTag(588091606,at.oh,10,"GetParagraphVersion: Node with text id {0} and paragraph id {1}",c?"valid":"0",a?"valid":"0");return null}}at.oh=389;at.Bym="-";Object(w.a)(at,"PersistedAnnotationStorage",null,[497]);class tN{constructor(){this.config=this.token=null}}Object(w.a)(tN,"UpdateAnnotationConfigParameters",
null,[]);var uN=b(124),EQ=b(925),FQ=b(1040),vN=b(333),GQ=b(1220);class $i{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd=null,ee){this.eG=rc;this.E6a=ee;this.ma=new Rd.a;this.Tta=new od.a;this.Q$=new od.a;this.VC=new od.a;this.abe=new od.a;this.Hhc=new Zc.a(oa.a.yi());this.Uue=new Ua.a;this.hKb=new od.a;this.Wae=new od.a;this.A1c=new od.a;this.iKb=new od.a;this.Zec=new od.a;this.B1c=new od.a;this.L3c=new od.a;this.nbd=[];this.obd=[];this.Qmc=null;this.Anj=new Zc.a(oa.a.yi());this.Zae=new Map;this.OLb=
new Map;this.ggc=null;this.rfa=new od.a;this.Pyc=null;this.Eij=a.$("AugLoopAnnotationsAttachingIsEnabled");this.Otj=a.bB("SendReleaseMessageAnnotationList")||[];this.Na=Tb;this.tDa=vd;this.Rua=X;this.dD=ma;this.sr=h;this.rr=Pa;this.O6=mb;this.yT=v;this.Me=c;this.Ta=B;xa.a.instance.resolve("Box4.ICharacterPropertiesEditor").eIj(Object(m.a)(this,this.mnm,"onEditInIntentRangeEventHandler"));this.QU=Tc;this.XSn=a.getBooleanFeatureGate("Microsoft.Office.WordOnline.InteractivePerfAnnotationStorageSuperTransaction",
!1);this.u7i=a.getBooleanFeatureGate("Microsoft.Office.WordOnline.AnnotationProcessingStateIsEnabled",!1);this.zij=a.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1);this.E6a&&this.wql()}get qpi(){return this.iKb}set qpi(a){this.iKb=a}Ea(a,c){r.ULS.sendTraceTag(41521862,$i.oh,50,"New registration for annotation type: {0}.",c);this.addHandler(a,c);this.KGe(c).catch(h=>{r.ULS.sendTraceTag(594396739,$i.oh,10,"Failed to activate annotation type {0}: {1}",c,h.toString())})}addHandler(a,
c){if(a&&c&&""!==c){var h=null;({value:h}=this.iKb.Ab(c,h)).returnValue?h.add(a):(h=new Ua.a,h.add(a),this.iKb.add(c,h))}else r.ULS.sendTraceTag(41521861,$i.oh,10,"Invalid registration. Handler == null? {0} or annotationType == null? {1} or annotationType == empty? {2}.",!a,!c,""===c)}xb(a,c){r.ULS.sendTraceTag(41521863,$i.oh,50,"Unregister handler for annotation type: {0}.",c);let h=null;({value:h}=this.iKb.Ab(c,h)).returnValue&&(h.remove(a),h.count||(r.ULS.sendTraceTag(41521864,$i.oh,50,"Unregister all handlers for annotation type: {0}.",
c),this.iKb.remove(c),this.vkm(c)))}uDi(a){this.XSn&&!this.Pyc&&(this.Pyc=this.QU.Ob(2),this.Pyc.Oa(a))}h7j(){var a;null===(a=this.Pyc)||void 0===a?void 0:a.dispose();this.Pyc=null}Vnk(){if(this.nbd.length||this.obd.length)try{0<this.nbd.length&&this.nam(),0<this.obd.length&&this.eKn()}finally{this.h7j()}else this.Ta.me(this.Qmc),this.Qmc=null}q8g(){this.Qmc||(this.Qmc=new Se.a(4,2,100,Object(m.a)(this,this.Vnk,"cudIntentsForAnnotationsTask"),141),this.Ta.ub(this.Qmc))}nam(){let a;a=Array.dequeue(this.nbd);
const c=Yg.a.hEc(this.yT.value,a);if(c)if(c.Oh){this.uDi(c);var h=null;if(({value:h}=this.Zec.Ab(a,h)).returnValue){this.Zec.remove(a);for(const v of h)this.oam(c,v)}else r.ULS.sendTraceTag(50663568,$i.oh,100,"MarkIntentForAnnotationTask: No annotations for given tile id.")}else this.Anj.add(a);else r.ULS.sendTraceTag(50436127,$i.oh,15,"MarkIntentForAnnotationTask: Unable to get node from tileId.")}oam(a,c){var h=c.content.range;h=new vD.a(0,h.start,h.start+h.length,N.a.create(),c,v=>{this.abe.Z(c.id,
v.toString())});this.sr.h5b(a,h);this.ma.Fca&&this.ma.raiseEvent($i.i6b,new wD(c,fo.a.getTypeName()))}X3h(a){const c=Yg.a.gbb(a.parentPath);let h=null;({value:h}=this.Zec.Ab(c,h)).returnValue||(h=new Ua.a,this.Zec.add(c,h),Array.enqueue(this.nbd,c));h.add(a);this.q8g()}qam(a,c){this.Me.$c(()=>{let h;if(({value:h}=this.Q$.Ab(a,h)).returnValue){var v=this.uGi(a);for(const B of h){let X;({value:X}=this.VC.Ab(B,X)).returnValue&&c(X)&&$i.qzb(X)&&(this.X3h(X),v&&this.ma.raiseEvent($i.i6b,new wD(X,Hf.a.getTypeName())))}}},
"AS:MIFAT")}fKn(a,c){this.Me.$c(()=>{let h;if(({value:h}=this.Q$.Ab(a,h)).returnValue)for(const v of h){let B;({value:B}=this.VC.Ab(v,B)).returnValue&&c(B)&&$i.qzb(B)&&this.i_f(B)}},"AS:UIFAT")}Bkm(a){var c=Yg.a.wI(a);let h=null;if(({value:h}=this.Tta.Ab(c,h)).returnValue){c=0;for(var v=new Ua.a;h.count>c;){var B=h.J(c),X=null;({value:X}=this.VC.Ab(B,X)).returnValue&&$i.qzb(X)?this.rr.wGb(a,X)?this.gXb(X,!this.Na.isFeatureEnabled(144)):(B=X.content.range,X=new vD.a(0,B.start,B.start+B.length,N.a.create(),
X),v.add(X),c++):c++}0<v.count&&this.sr.mrf(a,v)}}eKn(){let a="";a=Array.dequeue(this.obd);const c=Yg.a.hEc(this.yT.value,a);if(c&&12===c.type){this.uDi(c);var h=null;({value:h}=this.B1c.Ab(a,h)).returnValue?(this.sr.j_f(v=>h.contains(v.intent),c,0),this.B1c.remove(a)):r.ULS.sendTraceTag(50663570,$i.oh,100,"UnmarkIntentForAnnotationsTask: No annotations for given tileId.")}else r.ULS.sendTraceTag(50436128,$i.oh,15,"UnmarkIntentForAnnotationsTask: Unable to unmark ChPs in node")}i_f(a){let c;({value:c}=
this.abe.Ab(a.id,c)).returnValue||(c=Yg.a.gbb(a.parentPath));this.abe.remove(a.id);var h=null;({value:h}=this.B1c.Ab(c,h)).returnValue||(h=new Ua.a,this.B1c.add(c,h),Array.enqueue(this.obd,c));h.add(a);this.q8g();h=null;({value:h}=this.Zec.Ab(c,h)).returnValue&&h.remove(a)}mEj(a){const c=a.id;var h=a.annotationType;const v=a.parentPath;this.eG?this.rr.gra(a):this.rr.wJd(h);let B=null;({value:B}=this.Q$.Ab(h,B)).returnValue||(B=new Ua.a,this.Q$.add(h,B));B.add(c);h=null;({value:h}=this.Tta.Ab(v,h)).returnValue||
(h=new Ua.a,this.Tta.add(v,h));h.add(c);this.VC.add(c,a);this.UVn(a);return!0}UVn(a){const c=a.annotationType;let h=!1,v,B;this.eG?(v=this.rr.Vph(a),h=0<v.length,B=(X,ma,Pa)=>this.Rua.Tqm(X,ma,Pa)):(v=[this.rr.ksb(a)],h=null!==v[0],B=(X,ma,Pa)=>this.Rua.G6b(X[0],ma,Pa));if(h){let X=!1;B(v,a.annotationType,(ma,Pa)=>{this.VC.Ja(a.id)?(Pa=this.eG?this.rr.idb(a,Yg.a.eqh(a)):this.rr.lKd(c,Yg.a.eqh(a)),!ma&&Pa?this.m0f(a,10,!1):ma&&this.m0f(a,ma),this.eG&&X||(this.leh(a),X=!0)):Pa.kNa=!0})}else this.leh(a)}leh(a){const c=
$i.qzb(a);c&&this.X3h(a);!c&&this.ma.Fca&&this.ma.raiseEvent($i.i6b,new wD(a,fo.a.getTypeName()))}kTi(a,c,h){let v=!0;this.Me.$c(()=>{if(h.startsWith(Yg.a.ivb)){var B=a.id,X=null;if(c===Hf.a.getTypeName())this.gXb(a);else if(({value:X}=this.VC.Ab(B,X)).returnValue)r.ULS.sendTraceTag(41418891,$i.oh,50,"UpdateAnnotationsStorage: Updating storage for annotation {0} of type {1}.",B,a.annotationType),this.VC.Z(B,a);else if(!this.mEj(a)){v=!1;return}c===fo.a.getTypeName()&&h!==Yg.a.ivb&&this.Uue.add(a.annotationType)}this.IFb(a,
c)},"AS:UAS");return v}Qcn(a){if(a)for(const c of a)this.IFb(c,aD.a.getTypeName()),a=c.content,this.L3c.Ja(a.categoryName)?this.L3c.Z(a.categoryName,c):this.L3c.add(a.categoryName,c);else r.ULS.sendTraceTag(592802119,$i.oh,10,"SetCritiqueCategoryCountAndSendToHandlers: critiqueCategoryCountAnnotations null")}IHj(a){this.ma.addHandler($i.i6b,a)}IPg(a){this.ma.addHandler($i.U9h,a)}yHd(a){return this.hKb.Ja(a)}HHj(a){this.ma.addHandler($i.lQd,a)}cYm(a){this.ma.removeHandler($i.lQd,a)}uGi(a){return!Yg.a.ve(a)&&
hC.a(a)&&this.ma.Fca}gXb(a,c=!0){if(this.VC.Ja(a.id)){var h=this.VC.J(a.id);this.VC.remove(a.id);var v=null;({value:v}=this.Tta.Ab(a.parentPath,v)).returnValue?(v.remove(a.id),$i.qzb(h)&&this.i_f(h)):r.ULS.sendTraceTag(50734169,$i.oh,15,"DeleteAnnotationFromStorage: No annotations in given parent path");v=null;({value:v}=this.Q$.Ab(a.annotationType,v)).returnValue?v.remove(a.id):r.ULS.sendTraceTag(50734170,$i.oh,15,"DeleteAnnotationFromStorage: Annotation of this type does not exist in document");
this.uGi(a.annotationType)?this.ma.raiseEvent($i.i6b,new wD(h,Hf.a.getTypeName())):this.IFb(a,Hf.a.getTypeName());c&&this.O6.BVi(h,Hf.a.getTypeName())}}c5e(a,c,h=!1){const v=new Ua.a;var B;if(!({value:B}=this.Q$.Ab(a,B)).returnValue)return v;for(const X of B)this.VC.Ja(X)?(a=this.VC.J(X),(B=this.eG?this.rr.Oyd(a):this.rr.ksb(a))&&(c.equals(B)||h&&c.overlaps(B))&&v.add(a)):r.ULS.sendTraceTag(577843217,$i.oh,50,"GetAnnotationsByDescription: Annotation {0} exists in a cache but not in storage",X);return v}PIl(a){return Un.a.getTypeNameFor(a)===
vN.a.getTypeName()}bRh(a){var c,h;return(null===(h=null===(c=this.E6a)||void 0===c?void 0:c.Txh)||void 0===h?void 0:h.call(c))===FQ.a.dec&&a&&0===a.priority?this.E6a.eYc(a.context.substr(a.startInContext,a.range.length)):!1}rGm(a){this.Me.$c(()=>{r.ULS.y5($i.oh,100)&&r.ULS.sendTraceTag(41418894,$i.oh,100,"Operation of type {0} with path {1} received",Un.a.getTypeNameFor(a),a.parentPath.join("\\"));try{const c=new NH(a);for(const h of c.le){if(this.PIl(h.content)&&this.bRh(h.content)){this.YNa(h,70);
continue}const v=h.parentPath,B=c.IRg;B===Hf.a.getTypeName()&&this.Ipi(h,v);if(B===fo.a.getTypeName()&&hC.a(h.annotationType)){const ma=Yg.a.gbb(v);if(h.content.isHotCritique&&this.zij){this.OLb.set(ma,Date.now());continue}}const X=h.annotationType;if(Yg.a.ve(X)||X!==hE.a.getTypeName())if(!Yg.a.ve(X)&&hC.a(X)&&h.content&&0==h.content.priority&&uN.a.kra){const ma=Yg.a.gbb(v);ma&&ma==uN.a.oQk()&&r.ULS.sendTraceTag(539870169,$i.oh,10,"Skipping the Spelling Error Annotation as Text Prediction is visible")}else B!==
Hf.a.getTypeName()&&this.Hhc.contains(v)?r.ULS.sendTraceTag(41418897,$i.oh,50,"ProcessOperation: Parent tile {0} for annotation {1} was deleted.",v,h.id):this.iTi(h,v,B);else r.ULS.sendTraceTag(595342670,$i.oh,50,"ProcessOperation: Skipping CritiqueCategoryCountAnnotation for Parent tile {0} since the counts are maintained locally.",v)}}catch(c){r.ULS.sendTraceTag(41418898,$i.oh,10,"Exception occurred while processing annotations: Error Message {0}, Stack {1}",c.message,c.stack)}},"AS:PO")}oVm(a){if(a&&
a.annotationType&&this.rr.L1b(a.annotationType)){var c;if(({value:c}=this.Q$.Ab(a.annotationType,c)).returnValue&&(a=this.eG?this.rr.Oyd(a):this.rr.ksb(a)))for(const h of c){let v;({value:v}=this.VC.Ab(h,v)).returnValue&&(c=this.eG?this.rr.Oyd(v):this.rr.ksb(v))&&(a.equals(c)||a.overlaps(c))&&this.gXb(v)}}}IFb(a,c){this.Me.$c(()=>{let h=null;if(({value:h}=this.qpi.Ab(a.annotationType,h)).returnValue)for(const v of h)v.hK(a,c)},"AS:SATH")}c7j(){r.ULS.sendTraceTag(50860999,$i.oh,50,"ClearStorage: Initiated Clearing Storage");
this.ggc||(this.ggc=new Se.a(4,2,100,Object(m.a)(this,this.d7j,"clearStorageTask"),142),this.Ta.ub(this.ggc))}d7j(){const a=new Ua.a;for(const c of this.VC.values)if(a.add(c),a.count===$i.Jnj)break;for(const c of a)this.gXb(c),this.IFb(c,Hf.a.getTypeName());this.VC.count||(this.Ta.me(this.ggc),this.ggc=null)}activateAnnotation(a,c){let h;if(({value:h}=this.A1c.Ab(a,h)).returnValue){if(h.contains(c))return Promise.resolve(null);h.add(c)}else{let v;this.A1c.add(a,(v=new Ua.a,v.add(c),v))}return this.KGe(a)}KGe(a){r.ULS.sendTraceTag(41521865,
$i.oh,50,"ActivateAnnotation: Activating annotation type {0}.",a);if(this.hKb.Ja(a))return Promise.resolve(null);var c=null;if(({value:c}=this.Wae.Ab(a,c)).returnValue)return c;this.uBj(a);c=null;this.tDa&&(c=this.tDa());if(c){const h=new CQ.a;h.annotationType=a;this.u7i&&(this.rfa.Ja(a)||this.rfa.Z(a,new PH),h.stateUpdateHandler=(v,B)=>{this.rfa.J(a).oldState=v;this.rfa.J(a).newState=B;for(const X of this.rfa.J(a).handlers)X(a,v,B)});c=c.activateAnnotation(h);this.Wae.add(a,c);return c.then(v=>{this.Wae.remove(a);
this.hKb.add(a,v.token);this.jTi(v.token,a);this.ma.raiseEvent($i.lQd,new OH(a,!0));this.uql(a);return v})}return Promise.reject(Error.create("Error during annotation activation"))}uql(a){const c=this.rr.TFh(a);c&&this.Rua.nAh(c,h=>{if(this.O6.Tzf){var v=sd.ParagraphReader.ex(Yg.a.getRootNode(),!0,!0);if(v&&0<v.count){let B=0;for(const X of v){v=at.jBd(X);if(!v)continue;let ma=!1;for(;B<h.length;){if(v===h[B]){ma=!0;break}B++}if(!ma){this.O6.Tzf(c);break}B++}}}})}uBj(a){this.O6.VVn(a,(c,h)=>{0<this.c5e(a,
h,!0).count||this.kTi(c,fo.a.getTypeName(),c.parentPath)},(c,h)=>{if(3!==h.Gr)r.ULS.sendTraceTag(591541786,$i.oh,15,"Annotation moved to unsupported location type: {0}",h.Gr);else if(c.Gr!==h.Gr)r.ULS.sendTraceTag(591541787,$i.oh,15,"Location types are not equal. This is not currently supported. Old: {0} New: {1}",c.Gr,h.Gr);else{c=this.c5e(a,c);for(const B of c){const X=B.content;c=Yg.a.Qab(this.yT.value,B.parentPath);if(!c){r.ULS.sendTraceTag(591541788,$i.oh,15,"RegisterHandler.onPersistedAnnotationMoved: Unable to get node from tileId.");
break}if(!this.sr.j_f(ma=>ma.intent===X,c,0))break;var v=h.Joa;v=new vD.a(0,v,v+h.Ioa,null,X);this.sr.h5b(c,v)}}},c=>{for(const h of this.c5e(a,c))this.gXb(h,!1)})}releaseAnnotation(a,c){let h;if(({value:h}=this.A1c.Ab(a,h)).returnValue){h.contains(c)&&h.remove(c);if(0<h.count)return Promise.resolve(!1);this.A1c.remove(a)}r.ULS.sendTraceTag(593790408,$i.oh,50,"ReleaseAnnotation: Releasing annotation type {0}.",a);return this.szi(a)}vkm(a){var c=null;if(({value:c}=this.Q$.Ab(a,c)).returnValue){r.ULS.sendTraceTag(41418899,
$i.oh,50,"OnAllHandlersUnregistered: Purging all storage for annotation type {0}.",a);for(const h of c)if(c=null,({value:c}=this.VC.Ab(h,c)).returnValue){const v=c.parentPath;let B=null;({value:B}=this.Tta.Ab(v,B)).returnValue&&(B.remove(h),B.count||this.Tta.remove(v));this.VC.remove(h);$i.qzb(c)&&this.i_f(c)}this.Q$.remove(a)}Array.contains(this.Otj,a)&&this.szi(a)}szi(a){let c=null,h=null;this.tDa&&(h=this.tDa());if(h){if(({value:c}=this.hKb.Ab(a,c)).returnValue){const v=new oN;v.token=c;this.hKb.remove(a);
this.ma.raiseEvent($i.lQd,new OH(a,!1));return h.releaseAnnotation(v)}return Promise.resolve(!0)}return Promise.reject(Error.create("Error during annotation release"))}n_h(){this.Me.$c(()=>{if(this.Eij){var a=Yg.a.getRootNode();if(a){var c=new od.a;Nr.e(a,h=>{var v=Yg.a.wI(h),B=null;if(({value:B}=this.Tta.Ab(v,B)).returnValue)for(const X of B)v=null,({value:v}=this.VC.Ab(X,v)).returnValue&&(v.parent=h,v.wJc=!0,v.sDb=2,c.Ja(v.annotationType)||c.Z(v.annotationType,new Ua.a),c.J(v.annotationType).add(X),
B=null,({value:B}=this.Q$.Ab(v.annotationType,B)).returnValue&&B.remove(v.id));return!0},12);for(const h of this.Q$.keys)if(a=null,({value:a}=this.Q$.Ab(h,a)).returnValue)for(const v of a)if(a=null,({value:a}=this.VC.Ab(v,a)).returnValue){let B=null;a.parentPath===Yg.a.ivb?(a.sDb=1,a.parent=null):({value:B}=this.VC.Ab(a.parentPath,B)).returnValue?(a.sDb=3,a.parent=B):(a.sDb=0,a.parent=null,r.ULS.sendTraceTag(41554060,$i.oh,15,"LinkAnnotations: Unknown annotation parent for annotation ID: {0}.",a.id));
a.wJc=!0;c.Ja(a.annotationType)||c.Z(a.annotationType,new Ua.a);c.J(a.annotationType).add(v)}else r.ULS.sendTraceTag(41997840,$i.oh,15,"LinkAnnotations: Annotation object not found for the given annotation ID: {0}.",v);else r.ULS.sendTraceTag(41997841,$i.oh,15,"LinkAnnotations: Annotations not found for the given annotation type: {0}.",h);this.Q$=c;this.Uue.clear()}else r.ULS.sendTraceTag(41554058,$i.oh,10,"LinkAnnotations: There is no root node in the current document.")}else r.ULS.sendTraceTag(41554057,
$i.oh,50,"LinkAnnotations: Link annotations called but flags is not set.")},"AS:LA")}qMj(a){this.rGm(a)}Htm(a,c){this.Me.$c(()=>{const h=c?c+String.format("\\{0}",a.id):Yg.a.wI(a);r.ULS.sendTraceTag(41418900,$i.oh,50,"OnTileDeleted: Tile delete event received for tile {0}.",h);this.Hhc.contains(h)||this.Hhc.add(h);var v=null;if(({value:v}=this.Tta.Ab(h,v)).returnValue){r.ULS.sendTraceTag(41418901,$i.oh,100,"OnTileDeleted: Removing {0} annotations for tile {1} from storage.",v.count,h);for(const B of v)v=
null,({value:v}=this.VC.Ab(B,v)).returnValue&&(this.IFb(v,Hf.a.getTypeName()),this.ma.Fca&&this.ma.raiseEvent($i.i6b,new wD(v,Hf.a.getTypeName())),this.VC.remove(B));this.Tta.remove(h)}},"AS:OTD")}Gtm(a){a=Yg.a.wI(a);this.Hhc.remove(a)&&r.ULS.sendTraceTag(41418902,$i.oh,50,"OnTileAdded: Deleted tile {0} was re-added.",a)}oQn(a){if(a){r.ULS.sendTraceTag(50436131,$i.oh,50,"UpdateRangeForAnnotations: Updated ranges for annotations {0}",a.count);var c=new od.a;for(var h of a)a=null,({value:a}=c.Ab(h.parentPath,
a)).returnValue||(a=new od.a,c.add(h.parentPath,a)),a.Z(h.id,h);for(const v of c){c=Yg.a.Qab(this.yT.value,v.key);if(!c){r.ULS.sendTraceTag(50436160,$i.oh,10,"UpdateRangeForAnnotations: Unable to get node for the annotation");break}h=new WF.a([0]);for(let B=0,X=c.la.length;B<X;B++)a=c.la.J(B),a.sj&&h.u1a(a.sj,void 0,(ma,Pa)=>{if(Pa){var mb=null,Tb=Pa.intent;Tb&&({value:mb}=v.value.Ab(Tb.id,mb)).returnValue&&(Tb=new nN.a,Tb.start=Pa.Xa.cp,Tb.length=ma.Xa.cp-Tb.start,mb.content.range=Tb,mb.lLa=!1)}})}}else r.ULS.sendTraceTag(50436130,
$i.oh,10,"UpdateRangeForAnnotations: annotations list null")}getAnnotationsByType(a){r.ULS.sendTraceTag(593049729,$i.oh,50,"GetAnnotationsByType: Method called for type {0}.",a);return this.KGe(a).then(()=>{const c=new Ua.a;this.Me.$c(()=>{if(Yg.a.ve(a)||a!==hE.a.getTypeName()){this.Uue.contains(a)&&this.n_h();var h=null;if(({value:h}=this.Q$.Ab(a,h)).returnValue){r.ULS.sendTraceTag(41418903,$i.oh,50,"GetAnnotationsByType: Enumerating annotations of type {0}.",a);var v=new Ua.a;for(const B of h)h=
null,({value:h}=this.VC.Ab(B,h)).returnValue&&(h.lLa&&v.add(h),c.add(h));v&&0<v.count&&$i.qzb(v.J(0))&&this.oQn(v)}}else for(v of this.L3c.values)c.add(v);c.count||r.ULS.sendTraceTag(41418904,$i.oh,50,"GetAnnotationsByType: No annotations found for type {0}!",a)},"AS:GABT");return c},c=>{r.ULS.sendTraceTag(41418905,$i.oh,10,"Exception occurred while fetching annotations of type {0}: {1}",a,c);return null})}jab(a){let c=null;return({value:c}=this.VC.Ab(a,c)).returnValue?c:null}fqh(a){let c=null;if(this.Tta.Ja(a))for(const h of this.Tta.J(a))if(a=
this.jab(h))c||(c=new Ua.a),c.add(a);return c}qBb(a){return(a=this.jab(a))?(a.wJc||this.n_h(),a):null}YNa(a,c){this.gjn(a,c);this.m0f(a,c);this.IFb(a,aD.a.getTypeName());if(!this.eG&&this.rr.lKd(a.annotationType,c)){const h=this.rr.ksb(a);h&&(a=Object.assign(new EQ.a,{annotationType:a.annotationType,contentDescriptor:h,state:c}),this.dD.Zh(this.yT.value,a))}}PLn(a,c){this.nPn(a,c);this.ugn(a,Yg.a.RRk(a));this.IFb(a,aD.a.getTypeName())}QLn(a,c){if(this.eG){a=this.rr.Vph(a);for(var h of a)this.dD.h7d(this.yT.value,
h,c)}else h=this.rr.ksb(a),this.dD.h7d(this.yT.value,h,c)}gjn(a,c){let h=null;this.tDa&&(h=this.tDa());h&&(a=this.SRk(a,c))&&h.setAnnotationState(a)}m0f(a,c,h=!0){if(a&&$i.VPh(a)){var v=this.jab(a.id);!a.content||v&&a.content===v.content||Yg.a.setAnnotationState(a,c);v&&v.content&&Yg.a.setAnnotationState(v,c);h&&this.ma.Fca&&(70===c||60===c)&&this.ma.raiseEvent($i.U9h,new rN(a,c))}}SRk(a,c){let h=null;a&&(h=Object.assign(new qN,{id:a.id,value:c}),Yg.a.ve(a.parentPath)||(h.parentPath=a.parentPath.split("\\")));
return h}ugn(a,c){const h=this.tDa?this.tDa():null;h&&(a=this.QRk(a,c))&&h.setAnnotationMetadata(a)}nPn(a,c){if(a&&$i.VPh(a)){var h=this.jab(a.id);!a.content||h&&a.content==h.content||Yg.a.$zi(a,c);h&&h.content&&Yg.a.$zi(h,c)}}QRk(a,c){if(!a)return null;const h=new pN;h.id=a.id;h.value=c;Yg.a.ve(a.parentPath)||(h.parentPath=a.parentPath.split("\\"));return h}Emn(a,c,h,v){const B=a.content;if((this.eG?this.rr.gra(a):this.rr.wJd(a.annotationType))&&B){const X=B.range.start+B.range.length;if(0<v&&X<=
h||0>v&&X<=h+v)return!1;if(0<v&&B.range.start>=c||0>v&&B.range.start>=h)return B.range.start+=v,!1}return!this.Na.isFeatureEnabled(103)&&B&&B.M_?(a=this.eG?this.rr.idb(a,60):this.rr.lKd(a.annotationType,60),!(60===B.M_.state&&a)):!0}mnm(a,c){for(const h of c.sj)a=h.intent,!a.type&&this.Emn(a.intent,h.cpBegin,h.cpEnd,h.G4b)&&this.gXb(a.intent)}ZMg(a,c){this.rfa.Ja(c)||this.rfa.Z(c,new PH);this.rfa.J(c).handlers.add(a);a(c,this.rfa.J(c).oldState,this.rfa.J(c).newState)}Lpi(a,c){this.rfa.Ja(c)&&this.rfa.J(c).handlers.contains(a)&&
this.rfa.J(c).handlers.remove(a)}static VPh(a){a=Un.a.getBaseTypesFor(a.content);return Array.contains(a,Ul.a.getTypeName())}static qzb(a){if(void 0===a.content||null===a.content||""===Yg.a.gbb(a.parentPath))return!1;const c=Un.a.getBaseTypesFor(a.content);return Array.contains(c,BQ.a.getTypeName())&&a.annotationType!==ok.RoleDetectionAnnotation.getTypeName()}OLn(a){a?(this.Zae.AugLoop_Text_Critique=a,a=this.yHd("AugLoop_Text_Critique")?this.hKb.J("AugLoop_Text_Critique"):null,this.jTi(a,"AugLoop_Text_Critique")):
r.ULS.sendTraceTag(540615552,$i.oh,50,"Annotation configuration could not be updated for annotation type: {0}.","AugLoop_Text_Critique")}jTi(a,c){if(a&&this.Zae[c]){const h=new tN;h.token=a;h.config=this.Zae[c];this.tDa&&(this.tDa().updateAnnotationConfig(h),r.ULS.sendTraceTag(540615553,$i.oh,50,"Annotation configuration has been updated for annotation type: {0}.",c))}}Ipi(a,c){let h=null;({value:h}=this.VC.Ab(a.id,h)).returnValue&&(a.annotationType=h.annotationType);c=Yg.a.gbb(c);this.OLb.has(c)&&
hC.a(a.annotationType)&&this.OLb.delete(c)}iTi(a,c,h){this.oVm(a);this.kTi(a,h,c)&&this.O6.BVi(a,h)}sMa(a){const c=a.parentPath,h=Hf.a.getTypeName();this.Ipi(a,c);this.YNa(a,70);this.Hhc.contains(c)||this.iTi(a,c,h)}wql(){Object(ew.__awaiter)(this,void 0,void 0,function*(){yield Object(GQ.b)();const a=yield this.getAnnotationsByType(vN.a.getTypeName());for(const c of a)this.bRh(c.content)&&this.sMa(c)})}}$i.oh=389;$i.i6b="OnAnnotationOperation";$i.U9h="OnAnnotationLocalStateChange";$i.lQd="OnAnnotationActivationChange";
$i.Jnj=20;Object(w.a)($i,"AnnotationStorage",null,[499]);class wN{constructor(){this.gOf=null;this.iWc=!1}}Object(w.a)(wN,"AugmentationLoopStateManager",null,[496]);var xN=b(229);class QH extends xN.a{constructor(){super();this.FileId=this.AugLoopSeedUrl=this.Authorization=this.OriginString=this.ExpectedEndRevisionId=null;this.AddSubDocumentKindTypeToPathIsEnabled=this.CheckOnDemandNodeVersionEnabled=this.AddDocumentKindTypeToPathIsEnabled=this.SeedBatchesInParallelIsEnabled=!1}ol(){return 102}static construct(a,
c,h,v,B,X){const ma=new QH;ma.ExpectedEndRevisionId=a;ma.OriginString=c;ma.Authorization=h;ma.AugLoopSeedUrl=v;ma.FileId=B;ma.SeedBatchesInParallelIsEnabled=X;ma.AddDocumentKindTypeToPathIsEnabled=!0;ma.CheckOnDemandNodeVersionEnabled=!0;ma.AddSubDocumentKindTypeToPathIsEnabled=!0;return ma}}Object(w.a)(QH,"FullFileAugLoopSeedingRequest",xN.a,[]);class RH{constructor(){this.authToken=this.url=this.Mei=null}}Object(w.a)(RH,"ReseedingTaskInfo",null,[]);class nr{constructor(a,c,h,v,B,X){this.Tkb=null;
this.Jjg=!1;this.WLb=null;this.vye=0;this.q8i=a.$("AugLoopServerSideSeedingIsEnabled");this.o8i=a.$("AugLoopReseedingIsEnabled");this.p8i=a.$("AugLoopFFSSeedBatchesInParallelIsEnabled");this.Fug=a.vb("MaxReseedingRetries",1);this.Qe=c;this.F7c=h;this.HL=v;this.D6=B;this.$e=X;Eb.App.oa&&Eb.App.oa.Da&&Eb.App.oa.Da.Zb&&Eb.App.oa.Da.Zb.contentReplicator&&(this.Tkb=Eb.App.oa.Da.Zb.contentReplicator)}YBl(a,c,h){if(this.q8i){var v=this.HL.gOf;v&&v.trim().length?this.Jjg?this.o8i&&(r.ULS.sendTraceTag(50861E3,
nr.oh,50,"InitiateFullFileSeedingFlow: Initiated Reseeding Flow"),this.vye=0,this.Tkb?(this.HL.iWc=!0,this.Tkb.tTb(Object(m.a)(this,this.wQc,"processReplicationStatus")),this.WLb=Object.assign(new RH,{Mei:a,url:c,authToken:h}),this.Tkb.mC(null,null,this.WLb)):r.ULS.sendTraceTag(592814793,nr.oh,50,"InitiateFullFileSeedingFlow: ContentReplicator is null")):(r.ULS.sendTraceTag(41445392,nr.oh,50,"InitiateFullFileSeedingFlow: Initiated FullFileSeedingFlow"),this.Kli(v,a,c,h),this.Jjg=!0):r.ULS.sendTraceTag(41445391,
nr.oh,10,"InitiateFullFileSeedingFlow: Empty or Null SeedRevision. Unable to InitiateFullFileSeedingFlow.")}else r.ULS.sendTraceTag(41445390,nr.oh,50,"InitiateFullFileSeedingFlow: AugLoopServerSideSeeding BRS setting has been diabled. File will not be seeded to Augmentation Loop.")}wQc(a,c){a=c.F7;this.WLb&&Xj.AT(a,h=>h===this.WLb)&&(c.httpStatusCode!==Ga.a.wA||c.oB||2!==c.BDf?c.httpStatusCode!==Ga.a.wA||c.oB||1!==c.BDf?this.nvi(()=>{r.ULS.sendTraceTag(50861003,nr.oh,10,"ProcessReplicationStatus: ForceInbound or pinning the lastest revision failed. HttpStatusCode: {0}, OperationResult: {1}, PinRevisionForAugLoopResponse: {2}, Correlation: {3}",
c.httpStatusCode,c.oB,c.BDf,c.Hs)}):(this.HL.iWc=!1,this.Tkb.TEb(Object(m.a)(this,this.wQc,"processReplicationStatus")),this.$e.c7j(),r.ULS.sendTraceTag(50861002,nr.oh,50,"ProcessReplicationStatus: Initiated Full File Seeding Request"),a=Object(ha.a)(RH,this.WLb),this.Kli(c.N4m,a.Mei,a.url,a.authToken)):this.nvi(()=>{r.ULS.sendTraceTag(50861001,nr.oh,50,"Replication succeeded but failed to pin the latest revision on the server for the user")}))}nvi(a){this.vye<this.Fug?(r.ULS.sendTraceTag(594384E3,
nr.oh,50,"RetryReseeding: ForceInbound or pinning the latest revision failed. Reseeding retry #{0} of {1}",++this.vye,this.Fug),this.Tkb.mC(null,null,this.WLb)):(this.HL.iWc=!1,this.Tkb.TEb(Object(m.a)(this,this.wQc,"processReplicationStatus")),a())}Kli(a,c,h,v){const B=QH.construct(a,c,v,h,l.AFrameworkApplication.rootQuerySignature,this.p8i);r.ULS.sendTraceTag(595178454,nr.oh,50,"QueueFullFileSeedingRequest: Calling AddSeedRequestToRequestManager on Host store replicator load completion.");this.F7c.Vyb.execute(()=>
{this.GFj(B)})}GFj(a){r.ULS.sendTraceTag(595178453,nr.oh,50,"InitiateFullFileSeedingFlow: Adding seed request to RequestManager");this.Qe.ai(Eb.App.webServiceBase+"OneNote.ashx?perfTag=FullFileAugLoopSeed",2,tL.b(a),{["Content-Type"]:"application/json; charset=utf-8"},!1,2,Object(m.a)(this,this.XGk,"fileSeedingSuccessCallback"),Object(m.a)(this,this.WGk,"fileSeedingFailCallback"),a);r.ULS.sendTraceTag(42016906,nr.oh,50,"InitiateFullFileSeedingFlow: Added seed request to RequestManager")}XGk(a){if(void 0===
a||null===a||void 0===a.data||null===a.data||void 0===a.data.qd||null===a.data.qd)r.ULS.sendTraceTag(41445393,nr.oh,10,"FileSeedingSuccessCallback: args or args.Data or args.Data.ResponseData is null or Undefined");else if(a.data.we!==Ga.a.wA)r.ULS.sendTraceTag(41445394,nr.oh,10,"FileSeedingSuccessCallback: Returned unexpected args.Data.HttpStatus code: {0}",a.data.we);else try{let c;({group:c}=Dm.a.D$(a.data.qd,c)).returnValue?c.Responses&&c.Responses.length?(a=null,c&&c.Responses&&c.Responses.length&&
(a=c.Responses[0])?(this.D6.hjb(a),a.StatusCode?r.ULS.sendTraceTag(41445398,nr.oh,10,"FileSeedingSuccessCallback: FullFileAugLoopSeedingResponse returned unexpected status code: {0}",a.StatusCode):r.ULS.sendTraceTag(41445399,nr.oh,50,"FileSeedingSuccessCallback: FullFileAugLoopSeeding was successful and last revision seeded is {0}",a.LastSeededRevisionId)):r.ULS.sendTraceTag(41445397,nr.oh,10,"FileSeedingSuccessCallback: serverResponseGroup is null or serverResponseGroup.Responses is null or serverResponseGroup.Responses is empty or response is null")):
r.ULS.sendTraceTag(41445396,nr.oh,10,"FileSeedingSuccessCallback: responseGroup or responseGroup.Responses is null or empty"):r.ULS.sendTraceTag(41445395,nr.oh,10,"FileSeedingSuccessCallback received null or empty server response group")}catch(c){r.ULS.sendTraceTag(41445400,nr.oh,10,"FileSeedingSuccessCallback: {0}",c.message)}}WGk(a){void 0===a||null===a||void 0===a.data||null===a.data||void 0===a.data.qd||null===a.data.qd?r.ULS.sendTraceTag(41445401,nr.oh,10,"FileSeedingFailCallback: args or args.Data or args.Data.ResponseData is null or Undefined"):
r.ULS.sendTraceTag(41445402,nr.oh,10,"FileSeedingFailCallback: Editor Service token generation server request failed:{0}",a.data.we)}}nr.oh=389;Object(w.a)(nr,"FullFileAugLoopSeedingService",null,[]);class yN{constructor(){}}Object(w.a)(yN,"RuntimeManagerInitializationTracker",null,[]);class zN{getAugLoopRuntimeManager(){return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager()}}Object(w.a)(zN,"AlFactoryWrapper",null,[495]);class AN{Yn(){return Yg.a.Yn()}}Object(w.a)(AN,"UtilsWrapper",null,[494]);
var Hk=b(1789),SH=b(251);class or{constructor(a,c,h,v,B){this.Tb=null;this.qa=a;this.zc=h;this.uj=v;this.$b=B;this.rja=this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.Augloop.IsCaptionDetectionEnabled",!1)}get characterPropertiesEditor(){return this.Tb||(this.Tb=xa.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Dc(){return As.a.getInstance()}Ben(a,c){a.listType=this.g6k(c);a.outlineLevel=sd.ParagraphReader.bWa(c);a.indentation=or.m8e(this.uj.q0(c));a.alignment=or.O4e(sd.ParagraphReader.zu(c));
a.isInsideTable=this.isInsideTable(c);a.isInsideTOC=c.kr;a.rightIndentation=or.m8e(this.uj.G_b(c));var h=this.uj.O_b(c);a.specialIndentType=or.rgl(h);a.specialIndentBy=or.m8e(h);a.listType!==Hk.e.NoList&&this.cgn(c,a);this.$in(c,a);h=[];this.rja&&(h=this.wFm(c));a.formattedRanges=this.w1k(c,h);this.rja&&null!=h&&(a.objectReferences=0<h.length?h:void 0)}w1k(a,c){var h=a.la?a.la.length:0,v=ua.FormattingReader.zr(Oe.a.create(a));let B=fm.a.kF,X=0,ma=fm.a.jI/2;v&&(ma=ua.FormattingReader.Mm(v,Ed.a.fontSize,
fm.a.jI)/2,B=ua.FormattingReader.Mm(v,Ed.a.font,fm.a.kF),X=ua.FormattingReader.language(v));v="Normal";var Pa=this.$b.um(a);Pa&&(v=Pa.getValue(zi.a.EK)||"Normal",Pa.hasProperty(Ed.a.font)&&(B=Pa.getValue(Ed.a.font)));if(h){--h;Pa=[];let Ie=null,Xe=void 0,Yf=null;this.rja&&a.hasProperty(Ed.a.mm)&&(Yf=a.getValue(Ed.a.mm));const Hh=a.properties.ia(Yb.a.Sba,null);for(let Fi=0;Fi<h;Fi++){var mb=a.la.J(Fi),Tb=a.Mb,rc=null;this.rja&&(rc=or.Maf(a,Yf,Fi));mb.Ke&&(Ie=or.dNn(Tb,mb.Ke,Ie));mb.hyperlink&&mb.hyperlink.url?
Xe=mb.hyperlink.url:mb.Lk&&(Xe=void 0);var Tc=a.la.J(Fi+1).cp-1;Tb=mb.cp;Tc=Tc-mb.cp+1;let wk=!1,Gk=!1,Kl=!1,Yj=ma,ao=0,oq=0,to=v,zt=void 0,Wq=X,Ys=B,Wr;if(mb.formatting){var vd=mb.formatting;wk=ua.FormattingReader.Mm(vd,Ed.a.bold,!1);Gk=ua.FormattingReader.Mm(vd,Ed.a.italic,!1);Kl=ua.FormattingReader.Mm(vd,Ed.a.underline,!1);Yj=ua.FormattingReader.Mm(vd,Ed.a.fontSize,2*ma)/2;ao=ua.FormattingReader.Mm(vd,zi.a.capitalization,0);oq=ua.FormattingReader.Mm(vd,Ed.a.fontColor,0);Wq=ua.FormattingReader.language(vd)||
X;Ys=ua.FormattingReader.Mm(vd,Ed.a.font,B);to=v;var ee=vd.fm;ee&&(ee=ee.ia(zi.a.Oz,null))&&!ee.equals(N.a.nil)&&vd.paragraph.Mb&&(vd=vd.paragraph.Mb.Ra(ee))&&(to=(new sg.a(vd)).getValue(zi.a.EK))}this.rja&&(Wr=this.A9e(rc),null!=Wr&&this.VOg(c,rc,Wr,Pa.length,Hk.b.Inline));Ie&&(zt=0<Ie.count);mb={isDeleted:this.oJl(Hh,mb,Fi,Xe),fontFamily:Ys,fontWeight:wk?Hk.d.Bold:Hk.d.Normal,fontSize:Yj,italic:Gk,underline:Kl?Hk.h.SingleLine:Hk.h.None,capitalization:or.i7g(ao),color:kn.a.VVg(oq),styleName:to,isFollowUp:zt,
languageId:or.Z6g(Wq),start:Tb,length:Tc,link:Xe,isReference:or.isReference(mb)?!0:void 0,objectType:null!==Wr&&void 0!==Wr?Wr:void 0};rc=0<Pa.length?Pa[Pa.length-1]:void 0;or.n1j(rc,mb)?rc.length+=mb.length:Pa.push(mb)}return Pa}return[{fontFamily:B,fontWeight:Hk.d.Normal,fontSize:ma,italic:!1,underline:Hk.h.None,capitalization:or.i7g(0),color:0,styleName:v,isFollowUp:void 0,languageId:or.Z6g(X),start:0,length:a.characterData.length}]}oJl(a,c,h,v){if(this.hx()){if(c.blob||c.formatting&&c.formatting.cache&&
c.formatting.cache.bAb||v)return!0;if(a&&h<a.length)return a[h]}return c.eh?!0:!1}hx(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",!1)}static n1j(a,c){return!!a&&!!c&&a.start+a.length===c.start&&a.isDeleted===c.isDeleted&&a.fontFamily===c.fontFamily&&a.fontWeight===c.fontWeight&&a.fontSize===c.fontSize&&a.italic===c.italic&&a.underline===c.underline&&a.capitalization===c.capitalization&&a.color===c.color&&a.highlightColor===
c.highlightColor&&a.styleName===c.styleName&&void 0===a.link&&void 0===c.link&&a.languageId===c.languageId&&!a.isReference&&!c.isReference&&!a.isFollowUp&&!c.isFollowUp&&void 0===a.objectType&&void 0===c.objectType}g6k(a){const c=new Kd.GraphIterator;c.set(a);c.La(11);c.mc(11);return(a=this.zc.Op(c))?or.oek(a.listType):Hk.e.NoList}cgn(a,c){const h=this.zc.OG(a);if(h){h.hasProperty(Yb.a.listID)&&(c.listId=h.getValue(Yb.a.listID).toString());const v=this.Cxh(a,h,Ed.a.font);a=this.Cxh(a,h,Ed.a.fontSize);
v&&(c.bulletAndNumberFontFamily=v);a&&(c.bulletAndNumberFontSize=a)}}isInsideTable(a){const c=new Kd.GraphIterator;c.set(a);return c.La(14)}$in(a,c){c.spacingBeforeParagraph=this.YCh(a,Yb.a.Rda,Yb.a.yka,Yb.a.uV);c.spacingAfterParagraph=this.YCh(a,Yb.a.Qda,Yb.a.xka,Yb.a.eP);c.lineSpacing=this.cJa(a)}YCh(a,c,h,v){if(sd.ParagraphReader.Mm(a,c,!1))return 0;c=sd.ParagraphReader.Mm(a,h,-1);if(0<=c)return c*SH.a.xTd/100;a=sd.ParagraphReader.Mm(a,v,-1);return 0<=a?a/20:0}Cxh(a,c,h){if(or.Dc.JO){if(a=this.characterPropertiesEditor.jIa(a),
null!=a&&null!=a.cache)return a.cache.getValue(h)}else if(c.hasProperty(h))return c.getValue(h)}cJa(a){const c=sd.ParagraphReader.Mm(a,Yb.a.tK,SH.a.tK);a=sd.ParagraphReader.Mm(a,Yb.a.Zt,SH.a.lineSpacing);switch(c){case 0:return a/240;case 1:return a/20;default:return 0}}static dNn(a,c,h){for(let v=0;v<c.length;v++){const B=c.J(v),X=B.Oj,ma=a.Ra(X);ma&&ma.ia(Yb.a.BF,!1)&&(h||(h=new Zc.a(new xe.a)),B.Nb?h.add(X):h.remove(X))}return h}static Z6g(a){return(a=vi.a.af(a))&&a.name?a.name.toLowerCase():void 0}static m8e(a){return a?
2===a.unit?Math.floor(Be.a.ktb(a.value)/20):Math.floor(a.value/20):0}static rgl(a){if(!a)return Hk.g.Initial;switch(a.specialIndentType){case 1:return Hk.g.FirstLine;case 2:return Hk.g.Hanging;default:return Hk.g.Initial}}static i7g(a){switch(a){case 2:return Hk.c.AllCaps;case 1:return Hk.c.SmallCaps;default:return Hk.c.NoCaps}}static O4e(a){switch(a){case 1:return Hk.a.Left;case 3:return Hk.a.Right;case 2:return Hk.a.Center;case 6:return Hk.a.Justified;case 0:return Hk.a.None;default:return Hk.a.Other}}static oek(a){switch(a){case 15:return Hk.e.Any;
case 1:return Hk.e.Bullet;case 42:return Hk.e.Invalid;case 13:return Hk.e.Lim;case 14:return Hk.e.Nil;case 16:return Hk.e.NoList;case 0:return Hk.e.Numbered;default:return Hk.e.Invalid}}static isReference(a){return a.blob&&(7===a.blob.nh||10===a.blob.nh)||a.Nh&&0<a.Nh.length||a.Ke&&0<a.Ke.length||a.Wa&&0<a.Wa.length?!0:!1}static Maf(a,c,h){return null==c?null:c[h]&&!c[h].equals(N.a.nil)&&a.Mb?a.Mb.Ra(c[h]):null}A9e(a){if(null==a)return null;if(a.hasProperty(Yb.a.Qp)){var c=a.getValue(Yb.a.Qp);if(or.Rhi.has(c))return or.Rhi.get(c)}if(a.hasProperty(Yb.a.PYb)&&
null!=a.getValue(Yb.a.PYb))return Hk.f.FootnoteEndnote;if(a.hasProperty(Yb.a.pageBreak)&&a.getValue(Yb.a.pageBreak))return Hk.f.PageBreak;if(a.hasProperty(Yb.a.EAb)&&a.getValue(Yb.a.EAb))return Hk.f.Tab;c=!1;a.hasProperty(Uc.a.Q8)?c=a.getValue(Uc.a.Q8):a.hasProperty(Yb.a.Wca)&&(c=a.getValue(Yb.a.Wca));return c&&a.hasProperty(Yb.a.imageType)&&1==a.getValue(Yb.a.imageType)?Hk.f.Image:null}static eMl(a){return a.hasProperty(Yb.a.B0b)&&0<=a.getValue(Yb.a.B0b)?!0:!1}ZWh(a){return or.Xyn.has(a)}yUe(a,c,
h,v){return null==a||null==c?(r.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: propertySet or objectType is undefined."),null):v===Hk.b.Inline&&null==h?(r.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Inline object does not have formattedRangeIndex defined."),null):v===Hk.b.Floating&&null!=h?(r.ULS.sendTraceTag(null,389,10,"FormattingExtractor.CreateObjectReference: Floating object has formattedRangeIndex defined."),null):0>h?(r.ULS.sendTraceTag(null,
389,10,"FormattingExtractor.CreateObjectReference: FormattedRangeIndex is a negative number."),null):or.eMl(a)?null:this.ZWh(c)?{referencedPath:["session","doc","main",a.id.toString()],formattedRangeIndex:h,anchorMode:null!==v&&void 0!==v?v:Hk.b.Unspecified,anchoredObjectType:v==Hk.b.Floating?c:void 0}:null}VOg(a,c,h,v,B){c=this.yUe(c,h,v,B);null!=c&&null!=a&&a.push(c)}wFm(a){const c=[];if(null==a)return r.ULS.sendTraceTag(null,389,10,"FormattingExtractor.ProcessAnchoredObjects: paragraphNode is null."),
c;let h=null;a.hasProperty(Yb.a.k3)&&(h=a.getValue(Yb.a.k3));if(null!=h)for(let v=0;v<h.length;++v){const B=or.Maf(a,h,v),X=this.A9e(B);null!=X&&this.VOg(c,B,X,null,Hk.b.Floating)}return c}j6g(a){if(null==a||!a.hasProperty(Ed.a.mm))return!1;const c=a.getValue(Ed.a.mm);for(let v=0;v<c.length;v++){var h=or.Maf(a,c,v);h=this.A9e(h);if(this.ZWh(h))return!0}return!1}}or.Rhi=new Map([[5,Hk.f.Image],[11,Hk.f.TextBox],[7,Hk.f.Chart],[6,Hk.f.SmartArt],[10,Hk.f.Drawing],[2,Hk.f.EquationObject],[4,Hk.f.Ink],
[19,Hk.f.PageBreak],[23,Hk.f.FootnoteEndnote],[24,Hk.f.FootnoteEndnote],[35,Hk.f.FootnoteEndnoteReferenceMark],[36,Hk.f.FootnoteEndnoteReferenceMark],[0,Hk.f.Other]]);or.Xyn=new Set([Hk.f.Image,Hk.f.TextBox,Hk.f.Chart,Hk.f.SmartArt,Hk.f.Drawing,Hk.f.Ink]);Object(w.a)(or,"FormattingExtractor",null,[493]);var CE=b(938);class BN extends Sys.EventArgs{constructor(a){super();this.v0b=a}}Object(w.a)(BN,"HasNodeEventsEventArgs",Sys.EventArgs,[]);class CN extends Sys.EventArgs{constructor(a){super();this.m4=
a}}Object(w.a)(CN,"IsCollectingNodeEventsEventArgs",Sys.EventArgs,[]);class DN{constructor(a,c,h){this.LNc=a;this.graphNode=c;this.fullPath=h}}Object(w.a)(DN,"NodeEvent",null,[524]);class EN{constructor(){this.Yme=this.Kke=!1;this.Gnb=null;this.ma=new Rd.a;this.F6=new Yc.a(0);this.n4a=new CE.a(oa.a.yi());this.rob=new CE.a(oa.a.yi());this.mbd=[]}wPg(a){this.ma.addHandler("IsCollectingNodeEventsChangedKey",a)}K6j(){this.F6=new Yc.a(0);this.v0b=!1}get v0b(){return this.Kke}set v0b(a){this.Kke!==a&&(this.Kke=
a,this.ma.raiseEvent("HasNodeEventsChangedKey",new BN(a),this))}get m4(){return this.Yme}set m4(a){this.Yme!==a&&(this.Yme=a,this.ma.raiseEvent("IsCollectingNodeEventsChangedKey",new CN(a),this))}AFb(a,c){this.n4a.Ja(a)||this.n4a.Z(a,c)}l7m(a,c){this.rob.Z(a,c)}LRk(a){let c=null;this.rob.Ja(a)&&(c=this.rob.J(a),this.rob.remove(a));return c}sXd(a,c){if(a)if(this.m4){var h=3!==c&&4!==c&&5!==c||!this.n4a.Ja(String.format("{0}",a.id))?Yg.a.wI(a):this.n4a.J(String.format("{0}",a.id));if(({value:v}=this.F6.Ab(h)).returnValue)if(v||
3!==c)if(5===v&&3===c){if(a=h.split("\\").pop(),this.rob.Ja(a)){var v=this.rob.J(a);v===h?(this.oqf(h,c),this.F6.add(h,c)):(this.rob.Z(a,h),this.n4a.Z(a,v),this.f2h(h),this.F6.remove(h),this.oqf(h,c),this.F6.add(v,5))}}else v&&(4!==v||0!==c&&3!==c&&5!==c)&&(this.oqf(h,c),this.F6.add(h,c));else this.f2h(h),this.F6.remove(h);else this.V8l(h,c),Array.enqueue(this.mbd,a),this.F6.add(h,c);this.v0b=0<this.F6.count}else r.ULS.sendTraceTag(593761369,389,15,"Can't record a node event if not in collecting mode.");
else r.ULS.sendTraceTag(593761370,389,15,"node is null.")}V8l(a,c){r.ULS.sendTraceTag(593761368,389,100,"Recording new event in queue for node {0} of kind {1}.",a,c)}oqf(a,c){r.ULS.sendTraceTag(593761366,389,100,"Recording new event for node {0} of kind {1}.",a,c)}f2h(a){r.ULS.sendTraceTag(593761367,389,100,"Removing node {0} form _nodeIdEventKindMap.",a)}fck(){let a=null;var c=!1;let h=null;for(;this.mbd.length&&!c;){h=Array.dequeue(this.mbd);if(!h)return r.ULS.sendTraceTag(593761365,389,15,"graphNode should not be null."),
null;this.n4a.Ja(String.format("{0}",h.id))?(a=this.n4a.J(String.format("{0}",h.id)),this.n4a.remove(String.format("{0}",h.id)),Array.enqueue(this.mbd,h)):a=Yg.a.wI(h);c=this.F6.Ja(a)}if(!c)return r.ULS.sendTraceTag(593761364,389,15,"NodeEventCollection is empty."),this.K6j(),null;c=this.F6.J(a);this.F6.remove(a);this.v0b=0<this.F6.count;r.ULS.sendTraceTag(593761363,389,100,"Consuming new event for node {0} of kind {1}.",a,c);return new DN(c,h,a)}rPm(a){this.Gnb=a}gck(){if(!this.Gnb)return null;for(var a=
0;a<this.Gnb.length;a++){var c=this.Gnb.J(a);c=Yg.a.wI(c.node);if(this.F6.Ja(c))return null}a=this.Gnb;this.Gnb=null;return a}a7j(){this.Gnb=null}dwn(){this.m4=!0}CKl(a){return this.F6.Ja(a.id.toString())}}Object(w.a)(EN,"NodeEventsCollection",null,[492]);var HQ=b(268);class FN extends zr.a{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc){super();this.eG=rc;this.Z7c=new Pz.a;this.Y3a=!1;this.oic=null;this.ou=c;this.pga=h;this.Gtj=tn.b(v.gOf);this.lfc=a.$("AugLoopOperationsAreEnabled");this.$e=B;this.O6=
X;this.rr=ma;this.Ta=Pa;this.sr=mb;this.dD=Tb;this.Uhc=new Set;this.She=new Set;Tc.Usa(this,7);this.M7i=new Set([Ed.a.Pl,Ed.a.bold,Ed.a.italic,Ed.a.underline,Ed.a.font,Ed.a.fontSize,Ed.a.fontColor,zi.a.capitalization,Ed.a.xk,Ed.a.mm,Yb.a.Rda,Yb.a.yka,Yb.a.uV,Yb.a.Qda,Yb.a.xka,Yb.a.eP,Yb.a.tK,Yb.a.Zt,Yb.a.listID,Yb.a.gS,Yb.a.sk,Yb.a.XAa,Yb.a.IM,Yb.a.Wh])}get index(){return 7}get POc(){return this.oic}set POc(a){this.oic=a;this.O6.Tzf=a?()=>{this.oic()}:null}init(){this.jWc()&&this.tY();this.pga.wPg(Object(m.a)(this,
this.cwf,"nodeEventCollection_IsCollectingNodeEventsChanged"))}tY(){this.ou?(this.Y3a=!0,this.ou.Yo(Object(m.a)(this,this.Gda,"onParagraphConnect")),this.ou.RL(Object(m.a)(this,this.a$h,"onBeforeParagraphDisconnect")),this.ou.Mt(Object(m.a)(this,this.YCb,"onParagraphDisconnected")),this.ou.Yl(Object(m.a)(this,this.Z0,"onParagraphPropertyChanged")),this.ou.eQg(Object(m.a)(this,this.Sbi,"onParagraphPropertyLoaded")),this.ou.UHj(Object(m.a)(this,this.b$h,"onBeforeParagraphValidatePersistence"))):r.ULS.sendTraceTag(39403912,
389,10,"RegisterEventHandlers: ParagraphNode event handlers can't be null.")}Wib(){this.ou?(this.Y3a=!1,this.ou.oE(Object(m.a)(this,this.Gda,"onParagraphConnect")),this.ou.wY(Object(m.a)(this,this.a$h,"onBeforeParagraphDisconnect")),this.ou.R9(Object(m.a)(this,this.YCb,"onParagraphDisconnected")),this.ou.WI(Object(m.a)(this,this.Z0,"onParagraphPropertyChanged")),this.ou.Tri(Object(m.a)(this,this.Sbi,"onParagraphPropertyLoaded")),this.ou.hYm(Object(m.a)(this,this.b$h,"onBeforeParagraphValidatePersistence"))):
r.ULS.sendTraceTag(39403913,389,10,"UnregisterEventHandlers: ParagraphNode event handlers can't be null.")}KFd(a){a&&this.Z7c.add(a.id,a.ia(Yb.a.Wh,0))}iUi(a){this.Z7c.Ja(a.id)?(this.O6.qSn(MH.a.LWc,a,this.Z7c.J(a.id)),this.Z7c.remove(a.id)):(this.O6.V6j(MH.a.LWc),this.POc&&this.POc())}e0a(a){const c=Eb.App.oa.Da.Jb;return!!c&&c.jr&&!!c.sc&&!!c.sc.Mb&&!!a&&!!a.Mb&&a.Mb.id===c.sc.Mb.id}Gda(a,c){(a=c.node)&&this.e0a(a)&&(r.ULS.sendTraceTag(40253400,389,100,"New paragraph Connect event."),Yg.a.bon(a,
this.pga.m4,this.lfc,this.Gtj)&&(this.pga.sXd(a,0),this.iUi(a)));this.pga.m4&&this.O6.$eb(a)}a$h(a,c){a=c.node;this.pga.AFb(String.format("{0}",a.id),Yg.a.wI(a))}YCb(a,c){(a=c.node)&&this.e0a(a)&&(r.ULS.sendTraceTag(40253401,389,100,"New paragraph Disconnect event."),this.pga.m4&&this.pga.sXd(a,3));this.pga.m4&&this.O6.Rbi(a,3)}Z0(a,c){a=c.node;c=c.property;a&&this.M7i.has(c)&&this.e0a(a)&&(r.ULS.sendTraceTag(40253402,389,100,"New paragraph Modified event."),this.pga.m4&&(this.pga.sXd(a,2),c===Yb.a.Wh&&
this.iUi(a)));this.pga.m4&&c===Yb.a.Ib&&this.O6.Rbi(a,2)}b$h(a,c){(a=c.node)&&sd.ParagraphReader.tb(a)&&!this.Uhc.has(a)&&!this.She.has(a)&&(this.Uhc.add(a),this.gY())}run(){if(0!==this.Uhc.size){var a=[];for(let c of this.Uhc)a.push(c),this.She.add(c),100<=a.length&&(this.Ghh(a),a=[]);0<a.length&&this.Ghh(a);this.Uhc.clear()}}Ghh(a){const c=new Se.a(4,1,500,()=>{for(let h of a)this.She.delete(h),this.updateAnnotationRangeData(h)},158);this.Ta.ub(c)}updateAnnotationRangeData(a){var c=this.sr.TVa(a,
0,v=>this.Bpn(v.intent));if(0<c.count)for(const v of c){c=this.O6.adl(v.intent.id);var h=a.dia;const B=sd.ParagraphReader.vR(a);v.end<v.begin||(h=HQ.a.yWb(B,h,v.begin,v.end-v.begin,v.begin,v.end-v.begin,a),this.dD.FJf(a.Mb,c,h))}}Bpn(a){return this.eG?!!a&&this.rr.gra(a)&&!!a.content:!!a&&this.rr.wJd(a.annotationType)&&!!a.content}Sbi(a,c){r.ULS.sendTraceTag(51389214,389,100,"Paragraph load event.");(a=c.node)&&this.$e.Bkm(a)}cwf(){this.jWc()?this.tY():this.Y3a&&!this.pga.m4&&this.Wib()}jWc(){return!this.Y3a&&
this.pga.m4}}Object(w.a)(FN,"ParagraphNodeEventHandler",zr.a,[355]);var IQ=b(885),GN=b(526);class XF extends GN.a{constructor(){super();this.H_=Object.assign(new no.a,{T_:XF.getTypeName(),B_:XF.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}}Object(w.a)(XF,"DeltaUpdateOperation",GN.a,[]);class HN{constructor(){this.referencedPath=null}}Object(w.a)(HN,"ItemReference",null,[]);class IN extends Eo.a{constructor(){super();
this.op=this.delta=this.parentPath=null}}Object(w.a)(IN,"ItemWithPath",Eo.a,[]);var TH=b(866);class DE extends TH.a{constructor(){super();this.prevParentPath=null;this.H_=Object.assign(new no.a,{T_:DE.getTypeName(),B_:DE.getBaseTypes()})}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}Object(w.a)(DE,"MoveOperation",TH.a,[]);class EE extends dp.a{constructor(){super();this.selectedRanges=null;
this.H_=Object.assign(new no.a,{T_:EE.getTypeName(),B_:EE.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}Object(w.a)(EE,"SelectionSignal",dp.a,[]);class YF extends EE{constructor(){super();this.content=null;this.H_=Object.assign(new no.a,{T_:YF.getTypeName(),B_:YF.getBaseTypes()})}static getTypeName(){return"AugLoop_Text_SelectionContentSignal"}static getBaseTypes(){return["AugLoop_Text_SelectionSignal","AugLoop_Signals_Signal"]}}
Object(w.a)(YF,"SelectionContentSignal",EE,[]);class JN{constructor(){this.range=this.tileReference=null}}Object(w.a)(JN,"TextTileRange",null,[]);var JQ=b(1484);class KN{constructor(a,c,h,v,B,X,ma,Pa){this.WS=this.Pie=null;this.JAe=!1;this.Ega=this.Eqe=this.Mfd=null;this.qa=a;this.JQa=c;this.Ta=h;this.asc=v;this.n8i=this.qa.$("AugLoopOperationsAreEnabled");this.bqb=new Zc.a(oa.a.yi());this.$e=B;this.Me=X;this.tob=ma;this.ya=Pa;this.Ly=new qf.a(()=>Eb.App.oa.Da.Zb.Lc);this.V1c=this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AutoreplaceIsEnabled",
!1);this.ya.aC(Object(m.a)(this,this.Kka,"processSetSelectionFinished"));Yg.a.Yn().then(()=>{this.WS=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacBox4AugLoopTimeBasedYieldTraversalSettings");this.qa.$("AugLoopAnnotationsIsEnabled")&&this.WS.setAnnotationResultCallback(Object.assign(new JQ.a,{handler:mb=>{this.$e.qMj(mb)}}));this.n8i&&this.JQa.dwn();this.Uwn()}).catch(()=>{})}NJk(){this.Me.$c(()=>{var a;const c=yr.a.instance.Zpa;
this.hx()&&this.u3j(c);for(this.asc.reset();this.JQa.v0b&&!this.asc.seb();){let B;B=this.JQa.fck();if(!B||!B.graphNode){r.ULS.sendTraceTag(41719901,389,15,"FirePreparedEventsForOperations: nodeEvent or nodeEvent.GraphNode is null.");this.asc.update();continue}if(!this.Lnn(B)){r.ULS.sendTraceTag(41719902,389,50,"FirePreparedEventsForOperations: Node with id {0} was not processed.",B.graphNode.id);this.asc.update();continue}const X=B.graphNode.id.toString();var h=-1,v=!0;c&&Gc.SelectionEditor.ke(c)&&
X==c.node.id.toString()&&(h=c.cpBegin,v=!1);let ma=null;if(this.bqb.contains(X))switch(B.LNc){case 3:this.bqb.remove(X);ma=3;break;default:ma=B.LNc}else switch(B.LNc){case 0:case 1:this.bqb.add(X);ma=0;break;case 2:this.bqb.add(X);ma=0;break;case 3:this.bqb.remove(X);ma=3;break;default:ma=B.LNc}if(null!=ma){h=this.D9e(B.graphNode,B.fullPath,ma,h,v);if(4==ma||5==ma){if(h.prevParentPath.join()!==h.parentPath.join()){v=Object.assign(new Hf.a,{parentPath:h.prevParentPath,items:h.items});const Pa=Object.assign(new fo.a,
{parentPath:h.parentPath,items:h.items,prevId:h.prevId,nextId:h.nextId});this.WS.submitOperation(Object.assign(new mp.a,{operation:v}));this.WS.submitOperation(Object.assign(new mp.a,{operation:Pa}));B.graphNode.type===wx.a.table&&this.ezi(B.graphNode,h.parentPath).forEach(mb=>{this.WS.submitOperation(Object.assign(new mp.a,{operation:mb}))})}}else this.WS.submitOperation(Object.assign(new mp.a,{operation:h}));if(this.V1c&&this.Ega&&this.Ega[0]==X)switch(ma){case 3:this.Ega=null;break;case 0:case 1:case 2:case 4:case 5:this.Ega[1]=
null===(a=this.tob.rxb(B.graphNode))||void 0===a?void 0:a.bDc(B.graphNode)}r.ULS.sendTraceTag(40776388,389,100,"FirePreparedEventsForOperations: Operation with OpType {0} submitted for tileId {1}",Un.a.getTypeNameFor(h),X);switch(ma){case 0:case 4:case 5:this.$e.Gtm(B.graphNode);break;case 3:this.$e.Htm(B.graphNode,h.parentPath.join("\\"))}}this.asc.update()}(a=this.JQa.gck())&&this.vti(a)},"TV:FPEFO")}u3j(a){const c=[],h=this.$e.OLb.entries();for(let v=0;v<this.$e.OLb.size;v++){const B=h.next();
(2E3<=Date.now()-B.value[1]||a.node.id!=B.value[0])&&c.push(B.value[0])}c.forEach(v=>{this.$e.OLb.delete(v);this.yGn(Yg.a.hEc(this.Ly.value,v))})}Lnn(a){return 3===a.LNc||Yg.a.VGi(a.graphNode)}Uwn(){!this.Pie&&this.JQa.m4&&(this.Pie=new Se.a(4,2,this.qa.vb("NodeEventsFiringInterval",500),Object(m.a)(this,this.NJk,"firePreparedEventsForOperations"),131),this.Ta.ub(this.Pie))}ezi(a,c){var h,v=[];const B=Kd.GraphIterator.va(a),X=B.ro();for(var ma=0;ma<X;ma++){let Pa=B.QG(ma);Pa.type===wx.a.outlineElement&&
(Pa=ie.OutlineElementNavigator.Fd(B));const mb=Pa.id.toString(),Tb=null===(h=this.tob.rxb(Pa))||void 0===h?void 0:h.Sqd(Pa);v.push(Object.assign(new Eo.a,{body:Tb,id:mb,revId:Yg.a.Uaf(Pa)}));B.mc(a.type)}c.push(a.id.toString());h=[];h.push(Object.assign(new fo.a,{parentPath:c.slice(),items:v,prevId:null}));for(v=0;v<X;v++)ma=B.QG(v),ma.type===wx.a.outlineElement&&(ma=ie.OutlineElementNavigator.Fd(B)),0<B.ro()&&(h=h.concat(this.ezi(ma,c))),B.mc(a.type);c.pop();return h}hJa(a){return a.split("\\").slice(0,
-1)}D9e(a,c,h,v=-1,B=!0){var X;let ma=null,Pa=null;const mb=a.id.toString();var Tb=null;3!==h&&(Tb=Yg.a.OYj(a));if(Tb)for(let rc=0;rc<Tb.length;rc++)if(Tb[rc]===mb){Pa=rc+1<Tb.length?Tb[rc+1]:null;ma=rc?Tb[rc-1]:null;break}Tb=null===(X=this.tob.rxb(a))||void 0===X?void 0:X.Sqd(a,v,B);v=[Object.assign(new Eo.a,{body:Tb,id:mb,revId:Yg.a.Uaf(a)})];switch(h){case 0:case 1:return Object.assign(new fo.a,{parentPath:this.hJa(c),items:v,prevId:ma,nextId:Pa});case 4:return Object.assign(new DE,{parentPath:this.hJa(Yg.a.wI(a)),
prevParentPath:this.hJa(c),items:v,prevId:ma,nextId:Pa});case 5:return h=this.JQa.LRk(mb),Object.assign(new DE,{parentPath:this.hJa(null!==h&&void 0!==h?h:Yg.a.wI(a)),prevParentPath:this.hJa(c),items:v,prevId:ma,nextId:Pa});case 2:return Object.assign(new aD.a,{parentPath:this.hJa(c),items:v});case 3:return Object.assign(new Hf.a,{parentPath:this.hJa(c),items:v});default:return r.ULS.sendTraceTag(42084322,389,15,"Submitted unknown operation for NodeEventKind ${0}, tileId {1}",h,mb),Object.assign(new TH.a,
{parentPath:this.hJa(c),items:v,prevId:ma,nextId:Pa})}}Ljl(a){return this.Ega&&this.Ega[0]===a?this.Ega[1]:null}wan(a){var c;if(!this.V1c)return r.ULS.sendTraceTag(545552581,389,10,"sendTile: autoreplace is not enabled"),!1;if(!Yg.a.VGi(a))return!1;const h=a.id.toString();var v=this.bqb.contains(h)?2:0;v=this.D9e(a,Yg.a.wI(a),v);this.WS.submitOperation(Object.assign(new mp.a,{operation:v}));this.bqb.add(h);this.Ega=[h,null===(c=this.tob.rxb(a))||void 0===c?void 0:c.bDc(a)];return!0}s$m(a,c){var h;
if(this.V1c){var v=a.id.toString(),B=this.hJa(Yg.a.wI(a));c=[Object.assign(new IN,{id:v,revId:Yg.a.Uaf(a),parentPath:B,delta:c})];B=Object.assign(new XF,{parentPath:B,items:c});this.WS.submitOperation(Object.assign(new mp.a,{L5n:B}));r.ULS.sendTraceTag(545552583,389,50,"sendDeltaOperation: tileId {0}",v);this.Ega=[v,null===(h=this.tob.rxb(a))||void 0===h?void 0:h.bDc(a)]}else r.ULS.sendTraceTag(545552582,389,10,"sendDeltaOperation: autoreplace is not enabled")}Kka(a,c){var h;if(c.rk&&c.rk.length){if(this.V1c)if(a=
Yg.a.J8k(c.rk),!a)this.Ega=null;else if(!this.Ega||this.Ega[0]!=a.id.toString()){const v=this.JQa.CKl(a)?null:null===(h=this.tob.rxb(a))||void 0===h?void 0:h.bDc(a);this.Ega=[a.id.toString(),v]}this.JAe&&(this.uWh()?this.JQa.rPm(c.rk.Fa):this.lDi(!1))}}rQj(a,c){if(a.tileReference.referencedPath.length!==c.tileReference.referencedPath.length||a.range.start!==c.range.start||a.range.length!==c.range.length)return!1;for(let h=0;h<a.tileReference.referencedPath.length;h++)if(a.tileReference.referencedPath[h]!==
c.tileReference.referencedPath[h])return!1;return!0}nQj(a,c){if(a.selectedRanges.length!==c.selectedRanges.length||a.content!==c.content)return!1;for(let h=0;h<a.selectedRanges.length;h++)if(!this.rQj(a.selectedRanges[h],c.selectedRanges[h]))return!1;return!0}vti(a){var c;if(a){var h=new Ua.a,v="";for(let ma=0;ma<a.length;ma++){var B=a.J(ma),X=(null===(c=this.tob.rxb(B.node))||void 0===c?void 0:c.Sqd(B.node)).content;v+=X;X=B.cpBegin<X.length?B.cpBegin:-1;X=Object.assign(new nN.a,{start:X,length:B.cpEnd-
B.cpBegin});const Pa=B.node.id.toString();B=this.hJa(Yg.a.wI(B.node));B.push(Pa);h.add(Object.assign(new JN,{range:X,tileReference:Object.assign(new HN,{referencedPath:B})}))}a=Object.assign(new YF,{selectedRanges:h.toArray(),content:v});this.Eqe&&this.nQj(a,this.Eqe)||(c=this.Mfd?this.Mfd:N.a.create().toString(),h=[Object.assign(new Eo.a,{body:a,id:c})],this.Mfd?c=Object.assign(new aD.a,{parentPath:["session","doc"],items:h}):(this.Mfd=c,c=Object.assign(new fo.a,{parentPath:["session","doc"],items:h})),
this.WS.submitOperation(Object.assign(new mp.a,{operation:c})),this.Eqe=a)}}Uin(a){this.uWh()&&this.lDi(a)}lDi(a){(this.JAe=a)?this.vti(this.ya.Ca.Fa):this.JQa.a7j()}uWh(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableSendSelectionSignalToAugloop",!1)}yGn(a){a=this.D9e(a,Yg.a.wI(a),2);this.WS.submitOperation(Object.assign(new mp.a,{operation:a}))}hx(){return!!l.AFrameworkApplication.K&&l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ProofingALV2Migration",
!1)}}Object(w.a)(KN,"TileView",null,[357]);var ZF=b(1633),$F;(function(a){a[a.none=0]="none";a[a.firstRow=32]="firstRow";a[a.lastRow=64]="lastRow";a[a.firstCol=128]="firstCol";a[a.lastCol=256]="lastCol";a[a.noHBand=512]="noHBand";a[a.noVBand=1024]="noVBand";a[a.nwCell=160]="nwCell";a[a.neCell=288]="neCell";a[a.swCell=192]="swCell";a[a.seCell=320]="seCell";a[a.defaultLook=1184]="defaultLook"})($F||($F={}));Object(w.b)("TableLookFlags",$F);class LN{Sqd(a){if(a)switch(a.type){case 14:return this.wmk(a);
case 15:return new ZF.TableRow;case 16:return this.umk(a)}else r.ULS.sendTraceTag(524149331,389,10,"ConvertNodeToTile: Node can't be null.")}wmk(a){var c=a.tU||[];let h=0;for(let v=0;v<c.length;v++)h+=c[v];c=c.map((v,B)=>({columnId:B.toString(),widthPercent:0!=h?100*v/h:0}));return new ZF.WordTable({columnDefs:c,tableLook:a.properties.ia(Yb.a.tableLook,$F.defaultLook),complexTable:a.properties.ia(Yb.a.complexTable,!1),floatingTable:a.properties.ia(Yb.a.oSh,!1)})}umk(a){return new ZF.TableCell({rowspan:a.properties.ia(Yb.a.rowSpan,
1),colspan:a.properties.ia(Yb.a.colSpan,1),borderInfo:{topBorder:{color:a.properties.ia(Yb.a.MHb,0),size:a.properties.ia(Yb.a.NHb,4),style:a.properties.ia(Yb.a.G0a,"single")},leftBorder:{color:a.properties.ia(Yb.a.IHb,0),size:a.properties.ia(Yb.a.JHb,4),style:a.properties.ia(Yb.a.E0a,"single")},rightBorder:{color:a.properties.ia(Yb.a.KHb,0),size:a.properties.ia(Yb.a.LHb,4),style:a.properties.ia(Yb.a.F0a,"single")},bottomBorder:{color:a.properties.ia(Yb.a.GHb,0),size:a.properties.ia(Yb.a.HHb,4),style:a.properties.ia(Yb.a.D0a,
"single")}},verticalAlignment:a.properties.ia(Yb.a.Lea,ZF.TableCellVerticalAlignment.Top),ghostCell:a.properties.ia(Yb.a.ghostCell,!1),renderCell:a.properties.ia(Yb.a.renderCell,!1),skippedCell:a.properties.ia(Yb.a.skippedCell,!1),fillColor:a.properties.ia(Ed.a.dI,0),verticalMerge:a.properties.ia(Vq.a.vMerge,null)})}bDc(a){return null===a||void 0===a?void 0:a.properties}}Object(w.a)(LN,"TableElementNodeToTileConverter",null,[356]);class MN{constructor(a,c,h){this.Vt=c;this.gta=h;this.xvd=!1;this.oic=
null;this.Bdi=(v,B)=>{this.xsa(B.node,0)};this.xdi=(v,B)=>{v=B.node;this.gta.AFb(v.id.toString(),Yg.a.wI(v))};this.Cdi=(v,B)=>{this.xsa(B.node,3)};this.mSd=(v,B)=>{this.xsa(B.node,2)};this.Edi=(v,B)=>{this.xsa(B.node,0)};this.Fdi=(v,B)=>{this.xsa(B.node,3)};this.Ddi=(v,B)=>{v=B.node;this.gta.AFb(v.id.toString(),Yg.a.wI(v))};this.nSd=(v,B)=>{this.xsa(B.node,2)};this.zdi=(v,B)=>{this.xsa(B.node,0)};this.ydi=(v,B)=>{v=B.node;this.gta.AFb(v.id.toString(),Yg.a.wI(v))};this.Adi=(v,B)=>{this.xsa(B.node,
3)};this.kSd=(v,B)=>{var X;v=B.node;if(B.property===Yb.a.ghostCell){if(B=v.lf?v:null===(X=v.Hra)||void 0===X?void 0:X.controlCell){X=Kd.GraphIterator.va(B);var ma=X.ro();for(var Pa=0;Pa<ma;Pa++){X.QG(Pa);var mb=ie.OutlineElementNavigator.Fd(X);this.gta.AFb(mb.id.toString(),String.format("{0}\\{1}",Yg.a.wI(B),mb.id));this.xsa(mb,4);X.mc(16)}}}else if(B.property===Ed.a.ge){B=Kd.GraphIterator.va(v);X=B.ro();let Tb=null;ma=[];for(Pa=0;Pa<X;Pa++)B.QG(Pa),mb=ie.OutlineElementNavigator.Fd(B),this.gta.l7m(mb.id.toString(),
String.format("{0}\\{1}",Yg.a.wI(v),mb.id)),14!=mb.type?(Tb=Yg.a.wI(mb),this.gta.AFb(mb.id.toString(),Tb),this.xsa(mb,5)):ma.push(mb),B.mc(16);ma.forEach(rc=>{this.gta.AFb(rc.id.toString(),String.format("{0}\\{1}",Tb.split("\\").slice(0,-1).join("\\"),rc.id));this.xsa(rc,5)})}this.xsa(v,2)};this.cwf=()=>{this.jWc()?this.tY():this.xvd&&!this.gta.m4&&this.Wib()};this.lfc=a.$("AugLoopOperationsAreEnabled")}get POc(){return this.oic}init(){this.jWc()&&this.tY();this.gta.wPg(this.cwf)}tY(){const {x4d:a,
B4d:c,p4d:h}=this.luh();if(a&&c&&h){this.xvd=!0;var v=this.xdi,B=this.Cdi,X=this.mSd;a.Yo(this.Bdi);a.RL(v);a.Mt(B);a.Yl(X);v=this.Ddi;B=this.Fdi;X=this.nSd;c.Yo(this.Edi);c.RL(v);c.Mt(B);c.Yl(X);v=this.ydi;B=this.Adi;X=this.kSd;h.Yo(this.zdi);h.RL(v);h.Mt(B);h.Yl(X)}else r.ULS.sendTraceTag(524149329,389,10,"RegisterEventHandlers: TableNode event handlers can't be null.")}Wib(){const {x4d:a,B4d:c,p4d:h}=this.luh();if(a&&c&&h){this.xvd=!1;var v=this.xdi,B=this.Cdi,X=this.mSd;a.oE(this.Bdi);a.wY(v);
a.R9(B);a.WI(X);v=this.Ddi;B=this.Fdi;X=this.nSd;c.oE(this.Edi);c.wY(v);c.R9(B);c.WI(X);v=this.ydi;B=this.Adi;X=this.kSd;h.oE(this.zdi);h.wY(v);h.R9(B);h.WI(X)}else r.ULS.sendTraceTag(524149330,389,10,"UnregisterEventHandlers: TableNode event handlers can't be null.")}xsa(a,c){a&&this.e0a(a)&&this.gta.m4&&this.lfc&&this.gta.sXd(a,c)}luh(){return{x4d:this.Vt.Yd(14),B4d:this.Vt.Yd(15),p4d:this.Vt.Yd(16)}}e0a(a){const c=Eb.App.oa.Da.Jb;return!!c&&c.jr&&!!c.sc&&!!c.sc.Mb&&!!a&&!!a.Mb&&a.Mb.id===c.sc.Mb.id}jWc(){return!this.xvd&&
!!this.gta.m4}}Object(w.a)(MN,"TableNodeEventHandler",null,[355]);class NN{constructor(a,c){this.qym=a;this.yAn=c}rxb(a){return a?14===a.type||15===a.type||16===a.type?this.yAn:12===a.type?this.qym:null:null}}Object(w.a)(NN,"NodeToTileConverterHolder",null,[352]);class UH{constructor(){this.W=null}get name(){return"Box4.AugmentationLoop"}yb(a){this.W=a;const c=this.W.resolve("Common.IAppSettingsManager"),h=c.$("AugLoopTaskUseTimeBasedYieldStrategy"),v=new EN,B=h?new Mj(c.vb("AugLoopTaskAllowedRunTimeBeforeYielding",
10),Ve.a.ie):new lN(c.vb("AugLoopTaskNodesToRunBeforeYielding",10));this.W.ha("Common.ICpuMeter",()=>Fo.a.instance).singleInstance();this.W.ha("Box4.AugmentationLoop.AugmentationLoopStateManager",()=>new wN).as("Box4.AugmentationLoop.IAugmentationLoopStateManager").singleInstance();this.W.ha("Box4.AugmentationLoop.ParagraphNodeEventHandler",()=>new FN(c,Eb.App.aj.Pk.Yd(12),v,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),
this.W.resolve("Box4.AugmentationLoop.IPersistedAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),l.AFrameworkApplication.Cb,this.W.resolve("Box4.Intent.IIntentRangeEditor"),this.W.resolve("Box4.IIntelligenceEditor"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatePersistencePolicyFix",!1),this.W.resolve("Box4.Graph.IGraphTransactionManager"))).as("Box4.AugmentationLoop.INodeEventHandler<Box4.AParagraphNode>").singleInstance();Yg.a.A1d()&&
this.W.ha("Box4.AugmentationLoop.TableNodeEventHandler",()=>new MN(c,Eb.App.aj.Pk,v)).singleInstance();this.W.ha("Common.App.AugmentationLoop.SDX.SdxPaneSuppressionManager",()=>new kN).singleInstance();this.W.ha("Box4.AugmentationLoop.IFormattingExtractor",()=>new or(this.W.resolve("Common.IAppSettingsManager"),this.W.ra("Box4.IFeatureHelper"),this.W.resolve("Box4.List.IListReader"),this.W.resolve("Box4.IParagraphIndentationReader"),this.W.resolve("Box4.Styles.IWACStyleReader"))).singleInstance();
this.W.ha("Box4.AugmentationLoop.IAnnotationPolicies",()=>new MH.a(new qf.a(()=>Eb.App.oa.Da.Zb.Lc),this.W.resolve("Box4.Intent.IIntentRangeEditor"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatePersistencePolicyFix",!1))).singleInstance();this.W.ha("Box4.AugmentationLoop.IPersistedAnnotationStorage",()=>new at(this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.IIntelligenceReader"),this.W.resolve("Box4.IIntelligenceEditor"),this.W.resolve("Box4.AugmentationLoop.IAnnotationPolicies"),
new qf.a(()=>Eb.App.oa.Da.Zb.Lc),a.resolve("Box4.IFeatureHelper"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatePersistencePolicyFix",!1))).singleInstance();const X=this.W.resolve("IRoamingDictionary");this.W.ha("Box4.AugmentationLoop.IAnnotationStorage",()=>new $i(this.W.resolve("Common.IAppSettingsManager"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.Intent.IIntentRangeEditor"),new qf.a(()=>Eb.App.oa.Da.Zb.Lc),l.AFrameworkApplication.Cb,this.W.ra("Box4.IIntelligenceReader"),
this.W.ra("Box4.IIntelligenceEditor"),this.W.ra("Box4.AugmentationLoop.IAnnotationPolicies"),this.W.ra("Box4.AugmentationLoop.IPersistedAnnotationStorage"),a.resolve("Box4.IFeatureHelper"),l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.StatePersistencePolicyFix",!1),Fk.a.instance,()=>{try{return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager()}catch(ma){return r.ULS.sendTraceTag(50935320,389,10,"Unable to GetAugLoopRuntimeManager, most likely due to al bundle not being loaded: {0}",
ma),null}},X)).singleInstance();this.W.ha("Box4.AugmentationLoop.INodeToTileConverterHolder",()=>new NN(new IQ.a(this.W.resolve("Box4.AugmentationLoop.IFormattingExtractor")),new LN)).singleInstance();this.W.ha("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>",()=>new KN(c,v,l.AFrameworkApplication.Cb,B,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Common.ICpuMeter"),this.W.resolve("Box4.AugmentationLoop.INodeToTileConverterHolder"),
this.W.resolve("Box4.ISelectionManager"))).singleInstance();r.ULS.sendTraceTag(39966347,389,50,"TileView<TextTile, AParagraphNode> registered.");this.W.ha("Box4.AugmentationLoop.IUtilsWrapper",()=>new AN).singleInstance();this.W.ha("Box4.AugmentationLoop.IAlFactoryWrapper",()=>new zN).singleInstance()}init(){if(l.AFrameworkApplication.K.$("AugLoopOperationsAreEnabled")){r.ULS.sendTraceTag(35190237,389,50,"Initializing Box4 Augmentation Loop package.");const a=new nr(this.W.resolve("Common.IAppSettingsManager"),
l.AFrameworkApplication.fe,Eb.App.Rea,this.W.resolve("Box4.AugmentationLoop.IAugmentationLoopStateManager"),Um.a.instance,this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage")),c=new mN;this.W.register(309,"Box4.AugmentationLoop.IAlSessionLifeEventNotifier").singleInstance().pTn(()=>c);const h=Yg.a.RZl(this.W.resolve("Common.IDynamicScriptLoaderProvider").$C,this.W.resolve("Common.App.OAuth.IOAuthManager"),a,this.W.resolve("Common.ISharedDependencyLoader"),c);this.W.ha("Box4.AugmentationLoop.RuntimeManagerInitializationTracker",
()=>new yN(h)).singleInstance();this.W.resolve("Box4.AugmentationLoop.ParagraphNodeEventHandler").init();Yg.a.A1d()&&this.W.resolve("Box4.AugmentationLoop.TableNodeEventHandler").init();this.W.resolve("Box4.IIntelligenceReader").init();this.W.resolve("Box4.AugmentationLoop.TileView<AugLoop.Deprecated.Tiling.TextTile,Box4.AViewableGraphNode>")}}dispose(){}static main(){M.a.instance.Lb(new UH);r.ULS.sendTraceTag(35190238,389,50,"Box4 Augmentation Loop package registered.")}}Object(w.a)(UH,"Box4AugmentationLoopPackage",
null,[1,2]);var aG=b(460),KQ=b(1483);class FE{constructor(a,c,h,v=null,B=null,X=null){this.YQ=new KQ.a(c,v,B,X);this.Xa=a;this.Nb=h}get type(){return this.YQ.type}get id(){return this.YQ.id}get intent(){return this.YQ.intent}Ge(a){return new FE(a,this.type,this.Nb,this.id,this.intent,this.YQ.Ura)}toString(){return String.format("Core = [{0}], IsStart = {1}",this.YQ,this.Nb)}}Object(w.a)(FE,"IntentObject",null,[166]);var ON=b(469);class zB{constructor(){this.cjc=new gd.a}Tkd(a,c,h,v,B=null,X=null,
ma=null){a=a.c8(c,a.la.U6g(c));a.sj||(a.sj=new ON.a(a));a.sj.add(new FE(a,h,v,B,X,ma));a.isFromErrorRangeSplit=!0}xqi(a){return a.Xa&&a.Xa.sj&&a.Xa.sj.VSc(c=>c===a,[a.type])?!0:!1}uWm(a,c){if(a.type===c.type&&a.Nb&&!c.Nb&&a.Xa&&a.Xa.sj&&a.Xa.sj.contains(a)&&c.Xa&&c.Xa.sj&&c.Xa.sj.contains(c)){var h=[a.type];a.Xa.sj.VSc(v=>v===a,h);c.Xa.sj.VSc(v=>v===c,h)}}iUn(a,c,h){if(!c)return!1;h=new WF.a([h]);for(let v=0;v<a.length;v++){const B=a.J(v);if(!B.sj)continue;let X=!0;h.u1a(B.sj,void 0,ma=>{ma.id&&c.equals(ma.id)&&
(X=!1)});if(!X)return!1}return!0}IDm(a,c,h,v){let B=null,X=null;c=new WF.a([c]);const ma=a.la;for(let Pa=0;Pa<ma.length;Pa++){const mb=ma.J(Pa);if(!mb.sj)continue;let Tb=!0;c.u1a(mb.sj,void 0,(rc,Tc)=>{if(Tc){var vd=Tc.Xa.cp<h,ee=rc.Xa.cp>v;vd&&rc.Xa.cp<=h||Tc.Xa.cp>=v&&ee||(vd&&ee?Tb=!1:vd?B=rc:ee?X=Tc:this.uWm(Tc,rc))}});if(!Tb)return!1}if(B){if(!this.xqi(B))return!1;this.Tkd(a,h,B.type,B.Nb,B.id,B.intent,B.YQ.Ura)}if(X){if(!this.xqi(X))return!1;this.Tkd(a,v,X.type,X.Nb,X.id,X.intent,X.YQ.Ura)}return!0}lSf(a){let c;
return({value:c}=this.cjc.Ab(a.type,c)).returnValue?c.lSf(a):!0}pam(a,c){if(this.lSf(c)){var h=c.id,v=c.type,B=c.begin,X=c.end;if(({cpEnd:X}=zB.PXi(a,B,X)).returnValue){if(aG.a(v)){if(!this.iUn(a.la,h,v))return}else if(!this.IDm(a,v,B,X))return;this.Tkd(a,B,v,!0,h,c.intent,c.YQ.Ura);this.Tkd(a,X,v,!1,h,c.intent,c.YQ.Ura)}}}fUd(a,c){Eb.App.oa.G_e(a,()=>{const h=new gf.GraphTransaction(2);try{h.Oa(a);const v=a.NV();try{const B=a.iX();try{c()}finally{B&&B.dispose()}}finally{v&&v.dispose()}}finally{h&&
h.dispose()}})}h5b(a,c){this.fUd(a,()=>{this.pam(a,c)})}ram(a,c){if(c.count){var h=new va.a,v=new em.a;for(var B of c){var X=B.value;aG.a(B.key)||X.Sc((Pa,mb)=>Pa.begin!==mb.begin?Pa.begin-mb.begin:Pa.end-mb.end);if(zB.mUn(X))for(var ma of X)X=ma.end,({cpEnd:X}=zB.PXi(a,ma.begin,X)).returnValue&&(X=X!==ma.end?new vD.a(ma.type,ma.begin,X,ma.id,ma.intent,ma.YQ.Ura):ma,h.add(X.begin),h.add(X.end),zB.VDj(v,X))}a.Yud(h);a=a.la;for(h=0;h<a.length;h++){B=a.J(h);if(ma=B.sj)for(const mb of c.keys)ma.ori(mb);
let Pa;({value:Pa}=v.Ab(B.cp,Pa)).returnValue||(Pa=null);if(Pa){ma||(ma=B.sj=new ON.a(B));for(const mb of Pa)ma.add(mb.Ge(B))}B.isFromErrorRangeSplit=!0}}}mrf(a,c){const h=new gd.a;for(const v of c){let B;({value:B}=h.Ab(v.type,B)).returnValue||(B=new Ua.a,h.Z(v.type,B));B.add(v)}this.fUd(a,()=>{this.ram(a,h)})}hKn(a,c){a=a.la;for(let h=0;h<a.length;h++){const v=a.J(h);v.sj&&v.sj.ori(c)}}pZc(a,c){this.fUd(a,()=>{this.hKn(a,c)})}gKn(a,c,h){let v=!1;c=c.la;h=[h];for(let B=0;B<c.length;B++){const X=
c.J(B);X.sj&&(v=X.sj.VSc(a,h)||v)}return v}j_f(a,c,h){let v=!1;this.fUd(c,()=>{v=this.gKn(a,c,h)});return v}Nwh(a,c,h,v){return!a||0>h||v>a.characterData.length||h>v?new Ua.a:this.TVa(a,c,B=>Math.max(B.begin,h)<=Math.min(B.end,v))}TVa(a,c,h){return zB.o4k(a,c,h)}static o4k(a,c,h){const v=new Ua.a;a=a.la;c=new WF.a([c]);for(let B=0;B<a.length;B++){const X=a.J(B);X.sj&&c.u1a(X.sj,void 0,(ma,Pa)=>{Pa&&(ma=new vD.a(Pa.type,Pa.Xa.cp,ma.Xa.cp,Pa.id,Pa.intent,Pa.YQ.Ura),h(ma)&&v.add(ma))})}return v}SDc(a,
c){const h=new Ua.a;if(!zB.CUl(a.contextId))return h;let v;const B=a.node;a.contextId!==ic.a.paragraph?(v=a.cpBegin,a=a.cpEnd):(v=0,a=B.characterData.length);h.addRange(this.Nwh(B,c,v,a));return h}HSm(a){this.cjc.Ja(0)||this.cjc.Z(0,a)}static PXi(a,c,h){a=sd.ParagraphReader.textLength(a);if(c>=a)return{returnValue:!1,cpEnd:h};h>a&&(h=a);return{returnValue:!0,cpEnd:h}}static mUn(a){if(!a.count)return!0;const c=new dm.a,h=a.J(0).type,v=aG.a(h);let B=-1;for(const X of a){if(X.type!==h||(aG.c(X.type)?
X.begin>X.end:X.begin>=X.end))return!1;if(v){a=X.id;if(!a||a.equals(N.a.nil)||c.contains(a))return!1;c.add(a)}else if(-1===B)B=X.end;else if(B>X.begin)return!1}return!0}static VDj(a,c){let h;({value:h}=a.Ab(c.begin,h)).returnValue||(h=new Ua.a,a.Z(c.begin,h));h.add(new FE(null,c.type,!0,c.id,c.intent,c.YQ.Ura));({value:h}=a.Ab(c.end,h)).returnValue||(h=new Ua.a,a.Z(c.end,h));h.add(new FE(null,c.type,!1,c.id,c.intent,c.YQ.Ura))}static CUl(a){return a===ic.a.xc||a===ic.a.Ub||a===ic.a.paragraph}}Object(w.a)(zB,
"IntentRangeEditor",null,[351]);class VH{constructor(){this.W=null}get name(){return"Box4.Intent"}yb(a){this.W=a;this.W.ha("Box4.Intent.IntentRangeEditor",()=>new zB).as("Box4.Intent.IIntentRangeEditor").singleInstance()}init(){this.W.resolve("Box4.IProofingManager")}dispose(){}static main(){M.a.instance.Lb(new VH)}}Object(w.a)(VH,"PackageManager",null,[1,2]);var sw=b(1223);class WH{constructor(a){this.F9l=a;this.B9l=[]}get handler(){return this.F9l}get mia(){return this.B9l}}Object(w.a)(WH,"RegisteredListener",
null,[]);class GA{constructor(a,c){this.type=0;this.payload=null;this.type=a;this.payload=c}}Object(w.a)(GA,"OfficeSharedCommentsEvent",null,[841]);class bG{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(w.a)(bG,"ViewContainerEvent",null,[841]);class GE{constructor(a){this.Mqf=!1;this.$ja=new Ua.a;this.O9l=a}hSm(a){a=new WH(a);this.$ja.add(a)}JSi(a){for(let c=0;c<this.$ja.count;++c)if(this.$ja.J(c).handler===a){this.$ja.removeAt(c);break}}RMa(a=
!1){const c=()=>{if(l.AFrameworkApplication.Qj)r.ULS.sendTraceTag(40420181,201,50,"Skipped processing comment pane events since app is shutting down.");else for(let B=0;B<this.$ja.count;++B){const X=this.$ja.J(B);for(;0<X.mia.length;){var h=Array.dequeue(X.mia);if(Object(Ub.a)(bG,h)){var v=X.handler;v(h)}else Object(Ub.a)(GA,h)&&(v=X.handler,v(h.type,h.payload))}}};a?c():this.Mqf||(this.Mqf=!0,io.a.q_(this.O9l,()=>{c();this.Mqf=!1},sw.a.JLk))}}Object(w.a)(GE,"GenericEventHost",null,[]);class zC{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.contextDrafts=this.smartReplies=null}}Object(w.a)(zC,"BasicEventPayload",null,[868]);class XH{constructor(a){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=a}}Object(w.a)(XH,"CommentContextDetails",
null,[]);class LQ{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.contextDrafts=null}}Object(w.a)(LQ,"ContextChangeWithSelectedThreadIndex",null,[868]);class PN{constructor(){this.tasks=this.comments=null}}Object(w.a)(PN,"LoadCommentsNoVirtualization",null,[868]);class QN extends GE{constructor(a){super(a);this.vDg=0}gin(a){this.vDg=a}OSm(a,c,h,v,B,X){a=new WH(a);X&&Array.enqueue(a.mia,this.tgk(X,this.vDg));X=
c?c.length:0;Array.enqueue(a.mia,this.A8g(X,h,v,0));X&&Array.enqueue(a.mia,this.u9g(c,B));this.$ja.add(a);this.RMa()}qZc(a){this.JSi(a)}o$m(a,c,h,v=0){this.ezb(this.A8g(a,c,h,v,null));this.RMa()}p$m(a,c,h){this.ezb(this.Vgk(a,c,h));this.RMa()}J$m(a,c){this.ezb(this.u9g(a,c));this.RMa()}selectComment(a){this.ezb(this.p$g(a,6));this.RMa()}highlightComment(a){this.ezb(this.p$g(a,7));this.RMa()}q0f(a,c){this.ezb(this.Wjk(a,c));this.RMa()}gEf(a,c){this.ezb(this.Xlk(a,c));this.RMa()}tgk(a,c=0){const h=
new zC;h.modelCapabilityFlags=a;h.richTextCapabilityFlags=c;return new GA(12,h)}A8g(a,c,h,v,B=null){const X=new zC;X.numberOfComments=a;X.numberOfThreads=c;X.contextDetails=Object.assign(new XH(h),{nextPopulatedContextDetails:v});X.contextDrafts=B;return new GA(0,X)}Vgk(a,c,h){const v=new zC;v.comments=a;v.numberOfThreads=c;v.tasks=h;return new GA(2,v)}u9g(a,c){const h=new PN;h.comments=a;h.tasks=c;return new GA(1,h)}p$g(a,c){const h=new zC;h.commentId="";a&&(h.commentId=a);return new GA(c,h)}Wjk(a,
c){const h=new zC;h.changes=[];h.contextDetails=Object.assign(new XH(c),{nextPopulatedContextDetails:a});return new GA(10,h)}Xlk(a,c){const h=new zC;h.commentId=a;h.smartReplies=c;return new GA(15,h)}ezb(a){for(let c=0;c<this.$ja.count;++c)Array.enqueue(this.$ja.J(c).mia,a)}}Object(w.a)(QN,"OfficeSharedCommentsEventHost",GE,[858]);class RN{constructor(){this.rAe=this.V8f=!1;this.a_=this.fl=this.jng=this.xtg=this.Ajd=this.SPb=this.fIg=this.Ecg=this.$C=this.drc=null}initialize(a,c,h,v=null,B=null,X=
null,ma=null,Pa=null,mb=null,Tb=null){this.$C=a;this.Ecg=c;this.fIg=h;this.SPb=v;this.Ajd=B;this.xtg=X;this.jng=ma;this.fl=Pa;this.V8f=!0;this.a_=mb;this.drc=Tb}Xpk(){sharedComments.setWebpackPublicPath(l.AFrameworkApplication.LV)}UGd(a=null,c=null){if(!this.V8f)return r.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((h,v)=>{v(io.a.VA(-2130915313))});if(this.rAe)return r.ULS.sendTraceTag(41424204,201,10,"InstantiateSharedComments called after shared comments was already instantiated."),
new Promise(()=>{});this.drc||(l.AFrameworkApplication.K.$("DynamicBundlesIsEnabled")?this.drc=appResourceLoader.loadChunk("sharedComments"):this.drc=this.$C.loadScript("sharedComments"));return this.drc.then(()=>{a?a():XC.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.SharedCommentsSetWebpackPublicPathRemoval")||this.Xpk();this.rAe||(this.a_&&this.a_.execute(h=>{h.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),c&&c(),
sharedComments.instantiate(this.Ecg,this.fIg,this.SPb,this.Ajd,this.xtg,this.jng,this.fl));this.rAe=!0})}}Object(w.a)(RN,"CommentActivationManager",null,[900]);class SN extends GE{constructor(a){super(a)}wUm(a){this.hSm(a)}ZKn(a){this.JSi(a)}ZDi(a){a=this.Rgk(a);for(let c=0;c<this.$ja.count;++c)Array.enqueue(this.$ja.J(c).mia,a);this.RMa(!0)}Rgk(a){const c=new bG;c.eventType=3;c.viewContainerVisibilityState=a;return c}gMk(){const a=this.cnk();for(let c=0;c<this.$ja.count;++c)Array.enqueue(this.$ja.J(c).mia,
a);this.RMa(!0)}cnk(){const a=new bG;a.eventType=2;return a}}Object(w.a)(SN,"ViewContainerEventHost",GE,[824]);class TN{constructor(){this.actionBehavior=this.actionType=0}}Object(w.a)(TN,"CommentUIActionPayload",null,[]);class UN{constructor(a,c){this.ga=a;this.Ujb=c;this.Eec=new uc.a;for(let h of this.Ujb)this.Eec.Z(h.value.canvasActionId,h.key),a=h.value,a.delayActionsUntilRegistration||this.ka(a)}ka(a){a.withFlags?this.ga.Aa(a.canvasActionId,a.canvasContextId,Object(m.a)(this,this.uMg,"actionHandler"),
97):this.ga.ka(a.canvasActionId,a.canvasContextId,Object(m.a)(this,this.uMg,"actionHandler"))}oMa(a,c){this.Ujb.Ja(a)&&(this.Ujb.J(a).delayActionsUntilRegistration&&this.ka(this.Ujb.J(a)),this.Ujb.J(a).registeredCallback=c)}uMg(a,c,h,v,B){if(this.Eec.Ja(a)){var X=this.Eec.J(a);if(!this.Ujb.Ja(X))return 8;const ma=this.Ujb.J(X);if(ma.preCallback){const Pa=ma.preCallback(a,c,h,v,B);if(2!==Pa)return Pa}if(!ma.registeredCallback)return 1===h?8:2;X=Object.assign(new TN,{actionType:X});1===h&&(X.actionBehavior=
1);X=ma.registeredCallback(X);return ma.postCallback?ma.postCallback(X,a,c,h,v,B):X?32:8}return 2}}Object(w.a)(UN,"OfficeSharedCommentsActionHost",null,[859]);var MQ=b(1284),cG=b(1023),NQ=b(291),YH=b(1385),VN=b(459);class HE{constructor(a){this.E2=a;this.G7b=new Yc.a;this.MWa=new Yc.a;this.PAl();this.cvl=[new hh.a(lh.a.o4g,lh.a.r$j),new hh.a(lh.a.n4g,lh.a.q$j),new hh.a(lh.a.h4g,lh.a.i$j),new hh.a(lh.a.g4g,lh.a.h$j),new hh.a(lh.a.q4g,lh.a.t$j),new hh.a(lh.a.p4g,lh.a.s$j)]}a_a(a){this.E2.a_a(a);this.CVm(a)}Gkf(a,
c){return!!a&&!!a.objectId&&c.contains(N.a.Ee(a.objectId))}bYa(a){a=Object(ha.a)(426,a);return!!a&&!!a.objectId}CVm(a){for(let c of this.cvl)a.classList.remove(c.className,c.BFc);a.classList.remove(lh.a.HDf,lh.a.s4g,lh.a.i4g,lh.a.r4g,HE.N4f)}PAl(){const a=new Yc.a,c=new Yc.a;a.add(0,null);a.add(1,lh.a.n4g);a.add(2,lh.a.o4g);a.add(3,lh.a.s4g);c.add(0,null);c.add(1,lh.a.g4g);c.add(2,lh.a.h4g);c.add(3,lh.a.i4g);this.MWa.Z(1,a);this.MWa.Z(2,c);this.MWa.Z(3,c);this.G7b.add(0,null);this.G7b.add(1,lh.a.p4g);
this.G7b.add(2,lh.a.q4g);this.G7b.add(3,lh.a.r4g)}}HE.N4f="CommentImportant";Object(w.a)(HE,"CommentHighlightUtils",null,[]);class ZH{constructor(){this.Aud=0;this.Atb=null}}Object(w.a)(ZH,"CommentGuidsInElementInfo",null,[]);class WN{constructor(){this.IIh=!1;this.Gha=this.iDb=null;this.ULa=this.Byb=0}}Object(w.a)(WN,"HighlightInfoForElement",null,[]);class $H{constructor(){this.dMh=this.fMh=this.eMh=-1;this.XJh=[];this.KVb=[];this.kHc=this.lHc=-1;this.CQh=!1}}Object(w.a)($H,"HighlightInfoForElementsInPara",
null,[]);class XN{constructor(){this.h_f=this.zzf=null}}Object(w.a)(XN,"OnAnchorMouseOutData",null,[]);class YN{constructor(a,c,h,v,B,X,ma,Pa){this.$de=a;this.e6=c;this.Bi=h;this.EH=v;this.ga=B;this.Ta=X;this.Te=ma;this.PQa=this.Lh=null;Pa.execute(mb=>{this.Lh=mb})}QXg(a,c,h,v){const B=new $H,X=[],ma=this.e6.bYa(c)?c.objectId:null;for(let Tb=0,rc=a.length;Tb<rc;Tb++){var Pa=a[Tb],mb=Yh.f(Pa);const Tc=Yh.c(Pa);Pa=new dm.a;const vd=new WN;if(mb){const ee=new VN.a(Yh.b);mb=this.jlh(mb,ma,ee);0<mb.length&&
(this.lOn(mb,h,Pa,vd,ma,v),X.push(Object.assign(new ZH,{Aud:Tb,Atb:ee})))}Tc&&(mb=this.jlh(Tc,ma),0<mb.length&&(this.nOn(mb,h,Pa,vd,B,ma,v,Tb),this.OMn(X,mb,Tb,vd)));0<h.count&&this.oOn(c,h,vd,v);this.MMn(X,vd);B.XJh.push(vd)}return B}iTg(a,c,h){let v=!1;for(let B=0,X=a.length;B<X;B++){const ma=a[B],Pa=c.XJh[B],mb=vk.a(ma);if(1!==mb&&2!==mb&&3!==mb)continue;const Tb=3===mb||2===mb&&-1!==ma.className.indexOf(lh.a.Iyb);this.e6.a_a(ma);this.QEj(ma,Pa,Tb,v);this.JDj(ma,B,mb,Pa,c,h);this.KDj(ma,B,c,Pa);
v=Tb}}jlh(a,c,h=null){const v=[];for(let B=0;B<a.length;B++)this.$de.wFi(a[B],a[B].toString()===c)&&(v.push(a[B]),h&&h.add(a[B]));return v}lOn(a,c,h,v,B,X){var ma;let Pa=!1,mb=!1;for(let rc of a){c.add(rc);h.add(rc);var Tb=rc.toString();Tb===B?(Tb=X?1:2,v.ULa=Tb,v.Byb=Tb):this.Gkf(this.Lh.wy,c)&&(Tb===(null===(ma=this.Lh.wy)||void 0===ma?void 0:ma.objectId)&&(mb=!0),Pa=!0)}0<a.length&&!v.ULa&&(v.ULa=mb?1:3,v.Byb=Pa?1:3)}nOn(a,c,h,v,B,X,ma,Pa){var mb,Tb;const rc=new VN.a(Yh.b);ma=ma?1:2;let Tc=!1;
for(let vd of a){const ee=vd.toString();c.contains(vd)||(ee===X?B.dMh=Pa:(B.eMh=Pa,v.ULa=3,(null===(mb=this.Lh.wy)||void 0===mb?void 0:mb.objectId)===ee&&(B.fMh=Pa,v.ULa=1)),rc.add(vd));ee===(null===(Tb=this.Lh.wy)||void 0===Tb?void 0:Tb.objectId)&&(Tc=!0);c.remove(vd);h.contains(vd)&&this.mOn(v,vd,ee,X,ma);ee===X&&(v.ULa=ma)}0<a.length&&!v.ULa&&(v.ULa=Tc?1:3);0<rc.count&&B.KVb.push(Object.assign(new ZH,{Aud:Pa,Atb:rc}))}OMn(a,c,h,v){0!==a.length&&(c.forEach(B=>{for(let X=a.length-1;0<=X;X--){const ma=
a[X];if(ma.Atb.contains(B)){ma.Aud===h&&(v.Gha?v.Gha.push(B):v.Gha=[B]);ma.Atb.remove(B);break}}}),a=a.filter(B=>0<B.Atb.count))}oOn(a,c,h,v){var B,X;this.Gkf(a,c)?h.Byb=v?1:2:h.Byb||(h.Byb=null!=(null===(B=this.Lh.wy)||void 0===B?void 0:B.objectId)&&c.contains(N.a.Ee(null===(X=this.Lh.wy)||void 0===X?void 0:X.objectId))?1:3);h.iDb||(h.iDb=[]);for(let ma of c)h.iDb.push(ma)}MMn(a,c){if(0<a.length){c.Gha||(c.Gha=[]);for(let h of a[a.length-1].Atb)c.Gha.push(h)}}mOn(a,c,h,v,B){a.IIh=!0;a.iDb||(a.iDb=
[]);a.iDb.push(c);h===v&&(a.Byb=B)}Gkf(a,c){return!!a&&!!a.objectId&&c.contains(N.a.Ee(a.objectId))}QEj(a,c,h,v){!c.ULa||h||v||((h=this.e6.G7b.J(c.ULa))&&a.classList.add(h),c.IIh&&a.classList.add(lh.a.HDf))}JDj(a,c,h,v,B,X){v=this.e6.MWa.J(h).J(v.Byb);c<B.dMh?v=X?this.e6.MWa.J(h).J(1):this.e6.MWa.J(h).J(2):c<B.eMh&&!v&&(v=c<B.fMh?this.e6.MWa.J(h).J(1):this.e6.MWa.J(h).J(3));v&&(c=B.CQh,a.classList.add(v),c&&a.classList.add(HE.N4f))}KDj(a,c,h,v){v.Gha||(v.Gha=this.DVk(c,h)||v.iDb);c=null;v.Gha&&0<
v.Gha.length&&(this.Bi.Ea(Jb.a.qV,a,Object(m.a)(this,this.Vlm,"onCommentAnchorMouseOver"),v.Gha),this.Bi.Ea(Jb.a.tda,a,Object(m.a)(this,this.Ulm,"onCommentAnchorMouseOut"),v.Gha),c=v.Gha[0]);this.Bi.Ea(Jb.a.click,a,Object(m.a)(this,this.w$h,"onCommentAnchorClick"),c);this.Bi.Ea(Jb.a.oH,a,Object(m.a)(this,this.w$h,"onCommentAnchorClick"),c)}DVk(a,c){for(;0<c.KVb.length&&c.KVb[0].Aud===a;)c.KVb.splice(0,1);if(0<c.KVb.length){a=[];for(let h of c.KVb[0].Atb)a.push(h);return a}return null}Vlm(a){if(!this.Lh||
this.EH.SId)return!0;if(a=a.ho){if(this.Lh.wy&&a[0].toString()===this.Lh.wy.objectId)return!0;this.PQa&&a[0].equals(this.PQa.h_f[0])?this.Ta.me(this.PQa.zzf):(this.PQa&&(this.Ta.me(this.PQa.zzf),this.ga.hb(Sa.a.eqd,2,this.PQa.h_f)),this.Lh.SJ.DQh(a[0])&&!this.Te.An||this.ga.hb(Sa.a.WQe,2,a));this.PQa=null}return!0}Ulm(a){if(this.EH.SId)return!0;const c=a.ho;c&&(a=new Se.a(2,1,0,()=>{this.ga.hb(Sa.a.eqd,2,c);this.PQa=null}),this.Ta.ub(a),this.PQa=Object.assign(new XN,{zzf:a,h_f:c}));return!0}w$h(a){const c=
new Se.a(2,1,0,()=>{if(this.Lh&&!this.Lh.SJ.vF){var h=a.ho;if(!h)h=Eb.App.oa.Pn.nf,this.Lh.wy&&(!h||h.name!==Fc.AFrame.WJ&&h.name!==Fc.AFrame.aq)&&this.Lh.clearSelection();else if(!this.Lh.wy||h.toString()!==this.Lh.wy.objectId)if(h=this.Lh.SJ.j0(h.toString()))h=Object.assign(new rw.a,{commentId:h.id,JV:!1,V9:1}),this.ga.hb(ba.a.selectComment,2,h)}});this.Ta.ub(c);return!1}}Object(w.a)(YN,"AllMarkupModeHighlightChangeHandler",null,[422]);var ZN=b(1275);class $N extends ZN.a{constructor(a){super(100,
25);this.Cec=new Yc.a(0);this.i7i=6E4;this.ckb=new Ua.a;this.ckb.add(1);this.ckb.add(6);this.ckb.add(2);this.ckb.add(4);this.ckb.add(10);this.ckb.add(11);this.Ld=a;a.jIf&&window.setInterval(Object(m.a)(this,this.FLk,"flushAggregatedActions"),this.i7i)}tBa(a){this.Ld.aJn&&this.Ld.jIf&&(this.ckb.contains(a)?this.JNm(a):this.aea(a+""))}JNm(a){this.Cec.Z(a,this.Cec.ax(a,0)+1)}FLk(){const a=this.Cec.keys;if(a.length){var c="";for(let h=0;h<a.length;h++)c+=a.J(h)+":"+this.Cec.J(a.J(h))+";";this.aea(c);
this.Cec=new Yc.a(0)}}}Object(w.a)($N,"CommentActionInTypingRecorder",ZN.a,[432]);class aO{static JWm(a){a&&a.atmention&&delete a.atmention.isCurrentUser;return a}}Object(w.a)(aO,"DeltaFormatHelpers",null,[]);class aI{constructor(){this.optional=this.attributes=null}}Object(w.a)(aI,"Operation",null,[]);class bI extends aI{constructor(){super();this.insert=null}}Object(w.a)(bI,"DeltaOperation",aI,[]);class bO{constructor(){this.ops=null}}Object(w.a)(bO,"Delta",null,[]);var cO=b(477),cI=b(1041),dI=
b(1591);class AC extends dI.ACommentFormatTranslator{constructor(a,c){super(a);this.$b=c}nYf(a){const c=new $q.a;for(let h=0;h<a.length;h++){const v=a[h];v.Gzb=!0;this.DNj(c,v);c.Nqa("\n")}return[c.iDc()]}WDn(a,c){a=$q.a.dzd(a[0]);a=this.eEm(a);const h=new Ua.a;let v=0,B=null,X=null;for(;v<a.ops.length;){const ma=a.ops[v];B||(B=cI.a.instance.createInstance(393230),B.Gzb=!0,B.Uh(Yb.a.Ib,uf.a.nE()),c(B),B.la.clear(),B.gla(""));"\n"===ma.insert?(X=this.bpf(B,X),this.tkn(B),h.add(B),B=null):X=this.R_l(B,
ma,X);v++}return h.toArray()}tkn(a){if(kg.a.instance.J(6)){var c=a.xZg();for(let h=0;h<c;h++)a.wordRunProperties.yp.Z(h,AC.Ngm),a.wordRunProperties.Jr.Z(h,AC.Lvf)}}bpf(a,c){var h=a.Xud();h.cp===a.characterData.length?h.Vg=!0:(h=Object.assign(new Ax.a(a,a.characterData.length),{Vg:!0}),a.la.add(h));h=a.la.last;if(c){c=!!c.Tx;const v=this.G5g(a,h,!c,c,null);h.formatting=v;c&&(a=this.E5g(a,h),h.zX=a.mi);h.Lk=!0;c=null}h.cp||h.formatting||(h.formatting=new Bp.a(h,N.a.nil));return c}R_l(a,c,h){const v=
a.Xud(),B=!!c.attributes&&!!c.attributes.link,X=!!c.attributes&&!!c.attributes.atmention,ma=this.G5g(a,v,B,X,c);v.formatting=ma;h&&(h.Tx&&(h=this.E5g(a,v),v.zX=h.mi),v.Lk=!0,h=null);if(B||X)this.s_l(v,a,c),h=v.hyperlink;a.gla(a.characterData+c.insert);return h}E5g(a,c){c=new Bp.a(c,N.a.create());let h=this.Qrd();h.setValue(Yb.a.BAb,!0);h=a.Mb.iP(h);c.mi=h.id;return c}G5g(a,c,h,v,B){c=new Bp.a(c,N.a.create());let X=cI.a.instance.createInstance(1179649);if(h||v)X.setValue(Ed.a.hz,!0),X.setValue(Ed.a.p4,
!0),h&&this.tcn(a,X);this.Ld.Asb&&B&&B.attributes&&this.hin(B.attributes,X);X=a.Mb.iP(X);c.mi=X.id;return c}tcn(a,c){kg.a.instance.J(8)&&(a=this.$b.tw(a))&&(a=a.zg(gj.StyleReader.pJb))&&c.setValue(zi.a.Oz,a.id)}hin(a,c){this.bGb(a.weight>=$q.a.lsf,c,Ed.a.bold,!0);this.bGb(a.italic,c,Ed.a.italic,!0);this.bGb(a.underline,c,Ed.a.underline,!0);this.bGb(a.underline,c,Ed.a.underlineType,fm.a.AIb);this.bGb(a.strikethrough,c,Ed.a.strikethrough,!0);if(this.Ld.Qzb){if(kn.a.RKc(a.highlight)){var h=kn.a.Dbb(a.highlight);
this.bGb(!!a.highlight,c,Ed.a.highlight,kn.a.JMa(h))}kn.a.RKc(a.color)&&(h=kn.a.Dbb(a.color),this.bGb(!!a.color,c,Ed.a.fontColor,kn.a.JMa(h)))}}bGb(a,c,h,v){a&&c.setValue(h,v)}s_l(a,c,h){if(h.attributes&&h.attributes.atmention){var v=ch.HyperlinkReader.iJa(h.attributes.atmention.email);h=h.optional&&h.optional.atmention&&h.optional.atmention.contentId?h.optional.atmention.contentId:AC.hPk(1===h.attributes.atmention.resolveState);v=new cO.a(a,v,!0,void 0,void 0,void 0,h);this.Ifk(v,c.Mb);a.hyperlink=
v}else c=ch.HyperlinkReader.iJa(h.attributes.link),v=this.uik(a.paragraph.la.first),a.hyperlink=new cO.a(a,c,!1,v.mi)}uik(a){let c=this.h$g();c=a.paragraph.Mb.iP(c);a=new Bp.a(a,N.a.nil);a.mi=c.id;return a}Ifk(a,c){var h=String.format(' HYPERLINK "{0}"',a.url),v=a.Tx;const B=this.Qrd();B.setValue(Yb.a.Qp,15);B.setValue(Yb.a.Tx,v);B.setValue(Yb.a.yKa,!0);B.setValue(Yb.a.fieldInstruction,h);a.Coa(c.iP(B).id);v=this.Qrd();v.setValue(Yb.a.Qp,47);v.setValue(Yb.a.fieldInstruction,h);a.Coa(c.iP(v).id);h=
this.Qrd();h.setValue(Yb.a.Qp,16);a.Coa(c.iP(h).id)}h$g(){const a=cI.a.instance.createInstance(1179649);a.setValue(Ed.a.hz,!0);a.setValue(Ed.a.p4,!0);a.setValue(Ed.a.isHidden,!0);return a}Qrd(){const a=this.h$g();a.setValue(Ed.a.I5,!0);return a}eEm(a){const c=new Ua.a;for(let h=0;h<a.ops.length;h++){const v=a.ops[h];v.optional=aO.JWm(v.optional);if(-1!==v.insert.indexOf("\n")&&"\n"!==v.insert){const B=v.insert.split("\n");for(let X=0;X<B.length;X++)if(h!==a.ops.length-1||X!==B.length-1||B[X])c.add(Object.assign(new bI,
{insert:B[X],attributes:v.attributes,optional:v.optional})),X!==B.length-1&&c.add(Object.assign(new bI,{insert:"\n"}))}else c.add(v)}return Object.assign(new bO,{ops:c.toArray()})}static hPk(a){return dI.ACommentFormatTranslator.aRj+Ya.a.create().toString().replace(RegExp("-","g"),"").toUpperCase()+(a?"Z":"")}}AC.Ngm=0;AC.Lvf=0;Object(w.a)(AC,"CommentDeltaFormatTranslator",dI.ACommentFormatTranslator,[]);class Cr{static q8e(a){return a===Cr.create?0:a===Cr.reply?1:a===Cr.edit?2:a===Cr.metadata?3:
null}}Cr.create="CREATE";Cr.reply="REPLY";Cr.edit="EDIT";Cr.metadata="METADATA";Object(w.a)(Cr,"CommentSessionType",null,[]);var IE=b(593);class Zw{static j6l(){const a=document.getElementsByClassName(IE.a.DBf);if(a&&a.length){var c=a[0].clientWidth;for(let h=1;h<a.length;h++){if(a[h].clientWidth!==c||h===a.length-1){r.ULS.sendTraceTag(540160401,327,50,"{0}:NoOfContainers={1}",a[h].clientWidth-c,a.length);break}c=a[h].clientWidth}}}static Z4f(a,c,h){a&&(a=Eb.App.lc.zp.T8e(a),oH.CoauthLockEditor.getInstance().d0a(a)&&
r.ULS.sendTraceTag(540160402,327,15,`Comment with ObjectId: ${c.objectId} added to a locked ${h?"start":"end"} paragraph. Lock Type ${a.Type.toString()}`))}static NUn(a,c,h){const v=c.Ra(N.a.Ee(a.objectId));if(v){var B=Oi.a.l8(v,c,!0);c=Oi.a.l8(v,c,!1);null!==B&&void 0!==B&&B.Rt||(r.ULS.sendTraceTag(540160404,327,15,`CommentRangeStart failed to save. startParaId: ${a.KTb}, CommentObjectId: ${a.objectId}`),Zw.z0h(h));null!==c&&void 0!==c&&c.Rt||(r.ULS.sendTraceTag(540160405,327,15,`CommentRangeEnd failed to save. endParaId: ${a.JTb}, CommentObjectId: ${a.objectId}`),
Zw.z0h(h))}else r.ULS.sendTraceTag(540160403,327,15,`Commited Comment missing CommentNode graph object ObjectId: ${a.objectId}`)}static z0h(a){a.pi("CommentCommit","CommentReferenceFailedToSave",{isIntentional:!1,isInternal:!0},{name:"CommentDataLoss",isIntentional:!1,isInternal:!0,isSessionEndingError:!1})}static q5l(a,c,h){0!==a.size&&a.forEach(v=>{c.has(v)||Zw.v5l(v,h)})}static v5l(a,c){c.Ra(N.a.Ee(a))&&r.ULS.sendTraceTag(539800642,327,15,`comment start missing for ${a}`)}static n4j(a){const c=
new Set;a.forEach(h=>{h&&h.Oh&&((h=Zw.O9k(h))?c.add(h):r.ULS.sendTraceTag(539554689,327,15,"Outline Node is undefined"))});c.forEach(h=>{const v=h.ia(ii.a.dRe,[]);0===h.ia(ii.a.bRe,[]).length&&0===v.length&&r.ULS.sendTraceTag(539800644,327,15,`Outline Element Node ${h.id.toString()} is missing comment info while paragraph has comments. This will cause some comments to fail to load.`)})}static PUl(a,c,h,v){a=h.rsh(a);if(!a)return!1;h=Yh.j(a);v=v.Ra(h);c.has(h.toString())&&r.ULS.sendTraceTag(539800643,
327,15,`Para Node ${h} missing comment reference for comment ${a.id}`);return v&&v.Oh?!0:(r.ULS.sendTraceTag(539567714,327,15,`Para Node ${h} with missing comment reference for comment ${a.id} is in a invalid state ${v?"paraNode containingGraph is null":"paraNode is null"}`),!1)}static O9k(a){let c;try{c=ie.OutlineElementNavigator.Al(a)}catch(h){r.ULS.sendTraceTag(539567715,327,10,`ParaNode ${a.id} OutlineNode failed to retrieve ${h}`)}return c}static HZk(a){var c;switch(null===(c=a.ZA)||void 0===
c?void 0:c.sessionType){case Cr.create:return"CommentThreadInProgress";case Cr.reply:return"CommentReplyInProgress";case Cr.edit:return"CommentEditInProgress"}}}Object(w.a)(Zw,"CommentDiagnosticHelpers",null,[]);var OQ=b(793),PQ=b(792);class JE{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc){this.yg=a;this.Ta=c;this.Me=h;this.xOa=v;this.Ld=B;this.KPa=X;this.Te=ma;this.aT=Pa;this.Lf=mb;this.SN=Tb;this.ZI=rc;this.dmb=null;this.fid=0;this.ynb=!1;this.ydd=0;this.KIb=this.HWc=this.Gbg=this.xlc=this.srb=!1;this.updateViewportInfo=
()=>{this.SN.JSf()&&this.Lf.updateViewportInfo(this.ynb,this.fBf)};this.fBf=()=>{this.Ld.fta?this.Uvb():this.o1a();this.SN.eBf()};this.sNf=()=>{this.Uvb()};this.wVf=()=>{!this.srb&&this.SN.eSf()&&(this.ydd=this.CFe.scrollTop,this.srb=!0,this.xOa.tBa(2))};this.HIf=(Tc,vd)=>{this.srb&&(Tc=this.CFe.scrollTop,Tc-this.ydd?(this.xlc||vd.g8d||this.updatePosition(),this.xlc||1!==vd.g8d||this.o1a(),this.eJe(Tc),this.SN.aAf()):this.xlc=this.srb=!1)};this.CFe=this.Lf.K$;this.Sda=IE.a.$Sd;this.Lq=this.Lf.Lq;
this.Lf.t5g()}get yId(){return this.SN.Vlf()}get Sda(){return this.Lf.Sda}set Sda(a){this.Lf.Sda=a}get $Tg(){return"1"===this.Lq.qB.style.opacity}KEi(a){this.HWc||(this.HWc=!0,this.Lf.sii(),this.dmb=a(this.Lq.rza,this.Lf.eri,()=>{this.updatePosition()}),this.Lf.U0h(this.dmb),this.SN.initialize(this.dmb,this),this.Lf.initialize(this.dmb,this.SN.Jeb),this.Lf.Moi(),this.Lf.EEi(),this.Lf.FEi(),this.Lf.JEi(this.SN.hMe,this.SN.XRd,this.SN.WRd),!this.Ld.fRg||this.Lf.ee?this.DXd():this.qTm())}SVc(){}x1d(){return this.Lf.BFi()}setInitialActiveContainerId(a,
c,h=null){this.Lf.setInitialActiveContainerId(a,0,h)}updatePosition(){if(!this.KIb&&this.yId&&this.yg.p0b()){var a=Ve.a.ie()-this.fid<IE.a.FVi;a||this.ynb||(this.Ld.fta?this.Uvb():this.o1a(a))}}oLe(){this.o1a()}Qsa(a,c,h){this.Lf.Qsa(a,c,h)}deleteContainer(a,c,h=!1){this.Lf.deleteContainer(a,c,()=>{this.yg.Ycf()||this.Lf.Edf();this.SN.pyf()},h)}addContainer(a,c,h){this.Lf.addContainer(a,c,h,this.Lf.ee,this.SN.fEc,this.SN.cxf)}ghi(a){this.KIb=!0;a();this.KIb=!1}iTc(a,c,h){this.Lf.iTc(a,c,h)}uVb(){this.Lf.uVb()}ZVi(){const a=
"1"===this.Lq.qB.style.opacity;switch(!0){case a&&!this.yg.Ycf():this.Lf.Edf();break;case !a&&this.yg.Ycf():this.Lf.YGb()}}yYf(a=!0){this.SN.FSf&&this.Lf.XOi(a)}static Jth(a,c=null){const h=new od.a;for(let v of a)v.yf||v.Xr!==nn.beingCreated&&(!c||c(v))&&JE.ECj(h,v.objectId,v);return h}static ECj(a,c,h){let v;({value:v}=a.Ab(c,v)).returnValue||(v=[],a.Z(c,v));v.push(h)}DXd(){this.Lf.ee&&(this.Lf.ee.aha(()=>{this.Ld.fta?this.KPa.value.measure(this.updateViewportInfo):this.updateViewportInfo()}),this.Ld.Ktk&&
(this.Ld.fta?this.Lf.ee.uld(this.sNf):(this.ydd=this.CFe.scrollTop,this.Lf.ee.uld(this.wVf),this.Lf.ee.rQg(this.HIf))))}qTm(){this.Lf.Gtc||this.Lf.Gtc.oKa()||this.Lf.Gtc.nIe(this.fOc.bind(this))}fOc(){this.Lf.Gtc.oKa()&&(this.DXd(),this.Lf.Gtc.BKf(this.fOc.bind(this)))}eJe(a){this.Lq.qB.style.top=a-this.ydd+"px";this.xlc=!1}o1a(a=!1){a=new Se.a(0,1,0,()=>{this.MYe()},129,void 0,!a);this.Ta.ub(a);this.ynb=!0;this.xlc=this.srb;this.xOa.tBa(10)}qBd(a){return this.Lf.eUa({contentAnchorPositions:a.contentAnchorPositions})}MYe(){this.ynb=
!1;if(this.Lq.rza&&this.dmb&&this.yg.p0b()){this.Lf.UAc();var a=0;this.Me.$c(()=>{a=this.Lf.GZb()},"FCM:UP:GET");var c=null,h=null;this.Me.$c(()=>{const v=this.SN.tsh(a,this.Lf.ee);c=v.N$j;h=this.qBd(v)},"FCM:UP:GP");this.Me.$c(()=>{this.srb?(this.Lf.Sgh(h),this.srb=!1):this.dmb.emitEvent(3,h);this.aT.XWd()},"FCM:UP:RC");this.dmb.setFirstCommentRenderDone();"0"===this.Lq.qB.style.opacity&&0<c.count&&!this.Te.An&&this.Me.$c(()=>{this.Lf.YGb()},"FCM:UP:SFC");this.Ld.nfb&&!this.Gbg&&0<c.count&&(io.a.q_(this.Ta,
this.Lf.u1h,sw.a.t1h),this.Gbg=!0);this.fid=Ve.a.ie();this.xOa.tBa(6)}else this.fid=Ve.a.ie()}Uvb(){this.ynb||(this.KPa.value.measure(()=>{const a=this.Lf.GZb(),c=new PQ.a;c.contentAnchorPositions=this.SN.l6e(a,this.Lf.ee).V7a;this.KPa.value.qeb(()=>{this.Lf.skh(c);this.fid=Ve.a.ie();this.ynb=!1})}),this.ynb=!0)}}Object(w.a)(JE,"FloatingCommentManager",null,[8,413]);var BC;(function(a){a[a.yco=0]="singleHint";a[a.d$n=1]="multiHint";a[a.nbo=2]="resolvedHint";a[a.e$n=3]="multiResolvedHint";a[a.entryPoint=
4]="entryPoint";a[a.unknown=void 0]="unknown"})(BC||(BC={}));Object(w.b)("CommentIconType",BC);const QQ={[1]:"ShowAllCommentsSelected_16x16x32",[0]:"SharedCommentBubbleSelected_16x16x32",[2]:"MarkCommentDone1Selected_16x16x32",[3]:"ShowAllCommentsResolvedSelected_16x16x32",[4]:"NewComment_16x16x32",[BC.unknown]:""},dO={[1]:"ShowAllCommentsHover_16x16x32",[0]:"SharedCommentBubbleHover_16x16x32",[2]:"MarkCommentDone1Hover_16x16x32",[3]:"ShowAllCommentsResolvedHover_16x16x32",[4]:"NewComment_16x16x32",
[BC.unknown]:""},xD={[1]:"ShowAllComments_16x16x32",[0]:"SharedCommentBubble_16x16x32",[2]:"MarkCommentDone1_16x16x32",[3]:"ShowAllCommentsResolved_16x16x32",[4]:"NewComment_16x16x32",[BC.unknown]:""},yD=(a,c)=>{c===BC.unknown&&r.ULS.sendTraceTag(545056465,327,15,`Unknown hint IconType with state : ${a}`);switch(a){case 1:return QQ[c];case 2:return dO[c];case 3:return xD[c];default:return""}};class $w{}$w.rKh=16;$w.rvl=1;$w.kff=20;$w.j_i=2;Object(w.a)($w,"CommentIconConstants",null,[]);class eO{constructor(){this.UQe=
0;this.Buc=!1}}Object(w.a)(eO,"CommentHintCensus",null,[]);class fO{constructor(a,c,h,v,B){this.Icg=a;this.PSb=h;this.hcj=v;this.OTa=B;this.HGa=-1;this.Zde=new Set(c)}get y(){if(-1!==this.HGa)return this.HGa;const a=Sys.UI.DomElement.getBounds(this.Icg),c=this.Icg.getClientRects();return this.HGa=0<c.length&&c[0]?this.hcj?a.y/this.PSb+$w.j_i:Math.floor(c[0].height)/(2*this.PSb)+a.y/this.PSb-$w.rKh/2:0}get LVb(){return Array.from(this.Zde)}rGj(a){this.Zde=new Set([...this.Zde,...a])}}Object(w.a)(fO,
"HintInfo",null,[469]);class tw extends So.a{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc){super();this.Ld=a;this.Se=c;this.Bi=h;this.kJ=v;this.ga=B;this.yg=Tb;this.xma=rc;this.xOa=Tc;this.zgc={};this.E4a=this.P6a=null;this.ncc={pcc:-1,Yvf:-1}}vGb(a){return Eb.App.DZi&&a.kb.Rh?Yh.l(a,!0):Yh.k(a.htmlElement,!0)}aub(a){const c=this.zoom,h=a.P4,v=a.oza,B=a.Tsb(1,$w.kff,c);this.xOa.tBa(1);let X=[];v.forEach((ma,Pa)=>{const mb=a.H8[Pa].y/c,Tb=Tc=>this.wik(h,Tc,Tc.y-mb,B),rc=()=>tw.nkk(h);ma=this.Ld.vPd?this.Jik(this.Vvh(ma,
Pa),Tb,rc):this.Iik(this.Vvh(ma,Pa),Tb);X=X.concat(ma)});return X}Iik(a,c){const h=[];for(let v of a){a=c(v);for(let X of v.LVb)this.zgc[X.toString()]=a;const B=this.y9e(v.LVb);this.d0f(B,a);a.OTa=v.OTa;h.push(a)}this.zyb(this.E4a);this.NWa(this.P6a);return h}Jik(a,c,h){h=h();const v=[];for(let B of a){a=c(B);for(let ma of B.LVb)this.zgc[ma.toString()]=a;const X=this.y9e(B.LVb);this.d0f(X,a);null==h.OTa&&(h.OTa=B.OTa);h.appendChild(a);v.push(a)}this.zyb(this.E4a);this.NWa(this.P6a);return[h]}Vxk(a,
c){a=null===a||void 0===a?void 0:a.querySelectorAll("."+tw.Yei);return 0<(null===a||void 0===a?void 0:a.length)&&a[0]&&(a=Array.from(a[0].querySelectorAll(tw.u$j)))?this.C8m(a,c):!1}C8m(a,c){let h=0,v=a.length-1,B;for(;v>=h;){B=Math.floor((v-h)/2+h);const X=a[B];if(X.offsetTop>=c-2&&X.offsetTop<=c+2)return!0;X.offsetTop>c+2?v=B-1:h=B+1}return!1}y9e(a){let c=0,h=0;for(let v of a)this.yg.Skf(v)&&(this.yg.DQh(v)?h+=1:c+=1);a=new eO;a.UQe=c+h;a.Buc=0===c;return a}Zcc(a){if(a=this.zgc[a.objectId]){var c=
Yh.f(a);c=this.y9e(c);this.d0f(c,a)}}d0f(a,c){const h=c.firstElementChild;if(h){h.title=WordEditorIntl.WordEditorStrings.L_CommentHintIcon_UserActionStatement;if(1===a.UQe){var v=a.Buc?2:0;h.alt=a.Buc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_SingleActiveLabel}else 1<=a.UQe&&(v=a.Buc?3:1,h.alt=a.Buc?WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiResolvedLabel:WordEditorIntl.WordEditorStrings.L_CommentHintIcon_MultiActiveLabel);
c.style.display="block";h.className=Fd.getImageClassWithCluster(l.AFrameworkApplication.zO,xD[v]);Di.a.Gl(h,tw.w4g,v)}}Vvh(a,c){a=this.xik(a,c);a.sort((h,v)=>h.y-v.y);return this.Vcm(a)}xik(a,c){const h=[],v=this.Ld.hp,B=this.zoom;a=Yh.e(a,!0);for(let X=0,ma=a.length;X<ma;X++){const Pa=a[X],mb=Yh.f(Pa);mb&&h.push(new fO(Pa,mb,B,v,c))}return h}Vcm(a){let c=null;const h=[];for(let v=0;v<a.length;v++)c&&Math.abs(a[v].y-c.y)<$w.rKh+$w.rvl?c.rGj(a[v].LVb):(c=a[v],h.push(c));return h}wik(a,c,h,v){const B=
a.Fe.ownerDocument,X=B.createElement("div");X.className=tw.u4g;X.style.top=h+"px";X.style.left=v+"px";X.style.right="auto";Di.a.Gl(X,lh.a.$wc,c.LVb);c=B.createElement("img");c.className=Fd.getImageClassWithCluster(l.AFrameworkApplication.zO,xD[0]);c.src=l.AFrameworkApplication.qp;c.title=CommonUIStrings.l_CommentHintTooltip;c.alt=CommonUIStrings.l_CommentHintTooltip+WordEditorIntl.WordEditorStrings.L_AccHelpShortcutMsgToMoveFocusCommentToDocument;c.setAttribute("role","button");X.appendChild(c);this.Se.BC(Jb.a.click,
c,Object(m.a)(this,this.tom,"onHintClick"),a);this.Se.Ea(Jb.a.YA,c,Object(m.a)(this,this.wom,"onHintDoubleClick"));this.Bi.Ea(Jb.a.qV,c,Object(m.a)(this,this.yom,"onHintMouseOver"),null);this.Bi.Ea(Jb.a.tda,c,Object(m.a)(this,this.xom,"onHintMouseExit"),null);this.kJ.Ea(c,Object(m.a)(this,this.vom,"onHintContextMenu"));return X}static nkk(a){a=a.Fe.ownerDocument.createElement("div");a.className=tw.Yei;return a}vom(){return!0}wom(){return!0}tom(a){const c=Yh.f(a.$p.parentNode);a.eventName===Jb.a.oH&&
(this.xma.RPe(),this.r2g());this.ga.hb(Sa.a.v4g,2,c);return!0}yom(a){this.zya(this.E4a)!==a.$p&&(a=Yh.f(a.$p.parentNode),this.ga.hb(Sa.a.WQe,2,a));return!0}xom(){this.ga.processAction(Sa.a.eqd,2);return!0}zyb(a){this.r2g();this.E4a=a;this.AOj()}AOj(){this.BOj(this.zya(this.E4a),this.zya(this.P6a))}NWa(a){this.x6j();this.P6a=a;if(a=this.zya(this.P6a))a.className=Fd.getImageClass(yD(1,this.Wzd(a)))}zya(a){if(!a)return null;let c=null;if(a=this.yg.j0(a))if(a=a.yf?this.yg.pI(a.yf):a)c=a.objectId;return c&&
this.zgc[c]?this.zgc[c].firstChild:null}r2g(){this.z6j(this.zya(this.E4a),this.zya(this.P6a))}z6j(a,c){if(a){const h=this.Wzd(a);a.className=a===c?Fd.getImageClass(yD(1,h)):Fd.getImageClass(yD(3,h));this.E4a=null}}BOj(a,c){a&&(a.title=0<this.ncc.Yvf&&1<this.ncc.pcc?CommonUIStrings.l_CommentHintTooltip+String.format(CommonUIStrings.l_CommentHintNthOfTotal,this.ncc.Yvf,this.ncc.pcc):CommonUIStrings.l_CommentHintTooltip,c!==a&&(c=this.Wzd(a),a.className=Fd.getImageClass(yD(2,c))))}x6j(){const a=this.zya(this.E4a),
c=this.zya(this.P6a);if(c){const h=this.Wzd(c);c.className=a===c?Fd.getImageClass(yD(2,h)):Fd.getImageClass(yD(3,h));this.P6a=null}}Wzd(a){return Di.a.Ra(a,tw.w4g)}}tw.u4g="clip16x16 HintContainer";tw.u$j=".clip16x16.HintContainer";tw.Yei="OutlineElementHintMargin";tw.w4g="CommentIconType";Object(w.a)(tw,"CommentHintActor",So.a,[425]);var gO=b(883);class hO extends gO.a{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb){super();this.Zu=a;this.Wx=c;this.wn=h;this.taskManager=v;this.pkd=B;this.Y8a=X;this.Lf=ma;this.getSelectedText=
Pa;this.oZn=mb;this.wf=Tb;this.oOc=()=>{};this.WQd=()=>{};this.d$f=!1;this.T2j={[0]:()=>this.ark(),[1]:()=>this.cHb.oLe()};this.eBf=()=>{this.pkd.tBa(11)};this.hMe=rc=>{if(this.Wx.Asb)for(let Tc of Yh.r)rc.bindAction(qc.KeyInputManager.VD(Tc),ba.a.NNe)};this.XRd=()=>{this.WQd()};this.WRd=(rc,Tc)=>{if(rc.name!==Fc.AFrame.aq&&Tc){var vd=this.wn.pr?this.wn.pr.id:"";this.Zu.HCb||(this.Zu.HCb=io.a.q_(this.taskManager,()=>{this.oOc(vd)}))}};this.hdi=()=>{};this.Jeb=()=>{this.nHi()};this.cxf=(rc,Tc)=>{0===
Tc&&(this.Y8a.XWd(),this.pkd.tBa(0))};this.pyf=()=>{this.pkd.tBa(5)};this.fEc=rc=>{let Tc=0;const vd=this.wn.h0();for(let ee=0;ee<vd.length;ee++){if(vd[ee].yf||vd[ee].done)continue;if((vd[ee].Xr===nn.beingCreated?vd[ee].ZA.draftId:vd[ee].id)===rc.contentId)break;const Ie=this.Dv.getContentAnchorPosition(vd[ee].id);!Ie||4<Math.abs(rc.anchorTop-Ie.anchorTop)||Tc++}return Tc};this.N9h=()=>{this.Y8a.XWd()};this.aAf=()=>{this.pkd.tBa(2)};this.nHi=()=>{if(!this.d$f&&this.Lf.K$){const rc=this.Lf.K$.getElementsByClassName(tw.u4g);
for(let Tc=0;Tc<rc.length;Tc++)rc[Tc].style.opacity="1";this.d$f=!0}}}get FSf(){return this.B8()}get PYe(){return this.oZn.MCh()}initialize(a,c){this.Dv=a;this.cHb=c;this.oSc()}ken(a,c){this.WQd=a;this.oOc=c}l6e(a,c){return{V7a:this.cWk(a,c),containerContentByType:{}}}tsh(a,c){const h=JE.Jth(this.wn.h0(),this.wn.TJa),v=[],B=Yh.d(!0);var X=this.wn.h0();c=this.cGm(c,X,h);!c.SEf&&c.contentAnchorPosition&&(v.push(c.contentAnchorPosition),c.contentAnchorPosition=null);for(X=0;X<B.length;X++){const ma=
B[X],Pa=Yh.f(ma);if(Pa)for(let mb=0;mb<Pa.length;mb++){const Tb=this.getContentAnchorPosition(a,h,ma,Pa[mb]);Tb&&(v.push(Tb),c.SEf&&c.contentAnchorPosition&&Tb.contentId===c.SEf.id&&(v.push(c.contentAnchorPosition),c.contentAnchorPosition=null))}}c.contentAnchorPosition&&v.splice(0,0,c.contentAnchorPosition);return{N$j:h,contentAnchorPositions:v}}Vlf(){var a;return!(null===(a=this.Dv)||void 0===a||!a.getAreContainersEnabled())}B8(){return this.wn.p0b()}eSf(){return this.B8()}lWc(){return this.B8()}JSf(){return this.Dv&&
this.Lf.K$&&this.B8()}Xci(a){0!==a&&this.oOc(this.wn.pr?this.wn.pr.id:"")}getContentAnchorPosition(a,c,h,v){let B=null;return({value:B}=c.Ab(v.toString(),B)).returnValue?(c=B[0])&&!c.yf?Object.assign(Object.assign({},new OQ.a),{anchorTop:(IE.a.nDc(h)-a)/this.Lf.THa,anchorLeft:0,containerContentType:0,contentId:c.id}):null:null}cGm(a,c,h){var v,B;const X={};"CREATE"===(null===(B=null===(v=this.wn.vF)||void 0===v?void 0:v.ZA)||void 0===B?void 0:B.sessionType)&&(v=this.Lf.K$.getElementsByClassName(lh.a.kud),
a=this.Lf.aqh((0<v.length?v[0]:null)||this.getSelectedText(),this.wn.vF.ZA.draftId,0,a),X.SEf=this.lal(c,h),X.contentAnchorPosition=a);return X}lal(a,c){var h=Array.indexOf(a,this.wn.vF);for(--h;-1<h;h--)if(c.Ja(a[h].objectId))return a[h]}cWk(a,c){return this.tsh(a,c).contentAnchorPositions}oSc(){this.Y8a.dgb("OnAfterTrackChangeMarkupViewChange",(a,c)=>{if(c)this.T2j[c.Di]()})}ark(){const a=Yh.h();if(0!==a.length){var c=JE.Jth(this.wn.h0()),h=this.wn.FU;for(let v=0;v<a.length;v++){const B=Yh.f(a[v]);
for(let X=0;X<B.length;X++){let ma;({value:ma}=c.Ab(B[X].toString(),ma)).returnValue&&(ma.forEach(Pa=>{var mb;Pa&&!Pa.yf&&(this.cHb.deleteContainer(Pa.id,0,!1),(null===(mb=h.wy)||void 0===mb?void 0:mb.id)===Pa.id&&h.clearSelection())}),this.wf.Kf(Fc.AFrame.Mp))}}}}}Object(w.a)(hO,"CommentFloatingContainerActor",gO.a,[429]);class iO extends Xg.a{constructor(a,c,h,v,B,X,ma,Pa,mb){super();this.$qe=a;this.Y2a=c;this.$de=h;this.Me=B;this.e6=Pa;this.aT=mb;this.Lh=null;this.Di=1;v.execute(Tb=>{this.Lh=Tb});
this.r6=[];this.Agc=new br.ScriptSharpLegacyMap;this.aRm(X,ma);this.oSc()}get jh(){return this.$qe.value}get commentEditor(){return this.Y2a}get gja(){return!!this.Lh}get Ayb(){return 0}get Jbb(){return this.r6}get Slg(){return this.Agc.Ja(this.Di)?this.Agc.J(this.Di):this.Agc.J(0)}bYa(a){return this.e6.bYa(a)}Xab(a,c){if(a=Object(ha.a)(426,a))for(let h of this.uGm(a))c.add(h)}CLa(a,c){this.gja&&this.Me.$c(()=>{this.Kqm(a,c)},"CHA:OPHC")}Kqm(a,c){if(this.Lh.SJ.p0b()){var h=this.fx.RHa,v=new Zc.a(new xe.a),
B=c.UZa("*"),X=this.HVk(h),ma=!!h&&!h.action||!!X&&X===this.Lh.wy,Pa;this.Me.$c(()=>{this.$de.r9k(a.id,v,null===X||void 0===X?void 0:X.objectId)},"OPHC:GOI");this.Me.$c(()=>{Pa=this.Slg.QXg(B,X,v,ma);Pa.CQh=this.AQh(h)&&0===h.action},"OPHC:BHI");this.Me.$c(()=>{this.Slg.iTg(B,Pa,ma)},"OPHC:AH")}}HVk(a){let c=null;!this.AQh(a)||0!==a.action&&2!==a.action||(c=this.fx.RHa.XD);return c||this.Lh.wy}uGm(a){if(!a)return[];a=this.jh.Ra(N.a.Ee(a.objectId));return this.commentEditor.hBd(a,null)}Gpi(){return!1}LF(a,
c,h){this.gja&&(a=Object.assign(new wh.a,{action:a,type:0,XD:c,LM:h}),this.fx.LF(a))}RPe(){this.gja&&(this.LF(3,this.Lh.S0b,this.Lh.S0b),this.Lh.S0b=null)}aRm(a,c){this.Agc.add(1,a);this.Agc.add(0,c)}oSc(){this.aT.dgb("OnBeforeTrackChangeMarkupViewChange",(a,c)=>{c&&c.Jvf!==this.Di&&(this.Di=c.Jvf)})}AQh(a){return a&&0===a.type}}Object(w.a)(iO,"CommentHighlightActor",Xg.a,[428,312]);var jO=b(899);class kO{constructor(a,c){this.y$j=a;this.Ywf=c}}Object(w.a)(kO,"CommentEndParaIdBeforeChangeInfo",null,
[]);class KE{constructor(a=!1){this.dS=null;this.Abb=!1;a&&(this.dS=new Zc.a(new xe.a))}}Object(w.a)(KE,"OpenCommentInfo",null,[]);class lO{constructor(a,c,h,v,B,X){this.Mu=a;this.Te=c;this.yg=h;this.aT=v;this.Wm=B;this.Me=X;this.Hkb=null;this.NOa=new ia.a(new jO.a);this.m6a=new CE.a(Yh.b);this.aT.dgb("OnCommentNodeAdded",Object(m.a)(this,this.dGm,"processIncomingNewComment"));["OnCommentPaneOpen","OnCommentPaneClose"].forEach(ma=>{this.aT.dgb(ma,Object(m.a)(this,this.lFl,"invalidateParaNodeForPaneOnlyComments"))});
a=this.Wm.Yd(12);a.Mt(Object(m.a)(this,this.MOc,"onParagraphNodeDisconnected"));a.Yo(Object(m.a)(this,this.ykm,"onAnchorParaNodesConnected"));this.Wm.Yd(40).wTb(Object(m.a)(this,this.Okm,"onBeforeCommentEndParaIdChange"));this.Wm.Yd(40).Yl(Object(m.a)(this,this.Xlm,"onCommentEndParaIdChange"));Hv.a.pMa(Object(m.a)(this,this.$lm,"onCommentRangeObjAdded"))}get wC(){return this.Mu.value}get Lc(){return this.wC.Lc}r9k(a,c,h){if(this.nym(a))for(let v of this.Te.rB.J(a).dS)!this.wFi(v,h===v.toString())||
c.add(v)}wFi(a,c){const h=this.Lc.Ra(a),v=Yh.q(h);return!h||v?!1:(a=this.yg.j0(a.toString()))&&(this.Te.An||this.yg.TJa(a)||c)?!0:!1}nym(a){return this.Rxm(a)}dGm(a,c){(a=c.commentNode)&&!Yh.q(a)&&(c=this.yg.Z5e(a),N.a.Go(c.hXc,c.DAc)||this.dUi(c,a)||this.k1g(c.Uwa,c.AHa,a)||this.r0f(a))}r0f(a){if(a){var c=Oi.a.hBd(a,null),h=new va.a;for(let v=1;v<c.length-1;v++)this.HHe(c[v].id,a.id),h.add(c[v]);vk.b(h)}}Rxm(a){if(!this.Te.dV)return!1;let c=null;if(({value:c}=this.Te.rB.Ab(a,c)).returnValue)return c.Abb;
let h=!1;this.Me.$c(()=>{const v=Yh.d();for(let B=0;B<v.length;B++)h=this.JPn(v[B],a,h);h||(this.Te.rB.add(a,new KE),this.Te.rB.J(a).Abb=!1)},"CHORA:PHOC");return h}JPn(a,c,h){a=Yh.f(a);if(!a)return h;for(let v=0;v<a.length;v++){const B=this.Lc.Ra(a[v]);B&&!Yh.q(B)&&(h=h||this.n3j(B,c))}return h}n3j(a,c){var h=this.yg.Z5e(a);if(this.dUi(h,a))return!1;var v=h.hXc;const B=h.DAc;h=h.Uwa;if(v!==N.a.nil&&(v.equals(B)||v.equals(c)))return!1;for(v=sd.ParagraphReader.jg(h,!1);v&&!v.id.equals(B);){if(v.id.equals(c))return this.HHe(c,
a.id),!0;v=sd.ParagraphReader.jg(v,!1)}return!1}HHe(a,c){this.Te.c1.Ja(c)||this.Te.c1.add(c,new Zc.a(new xe.a));this.Te.c1.J(c).add(a);this.Te.rB.Ja(a)?this.Te.rB.J(a).dS||(this.Te.rB.J(a).dS=new Zc.a(new xe.a)):this.Te.rB.add(a,new KE(!0));this.Te.rB.J(a).Abb=!0;this.Te.rB.J(a).dS.add(c)}Okm(a,c){c.property===Yb.a.Ppa&&(a=Yh.g(c.node,N.a.nil),this.Hkb=new kO(c.node.id,a))}Xlm(a,c){a=c.node;if(c.property===Yb.a.Ppa&&a){var h=Yh.j(a,N.a.nil);c=Yh.g(a,N.a.nil);var v=this.Hkb?this.Lc.Ra(this.Hkb.Ywf):
null;!Yh.q(a)&&h&&!h.equals(c)&&this.Hkb&&a.id.equals(this.Hkb.y$j)&&!h.equals(this.Hkb.Ywf)&&v&&v.isConnected&&this.HHe(this.Hkb.Ywf,a.id);c&&this.Te.rB.Ja(c)&&(h=this.Te.rB.J(c),h.Abb&&(r.ULS.shipAssertTag(572835481,327,!!h.dS,"Paranode with HasSpanningComment true should have non null OpenCommentObjIds"),h.dS&&h.dS.contains(a.id)&&(h.dS.remove(a.id),h.dS.count||(h.Abb=!1),this.Te.c1.Ja(a.id)?this.Te.c1.J(a.id).remove(c):r.ULS.sendTraceTag(572835482,327,15,"[OnPropertyChanged] OpenComment -> ParaNodes entry missing!"))))}}MOc(a,
c){a=c.node.id;this.Te.rB.Ja(a)&&this.OWm(a)}OWm(a){if(this.Te.rB.J(a).dS)for(let c of this.Te.rB.J(a).dS)this.Te.c1.Ja(c)?this.Te.c1.J(c).remove(a):r.ULS.sendTraceTag(572835483,327,15,"[OnDisconnected] OpenComment -> ParaNodes entry missing!");this.Te.rB.remove(a)}lFl(){const a=new va.a;for(let c of this.yg.h0())c.yf||c.Xr===nn.beingCreated||this.yg.TJa(c)||this.yg.vVi(c,a);vk.b(a)}dUi(a,c){let h=!1;if(!a.m3d||!a.Pud){h=!0;if(!a.Uwa||!a.AHa)return r.ULS.sendTraceTag(571025377,327,15,"Anchor para nodes missing, start={0}, end={1}",
!a.Uwa,!a.AHa),!0;a.m3d||this.NOa.Ja(a.Uwa)||this.NOa.add(a.Uwa,{commentNode:c,currentNode:a.Uwa,ZSd:a.AHa,EVe:!0});a.Pud||this.NOa.Ja(a.AHa)||this.NOa.add(a.AHa,{commentNode:c,currentNode:a.AHa,ZSd:a.Uwa,EVe:!1})}return h}k1g(a,c,h){a=Oi.a.tya(a,h.id,!0);c=Oi.a.tya(c,h.id,!1);let v;a||({value:v}=this.m6a.Ab(h.id,v),this.m6a.Z(h.id,v&1));c||({value:v}=this.m6a.Ab(h.id,v),this.m6a.Z(h.id,v&2));return!a||!c}ykm(a,c){c&&c.node&&this.NOa.Ja(c.node)&&(a=this.NOa.J(c.node).ZSd,this.NOa.Ja(a)||(a=this.NOa.J(c.node),
this.k1g(a.EVe?a.currentNode:a.ZSd,a.EVe?a.ZSd:a.currentNode,a.commentNode)||this.r0f(a.commentNode)),this.NOa.remove(c.node))}$lm(a,c){const h=a.Oj;if(!c&&this.m6a.Ja(h)){var v;(v=this.m6a).Z(h,v.J(h)&(a.Nb?-2:-3));this.m6a.J(h)||(this.r0f(this.Lc.Ra(h)),this.m6a.remove(h))}}}Object(w.a)(lO,"CommentHighlightOnRestActor",null,[427]);class mO{constructor(a,c){this.qrb=a;this.Qfa=c}getViewContainer(){return this.qrb}registerForViewContainerEvents(a){this.Qfa.wUm(a)}unregisterForViewContainerEvents(a){this.Qfa.ZKn(a)}}
Object(w.a)(mO,"ViewContainerProvider",null,[823]);class eI{constructor(a,c,h,v){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=a;this.appLocale=c;this.uiCulture=h;this.dataCulture=v}}Object(w.a)(eI,"LocalizationDetails",null,[]);var RQ=b(996);class nO{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh,Fi,wk,Gk,Kl,Yj,ao,oq,to,zt,Wq,Ys){this.ep=a;this.wn=c;this.MVb=h;this.D3=v;this.Wx=B;this.Zu=X;this.hxd=ma;this.N0b=Pa;this.xo=mb;this.Eb=Tb;this.dynamicScriptLoader=
rc;this.Z4m=Tc;this.wf=vd;this.$Qe=ee;this.YQe=Ie;this.AMg=Xe;this.$Un=Yf;this.j$=Hh;this.Y8a=Fi;this.E6m=wk;this.cFk=Gk;this.m9h=Kl;this.aVn=Yj;this.aRe=ao;this.SN=oq;this.Lf=to;this.ZI=zt;this.qSe=Wq;this.pfb=Ys;this.F8c=this.eRa=null;this.fng=!1;this.que=[];this.uDg=this.gng=!1;this.initialize=(Wr,pw)=>{this.Qzl(pw)};this.Qok=Wr=>kn.a.h7g(Wr);this.amm=()=>{this.UMh()};this.Q0k=(Wr,pw,kD)=>{Wr=Object.assign(Object.assign({},new RQ.a),{containerPanel:Wr,paneOpenedCallback:pw,paneClosedCallback:kD,
ulsLogger:new lo.a,canvasAndFcHostOffset:wacBoot.ShiftUtils.canvasAndFcOuterSurfaceOffset,isRtl:l.AFrameworkApplication.isRtl&&this.Wx.nfb,viewportInfo:this.Lf.N6e(),destroyAllContainersCallback:()=>{this.Zu.An||r.ULS.sendTraceTag(571342851,327,10,"The pane is not open but we are destroying the containers!")},featureGates:{deselectionEnabled:!0,floatingContainerVirtualizationEnabled:this.Wx.ixd,synchronousContainerPositioningEnabled:this.Wx.fta,trackChangeInSidetrackEnabled:this.Wx.trackChangeInSidetrackEnabled,
improveJumpingFixEnabled:!1,shouldInitialize:!this.Wx.contentNavigationApiEnabled,scrollingPerfImprovementEnabled:!1}});this.Wx.contentNavigationApiEnabled&&(Wr.sidetrackContentNavigationApi=this.qSe,Wr.featureGateApiSettings=this.SN.PYe,Wr.telemetryDetails=this.m9h);return floatingContainerManager.FactoryGlobal.getFCManagerInstance(Wr)};this.Onm=Wr=>{2!==this.ep.mode&&3!==this.ep.mode&&this.wn.pr&&Wr===this.wn.pr.id&&this.ep.clearSelection();Eb.App.oa.updateCommandUI(!0)};this.y$h=(Wr,pw)=>{this.Lt("onCSCStart",
window.performance.now());this.K7a&&!Wr&&(this.bvm(),this.Lt("openInFishbowl",!0));this.MVb.O7a&&this.Wx.Tub&&this.Eb.processAction(Sa.a.newComment,2);pw&&pw();this.Lt("onCSCEnd",window.performance.now())};this.Y8a.dgb("OnCommentInit",this.initialize);this.Y8a.dgb("OnCommentRenderedOnce",this.amm);this.SN.ken(()=>{},this.Onm)}get hEa(){return this.ep}get K7a(){return this.Zu.K7a}Lt(a,c){this.pfb.Lt(cG.a.comments,a,c,!0)}Qzl(a){if(this.Zu.dV)a&&a.CAa&&a.CAa();else if(this.fng)(null===a||void 0===a?
0:a.CAa)&&this.que.push(a.CAa);else{var c=this.Wx.TFc;this.Lt("hasCommentOnBoot",c);c?this.aRe.Pm("CommentLoad",0):tc.a.Y5b("canvas","floatingComments");this.fng=!0;this.Lt("initInProgress",!0);this.wn.initialize(this.ep);this.MVb.initialize(this.ep,null);this.MVb.GEi(this.ep);this.N0b.HAl(this.D3.Qin);this.Lt("InitAMSetup",window.performance.now());rg.a.Vp(this.cFk).continueWith(h=>{(this.eRa=h.result)||r.ULS.sendTraceTag(574734881,327,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");
this.$Qe.initialize(this.eRa);this.hEa.RQe.initialize(this.hEa,this.wn,this.eRa,this.$Qe);this.AMg.initialize(this.dynamicScriptLoader,this.hEa.RQe,this.m9h,this.eRa,new mO(this.$Un,this.aVn),this.Vxh(),"",this.$Qe.MCh(),this.j$);this.Lt("AMInitialized",window.performance.now());this.Wx.contentNavigationApiEnabled?this.Lf.L_h().then(()=>{this.Lt("FCMLoaded",window.performance.now());this.SVc();this.UGd(a)}):this.UGd(a)})}}iDm(){var a;this.Wx.Qzb&&(null===(a=sharedComments.setDarkModeColorHandler)||
void 0===a?void 0:a.call(sharedComments,this.Qok))}UGd(a){this.F8c=this.AMg.UGd(void 0,this.iDm.bind(this));this.yHc(a);this.Zu.dV=!0;this.Wx.hUf&&this.YQe.initialize()}yHc(a){if(!this.Zu.Lyb){this.Lt("InitCSStart",window.performance.now());var c=this.xo.Pe("Task","InitiateCommentingSession");try{const h=this.xo.Pe("Task","InitiateCommentingSession-UpdateModel");this.wn.fAl();h.stop();this.Lt("initAtBoot",window.performance.now());this.Wx.hp&&this.wn.p0b()&&r.ULS.sendTraceTag(574734882,327,50,String.format("Comments loaded into the model at {0}",
Ve.a.ie()));ck.a.get_instance().iH(12);r.ULS.sendTraceTag(574734883,327,50,"CommentRendered AppInitializationStatus was set");this.Zu.Lyb=!0;this.F8c.then(()=>{this.Lt("SCLoaded",window.performance.now());this.Lf.yAl();this.Lt("FCMInitiated",window.performance.now());if(this.Wx.hp){let B=!1;if(this.K7a){var v=this.D3.Iyd(this.K7a);v?(l.AFrameworkApplication.Mg("3ge3g205;cha3g788"),v=this.D3.Jyd(v,0),v)?this.wn.TJa(v)||(B=!0,this.cvm(v)):(B=!0,this.XYa()):B=!0}v=a?a.qai:null;this.Wx.contentNavigationApiEnabled?
this.y$h(B,v):this.n_l(B,v)}a&&a.CAa&&a.CAa();for(let B of this.que)B();this.gng&&this.UMh();this.que=[]})}catch(h){r.ULS.sendTraceTag(539567713,327,10,`Comments Initialization Failed: ${h}`)}finally{c.stop(),this.Lt("InitCSEnd",window.performance.now())}this.Eb.processAction(Sa.a.f4g,2)}}cvm(a){this.Eb.processAction(Sa.a.QV,2);this.SN.nHi();io.a.q_(l.AFrameworkApplication.Cb,()=>{this.D3.selectComment(a,Object.assign(Object.assign({},new rw.a),{JV:!0,V9:1}));this.wf.Kf(Fc.AFrame.aq);r.ULS.sendTraceTag(574734912,
327,50,"opened resolved deeplinked comment using pane, time since boot = {0}",(new Date).getTime()-l.AFrameworkApplication.nU)},sw.a.g9m);this.aRe.jB(Sa.a.VQe);l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordLinkToCommentSettings")}XYa(){this.Eb.processAction(Sa.a.XYa,2)}n_l(a,c){this.Lf.L_h().then(()=>{this.Lt("FCMLoaded",window.performance.now());this.SVc();this.y$h(a,c)}).catch(h=>{r.ULS.sendTraceTag(574734913,327,15,"Failed to load floatingContainerManager script: "+h.toString())})}SVc(){this.ZI.trackChangeInSidetrackEnabled?
(this.hxd.SVc(),this.Lt("STSet",window.performance.now())):this.hxd.KEi(this.Q0k)}UMh(){this.uDg||(this.Zu.dV&&this.F8c?(this.F8c.then(()=>{const a=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();this.E6m.execute(c=>{a.registerSafelinksNavigator(c.Lcc.bind(c))});this.Z4m.execute(c=>{c.dRm(a)})}),this.uDg=!0):(r.ULS.sendTraceTag(571618846,327,15,"[InitializeRichContentEditAPI] Shared comments runtime not yet loaded"),this.gng=!0))}Vxh(){return new eI(l.AFrameworkApplication.isRtl,
Sys.CultureInfo.CurrentCulture.name,l.AFrameworkApplication.uiCulture,l.AFrameworkApplication.dataCulture)}bvm(){this.D3.tyi(this.K7a,Object.assign(Object.assign({},new rw.a),{ASf:!1,JIc:!0}));this.aRe.jB(Sa.a.VQe)}}Object(w.a)(nO,"CommentInitActor",null,[]);class dG{constructor(a,c,h,v,B,X){this.Se=a;this.Bi=c;this.kJ=h;this.ga=v;this.LDa=B;this.hg=X;this.S7d=this.FPa=null}get zoom(){let a=1;this.hg&&this.hg.instance&&(a=this.hg.instance.ei);return 0<a?a:1}rGk(a,c){if(!this.S7d||!a.oza||c>=a.oza.length)return null;
const h=this.zoom,v=a.P4,B=a.Tsb(1,$w.kff,h);return this.Ghk(a.oza[c],v,(this.S7d.y-a.H8[c].y)/h+$w.j_i,B)}Ghk(a,c,h,v){if(this.FPa)return(c=this.FPa.parentElement)&&c.removeChild(this.FPa),this.FAi(a,this.FPa,h,v),this.FPa;const B=c.Fe.ownerDocument,X=B.createElement("div");X.className=dG.n$j;this.FAi(a,X,h,v);a=B.createElement("img");a.className=Fd.getImageClassWithCluster(l.AFrameworkApplication.zO,xD[4]);a.src=l.AFrameworkApplication.qp;a.title=CommonUIStrings.l_CommentNewCommentButton;a.alt=
CommonUIStrings.l_CommentNewCommentButton;a.setAttribute("role","button");X.appendChild(a);this.nSm(a,c);return this.FPa=X}nSm(a,c){this.Se.BC(Jb.a.click,a,this.tnm.bind(this),c);this.Se.Ea(Jb.a.YA,a,this.vnm.bind(this));this.Bi.Ea(Jb.a.qV,a,this.xnm.bind(this));this.Bi.Ea(Jb.a.tda,a,this.wnm.bind(this));this.kJ.Ea(a,this.unm.bind(this))}ydf(){if(this.FPa){const a=this.FPa.parentElement;a&&a.removeChild(this.FPa)}}FAi(a,c,h,v){this.LDa.Vxk(a,h)?c.style.left=v+$w.kff+"px":c.style.left=v+"px";c.style.top=
h+"px";c.style.right="auto";c.style.display="block";c.style.position="absolute";c.style.overflow="hidden";c.style.cursor="default"}vnm(){return!0}tnm(a){this.ga.eF=30;this.ga.processAction(Sa.a.newComment,2);a=a.$p;a.className=Fd.getImageClassWithCluster(l.AFrameworkApplication.zO,xD[4]);a=a.parentElement;(null===a||void 0===a?0:a.parentElement)&&a.parentElement.removeChild(a);return!0}xnm(a){a.$p.className=Fd.getImageClassWithCluster(l.AFrameworkApplication.zO,dO[4]);return!0}wnm(a){a.$p.className=
Fd.getImageClassWithCluster(l.AFrameworkApplication.zO,xD[4]);return!0}unm(){return!0}}dG.n$j="clip16x16 EntryPointContainer";Object(w.a)(dG,"CommentMarginEntryPointActor",null,[]);var eG=b(911);class oO{constructor(a){this.A4g=a;this.hjc=null;this.nvg=void 0;this.ovg=null;this.Snc=new Map;this.nhe=new Map}nUm(){eG.a.pMa(this.LMn.bind(this))}LMn(a,c){let h=a.id.toString();var v=a.getValue(Yb.a.JD).toString();c?(this.Snc.delete(h),this.nhe.delete(v)):(this.Snc.set(h,a),this.nhe.set(v,a));0===this.Snc.size&&
this.hjc&&(a=+new Date-+this.hjc,this.hjc=null,r.ULS.sendTraceTag(543506649,327,50,`All Nodes Disconnected. Duration between first Node connection and all nodes disconnections : ${a}`));c||this.nvg!==v||(c=+new Date-+this.ovg,r.ULS.sendTraceTag(541878464,327,15,`Deeplinked Comment added after deeplink navigation failed: ${c}`),v=new fi.a,v.durationMs=c,this.A4g.pi("CommentDeepLink","CommentFoundAfterDeeplinkAttempt",{isInternal:!0,Uu:v},{name:"CommentDeepLinkNavigationFailed",isIntentional:!1,isInternal:!0,
isSessionEndingError:!1,Uu:v}));this.hjc||(this.hjc=new Date)}set mem(a){this.nvg=a;this.ovg=new Date;if(a=this.BVk(a))r.ULS.sendTraceTag(538789919,327,15,`Deeplinked Comment ${a.id} present but failed to load`),a=new fi.a,this.A4g.pi("CommentDeepLink","CommentPresentButFailedToLoad",{isInternal:!0},{name:"CommentDeepLinkNavigationFailed",isIntentional:!1,isInternal:!0,isSessionEndingError:!1,Uu:a})}CVk(){return[...this.Snc.keys()]}BVk(a){return this.nhe.get(a)}rsh(a){return this.Snc.get(a)}}Object(w.a)(oO,
"CommentNodeTracker",null,[]);class pO{constructor(){this.$Vf=new Set([12])}get name(){return"CommentContentProvider"}get nMi(){return this.$Vf}initialize(){}getContent(){return[]}}Object(w.a)(pO,"CommentReviewSuggestionContentProvider",null,[424]);class CC extends Sys.EventArgs{constructor(){super();this.qai=this.CAa=null}}Object(w.a)(CC,"OnCommentInitArgs",Sys.EventArgs,[]);class LE{constructor(){this.commentId=null;this.kKc=!1}}Object(w.a)(LE,"CommentToSelectOnPaneLoadData",null,[]);class qO{constructor(a,
c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee){this.ep=a;this.SJ=c;this.t4g=h;this.D3=v;this.Y8a=B;this.Zu=X;this.hxd=ma;this.Wx=Pa;this.MVb=mb;this.zLc=Tb;this.Eb=rc;this.pYl=Tc;this.wf=vd;this.hj=ee;this.Eb.ka(Sa.a.OGb,Kc.a.frame,this.ep.OGb.bind(this.ep));this.Eb.ka(Sa.a.fud,Kc.a.frame,this.fud.bind(this));this.Eb.ka(Sa.a.SQe,Kc.a.frame,this.Tlm.bind(this));this.Eb.ka(Sa.a.c$j,Kc.a.frame,this.Slm.bind(this));this.Eb.ka(Sa.a.r7h,Kc.a.frame,this.eqm.bind(this));this.Eb.ka(Sa.a.heh,Kc.a.frame,this.bnm.bind(this));
this.Eb.ka(Sa.a.v4g,Kc.a.frame,this.uom.bind(this));this.Eb.Aa(Sa.a.WQe,Kc.a.frame,this.iOj.bind(this),64);this.Eb.Aa(Sa.a.eqd,Kc.a.frame,this.DVm.bind(this),64);this.Eb.ka(ba.a.selectComment,Kc.a.frame,this.D3.d9m.bind(this.D3));this.wNg(ba.a.hzc,!1);this.wNg(ba.a.SWe,!0);this.Eb.Aa(ba.a.fqd,Kc.a.frame,this.fqd.bind(this),64);this.Eb.ka(ba.a.G0h,Kc.a.frame,Le.ActionManager.De);this.Wx.Asb&&this.Eb.ka(ba.a.NNe,Kc.a.frame,this.rZj.bind(this))}get wn(){return this.SJ}get mode(){return this.ep.mode}get wy(){return this.ep.wy}get ay(){return this.Wx.hp}get jh(){return this.zLc.value}get Ma(){return this.pYl.value}get FU(){return this.ep}fud(a,
c,h,v,B){if(!B)return r.ULS.sendTraceTag(540160448,327,10,"No action data: DoesCommentExist"),8;if(!B)return r.ULS.sendTraceTag(540160449,327,10,"ActionData could not be cast to dict: DoesCommentExist"),8;a=this.D3.Iyd(B.NavigationId);if(this.Wx.Txk){if(!a)return 8}else if(a)return 32;return this.D3.Jyd(a,1)?32:8}Tlm(a,c,h,v,B){B&&this.Y8a.vsa("OnCommentInit",Object.assign(Object.assign({},new CC),{CAa:()=>{var X=this.D3.Iyd(B.NavigationId);if(X){var ma=this.D3.Jyd(X,1);ma?this.MVb.isVisible?(this.zUc(ma,
1),this.wf.rA(Fc.AFrame.aq)):this.wn.TJa(ma)?(X=Yh.p(ma),this.D3.selectComment(ma,Object.assign(Object.assign({},new rw.a),{JV:!X,V9:1})),this.wf.rA(Fc.AFrame.WJ)):(this.Zu.An||this.Eb.processAction(Sa.a.QV,2),io.a.q_(l.AFrameworkApplication.Cb,()=>{this.zUc(ma,1)},sw.a.zUc)):this.Eb.processAction(Sa.a.XYa,2)}}}));return 32}Slm(a,c,h,v,B){B?(a=this.wn.ZCc(B))?this.FU.m6b(a.id):r.ULS.sendTraceTag(540160450,327,10,"We were not able to find the comment referenced in the Activity Pane!"):this.FU.m6b(null);
return 32}eqm(a,c,h,v,B){if(B){if(this.Zu.Lyb){for(a=0;a<B.length;a++)this.wn.CAi(B[a]);this.ep.IEb()}else this.wn.vGj(B);this.C5l(B)}return 32}bnm(a,c,h,v,B){if(B)if(this.Zu.Lyb){for(a=0;a<B.length;a++)this.wn.CAi(B[a],!0);this.ep.IEb()}else this.wn.J6j();return 32}uom(a,c,h,v,B){this.ay||this.Zu.An||this.Eb.processAction(Sa.a.QV,2);if(B){a=null;if(!this.wy||2!==this.mode&&3!==this.mode){if(!B)return 8;if(this.ay)a=this.QHk(B);else for(c=0;c<B.length&&(a=this.wn.j0(B[c].toString()),this.hxd.yId&&
(!a||a.done));c++);}else a=this.wy;this.zUc(a,1);a&&this.Zu.dV&&this.wf.Kf(this.ay&&!this.Zu.An?Fc.AFrame.WJ:Fc.AFrame.aq)}else r.ULS.sendTraceTag(5017933,327,10,"We have hint but we couldn't find the paragraph that it belongs to!");return 32}iOj(a,c,h,v,B){var X;if(!B)return 32;if(B&&0<B.length){c=a=h=0;v=!1;for(let ma=0;ma<B.length;ma++)B[ma].toString()===(null===(X=this.wy)||void 0===X?void 0:X.objectId)?(v=!0,a++):this.SJ.Skf(B[ma])&&(v&&0===h&&(h=ma,c=a),a++);(X=this.SJ.j0(B[h].toString()))?
(this.t4g.ncc.Yvf=c+1,this.t4g.ncc.pcc=a,this.FU.m6b(X.id)):(B=B[h],this.jh.Ra(B)?r.ULS.sendTraceTag(540148256,327,10,`Comment Node with ObjectId ${B} has no corresponding comment in Model`):r.ULS.sendTraceTag(540148257,327,10,"Comment ObjectId:{0} is NOT in the model, but we are trying to hightlight!",B.toString()))}return 32}DVm(){this.FU.m6b(null);return 32}wNg(a,c){this.Eb.ka(a,Kc.a.frame,(h,v,B)=>this.Gmm(B,c))}Gmm(a,c=!1){if(2===a)a=this.wn.QU.Ob(15),a.Oa(this.wn.iDa),this.hj.$c(()=>{this.hzc(c)},
"ECM:DAC"),a.dispose();else if(1===a&&!this.wn.p0b())return 2;return 32}hzc(a=!1){this.ep.mode=1;const c=this.wn.h0();for(let h of c)h.Xr===nn.beingCreated||a&&!h.done||h.yf||this.ep.deleteComment(h);this.wf.Kf(Fc.AFrame.Mp);0<(a?this.wn.h0().filter(h=>h.done):this.wn.h0()).length?r.ULS.sendTraceTag(540160454,327,10,"Not all comments were deleted. onlyDeleteResolved: {0}.",a):r.ULS.sendTraceTag(540160455,327,50,"All comments were successfully deleted. onlyDeleteResolved: {0}.",a)}fqd(a,c,h){if(2===
h)if(a=this.wf.nf.name,a!==Fc.AFrame.aq&&a!==Fc.AFrame.WJ){!this.ay||this.Zu.An?(this.Zu.An||this.Eb.processAction(Sa.a.QV,2),this.wf.Kf(Fc.AFrame.aq)):this.wf.Kf(Fc.AFrame.WJ);var v=this.Ma.Ca.Fa;if(!v||!v.sa)return 2;a=v.sa.cpBegin;c=v.sa.node;v=!!this.wy&&(Gc.SelectionEditor.Cl(v)||v.zM)&&Yh.o(this.wy,c,this.jh,a);a=!!this.wy&&(2===this.mode||3===this.mode);if(v||a)return this.FU.xyi(this.wy.id,!0),32;v=this.ay&&!this.Zu.An?this.wn.ssh(!0,!0):null;this.FU.n9m(v)}else this.wn.pr&&(this.ep.N0b.syi(this.wn.pr,
!0),this.ep.N0b.NWa(null===(v=this.wn.pr)||void 0===v?void 0:v.objectId)),this.wf.Kf(Fc.AFrame.Mp);return 32}rZj(){return 4}C5l(a){const c=new Set;for(let h=0;h<a.length;h++){const v=this.wn.ZCc(a[h]);v&&c.add(v.yf?v.yf:v.id)}r.ULS.sendTraceTag(540160456,327,50,"Threads with new comments: {0}",c.size.toString())}zUc(a,c){a?this.MVb&&!this.Zu.dV?this.Zu.$8a=Object.assign(new LE,{commentId:a.id,kKc:!1}):this.D3.selectComment(a,Object.assign(new rw.a,{JV:!!c,V9:c})):r.ULS.sendTraceTag(5017932,327,10,
"We were not able to find the comment in the model!")}QHk(a){let c=null,h=!1;for(let v=0;v<a.length;v++){const B=a[v].toString();if(this.wn.Skf(a[v])){c||(c=B);if(h&&this.wn.pr.objectId!==B)return this.wn.j0(B);h=h||!!this.wn.pr&&this.wn.pr.objectId===B}}return c?this.wn.j0(c):null}}Object(w.a)(qO,"CommentsActionManager",null,[]);var fG=b(1643),gG;(function(a){a[a.e5n=0]="commentDeeplink";a[a.catchUpActivity=1]="catchUpActivity"})(gG||(gG={}));Object(w.b)("DeeplinkSource",gG);class rO{constructor(a,
c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc){this.ga=a;this.yg=c;this.tv=h;this.aee=v;this.lN=B;this.uFg=X;this.fb=ma;this.Te=Pa;this.Ld=mb;this.xQa=Tb;this.Ikb=rc;this.yH=Tc;this.fBe=!1;this.Qin=vd=>{if(this.Ld.hp&&!this.Te.An){const ee=new Se.a(0,1,0,()=>{this.oAi(vd)},136,void 0,!0);l.AFrameworkApplication.Cb.ub(ee)}else this.oAi(vd)}}get SJ(){return this.yg}get Ma(){return this.xQa.value}Tgh(a){let c=a.Xr===nn.beingCreated?a.ZA.draftId:a.id,h=null;a.yf&&(c=a.yf,h=()=>{this.uFg.selectComment(a.id)});this.lN.setInitialActiveContainerId(c,
0,h)}d9m(a,c,h,v,B){if(!B.commentId)return 2;a=this.yg.pI(B.commentId);if(!a)return 2;this.Mgb(a,B);return 32}vyi(a,c){var h,v;if(a){var B=(null===(v=null===(h=this.yg.vF)||void 0===h?void 0:h.ZA)||void 0===v?void 0:v.draftId)===a?this.yg.vF:this.yg.pI(a);this.selectComment(B,c)}}selectComment(a,c){a&&this.Mgb(a,c)}tyi(a,c){var h=this.Iyd(a);h&&((h=this.Jyd(h,0))?c.ASf?(this.Te.$8a=Object.assign(new LE,{commentId:h.id,kKc:!0}),r.ULS.sendTraceTag(579608864,327,50,"Deep linking before comment pane fully loaded.")):
(this.Mgb(h,Object.assign(new rw.a,{commentId:h.id,V9:1,JV:!0,JIc:!0})),this.Ld.hp&&void 0!==a&&null!==a&&this.Tgh(h),io.a.q_(l.AFrameworkApplication.Cb,()=>{this.fb.Kf(this.Ld.hp&&!this.Te.An?Fc.AFrame.WJ:Fc.AFrame.aq)},sw.a.nen),Cj.a.instance.Xe(lg.a.ibh,(new Date).getTime()),a=this.Ld.hp?"Deep linked discrete hosted comment":"Deep linked after comment pane fully loaded",a+=", elapsed since boot: {0} ms",r.ULS.sendTraceTag(579608865,327,50,a,(new Date).getTime()-l.AFrameworkApplication.nU)):this.ga.processAction(Sa.a.XYa,
2))}Iyd(a){let c=null;var h=null;if(F.a.V2b(a))c=a;else if(({dv:h}=z.d(a)).returnValue&&(a=h))return NF.a.comment in a&&(c=a[NF.a.comment]),c;c||(h=h?Object.keys(h):null,r.ULS.shipAssertTag(579608866,327,!1,"Unrecognized navigation id. {0}",h?h.join(","):"Not Json."));return c?c.toString():null}Jyd(a,c){const h=this.yg.ZCc(a),v=0===c;v&&this.yH.Pm("CommentDeepLink",0);if(!h){r.ULS.sendTraceTag(579608867,327,15,"Comment durableCommentId={0} not found for deep linking. Source: {1}",a,c);const B=new aa.a;
B.name="DeepLinkSource";B.string=gG[c];this.yH.logActivity("CommentDeeplinkNotFound",{dataFields:[B]});v&&(c=new fi.a,c.extendedProperties=new Map([["ErrorLevel","warning"]]),this.yH.pi("CommentDeepLink","CommentNotFound",{isIntentional:!1,isInternal:!0,Uu:c}),this.Ikb.mem=a)}return h}oAi(a){this.fBe=!0;this.Ma.setSelection(a);this.fBe=!1}Mgb(a,c){if(a){this.Te.HCb&&(l.AFrameworkApplication.Cb.me(this.Te.HCb),this.Te.HCb=null);var h=this.yg.pr,v=this.SJ.eAh(a),B=2===c.V9,X={};B&&(X.TriggeredByFindReplace=
!0);if(this.Te.An)B&&(X.PaneAlreadyOpen=!0),Hi.UISurfaces.Ms().then(ma=>{ma.setSelectedTaskPane(fG.a.gqd);return null});else if(a.Xr!==nn.beingCreated&&!this.SJ.TJa(a))this.Te.dV?this.ga.processAction(ba.a.QV,2):this.Te.$8a=Object.assign(new LE,{commentId:a.id,kKc:c.JIc}),B&&(X.OpeningPaneToSelect=!0);else if(this.Ld.hp){const ma=v.Xr===nn.beingCreated;ma?this.lN.Qsa(v.ZA.draftId,0,c.JV):this.lN.Qsa(v.id,0,c.JV);!ma&&B&&(X.SelectingDHC=!0)}io.a.q_(l.AFrameworkApplication.Cb,()=>{this.Te.dV&&(c.JV&&
this.fb.Kf(this.Ld.hp&&!this.Te.An?Fc.AFrame.WJ:Fc.AFrame.aq),c.JIc&&this.SJ.TJa(a)||!c.JV&&!c.V9||this.uFg.selectComment(a.id))},sw.a.PPf);this.yg.selectComment(a);this.aee.highlightComment(a,!0);this.tv.LF(0,v,h);Eb.App.oa.updateCommandUI(!0);0<Object.keys(X).length&&this.yH.jB(ba.a.selectComment,{customData:X})}}}Object(w.a)(rO,"CommentSelectionActor",null,[423]);class ME extends dp.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new no.a,{T_:ME.getTypeName(),B_:ME.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}}
Object(w.a)(ME,"CommentSmartReplySignal",dp.a,[]);class hG extends Ul.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new no.a,{T_:hG.getTypeName(),B_:hG.getBaseTypes()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}}Object(w.a)(hG,"SmartReply",Ul.a,[]);class iG{constructor(a){this.wma=a}wyc(a,c){return Object.assign(new Jr.a,{parentPath:["Signal",
ME.getTypeName()],items:[Object.assign(new Eo.a,{body:Object.assign(new ME,{commentId:a,comment:c})})]})}gEf(a){const c=new Ua.a;if(a&&a.CommentId&&a.ResultSets&&0<a.ResultSets.length&&a.ResultSets[0].Documents&&0<a.ResultSets[0].Documents.length){for(const h of a.ResultSets[0].Documents)c.add(h.Caption);0<c.count&&this.wma.gEf(a.CommentId,c.toArray())}else r.ULS.sendTraceTag(574493152,327,10,"Invalid response from SmartReplies request")}getTypeName(){return hG.getTypeName()}}Object(w.a)(iG,"BaseCommentSmartReplyProvider",
null,[935]);class sO extends iG{constructor(a,c,h,v){super(a);this.$e=c;this.b3=h;this.r8i=v}initialize(){this.b3.Yn().then(()=>{this.$e.Ea(this,iG.prototype.getTypeName.call(this))})}invoke(a,c){this.b3.Yn().then(()=>{this.r8i.getAugLoopRuntimeManager().submitOperation(Object.assign(new mp.a,{operation:this.wyc(a,c)}))})}hK(a,c){a&&Un.a.getTypeNameFor(a.content)===this.getTypeName()&&c===fo.a.getTypeName()?this.gEf(a.content):r.ULS.sendTraceTag(579170963,327,10,"Invalid annotation event for smart replies")}}
Object(w.a)(sO,"CommentSmartReplyProvider",iG,[337]);class Nz{}Nz.commentNode=null;Nz.rpi=null;Object(w.a)(Nz,"CanaryCommentNode",null,[]);class tO{constructor(a,c,h,v,B,X){this.qa=a;this.Na=c;this.Mu=h;this.Uqe=v;this.Ikb=B;this.ZI=X;this.Rmb=!1;this.Ikb.nUm();this.Fcg=this.Z8k();this.jIf&&(Ld.a.addHandler(window.self,Jb.a.jRg,()=>{this.Rmb=!0}),Ld.a.addHandler(window.self,Jb.a.kRg,()=>{this.Rmb=!1}));0<this.Fcg&&(l.AFrameworkApplication.Mg("i1708223;c2j3e430"),l.AFrameworkApplication.Mg("WoCom926;WoCom926cf"),
l.AFrameworkApplication.Mg("9aed8253;eb09b796"),l.AFrameworkApplication.Mg("h6f1a346;8cc44455"),l.AFrameworkApplication.Mg("aed6f872;c1818808"))}get wC(){return this.Mu?this.Mu.value:null}get KTa(){return this.Uqe.value}get aJn(){return this.Rmb}get TFc(){return 0<this.Fcg}get hp(){return this.ZI.hp}get hvk(){return!0}get nfb(){return this.qa.$("OutlineViewElementDisplayWrapperForDhcsIsEnabled")}get THb(){return this.Na.isFeatureEnabled(193)&&!S.App.KJc}get PTc(){return this.qa.$("RetainSelectionForNewCommentIsEnabled")}get u$m(){return this.Na.isFeatureEnabled(53)&&
this.qa.$("SendErrorReportOnCommentInboundCrashIsEnabled")}get vPd(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.newCommentEntryPointEnabled",!1)}get dZd(){return this.Na.isFeatureEnabled(30)}get Ktk(){return this.ZI.ldh}get e4g(){return this.qa.$("CommentAnchorHighlightOnIpSelectionIsEnabled")}get fta(){return this.ZI.fta}get wqk(){return this.qa.$("DelayLoadCommentNodeInModelOnPasteIsEnabled")}get jIf(){return this.qa.$("RecordCommentActionsInTypingIsEnabled")}get U7h(){return this.qa.$("NoHighlightWhenCommentDraftInProgressIsEnabled")}get Cim(){return this.qa.$("NotifyResolvedCommentsLocationIsEnabled")}get Tub(){return this.hp&&
!this.TFc&&!this.qa.Ga("BootActivityNavigationId")&&H.a.so}get Asb(){return this.Na.isFeatureEnabled(16)}get cRj(){return this.qa.$("AtMentionUserFloodGateCampaignIsEnabled")}get p$j(){return this.qa.$("CommentFriendlyTimestampsIsEnabled")}get dvk(){return this.qa.Ga("DisabledChangeGatesInSharedComments")}get ixd(){return this.ZI.ixd}get dHb(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.WordTrackChangesSimpleMarkupView",!1)}get e8a(){return this.Na.isFeatureEnabled(27)}get hUf(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SmartRepliesIsEnabled",
!1)}get DV(){return this.qa.Ga("PresenceUserId")}get removePersonalInformation(){return S.App.E8d&&!!vg.PageReader.instance&&vg.PageReader.instance.wca(Eb.App.oa.Da.Zb).removePersonalInformation}get xAk(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableLoggingForEmptyComments",!1)}get i4j(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CheckIfCommitUiRefreshEventReceived",!1)}get Qzb(){return this.Na.isFeatureEnabled(85)}get r$a(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.EnableDurableIdForIdentification",
!1)}get Meh(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoNotFocusFloatingCommentOnEdit",!1)}get R5h(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.MissingCommentsDiagnosticsEnabled",!1)}get Rnk(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CtrlEnterTipIsEnabled",!1)}get dRj(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AtMentionHintMessageIsEnabled",!1)}get QZl(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SharedCommentsLivePersonaCardForWeb",
!1)}get k4m(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetryLoadForFailedCommentEnabled",!1)}get vBn(){return this.qa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1)}get R$j(){return this.qa.$("CommentsTasksFpsIsEnabled")}get trackChangeInSidetrackEnabled(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TCCardInSideTrack",!1)}get C$j(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReactionsFPSEnabled",!1)}get Txk(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DoesCommentExistFixIsEnabled",
!1)}get contentNavigationApiEnabled(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ContentNavigationApiEnabled",!1)}get z4g(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.CommentManagerResolveCrashFixIsEnabled",!1)}get lud(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.DraftSelectionVetoImprovementIsEnabled",!1)}get fRg(){return this.qa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdvanceCommentSliceDownloadingInBoot",!0)}Z8k(){if(this.wC&&
this.KTa){var a=new Kd.GraphIterator;a.set(this.wC);this.KTa.oeb(a);let c=0;39===a.Md&&(c=a.ro());if(0<c)for(a=Tl.a.zn(a.currentNode);a.moveNext();)if(a.currentNode&&40===a.currentNode.type){Nz.commentNode=a.currentNode;break}return c}return-1}}Object(w.a)(tO,"CommentsSettings",null,[]);var uO=b(1420);class vO{constructor(a){this.e6=a}QXg(a,c,h){const v=new $H;c=this.e6.bYa(c)?c.objectId:null;if(!c)return v;c=N.a.Ee(c);if(h.contains(c))return v.lHc=0,v.kHc=a.length,v;for(let X=0,ma=a.length;X<ma;X++){var B=
a[X];h=Yh.f(B);B=Yh.c(B);h&&FF.a.a6g(h,c)&&(v.lHc=X);if(B&&FF.a.a6g(B,c)){v.kHc=X;break}}return v}iTg(a,c,h){const v=-1===c.lHc&&-1===c.kHc,B=-1<c.lHc?c.lHc:-1;c=-1<c.kHc?c.kHc:a.length;const X=!v&&B===c;var ma=!1;for(let Pa=0;Pa<a.length;Pa++){const mb=a[Pa],Tb=vk.a(mb);if(1!==Tb&&2!==Tb&&3!==Tb)continue;this.e6.a_a(mb);if(v||Pa<B||Pa>c)continue;const rc=3===Tb||2===Tb&&-1!==mb.className.indexOf(lh.a.Iyb),Tc=h?1:2;this.dPj(Pa,B,c,Tc,rc,ma,mb,X);if(Pa!==c||X)(ma=this.e6.MWa.J(Tb).J(Tc))&&mb.classList.add(ma),
ma=rc}}dPj(a,c,h,v,B,X,ma,Pa){a!==c&&a!==h||B||X||((a=this.e6.G7b.J(v))&&ma.classList.add(a),Pa&&ma.classList.add(lh.a.HDf))}}Object(w.a)(vO,"DefaultHighlightChangeHandler",null,[422]);var jG;(function(a){a[a.success=0]="success";a[a.noSelection=1]="noSelection";a[a.invalidContent=2]="invalidContent"})(jG||(jG={}));Object(w.b)("AnchorCreationResult",jG);class wO{}Object(w.a)(wO,"EditorAnchorInfo",null,[468]);class Ry{constructor(a,c,h,v,B){this.lFg=null;this.$qe=a;this.xQa=c;this.nN=h;this.LDa=v;
this.Rb=B;this.nN.hgb(this.LDa)}get Ma(){return this.xQa.value}get jh(){return this.$qe.value}initialize(){}HAl(a){this.lFg=a}dispose(){}NWa(a){this.LDa.NWa(a)}zyb(a){this.LDa.zyb(a)}highlightComment(a){this.syi(a,!1);this.LDa.NWa(a.objectId)}Zcc(a){this.LDa.Zcc(a)}zya(a){return this.LDa.zya(a)}syi(a,c){if(!a.Xr){var h=this.jh.Ra(N.a.Ee(a.objectId)),v=Oi.a.l8(h,this.jh,!0);h=Oi.a.l8(h,this.jh,!1);if(v&&h){const B=v.Xa.paragraph;v=v.Xa.cp;if(this.bSl(B,v))Eb.App.oa.updateCommandUI(!0);else{v=ne.SelectionFactory.vd(B,
v);h=Oe.a.Sb(h.Xa.paragraph,h.Xa.cp);if(Ry.Sf.T8(v.sa)||Ry.Sf.T8(h))a.P2b=!0,a.OYa();a=c?ne.SelectionFactory.jC(v,h):v;this.lFg(a)}}}}w6j(){this.LDa.zyb(null);this.LDa.NWa(null)}Gfk(){let a=new wO;return{returnValue:jG.success,anchor:a}}bSl(a,c){if(a&&Object(Ub.a)(rH.PageView,this.Rb.rc)){var h=a.Sd(this.Rb.rc.gb);a=document.getElementById(If.AppFrame.hDa);if(h&&a){c=fu.a.Zo(h,c);if(!c)return!1;c=c.y;h=Sys.UI.DomElement.getBounds(a).y;a=a.offsetHeight;if(c>=h&&c<=h+a)return!0}}return!1}static get Sf(){return li.a.instance}static getInstance(){return Ry.wk()}static wk(){return Ry._instance||
(Ry._instance=new Ry(new qf.a(()=>Eb.App.oa.Da.Zb.Lc),new qf.a(()=>$c.a.instance),xa.a.instance.resolve("Box4.Indicator.IIndicatorManagerFactory").instance,xa.a.instance.resolve("WordEditor.Comments.CommentHintActor"),ec.InteractiveViewManager.instance))}}Ry._instance=null;Object(w.a)(Ry,"EditorCommentHintManager",null,[420,421,14]);var SQ=b(1003);class Oz extends ud.a{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh,Fi,wk,Gk,Kl,Yj,ao){super(ma);this.zh=c;this.xQa=Pa;this.RQe=Tb;this.xma=
rc;this.Cgc=Tc;this.lN=vd;this.Ld=ee;this.yj=Ie;this.Jkb=Xe;this.Te=Yf;this.aT=Hh;this.Zc=wk;this.yH=Gk;this.Me=Kl;this.SN=ao;this.uJh=this.gHg=this.aQa=null;this.rkm=()=>{if(this.Te.dV){var oq=()=>!0;this.ay&&!this.Te.An&&(oq=to=>this.SJ.TJa(to));oq=this.SJ.F5e(oq);this.IEb(oq)}};this.ga=ma;this.zA=1===this.ga.mode?0:1;this.tZ=B;this.yg=v;this.s6=X;this.fb=mb;!this.Ld.fRg&&Fi?this.oJf(Fi):this.pTm();h.ggb(this.xma);(this.Ld.e4g||this.Ld.vPd)&&this.Ma.aC(Object(m.a)(this,this.PAa,"onSelectionChange"));
a.CWR(()=>a.result.xz.bsb(Object(m.a)(this,this.ikm,"onAfterKickout")));l.AFrameworkApplication.na&&l.AFrameworkApplication.na.QSa(Object(m.a)(this,this.hNc,"modeSwitched"));this.aT.dgb("OnAfterTrackChangeMarkupViewChange",this.rkm);l.AFrameworkApplication.UK&&l.AFrameworkApplication.UK(()=>{this.k4j()});Yj.execute(oq=>{oq.pdk.execute(to=>{this.uJh=to})})}pTm(){this.uJb&&(this.uJb.oKa()?this.oJf(this.uJb.Jb):this.uJb.nIe(this.fOc.bind(this)))}fOc(){this.uJb.oKa()&&(this.oJf(this.uJb.Jb),this.uJb.BKf(this.fOc.bind(this)))}oJf(a){a.aha(()=>
{this.Nwn()})}get uJb(){var a;return null===(a=S.App.Hk)||void 0===a?void 0:a.Da}get Ma(){return this.xQa.value}get wn(){return this.yg}get SJ(){return this.yg}get ay(){return this.Ld.hp}get F7h(){return!0}get S0b(){return this.aQa}set S0b(a){this.aQa=a}get mode(){return super.mode}set mode(a){a!==this.zA&&(super.mode=a,this.OYa())}get wy(){return this.model&&this.model.pr?this.model.pr.yf?this.model.pI(this.model.pr.yf):this.model.pr:null}get jh(){return this.zh.value}get pHi(){return!1}get removePersonalInformation(){return this.Ld.removePersonalInformation}hNc(a){2===
a.mode?this.zA=1:1===a.mode&&(this.zA=0);this.yg.vF&&0===this.zA?r.ULS.sendTraceTag(542914062,327,50,"Switch to read only mode while drafting a comment with drafting session type [{0}].",this.yg.vF.ZA.sessionType):this.Te.dV&&(this.ay||this.tZ.isVisible)&&this.IEb()}IEb(a=null,c=null){const h=this.SJ,v=!this.zA,B=this.F9.o$j,X=h.TAd();B.q0f(X?5:1,v);a=this.Ld.dHb&&a?a:h.a6e(this.Ld.dHb&&this.ay&&!this.Te.An);B.p$m(a,X,h.QOa);c&&r.ULS.sendTraceTag(572281362,327,50,c)}AOc(a,c,h=!1){this.Te.An?this.lN.ZVi():
c?this.lN.deleteContainer(a.Xr===nn.beingCreated?a.ZA.draftId:a.id,0,h):this.nMm(a)}nMm(a){const {bDn:c}=this.yg.N3k(a),h=this.s6.zya(a.objectId);h&&this.lN.addContainer(a.id,h.parentElement,0,c)}Byi(a){const c=this.wy;this.BUc();this.xma.LF(0,this.yg.pr,c);this.ay&&this.yg.pr&&!this.Te.An&&this.lN.Qsa(this.yg.pr.id,0,1===a)}o9m(){const a=this.wy;this.CUc();this.xma.LF(0,this.yg.pr,a);this.ay&&this.yg.pr&&!this.Te.An&&this.lN.Qsa(this.yg.pr.id,0,!1)}Zcc(a){this.s6.Zcc(a)}bAk(a,c){this.lN.addContainer(a,
null,0,c)}bAm(a){this.lN.ghi(a)}cAk(a,c){this.lN.iTc(a,c,0)}KNn(){this.lN.oLe()}uyi(a){if(a&&(2!==this.mode||a.Xr===nn.beingCreated)){var c=this.yg.pr;c!==a&&(this.yg.selectComment(a),this.tZ.isVisible?this.Te.dV?(this.tZ.selectComment(a,1),this.Qfa.selectComment(a.id)):this.Te.$8a=Object.assign(new LE,{commentId:a.id,kKc:!1}):this.ay&&!a.done&&(this.xyi(a.id,!1),this.Qfa.selectComment(a.id)),!this.tZ.isVisible&&this.ay&&a.done||(this.N0b.NWa(a.objectId),this.xma.LF(0,this.wy,c)))}}ikm(){this.Te.Lyb?
this.mode=0:this.zA=0}yHc(){}q_e(){this.Te.Lyb=!1}Prb(a){this.Ld.U7h&&this.yg.pr&&this.clearSelection();super.Prb(a);this.yH.Pm("CommentThreadInProgress",0);if(this.ay){const c=this.yg.Zil(a.draftId);this.bAk(a.draftId,c)}}addReply(a,c){this.yH.Pm("CommentReplyInProgress",0);super.addReply(a,c)}hpa(a){this.ay&&null!=a.ZA&&this.yg.aqi(a.ZA.draftId);super.hpa(a);this.s6.NWa(a.objectId);r.ULS.sendTraceTag(50426376,327,50,"{0}:  added by user action.",Yh.a(a));this.yH.Pm("CommentCommit",0);this.o4j(a);
Zw.NUn(a,this.jh,this.yH);this.yH.jB(ba.a.j4g,{succeeded:!0,customData:{actionType:a.yf?Cr.reply:Cr.create}})}b9a(a){super.b9a(a);this.yH.jB(ba.a.j4g,{succeeded:!0,customData:{actionType:Cr.edit}})}o4j(a){if(a.yf){var c=this.yg.eAh(a);if(c.JTb&&c.KTb){var h=this.jh.Ra(N.a.Ee(c.KTb));c=c.KTb===c.JTb?null:this.jh.Ra(N.a.Ee(c.JTb));Zw.Z4f(h,a,!0);Zw.Z4f(c,a,!1)}}}izc(a){super.izc(a);this.wy&&this.wy.id===a.id&&(super.clearSelection(),this.ay&&this.lN.uVb());if(this.ay)if(Yh.p(a)){var c=[];let h=null;
for(let v of this.model.h0())v!==a&&(v.yf===a.yf&&c.push(v),v.id===a.yf&&(h=v));h&&h.id&&h.objectId&&!h.done&&this.SJ.BF(h.objectId)&&!this.SJ.Phi(h.objectId)&&!c.length&&this.AOc(h,!0)}else c=a.Xr===nn.beingCreated,a.done||this.AOc(a,!0),c&&this.yg.aqi(a.ZA.draftId)}editComment(a,c){1===this.mode&&a&&(this.yg.mAc(a,c),Cr.edit===c.sessionType&&this.yH.Pm("CommentEditInProgress",0),this.Ld.THb&&3!==Cr.q8e(c.sessionType)?this.Jkb.selectComment(a,Object.assign(new rw.a,{JV:!this.Ld.Meh,V9:0})):this.Ld.e8a||
this.Jkb.selectComment(a,Object.assign(new rw.a,{JV:!this.Ld.Meh,V9:0})))}d_d(a){this.ay&&!this.Te.An||super.d_d(a)}deleteComment(a){a.Xr!==nn.beingCreated&&this.SJ.rch(N.a.Ee(a.objectId));this.aQa&&this.aQa.id===a.id&&(this.yg.pr&&this.aQa.id===this.yg.pr.id?this.aQa=null:this.xma.RPe());!this.yg.pr||this.yg.pr.id!==a.id&&this.yg.pr.yf!==a.id?this.yg.pr&&this.xma.LF(0,this.yg.pr,null):void 0===a.yf||null===a.yf?this.clearSelection():this.yg.selectComment(this.yg.pI(a.yf));a.P2b&&r.ULS.sendTraceTag(556360779,
327,50,"The comment selected for deletion is currently locked: {0}.",Yh.a(a));super.deleteComment(a);r.ULS.sendTraceTag(50426377,327,50,`${Yh.a(a)} deleted by user action. DurableId: ${a.svb}`)}htb(a,c){super.htb(a,c);this.ay&&!this.Te.An&&c&&(this.yg.pr&&this.yg.pr.id===a.id&&this.clearSelection(),this.S0b&&this.S0b.id===a.id&&this.xma.RPe())}n9m(a=null){(a=this.SJ.zVk(a))?this.Jkb.selectComment(a,Object.assign(new rw.a,{JV:!0,V9:1})):this.Byi(1)}PAa(a,c){var h;a=c.rk.Fa;if((this.ay||this.F9&&this.F9.isVisible)&&
!this.Jkb.fBe&&a){c=Gc.SelectionEditor.Cl(a);var v=a.zM;!this.Ld.vPd||null!==(h=this.uJh)&&void 0!==h&&h.Y7||(1!==this.mode||c&&!v?this.Cgc.ydf():this.vjk(a));2!==this.mode&&3!==this.mode&&this.Ld.e4g&&this.uHn(a,c,v)}}vjk(a){var c=a.sa.node;let h=ie.OutlineElementNavigator.Al(c);this.Me.$c(()=>{const B=Kd.GraphIterator.va(h);let X=null;do B.fn()&&(X=B.parentNode?ie.OutlineElementNavigator.Al(B.parentNode):null)&&(h=X,B.set(h));while(X)},"ECM:FOOE");if(null===h||void 0===h?0:h.aN)for(var v of h.aN)if(v&&
v instanceof ny.a){const B=SQ.a.V9g(v);this.Cgc.S7d=this.CGk(c,a);a=this.z_j(B);if(c=this.Cgc.rGk(B,a))B.oza[a].appendChild(c),v.xx(c);break}}CGk(a,c){let h;for(let v of a.aN)if(v&&v){h=v;break}a=c.sa.Xl;return 0>a||null===h||void 0===h||!h.eop?null:fu.a.XW(a,h,!1,!1)}z_j(a){var c;if(!a.H8||2>a.H8.length)return 0;let h=0;const v=null===(c=this.Cgc.S7d)||void 0===c?void 0:c.y;for(c=1;c<a.H8.length;c++)if(v>=a.H8[c].y-2)h=c;else break;return h}OYa(){Eb.App.gYa&&(Eb.App.SFc=2===this.mode||3===this.mode);
1!==this.mode&&this.Cgc.ydf()}uHn(a,c,h){const v=this.fb.nf;let B=null;if(c||h){c=a.sa.cpBegin;a=a.sa.node;if(this.wy&&Yh.o(this.wy,a,this.jh,c))return;B=this.U7k(a,c)}B?!this.ay||this.Te.An?io.a.q_(l.AFrameworkApplication.Cb,()=>{this.uyi(B)},sw.a.f9m):this.uyi(B):!this.yg.pr||v&&v.name===Fc.AFrame.WJ||this.clearSelection()}U7k(a,c){let h=null;const v=this.model.h0();for(let B=v.length-1;0<=B;B--){const X=v[B];if(X.objectId&&!(X.yf||this.ay&&!this.F9.isVisible&&X.done)&&Yh.o(X,a,this.jh,c)){h=X;
break}}return h}selectComment(a,c=1){this.Jkb.vyi(a,Object.assign(new rw.a,{JV:1===c,V9:c}))}xyi(a,c){const h=this.yg.pI(a);h?this.ay&&!Yh.p(h)&&h.Xr!==nn.beingCreated&&this.lN.Qsa(a,0,c):r.ULS.sendTraceTag(42332933,327,10,"Selected Comment isn't in the model.")}clearSelection(){const a=this.model.pr;super.clearSelection();this.xma.LF(1,a,a);this.ay&&this.lN.uVb()}DRl(){var a;return 500>(null===(a=this.gHg)||void 0===a?void 0:a.Yg)}m6b(a,c=1){if(!this.Ld.U7h||!this.yg.vF){var h=this.yg.pI(a),v=null;
h||(v=this.aQa);var B=this.DRl(),X=!1;1===c&&this.Qfa&&(B?X=!0:this.Qfa.highlightComment(a));a?h?B?X=!0:this.s6.zyb(h.objectId):r.ULS.sendTraceTag(37323346,327,10,"Comment is NOT in the model, but we are trying to hightlight!"):this.s6.zyb(null);h?B?X=!0:(this.aQa=h,this.xma.LF(2,h,v)):(this.aQa=null,this.xma.LF(3,null,v));X&&r.ULS.sendTraceTag(544532572,327,50,"Comment highlighting was skipped due to the user actively scrolling.")}}Nwn(){this.Zc&&(this.gHg=this.Zc.Pe("UserAction","StartScrollDetectionStopwatch"))}notify(a,
c){this.yj.sendNotification(a,c)}k4j(){if(this.wn&&this.wn.vF){var a=this.wn.vF;if(a.ZA.sessionType!==Cr.metadata){r.ULS.sendTraceTag(545640771,327,15,`Draft Comment of type:${a.Xr} present on app shutdown`);a=Zw.HZk(a);const c=new fi.a;c.inStaging=!0;a&&this.yH.pi(a,"CommentDraftLostOnAppShutdown",{isInternal:!0},{name:"CommentExperienceDegraded",isIntentional:!1,isInternal:!0,isSessionEndingError:!1,Uu:c})}}}static getInstance(){return Oz.wk()}static wk(){Oz.Gf||(Oz.Gf=new Oz(Eb.App.Zia(),new qf.a(()=>
Eb.App.oa.Da.Zb.Lc),xa.a.instance.resolve("Box4.Highlight.IHighlightManagerFactory").instance,xa.a.instance.resolve("Common.Comments.ICommentModel"),xa.a.instance.resolve("Common.Comments.ICommentPane"),Ry.getInstance(),l.AFrameworkApplication.pa,new qf.a(()=>$c.a.instance),nc.FocusManager.instance(),xa.a.instance.resolve("WordEditor.Comments.IWordEditorSharedCommentAPI"),xa.a.instance.resolve("WordEditor.Comments.ICommentHighlightActor"),xa.a.instance.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),
xa.a.instance.resolve("WordEditor.Comments.IFloatingCommentManager"),xa.a.instance.resolve("WordEditor.Comments.CommentsSettings"),xa.a.instance.resolve("Common.Utils.IAriaNotifier"),xa.a.instance.resolve("WordEditor.Comments.ICommentSelectionActor"),xa.a.instance.resolve("WordEditor.Comments.CommentsState"),xa.a.instance.resolve("WordEditor.Comments.WordCommentEventsActor"),S.App.Hk.Da.Jb,Eb.App.oa.Qo,xa.a.instance.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),Fo.a.instance,xa.a.instance.za("WordEditor.HeaderFooter.HeaderFooterControlOwner"),
xa.a.instance.resolve("WordEditor.Comments.ICommentFloatingContainerActor")),Oz.Gf.rGb=!0);return Oz.Gf}}Oz.Gf=null;Object(w.a)(Oz,"EditorCommentManager",ud.a,[417,418,419,14]);var xO=b(1642);class yO{constructor(a,c){this.CommentId=a;this.ResolveState=c}}Object(w.a)(yO,"CommentProperties",null,[]);var HA;(function(a){a[a.unsaved=0]="unsaved";a[a.sentToServer=1]="sentToServer";a[a.succeeded=2]="succeeded";a[a.failed=3]="failed";a[a.saveNotNeeded=4]="saveNotNeeded"})(HA||(HA={}));Object(w.b)("CommentSaveStatus",
HA);var TQ=b(26),UQ=b(1039),zO=b(1472);class DC{constructor(a,c="",h="",v="",B=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=a;this.Provider=c;this.DisplayName=h;this.Email=v;this.IsCurrentUser=B}}Object(w.a)(DC,"OfficeSharedCommentUser",null,[]);class AO extends DC{constructor(a,c="",h="",v="",B=!1){super(a,c,h,v,B);this.DateUtc=null}}Object(w.a)(AO,"CommentReactionUser",DC,[]);var NE;(function(a){a[a.like=1]="like"})(NE||(NE={}));Object(w.b)("ReactionType",
NE);var Tx;(function(a){a[a.first=0]="first";a[a.done=0]="done";a[a.undone=1]="undone";a[a.addComment=2]="addComment";a[a.deleteComment=3]="deleteComment";a[a.editComment=4]="editComment";a[a.addReaction=5]="addReaction";a[a.removeReaction=6]="removeReaction";a[a.last=7]="last"})(Tx||(Tx={}));Object(w.b)("CommentChangeType",Tx);var BO=b(550);class CO{constructor(){this.iFg=this.xHg=!1;this.iyj=[]}get ucc(){return this.iyj}get nHb(){return this.xHg}set nHb(a){this.xHg=a;for(const c of this.ucc)c.nHb=
a}get ZFb(){return this.iFg}set ZFb(a){this.iFg=a;for(const c of this.ucc)c.ZFb=a}$0a(a){for(const c of this.ucc)a=c.$0a(a);return a}}Object(w.a)(CO,"AggregateCommentTaskPersonTransformer",null,[907]);var fI=b(1419);class DO{constructor(a,c){this.Wkj=new qf.a(()=>c.$0a(a.value))}sYk(){return new Date}XTa(a,c,h){if(0===a)throw r.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");
const v=Ya.a.create().toString();h=new fI.a(a,this.Wkj.value,h,v,!1);h.commentId=c;r.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",a);return h}}Object(w.a)(DO,"HistoryRecordFactory",null,[908]);var gI=b(1487);class EO{constructor(a,c,h,v,B,X){this.isLossy=a;this.title=c;this.assignees=h;this.schedule=v;this.completion=B;this.priority=X}}Object(w.a)(EO,"CommentTaskState",null,[]);class FO{constructor(){this.commentId=null}}Object(w.a)(FO,"HistoryItem",null,[]);class hI{constructor(a,
c,h,v,B,X,ma){this.fne=!1;if(1!==c.type)throw Error.argument("createRecord");this.Chc=h;this.zhc=v;this.Ahc=B;this.iwg=1;this.V7c=a;this.Wmj=X;this._state=new EO(!1,this.Chc,ma,new gI.a,this.Ahc,this.zhc);this._history=[];this.I9g(c)}FWb(a,c){if(1!==a.type)throw Error.argument("createRecordTemplate");const h=hI.Bhl(a,this.iwg);this.iwg++;return Object.assign(new fI.a(c,a.user,a.time,h),{commentId:a.commentId})}get eZh(){return this.history[this.history.length-1]}get vIh(){return this.state.completion===
this.Ahc}get uIh(){return this.state.priority===this.zhc}get wIh(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get xIh(){return this.state.title===this.Chc}I9g(a){a=Object.assign(new FO,{commentId:a.commentId,records:[a]});this.history.push(a)}tqh(a){let c=-1;for(let h=0;h<this.state.assignees.length;h++)if(this.V7c.equals(this.state.assignees[h],a)){c=h;break}return c}emn(a){const c=
this.eZh,h=c.records[c.records.length-1];return this.V7c.equals(h.user,a.user)&&c.commentId===a.commentId&&h.time.getTime()===a.time.getTime()?!0:!1}nSn(a){switch(a.type){case 2:-1===this.tqh(a.assignee)&&this.state.assignees.push(a.assignee);break;case 3:const c=this.tqh(a.assignee);0<=c&&this.state.assignees.splice(c,1);break;case 4:Array.clear(this.state.assignees);break;case 5:this.state.schedule=a.schedule;break;case 6:this.state.completion=a.completion;break;case 9:this.state.title=a.title;
break;case 10:this.state.priority=a.priority;break;case 0:this.state.isLossy=!0;break;case 1:r.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.fne=!0;break;case 8:this.fne=!1;break;case -1:r.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}a.isLossy&&(this.state.isLossy=!0);this.emn(a)?this.eZh.records.push(a):this.I9g(a)}get isDeleted(){return this.fne}get state(){return this._state}get history(){return this._history}L2k(a){if(!a)return this.history;
const c=Array.clone(this.history),h=c[0],v=h.records.shift();if(!this.Wmj){var B=this.FWb(v,4);h.records.unshift(B)}!a.vIh&&this.vIh&&(B=this.FWb(v,6),B.completion=this.Ahc,h.records.unshift(B));!a.uIh&&this.uIh&&(B=this.FWb(v,10),B.priority=this.zhc,h.records.unshift(B));!a.wIh&&this.wIh&&(B=this.FWb(v,5),B.schedule=new gI.a,h.records.unshift(B));!a.xIh&&this.xIh&&(B=this.FWb(v,9),B.title=this.Chc,h.records.unshift(B));a.isDeleted&&(a=this.FWb(v,8),h.records.unshift(a));return c}static Bhl(a,c){return"Synthesized-"+
a.recordId+"-"+c}}Object(w.a)(hI,"CommentTaskStateBuilder",null,[]);class GO{constructor(a,c,h,v){this.id=a;this.commentId=c;this.currentState=h;this.history=v}}Object(w.a)(GO,"CommentTaskItem",null,[]);var kG=b(1418);const OE=a=>{const c=new kG.a(a.UserId,a.Provider,a.DisplayName,a.Email);c.IsCurrentUser=a.IsCurrentUser;return c};var VQ=b(1638);class zD{static clone(a){a=zD.h8j(a.extensions);return new VQ.a(a)}static b3g(a){return a?zD.clone(a):null}static isEmpty(a){return!a.extensions||!a.extensions.count}static ve(a){return!a||
zD.isEmpty(a)}static h8j(a){if(!a)return null;const c=new Yc.a;a.forEach((h,v)=>{c.add(h,v);return!0});return c}}Object(w.a)(zD,"ExtensionListExtensions",null,[]);class HO{static clone(a){var c=OE(a.user);c=new fI.a(a.type,c,a.time,a.recordId,a.isLossy);c.commentId=a.commentId;c.anchorExtensionList=zD.b3g(a.anchorExtensionList);c.recordExtensionList=zD.b3g(a.recordExtensionList);a.assignee&&(c.assignee=OE(a.assignee));if(a.schedule){var h=a.schedule;const v=new gI.a;v.startDate=h.startDate;v.endDate=
h.endDate;c.schedule=v}c.completion=a.completion;c.title=a.title;c.priority=a.priority;c.undoId=a.undoId;return c}}Object(w.a)(HO,"HistoryRecordExtensions",null,[]);class IO{constructor(a,c,h,v,B,X,ma,Pa=!1){this.V7c=a;this.edd=c;this.OFa=h;this.Eaj=v;this.Chc=B;this.zhc=X;this.Ahc=ma;this.K9c=Pa}zmk(a,c,h,v=null){if(!a)throw r.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!c)throw r.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),Error.argumentNull("parentCommentId");
if(!h||!h.length)throw r.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==h[0].type)throw r.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var B=[],X=null,ma=this.eHm(h);for(var Pa of h)if(!ma.contains(Pa.recordId))if(h=this.gFh(Pa.commentId,v),h=this.KPk(Pa,h),1===h.type){let Tb=[];this.K9c&&X&&X.state&&(Tb=X.state.assignees);X=new hI(this.V7c,h,this.Chc,this.zhc,
this.Ahc,this.K9c,Tb);B.push(X)}else if(X)X.nSn(h);else throw r.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");ma=null;Pa=[];if(X){X.isDeleted||(ma=X.state);X=null;for(var mb of B)B=mb.L2k(X),Array.addRange(Pa,B),X=mb}mb=this.gFh(c,v);ma&&(ma.completion=this.Qak(c,v,ma.completion));return new GO(a,
mb,ma,Pa)}eph(a,c,h,v=null){if(!c)throw r.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(h&&!a)throw r.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const B=[],X=this.OFa.sYk();if(h){var ma=this.OFa.XTa(1,a,X);B.push(ma)}ma=null;if(c.assigneeUpdate){if(!c.assigneeUpdate.assigneesToAdd||!c.assigneeUpdate.assigneesToRemove)throw r.ULS.sendTraceTag(536999254,327,15,"Invalid AssigneeUpdate."),
Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Pa=0;Pa<c.assigneeUpdate.assigneesToAdd.length;Pa++){var mb=this.J9g(2,c.assigneeUpdate.assigneesToAdd[Pa],a,X);mb&&B.push(mb)}for(Pa=0;Pa<c.assigneeUpdate.assigneesToRemove.length;Pa++)(mb=this.J9g(3,c.assigneeUpdate.assigneesToRemove[Pa],a,X))&&B.push(mb)}else c.assignee&&(h||(ma=this.OFa.XTa(4,a,X),B.push(ma)),Pa=this.OFa.XTa(2,a,X),ma=this.edd.$0a(c.assignee),Pa.assignee=ma,B.push(Pa));c.title?(v=this.OFa.XTa(9,a,X),v.title=c.title,
B.push(v)):h&&v&&(Pa=this.OFa.XTa(9,a,X),Pa.title=this.Eaj.akl(v,ma),B.push(Pa));if(c.schedule){if(c.schedule.startDate>c.schedule.endDate)throw r.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");v=this.OFa.XTa(5,a,X);v.schedule=c.schedule;B.push(v)}if(void 0!==c.completion&&null!==c.completion){v=c.completion;if(0>v||100<v)throw r.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),Error.argumentOutOfRange("completion");h||r.ULS.sendTraceTag(595198538,
327,50,"Task progress change. [Progress: {0}]",v);h=this.OFa.XTa(6,a,X);h.completion=v;B.push(h)}if(void 0!==c.priority&&null!==c.priority){c=c.priority;if(0>c||10<c)throw r.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");a=this.OFa.XTa(10,a,X);a.priority=c;B.push(a)}return B}J9g(a,c,h,v){if(2!==a&&3!==a)return r.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),null;a=this.OFa.XTa(a,h,v);a.assignee=
this.edd.$0a(c);return a}eHm(a){const c=new dm.a,h=new dm.a;for(let v=a.length-1;0<=v;v--){const B=a[v],X=h.contains(B.recordId);X||-1!==B.type||(h.contains(B.undoId)?r.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):h.add(B.undoId));if(X||-1===B.type)c.contains(B.recordId)?r.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):c.add(B.recordId)}return c}KPk(a,c){const h=HO.clone(a);
h.commentId=c;h.user=this.edd.$0a(a.user);h.assignee=this.edd.$0a(a.assignee);return h}Qak(a,c,h){let v=h;a&&c&&(({value:c}=c.Ab(a)).returnValue?(v=c.ResolveState?100:100===h?0:h,v!==h&&r.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",a)):r.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",a));return v}gFh(a,c){let h=a;a&&c&&(({value:c}=c.Ab(a)).returnValue?h=c.CommentId:
(r.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",a),h=a));return h}}Object(w.a)(IO,"CommentTaskTranslatorImpl",null,[909]);var AD=b(908);class JO{constructor(){this.i$a=CommonUIStrings.l_Ellipsis}akl(a,c){if(!a)throw r.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var h=$q.a.dzd(a)}catch(mb){throw r.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),
Error.format("Improperly formatted Delta text in commentRichText");}var v=a=0,B=0;const X=RegExp("\\s+","g"),ma=new Sys.StringBuilder;for(var Pa of h.ops)Pa.attributes&&Pa.attributes.atmention&&Pa.attributes.atmention.email&&c&&(h=Pa.attributes.atmention.email,0<h.length&&(h===c.UserId||h===c.Email||h===AD.a.G$a(c.UserId))&&(v=a,B=v+Pa.insert.length)),h=Pa.insert.replace(X," "),a+=h.length,ma.append(h);!B&&c&&r.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",c.Provider);
c=ma.toString().trimEnd();a=c.length;255<a?(Pa=(255-(B-v))/2,0>v-Pa?(a=Zo.a.instance.kab(c,255-this.i$a.length),B=c.substring(0,a)+this.i$a,a="Trimmed End"):B+Pa>a?(v=Zo.a.instance.KVa(c,a-255+this.i$a.length),B=this.i$a+c.substring(v,a),a="Trimmed Start"):(v=Zo.a.instance.KVa(c,v-Pa+this.i$a.length),a=Zo.a.instance.kab(c,B+Pa-this.i$a.length),B=this.i$a+c.substring(v,a)+this.i$a,a="Trimmed Both")):(a="No Trim",B=c);r.ULS.sendTraceTag(592998804,327,50,a);return B}}Object(w.a)(JO,"ContentExtractor",
null,[]);class KO{constructor(a,c){this.shj=a;this.Ykj=c;this.ZFb=this.nHb=!1}$0a(a){if(!a)return null;if(void 0===a.UserId||null===a.UserId)throw r.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(a.IsCurrentUser||!this.shj.equals(this.Ykj.value,a))return a;a=OE(a);a.IsCurrentUser=!0;return a}}Object(w.a)(KO,"EnsureIsCurrentUserSetTransformer",null,[907]);class LO{constructor(){this.ZFb=this.nHb=!1}$0a(a){if(!a)return null;if(void 0===a.UserId||null===
a.UserId)return a;if(!a.Email||""===a.Email){let c;if(c=AD.a.G$a(a.UserId))return a=OE(a),a.Email=c,a}return a}}Object(w.a)(LO,"RestoreEmailTransformer",null,[907]);class lG{constructor(){this.ZFb=this.nHb=!1}$0a(a){if(!a)return null;if(void 0!==a.UserId&&null!==a.UserId)return a;switch(this.nHb?this.ZFb?2:1:0){case 0:if(void 0===a.UserId||null===a.UserId)throw r.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");a=OE(a);break;case 1:if(void 0===a.Id||null===
a.Id)throw r.ULS.sendTraceTag(593368214,327,10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===a.Email||null===a.Email)throw r.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var c=lG.Ggi(a.Id,a.Email,null);if(!c||""===c)throw r.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var h=l.AFrameworkApplication.K.Ga("HostAuthType")||"";if("aad"!==h.toLowerCase()||c.startsWith("S::")){if("msa"===h.toLowerCase())throw r.ULS.sendTraceTag(593368210,
327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");r.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",h)}else throw r.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");a=new kG.a(c,"AD",a.DisplayName,a.Email);break;case 2:if(void 0===a.UserPrincipalName||null===a.UserPrincipalName)throw r.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");
if(void 0!==a.SuggestionSubtype&&null!==a.SuggestionSubtype)if("OrganizationUser"===a.SuggestionSubtype)c="AD";else throw r.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",a.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw r.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");h=lG.Ggi(a.Id,a.UserPrincipalName,a.AadObjectId);if(!h||""===h)throw r.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),
Error.argument("UserId");if("AD"===c&&!h.startsWith("S::"))throw r.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");a=new kG.a(h,c,a.Name,a.UserPrincipalName);break;default:throw r.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return a}static Ggi(a,c,h){if(!c||""===c)return r.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),a;if(h&&""!==h)return"S::"+c+"::"+h;if(!a||""===a)return r.ULS.sendTraceTag(593368217,
327,50,"Missing ID"),a;if(a.startsWith("S::"))return a;if(-1!==a.indexOf("@")){h=a.split("@");if(Ya.a.Nc(h[0]))return"S::"+c+"::"+h[0];r.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return a}}Object(w.a)(lG,"UserIdCanonicalizationTransformer",null,[907]);class IA{constructor(a,c,h=!1,v=!1){this.idj=a;this.fbg=c;this.Ilj=h;this.K9c=v}Jgk(){const a=new AD.a;var c=new qf.a(IA.UXk);const h=new CO;this.fbg&&(h.ucc.push(new lG),h.ucc.push(new LO));this.idj&&h.ucc.push(new KO(a,
c));h.nHb=this.fbg;h.ZFb=this.Ilj;c=new DO(c,h);const v=new JO;return new IO(a,h,c,v,IA.bqk,IA.Qpk,IA.Rpk,this.K9c)}static UXk(){const a=new kG.a(l.AFrameworkApplication.K.Ga("PresenceUserId")||"",l.AFrameworkApplication.K.Ga("PresenceProvider")||"",l.AFrameworkApplication.userName||"");a.IsCurrentUser=!0;return a}}IA.bqk="";IA.Qpk=5;IA.Rpk=0;Object(w.a)(IA,"CommentTaskTranslatorFactory",null,[899]);var WQ=b(663),XQ=b(1272);class MO{create(){return new eG.a}}Object(w.a)(MO,"CommentNodeFactory",null,
[472]);var NO=b(928);class OO{constructor(){this.DAc=this.hXc=null;this.Pud=this.m3d=!1;this.AHa=this.Uwa=null}}Object(w.a)(OO,"CommentAnchorParaNodesStatus",null,[]);class PO extends zr.a{constructor(a){super();this.Wrj=a}get index(){return 2}run(){this.Wrj()}k4g(a,c){c.property===Ed.a.ge&&this.gY()}}Object(w.a)(PO,"CommentContentPropertyTracker",zr.a,[]);class QO{constructor(a,c){this.q7b=a;this.pOh=c}}Object(w.a)(QO,"CommentIntentIdentifier",null,[]);class RO extends zr.a{constructor(a,c){super();
this.S2a=new Zc.a(new jO.a);this.nSb=new CE.a(Yh.b);this.oSb=new br.ScriptSharpLegacyMap;this.Znj=a;this.bpj=c;this.oSb.add(Yb.a.J7,1);this.oSb.add(Yb.a.fF,0);this.oSb.add(Ed.a.ge,0);this.oSb.add(Yb.a.C3,2)}get index(){return 4}run(){let a="";for(let c of this.S2a)if(this.Znj(c),this.nSb.Ja(c.id))for(let h of this.nSb.J(c.id))a+="_"+h;this.bpj(a);this.S2a.clear();this.nSb=new CE.a(Yh.b)}z$j(a,c){a=c.property;if(a===Yb.a.J7||a===Yb.a.fF||a===Ed.a.ge||S.App.E8d&&a===Yb.a.JVb||a===Yb.a.C3)this.S2a.add(c.node),
this.oSb.Ja(a)&&(this.nSb.Ja(c.node.id)||this.nSb.add(c.node.id,new va.a),this.nSb.J(c.node.id).add(this.oSb.J(a))),this.gY()}M$j(a,c){c.property===Ed.a.Pl&&(a=c.node,a.Gzb&&(this.S2a.add(a),this.gY()))}ABn(a,c){this.S2a.add(c.node);this.gY()}}Object(w.a)(RO,"CommentNodeTransactionCompletedProcessor",zr.a,[]);class SO{constructor(){this.mhe=new Map;this.ske=new Map}CCj(a,c){if(this.mhe.has(a))throw Error("DuplicateDurableId");if(this.ske.has(c))throw Error("DuplicateGuardId");this.mhe.set(a,c);this.ske.set(c,
a)}X1k(a){return this.mhe.get(a)}KZk(a){return this.ske.get(a)}}Object(w.a)(SO,"CommentIdMapper",null,[]);class $r extends xO.a{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe,Yf,Hh,Fi,wk,Gk,Kl,Yj,ao,oq,to,zt=null){super();this.Mu=a;this.Zqe=c;this.Uqe=h;this.Fb=v;this.U$i=B;this.xQa=X;this.$Fe=ma;this.ygc=Pa;this.qa=mb;this.Na=Tb;this.sr=rc;this.ROb=Tc;this.fG=vd;this.HOb=ee;this.Usg=Ie;this.Ld=Xe;this.Xi=Yf;this.xOa=Hh;this.Te=Fi;this.aT=wk;this.S6i=Gk;this.Ikb=Kl;this.yH=Yj;this.gSa=ao;this.Dgc=
[];this.QOa=[];this.sDe=new Yc.a(0);this.Led=new Yc.a;this.Ihd=new Zc.a(oa.a.yi());this.VCe=new Zc.a(oa.a.yi());this.Z4c=null;this.Elb=new Yc.a;this.Xfe=!1;this.Arg=null;this.a3c=new dm.a;this.I8c=this.joe=this.Uwg=!1;this.cee=new Set;this.qW=[];this.Dlb=2;this.Ova=new Yc.a(!1);this.Fnc=new dm.a;this.cde=!1;this.mic=new Map;this.bee=new SO;this.W2c=0;this.T$i=5;this.TJa=Wq=>{if(!this.Ld.hp||Wq.done)return!1;if(Wq.Xr===nn.beingCreated)return!0;if(Wq.objectId){if(this.cIl(Wq))return!1;if(!this.YNl(Wq.objectId)||
Wq.yf)return!0;for(let Ys of this.h0())if(Ys.yf===Wq.id)return!0}return!1};$r.Lw=zt;this.gbd=new Zc.a(oa.a.yi());!this.Ld.Tub&&this.Ld.hp||eG.a.pMa(Object(m.a)(this,this.F9h,"onAddedOrDeleted"));this.Ld.PTc&&(to.vTb(Object(m.a)(this,this.iOc,"onAggregateIntentRangeRendered")),oq&&oq.Mt((Wq,Ys)=>{Wq=Yh.n(this.qW,Ys.node.id);0<this.qW.length&&(!Wq||Wq===this.qW.length-1)&&(this.Dlb=1,this.qW=[])}))}get FU(){return this.Lh}get vJe(){return this.lg}get RYh(){return this.Arg||(this.Arg=Object.assign(new WQ.a,
{xba:WoncaIntl.WoncaStrings.l_InboundingCommentFailed,Woa:1}))}get QU(){return this.Fb}get wC(){return this.Mu.value}get Lc(){return this.wC.Lc}get iDa(){return this.Zqe.value}get KTa(){return this.Uqe.value}get Ma(){return this.xQa.value}get DV(){return this.qa.Ga("PresenceUserId")}get GZa(){return this.qa.Ga("PresenceProvider")}xWa(a,c,h,v){if(h&&this.vF&&(!this.vF||!this.vF.yf)){var B=!1;for(let X of h)if(3===X.type)switch(B=!0,h=Yh.m(this.qW,X.id),-1<h&&(this.qW[h].q7b=c.id),a.classList.add(lh.a.kud),
v){case 1:a.classList.add(lh.a.kZe);break;case 0:a.classList.add(lh.a.lZe)}B||a.classList.remove(lh.a.kud,lh.a.lZe,lh.a.kZe);this.xOa.tBa(3)}}iOc(a,c){a=c.paragraphNode;for(let h of c.contents)this.xWa(h.element,a,h.intents,h.DG)}a6e(a=!1){return this.$Fe.nOk(this.lg,l.AFrameworkApplication.pa.mode,c=>!this.Ld.dHb||!a||this.TJa(c))}F5e(a){return this.$Fe.UTk(this.Lh.model.h0(),l.AFrameworkApplication.pa.mode,a)}eAh(a){if(!a||!a.yf)return a;a=a.yf;for(let c=0;c<this.lg.length;c++)if(this.lg[c].id===
a)return this.lg[c];return null}Igk(){const a=[];if(this.Na.isFeatureEnabled(193)){var c=this.HOb.value;for(let h of c.mEh())(c=this.qph(h))&&a.push(c)}return a}uyl(a){if(!this.QOa)throw oo.a.invalidOperation("UpdateContent must have been called before this.");for(let c=0;c<this.QOa.length;c++)if(this.QOa[c].id===a)return c;return-1}LMh(){const a=new od.a;for(let h of this.lg)if(h.objectId&&h.rJa){var c=N.a.Ee(h.objectId);if((c=this.Lc.Ra(c))&&c.hasProperty(Yb.a.JD))if(c=c.getValue(Yb.a.JD).toString(),
a.Ja(c)){const v=a.J(c).CommentId;this.C2i(v,h,c)}else a.add(c,new yO(h.id,h.done))}this.Z4c=a}C2i(a,c,h){a!==c.rJa?(r.ULS.sendTraceTag(42866777,327,10,"Multiple comments contains the same DurableId [{0}], GuardId [{1}], GuardId of existing entry: {2}",h,c.rJa,a),this.yH.pi("CommentLoad","MultipleCommentsWithSameDurableId",{isInternal:!0},{name:"CommentExperienceDegraded",isInternal:!0})):r.ULS.sendTraceTag(554297428,327,15,"Duplicate entry of same comment with DurableId [{0}], GuardId [{1}]",h,c.rJa)}qph(a){const c=
this.Usg.value;var h=this.HOb.value;const v=h.W_b(a);if(void 0===v||null===v)return r.ULS.sendTraceTag(592234717,3003,50,"GenerateTaskItemForTaskId was called with a taskId [{0}] that has no comment anchor id.",a),null;h=h.kEh(a);try{return c.zmk(a,v.toString(),h,this.Z4c)}catch(B){return r.ULS.sendTraceTag(42856716,3003,10,"CreateTaskItemFromHistoryRecords Failed due to [{0}]",B.message),null}}ssh(a=!1,c=!1){const h=new dm.a,v=c?Yh.i():new Set;this.Ova.keys.forEach(B=>{v.has(B)||a&&this.Ova.J(B)||
h.add(B);return!0});return h}TAd(){if(!this.lg)return 0;let a=0;for(let c of this.lg)c.yf||a++;return a}FCj(a){if(a.Xr===nn.beingCreated){if(this.Lh.mode=2,this.L4a=a,this.Ma.Ca){var c=this.Ma.Ca.Fa;if(c&&c.sa){if(Gc.SelectionEditor.Cl(c)){var h=Gc.SelectionEditor.a0(c.sa,!1);h&&(this.Ma.setSelection(h),c=h)}for(h=0;h<c.length&&this.Ld.PTc;h++){var v=c.J(h).node;if(!sd.ParagraphReader.tb(v)||!(-1!==c.J(h).cpBegin&&-1!==c.J(h).cpEnd||-1!==c.J(h).Xl&&-1!==c.J(h).Tu))continue;var B=-1===c.J(h).cpBegin?
c.J(h).Xl:c.J(h).cpBegin;const X=-1===c.J(h).cpEnd?c.J(h).Tu:c.J(h).cpEnd,ma=N.a.create();this.sr.h5b(v,new vD.a(3,B,X,ma));this.qW.push(new QO(v.id,ma))}}}}else this.rXd(a);h=({index:c}=this.uZf(a)).returnValue;if(!a.yf){v=null;B=this.ssh();a.Xr!==nn.beingCreated&&(v=this.pfl(a),B.remove(a.objectId));v=({index:B}=this.R7k(v,B)).returnValue;c=-1<B?B:c;B=0;if(v)for(;c<this.lg.length&&this.lg[c].yf;)c++;if(!v&&this.Ld.hp&&a.Xr===nn.beingCreated)for(v=0;v<c;v++)this.lg[v].yf||this.lg[v].done||B++;this.Zxn(a,
B)}h&&Array.insert(this.lg,c,a)}hpa(a){super.hpa(a);this.a3c.add(a.id)}Zxn(a,c){this.Ld.hp&&a.Xr===nn.beingCreated&&a.ZA&&this.sDe.Z(a.ZA.draftId,c)}Zil(a){return this.sDe.J(a)}aqi(a){this.sDe.remove(a)}N3k(a){let c=0,h=0;for(let v=0;v<this.lg.length;v++){if(this.lg[v].id===a.id){h=v;break}this.lg[v].yf||this.lg[v].done||c++}return{returnValue:h,bDn:c}}N$e(a){var c=null,h=this.Lc.Ra(a);a=Oi.a.l8(h,this.Lc,!0);h=Oi.a.l8(h,this.Lc,!1);a&&h&&(c=ne.SelectionFactory.vd(a.Xa.paragraph,a.Xa.cp),c=ne.SelectionFactory.jC(c,
Oe.a.Sb(h.Xa.paragraph,h.Xa.cp)));a&&h||this.yH.pi("CommentLoad","ParaNodeNotConnected",{isIntentional:!1,isInternal:!0});return c}pfl(a){a=N.a.Ee(a.objectId);return this.N$e(a)}iKf(a,c){var h=this.Lc.Ra(a);if(h){var v=this.Lc.Ra(Yh.j(h));h=this.Lc.Ra(Yh.g(h));if(v===h)for(h=0;h<v.la.length&&!v.la.J(h).BIn(a,c);h++);}}R7k(a,c){let h=-1;var v=null;a||(a=this.Ma.Ca?this.Ma.Ca.Fa:null);if(!a||!a.sa)return{returnValue:null,index:h};const B=this.FAh(a.sa);if(!B)return{returnValue:null,index:h};var X=Oi.a.Z4k(B.iterator.currentNode,
a.sa.cpBegin,this.Ld.hp,c);X&&(v=this.j0(X.Oj.toString()),X=Array.indexOf(this.lg,v),v=0<=X?v:null,h=0<=X?X+1:h);v||(a=this.qsh(B,a.sa,this.Ld.hp,c),v=0<=a?this.lg[a]:null,h=0<=a?a:h);return{returnValue:v,index:h}}zVk(a=null){var c=null;c=this.Ma.Ca.Fa;return c&&c.sa?this.w0k(c.sa,this.Ld.hp,a):null}FAh(a){const c=new Kd.GraphIterator;c.set(a.node);return c.fn()?Tl.a.eq(c,c.origin):null}w0k(a,c,h=null){const v=this.FAh(a);a=this.qsh(v,a,c,h);return-1<a?this.lg[a]:null}qsh(a,c,h,v=null){let B=-1;if(a)for(c=
c.cpBegin;-1===B&&a.moveNext();)sd.ParagraphReader.eg(a.iterator)&&((c=Oi.a.Y5e(a.iterator.currentNode,c,h,v))&&(B=Array.indexOf(this.lg,this.j0(c.Oj.toString()))),c=0);return B}DQh(a){const c=a.toString();return this.Ova.Ja(c)&&this.Ova.J(c)||this.Fnc.contains(a)&&this.Lc.zqa(a)&&this.Lc.Ra(a).ia(Yb.a.J7,!1)}CAi(a,c=!1){if(a=this.ZCc(a))a.vkf=!c}Skf(a){return this.Ova.Ja(a.toString())||this.Fnc.contains(a)&&this.Lc.zqa(a)&&!this.Lc.Ra(a).ia(Yb.a.YL,null)}rXd(a){!a.objectId||a.yf||this.Ova.Ja(a.objectId)||
this.Ova.add(a.objectId,a.done)}deleteComment(a){a&&!a.yf&&(this.Ld.hp&&a.Xr!==nn.beingCreated?this.Ova.remove(a.objectId):a.Xr===nn.beingCreated&&this.ESi());this.a3c.remove(a.id);return super.deleteComment(a)}f7e(a){return a&&a.hasProperty(Yb.a.JD)?a.pg(Yb.a.JD).toString():""}ZCc(a){if(!a)return null;if(this.Ld.r$a)return this.pI(a);for(let c of this.lg){const h=this.Lc.Ra(N.a.Ee(c.objectId));if(this.f7e(h)===a.toString())return a=h.pg(Yb.a.fF),this.pI(a)}return null}yHf(a,c=!1){if(a&&Oi.a.RHd(a)&&
this.Na.isFeatureEnabled(193)){const h=this.f7e(a);if(""!==h){if(c){let v;if(this.Z4c&&({value:v}=this.Z4c.Ab(h,v)).returnValue&&v.ResolveState===a.ia(Yb.a.J7,!1))return}(a=this.Elb.J(Number.parseInvariant(h)))&&this.Ihd.add(a)}}}F9h(a,c){if(a.Mb.id.equals(this.Lc.id)){this.xOa.tBa(7);var h=a.getValue(Yb.a.fF),v=a.getValue(Yb.a.JD).toString();h=this.Ld.r$a?this.mic.has(v)?this.mic.get(v):v:h;h=this.pI(h);if(c){if(h){this.vF&&this.vF.yf===h.id&&(r.ULS.sendTraceTag(592188698,327,50,"Draft lost by parent deletion"),
this.yH.pi("CommentReplyInProgress","DraftCommentLostOnParentDelete",{isIntentional:!1,isInternal:!0},{name:"CommentDataLoss",isIntentional:!1,isInternal:!0,isSessionEndingError:!1}));c=h.yf?"The comment is a reply":"";v=Yh.j(a,N.a.nil).toString();const B=Yh.g(a,N.a.nil).toString();if(this.a3c.contains(h.id)&&!Oi.a.pJl(h.svb)){this.a3c.remove(h.id);const X=+new Date-+h.date;r.ULS.sendTraceTag(577307335,327,15,"New session comment deleted by inbound change: {0}. duration: {1}. startParaId: {2}. endParaId: {3}. {4}.",
Yh.a(h),X,v,B,c)}else r.ULS.sendTraceTag(50426379,327,50,"{0} deleted by inbound changes. startParaId: {1}. endParaId: {2}. {3}.",Yh.a(h),v,B,c);this.Lh.izc(h);this.rch(a.id)}}else if(!h){this.yH.Hvb();this.Ld.z4g?xa.a.instance.ra("WordEditor.Comments.EditorCommentManager")||r.ULS.sendTraceTag(525379405,327,10,"comment Manager resolve failed"):xa.a.instance.resolve("WordEditor.Comments.EditorCommentManager");if(this.Ld.Tub&&!this.Te.dV){this.aT.vsa("OnCommentInit",Object.assign(new CC,{qai:()=>{this.gyf(a);
this.HEb()}}));return}this.Ld.hp||this.Te.dV||this.aT.vsa("OnCommentInit");h=!1;this.Ld.wqk&&(h=this.mKm(a));h||this.gyf(a)}this.Xfe=!0}}mKm(a){const c=this.Z5e(a);let h=!1;c.m3d&&c.Pud||(this.Fnc.add(a.id),h=!0,this.x$h(a));return h}x$h(a){io.a.q_(l.AFrameworkApplication.Cb,()=>{this.gyf(a);this.Fnc.remove(a.id);this.Fnc.count||(this.HEb(),this.FU.KNn())},"DelayLoadCommentNodeIntoModel")}gyf(a){if(!this.Lh&&(r.ULS.sendTraceTag(525379406,327,10,"Comment Manager Not initialized"),this.Ld.z4g&&this.W2c<
this.T$i)){this.W2c+=1;this.x$h(a);r.ULS.sendTraceTag(525378784,327,50,`Comment Node add Retry attempt ${this.W2c}`);return}var c=this.wZb();c.qh(a);c.fB()?(c=this.wTe(c),this.Lh.addComment(c,null),2!==this.Lh.mode&&3!==this.Lh.mode&&(this.Lh.mode=1),this.yHf(a),this.him(c)):this.Dgc.push(a);this.aT.vsa("OnCommentNodeAdded",{commentNode:a})}him(a){this.Ld.hp&&!this.Te.An&&this.FU.wy&&a.yf&&this.FU.wy.id===a.yf&&this.FU.notify(String.format(Box4Intl.Box4Strings.L_CommentReplyAdded,a.author),!1)}Z5e(a){const c=
new OO;c.hXc=Yh.j(a,N.a.nil);c.DAc=Yh.g(a,N.a.nil);a=c.hXc.equals(N.a.nil);const h=c.DAc.equals(N.a.nil);a||(c.Uwa=this.Lc.Ra(c.hXc),c.m3d=!!c.Uwa&&c.Uwa.isConnected);h||(c.AHa=this.Lc.Ra(c.DAc),c.Pud=!!c.AHa&&c.AHa.isConnected);return c}Thh(a,c){const h=this.uyl(a);-1!==h&&Array.removeAt(this.QOa,h);c||((a=this.qph(a))?this.QOa.push(a):r.ULS.sendTraceTag(42870813,3003,10,"GenerateTaskItemForTaskId returned null"))}qBk(){for(let a of this.Ihd)this.Thh(a,!1);this.Ihd.clear();for(let a of this.VCe)this.Thh(a,
!0);this.VCe.clear()}HEb(a=null){this.Ld.THb&&this.LMh();this.Ld.THb&&this.qBk();this.Ld.i4j&&a&&(this.cde&&0>a.indexOf("0")&&r.ULS.sendTraceTag(558687680,327,15,"Expected Commit Ui Refresh but its missing."),this.cde=!1);this.FU.IEb(void 0,a);this.xOa.tBa(8)}Hdi(a,c,h){if(a.Mb.id.equals(this.Lc.id)){var v=a.ia(Yb.a.taskId,"");if(""===v)r.ULS.sendTraceTag(42856717,3003,10,"Newly added or deleted task node does not have a task id.");else{if(c)if(this.VCe.add(v),v=this.HOb.value.iEh(a),void 0!==v&&
null!==v)this.Elb.remove(v);else{r.ULS.sendTraceTag(591971722,3003,10,"A task without comment id was deleted even though that shouldn't be possible.");return}else if(this.Ihd.add(v),c=this.HOb.value,a=c.iEh(a),void 0!==a&&null!==a)for(this.Elb.J(a)?this.Elb.Z(a,v):this.Elb.add(a,v),a=c.kEh(v),c=0;c<a.length;c++){var B=a[c].commentId;B&&(B=Number.parseInvariant(B),this.Elb.J(B)||this.Elb.add(B,v))}else{r.ULS.sendTraceTag(591971723,3003,10,"A task without comment id was added or modified even though that shouldn't be possible.");
return}h&&this.HEb()}}}uZf(a){var c=this.lg.length,h=!1;if(a.yf){var v=(h=this.pI(a.yf))&&h.objectId?this.Lc.Ra(N.a.Ee(h.objectId)):null;v=!!v&&v.hasProperty(Yb.a.Vwa);c=Array.indexOf(this.lg,h);h=0>c;for(c+=1;c<this.lg.length&&this.lg[c].yf===a.yf&&this.lg[c]!==this.vF&&!(v&&a.date<this.lg[c].date);)c++}return{returnValue:!h,index:c}}vvl(){const a=new RO(Object(m.a)(this,this.HMn,"updateComment"),Object(m.a)(this,this.HEb,"refreshCommentsPane")),c=Eb.App.aj.Pk;c.Yd(40).Yl(Object(m.a)(a,a.z$j,"commentPropertyChanged"));
c.Yd(12).Yl(Object(m.a)(a,a.M$j,"commentTextChanged"));this.Na.isFeatureEnabled(193)&&c.Yd(72).Yl(Object(m.a)(a,a.ABn,"taskPropertyChanged"));Wo.GraphTransactionManager.instance.Usa(a,3)}HMn(a){if(Oi.a.RHd(a)){const h=this.j0(a.id.toString());if(h){var c=Kd.GraphIterator.va(a);h.text=this.Fwb(c);h.done=a.ia(Yb.a.J7,!1);this.Ld.e8a&&a.hasProperty(Yb.a.C3)&&(c=(c=a.getValue(Yb.a.C3))?z.b(c||""):null,h.usersByReactionType=c,this.w4j(h));this.KMn(a,h);h.yf||this.PMn(a,h)}}else this.Na.isFeatureEnabled(193)&&
72===a.type?this.Hdi(a,!1,!1):this.JMn(a)}w4j(a){if(a&&this.cee.has(a.id)){var c=a.usersByReactionType[1];for(let h=0;c&&h<c.length;h++)if(c[h].UserId===this.DV)return;r.ULS.sendTraceTag(542765345,327,15,`Like by current user on Comment ${a.objectId} removed by inbound changes`)}}PMn(a,c){this.t8j(c);const h=this.Ld.hp;h&&this.jsl(c)?(this.uqk(c),this.yHf(a),this.DQn(c)):h||this.yHf(a,!0)}JMn(a){let c=new Kd.GraphIterator;c.set(a);c.La(40);c.mc(40);if(c.currentNode){if(a=this.j0(c.currentNode.id.toString()))a.text=
this.Fwb(c)}else r.ULS.sendTraceTag(592738053,327,15,"UpdateComment Unexpected Node Type: "+wx.a[a.type])}DQn(a){if(!this.Te.An){var c=new va.a;this.vVi(a,c);0<c.count&&vk.b(c)}}uqk(a){const c=new Se.a(0,1,0,()=>{this.IMn(a)},137,void 0,!0);l.AFrameworkApplication.Cb.ub(c)}t8j(a){var c;null!==(c=this.vF)&&void 0!==c&&c.ZA&&this.vF.ZA.sessionType!==Cr.metadata&&(c=this.vF,a.yf||!a.done||c.yf!==a.id&&c.id!==a.id||(r.ULS.sendTraceTag(592188699,327,15,"Draft comment lost on parent resolve, DraftType: {0}",
c.Xr),this.yH.pi("CommentReplyInProgress","DraftCommentLostOnParentResolve",{isIntentional:!1,isInternal:!0},{name:"CommentDataLoss",isIntentional:!1,isInternal:!0,isSessionEndingError:!1}),c.Xr===nn.beingCreated?(this.Lh.clearSelection(),this.deleteComment(c),this.selectComment(a)):c.Xr===nn.beingEdited&&(c.Xr=nn.normal,c.OMa=HA.succeeded,this.Lh.BOe())))}KMn(a,c){if(this.Ld.r$a){if(a=a.getValue(Yb.a.JD).toString(),c.id!==a){if(!c.yf)for(var h=Array.indexOf(this.lg,c)+1;h<this.lg.length&&this.lg[h].yf===
c.id;h++)this.lg[h].yf=a;r.ULS.sendTraceTag(555044877,327,50,"durable Id updated.");c.id=a;this.mic.has(a)&&this.mic.delete(a)}}else if(a=a.getValue(Yb.a.fF),c.id!==a){if(!c.yf)for(h=Array.indexOf(this.lg,c)+1;h<this.lg.length&&this.lg[h].yf===c.id;h++)this.lg[h].yf=a;c.id=a}}jsl(a){return this.Ova.Ja(a.objectId)&&this.Ova.J(a.objectId)!==a.done}IMn(a){this.Ova.Z(a.objectId,a.done);if(a.done)if(this.FU.Zcc(a),this.Te.An)this.FU.AOc(a,!0);else{var c=new Se.a(0,1,0,()=>{this.FU.AOc(a,!0,!1);this.Led.remove(a.id)},
139);this.Led.add(a.id,c);l.AFrameworkApplication.Cb.ub(c);this.Sw&&a.id===(void 0===this.Sw.yf||null===this.Sw.yf?this.Sw.id:this.Sw.yf)&&this.FU.clearSelection()}else this.FU.Zcc(a),c=null,({value:c}=this.Led.Ab(a.id)).returnValue?(l.AFrameworkApplication.Cb.me(c),this.Led.remove(a.id)):this.FU.AOc(a,!1)}uvl(){const a=new PO(Object(m.a)(this,this.rBk,"ensureCommentsAndTasksConnected")),c=Eb.App.aj.Pk;c.Yd(39).Yl(Object(m.a)(a,a.k4g,"commentContainerPropertyChanged"));this.Na.isFeatureEnabled(193)&&
c.Yd(71).Yl(Object(m.a)(a,a.k4g,"commentContainerPropertyChanged"));Wo.GraphTransactionManager.instance.Usa(a,3)}rBk(){const a=this.wZb();for(this.Dgc.sort((c,h)=>{const v=c.ia(Yb.a.YL,null),B=h.ia(Yb.a.YL,null);if(!v&&B)return-1;if(!B&&v)return 1;c.hasProperty(Yb.a.Vwa)&&h.hasProperty(Yb.a.Vwa)?(c=c.getValue(Yb.a.Vwa),h=h.getValue(Yb.a.Vwa),h=c<h):(c=new Date(c.getValue(Yb.a.Xwc)),h=new Date(h.getValue(Yb.a.Xwc)),h=c<h);return h?-1:1});this.Dgc.length;){const c=this.Dgc[0];a.tbb(c)&&(a.qh(c),this.Lh.addComment(this.wTe(a),
null),this.Lh.mode=1);Array.removeAt(this.Dgc,0)}if(a.Za(1))for(;a.ue(1););this.Na.isFeatureEnabled(193)&&this.HOb.value.mEh();this.Xfe&&(this.HEb(),this.Xfe=!1)}j0(a){for(let c=0;c<this.lg.length;c++){const h=this.lg[c];if(h.objectId===a)return h}return null}vGj(a){if(a)for(let c of a)c&&this.gbd.add(c)}J6j(){this.gbd.clear()}fAl(){this.Te.Lyb&&r.ULS.sendTraceTag(50972491,327,15,"initializeCommentsAtBoot was called while the commenting session was already alive. [Call stack: {0}]",TQ.Debug.tVa());
this.Ld.TFc&&this.dAl();this.gAl();this.eAl()}dAl(){this.lg=[];var a=new Kh.a,c=new Yc.a(0);const h=Tl.a.zn(this.iDa),v=new Set,B=new Set;this.Na.isFeatureEnabled(138)&&this.CEj(h,c);let X=this.wZb();c=new Set;const ma=new Set,Pa=new gf.GraphTransaction(2),mb=Ve.a.ie();try{if(Pa.Lr(X),X.pp(1)){for(;h.moveNext();){if(!sd.ParagraphReader.eg(h.iterator))continue;const rc=h.iterator.currentNode,Tc=sd.ParagraphReader.xZb(rc);rc&&rc.id.equals(Nz.rpi)&&this.u4l(Tc,rc);B.add(rc.id.toString());this.Oji(Tc,
c,X,v,a,ma)}const Tb=this.IVk(v,B);0<Tb.length&&this.l4m(Tb,B,X,c);0<a.length&&this.o4m(a,v)}}finally{Pa&&Pa.dispose()}a=Ve.a.ie();this.joe&&this.S6i.aea(Object.assign(new UQ.a,{name:"GraphWalkToLoadComments",durationMs:a-mb}));0==v.size&&this.Ld.TFc&&r.ULS.sendTraceTag(589322444,327,15,"Comments not loaded in model while graph has comments");Zw.q5l(ma,c,this.Lc)}Oji(a,c,h,v,B,X){for(let ma of a)a=ma.Oj.toString(),(this.Ld.hp?!ma.Nb:ma.Nb)?c.has(a)||X.add(a):c.has(a)?r.ULS.sendTraceTag(594363285,
327,50,"[UpdateContent] Duplicate commentRangeStart with id: {0}",ma.Oj):(c.add(a),this.GCj(ma,h,v,B))}l4m(a,c,h,v){const B=this.z$k(a);this.Ld.R5h&&Zw.n4j(B);if(this.Ld.k4m){var X=new Set,ma=new Set;B.forEach(mb=>{c.has(mb.id.toString())||ma.has(mb.id.toString())||(ma.add(mb.id.toString()),mb=sd.ParagraphReader.xZb(mb),r.ULS.sendTraceTag(538056651,327,50,`Retrying loading ${mb.length} CommentRangeObjects`),this.Oji(mb,v,h,X,new Kh.a,new Set))});var Pa=[];a.forEach(mb=>{X.has(mb)||Pa.push(mb)});0<
Pa.length&&r.ULS.sendTraceTag(526729491,327,15,`Comments Failed To Load on Retry: ${Pa.join(",")}`)}else this.F5l(a)}z$k(a){const c=[];a.forEach(h=>{if(h=this.Ikb.rsh(h))h=Yh.j(h),(h=this.Lc.Ra(h))&&h.Oh&&c.push(h)});return c}gAl(){!this.Ld.Tub&&this.Ld.hp&&eG.a.pMa(Object(m.a)(this,this.F9h,"onAddedOrDeleted"));this.vvl();this.uvl()}GCj(a,c,h,v){const B=this.Lc.Ra(a.Oj);c.qh(B);40===c.Md&&B?(a=this.wTe(c),c=this.jzd(a),this.gbd.contains(c)&&(a.vkf=!0,this.gbd.remove(c)),({index:c}=this.uZf(a)).returnValue?
(Array.insert(this.lg,c,a),this.rXd(a),h.add(a.objectId),this.y0h(a),a.yf&&this.FKk(a)):v.add(a)):(r.ULS.sendTraceTag(594363295,327,15,"[UpdateContent] Iterator is not at commentNode, commentnode is null: {0}, objId null: {1}",!B,!a.Oj),39===c.Md||this.wZb())}IVk(a,c){let h=[];const v=this.Ikb.CVk();if(a.size===v.length)return h;v.forEach(B=>{!a.has(B)&&Zw.PUl(B,c,this.Ikb,this.Lc)&&h.push(B)});return h}eAl(){this.Ld.THb&&this.LMh();this.Ld.THb&&(this.QOa=this.Igk(),NO.a.pMa(Object(m.a)(this,this.Hdi,
"onTaskChanged")))}y0h(a){this.Ld.R5h&&r.ULS.sendTraceTag(539800645,327,50,`Comment added to Model. ${Yh.a(a)} `)}F5l(a){0<a.length&&(r.ULS.sendTraceTag(543745805,327,15,`Comments Failed To Load: ${a.join(",")}`),this.yH.pi("CommentLoad","CommentsPresentButFailedToLoad",{isInternal:!0},{name:"CommentExperienceDegraded",isInternal:!0}))}FKk(a){if(a.yf){var c=this.pI(a.yf);if(c&&c.yf){const h=this.pI(c.yf);h&&(h.yf?r.ULS.sendTraceTag(574763869,327,10,"Multiple chain of replies parented to other replies"):
(a.yf=c.yf,r.ULS.sendTraceTag(574763870,327,15,`Comment reply id pointing to another reply. objectid: ${a.objectId} parentObjectId: ${c.objectId}`)))}}}o4m(a,c){for(let h=0;h<a.length;h++){let v;const B=a.J(h);({index:v}=this.uZf(B)).returnValue?(Array.insert(this.lg,v,B),this.rXd(B),c.add(B.objectId),this.y0h(B)):r.ULS.sendTraceTag(37028936,327,10,String.format("Orphaned Comment add on retry failed: CommentGuardID: {0}, DurableId: {1}, ParentId: {2}",B.rJa,B.svb,B.yf))}}u4l(a,c){if(Nz.commentNode){var h=
!1;for(let v=0;v<a.length;v++)if(a[v].Oj.equals(Nz.commentNode.id)){h=!0;break}h||r.ULS.sendTraceTag(571019914,327,15,"CommentDataMissing: matching para does not have expected rangeobject. is paraNode Connected: {0}",c.isConnected)}}dIl(a,c,h){if(!Nz.commentNode||this.Uwg)return!1;var v=Nz.commentNode;const B=Yh.j(v,N.a.nil),X=Yh.g(v,N.a.nil);if(B.equals(N.a.nil)&&X.equals(N.a.nil))return!1;const ma=a.ia(Ed.a.LJ,null);if(!ma)return!1;for(let Pa=0;Pa<ma.length;Pa++){v=this.Lc.Ra(ma[Pa]);if(!sd.ParagraphReader.tb(v))continue;
const mb=v.id.equals(B),Tb=v.id.equals(X);if(mb||Tb){c=mb&&!c;h=Tb&&!h;a=a.isConnected;this.Uwg=!0;Nz.rpi=v.id;if(c||h)return r.ULS.sendTraceTag(571019915,327,15,"CommentDataMissing: Graph has commentNode with matching para in OE but OE has empty starts {0} and ends {1}. is OE Connected: {2}",c,h,a),!0;break}}return!1}CEj(a,c){a.Fl(h=>{if(11===h.Md){if(this.joe)return!0;var v=h.currentNode;const B=v.ia(ii.a.dRe,null),X=v.ia(ii.a.bRe,null);if(this.dIl(v,B,X))return r.ULS.sendTraceTag(560537753,327,
15,"OE filtering disabled for this session"),this.joe=!0;h=!!B&&0<B.length;const ma=!!X&&0<X.length;h&&B.forEach(mb=>{const Tb=this.Lc.Ra(mb);Tb&&!Yh.q(Tb)&&c.add(mb,0)});ma&&X.forEach(mb=>{c.Ja(mb)&&c.remove(mb)});(v=v.ia(Ed.a.LJ,null))&&v.forEach(mb=>{const Tb=this.Lc.Ra(mb);sd.ParagraphReader.tb(Tb)&&!this.Te.rB.Ja(mb)&&this.Te.rB.add(mb,new KE)});const Pa=c.keys;for(let mb=0;mb<Pa.length;mb++){v&&0<c.J(Pa.J(mb))&&(this.Te.c1.Ja(Pa.J(mb))||this.Te.c1.add(Pa.J(mb),new Zc.a(new xe.a)),v.forEach(rc=>
{const Tc=this.Lc.Ra(rc);sd.ParagraphReader.tb(Tc)&&(this.Te.rB.J(rc).dS||(this.Te.rB.J(rc).dS=new Zc.a(new xe.a)),this.Te.c1.J(Pa.J(mb)).add(rc),this.Te.rB.J(rc).Abb=!0,this.Te.rB.J(rc).dS.add(Pa.J(mb)))}));let Tb;c.Z(Tb=c.keys.J(mb),c.J(Tb)+1)}return h||ma}return!0},null)}wTe(a){40!==a.Md&&r.ULS.sendTraceTag(594363294,327,15,"[CreateCommentForNode] Iterator is not at commentNode");const c=a.currentNode;var h=c.getValue(Yb.a.JVb);const v=c.getValue(Yb.a.fF),B=c.getValue(Yb.a.JD).toString(),X=c.getValue(Yb.a.Xwc);
let ma=null,Pa=null;this.Na.ks(27);if(this.Ld.e8a&&c.hasProperty(Yb.a.C3)){var mb=c.getValue(Yb.a.C3);ma=mb?z.b(mb||""):null}c.hasProperty(Yb.a.Vwa)&&(Pa=c.getValue(Yb.a.Vwa));let Tb=null,rc=null;this.Na.isFeatureEnabled(30)&&c.hasProperty(Yb.a.cqd)&&c.hasProperty(Yb.a.Wwc)&&(Tb=c.getValue(Yb.a.cqd),rc=c.getValue(Yb.a.Wwc));mb=Yh.j(c,N.a.nil).toString();const Tc=Yh.g(c,N.a.nil).toString(),vd=c.ia(Yb.a.J7,!1),ee=c.ia(Yb.a.YL,null),Ie=c.ia(Yb.a.zbb,!1),Xe=this.Fwb(a);h=new zO.Comment(this.Ld.r$a?B:
v,v,h,Pa||new Date(X),this.Ld.r$a?this.bee.KZk(ee):ee,vd,Xe,zO.Comment.Lfi,Ie,rc,Tb,ma);h.KTb=mb;h.JTb=Tc;h.objectId=c.id.toString();h.svb=B;this.oNg(B,v);a.mc(39);return h}oNg(a,c){(!a||Number.parseInvariant(a)>=Oi.a.h4h)&&r.ULS.sendTraceTag(544022547,327,10,`Durable Id is invalid ${a}`);c||r.ULS.sendTraceTag(544022548,327,10,`Guard Id is invalid ${c}`);try{this.bee.CCj(a,c)}catch(h){"DuplicateDurableId"===h.message?r.ULS.sendTraceTag(544511521,327,10,`Duplicate Durable Id: ${a} with Guard Id: ${c}`):
"DuplicateGuardId"===h.message?r.ULS.sendTraceTag(544511522,327,10,`Duplicate GuardId: ${c} with Durable Id: ${a}`):r.ULS.sendTraceTag(544022549,327,10,`Unkown Error when adding to CommentIds map: ${h}`)}}Fwb(a){if(40!==a.Md)return r.ULS.sendTraceTag(594379426,327,15,"Trying to get text from node of type: {0}",a.Md),this.ygc.nYf([]);const c=a.rm.id.toString();let h=a.Md+":";const v=a.ro();0<v&&(a.Xc(),h+=a.Md+":");const B=Array(v);for(let X=0;X<v;X++){a.Xc();h+=a.Md+":";const ma=a.currentNode;ma.Gzb=
!0;B[X]=ma;ma.la||r.ULS.sendTraceTag(594363293,327,15,"[GetCommentText_Crash] "+h);!ma.la&&this.Ld.u$m&&(l.AFrameworkApplication.Bh("Microsoft.Office.Web.SessionSettings.IWacWordSendErrorReportOnCommentInboundCrashSettings"),this.fo());a.ob();a.ni();h+=X<v-1?":"+a.Md+":":":"}this.Ld.xAk&&1===B.length&&(a=sd.ParagraphReader.text(B[0]),F.a.aX(a)&&r.ULS.sendTraceTag(562135946,327,50,"Comment with ObjectId:{0} is an empty comment. Was Comment Text Null: {1}",c,!a));return this.ygc.nYf(B)}fo(){if(Yd.WoncaApp.X4d){var a=
new XQ.a(!0,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportTitle,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportDescription,WoncaIntl.WoncaStrings.l_InboundingCommentErrorReportPrivacyStatement);a.yc=1;a.Nd(1,WoncaIntl.WoncaStrings.l_SendErrorReport);a.Nd(0,WoncaIntl.WoncaStrings.l_NoThanks);a.yY(1);a.Fw(Qk.a.cTe,CommonUIStrings.l_DefaultDialogTitle,WoncaIntl.WoncaStrings.l_InboundingCommentFailed,Object(m.a)(this,this.Xtk,"dialogResponseHandler"),!1)}else this.fG.Aw(Qk.a.cTe,this.RYh)}Xtk(a){1===
a&&(Yd.WoncaApp.X4d.i8g(),this.ROb.value.Vgb(!0,"CommentInboundFailed"));this.fG.Aw(Qk.a.cTe,this.RYh)}jzd(a){if(!a||!a.objectId)return"";a=N.a.Ee(a.objectId);a=this.Lc.Ra(a);return this.f7e(a)}qal(a){return this.jzd(a.yf?this.pI(a.yf):a)}PPm(a,c){if(this.Na.isFeatureEnabled(193))if(this.Ld.removePersonalInformation)r.ULS.sendTraceTag(595128897,3003,50,"RecordTaskChanges no ops because filter PII flag on"),this.HEb();else{this.gSa.jB(Sa.a.JRf);var h=null===c||void 0===c?void 0:c.taskId,v=!h;v?this.gSa.Pm("TaskCreate",
0):this.gSa.Pm("TaskEngagement",0);try{const mb=this.HOb.value,Tb=this.jzd(a);if(""===Tb)this.tNd(v,"FailedDurableIdForComment");else{var B=this.qal(a);if(""===B)this.tNd(v,"FailedDurableIdForParentComment");else if(v&&a.ZA.sessionType!==Cr.create&&a.ZA.sessionType!==Cr.reply)r.ULS.sendTraceTag(42856725,3003,10,"Unexpected create task for drafting session type [{0}]",a.ZA.sessionType),this.gSa.pi("TaskCreate","FailedTaskCreateInvalidSessionType");else{var X=null;a.ZA.sessionType!==Cr.metadata&&(X=
Tb);var ma=this.Usg.value;var Pa=bj.a.ve(a.text)?ma.eph(X,c,v):ma.eph(X,c,v,a.text[0]);0<Pa.length?v?(mb.w9a(Number.parseInvariant(B),Pa)||this.gSa.pi("TaskCreate","TaskCreateFailed"),this.HEb()):(this.gSa.Pm("TaskEngagement",0),mb.MNj(h,Pa)||this.gSa.pi("TaskEngagement","TaskEngagementFailed")):this.tNd(v,"HistoryRecordsLengthZero")}}}catch(mb){this.tNd(v,"RecordTaskChangesFailed")}}}tNd(a,c){const h={name:"TaskExperienceDegraded",isInternal:!0};a?this.gSa.pi("TaskCreate",c,h):this.gSa.pi("TaskEngagement",
c,h)}Gkd(a,c){if(this.Ld.e8a&&a){var h=l.AFrameworkApplication.userName,v=c.toString();a.usersByReactionType||(a.usersByReactionType={});var B=a.usersByReactionType[v];h=new AO(this.DV,this.GZa,h);h.DateUtc=new Date;B?B.push(h):a.usersByReactionType[v]=[h];r.ULS.sendTraceTag(572014993,327,50,"Reaction type {0} added to {1} with Object Id: {2} ",c,a.yf?"reply":"parent",a.objectId);v=[a];this.yH.jB(ba.a.A$j,{succeeded:!0,customData:{reactionType:NE[c]}});this.VRc(v,Tx.addReaction);this.cee.add(a.id)}}WXd(a,
c){if(this.Ld.e8a&&a&&a.usersByReactionType){var h=a.usersByReactionType[c.toString()];if(h&&h.length){for(let v=0;v<h.length;v++)if(h[v].UserId===this.DV){Array.removeAt(h,v);break}r.ULS.sendTraceTag(572014994,327,50,"Reaction type {0} removed from {1} with Object Id: {2} ",c,a.yf?"reply":"parent",a.objectId);h=[a];this.yH.jB(ba.a.B$j,{succeeded:!0,customData:{reactionType:NE[c]}});this.cee.delete(a.id);this.VRc(h,Tx.removeReaction)}}}VRc(a,c){const h=this.Fb.Ob(15);h.Oa(this.iDa);this.wC.UD.D7(3);
switch(c){case Tx.deleteComment:for(c=0;c<a.length;c++){var v=a[c];if(v.Xr!==nn.beingCreated){var B=N.a.Ee(v.objectId);(B=this.Lc.Ra(B))&&Oi.a.ctd(B,this.Lc);r.ULS.sendTraceTag(39364559,327,50,`Deleting Comment: [CommentObjectId:${v.objectId}]`)}}break;case Tx.addComment:this.Lh.mode=1;a=a[0];a.date=new Date;c=this.Yjk(a);v=c.getValue(Yb.a.JD).toString();a.svb=v;this.Ld.r$a&&this.mic.set(v,a.id);v=a.text;B=this.wZb();if(a.yf){var X=this.pI(a.yf),ma=this.Lc.Ra(N.a.Ee(X.objectId));c.setValue(Yb.a.YL,
ma.getValue(Yb.a.fF));this.addReply(c,v,this.Lc,B,ma);r.ULS.sendTraceTag(39364560,327,50,`Adding Reply: [ObjectId:${a.objectId}][ParentObjectId:${X.objectId}]`)}else(X=this.Ma.Ca.Fa)&&X.sa&&(Gc.SelectionEditor.Cl(X)&&(ma=Gc.SelectionEditor.a0(X.sa,!1))&&(this.Ma.setSelection(ma),X=ma,r.ULS.sendTraceTag(592569872,327,50,"[RecordChanges] Selection extended")),sd.ParagraphReader.tb(X.sa.node)&&sd.ParagraphReader.tb(X.Pb.node)&&(this.Prb(c,v,B,X),r.ULS.sendTraceTag(39364561,327,50,`Adding Comment: [ObjectId:${a.objectId}]`)));
v=c.ia(Yb.a.fF,null);a.rJa=v;a.OMa=HA.sentToServer;a.OMa=HA.succeeded;a.objectId=c.id.toString();this.rXd(a);this.oNg(a.svb,a.rJa);this.cde=!0;break;case Tx.editComment:this.Lh.mode=1;a=a[0];c=N.a.Ee(a.objectId);c=this.Lc.Ra(c);v=a.rJa;a.rJa||(v=c.getValue(Yb.a.fF),r.ULS.sendTraceTag(554446870,327,15,`Missing GuardID for Comment with objectId ${a.objectId} while editing`),v=this.Ld.r$a?v:a.id);this.MTi(c,a.text,v);r.ULS.sendTraceTag(39364562,327,50,`Editing Comment: [CommentObjectId:${a.objectId}]`);
a.OMa=HA.sentToServer;a.OMa=HA.succeeded;break;case Tx.addReaction:case Tx.removeReaction:c=a[0];a=N.a.Ee(c.objectId);a=this.Lc.Ra(a);c=this.Ld.e8a?(c=c.usersByReactionType)?z.c(c):"":null;c&&a.setValue(Yb.a.C3,c);break;case Tx.done:case Tx.undone:for(c=0;c<a.length;c++)v=a[c],B=N.a.Ee(v.objectId),this.Lc.Ra(B).setValue(Yb.a.J7,v.done),r.ULS.sendTraceTag(594124932,327,50,`${v.done?"Resolved":"Re-opened"} Comment: [CommentObjectId:${v.objectId}]`)}this.Xi.ZD();r.ULS.sendTraceTag(572281361,327,50,"Disposing transaction, should raise context reload event");
h.dispose()}wZb(){const a=new Kd.GraphIterator;a.set(this.wC);this.KTa.oeb(a);return a}BUc(){return this.Cyi(!0)}CUc(){return this.Cyi(!1)}Cyi(a){if(!this.lg.length)return null;let c=this.Sw;do{if(c){const h=this.Ld.hp&&!this.Te.An;c=a?this.u0k(c,h):this.v0k(c,h)}else c=a?this.lg[0]:this.lg[this.lg.length-1];if(!c)return null}while(c.yf&&""!==c.yf);this.selectComment(c);return c}x8g(a,c,h,v,B){const X=this.U$i.create(1074135127);this.Ld.removePersonalInformation&&(c=CommonUIStrings.l_RemovedAuthorName,
h=null);X.setValue(Yb.a.commentId,uf.a.nE());X.setValue(Yb.a.JD,Oi.a.e7e());X.setValue(Yb.a.BHa,l.AFrameworkApplication.userSessionId);X.setValue(Yb.a.fF,a);X.setValue(Yb.a.JVb,c);X.setValue(Yb.a.y4g,c);X.setValue(Yb.a.Xwc,h?BO.a.G3e(h,"MM/dd/yyyy HH:mm:ss",BO.a.dataCulture):"");X.setValue(Yb.a.Vwa,h);X.setValue(Yb.a.J7,v);this.Ld.e8a&&B&&(a=B?z.c(B):"",X.setValue(Yb.a.C3,a));this.Na.isFeatureEnabled(30)&&(X.setValue(Yb.a.Wwc,this.DV),X.setValue(Yb.a.cqd,this.GZa));return X}Yjk(a){var c;const h=this.x8g(a.id,
a.author,a.date,a.done,null!==(c=a.usersByReactionType)&&void 0!==c?c:{});a.yf&&(this.Ld.r$a?((c=this.bee.X1k(a.yf))||r.ULS.sendTraceTag(555008772,327,10,`Missing guardId for Comment With Durable Id ${a.yf}`),a=c):a=a.yf,h.setValue(Yb.a.YL,a));return h}addReply(a,c,h,v,B){this.addComment(a,c,v);c=$r.BOg(a,h,B,!0);h=$r.BOg(a,h,B,!1);c&&Yh.t(a,c.Xa.paragraph.id);h&&(Yh.s(a,h.Xa.paragraph.id),h.Xa.paragraph.id||r.ULS.shipAssertTag(5564303,327,!1,"Comment node has no end anchor!"))}Prb(a,c,h,v){this.addComment(a,
c,h);let B,X;({start:c,end:B,startCp:h,endCp:X,eUg:ma}=this.YZj());this.Ld.lud&&ma&&(v.sa.node===c&&(h=yr.a.xab(v,!0)),v.Pb.node===B&&(X=yr.a.xab(v,!1)));if(-1===h||-1===X){this.Ld.lud&&!this.I8c&&0===this.Dlb&&(this.yH.pi("CommentThreadInProgress","DraftSelectionLost",{isInternal:!0},{name:"CommentExperienceDegraded",isInternal:!0}),this.I8c=!0);c=v.sa.node;h=yr.a.xab(v,!0);B=v.Pb.node;X=yr.a.xab(v,!1);if(2<v.length){var ma=[];for(let Pa=0;Pa<v.length;Pa++)ma.push(v.J(Pa).node.id);this.fOg(a,ma)}this.Ld.PTc&&
r.ULS.sendTraceTag(51233603,327,50,"Intents invalid reason {0}",this.Dlb)}else if(2<this.qW.length){ma=[];for(v=0;v<this.qW.length;v++)ma.push(this.qW[v].q7b);this.fOg(a,ma)}Oi.a.dTb(c,a.id,h,!0);Oi.a.dTb(B,a.id,X,!1);Yh.t(a,c.id);Yh.s(a,B.id);this.ESi();B.id||r.ULS.shipAssertTag(5564304,327,!1,"Comment node has no end anchor!")}fOg(a,c){if(!(2>=c.length||!a||Yh.q(a))){this.Te.c1.add(a.id,new Zc.a(new xe.a));for(var h=N.a.Go(c[0],c[1])?2:1,v=c.length-2;h<=v;h++){const B=c[h];this.Te.rB.Ja(B)?this.Te.rB.J(B).dS||
(this.Te.rB.J(B).dS=new Zc.a(new xe.a)):this.Te.rB.add(B,new KE(!0));this.Te.rB.J(B).Abb=!0;this.Te.rB.J(B).dS.add(a.id);this.Te.c1.J(a.id).add(B)}}}YZj(){let a=null,c=-1,h=null;var v=-1;let B=!1;if(!this.Ld.PTc||!this.qW.length||2!==this.Dlb)return{start:a,end:h,startCp:c,endCp:v,eUg:B};a=this.Lc.Ra(this.qW[0].q7b);h=1===this.qW.length?a:this.Lc.Ra(this.qW[this.qW.length-1].q7b);if(sd.ParagraphReader.tb(a)&&sd.ParagraphReader.tb(h)){v=ma=>3===ma.type;let X=this.sr.TVa(a,3,v);c=0<X.count?X.J(0).begin:
-1;a!==h&&(X=this.sr.TVa(h,3,v));v=0<X.count?X.J(0).end:-1;this.Ld.lud&&(-1===c&&null!=a&&(c=a.la.first.cp,B=!0,r.ULS.sendTraceTag(524862562,327,50,"Draft Anchor startCp was adjusted")),-1===v&&null!=h&&(v=h.la.last.cp,B=!0,r.ULS.sendTraceTag(524862563,327,50,"Draft Anchor endCp was adjusted")))}this.Dlb=-1===c||-1===v?0:2;this.Ld.lud||this.I8c||0!==this.Dlb||(this.yH.pi("CommentThreadInProgress","DraftSelectionLost",{isInternal:!0},{name:"CommentExperienceDegraded",isInternal:!0}),this.I8c=!0);return{start:a,
end:h,startCp:c,endCp:v,eUg:B}}ESi(){if(this.Ld.PTc){for(let a of this.qW){const c=this.Lc.Ra(a.q7b);sd.ParagraphReader.tb(c)&&this.sr.pZc(c,3)}this.qW=[];this.Dlb=2}}addComment(a,c,h){a.anchor||(h.Je(a,1),h.qh(a),this.DAi(a,c,h))}DAi(a,c,h){let v=0;var B=null;c=this.ygc.WDn(c,X=>{const ma=new Qs.a;h.Je(ma,1);h.qh(ma);h.Je(X,2);h.qh(X);h.ob();h.ob()});for(let X=0;X<c.length;X++)B=c[X],v=B.getValue(Yb.a.Ib),$r.paragraphEditor.s1a(B),$r.Lw&&$r.Lw.lHa&&$r.Lw.TBa(Oe.a.create(B));a.setValue(Yb.a.fF,v.toString());
return B}Z1b(a,c){return $r.wPh(a,c)}ssl(){return 0<this.qW.length}tyc(a){if(a.sa&&sd.ParagraphReader.tb(a.sa.node)&&sd.ParagraphReader.tb(a.Pb.node)){const c=this.x8g(sd.ParagraphReader.vR(a.Pb.node).toString(),l.AFrameworkApplication.userName,new Date,!1,{}),h=new $q.a;h.Nqa("\n");this.Prb(c,[h.iDc()],this.wZb(),a);return c}return null}Wr(a){return!this.$Fe.wSf(this.ZCc(a.getValue(Yb.a.JD)))}MTi(a,c,h){const v=new Kd.GraphIterator;for(v.set(a);v.Xc();)v.xf();this.DAi(a,c,v).Uh(Yb.a.Ib,Number.parseInvariant(h));
a.setValue(Yb.a.fF,h);if(c=this.j0(a.id.toString()))c.o6g=!1;a.setValue(Yb.a.zbb,!1)}LTi(a,c){this.MTi(a,[Sys.Serialization.JavaScriptSerializer.serialize(c)],a.getValue(Yb.a.fF))}BF(a){a=this.Lc.Ra(N.a.Ee(a));return!!a&&a.ia(Yb.a.BF,!1)}Phi(a){a=this.Lc.Ra(N.a.Ee(a));return!!a&&a.ia(Yb.a.Y5g,!1)}cIl(a){const c=Yh.i();return a&&c.has(a.objectId)}YNl(a){const c=this.Lc.Ra(N.a.Ee(a));return c?this.AJc(c):(r.ULS.sendTraceTag(562562755,341,15,"CommentNode is null, commentObjectId: "+a),!1)}AJc(a){var c=
a.id,h=Yh.j(a),v=Yh.g(a);if(!N.a.Go(h,v))return!1;h=a.Mb.Ra(h);if(!h)return!1;v=({rwc:a}=this.byc(h,c,!0)).returnValue;var B=({rwc:c}=this.byc(h,c,!1)).returnValue;if(-1===v||-1===B)return!1;h=h.la;v=h.J(a);B=h.J(c);if(!v.hyperlink||!v.hyperlink.aE||!B.Lk)return!1;for(a+=1;a<c;a++)if(v=h.J(a),v.hyperlink||v.Lk)return!1;return!0}Ycf(){return $r.Csl(this.lg,a=>this.BF(a),a=>this.Phi(a))}byc(a,c,h){let v;for(v=0;v<a.la.length;v++){const B=a.la.J(v);if(B.Ke)for(let X=0;X<B.Ke.length;X++){const ma=B.Ke.J(X);
if(ma.Oj.equals(c)&&ma.Nb===h)return{returnValue:B.cp,rwc:v}}}return{returnValue:-1,rwc:v}}rch(a){if(this.Te.c1.Ja(a)){const c=new va.a;for(let h of this.Te.c1.J(a))this.EVm(h,a,c);this.Te.c1.remove(a);vk.b(c)}}vVi(a,c){if(a.objectId){a=N.a.Ee(a.objectId);var h=this.Lc.Ra(a);if(h){var v=Yh.j(h,N.a.nil);h=Yh.g(h,N.a.nil);v.equals(N.a.nil)||c.add(this.Lc.Ra(v));h.equals(N.a.nil)||c.add(this.Lc.Ra(h));if(this.Te.c1.Ja(a))for(let B of this.Te.c1.J(a))c.add(this.Lc.Ra(B))}}}EVm(a,c,h){let v;({value:v}=
this.Te.rB.Ab(a,v));v&&(v.dS.remove(c),v.dS.count||(v.Abb=!1,h.add(this.Lc.Ra(a))))}static get paragraphEditor(){return $r.kh||($r.kh=xa.a.instance.resolve("Box4.IParagraphEditor"))}static getInstance(){return $r.wk()}static wk(){if($r._instance)return $r._instance;const a=new qf.a(()=>(new IA(!0,!0,!0)).Jgk()),c=xa.a.instance;$r._instance=new $r(new qf.a(()=>Eb.App.oa.Da.Zb),new qf.a(()=>Eb.App.oa.Da.Jb.sc),new qf.a(()=>YH.a.instance),new Fk.a,new MO,new qf.a(()=>$c.a.instance),c.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),
c.resolve("WordEditor.Comments.ICommentFormatTranslator"),c.resolve("Common.IAppSettingsManager"),c.resolve("Box4.IFeatureHelper"),c.resolve("Box4.Intent.IIntentRangeEditor"),new qf.a(()=>Eb.App.QY),c.resolve("Box4.IKickoutExecutor"),c.te("WordEditor.Tasks.ITaskActor"),a,c.resolve("WordEditor.Comments.CommentsSettings"),c.resolve("Box4.IUndoManager"),c.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),c.resolve("WordEditor.Comments.CommentsState"),c.resolve("WordEditor.Comments.WordCommentEventsActor"),
c.resolve("Common.SharedCommentsTelemetryRecorder<Common.CommentActivityData>"),c.resolve("WordEditor.Comments.CommentNodeTracker"),c.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),c.resolve("WordEditor.Comments.ITasksUsageAndHealthLogger"),Eb.App.aj.Pk.Yd(12),c.resolve("Box4.ParagraphRenderEvents"),c.resolve("Box4.CatchUpActivity.IChangeIdEditor"));return $r._instance}static BOg(a,c,h,v){c=Oi.a.l8(h,c,v);if(!c)return null;c=c.Xa.Ke;return Oi.a.Fkd(a.id,c,c.J(0).Rt,v)}static wPh(a,c){if(Eb.App.lostSession||
(c?!Eb.App.Wr:!Eb.App.Wr&&!Eb.App.Bn)||1===a.mode||!Object(Ub.a)(rH.PageView,ec.InteractiveViewManager.instance.rc))return!1;a=ec.InteractiveViewManager.instance.rc.Ma.If;return!a||li.a.instance.Kba(a)||a.contextId===ic.a.anchoredObject?!1:!0}static Csl(a,c,h){const v=new va.a,B=new va.a,X=new od.a,ma=new od.a;for(let Tb of a){var Pa=Tb.id,mb=Tb.objectId;a=Tb.done;const rc=!!mb&&c(mb);Pa&&(a&&v.add(Pa),rc&&B.add(Pa),mb&&X.Z(Pa,mb));if(Pa=Tb.yf)({value:mb}=ma.Ab(Pa,0)).returnValue||(mb=0),ma.Z(Pa,
mb+1);if(!Pa&&!a&&!rc)return!0}for(let Tb of B){if(v.contains(Tb))continue;let rc;if(({value:rc}=X.Ab(Tb,rc)).returnValue&&h(rc))return!0;let Tc;if(({value:Tc}=ma.Ab(Tb,0)).returnValue&&0<Tc)return!0}return!1}}$r._instance=null;$r.kh=null;$r.Lw=null;Object(w.a)($r,"EditorCommentModel",xO.a,[414,415,416]);b(1276);class BD{constructor(a,c){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;
this.canvasActionId=a;this.canvasContextId=c}}Object(w.a)(BD,"CommentUIAction",null,[]);class iI{constructor(a,c,h,v){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=a;this.body=c;this.confirmButton=h;this.cancelButton=v}}Object(w.a)(iI,"ViewContainerModalDialogStrings",null,[]);class TO{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie,Xe){this.ga=a;this.Se=c;this.jd=h;this.fb=v;this.Dn=B;this.xg=X;this.EN=ma;this.wma=Pa;this.Ajd=mb;this.AFe=Tb;this.Ta=rc;this.lN=Tc;this.Ld=
vd;this.Te=ee;this.Jkb=Ie;this.aT=Xe;this.aee=this.Lh=null;this.pFg=this.d9f=!1;this.Bpc=null;this.Eec=this.Bfk()}get isVisible(){return this.Te.An}get O7a(){return this.d9f}set O7a(a){this.d9f=a}get Oln(){return"SharedCommentsTaskPaneProps"}get BPc(){return null}get s7h(){return null}get lR(){return this.Dn}get F9(){return null}get o$j(){return this.wma}get hp(){try{return this.Ld.hp}catch(a){return!1}}Vxh(){return new eI(l.AFrameworkApplication.isRtl,Sys.CultureInfo.CurrentCulture.name,l.AFrameworkApplication.uiCulture,
l.AFrameworkApplication.dataCulture)}Bfk(){const a=new gd.a,c=new BD(Sa.a.newComment,Kc.a.frame);c.preCallback=Object(m.a)(this,this.DBj,"addActionPreCallback");const h=new BD(ba.a.Tvf,Kc.a.frame),v=new BD(ba.a.VEf,Kc.a.frame),B=new BD(ba.a.deleteComment,Kc.a.frame);B.preCallback=Object(m.a)(this,this.Hqk,"deleteActionPreCallback");B.postCallback=Object(m.a)(this,this.Ouk,"disableOnClosePaneOrNoSelection");this.hp&&(h.preCallback=Object(m.a)(this,this.rMh,"initCommentSessionPreCallback"),v.preCallback=
Object(m.a)(this,this.rMh,"initCommentSessionPreCallback"));const X=new BD(Sa.a.QV,Kc.a.frame);X.preCallback=Object(m.a)(this,this.prn,"showHideActionPreCallback");a.Z(6,X);a.Z(0,c);a.Z(1,h);a.Z(2,v);a.Z(3,B);return a}prn(a,c,h){return 2!==h||this.Te.dV?1===h?32:2:(this.aT.vsa("OnCommentInit",Object.assign(new CC,{CAa:()=>{this.ga.processAction(Sa.a.QV,2)}})),32)}rMh(a,c,h){return 1!==h||this.Te.dV?2:8}DBj(a,c,h){if(1===h)return!this.Z1b()||this.O7a?8:this.Te.dV?2:32;if(!this.Te.dV)return this.O7a=
!0,this.aT.vsa("OnCommentInit",Object.assign(new CC,{CAa:()=>{this.hp||this.Te.An||this.ga.processAction(Sa.a.QV,2)}})),32;this.hp||this.Te.An||this.ga.processAction(Sa.a.QV,2);(this.hp||this.Te.An)&&this.fb.Kf(this.Te.An?Fc.AFrame.aq:Fc.AFrame.WJ);return 2}Hqk(a,c,h){return 1===h&&ya.SessionStatusManager.instance.gi?8:2}Ouk(a,c,h,v){return 1!==v||(this.hp||this.isVisible)&&this.Lh.model.pr?a||this.Lh.model.pr?32:8:8}GEi(a){this.pFg||(this.fxj=this.HBd(),this.EN.OHa(),this.cln(),this.Zkn(a),this.pFg=
!0)}Zkn(a){this.Lh=a;this.aee=a.N0b;this.Lh.Xih=this.wma}initialize(a){this.GEi(a);this.eb()}Nff(){this.Bpc&&this.fb.Kf(Fc.AFrame.aq);this.O7a&&!this.hp?(this.ga.processAction(Sa.a.newComment,2),this.O7a=!1):this.Te.$8a&&io.a.q_(l.AFrameworkApplication.Cb,()=>{const a=this.Te.$8a.commentId,c=this.Te.$8a.kKc;this.ga.hb(ba.a.selectComment,2,Object.assign(new rw.a,{commentId:a,V9:1,JV:!0,JIc:c}));c&&(io.a.q_(l.AFrameworkApplication.Cb,()=>{this.fb.Kf(Fc.AFrame.aq)},sw.a.PPf),Cj.a.instance.Xe(lg.a.ibh,
(new Date).getTime()));r.ULS.sendTraceTag(35149083,327,50,"Comment selected in shared comment pane after boot: {0}",(new Date).getTime()-l.AFrameworkApplication.nU);this.Te.$8a=null},sw.a.e9m)}dispose(){}t1(){}selectComment(){this.isVisible||this.hp||this.WHi();this.xg.updateCommandUI(!0)}eb(){this.ga.ka(Sa.a.Gbb,Kc.a.frame,Object(m.a)(this,this.Gbb,"hideCommentPane"));this.ga.Aa(Sa.a.uEb,Kc.a.frame,Object(m.a)(this,this.uEb,"queryToggleCommentPane"),96)}OYa(){-1!==this.Lh.mode&&(this.Lh.mode||this.Rgh())}Rgh(){const a=
this.Lh,c=a.SJ,h=c.TAd(),v=c.a6e(this.Ld.dHb&&this.Ld.hp&&!this.Te.An);this.wma.o$m(v.length,h,!a.mode,h?5:1);this.wma.J$m(v,c.QOa)}cln(){const a=this.fb.fd(Fc.AFrame.aq);a.parent=Fc.AFrame.uo;a.rK=!0;a.mMf=!0;a.ldc=!0;a.Qrb((c,h)=>{IE.a.f_g(h.name)||(this.Te.HCb=io.a.q_(this.Ta,()=>{h.name!==Fc.AFrame.WJ&&2!==this.Lh.mode&&3!==this.Lh.mode&&(this.Lh.clearSelection(),this.xg.updateCommandUI(!0));this.Te.HCb=null},sw.a.Ylm))});this.Dn.KQ(Fc.AFrame.aq);if(this.Ld.Asb)for(let c of Yh.r)a.bindAction(qc.KeyInputManager.VD(c),
ba.a.NNe)}$dn(){this.Bpc&&this.AFe.gMk()}Z0g(){this.Bej&&this.$dn()}imm(a,c,h,v){const B=this.Lh,X=B.SJ.vF;X&&X.ZA?B.RQe.endCommentSession(X.ZA.draftId):r.ULS.sendTraceTag(40130755,327,10,"Attempting to discard when there is no active draft!");this.Gbb(a,c,h,v,!0);io.a.q_(this.Ta,()=>{this.xg.updateCommandUI(!0)},sw.a.i5m)}ilm(){this.Bpc&&this.fb.Kf(Fc.AFrame.aq);this.xg.updateCommandUI(!0)}sBa(a){a.Bp(this.fb.BN);a.Bp(this.fb.DN)}OGb(a,c,h){if(1===h)return 32;this.WHi();return 32}WHi(){this.isVisible||
(this.Te.dV?(this.Fvk(),this.Te.An=!0,this.aT.XWd(),this.fb.Atc(Fc.AFrame.aq),this.hp&&this.Ld.dHb&&this.Lh.IEb(this.Lh.model.F5e(()=>!0)),this.Bej=!0,Hi.UISurfaces.Ms().then(a=>{a.showTaskPane(fG.a.gqd,this.fxj);return null}).catch(()=>{r.ULS.sendTraceTag(559273377,327,10,"Error showing comment task pane.")}),this.Lh.m6b(null),this.xg.updateCommandUI(!0),this.sBa(this.fb.fd(Fc.AFrame.aq)),this.aT.vsa("OnCommentPaneOpen"),r.ULS.sendTraceTag(37007903,327,50,"New Comment Pane opened.")):this.aT.vsa("OnCommentInit",
Object.assign(new CC,{CAa:()=>{this.Te.An||this.ga.processAction(Sa.a.QV,2)}})))}Fvk(){this.ga.hb(ba.a.Vba,2,null);this.ga.hb(ba.a.jX,2,null)}Z1b(){return $r.wPh(this.ga,!1)}Prb(){}show(){this.isVisible||this.ga.processAction(Sa.a.QV,2)}editComment(){return 2}Gbb(a,c,h,v,B){if(1===h||!this.Te.An)return 32;if(!this.hp&&2===h&&(2===this.Lh.mode||3===this.Lh.mode))return B=new iI(CommentPaneStrings.DiscardDialogTitle,CommentPaneStrings.DiscardDialogBody,CommentPaneStrings.DiscardDialogAbandon,CommentPaneStrings.DiscardDialogResume),
this.Ajd.invokeModalConfirmationDialog(()=>{this.imm(a,c,h,v)},()=>{this.ilm()},B),32;this.gFd();if(this.hp)return 32;B&&this.Rgh();return 32}gFd(){this.Lh.paneClosing();this.Te.An=!1;if(this.hp&&this.Ld.dHb){const c=this.Lh.model;this.Lh.IEb(c.F5e(h=>c.TJa(h)))}var a=nc.FocusManager.instance();a.nf&&a.nf.name===Fc.AFrame.aq&&a.Kf(this.hp&&(2===this.Lh.mode||3===this.Lh.mode||this.Lh.wn.pr)?Fc.AFrame.WJ:a.$Q);this.Dn.Bv(Fc.AFrame.aq);this.fb.Yyc(Fc.AFrame.aq);Hi.UISurfaces.Ms().then(c=>{c.hideTaskPane(fG.a.gqd,
2);return null}).catch(()=>{r.ULS.sendTraceTag(559273378,327,10,"Error hiding Comment Pane.")});this.hp&&(a=this.Lh.model.pr)&&this.SMn(a);this.aT.vsa("OnCommentPaneClose");r.ULS.sendTraceTag(572281360,327,50,"New Comment Pane closed.")}SMn(a){a.done?this.Lh.clearSelection():this.Jkb.Tgh(a)}ytm(a=null){this.AFe.ZDi(3);this.Nff();if(a){this.Z0g();Ld.a.dJf(a,[Jb.a.contextMenu]);const c=this.fb.fd(Fc.AFrame.aq);this.Se.Lrb(Fc.AFrame.aq,a,c.ldc)}}prm(a){this.Dn.YB(Fc.AFrame.aq);1!==a&&io.a.q_(l.AFrameworkApplication.Cb,
()=>{this.fb.rA(Fc.AFrame.aq)},sw.a.PPf)}onTaskPaneClose(){this.Te.dV&&this.AFe.ZDi(1)}HBd(){const a={type:this.Oln,q7n:this.Z0g};return Object.assign(new qn.a,{title:WordEditorIntl.WordEditorStrings.L_Comments,contentProps:a,hideHeader:!1,width:300,location:2,onOpen:c=>{this.Bpc=c;this.ytm(c);this.lN.yYf(!0)},onClose:()=>{this.Bpc=null;this.ga.hb(Sa.a.Gbb,2,!0);this.xg.updateCommandUI(!0);this.onTaskPaneClose();this.lN.yYf(!1)},onShow:c=>{this.prm(c)}})}QV(){return 32}uEb(a,c,h,v,B){if(1===h)return 32;
B[Uf.a.On]=this.isVisible;return 32}}Object(w.a)(TO,"OfficeSharedCommentPane",null,[14,411,412]);class UO{constructor(a,c){this.containerType="full-pane";this.identifier=null;this.ga=a;this.identifier=c}openView(){this.ga.processAction(Sa.a.OGb,2)}closeView(){this.ga.hb(Sa.a.Gbb,2,!0)}invokeModalConfirmationDialog(a,c,h){const v=new oe.StandardDialog;h&&h.title&&h.body&&h.confirmButton&&h.cancelButton||(r.ULS.sendTraceTag(35678229,327,10,"InvokeModalConfirmationDialog: No localized strings provided."),
h=new iI("","","",""));v.yc=1;v.Nd(1,h.confirmButton);v.Nd(0,h.cancelButton);v.mv(h.title,h.body,1,B=>{1===B?a():c()})}}Object(w.a)(UO,"ViewContainerAPI",null,[409,410]);class VO{constructor(a,c,h){this.pFn=a;this.Zu=c;this.CCa=h;this.Bd=new Rd.a;this.pFn.execute(v=>{this.CCa.GXd("OnBeforeTrackChangeMarkupViewChange",(B,X)=>{X&&X.Jvf!==v.Di&&this.Bd.raiseEvent("OnBeforeTrackChangeMarkupViewChange",X)});this.CCa.GXd("OnAfterTrackChangeMarkupViewChangeEventKey",(B,X)=>{X&&X.Di===v.Di&&(uO.a.Di=v.Di,
this.Bd.raiseEvent("OnAfterTrackChangeMarkupViewChange",X))})})}dgb(a,c){this.Bd.addHandler(a,c)}vsa(a,c){this.Bd.raiseEvent(a,c)}XWd(){this.Zu.MHf||(this.Zu.MHf=!0,this.Bd.raiseEvent("OnCommentRenderedOnce"))}}Object(w.a)(VO,"WordCommentEventsActor",null,[]);class jI{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(w.a)(jI,"InitCommentSessionResult",null,[]);class WO extends jI{constructor(){super();this.updatedDraftSessionConfiguration=
null}}Object(w.a)(WO,"BeginDraftingHostResult",jI,[]);class XO{constructor(a,c,h,v,B,X,ma,Pa,mb,Tb,rc,Tc,vd,ee,Ie){this.taskManager=a;this.wma=c;this.G6i=h;this.oGn=v;this.YQe=B;this.Wx=X;this.Yq=ma;this.wf=Pa;this.j$=mb;this.Eb=Tb;this.hj=rc;this.D3=Tc;this.Zu=vd;this.w$j=ee;this.v$j=Ie;this.SPb=this.O2=this.Tl=null;this.Z$i="WordWebCommitNewCommentActivity";this.$$i="WordWebCommitTaskActivity";this.W$i="WordWebCommentReactionActivity";this.dee=null;this.TIg=0;this.Cye=null}get O3a(){return this.O2}PDm(a){var c;
const h=this.O3a.vF,v=this.O2.h0();if(v&&h){const B=AD.a.G$a(null!==(c=h.authorId)&&void 0!==c?c:"");c=new DC(h.authorId,h.pUb,h.author,null!==B&&void 0!==B?B:"",!0);a.author=c;a.insertIndex=Array.indexOf(v,h);a.authorName=h.author;a.authorIdentity="";return null}return io.a.VA(-2130915320)}initialize(a,c,h,v){this.Tl=a;this.O2=c;this.SPb=h;this.dee=v}beginDraftingAsync(a){if(!a)return new Promise((v,B)=>{B(io.a.VA(-2130915327))});const c=new WO,h=Cr.q8e(a.sessionType);return void 0===h||null===h?
new Promise((v,B)=>{B(io.a.VA(-2130915317))}):new Promise((v,B)=>{io.a.q_(this.taskManager,()=>{if(1!==this.Tl.mode)r.ULS.sendTraceTag(40130753,327,10,"Create InitCommentSession Failed. CommentingMode={0}",this.Tl.mode),B(io.a.VA(-2130915325));else{this.B0g();try{switch(h){case 0:if(!this.Tl.F9.Z1b()){B(io.a.VA(-2130915326));return}this.Wx.vPd&&this.w$j.ydf();r.ULS.sendTraceTag(553710798,327,50,`Creating comment for ${a.draftId}`);this.Tl.Prb(a);break;case 1:if(!a.threadId||""===a.threadId){B(io.a.VA(-2130915324));
return}if(this.Wx.hUf){let Pa=this.O2.pI(a.threadId);if(Pa){const mb=this.O2.nsh(Pa,!1),Tb=xE.Fwb(Pa,mb,Pa.authorId===this.Wx.DV);Tb&&this.YQe.invoke(a.threadId,Tb)}else r.ULS.sendTraceTag(579170962,327,10,"Smart reply provider not invoked since comment is null",this.Tl.mode)}this.Tl.addReply(a.threadId,a);break;case 3:if(!a.threadId||""===a.threadId){B(io.a.VA(-2130915324));return}var X=this.O2.pI(a.threadId);if(!X){B(io.a.VA(-2130915323));return}this.Tl.editComment(X,a);break;case 2:if(!a.commentId||
""===a.commentId){B(io.a.VA(-2130915324));return}let ma=this.O2.pI(a.commentId);if(!ma){B(io.a.VA(-2130915323));return}this.Tl.editComment(ma,a)}}catch(ma){B(ma);this.eui();r.ULS.sendTraceTag(553677466,327,10,`Drafting Exception ${ma} on Session ${h}`);return}(X=this.PDm(c))?B(X):v(c);this.eui()}},sw.a.beginDraftingAsync)})}commit(a,c,h){const v=this.O3a.vF;if(!v)throw io.a.VA(-2130915320);var B=v.ZA;if(!B)throw io.a.VA(-2130915320);const X=Cr.q8e(B.sessionType);if(void 0===X||null===X)throw io.a.VA(-2130915317);
if(a!==B.draftId)throw io.a.VA(-2130915327);let ma=!1,Pa=!1;B=!1;switch(X){case 3:if(!h)throw io.a.VA(-2130915327);break;case 0:this.hj.$c(()=>{if(!this.Tl.F9.Z1b())throw io.a.VA(-2130915326);v.text=[c];this.Tl.ay&&!this.Zu.An?this.Tl.bAm(()=>{this.Tl.hpa(v);this.Tl.cAk(a,v.id)}):this.Tl.hpa(v);Pa=h&&null!=h.Task;ma=this.Tl.ay;io.a.q_(this.taskManager,()=>{this.Mgb(v.id)},sw.a.Mgb)},"WESCA:C:C");break;case 1:this.hj.$c(()=>{v.text=[c];this.Tl.hpa(v);Pa=h&&null!=h.Task;ma=this.Tl.ay},"WESCA:C:R");
break;case 2:this.hj.$c(()=>{v.text=[c];this.Tl.b9a(v);this.Sji(ba.a.O2l)},"WESCA:C:E");break;default:throw io.a.VA(-2130915322);}h&&(h.Resolve&&(this.EAi(v,h.Resolve.isResolved),h.Resolve.isResolved&&!this.Zu.An&&(this.Tl.notify(Box4Intl.Box4Strings.L_CommentResolved,!0),this.Wx.Cim&&(this.TIg++,3===this.TIg&&(r.ULS.sendTraceTag(590424158,327,50,"Resolve callout shown"),this.uim())))),h.Task&&this.Tl.$$j(v,h.Task),h.Reaction&&(B=this.Wx.C$j,h.Reaction.isActive?this.Tl.Gkd(v,h.Reaction.reactionType):
this.Tl.WXd(v,h.Reaction.reactionType)));this.Wx.R$j&&Pa&&this.j$.execute(mb=>mb.logActivity(this.$$i,"CommentsTasksFpsIsEnabled"));ma&&this.j$.execute(mb=>{mb.logActivity(this.Z$i,"CommentsFpsIsEnabled")});B&&this.j$.execute(mb=>{mb.logActivity(this.W$i,"CommentReactionsFpsIsEnabled")});return v.id}uim(){Hi.UISurfaces.dK().then(a=>{var c=Object.assign(new eo.a,{target:'[data-unique-id~="ShowCommentsTopBar"]',showCloseIcon:!0,title:WordEditorIntl.WordEditorStrings.L_ResolvedCommentsAndTasksLocationCalloutTitle,
content:WordEditorIntl.WordEditorStrings.L_ResolvedCommentsAndTasksLocationCalloutContent,useTeachingStyles:!0,preventLightDismiss:!0,calloutProps:Object.assign(new Mb.a,{directionalHint:6,gapSpace:4,isBeakVisible:!0})});c=a.callout(c);const h=Object.assign(new hc.a,{expirationOptions:Object.assign(new Hc.a,{displayTimeoutSeconds:10,onExpire:Object(m.a)(this,this.yvk,"dismissResolvedCommentsLocationNotification")})});this.Cye=a.addNotification(c,h)})}yvk(){Hi.UISurfaces.dK().then(a=>{a.removeNotification(this.Cye);
return this.Cye=null})}endCommentSession(a){const c=this.O3a.vF;if(c){if(c.ZA&&c.ZA.draftId!==a)throw io.a.VA(-2130915327);if(c.Xr===nn.beingCreated)this.Tl.deleteComment(c),!this.Tl.ay||c.yf||this.Zu.An||this.wf.Kf(Fc.AFrame.Mp);else{if(3!==this.Tl.mode){r.ULS.sendTraceTag(33621450,327,50,"CommentingMode != EditingComment at the time of ending a comment session");return}c.Xr=nn.normal;c.OMa=HA.succeeded;c.ZA=null;this.Tl.BOe()}}this.Yq&&this.Yq.updateCommandUI(!0);this.O3a.TAd()||this.wma.q0f(1,
!this.Tl.mode)}deleteComment(a){(a=this.O2.pI(a))?(this.Tl.deleteComment(a),this.Tl.ay&&!this.Zu.An?a.yf||this.wf.Kf(Fc.AFrame.Mp):this.wf.rA(Fc.AFrame.aq),this.oGn.wSf(a)&&this.Sji(ba.a.G0h)):r.ULS.sendTraceTag(594600902,327,15,"Comment to delete is not in the model.")}selectComment(a){this.Mgb(a,0)}highlightComment(a){this.Tl.m6b(a,0)}setThreadResolvedState(a,c){(a=this.O2.pI(a))&&this.EAi(a,c)}EAi(a,c){if(a.yf&&""!==a.yf)throw io.a.VA(-2130915321);this.Tl.htb(a,c);c&&!this.Zu.An&&this.wf.Kf(Fc.AFrame.Mp)}presentLinkToComment(a){var c=
this.O2.pI(a);c?(c=this.O3a.jzd(c))?(a={["nav"]:btoa(`{"${NF.a.comment}":${c}}`),["mode"]:"copy"},this.v$j.jB(ba.a.presentLinkToComment),this.Eb.hb(Sa.a.M$a,2,a)):r.ULS.sendTraceTag(578058146,327,10,"[LinkToComment] Invalid durableCommentId for commentId: {0}",a):r.ULS.sendTraceTag(578401558,327,10,"[LinkToComment] Comment not found for Id {0}",a)}selectFirstThreadInNextCommentContext(){this.Tl.Byi(0)}selectLastThreadInPreviousCommentContext(){this.Tl.o9m()}registerForCommentEvents(a){const c=this.O3a.a6e(this.Wx.dHb&&
this.Wx.hp&&!this.Zu.An),h=this.O3a.QOa,v=this.O3a.TAd(),B=!this.Tl.mode;this.wma.gin(this.dee.Jdl());this.dee.o7k().then(X=>{this.wma.OSm(a,c,v,B,h,X);this.wma.q0f(v?5:1,B);this.Yq&&this.Yq.updateCommandUI(!0)})}unregisterForCommentEvents(a){this.wma.qZc(a)}registerForAction(a,c){this.G6i.oMa(a,c)}unregisterForAction(){}checkAtMentionCapability(){return this.SPb?this.SPb.atMentionsEnabledAsync():(r.ULS.sendTraceTag(36475799,327,10,"AtMentionEnabled called before initialization."),new Promise(a=>
{a(!1)}))}resolveSupported(){return!0}loadThreads(){r.ULS.sendTraceTag(40130754,327,10,"LoadThreads incorrectly called on unsupported platform.")}B0g(){const a=this.Tl.ay&&!this.Zu.An?Fc.AFrame.WJ:Fc.AFrame.aq;if(a===Fc.AFrame.aq){if(!this.Zu.An)return;Hi.UISurfaces.Ms().then(c=>{c.setSelectedTaskPane(fG.a.gqd);return null})}this.wf.rA(a)}Mgb(a,c=1){this.B0g();this.D3.vyi(a,Object.assign(new rw.a,{V9:c,JV:1===c}))}eui(){this.Tl.F9.O7a&&(this.Tl.F9.O7a=!1)}Sji(a){this.Eb.processAction(a,2)}}Object(w.a)(XO,
"WordEditorSharedCommentAPI",null,[407,408]);class kI{constructor(a,c,h,v,B,X,ma=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=null;this.commentId=a;this.parentId=c;this.commentBody=h;this.author=v;this.date=B;this.commentFlags=X;this.usersByReactionType=ma}}Object(w.a)(kI,"OfficeSharedCommentModel",null,[]);class YO{constructor(a,c,h){this.qa=a;this.Ld=c;this.zLc=h;this.QMg="AD";this.Bgc=new Yc.a;this.mFe=new Yc.a;this.ERj=
RegExp("(.*?)\\s*(\\[\\d+\\])$");this.Hcg=new dm.a}get nXi(){return this.qa.Ga("UserPrincipalName")}get GZa(){return this.qa.Ga("PresenceProvider")}get DV(){return this.qa.Ga("PresenceUserId")}get jh(){return this.zLc.value}i8h(a){const c=this.ERj.exec(a);return c?c[1]:a}LCh(a,c=!1){let h=0;a.done&&(h=a.yf&&""!==a.yf?h|4:h|8);a.o6g&&(h|=2);c&&(h|=1);this.Ld.dZd&&this.wSf(a)&&(h|=16);a.vkf&&(h|=32);this.ptl(a)||(h|=128);return h}ptl(a){return a?(a=this.jh.Ra(a.objectId))?a.hasProperty(Yb.a.C3):!1:
!1}wSf(a){if(!a)return!1;if(void 0===a.authorId||null===a.authorId||""===a.authorId)return this.dqf(a.id,a.objectId,"Comment AuthorId null or empty"),!1;if(void 0===this.DV||null===this.DV||""===this.DV)return this.dqf(a.id,a.objectId,"PresenceUserId null or empty"),!1;if(this.DV==a.authorId&&a.pUb==this.GZa)return!1;const c=this.Xvd(a.authorId),h=this.Xvd(this.DV);if(this.GZa===this.QMg&&c&&h&&c[0]!=this.nXi&&c[1]!=h[1])return!0;this.dqf(a.id,a.objectId,"Unknown");return!1}isCurrentUser(a){if(!a||
void 0===a.authorId||null===a.authorId||""===a.authorId||void 0===this.DV||null===this.DV||""===this.DV)return!1;if(this.DV==a.authorId&&a.pUb==this.GZa)return!0;a=this.Xvd(a.authorId);const c=this.Xvd(this.DV);return this.GZa===this.QMg&&a&&c?a[0]==this.nXi||a[1]==c[1]:!1}Xvd(a){if(void 0===a||null===a)return null;a=a.split("::");return 3===a.length?a.slice(1,3):null}dqf(a,c,h){a&&!this.Hcg.contains(a)&&(r.ULS.sendTraceTag(42824129,327,50,`No edit restriction for commentObjectId: ${c}; reason: ${h}`),
this.Hcg.add(a))}Eoh(a,c){var h;if(!a)return null;const v=a.YJd;let B=!1;1===c&&(B=!0);c=a.author?this.i8h(a.author):"";const X=AD.a.G$a(null!==(h=a.authorId)&&void 0!==h?h:"");h=new DC(this.Ld.dZd&&a.authorId?a.authorId:"",a.pUb,c,null!==X&&void 0!==X?X:"",this.isCurrentUser(a));return new kI(a.id?a.id:"",a.yf?a.yf:"",a.text&&a.text.length?a.text[0]:null,h,a.date||v?a.date:new Date,this.LCh(a,B),this.NCh(a.usersByReactionType))}nOk(a,c,h){const v=[],B=new Yc.a;if(!a)return this.Ld.dZd?v:null;for(let X of a)X.Xr!==
nn.beingCreated&&h(X)&&(X.id&&this.Bgc.Ja(X.id)?(a=this.Bgc.J(X.id),a=this.Ljk(X,a,c),v.push(a),B.Z(X.id,a)):X.id?(a=this.Eoh(X,c),v.push(a),B.Z(X.id,a)):r.ULS.sendTraceTag(50667679,327,10,"CommentId should not be null"));this.Bgc=B;return v}UTk(a,c,h){const v=[];for(let B of a)B.Xr!==nn.beingCreated&&h(B)&&(B.id&&this.Bgc.Ja(B.id)?v.push(this.Bgc.J(B.id)):B.id&&v.push(this.Eoh(B,c)));return v}Ljk(a,c,h){var v=a.YJd,B=1===h;h=a.yf?a.yf:"";const X=a.text&&a.text.length?a.text[0]:null,ma=a.author?this.i8h(a.author):
"",Pa=this.Ld.dZd&&a.authorId?a.authorId:"",mb=a.pUb?a.pUb:"",Tb=AD.a.G$a(Pa);v=a.date||v?a.date:new Date;B=this.LCh(a,B);const rc=this.isCurrentUser(a),Tc=this.NCh(a.usersByReactionType);return c.parentId===h&&c.commentBody===X&&c.author.DisplayName===ma&&c.author.UserId===Pa&&c.author.Provider===mb&&c.author.IsCurrentUser===rc&&c.date===v&&c.commentFlags===B&&this.jQj(c.usersByReactionType,Tc)?c:(c=new DC(Pa,mb,ma,null!==Tb&&void 0!==Tb?Tb:"",rc),new kI(a.id,h,X,c,v,B,Tc))}jQj(a,c){if(!a&&!c)return!0;
if(!c||!a)return!1;var h=Object.keys(a);if(h.length!==Object.keys(c).length)return!1;for(let v of h){if(!(v in c))return!1;h=a[v];const B=c[v];if(h.length!==B.length)return!1;for(let X=0;X<h.length;X++)if(!this.YPj(h[X],B[X]))return!1}return!0}YPj(a,c){return a||c?a&&c&&a.UserId===c.UserId&&a.Provider===c.Provider&&a.Email===c.Email&&a.DisplayName===c.DisplayName&&a.IsCurrentUser===c.IsCurrentUser?!0:!1:!0}NCh(a){if(!a)return null;const c={},h=this.qa.Ga("PresenceUserId");for(let B of Object.keys(a)){const X=
[];var v=a[B];for(let ma of v){v=ma.UserId===h;let Pa;this.mFe.Ja(ma.UserId)?(Pa=this.mFe.J(ma.UserId),Pa.IsCurrentUser=v):(Pa=new DC(ma.UserId,ma.Provider,ma.DisplayName,ma.Email,v),this.mFe.add(ma.UserId,Pa));X.push(Pa)}c[B]=X}return c}}Object(w.a)(YO,"WordEditorSharedCommentModelTranslator",null,[384]);class lI{constructor(){this.fl=null;this.P1c=this.MAg=this.l$f=this.eIg=this.XKg=this.ewg=this.RCg=!1}MCh(){this.fl||(r.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),
this.kDi());return this.fl}o7k(){return new Promise((a,c)=>{this.P1c?a(this.ryh()):this.eAi().then(()=>{a(this.ryh())}).catch(h=>{c(h)})})}ryh(){this.P1c||r.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let a;a=33;this.l$f&&(a|=2);this.RCg&&(a|=8);this.XKg&&(a|=16);this.ewg&&(a|=4);this.eIg&&(a|=64);this.MAg&&(a|=128);return a}}Object(w.a)(lI,"OfficeSharedCommentsAppCapabilities",null,[860]);
class ZO extends lI{constructor(a){super();this.eRa=null;this.Ld=a;this.ojn();this.kDi()}ojn(){this.eIg=this.Ld.THb;this.XKg=!1;this.MAg=this.ewg=this.RCg=!0}initialize(a){this.eRa=a;this.eAi()}Jdl(){let a=120;this.Ld.Qzb&&(a|=1536);return a}kDi(){this.fl={};this.fl.LivePersonaPicker="true";this.fl.PersonaColor="true";this.fl.DiscreteHostedComments=this.Ld.hvk.toString();this.fl.NewCommentButton="true";this.fl.DisabledChangeGates="WebThemeIntegrationHighContrastFixes,"+this.Ld.dvk;this.fl.CommentsFluentUI=
"true";this.fl.CommentTasks=this.Ld.THb.toString();this.fl.CommentTasksFromReply=this.fl.CommentTasks;this.fl.CommentsFluentUIV2="true";this.fl.CommentFriendlyTimestamps=this.Ld.p$j.toString();this.fl.AtMentionFloodgateSurvey=this.Ld.cRj.toString();this.fl.HyperlinksInComments="true";this.fl.NewModelState="true";this.fl.LogDraftCommentIdPair="true";this.fl.RichTextFormattingInWeb=this.Ld.Asb.toString();this.fl.NoDiscardOnFocusLoss="true";this.fl.NewResolvedCardDesignInWeb="true";this.fl.RichContentEditIntegration=
"true";this.fl.HyperlinksWithDisplayText="true";this.fl.SmartReplies=this.Ld.hUf.toString();this.fl.NewBorderAndFocusLookInWeb="true";this.fl.LinkToComment="true";this.fl.TaskPaneWithNewInfrastructure="true";this.fl.CommentReactions=this.Ld.e8a.toString();this.fl.WebThemeIntegration="true";this.fl.NewSelectionInteractions="true";this.fl.QuillInitializationTelemetry="true";this.fl.PersonaIconImageForWeb="true";this.fl.HighlightsAndFontColorInWebComments=this.Ld.Qzb.toString();this.fl.TruncationUIWithReadMoreText=
"true";this.fl.CtrlEnterTip=this.Ld.Rnk.toString();this.fl.AtMentionHintMessage=this.Ld.dRj.toString();this.fl.LivePersonaCardForWeb=this.Ld.QZl.toString();this.fl.TaskHistoryRecordIDs=this.Ld.vBn.toString();this.fl.ContentNavigation=this.Ld.contentNavigationApiEnabled.toString()}eAi(){return new Promise((a,c)=>{this.eRa?this.eRa.atMentionsEnabledAsync().then(h=>{this.l$f=h;this.P1c=!0;a(this.P1c)}):(r.ULS.sendTraceTag(588292830,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),
c(io.a.VA(-2130915320)))})}}Object(w.a)(ZO,"WordSharedCommentsAppCapabilities",lI,[383]);class mG{constructor(){this.W=null;this._initialized=!1;this.Q$j={jUa:"webasynccollabeng",featureName:"Comments",occ:"CommentsFeatureUsage",cJb:7};this.DBn={jUa:"webasynccollabeng",featureName:"Tasks",occ:"TasksFeatureUsage",cJb:7};this.lPc=null}get pfb(){return this.lPc||(this.lPc=this.W.resolve("Box4.IPackageBootPerfLogger"))}v7(a){this.pfb.v7(cG.a.comments,a,!0)}get name(){return"WordEditor.Comments"}yb(a){this.W=
a;this.v7("CPConfigStart");a.ha("WordEditor.Comments.ICommentsUsageAndHealthLogger",()=>new Kn.a(Fa.Health.instance,new gt.a,this.Q$j)).as("WordEditor.Comments.ICommentsUsageAndHealthLogger").singleInstance();a.ha("WordEditor.Comments.ITasksUsageAndHealthLogger",()=>new Kn.a(Fa.Health.instance,new gt.a,this.DBn)).as("WordEditor.Comments.ITasksUsageAndHealthLogger").singleInstance();a.ha("WordEditor.Comments.CommentNodeTracker",()=>new oO(this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.CommentNodeTracker").singleInstance();
a.ha("WordEditor.Comments.CommentsSettings",()=>new tO(l.AFrameworkApplication.K,this.W.resolve("Box4.IFeatureHelper"),new qf.a(()=>Eb.App.oa.Da.Zb),new qf.a(()=>YH.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"))).as("WordEditor.Comments.CommentsSettings").singleInstance();a.ha("WordEditor.Comments.CommentsState",()=>new uO.a).singleInstance();a.ha("WordEditor.Comments.WordCommentEventsActor",()=>new VO(a.za("Box4.TrackChange.ITrackChangeManager"),
a.resolve("WordEditor.Comments.CommentsState"),a.resolve("Box4.TrackChange.ITrackChangeEventsActor"))).singleInstance();a.ha("WordEditor.Comments.WordEditorSharedCommentModelTranslator",()=>new YO(l.AFrameworkApplication.K,this.W.resolve("WordEditor.Comments.CommentsSettings"),new qf.a(()=>Eb.App.oa.Da.Zb.Lc))).as("WordEditor.Comments.IWordEditorSharedCommentModelTranslator").singleInstance();a.ha("WordEditor.Comments.CommentDeltaFormatTranslator",()=>new AC(a.resolve("WordEditor.Comments.CommentsSettings"),
a.resolve("Box4.Styles.IWACStyleReader"))).as("WordEditor.Comments.ICommentFormatTranslator").singleInstance();a.ha("Common.Comments.OfficeSharedCommentsEventHost",()=>new QN(l.AFrameworkApplication.Cb)).as("Common.Comments.IOfficeSharedCommentsEventHost").singleInstance();a.ha("WordEditor.Comments.CommentActionInTypingRecorder",()=>new $N(this.W.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.ICommentActionInTypingRecorder").singleInstance();a.ha("WordEditor.Comments.EditorCommentModel",
$r.getInstance).as("Common.Comments.ICommentModel").as("WordEditor.Comments.IWordEditorCommentModel").as("WordEditor.Comments.IEditorCommentModel").singleInstance();a.ha("WordEditor.Comments.CommentHighlightOnRestActor",()=>new lO(new qf.a(()=>Eb.App.oa.Da.Zb),a.resolve("WordEditor.Comments.CommentsState"),a.resolve("WordEditor.Comments.IEditorCommentModel"),a.resolve("WordEditor.Comments.WordCommentEventsActor"),a.resolve("Box4.INotebookManager").Pk,Fo.a.instance)).as("WordEditor.Comments.ICommentHighlightOnRestActor").singleInstance();
a.ha("WordEditor.Comments.CommentHighlightUtils",()=>new HE(a.resolve("Box4.Highlight.IHighlightManager"))).singleInstance();a.ha("WordEditor.Comments.DefaultHighlightChangeHandler",()=>new vO(a.resolve("WordEditor.Comments.CommentHighlightUtils"))).singleInstance();a.ha("WordEditor.Comments.AllMarkupModeHighlightChangeHandler",()=>new YN(a.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),a.resolve("WordEditor.Comments.CommentHighlightUtils"),l.AFrameworkApplication.na.RY,l.AFrameworkApplication.na.wCa,
l.AFrameworkApplication.pa,l.AFrameworkApplication.Cb,a.resolve("WordEditor.Comments.CommentsState"),a.za("WordEditor.Comments.IEditorCommentManager"))).singleInstance();a.ha("WordEditor.Comments.CommentHighlightActor",()=>new iO(new qf.a(()=>Eb.App.oa.Da.Zb.Lc),a.resolve("WordEditor.CommentsInteractive.ICommentEditor"),a.resolve("WordEditor.Comments.ICommentHighlightOnRestActor"),a.za("WordEditor.Comments.IEditorCommentManager"),Fo.a.instance,a.resolve("WordEditor.Comments.AllMarkupModeHighlightChangeHandler"),
a.resolve("WordEditor.Comments.DefaultHighlightChangeHandler"),a.resolve("WordEditor.Comments.CommentHighlightUtils"),a.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("WordEditor.Comments.ICommentHighlightActor").singleInstance();a.ha("WordEditor.Comments.CommentHintActor",()=>new tw(a.resolve("WordEditor.Comments.CommentsSettings"),oi.a.instance,ah.a.instance,ad.a.instance,l.AFrameworkApplication.pa,Tf.TableCellReader.CNl,Fe.moveToLastRenderedCellOfTheRow,new gl.a,a.za("Box4.ContentControlConfigSettings"),
a.resolve("WordEditor.Comments.IEditorCommentModel"),a.resolve("WordEditor.Comments.ICommentHighlightActor"),a.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"))).as("WordEditor.Comments.ICommentHintActor").singleInstance();a.ha("WordEditor.Comments.CommentMarginEntryPointActor",()=>new dG(oi.a.instance,ah.a.instance,ad.a.instance,l.AFrameworkApplication.pa,a.resolve("WordEditor.Comments.ICommentHintActor"),a.za("Common.IZoomManager"))).singleInstance();a.ha("WordEditor.Comments.ViewContainerAPI",
()=>new UO(l.AFrameworkApplication.pa,"OfficeSharedCommentPaneSurface")).as("WordEditor.Comments.IWordViewContainerAPI").singleInstance();a.ha("Common.Comments.CommentActivationManager",()=>new RN).as("Common.Comments.ICommentActivationManager").singleInstance();a.ha("Common.Comments.ViewContainerEventHost",()=>new SN(l.AFrameworkApplication.Cb,"OfficeSharedCommentPaneSurface")).as("Common.Comments.IViewContainerEventHost").singleInstance();a.ha("WordEditor.Comments.CommentSmartReplyProvider",()=>
new sO(this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Box4.AugmentationLoop.IAnnotationStorage"),this.W.resolve("Box4.AugmentationLoop.IUtilsWrapper"),this.W.resolve("Box4.AugmentationLoop.IAlFactoryWrapper"))).as("Common.Comments.ICommentSmartReplyProvider").singleInstance();a.ha("WordEditor.Comments.WordSharedCommentsAppCapabilities",()=>new ZO(a.resolve("WordEditor.Comments.CommentsSettings"))).as("WordEditor.Comments.IWordSharedCommentsAppCapabilities").singleInstance();
this.v7("CPConfigEnd")}init(){this.v7("CPInitStart");this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{try{this.El(),this.v7("CPInitEnd")}catch(a){throw r.ULS.o1(524300632,327,10,a,"Exception threw from Comments Package initialization in onAfterGraphFeaturesNodeLoaded: {0}",a),this.pfb.Lt(cG.a.comments,"CPInitException",a,!0),a;}})}El(){if(this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(28)){var a=this.W.resolve("WordEditor.Comments.CommentsSettings");this.v7("onAfterGFNLoadedStart");
this.W.ha("WordEditor.Comments.OfficeSharedCommentPane",()=>new TO(l.AFrameworkApplication.pa,l.AFrameworkApplication.na.yx,l.AFrameworkApplication.na.zB,l.AFrameworkApplication.na.Pn,l.AFrameworkApplication.na.gu,Eb.App.oa,vp.a.instance,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.resolve("Common.Comments.IViewContainerEventHost"),l.AFrameworkApplication.Cb,this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),
a,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"))).as("Common.Comments.ICommentPane").as("WordEditor.Comments.IOfficeSharedCommentPane").singleInstance();this.W.ha("Common.Comments.OfficeSharedCommentsActionHost",()=>new UN(l.AFrameworkApplication.pa,this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane").Eec)).as("Common.Comments.IOfficeSharedCommentsActionHost").singleInstance();
this.W.ha("WordEditor.Comments.WordEditorSharedCommentAPI",()=>new XO(l.AFrameworkApplication.Cb,this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.W.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),this.W.resolve("WordEditor.Comments.IWordEditorSharedCommentModelTranslator"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),a,Eb.App.oa,l.AFrameworkApplication.na.Pn,this.W.za("Common.ISystemInitiatedFeedback"),l.AFrameworkApplication.pa,Fo.a.instance,this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),
this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.CommentMarginEntryPointActor"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.IWordEditorSharedCommentAPI").singleInstance();ud.a.factory=Oz.getInstance;this.W.ha("WordEditor.Comments.EditorCommentManager",Oz.getInstance).as("Common.Comments.ICommentManagerCore").as("WordEditor.Comments.IEditorCommentManager").singleInstance();this.W.ha("WordEditor.Comments.CommentFloatingContainerActor",
()=>new hO(this.W.resolve("WordEditor.Comments.CommentsState"),a,this.W.resolve("WordEditor.Comments.IEditorCommentModel"),l.AFrameworkApplication.Cb,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),()=>document.querySelector(`#${If.AppFrame.hDa} .${NQ.a.cXb}`),this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),l.AFrameworkApplication.na.Pn)).as("WordEditor.Comments.ICommentFloatingContainerActor").singleInstance();
var c=this.W.resolve("WordEditor.Sidetrack.SidetrackSettings"),h=c.trackChangeInSidetrackEnabled;h&&this.W.resolve("WordEditor.Sidetrack.IFloatingContainerActorConsumer").Qoi(this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"));a.contentNavigationApiEnabled&&(this.W.ha("WordEditor.Comments.CommentContentProvider",()=>new pO).singleInstance(),this.W.resolve("WordEditor.Comments.CommentContentProvider"));this.W.ha("WordEditor.Comments.FloatingCommentManager",()=>new JE(this.W.resolve("WordEditor.Comments.IEditorCommentModel"),
l.AFrameworkApplication.Cb,Fo.a.instance,this.W.resolve("WordEditor.Comments.ICommentActionInTypingRecorder"),a,MQ.a.get_instance(),this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),c)).singleInstance();this.W.ha("WordEditor.Comments.IFloatingCommentManager",()=>h?this.W.resolve("WordEditor.Sidetrack.SidetrackManager"):
this.W.resolve("WordEditor.Comments.FloatingCommentManager")).as("Box4.IFloatingObjectUpdater").singleInstance();this.W.ha("WordEditor.Comments.CommentSelectionActor",()=>new rO(l.AFrameworkApplication.pa,this.W.resolve("Common.Comments.ICommentModel"),this.W.resolve("WordEditor.Comments.ICommentHighlightActor"),Ry.getInstance(),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),this.W.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),l.AFrameworkApplication.na.Pn,this.W.resolve("WordEditor.Comments.CommentsState"),
a,new qf.a(()=>$c.a.instance),this.W.resolve("WordEditor.Comments.CommentNodeTracker"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"))).as("WordEditor.Comments.ICommentSelectionActor").singleInstance();this.W.ha("WordEditor.Comments.CommentInitActor",()=>new nO(this.W.resolve("WordEditor.Comments.IEditorCommentManager"),this.W.resolve("WordEditor.Comments.IEditorCommentModel"),this.W.resolve("WordEditor.Comments.IOfficeSharedCommentPane"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),
a,this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),Ry.getInstance(),Eb.App.oa.Qo,l.AFrameworkApplication.pa,this.W.resolve("Common.IDynamicScriptLoaderProvider").$C,this.W.za("WordEditor.Comments.ICommentRibbonCommandHandler"),l.AFrameworkApplication.na.Pn,this.W.resolve("WordEditor.Comments.IWordSharedCommentsAppCapabilities"),this.W.resolve("Common.Comments.ICommentSmartReplyProvider"),this.W.resolve("Common.Comments.ICommentActivationManager"),
this.W.resolve("WordEditor.Comments.IWordViewContainerAPI"),this.W.za("Common.ISystemInitiatedFeedback"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),this.W.za("Common.App.SafeLinks.ISafeLinksManager"),this.W.za("Common.App.People.IExternalPeopleAPI"),this.W.resolve("Common.OfficeSharedCommentsTelemetry"),this.W.resolve("Common.Comments.IViewContainerEventHost"),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger"),this.W.resolve("WordEditor.Comments.ICommentFloatingContainerActor"),
this.W.resolve("WordEditor.Sidetrack.ISidetrackHelper"),c,this.W.resolve("WordEditor.ReviewSuggestionContent.WordContentNavigationAPI"),this.W.resolve("Box4.IPackageBootPerfLogger"))).singleInstance();this.W.ha("WordEditor.Comments.CommentsActionManager",()=>new qO(this.W.resolve("WordEditor.Comments.EditorCommentManager"),this.W.resolve("WordEditor.Comments.EditorCommentModel"),this.W.resolve("WordEditor.Comments.ICommentHintActor"),this.W.resolve("WordEditor.Comments.ICommentSelectionActor"),this.W.resolve("WordEditor.Comments.WordCommentEventsActor"),
this.W.resolve("WordEditor.Comments.CommentsState"),this.W.resolve("WordEditor.Comments.IFloatingCommentManager"),a,this.W.resolve("Common.Comments.ICommentPane"),new qf.a(()=>Eb.App.oa.Da.Zb.Lc),l.AFrameworkApplication.pa,new qf.a(()=>$c.a.instance),nc.FocusManager.instance(),Fo.a.instance)).as("WordEditor.Comments.CommentsActionManager").singleInstance();this.W.resolve("WordEditor.Comments.CommentInitActor");var v=a.hp,B=this.W.resolve("WordEditor.Comments.EditorCommentManager");this.W.resolve("WordEditor.Comments.CommentsActionManager");
B&&v&&(this.W.resolve("WordEditor.Comments.CommentsState").K7a=mG.Rqh(),a.Tub||this.W.resolve("WordEditor.Comments.WordCommentEventsActor").vsa("OnCommentInit"));Zw.j6l();a.TFc&&Eb.App.oa.Da.Ihh();ud.a.instance&&(a.Tub||ck.a.get_instance().Vk(4,()=>{this.Zlm(v)},11).continueWith(()=>{this.cAl()}),this._initialized=!0);this.$Qm(this.W.za("Box4.Accessibility.IAccessibilityContextManager"),this.W.resolve("Box4.IParagraphReader"),this.W.resolve("WordEditor.CommentsInteractive.ICommentEditor"))}}cAl(){this.W.resolve("WordEditor.Comments.WordCommentEventsActor").vsa("OnCommentInit")}Zlm(a){a||
this.bnl()}bnl(){const a=mG.Rqh();a&&(r.ULS.sendTraceTag(35149084,327,50,"Comment deep linking starts after boot: {0}",(new Date).getTime()-l.AFrameworkApplication.nU),this.W.resolve("WordEditor.Comments.WordCommentEventsActor").vsa("OnCommentInit",Object.assign(new CC,{CAa:()=>{ud.a.instance.F9.isVisible||l.AFrameworkApplication.pa.processAction(Sa.a.QV,2);this.W.resolve("WordEditor.Comments.ICommentSelectionActor").tyi(a,Object.assign(new rw.a,{ASf:!0}))}})),this.W.resolve("WordEditor.Comments.ICommentsUsageAndHealthLogger").jB(Sa.a.VQe))}$Qm(a,
c,h){a&&a.execute(v=>{v.j1(new Ms(c,h))})}dispose(){this._initialized&&(ud.a.instance&&ud.a.instance.dispose(),this._initialized=!1)}static Rqh(){return l.AFrameworkApplication.K.Ga("BootActivityNavigationId")}}Object(w.a)(mG,"PackageManager",null,[1,2]);class $O{isComment(a){return Oi.a.isComment(a)}RHd(a){return Oi.a.RHd(a)}Qhf(a){return Oi.a.Qhf(a)}eyf(a,c){Oi.a.eyf(a,c)}iyf(a,c){Oi.a.iyf(a,c)}jUe(a){return Oi.a.jUe(a)}oeb(a){return YH.a.instance.oeb(a)}deleteComment(a,c){Oi.a.deleteComment(a,
c)}ctd(a,c){Oi.a.ctd(a,c)}lgb(a){Oi.a.lgb(a)}l8(a,c,h){return Oi.a.l8(a,c,h)}tya(a,c,h){return Oi.a.tya(a,c,h)}P_b(a,c){return Oi.a.P_b(a,c)}Y5e(a,c,h,v=null){return Oi.a.Y5e(a,c,h,v)}dTb(a,c,h,v){Oi.a.dTb(a,c,h,v)}Fkd(a,c,h,v){return Oi.a.Fkd(a,c,h,v)}get Fzb(){return Oi.a.Fzb}set Fzb(a){Oi.a.Fzb=a}mZa(a,c){Oi.a.mZa(a,c)}BSc(a){Oi.a.BSc(a)}PJf(a){Oi.a.PJf(a)}hBd(a,c){return Oi.a.hBd(a,c)}fyf(a,c){Oi.a.fyf(a,c)}hyf(a,c){Oi.a.hyf(a,c)}EQd(a,c,h,v,B,X){Oi.a.EQd(a,c,h,v,B,X)}L_e(a,c){Oi.a.L_e(a,c)}qQc(a,
c,h,v){return Oi.a.qQc(a,c,h,v)}uQc(a,c,h,v){return Oi.a.uQc(a,c,h,v)}}Object(w.a)($O,"CommentEditorProxy",null,[382]);class aP{constructor(){this.lPc=this.WHg=this.W=null}get pAn(){return this.WHg||(this.WHg=this.W.za("WordEditor.ITableEditor"))}get pfb(){return this.lPc||(this.lPc=this.W.resolve("Box4.IPackageBootPerfLogger"))}v7(a){this.pfb.v7(cG.a.comments,a,!0)}get name(){return"WordEditor.CommentsInteractive"}yb(a){this.W=a;this.v7("CIPConfigStart");a.ha("WordEditor.CommentsInteractive.CommentEditorProxy",
()=>new $O).as("WordEditor.CommentsInteractive.ICommentEditor").singleInstance();this.v7("CIPConfigEnd")}init(){this.v7("CIPInitStart");this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{this.El();this.v7("CIPInitEnd")})}El(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(28)&&this.wvl()}dispose(){}wvl(){Hv.a.pMa(Oi.a.iyf);dk.EIe(Oi.a.fyf);dk.tld(Oi.a.hyf);dk.ZHj(Oi.a.Wlm);this.pAn.execute(a=>{a.FIe(Oi.a.mZa)});Eb.App.aj.Pk.Yd(39).Yl(Oi.a.eyf);dk.iHj(Oi.a.Zkm);dk.cHj(Oi.a.skm)}}Object(w.a)(aP,
"PackageManager",null,[1,2]);var YQ=b(1816),bP=b(1488);class mI{constructor(a,c,h,v,B,X,ma){this.wGa=a;this.h7=c;this.Z2=h;this.Vb=v;this.Ofj=B;this.xte=X;this.Vnb=ma;bP.a.YHj((Pa,mb)=>{this.kGj(mb.graphNode,mb.d$j)});bP.a.AIj((Pa,mb)=>{this.Uek(mb.graphNode,mb.j8j)})}mAd(){var a=this.Ofj();const c=this.Vb.Dj();c.set(a);if(this.h7.QIn(c))return c;c.set(a);jn.PageNavigator.instance.aS(c);a=this.Z2.ymk(c.currentNode);c.qh(a);return c}yCd(a){const c=this.mAd();let h=null;this.h7.Cxd(c,v=>{this.Z2.lEh(v)===
a&&(h=v);return!h});return h}hEh(a){const c=this.mAd();let h=null;this.h7.Cxd(c,v=>{this.Z2.W_b(v)===a&&(h=v);return!h});return h}m1h(a,c,h){r.ULS.sendTraceTag(594928199,3003,50,"History Record Generated. [RecordType: {0}], [TaskID: {1}], [TaskCompletion: {2}]",a,c,h)}mEh(){const a=this.mAd(),c=[];this.h7.Cxd(a,h=>{c.push(this.Z2.lEh(h));return!0});return c}w9a(a,c){if(!c.length)return this.Vnb&&r.ULS.sendTraceTag(42812043,3003,10,"A task must always have at least one history record."),null;const h=
this.mAd(),v=Ya.a.create().toString(),B=new Kh.a;for(let X of c)B.add(X),this.m1h(X.type,v,X.completion);c=this.wGa.ROf(B);this.Z2.w9a(h.currentNode,v,a,c);this.xte();return v}me(a){(a=this.yCd(a))?(this.Z2.me(a),this.xte()):this.Vnb&&r.ULS.sendTraceTag(51656714,3003,10,"DeleteTask : Unable to find task with given ID")}W_b(a){a=this.yCd(a);return a?this.Z2.W_b(a):(this.Vnb&&r.ULS.sendTraceTag(42812044,3003,10,"GetTaskCommentAnchorId : Unable to find task with given ID"),null)}iEh(a){return this.Z2.W_b(a)}kEh(a){a=
this.yCd(a);if(!a)return this.Vnb&&r.ULS.sendTraceTag(42812045,3003,10,"GetTaskHistory : Unable to find task with given ID"),null;a=this.Z2.R$e(a);return this.wGa.kXb(a).toArray()}MNj(a,c){if(!c.length)return this.Vnb&&r.ULS.sendTraceTag(594928198,3003,10,"AppendTaskHistory : New records do not exist"),!1;const h=this.yCd(a);if(!h)return this.Vnb&&r.ULS.sendTraceTag(42812046,3003,10,"AppendTaskHistory : Unable to find task with given ID"),!1;const v=this.Z2.R$e(h),B=this.wGa.kXb(v);for(let X of c)B.add(X),
this.m1h(X.type,a,X.completion);a=this.wGa.ROf(B);a!==v&&(this.Z2.Sin(h,a),this.xte());return!0}kGj(a,c){if(c=this.hEh(c)){const h=this.Vb.Dj();h.set(a);this.Z2.ub(c.clone(),this.Z2.CCk(c,h))}}Fni(a,c,h){if(c.Ja(a))return c.J(a);const v=Ya.a.create().toString();c.add(a,v);h&&this.Vnb&&r.ULS.sendTraceTag(593281437,3003,10,"RecordIdFromMapOrGenerateNewIdAndAddToMap : Unexpectedly creating new id.");return v}Uek(a,c){const h=new em.a;var v=this.Vb.Dj();v.set(a);v.Za(38)&&this.h7.Cxd(v,B=>{const X=this.Z2.W_b(B);
void 0!==X&&null!==X&&h.add(X,B);return!0});for(let B of c)if(a=null,({value:a}=h.Ab(B.key,a)).returnValue)if(B.value===B.key)a=this.hEh(B.key),this.Z2.Cjn(a,parseInt(B.key));else{a=this.Z2.R$e(a);if(!a||""===a){r.ULS.sendTraceTag(595347466,3003,10,"CopyTaskNodesFromParentNode : History Records not found on taskNode on clipboard");break}a=this.wGa.kXb(a);v=new od.a;for(let X=0;X<a.length;X++){if(a.J(X).commentId){const ma=Number.parseInvariant(a.J(X).commentId);c.Ja(ma)?a.J(X).commentId=c.J(ma).toString():
a.J(X).commentId=null}a.J(X).recordId=this.Fni(a.J(X).recordId,v,!1);-1===a.J(X).type&&(a.J(X).undoId=this.Fni(a.J(X).undoId,v,!0))}this.w9a(B.value,a.toArray())}}static hq(){return new mI(xa.a.instance.resolve("WordEditor.Tasks.ITaskHistorySerialization"),xa.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),xa.a.instance.resolve("WordEditor.Tasks.ITaskEditor"),new gl.a,()=>Eb.App.oa.Da.Zb,()=>{xa.a.instance.za("Common.Interface.IEditNotificationManager").execute(a=>{a.sud()})},!0)}}Object(w.a)(mI,
"TaskActor",null,[435]);var ZQ=b(991);class cP{create(){return new ZQ.a}}Object(w.a)(cP,"TaskContentNodeFactory",null,[472]);class dP{create(){return new NO.a}}Object(w.a)(dP,"TaskNodeFactory",null,[472]);class PE{constructor(a,c,h,v,B,X){this.h7=a;this.Fb=c;this.Vb=h;this.axj=v;this.dxj=B;this.uKb=X}Zkk(a,c,h){const v=this.dxj.create(1074135162);v.setValue(Yb.a.taskId,a);v.setValue(Yb.a.RHb,c);v.setValue(Yb.a.lta,h);return v}Y_b(a){const c=this.Fb.Ob(4);c.Oa(a);this.uKb();return c}lEh(a){return this.h7.IAb(a)?
a.getValue(Yb.a.taskId):(r.ULS.sendTraceTag(42812047,3003,10,"Unexpected node type"),null)}W_b(a){return this.h7.IAb(a)?a.hasProperty(Yb.a.RHb)?a.getValue(Yb.a.RHb):null:(r.ULS.sendTraceTag(42812048,3003,10,"Unexpected node type"),null)}R$e(a){return this.h7.IAb(a)?a.getValue(Yb.a.lta):(r.ULS.sendTraceTag(42812049,3003,10,"Unexpected node type"),null)}ymk(a){if(7!==a.type)return r.ULS.sendTraceTag(42812050,3003,10,"Unexpected node type"),null;const c=this.Y_b(a);try{const h=this.axj.create(1074135161),
v=this.Vb.Dj();v.set(a);v.h3(h,38,PE.rBn);return h}finally{c&&c.dispose()}}w9a(a,c,h,v){if(!this.h7.tmf(a))return r.ULS.sendTraceTag(42812051,3003,10,"Unexpected node type"),null;const B=this.Y_b(a);try{const X=this.Zkk(c,h,v),ma=this.Vb.Dj();ma.set(a);ma.h3(X,1,new N.a(Ya.a.Oha(h.toString()),1));return X}finally{B&&B.dispose()}}me(a){if(this.h7.IAb(a))if(a.anchor&&a.anchor.gr){var c=a.anchor.gr.Iq.node;if(this.h7.tmf(c)){var h=this.Y_b(c);try{const v=this.Vb.Dj();v.set(c);v.qh(a.anchor.node);v.xf()}finally{h&&
h.dispose()}}else r.ULS.sendTraceTag(51656717,3003,10,"Task node unexpectedly parented to non-content node")}else r.ULS.sendTraceTag(51656716,3003,10,"Cannot delete an unlinked node");else r.ULS.sendTraceTag(51656715,3003,10,"Unexpected node type")}Sin(a,c){if(this.h7.IAb(a)){var h=this.Y_b(a);try{a.setValue(Yb.a.lta,c)}finally{h&&h.dispose()}}else r.ULS.sendTraceTag(42812052,3003,10,"Unexpected node type")}Cjn(a,c){if(this.h7.IAb(a)){var h=this.Y_b(a);try{const v=a.hasProperty(Yb.a.RHb)?a.getValue(Yb.a.RHb):
null;void 0===v||null===v||v===c?a.Uh(Yb.a.RHb,c):r.ULS.sendTraceTag(595347464,3003,10,"TaskAnchorId is changed.")}finally{h&&h.dispose()}}else r.ULS.sendTraceTag(595347465,3003,10,"Unexpected node type")}CCk(a,c){if(!c.pp(38)){const h=this.Vb.Dj();h.set(a);h.La(71);h.mc(71);a=Nr.a(h.currentNode,a.Eh().Mb,!0);c.Je(a,38)}return c.Za(38)}ub(a,c){if(this.h7.tmf(c)){var h=this.Y_b(c);try{const v=this.Vb.Dj();v.set(c);v.Je(a,1)}finally{h&&h.dispose()}}else r.ULS.sendTraceTag(595347463,3003,10,"Unexpected node type")}static hq(){return new PE(xa.a.instance.resolve("WordEditor.Tasks.ITaskNavigator"),
new Fk.a,new gl.a,new cP,new dP,()=>{S.App.Hk.Da.Zb.UD.D7(10)})}}PE.rBn=new N.a(Ya.a.Ee("50f73b87-1d48-4f4a-94a3-4c20e2cf6387"),1);Object(w.a)(PE,"TaskEditor",null,[434]);class nI{constructor(a,c){this.Mu=a;this.HPb=c}IAb(a){return!!a&&72===a.type}BTl(a){return!!a&&71===a.Md}tmf(a){return!!a&&71===a.type}QIn(a){a.set(this.Mu.value);this.HPb.aS(a);return!!a.Za(38)}Cxd(a,c){if(a&&c)if(this.BTl(a))for(var h=!0,v=a.Za(1);h&&v;)this.IAb(v)||r.ULS.sendTraceTag(42812055,3003,10,"Unexpected node type {0}",
v.type),h=c(v),v=a.ue(1);else r.ULS.sendTraceTag(42812054,3003,10,"Unexpected iterator type {0}",a.Md);else r.ULS.sendTraceTag(42812053,3003,10,"ForEachTaskInTaskContent : Invalid Input")}static hq(){return new nI(new qf.a(()=>Eb.App.oa.Da.Zb),jn.PageNavigator.instance)}}Object(w.a)(nI,"TaskNavigator",null,[381]);class eP{constructor(){this.W=null}get name(){return"WordEditor.Tasks"}init(){this.W.resolve("Box4.IFeatureHelper").pk.continueWith(()=>{this.El()})}dispose(){}yb(a){this.W=a;a.ha("WordEditor.Tasks.JsonTaskHistorySerialization",
()=>new YQ.a).as("WordEditor.Tasks.ITaskHistorySerialization").singleInstance();a.ha("WordEditor.Tasks.TaskNavigator",()=>nI.hq()).as("WordEditor.Tasks.ITaskNavigator").singleInstance();a.ha("WordEditor.Tasks.TaskEditor",()=>PE.hq()).as("WordEditor.Tasks.ITaskEditor").singleInstance();a.ha("WordEditor.Tasks.TaskActor",()=>mI.hq()).as("WordEditor.Tasks.ITaskActor").singleInstance()}El(){this.W.resolve("Box4.IFeatureHelper").isFeatureEnabled(193)}}Object(w.a)(eP,"TasksPackage",null,[1,2]);class fP{constructor(){this.onResizeMiddleContainer=
this.onTabStripFocus=this.onResizeEnd=this.onResizeStart=this.onOverflowMenuClose=this.onOverflowMenuOpen=this.setFocusCallback=this.onHide=this.onShow=this.onClose=this.onOpen=this.middleContainer=null}}Object(w.a)(fP,"TaskPaneGroupAppProps",null,[]);class gP{static dak(a,c){nc.FocusManager.rH()&&(ah.a.instance.lwa(a,c,!1),im.a.instance.lwa(a,c,!1),l.AFrameworkApplication.na.gu.KQ(a))}}Object(w.a)(gP,"ReactTaskPaneManagerUtils",null,[]);class hP{constructor(){this.type=null}}Object(w.a)(hP,"SampleTaskPaneProps",
null,[]);var $Q=b(1486);class iP{constructor(){this.entry=null;this.show=!1}}Object(w.a)(iP,"AnimationBatchEntry",null,[]);var aR=b(1485);class Dv{constructor(){this.uzg=[];this.vzg=[];this.Pga={};this.PDa=this.ODa=null;this.Khd=!1;this.DW=null;this.afd=this.bad=0;this.Xec=[];this.zoe=!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.$cb;this.Pw=!1}initialize(){this.Khd=!1;(this.Pw=!!l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.a9)&&this.RUe()}TUe(a,c,h,v){c=this.ACd(c);r.ULS.sendTraceTag(4290588,
320,50,"Create new task pane.");this.RUe();const B=document.createElement("div");B.id=c;B.className=Dv.EVn;B.style.width="0";this.zoe||(this.lDj(h,c,B),this.Pga[c]=a.TUe(c,h,v,B));return B}RUe(){this.Khd||this.rln()}lDj(a,c,h){let v=null,B=null;0===a?(v=this.ODa,B=this.uzg):1===a&&(v=this.PDa,B=this.vzg);if(v){a=!1;for(let X=0;X<B.length;X++)if(!a)B[X]===c&&(a=!0);else if(B[X]in this.Pga){this.gEl(v,h,this.Pga[B[X]]);return}v.appendChild(h)}}gEl(a,c,h){a.insertBefore(c,h.element)}swk(a){a=this.ACd(a);
if(a in this.Pga){const c=this.Pga[a];c.element.parentNode.removeChild(c.element);delete this.Pga[a]}}AIi(a){a=this.ACd(a);a in this.Pga&&(a=this.Pga[a])&&!a.isVisible&&(this.MHi(a,!0),this.OQg(a.position,!0,this.vZg(a,!0)),1===a.position&&1<Za.a.count(this.Pga)&&this.H8l())}Rul(a){a=this.ACd(a);a in this.Pga&&(a=this.Pga[a])&&a.isVisible&&(this.MHi(a,!1),this.OQg(a.position,!1,this.vZg(a,!1)))}GWb(a){if(this.DW)return this.DW;const c=document.createElement("div");document.body.appendChild(c);c&&
(this.DW=new tF(c,a));return this.DW}MHi(a,c){a.element&&(a.isVisible=c,this.Xec.push(Object.assign(new iP,{entry:a,show:c})));0===a.position?this.bad+=c?1:-1:this.afd+=c?1:-1;1===this.Xec.length&&window.setTimeout(Object(m.a)(this,this.Gwn,"startPaneAnimation"),0);this.Pw&&a.element&&a.element.parentNode&&(0===a.position&&!this.bad||1===a.position&&!this.afd?(a.element.parentNode.style.minHeight="0px",a.element.parentNode.style.height="0px",a.element.parentNode.style.overflow="hidden"):(a.element.parentNode.style.minHeight=
"",a.element.parentNode.style.height="",a.element.parentNode.style.overflow=""))}Gwn(){this.Obi();var a=Xj.where(Xj.asEnumerable(this.Xec),B=>0===B.entry.position),c=Xj.where(a,B=>!B.show);if(Xj.any(c)&&Xj.Ct(c)!==Xj.Ct(a)){for(var h of c)h.entry.element.style.width="0";a=Xj.where(a,B=>B.show)}c=Xj.where(Xj.asEnumerable(this.Xec),B=>1===B.entry.position);h=Xj.where(c,B=>!B.show);if(Xj.any(h)&&Xj.Ct(h)!==Xj.Ct(c)){for(var v of h)v.entry.element.style.width="0";c=Xj.where(c,B=>B.show)}for(let B of Xj.concat(a,
c))a=B.entry,rp.WacAirSpace.qS(a.element,Mo.a.oTf),v=new aR.a(a.element),B.show?v.IJe(0,a.width):v.IJe(a.width,0),rp.WacAirSpace.animate(v,null,null);this.Xec.length=0}Obi(){}vZg(a,c){let h=a.width;a=0===a.position?this.bad:this.afd;if(c&&1===a||!c&&!a)h+=1;return h}rln(){this.Khd||(this.ODa||(this.ODa=document.createElement("div"),this.ODa.id=Dv.CVn,this.ODa.className=Dv.CYi,Sys.UI.DomElement.addCssClass(this.ODa,"alignLeft"),l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.r4&&Sys.UI.DomElement.addCssClass(this.ODa,
"FlexBoxLayout"),this.zoe&&Sys.UI.DomElement.addCssClass(this.ODa,Dv.yYi),this.ROg(0,this.ODa)),this.PDa||(this.PDa=document.createElement("div"),this.PDa.id=Dv.DVn,this.PDa.className=Dv.CYi,Sys.UI.DomElement.addCssClass(this.PDa,"alignRight"),l.AFrameworkApplication.na&&l.AFrameworkApplication.na.Ya.r4&&Sys.UI.DomElement.addCssClass(this.PDa,"FlexBoxLayout"),this.zoe&&Sys.UI.DomElement.addCssClass(this.PDa,Dv.yYi),this.ROg(1,this.PDa)),this.Idi(this.ODa,this.PDa),this.Khd=!0)}Idi(){}pwa(a,c){Array.add(1===
a?this.vzg:this.uzg,c)}ACd(a){return a+"-Entry"}H8l(){let a=0;for(const c of Za.a.rM(this.Pga)){const h=Object(ha.a)(919,this.Pga[c]);h&&h.isVisible&&1===h.position&&a++}2===a?r.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):2<a&&r.ULS.sendTraceTag(595179605,320,50,a+" simultaneous panes open")}}Dv.CVn="WACTaskPaneContainerLeft";Dv.DVn="WACTaskPaneContainerRight";Dv.CYi="WACTaskPaneContainer";Dv.EVn="WACTaskPaneEntry";Dv.yYi="WACReactTaskPaneContainer";Object(w.a)(Dv,"BaseTaskPaneManager",
null,[920]);class oI extends Dv{constructor(a,c){super();this.Dnc=this.Cnc=this.EFe=this.DFe=0;this.ga=a;this.Rng=c}ROg(a,c){const h=Eb.App.oa.vA;h.parentNode&&(a?1===a&&(this.Pw?((a=Object(qG.a)("FarPane"))&&a.appendChild(c),c.classList.add("regionComposer"),Eb.App.oa.Vw.registerBoundingWindowRectsChanged("farPane",(v,B)=>{"DP"===B||3===B?c.classList.add("DL"):c.classList.remove("DL")})):h.parentNode.insertBefore(c,h.nextSibling)):this.Pw?((a=Object(qG.a)("NearPane"))&&a.appendChild(c),c.classList.add("regionComposer")):
h.parentNode.insertBefore(c,h))}OQg(a,c,h){this.Pw||(c=c?h:-h,a?this.Dnc+=c:this.Cnc+=c)}Obi(){if(!this.Pw){var a=Eb.App.oa.vA;rp.WacAirSpace.qS(a,Mo.a.oTf);if(this.DFe!==this.Cnc){const c=new $v.a(a);c.eMj(this.DFe,this.Cnc,this.Rng);rp.WacAirSpace.animate(c,null,Object(m.a)(this,this.$nh,"forceInteractiveViewRefreshOutline"));this.DFe=this.Cnc}this.EFe!==this.Dnc&&(a=new $v.a(a),a.fMj(this.EFe,this.Dnc,this.Rng),rp.WacAirSpace.animate(a,null,Object(m.a)(this,this.$nh,"forceInteractiveViewRefreshOutline")),
this.EFe=this.Dnc)}}$nh(){ec.InteractiveViewManager.instance.forEach(a=>{a.Fxd()})}}Object(w.a)(oI,"TaskPaneManager",Dv,[]);class nG extends oI{constructor(a,c){super(a,c);this.BN=qc.KeyInputManager.mb(vb.a.Sv,0);this.DN=qc.KeyInputManager.mb(vb.a.Sv,4);this.Aye=this.pnc=null;this.$sg="AccCheckerTaskPane";this.ma=new Rd.a;this.isPaneOpen=!1;this.B$d=this.oie=null;this.pwa(0,"SampleTaskPane");this.pwa(0,ln.a.O$a);this.pwa(1,ln.a.YQj);this.pwa(1,"CustomTaskPane");this.pwa(1,ln.a.Mgf);this.pwa(1,Fc.AFrame.aq);
this.pwa(1,Fc.AFrame.NMg);this.pwa(1,Fc.AFrame.IMg);this.pwa(1,ln.a.Kxd);this.pwa(1,ln.a.szc);this.pwa(1,ln.a.XAc);this.Ujj=(this.P9f=!!l.AFrameworkApplication.na&&!!l.AFrameworkApplication.na.Ya)&&l.AFrameworkApplication.na.Ya.qlf;this.$ij=S.App.QAb;this.hjj=this.P9f&&l.AFrameworkApplication.na.Ya.IVh;this.initialize();a.Aa(ba.a.ETf,ic.a.application,nG.ETf,96)}get bSh(){null==this.B$d&&(this.B$d=l.AFrameworkApplication.K?l.AFrameworkApplication.K.getBooleanFeatureGate("Microsoft.Office.WordOnline.ExternalContentFloatiePositionIsEnabled",
!1):!1);return this.B$d}get $Yd(){if(!Eb.App.oa||!Eb.App.oa.vA)return null;this.Aye||(this.Aye=new tF(Eb.App.oa.vA,nc.FocusManager.instance()));return this.Aye}eb(){}Idi(a,c){const h=pj.a.instance,v=nc.FocusManager.instance(),B=Pl.EventHandlerManager.instance,X=this;Hi.UISurfaces.Ms().then(ma=>{X.pnc=X.GWb(v);let Pa;ma.renderTaskPaneGroups(a,c,(Pa=new fP,Pa.middleContainer=Eb.App.oa.vA,Pa.onTabStripFocus=()=>{v.rA(ln.a.wbc)},Pa.onOpen=(mb,Tb)=>{X.rlf(mb)&&gP.dak(mb,Tb);B.nHe(Tb,"focus",X.iCh(mb,v),
!0);var rc=X.ETh(mb),Tc=ma.selectors.getTabbedTaskPaneCount(rc?1:2);rc=rc?ln.a.j4d:ln.a.wbc;1===Tc&&(h.mwa(rc),this.isPaneOpen=!0,this.kmi({isPaneOpen:this.isPaneOpen,XXc:Tb}));Tb=X.G7e(mb);if(Tc=v.fd(Tb))Tc.txc=rc,X.Apn(mb)&&(Tc.Bp(X.BN),Tc.Bp(X.DN)),h.qSh(Tb)&&h.Bv(Tb);this.bSh&&this.Tvd&&this.Tvd.Ty(!0)},Pa.onClose=(mb,Tb)=>{X.rlf(mb);const rc=X.ETh(mb),Tc=rc?ln.a.j4d:ln.a.wbc;ma.selectors.getTabbedTaskPaneCount(rc?1:2)||(h.Bv(Tc),this.isPaneOpen=!1,this.kmi({isPaneOpen:this.isPaneOpen,XXc:Tb}));
B.RJf(Tb,"focus",X.iCh(mb,v),!0);this.bSh&&this.Tvd&&this.Tvd.Ty(!0)},Pa.setFocusCallback=(mb,Tb)=>{X.rlf(mb)&&Tb&&(mb=v.fd(X.G7e(mb)),mb.b7j(),mb.iba(Tb))},Pa.onOverflowMenuOpen=()=>{if(X.pnc)X.pnc.onMenuOpen()},Pa.onOverflowMenuClose=()=>{if(X.pnc)X.pnc.onMenuClose()},Pa.onShow=(mb,Tb)=>{2===Tb&&window.requestAnimationFrame(()=>{window.setTimeout(()=>{v.Kf(mb)},0)})},Pa.onHide=(mb,Tb,rc)=>{rc&&1!==Tb&&v.Kf(v.$Q)},Pa.onResizeStart=()=>{if(Eb.App.oa&&(Eb.App.oa.vA.className=If.AppFrame.$1f,X.$Yd))X.$Yd.onMenuOpen()},
Pa.onResizeEnd=()=>{if(Eb.App.oa&&(al.a.SVh()||(Eb.App.oa.vA.className+=" "+Eb.App.oa.S_g),X.$Yd))X.$Yd.onMenuClose()},Pa));this.Bea(ln.a.wbc,v,c,X);this.Bea(ln.a.j4d,v,a,X);return null})}Bea(a,c,h,v){const B=c.fd(a);B.parent=Fc.AFrame.uo;B.rK=!0;ah.a.instance.lwa(a,h,!1);im.a.instance.lwa(a,h,!1);a=new He.DOMFocusListing(()=>h);a.vn(3);a.vn(2);a.vn(4);a.vn(1);c.qha(()=>h,B,a).mV=!0;B.Bp(v.BN);B.Bp(v.DN)}G7e(a){return a===this.$sg?ln.a.ZLg:a}iCh(a,c){return()=>{c.rA(this.G7e(a))}}Apn(a){return a===
this.$sg?!1:!0}YKl(a){return a===ln.a.O$a}rlf(a){return this.YKl(a)||a===ln.a.ZLg||0<=a.indexOf("AppForOfficePanel")||a===ln.a.Kxd||a===ln.a.Mgf&&this.Ujj||a===ln.a.szc&&this.$ij||a===ln.a.XAc&&this.hjj||a===$Q.a.mwb?!0:!1}ETh(a){return a===ln.a.O$a||"SampleTaskPane"===a}static vil(){return new nG(l.AFrameworkApplication.pa,l.AFrameworkApplication.isRtl)}static ETf(a,c,h,v,B){if(1===h)return 32;Hi.UISurfaces.Ms().then(X=>{X.showTaskPane(B,Object.assign(new qn.a,{title:"Sample Task Pane",width:320,
location:2,contentProps:Object.assign(new hP,{type:"SampleTaskPaneProps"})}));return null});return 32}RGa(a){this.ma.addHandler("onPaneToggle",a)}bTc(a){this.ma.removeHandler("onPaneToggle",a)}kmi(a){this.ma.raiseEvent("onPaneToggle",a)}get Tvd(){this.oie||(this.oie=xa.a.instance.ra("WordEditor.Actors.ExternalContentFloatieEventManager"));return this.oie}}Object(w.a)(nG,"TaskPaneManager",oI,[380]);class jP{constructor(){this.EQ=null}get name(){return"WordEditor.TaskPaneManager"}yb(){}init(){this.EQ=
nG.vil();this.EQ.eb();Eb.App.oa.sib=this.EQ}dispose(){}}Object(w.a)(jP,"PackageManager",null,[1,2]);Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI.Controls.SearchBoxComponents");Type.registerNamespace("CommandUI.React");Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4CS");Type.registerNamespace("B4IE");Type.registerNamespace("B4Im");Type.registerNamespace("B4Intent");
Type.registerNamespace("B4LE");Type.registerNamespace("B4NLE");Type.registerNamespace("B4OLE");Type.registerNamespace("B4S");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TaE");Type.registerNamespace("B4UI");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4.AtMentions");Type.registerNamespace("Box4.AugmentationLoop");Type.registerNamespace("Box4.AugmentationLoop.TilingSchema");Type.registerNamespace("Box4.ClipArt");Type.registerNamespace("Box4.Clipboard");
Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.Media");Type.registerNamespace("Box4.Proofing");Type.registerNamespace("Box4.TaskPaneManager");Type.registerNamespace("Box4.WorkerShared");Type.registerNamespace("Box4.Workers");Type.registerNamespace("CanvasAtMentions");Type.registerNamespace("Common.App.CatchUpActivity");Type.registerNamespace("GC2");Type.registerNamespace("PUTSOMETHINGHERE");
Type.registerNamespace("WEAc");Type.registerNamespace("WEB");Type.registerNamespace("WECX");Type.registerNamespace("WEDCE");Type.registerNamespace("WEIE");Type.registerNamespace("WEIL");Type.registerNamespace("WELE");Type.registerNamespace("WENLE");Type.registerNamespace("WEOLE");Type.registerNamespace("WETaE");Type.registerNamespace("WEUI");Type.registerNamespace("Wac.Common");Type.registerNamespace("Wac.Common.Actors");Type.registerNamespace("Wac.Common.SendUsYourFile");Type.registerNamespace("Wonca.UI");
Type.registerNamespace("WordEditor.AtMentions");Type.registerNamespace("WordEditor.CanvasContextualProvider");Type.registerNamespace("WordEditor.CatchUpActivity");Type.registerNamespace("WordEditor.CatchUpActivity.NetworkShared");Type.registerNamespace("WordEditor.ContextualSearch");Type.registerNamespace("WordEditor.CritiqueCounts");Type.registerNamespace("WordEditor.Designer.Common");Type.registerNamespace("WordEditor.Designer.Common.AL");Type.registerNamespace("WordEditor.Designer.Common.Conditions");
Type.registerNamespace("WordEditor.Designer.Common.Review");Type.registerNamespace("WordEditor.DocumentUnderstanding.RLM");Type.registerNamespace("WordEditor.Embed");Type.registerNamespace("WordEditor.FindReplace");Type.registerNamespace("WordEditor.FootnoteEndnote");Type.registerNamespace("WordEditor.FootnoteEndnoteInteractive");Type.registerNamespace("WordEditor.Goals");Type.registerNamespace("WordEditor.GraphicsEditor");Type.registerNamespace("WordEditor.HeaderFooter");Type.registerNamespace("WordEditor.Insights");
Type.registerNamespace("WordEditor.IntelligentPlaceholder");Type.registerNamespace("WordEditor.RibbonIntelligence");Type.registerNamespace("WordEditor.Ruler");Type.registerNamespace("WordEditor.SendUsYourFile");Type.registerNamespace("WordEditor.SignalAggregator");Type.registerNamespace("WordEditor.TableStyle");Type.registerNamespace("WordEditor.TaskPaneManager");Type.registerNamespace("WordEditor.Tasks");Type.registerNamespace("WordEditor.WordCount");Type.registerNamespace("WordEditor.WorkerShared");
Type.registerNamespace("WordEditor.Workers");Type.registerNamespace("Common.App.AccountSwitching");Q.main();Type.registerNamespace("Common.App.WopiIdentity");la.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Rb.main();Type.registerNamespace("WordEditor.Comments");Type.registerNamespace("WordEditor.CommentsInteractive");Type.registerNamespace("Common.App.OAuth");LH.main();UH.main();VH.main();M.a.instance.Lb(new jP);M.a.instance.Lb(new eP);M.a.instance.Lb(new aP);
M.a.instance.Lb(new mG);Nb.main();lc.main();Lc.main();IH.main();Type.registerNamespace("Common.App.AccessibilityHelpDialog");Type.registerNamespace("Common.App.ActivityAggregator");Ue.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("Common");id.main();Type.registerNamespace("Common.App.WildFire");Oc.main();Type.registerNamespace("Common.App.BrowserInfoLogger");
Je.main();Type.registerNamespace("Common.App.HostNotification");pi.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.FloatPane");ik.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");Type.registerNamespace("Common.App.LivePersonaUtils");Jg.main();Type.registerNamespace("CNT");Xl.main();Type.registerNamespace("Common.App.NewAndOpen.Core");M.a.instance.Lb(new bg);Type.registerNamespace("Common.App.NewAndOpen.UX");
M.a.instance.Lb(new zn);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Pe.main();Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SafeLinks");Type.registerNamespace("Common.App.SafeLinks");fc.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Ak.main();Type.registerNamespace("Common.App.TaskPaneManager");Type.registerNamespace("CAUI");Hb.main();
Type.registerNamespace("CADWLTR");bd.main();Type.registerNamespace("Common.App.DirectPrint");M.a.instance.Lb(new Bk);Type.registerNamespace("Common.App.SearchOAuthManager");Sf.main();Td.main();Dh.main();di.main();nj.main();Cg.main();mi.main();M.a.instance.Lb(new Jo);Nd.main();be.main();El.main();M.a.instance.Lb(new Pp);Type.registerNamespace("Common.App.SaveStatus");M.a.instance.Lb(new hm);Type.registerNamespace("Common.App.EventsCacheManager");Al.main();Type.registerNamespace("CUIB");jo.main();Type.registerNamespace("CommandUI.TaskPane");
try{M.a.instance.Lb(new bf(Eb.App.oa.Da))}catch(a){r.ULS.shipAssertTag(575930383,3016,!1,a.message)}Jn.main();Type.registerNamespace("Common.App.Insights");rn;M.a.instance.Lb(new On);Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.CommentsSmartReply");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AugmentationLoop.SDX");sn("Begin");M.a.instance.Lb(new Ip);try{M.a.instance.Lb(new Zt(ck.a.get_instance(),
Eb.App.oa.Da,Eb.App.oa.Ya))}catch(a){r.ULS.shipAssertTag(575930384,3016,!1,a.message)}Kb.main();M.a.instance.Lb(new se);zq.main();cj.main();ij.main();Ft.main();kv.main();Kv.main();Nw.main();ux.main();M.a.instance.Lb(new Tu);lu.main();Xz.main();bw.main();Dt.main();KH.main();M.a.instance.Lb(new xx);M.a.instance.Lb(new oy);TA.main();VA.main();Ds.main();M.a.instance.Lb(new PB);M.a.instance.Lb(new RB);bB;Od.main();Bg.main();Ep.main();IC.main();QE;M.a.instance.Lb(new rA);M.a.instance.Lb(new zv);KC.main();
jr.main();Fz.main();M.a.instance.Lb(new tI);M.a.instance.Lb(new EI);Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=dv;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");zG.main();BG.main();CG.main();rP;ZG.main();SP;window.MSOJS=vB;wH.main();zH.main();M.a.instance.Lb(new eN);M.a.instance.Lb(new gN);(()=>Object(ew.__awaiter)(void 0,
void 0,void 0,function*(){l.AFrameworkApplication.K.$("WPMPackageIsEnabled")&&(yield b.e(14).then(b.bind(null,1813)).then(a=>{a.initializeOnDemandPackage()}))}))()},645:function(G,P,b){Object.defineProperty(P,"__esModule",{value:!0});var k=b(77);k.__exportStar(b(834),P);k.__exportStar(b(1063),P);k.__exportStar(b(835),P);k.__exportStar(b(1064),P);k.__exportStar(b(1065),P);k.__exportStar(b(1066),P);G.exports.getChangeGateDictionary||Object.defineProperty(G.exports,"getChangeGateDictionary",{enumerable:!0,
get:function(){return G.exports.xrh}});G.exports.getFeatureGateDictionary||Object.defineProperty(G.exports,"getFeatureGateDictionary",{enumerable:!0,get:function(){return G.exports.wuh}});G.exports.makeGetTypedFeatureGate||Object.defineProperty(G.exports,"makeGetTypedFeatureGate",{enumerable:!0,get:function(){return G.exports.F3h}});G.exports.makeTypedIsChangeGateEnabled||Object.defineProperty(G.exports,"makeTypedIsChangeGateEnabled",{enumerable:!0,get:function(){return G.exports.L3h}})},773:function(G,
P,b){function k(){return b(773)}function f(Ua){for(var Lb=[],Va=1;Va<arguments.length;Va++)Lb[Va-1]=arguments[Va];return f.RYc.apply(f,Object(sa.__spreadArray)([Ua,void 0],Lb,!1))}function x(Ua){return u(Ua)&&"WorkerError"===Ua.name&&"object"===typeof Ua.info}function u(Ua){return null==Ua?!1:Ua instanceof Error?!0:"string"===typeof Ua.name&&"string"===typeof Ua.message&&(null==Ua.stack||"string"===typeof Ua.stack)}function w(Ua){if(u(Ua))var Lb=Ua;else{Lb=Error;var Va="(non-Error object) ".concat;
a:{var Sb=typeof Ua;switch(Sb){case "function":case "symbol":case "undefined":Ua="<".concat(Sb,">");break a;case "object":Ua=JSON.stringify(Ua);break a;default:Ua="".concat(Ua)}}Lb=Lb(Va.call("(non-Error object) ",Ua))}return Lb}function r(Ua){var Lb=Ua.name,Va=x(Ua)?Ua.KSj:Ua.message,Sb=Ua.stack;x(Ua)?(Ua=Ua.info,Ua=Object(sa.__assign)(Object(sa.__assign)({},Ua),{error:Ua.error?r(Ua.error):void 0})):Ua=void 0;return{name:Lb,message:Va,stack:Sb,info:Ua}}function m(Ua){return u(Ua)?{Tca:!0,value:r(Ua)}:
{Tca:!1,value:Ua}}function l(Ua){if("WorkerError"===Ua.name){var Lb=Ua.message;var Va=Ua.info;Va=Object(sa.__assign)(Object(sa.__assign)({},Va),{error:Va.error?l(Va.error):void 0});Lb=new qa(Lb,Va)}else(Lb=va[Ua.name])?Lb=new Lb(Ua.message):(Lb=Error(Ua.message),Lb.name=Ua.name);null!=Ua.stack&&(Lb.stack=Ua.stack);return Lb}function z(Ua){return Ua.Tca?l(Ua.value):Ua.value}function F(){return"undefined"!==typeof Blob&&"undefined"!==typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&
"undefined"!==typeof Worker}function L(Ua){if(Ca)throw new TypeError("setConfig has already been called");Ca=Ua}function E(){var Ua=null!==Ca&&void 0!==Ca?Ca:{};return{createTimeout:Ua.createTimeout,createMode:Ua.createMode,importScriptUrls:Ua.importScriptUrls?Object(sa.__spreadArray)([],Ua.importScriptUrls,!0):void 0,typedWorkersUrl:Ua.typedWorkersUrl,typedWorkersName:Ua.typedWorkersName,Qef:Ua.Qef}}function A(Ua){var Lb,Va;return null!==(Va=null!==(Lb=null===Ua||void 0===Ua?void 0:Ua.createTimeout)&&
void 0!==Lb?Lb:null===Ca||void 0===Ca?void 0:Ca.createTimeout)&&void 0!==Va?Va:3E5}function M(Ua){var Lb,Va;Ua=null!==(Va=null!==(Lb=null===Ua||void 0===Ua?void 0:Ua.createMode)&&void 0!==Lb?Lb:null===Ca||void 0===Ca?void 0:Ca.createMode)&&void 0!==Va?Va:"Thread";return"ThreadOrLocal"===Ua?F()?"Thread":"Local":Ua}function Q(Ua){setTimeout(function(){throw Ua;})}function R(){return"undefined"!==typeof self&&"__typed_workers_thread"in self?self:void 0}function K(Ua){var Lb=R();void 0!==Lb?(Ua={kind:1,
error:m(Ua)},Lb.postMessage(Ua)):console.warn(Ua)}function J(Ua){var Lb;try{(null!==(Lb=null===Ca||void 0===Ca?void 0:Ca.jao)&&void 0!==Lb?Lb:K)(Ua)}catch(Va){console.warn(Ua),Q(Va)}}function O(Ua){var Lb=R();void 0!==Lb&&Lb.postMessage({kind:2,stats:Ua})}function N(Ua){var Lb;try{(null!==(Lb=null===Ca||void 0===Ca?void 0:Ca.F$n)&&void 0!==Lb?Lb:O)(Ua)}catch(Va){Q(Va)}}function V(Ua,Lb){return Ua.then(function(Va){Lb();return Va},function(Va){Lb();return Promise.reject(Va)})}function W(Ua,Lb,Va){if(1073741824<
Ua)return Va;var Sb=setTimeout(Lb,Math.max(0,Ua));return{resolve:function(nb){clearTimeout(Sb);Va.resolve(nb)},reject:function(nb){clearTimeout(Sb);Va.reject(nb)}}}function ca(){var Ua=Object.create(null);Ua.key=void 0;delete Ua.key;return Ua}function H(){try{return"function"===typeof Proxy&&!0===(new Proxy({},{get:function(){return!0}})).k}catch(Ua){return!1}}function Z(Ua,Lb){var Va=ca(),Sb=Wa("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(nb,La){var Ha;return"then"===La?void 0:null!==
(Ha=nb[La])&&void 0!==Ha?Ha:nb[La]=Ua(La)}:function(nb,La){var Ha;return null!==(Ha=nb[La])&&void 0!==Ha?Ha:nb[La]=Ua(La)};if(!Lb)return new Proxy(Va,{get:Sb});Lb.forEach(function(nb){return Sb(Va,nb)});return Va}function aa(Ua){throw Ua;}function ja(){return{status:"Pending",start:Db()}}function Ba(Ua,Lb,Va){"Pending"===Ua.status&&(Ua.status=Lb,Ua.end=Math.max(Ua.start,null!==Va&&void 0!==Va?Va:Db()))}function la(Ua,Lb){function Va(Sb){Ba(Ua,x(Sb)&&"Timeout"===Sb.info.ZW?"Timeout":"Error");throw Sb;
}try{return Lb().then(function(Sb){var nb;return null!==(nb=Ba(Ua,"Success"))&&void 0!==nb?nb:Sb},Va)}catch(Sb){Va(Sb)}}function ia(Ua,Lb,Va){var Sb,nb,La,Ha=null!==(Sb=null===Ua||void 0===Ua?void 0:Ua.start)&&void 0!==Sb?Sb:Infinity;Sb=Ha<Lb?Lb:Ha>Va?Va:Ha;Ha=null!==(nb=null===Ua||void 0===Ua?void 0:Ua.end)&&void 0!==nb?nb:Infinity;Va=Ha<Lb?Lb:Ha>Va?Va:Ha;return{status:null!==(La=null===Ua||void 0===Ua?void 0:Ua.status)&&void 0!==La?La:"Pending",start:Math.round(1E3*(Sb-Lb))/1E3,end:Math.round(1E3*
(Va-Lb))/1E3,duration:Math.round(1E3*(Va-Sb))/1E3}}function oa(Ua,Lb,Va){Va="def"in Va?Va:f(Va);var Sb=Va.def,nb=Va.args;return"function"!==typeof Sb?Promise.reject(new qa("Loading an InsideScript to create a local worker is unimplemented",{ZW:"InternalError",gB:{type:"Endpoint",bHb:"Inside",id:Ua.options.id}})):Promise.resolve().then(function(){return la(Lb.Kgf=ja(),function(){return Sb.apply(void 0,Object(sa.__spreadArray)([{config:E(),importTypedWorkers:k,connection:Ua}],nb,!1)).then(function(){})})})}
function ha(Ua,Lb,Va,Sb,nb){var La=new MessageChannel,Ha=La.port2,Aa;return Promise.all([Sb({port:La.port1,options:Ua,createMode:Lb}),la(Va.Ord=ja(),function(){return xa.Ord({port:Ha,options:Ua,createMode:Lb},function(Ma){return nb(Aa=Ma)})})]).then(function(){return Aa},function(Ma){Aa?Aa.close("Force"):Ha.close();return Promise.reject(Ma)})}function pa(Ua,Lb,Va,Sb){return ha(Ua,"Local",Lb,function(nb){return oa(nb,Lb,Va)},Sb)}function Ea(Ua,Lb,Va,Sb){Lb.asd=ja();try{var nb=new pb(Ua,Va)}catch(La){return Ba(Lb.asd,
"Error"),Promise.reject(La)}Ba(Lb.asd,"Success");return ha(Ua,"Thread",Lb,function(La){return nb.iUe(La,Lb)},Sb).then(function(La){La.bsl()?nb.terminate():La.Unj=nb.terminate.bind(nb);return La},function(La){nb.terminate();return Promise.reject(La)})}function Fa(Ua,Lb,Va){void 0===Va&&(Va=function(){});var Sb=M(Ua),nb="local"in Lb?"Local"===Sb?Lb.local:Lb.aDn:Lb,La="Local"===Sb?pa:Ea,Ha={id:Ua.id,createMode:Sb,aVe:ja()};Lb=la(Ha.aVe,function(){return La({id:Ua.id,createTimeout:Ua.createTimeout,createMode:Ua.createMode,
importScriptUrls:Ua.importScriptUrls,Qef:Ua.Qef},Ha,nb,Va)});return V(Lb,function(){var Aa=Ha.createMode;var Ma=Ha.aVe,cb=Ha.Kgf,ib=Ha.Ord,Rb=Ha.asd,Oa=Ma.status,lb=Ma.start;Ma=Ma.end;Aa="Pending"!==Oa&&void 0!==Ma?{id:Ha.id,createMode:Aa,aVe:{status:Oa,I3n:lb,duration:Math.round(1E3*(Ma-lb))/1E3},asd:"Thread"===Aa?ia(Rb,lb,Ma):void 0,Ord:ia(ib,lb,Ma),Kgf:ia(cb,lb,Ma)}:void 0;Aa&&N(Aa)})}function Ga(Ua,Lb){if(0===Lb)importScripts.apply(void 0,Ua);else for(var Va=0;Va<Ua.length;Va++)a:{for(var Sb=
void 0,nb=Ua[Va],La=Lb,Ha=0;Ha<=La;Ha+=1)try{Sb=importScripts;if(0<Ha){var Aa=nb,Ma=String(Ha),cb=Aa.indexOf("?");if(0>cb)var ib="".concat(Aa,"?").concat("retries","=").concat(Ma);else{var Rb=Aa.slice(0,cb+1),Oa=Aa.slice(cb+1).split("&");for(Aa=0;Aa<Oa.length&&("="!==Oa[Aa][7]||"retries"!==Oa[Aa].slice(0,7));Aa+=1);Oa[Aa]="".concat("retries","=").concat(Ma);ib=Rb+Oa.join("&")}}else ib=nb;Sb(ib);break a}catch(lb){Sb=lb}throw Sb;}}function $a(){return"undefined"!==typeof WorkerGlobalScope}function fa(){return self.name}
b.r(P);var sa=b(77),qa=function(Ua){function Lb(Va,Sb){var nb=this.constructor,La;var Ha=Ua.call(this,"".concat(Va,"; info = ").concat(JSON.stringify(Object(sa.__assign)(Object(sa.__assign)({},Sb),{error:null===(La=Sb.error)||void 0===La?void 0:La.message}))))||this;Ha.KSj=Va;Ha.info=Sb;Ha.name="WorkerError";Va=nb.prototype;Object.getPrototypeOf(Ha)!==Va&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(Ha,Va):Ha.__proto__=Va);return Ha}Object(sa.__extends)(Lb,Ua);return Lb}(Error),va={Error,EvalError,
RangeError,ReferenceError,SyntaxError,TypeError,URIError},Ca;f.RYc=function(Ua,Lb){for(var Va=[],Sb=2;Sb<arguments.length;Sb++)Va[Sb-2]=arguments[Sb];return{def:Ua,args:Va,transferables:null!==Lb&&void 0!==Lb?Lb:[]}};var ta=b(645),Wa=Object(ta.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(ta.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});var Za,Ya=-1,Ka=function(){function Ua(Lb,Va){function Sb(){var cb;return null===
(cb=Ha.onClose)||void 0===cb?void 0:cb.call(Ha)}var nb,La,Ha=this;this.gB=Lb;this.port=Va;this.xIc=!1;this.exports={};this.rZc=ca();var Aa=(nb={},nb[0]=this.lRd.bind(this),nb[1]=this.onResult.bind(this),nb[2]=function(cb){var ib;cb=cb.tOk;null===(ib=Ha.Nom)||void 0===ib?void 0:ib.call(Ha,Z(Ha.Qkk.bind(Ha),cb),Z(Ha.sgk.bind(Ha),cb))},nb[3]=Sb,nb),Ma=(La={},La[0]=this.Ism.bind(this),La[1]=this.Zci.bind(this),La[2]=Sb,La[3]=Sb,La);this.port.onmessage=function(cb){cb=cb.data;return Aa[cb.kind](cb)};this.port.onmessageerror=
function(cb){cb=cb.data;return Ma[cb.kind](cb)}}Ua.prototype.Odn=function(Lb){this.exports=Lb;if(null!==Za&&void 0!==Za?Za:Za=H())Lb=void 0;else{for(var Va=ca();null!=Lb;){for(var Sb=0,nb=Object.getOwnPropertyNames(Lb);Sb<nb.length;Sb++){var La=nb[Sb];try{"function"===typeof Lb[La]&&(Va[La]=!0)}catch(Ha){}}Lb=Object.getPrototypeOf(Lb)}Lb=Object.getOwnPropertyNames(Va)}this.port.postMessage({kind:2,tOk:Lb})};Ua.prototype.close=function(){if(!this.xIc){this.xIc=!0;this.port.postMessage({kind:3});this.port.close();
for(var Lb in this.rZc){var Va=this.rZc[Lb],Sb=Va.reject;Va=Va.qX;Va=new qa("Importing Endpoint closed while waiting for ".concat(Va," result"),{ZW:"Connection",gB:this.gB,qX:Va});Sb(Va)}}};Ua.prototype.lRd=function(Lb){var Va=this,Sb=Lb.yba,nb=Lb.qX,La=Lb.args;Lb=Promise.resolve().then(function(){var Ha=Va.exports[nb];if(Ha)return Ha.apply(Va.exports,La);throw new qa("Exporting Endpoint received a ".concat(0<=Sb?"call":"post"," to unknown function ").concat(nb),{ZW:"Connection",gB:Va.gB,yba:Sb,qX:nb});
});0<=Sb?Lb.then(function(Ha){return Va.GOf(Sb,nb,!0,Ha)},function(Ha){return Va.GOf(Sb,nb,!1,Ha)}):Lb.catch(function(Ha){Ha=w(Ha);J(new qa("Exporting Endpoint's ".concat(nb," implementation threw or rejected"),{ZW:"UnhandledError",gB:Va.gB,error:Ha,yba:Sb,qX:nb}))})};Ua.prototype.GOf=function(Lb,Va,Sb,nb){nb=m(nb);Lb={kind:1,yba:Lb,qX:Va,OLl:Sb,$ui:nb};try{this.port.postMessage(Lb,void 0)}catch(La){this.Zci(Lb,w(La))}};Ua.prototype.Zci=function(Lb,Va){var Sb=Lb.yba,nb=Lb.qX;Lb=Lb.$ui;Va=new qa(Va?
"Exporting Endpoint failed to send ".concat(nb," result"):"Importing Endpoint failed to deserialize ".concat(nb," result"),{ZW:"MessageError",gB:this.gB,error:Va,yba:Sb,qX:nb});Lb.Tca?J(Va):this.GOf(Sb,nb,!1,Va)};Ua.prototype.H4d=function(Lb){var Va=this.rZc[Lb];Va&&delete this.rZc[Lb];return Va};Ua.prototype.jcn=function(Lb,Va,Sb,nb){var La=this;return 1073741824<Sb?nb:W(Sb,function(){var Ha=La.H4d(Lb);Ha&&Ha.reject(new qa("Importing Endpoint's call to ".concat(Va," timed out"),{ZW:"Timeout",gB:La.gB,
timeout:Sb,yba:Lb,qX:Va}))},nb)};Ua.prototype.g$m=function(Lb,Va,Sb,nb){var La=this;return new Promise(function(Ha,Aa){var Ma=Ya+=1,cb={kind:0,yba:Ma,qX:Lb,args:Va};La.rZc[Ma]=Object(sa.__assign)(Object(sa.__assign)({},La.jcn(Ma,Lb,Sb,{resolve:Ha,reject:Aa})),{qX:Lb});try{La.port.postMessage(cb,nb)}catch(ib){if(Ha=La.H4d(Ma))Aa=w(ib),Ha.reject(new qa("Importing Endpoint failed to send call to ".concat(Lb),{ZW:"MessageError",gB:La.gB,error:Aa,yba:Ma,qX:Lb}))}})};Ua.prototype.V$m=function(Lb,Va,Sb,
nb){Va={kind:0,yba:-1,qX:Lb,args:Va};try{this.port.postMessage(Va,nb)}catch(La){nb=w(La),Sb(new qa("Importing Endpoint failed to post to ".concat(Lb),{ZW:"MessageError",gB:this.gB,error:nb,yba:-1,qX:Lb}))}};Ua.prototype.Ism=function(Lb){var Va,Sb=Lb.yba;Lb=Lb.qX;Lb=new qa("Exporting Endpoint failed to deserialize ".concat(0<=Sb?"call":"post"," to ").concat(Lb),{ZW:"MessageError",gB:this.gB,yba:Sb,qX:Lb});Sb=0<=Sb?this.H4d(Sb):void 0;(null!==(Va=null===Sb||void 0===Sb?void 0:Sb.reject)&&void 0!==Va?
Va:J)(Lb)};Ua.prototype.onResult=function(Lb){var Va=Lb.yba,Sb=Lb.qX,nb=Lb.OLl;Lb=Lb.$ui;0<=Va?(Va=this.H4d(Va))&&(nb?Va.resolve:Va.reject)(z(Lb)):J(new qa("Exporting Endpoint sent a result for a post to ".concat(Sb),{ZW:"InternalError",gB:this.gB,yba:Va,qX:Sb}))};Ua.prototype.Qkk=function(Lb){function Va(){for(var nb=[],La=0;La<arguments.length;La++)nb[La]=arguments[La];return Va.RYc.apply(Va,Object(sa.__spreadArray)([void 0],nb,!1))}var Sb=this;Va.RYc=function(nb){for(var La,Ha,Aa,Ma=[],cb=1;cb<
arguments.length;cb++)Ma[cb-1]=arguments[cb];Sb.xIc||(cb=null!==(Aa=null!==(La=Va.gci)&&void 0!==La?La:null===(Ha=Sb.n9k)||void 0===Ha?void 0:Ha.call(Sb))&&void 0!==Aa?Aa:aa,Sb.V$m(Lb,Ma,cb,nb))};return Va};Ua.prototype.sgk=function(Lb){function Va(){for(var nb=[],La=0;La<arguments.length;La++)nb[La]=arguments[La];return Va.RYc.apply(Va,Object(sa.__spreadArray)([void 0],nb,!1))}var Sb=this;Va.RYc=function(nb){for(var La,Ha,Aa,Ma=[],cb=1;cb<arguments.length;cb++)Ma[cb-1]=arguments[cb];if(Sb.xIc)return Promise.reject(new qa("".concat(Sb.gB.bHb,
" Endpoint's call.").concat(Lb," called after close"),{ZW:"Connection",gB:Sb.gB,qX:Lb}));cb=null!==(Aa=null!==(La=Va.kOe)&&void 0!==La?La:null===(Ha=Sb.XTk)||void 0===Ha?void 0:Ha.call(Sb))&&void 0!==Aa?Aa:Infinity;return Sb.g$m(Lb,Ma,cb,nb)};Va.kOe=void 0;return Va};return Ua}(),xa=function(){function Ua(Lb,Va,Sb){function nb(La){return function(){throw new qa("".concat(Lb.bHb," Endpoint's ").concat(La," referenced before the ").concat("Outside"===Lb.bHb?"inside":"outside"," Endpoint started"),{ZW:"Connection",
gB:Lb});}}this.kOe=Infinity;this.gci=aa;this.Q7c=Lb;this._state=Va;this.createMode=Sb;Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:nb("post")},call:{configurable:!0,enumerable:!1,get:nb("call")}})}Ua.Hdg=function(Lb,Va,Sb){var nb=Va.port,La=Va.options;Va=Va.createMode;var Ha={type:"Endpoint",bHb:Lb,id:null===La||void 0===La?void 0:La.id};try{var Aa=new Ka(Ha,nb);var Ma=new Ua(Ha,Aa,Va)}catch(cb){return Promise.reject(cb)}return(new Promise(function(cb,ib){var Rb;Aa.XTk=function(){return Ma.kOe};
Aa.n9k=function(){return Ma.gci};Aa.Nom=function(Nb,qc){Object.defineProperties(Ma,{post:{configurable:!0,enumerable:!1,writable:!1,value:Nb},call:{configurable:!0,enumerable:!1,writable:!1,value:qc}});lb.resolve()};Aa.onClose=function(){return Ma.close("Force")};var Oa=A(La),lb=W(Oa,function(){var Nb=new qa("".concat(Lb," Endpoint timed out waiting for the ").concat("Outside"===Lb?"inside":"outside"," to start"),{ZW:"Timeout",gB:Ha,timeout:Oa});lb.reject(Nb)},{resolve:cb,reject:ib});Ma.K2c=function(){lb.resolve()};
try{var gb=Sb(Ma)}catch(Nb){return lb.reject(Nb)}null===(Rb=Ma._state)||void 0===Rb?void 0:Rb.Odn(gb)})).then(function(){Ma.K2c=void 0;return Ma},function(cb){Ma.K2c=void 0;Ma.close();return Promise.reject(cb)})};Ua.prototype.bsl=function(){return void 0===this._state};Ua.prototype.close=function(Lb){var Va;if(this._state){if(this.K2c)if("Force"===Lb)this.K2c();else{var Sb={ZW:"Connection",gB:this.Q7c};throw new qa("".concat(this.Q7c.bHb," Endpoint's close called during creation"),Sb);}Lb=this._state;
this._state=void 0;try{Lb.close(),null===(Sb=this.Unj)||void 0===Sb?void 0:Sb.call(this),null===(Va=this.onClose)||void 0===Va?void 0:Va.call(this)}catch(nb){Sb={ZW:"Connection",gB:this.Q7c,error:w(nb)},J(new qa("".concat(this.Q7c.bHb," Endpoint's close threw an error"),Sb))}}};Ua.Ord=function(Lb,Va){void 0===Va&&(Va=function(){});return Ua.Hdg("Outside",Lb,Va)};Ua.iUe=function(Lb,Va){return Ua.Hdg("Inside",Lb,Va)};return Ua}(),Sa=-1,pb=function(){function Ua(Lb,Va){var Sb;try{var nb=void 0;var La=
"def"in Va?Va:f(Va),Ha=La.def,Aa=La.args,Ma=La.transferables;if("function"!==typeof Ha)var cb=[Ha,Aa,Ma,void 0];else{var ib="__generatedInsideInit".concat(Sa+=1);cb=[{scriptUrl:void 0,insideInitName:ib},Aa,Ma,"var ".concat(ib," = ").concat(Ha.toString(),";")]}this.script=cb[0];this.args=cb[1];this.transferables=cb[2];nb=cb[3];this.fnd=URL.createObjectURL(new Blob(void 0===nb?['!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?null:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t,r=o();return null!==r&&(null===(t=r[e])||void 0===t||t)},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return void 0===t?(0,o.setChangeGateDictionaryGetter)(void 0):(0,o.setChangeGateDictionaryGetter)((function(){var r=t();return null===r?null:n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);']:
[nb,"\n\n",'!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?null:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t,r=o();return null!==r&&(null===(t=r[e])||void 0===t||t)},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return void 0===t?(0,o.setChangeGateDictionaryGetter)(void 0):(0,o.setChangeGateDictionaryGetter)((function(){var r=t();return null===r?null:n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);'],
{type:"application/javascript"}));Va={};null!=Lb.id&&(Va.name=Lb.id);this.lfa=new Worker(this.fnd,Va)}catch(Rb){throw null===(Sb=this.lfa)||void 0===Sb?void 0:Sb.terminate(),this.yvi(),Rb;}}Ua.prototype.yvi=function(){void 0!==this.fnd&&(URL.revokeObjectURL(this.fnd),this.fnd=void 0)};Ua.prototype.iUe=function(Lb,Va){var Sb=this,nb=Lb.port,La=Lb.options,Ha={type:"Thread",bHb:"Outside",id:La.id},Aa=this.lfa;Lb=new Promise(function(Ma,cb){Sb.nWb={resolve:Ma,reject:cb};Ma={config:E(),port:nb,options:La,
script:Sb.script,args:Sb.args,featureGateDictionary:Object(ta.getFeatureGateDictionary)(),S4n:Object(ta.getChangeGateDictionary)()};Aa.postMessage(Ma,Object(sa.__spreadArray)([nb],Sb.transferables,!0));Aa.onerror=function(ib){ib.preventDefault();ib=u(ib.error)?x(ib.error)?ib.error:new qa("".concat("worker.onerror"," received an unhandled error"),{ZW:"UnhandledError",gB:Ha,error:ib.error}):null==ib.message?new qa("".concat("worker.onerror"," received a non-error (worker script fetch probably failed)"),
{ZW:"UnhandledError",gB:Ha}):new qa("".concat("worker.onerror"," received an unhandled error: ").concat("".concat(ib.message," at ").concat(ib.filename,":").concat(ib.lineno,":").concat(ib.colno)),{ZW:"UnhandledError",gB:Ha});Sb.nWb?Sb.nWb.reject(ib):J(ib)};Aa.onmessage=function(ib){var Rb,Oa;ib=ib.data;switch(ib.kind){case 0:return Va.Kgf=ib.Qv,void 0===ib.error?null===(Rb=Sb.nWb)||void 0===Rb?void 0:Rb.resolve():null===(Oa=Sb.nWb)||void 0===Oa?void 0:Oa.reject(z(ib.error));case 1:return J(z(ib.error));
case 2:return N(ib.stats)}}});return V(Lb,function(){return void(Sb.nWb=void 0)})};Ua.prototype.terminate=function(){var Lb;if(this.lfa){var Va=this.lfa;this.lfa=void 0;null===(Lb=this.nWb)||void 0===Lb?void 0:Lb.resolve();Va.terminate();this.yvi()}};return Ua}(),Db="undefined"!==typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};b.d(P,"WorkerError",function(){return qa});b.d(P,"isThreadingSupported",function(){return F});
b.d(P,"setConfig",function(){return L});b.d(P,"dispatchWorkerError",function(){return J});b.d(P,"paramInsideDef",function(){return f});b.d(P,"Endpoint",function(){return xa});b.d(P,"createWorker",function(){return Fa});b.d(P,"importScriptsWithRetry",function(){return Ga});b.d(P,"isWorkerThread",function(){return $a});b.d(P,"workerName",function(){return fa})},834:function(G,P,b){function k(){return"undefined"===typeof __get_feature_gate_dictionary_variable?u:__get_feature_gate_dictionary_variable()}
function f(w,r){var m;return null!==(m=k()[w])&&void 0!==m?m:r}Object.defineProperty(P,"__esModule",{value:!0});P.KPf=P.getIntFeatureGate=P.azh=P.getBooleanFeatureGate=P.getStringFeatureGate=P.wuh=void 0;var x=b(913),u={};P.wuh=k;P.getStringFeatureGate=f;P.getBooleanFeatureGate=function(w,r){var m;w=null===(m=f(w))||void 0===m?void 0:m.trim().toLowerCase();return"true"===w?!0:"false"===w?!1:r};P.azh=function(w,r){var m;w=null===(m=f(w))||void 0===m?void 0:m.trim().toLowerCase();if(void 0===w)return r;
if("infinity"===w||"+infinity"===w)return Infinity;if("-infinity"===w)return-Infinity;m=parseFloat(w);return isNaN(m)?r:m};P.getIntFeatureGate=function(w,r){var m;w=null===(m=f(w))||void 0===m?void 0:m.trim();if(void 0===w)return r;m=parseInt(w,10);return isNaN(m)?r:m};P.KPf=function(w){var r=x.globalThis.o6i;x.globalThis.o6i=w;return r}},835:function(G,P,b){function k(){return"undefined"===typeof __get_change_gate_dictionary_variable?null:__get_change_gate_dictionary_variable()}Object.defineProperty(P,
"__esModule",{value:!0});P.N_d=P.isChangeGateEnabled=P.xrh=void 0;var f=b(913);P.xrh=k;P.isChangeGateEnabled=function(x){var u,w=k();return null===w?!1:null!==(u=w[x])&&void 0!==u?u:!0};P.N_d=function(x){var u=f.globalThis.n6i;f.globalThis.n6i=x;return u}},847:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{constructor(){this.method=this.api=0}}Object(G.a)(k,"Message",null,[])},913:function(G,P,b){Object.defineProperty(P,"__esModule",{value:!0});P.globalThis=void 0;G=b(1060);P.globalThis=
G},923:function(G,P,b){function k(J,O=self){O.addEventListener("message",function W(V){if(V&&V.data){var {id:ca,type:H,path:Z}=Object.assign({path:[]},V.data),aa=(V.data.iUg||[]).map(m);try{const Ba=Z.slice(0,-1).reduce((ia,oa)=>ia[oa],J),la=Z.reduce((ia,oa)=>ia[oa],J);switch(H){case "GET":var ja=la;break;case "SET":Ba[Z.slice(-1)[0]]=m(V.data.value);ja=!0;break;case "APPLY":ja=la.apply(Ba,aa);break;case "CONSTRUCT":const ia=new la(...aa);ja=Object.assign(ia,{[F]:!0});break;case "ENDPOINT":const {port1:oa,
port2:ha}=new MessageChannel;k(J,ha);ja=w(oa,[oa]);break;case "RELEASE":ja=void 0;break;default:return}}catch(Ba){ja={value:Ba,[A]:0}}Promise.resolve(ja).catch(Ba=>({value:Ba,[A]:0})).then(Ba=>{const [la,ia]=r(Ba);O.postMessage(Object.assign(Object.assign({},la),{id:ca}),ia);"RELEASE"===H&&(O.removeEventListener("message",W),"MessagePort"===O.constructor.name&&O.close())})}});O.start&&O.start()}function f(J){if(J)throw Error("Proxy has been released and is not useable");}function x(J,O=[],N=function(){}){let V=
!1;const W=new Proxy(N,{get(ca,H){f(V);if(H===E)return()=>l(J,{type:"RELEASE",path:O.map(Z=>Z.toString())}).then(()=>{"MessagePort"===J.constructor.name&&J.close();V=!0});if("then"===H){if(0===O.length)return{then:()=>W};ca=l(J,{type:"GET",path:O.map(Z=>Z.toString())}).then(m);return ca.then.bind(ca)}return x(J,[...O,H])},set(ca,H,Z){f(V);const [aa,ja]=r(Z);return l(J,{type:"SET",path:[...O,H].map(Ba=>Ba.toString()),value:aa},ja).then(m)},apply(ca,H,Z){f(V);ca=O[O.length-1];if(ca===L)return l(J,{type:"ENDPOINT"}).then(m);
if("bind"===ca)return x(J,O.slice(0,-1));const [aa,ja]=u(Z);return l(J,{type:"APPLY",path:O.map(Ba=>Ba.toString()),iUg:aa},ja).then(m)},construct(ca,H){f(V);const [Z,aa]=u(H);return l(J,{type:"CONSTRUCT",path:O.map(ja=>ja.toString()),iUg:Z},aa).then(m)}});return W}function u(J){J=J.map(r);return[J.map(O=>O[0]),Array.prototype.concat.apply([],J.map(O=>O[1]))]}function w(J,O){R.set(J,O);return J}function r(J){for(const [O,N]of Q)if(N.k_g(J)){const [V,W]=N.serialize(J);return[{type:"HANDLER",name:O,
value:V},W]}return[{type:"RAW",value:J},R.get(J)||[]]}function m(J){switch(J.type){case "HANDLER":return Q.get(J.name).deserialize(J.value);case "RAW":return J.value}}function l(J,O,N){return new Promise(V=>{const W=z();J.addEventListener("message",function Z(H){H.data&&H.data.id&&H.data.id===W&&(J.removeEventListener("message",Z),V(H.data))});J.start&&J.start();J.postMessage(Object.assign({id:W},O),N)})}function z(){return Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}
G=b(0);const F=Symbol("Comlink.proxy"),L=Symbol("Comlink.endpoint"),E=Symbol("Comlink.releaseProxy"),A=Symbol("Comlink.thrown"),M=J=>"object"===typeof J&&null!==J||"function"===typeof J,Q=new Map([["proxy",{k_g:J=>M(J)&&J[F],serialize(J){const {port1:O,port2:N}=new MessageChannel;k(J,O);return[N,[N]]},deserialize(J){J.start();return x(J,[],void 0)}}],["throw",{k_g:J=>M(J)&&A in J,serialize({value:J}){return[J instanceof Error?{Tca:!0,value:{message:J.message,name:J.name,stack:J.stack}}:{Tca:!1,value:J},
[]]},deserialize(J){if(J.Tca)throw Object.assign(Error(J.value.message),J.value);throw J.value;}}]]),R=new WeakMap;b.d(P,"a",function(){return K});class K{static X5i(J){K.V3a=J;K.lAj=x(J,[],void 0)}static get Endpoint(){return K.V3a}static get Y5i(){return K.lAj}}Object(G.a)(K,"WorkerUtils",null,[])},935:function(G,P,b){b.d(P,"a",function(){return k});G=b(0);class k{}Object(G.a)(k,"WaterlineOverrideSettings",null,[])},936:function(G,P,b){function k(z){return{scriptUrl:z,insideInitName:"window.UlsWorkerService.ulsWorkerInsideInit"}}
b.r(P);b.d(P,"UlsWorkerService",function(){return m});b.d(P,"ulsWorkerInsideInit",function(){return l});b.d(P,"ulsWorkerInsideScript",function(){return k});G=b(0);var f=b(773),x=b(886),u=b(23),w=b(2),r=b(779);class m{constructor(z,F,L,E,A){this.xyj=new x.a(z,F,L,E,A)}RU(z){this.xyj.RU(z)}}Object(G.a)(m,"UlsWorkerService",null,[]);const l=({config:z,connection:F})=>{"Thread"===F.createMode&&f.setConfig(z);z=u.a.instance.ra("Common.IRefreshableAppSettings");const L=new m(r.a.Qsd,!0,w.AFrameworkApplication.fe,
null!==z&&void 0!==z?z:w.AFrameworkApplication.K,z);return f.Endpoint.iUe(F,()=>L)}},937:function(G,P,b){G=b(0);var k=b(466),f=b(500),x=b(626),u=b(229);class w extends u.a{constructor(){super();this.LowWaterline=this.HighWaterline=this.FileId=null}ol(){return 97}static L7(L,E,A){const M=new w;M.FileId=L;M.HighWaterline=E;M.LowWaterline=A;return M}}Object(G.a)(w,"GetActivitiesRequest",u.a,[]);class r extends u.a{constructor(L,E,A){super();this.Settings=this.Waterline=this.FileId=null;this.FileId=L;
this.Waterline=E;this.Settings=A}ol(){return 107}static L7(L,E,A){return new r(L,E,A)}}Object(G.a)(r,"GetRelevantActivitiesRequest",u.a,[]);class m extends u.a{constructor(L,E){super();this.WaterlineOverrideSettings=this.FileId=null;this.FileId=L;this.WaterlineOverrideSettings=E}ol(){return 96}static L7(L,E){return new m(L,E)}}Object(G.a)(m,"GetWywaActivitiesRequest",u.a,[]);class l{}Object(G.a)(l,"RelevantActivitiesSettings",null,[]);class z extends u.a{constructor(){super();this.FileId=null}ol(){return 109}static L7(L){const E=
new z;E.FileId=L;return E}}Object(G.a)(z,"UpdateWaterlineRequest",u.a,[]);b.d(P,"a",function(){return F});class F{constructor(L,E,A,M,Q){this.dnj=L;this.gfd=E;this.kye=A;this.ikb=M;this.c$i=Q}requestWYWAActivities(L){L=m.L7(this.gfd(),L);return k.a.then(this.Z7(L,"wywa"),E=>E)}requestActivities(L,E){L=w.L7(this.gfd(),L,E);return k.a.then(this.Z7(L,"activities"),A=>A)}o1m(){const L=z.L7(this.gfd());return k.a.then(this.Z7(L,"waterline"),E=>E)}requestRelevantActivities(L,E){E=Object.assign(new l,{FirstDocumentOpen:E,
MockDataEnabled:!1});L=r.L7(this.gfd(),L,E);return k.a.then(this.Z7(L,"relevant"),A=>A)}requestActivityFeed(){return k.a.e5d(this.c$i,L=>L.getActivityFeed(null))}Z7(L,E){const A={"Content-Type":"application/json; charset=utf-8"};return k.a.then(k.a.e5d(this.dnj,M=>M.Pv(this.kye,A,f.a.H5g(L,this.ikb),E)),M=>{if(!(M&&M.args&&M.args.data&&M.args.data.qd))return null;let Q;({group:Q}=x.a.D$(M.args.data.qd,Q));return Q&&Q.Responses&&Q.Responses.length?Q.Responses[0]:null})}}Object(G.a)(F,"SharedActivityRepository",
null,[])}}]);

//# sourceMappingURL=https://wordwebclientbuilds.blob.core.windows.net/ooui/a048ce1529a2befd784608ddea483865d3dd781d/WordEditorDSVersionHistoryNotRemoved.box4.dll1.js.map